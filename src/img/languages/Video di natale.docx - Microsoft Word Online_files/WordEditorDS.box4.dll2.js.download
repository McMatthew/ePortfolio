'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1383:function(I,K,e){I=e(0);var m=e(13),f=e(41),a=e(5),l=e(114),w=e(185),z=e(824),x=e(231),u=e(622),v=e(2),E=e(373),y=e(21),H=e(118),D=e(277),G=e(1),J=e(1537);class U{constructor(S,N){this.LAk=S;this.MD=N}K(S){return this.LAk.R4(S,this.MD)}}Object(I.a)(U,"PropertyMergeStrategies",null,[]);var F=e(1602),T=e(1535);class Y extends T.a{constructor(){super();this.mhd=this.fne=this.Lp=null;this.Rue=0}get aha(){return"Property"}BSb(){this.detail.W("Type",
this.aha);this.detail.W("ComplexMerger",null!=this.Lp?this.Lp:-1);this.detail.W("Strategy",null!=this.fne?this.fne:-1);this.detail.W("ClassId",null!=this.mhd?this.mhd:-1);this.detail.W("PropId",this.Rue);return this.detail}}Object(I.a)(Y,"PropertyMergeFailureDetail",T.a,[]);e.d(K,"a",function(){return P});class P{constructor(S=null){this.WFh=this.Dc=null;this.Jac=S||this.F6c()}get Lp(){return 1}get Dxb(){return this.Jac}F6c(){return[Object(H.a)(this,this.uyp,"tryPreProcessFavoredRevision"),Object(H.a)(this,
this.zzl,"cloneObjectAndRemoveNeededProperties"),Object(H.a)(this,this.gyp,"tryMergeNodeInternal")]}get MD(){return 5}get Tue(){return this.WFh||(this.WFh=new U(this.Vl(),this.MD))}HF(S,N){const V=S.Ah.value.Xf;w.a.instance.fb(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",V.id,V.yc);S.kv.logger.mj(Object.assign(new Y,{Lp:this.Lp,mhd:V.yc,Rue:N}));return!1}XNg(S){const N=S.Ah.value;w.a.instance.fb(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",N.Xf.id,N.Xf.yc);for(let V=0;V<this.Dxb.length;V++)if(!(0,this.Dxb[V])(S))return w.a.instance.fb(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",N.Xf.id,N.Xf.yc,V),S.kv.logger.Ole("GraphNodeComplexMerge.GetMergeFunctions()",V),this.fLn(S),S.Fm=null,!1;w.a.instance.fb(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",N.Xf.id,N.Xf.yc);
return!0}fLn(S){S.hSg||(S.hSg=!0,F.a(S.Ah.value.yx,"Base",1),F.a(S.Ah.value.Xf,"Favored",1),F.a(S.np.value.Xf,"Conflict",1))}uyp(S){const N=S.Ah.value,V=this.Tue;if(!N.j5)return!0;let Z=!0;N.xFa.forEach((ca,W)=>{if(!W.j5||S.mh.contains(ca))return!0;W=V.K(ca);if(5===W){const X=N.yx.yc;w.a.instance.fb(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",X,ca,W);S.kv.logger.mj(Object.assign(new Y,{Lp:this.Lp,
mhd:X,Rue:ca,fne:W}));return Z=!1}6===W&&S.mrg.add(ca);return!0});return Z}zzl(S){S.Fm=S.Ah.value.Xf.KQ();const N=S.mrg,V=S.Fm;N&&N.forEach(Z=>{V.removeProperty(z.a.q1(Z));return!0});return!0}gyp(S){const N=S.np.value,V=N.yx.yc,Z=this.Tue;let ca=!0;N.xFa.forEach((W,X)=>{const ka=Z.K(W);ca=this.N9j(S,X,W,ka);ca||(S.Fm=null,w.a.instance.fb(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",V,W,ka),S.kv.logger.mj(Object.assign(new Y,{Lp:this.Lp,mhd:V,Rue:W,
fne:ka})));return ca});return ca}N9j(S,N,V,Z){const ca=S.Fm;if(!N.j5&&8!==Z||2===Z||7===Z||S.mh.contains(V))return!0;if(5===Z)return!1;if(4===Z||3===Z){let W;if(({value:W}=S.Ah.value.xFa.Nc(V)).returnValue&&W.j5)return 4!==Z;Z=0}8===Z&&(Z=0);if(0===Z){if(!N.isDeleted)return S=z.a.q1(V),(P.bMp(N,V,S)||P.Xap())&&ca.Agb(S,N.newValue),!0;Z=6}return 6===Z?(ca.removeProperty(z.a.q1(V)),!0):1===Z?this.HF(S,V):!1}JTn(S,N,V,Z,ca,W){S=S||new x.a;N=N||new x.a;V=V||new x.a;var X=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
S.length,N.length,V.length),ka=S.length<=N.length&&S.length<=V.length;this.m4i()&&ka&&w.a.instance.fb(541181455,1,1,X);if(!ka&&this.i2i(W.runtime.Dc))return null;if(this.m4i())for(X=0;X<S.length;X++){ka=S.Lg(X);var ma=N.Lg(X);let ja=V.Lg(X);ka=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ka,ma,ja,X,S.length);w.a.instance.fb(541181457,1,1,ka)}if(this.i2i(W.runtime.Dc))for(W=0;W<
S.length;W++)if(X=S.Lg(W),ka=N.Lg(W),ma=V.Lg(W),!Z(X,ka)||!Z(X,ma))return null;S=S.pQa();Z=new u.a;W=S.length;for(X=W;X<N.length;X++)ka=N.Lg(X),S.add(ka),Z.add(ka);for(;W<V.length;W++)N=V.Lg(W),Z.contains(N)?w.a.instance.fb(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",N):(S.add(N),ca(N));return S}m4i(){return!!v.AFrameworkApplication.J&&v.AFrameworkApplication.J.$("LogMPALErrors")}i2i(S){if(!S)return!1;S.wTf(1000008);
return S.TTb(1000008)}szn(S){if(!S)return!1;S.wTf(1000009);return S.TTb(1000009)}pjj(S,N,V,Z){return J.a(S,N,V,Z)}yOa(S,N,V){S=S||new x.a;N=N||new x.a;V=V||new x.a;const Z=S.FU(),ca=N.FU(),W=V.FU();S=P.filter(S,X=>ca.contains(X)&&W.contains(X));S.FU();S.PC(S.length,P.filter(N,X=>!Z.contains(X)));S.PC(S.length,P.filter(V,X=>!Z.contains(X)&&!ca.contains(X)));return S}CTn(S,N){const V=z.a.q1(N),Z=S.xf;var ca=Z.getPropertyObjectIds(S.Ah.value.yx,V),W=Z.getPropertyObjectIds(S.Ah.value.Xf,V);const X=Z.getPropertyObjectIds(S.np.value.Xf,
V);ca=this.yOa(ca,W,X);W=S.Fm;0<ca.length?Z.setPropertyObjectIds(W,V,ca):W.removeProperty(V);S.mh.add(N)}xqb(S,N,V){S.hasProperty(V)?N.Agb(V,S.nG(V)):N.removeProperty(V)}kLo(S,N){var V=N.Ak();for(const Z of V)N.removeProperty(Z);V=S.Ak();for(const Z of V)N.Agb(Z,S.nG(Z))}e6f(S,N,V,Z,ca){N=S.getPropertyInt32(N,ca);V=S.getPropertyInt32(V,ca);V=null!=N&&null!=V?Math.max(N,V):null!=V?V:null!=N?N:null;null!=V?S.setPropertyInt32(Z,ca,V):Z.removeProperty(ca)}trf(S,N,V,Z,ca,W){N=S(N,ca);V=S(V,ca);S=S(Z,ca);
Z=N.FU();let X=!1;W&&(X=W(N,V,S));X?(W=!0,Z=!1):(W=Z.Aai(V),Z=Z.Aai(S));w.a.instance.fb(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.Db(ca),N.Bt(),V.Bt(),S.Bt(),W,Z);return{kZc:S,ycb:W,ocb:Z}}kvl(S,N,V,Z,ca){let W;N=S(N,ca);V=S(V,ca);S=S(Z,ca);Z=this.Q7i(N,V);W=this.Q7i(N,S);w.a.instance.fb(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.Db(ca),N.Bt(),V.Bt(),S.Bt(),Z,W);return{kZc:S,ycb:Z,ocb:W}}Q7i(S,N){if(!S&&!N)return!0;if(!S||!N)return!1;if(!S.count&&!N.count)return!0;let V=!1;N.forEach((Z,ca)=>V=S.Bb(Z)&&ca==S.K(Z));return V}Vl(){let S;S=this.szn(this.Dc)?P.pJk.value:P.oJk.value;const N=new E.a(0);for(let V=0;V<S.length;V++)N.W(S[V],7);return N}static fca(){return new P}static get instance(){return P._instance.value}static Xap(){return y.a.instance.Wa("Box4.IFeatureHelper").isFeatureEnabled(70)}static bMp(S,N,V){if(void 0!==
S.newValue&&null!==S.newValue||G.a.a5i(V.type))return!0;P.bMn(S,N,V);return!1}static bMn(S,N,V){V=V.type===G.a.string;N=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",N);V||(N+=String.format(" [NewValue: {0}] [OldValue: {1}]",S.newValue,S.oldValue));w.a.instance.fb(19145822,1,2,N)}static ubg(S,N,V){const Z=z.a.Db(V),ca=S.xf;var W=ca.getPropertyObjectIds(S.Ah.value.yx,V);const X=ca.getPropertyObjectIds(S.Ah.value.Xf,V);var ka=ca.getPropertyObjectIds(S.np.value.Xf,V);ka=P.iXm(ka,
S.kv.runtime.cBc);N=N.yOa(W,X,ka);W=S.Fm;0<N.length?ca.setPropertyObjectIds(W,V,N):W.removeProperty(V);S.mh.add(Z);return!0}static iXm(S,N){const V=new x.a;S.forEach(Z=>{N.contains(Z,(ca,W)=>ca.equals(W))||V.add(Z);return!0});return V}static filter(S,N){const V=new x.a;S.forEach(Z=>{N(Z)&&V.add(Z);return!0});return V}static tCm(){return[z.a.Db(m.a.I4d),z.a.Db(m.a.lastModifiedTime),z.a.Db(m.a.UN),z.a.Db(m.a.zpd),z.a.Db(m.a.kzg),z.a.Db(f.a.khd),z.a.Db(a.a.D_d),z.a.Db(a.a.xrb),z.a.Db(l.a.JOj)]}static uCm(){return[z.a.Db(m.a.I4d),
z.a.Db(m.a.lastModifiedTime),z.a.Db(m.a.UN),z.a.Db(m.a.zpd),z.a.Db(m.a.kzg),z.a.Db(f.a.khd),z.a.Db(a.a.D_d),z.a.Db(l.a.JOj)]}}P._instance=new D.a(P.fca);P.oJk=new D.a(P.tCm);P.pJk=new D.a(P.uCm);Object(I.a)(P,"GraphNodeComplexMerge",null,[897])},1384:function(I,K,e){e.r(K);I=e(0);var m=e(257),f=e(1413),a=e(1392),l=e(1604),w=e(1605);class z{constructor(u,v){this.wlb=!1;this.Joa=null;if(!u)throw Error.argumentNull("annotations");if(!u.dsc(v))throw Error.argument("structTypeID","Invalid struct type ID");
this.Fz=u;this.Qtc=this.Fz.aIi(v);this.gVk=v}get wfc(){return this.Fz}get isReadOnly(){return this.wlb}get M2a(){return this.gVk}otb(u){if(0>u||u>=this.Qtc)throw Error.argument("iField","Invalid field index");return this.Joa&&null!=this.Joa[u]?this.Joa[u]:this.Fz.DMi(this.M2a,u)}PCg(u,v){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.Qtc)throw Error.argument("iField","Invalid field index");if(!this.Fz.Vqc(this.Fz.CTb(this.M2a,
u),v))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Joa||(this.Joa=Array(this.Qtc)))[u]=v}dka(){const {Annotations:u}=e(1384);let v="[";if(this.Joa){let E=!0;for(let y=0;y<this.Qtc;++y){if(null==this.Joa[y])continue;const H=this.Fz.CTb(this.M2a,y);if(u.iDb(H,this.Joa[y],this.Fz.DMi(this.M2a,y)))continue;E?E=!1:v+=", ";v+=this.Fz.EMi(this.M2a,y);v+="=";const D=this.Fz.dka(H,this.Joa[y]);H===u.Lea?(v+='"',v+=f.a.AEf(D),v+='"'):v+=D}}return v+"]"}isEqual(u){const {Annotations:v}=
e(1384);if(this===u)return!0;if(!u||this.Fz!==u.wfc||this.M2a!==u.M2a)return!1;for(let E=0;E<this.Qtc;++E)if(!v.iDb(this.Fz.CTb(this.M2a,E),this.otb(E),u.otb(E)))return!1;return!0}clone(){const u=new z(this.Fz,this.M2a);this.Joa&&(u.Joa=Array.clone(this.Joa));return u}FY(){return this.isReadOnly?this.clone():this}x9f(){const {Annotations:u}=e(1384);if(!this.isReadOnly&&(this.wlb=!0,this.Joa))for(let v=0;v<this.Qtc;++v){const E=this.Joa[v];null!=E&&u.IXb(E)}}toString(){return this.dka()}}Object(I.a)(z,
"StructValue",null,[2028,2029]);e.d(K,"Annotations",function(){return x});class x{constructor(u,v){if(!u)throw Error.argumentNull("initData");if(!v)throw Error.argumentNull("objectFetcher");this.hPn=v.u3l;let E=0;var y=v.$sb(u.K(E));++E;this.nag=new l.a(new w.a(y));this.GAk=u.K(E);++E;this.Jgj=Array(this.d5d);this.Ifd=Array(this.d5d);this.sxb=Array(this.d5d);for(y=0;y<this.d5d;++y){this.Jgj[y]=v.lF(u.K(E));++E;this.Ifd[y]=u.K(E);++E;var H=u.K(E);++E;this.sxb[y]=Array(H);for(var D=0;D<H;++D)this.sxb[y][D]=
v.lF(u.K(E)),++E}this.fVk=u.K(E);++E;this.qhj=Array(this.Qtd);this.wme=Array(this.Qtd);this.xme=Array(this.Qtd);this.vme=Array(this.Qtd);for(y=0;y<this.Qtd;++y)for(this.qhj[y]=v.lF(u.K(E)),++E,H=u.K(E),++E,this.wme[y]=Array(H),this.xme[y]=Array(H),this.vme[y]=Array(H),D=0;D<H;++D)this.wme[y][D]=v.lF(u.K(E)),++E,this.xme[y][D]=u.K(E),++E,this.vme[y][D]=({Ona:E}=this.XWa(this.xme[y][D],u,E,null,null,null)).returnValue,x.IXb(this.vme[y][D]);this.juk=u.K(E);++E;this.Q$f=Array(this.Ufc);this.R$f=Array(this.Ufc);
this.P$f=Array(this.Ufc);for(y=0;y<this.Ufc;++y)this.Q$f[y]=v.lF(u.K(E)),++E,this.R$f[y]=u.K(E),++E,this.P$f[y]=({Ona:E}=this.XWa(this.R$f[y],u,E,null,null,null)).returnValue,x.IXb(this.P$f[y])}S4c(u){for(let v=0;v<this.Ufc;++v)if(this.Q$f[v]===u)return v;return-1}Iyi(u){if(!this.Zrc(u))throw Error.argument("attrID","Invalid attribute ID");return this.Q$f[u]}getAttributeType(u){if(!this.Zrc(u))throw Error.argument("attrID","Invalid attribute ID");return this.R$f[u]}CTb(u,v){if(!this.dsc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.xme[x.Rtd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}dka(u,v){if(!this.z5f(u))throw Error.argument("typeID","Invalid type ID");if(!this.Vqc(u,v))throw Error.argument("value","Value is not of the correct type");switch(u){case x.Lea:return v;case x.PGa:return v?"True":"False";case x.jRa:case x.sya:return v.toString();case x.r_:return v.dka();default:if(!x.pM(u)&&x.$vd(u)){u=x.nEf(u);const H=this.sxb[u].length;switch(this.Ifd[u]){case 0:return this.sxb[u][v];
case 1:if(v){var E="";for(var y=1;y<H;++y)v&1<<y-1&&(0<E.length&&(E+=" & "),E+=this.sxb[u][y]);return E}return this.sxb[u][0];case 2:E="";for(y=0;y<H;++y)v&1<<y&&(0<E.length&&(E+=" & "),E+=this.sxb[u][y]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Ifd[u]);}}else return v.dka()}}z5f(u){switch(u){case x.Lea:case x.PGa:case x.jRa:case x.sya:case x.r_:return!0;default:return x.pM(u)?this.z5f(x.Yab(u)):x.$vd(u)?this.BBn(u):this.dsc(u)}}BBn(u){u=x.nEf(u);return 0<=
u&&u<this.Jgj.length}dsc(u){u=x.Rtd(u);return 0<=u&&u<this.qhj.length}Zrc(u){return 0<=u&&u<this.Ufc}Vqc(u,v){if(null==v)return!1;switch(u){case x.Lea:return"string"===typeof v;case x.PGa:return"boolean"===typeof v;case x.jRa:return"number"===typeof v;case x.sya:return"number"===typeof v;case x.r_:return Object(m.a)(2026,v);default:if(x.pM(u))return Object(m.a)(2027,v)&&v.M9===x.Yab(u);if(x.$vd(u)){if("number"!==typeof v)return!1;u=x.nEf(u);const E=this.sxb[u].length;switch(this.Ifd[u]){case 0:return 0<=
v&&v<E;case 1:return!(v&-1<<E-1);case 2:return!!v&&!(v&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Ifd[u]);}}else return Object(m.a)(2028,v)&&v.M2a===u}}get Ufc(){return this.juk}get d5d(){return this.GAk}get Qtd(){return this.fVk}Kom(u){if(!this.Zrc(u))throw Error.argument("attrID","Invalid attribute ID");return this.P$f[u]}aIi(u){if(!this.dsc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.wme[x.Rtd(u)].length}EMi(u,v){if(!this.dsc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.wme[x.Rtd(u)][v]}DMi(u,v){if(!this.dsc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.vme[x.Rtd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}XWa(u,v,E,y,H,D){if(!v)throw Error.argumentNull("initData");if(x.pM(u)){var G=v.K(E);++E;u=x.Yab(u);var J=new a.a(this,u);for(var U=0;U<G;++U)Array.add(J.items,({Ona:E}=this.XWa(u,v,E,y,H,D)).returnValue);return{returnValue:J,Ona:E}}switch(u){case x.Lea:return{returnValue:(y||
this.nag).lF(v.K(E++)),Ona:E};case x.PGa:return{returnValue:1===v.K(E++),Ona:E};case x.jRa:return{returnValue:v.K(E++),Ona:E};case x.sya:return{returnValue:(H||this.hPn)[v.K(E++)],Ona:E};case x.r_:u=v.K(E++);G=new f.a(this);for(J=0;J<u;++J)U=v.K(E),++E,D&&(U=D[U]),G.bC(U,({Ona:E}=this.XWa(this.getAttributeType(U),v,E,y,H,D)).returnValue);return{returnValue:G,Ona:E};default:if(x.$vd(u))return{returnValue:v.K(E++),Ona:E};if(x.w$j(u)){G=v.K(E++);J=new z(this,u);for(U=0;U<G;++U){const F=v.K(E);++E;J.PCg(F,
({Ona:E}=this.XWa(this.CTb(u,F),v,E,y,H,D)).returnValue)}return{returnValue:J,Ona:E}}throw Error.argument("typeID","Invalid type ID");}}static $vd(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static w$j(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static pM(u){return 32768===(u&32768)}static EFm(u){if(x.pM(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static Yab(u){if(!x.pM(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static iDb(u,v,E){switch(u){case x.Lea:case x.PGa:case x.jRa:case x.sya:return v===E;case x.r_:return v.isEqual(E);default:return x.pM(u)?v.isEqual(E):x.$vd(u)?v===E:v.isEqual(E)}}static IXb(u){Object(m.a)(2029,u)&&u.x9f()}static FY(u){return Object(m.a)(2029,u)?u.FY():u}static nEf(u){return u-16}static Rtd(u){return(u&-16385)-16}}x.Lea=1;x.PGa=2;x.jRa=3;x.sya=5;x.r_=9;Object(I.a)(x,"Annotations",null,[2030])},1389:function(I,K,e){e.r(K);e.d(K,"TellMeActorConstants",function(){return w});
I=e(0);var m=e(1422),f=e(530),a=e(287),l=e(1376);class w{constructor(){this.Ela=null;this.eaa=[];this.Nac=!0;this.DKd=null;this.gPh=!1;this.VK=null;this.d4e=[];this.GQe=[];this.FQe=[];this.rff=[];this.dQd=this.QIa=null;this.e4e=[];this.lZe=this.adf=this.$c=null;this.rRc=-1;this.QAd=this.YWe=null}static get instance(){return w._instance||(w._instance=new w)}VKf(){return this.d4e}O8d(){return this.GQe}cLf(){return this.FQe}ISf(){return this.rff}GOf(){return this.QIa}get atd(){return this.dQd}set atd(z){this.dQd=
z}WKf(){return this.e4e}swd(z,x="",u=null){z?this.QAd=new f.a(a.a.Oh()):x&&u&&this.QAd.add(x,u)}Dnc(){return w.instance.Jn?w.instance.Jn.axa.interactionId:null}get d9a(){return this.QAd}set d9a(z){this.QAd=z}get CU(){return w.instance.adf}set CU(z){w.instance.adf=z}WRf(){return this.adf}get actions(){return w.instance.eaa}set actions(z){w.instance.eaa=z}aP(){return this.$c}gk(){return this.lZe}Q1d(){return this.rRc}tNf(){return this.YWe}get Xo(){return w.instance.$c}set Xo(z){w.instance.$c=z}set gMe(z){w.instance.Ela=
z}get Wnc(){return w.instance.YWe}set Wnc(z){w.instance.YWe=z}get Jn(){return w.instance.lZe}set Jn(z){w.instance.lZe=z}get nxa(){return w.instance.rRc}set nxa(z){w.instance.rRc=z}get ITd(){return this.VK}set ITd(z){this.VK=z}static get Unknown(){return w.unknown}get a0c(){return this.VK?this.VK.contentType:w.unknown}UH(z){const x=window.performance.now();this.Ela&&!l.c(z)&&(this.Ela(z),w.instance.Jn.hE(m.a.UH,window.performance.now()-x))}get Lgd(){return this.Nac}set Lgd(z){this.Nac=z}get Dxd(){return this.DKd}set Dxd(z){this.DKd=
z}get hib(){return this.gPh}set hib(z){this.gPh=z}get vuc(){return this.d4e}set vuc(z){this.d4e=z}get xhc(){return this.GQe}set xhc(z){this.GQe=z}get whc(){return this.FQe}set whc(z){this.FQe=z}get YDc(){return this.rff}set YDc(z){this.rff=z}get Poa(){return this.QIa}set Poa(z){this.QIa=z}get n3b(){return this.dQd}set n3b(z){this.dQd=z}get wuc(){return this.e4e}set wuc(z){this.e4e=z}}w._instance=null;w.unknown="Unknown";Object(I.a)(w,"TellMeActorConstants",null,[])},1390:function(I,K,e){I=e(0);var m=
e(359);class f{constructor(){this.userId=this.email=this.displayName=null}}Object(I.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(I.a)(a,"InsightsParameters",null,[]);var l=e(1739),w=e(1740),z=e(1742),x=e(1743),u=e(2),v=e(1473),E=e(1491),y=e(29),H=e(17),D=e(16),G=e(1376),J=e(1741);e.d(K,"a",function(){return U});class U{static get EZf(){return"Insights_16x16x32"}static get rem(){return"Find_16x16x32"}static get mxj(){return"-Parameterized"}static get HHg(){return"Parameterized"}static get zHe(){return"bTryQuery"}static get dOg(){return"TellMeSuggestion_"}static get X9j(){return"bTryQueryAlternate"}static get vLg(){return"MenuTellMe"}static get Zho(){const F=
{},T=[];Array.add(T,{Term:{PeopleType:"Person"}});F.And=T;return F}static xxf(F){return F+U.mxj}static getParameter(F){let T="",Y="";if(F)for(let P=0;P<F.Lsi;++P)"Type"===F.getFieldName(P)?T=F.getValue(P):"Value"===F.getFieldName(P)&&(Y=F.getValue(P));return new m.a(T,Y)}static xPb(F){F=Object.assign(new a,{neighborhood:F,mentionStart:0,mentionLength:F.length});return y.c(F)}static Tfi(F,T,Y){F=Object.assign(new f,{displayName:F,email:T,userId:Y});return y.c(F)}static MWa(F,T,Y=null){return y.c(U.jMi(F,
T,Y,null))}static jMi(F,T,Y=null,P=null){F=Object.assign(new E.a,{neighborhood:F,mentionStart:0,mentionLength:F?F.length:0});return Object.assign(new v.a,{selection:F,userIntent:P,entryPoint:T,launchData:Y})}static uPo(F,T){return U.MWa(F,U.RMj(T))}static RMj(F){switch(F){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static Crn(){return!!u.AFrameworkApplication.J&&
u.AFrameworkApplication.J.$("IsGoLocalEnvironment")}static Jrc(){const F=u.AFrameworkApplication.J?u.AFrameworkApplication.J.rb("SovereignEnvironmentName"):null;return!!F&&0<F.length}static isEnterpriseUser(){const F=u.AFrameworkApplication.J?u.AFrameworkApplication.J.rb("HostAuthType"):null;return!!F&&"aad"===F.toLowerCase()||"external"===F&&U.L0f()}static wFg(F){return F.Tqp&&!U.Jrc()}static Ayn(){const F=u.AFrameworkApplication.J?u.AFrameworkApplication.J.rb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.J&&
"UnifiedUiHostTeams"===F&&u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static vFg(F){return F.W2a&&F.ncm&&(F.Eud||F.Cud||F.Cwb)&&!U.Ayn()&&U.isEnterpriseUser()&&!U.Jrc()}static Mva(){return u.AFrameworkApplication.J?u.AFrameworkApplication.Xgb||u.AFrameworkApplication.J.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.Xgb}static UT(F){return!F||U.L7i(F.sh)}static L7i(F){return!F||!F.trim().length}static kHe(F){if(!F)return 0;
const T=Math.pow(10,5);return Math.round(F*T)/T}static itp(){var F=new Date;return F?new Date(F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate(),F.getUTCHours(),F.getUTCMinutes(),F.getUTCSeconds(),F.getUTCMilliseconds()):null}static nSf(F){F=new Date(F);return(U.itp().getTime()-F.getTime())/1E3}static u8i(F){switch(F){case l.a.bWf:case w.a.rui:case J.a.sYi:case z.a.Amj:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return F.startsWith(U.zHe)||
F.startsWith(U.dOg)||F.startsWith(U.X9j)||F.startsWith("PeopleSuggestion")||F.startsWith("FileSuggestion")||F.startsWith("FindInDocumentSuggestion")||F.startsWith("NotesSuggestion")||F.startsWith("OnenoteNotesSuggestion")||F.startsWith("SmartLookupFromTellMe")||F.startsWith("GetHelpFromTellMe")||F.startsWith("GetHelpWithDescriptionFromTellMe")||F.startsWith("AddinSuggestion")||F.startsWith("OfficeScripts")?!0:!1}static jNf(F,T){const Y=[];Array.add(Y,new x.a(400,F));Array.add(Y,new x.a(200,T));F=
{};F.parts=Y;return JSON.stringify(F)}static Wsb(F){const T=F.indexOf("<b0>"),Y=F.lastIndexOf("</b0>"),P=[];Array.add(P,new x.a(400,F.substring(0,T)));Array.add(P,new x.a(600,F.substring(T+4,Y)));Array.add(P,new x.a(400,F.substring(Y+5,F.length)));F={};F.parts=P;return JSON.stringify(F)}static bOi(F){const T=U.nSf(F);return 60>T?CommonUIStrings.l_TimeSince_SecsAgo:3600>T?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(T/60).toString()):86400>T?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(T/3600).toString()):172800>T?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(F)).localeFormat("MMMM dd, yyyy"))}static Hsm(F){const T=Array(F.length);for(let Y=0;Y<F.length;Y++)T[Y]=F[Y].commandId;return T}static L0f(){if("Dev Box"===u.AFrameworkApplication.J.rb("StatusBarEnvironmentNameToUse"))return!0;let F=u.AFrameworkApplication.J.rb("UserPrincipalName");F=G.c(F)?"":D.a.Ph(F);const T=u.AFrameworkApplication.J.RA("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.J.kF("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(T,F)&&"inner"===u.AFrameworkApplication.J.rb("Microsoft365Ring")}static pCm(F){switch(U.J9d(F)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static MRm(F){F=U.J9d(F);switch(F){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return F}}static J9d(F){switch(F.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static bia(){return H.a.w9&&!H.a.zt}static pum(F){if("word"===F.application.toLowerCase())return"ChatPane";if("powerpoint"===F.application.toLowerCase())return"ChatPPTPane";if("excel"===F.application.toLowerCase())return"Copilot"}}U.zhb=9E5;Object(I.a)(U,"TellMeUtils",null,[])},1392:function(I,K,e){e.d(K,"a",function(){return f});
I=e(0);var m=e(1413);class f{constructor(a,l){this.wlb=!1;const {Annotations:w}=e(1384);if(!a)throw Error.argumentNull("annotations");if(!a.z5f(l))throw Error.argument("memberTypeID","Invalid type ID");if(w.pM(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Fz=a;this.SKk=l;this.jr=[]}get wfc(){return this.Fz}get isReadOnly(){return this.wlb}get M9(){return this.SKk}get items(){return this.jr}dka(){const {Annotations:a}=e(1384);let l="[";for(let w=0,z=this.items.length;w<
z;++w){0<w&&(l+=", ");const x=this.Fz.dka(this.M9,this.items[w]);this.M9===a.Lea?(l+='"',l+=m.a.AEf(x),l+='"'):l+=x}return l+"]"}isEqual(a){const {Annotations:l}=e(1384);if(this===a)return!0;if(!a||a.wfc!==this.Fz||a.M9!==this.M9||a.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!l.iDb(this.M9,this.items[w],a.items[w]))return!1;return!0}clone(){const a=new f(this.Fz,this.M9);Array.addRange(a.items,this.items);return a}FY(){return this.isReadOnly?this.clone():this}x9f(){const {Annotations:a}=
e(1384);if(!this.isReadOnly){this.wlb=!0;for(const l of this.items)a.IXb(l)}}toString(){return this.dka()}}Object(I.a)(f,"ListValue",null,[2027,2029])},1394:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.Pv="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(I.a)(m,"TellMeScenario",null,[])},1396:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f,a,l=null,w=null,z=4,x=-99999,u=0){this.additionalInfo="";this.rVd=-1;this.value=f;this.type=a;this.subType=
z;this.label=this.wG=l;this.groupType=30;this.description=w;this.score=x;this.count=u}}Object(I.a)(m,"ResultBinding",null,[])},1398:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f=30,a=""){this.uQ=[];this.groupType=f;this.displayName=a}get results(){return this.uQ}aA(f){f.groupType=this.groupType;Array.add(this.results,f)}Vvg(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(I.a)(m,"SimpleResultGroup",null,[1946])},
1400:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f){this.attributes=null;this.query=f;this.pq=[]}Jx(f){this.pq.push(f)}SIj(f){const a=[];for(const l of this.pq)l.groupType!==f&&a.push(l);this.pq.length!==a.length&&(this.pq=a)}get nrc(){return!1}}Object(I.a)(m,"SimpleResultsUpdatedEventArgs",null,[1944])},1413:function(I,K,e){I=e(0);class m{constructor(a,l){this.Wob=a;this.value=l}}Object(I.a)(m,"AttrValuePair",null,[]);e.d(K,"a",function(){return f});class f{constructor(a){this.wlb=
!1;if(!a)throw Error.argumentNull("annotations");this.Fz=a;this.o2=[]}get wfc(){return this.Fz}get isReadOnly(){return this.wlb}get lVf(){return 0<this.o2.length}Rs(a){if(!this.Fz.Zrc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.o2)if(a===l.Wob)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}bC(a,l){var {Annotations:w}=e(1384);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Fz.Zrc(a))throw Error.argument("attributeID",
"Invalid attribute ID");if(!this.Fz.Vqc(this.Fz.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.IXb(l);for(w=0;w<this.o2.length;++w){const z=this.o2[w];if(a===z.Wob){z.value=l;return}}Array.add(this.o2,new m(a,l))}u1a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Fz.Zrc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let l=0;l<this.o2.length;++l)if(a===
this.o2[l].Wob){Array.removeAt(this.o2,l);break}}A7d(a){if(!a)throw Error.argumentNull("action");for(const l of this.o2)a(l.Wob,l.value)}clone(){const a=new f(this.Fz);a.I9a(this);return a}I9a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.wfc!==this.Fz)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.o2);a.A7d((l,w)=>{this.bC(l,w)})}dka(){const {Annotations:a}=
e(1384);let l="[",w=!0;for(const z of this.o2){w?w=!1:l+=", ";l+=this.Fz.Iyi(z.Wob);l+="=";const x=this.Fz.getAttributeType(z.Wob),u=this.Fz.dka(x,z.value);x===a.Lea?(l+='"',l+=f.AEf(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=e(1384);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Fz!==a.wfc||this.lVf!==a.lVf)return!1;let w=0,z=null,x=!1;a.A7d((u,v)=>{++w;if(!x){var E=-1;for(let y=0,H=this.o2.length;y<H;++y)if(this.o2[y].Wob===u){E=y;break}0>E?x=!0:(z||
(z=Array(this.o2.length)),z[E]=v)}});if(this.o2.length!==w||x)return!1;for(let u=0,v=this.o2.length;u<v;++u)if(!l.iDb(this.Fz.getAttributeType(this.o2[u].Wob),this.o2[u].value,z[u]))return!1;return!0}FY(){return this.isReadOnly?this.clone():this}x9f(){const {Annotations:a}=e(1384);if(!this.isReadOnly){this.wlb=!0;for(const l of this.o2)a.IXb(l.value)}}toString(){return this.dka()}static AEf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(I.a)(f,"FeatureBundle",
null,[2026,2029])},1422:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.click="Click";m.icb="InteractionBegin";m.nVb="InteractionEnd";m.Dbi="ControlActivated";m.query="Query";m.$Cj="QueryIndexRecorded";m.v9h="Clicks";m.oRh="ActionEvents";m.iti="FilteredActionEvents";m.ZRj="SessionContext";m.latency="Latency";m.performance="Performance";m.CKj="RenderedResults";m.events="Events";m.QPl="CreateResultsMenu";m.UH="UpdateRibbonControls";m.vPo="ResultsAggregation";m.WL="IssueQuery";m.QBl=
"CommandSuggestions";m.error="Error";m.f9f="LoadModelData";m.AXl="DepsResolveTime";m.hVn="ModelDataWaitTime";m.timedOut="TimedOut";m.t9k="AddinQueryCommandReady";m.Rmm="GetAddinEntitlements";m.xCj="ProviderMRUEvents";m.f6l="EnableAddinSearchCommands";Object(I.a)(m,"EventNames",null,[])},1436:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(){this.jag=null;this.qia=this.mag=0}EIf(f,a,l){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");
if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.jag=f;this.mag=a;this.qia=l}Dsb(f,a,l){this.EIf(f.jag,f.mag+a,l)}K(f){if(0>f||f>=this.qia)throw Error.argumentOutOfRange("index");return this.jag[this.mag+f]}get count(){return this.qia}static Xwf(f){const a=new m;a.EIf(f,0,f.length);return a}}Object(I.a)(m,"ReadOnlyList",null,[2039])},1449:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.RTp=
0]="Classifier";f[f.tTp=1]="AppsForOffice";f[f.FindInDocument=2]="FindInDocument";f[f.nVp=3]="FindInDocumentScopedSearch";f[f.vXp=4]="RecentlyUsed";f[f.fqk=5]="TryQuery";f[f.Empty=6]="Empty";f[f.RYp=7]="TryCommand";f[f.pjk=8]="Assistance";f[f.hjk=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.Vqk=12]="WolframAnswer";f[f.imk=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.wXp=16]="Recommended";f[f.YXp=17]="ServiceClassifier";f[f.ZXp=18]="ServiceRecommended";
f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Tmk=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.Yik=24]="ActionAI";f[f.Zik=25]="ActionAICommand";f[f.mpk=26]="SummarizeDeck";f[f.fjk=27]="Addin";f[f.Unk=28]="OfficeScript";f[f.gjk=29]="AddinStoreEntry";f[f.None=30]="None";f[f.tWp=31]="MergedActions";f[f.uWp=32]="MergedScopedSearches";f[f.vWp=33]="MergedSuggestedSearches"})(m||(m={}));Object(I.b)("ResultGroupType",m)},1457:function(I,K,e){e.d(K,"a",function(){return m});
I=e(0);e=e(1535);class m extends e.a{constructor(){super();this.info=this.Dk=this.eventId=null}get aha(){return"Misc"}BSb(){this.detail.W("Type",this.aha);this.detail.W("EventId",this.eventId);this.detail.W("Func",this.Dk);this.detail.W("Info",this.info);return this.detail}}Object(I.a)(m,"BasicMergeFailureDetail",e.a,[])},1458:function(I,K,e){e.d(K,"a",function(){return l});I=e(0);var m=e(622),f=e(824),a=e(1481);class l{constructor(w,z=!0){this.rn=z&&w?w.KQ():w;this.Ndc=new m.a}JO(w){this.Ndc.add(f.a.Db(w))}M6o(w){this.Ndc=
w}tjj(w){this.rn&&(new a.a(this.rn,w)).xFa.forEach((z,x)=>{x.j5&&!this.Ndc.contains(z)&&(this.Ndc.add(z),x.isDeleted?(x=this.rn,x.hasProperty(f.a.q1(z))&&x.removeProperty(f.a.q1(z))):this.rn.Agb(f.a.q1(z),x.newValue));return!0})}}Object(I.a)(l,"PartialMergeResult",null,[])},1476:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{static $sp(f){return f.toString().charCodeAt(0)}static dAn(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static iZh(f,a){if(f===a)return!0;
"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static hZh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=m.JKj(f);a=m.JKj(a);return f===a}static JKj(f){return f.replace(m.Yfd," ")}static LBb(f,a,l){return f.substring(a,a+l)}}m.Yfd=RegExp("\u00a0","g");Object(I.a)(m,"CharUtils",null,[])},1477:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.appName="AppName";m.r8="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";
m.errorMessage="ErrorMessage";m.event="Event";m.interactionId="CorrelationID";m.pgo="ParentUiElement";m.query="Input";m.R_b="QueryID";m.eDj="QueryLength";m.kxc="QueryIndex";m.wPo="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.C$j="UiElement";m.Pwe="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.Ptp="TokenAcquired";m.ZEn="LatencyType";m.groupName="GroupName";m.Qca="GroupIndex";
m.groupType="GroupType";m.rPo="ResultInfoList";m.resultType="ResultType";m.EJg="SubResultType";m.Osn="IsInputBlur";m.Psn="IsInputFocus";m.lzn="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.s4l="DwellTime";m.R9i="IsZeroTerm";m.aSp="WordsCount";m.dje="IsSearchUxEnabled";m.BAn="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.cBf="DisplayIndex";m.o6l="EnableList";m.provider="Provider";m.contentType="ContentType";m.Iyn="IsSelectionBased";m.cjl="BeginPerformanceMarker";
m.P6l="EndPerformanceMarker";m.sio="PerformanceMeasure";Object(I.a)(m,"Columns",null,[])},1478:function(I,K,e){e.r(K);e.d(K,"CommandResultsUtilityHelper",function(){return E});I=e(0);var m=e(1477),f=e(1422),a=e(1389),l=e(1479),w=e(1398),z=e(36),x=e(1390),u=e(1396),v=e(1997);class E{static P4b(y,H){if(H&&H.$t){const D={};for(const G of y)H.Ddd(G)&&(D[G]=appChrome.selectors.getModelType(G));a.TellMeActorConstants.instance.UH(D)}}static Dvb(y){const H=a.TellMeActorConstants.instance.aP();return!!H&&
H.$t&&!appChrome.selectors.isControlDisabled(y)}static Vhf(y,H,D){if(!(H&&H.results&&y&&y.results&&y.results.length))return{returnValue:!1,Rhf:y,Lif:H};const G=[];for(var J of H.results)Array.add(G,J.value);J=0;const U=0<H.results.length?H.results[0].score:0;for(const F of y.results)if(F.score>D&&!Array.contains(G,F.value)&&E.Dvb(F.value)&&(0<U&&(F.score=U),Array.insert(H.results,J,F),J++),2===J)break;return 0<J?(D=H.results.length-5,0<D&&H.Vvg(D),{returnValue:!0,Rhf:y,Lif:H}):{returnValue:!1,Rhf:y,
Lif:H}}static Atc(y,H,D,G){if(a.TellMeActorConstants.instance.gk()&&y){const J=[];for(const U of y)J.push(String.format('{{"Id":"{0}","Score":{1}}}',U.commandId,U.score));y={};y[m.a.suggestions]="[{"+J.join(",")+"}]";y[m.a.R9i]=H;y[m.a.groupType]=D;y[m.a.provider]=G;a.TellMeActorConstants.instance.gk().hE(f.a.QBl,window.performance.now(),y)}}static tTb(y,H,D,G,J,U,F,T){var Y;D.ELf&&(H=E.vum(D.ELf,H));var P=x.a.Hsm(H);E.P4b(P,D);var S=[],N=[];P=[];const V=new w.a(F);F=16===F||18===F||7===F||4===F?
z.AFrameworkApplication_AppSettingsManager.J?z.AFrameworkApplication_AppSettingsManager.J.sc("TellMeMaxRecommendedResultsToReturn",3):3:0===F||17===F||25===F?5:0;const Z=v.a.instance.GOf(),ca=x.a.pum(D);D.Wbo&&D.Ddd(ca)&&E.Dvb(ca)&&x.a.UT(y)&&!Z.N_d(ca)&&S.push(new u.a(ca,5,null,null,T));for(const X of H)if(!E.don(X.commandId)){H=E.drp(X.commandId);if(D.Ddd(X.commandId)&&!H){if(x.a.u8i(X.commandId))continue;H=null;J&&U&&(H=J.sLm(X.commandId,U));E.Dvb(X.commandId)?Array.add(S,new u.a(X.commandId,5,
H,null,T,X.score)):Array.add(N,new u.a(X.commandId,5,H,null,T,X.score))}else D.jNb&&H&&G&&Array.add(P,X.commandId.substr(21));if(S.length+P.length>=F)break}D=0;for(J=0;J<S.length&&D<F;J++,D++)V.aA(S[J]);var W=(Y=(S=null===(Y=z.AFrameworkApplication_AppSettingsManager.J)||void 0===Y?void 0:Y.getBooleanFeatureGate("Microsoft.Office.WordOnline.disabledButtonsInTellMeShouldHide",!1))?null===(W=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===W?void 0:W.getSharedUxSettings():void 0)?
Y.commonSettings:void 0;if(!S||!W||!W().shouldHideDisabledButtonsFromTellMe())for(W=0;W<N.length&&D<F;W++,D++)V.aA(N[W]);for(N=0;N<P.length&&D<F;N++,D++)G.rzq(y,P[N],V);return V}static vum(y,H){const D=[],G=[];for(const J of H){H=J.commandId;let U=J;J.commandId in y&&(H=y[J.commandId],U=new l.a(H,J.score));Array.contains(G,H)||(D.push(U),G.push(H))}return D}static don(y){E.l0h||(z.AFrameworkApplication_AppSettingsManager.J&&z.AFrameworkApplication_AppSettingsManager.J.RA("TellMeControlPredictionBlockList")&&
z.AFrameworkApplication_AppSettingsManager.J.kF("TellMeControlPredictionBlockList").forEach(H=>{Array.add(E.k0h,H.toLowerCase())}),E.l0h=!0);return Array.contains(E.k0h,y.toLowerCase())}static drp(y){return y.startsWith("btnTellMeOfficeAddIn")}static Mad(y){return 2<y.length&&";"===y.charAt(0)&&";"===y.charAt(y.length-1)&&!!z.AFrameworkApplication_AppSettingsManager.J&&(z.AFrameworkApplication_AppSettingsManager.J.$("TellMeCommandHookIsEnabled")||z.AFrameworkApplication_AppSettingsManager.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}}E.l0h=!1;E.k0h=[];Object(I.a)(E,"CommandResultsUtilityHelper",null,[])},1479:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f,a){this.commandId=f;this.score=a}}Object(I.a)(m,"CommandSuggestion",null,[])},1481:function(I,K,e){I=e(0);var m=e(373),f=e(824),a=e(277),l=e(118);class w{constructor(x,u,v){this.$Pk=x;this.oMk=u;this.JLk=v;this.RZe=new a.a(Object(l.a)(this,this.yvl,"checkIfDifferent"))}get nrg(){return this.$Pk}get oldValue(){return this.oMk}get newValue(){return this.JLk}get vvb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get j5(){return this.vvb||this.isDeleted||this.RZe.value}yvl(){return this.vvb||this.isDeleted?!0:!f.a.qZh(this.nrg,this.oldValue,this.newValue)}}Object(I.a)(w,"PropertyDiff",null,[]);e.d(K,"a",function(){return z});class z{constructor(x,u){this.lMk=x;this.GLk=u;this.RZe=new a.a(()=>this.Yad());this.bQk=
new a.a(Object(l.a)(this,this.y9l,"evaluatePropertyDiffs"))}get yx(){return this.lMk}get Xf(){return this.GLk}get vvb(){return!!this.Xf&&!this.yx}get isDeleted(){return!this.Xf&&!!this.yx}get j5(){return this.vvb||this.isDeleted||this.RZe.value}get xFa(){return this.bQk.value}Yad(x=null){let u=!1;this.xFa.forEach((v,E)=>{u=E.j5&&(!x||7!==x.K(v));return!u});return u}y9l(){const x=new m.a;var u=this.Xf,v=this.yx;if(this.vvb){v=u.Ak();for(var E=0;E<v.length;E++){var y=v[E];x.W(f.a.Db(y),new w(y,null,
u.nG(y)))}}else if(this.isDeleted)for(u=v.Ak(),E=0;E<u.length;E++)y=u[E],x.W(f.a.Db(y),new w(y,v.nG(y),null));else{E=v.Ak();for(y=0;y<E.length;y++){var H=E[y],D=f.a.Db(H),G=v.nG(H);const J=u.hasProperty(H)?u.nG(H):null;x.W(D,new w(H,G,J))}E=u.Ak();for(y=0;y<E.length;y++)H=E[y],v.hasProperty(H)||(D=f.a.Db(H),G=u.nG(H),x.W(D,new w(H,null,G)))}return x}}Object(I.a)(z,"MergeableObjectDiff",null,[])},1495:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);var m=e(49);class f{constructor(){this.cp=
0;this.id=m.a.create()}}Object(I.a)(f,"LcsUpdateHint",null,[917,222])},1496:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.Pv="TellMe";m.KOn="Loki";m.T3j="Substrate";m.kxc="QueryIndex";m.F5j="TellMeRanker";m.G5j="TellMeRankerLogging";Object(I.a)(m,"Services",null,[])},1497:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.VYa="HttpRequest";m.provider="Provider";Object(I.a)(m,"LatencyTypes",null,[])},1504:function(I,K,e){I=e(0);var m=e(61),f=e(13),a=e(5),l=e(33),
w=e(231),z=e(185),x=e(226),u=e(49),v=e(622),E=e(118),y=e(247),H=e(1535);class D extends H.a{constructor(){super();this.oE=null}get aha(){return"CreateMergeBlock"}BSb(){this.detail.W("Type",this.aha);this.detail.W("Revision",this.oE);return this.detail}}Object(I.a)(D,"CreateMergeBlockFailureDetail",H.a,[]);var G=e(1600),J=e(1602),U=e(1727),F=e(1536),T=e(1458),Y=e(1794),P=e(592);e.d(K,"a",function(){return S});class S{static g1d(N,V,Z,ca,W,X,ka){let ma;ma="";const ja=new w.a;for(let Ba=0;Ba<Z.length;Ba++){var na=
void 0;let Ma;na=G.a.Lum(V,Z.K(Ba),ca,W,X,ka,N);if(!na)return{returnValue:null,Rdb:ma};({tbg:Ma,Rdb:na}=na.hHi());if(!Ma)return{returnValue:null,Rdb:ma};ma+=na;ja.PC(ja.length,Ma)}return{returnValue:ja,Rdb:ma}}static Sei(N,V,Z,ca,W,X,ka,ma){let ja,na,Ba,Ma,Ea,ya;ya=Ea=Ma=Ba=na=ja=null;({Rdb:Ma,returnValue:ja}=S.g1d(V,ia=>N.runtime.Ao.K(ia),Z,1,X,ka,ma));if(!ja)return z.a.instance.fb(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
N.logger.mj(Object.assign(new D,{oE:"Base"})),{returnValue:!1,NO:ja,d3c:na,ewd:Ba,KWd:Ma,Y5d:Ea,YHe:ya};({Rdb:Ea,returnValue:na}=S.g1d(V,ia=>N.runtime.BC.K(ia)||N.runtime.Ao.K(ia),ca,2,X,ka,ma));if(!na)return z.a.instance.fb(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),N.logger.mj(Object.assign(new D,{oE:"Favored"})),{returnValue:!1,NO:ja,d3c:na,ewd:Ba,KWd:Ma,Y5d:Ea,YHe:ya};({Rdb:ya,returnValue:Ba}=
S.g1d(V,ia=>N.runtime.Pw.K(ia)||N.runtime.Ao.K(ia),W,4,X,ka,ma));return Ba?{returnValue:!0,NO:ja,d3c:na,ewd:Ba,KWd:Ma,Y5d:Ea,YHe:ya}:(z.a.instance.fb(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),N.logger.mj(Object.assign(new D,{oE:"Unfavored"})),{returnValue:!1,NO:ja,d3c:na,ewd:Ba,KWd:Ma,Y5d:Ea,YHe:ya})}static t9h(N,V=!1){const Z=new w.a;let ca=0;for(;ca<N.length;){var W=N.K(ca);if(1===W.type||
4===W.type||2===W.type)Z.add(W),ca++;else if(3===W.type){let ka="";ka+=W.character;ca++;let ma=W.VZa,ja=!1;for(;ca<N.length;ca++){var X=N.K(ca);3===X.type?W.runId===X.runId&&W.mN.equals(X.mN)&&(W.Bha===X.Bha||W.XMa===X.XMa)&&W.$B.aE(X.$B)&&(!V||W.gx&&W.gx.equals(X.gx))?(ka+=X.character,X.VZa&&(ma=!0)):ja=!0:ja=!0;if(ja){W=new Y.a(null,W.source,W.$k,W.Eg,W.runId,W.mN,ka,W.Xxb,!0,ma,W.Bha,W.XMa,W.a1a,W.$B,W.gx);Z.add(W);break}}}}z.a.instance.fb(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
Z.Bt());return Z}static GBl(N,V=!1){const Z=new w.a;let ca=0;for(;ca<N.length;){var W=N.K(ca);if(1===W.type||4===W.type||2===W.type)Z.add(W),ca++;else if(3===W.type){let ka=W.character.toString();ca++;let ma=W.VZa;for(;ca<N.length;ca++){var X=N.K(ca);if(3===X.type&&S.aap(W,X,V))ka+=X.character,X.VZa&&(ma=!0);else break}W=new Y.a(null,W.source,W.$k,W.Eg,W.runId,W.mN,ka,W.Xxb,!0,ma,W.Bha,W.XMa,W.a1a,W.$B,W.gx);Z.add(W)}}z.a.instance.fb(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
Z.Bt());return Z}static aap(N,V,Z){return N.runId===V.runId&&N.mN.equals(V.mN)&&(N.Bha===V.Bha||N.XMa===V.XMa)&&N.$B.aE(V.$B)&&(!Z||!!N.gx&&N.gx.equals(V.gx))}static x4o(N,V,Z,ca,W,X,ka,ma,ja,na,Ba,Ma,Ea,ya,ia,za){N.setPropertyString(Z.rn,f.a.so,W);N.setPropertyUint32(Z.rn,a.a.qd,ca);N.setPropertyUint32s(Z.rn,a.a.qU,X);N.setPropertyUint32s(Z.rn,a.a.A2,ka);N.setPropertyObjectIds(Z.rn,f.a.Qq,ja);N.hasProperty(Z.rn,a.a.kk)&&N.setPropertyUint32(Z.rn,a.a.kk,S.llm());V&&V(8)&&N.setPropertyObjectIds(Z.rn,
a.a.vy,za);ca=!1;for(W=0;W<na.length;W++)if(na.K(W)){ca=!0;break}ca&&N.setPropertyBools(Z.rn,a.a.Dfg,na);S.Ppl(V,N,Z,Ba,Ma,Ea,ya);S.Qpl(N,Z,ia);Z.JO(f.a.so);Z.JO(a.a.qd);Z.JO(a.a.qU);Z.JO(a.a.A2);Z.JO(f.a.Qq);Z.JO(a.a.Dfg);Z.JO(f.a.sw);Z.JO(f.a.ABb);Z.JO(a.a.DYa);Z.JO(a.a.zPa);Z.JO(f.a.PEa);Z.JO(a.a.vy);N.hasProperty(Z.rn,a.a.kk)&&Z.JO(a.a.kk);0<ma.length?N.setPropertyUint32s(Z.rn,f.a.sw,ma):Z.rn.removeProperty(f.a.sw)}static Ppl(N,V,Z,ca,W,X,ka){if(N(93)){N=ca.contains(!0,(ma,ja)=>ja);S.NDg(V,Z,
f.a.PEa,N?ca:null);S.NDg(V,Z,f.a.ABb,S.lMj(ca,W));S.NDg(V,Z,a.a.DYa,S.lMj(ca,X));ca=!1;for(W=0;W<ka.length;W++)0!==ka.K(W)&&(ca=!0);ca?V.setPropertyUint32s(Z.rn,a.a.zPa,ka):Z.rn.removeProperty(a.a.zPa)}}static Qpl(N,V,Z){const ca=ka=>ka;var W=Object(E.a)(N,N.setPropertyBools,"setPropertyBools");S.dWa(V,Z.lvb,ca,W,a.a.wNa);S.dWa(V,Z.crb,ca,W,a.a.Qma);S.dWa(V,Z.cfb,ca,W,a.a.yPa);W=ka=>0<ka.length;var X=Object(E.a)(N,N.setPropertyStrings,"setPropertyStrings");S.dWa(V,Z.kvb,W,X,a.a.xNa);S.dWa(V,Z.brb,
W,X,a.a.DLa);S.dWa(V,Z.ozb,W,X,a.a.bRa);W=ka=>!!ka;X=Object(E.a)(N,N.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");S.dWa(V,Z.mvb,W,X,a.a.yNa);S.dWa(V,Z.h$a,W,X,a.a.ELa);S.dWa(V,Z.qzb,W,X,a.a.cRa);W=ka=>!!ka;X=Object(E.a)(N,N.z4o,"setPropertyList");S.Spf(V,Z.kZa,W,X,l.a.lZa);S.Spf(V,Z.cQb,W,X,l.a.VWa);S.Spf(V,Z.w_b,W,X,l.a.h3a);Z.cfb.any(ca)?S.dWa(V,Z.pzb,()=>!0,Object(E.a)(N,N.setPropertyObjectIds,"setPropertyObjectIds"),a.a.MGa):V.rn.removeProperty(a.a.MGa)}static lMj(N,V){const Z=
new w.a;let ca=!1;for(let W=0;W<N.length;W++){const X=V.K(W)&&!N.K(W);Z.add(X);ca=X||ca}return ca?Z:null}static NDg(N,V,Z,ca){ca?N.setPropertyBools(V.rn,Z,ca):V.rn.removeProperty(Z)}static llm(){return x.a.BG()}static hIi(N,V){return N.runtime.BC.R4(V,N.runtime.Ao.K(V)||N.runtime.Pw.get(V))}static G6c(N,V,Z,ca,W){let X;X=new w.a;const ka=!!Z&&Z(8),ma=!!Z&&Z(110);if(N.runtime.Dc.isFeatureEnabled(69)){var ja=S.GBl(ca,ka);var na=S.t9h(ca,ka);ja.length!==na.length&&N.runtime.Dc.bJ(69)}else ja=S.t9h(ca,
ka);na=0;let Ba="",Ma=new w.a,Ea=new w.a,ya=new w.a,ia=new w.a,za=new w.a,Ca=new w.a,db=new w.a,pa=new w.a,ua=new w.a;const Ga=new U.a;let wa=new w.a;var xa=ja.K(ja.length-1);if(2!==xa.type&&4!==xa.type)return z.a.instance.fb(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",xa.type),N.logger.mj(Object.assign(new F.a,{Dk:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",
xa.type)})),{returnValue:!1,jte:X};var sa=0;for(xa=0;xa<ja.length;xa++){var Ka=ja.K(xa),Na=null;if(1===Ka.type||3===Ka.type)Na=Ka,Ba+=Na.text;else if(4===Ka.type){Ka=S.hIi(N,Ka.$k);Ka=new T.a(Ka);X.add(Ka);continue}Na?(Ma.add(Na.runId),Ea.add(Na.Eg),sa+=Na.text.length,ya.add(sa),ia.add(Na.mN),za.add(Na.Xxb),Ca.add(Na.VZa),db.add(Na.Bha),pa.add(Na.XMa),ua.add(Na.a1a),Ga.lvb.add(Na.$B.y4m),Ga.crb.add(Na.$B.Y3m),Ga.cfb.add(Na.$B.e5m),Ga.kvb.add(Na.$B.nvb.author),Ga.brb.add(Na.$B.drb.author),Ga.ozb.add(Na.$B.xPa.author),
Ga.mvb.add(Na.$B.nvb.Dgd),Ga.h$a.add(Na.$B.drb.Dgd),Ga.qzb.add(Na.$B.xPa.Dgd),Ga.pzb.add(Na.$B.xPa.Upg),ma&&(Ga.kZa.push(new P.a(!1,"",null,null!=Na.$B.nvb.zOa?V.ICg(Na.$B.nvb.zOa):null)),Ga.kZa.push(new P.a(!1,"",null,null!=Na.$B.drb.zOa?V.ICg(Na.$B.drb.zOa):null)),Ga.kZa.push(new P.a(!1,"",null,null!=Na.$B.xPa.zOa?V.ICg(Na.$B.xPa.zOa):null))),ka&&wa.add(Na.gx)):Ma.length||(Ma.add(0),Ea.add(0),ya.add(0),ia.add(u.a.nil),za.add(!1),Ca.add(!1),db.add(!1),pa.add(!1),ua.add(0),Ga.lvb.add(!1),Ga.crb.add(!1),
Ga.cfb.add(!1),Ga.kvb.add(""),Ga.brb.add(""),Ga.ozb.add(""),Ga.mvb.add(0),Ga.h$a.add(0),Ga.qzb.add(0),Ga.pzb.add(u.a.nil),ma&&(Ga.kZa.push(new P.a(!1,"",null,null)),Ga.cQb.push(new P.a(!1,"",null,null)),Ga.w_b.push(new P.a(!1,"",null,null))));if(2===Ka.type){sa=Ka;Ka=sa.qd;ya.VJ(ya.length-1);Na=W.K(na);if(!Na)return z.a.instance.fb(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
na,W.length,ca.length,xa,ja.length),N.logger.mj(Object.assign(new F.a,{Dk:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),z.a.instance.nqa(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",W.Bt()),z.a.instance.nqa(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",ca.Bt()),z.a.instance.nqa(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ja.Bt()),{returnValue:!1,jte:X};if(Na=S.hIi(N,Na))Na=new T.a(Na.KQ()),S.x4o(V,Z,Na,
sa.qd,Ba,Ma,Ea,ya,ia,za,Ca,db,pa,ua,Ga,wa),X.add(Na);z.a.instance.fb(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",sa.$k,Ka,Ma.Bt(),Ea.Bt(),ya.Bt(),Ca.Bt(),db.Bt(),pa.Bt(),ia.Bt(),"",ua.Bt());na++;Ba="";Ma=new w.a;Ea=new w.a;ya=new w.a;ia=new w.a;za=new w.a;Ca=new w.a;db=new w.a;pa=new w.a;ua=new w.a;Ga.reset();sa=
0;wa=new w.a}}return{returnValue:!0,jte:X}}static lOo(N,V){const Z=N.runtime.ks.K(y.a.NP),ca=V.getPropertyObjectIds(Z.rn,a.a.t_);for(let W=0;W<ca.length;W++)N.runtime.ks.remove(ca.K(W));V.setPropertyObjectIds(Z.rn,a.a.t_,new w.a);V.setPropertyString(Z.rn,a.a.VGa,u.a.nil.toString());Z.JO(a.a.t_);Z.JO(a.a.VGa)}static ifn(N,V){if(N.runtime.ks.Bb(y.a.NP))return null;const Z=new T.a(N.runtime.Ao.K(y.a.NP).KQ());V.setPropertyString(Z.rn,a.a.VGa,N.output.QN.last().id.toString());V.setPropertyObjectIds(Z.rn,
a.a.t_,new w.a);Z.JO(a.a.t_);Z.JO(a.a.VGa);N.runtime.ks.W(y.a.NP,Z);return Z}static POf(N){const V=new w.a;N.forEach(Z=>{V.add(Z.id);return!0});return V}static Dtc(N,V,Z,ca){let W=0;Z.forEach(X=>{J.a(X,V+W++,1);X.yc===m.a.paragraphNode&&N.getPropertyObjectIds(X,f.a.Qq).forEach(ka=>{ca.add(ka);return!0});return!0})}static eLn(N,V){const Z=new v.a;let ca=0;V.forEach(W=>{if(Z.contains(W))return!0;Z.add(W);if(({index:ca}=S.R9f("BaseFormatting_",ca,W,X=>N.runtime.Ao.K(X))).returnValue||({index:ca}=S.R9f("FavoredFormatting_",
ca,W,X=>N.runtime.BC.K(X))).returnValue||({index:ca}=S.R9f("ConflictingFormatting_",ca,W,X=>N.runtime.Pw.K(X))).returnValue)return!0;ca++;return!0})}static R9f(N,V,Z,ca){if(Z=ca(Z))if(J.a(Z,N+V,1),Z.yc===m.a.q2a)return V++,{returnValue:!0,index:V};return{returnValue:!1,index:V}}static KBf(N){return!!N.runtime.Ao.K(y.a.NP)}static dWa(N,V,Z,ca,W){V.any(Z)?(ca(N.rn,W,V),N.JO(W)):N.rn.removeProperty(W)}static Spf(N,V,Z,ca,W){V.some(Z)?(ca(N.rn,W,V),N.JO(W)):N.rn.removeProperty(W)}static mVj(N,V){const Z=
new w.a;Z.add(0);const ca=N?N.length:0;for(let W=0;W<ca;W++)Z.insert(W+1,N.Lg(W));Z.insert(Z.length,V);return Z}}Object(I.a)(S,"ParagraphMergeUtils",null,[])},1533:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);var m=e(231);class f{constructor(a,l,w){this.wo=null;this.wl=a;this.source=l;this.$k=w}get type(){return this.wl}get jhb(){return!1}get srn(){return 1===(this.source&1)}get trn(){return 2===(this.source&2)}get urn(){return 4===(this.source&4)}C9(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.xpm(),this.Mlc())}xpm(){let a="";this.srn&&(a+="Base");this.trn&&(a+="FavoredUpdate");this.urn&&(a+="UnfavoredUpdate");return a}Mlc(){return""}aE(a){return this.type===a.type}wtd(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(I.a)(f,"AMergeBlock",null,[44,45])},1534:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1533);class m extends e.a{constructor(f,a,l){super(2,f,a);this.qd=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.qd,this.$k)}Mlc(){return"Eop"}clone(){return new m(this.source,this.$k,this.qd)}aE(f,a,l,w=!1,z=!0){return super.aE(f,a,l,w)?z?f.qd===this.qd:f.$k===this.$k&&f.qd===this.qd:!1}get length(){return 1}}Object(I.a)(m,"EopMergeBlock",e.a,[])},1535:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);var m=e(373);class f{constructor(){this.detail=new m.a}}Object(I.a)(f,"AMergeFailureDetail",null,[896])},1536:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1457);class m extends e.a{constructor(){super()}get aha(){return"ParagraphMerge"}}
Object(I.a)(m,"ParagraphMergeFailureDetail",e.a,[])},1537:function(I,K,e){e.d(K,"b",function(){return w});e.d(K,"a",function(){return x});var m=e(231),f=e(373),a=e(622),l=e(1728);const w=(v,E,y)=>{const H=z(v,E,y);let D=0,G=0,J=0,U=new l.a;const F=new m.a;for(let T=0;T<H.length;T++){const Y=H.Lg(T+1);U.MVd(v.Lg(D));U.OVd(E.Lg(G));U.SVd(y.Lg(J));D++;G++;for(J++;D<v.length&&(!Y||!Y.equals(v.Lg(D)));)U.MVd(v.Lg(D)),D++;for(;G<E.length&&(!Y||!Y.equals(E.Lg(G)));)U.OVd(E.Lg(G)),G++;for(;J<y.length&&(!Y||
!Y.equals(y.Lg(J)));)U.SVd(y.Lg(J)),J++;F.add(U);U=new l.a}for(;D<v.length;)U.MVd(v.Lg(D)),D++;for(;G<E.length;)U.OVd(E.Lg(G)),G++;for(;J<y.length;)U.SVd(y.Lg(J)),J++;U.isEmpty||F.add(U);return F},z=(v,E,y)=>{const H=new m.a,D=E.FU(),G=y.FU();v.forEach(J=>{D.contains(J)&&G.contains(J)&&H.add(J);return!0});return H},x=(v,E,y)=>{v=v||new m.a;E=E||new m.a;y=y||new m.a;const H=new m.a,D=new f.a(0),G=new a.a;for(var J=0;J<v.length;J++){var U=v.Lg(J);D.W(U,J)}for(v=J=0;J<E.length&&v<y.length;){U=E.Lg(J);
let F=y.Lg(v),T=D.R4(U,-1),Y=D.R4(F,-1);-1===T?(u(G,H,U),J++):-1===Y?(u(G,H,F),v++):T===Y?(u(G,H,U),J++,v++):T<Y?J++:v++}for(;J<E.length;J++)U=E.Lg(J),-1===D.R4(U,-1)&&u(G,H,U);for(;v<y.length;v++)E=y.Lg(v),-1===D.R4(E,-1)&&u(G,H,E);return H},u=(v,E,y)=>{v.contains(y)||(E.add(y),v.add(y))}},1538:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1457);class m extends e.a{constructor(){super()}get aha(){return"RdOpLcs"}}Object(I.a)(m,"ReducedOpsLcsFailureDetail",e.a,[])},1545:function(I,K,
e){I=e(0);class m{constructor(){this.tokenFilter=this.I$c=null;this.cbg=this.score=this.agd=0}nng(H,D,G){this.score=H.K(D);++D;this.I$c=H.K(D)?G.Fua(H.K(D)):null;++D;this.tokenFilter=H.K(D)?G.Fua(H.K(D)):null;++D;this.agd=H.K(D);++D;this.cbg=H.K(D);++D;return D}}Object(I.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(H,D,G,J,U){this.rsb=H;this.count=D;this.V6d=G;this.hT=J;this.depth=U}}Object(I.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=e(1631),l=e(1748);class w{constructor(H=null,
D=0,G=0,J=0){this.kXk=H||new l.a;this.SCa=D;this.hT=G;this.depth=J}get Q$(){return this.kXk}getKey(){return this.Q$.ZA.toString()+":"+this.SCa.toString()}}Object(I.a)(w,"TrieBookmark",null,[]);class z{constructor(H,D){this.L_a=H;this.cag=D}LOn(H){if(null==H)throw Error.argumentNull("prefix");let D={};var G=D[""]=new w;this.dee(G,D);for(G=0;G<H.length;++G){const J=H.charCodeAt(G),U={};for(let F in D)this.l$k(J,D[F],U);D=U}return this.Jvp(D)}dee(H,D){if(!(H.hT>=this.cag)&&(H=new w(a.a.wsf(H.Q$),H.SCa,
H.hT+1,H.depth),H.Q$.sJ&a.a.Cib&&(H.SCa+=1),this.L_a.z4b(H.Q$))){H.depth+=1;let G=!0;for(;G;)z.HIe(H,D),this.dee(H,D),H.SCa+=this.L_a.Zlc(H.Q$,!0)+(H.Q$.sJ&a.a.Cib?1:0),G=this.L_a.Bvd(H.Q$)}}l$k(H,D,G){D.hT+1<=this.cag&&(D.hT+=1,z.HIe(D,G),--D.hT);D.Q$.sJ&a.a.Cib&&(D.SCa+=1);if(this.L_a.z4b(D.Q$)){D.depth+=1;let J=!0;for(;J;)D.Q$.G5b===H?(z.HIe(D,G),this.dee(D,G)):D.hT+1<=this.cag&&(D.hT+=1,z.HIe(D,G),this.dee(D,G),--D.hT),D.SCa+=this.L_a.Zlc(D.Q$,!0)+(D.Q$.sJ&a.a.Cib?1:0),J=this.L_a.Bvd(D.Q$)}}Jvp(H){const D=
[];for(var G in H){const J=H[G];if(!J.Q$.ZA)continue;const U=!!(J.Q$.sJ&a.a.Cib),F=this.L_a.Zlc(J.Q$,!1)+(U?1:0);Array.add(D,new f(J.SCa,F,U,J.hT,J.depth))}D.sort((J,U)=>{let F=J.rsb-U.rsb;return F||(F=-(J.count-U.count))?F:F=J.depth-U.depth});if(2>D.length)return D;H=[];for(G=0;G<D.length;)G+=z.h8j(G,D,H);return H}static HIe(H,D){const G=H.getKey();G in D?(D=D[G],D.hT=Math.min(D.hT,H.hT)):D[G]=new w(a.a.wsf(H.Q$),H.SCa,H.hT,H.depth)}static h8j(H,D,G){const J=D[H];let U=J.rsb;const F=U+J.count;let T=
1,Y=J.V6d;for(;H+T<D.length&&D[H+T].rsb<F;){const P=D[H+T];P.rsb>U&&(Array.add(G,new f(U,P.rsb-U,Y,J.hT,J.depth)),Y=!1);T+=z.h8j(H+T,D,G);U=P.rsb+P.count}U<F&&Array.add(G,new f(U,F-U,Y,J.hT,J.depth));return T}}Object(I.a)(z,"ErrorTolerantTrieLookupEngine",null,[2051]);class x extends m{constructor(H,D,G){super();this.IVi=this.fvj=!1;this.Cqi=null;if(H){var J=0;try{J=this.nng(H,J,D);this.fvj=1===H.K(J);++J;this.IVi=1===H.K(J);++J;const U=H.K(J);this.Cqi=this.Hgo(G,U)}catch(U){throw Error.argument("initData");
}}}Hgo(H,D){return new z(H,D)}}Object(I.a)(x,"FuzzyMatchTokenStringGeneratorInit",m,[]);class u extends m{constructor(H,D){super();this.query=this.name=null;if(H){this.annotations=D.annotations;var G=0;try{G=this.nng(H,G,D),this.name=D.lF(H.K(G)),++G,this.query=D.$O(H.K(G))}catch(J){throw Error.argument("initData");}}}}Object(I.a)(u,"QueryTokenStringGeneratorInit",m,[]);class v extends m{constructor(H,D){super();if(H)try{this.nng(H,0,D)}catch(G){throw Error.argument("initData");}}}Object(I.a)(v,"SurfaceStringTokenStringGeneratorInit",
m,[]);var E=e(1436);e.d(K,"a",function(){return y});class y{constructor(H){this.T$f=H}get I$c(){return this.T$f.I$c}get tokenFilter(){return this.T$f.tokenFilter}get agd(){return this.T$f.agd}static create(H,D,G){const {SurfaceStringTokenStringGenerator:J}=e(1925),{QueryTokenStringGenerator:U}=e(1926),{FuzzyMatchTokenStringGenerator:F}=e(1927);let T=0;try{if(H.K(T)!==y.WNb)throw Error.argument("initData","Input does not represent a token string generator");++T;const Y=H.K(T);++T;const P=new E.a;P.Dsb(H,
T,H.count-T);switch(Y){case J.sXc:return new J(new v(P,D));case U.sXc:return new U(new u(P,D));case F.sXc:return new F(new x(P,D,G));default:throw Error.argument("initData");}}catch(Y){throw Error.argument("initData");}}static bUh(H,D,G,J,U,F){H=H.Utp.getId(D,null);if(0>H)return++F,F;y.cUh(H,G,J,U);return F}static cUh(H,D,G,J){Array.add(J.qJg,H);Array.add(J.B3j,D);++J.TCc[G]}}y.WNb=1099767983;Object(I.a)(y,"TokenStringGenerator",null,[2047])},1599:function(I,K,e){e.d(K,"a",function(){return a});I=
e(0);var m=e(231);K=e(1533);var f=e(1476);class a extends K.a{constructor(l,w,z){super(l,w,z)}ljp(l){let w;w=null;if(!this.text||!this.jhb||0>=l||l>=this.length)return{returnValue:!1,T1j:w};w=new m.a;const z=this.clone();z.bsd(f.a.LBb(this.text,0,l));const x=this.clone();x.bsd(f.a.LBb(this.text,l,this.length-l));w.add(z);w.add(x);return{returnValue:!0,T1j:w}}C9(){return!0}get length(){return this.text.length}}Object(I.a)(a,"ATextMergeBlock",K.a,[])},1600:function(I,K,e){e.d(K,"a",function(){return a});
I=e(0);var m=e(61),f=e(185);class a{olf(l,w){return l+("[Block: "+w+"] ")}static Lum(l,w,z,x,u,v,E){const {ParagraphMergeBlockCreator:y}=e(2010),{TableMergeBlockCreator:H}=e(2016);if(w.yc===m.a.paragraphNode)return new y(l,w,z,u,v,x(8),E,x(110));if(w.yc===m.a.Fq)return new H(w,z);f.a.instance.fb(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",w.yc);return null}}Object(I.a)(a,"MergeBlockCreator",null,[])},1601:function(I,K,e){e.d(K,"a",function(){return w});I=e(0);var m=
e(61),f=e(5),a=e(49);K=e(1599);var l=e(1481);class w extends K.a{constructor(z,x,u,v,E,y,H,D,G,J,U,F,T,Y){super(x,u,v);this.Eg=E;this.runId=y;this.Xxb=D;this.sCk=H;this.DNe=z;this.VZa=G;this.Bha=J;this.XMa=U;this.a1a=F;this.$B=T;this.gx=Y}get JVc(){return this.DNe}get mN(){return this.sCk}get TRb(){return this.JVc(this.mN)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Eg,this.runId,this.Xxb,
this.$k,this.mN.toString(),this.gx?this.gx.toString():"NULL")}aE(z,x,u,v=!1){if(!super.aE(z,x,u,v))return!1;if(v)return!0;if(!this.$B.aE(z.$B)||this.gx&&!this.gx.equals(z.gx))return!1;if(this.mN.equals(z.mN)||this.mN.equals(a.a.nil)||z.mN.equals(a.a.nil))return!0;z=new l.a(this.TRb,z.TRb);x=x.tei(this.TRb,u);return z.Yad(x.Tue)?!1:!0}get Wln(){return this.C9()&&"\ufffc"===this.text&&this.TRb?this.TRb.hasProperty(f.a.gu)||this.TRb.yc!==m.a.Yyb?!0:!1:!1}}Object(I.a)(w,"AUserRunMergeBlock",K.a,[])},
1602:function(I,K,e){e.d(K,"a",function(){return f});var m=e(185);const f=(a,l,w=4)=>{a?m.a.instance.nqa(4273285,w,4,l,a.OCc()):m.a.instance.fb(4293845,w,1,l,"{0}: Node was null.",l)}},1603:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1396);class m extends e.a{constructor(f,a,l,w,z=null){super(f,a,z,null,l);this.id=w}}Object(I.a)(m,"TryQueryResultBinding",e.a,[])},1604:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f){this.Kb=f}get ieb(){return this.Kb.ieb}get Dnp(){return 4!==
this.Kb.style}get Fnp(){return!0}get trie(){return this.Kb.trie}getId(f,a){if(!this.Dnp)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Kb.style){case 0:return this.rCm(f,a);default:throw Error.notImplemented();}}lF(f){if(!this.Fnp)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.ieb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Kb.style){case 0:return this.wSm(f);case 4:return this.vSm(f);
default:throw Error.notImplemented();}}rCm(f,a){f=this.Kb.trie.cgj(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.iDc||f.iDc>=this.Kb.ieb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Kb.Cvd?this.Kb.Qmd.ZB(this.Kb.Cvd+4*f.iDc,4):f.iDc}wSm(f){if(this.Kb.Cvd){let a=0;for(;a<this.Kb.ieb&&this.Kb.Qmd.ZB(this.Kb.Cvd+4*a,4)!==f;++a);if(a>=this.Kb.ieb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Kb.trie.CMi(a)}return this.Kb.trie.CMi(f)}vSm(f){const a=
this.Kb.Qmd.ZB(this.Kb.y3j+4*f,4);f=this.Kb.Qmd.ZB(this.Kb.z3j+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let w=0;w<a;++w)l[w]=({e$m:f}=this.Zvo(f)).returnValue;return String.fromCharCode.apply(null,l)}Zvo(f){let a=0;for(let l=0;3>l;++l){const w=this.Kb.Qmd.K(this.Kb.I5h+f)^182;++f;a|=(w&127)<<7*l;if(!(w&128))break}return{returnValue:a,e$m:f}}}Object(I.a)(m,"StringTable",null,[2034])},1605:function(I,K,e){e.d(K,"a",function(){return f});
I=e(0);var m=e(1631);class f{constructor(a){this.trie=null;this.I5h=this.y3j=this.z3j=this.Cvd=0;if(a){this.Qmd=a;var l=0;if(a.ZB(l,4)!==f.WNb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.ieb=a.ZB(l,4);l+=4;this.style=a.ZB(l,4);l+=4;switch(this.style){case 0:const w=1===a.ZB(l,4);l+=4;w||(this.Cvd=l,l+=4*this.ieb);a.ZB(l,4);this.trie=this.jho(a,l+4);break;case 4:this.z3j=l;this.y3j=l+=4*this.ieb;l+=4*this.ieb;a.ZB(l,4);this.I5h=l+4;break;default:throw Error.argument("bytes");
}}}jho(a,l){return new m.a(a,l)}}f.WNb=1025118440;Object(I.a)(f,"StringTableInit",null,[])},1606:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.hjk=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.Vqk=3]="WolframAnswer";f[f.pjk=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.fqk=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HVp=9]="HelpAction";f[f.imk=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";
f[f.pVp=13]="FirstRunResult";f[f.KWp=14]="NoCommandsFoundResult";f[f.Tpk=15]="TestResult";f[f.uTp=16]="AppsForOffice_Installed";f[f.wTp=17]="AppsForOffice_Recommandation";f[f.vTp=18]="AppsForOffice_Query";f[f.PWp=19]="Notes_Onenote";f[f.QWp=20]="Notes_Samsung";f[f.RWp=21]="Notes_Sticky";f[f.Tmk=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.Yik=25]="ActionAI";f[f.Zik=26]="ActionAICommand";f[f.fjk=27]="Addin";f[f.Unk=28]="OfficeScript";f[f.gjk=29]="AddinStoreEntry";f[f.AVp=
30]="GenerateSlides";f[f.mpk=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(m||(m={}));Object(I.b)("ResultType",m)},1629:function(I,K,e){I=e(0);var m=e(5),f=e(622),a=e(185),l=e(231),w=e(49),z=e(373),x=e(87),u;(function(Wa){Wa[Wa.none=0]="none";Wa[Wa.ygd=1]="mergeConflict";Wa[Wa.Z2p=2]="containerBaseIdValidationFailure";Wa[Wa.e8p=3]="failedToApplyHints";Wa[Wa.zJe=4]="validateUpdateHintsAreComplete";Wa[Wa.other=5]="other"})(u||(u={}));Object(I.b)("ParagraphMergeUsingHintsFailureReason",u);var v=e(1059),
E=e(247),y=e(743);const H=Wa=>{const Ja=new l.a;Wa.forEach(Va=>{Ja.add(Va);return!0});return Ja};var D=e(1534),G=e(1537),J=e(1538);const U=(Wa,Ja)=>{if(Wa.length!==Ja.length)return!1;for(let Va=0;Va<Wa.length;Va++)Wa.K(Va).wo=Ja.K(Va),Ja.K(Va).wo=Wa.K(Va);return!0},F=(Wa,Ja,Va)=>{let mb,Ab,Xb;mb=0;Ab=!1;Xb=0;var Lb;if(!({idx:Lb}=N(Wa,Ja)).returnValue)return a.a.instance.fb(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Ja,Wa.Bt()),{returnValue:!1,
f8c:mb,Uxb:Ab,bhd:Xb};if(!Va&&2===Wa.K(Lb).type)return{returnValue:!0,f8c:Lb,Uxb:Ab,bhd:Xb};if(!Wa.K(Lb).C9())return a.a.instance.fb(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Lb,Va,Wa.Bt()),{returnValue:!1,f8c:mb,Uxb:Ab,bhd:Xb};let dc=!1,yc=0;for(;Lb<Wa.length&&Wa.K(Lb).$k.equals(Ja);Lb++){if(Va===yc){dc=!0;break}if(Va>yc&&Va<yc+Wa.K(Lb).length){Ab=dc=!0;Xb=Va-yc;break}yc+=Wa.K(Lb).length}dc||Va!==yc||(dc=!0);dc&&(mb=
Lb);return{returnValue:dc,f8c:mb,Uxb:Ab,bhd:Xb}},T=(Wa,Ja,Va)=>{let mb,Ab,Xb;Xb=Ab=0;mb=!1;let Lb=0,dc=!1;for(;Ab<Wa.length;Ab++){if(Ja===Lb){dc=!0;break}if(Ja>Lb&&Ja<Lb+Wa.K(Ab).length){mb=dc=!0;Xb=Ja-Lb;break}Lb+=Wa.K(Ab).length}dc||Ja!==Lb||(dc=!0);dc||(Wa=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Wa.length,Lb,Ja),a.a.instance.fb(573178201,1,2,Wa),Va.mj(Object.assign(new J.a,{eventId:"8k6fz",info:Wa})));return{returnValue:dc,Uxb:mb,i0h:Ab,h0h:Xb}},
Y=(Wa,Ja,Va)=>{let mb;if(Wa.K(Ja).C9()&&({T1j:mb}=Wa.K(Ja).ljp(Va)).returnValue)return Wa.PC(Ja+1,mb),Wa.VJ(Ja),!0;a.a.instance.fb(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ja,Va,Wa.Bt());return!1},P=(Wa,Ja,Va)=>{let mb,Ab;if(!({f8c:Va,Uxb:Ab,bhd:mb}=F(Wa,Ja,Va)).returnValue)return{returnValue:!1,index:0};if(!Ab)return{returnValue:!0,index:Va};if(Y(Wa,Va,mb))return{returnValue:!0,index:Va+1};a.a.instance.fb(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
Ja,mb,Wa.Bt());return{returnValue:!1,index:0}},S=(Wa,Ja,Va)=>{let mb;if(!({Uxb:mb,i0h:Ja,h0h:Va}=T(Wa,Ja,Va)).returnValue)return{returnValue:!1,index:0};if(!mb)return{returnValue:!0,index:Ja};if(Y(Wa,Ja,Va))return{returnValue:!0,index:Ja+1};a.a.instance.fb(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Va,Wa.Bt());return{returnValue:!1,index:0}},N=(Wa,Ja)=>{let Va;Va=0;for(let mb=0;mb<Wa.length;mb++)if(Wa.K(mb).$k.equals(Ja))return Va=mb,{returnValue:!0,
idx:Va};a.a.instance.fb(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Ja,Wa.Bt());return{returnValue:!1,idx:Va}},V=(Wa,Ja)=>{let Va;Va=-1;for(let mb=Ja;mb<Wa.length;mb++)if(2===Wa.K(mb).type)return Va=mb,{returnValue:!0,dna:Va};a.a.instance.fb(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Ja,Wa.Bt());return{returnValue:!1,dna:Va}},Z=(Wa,Ja,Va)=>{let mb;mb=-1;for(let Ab=Va;Ab<Wa.length;Ab++)if(2===
Wa.K(Ab).type&&Wa.K(Ab).$k.equals(Ja))return mb=Ab,{returnValue:!0,dna:mb};a.a.instance.fb(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Ja,Va,Wa.Bt());return{returnValue:!1,dna:mb}},ca=(Wa,Ja)=>{let Va;Va=0;var mb;if(!({idx:mb}=N(Wa,Ja)).returnValue)return a.a.instance.fb(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ja,Wa),{returnValue:!1,length:Va};for(;mb<Wa.length;mb++)if(6!==Wa.K(mb).type){if(2===Wa.K(mb).type)return{returnValue:!0,
length:Va};a.a.instance.shipAssertTag(17342617,1,Wa.K(mb).C9(),"We found something other than text with type "+Wa.K(mb).type);a.a.instance.shipAssertTag(17877021,1,Wa.K(mb).$k.equals(Ja),"Unexpected GraphNodeId {0} for ParaId {1}",Wa.K(mb).$k,Ja);Va+=Wa.K(mb).length}a.a.instance.fb(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ja,Wa);return{returnValue:!1,length:Va}},W=Wa=>{const Ja=new l.a;for(let Va=0;Va<Wa.length;Va++)Ja.add(Wa.K(Va).clone());return Ja};var X=e(1536),ka=e(1476);
class ma{constructor(Wa,Ja,Va=null,mb=null){this.$k=Wa;this.type=Ja;this.text=Va;this.qd=mb}isEqual(Wa){return Wa.$k.equals(this.$k)&&this.type===Wa.type&&this.qd===Wa.qd&&ka.a.hZh(this.text,Wa.text)}toString(){let Wa=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.$k,this.qd,this.type);this.text&&(Wa+=String.format(" [TextLength: {0}]",this.text.length));return Wa}}Object(I.a)(ma,"MergeBlockValidationState",null,[]);var ja=e(257),na=e(901),Ba=e(902),Ma=e(486),Ea=e(487),
ya=e(900),ia=e(899),za=e(1457),Ca=e(1736),db;(function(Wa){Wa[Wa.rk=1]="base";Wa[Wa.t8p=2]="favoredUpdate";Wa[Wa.Jyq=4]="unfavoredUpdate";Wa[Wa.min=1]="min";Wa[Wa.max=7]="max"})(db||(db={}));Object(I.b)("MergeBlockSource",db);class pa{constructor(Wa,Ja,Va,mb){this.Eg=Wa;this.cp=Ja;this.JWd=Va;this.Pwd=mb}}Object(I.a)(pa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var ua=e(1533);class Ga extends ua.a{constructor(Wa,Ja){super(6,Wa,Ja);this.qd=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.$k)}Mlc(){return"Selection"}clone(){return new Ga(this.source,this.$k)}aE(){return!1}get length(){return 0}}Object(I.a)(Ga,"SelectionMergeBlock",ua.a,[]);var wa;(function(Wa){Wa[Wa.success=0]="success";Wa[Wa.auq=1]="selfSplit";Wa[Wa.xmq=2]="noSecondaryBlockToSplit";Wa[Wa.Hyq=3]="unexpected"})(wa||(wa={}));Object(I.b)("SplitTwinListResult",wa);var xa=e(1599);class sa extends xa.a{constructor(Wa,Ja,Va,mb){super(5,Wa,Ja);this._text=null;this.bsd(Va);this.OXk=mb}get text(){return this._text}bsd(Wa){this._text=
Wa}get vwd(){return this.OXk}clone(){return new sa(this.source,this.$k,this.text,this.vwd)}get jhb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(I.a)(sa,"UpdateHintTextMergeBlock",xa.a,[]);class Ka{constructor(Wa,Ja,Va,mb){this.F7=!1;this.Omb=new z.a;this.we=Wa;this.JOh=mb;this.Efh=Va;this._base=Ja;this.JSe=W(Ja);if(!U(this.rk,this.uf))throw a.a.instance.fb(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Wa.logger.mj(Object.assign(new za.a,
{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get rk(){return this._base}get uf(){return this.JSe}get ygd(){return this.F7}fmf(Wa,Ja){switch(Wa.type){case 1:return this.Ddl(Wa,Ja);case 2:return this.Dlf(Wa,Ja);case 3:return this.Iel(Wa,Ja);case 4:return this.Zdl(Wa);case 5:return this.Ucl(Wa,Ja);case 6:return this.Blf(Wa);default:return!1}}emf(Wa,Ja){switch(Wa.type){case 1:return this.Hlf(Wa,Ja);case 2:return this.Clf(Wa,Ja);case 3:return this.Hel(Wa,Ja);case 4:return this.Ydl(Wa);
case 5:return this.Tcl(Wa,Ja);case 6:return this.Alf(Wa);default:return{returnValue:!1,Qw:null}}}Ddl(Wa,Ja){let Va;const mb=({Sna:Va}=this.DQa(Wa.Eg,Ja,!1,Wa.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==mb&&1!==mb)return 3!==mb&&(a.a.instance.fb(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",db[Ja],wa[mb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.F7=
!1;Ja=new sa(Ja,Wa.Eg,Wa.text,Wa.id);this.YYf(Wa,Va,Ja);return!0}Dlf(Wa,Ja){let Va,mb=({Sna:Va}=this.DQa(Wa.Eg,Ja,!1,Wa.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==mb&&1!==mb)return 3!==mb&&(a.a.instance.fb(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",db[Ja],wa[mb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Ab;({Sna:Ab,returnValue:mb}=
this.DQa(Wa.Eg,Ja,!1,Wa.cp+Wa.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==mb&&1!==mb)return 3!==mb&&(a.a.instance.fb(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",db[Ja],wa[mb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.F7=!1;this.lzf(Wa,Va,Ab);return!0}Iel(Wa,Ja){let Va;const mb=({gXf:Va}=this.hFi(Wa,Ja,!1)).returnValue;if(0!==mb&&1!==mb)return 3!==
mb&&(a.a.instance.fb(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",db[Ja],wa[mb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.F7=!1;Ja=new D.a(Ja,Wa.Dw,Wa.UJa);this.YYf(Wa,Va,Ja);return!0}Zdl(Wa){let Ja;if(!({jee:Ja}=this.iFi(Wa,this.uf,"Derived")).returnValue)return!1;this.lzf(Wa,Ja,Ja+1);return!0}Ucl(Wa,Ja){let Va;if(!({sbg:Ja,fXf:Va}=this.gHi(Wa,!1,Ja)).returnValue)return!1;
this.YYf(Wa,Va,Ja);return!0}Blf(Wa){let Ja;if(!({iee:Ja}=this.ZEi(Wa,this.uf,"Derived")).returnValue)return!1;this.lzf(Wa,Ja,Ja+1);return!0}pYh(Wa,Ja,Va){const mb=({Sna:Ja}=this.DQa(Wa,Va,!1,Ja,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==mb&&1!==mb)return 3!==mb&&(a.a.instance.fb(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",db[Va],wa[mb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vz"}))),!1;this.F7=!1;Wa=new Ga(Va,Wa);this.uf.insert(Ja,Wa);return!0}Hlf(Wa,Ja){var Va=null;if(Ka.V1i(Wa.text.length))return{returnValue:!1,Qw:Va};let mb,Ab,Xb;var Lb=({Sna:mb,MDa:Ab,Fma:Xb}=this.DQa(Wa.Eg,Ja,!0,Wa.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Lb&&2!==Lb)return 3!==Lb&&(a.a.instance.fb(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",db[Ja],wa[Lb]),this.we.logger.mj(Object.assign(new Ca.a,
{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Qw:Va};this.F7=!1;({dna:Lb}=V(this.uf,Ab));Lb=this.uf.K(Lb).$k;Va=new sa(Ja,Wa.Eg,Wa.text,Wa.id);Ja=new sa(Ja,Lb,Wa.text,Wa.id);Va.wo=Ja;Ja.wo=Va;this.rk.insert(mb,Va);this.uf.insert(Ab,Ja);Va=new l.a;Va.add(new Ea.a(Lb,Xb,Wa.text,Wa.id,Wa.qx));return{returnValue:!0,Qw:Va}}Clf(Wa,Ja){let Va;Va=null;if(Ka.V1i(Wa.text.length))return{returnValue:!1,Qw:Va};let mb;var Ab,Xb=({Sna:mb,MDa:Lb,Fma:Ab}=this.DQa(Wa.Eg,Ja,!0,Wa.cp,!1,
"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Xb){if(2!==Xb)return 3!==Xb&&(a.a.instance.fb(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",db[Ja],wa[Xb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Qw:Va};var Lb=0;for({idx:Ab}=N(this.rk,Wa.Eg);Ab<this.rk.length&&Lb<Wa.cp;Ab++)Lb+=this.rk.K(Ab).length;Lb-=this.rk.K(Ab-1).length;
({MDa:Lb,Fma:Ab,returnValue:Xb}=this.DQa(Wa.Eg,Ja,!0,Lb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Xb)return 3!==Xb&&(a.a.instance.fb(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",db[Ja],wa[Xb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Qw:Va};this.F7=!1}var dc,yc;({Sna:dc,MDa:yc,Fma:Wc,returnValue:Xb}=this.DQa(Wa.Eg,
Ja,!0,Wa.cp+Wa.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Xb){if(2!==Xb)return 3!==Xb&&(a.a.instance.fb(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",db[Ja],wa[Xb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Qw:Va};var Wc=0;for({idx:yc}=N(this.rk,Wa.Eg);yc<this.rk.length&&Wc<Wa.cp+Wa.text.length;yc++)Wc+=this.rk.K(yc).length;
({MDa:yc,Fma:Wc,returnValue:Xb}=this.DQa(Wa.Eg,Ja,!0,Wc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Xb)return 3!==Xb&&(a.a.instance.fb(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",db[Ja],wa[Xb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Qw:Va};this.F7=!1}Ja="";Va=new l.a;for(--yc;yc>=Lb;yc--)if(6!==this.uf.K(yc).type)if(this.uf.K(yc).wo)Ja=
this.uf.K(yc).text+Ja,this.uf.VJ(yc);else{if(5===this.uf.K(yc).type)Xb=Wc-Ja.length;else if(2===this.uf.K(yc).type){if(Xb=0,!({length:Wc}=ca(this.uf,this.uf.K(yc).$k)).returnValue)return a.a.instance.fb(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Qw:Va}}else return a.a.instance.fb(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Qw:Va};if(!({dna:zb}=V(this.uf,yc+1)).returnValue)return a.a.instance.fb(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Qw:Va};var zb=this.uf.K(zb).$k;Va.add(new Ma.a(zb,Xb,Ja));Ja=""}for(--dc;dc>=mb;dc--)this.rk.VJ(dc);if(!({dna:zb}=V(this.uf,
Lb)).returnValue)return a.a.instance.fb(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Qw:Va};zb=this.uf.K(zb).$k;Ja&&Ja.length&&Va.add(new Ma.a(zb,Ab,Ja,Wa.id,Wa.qx));return{returnValue:!0,Qw:Va}}Hel(Wa,Ja){var Va=null;let mb,Ab,Xb;var Lb=({gXf:mb,WUi:Ab,Fma:Xb}=this.hFi(Wa,Ja,!0)).returnValue;if(0!==Lb)return 3!==Lb&&(a.a.instance.fb(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",
db[Ja],wa[Lb]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Qw:Va};var dc;if(!({dna:dc}=V(this.uf,Ab)).returnValue)return a.a.instance.fb(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,Qw:Va};Lb=this.uf.K(dc).$k;const yc=this.uf.K(dc).qd;let Wc,zb,cd;({Dw:dc,Mba:Wc,UJa:zb,eta:cd}=this.QHm(Wa,dc));this.D5h(this.uf,dc,Wc,cd,Ab);Va=new D.a(Ja,Wa.Dw,Wa.UJa);Ja=
new D.a(Ja,dc,zb);Va.wo=Ja;Ja.wo=Va;this.rk.insert(mb,Va);this.uf.insert(Ab,Ja);Va=new l.a;Va.add(new ia.a(Lb,yc,Xb,dc,zb,Wc,cd,Wa.id,Wa.qx));return{returnValue:!0,Qw:Va}}Ydl(Wa){let Ja;Ja=null;let Va,mb;var Ab;if(!({jee:Va}=this.iFi(Wa,this.rk,"Base")).returnValue)return{returnValue:!1,Qw:Ja};if(!this.rk.K(Va).wo||!({dna:mb}=Z(this.uf,this.rk.K(Va).wo.$k,0)).returnValue)return a.a.instance.fb(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),
this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.F7=!0,{returnValue:!1,Qw:Ja};if(!({dna:Ab}=V(this.uf,mb+1)).returnValue)return a.a.instance.fb(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.F7=!0,{returnValue:!1,Qw:Ja};let Xb,Lb,dc,yc,Wc,zb;({Sdb:Ab,Fxb:dc,gmj:Xb,
lYn:yc,YXn:Lb,ZXn:Wc}=this.jvm(Wa,mb,Ab));if(!({length:zb}=ca(this.uf,Ab)).returnValue)return{returnValue:!1,Qw:Ja};this.C5h(this.uf,Ab,dc,mb);this.uf.VJ(mb);this.rk.VJ(Va);Ja=new l.a;Ja.add(new ya.a(Xb,yc,zb,Lb,Wc,Ab,dc,Wa.id,Wa.qx));return{returnValue:!0,Qw:Ja}}Tcl(Wa,Ja){var Va=null;let mb,Ab,Xb;if(!({sbg:Xb,fXf:mb}=this.gHi(Wa,!0,Ja)).returnValue)return{returnValue:!1,Qw:Va};if(!({Jub:Ab}=this.s6c(this.rk,this.uf,mb,!0)).returnValue)return a.a.instance.fb(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),
{returnValue:!1,Qw:Va};if(0<Ab&&2!==this.uf.K(Ab-1).type)return a.a.instance.fb(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.F7=!0,{returnValue:!1,Qw:Va};let Lb;if(!({Dw:Lb}=this.Mxi(Ab)).returnValue)return{returnValue:!1,Qw:Va};Ja=new D.a(Ja,Wa.Eg,Wa.qd);Va=Xb;Va.wo=Ja;Ja.wo=Va;this.rk.insert(mb,Xb);this.uf.insert(Ab,Ja);Va=new l.a;
Va.add(new na.a(Wa.Eg,Wa.qd,Lb,Wa.id,Wa.qx));return{returnValue:!0,Qw:Va}}Alf(Wa){let Ja;Ja=null;let Va;var mb;if(!({iee:mb}=this.ZEi(Wa,this.rk,"Base")).returnValue)return{returnValue:!1,Qw:Ja};if(!this.rk.K(mb).wo||!this.rk.K(mb).wo.$k.equals(Wa.Eg))return a.a.instance.fb(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),
this.F7=!0,{returnValue:!1,Qw:Ja};if(!({Jub:Va}=this.s6c(this.rk,this.uf,mb,!0)).returnValue)return a.a.instance.fb(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,Qw:Ja};if(0<Va&&2!==this.uf.K(Va).type)return a.a.instance.fb(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.F7=!0,{returnValue:!1,
Qw:Ja};const Ab=this.uf.K(Va).$k,Xb=this.uf.K(Va).qd;this.uf.VJ(Va);this.rk.VJ(mb);({Dw:mb}=this.Mxi(Va));0<Va&&6===this.uf.K(Va-1).type&&this.qlo(Va-1,mb);Ja=new l.a;Ja.add(new Ba.a(Ab,Xb,mb,Wa.id,Wa.qx));return{returnValue:!0,Qw:Ja}}oYh(Wa,Ja,Va){let mb;var Ab=({Sna:Ja,MDa:mb}=this.DQa(Wa,Va,!0,Ja,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Ab)return 3!==Ab&&(a.a.instance.fb(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
db[Va],wa[Ab]),this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({dna:Ab}=V(this.uf,mb));Ab=this.uf.K(Ab).$k;Wa=new Ga(Va,Wa);Va=new Ga(Va,Ab);Wa.wo=Va;Va.wo=Wa;this.rk.insert(Ja,Wa);this.uf.insert(mb,Va);return!0}jvm(Wa,Ja,Va){let mb,Ab,Xb;mb=Wa.Sdb.equals(Wa.Eg)?this.uf.K(Ja).$k:this.uf.K(Va).$k;Wa=Wa.Fxb===Wa.qd?this.uf.K(Ja).qd:this.uf.K(Va).qd;Ab=this.uf.K(Ja).$k;Ja=this.uf.K(Ja).qd;Xb=this.uf.K(Va).$k;Va=this.uf.K(Va).qd;return{Sdb:mb,Fxb:Wa,
gmj:Ab,lYn:Ja,YXn:Xb,ZXn:Va}}QHm(Wa,Ja){let Va;var mb=Wa.Eg.equals(Wa.Dw)?Wa.Mba:Wa.Dw;const Ab=Wa.qd===Wa.UJa?Wa.eta:Wa.UJa;Wa.Eg.equals(Wa.Dw)?Va=this.uf.K(Ja).$k:(Va=mb,mb=this.uf.K(Ja).$k);Wa.qd===Wa.UJa?(Wa=this.uf.K(Ja).qd,Ja=Ab):(Wa=Ab,Ja=this.uf.K(Ja).qd);return{Dw:Va,Mba:mb,UJa:Wa,eta:Ja}}E5h(Wa,Ja,Va,mb){for(;mb<Wa.length;mb++){if(!Wa.K(mb).C9()&&6!==Wa.K(mb).type&&2!==Wa.K(mb).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Wa.K(mb).type);break}Wa.K(mb).$k=Ja;
if(2===Wa.K(mb).type){Wa.K(mb).qd=Va;break}}}D5h(Wa,Ja,Va,mb,Ab){this.E5h(Wa,Va,mb,Ab);Ka.F5h(Wa,Ja,Ab)}C5h(Wa,Ja,Va,mb){this.E5h(Wa,Ja,Va,mb+1);Ka.F5h(Wa,Ja,mb)}iFi(Wa,Ja,Va){let mb,Ab=-1;if(!({dna:mb}=Z(Ja,Wa.Eg,0)).returnValue)return a.a.instance.fb(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Va+"for GraphNodeId "+Wa.Eg),{returnValue:!1,jee:mb};if(!({dna:Ab}=V(Ja,mb+1)).returnValue||!Ja.K(Ab).$k.equals(Wa.Mba))return a.a.instance.fb(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
mb+1+" in "+Va+" of length "+Ja.length),{returnValue:!1,jee:mb};this.C5h(Ja,Wa.Sdb,Wa.Fxb,mb);return{returnValue:!0,jee:mb}}hFi(Wa,Ja,Va){let mb;const Ab=Va?this.rk:this.uf,Xb=Va?"Base":"Derived",Lb=({Sna:Ja,MDa:Va,Fma:mb}=this.DQa(Wa.Eg,Ja,Va,Wa.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Lb||2===Lb)return a.a.instance.fb(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Xb),{returnValue:Lb,gXf:Ja,WUi:Va,Fma:mb};this.D5h(Ab,Wa.Dw,Wa.Mba,Wa.eta,Ja);return{returnValue:Lb,
gXf:Ja,WUi:Va,Fma:mb}}ZEi(Wa,Ja,Va){return({idx:Wa}=N(Ja,Wa.Eg)).returnValue?2!==Ja.K(Wa).type?(a.a.instance.fb(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Va),{returnValue:!1,iee:-1}):{returnValue:!0,iee:Wa}:(a.a.instance.fb(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Va),{returnValue:!1,iee:-1})}qlo(Wa,Ja){var Va=this.uf.K(Wa);if(Ja){let mb;({dna:mb}=Z(this.uf,Ja,0));Va=Va.clone();Va.$k=Ja;this.uf.VJ(Wa);this.uf.insert(mb,
Va)}else this.uf.length>Wa&&(this.uf.K(Wa+1).C9()||2===this.uf.K(Wa+1).type)&&(Va.$k=this.uf.K(Wa+1).$k)}gHi(Wa,Ja,Va){var mb=Ja?this.rk:this.uf;Ja=Ja?"Base":"Derived";Va=new D.a(Va,Wa.Eg,Wa.qd);if(Wa.Dw){if(!({dna:mb}=Z(mb,Wa.Dw,0)).returnValue)return a.a.instance.fb(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Wa.Dw,Ja),{returnValue:!1,sbg:Va,fXf:mb};mb+=1}else mb=0;return{returnValue:!0,sbg:Va,fXf:mb}}Mxi(Wa){let Ja;Ja=null;let Va=Wa-1;if(-1===
Va)return{returnValue:!0,Dw:Ja};6===this.uf.K(Va).type&&Va--;if(2===this.uf.K(Va).type||4===this.uf.K(Va).type)return Ja=this.uf.K(Va).$k,{returnValue:!0,Dw:Ja};a.a.instance.fb(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.uf.K(Wa-1).type);return{returnValue:!1,Dw:Ja}}s6c(Wa,Ja,Va,mb){let Ab,Xb=!0;Ab=-1;if(Va>Wa.length)return a.a.instance.fb(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Jub:Ab};
if(Va<Wa.length){if(-1<Va&&Va<Wa.length&&!Wa.K(Va).wo){Xb=!1;for(var Lb=Va+1;Lb<Wa.length;Lb++)if(Wa.K(Lb).wo){Va=Lb;Xb=!0;break}}if(!Xb)return{returnValue:!1,Jub:Ab};Xb=!1;for(Lb=0;Wa.K(Va)&&Lb<Ja.length;Lb++)if(Ja.K(Lb).wo===Wa.K(Va)){Ab=Lb;Xb=!0;break}if(!Xb)return{returnValue:!1,Jub:Ab}}else Ab=Ja.length;if(0<Ab&&mb&&!Ja.K(Ab-1).wo){for(Wa=Ab-1;0<=Wa&&!Ja.K(Wa).wo;Wa--);Ab=Wa+1;6===Ja.K(Ab).type&&5!==this.we.input.source&&Ab++}return{returnValue:!0,Jub:Ab}}DQa(Wa,Ja,Va,mb,Ab,Xb){let Lb;var dc;
let yc;var Wc=this.rk;let zb=this.uf,cd=!1;Va||(Wc=this.uf,zb=this.rk);yc=dc=Lb=0;let qc,Dc,mc=0;if(!({f8c:mb,Uxb:qc,bhd:Dc}=F(Wc,Wa,mb)).returnValue)return a.a.instance.fb(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Sna:Lb,MDa:dc,Fma:yc};0<=mb&&mb<Wc.length&&!Wc.K(mb).wo&&qc&&!Ab&&(a.a.instance.fb(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Xb),this.F7=!0,mc=Ja===Wc.K(mb).source?1:2,cd=!0);Ab&&!Wc.K(mb)&&mb--;Ab&&qc&&!Wc.K(mb).wo&&(qc=!1,Dc=0);if(!Va&&!({idx:Wa}=N(zb,Wa)).returnValue&&!qc)return{returnValue:0,Sna:mb,MDa:dc,Fma:yc};if(!({Jub:Wa}=this.s6c(Wc,zb,mb,Va&&!qc)).returnValue&&!cd&&(Ja=!1,1===this.JOh&&0<mb&&!Dc&&(mb--,{Jub:Wa,returnValue:Ja}=this.s6c(Wc,zb,mb,Va&&!qc),Ja&&(mb++,Wa<zb.length-1?Wa++:Ja=!1)),!Ja))return a.a.instance.fb(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.we.logger.mj(Object.assign(new Ca.a,{Dk:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.F7=!0,{returnValue:3,Sna:Lb,MDa:dc,Fma:yc};if(qc&&(!Y(Wc,mb,Dc)||!cd&&!Y(zb,Wa,Dc)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Sna:Lb,MDa:dc,Fma:yc};Lb=mb;dc=Wa;qc&&(Lb=mb+1,cd||(dc=Wc.K(mb),Va=zb.K(Wa),dc.wo=Va,Va.wo=dc,Wc=Wc.K(mb+1),dc=zb.K(Wa+1),Wc.wo=dc,dc.wo=
Wc,dc=Wa+1));if(dc>=zb.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+dc+" secondaryList length was "+zb.length),{returnValue:3,Sna:Lb,MDa:dc,Fma:yc};for(Wc=0;Wc<dc;Wc++)zb.K(Wc).$k.equals(zb.K(dc).$k)&&(yc+=zb.K(Wc).length);return{returnValue:mc,Sna:Lb,MDa:dc,Fma:yc}}lzf(Wa,Ja,Va){this.Efh.contains(Wa.id)&&this.Omb.W(Wa.id,new l.a);for(--Va;Va>=Ja;Va--)this.Efh.contains(Wa.id)?this.Omb.K(Wa.id).insert(this.Omb.K(Wa.id).length,
this.uf.K(Va)):this.uf.K(Va).wo&&(this.uf.K(Va).wo.wo=null),this.uf.VJ(Va)}YYf(Wa,Ja,Va){if(this.Omb.Bb(Wa.qx)){const mb=this.Omb.K(Wa.qx);for(let Ab=0;Ab<mb.length;Ab++)mb.K(Ab).$k=Va.$k,Object(ja.a)(D.a,Va)&&Object(ja.a)(D.a,mb.K(Ab))&&(mb.K(Ab).qd=Va.qd);this.uf.PC(Ja,this.Omb.K(Wa.qx));this.Omb.remove(Wa.qx)}else this.uf.insert(Ja,Va)}jWm(Wa){let Ja,Va;Va=Ja=-1;if(!Wa.wo)return{returnValue:!1,bjc:Ja,Izf:Va};var mb;let Ab=0,Xb=!1;if(!({idx:mb}=N(this.uf,Wa.wo.$k)).returnValue)return{returnValue:!1,
bjc:Ja,Izf:Va};for(;mb<this.uf.length;mb++){if(Wa.wo===this.uf.K(mb)){Ja=mb;Va=Ab;Xb=!0;break}Ab+=this.uf.K(mb).length}return{returnValue:Xb,bjc:Ja,Izf:Va}}vGf(Wa){let Ja;Ja=new l.a;let Va=0,mb=0;for(;Va<Wa.length;){if(mb>=this.rk.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,DDc:Ja};if(Wa.K(Va).length>this.rk.K(mb).length){if(!Y(Wa,Va,this.rk.K(mb).length))return a.a.instance.fb(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",
Va,this.rk.K(mb).length),{returnValue:!1,DDc:Ja}}else if(Wa.K(Va).length<this.rk.K(mb).length){var Ab=!!this.rk.K(mb).wo,Xb=0;if(Ab&&!({Jub:Xb}=this.s6c(this.rk,this.uf,mb,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",mb),{returnValue:!1,DDc:Ja};if(!Y(this.rk,mb,Wa.K(Va).length)||Ab&&!Y(this.uf,Xb,Wa.K(Va).length))return a.a.instance.fb(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,DDc:Ja};if(Ab){Ab=this.rk.K(mb);var Lb=this.uf.K(Xb);Ab.wo=Lb;Lb.wo=Ab;Ab=this.rk.K(mb+1);Xb=this.uf.K(Xb+1);Ab.wo=Xb;Xb.wo=Ab}}if(this.rk.K(mb).wo&&5!==this.rk.K(mb).type&&this.rk.K(mb).C9()&&(Xb=this.rk.K(mb),Ab=Wa.K(Va),!Xb.mN.equals(Ab.mN)||!Xb.$B.aE(Ab.$B))){let dc;if(!({bjc:Lb,Izf:dc}=this.jWm(this.rk.K(mb))).returnValue)return{returnValue:!1,DDc:Ja};Ja.add(new pa(this.uf.K(Lb).$k,dc,Xb,Ab))}Va++;mb++}return{returnValue:!0,DDc:Ja}}static F5h(Wa,Ja,Va){for(--Va;0<=Va;Va--){if(!Wa.K(Va).C9()&&
6!==Wa.K(Va).type){a.a.instance.shipAssertTag(17311187,1,2===Wa.K(Va).type||4===Wa.K(Va).type,"Found merge block of type "+Wa.K(Va).type);break}Wa.K(Va).$k=Ja}}static V1i(Wa){return Wa?!1:(a.a.instance.fb(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(I.a)(Ka,"ParagraphMergeUsingHintsTwinList",null,[894]);var Na=e(1734),ub=e(1735),Ua=e(1731),sb=e(1733),qb=e(1732);class ab{constructor(Wa,Ja,Va,mb){this.cp=Wa;this.length=
Ja;this.JWd=Va;this.Pwd=mb}}Object(I.a)(ab,"UpdateFormattingIdsPosInfo",null,[]);class Xa{constructor(Wa,Ja,Va){this.F7=!1;this.Omb=new z.a;this.we=Wa;this.JOh=Va;this._base=Ja;this.JSe=W(Ja);if(!U(this.rk,this.uf))throw a.a.instance.fb(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Wa.logger.mj(Object.assign(new J.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get rk(){return this._base}get uf(){return this.JSe}get ygd(){return this.F7}fmf(Wa,Ja){switch(Wa.type){case 11:return this.Bdl(Wa,
Ja);case 8:return this.Dlf(Wa,Ja);case 10:return this.Blf(Wa);default:return!1}}emf(Wa,Ja){switch(Wa.type){case 11:return this.Adl(Wa,Ja);case 8:return this.Clf(Wa,Ja);case 10:return this.Alf(Wa);default:return{returnValue:!1,Qw:null}}}pYh(){a.a.instance.fb(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}oYh(){a.a.instance.fb(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");
this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}vGf(Wa){let Ja;Ja=new l.a;let Va=0,mb=0,Ab=0;for(;Va<Wa.length;){if(mb>=this.rk.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.we.logger.mj(Object.assign(new J.a,{Dk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,Owd:Ja};if(Wa.K(Va).length>this.rk.K(mb).length){if(!Y(Wa,
Va,this.rk.K(mb).length))return a.a.instance.fb(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.we.logger.mj(Object.assign(new J.a,{Dk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Owd:Ja}}else if(Wa.K(Va).length<this.rk.K(mb).length&&!this.chb(Ab+Wa.K(Va).length,!0).returnValue)return a.a.instance.fb(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Owd:Ja};if(this.rk.K(mb).wo&&5!==this.rk.K(mb).type&&this.rk.K(mb).C9()){const Xb=this.rk.K(mb),Lb=Wa.K(Va);if(!Xb.mN.equals(Lb.mN)||!Xb.$B.aE(Lb.$B)){let dc,yc;if(({bjc:dc,Oji:yc}=this.kWm(this.rk.K(mb))).returnValue)Ja.add(new ab(yc,this.uf.K(dc).length,Xb,Lb));else return a.a.instance.fb(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Owd:Ja}}}Ab+=this.rk.K(mb).length;Va++;mb++}return{returnValue:!0,Owd:Ja}}Bdl(Wa,Ja){let Va;if(!({FLa:Va}=this.chb(Wa.cp,!0)).returnValue)return a.a.instance.fb(574433300,1,2,"ApplyInsertTextHintToDerived"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let Ab=0;Ab<Wa.Z4.length;Ab++)switch(Wa.Z4.K(Ab).type){case 7:var mb=Wa.Z4.K(Ab);this.uf.insert(Va,new sa(Ja,
null,mb.text,mb.id));break;case 9:mb=Wa.Z4.K(Ab);this.uf.insert(Va,new D.a(Ja,mb.Eg,mb.qd));break;default:return a.a.instance.fb(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Dlf(Wa,Ja){let Va,mb;if(!({FLa:Va}=this.chb(Wa.cp,!0)).returnValue||!({FLa:mb}=this.chb(Wa.cp+Wa.text.length,!1)).returnValue)return a.a.instance.fb(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Wa=mb;Wa>=Va;Wa--)this.uf.K(Wa).source!==Ja&&this.z2d(this.uf,Wa);return!0}Blf(Wa){let Ja;if(!({FLa:Ja}=this.chb(Wa.cp,!0)).returnValue)return a.a.instance.fb(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.ozf(this.uf,Wa,Ja);return!0}Adl(Wa,Ja){let Va;Va=null;let mb,Ab;if(!({sNb:mb,FLa:Ab}=this.chb(Wa.cp,!0)).returnValue)return a.a.instance.fb(574433303,
1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Qw:Va};var Xb=this.GLf(this.uf,Ab-1);Xb=new qb.a(Xb);for(let Lb=0;Lb<Wa.Z4.length;Lb++)switch(Wa.Z4.K(Lb).type){case 7:Xb.Z4.add(this.Hlf(Wa.Z4.K(Lb),Ja,mb,Ab));break;case 9:Xb.Z4.add(this.Cdl(Wa.Z4.K(Lb),Ja,mb,Ab));break;default:return a.a.instance.fb(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Qw:Va}}Va=new l.a;Va.add(Xb);return{returnValue:!0,Qw:Va}}Hlf(Wa,Ja,Va,mb){const Ab=new sa(Ja,Wa.Eg,Wa.text,Wa.id);Ja=new sa(Ja,Wa.Eg,Wa.text,Wa.id);Ab.wo=Ja;Ja.wo=Ab;this.rk.insert(Va,Ab);this.uf.insert(mb,Ja);Va=new sb.a(Wa.Eg,Wa.text);Va.id=Wa.id;return Va}Cdl(Wa,Ja,Va,mb){const Ab=new D.a(Ja,Wa.Eg,Wa.qd);Ja=new D.a(Ja,Wa.Eg,Wa.qd);Ab.wo=Ja;Ja.wo=Ab;this.rk.insert(Va,Ab);this.uf.insert(mb,Ja);return new Ua.a(Wa.Eg,Wa.qd)}Clf(Wa){let Ja;
Ja=new l.a;let Va;var mb;let Ab;if(!({sNb:Va,FLa:mb}=this.chb(Wa.cp,!0)).returnValue||!({sNb:Ab,FLa:Xb}=this.chb(Wa.cp+Wa.text.length,!1)).returnValue)return a.a.instance.fb(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,Qw:Ja};for(Wa=Xb;Wa>=mb;Wa--)if(this.uf.K(Wa).wo){var Xb=Wa;const Lb=({cmj:Wa}=this.Vdm(Wa,mb)).returnValue;Lb&&(Ja.add(Lb),this.z2d(this.uf,Wa,Xb))}for(mb=Ab;mb>=
Va;mb--)this.z2d(this.rk,mb);return{returnValue:!0,Qw:Ja}}Alf(Wa){let Ja;Ja=null;let Va,mb;if(!({sNb:Va,FLa:mb}=this.chb(Wa.cp,!0)).returnValue)return a.a.instance.fb(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Qw:Ja};if(!this.ozf(this.rk,Wa,Va))return a.a.instance.fb(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Qw:Ja};this.ozf(this.uf,Wa,mb)&&(Ja=new l.a,Ja.add(new Na.a(this.GLf(this.uf,mb-1),Wa.Eg,Wa.qd)));return{returnValue:!0,Qw:Ja}}chb(Wa,Ja){var Va;var mb=Va=-1;let Ab,Xb;if(!({Uxb:Xb,i0h:Wa,h0h:Ab}=T(this.rk,Wa,this.we.logger)).returnValue)return{returnValue:!1,sNb:Va,FLa:mb};const Lb=Wa>=this.rk.length;Lb&&Wa--;if(this.rk.K(Wa).wo){const dc=this.tfm(this.uf,this.rk.K(Wa));if(Xb){if(0>dc||!Y(this.rk,Wa,Ab)||!Y(this.uf,dc,Ab))return a.a.instance.fb(575706444,
1,2,"SplitTwinListAndFindIdx"),this.we.logger.mj(Object.assign(new J.a,{Dk:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,sNb:Va,FLa:mb};Va=this.rk.K(Wa);mb=this.uf.K(dc);Va.wo=mb;mb.wo=Va;Va=this.rk.K(Wa+1);mb=this.uf.K(dc+1);Va.wo=mb;mb.wo=Va;Va=Ja?Wa+1:Wa;mb=Ja?dc+1:dc}else Ja?(Va=Lb?Wa+1:Wa,mb=Lb?dc+1:dc):(Va=Lb?Wa:Wa-1,mb=Lb?dc:dc-1)}else if(Xb){if(Y(this.rk,Wa,Ab))Va=Ja?Wa+1:Wa;else return a.a.instance.fb(575706445,1,2,"SplitTwinListAndFindIdx"),this.we.logger.mj(Object.assign(new J.a,
{Dk:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,sNb:Va,FLa:mb};Ja?(mb=({EUb:mb}=this.Okc(this.rk,this.uf,Wa,!1)).returnValue?mb+1:0,mb=mb>=this.uf.length?this.uf.length-1:mb):(mb=({EUb:mb}=this.Okc(this.rk,this.uf,Wa,!0)).returnValue?mb-1:this.uf.length-1,mb=0>mb?0:mb)}else Ja?(({EUb:mb}=this.Okc(this.rk,this.uf,Wa,!0)).returnValue||(({EUb:mb}=this.Okc(this.rk,this.uf,Wa,!1)).returnValue?mb+=1:(mb=Lb?this.uf.length-1:0,mb=0>mb?0:mb)),Va=Lb?Wa+1:Wa):(({EUb:mb}=this.Okc(this.rk,this.uf,
Wa,!1)).returnValue||(({EUb:mb}=this.Okc(this.rk,this.uf,Wa,!0)).returnValue?--mb:(mb=Wa?this.uf.length-1:0,mb=0>mb?0:mb)),Va=Lb?Wa:Wa-1);return{returnValue:!0,sNb:Va,FLa:mb}}Okc(Wa,Ja,Va,mb){let Ab=null;if(mb)for(;Va<Wa.length;Va++){if(Wa.K(Va).wo){Ab=Wa.K(Va).wo;break}}else for(;0<=Va;Va--)if(Wa.K(Va).wo){Ab=Wa.K(Va).wo;break}if(Ab)for(Wa=0;Wa<Ja.length;Wa++)if(Ja.K(Wa)===Ab)return Ja=Wa,{returnValue:!0,EUb:Ja};return{returnValue:!1,EUb:-1}}tfm(Wa,Ja){for(let Va=0;Va<Wa.length;Va++)if(Wa.K(Va).wo===
Ja)return Va;return-1}z2d(Wa,Ja,Va=-1){for(Va=0>Va?Ja:Va;Va>=Ja;Va--)Wa.K(Va).wo&&(Wa.K(Va).wo.wo=null),Wa.VJ(Va)}GLf(Wa,Ja){let Va=0;for(;0<=Ja;Ja--)Va+=Wa.K(Ja).length;return Va}FUm(Wa){Wa=Object(x.a)(xa.a,Wa);Wa||(a.a.instance.fb(575706448,1,2,"GetTextBlock"),this.we.logger.mj(Object.assign(new J.a,{Dk:"GetTextBlock",eventId:"8ujvq"})));return Wa}Vdm(Wa,Ja){let Va="",mb=Wa;for(;mb>=Ja&&this.uf.K(mb).wo&&2!==this.uf.K(mb).type;)Va=this.FUm(this.uf.K(mb)).text+Va,mb--;Ja=0>mb?0:this.GLf(this.uf,
mb);return mb<Wa?(Wa=mb+1,{returnValue:new ub.a(Ja,Va),cmj:Wa}):{returnValue:null,cmj:mb}}kWm(Wa){let Ja,Va,mb=!1;Va=Ja=0;if(!Wa.wo)return{returnValue:!1,bjc:Ja,Oji:Va};for(Ja=0;Ja<this.uf.length;Ja++){if(this.uf.K(Ja).wo===Wa){mb=!0;break}Va+=this.uf.K(Ja).length}return{returnValue:mb,bjc:Ja,Oji:Va}}ozf(Wa,Ja,Va){Va=Va===Wa.length?--Va:Va;Va>Wa.length-1&&(a.a.instance.fb(571757957,1,2,"DeleteEopInList: Idx out of range"),this.we.logger.mj(Object.assign(new J.a,{Dk:"DeleteEopInList",eventId:"8ffwf"})));
if(2===Wa.K(Va).type){const mb=Wa.K(Va);if(mb.$k!==Ja.Eg||mb.qd!==Ja.qd)return!1;this.z2d(Wa,Va);return!0}return!1}}Object(I.a)(Xa,"ParagraphMergeUsingHintsTwinListLcs",null,[894]);var wb=e(1504),Sa=e(1458),cc=e(1730);e.d(K,"a",function(){return Cb});class Cb{constructor(Wa,Ja,Va,mb,Ab,Xb,Lb=null,dc=null,yc=null){this.cV=this.SAa=this.WSa=this.Rya=null;this._initialized=!1;this.we=Wa;this.tJ=Ja;this.LJa=mb;this.nIa=Va;this.vza=Ab;this.GOe=new f.a;for(Wa=0;Wa<this.tJ.length;Wa++)this.GOe.add(this.tJ.K(Wa).id);
this.Rmh=new f.a;for(Wa=0;Wa<this.nIa.length;Wa++)this.Rmh.add(this.nIa.K(Wa).id);this.vOh=new f.a;for(Wa=0;Wa<this.LJa.length;Wa++)this.vOh.add(this.LJa.K(Wa).id);this.Ng=Xb;this.eff=Lb||y.a.instance;this.HM=dc;this.D0=yc;this.GHb=1===(this.HM&&this.D0&&1===this.HM.tRa&&1===this.D0.tRa?1:0);this.uza=0}get Tyg(){return 1!==this.uza}hfn(){var Wa=!0;if(this.HM&&this.D0)return Wa;if(this.HM||this.D0)return a.a.instance.fb(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.we.runtime.BC.Bb(E.a.NP)&&(Wa=this.we.runtime.BC.K(E.a.NP),Wa=this.tRg(Wa,this.we.runtime.RKa.id,"favored")&&({sM:this.HM}=this.ZWi(Wa,this.GOe,this.Rmh,this.we.runtime.BC,"favored")).returnValue);Wa&&this.we.runtime.Pw.Bb(E.a.NP)&&(Wa=this.we.runtime.Pw.K(E.a.NP),Wa=this.tRg(Wa,this.we.runtime.RKa.id,"unfavored")&&({sM:this.D0}=this.ZWi(Wa,this.GOe,this.vOh,this.we.runtime.Pw,"unfavored")).returnValue);this.HM=this.HM?this.HM:new cc.a(new l.a,0);this.D0=this.D0?this.D0:new cc.a(new l.a,0);
Wa&&this.we.input.GUb&&(Wa=this.we.input.Jea.last().LMa(E.a.NP),Wa=this.tRg(Wa,this.we.input.Jea.last().rL.id,"alreadyMerged"));return Wa}kdn(){const Wa=new f.a;if(this.GHb)return Wa;const Ja=this.HM?this.HM.sM.pQa():new l.a;let Va=0;for(;Va<Ja.length-1;){const mb=Ja.K(Va);let Ab,Xb=!1;for(Ab=Va+1;Ab<Ja.length;Ab++){const Lb=Ja.K(Ab);if(mb.J3i(Lb)){Wa.add(mb.id);Ja.VJ(Ab);Ja.VJ(Va);Xb=!0;break}}Xb||Va++}return Wa}tRg(Wa,Ja,Va){Wa=this.Ng.getPropertyString(Wa,m.a.VGa);Wa=w.a.Of(Wa);return Ja.equals(Wa)?
!0:(this.ord(2),a.a.instance.fb(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.we.runtime.RKa.id,Wa,Va),!1)}ZWi(Wa,Ja,Va,mb,Ab){let Xb;Xb=new cc.a(new l.a,0);Wa=this.Ng.getPropertyObjectIds(Wa,m.a.t_).pQa();for(let dc=0;dc<Wa.length;dc++){if(!mb.Bb(Wa.K(dc)))return a.a.instance.fb(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Wa.K(dc),Ab),{returnValue:!1,sM:Xb};const yc=mb.K(Wa.K(dc));var Lb=w.a.Of(this.Ng.getPropertyString(yc,m.a.sqa));if(Ja.contains(Lb)||Va.contains(Lb)){Lb=this.eff.Inc(yc);if(!Lb)return a.a.instance.fb(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",yc.id,Ab),{returnValue:!1,sM:Xb};Xb.sM.add(Lb)}}0<Wa.length&&a.a.instance.fb(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
Ab,Wa.Bt(),Xb.sM.Bt());return{returnValue:!0,sM:Xb}}sen(){return({NO:this.Rya,d3c:this.WSa,ewd:this.SAa}=wb.a.Sei(this.we,this.Ng,this.tJ,this.nIa,this.LJa,this.vza,!0,!0)).returnValue?!0:!1}ffn(Wa){const Ja=wb.a.g1d(this.Ng,Va=>this.we.runtime.Ao.K(Va),this.tJ,1,this.vza,!0,!0).returnValue;if(!Ja)return a.a.instance.fb(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.cV=this.GHb?new Xa(this.we,Ja,1):new Ka(this.we,Ja,Wa,this.HM?this.HM.tRa:
0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.hfn()||!this.sen())return!1;const Wa=this.kdn();return this.ffn(Wa)?!0:!1}iHi(Wa){const Ja=new l.a;let Va="";for(let mb=0;mb<Wa.length;mb++){const Ab=Wa.K(mb);Ab.C9()?Va+=Wa.K(mb).text:2===Ab.type?(Ja.add(new ma(Ab.$k,Ab.type,Va,Ab.qd)),Va=""):4===Ab.type&&(Ja.add(new ma(Ab.$k,Ab.type)),Va="")}return Ja}zJe(Wa,Ja,Va){Ja=this.iHi(Ja);Wa=this.iHi(Wa);let mb=Ja.length===Wa.length;if(mb)for(let Ab=0;Ab<Ja.length;Ab++)if(!Ja.K(Ab).isEqual(Wa.K(Ab))){mb=
!1;break}mb||(this.ord(4),a.a.instance.fb(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Va,Wa.Bt(),Ja.Bt()));return mb}VYh(Wa,Ja,Va){(Ja=({Yhb:Wa}=this.rfl(Wa,Ja,Va)).returnValue)||this.ord(this.cV.ygd?1:3);return{returnValue:Ja,Yhb:Wa}}rfl(Wa,Ja,Va){let mb;mb=new l.a;let Ab=!0;var Xb=0;let Lb=null,dc=this.HM?this.HM.sM.length:0;for(var yc=0;yc<dc&&Ab;yc++)Lb=this.HM.sM.K(yc),
Xb<this.D0.sM.length&&Lb.id.equals(this.D0.sM.K(Xb).id)&&5!==this.we.input.source?({returnValue:Ab}=this.cV.emf(Lb,2),Xb++):Ab=this.cV.fmf(Lb,2);if(!Ab)return a.a.instance.fb(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Lb.toString()),{returnValue:!1,Yhb:mb};if(!this.zJe(this.cV.uf,this.WSa,"Favored"))return{returnValue:!1,Yhb:mb};if(Wa&&1===this.we.input.Ooa&&!this.cV.pYh(Ja,Va,2))return a.a.instance.fb(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Ja,Va),{returnValue:!1,Yhb:mb};Ab=!0;yc=new l.a;for(dc=this.D0?this.D0.sM.length:0;Xb<dc&&Ab;Xb++){Lb=this.D0.sM.K(Xb);let Wc;({Qw:Wc,returnValue:Ab}=this.cV.emf(Lb,4));Ab&&Wc&&yc.PC(yc.length,Wc)}return Ab?this.zJe(this.cV.rk,this.SAa,"Unfavored")?Wa&&2===this.we.input.Ooa&&!this.cV.oYh(Ja,Va,4)?(a.a.instance.fb(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ja,Va),{returnValue:!1,Yhb:mb}):{returnValue:!0,Yhb:yc}:{returnValue:!1,Yhb:mb}:(a.a.instance.fb(17044291,
1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Lb.id,Lb.type),{returnValue:!1,Yhb:mb})}vGm(){let Wa,Ja=0;let Va=0,mb=w.a.nil;for(Wa=new z.a;Va<this.cV.rk.length;){const Lb=this.cV.rk.K(Va);mb.equals(Lb.$k)||(Ja=0,mb=Lb.$k);if(5===Lb.type){var Ab=Ja+Lb.length;var Xb=void 0;let dc;const yc=W(this.SAa);if(!({index:Xb}=P(yc,Lb.$k,Ja)).returnValue||!({index:dc}=P(yc,Lb.$k,Ab)).returnValue)return a.a.instance.fb(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",
Lb.vwd),{returnValue:!1,hjj:Wa};for(Ab=new l.a;Xb<dc;Xb++)Ab.add(yc.K(Xb));Wa.W(Lb.vwd,Ab)}Ja+=Lb.length;Va++}return{returnValue:!0,hjj:Wa}}wGm(){let Wa;Wa=new z.a;let Ja=0;for(let mb=0;mb<this.cV.rk.length;mb++){const Ab=this.cV.rk.K(mb);if(5===Ab.type){var Va=void 0;let Xb;const Lb=W(this.SAa);if(!({index:Va}=S(Lb,Ja,this.we.logger)).returnValue||!({index:Xb}=S(Lb,Ja+Ab.length,this.we.logger)).returnValue)return a.a.instance.fb(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),
{returnValue:!1,ijj:Wa};const dc=new l.a;for(;Va<Xb;Va++)dc.add(Lb.K(Va));Wa.W(Ab.vwd,dc)}Ja+=Ab.length}return{returnValue:!0,ijj:Wa}}$dl(Wa){let Ja;Ja=new l.a;let Va;if(this.GHb){if(!({ijj:Va}=this.wGm()).returnValue)return{returnValue:!1,Cgd:Ja}}else if(!({hjj:Va}=this.vGm()).returnValue)return{returnValue:!1,Cgd:Ja};let mb;mb=this.GHb?new Xa(this.we,W(this.WSa),1):new Ka(this.we,W(this.WSa),new f.a,this.HM?this.HM.tRa:0);for(var Ab=0;Ab<Wa.length;Ab++)if(!mb.fmf(Wa.K(Ab),4))return{returnValue:!1,
Cgd:Ja};for(Wa=mb.uf.length-1;0<=Wa;Wa--)5===mb.uf.K(Wa).type&&(Ab=mb.uf.K(Wa).vwd,mb.uf.VJ(Wa),mb.uf.PC(Wa,Va.K(Ab)));this.GHb&&(this.Thi(mb.uf),this.Thi(this.cV.uf));if(!this.zJe(this.cV.uf,mb.uf,"Merged"))return{returnValue:!1,Cgd:Ja};Ja=mb.uf;return{returnValue:!0,Cgd:Ja}}Thi(Wa){const Ja=new z.a;for(let Va=Wa.length-1;0<=Va;Va--){const mb=Object(x.a)(D.a,Wa.K(Va));mb&&(Ja.Bb(mb.qd)?Ja.K(mb.qd).source!==mb.source&&Wa.VJ(Va):Ja.add(mb.qd,mb))}}qfl(Wa){let Ja;if(!({Owd:Ja}=this.cV.vGf(W(this.SAa))).returnValue)return!1;
for(let mb=0;mb<Ja.length;mb++){const Ab=Ja.K(mb);let Xb,Lb;if(!({index:Xb}=S(Wa,Ab.cp,this.we.logger)).returnValue||!({index:Lb}=S(Wa,Ab.cp+Ab.length,this.we.logger)).returnValue)return a.a.instance.fb(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Va=!1;for(let dc=Xb;dc<Lb&&!Va;dc++)Va=!Ab.JWd.mN.equals(Wa.K(dc).mN);if(!Va){for(Va=Xb;Va<Lb;Va++)Wa.VJ(Xb);Wa.insert(Xb,
Ab.Pwd)}}return!0}pfl(Wa){let Ja;if(!({DDc:Ja}=this.cV.vGf(W(this.SAa))).returnValue)return!1;for(let Ab=0;Ab<Ja.length;Ab++){var Va=Ja.K(Ab);let Xb,Lb;if(({index:Xb}=P(Wa,Va.Eg,Va.cp)).returnValue&&({index:Lb}=P(Wa,Va.Eg,Va.cp+Va.Pwd.length)).returnValue){var mb=!1;for(let dc=Xb;dc<Lb&&!mb;dc++)mb=!Va.JWd.mN.equals(Wa.K(dc).mN)||!Va.JWd.$B.aE(Wa.K(dc).$B);if(mb){if(this.HM&&1===this.HM.tRa||this.D0&&1===this.D0.tRa)return!1}else{for(mb=Xb;mb<Lb;mb++)Wa.VJ(Xb);Wa.insert(Xb,Va.Pwd)}}else if(Va=Va.Pwd.Wln,
a.a.instance.fb(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Va),Va||this.HM&&1===this.HM.tRa||this.D0&&1===this.D0.tRa)return!1}return!0}GLm(Wa){let Ja,Va;Va=new l.a;Ja=this.we.runtime.ks.K(E.a.NP);let mb;({Cbg:mb}=Cb.lyi(this.we,this.Ng));const Ab=new l.a;for(let Lb=0;Lb<Wa.length;Lb++){if(mb.contains(Wa.K(Lb).id,(yc,Wc)=>yc.equals(Wc)))continue;if(this.we.runtime.ks.Bb(Wa.K(Lb).id))return a.a.instance.shipAssertTag(17044293,
1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Wa.K(Lb).id),{returnValue:!1,lte:Ja,kte:Va};Ab.add(Wa.K(Lb).id);var Xb=Wa.K(Lb).rYa();const dc=new Sa.a(Xb);Xb=Xb.Ak();for(const yc of Xb)dc.JO(yc);Va.add(dc)}Wa=this.Ng.getPropertyObjectIds(Ja.rn,m.a.t_);Wa.PC(Wa.length,Ab);this.Ng.setPropertyObjectIds(Ja.rn,m.a.t_,Wa);return{returnValue:!0,lte:Ja,kte:Va}}D9d(Wa){return String.format("Name: {0}, Message: {1}, Stack: {2}",Wa.name,Wa.message,Wa.stack)}ord(Wa){0===this.uza&&(this.uza=
Wa)}qDc(){let Wa;Wa=null;let Ja,Va;var mb;try{if({ks:Wa,lte:Ja,kte:Va,returnValue:mb}=this.cxp(),mb){if(Ja&&Va){this.we.runtime.ks.W(Ja.rn.id,Ja);for(mb=0;mb<Va.length;mb++){const dc=Va.K(mb);this.we.runtime.ks.W(dc.rn.id,dc)}const Ab=Ja.rn,Xb=this.Ng.getPropertyObjectIds(Ab,m.a.t_),Lb=this.Ng.getPropertyString(Ab,m.a.VGa);a.a.instance.fb(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Xb.Bt(),Lb)}else a.a.instance.fb(593826831,
1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,ks:Wa}}}catch(Ab){a.a.instance.fb(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.D9d(Ab))}this.ord(5);a.a.instance.fb(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.uza,this.Tyg);this.Cdb();this.HM&&1===this.HM.tRa&&this.we.logger.mj(Object.assign(new X.a,{eventId:"bc04c",Dk:"ParagraphMergeUsingHints.TryDoMerge",
info:u[this.uza]+"/LCS"}));return{returnValue:!1,ks:Wa}}cxp(){let Wa,Ja,Va;Va=Ja=Wa=null;let mb;mb=this.initialize();this.we.logger.EZ("PMUH Initialize");let Ab=null;mb=mb&&({Yhb:Ab}=this.VYh(!1,w.a.nil,0)).returnValue;this.we.logger.EZ("PMUH ApplyUpdateHints");let Xb=new l.a;mb=mb&&({Cgd:Xb}=this.$dl(Ab)).returnValue;this.we.logger.EZ("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");mb=this.GHb?mb&&this.qfl(Xb):mb&&this.pfl(Xb);this.we.logger.EZ("PMUH ApplyUnfavoredFormattingChanges");
this.GHb&&!this.gQo(Xb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.we.logger.mj(Object.assign(new J.a,{Dk:"ReuseParaIdsIfPossible",eventId:"8ettb"})),mb=!1);const Lb=this.nae(Xb);mb=mb&&({jte:Wa}=wb.a.G6c(this.we,this.Ng,this.vza,Xb,Lb)).returnValue;this.we.logger.EZ("PMUH GetMergeableObjectsFromMergeBlocks");this.HM&&1===this.HM.tRa&&this.D0&&1===this.D0.tRa||(mb=mb&&({lte:Ja,kte:Va}=this.GLm(H(Ab))).returnValue,this.we.logger.EZ("PMUH GetPartialMergeResultForUpdateHintNodes"));
return{returnValue:mb,ygd:!!this.cV&&this.cV.ygd,ks:Wa,lte:Ja,kte:Va}}nae(Wa){const Ja=new l.a;for(let Va=0;Va<Wa.length;Va++)2===Wa.K(Va).type&&Ja.add(Wa.K(Va).$k);return Ja}DMf(Wa){const Ja=new l.a;for(let Va=0;Va<Wa.length;Va++)2===Wa.K(Va).type&&Ja.add(Wa.K(Va));return Ja}gQo(Wa){var Ja=this.DMf(this.Rya),Va=this.DMf(this.WSa),mb=this.DMf(this.SAa),Ab=this.nae(Ja),Xb=this.nae(Va),Lb=this.nae(mb);Xb=G.b(Ab,Xb,Lb);Ab=new l.a;for(Lb=0;Lb<Xb.length;Lb++)Ab.PC(Ab.length,Xb.K(Lb).vfm());Xb=this.Afm(Wa);
Ja=this.wfm(Xb,Ab,Ja,Va,mb);Va=0;mb=new f.a;for(Ab=0;Ab<Wa.length;Ab++)if(Xb=Wa.K(Ab),2===Xb.type)if(mb.contains(Xb.$k))if(Va<Ja.length)Wa.VJ(Ab),Wa.insert(Ab,Ja.K(Va)),Va++;else return!1;else mb.add(Xb.$k);0<Wa.length&&2!==Wa.K(Wa.length-1).type&&Va<Ja.length&&Wa.insert(Wa.length,Ja.K(Va));return!0}Afm(Wa){const Ja=new f.a;for(let Va=0;Va<Wa.length;Va++)2===Wa.K(Va).type&&Ja.add(Wa.K(Va).$k);return Ja}wfm(Wa,Ja,Va,mb,Ab){const Xb=new l.a;for(let Lb=0;Lb<Ja.length;Lb++){const dc=Ja.K(Lb);if(!Wa.contains(dc)){let yc;
(({block:yc}=this.nGf(mb,dc)).returnValue||({block:yc}=this.nGf(Ab,dc)).returnValue||({block:yc}=this.nGf(Va,dc)).returnValue)&&yc&&Xb.add(yc)}}return Xb}nGf(Wa,Ja){for(let Va=0;Va<Wa.length;Va++)if(2===Wa.K(Va).type&&Wa.K(Va).$k===Ja)return Wa=Wa.K(Va),{returnValue:!0,block:Wa};return{returnValue:!1,block:null}}Cdb(){const Wa=new l.a;wb.a.Dtc(this.Ng,"BaseObjects_",this.tJ,Wa);wb.a.Dtc(this.Ng,"FavoredObjects_",this.nIa,Wa);wb.a.Dtc(this.Ng,"ConflictObjects_",this.LJa,Wa)}Fql(){let Wa,Ja;Wa=w.a.nil;
Ja=-1;let Va=0;for(let mb=0;mb<this.cV.uf.length;mb++){const Ab=this.cV.uf.K(mb);if(Ab.C9())Va+=Ab.length;else if(6!==Ab.type)Va=0;else return Wa=Ab.$k,Ja=Va,{returnValue:!0,objectId:Wa,cp:Ja}}a.a.instance.fb(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Wa,cp:Ja}}owd(Wa,Ja){let Va,mb;mb=Ja;Va=Wa;try{let Ab=this.initialize();if(Ab=(Ab=Ab&&this.VYh(!0,Wa,Ja).returnValue)&&({objectId:Va,cp:mb}=this.Fql()).returnValue)return a.a.instance.fb(17409924,
1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Va,mb),{returnValue:!0,Nfb:Va,rxa:mb}}catch(Ab){a.a.instance.fb(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.D9d(Ab))}this.ord(5);a.a.instance.fb(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.uza,this.Tyg);this.Cdb();return{returnValue:!1,Nfb:Va,rxa:mb}}static lyi(Wa,
Ja){let Va;Va=new l.a;if(!Wa.input.GUb)return{returnValue:!0,Cbg:Va};Wa=Wa.input.Jea.last().LMa(E.a.NP);Va=Ja.getPropertyObjectIds(Wa,m.a.t_);return{returnValue:!0,Cbg:Va}}static Ylo(Wa){if(!wb.a.KBf(Wa))return!0;const Ja=new v.a;Wa.runtime.ks.W(E.a.NP,wb.a.ifn(Wa,Ja));return!0}static Clo(Wa){if(!Wa.runtime.ks.Bb(E.a.NP)||!Wa.runtime.Pw.Bb(E.a.NP))return!0;const Ja=new v.a,Va=Wa.runtime.ks.K(E.a.NP);var mb=Ja.getPropertyString(Va.rn,m.a.VGa);if(w.a.Of(mb).equals(w.a.nil))return!0;mb=Ja.getPropertyObjectIds(Va.rn,
m.a.t_);const Ab=Ja.getPropertyObjectIds(Wa.runtime.Pw.K(E.a.NP),m.a.t_);let Xb;({Cbg:Xb}=Cb.lyi(Wa,Ja));for(let Lb=0;Lb<Ab.length;Lb++)mb.contains(Ab.K(Lb),(dc,yc)=>dc.equals(yc))||Xb.contains(Ab.K(Lb),(dc,yc)=>dc.equals(yc))||(mb.add(Ab.K(Lb)),Wa.runtime.ks.W(Ab.K(Lb),new Sa.a(Wa.runtime.Pw.K(Ab.K(Lb)).KQ())));Ja.setPropertyObjectIds(Va.rn,m.a.t_,mb);return!0}}Object(I.a)(Cb,"ParagraphMergeUsingHints",null,[835])},1631:function(I,K,e){I=e(0);class m{constructor(x){this.nmj=x;this.succeeded=!1;this.iDc=
x?x.iDc:0;this.vAn=!1;this.length=this.Xpp=0}}Object(I.a)(m,"TrieResult",null,[]);class f{constructor(x,u,v){this.uxb=new m(null);this.pPn=x;this.Kfd=u;this.Igj=u+v-1}get result(){return this.uxb}DHi(){let x;return this.Kfd<=this.Igj?(x=this.pPn.charAt(this.Kfd),++this.Kfd,{returnValue:!0,ch:x}):{returnValue:!1,ch:"\x00"}}Tug(x,u,v){x&&(this.uxb.vAn=!0,this.uxb.Xpp=u);this.uxb.length=this.Kfd;this.uxb.succeeded=!0;this.uxb.iDc=v;this.Kfd!==this.Igj+1&&(this.uxb=new m(this.uxb))}}Object(I.a)(f,"LookUpStringVisitor",
null,[2045]);var a=e(1748);class l{constructor(){this.h5h=this.E2h=this.G2h=this.D2h=this.F2h=this.Gpf=this.Epf=this.Ipf=this.Dpf=0}}Object(I.a)(l,"TRIESTATS",null,[]);class w{constructor(){this.HQa=this.whd=0}}Object(I.a)(w,"TrieSymbol",null,[]);e.d(K,"a",function(){return z});class z{constructor(x,u){this.J9=null;this.qme=this.Ygj=this.Wgj=this.$gj=this.Sgj=this.Zgj=this.Xgj=this.ahj=this.Tgj=0;this.ON=x;if(x.ZB(u,4)!==z.WNb)throw Error.argument("Input does not represent a trie");u+=4;this.Kgj=
1===x.ZB(u,4);u+=4;this.mPn=1===x.ZB(u,4);u+=4;this.iPn=x.ZB(u,4);u+=4;if(x.ZB(u,4)){x=u+4;this.J9=this.hwo(x);this.Tgj=u=x+z.kpl;this.ahj=u+=z.CXd*(this.J9.Dpf+(this.J9.Dpf%2?1:0));this.Xgj=u+=z.CXd*(this.J9.Ipf+(this.J9.Ipf%2?1:0));this.Zgj=u+=z.CXd*(this.J9.Epf+(this.J9.Epf%2?1:0));this.Sgj=u+=z.CXd*(this.J9.Gpf+(this.J9.Gpf%2?1:0));this.$gj=u+=z.Kpf*this.J9.D2h;this.Wgj=u+=z.Lpf*this.J9.G2h;this.Ygj=u+=z.Lpf*this.J9.E2h;u+=z.Lpf*this.J9.F2h;if(u!==x+this.J9.h5h)throw Error.argument("Corrupted trie binary");
this.qme=u}else this.J9=null}cgj(x,u,v,E){x=new f(x,u,v);this.Igk(x,E);return x.result}CMi(x){if(this.Kgj)if(x)--x;else return"";if(!this.J9)throw Error.argument("Invalid trieID");const u=new a.a;u.sJ=0;this.z4b(u);const v=[];for(;;){if(u.sJ&z.Cib)if(x)--x;else return Array.add(v,u.G5b),String.fromCharCode.apply(null,v);const E=!!(u.sJ&z.WLe),y=this.Zlc(u,!0);if(E||x<y){if(Array.add(v,u.G5b),!this.z4b(u))throw Error.argument("Invalid trieID");}else if(x-=y,!this.Bvd(u))throw Error.argument("Invalid trieID");
}}Igk(x,u){let v=0;this.Kgj&&(x.Tug(this.mPn,this.iPn,0),++v);if(this.J9){var E=new a.a;E.sJ=0;if(this.z4b(E))for(;;){var y=void 0;if(!({ch:y}=x.DHi()).returnValue)break;u&&(y=u(y));y=y.toString().charCodeAt(0);let H=!1;for(;!H;){const D=!!(E.sJ&z.Cib);if(E.G5b===y){if(H=!0,D&&x.Tug(!!(E.sJ&z.LVg),E.FFe,v),!this.z4b(E))return}else if(v+=this.Zlc(E,!0),!this.Bvd(E))return;D&&++v}}}}z4b(x){if(!x.sJ)return this.ANg(x),!0;if(!(x.sJ&z.VLe))return!1;x.YYa=0;x.ZA=x.Iub;this.ANg(x);return!0}Bvd(x){if(x.sJ&
z.WLe)return!1;this.ANg(x);return!0}Zlc(x,u){return x.sJ&z.KVg?x.BXd:x.sJ&z.VLe?!u&&x.sJ&z.WLe?this.zum(x):1:0}zum(x){x=z.wsf(x);if(!this.z4b(x))return 0;let u=0;do x.sJ&z.Cib&&++u,u+=this.Zlc(x,!1);while(this.Bvd(x));return u}ANg(x){x.sJ||(x.YYa=0,x.ZA=this.qme);var u=this.g2d(this.Tgj,x.ZA),v=u.HQa;x.ZA+=u.whd;u=this.ON.ZB(this.Sgj+z.Kpf*v,z.Kpf);x.G5b=u&65535;x.sJ=u>>16;x.sJ&z.KVg&&(x.BXd=this.UTl(x));x.sJ&z.LVg&&(u=this.g2d(this.ahj,x.ZA),v=u.HQa,x.ZA+=u.whd,x.FFe=this.ON.ZB(this.$gj+4*v,4));
x.sJ&z.Hpk?(x.Iub=this.qme+((this.ON.K(x.ZA)<<8|this.ON.K(x.ZA+1))<<8|this.ON.K(x.ZA+2)),x.ZA+=3):x.sJ&z.Ipk?(x.Iub=x.ZA,x.YYa=x.Iub):x.sJ&z.Jpk?(u=this.g2d(this.Xgj,x.ZA),v=u.HQa,x.ZA+=u.whd,x.Iub=this.qme+this.ON.ZB(this.Wgj+4*v,4)):x.sJ&z.VLe&&(u=this.g2d(this.Zgj,x.ZA),v=u.HQa,x.ZA+=u.whd,x.YYa||(x.YYa=x.ZA),x.YYa+=this.ON.ZB(this.Ygj+4*v,4),x.Iub=x.YYa)}g2d(x,u){const v=new w;let E=0;for(;;){E+=this.ON.K(u);++u;++v.whd;const y=this.ON.ZB(x,2);if(E<y)break;v.HQa+=y;E-=y;x+=2;E<<=8}v.HQa+=E;return v}UTl(x){let u=
this.ON.K(x.ZA);192<=u?(u=(u&63)<<15|(this.ON.K(x.ZA+1)&127)<<8,u|=this.ON.K(x.ZA+2),x.ZA+=3):128<=u?(u=(u&127)<<8|this.ON.K(x.ZA+1),x.ZA+=2):x.ZA+=1;return u}hwo(x){const u=new l;u.Dpf=this.ON.ZB(x+12,2);u.Ipf=this.ON.ZB(x+14,2);u.Epf=this.ON.ZB(x+16,2);u.Gpf=this.ON.ZB(x+18,2);u.F2h=this.ON.ZB(x+24,4);u.D2h=this.ON.ZB(x+28,4);u.G2h=this.ON.ZB(x+32,4);u.E2h=this.ON.ZB(x+36,4);u.h5h=this.ON.ZB(x+40,4);return u}static wsf(x){const u=new a.a;u.G5b=x.G5b;u.sJ=x.sJ;u.BXd=x.BXd;u.ZA=x.ZA;u.Iub=x.Iub;u.YYa=
x.YYa;u.FFe=x.FFe;return u}}z.WNb=1654263084;z.kpl=48;z.CXd=2;z.Lpf=4;z.Kpf=4;z.Cib=1;z.WLe=2;z.KVg=4;z.LVg=8;z.VLe=16;z.Ipk=64;z.Jpk=128;z.Hpk=256;Object(I.a)(z,"Trie",null,[2042])},1633:function(I,K,e){e.r(K);I=e(0);e(1394);var m=e(1422);class f{}f.aij=0;f.Tsl=1;f.Eue=10;Object(I.a)(f,"AppsForOfficeStoreType",null,[]);var a=e(1389),l=e(2),w=e(96),z=e(12);class x{constructor(){this.Nbf=0}Qrg(J,U){this.Nbf=window.performance.now();this.J3a(()=>{const F=window.performance.now(),T={},Y=l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);U.u9k&&(T.callback=P=>{J(P,f.aij,F)},Y&&(T.storeType=f.aij),l.AFrameworkApplication.va.Zb(z.a.P_b,2,T));U.v9k&&(T.callback=P=>{J(P,f.Eue,F)},Y?T.storeType=f.Eue:l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?T.storeType=10:T.storeType=f.Eue,l.AFrameworkApplication.va.Zb(z.a.P_b,2,T))},0,()=>{if(a.TellMeActorConstants.instance.gk())a.TellMeActorConstants.instance.gk().onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.Nbf)+" ms")})}J3a(J,U=0,F=null){2!==l.AFrameworkApplication.va.Vb(z.a.P_b,1)?(a.TellMeActorConstants.instance.gk()&&a.TellMeActorConstants.instance.gk().hE(m.a.t9k,window.performance.now()-this.Nbf),J()):U<x.xSn?l.AFrameworkApplication.zc.pc(new w.a(2,1,x.CNp,()=>{this.J3a(J,U+1,F)})):F&&F()}static get instance(){x._instance||(x._instance=new x);return x._instance}}x._instance=null;x.xSn=20;x.CNp=500;Object(I.a)(x,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.l6f=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(I.a)(u,"AddinInfo",null,[]);var v=e(1396),E=e(1398),y=e(1400),H=e(1390),D=e(152);e.d(K,"AddinResultsProvider",function(){return G});class G{constructor(J){this.Z8e=[];this.$c=J;this.q5n=(U,F,T)=>{if(U){const Y=U.errorCode;if(a.TellMeActorConstants.instance.gk()){const P={};P.StoreType=F;P.ErrorCode=
Y;P.AddinCount=U.value?U.value.length:0;a.TellMeActorConstants.instance.gk().hE(m.a.Rmm,window.performance.now()-T,P)}if(0===Y&&U.value){G.YMb=G.YMb||{};U=U.value;for(const P of U)U=new u,U.displayName=P[0],U.id=P[1],U.description=P[2],U.targetType=P[3],U.appVersion=4<P.length?P[4]:"",U.assetId=5<P.length?P[5]:"",U.assetStoreId=6<P.length?P[6]:"",U.width=7<P.length?P[7]:0,U.height=8<P.length?P[8]:0,U.iconUrl=9<P.length?P[9]:"",U.providerName=10<P.length?P[10]:"",U.storeId=11<P.length?P[11]:"",U.storeType=
12<P.length?P[12]:"",U.l6f=this.XDm(U),G.YMb[U.id]=U,0<U.iconUrl.length&&(F="AddinIcon_"+U.id,l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.KGj(F,U.iconUrl):appChrome.addInApi.registerAddinIcon(F,U.iconUrl))}}};x.instance.Qrg(this.q5n,this.$c)}iP(){return"Add-ins"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(J,U,F,T,Y=null){F=new y.a(J);Y&&!Array.contains(Y,27)||H.a.UT(J)||(Y=new E.a(27),Y.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.ADm(J.sh,Y),F.Jx(Y));U.mv(F)}ADm(J,U){if((J=this.CUo(J))&&0<J.length){let F=0;J.forEach(T=>{if(!(3<++F)){var Y="AddinSuggestion"+F,P={};if(l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var S="AddinIcon_"+T.id;0>Array.indexOf(this.Z8e,S)&&0<T.iconUrl.length&&this.KGj(S,T.iconUrl);P["default"]=0<=Array.indexOf(this.Z8e,S)?S:"AppForOfficeLogo_20"}else P["default"]=0<T.iconUrl.length?"AddinIcon_"+T.id:"AppForOfficeLogo_20";S=[];
S.push(appChrome.actions.setControlLabel(Y,T.displayName));S.push(appChrome.actions.setControlIconSet(Y,P));S.push(appChrome.actions.setCompoundButtonCommandValueId(Y,T.id));S.push(appChrome.actions.updateCompoundButtonDescription(Y,T.description));l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(P=window.performance.now(),S.push(appChrome.actions.updateControlEnabledDisabledState(Y,!1)),a.TellMeActorConstants.instance.gk()&&a.TellMeActorConstants.instance.gk().hE(m.a.f6l,
window.performance.now()-P));appChrome.api.dispatch(S);Y=new v.a(Y,27,void 0,void 0,1);Y.additionalInfo=Telemetry.PrivacyRules.GetPrivacyCompliantId(T.id,T.storeType,T.assetId,null,null,T.storeId);U.aA(Y)}})}}KGj(J,U){D.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(J,U),Array.add(this.Z8e,J))}CUo(J){if(!G.YMb)return null;const U=[],F=G.YMb;for(const Y in F){var T=F[Y];T&&G.CRn(J,T)&&Array.add(U,T)}return U}XDm(J){return G.Ljp(J.displayName)}static CRn(J,U){if(!U.l6f)return!1;
for(const F of J.split(" ")){J=!1;for(const T of U.l6f)if(T.toLowerCase().startsWith(F.toLowerCase())){J=!0;break}if(!J)return!1}return!0}static Ljp(J){const U=[];for(const F of J.split(" ")){J=0;for(let T=0;T<F.length;T++){const Y=F.charAt(T);Y.toString().toUpperCase()===Y.toString()&&T>J&&(Array.add(U,F.substring(J,T)),J=T)}Array.add(U,F.substring(J,F.length));J&&Array.add(U,F.substring(0,F.length))}return U}}G.YMb=null;Object(I.a)(G,"AddinResultsProvider",null,[845])},1727:function(I,K,e){e.d(K,
"a",function(){return f});I=e(0);var m=e(231);class f{constructor(){this.w_b=this.cQb=this.kZa=this.pzb=this.qzb=this.h$a=this.mvb=this.ozb=this.brb=this.kvb=this.cfb=this.crb=this.lvb=null;this.reset()}reset(){this.lvb=new m.a;this.crb=new m.a;this.cfb=new m.a;this.kvb=new m.a;this.brb=new m.a;this.ozb=new m.a;this.mvb=new m.a;this.h$a=new m.a;this.h$a=new m.a;this.qzb=new m.a;this.pzb=new m.a;this.kZa=[];this.cQb=[];this.w_b=[]}cMp(a){return this.MYa(this.lvb,a)&&this.MYa(this.crb,a)&&this.MYa(this.cfb,
a)&&this.MYa(this.kvb,a)&&this.MYa(this.brb,a)&&this.MYa(this.ozb,a)&&this.MYa(this.mvb,a)&&this.MYa(this.h$a,a)&&this.MYa(this.qzb,a)&&this.MYa(this.pzb,a)}MYa(a,l){return!a||!a.length||a.length===l}}Object(I.a)(f,"MergeableTrackedChangesProperties",null,[])},1728:function(I,K,e){e.d(K,"a",function(){return a});I=e(0);var m=e(231),f=e(622);class a{constructor(){this.$Ra=new m.a;this.VSa=new m.a;this.qVa=new m.a}get qNb(){return this.$Ra}get HFf(){return this.VSa}get LCb(){return this.qVa}get isEmpty(){return!this.$Ra.length&&
!this.VSa.length&&!this.qVa.length}get Axb(){return Math.max(Math.max(this.$Ra.length,this.VSa.length),this.qVa.length)}get WUn(){return Math.min(Math.min(this.$Ra.length,this.VSa.length),this.qVa.length)}MVd(l){this.$Ra.add(l)}OVd(l){this.VSa.add(l)}SVd(l){this.qVa.add(l)}vfm(){const l=new f.a,w=new m.a;let z=0;for(;z<this.$Ra.length||z<this.VSa.length||z<this.qVa.length;)z<this.$Ra.length&&!l.contains(this.$Ra.K(z))&&(w.add(this.$Ra.K(z)),l.add(this.$Ra.K(z))),z<this.VSa.length&&!l.contains(this.VSa.K(z))&&
(w.add(this.VSa.K(z)),l.add(this.VSa.K(z))),z<this.qVa.length&&!l.contains(this.qVa.K(z))&&(w.add(this.qVa.K(z)),l.add(this.qVa.K(z))),z++;return w}}Object(I.a)(a,"ObjectCollection",null,[])},1729:function(I,K,e){e.d(K,"a",function(){return D});I=e(0);var m=e(61),f=e(13),a=e(373),l=e(231);e(49);e(824);var w=e(622),z=e(185),x=e(190),u=e(1059),v=e(1280),E=e(1779),y=e(1537),H=e(1776);class D{constructor(G){this.QE=new u.a;this.f0=new a.a;this.yNh=new a.a(0);this.Nzd=new l.a;this.Lqh=new l.a;this.UAh=
new l.a;this.xyh=new l.a;this.mAh="";this.j5a=null;this.Su=this.W1e=0;this.oMd=new a.a(0);this.hVe=this.mEh=this.gJd=0;const {MarkerValidation:J}=e(1923);this._state=G;this.vKk=new J}get Xfd(){return this.vKk}get DCj(){return this.j5a}U5o(G){this.W1e=G}Ole(G,J){this.mAh=String.format("{0}-{1}",G,J)}uBe(G){this.Vxl();this.hVe=G}wDg(){this.hVe=0}Vxl(){this.j5a&&this.Nzd.add(this.j5a);this.j5a=null}mj(G){this.j5a||(this.j5a=G);switch(this.hVe){case 1:this.Lqh.add(G);break;case 2:this.UAh.add(G);break;
case 3:this.xyh.add(G);break;default:this.j5a&&this.Nzd.add(G)}}lej(G){this.Nzd.add(G)}wMn(){this.Su=this.AMa();this.Fdb("MergeEnd")}Fdb(G){const J=this.AMa();this.yNh.W(G,J-this.W1e);this.W1e=J}S3o(){this.gJd=this.AMa();this.mEh++}EZ(G){const J=this.AMa();let U;({value:U}=this.oMd.Nc(G)).returnValue?(U+=J-this.gJd,this.oMd.W(G,U)):this.oMd.W(G,J-this.gJd);this.gJd=J}zGm(){this.f0.W("Id",this._state.input.mYb.toString());this.f0.W("Source",v.a[this._state.input.source]);this.f0.W("RevSummary",D.P3a(this.hPm()));
this.f0.W("NodesRolledBackIfFailed",D.P3a(this.DIm()));if(!this._state.output.succeeded){let G,J,U,F,T;({Iil:G,vbm:J,hAp:U,Oil:F,jAp:T}=this.Edm(this._state.runtime));this.f0.W("CharactersLost",this.Crm(G,J,U));this.f0.W("CharactersLostInComments",this.Psm());this.f0.W("CharactersLostInTables",this.Mnm(T,F))}this.f0.W("FuncStep",this.mAh);this.f0.W("FailureDetail",D.P3a(this.BSb()));this.f0.W("FailDetailHints",this.F9d(this.Lqh));this.f0.W("FailDetailNaiveMerge",this.F9d(this.UAh));this.f0.W("FailDetailLcs",
this.F9d(this.xyh));this.f0.W("ExtraDetails",this.F9d(this.Nzd));this.f0.W("Timeline",D.P3a(this.yNh));this.f0.W("ParagraphMergesCount",this.mEh);this.f0.W("ParagraphMergeDurations",D.P3a(this.oMd));this.f0.W("MarkerInfo",D.P3a(this.Xfd.fCi()));this.f0.W("Result",D.P3a(this.BGm()));return JSON.stringify(D.P3a(this.f0))}AMa(){return(new Date).getTime()}hPm(){const G=new a.a;let J,U,F;({aMg:J,gTg:U,RKa:F}=this.jOf(this._state,this._state.input.Jea,this._state.input.R3a,this._state.input.GUb));G.W("hasBase",
F?"true":"false");if(F){let T=0,Y=0;for(;J&&!J.id.equals(F.id);)T++,J=J.rL;for(;U&&!U.id.equals(F.id);)Y++,U=U.rL;G.W("lenToBaseTheirs",J?T:-1);G.W("lenToBaseYours",U?Y:-1)}return G}jOf(G,J,U,F){G=J.Lg(J.length-1-(F?1:0));J=(U=U.Lg(U.length-1))&&G?G.XXa(U):null;return{aMg:G,gTg:U,RKa:J}}DIm(){if(!this._state.runtime.bXi)return null;const G=this._state.runtime.Pw,J=new a.a(0);G.forEach((U,F)=>{({value:U}=J.Nc(F.yc.toString()));J.W(F.yc.toString(),U+1);return!0});return J}Crm(G,J,U){let F=null,T=null,
Y=null;const P=this._state.runtime.Pw;let S=0;try{Y=new H.a(this.QE,this._state);F=y.b(G,J,U);T=new w.a;for(G=0;G<F.length;G++)if(!F.K(G).qNb.Kx(F.K(G).LCb,(N,V)=>N.equals(V))){const N=this.Vki(F.K(G),Y);S+=N;T.add(F.K(G))}F&&P.forEach((N,V)=>{if(V.yc===m.a.paragraphNode){V=null;for(let Z=0;Z<F.length;Z++)if(!T.contains(F.K(Z))&&F.K(Z).LCb.contains(N,(ca,W)=>ca===W)){V=F.K(Z);break}V&&(N=this.Vki(V,Y),T.add(V),S+=N)}return!0});return S}catch(N){return z.a.instance.fb(579190992,1,2,"Exception in GetCharactersLost: "+
N.toString()),-1}}Edm(G){let J,U,F,T,Y;G.IK=S=>{if(750<this.AMa()-this._state.input.K2a)throw z.a.instance.fb(579190991,1,2,"Timed out while calculating characters lost: {0}",S),x.a.invalidOperation(S);};J=new l.a;U=new l.a;F=new l.a;T=new l.a;const P=new l.a;Y=new l.a;try{if(G.Ao){const S=G.Ao.K(E.ChildNodeListMerge.Dse);let N,V;N=G.BC.K(E.ChildNodeListMerge.Dse)||S;V=G.Pw.K(E.ChildNodeListMerge.Dse)||S;this.lGf(S,Z=>G.Ao.K(Z),J,T);this.lGf(N,Z=>G.BC.K(Z)||G.Ao.K(Z),U,P);this.lGf(V,Z=>G.Pw.K(Z)||
G.Ao.K(Z),F,Y)}}catch(S){z.a.instance.fb(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+S.toString())}return{Iil:J,vbm:U,hAp:F,Oil:T,jAp:Y}}Mnm(G,J){try{let F=0;const T=this._state.runtime;var U=S=>T.Pw.K(S)||T.Ao.K(S);const Y=new w.a,P=this.pfm(G,T,U,Y);for(G=0;G<P.count;G++){let S=P.keys.K(G);const N=P.K(S);if(!Y.contains(S)){let V=this.bNi(T,U,Y,S,N);if(-1!==V)F+=V;else return z.a.instance.fb(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(U=
0;U<J.length;U++){let S=J.K(0);if(!Y.contains(S)){let N=this.Obe(T.Ao.K(S));if(-1===N)return z.a.instance.fb(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;F+=N}}return F}catch(F){return z.a.instance.fb(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+F.toString()),-1}}bNi(G,J,U,F,T){G.IK("GetTableCharactersLost");let Y=0;T=this.QE.getPropertyObjectIds(T,f.a.Fg);for(let Z=0;Z<T.length;Z++){var P=J(T.K(Z));P=this.QE.getPropertyObjectIds(P,f.a.Fg);for(let ca=
0;ca<P.length;ca++){var S=J(P.K(ca));if(G.Ao.K(T.K(Z))&&G.Ao.K(P.K(ca))){var N=G.Ao.K(P.K(ca));if(!N)return z.a.instance.fb(573089737,1,2,"Base cell unexpectedly null"),-1;S=this.QE.getPropertyObjectIds(N,f.a.Fg);var V=G.BC.K(P.K(ca))||G.Ao.K(P.K(ca));V=this.QE.getPropertyObjectIds(V,f.a.Fg);N=this.QE.getPropertyObjectIds(N,f.a.Fg);S=y.b(S,V,N);for(N=0;N<S.length;N++){V=S.K(N);const W=this.STm(G,J,U,V);if(-1===W)return z.a.instance.fb(573089738,1,2,"Error getting characters lost for parition {0}",
V.toString()),-1;Y+=W}}else{N=this.MUm(J,S,U);if(-1===N)return z.a.instance.fb(573089736,1,2,"Error getting text length of cell {0}",S.id.toString()),-1;Y+=N}}}U.add(F);return Y}STm(G,J,U,F){let T=0;var Y=new l.a,P=new l.a;const S=new a.a;new a.a;for(var N=0;N<F.qNb.length;N++){var V=G.Ao.K(F.qNb.K(N));V=this.QE.getPropertyObjectIds(V,f.a.FI);if(1!==V.length)return z.a.instance.fb(573089739,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;var Z=G.Ao.K(V.K(0));Z.yc===m.a.paragraphNode?Y.add(Z):
Z.yc===m.a.Fq&&S.add(V.K(0),Z)}for(N=0;N<F.LCb.length;N++){V=J(F.LCb.K(N));V=this.QE.getPropertyObjectIds(V,f.a.FI);if(1!==V.length)return z.a.instance.fb(573089740,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;Z=J(V.K(0));if(Z.yc===m.a.paragraphNode)P.add(Z);else if(Z.yc===m.a.Fq){Z=this.bNi(G,J,U,V.K(0),Z);if(-1===Z)return z.a.instance.fb(573089741,1,2,"Error diffing table {0}",V.K(0).toString()),-1;T+=Z}}N=new H.a(this.QE,this._state);if(0<Y.length&&0<P.length){Y=N.tti(Y,ca=>G.Ao.K(ca),
P,ca=>J(ca));if(-1===Y)return z.a.instance.fb(573089742,1,2,"Problem diffing parition {0} with LCS",F.toString()),-1;T+=Y}else if(0<Y.length)for(F=0;F<Y.length;F++)T+=this.QE.getPropertyString(Y.K(F),f.a.so).length+1;else if(0<P.length)for(F=0;F<P.length;F++)T+=this.QE.getPropertyString(P.K(F),f.a.so).length+1;for(F=0;F<S.count;F++)if(Y=S.keys.K(F),!U.contains(Y)){P=this.Obe(S.K(Y));if(-1===P)return z.a.instance.fb(573089743,1,2,"Error getting length of table {0}",Y.toString()),-1;T+=P}return T}MUm(G,
J,U){let F=0;J=this.QE.getPropertyObjectIds(J,f.a.Fg);for(let P=0;P<J.length;P++){var T=G(J.K(P));T=this.QE.getPropertyObjectIds(T,f.a.FI);if(1!==T.length)return z.a.instance.fb(573089744,1,2,"Unexpected number of ContentNodes: {0}",T.length),-1;var Y=G(T.K(0));if(Y.yc===m.a.paragraphNode)F+=this.QE.getPropertyString(Y,f.a.so).length+1;else if(Y.yc===m.a.Fq){Y=this.Obe(Y);if(-1===Y)return z.a.instance.fb(573089745,1,2,"Problem finding text length of table {0}",T.K(0).toString()),-1;F+=Y;U.add(T.K(0))}}return F}Obe(G){this._state.runtime.IK("GetTextLengthOfTable");
let J=0;const U=S=>this._state.runtime.Pw.K(S)||this._state.runtime.Ao.K(S);G=this.QE.getPropertyObjectIds(G,f.a.Fg);for(let S=0;S<G.length;S++){var F=U(G.K(S));F=this.QE.getPropertyObjectIds(F,f.a.Fg);for(let N=0;N<F.length;N++){var T=U(F.K(N));T=this.QE.getPropertyObjectIds(T,f.a.Fg);for(let V=0;V<T.length;V++){var Y=U(T.K(V));Y=this.QE.getPropertyObjectIds(Y,f.a.FI);if(1!==Y.length)return z.a.instance.fb(573089746,1,2,"Unexpected number of ContentNodes: {0}",Y.length),-1;var P=U(Y.K(0));if(P.yc===
m.a.paragraphNode)J+=this.QE.getPropertyString(P,f.a.so).length+1;else if(P.yc===m.a.Fq){P=this.Obe(P);if(-1===P)return z.a.instance.fb(573089747,1,2,"Error finding the text length of table {0}",Y.K(0)),-1;J+=P}}}}return J}pfm(G,J,U,F){const T=new a.a;for(let Y=0;Y<G.length;Y++){let P=!1;J.Pw.K(G.K(Y))&&(P=!0);const S=U(G.K(Y)),N=this.QE.getPropertyObjectIds(S,f.a.Fg);if(!P)for(let V=0;V<N.length;V++)if(J.Pw.K(N.K(V))){P=!0;break}P?T.add(G.K(Y),S):F.add(G.K(Y))}return T}Vki(G,J){return this.Uki(G.qNb,
G.LCb,J)}Uki(G,J,U){const F=new l.a;for(var T=0;T<G.length;T++)F.add(this._state.runtime.Ao.K(G.K(T)));G=new l.a;for(T=0;T<J.length;T++)G.add(this._state.runtime.Pw.K(J.K(T))||this._state.runtime.Ao.K(J.K(T)));return U.tti(F,Y=>this._state.runtime.Ao.K(Y),G,Y=>this._state.runtime.Pw.K(Y)||this._state.runtime.Ao.K(Y))}lGf(G,J,U,F){if(G.yc===m.a.Kh){G=this.QE.getPropertyObjectIds(G,f.a.Fg);for(let T=0;T<G.length;T++){const Y=this.QE.getPropertyObjectIds(J(G.K(T)),f.a.Fg);for(let P=0;P<Y.length;P++){const S=
this.QE.getPropertyObjectIds(J(Y.K(P)),f.a.Fg);for(let N=0;N<S.length;N++){const V=this.QE.getPropertyObjectIds(J(S.K(N)),f.a.FI);if(1!==V.length)return;const Z=J(V.K(0));Z.yc===m.a.paragraphNode?U.add(V.K(0)):Z.yc===m.a.Fq?F.add(V.K(0)):z.a.instance.fb(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[Z.yc])}}}}}mGf(G,J){G=this.QE.getPropertyObjectIds(G,f.a.Fg);const U=new l.a;for(let F=0;F<G.length;F++){const T=this.QE.getPropertyObjectIds(J(G.K(F)),f.a.FI);if(1!==T.length)return null;
U.add(T.K(0))}return U}Psm(){let G=0;const J=this._state.runtime,U=J.Pw,F=Y=>J.Pw.K(Y)||J.Ao.K(Y);let T=null;J.IK=Y=>{if(750<this.AMa()-this._state.input.K2a)throw z.a.instance.fb(573089749,1,2,"Timed out while calculating comment characters lost: {0}",Y),x.a.invalidOperation(Y);};try{U.forEach((Y,P)=>{if(P.yc===m.a.vL){Y=this.mGf(P,F);var S=J.Ao.K(P.id);if(S)S=this.mGf(S,V=>J.Ao.K(V)),T||(T=new H.a(this.QE,this._state)),G+=this.Uki(S,Y,T);else for(S=0;S<Y.length;S++)G+=this.QE.getPropertyString(J.Pw.K(Y.K(S)),
f.a.so).length+1}if(P.yc===m.a.tma&&(Y=this.QE.getPropertyObjectIds(P,f.a.Fg).FU(),P=J.Ao.K(P.id)))for(P=this.QE.getPropertyObjectIds(P,f.a.Fg),S=0;S<P.length;S++)if(!Y.contains(P.K(S))){var N=J.Ao.K(P.K(S));N=this.mGf(N,V=>J.Ao.K(V));for(let V=0;V<N.length;V++)G+=this.QE.getPropertyString(J.Ao.K(N.K(V)),f.a.so).length+1}return!0})}catch(Y){return z.a.instance.fb(573089750,1,2,"Exception in GetCommentCharactersLost: "+Y.toString()),-1}return G}BSb(){return this.j5a?this.j5a.BSb():null}F9d(G){const J=
new l.a;G.forEach(U=>{J.add(D.P3a(U.BSb()));return!0});return J.toArray()}BGm(){const G=new a.a;G.W("Succeeded",this._state.output.succeeded);G.W("Timeout",this._state.output.timeout);G.W("Crash",this._state.output.dCa);G.W("MergedRevisions",this._state.output.QN?this._state.output.QN.length:-1);G.W("Duration",this.Su-this._state.input.K2a);return G}static P3a(G){if(!G)return null;const J={};G.forEach((U,F)=>{J[U.toString()]=F;return!0});return J}}Object(I.a)(D,"MergeLogger",null,[])},1730:function(I,
K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f,a){this.tRa=a;this.sM=f}}Object(I.a)(m,"UpdateHintCollection",null,[])},1731:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1495);class m extends e.a{constructor(f,a){super();this.Eg=f;this.qd=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}]",this.cp,this.type,this.Eg)}}Object(I.a)(m,"LcsInsertParaUpdateHint",e.a,[])},1732:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);var m=
e(231);e=e(1495);class f extends e.a{constructor(a){super();this.Z4=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.Z4.length;l++)a+=String.format("({0}), ",this.Z4.K(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(I.a)(f,"LcsInsertUpdateHint",e.a,[])},1733:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1495);class m extends e.a{constructor(f,a){super();this.text=a;this.Eg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}]",
this.cp,this.type,this.Eg)}}Object(I.a)(m,"LcsInsertTextUpdateHint",e.a,[])},1734:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1495);class m extends e.a{constructor(f,a,l){super();this.cp=f;this.Eg=a;this.qd=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}]",this.cp,this.type,this.Eg)}}Object(I.a)(m,"LcsDeleteParaUpdateHint",e.a,[])},1735:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1495);class m extends e.a{constructor(f,a){super();
this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}]",this.cp,this.type)}}Object(I.a)(m,"LcsDeleteTextUpdateHint",e.a,[])},1736:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1457);class m extends e.a{constructor(){super()}get aha(){return"Conflict"}}Object(I.a)(m,"ConflictMergeFailureDetail",e.a,[])},1737:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);e=e(1457);class m extends e.a{constructor(){super()}get aha(){return"TableMerge"}}Object(I.a)(m,
"TableMergeFailureDetail",e.a,[])},1739:function(I,K,e){e.d(K,"a",function(){return a});I=e(0);var m=e(236),f=e(16);class a{constructor(l,w,z,x,u){this.K$e=l;this.J$e=w;this.lWk=z;this.rEk=x;this.vrh=u}get f1b(){return 4}Kma(l,w=null){w=w.sessionId+"|"+w.interactionId+"|"+l.wG;if(this.vrh||this.rEk){let z=this.vrh||f.a.BE(CommonUIStrings.l_HelpTooltip)===f.a.BE(l.wG.trim());if(this.lWk&&2<l.wG.length){const x=l.wG;";"===x.charAt(0)&&";"===x.charAt(x.length-1)&&x.substring(1,x.length-1)===a.bWf&&(z=
!0)}l=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.wG);return this.uxi(w,f.a.Mf(l),z)}return this.uxi(w,f.a.Mf(String.format(CommonUIStrings.l_TextWithQuotation,l.wG)),!1)}uxi(l,w,z){return m.a(a.bWf,z?this.J$e:this.K$e,w,"OfficeAssistant_16x16x32","A0",f.a.Mf(l),w,null,null)}}a.bWf="bSearchHelp";Object(I.a)(a,"AssistanceMenuItemFactory",null,[1964])},1740:function(I,K,e){e.d(K,"a",function(){return w});I=e(0);var m=e(2),f=e(236),a=e(105),l=e(16);
class w{get f1b(){return 13}Kma(){return w.Jml()}static Jml(){return f.b(w.rui,"798637440",l.a.Mf(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.mr,a.getImageClass("Info_32x32x32"),null,null,l.a.Mf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.Mf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.rui="bTellMeFirstRun";Object(I.a)(w,"FirstRunMenuItemFactory",null,[1964])},1741:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);
class m{}m.sYi="bInsights";Object(I.a)(m,"InsightsMenuItemFactoryStatic",null,[])},1742:function(I,K,e){e.d(K,"a",function(){return l});I=e(0);var m=e(2),f=e(236),a=e(16);class l{constructor(w=null,z=null){this.vBh=w;this.RLk=z||CommonUIStrings.l_LookupNoResultsDescription}get f1b(){return 14}Kma(w){w=String.format(this.RLk,w.wG);return this.wnl(w)}wnl(w){return f.b(l.Amj,"798637440",a.a.Mf(CommonUIStrings.l_LookupNoResultsTitle),this.vBh?m.AFrameworkApplication.mr:null,this.vBh,null,null,a.a.Mf(CommonUIStrings.l_LookupNoResultsTitle),
"Menu32",null,null,a.a.Mf(w),null,null)}}l.Amj="lookupNoResults";Object(I.a)(l,"NoCommandsFoundMenuItemFactory",null,[1964])},1743:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(I.a)(m,"LabelFormatted",null,[])},1744:function(I,K,e){e.d(K,"a",function(){return z});I=e(0);e(1394);var m=e(1396),f=e(1398),a=e(1400),l=e(1390),w=e(16);class z{constructor(x){this.$c=x}iP(){return"Assistance"}eZ(){return 0===
this.$c.Px?0:1===this.$c.Px?1:this.$c.ljd?3:2}WL(x,u,v=!1,E,y=null){E=new a.a(x);if((!y||Array.contains(y,8))&&!l.a.UT(x)){y=new f.a(8);if(v){v=w.a.BE(CommonUIStrings.l_HelpTooltip)===w.a.BE(x.sh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.sh);const H=[];this.$c.edb&&(this.$c.QCe||H.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),v=this.UHi(x.sh));const D="||"+x.sh;H.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",
v));H.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",D));appChrome.api.dispatch(H);x=new m.a("GetHelpFromTellMe",4,x.sh,null,1)}else x=new m.a("bSearchHelp",4,x.sh,null,1);y.aA(x);y.displayName=CommonUIStrings.l_HelpButtonTitle;E.Jx(y)}u.mv(E)}lub(x,u=null){const v=new f.a(8),E=w.a.BE(CommonUIStrings.l_HelpTooltip)===w.a.BE(x.sh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.sh);for(let H=0;H<u.length&&2>H;H++){var y=[];
let D="GetHelpWithDescriptionFromTellMe"+(H+1).toString(),G=4;if(this.$c.qsd)y.push(appChrome.actions.setControlLabel(D,E)),y.push(appChrome.actions.setCompoundButtonCommandValueId(D,x.sh)),y.push(appChrome.actions.updateCompoundButtonDescription(D,this.uSf(u.length)));else if(this.$c.rsd){let J=this.mOi(u[H]);D="GetHelpFromTellMe"+(H+1).toString();this.$c.edb&&(J=this.UHi(J));G=9;y.push(appChrome.actions.setControlLabel(D,J));y.push(appChrome.actions.setButtonCommandValueId(D,this.BVm(u[H])))}appChrome.api.dispatch(y);
y=new m.a(D,G,null,null,0);y.label=this.mOi(u[H]);y.description=this.AVm(u[H]);v.aA(y);if(this.$c.rsd)break}v.displayName=CommonUIStrings.l_HelpButtonTitle;return v}uSf(x){return 1===x?String.format(CommonUIStrings.l_SearchResultText,x):String.format(CommonUIStrings.l_SearchResultsText,x)}UHi(x){return this.$c.G4f?l.a.jNf(x,CommonUIStrings.l_HelpScopedButtonText):x+CommonUIStrings.l_HelpScopedButtonText}mOi(x){return x.name?x.name:""}AVm(x){return x.description?x.description:""}BVm(x){return x.id?
"AssetID="+x.id:""}}Object(I.a)(z,"AssistanceResultsProvider",null,[845])},1745:function(I,K,e){e.d(K,"a",function(){return x});I=e(0);e(1394);var m=e(1396),f=e(1398),a=e(1400),l=e(1389),w=e(1390),z=e(1456);class x{constructor(u){this.$c=u}iP(){return"Image"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:3===this.$c.Px?3:2}WL(u,v,E,y,H=null){E=new a.a(u);(!H||Array.contains(H,19))&&w.a.UT(u)&&this.$c.vU&&this.lub(u,E,1);v.mv(E)}lub(u,v,E,y=null){var H=[];let D;l.TellMeActorConstants.instance.aP()&&
l.TellMeActorConstants.instance.aP().edb?(D=this.$c.G4f?w.a.jNf(u.sh,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.sh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.$c.QCe||H.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):D=this.$c.vU?w.a.UT(u)?this.$c.Tob?w.a.Wsb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.$c.Tob?w.a.Wsb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.sh)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.sh):this.$c.tAc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.sh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.$c.zDa?(l.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",D)),H=w.a.MWa(u.sh,9,Object.assign(new z.a,{landingTab:"Image"})),l.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",H))):(H.push(appChrome.actions.setControlLabel("ImageForSearch",
D)),u=w.a.MWa(u.sh,9,Object.assign(new z.a,{landingTab:"Image"})),H.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(H));E=new m.a("ImageForSearch",12,null,null,E);y&&(E.score=y.ConfidenceScore);y=new f.a(19,this.$c.tAc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);y.aA(E);v.Jx(y)}}Object(I.a)(x,"ImageResultsProvider",null,[845])},1746:function(I,K,e){e.d(K,"a",function(){return z});I=e(0);e(1394);var m=e(1396),f=e(1398),a=e(1400),
l=e(1390),w=e(2);class z{constructor(x){this.$c=x}iP(){return"Template"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:3}WL(x,u){x=new a.a(x);u.mv(x)}lub(x,u,v){var E=[];let y;y=this.$c.vU?this.$c.Tob?l.a.Wsb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,x.sh)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,x.sh):String.format(CommonUIStrings.l_TellMeTemplateButtonText,x.sh);E.push(appChrome.actions.setControlLabel("TemplateForSearch",y));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.J.rb("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,x.sh)));appChrome.api.dispatch(E);x=new f.a(23);x.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new m.a("TemplateForSearch",24,null,null,0);E.label=v[0].Title?v[0].Title:"";E.description=v[0].Description?v[0].Description:"";x.aA(E);u.Jx(x)}}Object(I.a)(z,"TemplateResultsProvider",null,[845])},1747:function(I,K,e){e.d(K,"a",function(){return v});I=e(0);e(1394);var m=e(1396),f=e(1398),
a=e(1400),l=e(1603),w=e(1390),z=e(16),x=e(1478),u=e(1389);class v{constructor(E,y,H,D){this.QIa=E;this.Rnb=y;this.eOh=D;this.RBk=H;this.$c=u.TellMeActorConstants.instance.aP()}iP(){return"EmptyQuery"}eZ(){return 1===this.$c.Px?1:0}WL(E,y,H=!1,D,G=null){D=new a.a(E);if((!G||Array.contains(G,5)||Array.contains(G,6)||Array.contains(G,4))&&w.a.UT(E)){this.QIa.w5c().length||!this.RBk||this.eOh||(E=new f.a(6),G=new m.a(null,13,void 0,void 0,1),E.aA(G),D.Jx(E));E=new f.a(4);if(0<this.QIa.w5c().length){E.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;G=this.QIa.w5c();var J=[];for(var U of G)J.push(U.Id);x.CommandResultsUtilityHelper.P4b(J,this.$c);for(var F of G)x.CommandResultsUtilityHelper.Dvb(F.Id)&&E.aA(new m.a(F.Id,5,null,null,2));D.Jx(E)}if(this.eOh&&0<this.Rnb.length&&this.QIa.w5c().length<v.maxResults){U=new f.a(5);U.displayName=CommonUIStrings.l_TellMeTryQueryTitle;F=v.maxResults-E.results.length;E=[];for(G=0;G<this.Rnb.length&&G<F;++G){if(H){J=w.a.dOg+(G+1);const T=this.Rnb[G].key,Y=z.a.replaceAll(T,
'"',"");E.push(appChrome.actions.setControlLabel(J,T));E.push(appChrome.actions.setButtonCommandValueId(J,Y));J=new l.a(T,7,0,Y,J)}else J=new l.a(this.Rnb[G].key,7,0,this.Rnb[G].value);U.aA(J)}0<E.length&&appChrome.api.dispatch(E);D.Jx(U)}}y.mv(D)}}v.maxResults=5;Object(I.a)(v,"EmptyQueryResultsProvider",null,[845])},1748:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(){this.FFe=this.YYa=this.Iub=this.ZA=this.BXd=this.sJ=this.G5b=0}}Object(I.a)(m,"TRIESCAN",null,[])},1772:function(I,
K,e){e.r(K);var m=e(0),f=e(1394),a=e(1477),l=e(1422),w=e(1396),z=e(1398),x=e(1400),u=e(1390),v=e(1456),E=e(1389);class y{constructor(gb){this.$c=gb}iP(){return"ActionAI"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb=!1,Cc,id=null){Cc=new x.a(gb);if(!id||Array.contains(id,24))if(this.obp()||!u.a.UT(gb)){id=new z.a(24);var Ad=u.a.UT(gb);Wb&&(Wb=null,u.a.Mva()&&(Wb=u.a.MWa(Ad?"":gb.sh,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.$c.zDa?Wb&&E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
Wb)):(gb=[],Wb&&gb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Wb)),appChrome.api.dispatch(gb)));id.aA(new w.a("ActionAIFromTellMe",25,null,null,1));Cc.Jx(id)}Fb.mv(Cc)}obp(){return u.a.Mva()&&this.$c.nge}}Object(m.a)(y,"ActionAIResultsProvider",null,[845]);var H=e(1633);class D{constructor(gb,Fb){this.rHa=gb;this.xm=Fb}mv(gb){this.rHa.S4o(this.xm,gb)}}Object(m.a)(D,"AggregatorResultsProviderCallback",null,[1966]);class G{constructor(gb){this.Mya=null;this.$c=gb;this.$c.jNb&&
(this.Mya=null)}iP(){return"AppsForOffice"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb,Cc,id=null){Wb=new x.a(gb);if(!id||Array.contains(id,1))id=new z.a(1),this.Mya.B_p(id,gb.sh),Wb.Jx(id);Fb.mv(Wb)}}Object(m.a)(G,"AppsForOfficeRecommendationResultsProvider",null,[845]);var J=e(1744),U=e(1384),F=e(1413),T=e(257);class Y{constructor(gb,Fb){this.Kb=gb;this.lPn=Fb}isMatch(gb,Fb){if(!Object(T.a)(2026,gb))throw Error.argument("objToTest","Expected feature bundle");let Wb;return({value:Wb}=
gb.Rs(this.Kb.sBa)).returnValue?this.Kb.xRg.isMatch(Wb,Fb):this.lPn}}Object(m.a)(Y,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[2035]);class P{constructor(gb,Fb){this.Kb=gb;this.Z$f=Fb}isMatch(gb){if(!Object(T.a)(2026,gb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Z$f^gb.Rs(this.Kb.sBa).returnValue)}}Object(m.a)(P,"AnnotatedWithAnnotationFilter",null,[2035]);class S{constructor(gb){this.Kb=gb}isMatch(gb,Fb){if(!Object(T.a)(2028,gb))throw Error.argument("objToTest",
"Expected struct value");return this.Kb.xRg.isMatch(gb.otb(this.Kb.BXa),Fb)}}Object(m.a)(S,"FieldValueMatchesStructFilter",null,[2035]);class N{constructor(gb,Fb){gb&&(this.BXa=gb.K(0),this.xRg=Fb.Fua(gb.K(1)))}}Object(m.a)(N,"FieldValueMatchesStructFilterInit",null,[]);class V{constructor(gb){this.Z$f=gb}isMatch(gb){if(!Object(T.a)(2026,gb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Z$f^gb.lVf)}}Object(m.a)(V,"HasAnnotationsAnnotationFilter",null,[2035]);class Z{constructor(gb,
Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb){if(!Object(T.a)(2027,gb))throw Error.argument("objToTest","Expected list value");switch(this.wda){case 0:for(const Wb of gb.items)if(this.Kb.filter.isMatch(Wb,Fb))return!0;return!1;case 1:for(const Wb of gb.items)if(!this.Kb.filter.isMatch(Wb,Fb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(Z,"ItemTestListFilter",null,[2035]);class ca{constructor(gb){this.Kb=gb}isMatch(gb,Fb){if(!Object(T.a)(2027,gb))throw Error.argument("objToTest",
"Expected list value");return this.Kb.filter.isMatch(gb.items.length,Fb)}}Object(m.a)(ca,"LengthMatchesListFilter",null,[2035]);class W{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb,Wb=null){let Cc=0===this.wda;for(const id of this.Kb.U6h)if((Cc=id.isMatch(gb,Fb,Wb))?1===this.wda:0===this.wda)return Cc;2===this.wda&&(Cc=!Cc);return Cc}}Object(m.a)(W,"NonterminalFilter",null,[2035]);class X{constructor(gb,Fb){if(gb){var Wb=gb.K(0);this.U6h=Array(Wb);for(let Cc=0;Cc<Wb;++Cc)this.U6h[Cc]=Fb.Fua(gb.K(1+
Cc))}}}Object(m.a)(X,"NonterminalFilterInit",null,[]);class ka{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected number value");let Wb=this.Kb.number;if(this.Kb.query){Fb=this.Kb.query.iw(null,Fb);if("number"!==typeof Fb)throw Error.invalidOperation("Query did not return number");Wb+=Fb}switch(this.wda){case 0:return gb===Wb;case 1:return gb<Wb;case 2:return gb<=Wb;case 3:return gb>Wb;case 4:return gb>=Wb;default:throw Error.notImplemented();
}}}Object(m.a)(ka,"NumberFilter",null,[2035]);class ma{constructor(gb,Fb){gb&&(this.number=gb.K(0),this.query=gb.K(1)?Fb.$O(gb.K(1)):null)}}Object(m.a)(ma,"NumberFilterInit",null,[]);class ja{constructor(gb,Fb,Wb){this.G9d=this.Cym;this.rPn=gb;this.Ogj=Fb;this.Ngj=Wb}Zqf(gb){this.Ogj=gb}Cym(gb){if(!gb)throw Error.argument("name","Invalid named feature bundle reference");const Fb=gb.substr(1);return 1===gb.charCodeAt(0)&&Fb===this.rPn?this.Ogj:this.Ngj?this.Ngj.G9d(gb):null}}Object(m.a)(ja,"SimpleNamedFeatureBundleResolver",
null,[2043]);class na{constructor(gb){this.Kb=gb}isMatch(gb,Fb){if(!Object(T.a)(2026,gb))throw Error.argument("objToTest","Expected feature bundle");gb=this.Kb.query.iw(null,new ja(this.Kb.BJe,gb,Fb));if("boolean"!==typeof gb)throw Error.invalidOperation("Query did not return bool");return gb}}Object(m.a)(na,"PredicateAnnotationFilter",null,[2035]);class Ba{constructor(gb,Fb){gb&&(this.BJe=Fb.lF(gb.K(0)),this.query=Fb.$O(gb.K(1)))}}Object(m.a)(Ba,"PredicateAnnotationFilterInit",null,[]);class Ma{constructor(gb){this.Kb=
gb}isMatch(gb,Fb){if("boolean"!==typeof gb)throw Error.argument("objToTest","Expected bool value");Fb=this.Kb.query.iw(null,Fb);if("boolean"!==typeof Fb)throw Error.invalidOperation("Query did not return bool");return gb===Fb}}Object(m.a)(Ma,"QueryBooleanFilter",null,[2035]);class Ea{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected integer");Fb=this.Kb.query.iw(null,Fb);if("number"!==typeof Fb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.wda){case 0:return gb===Fb;case 1:return 0!==(gb&Fb);case 2:return gb===(gb&Fb);case 3:return Fb===(gb&Fb);default:throw Error.notImplemented();}}}Object(m.a)(Ea,"QueryEnumFilter",null,[2035]);class ya{constructor(gb,Fb){gb&&(this.tie=1===gb.K(0),this.query=Fb.$O(gb.K(1)))}}Object(m.a)(ya,"QueryEnumFilterInit",null,[]);class ia{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb){if(!Object(T.a)(2027,gb))throw Error.argument("objToTest","Expected list value");Fb=this.Kb.query.iw(null,
Fb);if(!Object(T.a)(2027,Fb))throw Error.invalidOperation("Query did not return list value");if(gb.M9!==Fb.M9)return!1;switch(this.wda){case 0:return U.Annotations.iDb(U.Annotations.EFm(gb.M9),gb,Fb);case 1:for(const Wb of gb.items)for(const Cc of Fb.items)if(U.Annotations.iDb(gb.M9,Wb,Cc))return!0;return!1;case 2:for(const Wb of gb.items)for(const Cc of Fb.items)if(!U.Annotations.iDb(gb.M9,Wb,Cc))return!1;return!0;case 3:for(const Wb of Fb.items)for(const Cc of gb.items)if(!U.Annotations.iDb(gb.M9,
Wb,Cc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ia,"QueryListFilter",null,[2035]);class za{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb,Fb){if("string"!==typeof gb)throw Error.argument("objToTest","Expected string");Fb=this.Kb.query.iw(null,Fb);if("string"!==typeof Fb)throw Error.invalidOperation("Query did not return string");this.Kb.Z_f&&(gb=gb.toUpperCase(),Fb=Fb.toUpperCase());switch(this.wda){case 0:return gb===Fb;case 1:return 0<=gb.indexOf(Fb);case 2:return gb.startsWith(Fb);
case 3:return gb.endsWith(Fb);case 4:return 0<=Fb.indexOf(gb);case 5:return Fb.startsWith(gb);case 6:return Fb.endsWith(gb);default:throw Error.notImplemented();}}}Object(m.a)(za,"QueryStringFilter",null,[2035]);class Ca{constructor(gb,Fb){gb&&(this.query=Fb.$O(gb.K(0)),this.Z_f=1===gb.K(1))}}Object(m.a)(Ca,"QueryStringFilterInit",null,[]);class db{constructor(gb){this.Kb=gb}isMatch(gb,Fb){if(!Object(T.a)(2028,gb))throw Error.argument("objToTest","Expected struct value");Fb=this.Kb.query.iw(null,
Fb);if(!Object(T.a)(2028,Fb))throw Error.invalidOperation("Query did not return struct value");return gb.isEqual(gb)}}Object(m.a)(db,"QueryStructFilter",null,[2035]);class pa{constructor(gb){this.Kb=gb}isMatch(gb,Fb){gb=this.Kb.query.iw(null,Fb);if("boolean"!==typeof gb)throw Error.invalidOperation("Query did not return bool");return gb}}Object(m.a)(pa,"QueryWhereConstraintFilter",null,[2035]);class ua{constructor(gb){this.Kb=gb}isMatch(gb){if("string"!==typeof gb)throw Error.argument("objToTest",
"Expected string");return this.Kb.ond.test(gb)}}Object(m.a)(ua,"RegexStringFilter",null,[2035]);class Ga{constructor(gb,Fb){gb&&(this.ond=Fb.gnc(gb.K(0)))}}Object(m.a)(Ga,"RegexStringFilterInit",null,[]);class wa{constructor(gb,Fb){gb&&(this.filter=Fb.Fua(gb.K(0)))}}Object(m.a)(wa,"SingleFilterFilterInit",null,[]);class xa{constructor(gb,Fb){gb&&(this.query=Fb.$O(gb.K(0)))}}Object(m.a)(xa,"SingleQueryFilterInit",null,[]);class sa{constructor(gb){this.Kb=gb}isMatch(gb){if("boolean"!==typeof gb)throw Error.argument("objToTest",
"Expected bool value");return gb===this.Kb.value}}Object(m.a)(sa,"StoredValueBooleanFilter",null,[2035]);class Ka{constructor(gb){gb&&(this.value=1===gb.K(0))}}Object(m.a)(Ka,"StoredValueBooleanFilterInit",null,[]);class Na{constructor(gb,Fb){this.Kb=gb;this.wda=Fb}isMatch(gb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected integer");switch(this.wda){case 0:return this.Kb.tie?this.Kb.value?!!(gb&this.Kb.value):!gb:gb===this.Kb.value;case 1:return this.Kb.tie?(gb&this.Kb.value)===
this.Kb.value:32>gb&&(1<<gb&this.Kb.value)===this.Kb.value;case 2:return this.Kb.tie?!!(gb&this.Kb.value):32>gb&&!!(1<<gb&this.Kb.value);default:throw Error.notImplemented();}}}Object(m.a)(Na,"StoredValueEnumFilter",null,[2035]);class ub{constructor(gb){gb&&(this.tie=1===gb.K(0),this.value=gb.K(1))}}Object(m.a)(ub,"StoredValueEnumFilterInit",null,[]);class Ua{constructor(){this.ogo=null;this.Jpf=this.CUb=0}}Object(m.a)(Ua,"WHEREConstraintData",null,[]);class sb{constructor(gb){this.Kb=gb}isMatch(gb,
Fb){if(!Object(T.a)(Ua,gb))throw Error.argument("objToTest","Expected WHERE constraint data");let Wb=-1,Cc=-1;const id=gb.ogo;switch(this.Kb.Jqf){case 4:Wb=id.K3c;Cc=id.WHg;break;case 5:Wb=gb.CUb;Cc=id.K3c-gb.CUb;break;case 6:Wb=id.K3c+id.WHg;Cc=gb.CUb+gb.Jpf-Wb;break;case 1:case 2:case 3:let Ad=!1;for(let Cd=id.O1p;Cd;Cd=Cd.next)if(this.Kb.HKp===Cd.name){Ad=!0;1===this.Kb.Jqf?(Wb=Cd.K3c,Cc=Cd.WHg):2===this.Kb.Jqf?(Wb=gb.CUb,Cc=Cd.K3c-gb.CUb):(Wb=Cd.K3c+Cd.WHg,Cc=gb.CUb+gb.Jpf-Wb);break}if(!Ad)return!1;
break;case 7:Wb=gb.CUb;Cc=gb.Jpf;break;default:throw Error.notImplemented();}return null!==this.Kb.Mjp.B$p(id.pwq,Wb,Cc,Wb,!0,2,Fb)}}Object(m.a)(sb,"SubSreWhereConstraintFilter",null,[2035]);class qb{constructor(gb,Fb){if(gb){var Wb=Fb.lF(gb.K(0));this.Jqf=Wb.charCodeAt(0);this.HKp=Wb.substr(1);this.Mjp=Fb.SPm(gb.K(1))}}}Object(m.a)(qb,"SubSreWhereConstraintFilterInit",null,[]);class ab{constructor(gb){this.Kb=gb}isMatch(gb,Fb,Wb=null){if(!Object(T.a)(2026,gb))throw Error.argument("objToTest","Expected feature bundle");
if(null==Wb)throw Error.argumentNull("parentTextForSpan");if(this.Kb.LWh&&!this.Kb.LWh.isMatch(gb,Fb))return!1;if(this.Kb.PLg){let Cc;if(({value:Cc}=gb.Rs(this.Kb.Hip)).returnValue){if(!this.Kb.PLg.isMatch(Cc,Fb))return!1}else{let id,Ad;if(!({value:id}=gb.Rs(this.Kb.t1j)).returnValue||!({value:Ad}=gb.Rs(this.Kb.s1j)).returnValue||0>id||0>Ad||id+Ad>Wb.length||!this.Kb.PLg.isMatch(Wb.substr(id,Ad),Fb))return!1}}if(this.Kb.l2j){let Cc;if(!({value:Cc}=gb.Rs(this.Kb.t1j)).returnValue||!this.Kb.l2j.isMatch(Cc,
Fb))return!1}if(this.Kb.ebj){let Cc;if(!({value:Cc}=gb.Rs(this.Kb.s1j)).returnValue||!this.Kb.ebj.isMatch(Cc,Fb))return!1}return!0}}Object(m.a)(ab,"TextSpanFilter",null,[2035]);class Xa{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.t1j=gb.K(0),this.s1j=gb.K(1),this.Hip=gb.K(2),this.PLg=gb.K(3)?Fb.Fua(gb.K(3)):null,this.LWh=gb.K(4)?Fb.Fua(gb.K(4)):null,this.l2j=gb.K(5)?Fb.Fua(gb.K(5)):null,this.ebj=gb.K(6)?Fb.Fua(gb.K(6)):null)}}Object(m.a)(Xa,"TextSpanFilterInit",null,[]);class wb{constructor(gb,
Fb){gb&&(this.annotations=Fb.annotations,this.sBa=gb.K(0),this.xRg=gb.K(1)?Fb.Fua(gb.K(1)):null)}}Object(m.a)(wb,"ValueFilterAnnotationFilterInit",null,[]);var Sa=e(1436);class cc{Fua(gb,Fb){const Wb=gb.K(0),Cc=new Sa.a;Cc.Dsb(gb,1,gb.count-1);switch(Wb){case 1:return new W(new X(Cc,Fb),0);case 2:return new W(new X(Cc,Fb),1);case 3:return new W(new X(Cc,Fb),2);case 101:return new ua(new Ga(Cc,Fb));case 103:return new za(new Ca(Cc,Fb),0);case 104:return new za(new Ca(Cc,Fb),1);case 105:return new za(new Ca(Cc,
Fb),2);case 106:return new za(new Ca(Cc,Fb),3);case 107:return new za(new Ca(Cc,Fb),4);case 108:return new za(new Ca(Cc,Fb),5);case 109:return new za(new Ca(Cc,Fb),6);case 201:return new sa(new Ka(Cc));case 202:return new Ma(new xa(Cc,Fb));case 301:return new ka(new ma(Cc,Fb),0);case 302:return new ka(new ma(Cc,Fb),1);case 303:return new ka(new ma(Cc,Fb),2);case 304:return new ka(new ma(Cc,Fb),3);case 305:return new ka(new ma(Cc,Fb),4);case 401:return new Na(new ub(Cc),0);case 402:return new Na(new ub(Cc),
1);case 403:return new Na(new ub(Cc),2);case 404:return new Ea(new ya(Cc,Fb),0);case 405:return new Ea(new ya(Cc,Fb),1);case 406:return new Ea(new ya(Cc,Fb),2);case 407:return new Ea(new ya(Cc,Fb),3);case 501:return new S(new N(Cc,Fb));case 502:return new db(new xa(Cc,Fb));case 601:return new Z(new wa(Cc,Fb),0);case 602:return new Z(new wa(Cc,Fb),1);case 603:return new ca(new wa(Cc,Fb));case 604:return new ia(new xa(Cc,Fb),0);case 605:return new ia(new xa(Cc,Fb),1);case 606:return new ia(new xa(Cc,
Fb),2);case 607:return new ia(new xa(Cc,Fb),3);case 701:return new V(!1);case 702:return new V(!0);case 703:return new P(new wb(Cc,Fb),!1);case 704:return new P(new wb(Cc,Fb),!0);case 705:return new Y(new wb(Cc,Fb),!1);case 706:return new Y(new wb(Cc,Fb),!0);case 707:return new na(new Ba(Cc,Fb));case 901:return new ab(new Xa(Cc,Fb));case 1002:return new pa(new xa(Cc,Fb));case 1001:return new sb(new qb(Cc,Fb));default:throw Error.argument("initData");}}}Object(m.a)(cc,"FilterFactory",null,[2031]);
var Cb=e(1392);class Wa{constructor(gb){this.Kb=gb}get yH(){return this.Kb.yH}get o$(){return this.Kb.o$}get $Ee(){return this.Kb.$Ee}get Yge(){return this.Kb.Yge}load(gb,Fb){return this.iw(gb,gb?new ja("root",gb,Fb):Fb)}store(gb,Fb,Wb){this.vBc(gb,Fb,gb?new ja("root",gb,Wb):Wb,null)}iw(gb,Fb){if(!this.Yge&&!this.Kb.annotations.Vqc(this.yH,gb))throw Error.argument("input","Input value not of expected type");let Wb=this.Kb.uui;for(;Wb;)gb=Wb.load(gb,Fb),Wb=Wb.next;return gb}vBc(gb,Fb,Wb,Cc){if(!this.$Ee)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.Yge&&!this.Kb.annotations.Vqc(this.yH,gb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Kb.annotations.Vqc(this.o$,Fb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Kb.uui.store(gb,Fb,Wb,Cc)}static h9h(gb,Fb,Wb,Cc){if(Wb===Cc)return Fb;if(U.Annotations.pM(Wb)&&U.Annotations.pM(Cc)){Wb=U.Annotations.Yab(Wb);Cc=U.Annotations.Yab(Cc);const id=new Cb.a(gb,Cc);for(const Ad of Fb.items)Array.add(id.items,Wa.h9h(gb,Ad,Wb,Cc));return id}if(Wb===
U.Annotations.jRa){if(Cc===U.Annotations.sya)return Fb;if(Cc===U.Annotations.Lea)return Fb.toString()}else if(Wb===U.Annotations.sya){if(Cc===U.Annotations.jRa)return Math.floor(Fb);if(Cc===U.Annotations.Lea)return Fb.toString()}else if(Wb===U.Annotations.Lea){if(Cc===U.Annotations.jRa)return parseInt(Fb);if(Cc===U.Annotations.sya)return parseFloat(Fb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(Wa,"AnnotationQuery",null,[2037]);class Ja{constructor(){this.o$=
this.yH=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}bbb(gb){if(this.next)return{returnValue:this.next,EQa:gb};if(gb){const Fb=gb.Abi;gb=gb.UAj;return{returnValue:Fb,EQa:gb}}return{returnValue:null,EQa:gb}}}Object(m.a)(Ja,"AnnotationQueryStep",null,[2049]);class Va extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=this.Kb.query.iw(gb,Fb);if(U.Annotations.pM(this.yH)){var Wb=U.Annotations.Yab(this.yH);let id=new Cb.a(this.Kb.annotations,Wb);if(U.Annotations.pM(this.Kb.query.o$)){if(gb.items.length!==
Fb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Ad=0,Cd=gb.items.length;Ad<Cd;++Ad)Array.add(id.items,this.KXd(gb.items[Ad],Fb.items[Ad],Wb===U.Annotations.sya))}else for(var Cc of gb.items)Array.add(id.items,this.KXd(Cc,Fb,Wb===U.Annotations.sya));return id}if(U.Annotations.pM(this.Kb.query.o$)){Cc=new Cb.a(this.Kb.annotations,this.yH);for(Wb of Fb.items)Array.add(Cc.items,this.KXd(gb,Wb,this.yH===U.Annotations.sya));return Cc}return this.KXd(gb,
Fb,this.yH===U.Annotations.sya)}KXd(gb,Fb,Wb){gb=this.Igc(gb,Fb);return Wb?gb:Math.floor(gb)}}Object(m.a)(Va,"NumericAnnotationQueryStep",Ja,[]);class mb extends Va{constructor(gb){super(gb)}Igc(gb,Fb){return gb+Fb}}Object(m.a)(mb,"AddAnnotationQueryStep",Va,[]);class Ab extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){if(this.yH===U.Annotations.PGa&&this.Kb.query.o$===U.Annotations.PGa){let id;if(({result:id}=this.q4h(gb)).returnValue)return id}if(U.Annotations.pM(this.yH)){var Wb=new Cb.a(this.Kb.annotations,
U.Annotations.PGa);Fb=this.Kb.query.iw(gb,Fb);if(U.Annotations.pM(this.Kb.query.o$)){if(gb.items.length!==Fb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let id=0,Ad=gb.items.length;id<Ad;++id)Array.add(Wb.items,this.hZc(Fb.items[id],gb.items[id]))}else for(var Cc of gb.items)Array.add(Wb.items,this.hZc(Fb,Cc));return Wb}Cc=this.Kb.query.iw(gb,Fb);if(U.Annotations.pM(this.Kb.query.o$)){Fb=new Cb.a(this.Kb.annotations,U.Annotations.PGa);for(Wb of Cc.items)Array.add(Fb.items,
this.hZc(Wb,gb));return Fb}return this.hZc(Cc,gb)}}Object(m.a)(Ab,"BinaryBooleanAnnotationQueryStep",Ja,[]);class Xb extends Ab{constructor(gb){super(gb)}q4h(gb){return{returnValue:!gb,result:!1}}hZc(gb,Fb){return gb&&Fb}}Object(m.a)(Xb,"AndAnnotationQueryStep",Ab,[]);class Lb{constructor(gb){gb&&(this.annotations=gb)}}Object(m.a)(Lb,"AnnotationsOnlyQueryStepInit",null,[]);class dc extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=this.Kb.query.iw(gb,Fb);gb=gb.clone();U.Annotations.pM(this.Kb.query.o$)?
Array.addRange(gb.items,Fb.items):Array.add(gb.items,Fb);return gb}}Object(m.a)(dc,"AppendAnnotationQueryStep",Ja,[]);class yc extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){if(this.yH===U.Annotations.r_)return this.R2c(gb,Fb);const Wb=new Cb.a(this.Kb.annotations,U.Annotations.r_);for(const Cc of gb.items)Array.add(Wb.items,this.R2c(Cc,Fb));return Wb}R2c(gb,Fb){const Wb=new F.a(this.Kb.annotations);Wb.I9a(gb);gb=new F.a(this.Kb.annotations);this.Kb.script.uXa(null,new ja("Input",Wb,new ja("Output",
gb,Fb)));return gb}}Object(m.a)(yc,"ApplyAnnotationQueryStep",Ja,[]);class Wc extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){if(this.yH===U.Annotations.r_)return Fb=this.R2c(gb,Fb),Fb.Rs(this.Kb.JWh).returnValue||new Cb.a(this.Kb.annotations,U.Annotations.r_),Fb;const Wb=new Cb.a(this.Kb.annotations,U.Annotations.r_);for(const Cc of gb.items)if(gb=this.R2c(Cc,Fb),({value:gb}=gb.Rs(this.Kb.JWh)).returnValue)for(const id of gb.items)Array.add(Wb.items,id);return Wb}R2c(gb,Fb){const Wb=new F.a(this.Kb.annotations);
Wb.I9a(gb);gb=new F.a(this.Kb.annotations);this.Kb.script.uXa(null,new ja("Input",Wb,new ja("Output",gb,Fb)));return gb}}Object(m.a)(Wc,"ApplyExpandAnnotationQueryStep",Ja,[]);class zb{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.script=Fb.bSb(gb.K(0)),this.JWh=gb.K(1))}}Object(m.a)(zb,"ApplyExpandQueryStepInit",null,[]);class cd{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.script=Fb.bSb(gb.K(0)))}}Object(m.a)(cd,"ApplyQueryStepInit",null,[]);class qc extends Ja{constructor(gb){super();
this.Kb=gb}load(gb){if(this.yH===U.Annotations.r_)return this.ple(gb);const Fb=new Cb.a(this.Kb.annotations,this.Kb.annotations.getAttributeType(this.Kb.sBa));for(const Wb of gb.items)Array.add(Fb.items,this.ple(Wb));return Fb}store(gb,Fb,Wb,Cc){if(this.yH===U.Annotations.r_){var id=Fb,Ad=({EQa:Cc}=this.bbb(Cc)).returnValue;Ad&&(id=Ad.store(U.Annotations.FY(this.ple(gb)),Fb,Wb,Cc));gb.bC(this.Kb.sBa,id)}else{var Cd=Fb;if(id=({EQa:Cc}=this.bbb(Cc)).returnValue){Cd=new Cb.a(this.Kb.annotations,this.Kb.annotations.getAttributeType(this.Kb.sBa));
for(Ad of gb.items)Array.add(Cd.items,this.ple(Ad));Cd=id.store(Cd,Fb,Wb,Cc)}Fb=Cd;if(Fb.items.length!==gb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let qe=0,df=gb.items.length;qe<df;++qe)Wb=gb.items[qe],Wb.isReadOnly&&(Wb=Wb.clone(),gb.items[qe]=Wb),Wb.bC(this.Kb.sBa,Fb.items[qe])}return gb}ple(gb){({value:gb}=gb.Rs(this.Kb.sBa)).returnValue||(gb=this.Kb.annotations.Kom(this.Kb.sBa));return gb}}Object(m.a)(qc,"AttrAnnotationQueryStep",Ja,
[]);class Dc{constructor(gb,Fb){gb&&(this.annotations=Fb,this.sBa=gb.K(0))}}Object(m.a)(Dc,"AttrQueryStepInit",null,[]);class mc extends Ja{constructor(gb){super();this.Kb=gb}load(gb){const Fb=new F.a(this.Kb.annotations);Fb.I9a(gb);return this.Kb.module.execute(Fb)}}Object(m.a)(mc,"CallModuleAnnotationQueryStep",Ja,[]);class lc{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.module=Fb.UOf(gb.K(0)))}}Object(m.a)(lc,"CallModuleQueryStepInit",null,[]);class Vb extends Ja{constructor(gb){super();
this.Kb=gb}load(gb,Fb){if(U.Annotations.pM(this.yH)){var Wb=this.Kb.query.iw(gb,Fb);Fb=new Cb.a(this.Kb.annotations,U.Annotations.Lea);let Ad="string"===typeof Wb;for(var Cc of gb.items)if(Ad)Array.add(Fb.items,Cc+Wb);else for(var id of Wb.items)Array.add(Fb.items,Cc+id);return Fb}Cc=this.Kb.query.iw(gb,Fb);if("string"===typeof Cc)return gb+Cc;id=new Cb.a(this.Kb.annotations,U.Annotations.Lea);for(Wb of Cc.items)Array.add(id.items,gb+Wb);return id}}Object(m.a)(Vb,"ConcatAnnotationQueryStep",Ja,[]);
class yb extends Ja{constructor(gb){super();this.Kb=gb}load(gb){return Wa.h9h(this.Kb.annotations,gb,this.yH,this.o$)}}Object(m.a)(yb,"ConvertAnnotationQueryStep",Ja,[]);class Db extends Ja{constructor(){super()}load(gb){return gb.items.length}}Object(m.a)(Db,"CountAnnotationQueryStep",Ja,[]);class $b extends Va{constructor(gb){super(gb)}Igc(gb,Fb){return gb/Fb}}Object(m.a)($b,"DivideAnnotationQueryStep",Va,[]);class Fa extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=new ja(this.Kb.BJe,
null,Fb);for(const Wb of gb.items)if(Fb.Zqf(Wb),this.Kb.query.iw(Wb,Fb))return!0;return!1}}Object(m.a)(Fa,"ExistsAnnotationQueryStep",Ja,[]);class lb extends Va{constructor(gb){super(gb)}Igc(gb,Fb){return Math.pow(gb,Fb)}}Object(m.a)(lb,"ExpAnnotationQueryStep",Va,[]);class kb{constructor(gb,Fb){gb&&(this.AXa=Fb.lF(gb.K(0)))}}Object(m.a)(kb,"FeatureBundleNameQueryStepInit",null,[]);class Ob extends Ja{constructor(gb){super();this.Kb=gb}load(gb){if(U.Annotations.pM(this.yH)){const Fb=new Cb.a(this.Kb.annotations,
this.Kb.annotations.CTb(U.Annotations.Yab(this.yH),this.Kb.BXa));for(const Wb of gb.items)Array.add(Fb.items,Wb.otb(this.Kb.BXa));return Fb}return gb.otb(this.Kb.BXa)}store(gb,Fb,Wb,Cc){if(U.Annotations.pM(this.yH)){var id=Fb,Ad=({EQa:Cc}=this.bbb(Cc)).returnValue;if(Ad){id=new Cb.a(this.Kb.annotations,this.Kb.annotations.CTb(U.Annotations.Yab(this.yH),this.Kb.BXa));for(var Cd of gb.items)Array.add(id.items,Cd.otb(this.Kb.BXa));id=Ad.store(id,Fb,Wb,Cc)}Fb=id;if(Fb.items.length!==gb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let qe=0,df=gb.items.length;qe<df;++qe)Wb=gb.items[qe],Wb.isReadOnly&&(Wb=Wb.clone(),gb.items[qe]=Wb),Wb.PCg(this.Kb.BXa,Fb.items[qe])}else Ad=Fb,(Cd=({EQa:Cc}=this.bbb(Cc)).returnValue)&&(Ad=Cd.store(U.Annotations.FY(gb.otb(this.Kb.BXa)),Fb,Wb,Cc)),gb.PCg(this.Kb.BXa,Ad);return gb}}Object(m.a)(Ob,"FieldAnnotationQueryStep",Ja,[]);class nc{constructor(gb,Fb){gb&&(this.annotations=Fb,this.BXa=gb.K(0))}}Object(m.a)(nc,"FieldQueryStepInit",null,[]);class zc extends Ja{constructor(gb){super();this.Kb=
gb}load(gb,Fb){for(const Wb of gb.items)if(this.Kb.filter.isMatch(Wb,Fb))return Wb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(gb,Fb,Wb,Cc){let id=Fb,Ad=-1;for(let qe=0,df=gb.items.length;qe<df;qe++)if(this.Kb.filter.isMatch(gb.items[qe],Wb)){Ad=qe;break}if(0>Ad)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Cd=({EQa:Cc}=this.bbb(Cc)).returnValue;Cd&&(id=Cd.store(U.Annotations.FY(gb.items[Ad]),Fb,Wb,Cc));
gb.items[Ad]=id;return gb}}Object(m.a)(zc,"FirstItemMatchingAnnotationQueryStep",Ja,[]);class Pb extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=new ja(this.Kb.BJe,null,Fb);for(const Wb of gb.items)if(Fb.Zqf(Wb),!this.Kb.query.iw(Wb,Fb))return!1;return!0}}Object(m.a)(Pb,"ForAllAnnotationQueryStep",Ja,[]);class tb extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){gb=Fb?Fb.G9d(this.Kb.AXa):null;if(!gb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Kb.AXa+
'"');return gb}store(gb,Fb,Wb,Cc){gb=Wb?Wb.G9d(this.Kb.AXa):null;if(!gb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Kb.AXa+'"');let id=Fb;const Ad=({EQa:Cc}=this.bbb(Cc)).returnValue;Ad&&(id=Ad.store(gb,Fb,Wb,Cc));gb!==id&&gb.I9a(id);return gb}}Object(m.a)(tb,"GetAnnotationQueryStep",Ja,[]);class ib{constructor(gb,Fb){this.$xk=gb;this.EPk=Fb}get Abi(){return this.$xk}get UAj(){return this.EPk}}Object(m.a)(ib,"AnnotationQueryStoreContinuation",null,[2050]);class Rb extends Ja{constructor(gb){super();
this.Kb=gb}load(gb,Fb){return this.Kb.XFe.iw(gb,Fb)?this.Kb.W8j.iw(gb,Fb):this.Kb.V5d?this.Kb.V5d.iw(gb,Fb):gb}store(gb,Fb,Wb,Cc){var id=this.Kb.XFe.iw(gb,Wb);this.next&&(Cc=new ib(this.next,Cc));if(id)return this.Kb.W8j.vBc(gb,Fb,Wb,Cc);if(this.Kb.V5d)return this.Kb.V5d.vBc(gb,Fb,Wb,Cc);id=Fb;let Ad=null;Cc&&(Ad=Cc.Abi,Cc=Cc.UAj);Ad&&(id=Ad.store(U.Annotations.FY(gb),Fb,Wb,Cc));return id}}Object(m.a)(Rb,"IfAnnotationQueryStep",Ja,[]);class gc{constructor(gb,Fb){gb&&(this.XFe=Fb.$O(gb.K(0)),this.W8j=
Fb.$O(gb.K(1)),this.V5d=gb.K(2)?Fb.$O(gb.K(2)):null)}}Object(m.a)(gc,"IfQueryStepInit",null,[]);class xc{constructor(gb,Fb){gb&&(this.Abn=Fb.$O(gb.K(0)),this.V9i=Fb.$O(gb.K(1)))}}Object(m.a)(xc,"IndexAndItemQueryStepInit",null,[]);class Nc extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){const Wb=this.Kb.Abn.iw(gb,Fb);Fb=this.Kb.V9i.iw(gb,Fb);gb=gb.clone();if(0>Wb||Wb>gb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(U.Annotations.pM(this.Kb.V9i.o$))for(let Cc=
0;Cc<Fb.items.length;++Cc)Array.insert(gb.items,Wb+Cc,Fb.items[Cc]);else Array.insert(gb.items,Wb,Fb);return gb}}Object(m.a)(Nc,"InsertAtAnnotationQueryStep",Ja,[]);class Kc extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){return!(!Fb||!Fb.G9d(this.Kb.AXa))}}Object(m.a)(Kc,"IsDefinedAnnotationQueryStep",Ja,[]);class fd extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=this.qN(gb,Fb);return gb.items[Fb]}store(gb,Fb,Wb,Cc){const id=this.qN(gb,Wb);let Ad=Fb;const Cd=({EQa:Cc}=this.bbb(Cc)).returnValue;
Cd&&(Ad=Cd.store(U.Annotations.FY(gb.items[id]),Fb,Wb,Cc));gb.items[id]=Ad;return gb}qN(gb,Fb){Fb=this.Kb.query.iw(gb,Fb);if(0>Fb||Fb>=gb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Fb}}Object(m.a)(fd,"ItemAnnotationQueryStep",Ja,[]);class jd extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){const Wb=new Cb.a(this.Kb.annotations,U.Annotations.Yab(this.yH));for(const Cc of gb.items)this.Kb.filter.isMatch(Cc,Fb)&&Array.add(Wb.items,Cc);return Wb}}
Object(m.a)(jd,"ItemsMatchingAnnotationQueryStep",Ja,[]);class Id extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){Fb=this.qN(gb,Fb);return gb.items[gb.items.length-Fb-1]}store(gb,Fb,Wb,Cc){const id=this.qN(gb,Wb);let Ad=Fb;const Cd=({EQa:Cc}=this.bbb(Cc)).returnValue;Cd&&(Ad=Cd.store(U.Annotations.FY(gb.items[gb.items.length-id-1]),Fb,Wb,Cc));gb.items[gb.items.length-id-1]=Ad;return gb}qN(gb,Fb){Fb=this.Kb.query?this.Kb.query.iw(gb,Fb):0;if(0>Fb||Fb>=gb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Fb}}Object(m.a)(Id,"LastItemAnnotationQueryStep",Ja,[]);class ce extends Ja{constructor(gb){super();this.Kb=gb}load(gb){if(U.Annotations.pM(this.yH)){const Fb=new Cb.a(this.Kb.annotations,U.Annotations.jRa);for(const Wb of gb.items)Array.add(Fb.items,Wb.length);return Fb}return gb.length}}Object(m.a)(ce,"LengthAnnotationQueryStep",Ja,[]);class Fe extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){if(U.Annotations.pM(this.yH)){const Wb=new Cb.a(this.Kb.annotations,U.Annotations.PGa);
for(const Cc of gb.items)Array.add(Wb.items,this.Kb.filter.isMatch(Cc,Fb));return Wb}return this.Kb.filter.isMatch(gb,Fb)}}Object(m.a)(Fe,"MatchesAnnotationQueryStep",Ja,[]);class Fd extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){return this.Kb.filter.isMatch(gb,Fb)}}Object(m.a)(Fd,"MatchesAsListAnnotationQueryStep",Ja,[]);class Qb extends Va{constructor(gb){super(gb)}Igc(gb,Fb){return gb%Fb}}Object(m.a)(Qb,"ModuloAnnotationQueryStep",Va,[]);class ch extends Va{constructor(gb){super(gb)}Igc(gb,
Fb){return gb*Fb}}Object(m.a)(ch,"MultiplyAnnotationQueryStep",Va,[]);class Nf extends Ja{constructor(gb){super();this.Kb=gb}load(gb){if(U.Annotations.pM(this.yH)){const Fb=new Cb.a(this.Kb.annotations,U.Annotations.PGa);for(const Wb of gb.items)Array.add(Fb.items,!Wb);return Fb}return!gb}}Object(m.a)(Nf,"NotAnnotationQueryStep",Ja,[]);class Mf extends Ab{constructor(gb){super(gb)}q4h(gb){return{returnValue:gb,result:!0}}hZc(gb,Fb){return gb||Fb}}Object(m.a)(Mf,"OrAnnotationQueryStep",Ab,[]);class Df extends Ja{constructor(gb){super();
this.Kb=gb}load(gb,Fb){const Wb=this.Kb.SIg.iw(gb,Fb);gb=this.Kb.b_c.iw(gb,Fb);Fb=new Cb.a(this.Kb.annotations,U.Annotations.jRa);for(let Cc=0;Cc<gb;++Cc)Array.add(Fb.items,Wb+Cc);return Fb}}Object(m.a)(Df,"RangeAnnotationQueryStep",Ja,[]);class Ig{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.filter=Fb.Fua(gb.K(0)))}}Object(m.a)(Ig,"SingleFilterQueryStepInit",null,[]);class pg{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.query=gb.K(0)?Fb.$O(gb.K(0)):null)}}Object(m.a)(pg,
"SingleOptionalQueryQueryStepInit",null,[]);class Rf{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.query=Fb.$O(gb.K(0)))}}Object(m.a)(Rf,"SingleQueryQueryStepInit",null,[]);class qf{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.SIg=Fb.$O(gb.K(0)),this.b_c=gb.K(1)?Fb.$O(gb.K(1)):null)}}Object(m.a)(qf,"StartAndCountOrLengthQueryStepInit",null,[]);class Mh extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){let Wb;({startIndex:Fb,length:Wb}=this.tbe(gb,Fb));const Cc=
new Cb.a(this.Kb.annotations,gb.M9);for(let id=0;id<Wb;++id)Array.add(Cc.items,gb.items[Fb+id]);return Cc}store(gb,Fb,Wb,Cc){let id,Ad;({startIndex:id,length:Ad}=this.tbe(gb,Wb));var Cd=Fb;const qe=({EQa:Cc}=this.bbb(Cc)).returnValue;if(qe){Cd=new Cb.a(this.Kb.annotations,gb.M9);for(let df=0;df<Ad;++df)Array.add(Cd.items,gb.items[id+df]);Cd=qe.store(Cd,Fb,Wb,Cc)}Fb=Cd;for(Wb=0;Wb<Ad;++Wb)Array.removeAt(gb.items,id);for(let df=0,Ef=Fb.items.length;df<Ef;++df)Array.insert(gb.items,id+df,Fb.items[df]);
return gb}tbe(gb,Fb){let Wb;Wb=this.Kb.SIg.iw(gb,Fb);if(0>Wb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Fb=this.Kb.b_c?this.Kb.b_c.iw(gb,Fb):gb.items.length-Wb;if(0>Fb||Wb+Fb>gb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Wb,length:Fb}}}Object(m.a)(Mh,"SublistAnnotationQueryStep",Ja,[]);class ed extends Ja{constructor(gb){super();this.Kb=gb}load(gb,Fb){if(U.Annotations.pM(this.yH)){const Wb=
new Cb.a(this.Kb.annotations,U.Annotations.Lea);for(let Cc=0,id=gb.items.length;Cc<id;++Cc)Array.add(Wb.items,this.OMi(gb.items[Cc],Fb));return Wb}return this.OMi(gb,Fb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}OMi(gb,Fb){let Wb;({startIndex:Fb,length:Wb}=this.tbe(gb,Fb));return gb.substr(Fb,Wb)}tbe(gb,Fb){let Wb;Wb=this.Kb.SIg.iw(gb,Fb);if(0>Wb)throw Error.invalidOperation("Invalid start index in Substring() query step");Fb=this.Kb.b_c?this.Kb.b_c.iw(gb,
Fb):gb.length-Wb;if(0>Fb||Wb+Fb>gb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Wb,length:Fb}}}Object(m.a)(ed,"SubstringAnnotationQueryStep",Ja,[]);class dd extends Va{constructor(gb){super(gb)}Igc(gb,Fb){return gb-Fb}}Object(m.a)(dd,"SubtractAnnotationQueryStep",Va,[]);class Vh extends Ja{constructor(gb){super();this.Kb=gb}load(gb){const Fb=new Cb.a(this.Kb.annotations,U.Annotations.Lea);for(let Wb=0;Wb<gb.length;++Wb)Array.add(Fb.items,
gb.charAt(Wb).toString());return Fb}}Object(m.a)(Vh,"ToCharListAnnotationQueryStep",Ja,[]);class Gf extends Ja{constructor(gb){super();this.Kb=gb}load(gb){const Fb=new Cb.a(this.Kb.annotations,this.yH);Array.add(Fb.items,gb);return Fb}}Object(m.a)(Gf,"ToListAnnotationQueryStep",Ja,[]);class Td extends Ja{constructor(gb){super();this.Kb=gb}load(){return this.Kb.value}}Object(m.a)(Td,"ValueAnnotationQueryStep",Ja,[]);class Xc{constructor(gb,Fb){if(gb){var Wb=gb.K(0),Cc=1;this.value=({Ona:Cc}=Fb.XWa(Wb,
gb,Cc,null,null,null)).returnValue;U.Annotations.IXb(this.value)}}}Object(m.a)(Xc,"ValueQueryStepInit",null,[]);class de{constructor(gb,Fb){gb&&(this.BJe=Fb.lF(gb.K(0)),this.query=Fb.$O(gb.K(1)))}}Object(m.a)(de,"VarNameAndQueryQueryStepInit",null,[]);class ze{constructor(gb,Fb){this.Gnh=null;if(gb){this.annotations=Fb.annotations;var Wb=0;this.yH=gb.K(Wb);++Wb;this.o$=gb.K(Wb);++Wb;this.$Ee=1===gb.K(Wb);++Wb;this.Yge=1===gb.K(Wb);++Wb;var Cc=gb.K(Wb);++Wb;if(Cc){var id=Wb,Ad=Wb+Cc,Cd=Wb+2*Cc;Wb+=
3*Cc;var qe=gb.count-Wb,df=null;for(let Sf=0;Sf<Cc;++Sf){var Ef=Wb+gb.K(Cd+Sf);const Je=(Sf===Cc-1?qe:gb.K(Cd+Sf+1))-gb.K(Cd+Sf),Ug=new Sa.a;Ug.Dsb(gb,Ef,Je);Ef=ze.SHm(gb.K(Ad+Sf),Ug,Fb);Ef.yH=gb.K(id+Sf);Ef.o$=Sf===Cc-1?this.o$:gb.K(id+Sf+1);df?df.next=Ef:this.Gnh=Ef;df=Ef}}}}get uui(){return this.Gnh}static SHm(gb,Fb,Wb){switch(gb){case 1:return new tb(new kb(Fb,Wb));case 2:return new Kc(new kb(Fb,Wb));case 3:return new qc(new Dc(Fb,Wb.annotations));case 4:return new Ob(new nc(Fb,Wb.annotations));
case 5:return new Rb(new gc(Fb,Wb));case 6:return new Fe(new Ig(Fb,Wb));case 43:return new Fd(new Ig(Fb,Wb));case 45:return new yc(new cd(Fb,Wb));case 49:return new Wc(new zb(Fb,Wb));case 46:return new Td(new Xc(Fb,Wb.annotations));case 51:return new mc(new lc(Fb,Wb));case 52:return new Df(new qf(Fb,Wb));case 53:return new yb(new Lb(Wb.annotations));case 13:return new fd(new Rf(Fb,Wb));case 14:return new Id(new pg(Fb,Wb));case 15:return new Db;case 18:return new zc(new Ig(Fb,Wb));case 16:return new Pb(new de(Fb,
Wb));case 17:return new Fa(new de(Fb,Wb));case 22:return new Nc(new xc(Fb,Wb));case 24:return new dc(new Rf(Fb,Wb));case 26:return new Mh(new qf(Fb,Wb));case 27:return new jd(new Ig(Fb,Wb));case 30:return new Gf(new Lb(Wb.annotations));case 31:return new ed(new qf(Fb,Wb));case 32:return new Vb(new Rf(Fb,Wb));case 47:return new ce(new Lb(Wb.annotations));case 48:return new Vh(new Lb(Wb.annotations));case 34:return new mb(new Rf(Fb,Wb));case 35:return new dd(new Rf(Fb,Wb));case 36:return new ch(new Rf(Fb,
Wb));case 37:return new $b(new Rf(Fb,Wb));case 38:return new Qb(new Rf(Fb,Wb));case 39:return new lb(new Rf(Fb,Wb));case 40:return new Xb(new Rf(Fb,Wb));case 41:return new Mf(new Rf(Fb,Wb));case 42:return new Nf(new Lb(Wb.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(ze,"AnnotationQueryInit",null,[]);class jf{constructor(gb){this.Kb=gb}execute(gb,Fb){this.uXa(gb,gb?new ja("root",gb,Fb):Fb)}uXa(gb,Fb){for(const Wb of this.Kb.commands)Fb=Wb.execute(gb,Fb)}}Object(m.a)(jf,
"AnnotationScript",null,[2036]);class hc{constructor(gb){this.Kb=gb}execute(gb,Fb){const Wb=this.Kb.fgn.iw(gb,Fb),Cc=this.Kb.Mdo.iw(gb,Fb);this.Kb.script.uXa(gb,new ja("Input",Wb,new ja("Output",Cc,Fb)));return Fb}}Object(m.a)(hc,"ApplyAnnotationScriptCommand",null,[2044]);class wc{constructor(gb,Fb){gb&&(this.fgn=Fb.$O(gb.K(0)),this.Mdo=Fb.$O(gb.K(1)),this.script=Fb.bSb(gb.K(2)))}}Object(m.a)(wc,"ApplyScriptCommandInit",null,[]);class Pc{constructor(gb){this.Kb=gb}execute(gb,Fb){const Wb=this.Kb.Tzg.iw(gb,
Fb);this.Kb.hme.vBc(gb,Wb,Fb,null);return Fb}}Object(m.a)(Pc,"AssignAnnotationScriptCommand",null,[2044]);class md{constructor(gb){this.Kb=gb}execute(gb,Fb){const Wb=this.Kb.hme.iw(gb,Fb);gb=this.Kb.Tzg.iw(gb,Fb);Wb!==gb&&Wb.I9a(gb);return Fb}}Object(m.a)(md,"CopyAnnotationScriptCommand",null,[2044]);class fe{constructor(gb){this.Kb=gb}execute(gb,Fb){let Wb=this.Kb.W7f.iw(gb,Fb);if(this.Kb.W7f.$Ee){Wb=U.Annotations.FY(Wb);var Cc=new ja(this.Kb.AXa,null,Fb);for(let Ad=0,Cd=Wb.items.length;Ad<Cd;++Ad){var id=
this.dri(gb,Wb.items[Ad],Cc);if(0>this.Kb.Jye)Wb.items[Ad]=id;else if(({value:id}=id.Rs(this.Kb.Jye)).returnValue)Wb.items[Ad]=id;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Kb.W7f.vBc(gb,Wb,Fb,null)}else{Cc=new ja(this.Kb.AXa,null,Fb);for(let Ad=0,Cd=Wb.items.length;Ad<Cd;++Ad)this.dri(gb,Wb.items[Ad],Cc)}return Fb}dri(gb,Fb,Wb){let Cc;0>this.Kb.Jye?Cc=U.Annotations.FY(Fb):(Cc=new F.a(this.Kb.annotations),Cc.bC(this.Kb.Jye,Fb));Wb.Zqf(Cc);
this.Kb.dkl.uXa(gb,Wb);return Cc}}Object(m.a)(fe,"EnumerateAnnotationScriptCommand",null,[2044]);class se{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.AXa=Fb.lF(gb.K(0)),this.W7f=Fb.$O(gb.K(1)),this.dkl=Fb.bSb(gb.K(2)),this.Jye=gb.K(3))}}Object(m.a)(se,"EnumerateScriptCommandInit",null,[]);class $d{constructor(gb){this.Kb=gb}execute(gb,Fb){this.Kb.XFe.iw(gb,Fb)?this.Kb.Hwp.uXa(gb,Fb):this.Kb.hsi&&this.Kb.hsi.uXa(gb,Fb);return Fb}}Object(m.a)($d,"IfAnnotationScriptCommand",null,[2044]);
class Md{constructor(gb,Fb){gb&&(this.XFe=Fb.$O(gb.K(0)),this.Hwp=Fb.bSb(gb.K(1)),this.hsi=gb.K(2)?Fb.bSb(gb.K(2)):null)}}Object(m.a)(Md,"IfScriptCommandInit",null,[]);class Ub{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.hme=Fb.$O(gb.K(0)),this.Tzg=Fb.$O(gb.K(1)))}}Object(m.a)(Ub,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Vc{constructor(gb){this.Kb=gb}execute(gb,Fb){const Wb=this.Kb.Tzg.iw(this.Kb.hme.iw(gb,Fb),Fb);this.Kb.hme.vBc(gb,Wb,Fb,null);return Fb}}Object(m.a)(Vc,
"ModifyAnnotationScriptCommand",null,[2044]);class qd{constructor(gb){this.Kb=gb}execute(gb,Fb){const Wb=new F.a(this.Kb.annotations);this.Kb.query&&Wb.I9a(this.Kb.query.iw(gb,Fb));return Fb=new ja(this.Kb.AXa,Wb,Fb)}}Object(m.a)(qd,"NewAnnotationScriptCommand",null,[2044]);class vb{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.AXa=Fb.lF(gb.K(0)),this.query=gb.K(1)?Fb.$O(gb.K(1)):null)}}Object(m.a)(vb,"NewScriptCommandInit",null,[]);class Kb{constructor(gb){this.Kb=gb}execute(gb,Fb){gb=
this.Kb.query.iw(gb,Fb);if(this.Kb.query.o$===U.Annotations.r_)gb.u1a(this.Kb.sBa);else for(const Wb of gb.items)Wb.u1a(this.Kb.sBa);return Fb}}Object(m.a)(Kb,"RemoveAnnotationScriptCommand",null,[2044]);class Ic{constructor(gb,Fb){gb&&(this.annotations=Fb.annotations,this.query=Fb.$O(gb.K(0)),this.sBa=gb.K(1))}}Object(m.a)(Ic,"RemoveScriptCommandInit",null,[]);class kd{constructor(gb,Fb){if(gb){var Wb=0,Cc=gb.K(Wb);++Wb;if(Cc){var id=Wb,Ad=Wb+Cc;Wb+=2*Cc;var Cd=gb.count-Wb;this.commands=Array(Cc);
for(let qe=0;qe<Cc;++qe){const df=Wb+gb.K(Ad+qe),Ef=(qe===Cc-1?Cd:gb.K(Ad+qe+1))-gb.K(Ad+qe),Sf=new Sa.a;Sf.Dsb(gb,df,Ef);this.commands[qe]=kd.IHm(gb.K(id+qe),Sf,Fb)}}}}static IHm(gb,Fb,Wb){switch(gb){case 1:return new Pc(new Ub(Fb,Wb));case 2:return new Vc(new Ub(Fb,Wb));case 3:return new Kb(new Ic(Fb,Wb));case 6:return new qd(new vb(Fb,Wb));case 7:return new fe(new se(Fb,Wb));case 8:return new $d(new Md(Fb,Wb));case 9:return new md(new Ub(Fb,Wb));case 10:return new hc(new wc(Fb,Wb));default:throw Error.argument("initData");
}}}Object(m.a)(kd,"AnnotationScriptInit",null,[]);var Wd=e(1631);class Ye{constructor(gb){this.Q6=gb;this.nB=0}Xda(){const gb=this.Q6.ZB(this.nB,4);this.nB+=4;return gb}get cma(){return this.Q6}get offset(){return this.nB}set offset(gb){this.nB=gb}}Object(m.a)(Ye,"ByteArrayReader",null,[]);class Re{constructor(){this.ON=null;this.Ugj=this.qia=0}K(gb){if(0>gb||gb>=this.qia)throw Error.argumentOutOfRange("index");return this.ON.ZB(this.Ugj+4*gb,4)}get count(){return this.qia}static kMl(gb,Fb,Wb){const Cc=
new Re;Cc.ON=gb;Cc.Ugj=Fb;Cc.qia=Wb;return Cc}}Object(m.a)(Re,"ReadOnlyListOverByteArray",null,[2039]);class le{constructor(gb,Fb){this.Mgj=this.Lgj=!1;this.Fz=this.L_a=this.O$f=this.Pgj=null;try{this.Fz=Fb.annotations;const Wb=Fb.$sb(gb.K(0)),Cc=new Ye(Wb);if(-914743053!==Cc.Xda())throw Error.argument("Input does not represent a flat lexicon");this.Lgj=1===Cc.Xda();this.Mgj=1===Cc.Xda();const id=Cc.Xda();Cc.offset+=id;const Ad=Cc.Xda();this.O$f=le.tgo(Cc,Ad,this.Fz);const Cd=Cc.Xda();this.Pgj=le.Igo(Cc,
Cd);const qe=Cc.Xda();this.L_a=new Wd.a(Cc.cma,Cc.offset);Cc.offset+=qe}catch(Wb){throw Error.argument("initData");}}get trie(){return this.L_a}Sqm(gb){return"i"===gb&&this.Mgj?"\u0130":gb.toUpperCase()}Z_f(){return this.Lgj}Vnm(gb){let Fb;Fb=new Cb.a(this.Fz,U.Annotations.r_);if(1!==gb)if(0===gb)gb=new F.a(this.Fz),Array.add(Fb.items,gb);else if(gb&1073741824){gb=this.Pgj[gb&-1073741825];for(let Cc=0;Cc<gb.length;++Cc){var Wb=gb[Cc];Wb=0===Wb?new F.a(this.Fz):this.O$f[Wb-2];Array.add(Fb.items,Wb)}}else Array.add(Fb.items,
this.O$f[gb-2]);return{returnValue:!0,HGn:Fb}}static tgo(gb,Fb,Wb){if(Fb%4)throw Error.argument("reader");const Cc=Re.kMl(gb.cma,gb.offset,Fb/4);gb.offset+=Fb;gb=[];for(Fb=0;Fb<Cc.count;){const id=({Ona:Fb}=Wb.XWa(U.Annotations.r_,Cc,Fb,null,null,null)).returnValue;Array.add(gb,id)}return gb}static Igo(gb,Fb){Fb=gb.offset+Fb;const Wb=[];for(;gb.offset<Fb;){const Cc=gb.Xda(),id=Array(Cc);for(let Ad=0;Ad<Cc;++Ad){const Cd=gb.Xda();id[Ad]=Cd}Array.add(Wb,id)}return Wb}}Object(m.a)(le,"RawFlatLexicon",
null,[2038]);var Bh=e(1604),gf=e(1605);class Wf{constructor(gb){if(null==gb)throw Error.argumentNull("base64String");const Fb=gb.length;if(Fb%4)throw Error.argument("base64String's length must be a multiple of 4");this.qia=.75*Fb;this.TXb=Array(Math.ceil(this.qia/4));gb.endsWith("==")?this.qia-=2:gb.endsWith("=")&&--this.qia;let Wb=0;for(let Cc=0;Cc<Fb;Cc+=4){const id=Wf.tze[gb.charCodeAt(Cc)-43]<<18|Wf.tze[gb.charCodeAt(Cc+1)-43]<<12|Wf.tze[gb.charCodeAt(Cc+2)-43]<<6|Wf.tze[gb.charCodeAt(Cc+3)-43];
let Ad=id>>16&255;this.TXb[Math.floor(Wb/4)]|=Ad<<Wb%4*8;++Wb;Ad=id>>8&255;this.TXb[Math.floor(Wb/4)]|=Ad<<Wb%4*8;++Wb;Ad=id&255;this.TXb[Math.floor(Wb/4)]|=Ad<<Wb%4*8;++Wb}}get length(){return this.qia}K(gb){if(0>gb||gb>=this.qia)throw Error.argumentOutOfRange("i");return this.uzi(gb)}ZB(gb,Fb){if(0>gb||0>Fb||gb+Fb>this.qia)throw Error.argument("Bad range");let Wb=0;for(let Cc=0;Cc<Fb;++Cc)Wb|=this.uzi(gb+Cc)<<8*Cc;return Wb}kwo(gb,Fb){let Wb=0,Cc=0,id=Math.floor(gb/8);for(gb%=8;Cc<Fb;){const Ad=
8-gb>Fb-Cc?Fb-Cc:8-gb,Cd=this.K(id);Wb|=(Cd>>gb&~(255<<Ad))<<Cc;Cc+=Ad;++id;gb=0}return Wb}uzi(gb){return this.TXb[Math.floor(gb/4)]>>gb%4*8&255}}Wf.tze=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Wf,"ByteArray",null,[]);class $i{constructor(gb,Fb,Wb){this.GH=gb;this.nPn=Fb;this.qPn=Wb;this.bhj=Array(gb.b?gb.b.length:
0);this.nag=new Bh.a(new gf.a(this.$sb(this.GH.s)));this.uda=Array(gb.t.length);this.KF=new U.Annotations(this.Vsb(0),this)}get annotations(){return this.KF}get u3l(){return this.GH.d}$Gm(){if(!(""in this.GH.m))throw Error.argument("name","Unrecognized module");return this.UOf(this.GH.m[""])}$sb(gb){if(0>gb||!this.GH.b||gb>=this.GH.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.bhj[gb]||(this.bhj[gb]=new Wf(this.GH.b[gb]))}lF(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.uda[gb]){const Fb=this.Vsb(gb).K(0);this.uda[gb]=this.nag.lF(Fb)}return this.uda[gb]}gnc(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.uda[gb]){var Fb=this.Vsb(gb);const Wb=this.lF(Fb.K(0));Fb=1===Fb.K(1);this.uda[gb]=new RegExp(Wb,Fb?"i":"")}return this.uda[gb]}SPm(gb){if(1>gb||
gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}UOf(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not an NL module");return this.uda[gb]||(this.uda[gb]=this.qPn.vHm(this.Vsb(gb),this))}$O(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.GH.t[gb])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.uda[gb]||(this.uda[gb]=new Wa(new ze(this.Vsb(gb),this)))}bSb(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.uda[gb]||(this.uda[gb]=new jf(new kd(this.Vsb(gb),this)))}Fua(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not a filter");
return this.uda[gb]||(this.uda[gb]=this.nPn.Fua(this.Vsb(gb),this))}cOm(gb){if(1>gb||gb>=this.GH.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.GH.t[gb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.uda[gb]||(this.uda[gb]=new le(this.Vsb(gb),this))}Vsb(gb){const Fb=this.GH.n[gb];gb=(gb<this.GH.t.length-1?this.GH.n[gb+1]:this.GH.n.length)-Fb;if(0>Fb||0>gb||Fb+gb>this.GH.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Fb+","+gb+")");const Wb=new Sa.a;Wb.EIf(this.GH.n,Fb,gb);return Wb}}Object(m.a)($i,"ObjectFetcher",null,[2032]);class wf{constructor(gb,Fb,Wb){if(!gb)throw Error.argumentNull("prediction");if(!Fb)throw Error.argumentNull("fieldNames");if(!Wb)throw Error.argumentNull("values");if(Fb.length!==Wb.length)throw Error.argument("values","fieldNames and values do not have same length");this.tPk=gb;this.UXb=Fb;this.Ofd=Wb}get prediction(){return this.tPk}get Lsi(){return this.UXb.length}getFieldName(gb){return 0<=
gb&&gb<this.UXb.length?this.UXb[gb]:null}getValue(gb){return 0<=gb&&gb<this.Ofd.length?this.Ofd[gb]:null}}Object(m.a)(wf,"PredictionData",null,[]);class Hf{constructor(gb,Fb){if(!gb)throw Error.argumentNull("predictions");if(!Fb)throw Error.argumentNull("tokenAttributes");this.tPn=gb;this.xPn=Fb}VPf(){return this.tPn}jyi(){return this.xPn}}Object(m.a)(Hf,"PredictionDataWithTokenAttributes",null,[]);class vf{constructor(gb,Fb){this.prediction=null;this.score=0;this.prediction=gb;this.score=Fb}}Object(m.a)(vf,
"PredictionWithScore",null,[]);class Ui{constructor(gb,Fb){if(!gb)throw Error.argumentNull("predictions");if(!Fb)throw Error.argumentNull("attributes");this.uPk=gb;this.luk=Fb}VPf(){return this.uPk}jyi(){return this.luk}}Object(m.a)(Ui,"PredictionsWithTokenAttributes",null,[]);class rf{constructor(gb,Fb,Wb){if(!gb)throw Error.argumentNull("attributeName");if(!Fb)throw Error.argumentNull("fieldNames");if(!Wb)throw Error.argumentNull("values");if(Fb.length!==Wb.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.kuk=gb;this.UXb=Fb;this.Ofd=Wb}get attributeName(){return this.kuk}get Lsi(){return this.UXb.length}getFieldName(gb){return 0<=gb&&gb<this.UXb.length?this.UXb[gb]:null}getValue(gb){return 0<=gb&&gb<this.Ofd.length?this.Ofd[gb]:null}}Object(m.a)(rf,"TokenAttributes",null,[]);var ug=e(118),Eg=e(145);class th{constructor(gb,Fb,Wb,Cc,id){this.gyd=0;this.kTg=null;this.hyd=this.IEc=0;this.HKe=this.Q5b=this.Iya=this.JEc=null;this.lTg=0;this.v4e=this.LF=
null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.uX=gb;this.Kik=this.Oik=Fb;this.Jik=this.Mik=Wb;this.eyd=this.Lik=Cc;this.fyd=this.Nik=id}Pik(){this.hyd=0;return this.iTg}iTg(){if(!(this.hyd<this.eyd))return this.jTg;this.JEc=this.Kik.items[this.hyd+this.Jik];this.Iya=new F.a(this.uX.Kb.annotations);1!==this.eyd&&this.uX.Kb.Iad||this.Iya.I9a(this.JEc);if(0<=this.uX.Kb.aoe){({value:this.Q5b}=this.Iya.Rs(this.uX.Kb.aoe)).returnValue?
this.Q5b=this.Q5b.FY():this.Q5b=new Cb.a(this.uX.Kb.annotations,U.Annotations.r_);this.HKe=this.fyd.items;this.lTg=this.HKe.length;for(this.gyd=0;this.gyd<this.lTg;++this.gyd)this.kTg=this.HKe[this.gyd],Array.add(this.Q5b.items,this.kTg);this.Iya.bC(this.uX.Kb.aoe,this.Q5b)}else 0<=this.uX.Kb.IHg?this.Iya.bC(this.uX.Kb.IHg,this.fyd.items[0]):0<=this.uX.Kb.Ynf?this.Iya.bC(this.uX.Kb.Ynf,!0):this.uX.Kb.p5i?this.fyd.items[0].A7d((gb,Fb)=>this.Iya.bC(gb,Fb)):(this.Iya.I9a(this.fyd.items[0]),1!==this.eyd&&
this.uX.Kb.Iad||(({value:this.IEc}=this.JEc.Rs(this.uX.Kb.i8)).returnValue&&this.Iya.bC(this.uX.Kb.i8,this.IEc),({value:this.IEc}=this.JEc.Rs(this.uX.Kb.Jba)).returnValue&&this.Iya.bC(this.uX.Kb.Jba,this.IEc),this.JEc.Rs(this.uX.Kb.Xob).returnValue&&this.Iya.bC(this.uX.Kb.Xob,this.IEc)));this.LF=this.Iya;this._state=2;return this.Rik}jTg(){this._state=3}Qik(){this.hyd++;return this.iTg}Rik(){return 1<this.eyd&&this.uX.Kb.Iad?this.jTg:this.Qik}dispose(){}getEnumerator(){return-1===this._state?(this._state=
0,this):(new th(this.uX,this.Oik,this.Mik,this.Lik,this.Nik)).getEnumerator()}[Symbol.iterator](){return Object(Eg.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.v4e=this.Pik());for(;1===this._state;)this.v4e=this.v4e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.LF}}Object(m.a)(th,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[11,17,74]);class ei{constructor(gb,Fb,Wb){this.Lfd=this.Vgj=0;this.Rtc=null;this.oag=this.U$f=this.Ptc=this.ome=this.X$f=0;this.pme=!1;this.gag=gb;this.qag=Fb;this.sPn=Wb}DHi(){null===this.Rtc&&({W5j:this.Rtc,OUi:this.X$f,length:this.ome,Wam:gb}=this.gag.jOi(this.qag.items[this.Lfd],this.sPn),this.pme=gb||this.pme);if(this.Ptc<this.ome){var gb=this.Rtc.charAt(this.X$f+this.Ptc);++this.Ptc;return{returnValue:!0,ch:gb}}if(this.Lfd===this.qag.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Lfd;
this.Ptc=0;this.Rtc=null;return{returnValue:!0,ch:" "}}Tug(gb,Fb){this.Ptc===this.ome&&this.Rtc&&(this.oag=Fb,this.U$f=this.Lfd-this.Vgj+1)}fOo(gb){if(0>gb||gb>=this.qag.items.length)throw Error.argumentOutOfRange("iToken");this.Lfd=this.Vgj=gb;this.Rtc=null;this.U$f=this.Ptc=this.ome=this.X$f=0;this.oag=-1;this.pme=!1}ZFm(){return{ipl:this.U$f,MDn:this.oag,Vam:this.pme}}}Object(m.a)(ei,"TriePrefixVisitor",null,[2045]);class Yj{constructor(gb){this.Kb=gb}execute(gb){if(!({value:Wb}=gb.Rs(this.Kb.XVa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Fb;({value:Fb}=gb.Rs(this.Kb.G8a)).returnValue||(Fb=null);var Wb=this.anm(Wb,Fb);gb=U.Annotations.FY(gb);gb.bC(this.Kb.XVa,Wb);return gb}anm(gb,Fb){let Wb=null;const Cc=this.Kb.flatLexicon.trie,id=new ei(this,gb,Fb);let Ad=null;this.Kb.flatLexicon.Z_f()&&(Ad=Object(ug.a)(this.Kb.flatLexicon,this.Kb.flatLexicon.Sqm,"getCaseInsensitiveForm"));let Cd=0,qe;var df;let Ef;for(;Cd<gb.items.length;){const Sf=gb.items[Cd];id.fOo(Cd);Cc.Igk(id,Ad);({ipl:qe,MDn:df,Vam:Ef}=id.ZFm());if(0<qe){({HGn:df}=this.Kb.flatLexicon.Vnm(df));
for(let Je of this.oOl(gb,Cd,qe,df)){1<qe&&this.Kb.Iad&&this.mPl(gb,Fb,Cd,Sf,qe,Ef,Je);if(!Wb)for(Wb=new Cb.a(this.Kb.annotations,U.Annotations.r_),df=0;df<Cd;++df)Array.add(Wb.items,gb.items[df]);Array.add(Wb.items,Je)}Cd+=qe}else Wb&&Array.add(Wb.items,Sf),++Cd}return Wb||gb}mPl(gb,Fb,Wb,Cc,id,Ad,Cd){if(Ad)Ad=!0;else if(this.Kb.Z4i){Ad=!1;var qe=-1;for(var df=0;df<id;df++){var Ef=gb.items[Wb+df];let Kf;var Sf=void 0;if(!({value:Kf}=Ef.Rs(this.Kb.i8)).returnValue||!({value:Sf}=Ef.Rs(this.Kb.Jba)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<df){if(Kf>qe+1){Ad=!0;break}if(0>qe||null===Fb||qe>=Fb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Fb.charAt(qe)){Ad=!0;break}}qe=Kf+Sf}}else Ad=!1;if(Ad){Sf=new Sys.StringBuilder;for(Ad=0;Ad<id;++Ad)({W5j:qe,OUi:df,length:Ef}=this.jOi(gb.items[Wb+Ad],Fb)),0<Ad&&Sf.append(" "),Sf.append(qe.substr(df,Ef));Cd.bC(this.Kb.Xob,Sf.toString())}gb=gb.items[Wb+id-1];let Je,Ug;({value:Cc}=Cc.Rs(this.Kb.i8)).returnValue&&
({value:Je}=gb.Rs(this.Kb.i8)).returnValue&&({value:Ug}=gb.Rs(this.Kb.Jba)).returnValue?(Cd.bC(this.Kb.i8,Cc),Cd.bC(this.Kb.Jba,Je+Ug-Cc)):(Cd.u1a(this.Kb.i8),Cd.u1a(this.Kb.Jba))}oOl(gb,Fb,Wb,Cc){return new th(this,gb,Fb,Wb,Cc)}jOi(gb,Fb){let Wb,Cc;if(({value:Wb}=gb.Rs(this.Kb.Xob)).returnValue)Cc=!0,Fb=0,gb=Wb.length;else{Cc=!1;if(null===Fb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Wb=Fb;if(!({value:Fb}=gb.Rs(this.Kb.i8)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:gb}=gb.Rs(this.Kb.Jba)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Fb||0>gb||Fb+gb>Wb.length)throw Error.argument("Token start/length values out of range","token");}return{W5j:Wb,OUi:Fb,length:gb,Wam:Cc}}}Object(m.a)(Yj,"FlatLexiconNLModule",null,[2040]);class Zk{constructor(gb,Fb){this.Ynf=this.aoe=this.IHg=this.Xob=this.Jba=this.i8=this.G8a=this.XVa=0;this.p5i=this.Z4i=this.Iad=!1;this.flatLexicon=null;this.annotations=Fb.annotations;
let Wb=0;try{this.XVa=gb.K(Wb),++Wb,this.G8a=gb.K(Wb),++Wb,this.i8=gb.K(Wb),++Wb,this.Jba=gb.K(Wb),++Wb,this.Xob=gb.K(Wb),++Wb,this.IHg=gb.K(Wb),++Wb,this.aoe=gb.K(Wb),++Wb,this.Ynf=gb.K(Wb),++Wb,this.Iad=1===gb.K(Wb),++Wb,this.Z4i=1===gb.K(Wb),++Wb,this.p5i=1===gb.K(Wb),++Wb,this.flatLexicon=Fb.cOm(gb.K(Wb))}catch(Cc){throw Error.argument("initData");}}}Object(m.a)(Zk,"FlatLexiconNLModuleInit",null,[]);class yg{constructor(){this.C9c=0;this.jGf=null;this.eqd=0}}Object(m.a)(yg,"FeatureGenStackRec",
null,[]);class Kk{constructor(gb){this.KMg=Array(gb);this.TCc=Array(gb);this.qJg=[];this.B3j=[]}}Object(m.a)(Kk,"TokenStringLattice",null,[]);const Jh=(gb,Fb,Wb)=>{for(let Cc=0;Cc<gb.length;Cc++)Wb=Fb(Wb,gb[Cc]);return Wb},zf=(gb,Fb)=>{const Wb=Array(gb.length);for(let Cc=0;Cc<gb.length;Cc++)Wb[Cc]=Fb(gb[Cc]);return Wb},cg=(gb,Fb)=>{Fb=Array(Math.min(Fb,gb.length));for(let Wb=0;Wb<Fb.length;Wb++)Fb[Wb]=gb[Wb];return Fb},xe=(gb,Fb)=>{const Wb=[];for(const Cc of gb)Fb(Cc)&&Array.add(Wb,Cc);return Wb};
class wi{constructor(gb,Fb){this.key=gb;this.value=Fb}}Object(m.a)(wi,"KeyValuePair",null,[]);const ig=(gb,Fb)=>({returnValue:Fb in gb,value:gb[Fb]}),Qi=gb=>{const Fb=[];for(let Wb in gb){const Cc=new wi(Wb,gb[Wb]);Array.add(Fb,Cc)}return Fb};class el{constructor(gb){this.iOi=this.oVm;this.Kb=gb;this.sme=this.dag=this.eag=0;for(const Fb of this.Kb.a6d)this.eag=Math.max(this.eag,Fb.opg),this.dag=Math.max(this.dag,Fb.jpg),this.sme=Math.max(this.sme,Fb.xBb.length)}get udm(){return this.Kb.NGe.trie}execute(gb){if(!gb)throw Error.argumentNull("input");
let Fb,Wb;({tokens:Fb,aFn:Wb}=this.pVm(gb));let Cc=null,id=null,Ad={};if(this.Kb.sbd){Fb=U.Annotations.FY(Fb);for(var Cd=0;Cd<Fb.items.length;++Cd)Fb.items[Cd]=U.Annotations.FY(Fb.items[Cd])}else({psi:id,returnValue:Cc}=this.uIi(gb,Ad));Cd=Array(this.sme);const qe=Array(this.sme);for(var df=0;df<qe.length;++df)qe[df]=new yg;for(df=-this.eag;df<Fb.items.length+this.dag;++df){let Ef=null;this.Kb.sbd&&(Ef=Fb.items[df],Ad={},{psi:id,returnValue:Cc}=this.uIi(Ef,Ad));for(const Sf of this.Kb.a6d){if(0>df&&
-df>Sf.opg||df>=Fb.items.length&&df-Fb.items.length+1>Sf.jpg)continue;let Je=!0;for(let Ug=0;Ug<Sf.xBb.length;++Ug){const Kf=df+Sf.xBb[Ug];Cd[Ug]=Kf;if(0>Kf?0>this.Kb.ppg:Kf>=Fb.items.length?0>this.Kb.kpg:!Wb.TCc[Kf]){Je=!1;break}}Je&&({FSl:Cc,GSl:id}=this.Win(Sf,Wb,Cc,id,Ad,qe,Cd))}this.Kb.sbd&&(Ef.bC(this.Kb.Dcb?this.Kb.Tfc:this.Kb.Rfc,Cc),this.Kb.Dcb&&Ef.bC(this.Kb.Sfc,id))}gb=U.Annotations.FY(gb);this.Kb.sbd?gb.bC(this.Kb.XVa,Fb):(gb.bC(this.Kb.Dcb?this.Kb.Tfc:this.Kb.Rfc,Cc),this.Kb.Dcb&&gb.bC(this.Kb.Sfc,
id));return gb}pVm(gb){let Fb,Wb;if(!gb||!({value:Fb}=gb.Rs(this.Kb.XVa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Cc;({value:Cc}=gb.Rs(this.Kb.G8a)).returnValue||(Cc="");Wb=new Kk(Fb.items.length);const id=xe(this.Kb.NMg,Ad=>!Ad.I$c||Ad.I$c.isMatch(gb,null));for(let Ad=0;Ad<Fb.items.length;++Ad){const Cd=Fb.items[Ad];let qe=null;Wb.KMg[Ad]=Wb.qJg.length;let df=Wb.TCc[Ad]=0;for(const Ef of id)0<Ef.agd&&Wb.TCc[Ad]+df>=Ef.agd||Ef.tokenFilter&&!Ef.tokenFilter.isMatch(Cd,
null)||({hvd:qe,rXc:df}=Ef.apply(this,Cd,Ad,Wb,Cc,qe,df))}return{tokens:Fb,aFn:Wb}}Win(gb,Fb,Wb,Cc,id,Ad,Cd){let qe=0;Ad[0].C9c=-1;for(Ad[0].jGf=gb.$Nj;;){var df=Cd[qe],Ef=0>df||df>=Fb.TCc.length?1:Fb.TCc[df];let Ug=!1;for(;Ad[qe].C9c<Ef-1;){++Ad[qe].C9c;var Sf=void 0,Je=void 0;0>df?(Sf=this.Kb.ppg,Je=1):df>=Fb.KMg.length?(Sf=this.Kb.kpg,Je=1):(Je=Fb.KMg[df]+Ad[qe].C9c,Sf=Fb.qJg[Je],Je=Fb.B3j[Je]);Ad[qe].eqd=Je*(qe?Ad[qe-1].eqd:gb.score);if(({value:Sf}=ig(Ad[qe].jGf,Sf.toString())).returnValue){qe===
gb.xBb.length-1?(df=Sf,Ad[qe].eqd&&(({value:Ef}=ig(id,df.toString())).returnValue||(Ef=-1),0>Ef&&(Wb=U.Annotations.FY(Wb),Array.add(Wb.items,df)),this.Kb.Dcb&&(Cc=U.Annotations.FY(Cc),0>Ef?Array.add(Cc.items,Ad[qe].eqd):Cc.items[Ef]+=Ad[qe].eqd),0>Ef&&(this.Kb.b9i||this.Kb.Dcb)&&(id[df.toString()]=Wb.items.length-1))):(++qe,Ad[qe].C9c=-1,Ad[qe].jGf=Sf);Ug=!0;break}}if(!Ug&&(--qe,0>qe))break}return{FSl:Wb,GSl:Cc}}uIi(gb,Fb){let Wb;if(({value:Wb}=gb.Rs(this.Kb.Dcb?this.Kb.Tfc:this.Kb.Rfc)).returnValue)for(let Cc=
0;Cc<Wb.items.length;++Cc)Fb[Wb.items[Cc].toString()]=Cc;else Wb=new Cb.a(this.Kb.annotations,U.Annotations.jRa);if(this.Kb.Dcb){if(({value:Fb}=gb.Rs(this.Kb.Sfc)).returnValue||(Fb=new Cb.a(this.Kb.annotations,U.Annotations.sya)),Fb.items.length!==Wb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Kb.annotations.dka(U.Annotations.r_,gb));}else Fb=null;return{returnValue:Wb,psi:Fb}}get Utp(){return this.Kb.NGe}oVm(gb,
Fb){var Wb;if(({value:Wb}=Fb.Rs(this.Kb.Xob)).returnValue)gb=Wb;else{if(!({value:Wb}=Fb.Rs(this.Kb.i8)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Fb}=Fb.Rs(this.Kb.Jba)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Wb||0>Fb||Wb+Fb>gb.length)throw Error.argument("Token indices are out of range");gb=gb.substr(Wb,Fb)}return gb}}Object(m.a)(el,"NGramNLModule",null,[2040,2041]);class mj{constructor(gb){this.xBb=null;this.score=this.jpg=this.opg=
0;this.$Nj=null;if(gb){var Fb=0;try{if(gb.K(Fb)!==mj.WNb)throw Error.argument("initData","Input does not represent a feature template");++Fb;const Wb=gb.K(Fb);++Fb;this.xBb=Array(Wb);for(let Cc=0;Cc<Wb;++Cc)this.xBb[Cc]=gb.K(Fb),++Fb;this.opg=gb.K(Fb);++Fb;this.jpg=gb.K(Fb);++Fb;this.score=gb.K(Fb);++Fb;this.$Nj=({IUi:Fb}=mj.JEj(gb,Fb)).returnValue}catch(Wb){throw Error.argument("initData");}}}static JEj(gb,Fb){const Wb=gb.K(Fb);++Fb;const Cc={};for(let id=0;id<Wb;++id){const Ad=gb.K(Fb);++Fb;gb.K(Fb)?
Cc[Ad.toString()]=({IUi:Fb}=mj.JEj(gb,Fb)).returnValue:(++Fb,Cc[Ad.toString()]=gb.K(Fb),++Fb)}return{returnValue:Cc,IUi:Fb}}}mj.WNb=240803228;Object(m.a)(mj,"FeatureTemplate",null,[2048]);var Uf=e(1545);class hh{constructor(gb,Fb){this.Dcb=this.b9i=this.sbd=!1;this.Xob=this.Jba=this.i8=this.XVa=this.G8a=this.Sfc=this.Tfc=this.Rfc=0;this.NGe=null;this.kpg=this.ppg=0;this.a6d=this.NMg=null;if(gb){this.annotations=Fb.annotations;var Wb=0;try{this.sbd=1===gb.K(Wb);++Wb;this.b9i=1===gb.K(Wb);++Wb;this.Dcb=
1===gb.K(Wb);++Wb;this.Rfc=gb.K(Wb);++Wb;this.Tfc=gb.K(Wb);++Wb;this.Sfc=gb.K(Wb);++Wb;this.G8a=gb.K(Wb);++Wb;this.XVa=gb.K(Wb);++Wb;this.i8=gb.K(Wb);++Wb;this.Jba=gb.K(Wb);++Wb;this.Xob=gb.K(Wb);++Wb;this.NGe=this.eho(Fb.$sb(gb.K(Wb)));++Wb;this.ppg=gb.K(Wb);++Wb;this.kpg=gb.K(Wb);++Wb;const Cc=gb.K(Wb);++Wb;this.NMg=Array(Cc);for(let Ad=0;Ad<Cc;++Ad){const Cd=gb.K(Wb);++Wb;const qe=this.NGe.trie,df=new Sa.a;df.Dsb(gb,Wb,Cd);this.NMg[Ad]=this.iho(df,Fb,qe);Wb+=Cd}const id=gb.K(Wb);++Wb;this.a6d=
Array(id);for(Fb=0;Fb<id;++Fb){const Ad=gb.K(Wb);++Wb;const Cd=new Sa.a;Cd.Dsb(gb,Wb,Ad);this.a6d[Fb]=this.Jgo(Cd);Wb+=Ad}}catch(Cc){throw Error.argument("initData");}}}eho(gb){return new Bh.a(new gf.a(gb))}iho(gb,Fb,Wb){return Uf.a.create(gb,Fb,Wb)}Jgo(gb){return new mj(gb)}}Object(m.a)(hh,"NGramNLModuleInit",null,[]);class Jj{constructor(gb){this.Kb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");gb=gb.clone();this.Kb.script.execute(gb,null);return gb}}Object(m.a)(Jj,"ScriptNLModule",null,
[2040]);class $h{constructor(gb,Fb){gb&&(this.script=Fb.bSb(gb.K(0)))}}Object(m.a)($h,"ScriptNLModuleInit",null,[]);const pi=gb=>{gb=zf(gb,Fb=>Fb*Fb);return Math.sqrt(Jh(gb,(Fb,Wb)=>Fb+Wb,0))},vh=gb=>Jh(gb,(Fb,Wb)=>Fb>Wb?Fb:Wb,gb[0]);class Bl{constructor(gb){this.Kb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");var Fb=[],Wb=[];this.ZAl(gb,Fb,Wb);this.H9k(Fb,Wb);const Cc={};for(let Ad=0;Ad<Fb.length;++Ad){var id=Fb[Ad];const Cd=this.Kb.VYi.K(id);id=this.Kb.WYi.K(id);for(let qe=0;qe<id;++qe){const df=
this.Kb.Wba.K(this.Kb.e7h.K(Cd+qe)),Ef=this.Kb.f7h.K(Cd+qe);let Sf;({value:Sf}=ig(Cc,df)).returnValue||(Sf=0);Cc[df]=Sf+Wb[Ad]*Ef}}Wb=Qi(Cc);Wb.sort((Ad,Cd)=>{var qe=Ad.value,df=Cd.value;(qe=-(qe>df?1:qe<df?-1:0))||(qe=Ad.key.localeCompare(Cd.key));return qe});Fb=new Cb.a(this.Kb.annotations,U.Annotations.r_);for(const Ad of cg(Wb,this.Kb.SRn))Wb=new F.a(this.Kb.annotations),Wb.bC(this.Kb.ehl,Ad.key),Wb.bC(this.Kb.ghl,Ad.value),Array.add(Fb.items,Wb);gb.bC(this.Kb.fhl,Fb);return gb}ZAl(gb,Fb,Wb){if(({value:gb}=
gb.Rs(this.Kb.dhl)).returnValue){let Cc;if(({value:Cc}=gb.Rs(this.Kb.Tfc)).returnValue){let id;if(!({value:id}=gb.Rs(this.Kb.Sfc)).returnValue||Cc.items.length!==id.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.QZd(Cc,id,Fb,Wb)}if(({value:Cc}=gb.Rs(this.Kb.ihl)).returnValue){let id;if(!({value:id}=gb.Rs(this.Kb.jhl)).returnValue||Cc.items.length!==id.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.QZd(Cc,id,Fb,Wb)}({value:Cc}=gb.Rs(this.Kb.Rfc)).returnValue&&this.QZd(Cc,null,Fb,Wb);({value:Cc}=gb.Rs(this.Kb.hhl)).returnValue&&this.QZd(Cc,null,Fb,Wb)}}QZd(gb,Fb,Wb,Cc){for(let Ad=0;Ad<gb.items.length;++Ad){var id=void 0;gb.M9===U.Annotations.Lea?({value:id}=ig(this.Kb.Bni,gb.items[Ad])).returnValue||(id=-1):(id=gb.items[Ad],id=id>=this.Kb.Ubg&&id<=this.Kb.sSn?this.Kb.Wfg?this.Kb.Wfg.K(id-this.Kb.Ubg)-1:id-this.Kb.Ubg:-1);if(0<=id){let Cd;Cd=Fb?Fb.items[Ad]:1;0<Cd&&(Array.add(Wb,id),Array.add(Cc,
Cd))}}}H9k(gb,Fb){if(gb.length){switch(this.Kb.Oro){case 0:break;case 1:for(var Wb=0;Wb<Fb.length;++Wb)Fb[Wb]=1+Math.log(Fb[Wb]);break;case 2:Wb=vh(Fb);for(let Cc=0;Cc<Fb.length;++Cc)Fb[Cc]=.5+Fb[Cc]/Wb*.5;break;case 3:for(Wb=0;Wb<Fb.length;++Wb)Fb[Wb]=1;break;default:throw Error.notImplemented();}if(this.Kb.Sfe)for(Wb=0;Wb<Fb.length;++Wb)Fb[Wb]*=this.Kb.Sfe.K(gb[Wb]);gb=pi(Fb);for(Wb=0;Wb<Fb.length;++Wb)Fb[Wb]/=gb}}}Object(m.a)(Bl,"TfIdfRankerNLModule",null,[2040]);class Bj{constructor(gb,Fb=0){if(!gb)throw Error.argumentNull("byteArray");
this.tme=Fb;if(604662927!==gb.ZB(this.tme+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.ul=gb.ZB(this.tme+4,4);this.Bgj=gb.ZB(this.tme+8,4);this.gPn=gb}K(gb){if(0>gb||gb>=this.count)throw Error.argumentOutOfRange("index");return this.gPn.kwo(8*this.tme+96+gb*this.Bgj,this.Bgj)}get count(){return this.ul}}Object(m.a)(Bj,"CompactIntArray",null,[2039]);const Vj=(gb,Fb)=>{Fb=Array(Fb);for(let Ad=0;Ad<Fb.length;Ad++){var Wb=Ad,Cc=gb.Xda(),id=1===(Cc>>31&1)?
-1:1;const Cd=Cc&8388607;Cc=Cc>>23&255;256===Cc+1?id=Cd?Number.NaN:1===id?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Cc?(Cc-=127,id=id*mh(Cd,1)*Math.pow(2,Cc)):id=id*mh(Cd,0)*Math.pow(2,-126);Fb[Wb]=id}return Fb},mh=(gb,Fb)=>{let Wb=0;for(let Cc=0;23>Cc;Cc++)Wb+=(gb>>22-Cc&1)/Math.pow(2,Cc+1);return Fb+Wb};class xf{constructor(gb,Fb){this.Wfg=null;this.ynj=0;this.WYi=this.VYi=this.Sfe=null;this.xnj=0;this.f7h=this.e7h=null;this.annotations=Fb.annotations;let Wb=0;this.hhl=gb.K(Wb);++Wb;this.Rfc=
gb.K(Wb);++Wb;this.ihl=gb.K(Wb);++Wb;this.jhl=gb.K(Wb);++Wb;this.Tfc=gb.K(Wb);++Wb;this.Sfc=gb.K(Wb);++Wb;this.dhl=gb.K(Wb);++Wb;this.fhl=gb.K(Wb);++Wb;this.ehl=gb.K(Wb);++Wb;this.ghl=gb.K(Wb);++Wb;var Cc=gb.K(Wb);++Wb;var id=Array(Cc);for(var Ad=0;Ad<Cc;++Ad)id[Ad]=Fb.lF(gb.K(Wb)),++Wb;this.Wba=Sa.a.Xwf(id);this.SRn=gb.K(Wb);++Wb;this.Oro=gb.K(Wb);++Wb;Cc=gb.K(Wb);++Wb;this.Bni={};for(id=0;id<Cc;++id){Ad=Fb.lF(gb.K(Wb));++Wb;const Cd=gb.K(Wb);++Wb;this.Bni[Ad]=Cd}this.Ubg=gb.K(Wb);++Wb;this.sSn=
gb.K(Wb);++Wb;Cc=gb.K(Wb);++Wb;0<Cc&&(Cc=Fb.$sb(gb.K(Wb)),++Wb,this.Wfg=this.cte(new Ye(Cc)));++Wb;gb=Fb.$sb(gb.K(Wb));this.Sgo(gb)}cte(gb){return new Bj(gb.cma,gb.offset)}Sgo(gb){try{const Fb=new Ye(gb);this.ynj=Fb.Xda();1===Fb.Xda()?this.Sfe=Sa.a.Xwf(Vj(Fb,this.ynj)):this.Sfe=null;const Wb=Fb.Xda();this.VYi=this.cte(Fb);Fb.offset+=Wb;const Cc=Fb.Xda();this.WYi=this.cte(Fb);Fb.offset+=Cc;this.xnj=Fb.Xda();const id=Fb.Xda();this.e7h=this.cte(Fb);Fb.offset+=id;this.f7h=Sa.a.Xwf(Vj(Fb,this.xnj))}catch(Fb){throw Error.argument("byteReader");
}}}Object(m.a)(xf,"TfIdfRankerNLModuleInit",null,[]);class Wg{constructor(gb,Fb,Wb,Cc){this.kng=gb;this.mui=Wb;this.tokens=Cc;this.Mta=Fb;this.uzc=-1;this.mAe=0}}Object(m.a)(Wg,"TokenizerData",null,[]);class Oj{constructor(gb){this.Kb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");if(!({value:Cc}=gb.Rs(this.Kb.G8a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Fb;({value:Fb}=gb.Rs(this.Kb.i8)).returnValue||(Fb=0);let Wb;({value:Wb}=
gb.Rs(this.Kb.Jba)).returnValue||(Wb=Cc.length-Fb);if(0>Fb||Fb>Cc.length)throw Error.argument("input","Start index out of range");if(0>Wb||Wb>Cc.length)throw Error.argument("input","Length out of range");if(Fb+Wb>Cc.length)throw Error.argument("input","Bad start-length range");var Cc=new Wg(Cc,Fb,Fb+Wb,new Cb.a(this.Kb.annotations,U.Annotations.r_));this.Vtp(Cc);gb=gb.isReadOnly?gb.clone():gb;gb.bC(this.Kb.XVa,Cc.tokens);return gb}Vtp(gb){for(;gb.Mta<gb.mui;){if(this.Kb.ETf){var Fb=this.Kb.ETf.cgj(gb.kng,
gb.Mta,gb.mui-gb.Mta,null);!Fb.succeeded&&Fb.nmj&&(Fb=Fb.nmj);if(Fb.succeeded){this.Lrj(gb,Fb.length,this.Kb.JQi);gb.Mta+=Fb.length;continue}}Fb=gb.kng.substr(gb.Mta);let Wb=-1,Cc=-1,id=-1;for(let Ad=0;Ad<this.Kb.kze.length;++Ad){const Cd=this.Kb.kze[Ad].exec(Fb);Cd&&0<Cd[1].length&&(0>Wb||Cd[0].length>Cc)&&(Wb=Ad,Cc=Cd[0].length,id=Cd[1].length)}0<=Wb?(this.Lrj(gb,id,this.Kb.Mzg[Wb]),gb.Mta+=id):gb.Mta+=1}}Lrj(gb,Fb,Wb){if(this.Kb.l7i)Wb!==Oj.rpl&&(0>gb.uzc&&(gb.uzc=gb.Mta),gb.mAe=gb.Mta+Fb-gb.uzc,
Wb===Oj.qpl&&(0<=gb.uzc&&0<gb.mAe&&(Fb=new F.a(this.Kb.annotations),Fb.bC(this.Kb.i8,gb.uzc),Fb.bC(this.Kb.Jba,gb.mAe),Fb.bC(this.Kb.Rmf,Oj.spl),Fb.bC(this.Kb.G8a,gb.kng),Array.add(gb.tokens.items,Fb)),gb.uzc=-1,gb.mAe=0));else{let Cc=new F.a(this.Kb.annotations);Cc.bC(this.Kb.i8,gb.Mta);Cc.bC(this.Kb.Jba,Fb);Cc.bC(this.Kb.Rmf,Wb);Array.add(gb.tokens.items,Cc)}}}Oj.rpl="GAP";Oj.qpl="EOS_CHUNK";Oj.spl="SENTENCE";Object(m.a)(Oj,"TokenizerNLModule",null,[2040]);class Bg{constructor(gb,Fb){this.Jba=this.i8=
this.Rmf=this.XVa=this.G8a=0;this.l7i=!1;this.Mzg=this.kze=this.JQi=this.ETf=null;if(gb){this.annotations=Fb.annotations;var Wb=0;try{this.G8a=gb.K(Wb);++Wb;this.XVa=gb.K(Wb);++Wb;this.Rmf=gb.K(Wb);++Wb;this.i8=gb.K(Wb);++Wb;this.Jba=gb.K(Wb);++Wb;this.l7i=1===gb.K(Wb);++Wb;var Cc=gb.K(Wb);++Wb;0<Cc&&(this.ETf=Fb.UOf(Cc).udm);this.JQi=gb.K(Wb)?Fb.lF(gb.K(Wb)):"";++Wb;const id=gb.K(Wb);++Wb;this.kze=Array(id);this.Mzg=Array(id);for(Cc=0;Cc<id;++Cc)this.kze[Cc]=new RegExp(Fb.lF(gb.K(Wb))),++Wb,this.Mzg[Cc]=
Fb.lF(gb.K(Wb)),++Wb}catch(id){throw Error.argument("initData");}}}}Object(m.a)(Bg,"TokenizerNLModuleInit",null,[]);class Xg{constructor(gb){this.Kb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");let Fb;if(!({value:Fb}=gb.Rs(this.Kb.k_h)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Wb of this.Kb.zIg)Fb=Wb.apply(Fb);gb=U.Annotations.FY(gb);gb.bC(this.Kb.l_h,Fb);return gb}static dmf(gb,Fb){const Wb=new Sys.StringBuilder;for(let Cc=
0;Cc<gb.length;++Cc)Wb.append(Fb(gb.substr(Cc,1)));return Wb.toString()}}Object(m.a)(Xg,"TransliteratorNLModule",null,[2040]);class kl{constructor(gb){gb&&(this.style=gb.K(0))}apply(gb){return Xg.dmf(gb,Fb=>kl.Wtl(Fb,this.style))}static Wtl(gb,Fb){switch(Fb){case 0:return gb.toLowerCase();case 1:return"I"===gb?"\u0131":gb.toLowerCase();case 2:return gb.toUpperCase();case 3:return"i"===gb?"\u0130":gb.toUpperCase();default:throw Error.invalidOperation();}}}kl.XNb=0;Object(m.a)(kl,"ChangeCaseTransliterationStage",
null,[2046]);class ff{apply(gb){return Xg.dmf(gb,ff.yvp)}static yvp(gb){const Fb=gb.charCodeAt(0);return 65281<=Fb&&65374>=Fb?String.fromCharCode(Fb-65248):gb}}ff.XNb=4;Object(m.a)(ff,"LatinFullWidthToHalfWidthTransliterationStage",null,[2046]);class gj{constructor(gb,Fb){gb&&(this.ond=Fb.gnc(gb.K(0)),this.SLo=Fb.lF(gb.K(1)))}apply(gb){return gb.replace(this.ond,this.SLo)}}gj.XNb=1;Object(m.a)(gj,"RegexReplaceTransliterationStage",null,[2046]);class ej{constructor(gb,Fb){if(gb){var Wb=gb.K(0),Cc=
Fb.lF(gb.K(1)),id=new Bj(Fb.$sb(gb.K(2)));gb=0>gb.K(3)?null:new Bj(Fb.$sb(gb.K(3)));this.HJg={};for(Fb=0;Fb<Wb;++Fb)this.HJg[Cc.charAt(Fb).toString()]=Cc.substr(id.K(Fb),gb?gb.K(Fb):1)}}apply(gb){return Xg.dmf(gb,Fb=>Fb in this.HJg?this.HJg[Fb]:Fb)}}ej.XNb=2;Object(m.a)(ej,"SingleCharSubstitutionsTransliterationStage",null,[2046]);class zi{constructor(gb,Fb){this.l_h=this.k_h=0;this.zIg=null;if(gb){this.annotations=Fb.annotations;var Wb=0;try{this.k_h=gb.K(Wb);++Wb;this.l_h=gb.K(Wb);++Wb;const Cc=
gb.K(Wb);++Wb;this.zIg=Array(Cc);for(let id=0;id<Cc;++id){const Ad=gb.K(Wb);++Wb;const Cd=gb.K(Wb);++Wb;const qe=new Sa.a;qe.Dsb(gb,Wb,Cd);Wb+=Cd;this.zIg[id]=this.dho(Ad,qe,Fb)}}catch(Cc){throw Error.argument("initData");}}}dho(gb,Fb,Wb){switch(gb){case kl.XNb:return new kl(Fb);case gj.XNb:return new gj(Fb,Wb);case ej.XNb:return new ej(Fb,Wb);case ff.XNb:return new ff;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(zi,"TransliteratorNLModuleInit",
null,[]);class Lk{vHm(gb,Fb){const Wb=gb.K(0),Cc=new Sa.a;Cc.Dsb(gb,1,gb.count-1);switch(Wb){case 0:return new Jj(new $h(Cc,Fb));case 2:return new Oj(new Bg(Cc,Fb));case 3:return new el(new hh(Cc,Fb));case 5:return new Yj(new Zk(Cc,Fb));case 9:return new Xg(new zi(Cc,Fb));case 10:return new Bl(new xf(Cc,Fb));default:throw Error.notImplemented();}}}Object(m.a)(Lk,"NLModuleFactory",null,[2033]);class Gh{constructor(gb){this.opl=";";if(!gb)throw Error.argumentNull("resource");this.Koa=new $i(gb,new cc,
new Lk);this.gag=this.Koa.$Gm();this.Agj=this.Koa.annotations.S4c("Text.Text");this.ygj=this.Koa.annotations.S4c("Classification.Predictions");this.S$f=this.Koa.annotations.S4c("Classification.PredictionString");this.zgj=this.Koa.annotations.S4c("Classification.Probability");this.dPn=this.Koa.annotations.S4c("NLMod.Tokens");if(0>this.Agj||0>this.ygj||0>this.S$f||0>this.zgj)throw Error.argument("resourceObj","Resource does not represent a ranker");}ipm(){const gb=[];this.NEf(void 0,this.Vyi(gb),null);
return gb}kpm(gb,Fb){const Wb=[],Cc=[];this.NEf(gb,this.Vyi(Wb),(id,Ad)=>{const Cd=this.Koa.annotations.Iyi(id),qe=[],df=[];Fb&&Fb.length&&-1===Array.indexOf(Fb,Cd)||(id=this.Koa.annotations.getAttributeType(id),this.Hzj(id,Ad,qe,df),Ad=new rf(Cd,qe,df),Array.add(Cc,Ad))});return new Ui(Wb,Cc)}jpm(gb){const Fb=[];this.NEf(gb,Wb=>{let Cc;if(({value:Cc}=Wb.Rs(this.S$f)).returnValue){let id;({value:id}=Wb.Rs(this.zgj)).returnValue&&Array.add(Fb,new vf(Cc,id))}},null);return Fb}NEf(gb,Fb,Wb){var Cc=new F.a(this.Koa.annotations);
Cc.bC(this.Agj,gb);gb=this.gag.execute(Cc);if(({value:Cc}=gb.Rs(this.ygj)).returnValue)for(const id of Cc.items)Fb(id);if(Wb&&({value:Fb}=gb.Rs(this.dPn)).returnValue)for(const id of Fb.items)id.A7d(Wb)}Hzj(gb,Fb,Wb,Cc){if(U.Annotations.pM(gb))for(var id of Fb.items)this.Hzj(Fb.M9,id,Wb,Cc);else if(U.Annotations.w$j(gb)){id=this.Koa.annotations.aIi(gb);for(let Ad=0;Ad<id;Ad++)Array.add(Wb,this.Koa.annotations.EMi(gb,Ad)),Array.add(Cc,this.Koa.annotations.dka(this.Koa.annotations.CTb(gb,Ad),Fb.otb(Ad)))}else Array.add(Wb,
"VALUE"),Array.add(Cc,this.Koa.annotations.dka(gb,Fb))}Vyi(gb){return Fb=>{let Wb;({value:Wb}=Fb.Rs(this.S$f)).returnValue&&Array.add(gb,this.BMm(Wb))}}BMm(gb){const Fb=gb.indexOf(this.opl);return 0>Fb?gb:gb.substring(0,Fb)}}Object(m.a)(Gh,"Ranker",null,[]);var aj=e(1478);class ck{static P4b(gb,Fb){return aj.CommandResultsUtilityHelper.P4b(gb,Fb)}static Dvb(gb){return aj.CommandResultsUtilityHelper.Dvb(gb)}static Atc(gb,Fb,Wb,Cc){return aj.CommandResultsUtilityHelper.Atc(gb,Fb,Wb,Cc)}static tTb(gb,
Fb,Wb,Cc,id,Ad,Cd,qe){return aj.CommandResultsUtilityHelper.tTb(gb,Fb,Wb,Cc,id,Ad,Cd,qe)}static Mad(gb){return aj.CommandResultsUtilityHelper.Mad(gb)}static AAi(gb){const Fb=new z.a(0);var Wb=gb.split(";");gb=E.TellMeActorConstants.instance.aP();for(const Cc of Wb)if(0<Cc.length){Wb=Cc.split(":");const id=2===Wb.length?Wb[0]:Cc;if(!gb.Ddd(id))break;if(1===Wb.length)Wb=new w.a(id,5,null,null,1),Fb.aA(Wb);else if(2===Wb.length)Wb=new w.a(id,5,Wb[1],null,1),Fb.aA(Wb);else break}return Fb}static Vhf(gb,
Fb,Wb){return aj.CommandResultsUtilityHelper.Vhf(gb,Fb,Wb)}}Object(m.a)(ck,"CommandResultsUtility",null,[]);var yk=e(1479),eh=e(2);class vg{constructor(gb,Fb){this.Hxh="";this.z8e=null;this.A8e=!1;this.Mya=null;this.nuk=["TellMe.TellMeParamCollection"];this.$c=gb;this.B6a=Fb;this.$c.jNb&&(this.Mya=null)}get Mve(){if(!this.z8e&&!this.A8e){let gb=null;try{gb=window.TellMeModel}catch(Fb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("QueryRanker","TellMeModel not found. Exception: "+
Fb)}if(gb){try{this.z8e=new Gh(gb)}catch(Fb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Fb)}this.A8e=!0}else if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("QueryRanker","Classifier model not found")}return this.z8e}iP(){return"Command"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb=!1,Cc=f.a.Pv,id=null){const Ad=new x.a(gb);if((!id||Array.contains(id,
0))&&!u.a.UT(gb)){if(!this.Mve&&this.A8e){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.$c.jNb&&this.Mya&&this.Mya.initialize();if(ck.Mad(gb.sh)&&(id=ck.AAi(gb.sh),0<id.results.length)){id.displayName="Classifier Debug";Ad.Jx(id);Fb.mv(Ad);return}id=gb?this.Hxh=gb.sh:this.Hxh;if(eh.AFrameworkApplication.J.$("TellMeParameterizedQueriesEnabled")){id=
this.DMm(id);var Cd=this.P8d(id.VPf());id=id.jyi()}else id=this.CMm(id),Cd=this.Ksm(id),id=[];ck.Atc(Cd,!1,"Classifier","TFIDF");Cd=ck.tTb(gb,Cd,this.$c,this.Mya,this.B6a,id,0,1);0<Cd.results.length&&Cc!==f.a.contextMenu&&(Cd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Wb||Cd.results.length||this.$c.b5||this.$c.Xgb||(gb=new w.a("lookupNoResults",14,gb.sh,null,1),Cd.aA(gb));0<Cd.results.length&&Ad.Jx(Cd);Ad.attributes=id}Fb.mv(Ad)}VPf(){let gb=[];try{gb=this.Mve.ipm()}catch(Fb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("GetPredictions",
"Exception: "+Fb)}return gb}CMm(gb){let Fb=[];try{Fb=this.Mve.jpm(gb)}catch(Wb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("GetPredictionsWithScore","Exception: "+Wb)}return Fb}DMm(gb){try{return this.Mve.kpm(gb,this.nuk)}catch(Fb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("GetPredictionsWithTokenAttributes","Exception: "+Fb)}return new Ui([],[])}P8d(gb){const Fb=[];if(gb)for(const Wb of gb)Fb.push(new yk.a(Wb,-99999));
return Fb}Ksm(gb){const Fb=[];if(gb)for(const Wb of gb)Fb.push(new yk.a(Wb.prediction,Wb.score));return Fb}}Object(m.a)(vg,"CommandResultsProvider",null,[845]);var tm=e(1747);class Cm{constructor(gb){this.$c=gb}iP(){return"Feedback"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb,Cc,id=null){gb=new x.a(gb);if(!id||Array.contains(id,21))id=[],id.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(id),id=new z.a(22),id.displayName=
"",id.aA(new w.a("TellMeFeedback",23,null,null,1)),gb.Jx(id);Fb.mv(gb)}}Object(m.a)(Cm,"FeedbackResultsProvider",null,[845]);class Fj{constructor(gb,Fb,Wb,Cc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=gb;this.CommandId=Fb;this.CommandValueId=Wb;this.InputText=Cc}}Object(m.a)(Fj,"FindInDocumentProp",null,[]);var hj=e(16);class wg{constructor(gb){this.s3e=2;this.IIb=[];this.Ylb=[];this.$c=gb;wg.hMa=gb.sGf;wg.Jti="FindInDocumentSuggestion";wg.Jyj="FindInDocumentSuggestion3";
this.t2e=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.gTk=this.$c.jBb||!!eh.AFrameworkApplication.ta&&eh.AFrameworkApplication.ta.Pb.jBb}iP(){return"FindInDocument"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:3===this.$c.Px?this.$c.L0j?2:3:2}WL(gb,Fb,Wb=!1,Cc,id=null){const Ad=new x.a(gb);if(id&&!Array.contains(id,2))Fb.mv(Ad);else if(Array.clear(this.IIb),u.a.UT(gb)){if(Wb&&this.cZj()){Wb=new z.a(2);Wb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;id=1;Cc="";if(0<this.Ylb.length&&
!this.$c.tAc)for(var Cd of this.Ylb)if(""!==Cd.Label.toLowerCase()){if(id>=this.s3e)break;this.Ddk(Wb,Cd.Label,Cd.CommandValueId,wg.Jti+id,Cd.InputText);id++}Cd="";this.$c.vU?(Ad.Jx(Wb),Wb=new z.a(3),Cd=this.$c.Tob?u.a.Wsb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):Cd=CommonUIStrings.l_TellMeOpenFindPaneText;Cc=this.zAi("");this.Ddk(Wb,Cd,Cc,wg.Jyj,"");Ad.Jx(Wb)}Fb.mv(Ad)}else Cd="",Wb&&(Wb=this.zAi(gb.sh),Cc=[],this.$c.edb?(this.$c.QCe&&Cc.push(appChrome.actions.setControlIconSet(wg.hMa,
{"default":"FindInDocument_20"})),Cd=this.$c.G4f?u.a.jNf(gb.sh,CommonUIStrings.l_FindInDocumentScopedButtonText):gb.sh+CommonUIStrings.l_FindInDocumentScopedButtonText):this.$c.vU?(Cd=this.$c.Tob?u.a.Wsb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,gb.sh)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,gb.sh),Cc.push(appChrome.actions.setControlIconSet(wg.hMa,{"default":"FindInDocument_20"}))):Cd=this.$c.tAc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,
gb.sh),this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(wg.hMa,Cd)),E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId(wg.hMa,Wb))):(Cc.push(appChrome.actions.setControlLabel(wg.hMa,Cd)),Cc.push(appChrome.actions.setButtonCommandValueId(wg.hMa,Wb)),appChrome.api.dispatch(Cc)),this.GUj(Cd,wg.hMa,Wb,gb.sh)),this.$c.L0j?(Cd=new w.a(wg.hMa,8,gb.sh),Wb=new z.a(2),Wb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,
Wb.aA(Cd),Ad.Jx(Wb),Fb.mv(Ad)):this.$c.K9d(gb.sh).then(qe=>{const df=new w.a(wg.hMa,8,gb.sh,null,1);df.count=qe;qe=new z.a(2);qe.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;qe.aA(df);Ad.Jx(qe);Fb.mv(Ad)},qe=>{E.TellMeActorConstants.instance.gk().onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+qe);qe=new w.a(wg.hMa,8,gb.sh,null,1);const df=new z.a(2);df.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;df.aA(qe);Ad.Jx(df);Fb.mv(Ad)})}cZj(){return!!this.$c&&
this.$c.ICe}Ddk(gb,Fb,Wb,Cc,id=null){const Ad=[];Fb&&Ad.push(appChrome.actions.setControlLabel(Cc,Fb));this.$c.vU&&Ad.push(appChrome.actions.setControlIconSet(Cc,{"default":"FindInDocument_20"}));Ad.push(appChrome.actions.setButtonCommandValueId(Cc,Wb));appChrome.api.dispatch(Ad);this.GUj(Fb,Cc,Wb,"");gb.aA(new w.a(Cc,8,id,null,1,-99999))}zAi(gb){return this.gTk?u.a.MWa(gb,15,this.t2e):hj.a.Mf(gb)}GUj(gb,Fb,Wb,Cc){this.cZj()&&this.IIb.length<this.s3e&&(gb=new Fj(gb,Fb,Wb,Cc),Array.add(this.IIb,gb))}S2o(gb){for(let Fb=
0;Fb<this.IIb.length;Fb++)if(this.IIb[Fb].CommandId===gb){const Wb=this.IIb[Fb].Label;let Cc=!1;if(0<this.Ylb.length){let id=0;for(const Ad of this.Ylb){if(Ad.Label===Wb){Array.removeAt(this.Ylb,id);Cc=!0;break}id++}}!Cc&&this.Ylb.length>=this.s3e-1&&Array.removeAt(this.Ylb,1);Array.insert(this.Ylb,0,this.IIb[Fb])}}}wg.hMa=null;wg.Jti=null;wg.Jyj=null;Object(m.a)(wg,"FindInDocumentResultsProvider",null,[845]);var Od=e(1745);class zg{constructor(gb){this.$c=gb}iP(){return"Insights"}eZ(){return 0===
this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb=!1,Cc,id=null){Cc=new x.a(gb);if(!id||Array.contains(id,13))if(this.Cbp()||!u.a.UT(gb)){id=new z.a(13);var Ad=""===gb.sh.trim(),Cd=Ad?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",qe=new w.a(Cd,10,gb.sh,null,1);Wb&&(Wb=null,u.a.Mva()?Ad?Ad=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(Ad=this.$c.tAc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,gb.sh),Wb=u.a.MWa(gb.sh,1)):(Ad=
String.format(CommonUIStrings.l_InsightsButtonText,gb.sh),Wb=u.a.xPb(gb.sh)),this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(Cd,Ad)),Wb&&E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Wb))):(gb=[],gb.push(appChrome.actions.setControlLabel(Cd,Ad)),Wb&&gb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Wb)),appChrome.api.dispatch(gb)),qe.label=Ad);id.aA(qe);Cc.Jx(id)}Fb.mv(Cc)}Cbp(){return u.a.Mva()&&
this.$c.Rqp&&!this.$c.ana}}Object(m.a)(zg,"InsightsResultsProvider",null,[845]);var nh=e(1743);class Vi{constructor(gb){this.$c=gb}iP(){return"Learning"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb,Cc,id=null){Wb=new x.a(gb);id&&!Array.contains(id,21)||!u.a.UT(gb)||(id=[],Cc=this.$c.nGn,id.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Cc)),Cc=Vi.xAm(Cc),id.push(appChrome.actions.setControlLabel("LearningForSearch",Cc)),appChrome.api.dispatch(id),gb=new w.a("LearningForSearch",
22,gb.sh,null,1),id=new z.a(21),id.aA(gb),Wb.Jx(id));Fb.mv(Wb)}static xAm(gb){const Fb=[];Array.add(Fb,new nh.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Fb,new nh.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Fb,new nh.a(600,gb));Array.add(Fb,new nh.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));gb={};gb.parts=Fb;return JSON.stringify(gb)}}Object(m.a)(Vi,"LearningProvider",null,[845]);var he=e(623);class td{constructor(gb,Fb){this.aac=this.Xdc=this.Bmb=
this.CKd=null;this.HA=!1;this.Lac=gb;this.Eyk=Fb;gb&&this.Qri(gb)}vHe(){this.Lac.vHe()&&this.Qri(this.Lac)}ARf(gb){let Fb=[];var Wb=[];gb=td.mZn(gb);var Cc="";Array.clear(Wb);for(let id=0;id<gb.length;id++){const Ad=gb.charAt(id);-1!==" ".indexOf(Ad)?(Cc.length&&Array.add(Wb,Cc),Cc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Ad)?(Cc.length&&Array.add(Wb,Cc),Cc=Ad,Array.add(Wb,Cc),Cc=""):Cc+=Ad}Cc.length&&Array.add(Wb,Cc);for(gb=0;gb<Wb.length;gb++)Cc=this.Jsm(Wb[gb]),Cc=this.THl(Cc),Fb=td.oTn(Fb,
Cc);return Fb=this.c4k(Fb)}N2f(){this.HA||this.vHe();return this.HA}f2d(gb){return this.CKd[gb.toString()]}c4k(gb){for(let Fb=0;Fb<gb.length;Fb++){const Wb=this.Bmb[Fb];if(gb[Fb].commandId!==this.f2d(Wb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Cc;(Cc=gb[Fb]).score=Cc.score+Wb[1]}return gb}THl(gb){const Fb=[];for(var Wb=0;Wb<this.Bmb.length;Wb++)Fb.push(new yk.a(this.f2d(this.Bmb[Wb][0]),-5));Wb=new he.a;for(var Cc=0;Cc<gb.length;Cc++)Wb.add(this.f2d(gb[Cc][0]));for(Cc=
0;Cc<Fb.length;Cc++){const Ad=Fb[Cc];for(let Cd=0;Cd<gb.length;Cd++){var id=gb[Cd];const qe=this.f2d(id[0]);id=id[1];if(qe===Ad.commandId){Ad.score=id;Wb.remove(qe);break}}if(!Wb.count)break}return Fb}Jsm(gb){const Fb=1>gb.length;for(let Cd=0;2>=Cd;Cd++){const qe=this.aac;for(const df in qe){var Wb=qe[df],Cc=gb,id=df;const Ef=id.length+1,Sf=Array((Cc.length+1)*Ef);for(var Ad=0;Ad<=Cc.length;Ad++)Sf[Ad*Ef]=Ad;for(Ad=0;Ad<=id.length;Ad++)Sf[Ad]=Ad;for(Ad=0;Ad<id.length;Ad++)for(let Je=0;Je<Cc.length;Je++)Sf[(Je+
1)*Ef+(Ad+1)]=Cc.charAt(Je)===id.charAt(Ad)?Sf[Je*Ef+Ad]:Math.min(Math.min(Sf[Je*Ef+(Ad+1)]+1,Sf[(Je+1)*Ef+Ad]+1),Sf[Je*Ef+Ad]+1);Cc=Sf[Cc.length*Ef+id.length];if((!Cc||!Fb)&&Cc<=Cd)return Wb}}return this.Xdc}Qri(gb){this.CKd=gb.TOf();this.Bmb=gb.nNm();this.Xdc=gb.vWm();this.aac=gb.ZDm();if(this.HA=!!this.CKd&&!!this.Bmb&&!!this.aac&&!!this.Xdc)this.HA=0<this.Bmb.length&&td.J_f(this.Bmb);this.HA&&(this.HA=0<this.Xdc.length&&td.J_f(this.Xdc));this.HA&&(this.aac=td.hXm(this.aac));this.HA||(this.aac=
this.Xdc=this.Bmb=this.CKd=null)}CVm(gb){gb=this.ARf(gb);return this.fdm(gb,this.Eyk)}fdm(gb,Fb){let Wb=[];for(let Cc=0;Cc<gb.length;Cc++)gb[Cc].score>=Fb&&Wb.push(gb[Cc]);Wb.sort((Cc,id)=>Cc.score<id.score?1:Cc.score>id.score?-1:0);0<Wb.length-10&&(Wb=Wb.slice(0,10));return Wb}static oTn(gb,Fb){if(!gb.length)return Fb;if(gb.length!==Fb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Wb=0;Wb<gb.length;Wb++){if(gb[Wb].commandId!==Fb[Wb].commandId)throw Error.create("Incorrect CommandId");
let Cc;(Cc=gb[Wb]).score=Cc.score+Fb[Wb].score}return gb}static mZn(gb){return hj.a.Ph(gb)}static J_f(gb){for(let Fb=0;Fb<gb.length;Fb++)if(2!==gb[Fb].length)return!1;return!0}static hXm(gb){const Fb={};for(const id in gb){var Wb=id,Cc=gb[id];const Ad=Cc;Ad.length&&td.J_f(Ad)&&(Fb[Wb]=Cc)}return Fb}}Object(m.a)(td,"NaiveBayesClassifierModel",null,[]);class kh{constructor(gb,Fb){this.Mya=null;this.$c=gb;this.DOc=new td(Fb,gb.wHm);this.$c.jNb&&(this.Mya=null)}iP(){return"NBCommand"}eZ(){return 0===
this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb=!1,Cc=f.a.Pv,id=null){const Ad=new x.a(gb);if((!id||Array.contains(id,0))&&!u.a.UT(gb)){if(ck.Mad(gb.sh)&&(id=ck.AAi(gb.sh),0<id.results.length)){id.displayName="Classifier Debug";Ad.Jx(id);Fb.mv(Ad);return}if(!this.DOc.N2f()){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.$c.jNb&&
this.Mya&&this.Mya.initialize();id=this.DOc.CVm(gb.sh);ck.Atc(id,!1,"Classifier","NaiveBayesian");id=ck.tTb(gb,id,this.$c,this.Mya,null,null,0,1);0<id.results.length&&Cc!==f.a.contextMenu&&(id.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Wb||id.results.length||this.$c.b5||this.$c.Xgb||(gb=new w.a("lookupNoResults",14,gb.sh,null,1),id.aA(gb));0<id.results.length&&Ad.Jx(id)}Fb.mv(Ad)}}Object(m.a)(kh,"NaiveBayesCommandProvider",null,[845]);class eg{constructor(){this.FIb=null;this.HA=!1;
this.vHe()}vHe(){this.HA||(this.FIb=window.NBCRM)&&4===this.FIb.length&&(this.HA=!0);return this.HA}nNm(){return this.HA?this.FIb[1]:null}vWm(){return this.HA?this.FIb[2]:null}ZDm(){return this.HA?this.FIb[3][0]:null}TOf(){return this.HA?this.FIb[0][0]:null}}Object(m.a)(eg,"NaiveBayesModelAdapter",null,[1980]);var li=e(141);class Ll{constructor(gb){this.$c=gb}iP(){return"OfficeScript"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb){const Wb=new x.a(gb);if(!u.a.UT(gb)){gb=li.d(gb.sh);var Cc=
new z.a(28);Cc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Cc=this.CTh(gb,Ll.mAp,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Cc);Cc=this.CTh(gb,Ll.gkm,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Cc);Wb.Jx(Cc)}Fb.mv(Wb)}CTh(gb,Fb,Wb,Cc,id,Ad){const Cd=[];for(const qe of Fb)if(li.a(gb,qe)){this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(Wb,id)),E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId(Wb,
Cc))):(Cd.push(appChrome.actions.setControlLabel(Wb,id)),Cd.push(appChrome.actions.setButtonCommandValueId(Wb,Cc)),appChrome.api.dispatch(Cd));Ad.aA(new w.a(Wb,28,null,null,1));break}return Ad}}Ll.mAp="unhide row rows col cols column columns".split(" ");Ll.gkm=["freeze","selection","pane","panes"];Object(m.a)(Ll,"OfficeScriptsSamplesProvider",null,[845]);var mi=e(76),Ek=e(359),Ml=e(1497),Qk=e(1449),km=e(1496),$l=e(29),ll=e(127),tk=e(1376);class am{constructor(gb){this.eV=null;this.f7=-1;this.dbg=
14;this.gbg=12;this.attributes=this.Qef=this.query=null;this.nrc=!1;this.Xbc=[];this.$f=eh.AFrameworkApplication.pe;eh.AFrameworkApplication.J&&(this.dbg=eh.AFrameworkApplication.J.sc("TellMeMaxTermedResults",this.dbg),this.gbg=eh.AFrameworkApplication.J.sc("TellMeMaxZeroTermResults",this.gbg));this.wW=gb}get pq(){return this.Xbc}get bIe(){return this.Qef}Jx(gb){let Fb=!1;for(let Wb=0;Wb<this.pq.length;Wb++)if(30!==this.pq[Wb].groupType&&this.pq[Wb].groupType===gb.groupType){this.xif(this.pq[Wb],
gb);Fb=!0;break}Fb||this.pq.push(gb)}xif(gb,Fb){for(let Wb=0;Wb<Fb.results.length;Wb++)gb.aA(Fb.results[Wb])}SIj(gb){const Fb=[];for(const Wb of this.pq)Wb.groupType!==gb&&Fb.push(Wb);this.pq.length!==Fb.length&&(this.Xbc=Fb)}WGo(gb){let Fb=null,Wb=null,Cc=null;for(let id=0;id<gb.length;id++){const Ad=gb[id];if(Ad&&Ad.pq&&Ad.pq.length)for(const Cd of Ad.pq)if(17===Cd.groupType||18===Cd.groupType)Fb=Cd;else if(0===Cd.groupType||16===Cd.groupType)Wb=Cd,Cc=Ad}Fb&&Wb&&0<Wb.results.length&&(17===Fb.groupType&&
({Rhf:Wb,Lif:Fb}=aj.CommandResultsUtilityHelper.Vhf(Wb,Fb,this.wW.aP()?this.wW.aP().$rm:-.6)),Cc.SIj(Wb.groupType))}kip(){this.wW&&(new mi.a,this.ntd(this.wW.ihj))}bdd(gb,Fb){return this.query.sh.length>this.wW.aP().XNm&&this.Qwn(gb,Fb)||this.query.sh.length>this.wW.aP().YNm&&this.Rzn(gb,Fb)?!0:!1}Rzn(gb,Fb){return gb&&gb.length&&Fb&&Fb.length?-1===Fb.toLowerCase().indexOf(gb.toLowerCase())?!1:!0:!1}Qwn(gb,Fb){return gb&&gb.length&&Fb&&Fb.length?Fb.toLowerCase().startsWith(gb.toLowerCase()):!1}sdm(gb){const Fb=
[];for(const Wb of this.wW.aP().vU?this.bIe:this.pq)gb.contains(Wb.groupType)||Fb.push(Wb);this.wW.aP().vU?this.Qef=Fb:this.Xbc=Fb}rHp(gb,Fb){const Wb=[];for(const Cc of this.pq){const id=Cc;if(13!==id.groupType||24!==id.groupType){const Ad=gb[Qk.a[id.groupType].toLowerCase()];let Cd="False";Ad<Fb&&(Cd="True");id.displayName=id.displayName+" ("+Cd+": "+Ad+")"}Wb.push(id)}this.Xbc=Wb}ntd(gb,Fb=!1,Wb=null){if(this.wW.aP().vU){if(!Fb)for(this.Qef=Array(this.pq.length),Fb=0;Fb<this.pq.length;Fb++)this.bIe[Fb]=
this.pq[Fb];this.wW.ohj.ntd(this.pq,this.bIe,this.query,gb,Wb)}else{for(Wb=new mi.a;this.pq.length;){Fb=this.pq.pop();const Cc=Qk.a[Fb.groupType].toLowerCase(),id=gb[Cc];if(tk.c(id))throw Error.create("GroupId "+Cc+" missed from group SortingOrder");Wb.add(new Ek.a(id,Fb))}Wb.Sc((Cc,id)=>Cc.key<id.key?-1:1);for(gb=0;gb<Wb.count;gb++)Fb=Wb.K(gb).value,this.pq.push(Fb)}}lip(){var gb=!1;let Fb=!1,Wb=!1;for(let id=0;id<this.pq.length;id++){var Cc=this.pq[id];const Ad=Cc.groupType;if(8===Ad||15===Ad||
14===Ad){Cc=Cc.results;for(let Cd=0;Cd<Cc.length;Cd++){if(8===Ad&&this.bdd(this.query.sh,Cc[Cd].label)){gb=!0;break}if(15===Ad&&this.bdd(this.query.sh,Cc[Cd].label)){Fb=!0;break}if(14===Ad){if(this.bdd(this.query.sh,Cc[Cd].label)||this.bdd(this.query.sh,Cc[Cd].description)){Wb=!0;break}const qe=Cc[Cd].label.split(" ");for(const df of qe)if(this.bdd(this.query.sh,df)){Wb=!0;break}}}}}gb=this.wW.NPm(gb,Fb,Wb);this.ntd(gb)}xZb(gb,Fb,Wb,Cc,id,Ad){if(id===this.eV){var Cd=gb.data.responseData;id=null;try{id=
$l.b(Cd)}catch(Ji){E.TellMeActorConstants.instance.gk().onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Ji);return}if("RankerResults"in id&&id.RankerResults){this.LKa();var qe=id.RankerResults,df=new mi.a,Ef=new mi.a;Cd=0;for(var Sf of qe){qe=Sf.ProviderId;var Je=Sf.Score;Cd+=Je;df.add(new Ek.a(qe,Je))}df.Sc((lk,Sj)=>lk.value>Sj.value?-1:1);Je=Ad?Ad.RLi:1E-6;Sf={};qe={};let Ji=0;for(var Ug=0;Ug<df.count;Ug++){const lk=parseInt(df.K(Ug).key),Sj=df.K(Ug).value/
Cd;1===lk&&(qe.answer=Ji++,qe.entity=Ji++,qe.definition=Ji++,qe.wolframanswer=Ji++,Sj<Je&&(Ef.add(9),Ef.add(11),Ef.add(10),Ef.add(12)),Sf.answer=Sj,Sf.entity=Sj,Sf.definition=Sj,Sf.wolframanswer=Sj);2===lk&&(qe.assistance=Ji++,Sj<Je&&Ef.add(8),Sf.assistance=Sj);3===lk&&(qe.classifier=Ji++,qe.serviceclassifier=Ji++,Sj<Je&&(Ef.add(0),Ef.add(17)),Sf.classifier=Sj,Sf.serviceclassifier=Sj);4===lk&&(qe.people=Ji++,Sj<Je&&Ef.add(14),Sf.people=Sj);5===lk&&(qe.document=Ji++,Sj<Je&&Ef.add(15),Sf.document=Sj);
6===lk&&(qe.findindocument=Ji++,Sj<Je&&Ef.add(2),Sf.findindocument=Sj);7===lk&&(qe.notes=Ji++,Sj<Je&&Ef.add(20),Sf.notes=Sj);8===lk&&(qe.image=Ji++,Sj<Je&&Ef.add(19),Sf.image=Sj)}df=new mi.a;df.add("classifier");df.add("serviceclassifier");df.add("appsforoffice");df.add("addin");df.add("findindocument");df.add("assistance");df.add("document");df.add("people");df.add("answer");df.add("wolframanswer");df.add("definition");df.add("entity");df.add("image");df.add("template");df.add("officescript");for(Ug=
0;Ug<df.count;Ug++)df.K(Ug)in qe||(qe[df.K(Ug)]=Ji++);qe.learning=Ji++;qe.insights=Ji++;qe.actionai=Ji++;qe.actionaicommand=Ji++;qe.feedback=Ji++;Ad&&Ad.D4i&&this.rHp(Sf,Je);Ad&&Ad.E4i&&this.sdm(Ef);Ef={};for(var Kf in Sf)Ef[Kf]=Sf[Kf]*Cd;this.ntd(qe,!0,Ef)}if(Ad.lje&&"Intents"in id&&id.Intents){Kf=id.Intents;for(var fl of Kf)if(this.t5f(fl)&&"Serplet"===fl.GroupType&&fl.ConfidenceScore>fl.ConfidenceThreshold){Kf=!1;id=0;if(Ad.mje){Cd=new w.a("",32);for(Ef=0;Ef<this.pq.length;Ef++)if((df=this.pq[Ef].results)&&
0<df.length){id=Ef;Cd=df[0];break}2===Cd.groupType&&(Kf=!0)}Cd=new z.a(13);Kf&&Ad.mje&&(Cd=new z.a(13,CommonUIStrings.l_TellMeWebTitle));Ef=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.sh,null,0);df=[];Sf=null;Sf=u.a.Mva()?u.a.MWa(this.query.sh,1):u.a.xPb(this.query.sh);df.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Sf));Sf=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.sh);df.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",
Sf));appChrome.api.dispatch(df);Cd.aA(Ef);Ef=[];if(Kf&&Ad.mje)for(Ef.push(this.pq[id]),Ef.push(Cd),Kf=id+1;Kf<this.pq.length;Kf++)(id=this.pq[Kf].results)&&0<id.length&&Ef.push(this.pq[Kf]);else for(Ef.push(Cd),Kf=0;Kf<this.pq.length;Kf++)(id=this.pq[Kf].results)&&0<id.length&&Ef.push(this.pq[Kf]);this.Xbc=Ef}}if(Ad.mdd&&!Ad.vU){fl=Kf=-1;for(id=0;id<this.pq.length;id++)switch(this.pq[id].groupType){case 23:Kf=id;break;case 0:case 17:case 2:-1===fl&&(fl=id)}if(-1!==Kf){fl=-1===fl?0:Kf>fl?fl+1:fl;Kf=
this.pq[Kf];id=Array(this.pq.length);Cd=0;for(Ef=0;Ef<id.length;Ef++)Ef===fl?id[Ef]=Kf:(23===this.pq[Cd].groupType&&Cd++,id[Ef]=this.pq[Cd],Cd++);this.Xbc=id}}Cc.mv(this);Cc=E.TellMeActorConstants.instance.gk();Cc.U9(Fb.length,"RankerInference",gb.data.Xe.toString(),Math.round(window.performance.now()-Wb),km.a.F5j,!0,Ml.a.VYa);this.nrc&&Cc&&(gb=this.query.wzb,Fb=Cc.ACd,Ad.Fje&&gb>Fb&&!Ad.vU&&(Cc.h$f(this.query.sh),Cc.FCg(gb)))}}t5f(gb){if("GroupType"in gb&&gb.GroupType&&"ConfidenceScore"in gb&&"ConfidenceThreshold"in
gb)return!0;E.TellMeActorConstants.instance.gk().onError("IsValidIntentGroup","Invalid intents found");return!1}lZb(gb,Fb,Wb,Cc,id){Cc===this.eV&&(this.LKa(),E.TellMeActorConstants.instance.gk().U9(Fb.length,"RankerInference",gb.data.Xe.toString(),Math.round(window.performance.now()-Wb),km.a.F5j,!1,Ml.a.VYa));id.mv(this)}LKa(){-1!==this.f7&&(window.clearTimeout(this.f7),this.f7=-1)}mip(gb){let Fb;Fb=this.wW.aP().vU?E.TellMeActorConstants.instance.gk().yRf(this.bIe,this.query.sh):E.TellMeActorConstants.instance.gk().yRf(this.pq,
this.query.sh);var Wb=this.wW.aP().QLi;""!==Wb&&(Wb="_"+Wb);let Cc="";this.wW.aP().rie&&(Cc="RankerInference"+Wb+",");this.wW.aP().lje&&(Cc+="SerpletClassifier");","===Cc.charAt(Cc.length-1)&&(Cc=Cc.substring(0,Cc.length-1));Wb=E.TellMeActorConstants.instance.gk().FNi(Cc);const id=this.eV=ll.a.create().toString();Wb["Client-Request-Id"]=id;const Ad=window.performance.now(),Cd=this.wW.aP()?this.wW.aP().SLi:600;this.LKa();this.f7=window.setTimeout(()=>{if(id===this.eV){this.eV="";this.f7=-1;gb.mv(this);
const qe={};qe[a.a.provider]="Ranker";qe[a.a.R_b]=this.query.wzb;E.TellMeActorConstants.instance.gk().hE(l.a.timedOut,Cd,qe)}},Cd);this.$f.addRequest(E.TellMeActorConstants.instance.gk().GNi(),2,Fb,Wb,!1,0,qe=>{this.xZb(qe,this.query.sh,Ad,gb,id,this.wW.aP())},qe=>{this.lZb(qe,this.query.sh,Ad,id,gb)},null,null,!1,4E3,6E3)}vwp(){var gb=0,Fb=new mi.a,Wb=this.wW.ghj,Cc=this.wW.hhj;for(var id=0;id<this.pq.length;id++){var Ad=this.pq[id],Cd=Qk.a[Ad.groupType].toLowerCase(),qe=Wb[Cd];gb+=Ad.results.length;
Ad.results.length>qe&&(Cd=Cc[Cd],tk.c(Cd)||Fb.add(new Ek.a(Cd,Ad)))}Cc=!this.query||""===this.query.sh.trim();id=gb-(Cc?this.gbg:this.dbg);if(!(0>=id)){Cc=window.performance.now();gb=gb.toString()+" total,"+id.toString()+" to remove.";if(0<Fb.count)for(Fb.Sc((df,Ef)=>df.key>Ef.key?-1:1),Ad=0;Ad<Fb.count&&0<id;Ad++){Cd=Fb.K(Ad).value;qe=Qk.a[Cd.groupType].toLowerCase();let df=Cd.results.length-Wb[qe];df>id&&(df=id);0<df&&(Cd.Vvg(df),gb+=qe+": "+df.toString()+" results removed.",id-=df)}if(0<id){gb+=
id.toString()+" results left after trimming.";Fb=new mi.a;Wb=this.wW.lhj;for(Ad=0;Ad<this.pq.length;Ad++)Cd=this.pq[Ad],qe=Wb[Qk.a[Cd.groupType].toLowerCase()],tk.c(qe)||Fb.add(new Ek.a(qe,Cd));Fb.Sc((df,Ef)=>df.key<Ef.key?-1:1);for(Wb=0;0<id;)Ad=Fb.K(Wb++).value,id>=Ad.results.length?(Array.remove(this.pq,Ad),gb+=Qk.a[Ad.groupType]+": "+Ad.results.length.toString()+" results force removed.",id-=Ad.results.length):(Ad.Vvg(id),gb+=Qk.a[Ad.groupType]+": "+id.toString()+" results force removed.",id=
0)}E.TellMeActorConstants.instance.gk()&&(Fb={},Fb[a.a.message]=gb,E.TellMeActorConstants.instance.gk().hE("ShowOptimal",window.performance.now()-Cc,Fb))}}}Object(m.a)(am,"CombineResultsUpdatedEventArgs",null,[1944]);class bf{constructor(gb,Fb,Wb,Cc=!1,id=""){this.T6e=this.J9e=!1;this.ey=gb;this.oKb=[];this.$Fh=Fb.length;this.$c=E.TellMeActorConstants.instance.aP();this.FId=Cc;this.Dla=id;this.tdc={};for(gb=0;gb<Fb.length;++gb)this.tdc[gb.toString()]=Wb?0:Fb[gb].eZ()}S4o(gb,Fb){Fb&&Fb.query&&Fb.query.wzb<
E.TellMeActorConstants.instance.Q1d()||(this.oKb[gb]=Fb,this.T6e?this.J9e=!0:(!this.$c||3!==this.$c.Px||3!==this.tdc[gb.toString()]||this.Ski())&&this.tVb())}Mho(){this.T6e=!0}DAp(){this.T6e=!1;this.J9e&&(this.J9e=!1,this.tVb())}Ski(){if(this.oKb.length<this.$Fh)return!1;for(let gb=0;gb<this.$Fh;++gb)if(!this.oKb[gb])return!1;return!0}tVb(){var gb=this.Ski();const Fb=window.performance.now(),Wb=new am(E.TellMeActorConstants.instance.tNf());Wb.WGo(this.oKb);for(var Cc=0;Cc<this.oKb.length;++Cc){var id=
this.oKb[Cc];if(id&&id.pq&&id.pq.length&&(Wb.query=id.query,id.attributes&&0<id.attributes.length&&(Wb.attributes=id.attributes),id&&id.pq&&(gb||this.twl(Cc,this.oKb))))for(const Ad of id.pq)Wb.Jx(Ad)}Wb.pq&&Wb.pq.length&&(Wb.nrc=gb,this.$c&&this.$c.gHe&&Wb.vwp(),this.$c&&this.$c.jyn&&Wb.query.sh&&0<Wb.query.sh.length?Wb.lip():Wb.kip(),this.$c&&(this.$c.rie||this.$c.lje)&&this.FId&&Wb.query.sh&&0<Wb.query.sh.length&&Wb.nrc&&this.Dla!==f.a.contextMenu?(3===this.$c.Px&&gb||this.ey.mv(Wb),Wb.mip(this.ey)):
this.ey.mv(Wb),gb=E.TellMeActorConstants.instance.gk(),Wb.nrc&&gb&&(Cc=Wb.query.wzb,id=gb.ACd,Wb.query.sh&&0<Wb.query.sh.length&&this.FId&&this.$c.Fje&&this.Dla!==f.a.contextMenu&&Cc>id&&!this.$c.rie&&!this.$c.vU&&(gb.h$f(Wb.query.sh),gb.FCg(Cc)),gb.hE(l.a.vPo,window.performance.now()-Fb)))}twl(gb,Fb){if(!(this.tdc&&gb.toString()in this.tdc)||Fb.length<=gb||!Fb[gb])return!1;if(!Fb[gb].pq.length)return!0;const Wb=this.tdc[gb.toString()];if(0===Wb)return!0;const Cc=this.tdc;for(const Ad in Cc){var id=
Cc[Ad];const Cd=Number.parseInvariant(Ad);if(Cd!==gb&&id===Wb&&!(Fb.length>Cd&&Fb[Cd]))return!1}return!0}}Object(m.a)(bf,"ResultsAggregator",null,[]);var Cj=e(1780);class Wh{constructor(){this.JCc=this.KCc=this.ICc=this.gfd=this.Ktc=this.Epc=0}M1k(gb,Fb){switch(gb){case 1:this.Epc=Fb;break;case 3:this.Ktc=Fb;break;case 2:this.gfd=Fb;break;case 5:this.ICc=Fb;break;case 4:this.KCc=Fb;break;case 6:this.JCc=Fb}}}Object(m.a)(Wh,"CommandFeatures",null,[]);class zk{constructor(gb){this.Wmh=0;this.OIa=gb;
this.Qwk={}}get modelId(){return this.OIa}get zbm(){return this.Wmh}get JYc(){return this.Qwk}E0k(gb,Fb,Wb){0===Fb?this.Wmh=Wb:(this.JYc[gb]||(this.JYc[gb]=new Wh),this.JYc[gb].M1k(Fb,Wb))}}Object(m.a)(zk,"CoefficientsModel",null,[]);const Hl=(gb,Fb)=>Math.pow(10,-Fb/(60*Math.LN10/Math.LN2*gb));class Xf{constructor(gb,Fb){this.pQk=gb;this.ul=1;this.tBk=new Wh;this.features.gfd=1+Math.log(this.count)/Math.LN2;this.features.Epc=gb?1/gb:0;this.features.Ktc=2/Math.pow(2,gb);this.features.ICc=Hl(10,Fb);
this.features.KCc=Hl(2,Fb);this.features.JCc=Hl(1,Fb)}get rank(){return this.pQk}get count(){return this.ul}get features(){return this.tBk}OVi(){this.ul=this.count+1;this.features.gfd=1+Math.log(this.count)/Math.LN2}gHp(gb){const Fb=2/Math.pow(2,gb);this.features.Epc=Math.max(this.features.Epc,gb?1/gb:0);this.features.Ktc=Math.max(this.features.Ktc,Fb)}EIp(gb){const Fb=Hl(10,gb),Wb=Hl(2,gb);gb=Hl(1,gb);this.features.ICc=Math.max(this.features.ICc,Fb);this.features.KCc=Math.max(this.features.KCc,Wb);
this.features.JCc=Math.max(this.features.JCc,gb)}}Object(m.a)(Xf,"CommandModel",null,[]);class we{constructor(gb){this.BHc=null;if(!gb&&E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("PredictionEngine","IModelAdapter can't be null");this.Lac=gb;this.BKd=this.f9f()}f9f(){const gb=this.Lac.SGm(),Fb=this.Lac.TOf();if(void 0===gb||null===gb||void 0===Fb||null===Fb)return!1;try{window.performance.now();this.BHc={};for(let Wb=0;Wb<gb.length;Wb++){const Cc=gb[Wb],id=Fb[Cc[0].toString()].trim(),
Ad=Cc[1],Cd=0!==Ad?Fb[Cc[2].toString()].trim():"",qe=Cc[3];id in this.BHc||(this.BHc[id]=new zk(id));this.BHc[id].E0k(Cd,Ad,qe)}}catch(Wb){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("LoadModelData","Error Loading Suggestions Model: "+Wb);return!1}return!0}glm(){const gb=this.Lac.rDm(),Fb={};if(!gb)return Fb;let Wb=1;for(let Cc=0;Cc<gb.length;Cc++){const id=gb[Cc];id.Id in Fb?(Fb[id.Id].OVi(),Fb[id.Id].gHp(Wb),Fb[id.Id].EIp(id.TimeElapsedSinceClick)):Fb[id.Id]=
new Xf(Wb,id.TimeElapsedSinceClick);Wb++}return Fb}N2f(){this.BKd||(this.BKd=this.f9f());return this.BKd}AMm(){let gb=[];if(!this.BKd){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("GetPredictedCommands","IModelAdapter returned no data");return gb}const Fb=this.glm(),Wb=this.BHc;for(const id in Wb){const Ad=Wb[id],Cd=Ad.modelId;let qe=0;for(const df in Fb){var Cc=df;const Ef=Fb[df].features;(Cc=Cc in Ad.JYc?Ad.JYc[Cc]:null)&&(qe+=Ef.Epc*Cc.Epc+Ef.Ktc*Cc.Ktc+
Ef.gfd*Cc.gfd+Ef.ICc*Cc.ICc+Ef.KCc*Cc.KCc+Ef.JCc*Cc.JCc)}qe+=Ad.zbm;gb.push(new yk.a(Cd,qe))}gb.sort((id,Ad)=>id.score<Ad.score?1:id.score>Ad.score?-1:0);0<gb.length-10&&(gb=gb.slice(0,10));return gb}}Object(m.a)(we,"PredictionEngine",null,[]);class Rk{constructor(){this.hJh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),
"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),
"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),
"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),
"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}P8d(gb,Fb){return Fb&&"word"===Fb.application.toLowerCase()&&gb in this.hJh?this.hJh[gb]:[]}}Object(m.a)(Rk,"SuggestionResultsUtility",null,[]);class ml{constructor(gb,Fb,Wb){this.$c=Fb;this.DOc=new we(gb);this.QIa=Wb;this.cMh=new Rk}iP(){return"Suggestion"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:2}WL(gb,Fb,Wb,Cc=f.a.Pv,id=null){Wb=
new x.a(gb);E.TellMeActorConstants.instance.hib=!1;if((!id||Array.contains(id,16))&&u.a.UT(gb)){if(!this.DOc.N2f()){if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("CRASH","SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.eje()&&0<this.cMh.P8d(E.TellMeActorConstants.instance.a0c,this.$c).length){const Cd=this.cMh.P8d(E.TellMeActorConstants.instance.a0c,this.$c);
id=[];for(var Ad of Cd)this.$c.ICe&&"Find"===Ad||id.push(new yk.a(Ad,0));E.TellMeActorConstants.instance.hib=!0}else id=this.DOc.AMm();aj.CommandResultsUtilityHelper.Atc(id,!0,"Recommended","LRE");Ad=[];for(const Cd of id)this.QIa&&this.QIa.N_d(Cd.commandId)||Ad.push(Cd);gb=aj.CommandResultsUtilityHelper.tTb(gb,Ad,this.$c,null,null,null,16,1);0<gb.results.length&&Cc!==f.a.contextMenu&&(gb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<gb.results.length&&Wb.Jx(gb)}Fb.mv(Wb)}eje(){return!!this.$c&&
(this.$c.eje||this.$c.HCn)}}Object(m.a)(ml,"SuggestionResultsProvider",null,[845]);class Nl{rDm(){return E.TellMeActorConstants.instance.O8d()}SGm(){return window.TellMeSuggestionModel}TOf(){return window.CoefficientModelIdMap}}Object(m.a)(Nl,"SuggestionsModelAdapter",null,[1979]);var kk=e(1792),Sn=e(1746);e.d(K,"AggregatorResultsProvider",function(){return kg});class kg{constructor(gb=!1){this.Lbc={};this.Lbc[f.a.Pv]=[];this.Lbc[f.a.contextMenu]=[];this.FId=gb}T9i(gb,Fb,Wb,Cc,id=null){let Ad;var Cd=
!1;switch(Cc){case f.a.contextMenu:Ad=this.Lbc[f.a.contextMenu];Cd=!0;break;default:Ad=this.Lbc[f.a.Pv]}Fb=new bf(Fb,Ad,Cd,this.FId,Cc);Fb.Mho();for(let qe=0;qe<Ad.length;++qe){const df=window.performance.now(),Ef=new D(Fb,qe);(Cd=E.TellMeActorConstants.instance.aP())&&Cd.tll?window.setTimeout(()=>{Ad[qe].WL(gb,Ef,Wb,Cc,id);if(E.TellMeActorConstants.instance.gk()){const Sf={};Sf[a.a.provider]=Ad[qe].iP();Sf[a.a.R_b]=gb.wzb;E.TellMeActorConstants.instance.gk().hE(l.a.WL,window.performance.now()-df,
Sf)}},0):(Ad[qe].WL(gb,Ef,Wb,Cc,id),E.TellMeActorConstants.instance.gk()&&(Cd={},Cd[a.a.provider]=Ad[qe].iP(),Cd[a.a.R_b]=gb.wzb,E.TellMeActorConstants.instance.gk().hE(l.a.WL,window.performance.now()-df,Cd)))}Fb.DAp()}iP(){return"Aggregator"}eZ(){return 0}WL(gb,Fb,Wb=!1,Cc=f.a.Pv,id=null){if(E.TellMeActorConstants.instance.Lgd)this.T9i(gb,Fb,Wb,Cc,id);else{const Ad=window.performance.now();E.TellMeActorConstants.instance.Dxd.then(()=>{E.TellMeActorConstants.instance.gk()&&E.TellMeActorConstants.instance.gk().hE(l.a.hVn,
window.performance.now()-Ad);this.T9i(gb,Fb,Wb,Cc,id);return!0})}}addProvider(gb,Fb){this.Lbc[Fb].push(gb)}Y2k(gb){switch(gb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Fb=this.Lbc[f.a.Pv];for(const Wb of Fb)if("FindInDocument"===Wb.iP()){Wb.S2o(gb);break}}}static createInstance(gb,Fb,Wb,Cc){const id=Fb.ana;var Ad=Cc&&u.a.wFg(Fb),Cd=Ad&&Fb.ylg&&!id;const qe=Fb.$4f&&!u.a.Jrc()&&!id,df=Fb.c3f&&!id,Ef=new kg(Ad);if(Fb.Dbp&&!id){var Sf=new Vi(Fb);
Ef.addProvider(Sf,f.a.Pv)}Sf=Fb.$t?eh.AFrameworkApplication.J.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):eh.AFrameworkApplication.J.$("TellMeSuggestionsIsEnabled");const Je=!Sf&&eh.AFrameworkApplication.J.$("TellMeFirstRunExperienceIsEnabled");Ef.addProvider(new tm.a(gb,Fb.yyp,Je,!1),f.a.Pv);Sf&&!id&&Ef.addProvider(new ml(new Nl,Fb,gb),f.a.Pv);gb=eh.AFrameworkApplication.ta.Pb.v8i?new kh(Fb,new eg):new vg(Fb,Wb);Ef.addProvider(gb,f.a.contextMenu);(Ad&&Fb.zlg||Cd)&&Ef.addProvider(kk.a.jgi(Fb,!0),
f.a.Pv);Ef.addProvider(gb,f.a.Pv);!Fb.Eti||id||"Word"===Fb.application&&Fb.C6d||Ef.addProvider(new wg(Fb),f.a.Pv);Fb.jNb&&!id&&(Cd=new G(Fb),Ef.addProvider(Cd,f.a.Pv),Ef.addProvider(Cd,f.a.contextMenu));!Fb.nNb||Fb.rsd||Fb.qsd||id||Ef.addProvider(new J.a(Fb),f.a.Pv);Cc&&(Fb.b5||u.a.Mva())&&(Cd=new zg(Fb),Ef.addProvider(Cd,f.a.Pv),Ef.addProvider(Cd,f.a.contextMenu));Ad&&Ef.addProvider(kk.a.jgi(Fb,!1),f.a.Pv);Cc&&!Fb.JJg&&u.a.vFg(Fb)&&!id&&(Ef.addProvider(new Cj.a(Fb),f.a.Pv),Fb.U3j&&Ef.addProvider(new Cj.a(Fb),
f.a.contextMenu));qe&&Ef.addProvider(new Cm(Fb),f.a.Pv);!Fb.AAc&&!Fb.vU||id||Ef.addProvider(new Od.a(Fb),f.a.Pv);Fb.mdd&&!id&&Ef.addProvider(new Sn.a(Fb),f.a.Pv);Fb.nge&&(Ad=new y(Fb),Ef.addProvider(Ad,f.a.Pv),Ef.addProvider(Ad,f.a.contextMenu));Cc&&Fb.uge&&!id&&Ef.addProvider(new H.AddinResultsProvider(Fb),f.a.Pv);df&&"Excel"===Fb.application&&!id&&Ef.addProvider(new Ll(Fb),f.a.Pv);return Ef}}Object(m.a)(kg,"AggregatorResultsProvider",null,[845])},1776:function(I,K,e){I=e(0);var m=e(61),f=e(13),
a=e(5),l=e(185),w=e(231),z=e(373);e(49);var x=e(87);e(901);e(902);var u=e(486);e(487);var v=e(1734),E=e(1735),y=e(1731),H=e(1733),D=e(1732);e(900);e(899);class G{constructor(X,ka,ma){this.Ckm=X;this.Dil=ka;this.qul=ma}}Object(I.a)(G,"BacktraceAndMakeUpdateHintsInput",null,[]);var J=e(1476),U;(function(X){X[X.RUp=0]="EOP";X[X.character=1]="character";X[X.K6p=2]="embeddedMarker"})(U||(U={}));Object(I.b)("LCSBlockType",U);class F{toString(){return String.format("[Type: {0}]",U[this.type])}}Object(I.a)(F,
"ALCSBlock",null,[]);class T extends F{constructor(X,ka){super();this.PPe=ka;this.D6e=X}get type(){return 1}get character(){return this.PPe}get K0a(){return this.D6e}aE(X){return 1===X.type&&J.a.iZh(X.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(I.a)(T,"CharacterLCSBlock",F,[]);class Y extends F{constructor(X,ka,ma){super();this.D6e=X;this.qgf=ka;this.jI=ma}get type(){return 0}get qd(){return this.qgf}get length(){return this.jI}get K0a(){return this.D6e}aE(X){return 0!==
X.type?!1:X.K0a===this.K0a&&X.qd===this.qd}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.K0a.toString(),this.qd,this.length)}}Object(I.a)(Y,"EOPLCSBlock",F,[]);class P extends T{constructor(X,ka,ma){super(X,"\ufffc");this.uKk=ka;this.gFd=ma}get type(){return 2}get ze(){return this.uKk}get ol(){return this.gFd}aE(X){return 2!==X.type?!1:X.ze===this.ze&&this.ol.equals(X.ol)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.ze,this.ol)}}Object(I.a)(P,"EmbeddedMarkerLCSBlock",T,[]);class S{constructor(X,ka){this.x=X;this.y=ka}equals(X){return X.x===this.x&&X.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(I.a)(S,"IntPair",null,[911]);var N=e(1536),V=e(1504),Z=e(1538),ca=e(1730);e.d(K,"a",function(){return W});class W{constructor(X,ka){this.Ng=X;this.we=ka}tgi(X,ka,ma,ja,na,Ba,Ma){return this.ARl(X,ka,ma,ja,na,Ba,Ma)}ARl(X,ka,ma,ja,na,Ba,Ma){let Ea;Ea=null;({returnValue:X}=this.y$d(X,ka));if(!X)return l.a.instance.fb(575706449,
1,2,"Failed to get LCS blocks from objects for base"),this.we.logger.EZ("GetLCSBlocksFromObject"),{returnValue:!1,sM:Ea};({returnValue:ma}=this.y$d(ma,ja));if(!ma)return l.a.instance.fb(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.we.logger.EZ("GetLCSBlocksFromObject"),{returnValue:!1,sM:Ea};this.we.logger.EZ("GetLCSBlocksFromObject");Ea=this.zRl(X,ma,na,Ba,Ma);return Ea?{returnValue:!0,sM:Ea}:(l.a.instance.fb(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,
sM:Ea})}tti(X,ka,ma,ja){({returnValue:X}=this.y$d(X,ka));if(!X)return-1;({returnValue:ma}=this.y$d(ma,ja));if(!ma)return-1;({yyf:ma}=this.xti(X,ma));return ma}y$d(X,ka){let ma;const ja=new w.a;ma=new w.a;if(!X.length)return l.a.instance.fb(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.we.logger.mj(Object.assign(new N.a,{Dk:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,pEf:ma};for(let Ma=0;Ma<X.length;Ma++)if(this.we.runtime.IK("GetLCSBlocksFromObject: paraObjs#"+
Ma),X.K(Ma).yc===m.a.paragraphNode){const Ea=this.Ng.getPropertyString(X.K(Ma),f.a.so),ya=this.Ng.getPropertyUint32(X.K(Ma),a.a.qd);if(null==ya)return l.a.instance.fb(594124835,1,2,"Abandoning LCS due to missing WordId"),this.we.logger.mj(Object.assign(new N.a,{Dk:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,pEf:ma};let ia=this.Ng.getPropertyUint32s(X.K(Ma),f.a.sw);ia=V.a.mVj(ia,Ea.length);const za=this.Ng.getPropertyObjectIds(X.K(Ma),f.a.Qq);let Ca;for(Ca=0;Ca<ia.length-1;Ca++){var na=
ka(za.Lg(Ca)),Ba=void 0;Ba=na?(Ba=this.Ng.getPropertyBool(na,f.a.Gea))?Ba:!1:!1;if(Ba)ja.add(this.CLl(X.K(Ma).id,na));else for(na=ia.Lg(Ca);na<ia.Lg(Ca+1);na++)ja.add(new T(X.K(Ma).id,J.a.charAt(Ea,na)))}ja.add(new Y(X.K(Ma).id,ya,ia.K(Ca)));ma.add(ja.length-1)}else return l.a.instance.fb(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",X.K(Ma).yc),this.we.logger.mj(Object.assign(new N.a,{Dk:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,pEf:ma};this.we.runtime.IK("LCS: GetLCSBlocks for base");
return{returnValue:ja,pEf:ma}}CLl(X,ka){const ma=null==this.Ng.getPropertyInt32(ka,a.a.gu)?0:this.Ng.getPropertyInt32(ka,a.a.gu);return new P(X,ma,ka.id)}zRl(X,ka,ma,ja,na){ja=({yyf:ma}=this.xti(X,ka,ma,ja,na)).returnValue;this.we.logger.EZ("FindFurthestPaths");X=new G(ja,X,ka);X=new ca.a(this.sil(X,ma),1);this.we.logger.EZ("BacktraceAndMakeUpdateHints");return X}xti(X,ka,ma=-1,ja=-1,na=-1){let Ba;if(-1===ma||-1===ja||-1===na)na=ja=ma=-1;Ba=-1;const Ma=new z.a;Ma.W(new S(-1,1),new S(0,-1));if(-1!==
ma){Ma.W(new S(0,0),new S(ma,ma));var Ea=1}else Ea=0,ja=X.length,na=ka.length;for(ma=0;Ea<=X.length+ka.length;Ea++){let ya=!1;for(let ia=-Ea;ia<=Ea;ia+=2){let za,Ca;ia===-Ea?(za=Ma.K(new S(Ea-1,ia+1)).x,Ca=Ma.K(new S(Ea-1,ia+1)).y+1):ia===Ea?(za=Ma.K(new S(Ea-1,ia-1)).x+1,Ca=Ma.K(new S(Ea-1,ia-1)).y):Ma.K(new S(Ea-1,ia-1)).x>=Ma.K(new S(Ea-1,ia+1)).x?(za=Ma.K(new S(Ea-1,ia-1)).x+1,Ca=Ma.K(new S(Ea-1,ia-1)).y):(za=Ma.K(new S(Ea-1,ia+1)).x,Ca=Ma.K(new S(Ea-1,ia+1)).y+1);for(;za<ja&&Ca<na&&X.K(za).aE(ka.K(Ca));)za++,
Ca++;Ma.W(new S(Ea,ia),new S(za,Ca));if(za===ja&&Ca===na){ya=!0;Ba=Ea;ma=ia;break}}if(ya)break;this.we.runtime.IK("LCS FindFurthestPaths")}if(ma!==ja-na)return{returnValue:null,yyf:Ba};Ma.W(new S(Ba,ma),new S(ja+1,na+1));l.a.instance.fb(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",X.length,ka.length,Ba);return{returnValue:Ma,yyf:Ba}}sil(X,ka){const ma=X.Ckm,ja=X.Dil;X=X.qul;const na=new w.a;let Ba=ja.length,Ma=X.length;for(;0<Ba||0<Ma;){var Ea=
Ba-1,ya=Ma-1;if(this.Lho(ma,ka,Ba,Ma)){Ea=X.K(ya);if(1===Ea.type||2===Ea.type)this.Bin(na,Ba,Ea);else if(0===Ea.type)this.Thn(na,Ba,Ea);else return l.a.instance.fb(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Ea.type),this.we.logger.mj(Object.assign(new Z.a,{Dk:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ma--;ka--}else if(this.Kho(ma,ka,Ba,Ma)){ya=ja.K(Ea);if(1===ya.type||2===ya.type)this.rXl(na,Ea,ya);else if(0===ya.type)this.ZWl(na,Ea,ya);else return l.a.instance.fb(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",ya.type),this.we.logger.mj(Object.assign(new Z.a,{Dk:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ba--;ka--}else if(Ba&&Ma&&ja.K(Ea).aE(X.K(ya)))Ba--,Ma--;else return l.a.instance.fb(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.we.logger.mj(Object.assign(new Z.a,{Dk:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.we.runtime.IK("LCS: CreateUpdateHintsFromLCSBlocks");return na}Kho(X,ka,ma,ja){ka=
new S(ka-1,ma-ja-1);return X.Bb(ka)&&X.K(ka).x===ma-1&&X.K(ka).y===ja}Lho(X,ka,ma,ja){ka=new S(ka-1,ma-ja+1);return X.Bb(ka)&&X.K(ka).x===ma&&X.K(ka).y===ja-1}Thn(X,ka,ma){ma=new y.a(ma.K0a,ma.qd);let ja=!1;if(0<X.length&&11===X.Lg(X.length-1).type){const na=X.Lg(X.length-1);na.cp===ka&&(ja=!0,na.Z4.add(ma))}ja||(ka=new D.a(ka),ka.Z4.add(ma),X.add(ka))}Bin(X,ka,ma){var ja=!1;if(0<X.length&&11===X.Lg(X.length-1).type){const na=X.Lg(X.length-1);na.cp===ka&&((ja=Object(x.a)(H.a,na.Z4.K(na.Z4.length-
1)))?ja.text=ma.character.toString()+ja.text:na.Z4.add(new H.a(ma.K0a,ma.character.toString())),ja=!0)}ja||(ka=new D.a(ka),ka.Z4.add(new H.a(ma.K0a,ma.character.toString())),X.add(ka))}ZWl(X,ka,ma){ka=new v.a(ka,ma.K0a,ma.qd);X.add(ka)}deleteText(X,ka,ma){let ja=!1;if(0<X.sM.length&&2===X.sM.Lg(X.sM.length-1).type){const na=X.sM.Lg(X.sM.length-1);na.Eg.equals(ka.K0a)&&na.cp===ka.Pse&&(na.cp=ka.Pse-1,na.text=ma.character.toString()+na.text,ja=!0)}ja||X.sM.add(new u.a(ka.K0a,ka.Pse-1,ma.character.toString()));
--ka.Pse}rXl(X,ka,ma){let ja=!1;if(0<X.length&&8===X.Lg(X.length-1).type){const na=X.Lg(X.length-1);na.cp===ka+1&&(na.text=ma.character.toString()+na.text,--na.cp,ja=!0)}ja||X.add(new E.a(ka,ma.character.toString()))}}Object(I.a)(W,"LCSUpdateHintGenerator",null,[])},1779:function(I,K,e){e.r(K);I=e(0);var m=e(61),f=e(13),a=e(5),l=e(185),w=e(373),z=e(622),x=e(231),u=e(49),v=e(118),E=e(1457);class y extends E.a{constructor(){super()}get aha(){return"ChildNodeListMerge"}}Object(I.a)(y,"ChildNodeListMergeFailureDetail",
E.a,[]);class H{ECb(ca,W,X){return W.R4(ca,X.K(ca))}s9j(ca,W,X,ka){let ma;return({value:ma}=W.Nc(ca)).returnValue||({value:ma}=X.Nc(ca)).returnValue?ma:ka.K(ca)}}Object(I.a)(H,"ChildNodeListMergeUtils",null,[949]);var D=e(1537),G=e(1795),J=e(1602);class U{constructor(ca,W){this.classId=ca;this.azp=W}}Object(I.a)(U,"NodeChildrenTransformation",null,[]);var F=e(824),T=e(1481);class Y{constructor(ca,W,X){this.MO=ca;this.RGa=X;this.qua=W}Sue(ca){let W,X;return({sCj:W}=this.y9j(this.RGa,ca)).returnValue&&
W.j5||({sCj:X}=this.y9j(this.qua,ca)).returnValue&&X.j5}y9j(ca,W){let X;return{returnValue:({value:X}=(new T.a(this.MO,ca)).xFa.Nc(F.a.Db(W))).returnValue,sCj:X}}}Object(I.a)(Y,"NodeTriplet",null,[]);var P=e(1728);class S{constructor(ca,W,X){this.we=ca;this.Ng=W;this.W7=X;this.ZLh=!0}get kv(){return this.we}get xf(){return this.Ng}get cHa(){return this.W7}get success(){return this.ZLh}FLm(){l.a.instance.fb(4220310,1,5,"Evaluating ParentObjects");const ca=new w.a;this.qpf(ca,W=>this.kv.runtime.Ao.K(W));
this.qpf(ca,W=>this.cHa.ECb(W,this.kv.runtime.BC,this.kv.runtime.Ao));this.qpf(ca,W=>this.cHa.ECb(W,this.kv.runtime.Pw,this.kv.runtime.Ao));return ca}qpf(ca,W){const X=W(e(1779).ChildNodeListMerge.Dse);this.xf.getPropertyObjectIds(X,f.a.Fg).forEach(ka=>{this.xf.getPropertyObjectIds(W(ka),f.a.Fg).forEach(ma=>{ca.Bb(ma)&&!ka.equals(ca.K(ma))&&(this.ZLh=!1,l.a.instance.fb(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",ma,ka,ca.K(ma)));ca.W(ma,ka);return!0});
return!0})}}Object(I.a)(S,"OutlineGroupParentFinder",null,[]);var N=e(1458),V=e(1737);e.d(K,"ChildNodeListMerge",function(){return Z});class Z{constructor(ca,W=null,X=null,ka=null,ma=null){this.Ng=ca;this.Xfo=W||G.a.U9j;this.Coe=X||this.wIm();this.cHa=ka||new H;this.ljj=ma||this.xGm()}get xf(){return this.Ng}wIm(){return[new U(m.a.Kh,Object(v.a)(this,this.seo,"pageContentNodeThreewayChildMerge")),new U(m.a.gka,Object(v.a)(this,this.MRp,"wordSectionNodeThreewayChildMerge")),new U(m.a.hFa,Object(v.a)(this,
this.vse,"outlineElementContainerThreewayChildMerge")),new U(m.a.Bea,Object(v.a)(this,this.Sop,"tableCellThreewayChildMerge")),new U(m.a.yca,Object(v.a)(this,this.vse,"outlineElementContainerThreewayChildMerge")),new U(m.a.noc,Object(v.a)(this,this.vse,"outlineElementContainerThreewayChildMerge")),new U(m.a.vL,Object(v.a)(this,this.vse,"outlineElementContainerThreewayChildMerge"))]}xGm(){return[Object(v.a)(this,this.Nmo,"prepareObjectGroupings"),Object(v.a)(this,this.t1m,"handleInterOutlineGroupMerge"),
Object(v.a)(this,this.rio,"performThreewayChildMerge")]}nTn(ca){let W=0;for(;W<this.ljj.length;W++)if(!(0,this.ljj[W])(ca))return l.a.instance.fb(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",W),ca.logger.Ole("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",W),!1;return!0}Nmo(ca){const W=new w.a,X=new w.a,ka=new z.a;ca.runtime.BC.forEach((ma,ja)=>Z.Ixj(ja,W));ca.runtime.Pw.forEach((ma,ja)=>Z.Ixj(ja,X));for(let ma=0;ma<this.Coe.length;ma++){const ja=this.Coe[ma].classId;ca.runtime.byb.W(ja,
new w.a);W.Bb(ja)&&W.K(ja).forEach(na=>{var Ba=ca.runtime.Ao.K(na.id);Ba&&(Ba=new Y(Ba,na,ca.runtime.Pw.R4(na.id,Ba)),ca.runtime.byb.K(ja).add(na.id,Ba),ka.add(na.id));return!0});X.Bb(ja)&&X.K(ja).forEach(na=>{if(ka.contains(na.id))return!0;const Ba=ca.runtime.Ao.K(na.id);Ba&&ca.runtime.byb.K(ja).add(na.id,new Y(Ba,Ba,na));return!0})}ca.runtime.IK("PrepareObjectGroupings");ca.logger.Fdb("PrepareObjectGroupings");return!0}rio(ca){let W=!0;for(let X=0;W&&X<this.Coe.length;X++){const ka=this.Coe[X];
ca.runtime.IK("Before function#"+X);const ma=ka.classId;ca.runtime.byb.K(ma).forEach((ja,na)=>{ca.runtime.jWa.contains(na.MO.id)||(W=ka.azp(ca,na)&&W);W||(l.a.instance.fb(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ma,na.MO.id),ca.logger.mj(Object.assign(new y,{Dk:"PerformThreewayChildMerge",eventId:"aqtsr"})));return W});ca.runtime.IK("PerformThreewayChildMerge"+X)}ca.logger.Fdb("PerformThreewayChildMerge");return W}seo(ca,W){if(W.Sue(f.a.Fg)){var X=this.xf.getPropertyObjectIds(W.MO,
f.a.Fg);const ka=this.xf.getPropertyObjectIds(W.qua,f.a.Fg);W=this.xf.getPropertyObjectIds(W.RGa,f.a.Fg);X=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",X.length,ka.length,W.length,ca.input.source);l.a.instance.fb(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",X);ca.logger.mj(Object.assign(new y,{Dk:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:X}));return!1}return!0}MRp(ca,W){if(W.Sue(f.a.Fg)){const Ma=
new z.a,Ea=new z.a,ya=new z.a,ia=new z.a;var X=this.xf.getPropertyObjectIds(W.MO,f.a.Fg),ka=X.FU(),ma,ja=({Uci:ma}=this.ogk(W.qua,ka,Ma,"Favored")).returnValue,na=({Uci:Ba}=this.ogk(W.RGa,ka,Ea,"Unfavored")).returnValue;if(!ja||!na)return X=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ka.count,Ma.count,Ea.count,ma,Ba),ca.logger.mj(Object.assign(new y,{Dk:"WordSectionNodeThreewayChildMerge",
info:X})),!1;X.forEach(za=>{Ma.contains(za)||ya.add(za);Ea.contains(za)||ia.add(za);return!0});W=W.MO.KQ();ka=new x.a;for(ma=0;ma<X.length;ma++){var Ba=X.Lg(ma);if(ya.contains(Ba)||ia.contains(Ba)){if(ca.runtime.jWa.add(Ba),ka.length&&(ja=ka.Lg(ka.length-1),ja=ca.runtime.byb.K(m.a.hFa).K(ja),na=ca.runtime.byb.K(m.a.hFa).K(Ba),ja&&na))ya.contains(Ba)?ia.contains(Ba)||(ja.MO=ja.MO.KQ(),ja.RGa=ja.RGa.KQ(),this.NVd(ja.MO,na.MO),this.NVd(ja.RGa,na.RGa)):(ja.MO=ja.MO.KQ(),ja.qua=ja.qua.KQ(),this.NVd(ja.MO,
na.MO),this.NVd(ja.qua,na.qua))}else ka.add(Ba)}this.xf.setPropertyObjectIds(W,f.a.Fg,ka);X=new N.a(W);X.JO(f.a.Fg);ca.runtime.ks.W(W.id,X)}return!0}NVd(ca,W){const X=this.xf.getPropertyObjectIds(ca,f.a.Fg);W=this.xf.getPropertyObjectIds(W,f.a.Fg);const ka=X.pQa();W.forEach(ma=>{ka.add(ma);return!0});this.xf.setPropertyObjectIds(ca,f.a.Fg,ka)}ogk(ca,W,X,ka){let ma=0,ja=!0;this.xf.getPropertyObjectIds(ca,f.a.Fg).forEach(na=>{W.contains(na)?X.add(na):(ja=!1,l.a.instance.fb(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",
ka,na),ma++);return!0});return{returnValue:ja,Uci:ma}}t1m(ca){let W=!0;ca.runtime.byb.K(m.a.hFa).forEach((X,ka)=>{if(this.$sn(ka)){l.a.instance.fb(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ka.MO.id);let ma;const ja=new S(ca,this.xf,this.cHa);if(({Xvj:X,gik:ma}=this.nxp(ca,ja.FLm(),ka)).returnValue)return l.a.instance.fb(4220303,1,4,"Merging WordSection {0} as a unit.",ma),W=ja.success&&this.eUn(ca,ma,X)&&W,W||(l.a.instance.fb(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ka.MO.id,ja.success),ca.logger.mj(Object.assign(new y,{Dk:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ja.success)}))),W}return!0});return W}$sn(ca){if(!ca.Sue(f.a.Fg))return!1;const W=this.xf.getPropertyObjectIds(ca.MO,f.a.Fg).K(0),X=this.xf.getPropertyObjectIds(ca.qua,f.a.Fg);ca=this.xf.getPropertyObjectIds(ca.RGa,f.a.Fg);return!X.contains(W,(ka,ma)=>ka.equals(ma))||!ca.contains(W,(ka,ma)=>ka.equals(ma))}nxp(ca,W,X){W=
W.K(X.MO.id);l.a.instance.fb(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",X.MO.id,W);if(ca.runtime.jWa.contains(W))return l.a.instance.fb(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",W),{returnValue:!1,Xvj:null,gik:W};const ka=new P.a;X=ca.runtime.Ao.K(W);this.xf.getPropertyObjectIds(X,f.a.Fg).forEach(ma=>{ka.MVd(ma);
return!0});X=this.cHa.ECb(W,ca.runtime.BC,ca.runtime.Ao);this.xf.getPropertyObjectIds(X,f.a.Fg).forEach(ma=>{ka.OVd(ma);return!0});ca=this.cHa.ECb(W,ca.runtime.Pw,ca.runtime.Ao);this.xf.getPropertyObjectIds(ca,f.a.Fg).forEach(ma=>{ka.SVd(ma);return!0});return{returnValue:!0,Xvj:ka,gik:W}}Hpg(ca,W,X,ka,ma){let ja=!0;ca.forEach(na=>{const Ba=W(na);this.xf.getPropertyObjectIds(Ba,f.a.Fg).forEach(Ma=>{X.add(Ma);if(ka.Bb(Ma))return(ja=ka.K(Ma).equals(na)&&ja)||l.a.instance.fb(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",
ma,Ma,na,ka.K(Ma)),ja;ka.W(Ma,na);return!0});return!0});return ja}VJm(ca,W){let X,ka,ma,ja;X=new x.a;ka=new x.a;ma=new x.a;ja=new w.a;const na=ca.runtime.Ao;return this.Hpg(W.qNb,Ba=>na.K(Ba),X,ja,"Base")&&this.Hpg(W.HFf,Ba=>this.cHa.ECb(Ba,ca.runtime.BC,na),ka,ja,"Favored")&&this.Hpg(W.LCb,Ba=>this.cHa.ECb(Ba,ca.runtime.Pw,na),ma,ja,"Unfavored")?{returnValue:!0,M_h:X,jsi:ka,U$j:ma,Pnj:ja}:{returnValue:!1,M_h:X,jsi:ka,U$j:ma,Pnj:ja}}Ffm(ca,W,X,ka){let ma=!0;const ja=ca.runtime.Ao,na=ca.runtime.BC,
Ba=ca.runtime.Pw,Ma=ca.runtime.ks,Ea=new x.a,ya=new w.a;X.forEach(ia=>{const za=ka.K(ia);if(!za)return l.a.instance.fb(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ia),ca.logger.mj(Object.assign(new y,{Dk:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),ma=!1;za.equals(Ea.last())||(Ea.add(za),ya.add(za,new x.a));ya.K(za).add(ia);ca.runtime.jWa.add(ia);return!0});if(!ma)return!1;ya.forEach((ia,za)=>{const Ca=this.cHa.s9j(ia,na,Ba,ja).KQ();this.xf.setPropertyObjectIds(Ca,
f.a.Fg,za);Ma.W(ia,new N.a(Ca));Ma.K(ia).JO(f.a.Fg);ca.runtime.jWa.add(ia);return ma});X=this.cHa.s9j(W,na,Ba,ja).KQ();this.xf.setPropertyObjectIds(X,f.a.Fg,Ea);Ma.W(W,new N.a(X));Ma.K(W).JO(f.a.Fg);ca.runtime.jWa.add(W);return ma}eUn(ca,W,X){let ka,ma;if(!({M_h:ja,jsi:ka,U$j:ma,Pnj:X}=this.VJm(ca,X)).returnValue)return!1;var ja=D.b(ja,ka,ma);ja=this.Tvj(ca,ja);return!!ja&&this.Ffm(ca,W,ja,X)}vse(ca,W){return this.Uvj(ca,W)}Uvj(ca,W){if(W.Sue(f.a.Fg)){var X=this.RJm(W);X=this.Tvj(ca,X);if(!X)return l.a.instance.fb(4220308,
1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",W.MO.id),ca.logger.mj(Object.assign(new y,{Dk:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),J.a(W.MO,"OutlineElementContainerThreewayChildMerge_Base",1),J.a(W.qua,"OutlineElementContainerThreewayChildMerge_Favored",1),J.a(W.RGa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ka=this.xf.getPropertyObjectIds(W.MO,
f.a.Fg);const ma=X.FU();ka.forEach(ja=>{ma.contains(ja)||(ja=this.xf.getPropertyObjectIds(W.MO,f.a.FI),0<ja.length&&ca.runtime.Omg.add(ja.K(0)));return!0});ka=W.qua.KQ();this.xf.setPropertyObjectIds(ka,f.a.Fg,X);ca.runtime.ks.W(ka.id,new N.a(ka));ca.runtime.ks.K(ka.id).JO(f.a.Fg)}return!0}Sop(ca,W){let X=W.qua.hasProperty(f.a.Fg),ka=W.RGa.hasProperty(f.a.Fg);X&&(X=!!this.xf.getPropertyObjectIds(W.qua,f.a.Fg).length);ka&&(ka=!!this.xf.getPropertyObjectIds(W.RGa,f.a.Fg).length);if(X!==ka)if(this.kAn(ca.runtime.Dc))ca.logger.lej(Object.assign(new V.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ca.logger.mj(Object.assign(new V.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.Uvj(ca,W)}RJm(ca){let W,X;({Eil:ca,sbm:W,eAp:X}=this.xxm(ca));return D.b(ca,W,X)}Tvj(ca,W){l.a.instance.fb(4220309,1,5,"Considering {0} OutlineElement collections for merge.",W.length);const X=new x.a;let ka=!0;W.forEach(ma=>{if(!ma)return l.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),ca.logger.mj(Object.assign(new y,
{Dk:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ka=!1;if(1===ma.WUn&&1===ma.Axb){const Ca=ma.qNb.K(0),db=ma.HFf.K(0),pa=ma.LCb.K(0);if(Ca&&Ca.equals(db)&&Ca.equals(pa))return X.add(Ca),!0;if(1!==W.length)return l.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",Ca,db,pa,W.length),ca.logger.mj(Object.assign(new y,
{Dk:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ka=!1}const ja=new w.a,na=new x.a,Ba=new x.a,Ma=new x.a,Ea=new x.a,ya=new x.a,ia=new x.a,za=ca.runtime.Ao;ma.qNb.forEach(Ca=>ka=this.Iqg(ca,Ca,db=>za.K(db),na,Ea,ja,"Base"));if(!ka)return l.a.instance.fb(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ca.logger.mj(Object.assign(new y,{Dk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ma.HFf.forEach(Ca=>ka=this.Iqg(ca,
Ca,db=>this.cHa.ECb(db,ca.runtime.BC,za),Ba,ya,ja,"Favored"));if(!ka)return l.a.instance.fb(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ca.logger.mj(Object.assign(new y,{Dk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ma.LCb.forEach(Ca=>ka=this.Iqg(ca,Ca,db=>this.cHa.ECb(db,ca.runtime.Pw,za),Ma,ia,ja,"Unfavored"));if(!ka)return l.a.instance.fb(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ca.logger.mj(Object.assign(new y,{Dk:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ca.runtime.Dc&&ca.runtime.Dc.TTb(1000005)&&(ya.length&&this.rbm(ya,ca.runtime.BC)?(this.aUh(ya,ca,X,ja),this.MUd(ca,ja,ia)):this.aUh(ia,ca,X,ja));if(na.length){ma=null;if(!({ks:ma}=this.Xfo(ca,na,Ba,Ma,ma)).returnValue||!ma)return ka=!1;ma.forEach(Ca=>{0<Ca.Ndc.count&&ca.runtime.ks.W(Ca.rn.id,Ca);X.add(ja.K(Ca.rn.id));return!0})}return!0});return ka?X:null}rbm(ca,W){for(let X=0;X<ca.length;X++)if(W.get(ca.Lg(X).id))return!0;
return!1}MUd(ca,W,X){X.length&&(X.forEach(ka=>{ca.runtime.cBc.add(ka.id);ca.runtime.cBc.add(W.K(ka.id));return!0}),G.a.MUd(ca,this.xf,X.K(0)))}aUh(ca,W,X,ka){ca.forEach(ma=>{const ja=new N.a(ma.KQ());W.runtime.ks.W(ma.id,ja);X.add(ka.K(ma.id));return!0})}Iqg(ca,W,X,ka,ma,ja,na){var Ba=X(W);if(!Ba)return l.a.instance.fb(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",na,W),ca.logger.mj(Object.assign(new y,{Dk:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",
na)})),!1;const Ma=this.xf.getPropertyObjectIds(Ba,f.a.FI);if(!Ma||!Ma.length)return l.a.instance.fb(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",na,W),ca.logger.mj(Object.assign(new y,{Dk:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",na)})),J.a(Ba,"ProcessOutlineElement_"+na,1),!1;Ba=Ma.Lg(0);X=X(Ba);if(!X)return l.a.instance.fb(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",
na,Ba,W),ca.logger.mj(Object.assign(new y,{Dk:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",na)})),!1;if((na=this.xf.getPropertyString(X,a.a.XR))&&""!==na&&ca.runtime.Dc&&(ca.runtime.Dc.wTf(1000005),ca.runtime.Dc.TTb(1000005)))return ma.add(X),ja.add(Ba,W),ca.runtime.jWa.add(Ba),!0;ka.add(X);ja.add(Ba,W);ca.runtime.jWa.add(Ba);return!0}xxm(ca){let W,X;W=this.xf.getPropertyObjectIds(ca.MO,f.a.Fg);X=this.xf.getPropertyObjectIds(ca.qua,
f.a.Fg);ca=this.xf.getPropertyObjectIds(ca.RGa,f.a.Fg);return{Eil:W,sbm:X,eAp:ca}}kAn(ca){if(!ca)return l.a.instance.fb(51422868,1,2,"Feature Helper is null"),!1;ca.bJ(98);return ca.isFeatureEnabled(98)}static Ixj(ca,W){W.Bb(ca.yc)||W.W(ca.yc,new x.a);W.K(ca.yc).add(ca);return!0}}Z.Dse=u.a.Of("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(I.a)(Z,"ChildNodeListMerge",null,[940])},1780:function(I,K,e){I=e(0);var m=e(1394),f=e(1595),a=e(1477),l=e(1422),w=e(1717),z=e(1497);class x{constructor(W,
X){this.DimensionValue=this.DimensionName=null;this.DimensionName=W;this.DimensionValue=X}}Object(I.a)(x,"Dimension",null,[]);class u{constructor(W,X,ka,ma,ja){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=W;this.Query=X;this.From=ka;this.Size=ma;ja&&(this.Filter=ja)}}Object(I.a)(u,"EntityRequest",null,[]);class v{constructor(W){this.QueryString=null;this.QueryString=W}}Object(I.a)(v,"Query",null,[]);var E=e(1396);class y{constructor(W,X){this.Dimensions=this.Name=
null;this.Name=W;this.Dimensions=X}}Object(I.a)(y,"Scenario",null,[]);var H=e(1398),D=e(1400);class G{constructor(W,X,ka,ma){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=W;this.TimeZone=X;this.Cvid=ka;this.Scenario=ma}}Object(I.a)(G,"SubstrateBody",null,[]);var J=e(1496),U=e(1390),F=e(2),T=e(1711),Y=e(1710),P=e(1456),S=e(29),N=e(16),V=e(127),Z=e(1389);e.d(K,"a",function(){return ca});class ca{constructor(W){this.IPc=this.$mb=this.YKd=this.jKc=this.qQc=0;this.BBh=
this.SEh=this.eV=null;this.j2e=0;this.f7=-1;this.iTc="";this.qWe=!1;this.$f=F.AFrameworkApplication.pe;this.$c=W;this.RQd=this.zRf();this.DKb=new f.a;this.Wzh=this.$c.gHe?3:2;this.edf=this.$c.gHe&&this.$c.D_j?5:3;this.Dgf=this.$c.ICe?2:3;this.CQh=1;this.eKd=this.$c.dIi;this.$Kh=this.$c.vzn;this.tRc=W.hMi;F.AFrameworkApplication.J&&(this.SEh=F.AFrameworkApplication.J.rb("AppCatalogUrl")+F.AFrameworkApplication.J.rb("SearchPersonaPhotoBaseUrl"),this.qWe=this.$c.Yjc||this.$c.ana||this.$c.y4d);this.$c.ana&&
(this.Dgf=this.edf=5)}iP(){return"Substrate"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:3}WL(W,X,ka,ma=m.a.Pv,ja=null){const na=new D.a(W);if(!ja||Array.contains(ja,14)||Array.contains(ja,15)||Array.contains(ja,20))if(!this.j2e||window.performance.now()-this.j2e>=U.a.zhb)if(ka=this.DKb.MMi())this.j2e=window.performance.now(),ka.then(Ba=>{Ba&&""!==Ba?(this.iTc=Ba,""!==this.eV&&this.LMi(W,ma,this.iTc,X,ja)):(Z.TellMeActorConstants.instance.gk().onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),
X.mv(na))},Ba=>{Z.TellMeActorConstants.instance.gk().onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ba);X.mv(na)});else{if(Z.TellMeActorConstants.instance.gk())Z.TellMeActorConstants.instance.gk().onError("SubstrateResultsProvider:IssueQuery","undefined token promise");X.mv(na)}else this.iTc&&""!==this.iTc?this.LMi(W,ma,this.iTc,X,ja):(X.mv(na),Z.TellMeActorConstants.instance.gk().onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else X.mv(na)}SFa(){this.$mb=
this.IPc=this.YKd=this.jKc=this.qQc=0}LMi(W,X,ka,ma,ja){this.SFa();const na=new D.a(W),Ba=this.eV=V.a.create().toString();this.LKa();this.f7=window.setTimeout(()=>{if(Ba===this.eV){this.eV="";this.f7=-1;ma.mv(na);const ya={};ya[a.a.provider]=this.iP();ya[a.a.R_b]=W.wzb;Z.TellMeActorConstants.instance.gk().hE(l.a.timedOut,this.tRc,ya)}},this.tRc);const Ma={"Content-Type":"application/json",Accept:"application/json"};Ma.Authorization="Bearer "+ka;Ma["X-Office-Version"]=F.AFrameworkApplication.buildVersion;
Ma["X-Office-Application"]=F.AFrameworkApplication.J.rb("Application");Ma["X-Office-Platform"]="WAC";Ma["X-TellMe-SessionId"]=Z.TellMeActorConstants.instance.Dnc();Ma["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;Ma["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;Ma["Client-Request-Id"]=Ba;const Ea=window.performance.now();this.$f.addRequest(this.RSm(),2,this.SSm(W.sh,this.$c.application,Z.TellMeActorConstants.instance.Dnc(),U.a.UT(W)),Ma,!1,0,ya=>{this.xZb(ya,W,ma,Ba,Ea,
X,ja)},ya=>{this.lZb(ya,W,ma,Ba,Ea)},null,null,!1,4E3,6E3)}LKa(){-1!==this.f7&&(window.clearTimeout(this.f7),this.f7=-1)}xZb(W,X,ka,ma,ja,na,Ba){Z.TellMeActorConstants.instance.gk().U9(X.sh.length,this.RQd.join(","),W.data.Xe.toString(),Math.round(window.performance.now()-ja),J.a.T3j,!0,z.a.VYa);const Ma=U.a.UT(X),Ea=new D.a(X);if(ma===this.eV){this.LKa();W=S.b(W.data.responseData);if(W.Groups){W=W.Groups;for(const ya of W)"People"===ya.Type&&this.$c.Eud&&(Ba?Array.contains(Ba,14):1)?(W=this.nJi(ya.Suggestions,
Ma,na),0<W.results.length&&Ea.Jx(W)):"File"===ya.Type&&this.$c.Cud&&(Ba?Array.contains(Ba,15):1)?(W=this.PMf(ya.Suggestions,Ma,na),0<W.results.length&&(this.Jhe()&&(ma=new E.a("GenerateSlidesFromTellMe",30,"",null,1),W.aA(ma)),Ea.Jx(W))):"Notes"===ya.Type&&this.$c.Cwb&&na!==m.a.contextMenu&&(Ba?Array.contains(Ba,20):1)&&(W=this.$Hi(ya.Suggestions,Ma,X),0<W.results.length&&Ea.Jx(W))}ka.mv(Ea);Z.TellMeActorConstants.instance.gk().U9(X.sh.length,this.RQd.join(","),"",Math.round(window.performance.now()-
ja),"",!0,z.a.provider)}else ka.mv(Ea)}$Hi(W,X,ka){const ma=new H.a(20);ma.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ja of W)this.MBn(ja)&&(W=ja.NotesType,W=N.a.Ph(W),W=this.MIm(W,ja.LastModifiedTime,ja.BodyPreview,ja.Subject,X,ka,ja))&&(W.groupType=20,ma.aA(W));return ma}nJi(W,X,ka){const ma=new H.a(14);ma.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const na of W)if(this.NBn(na)){var ja=na.Id.split("@")[0];W=na.EmailAddresses[0];let Ba=na.Type;if(void 0===Ba||
null===Ba)Ba="User";if(ja=this.ULm(Ba,na.DisplayName,na.JobTitle,W,ja,ka,X))ja.description=W,W=na.JobTitle,"Department"in na&&"CompanyName"in na&&(W+="@"+na.Department+"@"+na.CompanyName),ja.additionalInfo=W,ma.aA(ja)}return ma}PMf(W,X,ka){const ma=new H.a(15);ma.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ya of W)if(this.DBn(ya)){var ja=ya.FileName;W=ya.FileExtension;var na=ja;ja.length>W.length&&na.endsWith(W)&&(na=ja.substr(0,ja.length-W.length-1));var Ba=void 0,Ma=0;"DateCreated"in
ya&&ya.DateCreated?(Ma=U.a.nSf(ya.DateCreated),Ba=U.a.bOi(ya.DateCreated),Ba=String.format(CommonUIStrings.l_CreatedTimeFormatString,ya.Author,Ba)):Ba=ya.Author;var Ea=ya.AccessUrl+"?web=1";const ia=N.a.Goc(Ea);ja=String.format('<a href="{0}">{1}</a>',ia,N.a.N1(ja));if(ka!==m.a.contextMenu||N.a.BZ(Ea))if(na=this.Qym(na,ka===m.a.contextMenu?ja:Ea,Ba,ya.FileExtension,ya.Text,X))na.description=ya.Author,na.rVd=Ma,ma.aA(na),this.qWe&&(Ma=ya.AccessUrl,ja=U.a.J9d(W),Ba=ya.DateModified?ya.DateModified:ya.DateCreated,
Ea=ya.Size?ya.Size:ya.FileSize,this.vap()&&(Ma=Ma.replace(RegExp("%20","g")," "),ja=U.a.MRm(W)),W=new w.a(ja,Ma,ya.SPWebUrl,ya.Id,Ea,Ba),Z.TellMeActorConstants.instance.swd(!1,na.value,W))}return ma}lZb(W,X,ka,ma,ja){ma===this.eV&&(this.LKa(),Z.TellMeActorConstants.instance.gk().U9(X.sh.length,this.RQd.join(","),W.data.Xe.toString(),Math.round(window.performance.now()-ja),J.a.T3j,!1,z.a.VYa));W=new D.a(X);ka.mv(W)}ULm(W,X,ka,ma,ja,na,Ba){Ba=Ba?this.CQh:this.Wzh;if(!window.LPC&&!U.a.L0f()||this.qQc===
Ba)return null;this.qQc+=1;Ba="PeopleSuggestion"+this.qQc.toString();var Ma=this.SEh+"?size=1&accountName="+ma;W=Object.assign(new T.a,{PersonaType:W,Smtp:ma,ProfilePictureUrl:Ma,AadObjectId:ja});const Ea=Object.assign(new Y.a,{identifiers:W,displayName:X});W=na===m.a.contextMenu;this.$c.zDa?(Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ba,Ea,X,ka)),na===m.a.contextMenu&&(ka=U.a.Tfi(X,ma,ja),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ba,
ka))),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ba,W))):(Ma=[],Ma.push(appChrome.actions.setPersonaButtonCoauthor(Ba,Ea,X,ka)),na===m.a.contextMenu&&(ka=U.a.Tfi(X,ma,ja),Ma.push(appChrome.actions.setButtonCommandValueId(Ba,ka))),Ma.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ba,W)),appChrome.api.dispatch(Ma));return new E.a(Ba,11,X,ma,0)}MIm(W,X,ka,ma,ja,na,Ba){if(ja&&!this.$c.z8i||this.YKd===this.eKd||this.IPc===
this.eKd||this.$mb===this.eKd)return null;var Ma=null;this.YKd+=1;ja="";const Ea=[],ya={};Ba.type="Notes";this.BBh=Object.assign(new P.a,{landingTab:"Notes",data:Ba});na=U.a.MWa(na.sh,33,this.BBh);if("onenotepagepreviews"===W){if(!("ClickthroughUrl"in Ba&&Ba.ClickthroughUrl)||""===Ba.ClickthroughUrl)return null;this.IPc+=1;ja="OnenoteNotesSuggestion"+this.IPc.toString();ya["default"]="SaveAsonetoc2_20";Ma=Ba.ClickthroughUrl;Ea.push(appChrome.actions.setControlIconSet(ja,ya));Ea.push(appChrome.actions.setCompoundButtonCommandValueId(ja,
Ma));Ma=new E.a(ja,19,null,null,0)}else if("stickynote"===W){if(!this.$Kh)return null;this.$mb+=1;ja="NotesSuggestion"+this.$mb.toString();ya["default"]="ShowAllNotes_20";Ea.push(appChrome.actions.setControlIconSet(ja,ya));Ea.push(appChrome.actions.setCompoundButtonCommandValueId(ja,na));Ma=new E.a(ja,21,null,null,0)}else if("samsung"===W){if(!this.$Kh)return null;this.$mb+=1;ja="NotesSuggestion"+this.$mb.toString();ya["default"]="CategoryCollapsed_20";Ea.push(appChrome.actions.setControlIconSet(ja,
ya));Ea.push(appChrome.actions.setCompoundButtonCommandValueId(ja,na));Ma=new E.a(ja,20,null,null,0)}""!==ja&&(W=U.a.bOi(X),W=String.format(CommonUIStrings.l_LastModifiedString,W),Ma.label=ma,Ma.rVd=U.a.nSf(X),Ea.push(appChrome.actions.setControlLabel(ja,ma)),Ea.push(appChrome.actions.updateCompoundButtonDescription(ja,W)),Ea.push(appChrome.actions.setControlCustomTooltip(ja,ka)),appChrome.api.dispatch(Ea));return Ma}Qym(W,X,ka,ma,ja,na){if(this.jKc===(na?this.Dgf:this.edf)||this.qWe&&"Word"!==U.a.J9d(ma))return null;
this.jKc+=1;na="FileSuggestion"+this.jKc.toString();const Ba=[],Ma={};Ma["default"]=U.a.pCm(ma);this.$c.zDa?(Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(na,W)),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlIconSet(na,Ma)),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(na,ka)),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(na,X)),Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlCustomTooltip(na,
ja)),this.$c.Yjc&&Z.TellMeActorConstants.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(na,"QuickActionOnFile"))):(Ba.push(appChrome.actions.setControlLabel(na,W)),Ba.push(appChrome.actions.setControlIconSet(na,Ma)),Ba.push(appChrome.actions.updateCompoundButtonDescription(na,ka)),Ba.push(appChrome.actions.setCompoundButtonCommandValueId(na,X)),Ba.push(appChrome.actions.setControlCustomTooltip(na,ja)),this.$c.Yjc&&Ba.push(appChrome.actions.setCompoundButtonSecondaryButtonId(na,
"QuickActionOnFile")),appChrome.api.dispatch(Ba));return new E.a(na,6,W,ka,0)}zRf(){const W=[];this.$c.Eud&&Array.add(W,"People");this.$c.Cud&&Array.add(W,"File");this.$c.Cwb&&Array.add(W,"Notes");return W}SSm(W,X,ka,ma){var ja=new v(W);W=new u("File",ja,0,ma?this.Dgf:this.edf,null);ma=new u("People",ja,0,ma?this.CQh:this.Wzh,U.a.Zho);ja=new u("Notes",ja,0,this.eKd,null);(this.$c.Yjc||this.$c.y4d)&&"powerpoint"===X.toLowerCase()&&(X="word");X=new x("app",X.toLowerCase());var na=[];Array.add(na,X);
X=new y("tellmesearch",na);na=[];this.$c.Cud&&Array.add(na,W);this.$c.Eud&&Array.add(na,ma);this.$c.Cwb&&Array.add(na,ja);ka=new G(na,"UTC",ka,X);return S.c(ka)}RSm(){let W=this.$c.enp;this.$c.Cwb&&(W+="?&setflight=NotesFrom3S");""!==this.$c.NMi&&(W=W+"&"+this.$c.NMi);return W}NBn(W){return"DisplayName"in W&&"Id"in W&&"EmailAddresses"in W&&!!W.Id&&!!W.EmailAddresses}DBn(W){return"FileExtension"in W&&!!W.FileExtension&&"FileName"in W&&!!W.FileName&&""!==W.FileName&&"AccessUrl"in W&&!!W.AccessUrl&&
""!==W.AccessUrl}MBn(W){return"Id"in W&&!!W.Id&&"NotesType"in W&&!!W.NotesType&&"Subject"in W&&!!W.Subject&&""!==W.Subject}Jhe(){return!!F.AFrameworkApplication.J&&F.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}vap(){return!!F.AFrameworkApplication.J&&F.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(I.a)(ca,"SubstrateResultsProvider",null,[845])},1782:function(I,
K,e){I=e(0);var m=e(61),f=e(33),a=e(5),l=e(13),w=e(185),z=e(90),x=e(190),u=e(231),v=e(622),E=e(49),y=e(373),H=e(2),D=e(1334),G=e(986),J=e(1332);class U{constructor(ja,na=0){this.jwf=null;this.wng=0;this.QN=ja;this.zbg=na}}Object(I.a)(U,"GraphMergerResponse",null,[]);var F=e(118),T=e(1),Y=e(100),P=e(907),S=e(1457),N=e(1535);class V extends N.a{constructor(){super();this.b2j=null;this.phk=!1}get aha(){return"Crash"}BSb(){this.detail.W("Type",this.aha);this.detail.W("Trace",this.Iwp(this.b2j));this.detail.W("Continue",
this.phk);return this.detail}Iwp(ja){ja=ja.split("\n");const na=4<ja.length?4:ja.length,Ba=new Sys.StringBuilder;for(let Ma=0;Ma<na;Ma++)Ma===na-1?Ba.append(String.format("{0}...",ja[Ma])):Ba.append(String.format("{0}\n",ja[Ma]));return Ba.toString()}}Object(I.a)(V,"CrashMergeFailureDetail",N.a,[]);var Z=e(2005),ca=e(1481),W=e(1629),X=e(1458);class ka{constructor(){this.qkl=new y.a;this.PCl=new y.a;this.hGl=new y.a}}Object(I.a)(ka,"RangeMarkers",null,[]);e.d(K,"a",function(){return ma});class ma{constructor(){this.zce=
0;this.vph=this.Okb=this.Jac=this.Ng=this.THh=this.$bc=null;this.Uzh=0;this.Dwh=50;this.Vmh=this.pgh=null}get Rfb(){return this.$bc}get sQo(){return this.THh}get xf(){return this.Ng}get Dxb(){return this.Jac}get AQi(){return this.Okb}get OZm(){return this.vph}get buc(){return this.Uzh}get V6h(){return this.pgh}get f3c(){return this.Vmh}lYb(ja,na,Ba,Ma,Ea,ya,ia){Ba=this.TNl(ja,na,Ma,Ea,ya,ia,this.f3c);Ma=0;const za=Ba.runtime.NCe;let Ca=null;try{this.CMn(za,Ba,ia,ja,na,Ea,ya);let db=J.a.success;for(;Ma<
this.Dxb.length;Ma++)if(!(0,this.Dxb[Ma])(Ba)){db=J.a.fk;Ba.logger.Ole("GraphMerger.GetMergeFunctions()",Ma);break}return Ca=new U(Ba.output.QN,db)}catch(db){const pa=!Ba.output.timeout;Ba.output.dCa=pa;const ua=this.D9d(db),Ga=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",pa?"Crashed":"Timed Out",Ba.input.mYb,!!Ba.output.QN,ua);pa?(w.a.instance.fb(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ga),Ba.logger.mj(Object.assign(new V,{b2j:ua,phk:!!Ba.output.QN}))):
w.a.instance.fb(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Ga);if(Ba.output.QN)return Ca=new U(Ba.output.QN,J.a.fk);throw db;}finally{Ba.output.succeeded?this.zMn(za,Ba,Ma):Ba.output.timeout?this.BMn(Ba,Ma):Ba.output.dCa?Ba.output.QN?this.AMn(Ba,Ma):this.yMn(Ba,Ma):this.xMn(Ba,Ma);Ba.logger.wMn();w.a.instance.nqa(42350232,1,Ba.output.succeeded?4:2,"MergeLogger",Ba.logger.zGm());Ba.logger.Xfd.DSi()&&w.a.instance.nqa(559015903,1,2,"MarkerInfo",Ba.logger.Xfd.toString());if(Ba.runtime.Dc&&Ba.runtime.Dc.isFeatureEnabled(66))try{this.RJn(Ba)}catch(db){w.a.instance.fb(571619421,
1,4,"Error logging references: {0}",db.toString())}this.iNn(Ba);Ca.wng|=(Ba.output.succeeded?2:1)<<2*(ia-1);if(Ca)try{Ca.jwf=this.tmo(Ba)}catch(db){w.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",db)}}}iNn(ja){if(!ja.output.succeeded){ja=ja.output.timeout?"Timeout":ja.logger.DCj?ja.logger.DCj.aha:"Unknown";const na=new Y.a;z.Health.instance.recordQosError(ja,["MergeFailure"],!0,!0,!1,!1,na)}}RJn(ja){const na=Ea=>{const ya=this.AMa()-ja.input.K2a>this.buc;if(0<this.buc&&
ya)throw w.a.instance.fb(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ea),x.a.invalidOperation(Ea);};let Ba=ja.runtime.BC.keys,Ma=Ea=>ja.runtime.BC.K(Ea);this.B9f(ja,na,Ba,Ma,"Favored");Ba=ja.runtime.Pw.keys;Ma=Ea=>ja.runtime.Pw.K(Ea);this.B9f(ja,na,Ba,Ma,"Unfavored");Ba=ja.runtime.ks.keys;Ma=Ea=>{const ya=ja.runtime.ks.K(Ea);return ya?ya.rn:ja.runtime.BC.K(Ea)};this.B9f(ja,na,Ba,Ma,"Merged")}B9f(ja,na,Ba,Ma,Ea){var ya=new u.a;const ia=new u.a;for(let za=0;za<Ba.length;za++){na("LogAddedAndDeletedNodes");
const Ca=Ma(Ba.K(za));if(Ca.yc===m.a.tqa)continue;const db=ja.runtime.Ao.K(Ca.id);db&&this.SJn(ya,ia,Ca,db)}this.hfj(ia,za=>ja.runtime.Ao.K(za),na);this.hfj(ya,Ma,na);na=new Sys.StringBuilder;for(Ba=0;Ba<ya.length;Ba++)na.append(ya.K(Ba).toString()+",");ya=new Sys.StringBuilder;for(Ba=0;Ba<ia.length;Ba++)ya.append(ia.K(Ba).toString()+",");w.a.instance.nqa(571619423,1,4,Ea+" revision: Added references",na.toString());w.a.instance.nqa(571619424,1,4,Ea+" revision: Deleted references",ya.toString())}SJn(ja,
na,Ba,Ma){const Ea=Ba.Ak();for(let ia=0;ia<Ea.length;ia++){const za=Ea[ia];if(this.r_i(za)){var ya=this.xf.getPropertyObjectIds(Ba,za);this.FLn(ja,na,Ma,za,ya)}else this.e5i(za)&&(ya=this.xf.getPropertyObjectId(Ba,za),this.ELn(ja,na,Ma,za,ya))}}hfj(ja,na,Ba){Ba("LogNestedReferences");Ba=new u.a;const Ma=new v.a;for(let Ea=0;Ea<ja.length;Ea++){const ya=ja.K(Ea);this.d$f(ya,Ba,Ma,na)}for(na=0;na<Ba.length;na++)ja.add(Ba.K(na))}d$f(ja,na,Ba,Ma){const Ea=Ma(ja);if(Ea){const ia=Ea.Ak();for(let za=0;za<
ia.length;za++){var ya=ia[za];if(this.r_i(ya)){ya=this.xf.getPropertyObjectIds(Ea,ya);for(let Ca=0;Ca<ya.length;Ca++)Ba.contains(ya.K(Ca))||(na.add(ya.K(Ca)),Ba.add(ya.K(Ca)),this.d$f(ya.K(Ca),na,Ba,Ma))}else this.e5i(ya)&&(ya=this.xf.getPropertyObjectId(Ea,ya),Ba.contains(ya)||(na.add(ya),Ba.add(ya),this.d$f(ja,na,Ba,Ma)))}}}FLn(ja,na,Ba,Ma,Ea){if(this.xf.hasProperty(Ba,Ma)){Ba=this.xf.getPropertyObjectIds(Ba,Ma);const ya=Ba.FU();Ma=Ea.FU();for(let ia=0;ia<Ea.length;ia++)ya.contains(Ea.K(ia))||ja.add(Ea.K(ia));
for(ja=0;ja<Ba.length;ja++)Ma.contains(Ba.K(ja))||na.add(Ba.K(ja))}else for(na=0;na<Ea.length;na++)ja.add(Ea.K(na))}ELn(ja,na,Ba,Ma,Ea){Ea&&(this.xf.hasProperty(Ba,Ma)?(Ba=this.xf.getPropertyObjectId(Ba,Ma),Ea.equals(Ba)||(ja.add(Ea),na.add(Ba))):ja.add(Ea))}vMn(ja){w.a.instance.fb(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ja.input.mYb,ja.output.dCa,ja.output.timeout)}CMn(ja,na,Ba,Ma,Ea,ya,ia){if(ja){ja=Ma.length?Ma.Lg(Ma.length-1):null;var za=Ea.length?Ea.Lg(Ea.length-
1):null;Ba=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",na.input.mYb,Ma.length,ja?ja.id:E.a.nil,ja?ja.rL?ja.rL.id:E.a.nil:E.a.nil,Ea.length,za?za.id:E.a.nil,za?za.rL?za.rL.id:E.a.nil:E.a.nil,ya,ia,this.buc,Ba);switch(na.input.source){case 5:w.a.instance.fb(51663493,1,4,Ba);break;default:w.a.instance.fb(4051606,
1,4,Ba)}}}zMn(ja,na,Ba){if(ja)switch(ja=this.L5c(na,Ba,"Succeeded"),na.input.source){case 5:w.a.instance.fb(51663494,1,4,ja);break;default:w.a.instance.fb(4059162,1,4,ja)}}BMn(ja,na){na=this.L5c(ja,na,"Timeout");switch(ja.input.source){case 5:w.a.instance.fb(51663495,1,4,na);break;default:w.a.instance.fb(4059163,1,2,na)}}xMn(ja,na){na=this.L5c(ja,na,"Rejection");switch(ja.input.source){case 5:w.a.instance.fb(51663496,1,4,na);break;default:w.a.instance.fb(4059164,1,2,na)}}AMn(ja,na){na=this.L5c(ja,
na,"Crash - Rejection");switch(ja.input.source){case 5:w.a.instance.fb(51663497,1,4,na);break;default:w.a.instance.fb(4059165,1,2,na)}}yMn(ja,na){na=this.L5c(ja,na,"Crash - Failed");switch(ja.input.source){case 5:w.a.instance.fb(51663498,1,4,na);break;default:w.a.instance.fb(4059166,1,2,na)}}L5c(ja,na,Ba){const Ma=ja.output.QN,Ea=Ma&&Ma.length?Ma.Lg(Ma.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
ja.input.mYb,Ba,this.AMa()-ja.input.K2a,na,Ma?Ma.length:0,Ea?Ea.id:E.a.nil,Ea?Ea.rL?Ea.rL.id:E.a.nil:E.a.nil,ja.input.source)}TNl(ja,na,Ba,Ma,Ea,ya,ia){const za=new Z.a,Ca=za.input;Ca.Jea=ja;Ca.R3a=na;Ca.Wl=Ba;Ca.Ooa=Ma;Ca.GUb=Ea;Ca.source=ya;Ca.f3c=ia;Ca.K2a=this.AMa();za.logger.U5o(Ca.K2a);ja=za.runtime;ja.Bsd=w.a.instance.k6(1,5);ja.NCe=w.a.instance.k6(1,4);let db="";ja.IK=pa=>{if(this.buc){var ua=this.AMa()-Ca.K2a,Ga=ua>this.buc;db+=String.format(" ({0}: {1})",pa,ua);Ga&&(za.output.timeout=!0,
pa=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",Ca.mYb,this.buc,pa,ua,db),w.a.instance.fb(528061012,1,2,pa),this.jsp(pa))}};return za}F6c(){return[Object(F.a)(this,this.hdo,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.Qsn,"isInputValid"),Object(F.a)(this,this.xen,"initializeOutputMergeState"),Object(F.a)(this,this.hfe,"initializeRuntimeMergeState"),W.a.Ylo,Object(F.a)(this.V6h,this.V6h.nTn,"mergeChildNodeLists"),
Object(F.a)(this,this.lyp,"tryObjectMerge"),W.a.Clo,Object(F.a)(this,this.ydm,"finalizeObjectMerge"),Object(F.a)(this,this.RLp,"validateMarkers"),Object(F.a)(this,this.b3k,"addMergeResultsToOutput")]}hdo(ja){const na=ja.input.Jea;ja=ja.output;return na?na.length?!0:(w.a.instance.fb(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ja.QN=na,ja.succeeded=!0,!1):(w.a.instance.fb(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
ja.QN=na,ja.succeeded=!0,!1)}Qsn(ja){var na=ja.input;const Ba=na.Jea,Ma=na.R3a,Ea=na.Wl,ya=na.Ooa;na=na.GUb;ja=ja.output;if(!Ma||!Ma.length)return w.a.instance.fb(42350233,1,5,"IsInputValid: No local changes to merge."),ja.QN=Ba,ja.succeeded=!0,!1;let ia=!0;if(2!==ya&&1!==ya)return ja.QN=Ba,!1;Ea&&Ea!==E.a.nil||(ia=!1);Ba.length<(na?2:1)&&(w.a.instance.fb(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
na),ia=!1);ia||(ja.QN=2===ya?Ba:Ma);return ia}hfe(ja){const na=ja.input,Ba=na.Jea,Ma=na.R3a,Ea=na.Ooa,{aMg:ya,gTg:ia,RKa:za}=this.jOf(ja,Ba,Ma,na.GUb);if(!za)return w.a.instance.fb(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",ya.id,ia.id),ja.logger.mj(Object.assign(new S.a,{Dk:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.yfj(ya,Ba.length,"TheirChanges"),this.yfj(ia,Ma.length,"YourChanges"),
ja.output.QN=2===Ea?Ba:Ma,!1;ja.runtime.RKa=za;const {fAp:Ca,tbm:db}=this.oZl(Ea,ya,ia),{gAp:pa,ubm:ua,Hil:Ga}=this.WGm(ja,Ca,db,za);ja.runtime.Ao=Ga;ja.runtime.Pw=pa;ja.runtime.BC=ua;ja.runtime.ks=new y.a;ja.runtime.X5d=db.id;ja.runtime.XHe=Ca.id;ja.runtime.byb=new y.a;ja.runtime.jWa=new v.a;ja.runtime.fzf=new y.a;ja.runtime.UDl=new y.a;ja.runtime.cpp=new y.a;ja.runtime.Nwe=new ka;ja.runtime.hne=new u.a;ja.runtime.Omg=new v.a;ja.runtime.cBc=new u.a;ja.runtime.Dc=ja.input.f3c(ja);ja.runtime.Dc.KUd(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.frp);ja.runtime.Dc.KUd(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.mtp);ja.runtime.Dc.KUd(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",f.a.abm);ja.runtime.Dc.KUd(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.mGo);ja.runtime.bXi=!0;H.AFrameworkApplication.J&&(this.Dwh=
H.AFrameworkApplication.J.sc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}yfj(ja,na,Ba){const Ma=new u.a;for(;ja;)Ma.add(ja),ja=ja.rL;const Ea=new Sys.StringBuilder;Ea.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ba,na,Ma.length));let ya=Ma.length,ia=0;Ma.forEach(za=>({NUi:ya,Zfj:ia}=this.U4k(Ea,za,Ma,ya,ia)).returnValue);w.a.instance.fb(4273302,1,4,Ea.toString())}U4k(ja,na,Ba,Ma,Ea){ja.append(String.format(" [{0} {1} {2}]",Ma,na.Nva?"S":"B",na.id));Ma--;
Ea++;return 50<Ea&&Ba.length!==Ea?(ja.append(" ...Truncated."),{returnValue:!1,NUi:Ma,Zfj:Ea}):{returnValue:!0,NUi:Ma,Zfj:Ea}}jOf(ja,na,Ba,Ma){na=na.Lg(na.length-1-(Ma?1:0));Ba=Ba.Lg(Ba.length-1);Ma=na.XXa(Ba);ja.runtime.IK("GetCommonBase");ja.logger.Fdb("GetCommonBase");return{aMg:na,gTg:Ba,RKa:Ma}}WGm(ja,na,Ba,Ma){let Ea,ya;({result:Ea}=na.nYb(Ma));ja.runtime.IK("GetUnfavoredChanges");ja.logger.Fdb("GetUnfavoredChanges");({result:ya}=Ba.nYb(Ma));5===ja.input.source&&(ja.runtime.xbm=P.a.JKi(Ba),
ja.runtime.iAp=P.a.JKi(na));ja.runtime.IK("GetFavoredChanges");ja.logger.Fdb("GetFavoredChanges");na=new D.a(Object(F.a)(Ma,Ma.LMa,"getMergeableObject"));ja.runtime.IK("GetModifiedObjects");ja.logger.Fdb("GetModifiedObjects");return{gAp:Ea,ubm:ya,Hil:na}}oZl(ja,na,Ba){2===ja?(ja=na,na=Ba):ja=Ba;return{fAp:na,tbm:ja}}xen(ja){const na=ja.input,Ba=na.Jea,Ma=na.R3a;ja.output.QN=(2===na.Ooa?Ba:Ma).pQa();ja.runtime.IK("InitializeOutputMergeState");ja.logger.Fdb("InitializeOutputMergeState");return!0}b3k(ja){var na=
ja.input.Wl;const Ba=ja.runtime.ks,Ma=ja.output.QN;na=this.UNl(ja,Ma.Lg(Ma.length-1),na,E.a.create());this.Vcm(ja,na,Ba);Ma.add(na);return ja.output.succeeded=!0}UNl(ja,na,Ba,Ma){ja.runtime.NCe&&w.a.instance.fb(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ba,Ma);ja=this.sQo(Ma);ja.Y_h(na,Ba);return ja}Vcm(ja,na,Ba){ja.runtime.NCe&&w.a.instance.fb(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Ba.count);Ba.forEach((Ma,
Ea)=>{na.Tec(Ea.rn);return!0})}lyp(ja){return this.Q9j(ja,!1)}ydm(ja){return this.Q9j(ja,!0)}Q9j(ja,na){const Ba=ja.runtime,Ma=Ba.Ao,Ea=Ba.BC,ya=na?Ba.fzf:Ba.Pw,ia=Ba.ks;let za=!0;const Ca=ja.runtime.Bsd;let db=0,pa=0,ua=0;ya.forEach((Ga,wa)=>{Ca&&w.a.instance.fb(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Ga,wa.yc,na);pa++;this.Dwh===pa&&(db++,ja.runtime.IK(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",db,ua,na)),pa=0);if(ja.runtime.Dc&&
ja.runtime.Dc.TTb(1000005)&&ja.runtime.cBc.contains(wa.id,(Ka,Na)=>Ka.equals(Na))||this.qhp(wa.yc))return!0;if(!na&&this.OVl(wa.yc,ja.runtime.Dc))return Ba.fzf.W(Ga,wa),!0;var xa=Ea.get(Ga);if(!xa)return ia.Bb(Ga)?ia.K(Ga).tjj(wa):ia.W(Ga,new X.a(wa,!1)),!0;if(!Ma.K(Ga)&&!this.dUn(xa.yc)){var sa=!!ja.input.Jea&&!!ja.input.Jea.last()&&ja.input.Jea.last().p5(Ga);const Ka=!!ja.input.R3a&&!!ja.input.R3a.last()&&ja.input.R3a.last().p5(Ga),Na=new ca.a(xa,wa);if(!Na.j5)return ia.W(Ga,new X.a(xa,!1)),!0;
w.a.instance.fb(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Ga,wa.yc,na,sa,Ka,!Na.j5,ja.input.source);ja.logger.mj(Object.assign(new S.a,{Dk:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return za=!1}sa=ia.R4(Ga,new X.a(Ma.K(Ga)));({Fm:xa,returnValue:za}=this.OZm.merge(ja,this.AQi,this.xf,sa,xa,wa));ua++;za&&(ja.runtime.IK(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",
Ga,wa.yc,ua,db,na)),xa&&(ia.Bb(xa.rn.id)?ia.K(xa.rn.id).tjj(xa.rn):ia.W(xa.rn.id,xa)));return za});ja.logger.Fdb("ObjectMerge");Ca&&w.a.instance.fb(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ya.count,ua,na);return za}RLp(ja){try{for(let na=0;na<ja.runtime.hne.length;na++){const Ba=ja.runtime.hne.K(na);if(ja.runtime.ks.K(Ba)){if(!this.kun(ja,Ba))return!1}else w.a.instance.fb(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ja.runtime.IK("Validate markers taking too long")}}catch(na){w.a.instance.fb(559535579,
1,2,"ValidateMerge threw an exception: {0}",na)}return ja.logger.Xfd.DSi()?!1:!0}Tbp(ja){return 38===ja||39===ja||40===ja||41===ja||44===ja||45===ja||33===ja||34===ja?!1:!0}jGm(ja){switch(ja){case 38:case 39:case 40:case 41:return a.a.Fe;case 44:case 45:return a.a.bXd;case 33:case 34:return a.a.Lk}return G.CommonProperties.nil}QLp(ja,na){const Ba=this.xf.getPropertyUint32(ja,a.a.gu);if(!Ba||this.Tbp(Ba))return!0;ja=this.xf.getPropertyObjectId(ja,this.jGm(Ba));return ma.qmc(na,ja)?!0:(na.logger.Xfd.Vfe=
Ba,!1)}kun(ja,na){if(ja.runtime.Omg.contains(na))return!1;if(na=ma.qmc(ja,na)){na=this.xf.getPropertyObjectIds(na,l.a.Qq);for(let Ba=0;Ba<na.length;Ba++){const Ma=ma.qmc(ja,na.Lg(Ba));if(Ma&&!this.QLp(Ma,ja))return!1}}return!0}qhp(ja){switch(ja){case m.a.mKa:case m.a.Bfc:case m.a.ZMb:case m.a.xfc:case m.a.UGa:case m.a.tqa:return!0}return!1}OVl(ja,na){let Ba=!1;if(ja===m.a.je)return!0;na&&na.bJ(116);na&&na.isFeatureEnabled(116)&&ja===m.a.ipb&&(Ba=!0);return Ba}dUn(ja){switch(ja){case m.a.kCc:return!0}return!1}oQl(ja,
na){const Ba=new u.a,Ma=new u.a,Ea=new u.a;var ya=ja.runtime.RKa;const ia=ya?ya.id:E.a.nil;this.Y7f(ya).forEach(za=>{Ba.add(na(za));return!0});ya=ja.input.Jea.Lg(ja.input.Jea.length-1);this.Y7f(ya,ia).forEach(za=>{Ma.add(na(za));return!0});ja=ja.input.R3a.Lg(ja.input.R3a.length-1);this.Y7f(ja,ia).forEach(za=>{Ea.add(na(za));return!0});return{Gil:Ba,Mrp:Ma,FSp:Ea}}Y7f(ja,na=null){const Ba=new u.a;na||(na=E.a.nil);for(;ja&&!na.equals(ja.id);)Ba.add(ja),ja=ja.rL;Ba.reverse();return Ba}Enp(ja){const na=
3===this.zce;let Ba=!1;!ja.output.succeeded&&(2===this.zce||ja.output.dCa&&1===this.zce)&&(Ba=!0);let Ma=!1;ja.input.Jea&&0<ja.input.Jea.length&&(na||Ba)&&ja.runtime.BC&&ja.runtime.Ao&&ja.runtime.Dc&&(Ma=ja.runtime.Dc.isFeatureEnabled(45));return Ma}r_i(ja){return 9===T.a.Stb(T.a.IIf(ja))}e5i(ja){return 8===T.a.Stb(T.a.IIf(ja))}static SAm(ja){return ja.output.dCa?2:ja.output.succeeded?3:1}static qmc(ja,na){if(!na||na===E.a.nil)return null;const Ba=ja.runtime.ks.K(na);return Ba?Ba.rn:ja.runtime.Ao.K(na)}}
ma.xce=E.a.Of("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(I.a)(ma,"GraphMergerBase",null,[836])},1792:function(I,K,e){I=e(0);var m=e(76),f=e(1394),a=e(1595),l=e(1477),w=e(1422),z=e(1497),x=e(1396),u=e(1398),v=e(1400),E=e(1389),y=e(1390);class H{constructor(Z){this.$c=Z;this.RQd=this.zRf()}iP(){return"Add-ins"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:3}WL(Z,ca){Z=new v.a(Z);ca.mv(Z)}lub(Z,ca,W){let X;X=this.$c.vU?new u.a(29):new u.a(27);X.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;
W&&this.Tfp(Z.sh,ca,X)}Tfp(Z,ca,W){const X=[];let ka;ka=this.$c.pln?this.$c.vU&&this.$c.Tob?y.a.Wsb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Z):this.$c.qln?this.$c.vU&&this.$c.Tob?y.a.Wsb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Z):this.$c.vU&&this.$c.Tob?y.a.Wsb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Z);this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ka)),E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z))):(X.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ka)),X.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z)),appChrome.api.dispatch(X));
W.aA(new x.a("LaunchAddinDialogFromTellMe",29));ca.Jx(W)}zRf(){const Z=[];this.$c.uge&&Array.add(Z,"Addin");return Z}}Object(I.a)(H,"AddinStoreResultsProvider",null,[845]);var D=e(1744),G=e(1479),J=e(1745),U=e(1780),F=e(1746),T=e(1496),Y=e(2),P=e(29),S=e(127),N=e(1478);e.d(K,"a",function(){return V});class V{constructor(Z,ca,W){this.rnb=this.CSc=this.DSc=this.WPd=!1;this.eV=null;this.f7=-1;this.A7a=this.xTc=this.Dla=this.mLb=null;this.Sxh=this.ayh=0;this.$c=Z;const X=y.a.Mva();this.skb=ca||[];this.$f=
Y.AFrameworkApplication.pe;this.uKh=Z.zlg;this.ESc=Z.ylg;this.UPd=X&&this.Y2b();this.VPd=X&&this.Z2b();this.wKh=X&&this.$2b();this.YPd=this.a3b();this.Maf=this.AAc();if((ca=Z.JJg&&y.a.vFg(Z))||Z.ana)this.mLb=new U.a(Z),this.WPd=Z.Cud;ca&&(this.DSc=Z.Eud,this.CSc=Z.Cwb,this.rnb=this.WPd&&this.oA("File")||this.DSc&&this.oA("People")||this.CSc&&this.oA("Notes"));this.TPd=this.qbp();this.GSc=Z.ljd;this.XPd=this.Kbp();this.Laf=this.pbp();this.Rcc=this.GCe();this.Yea=this.zUm();this.Ldh=new D.a(Z);this.jFk=
new J.a(Z);this.jWk=new F.a(Z);this.Ssk=new H(Z);this.tRc=W;this.DKb=new a.a;this.GSc&&(this.Ldh=new D.a(Z));Z.ana&&(this.Laf=this.XPd=this.GSc=this.rnb=this.CSc=this.DSc=this.Maf=this.YPd=this.wKh=this.VPd=this.UPd=this.ESc=!1,Y.AFrameworkApplication.J&&this.oA("File")&&this.tZj()||this.Rcc)&&(Z=this.DKb.qSf("Search",Y.AFrameworkApplication.J.rb("TellMeServiceAuthEndpointForSearch")),this.h3c(Z,"TellMeService",!0),Z=this.DKb.qSf("SmartLookup",Y.AFrameworkApplication.J.rb("SmartLookupShredderServiceEndpoint")),
this.h3c(Z,"Shredder",!1));Y.AFrameworkApplication.J&&this.rnb&&this.oA("File")&&this.tZj()&&(Z=this.DKb.qSf("Search",Y.AFrameworkApplication.J.rb("TellMeServiceAuthEndpointForSearch")),this.h3c(Z,"TellMeService",!0))}oA(Z){return Array.contains(this.skb,Z)?!0:!1}iP(){return"TellMeService"}eZ(){return 0===this.$c.Px?0:1===this.$c.Px?1:this.oA("Command")||this.oA("Recommended")?2:3}wUm(Z){let ca="";if(!Z&&this.oA("Command")&&this.$c.P2f){ca+="CommandSearch_DLIS,";var W=this.$c.J5j;0<W.length&&(ca+=
W+",")}Z&&this.oA("Recommended")&&this.ESc&&(W=this.FYm(),0<W.length&&(ca+=W+","));!Z&&this.oA("Help")&&(Z=this.$c.I5j,0<Z.length&&(ca+=Z+","));this.$c.ana&&this.A7a&&0<this.A7a.length&&(ca+="IsRecallEnabled_true,");(this.$c.Yjc||this.$c.y4d||this.$c.ana)&&this.rnb&&(ca+="IsGenerateSlidesEnabled_true,");0<ca.length&&(ca=ca.substr(0,ca.length-1));return ca}h3c(Z,ca,W){const X=W?this.ayh:this.Sxh;if(!X||window.performance.now()-X>=y.a.zhb)if(Z)W?this.ayh=window.performance.now():this.Sxh=window.performance.now(),
Z.then(ka=>{W?this.xTc=ka:(this.A7a=ka,E.TellMeActorConstants.instance.atd=ka)},ka=>{E.TellMeActorConstants.instance.gk().onError("TellMeServiceProvider:FetchTokenForService_"+ca,"tellMeServiceToken promise rejected: "+ka)});else if(E.TellMeActorConstants.instance.gk())E.TellMeActorConstants.instance.gk().onError("TellMeServiceProvider:FetchTokenForService_"+ca,"undefined token promise")}WL(Z,ca,W,X=f.a.Pv,ka=null){const ma=new v.a(Z);W=y.a.UT(Z);this.oA("File")&&(this.rnb||this.$c.ana)&&this.h3c(this.DKb.AUm(),
"TellMeService",!0);(this.oA("File")&&this.$c.ana||this.oA("ActionAI")&&this.Rcc)&&this.h3c(this.DKb.zRm(),"Shredder",!1);var ja=this.rnb&&!!this.xTc;const na=this.$c.ana&&!!this.A7a;var Ba=ja||na||W&&this.oA("Recommended")&&this.ESc;ja=ja||na||!W&&(this.uKh&&this.oA("Command")||this.UPd&&this.oA("Answer")||this.VPd&&this.oA("Definition")||this.Maf&&this.oA("Image")||this.GSc&&this.oA("Help")||this.YPd&&this.oA("WolframAnswer")||this.XPd&&this.oA("Template")||this.Laf&&this.oA("Addin"));if(Ba||ja)if(this.Dla=
X,X={"Content-Type":"application/json",Accept:"application/json"},X["X-Office-Version"]=Y.AFrameworkApplication.buildVersion,X["X-Office-Application"]=Y.AFrameworkApplication.J.rb("Application"),X["X-Office-Platform"]="WAC",X["X-TellMe-SqmUserId"]=Y.AFrameworkApplication.J.rb("LoggableUserId")||"",X["X-TellMe-SessionId"]=E.TellMeActorConstants.instance.Dnc(),this.xTc&&(X.Authorization="Bearer "+this.xTc),this.A7a&&0<this.A7a.length&&(X["X-TellMe-ShredderToken"]="Bearer "+this.A7a),Ba=this.wUm(W),
0<Ba.length&&(X["X-TellMe-Flights"]=Ba),Ba=[],!W&&this.oA("Answer")&&this.UPd&&(ka?Array.contains(ka,9):1)&&Array.add(Ba,"Answer"),!W&&this.oA("Command")&&this.uKh&&!N.CommandResultsUtilityHelper.Mad(Z.sh)&&(ka?Array.contains(ka,17):1)&&Array.add(Ba,"Command"),!W&&this.oA("Definition")&&this.VPd&&(ka?Array.contains(ka,10):1)&&Array.add(Ba,"Definition"),!W&&this.oA("Help")&&this.GSc&&(ka?Array.contains(ka,8):1)&&Array.add(Ba,"Help"),!W&&this.oA("WolframAnswer")&&this.YPd&&(ka?Array.contains(ka,12):
1)&&Array.add(Ba,"WolframAnswer"),W&&this.oA("Recommended")&&this.ESc&&!E.TellMeActorConstants.instance.hib&&(ka?Array.contains(ka,18):1)&&Array.add(Ba,"Recommended"),!W&&this.oA("Image")&&this.Maf&&(ka?Array.contains(ka,19):1)&&Array.add(Ba,"Image"),this.xTc&&this.rnb&&(ka?Array.contains(ka,14)||Array.contains(ka,15)||Array.contains(ka,20):1)&&(this.mLb.SFa(),this.WPd&&this.oA("File")&&Array.add(Ba,"File"),this.DSc&&this.oA("People")&&Array.add(Ba,"People"),this.CSc&&this.oA("Notes")&&Array.add(Ba,
"Notes")),this.A7a&&0<this.A7a.length&&this.$c.ana&&(ka?Array.contains(ka,15):1)&&(this.mLb.SFa(),this.oA("File")&&Array.add(Ba,"File")),!W&&this.oA("Template")&&this.XPd&&(ka?Array.contains(ka,23):1)&&Array.add(Ba,"Template"),!W&&this.oA("Addin")&&this.Laf&&(ka?Array.contains(ka,27):1)&&Array.add(Ba,"Addin"),!W&&this.oA("ActionAI")&&this.Rcc&&(ka?Array.contains(ka,25):1)&&Array.add(Ba,"ActionAI"),Ba.length){X["X-TellMe-SuggestionTypes"]=Ba.join(",");X["X-TellMe-Culture"]=Y.AFrameworkApplication.uiCulture;
X["X-TellMe-ProcessSessionId"]=Y.AFrameworkApplication.userSessionId;var Ma=this.eV=S.a.create().toString();X["Client-Request-Id"]=Ma;var Ea=window.performance.now();this.LKa();this.f7=window.setTimeout(()=>{if(Ma===this.eV){this.eV="";this.f7=-1;ca.mv(ma);const ya={};ya[l.a.provider]=this.iP();ya[l.a.R_b]=Z.wzb;E.TellMeActorConstants.instance.gk().hE(w.a.timedOut,this.tRc,ya)}},this.tRc);this.$f.addRequest(this.Yea,2,this.yUm(Z.sh),X,!1,0,ya=>{this.xZb(ya,Z,ca,Ma,Ea,ka)},ya=>{this.lZb(ya,Z,ca,Ma,
Ea)},null,null,!1,4E3,this.Rcc?3E4:6E3)}else E.TellMeActorConstants.instance.gk().onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ca.mv(ma);else ca.mv(ma)}LKa(){-1!==this.f7&&(window.clearTimeout(this.f7),this.f7=-1)}xZb(Z,ca,W,X,ka,ma){const ja=new v.a(ca);if(X===this.eV){this.LKa();E.TellMeActorConstants.instance.gk().U9(ca.sh.length,this.skb.join(","),Z.data.Xe.toString(),Math.round(window.performance.now()-ka),T.a.Pv,!0,z.a.VYa);X=Z.data.responseData;Z=null;try{Z=
P.b(X)}catch(ia){E.TellMeActorConstants.instance.gk().onError("OnSuccessCallBack","Exception occured while deserializing response:"+ia);return}X=y.a.UT(ca);if("Groups"in Z&&Z.Groups){var na=Z.Groups;for(var Ba of na)if("GroupType"in Ba&&"Suggestions"in Ba&&Ba.Suggestions)if("Commands"===Ba.GroupType&&(ma?Array.contains(ma,17):1)||"Recommended"===Ba.GroupType&&(ma?Array.contains(ma,18):1)){var Ma=(na="Recommended"===Ba.GroupType)?"DLIS":"NaiveBayes";"Source"in Ba&&Ba.Source&&(Ma=Ba.Source);var Ea=
Ba.Suggestions;new m.a;var ya=[];for(const ia of Ea)this.wBn(ia)&&(Ea=ia.Type,("Command"===Ea||na&&"Recommended"===Ea)&&ya.push(new G.a(ia.CommandId,ia.Score)));N.CommandResultsUtilityHelper.Atc(ya,!ca.sh.trim().length,Ba.GroupType,Ma);Ma=E.TellMeActorConstants.instance.GOf();Ea=[];for(const ia of ya)na&&Ma&&Ma.N_d(ia.commandId)||Ea.push(ia);ya=N.CommandResultsUtilityHelper.tTb(ca,Ea,this.$c,null,null,null,na?18:17,0);0<ya.results.length&&(this.Dla!==f.a.contextMenu&&(ya.displayName=na?CommonUIStrings.l_TellMeTryCommandTitle:
CommonUIStrings.l_TellMeCommandProviderTitle),ja.Jx(ya))}else if("Answer"===Ba.GroupType){Ea=Ba.Suggestions;na=null;ya=2147483647;Ma="";for(const ia of Ea)if(this.vBn(ia))if(Ma=ia.Type,Ea=this.lNm(Ma),"Answer"===Ma&&this.UPd){na=this.Gfi(Ma,ia,ca.sh);break}else Ea&&Ea<ya&&(ya=Ea,na=this.Gfi(Ma,ia,ca.sh));ya=y.a.uPo(ca.sh,Ma);na&&(ma?Array.contains(ma,na.type):1)&&(Ma=[],this.TPd?this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(na.value,na.wG)),E.TellMeActorConstants.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(na.value,
na.description)),E.TellMeActorConstants.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(na.value,ya))):(Ma.push(appChrome.actions.setControlLabel(na.value,na.wG)),Ma.push(appChrome.actions.updateCompoundButtonDescription(na.value,na.description)),Ma.push(appChrome.actions.setCompoundButtonCommandValueId(na.value,ya)),appChrome.api.dispatch(Ma)):this.$c.zDa?(E.TellMeActorConstants.instance.actions.push(appChrome.actions.setControlLabel(na.value,na.wG+" - "+na.description)),
E.TellMeActorConstants.instance.actions.push(appChrome.actions.setButtonCommandValueId(na.value,ya))):(Ma.push(appChrome.actions.setControlLabel(na.value,na.wG+" - "+na.description)),Ma.push(appChrome.actions.setButtonCommandValueId(na.value,ya)),appChrome.api.dispatch(Ma)),ya=this.xQl(na.type),ya.aA(na),ja.Jx(ya))}else"Help"===Ba.GroupType&&Ba.Suggestions.length&&(ma?Array.contains(ma,8):1)?this.GSc&&(na=this.Ldh.lub(ca,Ba.Suggestions))&&0<na.results.length&&ja.Jx(na):"Template"===Ba.GroupType&&
(ma?Array.contains(ma,23):1)?(na=Ba.Suggestions)&&0<na.length&&this.jWk.lub(ca,ja,na):"Addin"===Ba.GroupType&&(ma?Array.contains(ma,27):1)?(na=Ba.Suggestions)&&0<na.length&&this.Ssk.lub(ca,ja,na):"ActionAI"===Ba.GroupType&&(ma?Array.contains(ma,25):1)?(ya=Ba.Suggestions,na=[],new u.a(25),ya&&1===ya.length&&(Ma=ya[0])&&Ma.CommandId&&(ya=Ma.CommandId,na.push(new G.a(ya,"Score"in Ma?Ma.Score:0)),na=N.CommandResultsUtilityHelper.tTb(ca,na,this.$c,null,null,null,25,0),na.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,
ja.Jx(na))):"Substrate"===Ba.GroupType&&this.rnb&&"Type"in Ba?"File"===Ba.Type&&this.WPd&&(ma?Array.contains(ma,15):1)?(na=this.mLb.PMf(Ba.Suggestions,X,this.Dla))&&0<na.results.length&&(this.Jhe()&&(ya=new x.a("GenerateSlidesFromTellMe",30,"",null,1),na.aA(ya)),ja.Jx(na)):"People"===Ba.Type&&this.DSc&&(ma?Array.contains(ma,14):1)?(na=this.mLb.nJi(Ba.Suggestions,X,this.Dla))&&0<na.results.length&&ja.Jx(na):"Notes"===Ba.Type&&this.CSc&&(ma?Array.contains(ma,14):1)&&(na=this.mLb.$Hi(Ba.Suggestions,
X,ca))&&0<na.results.length&&ja.Jx(na):"Recall"===Ba.GroupType&&this.$c.ana&&"Type"in Ba&&"IntentService"===Ba.Type&&(ma?Array.contains(ma,15):1)&&(na=this.mLb.PMf(Ba.Suggestions,X,this.Dla))&&0<na.results.length&&(this.Jhe()&&(ya=new x.a("GenerateSlidesFromTellMe",30,"",null,1),na.aA(ya)),ja.Jx(na));else E.TellMeActorConstants.instance.gk().onError("OnSuccessCallBack","GroupType"in Ba?"Invalid group suggestions found for "+Ba.GroupType:"Invalid group found")}if(Z.Intents){Ba=Z.Intents;for(const ia of Ba)this.t5f(ia)&&
("Image"===ia.GroupType&&ia.ConfidenceScore>ia.ConfidenceThreshold&&(ma?Array.contains(ma,19):1)?this.jFk.lub(ca,ja,0,ia):"Commands"===ia.GroupType&&ia.ConfidenceScore<ia.ConfidenceThreshold&&(ma?Array.contains(ma,17):1)&&(Ba=new u.a(17),ja.Jx(Ba)))}W.mv(ja);E.TellMeActorConstants.instance.gk().U9(ca.sh.length,this.skb.join(","),"",Math.round(window.performance.now()-ka),"",!0,z.a.provider)}}lZb(Z,ca,W,X,ka){const ma=new v.a(ca);X===this.eV&&(this.LKa(),E.TellMeActorConstants.instance.gk().U9(ca.sh.length,
this.skb.join(","),Z.data.Xe.toString(),Math.round(window.performance.now()-ka),T.a.Pv,!1,z.a.VYa));W.mv(ma)}lNm(Z){switch(Z){case "Entity":return this.wKh?3:0;case "Definition":return this.VPd?5:0;case "WolframAnswer":return this.YPd?2:0;default:return 0}}Gfi(Z,ca,W){switch(Z){case "Answer":return new x.a(this.TPd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ca.Title?W:ca.Title,ca.Description,0);case "Entity":return new x.a(this.TPd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ca.Title?
W:ca.Title,ca.Description,0);case "Definition":return new x.a(this.TPd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ca.Title?W:ca.Title,ca.Description,0);case "WolframAnswer":return new x.a("WolframForSearch",3,""===ca.Title?W:ca.Title,ca.Description,0);default:return null}}xQl(Z){switch(Z){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,
CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.$c.tAc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}vBn(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"Description"in Z&&!!Z.Description&&""!==Z.Description}wBn(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"CommandId"in Z&&!!Z.CommandId&&""!==Z.CommandId&&"Score"in Z&&!!Z.Score}t5f(Z){if("GroupType"in Z&&Z.GroupType&&"ConfidenceScore"in Z&&"ConfidenceThreshold"in Z)return!0;E.TellMeActorConstants.instance.gk().onError("IsValidIntentGroup",
"Invalid intents found");return!1}yUm(Z){const ca=y.a.L7i(Z),W={};W.Query=Z;ca&&this.ESc&&(this.Tun()?W.UserActionEvents=E.TellMeActorConstants.instance.ISf():(W.CommandClickedEvents=E.TellMeActorConstants.instance.O8d(),W.CommandActionEvents=E.TellMeActorConstants.instance.cLf()),W.TellMeCommandClickMruEvents=E.TellMeActorConstants.instance.VKf(),W.ContentType=E.TellMeActorConstants.instance.a0c);this.XPd&&(Z={},Z.Application=this.$c.application,W.TemplateInfo=Z);return P.c(W)}Y2b(){return!!this.$c&&
this.$c.Y2b||!!Y.AFrameworkApplication.ta&&Y.AFrameworkApplication.ta.Pb.Y2b}Z2b(){return!!this.$c&&this.$c.Z2b||!!Y.AFrameworkApplication.ta&&Y.AFrameworkApplication.ta.Pb.Z2b}$2b(){return!!this.$c&&this.$c.$2b||!!Y.AFrameworkApplication.ta&&Y.AFrameworkApplication.ta.Pb.$2b}a3b(){return!!this.$c&&this.$c.a3b||!!Y.AFrameworkApplication.ta&&Y.AFrameworkApplication.ta.Pb.a3b}AAc(){return!!this.$c&&(this.$c.AAc||this.$c.vU)}qbp(){return!!this.$c&&!this.$c.edb}Kbp(){return!!this.$c&&this.$c.mdd}pbp(){return!!this.$c&&
this.$c.rln&&this.$c.oln}GCe(){return!!this.$c&&this.$c.GCe}w8i(){return!!Y.AFrameworkApplication.J&&Y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}x8i(){return!!Y.AFrameworkApplication.J&&Y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Tun(){return!!Y.AFrameworkApplication.J&&Y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",
!1)}Jhe(){return!!Y.AFrameworkApplication.J&&Y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}tZj(){return!!Y.AFrameworkApplication.J&&Y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}FYm(){return Y.AFrameworkApplication.J?Y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}zUm(){if(!Y.AFrameworkApplication.J)return"";
if(this.x8i())return Y.AFrameworkApplication.J.rb("TellMeServiceProdEndpointForSearch");if(this.w8i())return Y.AFrameworkApplication.J.rb("TellMeServiceEdogEndpointForSearch");if(y.a.L0f())return Y.AFrameworkApplication.J.rb("TellMeServiceIntEndpointForSearch");let Z=Y.AFrameworkApplication.J.rb("TellMeServiceSearchEndpoint");Z&&""!==Z||(Z=Y.AFrameworkApplication.H5j);return Z}static jgi(Z,ca){if(ca)return new V(Z,["Command","Recommended"],Z.zym);ca=y.a.Mva()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):
"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new V(Z,ca,Z.hMi)}}Object(I.a)(V,"TellMeServiceProvider",null,[845])},1794:function(I,K,e){I=e(0);var m=e(231),f=e(1601),a=e(190),l=e(1476);class w extends f.a{constructor(x,u,v,E,y,H,D,G,J,U,F,T,Y,P){super(x,3,u,v,E,y,H,G,J,U,F,T,Y,P);this.PPe=D}get character(){return this.PPe}get text(){return this.character.toString()}bsd(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Mlc(){return"CharRun"}clone(){return new w(this.JVc,
this.source,this.$k,this.Eg,this.runId,this.mN,this.character,this.Xxb,this.VZa,this.Bha,this.XMa,this.a1a,this.$B,this.gx)}aE(x,u,v,E=!1){return super.aE(x,u,v,E)?x.character===this.character?!0:l.a.iZh(x.character,this.character):!1}}Object(I.a)(w,"CharRunMergeBlock",f.a,[]);e.d(K,"a",function(){return z});class z extends f.a{constructor(x,u,v,E,y,H,D,G,J,U,F,T,Y,P,S){super(x,1,u,v,E,y,H,G,U,F,T,Y,P,S);this._text=D;this.vcf=J}get text(){return this._text}bsd(x){this._text=x}get jhb(){return this.vcf&&
this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.vcf)}Mlc(){return"TextRun"}clone(){return new z(this.JVc,this.source,this.$k,this.Eg,this.runId,this.mN,this._text,this.Xxb,this.vcf,this.VZa,this.Bha,this.XMa,this.a1a,this.$B,this.gx)}aE(x,u,v,E=!1){return super.aE(x,u,v,E)?l.a.hZh(this._text,x._text):!1}wtd(){const x=new m.a;for(let v=0;v<this.text.length;v++){var u=l.a.charAt(this._text,v);if(l.a.dAn(l.a.$sp(u))){let E="";E+=u;
u=l.a.charAt(this._text,++v);E+=u;u=new z(this.JVc,this.source,this.$k,this.Eg,this.runId,this.mN,E,this.Xxb,!1,this.VZa,this.Bha,this.XMa,this.a1a,this.$B,this.gx);x.add(u)}else u=new w(this.JVc,this.source,this.$k,this.Eg,this.runId,this.mN,u,this.Xxb,this.VZa,this.Bha,this.XMa,this.a1a,this.$B,this.gx),x.add(u)}return x}}Object(I.a)(z,"TextRunMergeBlock",f.a,[])},1795:function(I,K,e){I=e(0);var m=e(277),f=e(33),a=e(13),l=e(5),w=e(114),z=e(824),x=e(185),u=e(231),v=e(373),E=e(1383);class y{constructor(G,
J,U){this.position=G;this.leader=J;this.val=U}equals(G){return this.position===G.position&&this.leader===G.leader&&this.val===G.val}toString(){return this.position.toString()}}Object(I.a)(y,"TabStop",null,[]);var H=e(1924);e.d(K,"a",function(){return D});class D extends E.a{constructor(){super();this.iSd=null}Ikf(G){if(null==G)return!1;G.bJ(4);return G.isFeatureEnabled(4)}get Lp(){return 20}get Pup(){return this.iSd?this.iSd:this.iSd=new Set([z.a.Db(f.a.lZa),z.a.Db(f.a.VWa),z.a.Db(f.a.h3a)])}get MD(){return 0}Vl(){const G=
super.Vl();G.W(z.a.Db(a.a.so),1);G.W(z.a.Db(a.a.Qq),1);G.W(z.a.Db(a.a.sw),1);G.W(z.a.Db(l.a.A2),1);G.W(z.a.Db(l.a.qU),1);G.W(z.a.Db(l.a.qd),1);G.W(z.a.Db(a.a.ABb),1);G.W(z.a.Db(l.a.DYa),1);G.W(z.a.Db(l.a.zPa),1);G.W(z.a.Db(a.a.PEa),1);G.W(z.a.Db(l.a.wNa),1);G.W(z.a.Db(l.a.Qma),1);G.W(z.a.Db(l.a.xNa),1);G.W(z.a.Db(l.a.DLa),1);G.W(z.a.Db(l.a.yNa),1);G.W(z.a.Db(l.a.ELa),1);G.W(z.a.Db(l.a.yPa),1);G.W(z.a.Db(l.a.bRa),1);G.W(z.a.Db(l.a.cRa),1);G.W(z.a.Db(l.a.MGa),1);G.W(z.a.Db(l.a.vy),1);G.W(z.a.Db(f.a.lZa),
1);G.W(z.a.Db(f.a.VWa),1);G.W(z.a.Db(f.a.h3a),1);G.W(z.a.Db(l.a.jE),1);G.W(z.a.Db(l.a.kE),1);G.W(z.a.Db(l.a.tA),1);G.W(z.a.Db(l.a.a2),1);G.W(z.a.Db(w.a.DQ),1);G.W(z.a.Db(w.a.Zia),6);G.W(z.a.Db(w.a.YL),6);G.W(z.a.Db(w.a.K3a),6);G.W(z.a.Db(l.a.uOb),7);G.W(z.a.Db(w.a.YL),6);G.W(z.a.Db(l.a.R0j),2);G.W(z.a.Db(w.a.KFl),2);G.W(z.a.Db(w.a.Gfo),2);G.W(z.a.Db(l.a.fDc),2);G.W(z.a.Db(l.a.xvd),2);G.W(z.a.Db(l.a.y4b),2);G.W(z.a.Db(l.a.Fhb),2);G.W(z.a.Db(l.a.yvd),2);G.W(z.a.Db(l.a.zvd),2);G.W(z.a.Db(l.a.vle),2);
G.W(z.a.Db(l.a.listID),3);G.W(z.a.Db(l.a.listLevel),3);return G}HF(G,J){var U=G.kv.runtime.Dc,F=U.isFeatureEnabled(110);if(J===z.a.Db(a.a.so)||J===z.a.Db(a.a.Qq)||J===z.a.Db(a.a.sw)||J===z.a.Db(l.a.A2)||J===z.a.Db(l.a.qU)||J===z.a.Db(l.a.qd)||J===z.a.Db(a.a.ABb)||J===z.a.Db(l.a.DYa)||J===z.a.Db(l.a.zPa)||J===z.a.Db(a.a.PEa)||J===z.a.Db(l.a.wNa)||J===z.a.Db(l.a.Qma)||J===z.a.Db(l.a.xNa)||J===z.a.Db(l.a.DLa)||J===z.a.Db(l.a.yNa)||J===z.a.Db(l.a.ELa)||J===z.a.Db(l.a.yPa)||J===z.a.Db(l.a.bRa)||J===z.a.Db(l.a.cRa)||
J===z.a.Db(l.a.MGa)||J===z.a.Db(l.a.vy)||J===z.a.Db(l.a.XR)||this.WTn(J,F)){var T=G.np.value.yx;F=G.np.value.Xf;J=G.Ah.value.Xf;if(G.kv.runtime.jWa.contains(T.id))return x.a.instance.fb(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",T.id),!0;if(U.TTb(1000005)&&this.yhp(G,J,F))return G.Fm=J.KQ(),D.WSh(G),D.MUd(G.kv,G.xf,F),!0;U=new u.a;U.add(T);T=new u.a;T.add(F);F=new u.a;F.add(J);if(!({ks:J}=D.U9j(G.kv,U,F,T)).returnValue)return G.hSg=
!0,G.Fm=null,!1;D.WSh(G);G.Fm=J.Lg(0).rn;return!0}return J===z.a.Db(l.a.jE)||J===z.a.Db(l.a.kE)||J===z.a.Db(l.a.tA)?(this.Ywp(G),G.mh.add(z.a.Db(l.a.jE)),G.mh.add(z.a.Db(l.a.kE)),G.mh.add(z.a.Db(l.a.tA)),!0):J==z.a.Db(l.a.a2)||J==z.a.Db(w.a.DQ)?(J=this.pyp(G),G.mh.add(z.a.Db(l.a.a2)),G.mh.add(z.a.Db(w.a.DQ)),J):!1}yhp(G,J,U){J=G.xf.getPropertyString(J,l.a.XR);G=G.xf.getPropertyString(U,l.a.XR);return J||G?!0:!1}Ywp(G){const J=G.xf,U=G.Fm;var F=G.np.value.Xf,T=G.Ah.value.Xf;G=this.WLf(G.np.value.yx,
J);T=this.WLf(T,J);F=this.WLf(F,J);const {hUn:Y,iUn:P,jUn:S}=this.DGm(G,T,F);Y.length?(J.setPropertyUint32s(U,l.a.tA,Y),J.setPropertyUint32s(U,l.a.jE,P),J.setPropertyUint32s(U,l.a.kE,S)):this.$Fo(U)}O9j(G,J,U){var F=G.np.value.xFa;if(!F.Bb(z.a.Db(J)))return!0;F=F.get(z.a.Db(J));return this.N9j(G,F,z.a.Db(J),U)}pyp(G){if(!this.Ikf(G.kv.runtime.Dc))return this.O9j(G,l.a.a2,0)&&this.O9j(G,w.a.DQ,6);const J=G.xf;var U=G.Ah.value.Xf,F=G.np.value.Xf,T=J.getPropertyBool(U,l.a.a2),Y=J.getPropertyBool(F,l.a.a2);
U=J.getPropertyBool(U,w.a.DQ);F=J.getPropertyBool(F,w.a.DQ);T=null!==T&&void 0!==T?T:!1;Y=null!==Y&&void 0!==Y?Y:!1;const P=null!==U&&void 0!==U?U:!1,S=null!==F&&void 0!==F?F:!1;U=T&&Y;F=null;T!=Y&&(P||S)?F=!0:!T&&!Y&&P&&S&&(F=!0);G=G.Fm;null!=U?J.setPropertyBool(G,l.a.a2,U):G.removeProperty(l.a.a2);null!=F?J.setPropertyBool(G,w.a.DQ,F):G.removeProperty(w.a.DQ);return!0}WLf(G,J){const U=J.getPropertyUint32s(G,l.a.tA),F=J.getPropertyUint32s(G,l.a.jE);G=J.getPropertyUint32s(G,l.a.kE);J=new u.a;if(!U)return J;
for(let T=0;T<U.length;++T)J.add(new y(U.K(T),F.K(T),G.K(T)));return J}DGm(G,J,U){const {Mvj:F,Nvj:T,Ovj:Y}=this.LBi(G,J),{Mvj:P,Nvj:S,Ovj:N}=this.LBi(G,U);G=this.u0m(G,T,Y,S,N);G=this.t0m(G,F,P);J=new u.a;U=new u.a;const V=new u.a;for(let Z=0;Z<G.length;++Z)J.add(G.K(Z).position),U.add(G.K(Z).leader),V.add(G.K(Z).val);return{hUn:J,iUn:U,jUn:V}}LBi(G,J){const U=new u.a,F=new v.a,T=new v.a;let Y,P;for(Y=P=0;Y<G.length&&P<J.length;)G.K(Y).position===J.K(P).position?(G.K(Y).equals(J.K(P))||T.W(G.K(Y).position,
J.K(P)),++Y,++P):G.K(Y).position<J.K(P).position?(F.W(G.K(Y).position,G.K(Y)),++Y):(U.add(J.K(P)),++P);for(;Y<G.length;)F.W(G.K(Y).position,G.K(Y)),++Y;for(;P<J.length;)U.add(J.K(P)),++P;return{Mvj:U,Nvj:F,Ovj:T}}u0m(G,J,U,F,T){const Y=new u.a;for(let P=0;P<G.length;++P){const S=G.K(P).position;J.Bb(S)||(U.Bb(S)?Y.add(U.K(S)):F.Bb(S)||(T.Bb(S)?Y.add(T.K(S)):Y.add(G.K(P))))}return Y}t0m(G,J,U){J=this.rjj(J,U);return this.rjj(G,J)}rjj(G,J){const U=new u.a;let F,T;for(F=T=0;F<G.length&&T<J.length;)G.K(F).position<=
J.K(T).position?(U.add(G.K(F)),G.K(F).position===J.K(T).position&&++T,++F):U.add(J.K(T++));for(;F<G.length;)U.add(G.K(F++));for(;T<J.length;)U.add(J.K(T++));return U}$Fo(G){G.removeProperty(l.a.tA);G.removeProperty(l.a.jE);G.removeProperty(l.a.kE)}static gi(){return new D}static get instance(){return D.Ch.value}static WSh(G){G.mh.add(z.a.Db(a.a.so));G.mh.add(z.a.Db(a.a.Qq));G.mh.add(z.a.Db(a.a.sw));G.mh.add(z.a.Db(l.a.A2));G.mh.add(z.a.Db(l.a.qU));G.mh.add(z.a.Db(l.a.qd));G.mh.add(z.a.Db(a.a.ABb));
G.mh.add(z.a.Db(l.a.DYa));G.mh.add(z.a.Db(l.a.zPa));G.mh.add(z.a.Db(a.a.PEa));G.mh.add(z.a.Db(l.a.wNa));G.mh.add(z.a.Db(l.a.Qma));G.mh.add(z.a.Db(l.a.xNa));G.mh.add(z.a.Db(l.a.DLa));G.mh.add(z.a.Db(l.a.yNa));G.mh.add(z.a.Db(l.a.ELa));G.mh.add(z.a.Db(l.a.yPa));G.mh.add(z.a.Db(l.a.bRa));G.mh.add(z.a.Db(l.a.cRa));G.mh.add(z.a.Db(l.a.MGa));G.mh.add(z.a.Db(l.a.vy));G.mh.add(z.a.Db(l.a.XR))}static U9j(G,J,U,F){return(new H.a(G,J,U,F)).qDc()}static MUd(G,J,U){U=J.getPropertyObjectIds(U,a.a.Qq);for(let T=
0;T<U.length;T++){var F=G.runtime.Pw.K(U.Lg(T));if(F&&(F=J.getPropertyObjectId(F,l.a.Fe))){G.runtime.cBc.add(F);break}}}WTn(G,J){return J?this.Pup.has(G)?!0:!1:!1}}D.Ch=new m.a(D.gi);Object(I.a)(D,"ParagraphNodeComplexMerge",E.a,[])},1923:function(I,K,e){e.r(K);e.d(K,"MarkerValidation",function(){return a});I=e(0);var m=e(373),f=e(1729);class a{constructor(){this.Vfe=this.hZi=this.gZi=this.fZi=0}fCi(){const l=new m.a(0);l.W("InvalidBookmarks",this.fZi);l.W("InvalidComments",this.gZi);l.W("InvalidContentControls",
this.hZi);0!==this.Vfe&&l.W("InvalidMarkerType",this.Vfe);return l}DSi(){return 0<this.fZi||0<this.gZi||0<this.hZi||0!==this.Vfe?!0:!1}toString(){return JSON.stringify(f.a.P3a(this.fCi()))}}Object(I.a)(a,"MarkerValidation",null,[])},1924:function(I,K,e){e.d(K,"a",function(){return z});I=e(0);var m=e(185),f=e(1059),a=e(247),l=e(1629),w=e(1504);class z{constructor(x,u,v,E,y=null,H=null,D=null,G=null){this.we=x;this.tJ=u;this.nIa=v;this.LJa=E;this.WKk=y;this.oBk=H;this.CXk=D;this.vza=G||this.Xvf()}Xvf(){return x=>
!!this.we.runtime.Dc&&this.we.runtime.Dc.isFeatureEnabled(x)}SLl(){return()=>this.we.runtime.Dc}KBf(){return!!this.we.runtime.Ao.K(a.a.NP)}l1j(){let x;if(1===this.we.input.source||2===this.we.input.source)x=73;else if(4===this.we.input.source||3===this.we.input.source)x=34;else if(5===this.we.input.source)x=111;else return!1;return this.KBf()&&this.vza(x)}x3j(x,...u){return String.format.apply(null,[x].concat(u))}pae(x){const {ParagraphMerge:u}=e(2006);let v=this.we,E=this.nIa,y=this.LJa;x||(v=this.WKk||
this.we,E=this.oBk||E,y=this.CXk||y);var H=w.a.POf(this.tJ);const D=w.a.POf(E),G=w.a.POf(y);H=this.x3j("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",v.input.source,v.runtime.RKa.id,v.runtime.X5d,v.runtime.XHe,H.Bt(),D.Bt(),G.Bt());return x?{returnValue:new l.a(v,this.tJ,E,y,this.Xvf(),new f.a),Bt:H}:{returnValue:new u(v,this.tJ,E,y,this.Xvf(),this.SLl(),new f.a),Bt:H}}qDc(){this.we.logger.S3o();
var x=this.l1j();var u=({Bt:E}=this.pae(x)).returnValue;m.a.instance.fb(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",x,E);this.we.logger.EZ("ParagraphMergeSelector initialization");x?this.we.logger.uBe(1):this.we.logger.uBe(2);let v=({ks:u}=u.qDc()).returnValue;this.we.logger.wDg();var E=!v;x=!!this.we.runtime.Ao.K(a.a.NP)&&(x&&!v||!x);E&&({Bt:E,returnValue:u}=this.pae(!1),{ks:u,returnValue:v}=u.qDc(),m.a.instance.fb(18994390,1,v?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",
v,E));x&&(E=new f.a,w.a.lOo(this.we,E));this.we.logger.EZ("ParagraphMergeSelector finalization");return{returnValue:v,ks:u}}owd(x,u){let v,E,y;const H=this.l1j()&&this.vza(112);let D=({Bt:y}=this.pae(H)).returnValue,G=({Nfb:v,rxa:E}=D.owd(x,u)).returnValue;m.a.instance.fb(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",H,y);H&&!G&&D.Tyg&&({Bt:y,returnValue:D}=this.pae(!1),{Nfb:v,rxa:E,returnValue:G}=D.owd(x,u),m.a.instance.fb(18994392,1,G?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",
G,y));return{returnValue:G,Nfb:v,rxa:E}}}Object(I.a)(z,"ParagraphMergeSelector",null,[835])},1925:function(I,K,e){e.r(K);e.d(K,"SurfaceStringTokenStringGenerator",function(){return f});I=e(0);var m=e(1545);class f extends m.a{constructor(a){super(a);this.Kb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.iOi(x,l));v=m.a.bUh(a,u,this.Kb.score,w,z,v);return{hvd:u,rXc:v}}}f.sXc=0;Object(I.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},1926:function(I,K,e){e.r(K);e.d(K,"QueryTokenStringGenerator",function(){return a});
I=e(0);var m=e(1545),f=e(1384);class a extends m.a{constructor(l){super(l);this.Kb=l}apply(l,w,z,x,u,v,E){w=this.Kb.query.load(w,null);u=0;let y=null;this.Kb.query.o$===f.Annotations.PGa?w&&(y=this.Kb.name):((y=this.Kb.name)&&(y+="_"),y+=this.Kb.annotations.dka(this.Kb.query.o$,w));null!=y&&(u=m.a.bUh(l,y,this.Kb.score,z,x,u));return{hvd:v,rXc:E+u}}}a.sXc=1;Object(I.a)(a,"QueryTokenStringGenerator",m.a,[])},1927:function(I,K,e){e.r(K);e.d(K,"FuzzyMatchTokenStringGenerator",function(){return f});I=
e(0);var m=e(1545);class f extends m.a{constructor(a){super(a);this.Kb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.iOi(x,l));a=this.Kb.Cqi.LOn(u);if(this.Kb.fvj)for(var E of a)if(!E.hT&&E.V6d)return{hvd:u,rXc:v};E=0;for(const y of a)if(y.hT&&!({Hpf:E}=this.XYh(y,!0,w,z,E)).returnValue)return{hvd:u,rXc:v};if(this.Kb.IVi)for(const y of a)if(!({Hpf:E}=this.XYh(y,!1,w,z,E)).returnValue)break;return{hvd:u,rXc:v}}XYh(a,l,w,z,x){let u;l?(l=0,u=a.V6d?1:0):(l=a.V6d?1:0,u=a.count-l);for(let v=0;v<u;++v)if(m.a.cUh(a.rsb+
l+v,this.Kb.score,w,z),++x,0<this.Kb.cbg&&x>=this.Kb.cbg)return{returnValue:!1,Hpf:x};return{returnValue:!0,Hpf:x}}}f.sXc=2;Object(I.a)(f,"FuzzyMatchTokenStringGenerator",m.a,[])},1996:function(I,K,e){I=e(0);var m=e(61),f=e(5),a=e(41),l=e(277),w=e(1383);class z extends w.a{constructor(){super()}get Lp(){return 2}get MD(){return 7}static gi(){return new z}static get instance(){return z.Ch.value}}z.Ch=new l.a(z.gi);Object(I.a)(z,"AppBindingNodeComplexMerge",w.a,[]);var x=e(13),u=e(824),v=e(185),E=e(1458);
class y extends w.a{constructor(){super()}get Lp(){return 3}get MD(){return 7}Vl(){const kb=super.Vl();kb.W(u.a.Db(x.a.qW),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(x.a.qW)){const zc=kb.Fm;var nc=kb.xf;v.a.instance.fb(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,zc.yc,Ob);Ob=nc.getPropertyMilliseconds(kb.Ah.value.Xf,x.a.qW);nc=nc.getPropertyMilliseconds(kb.np.value.Xf,x.a.qW);Ob<nc&&this.qtm(kb);kb.mh.add(u.a.Db(x.a.qW));return!0}v.a.instance.fb(6633222,
1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}qtm(kb){this.kLo(kb.np.value.Xf,kb.Fm);this.mLf(kb,f.a.JVd);this.mLf(kb,f.a.ilf);this.mLf(kb,f.a.$kf)}mLf(kb,Ob){var nc=kb.xf,zc=kb.Fm;if(nc.hasProperty(zc,Ob)&&(Ob=nc.getPropertyObjectIds(zc,Ob))&&Ob.length)for(nc=kb.kv.runtime.Pw,kb=kb.kv.runtime.ks,zc=0;zc<Ob.length;zc++){const Pb=Ob.K(zc);if(!nc.Bb(Pb))continue;const tb=nc.K(Pb).KQ();kb.add(Pb,new E.a(tb,
!1))}}static gi(){return new y}static get instance(){return y.Ch.value}}y.Ch=new l.a(y.gi);Object(I.a)(y,"AppNodeComplexMerge",w.a,[]);class H extends w.a{constructor(){super()}get Lp(){return 4}get MD(){return 7}static gi(){return new H}static get instance(){return H.Ch.value}}H.Ch=new l.a(H.gi);Object(I.a)(H,"AppPropNodeComplexMerge",w.a,[]);class D extends w.a{constructor(){super()}get Lp(){return 5}get MD(){return 7}static gi(){return new D}static get instance(){return D.Ch.value}}D.Ch=new l.a(D.gi);
Object(I.a)(D,"AppRefNodeComplexMerge",w.a,[]);var G=e(373),J=e(622),U=e(231),F=e(16);class T{constructor(kb,Ob){this.id=kb;this.Zjp=Ob}}Object(I.a)(T,"IdAndTime",null,[]);class Y extends w.a{constructor(){super()}get Lp(){return 6}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.OVa),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.OVa)){const nc=kb.Fm,zc=kb.xf;v.a.instance.fb(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.yc,Ob);Ob=zc.getPropertyObjectIds(kb.Ah.value.yx,
f.a.OVa);const Pb=zc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.OVa),tb=zc.getPropertyObjectIds(kb.np.value.Xf,f.a.OVa);Ob=this.dTn(kb,Ob,Pb,tb);0<Ob.length?zc.setPropertyObjectIds(nc,f.a.OVa,Ob):nc.removeProperty(f.a.OVa);kb.mh.add(u.a.Db(f.a.OVa));return!0}v.a.instance.fb(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}dTn(kb,Ob,nc,zc){const Pb=this.yOa(Ob,nc,zc),tb=Ob.FU(),ib=nc.FU(),Rb=zc.FU();
Ob=w.a.filter(Pb,Nc=>!tb.contains(Nc)&&ib.contains(Nc));nc=w.a.filter(Pb,Nc=>!tb.contains(Nc)&&Rb.contains(Nc));if(!Ob.length||!nc.length)return Pb;const gc=new G.a;Ob.forEach(Nc=>{const Kc=new T(Nc,this.Fyi(kb,Nc,!1));this.Byi(kb,Nc,!1).forEach(fd=>{gc.add(fd,Kc);return!0});return!0});const xc=new J.a;nc.forEach(Nc=>{const Kc=this.Fyi(kb,Nc,!0);this.Byi(kb,Nc,!0).forEach(fd=>gc.Bb(fd)?(xc.add(gc.K(fd).Zjp>=Kc?Nc:gc.K(fd).id),!1):!0);return!0});return w.a.filter(Pb,Nc=>!xc.contains(Nc))}Fyi(kb,Ob,
nc){return(Ob=this.Lca(kb,Ob,nc))?kb.xf.getPropertyMilliseconds(Ob,x.a.qW):0}Lca(kb,Ob,nc){kb=nc?kb.kv.runtime.Pw:kb.kv.runtime.BC;return kb.Bb(Ob)?kb.K(Ob):null}Byi(kb,Ob,nc){const zc=new U.a,Pb=new J.a,tb=kb.xf;Ob=this.Lca(kb,Ob,nc);var ib=this.BKi(tb,Ob);if(ib)for(zc.add(ib),Pb.add(ib),Ob=tb.getPropertyObjectIds(Ob,f.a.JVd),ib=0;Ob&&ib<Ob.length;ib++){const Rb=this.BKi(tb,this.Lca(kb,Ob.K(ib),nc));if(!Rb)break;Pb.contains(Rb)||(zc.add(Rb),Pb.add(Rb))}return zc}BKi(kb,Ob){if(!kb.hasProperty(Ob,
f.a.PVa)||!kb.hasProperty(Ob,f.a.Lob)||!kb.hasProperty(Ob,f.a.$Mb))return null;const nc=kb.getPropertyString(Ob,f.a.PVa),zc=kb.getPropertyString(Ob,f.a.Lob);kb=kb.getPropertyString(Ob,f.a.$Mb);return F.a.BE(nc+";"+zc+";"+kb)}static gi(){return new Y}static get instance(){return Y.Ch.value}}Y.Ch=new l.a(Y.gi);Object(I.a)(Y,"AppsNodeComplexMerge",w.a,[]);class P extends w.a{constructor(){super()}get Lp(){return 36}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.tPg),1);kb.W(u.a.Db(f.a.KDg),1);return kb}HF(kb,
Ob){v.a.instance.fb(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Ob);if(Ob===u.a.Db(f.a.tPg)||Ob===u.a.Db(f.a.KDg)){const tb=u.a.q1(Ob);var nc=kb.Ah.value.Xf,zc=kb.np.value.Xf;const ib=kb.Fm;var Pb=kb.xf.getPropertyStrings(kb.Ah.value.yx,tb);nc=kb.xf.getPropertyStrings(nc,tb);zc=kb.xf.getPropertyStrings(zc,tb);Pb=this.yOa(Pb,nc,zc);kb.xf.setPropertyStrings(ib,tb,Pb);kb.mh.add(Ob);return!0}return!1}static gi(){return new P}static get instance(){return P.Ch.value}}
P.Ch=new l.a(P.gi);Object(I.a)(P,"AutoSaveParametersNodeComplexMerge",w.a,[]);class S extends w.a{constructor(){super()}get Lp(){return 44}Vl(){const kb=super.Vl();kb.W(u.a.Db(x.a.Fg),1);return kb}HF(kb,Ob){const nc=kb.kv.runtime.Dc;if(Ob===u.a.Db(x.a.Fg))return v.a.instance.fb(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",kb.Fm.id,kb.Fm.yc,Ob),nc.bJ(116),nc.isFeatureEnabled(116)?this.gTn(kb,Ob):this.CTn(kb,Ob),!0;v.a.instance.fb(589608912,
1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}gTn(kb,Ob){const nc=u.a.q1(Ob),zc=kb.xf;var Pb=zc.getPropertyObjectIds(kb.Ah.value.yx,nc),tb=zc.getPropertyObjectIds(kb.Ah.value.Xf,nc),ib=zc.getPropertyObjectIds(kb.np.value.Xf,nc);ib=S.tWm(kb,tb,ib);Pb=this.yOa(Pb,tb,ib);tb=kb.Fm;0<Pb.length?zc.setPropertyObjectIds(tb,nc,Pb):tb.removeProperty(nc);kb.mh.add(Ob)}static gi(){return new S}static get instance(){return S.Ch.value}static tWm(kb,
Ob,nc){const zc=new U.a,Pb=new G.a;Ob.forEach(tb=>{const ib=kb.kv.runtime.BC.K(tb);ib&&Pb.add(ib.nG(f.a.Wv).toString(),tb);return!0});nc.forEach(tb=>{var ib=kb.kv.runtime.Pw.K(tb);ib?(ib=ib.nG(f.a.Wv).toString(),Pb.Bb(ib)&&Pb.get(ib)!==tb?v.a.instance.fb(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):zc.add(tb)):zc.add(tb);return!0});return zc}}S.Ch=new l.a(S.gi);Object(I.a)(S,"BookmarkContainerNodeComplexMerge",w.a,
[]);class N extends w.a{constructor(){super()}get Lp(){return 41}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.yNb),1);kb.W(u.a.Db(f.a.Wv),1);return kb}HF(kb,Ob){return Ob===u.a.Db(f.a.yNb)?(kb.mh.add(u.a.Db(f.a.yNb)),!0):Ob===u.a.Db(f.a.Wv)?(kb.mh.add(u.a.Db(f.a.Wv)),!0):!1}jg(kb){return kb&&kb.length?!1:!0}static gi(){return new N}static get instance(){return N.Ch.value}}N.Ch=new l.a(N.gi);Object(I.a)(N,"BookmarkNodeComplexMerge",w.a,[]);class V extends w.a{constructor(){super();this.Nge=!1}get Lp(){return 7}Vl(){const kb=
super.Vl();kb.W(u.a.Db(x.a.Fg),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(x.a.Fg)){const Pb=kb.Fm,tb=kb.xf;var nc=kb.kv.runtime.Dc;nc&&(this.Nge=nc.isFeatureEnabled(67));v.a.instance.fb(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Pb.id,Pb.yc,Ob);Ob=tb.getPropertyObjectIds(kb.Ah.value.yx,x.a.Fg);nc=tb.getPropertyObjectIds(kb.Ah.value.Xf,x.a.Fg);var zc=tb.getPropertyObjectIds(kb.np.value.Xf,x.a.Fg);Ob=this.pTn(Ob,nc,zc);if(this.Nge&&
0<Ob.length){nc=new Sys.StringBuilder;for(zc=0;zc<Ob.length;zc++)nc.append(Ob.K(zc).toString()+",");v.a.instance.fb(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Pb.id,nc.toString())}0<Ob.length?tb.setPropertyObjectIds(Pb,x.a.Fg,Ob):Pb.removeProperty(x.a.Fg);kb.mh.add(u.a.Db(x.a.Fg));return!0}v.a.instance.fb(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}pTn(kb,
Ob,nc){const zc=new U.a,Pb=new G.a(0);this.Tcm(kb,nc,zc,Pb);return this.dZl(Ob,Pb,zc)}Tcm(kb,Ob,nc,zc){kb=kb||new U.a;Ob=Ob||new U.a;kb.forEach(Pb=>{zc.W(Pb,1);return!0});Ob.forEach(Pb=>{zc.Nc(Pb).returnValue?zc.W(Pb,2):(zc.W(Pb,0),nc.add(Pb));return!0})}dZl(kb,Ob,nc){kb=kb||new U.a;const zc=new U.a,Pb=new U.a,tb=new U.a;kb.forEach(ib=>{let Rb=!0,gc;({value:gc}=Ob.Nc(ib)).returnValue&&(0===gc?Ob.W(ib,2):1===gc&&(Rb=!1));Rb?zc.add(ib):this.Nge&&Pb.add(ib);return!0});nc.forEach(ib=>{let Rb=!1,gc;({value:gc}=
Ob.Nc(ib)).returnValue?0===gc&&(Rb=!0,Ob.W(ib,2)):v.a.instance.fb(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",ib);Rb?zc.add(ib):this.Nge&&tb.add(ib);return!0});this.vfj(Pb,"Favored");this.vfj(tb,"Unfavored");return zc}vfj(kb,Ob){if(kb.length){var nc=new Sys.StringBuilder;for(let zc=0;zc<kb.length;zc++)nc.append(kb.K(zc).toString()+",");v.a.instance.fb(561637572,1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",
Ob,nc.toString())}}static gi(){return new V}static get instance(){return V.Ch.value}}V.Ch=new l.a(V.gi);Object(I.a)(V,"CommentContentNodeComplexMerge",w.a,[]);var Z=e(87),ca=e(29);class W extends w.a{constructor(){super();this.iMh=[1]}get Lp(){return 8}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.zga),3);kb.W(u.a.Db(f.a.KI),3);kb.W(u.a.Db(f.a.Zpb),2);kb.W(u.a.Db(f.a.commentId),2);kb.W(u.a.Db(f.a.WYc),2);kb.W(u.a.Db(f.a.wta),2);kb.W(u.a.Db(f.a.xWa),1);kb.W(u.a.Db(f.a.tub),1);kb.W(u.a.Db(f.a.Fvb),1);kb.W(u.a.Db(f.a.JV),
1);kb.W(u.a.Db(f.a.iK),1);kb.W(u.a.Db(f.a.UYc),2);kb.W(u.a.Db(f.a.ZZd),2);kb.W(u.a.Db(f.a.y9a),2);kb.W(u.a.Db(f.a.ptf),2);kb.W(u.a.Db(f.a.LQ),1);kb.W(u.a.Db(x.a.Fg),0);kb.W(u.a.Db(f.a.uL),0);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.LQ)){var nc=kb.xf.getPropertyString(kb.np.value.Xf,f.a.LQ);this.jg(nc)?kb.Fm.removeProperty(f.a.LQ):kb.Fm.Agb(f.a.LQ,nc);return!0}if(Ob!==u.a.Db(f.a.xWa)&&Ob!==u.a.Db(f.a.tub)&&Ob!==u.a.Db(f.a.Fvb)&&Ob!==u.a.Db(f.a.iK)&&Ob!==u.a.Db(f.a.JV))return!1;var zc=kb.Ah.value.yx;
const Pb=kb.Ah.value.Xf;var tb=kb.np.value.Xf;nc=kb.Fm;if(Ob===u.a.Db(f.a.xWa)){zc=kb.xf.getPropertyString(Pb,f.a.xWa);tb=kb.xf.getPropertyString(tb,f.a.xWa);tb=this.jg(zc)?tb:this.jg(tb)?zc:null;if(this.jg(tb))return!0;kb.xf.setPropertyString(nc,f.a.xWa,tb);kb.mh.add(u.a.Db(f.a.xWa));return!0}if(Ob===u.a.Db(f.a.Fvb))return zc=kb.xf.getPropertyBool(Pb,f.a.Fvb),tb=kb.xf.getPropertyBool(tb,f.a.Fvb),zc=null!=zc?zc:!1,zc=(null!=tb?tb:!1)||zc,kb.xf.setPropertyBool(nc,f.a.Fvb,zc),kb.mh.add(u.a.Db(f.a.Fvb)),
!0;if(Ob===u.a.Db(f.a.tub)){zc=kb.xf.getPropertyBool(Pb,f.a.tub);tb=kb.xf.getPropertyBool(tb,f.a.tub);if(zc===tb)return!0;zc=null!=zc?zc:!1;zc=(null!=tb?tb:!1)||zc;kb.xf.setPropertyBool(nc,f.a.tub,zc);return!0}if(Ob===u.a.Db(f.a.iK)){zc=kb.xf.getPropertyBool(Pb,f.a.iK);tb=kb.xf.getPropertyBool(tb,f.a.iK);if(zc===tb)return!0;zc=null!=zc?zc:!1;zc=(null!=tb?tb:!1)||zc;kb.xf.setPropertyBool(nc,f.a.iK,zc);kb.mh.add(u.a.Db(f.a.iK));return!0}if(Ob===u.a.Db(f.a.JV)){Ob=kb.kv.runtime.Dc;Ob.bJ(12);if(Ob.isFeatureEnabled(12))return this.TCl(kb,
zc,Pb,tb,nc);zc=kb.xf.getPropertyString(Pb,f.a.JV);tb=kb.xf.getPropertyString(tb,f.a.JV);if(zc===tb)return!0;kb.xf.setPropertyString(nc,f.a.JV,tb||zc);kb.mh.add(u.a.Db(f.a.JV));return!0}return!1}TCl(kb,Ob,nc,zc,Pb){nc=kb.xf.getPropertyString(nc,f.a.JV);var tb=kb.xf.getPropertyString(zc,f.a.JV);if(nc===tb)return!0;zc=kb.xf.getPropertyString(Ob,f.a.JV);Ob={};zc=this.gQf(zc);nc=this.gQf(nc);tb=this.gQf(tb);for(let Rb=0;Rb<this.iMh.length;Rb++){const gc=this.iMh[Rb];var ib=this.fQf(zc,gc);const xc=this.fQf(nc,
gc),Nc=this.fQf(tb,gc);ib=this.KTn(ib,xc,Nc);Ob[gc.toString()]=ib.toArray()}kb.xf.setPropertyString(Pb,f.a.JV,this.nYo(Ob));kb.mh.add(u.a.Db(f.a.JV));return!0}KTn(kb,Ob,nc){const zc=new G.a,Pb=new G.a(0);for(var tb=0;tb<Ob.length;tb++){const Rb=Ob[tb].UserId;zc.add(Rb,Ob[tb]);Pb.add(Rb,0)}for(Ob=0;Ob<nc.length;Ob++)tb=nc[Ob].UserId,Pb.Bb(tb)?Pb.W(tb,2):(zc.add(tb,nc[Ob]),Pb.add(tb,0));for(nc=0;nc<kb.length;nc++)Ob=kb[nc].UserId,Pb.Bb(Ob)&&2!==Pb.K(Ob)&&Pb.W(Ob,1);const ib=new U.a;Pb.forEach((Rb,gc)=>
{if(1===gc)return!0;ib.add(zc.K(Rb));return!0});return ib}fQf(kb,Ob){return Ob.toString()in kb?Array.isArray(kb[Ob.toString()])?kb[Ob.toString()]:null:[]}gQf(kb){return Object(Z.a)(Object,this.OXl(kb))}OXl(kb){return Object(Z.a)(Object,ca.b(kb))}nYo(kb){return ca.c(kb)}jg(kb){return kb&&kb.length?!1:!0}static gi(){return new W}static get instance(){return W.Ch.value}}W.Ch=new l.a(W.gi);Object(I.a)(W,"CommentNodeComplexMerge",w.a,[]);class X extends w.a{constructor(){super()}get Lp(){return 46}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.je),1);kb.W(u.a.Db(x.a.lastModifiedTime),0);kb.W(u.a.Db(f.a.zZc),2);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.je))return v.a.instance.fb(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",kb.Fm.id,kb.Fm.yc,Ob),w.a.ubg(kb,this,f.a.je);v.a.instance.fb(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",
kb.Ah.value.Xf.id,Ob);return!1}static gi(){return new X}static get instance(){return X.Ch.value}}X.Ch=new l.a(X.gi);Object(I.a)(X,"ContentControlContainerNodeComplexMerge",w.a,[]);var ka=e(33),ma=e(49),ja=e(1782);class na extends w.a{constructor(){super()}get Lp(){return 37}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.aca),1);kb.W(u.a.Db(f.a.qCb),1);kb.W(u.a.Db(f.a.W_d),2);kb.W(u.a.Db(f.a.QOb),2);kb.W(u.a.Db(f.a.je),1);kb.W(u.a.Db(f.a.Yca),1);kb.W(u.a.Db(f.a.Bma),1);kb.W(u.a.Db(f.a.Qhc),1);kb.W(u.a.Db(f.a.pqb),
1);kb.W(u.a.Db(f.a.mqb),1);kb.W(u.a.Db(f.a.lqb),1);kb.W(u.a.Db(f.a.FWa),2);kb.W(u.a.Db(f.a.SOb),1);kb.W(u.a.Db(f.a.X_d),1);kb.W(u.a.Db(f.a.$ba),1);kb.W(u.a.Db(f.a.BN),2);kb.W(u.a.Db(f.a.vCa),2);kb.W(u.a.Db(f.a.Sta),2);kb.W(u.a.Db(f.a.m5),1);kb.W(u.a.Db(f.a.mva),1);kb.W(u.a.Db(f.a.nva),1);this.Dc.isFeatureEnabled(17)&&(kb.W(u.a.Db(ka.a.Buf),2),kb.W(u.a.Db(ka.a.$ai),2),kb.W(u.a.Db(ka.a.Zai),2),kb.W(u.a.Db(ka.a.hbi),2),kb.W(u.a.Db(ka.a.gbi),2));return kb}HF(kb,Ob){var nc=kb.Ah.value.Xf,zc=kb.np.value.Xf;
const Pb=kb.Fm;if(Ob===u.a.Db(f.a.je))return w.a.ubg(kb,this,f.a.je);if(Ob===u.a.Db(f.a.Yca)){Ob=kb.xf.getPropertyBool(nc,f.a.Yca);zc=kb.xf.getPropertyBool(zc,f.a.Yca);if(null!=Ob&&Ob||null!=zc&&zc)kb.xf.setPropertyBool(Pb,f.a.Yca,!0),kb.mh.add(u.a.Db(f.a.Yca));return!0}if(Ob===u.a.Db(f.a.Bma))return Ob=kb.xf.getPropertyBool(nc,f.a.Bma),zc=kb.xf.getPropertyBool(zc,f.a.Bma),kb.xf.setPropertyBool(Pb,f.a.Bma,null!=Ob&&!!Ob&&null!=zc&&!!zc),kb.mh.add(u.a.Db(f.a.Bma)),!0;if(Ob===u.a.Db(f.a.Qhc))return Ob=
kb.xf.getPropertyUint32(zc,f.a.Qhc),null!=Ob&&(kb.xf.setPropertyUint32(Pb,f.a.Qhc,Ob),kb.mh.add(u.a.Db(f.a.Qhc))),!0;if(Ob===u.a.Db(f.a.pqb)||Ob===u.a.Db(f.a.mqb)||Ob===u.a.Db(f.a.lqb))return(zc=kb.xf.getPropertyString(zc,u.a.q1(Ob)))&&0<zc.length&&(kb.xf.setPropertyString(Pb,u.a.q1(Ob),zc),kb.mh.add(Ob)),!0;if(Ob===u.a.Db(f.a.SOb)||Ob===u.a.Db(f.a.X_d)){nc=kb.xf.getPropertyObjectId(nc,u.a.q1(Ob));if(ja.a.qmc(kb.kv,nc))return!0;if((zc=kb.xf.getPropertyObjectId(zc,u.a.q1(Ob)))&&zc!==ma.a.nil)return kb.xf.setPropertyObjectId(Pb,
u.a.q1(Ob),zc),kb.mh.add(Ob),!0;Pb.removeProperty(u.a.q1(Ob));kb.mh.add(Ob);return!0}if(Ob===u.a.Db(f.a.$ba)){nc=kb.xf.getPropertyObjectId(nc,f.a.$ba);if((nc=ja.a.qmc(kb.kv,nc))&&kb.xf.getPropertyObjectIds(nc,f.a.je).FU().contains(kb.Fm.id))return!0;zc=kb.xf.getPropertyObjectId(zc,f.a.$ba);return(nc=ja.a.qmc(kb.kv,zc))&&kb.xf.getPropertyObjectIds(nc,f.a.je).FU().contains(kb.Fm.id)?(kb.xf.setPropertyObjectId(Pb,f.a.$ba,zc),kb.mh.add(Ob),!0):!1}if(Ob===u.a.Db(f.a.aca))return Ob=kb.xf.getPropertyBool(zc,
f.a.aca),null==Ob||Ob||(kb.xf.setPropertyBool(Pb,f.a.aca,!1),kb.mh.add(u.a.Db(f.a.aca))),!0;if(Ob===u.a.Db(f.a.qCb)){Ob=kb.xf.getPropertyObjectId(nc,f.a.qCb);zc=kb.xf.getPropertyObjectId(zc,f.a.qCb);if(Ob&&!Ob.equals(zc))return!1;if(Ob=Ob||zc)kb.xf.setPropertyObjectId(Pb,f.a.qCb,Ob),kb.mh.add(u.a.Db(f.a.qCb));return!0}Ob!==u.a.Db(f.a.m5)&&Ob!==u.a.Db(f.a.mva)&&Ob!==u.a.Db(f.a.nva)||v.a.instance.fb(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",
Ob);return!1}static gi(){return new na}static get instance(){return na.Ch.value}}na.Ch=new l.a(na.gi);Object(I.a)(na,"ContentControlNodeComplexMerge",w.a,[]);class Ba extends w.a{constructor(){super()}get Lp(){return 10}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.bT),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.bT)){Ob=kb.Fm;const zc=kb.xf;var nc=zc.getPropertyObjectIds(kb.Ah.value.yx,f.a.bT);const Pb=zc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.bT),tb=zc.getPropertyObjectIds(kb.np.value.Xf,f.a.bT);nc=this.tTn(nc,
Pb,tb);0<nc.length?zc.setPropertyObjectIds(Ob,f.a.bT,nc):Ob.removeProperty(f.a.bT);kb.mh.add(u.a.Db(f.a.bT));return!0}return!1}tTn(kb,Ob,nc){return this.yOa(kb,Ob,nc)}static gi(){return new Ba}static get instance(){return Ba.Ch.value}}Ba.Ch=new l.a(Ba.gi);Object(I.a)(Ba,"CustomXmlPartContainerNodeComplexMerge",w.a,[]);class Ma extends w.a{constructor(){super()}get Lp(){return 9}get MD(){return 0}static gi(){return new Ma}static get instance(){return Ma.Ch.value}}Ma.Ch=new l.a(Ma.gi);Object(I.a)(Ma,
"CustomXmlPartNodeComplexMerge",w.a,[]);class Ea extends w.a{constructor(){super()}get Lp(){return 29}get MD(){return 3}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.$ma),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.$ma)){Ob=kb.xf;var nc=Ob.getPropertyObjectIds(kb.Ah.value.yx,f.a.$ma),zc=Ob.getPropertyObjectIds(kb.Ah.value.Xf,f.a.$ma);const Pb=Ob.getPropertyObjectIds(kb.np.value.Xf,f.a.$ma);nc=this.yOa(nc,zc,Pb);zc=kb.Fm;0<nc.length?Ob.setPropertyObjectIds(zc,f.a.$ma,nc):zc.removeProperty(f.a.$ma);kb.mh.add(u.a.Db(f.a.$ma));
return!0}return!1}static gi(){return new Ea}static get instance(){return Ea.Ch.value}}Ea.Ch=new l.a(Ea.gi);Object(I.a)(Ea,"EmbeddedFontContainerNodeComplexMerge",w.a,[]);class ya extends w.a{constructor(){super()}get Lp(){return 30}get MD(){return 3}static gi(){return new ya}static get instance(){return ya.Ch.value}}ya.Ch=new l.a(ya.gi);Object(I.a)(ya,"EmbeddedFontNodeComplexMerge",w.a,[]);class ia extends w.a{constructor(){super()}get Lp(){return 11}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.Q8),4);
kb.W(u.a.Db(f.a.sMa),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.sMa)){const nc=kb.Fm,zc=kb.xf;v.a.instance.fb(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.yc,Ob);Ob=zc.getPropertyObjectIds(kb.Ah.value.yx,f.a.sMa);const Pb=zc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.sMa),tb=zc.getPropertyObjectIds(kb.np.value.Xf,f.a.sMa);Ob=this.pjj(Ob,Pb,tb,(ib,Rb)=>ib.equals(Rb));0<Ob.length?zc.setPropertyObjectIds(nc,f.a.sMa,
Ob):nc.removeProperty(f.a.sMa);kb.mh.add(u.a.Db(f.a.sMa));return!0}v.a.instance.fb(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}static gi(){return new ia}static get instance(){return ia.Ch.value}}ia.Ch=new l.a(ia.gi);Object(I.a)(ia,"FootnoteEndnoteContainerNodeComplexMerge",w.a,[]);class za extends w.a{constructor(){super()}get Lp(){return 12}get MD(){return 3}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.uua),1);return kb}HF(kb,Ob){const nc=kb.Fm,zc=kb.xf;if(Ob===u.a.Db(f.a.uua)){let Pb=-1;v.a.instance.fb(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nc.id,nc.yc,Ob);const tb=zc.getPropertyInt32(kb.Ah.value.Xf,f.a.uua),ib=zc.getPropertyInt32(kb.np.value.Xf,f.a.uua);null!=tb&&-1!==tb?Pb=tb:null!=ib&&(Pb=ib);zc.setPropertyInt32(nc,f.a.uua,Pb);kb.mh.add(Ob);return!0}v.a.instance.fb(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
kb.Ah.value.yx.id,Ob);return!1}static gi(){return new za}static get instance(){v.a.instance.fb(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return za.Ch.value}}za.Ch=new l.a(za.gi);Object(I.a)(za,"FootnoteEndnoteNodeComplexMerge",w.a,[]);class Ca extends w.a{constructor(){super()}get Lp(){return 47}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.BYa),1);return kb}HF(kb,Ob){return Ob===u.a.Db(f.a.BYa)?(v.a.instance.fb(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
kb.Fm.id,kb.Fm.yc,Ob),w.a.ubg(kb,this,f.a.BYa)):!1}static gi(){return new Ca}static get instance(){return Ca.Ch.value}}Ca.Ch=new l.a(Ca.gi);Object(I.a)(Ca,"GlossaryPageManifestNodeComplexMerge",w.a,[]);class db extends w.a{constructor(){super()}get Lp(){return 13}get MD(){return 3}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.Axa),4);return kb}static gi(){return new db}static get instance(){return db.Ch.value}}db.Ch=new l.a(db.gi);Object(I.a)(db,"HeaderFooterContainerNodeComplexMerge",w.a,[]);class pa extends w.a{constructor(){super()}get Lp(){return 14}get MD(){return 3}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.runId),3);kb.W(u.a.Db(f.a.qd),3);kb.W(u.a.Db(f.a.f_i),3);kb.W(u.a.Db(f.a.lZ),1);kb.W(u.a.Db(a.a.S1),1);kb.W(u.a.Db(x.a.imageAltText),1);kb.W(u.a.Db(f.a.P1),1);kb.W(u.a.Db(x.a.Sda),1);kb.W(u.a.Db(a.a.pib),1);kb.W(u.a.Db(f.a.MVa),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(x.a.imageAltText)||Ob===u.a.Db(f.a.P1)||Ob===u.a.Db(f.a.lZ)||Ob===u.a.Db(f.a.R1)||Ob===u.a.Db(x.a.Gub)||Ob===u.a.Db(x.a.Sda)||Ob===u.a.Db(a.a.S1)||Ob===u.a.Db(a.a.pib)||Ob===u.a.Db(f.a.MVa)){const zc=kb.Fm;var nc=
kb.xf;v.a.instance.fb(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,zc.yc,Ob);const Pb=nc.getPropertyInt32(kb.Ah.value.Xf,a.a.S1);nc=nc.getPropertyInt32(kb.np.value.Xf,a.a.S1);if(null!=Pb&&(0===Pb||2===Pb))return!0;if(null!=nc&&(0===nc||2===nc))return Ob=kb.np.value.Xf,this.xqb(Ob,zc,x.a.imageAltText),this.xqb(Ob,zc,f.a.P1),this.xqb(Ob,zc,f.a.R1),Ob.hasProperty(f.a.lZ)&&this.xqb(Ob,zc,f.a.lZ),this.xqb(Ob,zc,x.a.Gub),this.xqb(Ob,
zc,x.a.Sda),this.xqb(Ob,zc,a.a.S1),this.xqb(Ob,zc,a.a.pib),kb.mh.add(u.a.Db(x.a.imageAltText)),kb.mh.add(u.a.Db(f.a.P1)),kb.mh.add(u.a.Db(f.a.R1)),kb.mh.add(u.a.Db(f.a.lZ)),kb.mh.add(u.a.Db(x.a.Gub)),kb.mh.add(u.a.Db(x.a.Sda)),kb.mh.add(u.a.Db(a.a.S1)),kb.mh.add(u.a.Db(a.a.pib)),kb.mh.add(u.a.Db(f.a.MVa)),!0}v.a.instance.fb(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.yx.id,Ob);return!1}static gi(){return new pa}static get instance(){return pa.Ch.value}}
pa.Ch=new l.a(pa.gi);Object(I.a)(pa,"ImageNodeComplexMerge",w.a,[]);class ua extends w.a{constructor(){super()}get Lp(){return 40}get MD(){return 0}static gi(){return new ua}static get instance(){return ua.Ch.value}}ua.Ch=new l.a(ua.gi);Object(I.a)(ua,"IntelligenceAnnotationNodeComplexMerge",w.a,[]);class Ga extends w.a{constructor(){super()}get Lp(){return 32}get MD(){return 0}static gi(){return new Ga}static get instance(){return Ga.Ch.value}}Ga.Ch=new l.a(Ga.gi);Object(I.a)(Ga,"IntelligenceContentLocatorNodeComplexMerge",
w.a,[]);class wa extends w.a{constructor(){super()}get Lp(){return 34}get MD(){return 0}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.nZa),1);return kb}HF(kb,Ob){const nc=kb.Fm,zc=kb.xf;if(Ob===u.a.Db(f.a.nZa)){Ob=zc.getPropertyObjectIds(kb.Ah.value.yx,f.a.nZa);const Pb=zc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.nZa),tb=zc.getPropertyObjectIds(kb.np.value.Xf,f.a.nZa);Ob=this.yOa(Ob,Pb,tb);zc.setPropertyObjectIds(nc,f.a.nZa,Ob);kb.mh.add(u.a.Db(f.a.nZa));return!0}return!1}static gi(){return new wa}static get instance(){return wa.Ch.value}}
wa.Ch=new l.a(wa.gi);Object(I.a)(wa,"IntelligenceRegionNodeComplexMerge",w.a,[]);class xa extends w.a{constructor(){super()}get Lp(){return 35}get MD(){return 0}static gi(){return new xa}static get instance(){return xa.Ch.value}}xa.Ch=new l.a(xa.gi);Object(I.a)(xa,"IntelligenceRejectionNodeComplexMerge",w.a,[]);class sa extends w.a{constructor(){super()}get Lp(){return 39}get MD(){return 0}static gi(){return new sa}static get instance(){return sa.Ch.value}}sa.Ch=new l.a(sa.gi);Object(I.a)(sa,"IntelligenceReviewedNodeComplexMerge",
w.a,[]);class Ka extends w.a{constructor(){super()}get Lp(){return 33}get MD(){return 0}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.wpc),1);kb.W(u.a.Db(f.a.vpc),1);kb.W(u.a.Db(f.a.Kfe),1);kb.W(u.a.Db(f.a.Mfe),1);return kb}HF(kb,Ob){const nc=kb.Fm,zc=kb.xf;if(Ob===u.a.Db(f.a.wpc)||Ob===u.a.Db(f.a.vpc)||Ob===u.a.Db(f.a.Kfe)||Ob===u.a.Db(f.a.Mfe)){Ob=Ob===u.a.Db(f.a.wpc)?f.a.wpc:f.a.vpc;var Pb=zc.getPropertyObjectIds(kb.Ah.value.yx,Ob);const tb=zc.getPropertyObjectIds(kb.Ah.value.Xf,Ob),ib=zc.getPropertyObjectIds(kb.np.value.Xf,
Ob);Pb=this.yOa(Pb,tb,ib);zc.setPropertyObjectIds(nc,Ob,Pb);kb.mh.add(u.a.Db(Ob));return!0}return!1}static gi(){return new Ka}static get instance(){return Ka.Ch.value}}Ka.Ch=new l.a(Ka.gi);Object(I.a)(Ka,"IntelligenceRootNodeComplexMerge",w.a,[]);class Na extends w.a{constructor(){super()}get Lp(){return 42}get MD(){return 0}static gi(){return new Na}static get instance(){return Na.Ch.value}}Na.Ch=new l.a(Na.gi);Object(I.a)(Na,"IntelligenceSettingNodeComplexMerge",w.a,[]);class ub extends w.a{constructor(){super()}get Lp(){return 45}get MD(){return 0}static gi(){return new ub}static get instance(){return ub.Ch.value}}
ub.Ch=new l.a(ub.gi);Object(I.a)(ub,"IntelligenceWorkflowNodeComplexMerge",w.a,[]);class Ua extends w.a{constructor(){super()}get Lp(){return 15}get MD(){return 3}static gi(){return new Ua}static get instance(){return Ua.Ch.value}}Ua.Ch=new l.a(Ua.gi);Object(I.a)(Ua,"NumberListNodeComplexMerge",w.a,[]);var sb=e(114);class qb extends w.a{constructor(){super()}get Lp(){return 16}get MD(){return 0}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.iNb),1);kb.W(u.a.Db(sb.a.vtf),7);kb.W(u.a.Db(sb.a.ttf),7);return kb}HF(kb,
Ob){const nc=kb.Fm,zc=kb.xf;if(Ob===u.a.Db(f.a.iNb))return this.e6f(zc,kb.Ah.value.Xf,kb.np.value.Xf,nc,f.a.iNb),kb.mh.add(Ob),!0;v.a.instance.fb(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.yx.id,Ob);return!1}static gi(){return new qb}static get instance(){return qb.Ch.value}}qb.Ch=new l.a(qb.gi);Object(I.a)(qb,"OutlineElementNodeComplexMerge",w.a,[]);class ab extends w.a{constructor(){super()}get Lp(){return 17}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.iNb),1);kb.W(u.a.Db(f.a.Zta),1);kb.W(u.a.Db(sb.a.H4),1);kb.W(u.a.Db(sb.a.Ksc),1);kb.W(u.a.Db(sb.a.x0a),8);return kb}HF(kb,Ob){const nc=kb.Fm,zc=kb.xf;if(Ob===u.a.Db(f.a.iNb))return this.e6f(zc,kb.Ah.value.Xf,kb.np.value.Xf,nc,f.a.iNb),kb.mh.add(Ob),!0;if(Ob===u.a.Db(f.a.Zta)){var Pb=zc.getPropertyBool(kb.Ah.value.Xf,f.a.Zta),tb=zc.getPropertyBool(kb.np.value.Xf,f.a.Zta);zc.setPropertyBool(nc,f.a.Zta,null==Pb?!1:Pb&&null==tb?!1:tb);kb.mh.add(Ob);return!0}if(Ob===u.a.Db(sb.a.Ksc))return this.e6f(zc,
kb.Ah.value.Xf,kb.np.value.Xf,nc,sb.a.Ksc),kb.mh.add(Ob),!0;if(Ob===u.a.Db(sb.a.H4))return Pb=zc.getPropertyBool(kb.Ah.value.Xf,sb.a.H4),tb=zc.getPropertyBool(kb.np.value.Xf,sb.a.H4),zc.setPropertyBool(nc,sb.a.H4,null==Pb?!0:Pb||null==tb?!0:tb),kb.mh.add(Ob),!0;v.a.instance.fb(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.yx.id,Ob);return!1}static gi(){return new ab}static get instance(){return ab.Ch.value}}
ab.Ch=new l.a(ab.gi);Object(I.a)(ab,"OutlineGroupNodeComplexMerge",w.a,[]);var Xa=e(118);class wb extends w.a{constructor(){super()}get Lp(){return 18}get MD(){return 2}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.fde),3);kb.W(u.a.Db(x.a.hU),this.MD);kb.W(u.a.Db(f.a.Bu),1);kb.W(u.a.Db(f.a.a$),1);kb.W(u.a.Db(f.a.hs),1);kb.W(u.a.Db(ka.a.EH),1);kb.W(u.a.Db(ka.a.c0a),1);return kb}HF(kb,Ob){const nc=kb.xf;if(kb.kv.runtime.Dc.isFeatureEnabled(64)){if(Ob===u.a.Db(f.a.Bu)||Ob===u.a.Db(f.a.a$)||Ob===u.a.Db(ka.a.c0a)||
Ob===u.a.Db(f.a.hs)||Ob===u.a.Db(ka.a.EH))return this.Uyp(nc,kb)}else if(Ob===u.a.Db(f.a.Bu)||Ob===u.a.Db(f.a.hs)){let zc,Pb;({kZc:Ob,ycb:zc,ocb:Pb}=this.trf(Object(Xa.a)(nc,nc.getPropertyUint32s,"getPropertyUint32s"),kb.Ah.value.yx,kb.Ah.value.Xf,kb.np.value.Xf,f.a.Bu,null));if(!Pb&&!zc)return v.a.instance.fb(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",kb.Ah.value.Xf.id,u.a.Db(f.a.Bu)),!0;let tb,ib,Rb;({kZc:tb,
ycb:ib,ocb:Rb}=this.trf(Object(Xa.a)(nc,nc.getPropertyObjectIds,"getPropertyObjectIds"),kb.Ah.value.yx,kb.Ah.value.Xf,kb.np.value.Xf,f.a.hs,null));if(!ib&&!Rb)return v.a.instance.fb(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",kb.Ah.value.Xf.id,u.a.Db(f.a.hs)),!0;const gc=ib&&!Rb;if((zc&&!Pb)!==gc)return v.a.instance.fb(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
kb.Ah.value.Xf.id,u.a.Db(f.a.Bu),u.a.Db(f.a.hs)),!1;gc&&(nc.setPropertyObjectIds(kb.Fm,f.a.hs,tb),nc.setPropertyUint32s(kb.Fm,f.a.Bu,Ob));v.a.instance.fb(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",kb.Ah.value.Xf.id,u.a.Db(f.a.Bu),zc,Pb,u.a.Db(f.a.hs),ib,Rb);kb.mh.add(u.a.Db(f.a.hs));kb.mh.add(u.a.Db(f.a.Bu));
return!0}v.a.instance.fb(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}hTi(kb,Ob,nc,zc){let Pb;({kZc:Ob,ycb:zc,ocb:Pb}=this.trf(Ob,nc.Ah.value.yx,nc.Ah.value.Xf,nc.np.value.Xf,kb,zc));return Pb||zc?{returnValue:!0,Utf:Ob,ycb:zc,ocb:Pb}:(v.a.instance.fb(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
nc.Ah.value.Xf.id.toString(),u.a.Db(kb)),{returnValue:!1,Utf:Ob,ycb:zc,ocb:Pb})}hSi(kb,Ob,nc,zc,Pb){let tb;let ib,Rb,gc,xc;({Utf:tb,ycb:Nc,ocb:ib,returnValue:gc}=this.hTi(kb,Object(Xa.a)(nc,nc.getPropertyUint32s,"getPropertyUint32s"),zc,null));({Utf:nc,ycb:Pb,ocb:Rb,returnValue:xc}=this.hTi(Ob,Object(Xa.a)(nc,nc.getPropertyObjectIds,"getPropertyObjectIds"),zc,Pb));var Nc=Nc&&!ib;return gc&&xc?Nc!==(Pb&&!Rb)?(v.a.instance.fb(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
zc.Ah.value.Xf.id.toString(),u.a.Db(kb),u.a.Db(Ob)),{returnValue:2,F_d:tb,E_d:nc,GFe:Nc}):{returnValue:0,F_d:tb,E_d:nc,GFe:Nc}:{returnValue:1,F_d:tb,E_d:nc,GFe:Nc}}c1f(kb){let Ob=!0;kb.forEach(nc=>nc!==ma.a.nil?Ob=!1:!0);return Ob}oym(kb,Ob,nc){return this.c1f(kb)&&this.c1f(Ob)&&this.c1f(nc)?!0:!1}Uyp(kb,Ob){let nc,zc,Pb,tb,ib,Rb;var gc=({F_d:tb,E_d:ib,GFe:zc}=this.hSi(ka.a.c0a,f.a.hs,kb,Ob,null)).returnValue;if(2===gc||1===gc)return!0;({F_d:Pb,E_d:Rb,GFe:nc,returnValue:gc}=this.hSi(f.a.Bu,f.a.a$,
kb,Ob,Object(Xa.a)(this,this.oym,"getExtendedGuidEquivalence")));if(2===gc||1===gc)return!0;let xc;({kZc:gc,ycb:Nc,ocb:xc}=this.kvl(Object(Xa.a)(kb,kb.getPropertyDictionary,"getPropertyDictionary"),Ob.Ah.value.yx,Ob.Ah.value.Xf,Ob.np.value.Xf,ka.a.EH));if(!xc&&!Nc)return v.a.instance.fb(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ob.Ah.value.Xf.id.toString(),u.a.Db(ka.a.EH)),!0;var Nc=Nc&&!xc;if(nc!==zc||nc!==
Nc)return v.a.instance.fb(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Ob.Ah.value.Xf.id.toString(),u.a.Db(f.a.Bu),u.a.Db(ka.a.c0a),u.a.Db(ka.a.EH),zc,nc,Nc),!0;nc&&(kb.setPropertyObjectIds(Ob.Fm,f.a.hs,ib),kb.setPropertyUint32s(Ob.Fm,ka.a.c0a,tb),kb.setPropertyObjectIds(Ob.Fm,
f.a.a$,Rb),kb.setPropertyUint32s(Ob.Fm,f.a.Bu,Pb),kb.setPropertyDictionary(Ob.Fm,ka.a.EH,gc));v.a.instance.fb(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Ob.Ah.value.Xf.id.toString(),zc,nc,Nc);Ob.mh.add(u.a.Db(ka.a.c0a));Ob.mh.add(u.a.Db(f.a.hs));Ob.mh.add(u.a.Db(f.a.Bu));Ob.mh.add(u.a.Db(f.a.a$));Ob.mh.add(u.a.Db(ka.a.EH));return!0}static gi(){return new wb}static get instance(){return wb.Ch.value}}
wb.Ch=new l.a(wb.gi);Object(I.a)(wb,"PageContentNodeComplexMerge",w.a,[]);class Sa extends w.a{constructor(){super()}get Lp(){return 19}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.qGa),1);kb.W(u.a.Db(f.a.SVa),2);kb.W(u.a.Db(f.a.Oma),2);kb.W(u.a.Db(f.a.m9),1);return kb}HF(kb,Ob){const nc=kb.xf;if(Ob===u.a.Db(f.a.qGa)){var zc=nc.getPropertyObjectIds(kb.Ah.value.yx,f.a.qGa),Pb=nc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.qGa),tb=nc.getPropertyObjectIds(kb.np.value.Xf,f.a.qGa);if((zc=this.JTn(zc,Pb,tb,(ib,
Rb)=>ib.equals(Rb),ib=>{let Rb;({value:Rb}=kb.kv.runtime.Pw.Nc(ib)).returnValue?kb.kv.runtime.ks.W(ib,new E.a(Rb,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},kb.kv))&&0<zc.length)return nc.setPropertyObjectIds(kb.Fm,f.a.qGa,zc),kb.mh.add(u.a.Db(f.a.qGa)),!0}if(Ob===u.a.Db(f.a.m9))return zc=nc.getPropertyObjectIds(kb.Ah.value.yx,f.a.m9),Pb=nc.getPropertyObjectIds(kb.Ah.value.Xf,f.a.m9),tb=nc.getPropertyObjectIds(kb.np.value.Xf,
f.a.m9),zc=this.yOa(zc,Pb,tb),nc.setPropertyObjectIds(kb.Fm,f.a.m9,zc),kb.mh.add(Ob),!0;v.a.instance.fb(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}static gi(){return new Sa}static get instance(){return Sa.Ch.value}}Sa.Ch=new l.a(Sa.gi);Object(I.a)(Sa,"PageManifestNodeComplexMerge",w.a,[]);class cc extends w.a{constructor(){super()}get Lp(){return 43}Vl(){const kb=super.Vl();
kb.W(u.a.Db(f.a.Zla),0);kb.W(u.a.Db(f.a.g_b),0);kb.W(u.a.Db(f.a.xWb),0);kb.W(u.a.Db(f.a.Yua),1);kb.W(u.a.Db(f.a.sessionId),3);kb.W(u.a.Db(f.a.buildVersion),3);kb.W(u.a.Db(f.a.uEa),1);kb.W(u.a.Db(f.a.L2i),1);kb.W(u.a.Db(f.a.Tx),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(f.a.uEa)||Ob===u.a.Db(f.a.L2i)||Ob===u.a.Db(f.a.Tx)){var nc=kb.np.value.Xf,zc=kb.Ah.value.Xf,Pb=u.a.q1(Ob);zc=kb.xf.getPropertyBool(zc,Pb);nc=kb.xf.getPropertyBool(nc,Pb);kb.xf.setPropertyBool(kb.Fm,Pb,null==zc?!1:zc&&null==nc?!1:nc);kb.mh.add(Ob);
return!0}if(Ob===u.a.Db(f.a.Yua)){Ob=kb.xf;nc=kb.Ah.value.yx;zc=kb.np.value.Xf;Pb=kb.Ah.value.Xf;nc=nc?Ob.getPropertyObjectId(nc,f.a.Yua):null;zc=zc?Ob.getPropertyObjectId(zc,f.a.Yua):null;Pb=Pb?Ob.getPropertyObjectId(Pb,f.a.Yua):null;v.a.instance.fb(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",nc?nc.toString():"NULL",zc?zc.toString():"NULL",Pb?Pb.toString():"NULL");if(zc){if(Pb&&zc.equals(Pb))return kb.mh.add(u.a.Db(f.a.Yua)),Ob.setPropertyObjectId(kb.Fm,
f.a.Yua,zc),!0;if(ja.a.xce.equals(zc))return kb.mh.add(u.a.Db(f.a.Yua)),Ob.setPropertyObjectId(kb.Fm,f.a.Yua,ja.a.xce),!0}if(Pb&&ja.a.xce.equals(Pb))return kb.mh.add(u.a.Db(f.a.Yua)),Ob.setPropertyObjectId(kb.Fm,f.a.Yua,ja.a.xce),!0;v.a.instance.fb(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",nc?nc.toString():"NULL",zc?zc.toString():"NULL",Pb?Pb.toString():"NULL")}return!1}static gi(){return new cc}static get instance(){return cc.Ch.value}}cc.Ch=new l.a(cc.gi);
Object(I.a)(cc,"PageMetadataNodeComplexMerge",w.a,[]);var Cb=e(1795),Wa=e(156);class Ja extends w.a{constructor(){super()}get Lp(){return 31}Vl(){const kb=super.Vl();kb.W(u.a.Db(Wa.a.dE),1);kb.W(u.a.Db(f.a.listID),3);kb.W(u.a.Db(f.a.listLevel),1);kb.W(u.a.Db(f.a.mf),3);kb.W(u.a.Db(f.a.hgc),3);kb.W(u.a.Db(f.a.runId),3);kb.W(u.a.Db(f.a.g5d),3);kb.W(u.a.Db(x.a.fontColor),3);kb.W(u.a.Db(f.a.eai),3);kb.W(u.a.Db(f.a.qd),1);kb.W(u.a.Db(Wa.a.Hge),3);kb.W(u.a.Db(Wa.a.U5f),3);kb.W(u.a.Db(Wa.a.Mbd),3);kb.W(u.a.Db(f.a.uim),
3);kb.W(u.a.Db(sb.a.yak),3);for(let Ob=0;Ob<Ja.udb.length;Ob++)kb.W(Ja.udb[Ob],1);return kb}HF(kb,Ob){var nc=kb.xf;const zc=kb.Fm;u.a.q1(Ob);if(Ob===u.a.Db(f.a.qd)){nc=kb.xf.getPropertyInt32(kb.np.value.Xf,f.a.qd);if(null==nc||!nc)return!0;kb.xf.setPropertyInt32(zc,f.a.qd,nc);kb.mh.add(Ob);return!0}if(Ob===u.a.Db(Wa.a.dE)){const Pb=nc.getPropertyUint32(kb.Ah.value.Xf,Wa.a.dE),tb=nc.getPropertyUint32(kb.np.value.Xf,Wa.a.dE);if(null!=Pb&&null!=tb&&Pb===tb)return nc.setPropertyUint32(zc,Wa.a.dE,Pb),
kb.mh.add(Ob),!0;if(null==Pb&&null==tb)return zc.removeProperty(Wa.a.dE),kb.mh.add(u.a.Db(Wa.a.dE)),!0;if(null!=Pb&&null==tb)return nc.setPropertyUint32(zc,Wa.a.dE,Pb),kb.mh.add(Ob),!0;if(null==Pb&&null!=tb)return nc.setPropertyUint32(zc,Wa.a.dE,tb),kb.mh.add(Ob),!0}else{if(Ob===u.a.Db(f.a.listLevel))return this.fyp(nc,kb);if(Array.contains(Ja.udb,Ob))return this.eyp(kb)}return!1}eyp(kb){let Ob=!0,nc=!0,zc,Pb;({tqn:Ob,Enn:nc,wbm:zc,LEl:Pb}=this.mvl(kb));v.a.instance.fb(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
kb.Ah.value.Xf.id.toString(),Ob,nc);return Ob&&!nc?(this.ckj(Pb,kb),!0):Ob?!1:(this.ckj(zc,kb),!0)}mvl(kb){let Ob,nc,zc,Pb;const tb=kb.np.value;let ib;const Rb=kb.Ah.value;let gc;nc=Ob=!0;zc=new G.a;Pb=new G.a;for(let xc=0;xc<Ja.udb.length;xc++){const Nc=Ja.udb[xc],Kc=({value:ib}=tb.xFa.Nc(Nc)).returnValue;({value:gc}=Rb.xFa.Nc(Nc)).returnValue&&(Ob=this.x9j(kb.Ah,zc,gc,Nc)&&Ob);Kc&&(nc=this.x9j(kb.np,Pb,ib,Nc)&&nc)}return{tqn:Ob,Enn:nc,wbm:zc,LEl:Pb}}x9j(kb,Ob,nc,zc){const Pb=u.a.q1(zc);kb=kb.value.Xf;
Ob.W(zc,kb.hasProperty(Pb)?kb.nG(Pb):null);return!nc.j5}ckj(kb,Ob){const nc=Ob.Fm;for(let Pb=0;Pb<Ja.udb.length;Pb++){var zc=Ja.udb[Pb];const tb=u.a.q1(zc);(zc=kb.K(zc))?nc.Agb(tb,zc):nc.removeProperty(tb)}for(kb=0;kb<Ja.udb.length;kb++)Ob.mh.add(Ja.udb[kb]);v.a.instance.fb(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Ob.Ah.value.Xf.id.toString())}fyp(kb,Ob){const nc=Ob.Fm,zc=kb.getPropertyInt32(Ob.Ah.value.Xf,f.a.listLevel),Pb=kb.getPropertyInt32(Ob.np.value.Xf,
f.a.listLevel);return null!=zc&&null!=Pb&&zc===Pb?(kb.setPropertyInt32(nc,f.a.listLevel,zc),Ob.mh.add(u.a.Db(f.a.listLevel)),!0):null==zc&&null==Pb?(nc.removeProperty(f.a.listLevel),Ob.mh.add(u.a.Db(f.a.listLevel)),!0):null!=zc&&null==Pb?(kb.setPropertyInt32(nc,f.a.listLevel,zc),Ob.mh.add(u.a.Db(f.a.listLevel)),!0):null==zc&&null!=Pb?(kb.setPropertyInt32(nc,f.a.listLevel,Pb),Ob.mh.add(u.a.Db(f.a.listLevel)),!0):!1}static gi(){return new Ja}static get instance(){return Ja.Ch.value}}Ja.Ch=new l.a(Ja.gi);
Ja.udb=[u.a.Db(f.a.ve),u.a.Db(f.a.lv),u.a.Db(x.a.O9),u.a.Db(f.a.oia),u.a.Db(f.a.Qy),u.a.Db(f.a.Cu),u.a.Db(x.a.uW),u.a.Db(f.a.rnf),u.a.Db(x.a.font),u.a.Db(sb.a.lxb),u.a.Db(a.a.uA)];Object(I.a)(Ja,"PersistablePropertySetComplexMerge",w.a,[]);class Va extends w.a{constructor(){super()}get Lp(){return 21}get MD(){return 0}static gi(){return new Va}static get instance(){return Va.Ch.value}}Va.Ch=new l.a(Va.gi);Object(I.a)(Va,"RevisionMetadataNodeComplexMerge",w.a,[]);class mb extends w.a{constructor(){super()}get Lp(){return 48}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.Aue),3);return kb}static gi(){return new mb}static get instance(){return mb.Ch.value}}mb.Ch=new l.a(mb.gi);Object(I.a)(mb,"ShadowNumberListNodeComplexMerge",w.a,[]);class Ab extends w.a{constructor(){super()}get Lp(){return 22}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.r_a),7);kb.W(u.a.Db(f.a.ucd),2);return kb}static gi(){return new Ab}static get instance(){return Ab.Ch.value}}Ab.Ch=new l.a(Ab.gi);Object(I.a)(Ab,"SharedPersistablePropertySetComplexMerge",w.a,[]);class Xb extends w.a{constructor(){super()}get Lp(){return 38}get MD(){return 3}static gi(){return new Xb}static get instance(){return Xb.Ch.value}}
Xb.Ch=new l.a(Xb.gi);Object(I.a)(Xb,"StylePropertySetComplexMerge",w.a,[]);class Lb extends w.a{constructor(){super()}get Lp(){return 23}get MD(){return 0}Vl(){const kb=super.Vl();kb.W(u.a.Db(x.a.Fg),4);kb.W(u.a.Db(f.a.rowSpan),1);kb.W(u.a.Db(f.a.colSpan),1);kb.W(u.a.Db(f.a.ghostCell),1);kb.W(u.a.Db(ka.a.vMerge),1);kb.W(u.a.Db(ka.a.gridSpan),1);kb.W(u.a.Db(f.a.Ghb),2);kb.W(u.a.Db(f.a.yCb),2);kb.W(u.a.Db(f.a.NQa),2);return kb}sEa(kb){if(!kb)return v.a.instance.fb(540120285,1,2,"Feature helper is null"),
!1;kb.bJ(99);return kb.isFeatureEnabled(99)}HF(kb,Ob){kb.kv.runtime.IK("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+Ob);let nc=Ob===u.a.Db(f.a.rowSpan)||Ob===u.a.Db(f.a.colSpan)||Ob===u.a.Db(f.a.ghostCell);this.sEa(kb.kv.runtime.Dc)&&(nc=nc||Ob===u.a.Db(ka.a.vMerge)||Ob===u.a.Db(ka.a.gridSpan));return!nc}static gi(){return new Lb}static get instance(){return Lb.Ch.value}}Lb.Ch=new l.a(Lb.gi);Object(I.a)(Lb,"TableCellNodeComplexMerge",w.a,[]);var dc=e(1737);class yc extends w.a{constructor(){super()}get Lp(){return 24}get MD(){return 0}Vl(){const kb=
super.Vl();kb.W(u.a.Db(x.a.Fg),1);kb.W(u.a.Db(x.a.Nja),1);kb.W(u.a.Db(x.a.hya),1);kb.W(u.a.Db(f.a.SBc),1);kb.W(u.a.Db(f.a.Dea),1);kb.W(u.a.Db(f.a.Ghb),2);kb.W(u.a.Db(f.a.yCb),2);kb.W(u.a.Db(f.a.NQa),2);return kb}HF(kb,Ob){kb.kv.runtime.IK("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Ob);if(Ob===u.a.Db(x.a.Fg)||Ob===u.a.Db(x.a.Nja)||Ob===u.a.Db(f.a.SBc)||Ob===u.a.Db(f.a.Dea)||Ob===u.a.Db(x.a.hya)){const zc=kb.Fm,Pb=kb.xf;v.a.instance.fb(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
zc.id,zc.yc,Ob);if(this.C1l(kb))return!1;var nc=Pb.getPropertyObjectIds(kb.Ah.value.yx,x.a.Fg);const tb=Pb.getPropertyObjectIds(kb.Ah.value.Xf,x.a.Fg),ib=Pb.getPropertyObjectIds(kb.np.value.Xf,x.a.Fg);nc=this.pjj(nc,tb,ib,(Rb,gc)=>Rb.equals(gc));if(0<nc.length)return Pb.setPropertyObjectIds(zc,x.a.Fg,nc),Pb.setPropertyInt32(zc,x.a.hya,nc.length),kb.mh.add(u.a.Db(x.a.Fg)),kb.mh.add(u.a.Db(x.a.Nja)),kb.mh.add(u.a.Db(x.a.hya)),kb.mh.add(u.a.Db(f.a.SBc)),kb.mh.add(u.a.Db(f.a.Dea)),!0}v.a.instance.fb(4018189,
1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}C1l(kb){const Ob=kb.np.value,nc=kb.Ah.value;let zc,Pb;({value:zc}=Ob.xFa.Nc(u.a.Db(x.a.Nja)));({value:Pb}=nc.xFa.Nc(u.a.Db(x.a.Nja)));return zc.j5||Pb.j5?zc.j5&&Pb.j5?(v.a.instance.fb(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",zc.oldValue,Pb.newValue,zc.newValue),
kb.kv.logger.mj(Object.assign(new dc.a,{Dk:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):yc.Uli(kb.kv,zc,nc,"BaseConflict")||yc.Uli(kb.kv,Pb,Ob,"BaseFavored")?!0:!1:!1}static gi(){return new yc}static get instance(){return yc.Ch.value}static Uli(kb,Ob,nc,zc){return Ob.j5&&({value:Ob}=nc.xFa.Nc(u.a.Db(x.a.Fg)),Ob.j5)?(v.a.instance.fb(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",zc),kb.logger.mj(Object.assign(new dc.a,
{Dk:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}yc.Ch=new l.a(yc.gi);Object(I.a)(yc,"TableNodeComplexMerge",w.a,[]);class Wc extends w.a{constructor(){super()}get Lp(){return 25}get MD(){return 0}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.qd),3);kb.W(u.a.Db(x.a.Fg),4);kb.W(u.a.Db(f.a.Ghb),2);kb.W(u.a.Db(f.a.yCb),2);kb.W(u.a.Db(f.a.NQa),2);kb.W(u.a.Db(ka.a.TKg),2);kb.W(u.a.Db(ka.a.SKg),2);return kb}static gi(){return new Wc}static get instance(){return Wc.Ch.value}}Wc.Ch=new l.a(Wc.gi);Object(I.a)(Wc,
"TableRowNodeComplexMerge",w.a,[]);class zb extends w.a{constructor(){super()}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.tqp),2);kb.W(u.a.Db(x.a.Fg),1);return kb}HF(kb,Ob){if(Ob===u.a.Db(x.a.Fg)){const zc=kb.Fm,Pb=kb.xf;v.a.instance.fb(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,zc.yc,Ob);var nc=Pb.getPropertyObjectIds(kb.Ah.value.yx,x.a.Fg);const tb=Pb.getPropertyObjectIds(kb.Ah.value.Xf,x.a.Fg),ib=Pb.getPropertyObjectIds(kb.np.value.Xf,
x.a.Fg);if(nc=this.UTn(nc,tb,ib))return 0<nc.length?Pb.setPropertyObjectIds(zc,x.a.Fg,nc):zc.removeProperty(x.a.Fg),kb.mh.add(u.a.Db(x.a.Fg)),!0}v.a.instance.fb(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob);return!1}UTn(kb,Ob,nc){const zc=new G.a(0);kb.forEach(tb=>{zc.W(tb,0);return!0});Ob.forEach(tb=>{zc.Bb(tb)?zc.W(tb,1):zc.W(tb,3);return!0});nc.forEach(tb=>{let ib;({value:ib}=zc.Nc(tb)).returnValue?
1===ib?zc.W(tb,5):3===ib?(v.a.instance.fb(42754253,1,2,"TaskNode was found added by both sides of merge"),zc.W(tb,3)):zc.W(tb,2):zc.W(tb,4);return!0});const Pb=new U.a;zc.forEach((tb,ib)=>{0!==ib&&2!==ib&&1!==ib&&Pb.add(tb);return!0});return Pb}static gi(){return new zb}static get instance(){return zb.Ch.value}}zb.Ch=new l.a(zb.gi);Object(I.a)(zb,"TaskContentNodeComplexMerge",w.a,[]);class cd{equals(kb,Ob){return kb&&Ob?kb.UserId===Ob.UserId&&kb.Provider===Ob.Provider&&kb.DisplayName===Ob.DisplayName&&
kb.Email===Ob.Email:!kb&&!Ob}cP(){return 0}}Object(I.a)(cd,"CommentTaskPersonComparer",null,[14]);class qc{equals(kb,Ob){return kb&&Ob?kb.startDate?kb.endDate?kb.startDate.getTime()===Ob.startDate.getTime()&&kb.endDate.getTime()===Ob.endDate.getTime():!Ob.endDate:!Ob.startDate:!kb&&!Ob}cP(){return 0}}Object(I.a)(qc,"CommentTaskScheduleEqualityComparer",null,[14]);class Dc{equals(kb,Ob){if(!kb||!Ob)return!kb&&!Ob;if(!kb.extensions&&!Ob.extensions)return!0;if(!kb.extensions||!Ob.extensions||kb.extensions.count!==
Ob.extensions.count)return!1;let nc=!0;kb.extensions.forEach((zc,Pb)=>{let tb;return({value:tb}=Ob.extensions.Nc(zc)).returnValue&&Pb===tb?!0:nc=!1});return nc}cP(){return 0}}Object(I.a)(Dc,"ExtensionListEqualityComparer",null,[14]);class mc{b9l(kb,Ob){return kb&&Ob?kb.recordId===Ob.recordId&&mc.ohh.equals(kb.user,Ob.user)&&mc.ohh.equals(kb.assignee,Ob.assignee)&&kb.type===Ob.type&&kb.title===Ob.title&&kb.priority===Ob.priority&&kb.isLossy===Ob.isLossy&&kb.completion===Ob.completion&&kb.commentId===
Ob.commentId&&kb.time===Ob.time&&mc.dxk.equals(kb.schedule,Ob.schedule):!kb&&!Ob}equals(kb,Ob){return this.b9l(kb,Ob)}cP(){return 0}}mc.ohh=new cd;mc.dxk=new qc;new Dc;Object(I.a)(mc,"HistoryRecordEqualityComparer",null,[14]);var lc=e(2155),Vb=e(1481);class yb extends w.a{constructor(kb){super();this.fVa=kb}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.X3b),5);kb.W(u.a.Db(f.a.taskId),2);kb.W(u.a.Db(f.a.dqp),2);kb.W(u.a.Db(f.a.iqp),2);kb.W(u.a.Db(f.a.FGa),1);return kb}XNg(kb){if(!kb.np.value.yx&&!kb.Ah.value.yx){const Ob=
kb.Ah.value.Xf.KQ();Ob.removeProperty(f.a.FGa);const nc=kb.Ah.value.Xf,zc=kb.np.value.Xf;kb.Ah=new l.a(()=>new Vb.a(Ob,nc));kb.np=new l.a(()=>new Vb.a(Ob,zc))}return super.XNg(kb)}HF(kb,Ob){if(Ob!==u.a.Db(f.a.FGa))return v.a.instance.fb(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",kb.Ah.value.Xf.id,Ob),!1;const nc=kb.Fm,zc=kb.xf;v.a.instance.fb(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
nc.id,nc.yc,Ob);Ob=zc.getPropertyString(kb.Ah.value.yx,f.a.FGa);const Pb=zc.getPropertyString(kb.Ah.value.Xf,f.a.FGa),tb=zc.getPropertyString(kb.np.value.Xf,f.a.FGa);Ob=this.TTn(Ob,Pb,tb);if(!Ob)return!1;0<Ob.length?zc.setPropertyString(nc,f.a.FGa,Ob):nc.removeProperty(f.a.FGa);kb.mh.add(u.a.Db(f.a.FGa));return!0}TTn(kb,Ob,nc){kb=this.fVa.cjc(kb);Ob=this.fVa.cjc(Ob);nc=this.fVa.cjc(nc);if(!yb.Y5i(kb,Ob))return v.a.instance.fb(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!yb.Y5i(kb,nc))return v.a.instance.fb(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;nc=yb.IBl(kb.length,Ob,nc);return this.fVa.TBg(nc)}static gi(){const kb=new lc.a;return new yb(kb)}static get instance(){return yb.Ch.value}static IBl(kb,Ob,nc){const zc=new U.a;for(let Pb=0;Pb<Ob.length;Pb++)zc.add(Ob.K(Pb));for(;kb<nc.length;kb++)zc.add(nc.K(kb));return zc}static Y5i(kb,Ob){const nc=kb.length;if(nc>Ob.length)return!1;for(let zc=0;zc<nc;zc++)if(!yb.AEk.equals(Ob.K(zc),
kb.K(zc)))return Ob.K(zc).recordId===kb.K(zc).recordId&&v.a.instance.fb(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}yb.Ch=new l.a(yb.gi);yb.AEk=new mc;Object(I.a)(yb,"TaskSingleNodeComplexMerge",w.a,[]);class Db extends w.a{constructor(){super()}get Lp(){return 26}Vl(){const kb=super.Vl();kb.W(u.a.Db(x.a.Fg),1);return kb}HF(kb,Ob){const nc=x.a.Fg;if(Ob===u.a.Db(nc)){Ob=kb.Fm;const Pb=kb.xf;var zc=Pb.getPropertyObjectIds(kb.Ah.value.yx,
nc);const tb=Pb.getPropertyObjectIds(kb.Ah.value.Xf,nc),ib=Pb.getPropertyObjectIds(kb.np.value.Xf,nc);zc=this.aUn(zc,tb,ib);Pb.setPropertyObjectIds(Ob,nc,zc);kb.mh.add(u.a.Db(nc));return!0}return!1}aUn(kb,Ob,nc){return this.yOa(kb,Ob,nc)}static gi(){return new Db}static get instance(){return Db.Ch.value}}Db.Ch=new l.a(Db.gi);Object(I.a)(Db,"VectorClockContainerNodeComplexMerge",w.a,[]);class $b extends w.a{constructor(){super()}get Lp(){return 27}Vl(){const kb=super.Vl();kb.W(u.a.Db(f.a.Z2),1);return kb}HF(kb,
Ob){const nc=f.a.Z2;if(Ob===u.a.Db(nc)){Ob=kb.Fm;const zc=kb.xf,Pb=zc.getPropertyUint32(kb.Ah.value.Xf,nc)||0,tb=zc.getPropertyUint32(kb.np.value.Xf,nc)||0;zc.setPropertyUint32(Ob,nc,this.pGm(Pb,tb));kb.mh.add(u.a.Db(nc));return!0}return!1}pGm(kb,Ob){return kb>Ob?kb:Ob}static gi(){return new $b}static get instance(){return $b.Ch.value}}$b.Ch=new l.a($b.gi);Object(I.a)($b,"VectorClockNodeComplexMerge",w.a,[]);class Fa extends w.a{constructor(){super()}get Lp(){return 28}get MD(){return 0}Vl(){const kb=
super.Vl();kb.W(u.a.Db(f.a.zBf),3);kb.W(u.a.Db(f.a.qd),3);kb.W(u.a.Db(f.a.qmi),5);kb.W(u.a.Db(f.a.kne),5);kb.W(u.a.Db(f.a.Axa),5);return kb}static gi(){return new Fa}static get instance(){return Fa.Ch.value}}Fa.Ch=new l.a(Fa.gi);Object(I.a)(Fa,"WordSectionNodeComplexMerge",w.a,[]);e.d(K,"a",function(){return lb});class lb{tei(kb,Ob){switch(kb.yc){case m.a.hpa:return kb.hasProperty(f.a.imageType)||kb.hasProperty(a.a.S1)?this.ar(pa.instance,Ob):this.ar(Ja.instance,Ob);case m.a.xfc:return this.ar(z.instance,
Ob);case m.a.mKa:return this.ar(y.instance,Ob);case m.a.ZMb:return this.ar(H.instance,Ob);case m.a.Bfc:return this.ar(D.instance,Ob);case m.a.SVa:return this.ar(Y.instance,Ob);case m.a.tKa:return this.ar(P.instance,Ob);case m.a.vBa:return this.ar(S.instance,Ob);case m.a.ipb:return this.ar(N.instance,Ob);case m.a.tma:return this.ar(V.instance,Ob);case m.a.vL:return this.ar(W.instance,Ob);case m.a.je:return this.ar(na.instance,Ob);case m.a.Bta:return this.ar(X.instance,Ob);case m.a.Oma:return this.ar(Ba.instance,
Ob);case m.a.bT:return this.ar(Ma.instance,Ob);case m.a.ULa:return this.ar(Ea.instance,Ob);case m.a.$ma:return this.ar(ya.instance,Ob);case m.a.rMa:return this.ar(ia.instance,Ob);case m.a.yca:return this.ar(za.instance,Ob);case m.a.h9:return this.ar(db.instance,Ob);case m.a.$Ya:return this.ar(pa.instance,Ob);case m.a.oF:return this.ar(pa.instance,Ob);case m.a.IZf:return this.ar(ua.instance,Ob);case m.a.KZf:return this.ar(Ga.instance,Ob);case m.a.Jfe:return this.ar(wa.instance,Ob);case m.a.LZf:return this.ar(xa.instance,
Ob);case m.a.MZf:return this.ar(sa.instance,Ob);case m.a.m9:return this.ar(Ka.instance,Ob);case m.a.peb:return this.ar(Ua.instance,Ob);case m.a.MZ:return this.ar(qb.instance,Ob);case m.a.hFa:return this.ar(ab.instance,Ob);case m.a.Kh:return this.ar(wb.instance,Ob);case m.a.KZb:return this.ar(cc.instance,Ob);case m.a.kFa:return this.ar(Sa.instance,Ob);case m.a.paragraphNode:return this.ar(Cb.a.instance,Ob);case m.a.Lyc:return this.ar(Va.instance,Ob);case m.a.q2a:return this.ar(Ab.instance,Ob);case m.a.JBb:return this.ar(Xb.instance,
Ob);case m.a.Bea:return this.ar(Lb.instance,Ob);case m.a.Fq:return this.ar(yc.instance,Ob);case m.a.fqa:return this.ar(Wc.instance,Ob);case m.a.z5b:return this.ar(Db.instance,Ob);case m.a.QQa:return this.ar(zb.instance,Ob);case m.a.kCc:return this.ar(yb.instance,Ob);case m.a.DJe:return this.ar($b.instance,Ob);case m.a.gka:return this.ar(Fa.instance,Ob);case m.a.RZf:return this.ar(ub.instance,Ob);case m.a.OZf:return this.ar(Na.instance,Ob);case m.a.vDa:return this.ar(Ca.instance,Ob);case m.a.csd:return this.ar(mb.instance,
Ob)}return this.ar(w.a.instance,Ob)}ar(kb,Ob){kb.Dc=Ob?Ob():null;return kb}}Object(I.a)(lb,"GraphNodeComplexMergeFactory",null,[838])},1997:function(I,K,e){I=e(0);var m=e(530),f=e(287),a=e(118),l=e(257),w=e(87),z=e(1632),x=e(1041);class u{constructor(Fa,lb,kb,Ob,nc,zc){this.groupType=Fa;this.resultType=lb;this.EJg=kb;this.Qca=Ob;this.cBf=nc;this.resultIndex=zc}}Object(I.a)(u,"ClickLoggingInfo",null,[]);const v=Fa=>{const lb=[];for(;Fa;)Array.add(lb,"{ContextId:"+Fa.contextId+", IsGraphNodeContext:"+
Fa.nm+"}"),Fa=Fa.Pk;lb.reverse();return"{"+lb.join(", ")+"}"};class E{constructor(){this.interactionId=this.sessionId=null}}Object(I.a)(E,"CorrelationRecord",null,[1969]);var y=e(1422);class H{constructor(Fa,lb){this.provider=Fa;this.Ohb=lb}}Object(I.a)(H,"ExternalResultProvider",null,[]);class D{constructor(Fa,lb){this.Id=null;this.TimeStamp=0;this.Id=Fa;this.TimeStamp=lb}}Object(I.a)(D,"MRUControl",null,[]);var G=e(1606),J=e(1390),U=e(2),F=e(1254);class T{constructor(Fa,lb){this.JKk=10;this.aba=
[];this.RIa=[];this.Zuh=this.Yuh=!1;this.JOc=this.IOc="";this.Gac=lb;this.$c=Fa}w5c(){!this.Yuh&&this.$c&&(this.IOc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.$c.application,this.aba=this.Azi(),this.Yuh=!0);return this.aba}QNm(){!this.Zuh&&this.$c&&(this.JOc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.$c.application,this.RIa=this.Azi(!0),this.Zuh=!0);return this.RIa}DAn(Fa){return Fa.startsWith("TellMeUpsell")||"OpenInClientUpsell"===Fa||"TryOfficeUpsell"===Fa}r0f(Fa){return this.Mln(Fa)||this.DAn(Fa)||
J.a.u8i(Fa)?!1:!0}h8a(Fa){Fa=Fa.ControlId;this.r0f(Fa)&&(Fa=this.iwg(Fa),this.jHo(Fa),this.aQn(),Array.insert(this.aba,0,new D(Fa,Date.now())),this.IOc.length&&(Fa=JSON.stringify(this.aba),F.a.instance.setItem(this.IOc,Fa)))}addProvider(Fa){this.$Pn();Array.insert(this.RIa,0,new D(G.a[Fa],Date.now()));this.JOc.length&&(Fa=JSON.stringify(this.RIa),F.a.instance.setItem(this.JOc,Fa))}Azi(Fa=!1){if(!this.aba.length){var lb=Fa?F.a.instance.getItem(this.JOc):F.a.instance.getItem(this.IOc);if(!lb||""===
lb)return Fa?this.RIa:this.aba;let kb=null;try{kb=JSON.parse(lb)}catch(Ob){this.Ixl(Fa),kb=null}if(!kb||!kb.length||10<kb.length)return Fa?this.RIa:this.aba;lb=0;for(const Ob of kb)if(Fa||this.$c.Ddd(Ob.Id)&&this.r0f(Ob.Id))if(Fa?Array.insert(this.RIa,lb++,Ob):Array.insert(this.aba,lb++,Ob),lb===this.Gac)break}return Fa?this.RIa:this.aba}N_d(Fa){Fa=this.iwg(Fa);for(const lb of this.aba)if(lb.Id===Fa)return!0;return!1}Ixl(Fa=!1){F.a.instance.setItem(Fa?this.JOc:this.IOc,"")}fon(Fa){Fa=this.iwg(Fa.ControlId);
return this.r0f(Fa)?this.N_d(Fa):!1}jHo(Fa){if(0<this.aba.length){let lb=0;for(const kb of this.aba){if(kb.Id===Fa){Array.removeAt(this.aba,lb);break}lb++}}}iwg(Fa){return"Excel"===this.$c.application&&Fa.startsWith("m_excelWebRenderer_ewaCtl_")?Fa.substr(26,Fa.length):Fa}aQn(){this.aba.length===this.Gac&&Array.removeAt(this.aba,this.aba.length-1)}$Pn(){this.RIa.length===this.JKk&&Array.removeAt(this.RIa,this.RIa.length-1)}Mln(Fa){Fa=Fa.split("|");let lb="";if(6<=Fa.length)lb=Fa[0];else if(3<=Fa.length){if("3"===
Fa[0])return!0;lb=Fa[1]}return lb.startsWith("WA")}static createInstance(Fa){let lb=3;U.AFrameworkApplication.J&&(lb=U.AFrameworkApplication.J.sc("TellMeMaxRecommendedResultsToReturn",3));return new T(Fa,lb)}}Object(I.a)(T,"MruControlsManager",null,[1968]);class Y{constructor(Fa){this.yJb=Fa}Kma(Fa,lb){let kb;return Fa.wG&&(kb=this.yJb[Fa.value])?kb.Kma(Fa,lb):(kb=this.yAi(Fa.value))?kb.Kma(kb.AVn,lb):null}sLm(Fa,lb){if(Fa=this.yJb[Fa])for(const kb of lb)if(lb=J.a.getParameter(kb),lb.key===Fa.hng)return lb.value;
return null}XZn(Fa){(Fa=this.yAi(Fa))&&Fa.UZn()}yAi(Fa){const lb=Fa.indexOf(J.a.mxj);return 0<lb?this.yJb[Fa.substring(0,lb)]:null}}Object(I.a)(Y,"ParameterizedCommandManager",null,[1967]);var P=e(1449);class S{constructor(Fa,lb){this.sh=Fa;this.wzb=lb}}Object(I.a)(S,"TellMeQuery",null,[]);var N=e(1603);class V{constructor(Fa,lb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Fa;this.TimeElapsedSinceClick=lb}}Object(I.a)(V,"CommandClickedEvent",null,[]);var Z=e(1376);class ca{constructor(Fa,lb){this.gNk=
Fa;this.rRc=lb}mv(Fa){this.gNk(Z.c(Fa.query)?"":Fa.query.sh,Fa.pq,Fa.attributes,this.rRc,Fa.nrc)}}Object(I.a)(ca,"ResultsUpdatedCallback",null,[1966]);class W{constructor(Fa,lb,kb,Ob,nc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Fa;this.TimeElapsedSinceClick=kb;this.CommandSurface=Ob;this.CommandId=lb;this.TerminalParentControlId=nc}}Object(I.a)(W,"UserActionEvent",null,[]);var X=e(76);class ka{constructor(Fa,
lb){this.menuModel=Fa;this.PMj=lb}}Object(I.a)(ka,"GeneratedMenuModel",null,[]);var ma=e(654);class ja{constructor(Fa,lb,kb){this.$c=Fa;this.yJb=lb;this.Ela=kb}Hlm(Fa,lb,kb){const {TellMeActorConstants:Ob}=e(1389);let nc=0;const zc=new ma.a,Pb=[];let tb="";zc.sections=[];let ib=new X.a;const Rb=!!this.$c&&this.$c.edb;var gc=!!this.$c&&this.$c.jBb||U.AFrameworkApplication.ta.Pb.jBb;for(const Nc of Fa){Fa=0;Rb||(ib=new X.a);const Kc=new X.a;let fd=Nc.displayName;for(const jd of Nc.results){if(0<=jd.value.indexOf(J.a.HHg)){if(jd.wG){var xc=
this.yJb[jd.value];if(xc&&jd.value.endsWith(J.a.HHg)){if("FindParameterized"!==jd.value&&!gc){const Id=[];Id.push(appChrome.actions.setControlLabel(jd.value,xc.z$d(jd)));Id.push(appChrome.actions.setButtonCommandValueId(jd.value,xc.fLf(jd)));appChrome.api.dispatch(Id)}xc=jd.value.replace(J.a.HHg,"");ib.remove(xc)?Fa--:Kc.add(xc);ib.add(jd.value);Fa++}}}else switch(jd.type){case 5:Kc.contains(jd.value)||(ib.add(jd.value),Fa++);break;case 7:ib.add(jd.wG);Fa++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:ib.add(jd.value),
Fa++}13===Nc.groupType&&(fd=J.a.Mva()?0<lb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,lb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,lb));21===Nc.groupType&&(fd=CommonUIStrings.l_LearningUILiveText)}nc+=Fa;""!==fd&&0<Fa&&(tb+=" , "+Fa.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+fd+" , ");0<ib.count&&!Rb&&(Fa=appChrome.api.menuSection(ib.toArray(),Nc.displayName,null,P.a[Nc.groupType]),Pb.push(Fa))}gc=
null;0<nc&&(gc=0<lb.length?1!==nc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,nc,lb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,lb):1!==nc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,nc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Rb?(lb=appChrome.api.menuSection(ib.toArray(),"",null,null),Pb.push(lb)):gc+=tb);kb&&(this.$c.zDa?Ob.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(gc)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(gc)));zc.sections=Pb;return new ka(zc,nc,[])}static get hDf(){return ja.Olh||(ja.Olh=new ka(Object.assign(new ma.a,{sections:[]}),0,[]))}}ja.Olh=null;Object(I.a)(ja,"TellMeMenuDefintionGenerator",null,[]);var na;(function(Fa){Fa[Fa.EYp=0]="TellMeControlActivated";Fa[Fa.GYp=1]="TellMeQueryExecuted";Fa[Fa.IYp=2]="TellMeResultsRendered";Fa[Fa.FYp=3]="TellMeControlDeactivated"})(na||(na={}));Object(I.b)("PerformanceMarker",na);var Ba;
(function(Fa){Fa[Fa.KYp=0]="TellMeTimeToRender";Fa[Fa.JYp=1]="TellMeSessionLength";Fa[Fa.HYp=2]="TellMeResultTriageTime"})(Ba||(Ba={}));Object(I.b)("PerformanceMeasure",Ba);class Ma{mark(Fa){window.performance.mark(na[Fa])}measure(Fa,lb,kb){const {TellMeActorConstants:Ob}=e(1389);try{window.performance.measure(Ba[Fa],na[lb],na[kb])}catch(nc){Ob.instance.gk().onError("TellMePerformance:Measure","error measuring "+Ba[Fa])}}X9f(Fa,lb,kb){const {TellMeActorConstants:Ob}=e(1389);Ob.instance.gk().f$f(lb,
kb,Fa,this.rGm(Fa))}jyl(){var Fa=[0,1,2,3];for(const lb of Fa)window.performance.clearMarks(na[lb])}clearMeasures(Fa){for(const lb of Fa)window.performance.clearMeasures(Ba[lb])}rGm(Fa){let lb=0;(Fa=this.vnm(Fa))&&0<Fa.length&&(lb=Fa[Fa.length-1].duration);return lb}vnm(Fa){return window.performance.getEntriesByName(Ba[Fa],"measure")}}Object(I.a)(Ma,"TellMePerformance",null,[]);var Ea=e(1497),ya=e(1496),ia=e(29);class za{constructor(Fa){this.hWk=Fa}bjd(Fa,lb,kb){const {TellMeActorConstants:Ob}=e(1389);
Ob.instance.gk().U9(lb,ya.a.kxc,Fa.data.Xe.toString(),Math.round(window.performance.now()-kb),ya.a.kxc,!0,Ea.a.VYa);Fa=ia.b(Fa.data.responseData);lb=-1;Fa.Index&&(lb=Fa.Index);Ob.instance.gk().kNn(lb,this.hWk)}eid(Fa,lb,kb){const {TellMeActorConstants:Ob}=e(1389);Ob.instance.gk().U9(lb,ya.a.kxc,Fa.data.Xe.toString(),Math.round(window.performance.now()-kb),ya.a.kxc,!1,Ea.a.VYa)}WNm(Fa){if(Fa&&""!==Fa.trim()){const kb=window.performance.now(),Ob=U.AFrameworkApplication.E5j;var lb={};lb.Text=Fa;lb.IsFileHash=
"false";lb=ia.c(lb);U.AFrameworkApplication.pe.addRequest(Ob,2,lb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,nc=>{this.bjd(nc,Fa.length,kb)},nc=>{this.eid(nc,Fa.length,kb)},null,null,!1,4E3,6E3)}}}Object(I.a)(za,"TellMeQueryIndexCallback",null,[]);var Ca=e(1394);class db{constructor(Fa,lb,kb){this.xml=Fa;this.PMj=lb;this.b1l=kb}}Object(I.a)(db,"GeneratedMenuXml",null,[]);var pa=e(1739),ua=e(16);class Ga{constructor(Fa,lb){this.$Bd=Fa||{};this.B6a=lb}get f1b(){return 5}Kma(Fa,
lb=null){return this.B6a.Kma(Fa,lb)||this.oml(Fa.value)}oml(Fa){return Ga.ipf(Fa,this.$Bd[Fa]||null)}static ipf(Fa,lb=null){Fa=String.format('<ClonedControl Id="{0}" ',Fa);for(const nc in lb){var kb=nc,Ob=lb[nc];Ob=Ob?ua.a.Mf(Ob.toString()):"";Fa+=String.format('{0}="{1}" ',kb,Ob)}return Fa+"/>"}}Object(I.a)(Ga,"CommandMenuItemFactory",null,[1964]);var wa=e(236);class xa{constructor(){this.HBk=CommonUIStrings.l_FindInDocumentText}get f1b(){return 8}Kma(Fa){var lb=Fa.wG;Fa=ua.a.Mf(Fa.value);const kb=
ua.a.Mf(lb);lb=ua.a.Mf(String.format(this.HBk,lb));return this.Zkm(Fa,kb,lb)}Zkm(Fa,lb,kb){return wa.a(Fa,"1540292897",kb,J.a.rem,null,lb,kb,null,null)}}Object(I.a)(xa,"FindInDocumentMenuItemFactory",null,[1964]);var sa=e(1740),Ka=e(1741);class Na{constructor(Fa=null){this.RFk=Fa||CommonUIStrings.l_InsightsButtonText}get f1b(){return 10}Kma(Fa){var lb=Fa.wG;Fa=J.a.Mva()?J.a.MWa(lb,1):J.a.xPb(lb);lb=String.format(this.RFk,lb);return this.hlm(Fa,lb)}hlm(Fa,lb){return wa.a(Ka.a.sYi,J.a.Mva()?"1914896509":
"3317204163",ua.a.Mf(lb),J.a.EZf,null,ua.a.Mf(Fa),ua.a.Mf(lb),null,null)}}Object(I.a)(Na,"InsightsMenuItemFactory",null,[1964]);var ub=e(1742);class Ua{get f1b(){return 7}Kma(Fa){const lb=Object(w.a)(N.a,Fa);return this.Olm(ua.a.Mf(Fa.value),lb.id)}Olm(Fa,lb){return wa.a(lb,"1404166600",Fa,null,null,Fa,Fa,null,null)}}Object(I.a)(Ua,"TryQueryMenuItemFactory",null,[1964]);class sb{constructor(Fa){this.VU=[];this.$c=Fa}wym(Fa){for(const lb of this.VU)if(lb.f1b===Fa)return lb;return null}ja(Fa){this.VU.push(Fa)}fBo(Fa){this.ja(new Ga(this.$c.aHl,
Fa));this.ja(new ub.a(this.$c.HYn));this.ja(new pa.a(this.$c.FUo,this.$c.EUo,this.$c.crp,this.$c.C6m,this.$c.S$o));this.ja(new Na);this.ja(new xa);this.ja(new sa.a);this.ja(new Ua)}}Object(I.a)(sb,"MenuItemFactoryRegistry",null,[]);var qb=e(1396);class ab{constructor(Fa,lb){this.$c=Fa;this.gAh=new sb(this.$c);this.gAh.fBo(lb)}Ilm(Fa,lb){let kb=0;const Ob=[],nc=[];for(const Pb of Fa){Fa=J.a.vLg;var zc=[];for(const tb of Pb.results){const ib=this.gAh.wym(tb.type).Kma(tb,lb);Fa=J.a.vLg;zc.push(ib);if(13===
tb.type||14===tb.type)Fa="Menu32";17===tb.type&&(Fa="MenuTellMeExtended");tb.groupType=Pb.groupType;nc.push(Object(w.a)(qb.a,tb))}kb=kb?kb:zc.length;zc=wa.d("TellMeDropdownControls",zc);Fa=wa.g("TellMeDropdownMenuSection",zc,Fa,Pb.displayName);Ob.push(Fa)}lb=wa.h(Ob,"LookupDropdownMenu");return new db(lb,kb,nc)}static get s4d(){return ab.Plh||(ab.Plh=new db(wa.h([],"LookupDropdownMenu"),0,[]))}}ab.Plh=null;Object(I.a)(ab,"TellMeXmlGenerator",null,[]);class Xa{}Xa.yWn="MRU";Xa.test="Test";Object(I.a)(Xa,
"ActionType",null,[]);var wb=e(1477),Sa;(function(Fa){Fa[Fa.XXp=0]="Service";Fa[Fa.Local=1]="Local";Fa[Fa.oWp=2]="MRU";Fa[Fa.Tpk=3]="TestResult";Fa[Fa.Unknown=4]="Unknown"})(Sa||(Sa={}));Object(I.b)("SubResultType",Sa);var cc=e(84);class Cb{constructor(Fa,lb,kb,Ob,nc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Fa;this.IsEnabled=lb;this.ResultType=G.a[kb];this.SubResultType=Sa[Ob];this.OptionalData=nc?cc.a.toJSON(nc):null}}Object(I.a)(Cb,
"ResultInfo",null,[]);var Wa=e(129),Ja=e(192),Va=e(306);class mb{constructor(Fa,lb=null){this.jHd="TellMeWAC.";this.JOk=Fa;this.lXk=lb}fQa(Fa,lb,kb){lb=Wa.a.iG(lb);Fa=Wa.a.rxf(Fa,this.JOk,this.lXk,kb,lb);Ja.a.fQa(Fa,this.jHd)}eQa(Fa,lb,kb=0){lb=Wa.a.iG(lb);Ja.a.eQa(Object.assign(new Va.a,{name:Fa,dataFields:lb,durationMs:kb}),this.jHd)}}Object(I.a)(mb,"TellMeOtelLogger",null,[1978]);var Ab=e(127);class Xb{constructor(Fa,lb,kb,Ob,nc,zc,Pb){this.dba=this.Rfa=this.fhh=null;this.YH=Fa;this.Mjb=lb;this.GUa=
kb;this.vlb=Ob;this.O5a=nc;this.vIk=zc;this.dba=Pb?Pb:new mb(this.vlb?x.a.GHg:x.a.RFe)}get $t(){return this.vlb}get axa(){return this.GUa}FBe(Fa){this.fhh=Fa;switch(Fa){case Ca.a.contextMenu:this.Rfa=Ca.a.contextMenu;break;default:this.Rfa=Ca.a.Pv}}Zil(Fa,lb){this.GUa.interactionId||(this.GUa.interactionId=Ab.a.create().toString(),this.nej(Fa,!0,lb))}Toi(Fa,lb=!0){this.GUa.interactionId&&this.UKn(Fa,lb);this.vlb&&appChrome.api.updateTellMeCorrelationId("");this.GUa.interactionId=null}nej(Fa,lb,kb){const {TellMeActorConstants:Ob}=
e(1389),nc=this.ica(y.a.icb);nc[wb.a.culture]=this.Mjb;nc[wb.a.appName]=this.YH;nc[wb.a.context]=Fa;nc[wb.a.dje]=this.O5a;nc[wb.a.BAn]=this.vIk;nc[wb.a.lzn]=kb;nc[wb.a.Psn]=lb;nc[wb.a.contentType]=Ob.instance.a0c;this.dba.fQa(y.a.icb,nc,this.fhh);this.vlb&&appChrome.api.updateTellMeCorrelationId(this.GUa.interactionId)}UKn(Fa,lb){const kb=this.ica(y.a.nVb);kb[wb.a.s4l]=Fa;kb[wb.a.Osn]=lb;this.dba.eQa(y.a.nVb,kb)}jNn(Fa,lb,kb){let Ob=0;!kb&&0<Fa.length&&(Ob=Fa.trim().split(" ").length);const nc=this.ica(y.a.query);
nc[wb.a.query]="!";nc[wb.a.R_b]=lb;nc[wb.a.eDj]=Fa.length;nc[wb.a.R9i]=kb;nc[wb.a.aSp]=Ob;this.dba.fQa(y.a.query,nc,this.Rfa)}lMn(Fa,lb,kb,Ob,nc,zc,Pb,tb=null){const ib=this.ica(y.a.latency);ib[wb.a.culture]=this.Mjb;ib[wb.a.eDj]=Fa;ib[wb.a.C$j]=lb;ib[wb.a.statusCode]=kb;ib[wb.a.service]=nc;ib[wb.a.isSuccess]=zc;ib[wb.a.ZEn]=Pb;tb&&(ib[wb.a.Ptp]=tb);this.dba.eQa(y.a.latency,ib,Ob)}f$f(Fa,lb,kb,Ob){const nc=this.ica(y.a.performance);nc[wb.a.culture]=this.Mjb;nc[wb.a.cjl]=na[Fa];nc[wb.a.P6l]=na[lb];
nc[wb.a.sio]=Ba[kb];this.dba.eQa(y.a.performance,nc,Ob)}sNn(Fa,lb){var {TellMeActorConstants:kb}=e(1389);const {CommandResultsUtilityHelper:Ob}=e(1478);if(Fa.results.length){var nc=this.ica(y.a.CKj);nc[wb.a.Qca]=lb.toString();nc[wb.a.groupType]=P.a[Fa.groupType];16===Fa.groupType&&(nc[wb.a.Iyn]=kb.instance.hib);lb=[];kb=[];var zc=[];for(const Pb of Fa.results)nc[wb.a.resultType]||(nc[wb.a.resultType]=G.a[Pb.type]),Fa={},27===Pb.type&&(Fa.AssetId=Pb.additionalInfo),kb.push(Ob.Dvb(Pb.value)),lb.push(Pb.value),
zc.push(new Cb(Pb.value,Ob.Dvb(Pb.value),Pb.type,Pb.subType,Fa));0<lb.length&&(nc[wb.a.wPo]="{"+lb.join(", ")+"}",nc[wb.a.o6l]="{"+kb.join(", ")+"}",nc[wb.a.rPo]=ia.c(zc));this.dba.fQa(y.a.CKj,nc,this.Rfa)}}umm(Fa,lb){if(4===Fa)return Xa.yWn;switch(lb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[lb]}yKn(Fa,lb,kb,Ob,nc){const zc=this.ica(y.a.click);zc[wb.a.C$j]=Fa;zc[wb.a.pgo]=lb;zc[wb.a.commandId]=
kb;zc[wb.a.r8]=Ob;zc[wb.a.actionType]=this.umm(nc.groupType,nc.resultType);zc[wb.a.resultType]=G.a[nc.resultType];zc[wb.a.EJg]=Sa[nc.EJg];zc[wb.a.groupType]=P.a[nc.groupType];zc[wb.a.Qca]=nc.Qca.toString();zc[wb.a.cBf]=nc.cBf.toString();zc[wb.a.resultIndex]=nc.resultIndex.toString();this.dba.fQa(y.a.click,zc,this.Rfa)}EKn(Fa,lb){this.GUa.interactionId||(this.GUa.interactionId=Ab.a.create().toString(),this.nej("",!1,lb));lb=this.ica(y.a.Dbi);lb[wb.a.R_b]=Fa;this.dba.eQa(y.a.Dbi,lb)}Iej(Fa,lb,kb){if(Fa){if(kb)for(const Ob in kb)Fa[Ob]=
kb[Ob];this.dba.eQa(y.a.events,Fa,lb)}}lK(Fa,lb,kb=null){const Ob=this.ica(y.a.events);Ob[wb.a.event]=Fa;this.Iej(Ob,Math.round(lb),kb)}rda(Fa,lb,kb=null){const Ob=this.ica(y.a.events);Ob[wb.a.event]=y.a.error;Ob[wb.a.module]=Fa;Ob[wb.a.errorMessage]=lb;Ob[wb.a.message]=lb;this.Iej(Ob,Math.round(window.performance.now()),kb)}wKn(Fa){const lb=this.ica(y.a.v9h);lb[wb.a.value]=Fa;lb[wb.a.Pwe]=this.vlb;this.dba.fQa(y.a.v9h,lb,this.Rfa)}NJn(Fa){const lb=this.ica(y.a.oRh);lb[wb.a.value]=Fa;lb[wb.a.Pwe]=
this.vlb;this.dba.fQa(y.a.oRh,lb,this.Rfa)}pLn(Fa){const lb=this.ica(y.a.iti);lb[wb.a.value]=Fa;lb[wb.a.Pwe]=this.vlb;this.dba.fQa(y.a.iti,lb,this.Rfa)}hNn(Fa){const lb=this.ica(y.a.xCj);lb[wb.a.value]=Fa;lb[wb.a.Pwe]=this.vlb;this.dba.fQa(y.a.xCj,lb,this.Rfa)}aKn(Fa){const lb=this.ica(y.a.ZRj);lb[wb.a.value]=Fa;this.dba.fQa(y.a.ZRj,lb,this.Rfa)}lNn(Fa,lb){const kb=this.ica(y.a.$Cj);kb[wb.a.kxc]=Fa;lb&&(kb[wb.a.interactionId]=lb);this.dba.eQa(y.a.$Cj,kb)}ica(Fa){return{["SessionID"]:this.GUa.sessionId,
["CorrelationID"]:this.GUa.interactionId,["Time"]:(new Date).getTime(),["Event"]:Fa,["Scenario"]:this.Rfa}}}Object(I.a)(Xb,"UsageLogger",null,[1965]);var Lb=e(89),dc=e(1690),yc=e(1186),Wc=e(1456),zb=e(96),cd=e(204),qc=e(1185),Dc=e(638),mc=e(17),lc=e(552),Vb=e(98),yb=e(12),Db=e(1389);e.d(K,"a",function(){return $b});class $b{constructor(Fa=null){this.B6a=this.oc=this.za=this.VK=this.Rw=this.Sb=this.ga=this.EO=this.E3e=this.BQh=this.jsa=null;this.Ovh=this.Y$b=!1;this.J7b=null;this.FMc=this.O5a=!1;this.Ojb=
this.r8b=this.VHa=this.xNd=this.CLc=this.U3e=null;this.k$b=!1;this.M3e=0;this.h7b=null;this.iAh=0;this.NMc=!1;this.Xq=this.$s=this.skb=null;this.dispatcher=(lb,kb,Ob,nc,zc)=>{if(kb.contextId===Vb.a.frame)switch(lb){case yb.a.Pv:return this.Pv(lb,kb,Ob,nc,zc);case yb.a.uLg:return this.J2h(lb,kb,Ob,nc,zc);case yb.a.zLg:return this.Zej(lb,kb,Ob,nc,zc);case yb.a.CLg:return this.zej(lb,kb,Ob,nc,zc);case yb.a.BLg:return this.Vej(lb,kb,Ob,nc,zc);case yb.a.xLg:return this.icb(lb,kb,Ob,nc,zc);case yb.a.ELg:return this.Gye(lb,
kb,Ob,nc,zc);case yb.a.ALg:return this.Uej(lb,kb,Ob,nc,zc);case yb.a.DLg:return this.yej(lb,kb,Ob,nc,zc);case yb.a.Dud:return this.fvi(lb,kb,Ob,nc,zc);case yb.a.tLg:return this.qai(lb,kb,Ob,nc,zc);case yb.a.FLg:case yb.a.q7f:return this.zZf(lb,kb,Ob,nc,zc);case yb.a.bGf:case yb.a.cGf:case yb.a.dGf:case yb.a.eGf:case yb.a.fGf:case yb.a.vlg:case yb.a.wlg:case yb.a.xlg:case yb.a.GLg:return this.s0a(lb,kb,Ob,nc,zc);case yb.a.Ung:case yb.a.Vng:case yb.a.Wng:return this.ecb(lb,kb,Ob,nc,zc);case yb.a.wLg:return this.lvj(lb,
kb,Ob,nc,zc);case yb.a.dkf:case yb.a.ekf:case yb.a.fkf:return this.Eke(lb,kb,Ob,nc,zc);case yb.a.k3b:return this.k3b(lb,kb,Ob,nc,zc);case yb.a.Q6f:return this.saj(lb,kb,Ob,nc,zc);case yb.a.Rsg:return this.ADj(lb,kb,Ob,nc,zc);case yb.a.qJf:return this.vxi(lb,kb,Ob,nc,zc)}return 2};this.ADj=(lb,kb,Ob,nc,zc)=>{if(1===Ob)return 32;if(Z.c(zc))return $b.instance.Jn.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.oc.DHf();if(lb=zc.TerminalParentControlId){lb=this.d9a.K(lb);
if(!lb)return 16;kb=[];Array.add(kb,lb);if(!this.Iaj(kb))return 8}return 32};this.vxi=()=>{if(!this.d9a.count)return 16;const lb=[];for(const kb of this.d9a.values)Array.add(lb,kb);return this.Iaj(lb)?32:8};this.ecb=(lb,kb,Ob,nc,zc)=>{if(1===Ob)return 32;if(Z.c(zc))return $b.instance.Jn.onError("TellMeActor:InsertMention","actiondata comes null"),16;lb=zc.UILocation;let Pb;zc=zc.CommandValueId;try{Pb=ia.a(zc)}catch(tb){return $b.instance.Jn.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return Z.c(Pb)?($b.instance.Jn.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Z.c(this.CLc)?($b.instance.Jn.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==lb?($b.instance.Jn.onError("TellMeActor:InsertMention","location "+lb+" is unexpected"),16):this.CLc.ecb(Pb.displayName,Pb.email,Pb.userId)?32:($b.instance.Jn.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.s0a=(lb,kb,Ob,nc,zc)=>1===Ob?32:Z.c(zc)?($b.instance.Jn.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===zc.UILocation?this.Hin(Ob,zc):this.DZb(lb,kb,Ob,nc,zc);this.lvj=(lb,kb,Ob,nc,zc)=>{if(1===Ob)return 32;if(Z.c(zc))return $b.instance.Jn.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.$s&&window.setTimeout(()=>{this.$s.execute(Pb=>{Pb.y2a("TellMeSurvey",null)})},$b.Dbm);return 32};this.bFa=(lb,kb,Ob,nc,zc)=>{Ob=window.performance.now();this.sko(kb);$b.instance.Jn.k2o(kb);$b.instance.Xo.$t?(this.Ojb=this.E3e.Hlm(kb,lb,zc),$b.instance.Xo.zDa?($b.instance.actions.push(appChrome.actions.updateTellMeSearchResults(this.Ojb.menuModel,
lb,zc)),appChrome.api.dispatch($b.instance.actions)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Ojb.menuModel,lb,zc)),$b.instance.Xo.gJe&&this.k$b&&(Z.c($b.instance.CU)||$b.instance.CU.Location!==Ca.a.contextMenu)&&(this.EO.mark(2),this.EO.measure(0,1,2))):this.VHa=this.BQh.Ilm(kb,$b.instance.Jn.axa);this.h7b&&this.Sb.pc(this.h7b);zc={};zc.GroupsCount=kb.length;zc.QueryID=nc;zc.QueryLength=lb.length;$b.instance.Jn.hE(y.a.QPl,window.performance.now()-Ob,zc)};this.saj=(lb,
kb,Ob,nc,zc)=>{if(1===Ob)return 32;if(Z.c(zc))return $b.instance.Jn.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){lb={};lb.SourceControlId=zc.SourceControlId;lb.Query=zc.CommandValueId;zc=this.ga.Zb(yb.a.led,2,lb);if(32!==zc)$b.instance.Jn.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+zc+".");return zc}return this.ga.Zb(yb.a.led,
2,zc)};this.Eke=(lb,kb,Ob,nc,zc)=>{({AddinResultsProvider:lb}=e(1633));if(1===Ob)return 32;if(Z.c(zc))return $b.instance.Jn.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Ob=zc.CommandValueId;if(Z.b(Ob))return $b.instance.Jn.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!lb.YMb[Ob])return $b.instance.Jn.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Ob+" doesn't not exist in entitlements"),16;zc=e(1633).AddinResultsProvider.YMb[Ob];lb={};lb.solutionId=
zc.id;lb.version=zc.appVersion;lb.storeType=zc.storeType;lb.storeId=zc.storeId;lb.assetId=zc.assetId;lb.assetStoreId=zc.assetStoreId;lb.displayName=zc.displayName;lb.targetType=zc.targetType;lb.height=zc.height;lb.width=zc.width;zc=this.ga.Zb(yb.a.lZf,2,lb);if(32!==zc)$b.instance.Jn.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+zc+". AssetId: "+Ob);return zc};this.k3b=()=>{if(!Z.c(this.$s))for(const lb of z.a.instance.Lsb()){if("ShowContextMenuWithFloatie"===
lb.commandId)return this.$s.execute(kb=>{kb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(lb.commandId&&-1===lb.commandId.indexOf("Tab"))break}return 8};this.Xq=Fa?Fa:new Db.TellMeActorConstants}O8d(){return this.Xq.O8d()}cLf(){return this.Xq.cLf()}ISf(){return this.Xq.ISf()}VKf(){return this.Xq.VKf()}WKf(){return this.Xq.WKf()}get a0c(){return this.VK?this.VK.contentType:$b.unknown}GOf(){return this.Xq.Poa}gk(){return this.Xq.gk()}get actions(){return this.Xq.actions}set actions(Fa){this.Xq.actions=
Fa}Dnc(){return this.Xq.Dnc()}aP(){return this.Xq.aP()}tNf(){return this.Xq.tNf()}get Lgd(){return this.Xq.Lgd}set Nac(Fa){this.Xq.Lgd=Fa}get Dxd(){return this.Xq.Dxd}set DKd(Fa){this.Xq.Dxd=Fa}WRf(){return this.Xq.WRf()}performance(){return this.EO}get atd(){return this.Xq.n3b}set atd(Fa){this.Xq.n3b=Fa}get hib(){return this.Xq.hib}set hib(Fa){this.Xq.hib=Fa}UH(Fa){return this.Xq.UH(Fa)}initialize(Fa,lb=null,kb=null,Ob=null,nc=null,zc=null,Pb=null,tb=null,ib=null,Rb=null,gc=null){const {InteractionLogger:xc}=
e(2004),{GroupsPlacementInfo:Nc}=e(2002),{AggregatorResultsProvider:Kc}=e(1772);$b.instance.Xo=Fa;this.O5a=!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Pb.Erc;$b.instance.Jn=Ob;if(!Ob){Ob=new E;Ob.sessionId=U.AFrameworkApplication.userSessionId;const fd=lc.a.Vg(U.AFrameworkApplication.lcid)||lc.a.mad;$b.instance.Jn=new xc(new Xb($b.instance.Xo.application,fd.name,Ob,$b.instance.Xo.$t,this.O5a,Fa.W2a,null),$b.instance.Xo.eHl,$b.instance.Xo)}this.B6a=new Y($b.instance.Xo.parameterData);
this.BQh=kb||new ab($b.instance.Xo,this.B6a);$b.instance.gMe=Pb;this.E3e=this.E3e||new ja($b.instance.Xo,$b.instance.Xo.parameterData,Pb);this.oc=Lb.FocusManager.instance();this.Poa=T.createInstance($b.instance.Xo);$b.instance.Wnc=new Nc(Fa);this.ga=nc||U.AFrameworkApplication.va;this.Sb=zc||U.AFrameworkApplication.zc;this.Rw=ib;this.jsa=lb;this.$s=gc;this.EO=new Ma;this.d9a=new m.a(f.a.Oh());this.xNd=[];ib?ib.execute(fd=>{fd.isFeatureEnabled($b.Sqp,!0).then(jd=>{const {AggregatorResultsProvider:Id}=
e(1772);this.NMc=jd;this.jsa=this.jsa||Id.createInstance(this.Poa,$b.instance.Xo,this.B6a,this.NMc);for(const ce of this.xNd)this.jsa.addProvider(ce.provider,ce.Ohb);this.xNd=[];return null})}):(this.NMc=!0,this.jsa=this.jsa||Kc.createInstance(this.Poa,$b.instance.Xo,this.B6a,this.NMc));this.za=tb;this.VHa=ab.s4d;this.DKd=new Promise(fd=>{this.U3e=fd});Rb&&Rb.execute(fd=>{this.VK=fd})}mc(){this.q5k()}BCo(Fa){this.CLc=Fa}q5k(){this.ga.nb(yb.a.Pv,Vb.a.frame,Object(a.a)(this,this.Pv,"tellMe"),96);this.ga.nb(yb.a.uLg,
Vb.a.frame,Object(a.a)(this,this.J2h,"cacheAsyncMenuRefreshFunction"),96);this.ga.nb(yb.a.zLg,Vb.a.frame,Object(a.a)(this,this.Zej,"logItemExecuted"),96);this.ga.nb(yb.a.CLg,Vb.a.frame,Object(a.a)(this,this.zej,"logControlDeactivation"),96);this.ga.nb(yb.a.BLg,Vb.a.frame,Object(a.a)(this,this.Vej,"logInputFocus"),96);this.ga.nb(yb.a.xLg,Vb.a.frame,Object(a.a)(this,this.icb,"interactionBegin"),96);this.ga.nb(yb.a.ELg,Vb.a.frame,Object(a.a)(this,this.icb,"interactionBegin"),96);this.ga.nb(yb.a.ALg,
Vb.a.frame,Object(a.a)(this,this.Uej,"logInputBlur"),96);this.ga.nb(yb.a.DLg,Vb.a.frame,Object(a.a)(this,this.yej,"logControlActivated"),96);this.ga.nb(yb.a.Dud,Vb.a.frame,Object(a.a)(this,this.fvi,"focusSearchBox"),96);this.ga.nb(yb.a.tLg,Vb.a.frame,Object(a.a)(this,this.qai,"constructLiveNotificationForMenu"),96);this.ga.nb(yb.a.FLg,Vb.a.frame,Object(a.a)(this,this.zZf,"insertTryQuery"),96);this.ga.nb(yb.a.q7f,Vb.a.frame,Object(a.a)(this,this.zZf,"insertTryQuery"),96);this.ga.nb(yb.a.bGf,Vb.a.frame,
this.s0a,96);this.ga.nb(yb.a.cGf,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.dGf,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.eGf,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.fGf,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.vlg,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.wlg,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.xlg,Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.Ung,Vb.a.frame,this.ecb,96);this.ga.nb(yb.a.Vng,Vb.a.frame,this.ecb,96);this.ga.nb(yb.a.Wng,Vb.a.frame,this.ecb,96);this.ga.nb(yb.a.wLg,Vb.a.frame,this.lvj,96);this.ga.nb(yb.a.GLg,
Vb.a.frame,this.s0a,96);this.ga.nb(yb.a.dkf,Vb.a.frame,this.Eke,96);this.ga.nb(yb.a.ekf,Vb.a.frame,this.Eke,96);this.ga.nb(yb.a.fkf,Vb.a.frame,this.Eke,96);this.ga.nb(yb.a.k3b,Vb.a.frame,this.k3b,96);this.ga.nb(yb.a.Q6f,Vb.a.frame,this.saj,96);this.ga.nb(yb.a.Rsg,Vb.a.frame,this.ADj,96);this.ga.nb(yb.a.qJf,Vb.a.frame,this.vxi,96)}rAo(Fa){this.Nac=!1;const lb=window.performance.now();Fa.xdb.isCompleted?(this.Nac=!0,this.U3e(!0)):Fa.L0(()=>{this.Nac=!0;this.U3e(!0);$b.instance.Jn.hE(y.a.AXl,window.performance.now()-
lb)});this.kBo(Fa)}kBo(Fa){Dc.a.exe(this.dispatcher);Dc.a.o2c([new qc.a(yb.a.Pv,Vb.a.frame,96),new qc.a(yb.a.uLg,Vb.a.frame,96),new qc.a(yb.a.zLg,Vb.a.frame,96),new qc.a(yb.a.CLg,Vb.a.frame,96),new qc.a(yb.a.BLg,Vb.a.frame,96),new qc.a(yb.a.xLg,Vb.a.frame,96),new qc.a(yb.a.ELg,Vb.a.frame,96),new qc.a(yb.a.ALg,Vb.a.frame,96),new qc.a(yb.a.DLg,Vb.a.frame,96),new qc.a(yb.a.Dud,Vb.a.frame,96),new qc.a(yb.a.tLg,Vb.a.frame,96),new qc.a(yb.a.FLg,Vb.a.frame,96),new qc.a(yb.a.q7f,Vb.a.frame,96),new qc.a(yb.a.bGf,
Vb.a.frame,96),new qc.a(yb.a.cGf,Vb.a.frame,96),new qc.a(yb.a.dGf,Vb.a.frame,96),new qc.a(yb.a.eGf,Vb.a.frame,96),new qc.a(yb.a.fGf,Vb.a.frame,96),new qc.a(yb.a.vlg,Vb.a.frame,96),new qc.a(yb.a.wlg,Vb.a.frame,96),new qc.a(yb.a.xlg,Vb.a.frame,96),new qc.a(yb.a.Ung,Vb.a.frame,96),new qc.a(yb.a.Vng,Vb.a.frame,96),new qc.a(yb.a.Wng,Vb.a.frame,96),new qc.a(yb.a.wLg,Vb.a.frame,96),new qc.a(yb.a.GLg,Vb.a.frame,96),new qc.a(yb.a.dkf,Vb.a.frame,96),new qc.a(yb.a.ekf,Vb.a.frame,96),new qc.a(yb.a.fkf,Vb.a.frame,
96),new qc.a(yb.a.k3b,Vb.a.frame,96),new qc.a(yb.a.Q6f,Vb.a.frame,96),new qc.a(yb.a.Rsg,Vb.a.frame,96),new qc.a(yb.a.qJf,Vb.a.frame,96)],Fa)}fvi(Fa,lb,kb){if(1===kb)return 32;this.IVj();Fa=!1;($b.instance.Xo.W2a||this.O5a)&&(lb=document.getElementById("SearchButton"))&&lb.click();if(!$b.instance.Xo.W2a&&this.O5a)for(lb=document.getElementsByClassName("ms-suiteux-search-box"),kb=0;kb<lb.length;kb++){const Ob=lb[kb].querySelector("input[type=search]");Ob&&(Fa=Lb.FocusManager.LP(Ob))}else Fa=Lb.FocusManager.LP($get($b.instance.Xo.$t?
x.a.GHg:x.a.RFe));this.FMc=!0;return Fa?32:8}zZf(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.IVj();Fa=nc.CommandValueId;lb=$b.instance.Xo.$t?x.a.GHg:x.a.RFe;$b.instance.Xo.$t&&!Z.c(nc[yc.a.r2a])&&(nc[yc.a.r2a]=!1);if(Fa){if($b.instance.Xo.$t)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Fa)),this.skb=[19],32;if(nc=$get(lb))nc.value=Fa}return Lb.FocusManager.LP($get(lb))?32:8}IVj(){this.oc.zP($b.instance.Xo.W2a||
this.O5a?$b.instance.Xo.mUb:$b.instance.Xo.Tfb,!1)}lmm(Fa,lb){switch(Fa){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,lb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,lb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,lb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,lb)}return lb}qai(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;Fa=this.VHa?this.VHa.PMj:0;nc.Value=1!==Fa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Fa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.VHa)for(const zc of this.VHa.b1l)nc=Object(l.a)(N.a,zc)?zc.id:ua.a.replaceAll(zc.value,'"',""),(nc=$get(nc+"-"+J.a.vLg))&&cd.a.ju(nc,cd.a.bma,ua.a.Mf(this.lmm(zc.groupType,nc.innerText)));return 32}J2h(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.h7b=new zb.a(2,1,0,()=>{nc[dc.a.Callback]()},97);this.VHa&&this.Sb.pc(this.h7b);return 32}Zej(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;nc.CloseAllMenus&&(Fa=void 0===nc.ParentControlId||null===nc.ParentControlId?"<NA>":nc.ParentControlId,lb=this.J7b?this.J7b[nc.ControlId]:null,!lb&&this.J7b&&"<NA>"!==Fa&&(lb=this.J7b[Fa]),lb||(lb=this.Y$b&&this.Poa.fon(nc),lb=this.WYl(lb,
nc.ControlId),lb=new u(lb,32,4,-1,-1,-1),$b.instance.Jn.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+nc.ControlId+" determined group:"+P.a[lb.groupType])),$b.instance.Jn.Z2n(nc.ControlId,Fa,nc.CommandId,nc.CloseAllMenus,lb),this.B6a.XZn(nc.ControlId),nc.Location!==Ca.a.contextMenu&&(this.Poa.h8a(nc),this.Poa.addProvider(lb.resultType),$b.instance.Xo.ICe&&this.jsa.Y2k(nc.CommandId)));return 32}zej(Fa,lb,kb,Ob,nc){if(1===kb)return 32;(new za(this.Dnc())).WNm(this.r8b);Fa=this.r8b;
lb=this.Q1d();kb=$b.instance.Jn.ACd;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;nc=nc.UILocation;Fa&&0<Fa.length&&this.NMc&&J.a.wFg($b.instance.Xo)&&$b.instance.Xo.Fje&&19!==nc&&lb>kb&&!$b.instance.Xo.vU&&($b.instance.Jn.h$f(Fa),$b.instance.Jn.FCg(lb));$b.instance.Jn.TNo();$b.instance.Xo.gJe&&19!==nc&&(this.EO.mark(3),this.EO.measure(1,0,3),this.EO.measure(2,2,3),this.EO.X9f(0,1,2),this.EO.X9f(2,2,3),this.EO.X9f(1,0,3),this.EO.jyl(),this.EO.clearMeasures([0,
2,1]));$b.instance.Jn.z3n(window.performance.now()-this.M3e);$b.instance.Xo.$t&&(this.Ojb=null,$b.instance.Jn.XEa());this.FMc=this.k$b=!1;this.r8b="";return 32}Vej(Fa,lb,kb){if(1===kb)return 32;$b.instance.Jn.zyb(v(lb),this.FMc);return 32}Uej(Fa,lb,kb){if(1===kb)return 32;$b.instance.Jn.XEa();this.k$b=!1;return 32}yej(Fa,lb,kb,Ob,nc){if(1===kb)return 32;$b.instance.CU=null;nc&&($b.instance.CU=nc);$b.instance.Xo.gJe&&(Z.c($b.instance.CU)||$b.instance.CU.Location!==Ca.a.contextMenu)&&this.EO.mark(0);
$b.instance.Jn.FBe(Z.c($b.instance.CU)||Z.c($b.instance.CU.Location)?Ca.a.unknown:$b.instance.CU.Location);$b.instance.Jn.y3n(this.iAh,this.FMc);this.k$b||this.seb();return 32}cei(Fa,lb){const kb=[],Ob=Date.now();for(const nc of Fa)Fa=(Ob-nc.timeStamp)/1E3,Fa=J.a.kHe(Fa),Array.add(kb,new V(lb?nc.commandId:nc.controlId,Fa));return kb}XRl(Fa){const lb=[],kb=Date.now();for(const Ob of Fa)if(Ob.controlId||"keyboardShortcut"===Ob.commandSurface)Fa=(kb-Ob.timeStamp)/1E3,Fa=J.a.kHe(Fa),Array.add(lb,new W(Ob.controlId,
Ob.commandId,Fa,Ob.commandSurface,Ob.VFe));return lb}Qei(Fa=!1){var lb=Fa?this.Poa.QNm():this.Poa.w5c();Fa=[];const kb=Date.now();for(const Ob of lb)lb=(kb-Ob.TimeStamp)/1E3,lb=J.a.kHe(lb),Array.add(Fa,new V(Ob.Id,lb));return Fa}seb(){if(!this.k$b){this.Y$b=this.k$b=!0;if(!this.Ovh){this.Ovh=!0;const Fa={};Fa.IsMLREnabled=$b.instance.Xo.Cun;Fa.IsReactRibbonEnabled=$b.instance.Xo.$t;Fa.IsSharedHeaderEnabled=!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Pb.JN;Fa.IsSearchUxEnabled=this.O5a;
Fa.IsTellMeInHeaderEnabled=$b.instance.Xo.W2a;Fa.IsGoLocalEnv=J.a.Crn();Fa.IsSovereignEnvironment=J.a.Jrc();Fa.IsTellMeServiceResultsEnabled=J.a.wFg($b.instance.Xo);Fa.IsSubstrateProviderEnabled=J.a.vFg($b.instance.Xo);Fa.ShouldFetchTokens=!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Pb.T2b;Fa.IsSerpletEnabled=J.a.Mva();Fa.FirstOnClickTimeInMS=Math.round(window.performance.now());Fa.IsHeaderHidden=U.AFrameworkApplication.hideHeader||U.AFrameworkApplication.J1;Fa.IsSearchInHeaderHidden=
U.AFrameworkApplication.j9c;void 0!==window.performance.timing&&null!==window.performance.timing&&(Fa.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Fa.IsFindWithMatchesEnabled=$b.instance.Xo.C6d;Fa.HelpShowsTopSearchResult=$b.instance.Xo.rsd;Fa.HelpShowsNumberOfMatches=$b.instance.Xo.qsd;U.AFrameworkApplication.J&&(Fa.UiHost=U.AFrameworkApplication.J.rb("UiHostIntegrationType"));$b.instance.Jn.DNn(JSON.stringify(Fa))}this.xhc=this.cei(z.a.instance.l5c(),!1);this.whc=
this.cei(z.a.instance.Lsb(),!0);this.YDc=this.XRl(z.a.instance.Lsb());this.vuc=this.Qei();this.wuc=this.Qei(!0);$b.instance.Jn.seb()}}icb(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(mc.a.Ibd)return 32;this.M3e=window.performance.now();this.seb();Fa=new ca(this.bFa,0);$b.instance.nxa++;$b.instance.Jn.beginQuery("",$b.instance.nxa,this.Y$b);this.swd(!0,null);this.VHa=ab.s4d;this.Ojb=ja.hDf;if(this.jsa)$b.instance.actions=
[],this.jsa.WL(new S("",$b.instance.nxa),Fa,$b.instance.Xo.$t);else $b.instance.Jn.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.h7b&&this.Sb.pc(this.h7b);return 32}Gye(Fa,lb,kb){if(1===kb)return 32;this.oc.PW($b.instance.Xo.W2a||this.O5a?$b.instance.Xo.mUb:$b.instance.Xo.Tfb,!1);return 32}Pv(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:TellMe","actiondata comes null"),16;$b.instance.CU=nc;$b.instance.Jn.FBe(Z.c($b.instance.CU.Location)?
Ca.a.unknown:$b.instance.CU.Location);Fa=$b.instance.CU.Value;$b.instance.Xo.$t||Fa&&""!==Fa.trim()?(!this.Ojb&&$b.instance.Xo.$t&&($b.instance.Jn.zyb(v(lb),this.FMc),this.seb()),this.o$l(Fa,$b.instance.CU.Location),$b.instance.CU.PopulationXML=this.VHa.xml):this.Y$b?$b.instance.CU.PopulationXML=this.VHa.xml:($b.instance.CU.PopulationXML=ab.s4d.xml,this.Ojb=ja.hDf,this.r8b="");return 32}o$l(Fa,lb){this.M3e=window.performance.now();$b.instance.Xo.gJe&&lb!==Ca.a.contextMenu&&this.EO.mark(1);$b.instance.Xo.$t&&
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Fa));Fa&&0<Fa.trim().length&&(this.Y$b=!1);$b.instance.Xo.N8l();lb=Z.c(lb)?Ca.a.Pv:lb;if(Fa!==this.r8b||$b.instance.Xo.$t){$b.instance.nxa++;$b.instance.Jn.beginQuery(Fa,$b.instance.nxa,this.Y$b);this.swd(!0,null);const kb=new S(Fa,$b.instance.nxa),Ob=new ca(this.bFa,$b.instance.nxa);this.VHa=ab.s4d;this.Ojb=ja.hDf;if(this.jsa)$b.instance.actions=[],this.jsa.WL(kb,Ob,$b.instance.Xo.$t,lb,this.skb),this.skb=null;else $b.instance.Jn.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.iAh=$b.instance.nxa;this.r8b=Fa}}AFp(Fa){if($b.instance.Xo.$t){var lb=appChrome.selectors.getActiveControlStates();if(lb=Object(w.a)(Object,lb[Fa.value])){Fa.label=lb.label;let kb=null;"description"in lb&&(kb=lb.description);kb&&Object.getType(kb)===String?Fa.description=kb:"secondaryText"in lb?Fa.description=lb.secondaryText:"fullDescriptionLabel"in lb&&(Fa.description=lb.fullDescriptionLabel)}}}sko(Fa){this.J7b={};let lb=0,kb=0;for(const Ob of Fa){Fa=
0;for(const nc of Ob.results)this.J7b[nc.value]=new u(nc.groupType,nc.type,nc.subType,lb,Fa,kb),Fa++,kb++,nc.label||5!==nc.type||this.AFp(nc);0<Fa&&lb++}}DZb(Fa,lb,kb,Ob,nc){if(1===kb)return 32;if(Z.c(nc))return $b.instance.Jn.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Fa=nc.CommandValueId)&&window.open(Fa,"_blank");return 32}Iaj(Fa){const lb={};lb.token=this.atd;lb.files=ia.c(Fa);lb.type="MultiFilesDeckGeneration";if(U.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",
!1))return this.ga.Zb(yb.a.qFn,2,lb),!0;Fa=J.a.jMi("",J.a.RMj("GenerateDeckFromFile"),Object.assign(new Wc.a,{landingTab:"All",data:lb}));Fa=this.ga.Zb(yb.a.Uca,2,Fa);return 32!==Fa?($b.instance.Jn.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+Fa+"."),!1):!0}Hin(Fa,lb){if(1===Fa)return 32;if(Z.c(lb))return $b.instance.Jn.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Z.c(this.CLc))return $b.instance.Jn.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;Fa=lb.CommandValueId;return Z.c(Fa)?($b.instance.Jn.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.CLc.insertHtmlText(Fa)?32:($b.instance.Jn.onError("TellMeActor:InsertUrl","url is not inserted"),16)}WYl(Fa,lb){return lb.startsWith($b.instance.Xo.$t?J.a.dOg:J.a.zHe)?5:Fa?4:"bSearchHelp"===lb||lb.startsWith("GetHelpFromTellMe")?8:"bInsights"===lb||lb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===lb?24:lb===$b.instance.Xo.sGf?2:0}Q1d(){return this.Xq.Q1d()}addProvider(Fa,
lb){this.jsa?this.jsa.addProvider(Fa,lb):Array.add(this.xNd,new H(Fa,lb))}swd(Fa,lb="",kb=null){return this.Xq.swd(Fa,lb,kb)}static get instance(){return $b._instance||($b._instance=new $b(Db.TellMeActorConstants.instance))}get Xo(){return this.Xq.Xo}set Xo(Fa){this.Xq.Xo=Fa}set gMe(Fa){this.Xq.gMe=Fa}get Wnc(){return this.Xq.Wnc}set Wnc(Fa){this.Xq.Wnc=Fa}get Jn(){return this.Xq.Jn}set Jn(Fa){this.Xq.Jn=Fa}get nxa(){return this.Xq.nxa}set nxa(Fa){this.Xq.nxa=Fa}get d9a(){return this.Xq.d9a}set d9a(Fa){this.Xq.d9a=
Fa}get CU(){return this.Xq.CU}set CU(Fa){this.Xq.CU=Fa}get vuc(){return this.Xq.vuc}set vuc(Fa){this.Xq.vuc=Fa}get xhc(){return this.Xq.xhc}set xhc(Fa){this.Xq.xhc=Fa}get whc(){return this.Xq.whc}set whc(Fa){this.Xq.whc=Fa}get YDc(){return this.Xq.YDc}set YDc(Fa){this.Xq.YDc=Fa}get Poa(){return this.Xq.Poa}set Poa(Fa){this.Xq.Poa=Fa}get n3b(){return this.Xq.n3b}set n3b(Fa){this.Xq.n3b=Fa}get wuc(){return this.Xq.wuc}set wuc(Fa){this.Xq.wuc=Fa}}$b._instance=null;$b.Sqp="mso_tellMeService";$b.unknown=
"Unknown";$b.Dbm=500;Object(I.a)($b,"TellMeActor",null,[])},2002:function(I,K,e){e.r(K);I=e(0);var m=e(1449),f=e(76),a=e(359),l=e(87),w=e(1398);class z{constructor(J,U,F,T=0){this.SQi=J;this.groupType=U;this.EUf=T;this.lpd=F}}Object(I.a)(z,"SortingGroup",null,[]);class x{constructor(J,U,F,T){this.order=J;this.Qca=U;this.o_m=F;this.groupType=T}}Object(I.a)(x,"SortingProp",null,[]);var u=e(1389),v=e(1394),E=e(1390),y=e(1376);class H{constructor(J,U){this.khj={};this.jhj={};this.fhj=this.rhj=1;this.b2h(J,
U)}nip(J,U,F){var T=E.a.UT(F)?this.khj:this.jhj;F=new f.a;for(var Y of U)U=Object(l.a)(x,T[m.a[Y.groupType].toLowerCase()]),y.c(U)||F.add(new a.a(U,Y));F.Sc((S,N)=>S.key.order<N.key.order?-1:1);Array.clear(J);Y=u.TellMeActorConstants.instance.WRf();for(U=0;U<F.count;){T=F.K(U).key.Qca;var P=F.K(U).value;const S=new w.a(F.K(U).key.groupType);y.c(Y)||Y.Location===v.a.contextMenu||(S.displayName=F.K(U).key.o_m);for(const N of P.results)S.aA(N);for(P=++U;P<F.count&&F.K(P).key.Qca===T;)this.xif(S,F.K(P).value),
P=++U;J.push(S)}}THp(J,U){this.fhj=this.rhj=1;this.b2h(J,U)}b2h(J,U){this.h1j(J);for(var F=0;F<J.length;F++){const T=J[F];for(const Y of T.lpd)this.d2k(Y,F,T.SQi,T.groupType)}this.h1j(U);for(J=0;J<U.length;J++){F=U[J];for(const T of F.lpd)this.c2k(T,J,F.SQi,F.groupType)}}h1j(J){J.sort((U,F)=>Object(l.a)(z,U).EUf>Object(l.a)(z,F).EUf?-1:1)}d2k(J,U,F,T){this.khj[m.a[J].toLowerCase()]=new x(this.rhj++,U,F,T)}c2k(J,U,F,T){this.jhj[m.a[J].toLowerCase()]=new x(this.fhj++,U,F,T)}xif(J,U){for(let F=0;F<U.results.length;F++)J.aA(U.results[F])}}
Object(I.a)(H,"BaseGroupingSorter",null,[]);class D{constructor(){this.zme=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.ume=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,
32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.Rgj=new H(this.zme,this.ume)}ntd(J,U,F,T=null,Y=null){let P=!1;if(T){for(const S of E.a.UT(F)?this.zme:this.ume)this.nvo(S,T);P=!0}if(Y){for(const S of E.a.UT(F)?this.zme:this.ume)this.UHp(U,S,Y);P=!0}P&&this.Rgj.THp(this.zme,this.ume);this.Rgj.nip(J,U,F)}nvo(J,U){const F=new f.a;for(var T of J.lpd){const Y=U[m.a[T].toLowerCase()];F.add(new a.a(y.c(Y)?
Number.MAX_VALUE:Y,T))}if(F.count){F.Sc((Y,P)=>Y.key<P.key?-1:1);U=Array(F.count);for(T=0;T<F.count;T++)U[T]=F.K(T).value;J.lpd=U}}UHp(J,U,F){let T=0;for(const Y of U.lpd)if(m.a[Y].toLowerCase()in F&&F[m.a[Y].toLowerCase()])for(const P of J)if(P.groupType===Y){T+=F[m.a[Y].toLowerCase()];break}U.EUf=T}}Object(I.a)(D,"SimplifiedGroupingSorter",null,[]);e.d(K,"GroupsPlacementInfo",function(){return G});class G{constructor(J){this.ihj={};this.ghj={};this.hhj={};this.lhj={};this.kag={};this.mhj=this.zPn=
this.uPn=this.wPn=1;this.ohj=null;this.Wx=J;this.gol();this.Tko();this.Unl();this.Zml();J.vU&&(this.ohj=new D)}xI(J){this.ihj[m.a[J].toLowerCase()]=this.wPn++}pL(J,U){this.ghj[m.a[J].toLowerCase()]=U}AVa(J){this.hhj[m.a[J].toLowerCase()]=this.uPn++}b8(J){this.lhj[m.a[J].toLowerCase()]=this.zPn++}ZF(J){this.kag[m.a[J].toLowerCase()]=this.mhj++}gol(){const J=!!this.Wx&&this.Wx.edb,U=!!this.Wx&&this.Wx.ljd,F=!!this.Wx&&this.Wx.Cwb,T=!!this.Wx&&this.Wx.$4f&&!E.a.Jrc(),Y=!!this.Wx&&this.Wx.mdd,P=!!this.Wx&&
this.Wx.uge,S=!!this.Wx&&this.Wx.c3f,N=!!this.Wx&&this.Wx.nge;this.Wx&&(this.Wx.Yjc||this.Wx.ana||this.Wx.y4d)&&this.xI(26);N&&this.xI(24);this.xI(4);this.xI(18);this.xI(16);this.xI(7);this.xI(17);this.xI(0);this.xI(1);S&&this.xI(28);Y&&this.xI(23);J||this.xI(2);J&&!U||this.xI(8);this.xI(15);F&&this.xI(20);this.xI(14);this.xI(9);this.xI(12);this.xI(10);this.xI(11);J&&this.xI(2);J&&!U&&this.xI(8);this.xI(19);P&&this.xI(27);this.xI(21);this.xI(13);T&&this.xI(22);this.xI(30)}Tko(){this.pL(21,1);this.pL(4,
3);this.pL(18,3);this.pL(16,3);this.pL(7,3);this.pL(17,5);this.pL(0,5);this.pL(1,1);this.pL(28,2);this.pL(2,1);this.pL(8,2);this.pL(15,3);this.pL(14,2);this.pL(27,3);this.pL(9,1);this.pL(12,1);this.pL(10,1);this.pL(11,1);this.pL(19,1);this.pL(23,1);this.pL(13,1);this.pL(24,1);this.pL(25,1);this.pL(20,2);this.pL(22,1);this.pL(26,1)}Unl(){this.AVa(4);this.AVa(0);this.AVa(17);this.AVa(7);this.AVa(16);this.AVa(18);this.AVa(15);this.AVa(20);this.AVa(8);this.AVa(14)}Zml(){this.b8(14);this.b8(10);this.b8(12);
this.b8(9);this.b8(11);this.b8(20);this.b8(15);this.b8(8);this.b8(2);this.b8(1);this.b8(27);this.b8(7);this.b8(18);this.b8(16);this.b8(17);this.b8(0);this.b8(4)}cOo(){this.kag={};this.mhj=1}NPm(J,U,F){this.cOo();const T=!!this.Wx&&this.Wx.edb,Y=!!this.Wx&&this.Wx.ljd,P=!!this.Wx&&this.Wx.Cwb,S=!!this.Wx&&this.Wx.$4f&&!E.a.Jrc(),N=!!this.Wx&&this.Wx.mdd,V=!!this.Wx&&this.Wx.uge,Z=!!this.Wx&&this.Wx.c3f,ca=!!this.Wx&&this.Wx.GCe,W=!!this.Wx&&this.Wx.nge;J=J&&Y;ca&&this.ZF(25);this.ZF(4);this.ZF(18);
this.ZF(16);this.ZF(7);this.ZF(17);this.ZF(0);this.ZF(1);W&&this.ZF(24);Z&&this.ZF(28);N&&this.ZF(23);T&&!Y||!J||this.ZF(8);U&&this.ZF(15);T||this.ZF(2);V&&this.ZF(27);F&&this.ZF(14);T&&!Y||J||this.ZF(8);U||this.ZF(15);P&&this.ZF(20);F||this.ZF(14);this.ZF(9);this.ZF(12);this.ZF(10);this.ZF(11);T&&this.ZF(2);T&&!Y&&this.ZF(8);this.ZF(19);this.ZF(21);this.ZF(13);S&&this.ZF(22);return this.kag}aP(){return this.Wx}}Object(I.a)(G,"GroupsPlacementInfo",null,[])},2004:function(I,K,e){e.r(K);I=e(0);var m=
e(1632),f=e(1497),a=e(1449),l=e(1792),w=e(1496);class z{constructor(G="",J="",U="",F=-99999,T=-1,Y=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=G?G:"";this.Description=J?J:"";this.Type=U?U:"";this.Score=F;this.Age=T;this.Count=Y}}Object(I.a)(z,"Suggestion",null,[]);class x{constructor(G,J){this.GroupType=this.Suggestions=null;this.Suggestions=G;this.GroupType=J}}Object(I.a)(x,"SuggestionGroup",null,[]);class u{}u.ooc="help";u.rbl="answer";u.commands="commands";
u.vYo="servicecommands";u.template="template";Object(I.a)(u,"SuggestionGroupType",null,[]);var v=e(1390),E=e(2),y=e(29),H=e(1389);e.d(K,"InteractionLogger",function(){return D});class D{constructor(G,J,U){this.aUe=0;this.bdf=this.vNc=null;this.Tc=G;this.hbf=this.uRe=this.OYe=!1;this.eyk=J;this.$f=E.AFrameworkApplication.pe;this.$c=U;this.ACd=this.J6e=0}get axa(){return this.Tc.axa}FBe(G){this.Tc.FBe(G)}wfj(){if(this.vNc){var G=0;for(const J of this.vNc)this.Tc.sNn(J,G++);this.vNc=null}}beginQuery(G,
J,U){this.Tc.jNn(G,J,U)}zyb(G,J){this.Tc.Zil(G,J);this.OYe=!0;this.hbf=!1}XEa(){this.OYe=!1;this.uRe||(this.wfj(),this.Tc.Toi(this.aUe))}kNn(G,J){this.Tc.lNn(G,J)}Z2n(G,J,U,F,T){for(const Y of this.eyk)if(G.startsWith(Y)){this.hbf=!0;break}this.Tc.yKn(G,J,U,F,T)}z3n(G){this.uRe=!1;this.aUe=G;this.OYe||this.hbf||(this.wfj(),this.Tc.Toi(this.aUe,!1))}y3n(G,J){this.Tc.EKn(G,J);this.uRe=!0}dJf(G,J){if(!G.count)return"";let U="";const F=Date.now();for(const T of G)G=(F-T.timeStamp)/1E3,G=v.a.kHe(G),0<
U.length&&(U+=";"),U+=J?T.commandId:T.controlId,U+=":",U+=G.toString();return U}seb(){var G=this.dJf(m.a.instance.l5c(),!1);0<G.length&&this.Tc.wKn(G);G=this.dJf(m.a.instance.Lsb(),!0);0<G.length&&this.Tc.NJn(G);G=this.dJf(m.a.instance.kKc,!0);0<G.length&&this.Tc.pLn(G);G=H.TellMeActorConstants.instance.WKf();0<G.length&&this.Tc.hNn(y.c(G))}DNn(G){this.Tc.aKn(G)}U9(G,J,U,F,T,Y,P,S=null){this.Tc.lMn(G,J,U,F,T,Y,P,S)}f$f(G,J,U,F){this.Tc.f$f(G,J,U,F)}hE(G,J,U=null){this.Tc.lK(G,J,U)}onError(G,J,U=null){this.Tc.rda(G,
J,U)}k2o(G){this.vNc=G}WSm(G){const J=[];if(!G)return J;for(let U=0;U<G.length;U++){const F=a.a[G[U].groupType].toLowerCase(),T=[],Y=G[U].results;if(Y){for(let P=0;P<Y.length;P++)"findindocument"===F?Array.add(T,new z("","",F,Y[P].score,Y[P].rVd,Y[P].count)):Array.add(T,new z(Y[P].label,Y[P].description,F,Y[P].score,Y[P].rVd,Y[P].count));"answer"===F||"definition"===F||"wolframanswer"===F||"entity"===F?Array.add(J,new x(T,u.rbl)):"classifier"===F||"appsforoffice"===F?Array.add(J,new x(T,u.commands)):
"serviceclassifier"===F?Array.add(J,new x(T,u.vYo)):"assistance"===F?Array.add(J,new x(T,u.ooc)):("document"===F||"people"===F||"findindocument"===F||"notes"===F||"image"===F||"template"===F)&&Array.add(J,new x(T,F))}}return J}yRf(G,J){const U={};U.Query=J;U.SuggestionGroups=y.c(this.WSm(G));return y.c(U)}FNi(G){const J={"Content-Type":"application/json",Accept:"application/json"};J["X-Office-Version"]=E.AFrameworkApplication.buildVersion;J["X-Office-Application"]=E.AFrameworkApplication.J.rb("Application");
J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=E.AFrameworkApplication.J.rb("LoggableUserId")||"";J["X-TellMe-SessionId"]=this.Tc.axa.interactionId;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=E.AFrameworkApplication.uiCulture;J["X-TellMe-ProcessSessionId"]=E.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=G;J["X-TellMe-PartialQueryIndex"]=this.J6e;return J}xZb(G,J,U){this.U9(J.length,"RankerLogging",G.data.Xe.toString(),Math.round(window.performance.now()-U),w.a.G5j,
!0,f.a.VYa)}lZb(G,J,U){this.U9(J.length,"RankerLogging",G.data.Xe.toString(),Math.round(window.performance.now()-U),w.a.G5j,!1,f.a.VYa)}GNi(){this.bdf||(this.bdf=new l.a(this.$c,null,6E3));return this.bdf.Yea}h$f(G){const J=this.yRf(this.vNc,G),U=this.FNi("RankerLogging"),F=window.performance.now();this.$f.addRequest(this.GNi(),2,J,U,!1,0,T=>{this.xZb(T,G,F)},T=>{this.lZb(T,G,F)},null,null,!1,4E3,6E3);this.J6e++}TNo(){this.J6e=0}FCg(G){this.ACd=G}}Object(I.a)(D,"InteractionLogger",null,[])},2005:function(I,
K,e){I=e(0);var m=e(1729),f=e(49);class a{constructor(){this.source=0;this.Wl=this.R3a=this.Jea=null;this.Ooa=0;this.GUb=!1;this.mode=this.K2a=0;this.f3c=null;this.mYb=f.a.create()}}Object(I.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.dCa=!1;this.QN=null}}Object(I.a)(l,"OutputState",null,[]);class w{constructor(){this.bXi=this.NCe=this.Bsd=!1;this.Dc=this.hne=this.Omg=this.Nwe=this.cpp=this.UDl=this.jWa=this.IK=this.byb=this.cBc=this.iAp=this.xbm=this.ks=this.fzf=
this.Pw=this.BC=this.Ao=this.XHe=this.X5d=this.RKa=null}}Object(I.a)(w,"RuntimeState",null,[]);e.d(K,"a",function(){return z});class z{constructor(){this.input=new a;this.runtime=new w;this.output=new l;this.logger=new m.a(this)}}Object(I.a)(z,"MergeState",null,[])},2006:function(I,K,e){e.r(K);I=e(0);var m=e(622),f=e(231),a=e(185),l=e(257),w=e(1601),z=e(1736),x=e(1776),u=e(5),v=e(1996);class E{constructor(F,T){this.start=F;this.end=T}}Object(I.a)(E,"MergeDiffIdx",null,[]);class y{constructor(F,T,
Y,P=!1,S=null,N=null,V=!0){this.iDd=this.hDd=this.qkh=this.tOc=0;this.Zdc=this.EOe=null;this.Okb=S||new v.a;this.Ng=Y;this.Rya=F.pQa();this.VXk=T.pQa();this.PU=new E(0,0);this.rY=new E(0,0);this.rYe=P;this.HLc=V;this.wza=N;this.fql();this.$2o()}get NO(){return this.Rya}get jO(){return this.VXk}get XC(){return this.tOc}get ND(){return this.qkh}get xCa(){return this.hDd}get Vta(){return this.iDd}get h_l(){const F=new f.a;for(let T=this.EOe.start;T<this.EOe.end;T++)F.add(this.NO.Lg(T));return F}get xAf(){const F=
new f.a;for(let T=this.Zdc.start;T<this.Zdc.end;T++)F.add(this.jO.Lg(T));return F}JBf(F){if(this.ND<F.ND){if(this.ND+this.xCa>F.ND)return!0}else if(this.ND>F.ND){if(F.ND+F.xCa>this.ND)return!0}else if(2===this.XC&&3===F.XC||3===this.XC&&2===F.XC||2===this.XC&&2===F.XC||3===this.XC&&3===F.XC)return!0;return!1}HKj(F,T,Y,P){F.VJ(T);F.PC(T,Y);return P+=Y.length-1}I1j(F,T,Y,P,S){let N=this.NO.Lg(F),V=this.jO.Lg(T);if(!N||!V||!N.jhb&&!V.jhb)return{returnValue:!1,uKa:P,sRa:S};let Z=new f.a,ca=new f.a;N.jhb&&
(Z=N.wtd(),N=Z.Lg(Y?0:Z.length-1));V.jhb&&(ca=V.wtd(),V=ca.Lg(Y?0:ca.length-1));if(!N.aE(V,this.Okb,this.wza,this.rYe,this.HLc))return{returnValue:!1,uKa:P,sRa:S};Z.length&&(P=this.HKj(this.NO,F,Z,P));ca.length&&(S=this.HKj(this.jO,T,ca,S));return{returnValue:!0,uKa:P,sRa:S}}jem(F,T,Y,P,S,N){for(;S<=Y&&N<=P;){const V=F.Lg(S),Z=T.Lg(N);if(!V.aE(Z,this.Okb,this.wza,this.rYe,this.HLc))break;this.PU.start+=V.length;this.rY.start+=Z.length;S++;N++}return{qnf:S,lPg:N}}hem(F,T,Y,P,S,N){for(;S>=Y&&N>=P;){const V=
F.Lg(S),Z=T.Lg(N);if(!V.aE(Z,this.Okb,this.wza,this.rYe,this.HLc))return{returnValue:!0,uKa:S,sRa:N};S--;N--}return{returnValue:!1,uKa:S,sRa:N}}iem(F,T,Y,P){let S=!1;do({qnf:F,lPg:T}=this.jem(this.NO,this.jO,Y,P,F,T)),{uKa:Y,sRa:P,returnValue:S}=this.I1j(F,T,!0,Y,P);while(S);return{qnf:F,lPg:T,uKa:Y,sRa:P}}gem(F,T,Y,P){let S=!1;do{if(!({uKa:Y,sRa:P}=this.hem(this.NO,this.jO,F,T,Y,P)).returnValue)break;({uKa:Y,sRa:P,returnValue:S}=this.I1j(Y,P,!1,Y,P))}while(S);return{uKa:Y,sRa:P}}fql(){var F=0,T=
0,Y=this.NO.length-1,P=this.jO.length-1;0<=Y&&this.NO.Lg(Y);0<=P&&this.jO.Lg(P);({qnf:F,lPg:T,uKa:Y,sRa:P}=this.iem(F,T,Y,P));if(F<Y||T<P)({uKa:Y,sRa:P}=this.gem(F,T,Y,P));Y++;P++;this.EOe=new E(F,Y);this.Zdc=new E(T,P);this.PU.end=this.PU.start;this.rY.end=this.rY.start;for(var S=F;S<Y;S++){var N=this.NO.Lg(S);this.PU.end+=N.length}for(S=T;S<P;S++)N=this.jO.Lg(S),this.rY.end+=N.length;a.a.instance.fb(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
F,Y,T,P);a.a.instance.fb(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.PU.start,this.PU.end,this.rY.start,this.rY.end);this.PU.start<=this.PU.end&&this.rY.start<=this.rY.end&&(F=this.NO.Lg(F),T=this.jO.Lg(T),S=this.NO.Lg(Y),N=this.jO.Lg(P),Y=this.NO.Lg(Y-1),P=this.jO.Lg(P-1),a.a.instance.fb(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
F,S,T,N,Y,P))}$2o(){this.qkh=this.PU.start;this.hDd=this.iDd=0;this.PU.start===this.PU.end&&this.rY.start===this.rY.end?this.tOc=0:this.PU.start===this.PU.end&&this.rY.start<this.rY.end?(this.tOc=1,this.iDd=this.rY.end-this.rY.start):this.rY.start===this.rY.end&&this.PU.start<this.PU.end?(this.tOc=2,this.hDd=this.PU.end-this.PU.start):(this.tOc=3,this.hDd=this.PU.end-this.PU.start,this.iDd=this.rY.end-this.rY.start);a.a.instance.fb(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.XC,this.ND,this.xCa,this.Vta)}nun(F,T){return F.C9()&&T.C9()?F.runId===T.runId&&F.Eg===T.Eg:!1}Xzn(F){if(!F.C9()||"\ufffc"!==F.text)return!1;F=F.TRb;return F?F.hasProperty(u.a.Lk)||F.hasProperty(u.a.bXd)||F.hasProperty(u.a.oCf)||F.hasProperty(u.a.Q8)||F.hasProperty(u.a.imageType)||F.hasProperty(u.a.d_a)||F.hasProperty(u.a.AWb)||F.hasProperty(u.a.gu)&&(F=this.Ng.getPropertyInt32(F,u.a.gu))&&(36===F||35===F||24===F||23===F||33===F||34===F||44===F||45===F||42===F||43===F)?!0:!1:!1}Vbd(F){return F.C9()&&
!this.Xzn(F)}rrl(){if(2===this.XC)return!1;var F=this.Zdc.start;if(!F)return!1;let T=null;for(var Y=this.Zdc.start;Y<this.Zdc.end;Y++){const P=this.jO.Lg(Y);if(this.Vbd(P)){T=P;break}}if(!T)return!1;--F;for(Y=this.jO.Lg(F);Y&&!this.Vbd(Y);)F--,Y=this.jO.Lg(F);return Y&&this.nun(Y,T)?!0:!1}WDi(F){const T=new f.a;for(let Y=0;Y<F.length;Y++)F.K(Y).jhb?T.PC(T.length,F.K(Y).wtd()):T.insert(T.length,F.K(Y));return T}pun(){if(3!==this.XC||this.xCa!==this.Vta)return!1;const F=this.WDi(this.h_l),T=this.WDi(this.xAf);
if(F.length!==T.length)return!1;for(let Y=0;Y<F.length;Y++)if(!F.K(Y).aE(T.K(Y),this.Okb,this.wza,!0,this.HLc))return!1;return!0}oun(){if(0!==this.XC&&3!==this.XC||this.NO.length!==this.jO.length)return!1;let F=!1;for(let T=0;T<this.NO.length;T++){if(!this.NO.K(T).aE(this.jO.K(T),this.Okb,this.wza,!0,this.HLc))return!1;if(3===this.NO.K(T).type||1===this.NO.K(T).type){const Y=this.NO.K(T),P=this.jO.K(T);F=Y.runId!==P.runId||Y.Eg!==P.Eg||F}}return F}}Object(I.a)(y,"MergeBlockDiff",null,[]);var H=e(1536);
class D{constructor(F,T){this.id=F;this.index=T}}Object(I.a)(D,"ParagraphStartIndex",null,[]);var G=e(1629),J=e(1504);e.d(K,"ParagraphMerge",function(){return U});class U{constructor(F,T,Y,P,S,N,V){this.Ybc=this.uJb=this.Uq=this.FA=null;this.vi=!1;this.wOh=this.Smh=this.oeh=this.SAa=this.WSa=this.Rya=null;this.we=F;this.tJ=T;this.LJa=P;this.nIa=Y;this.vza=S;this.wza=N;this.Ng=V}IKi(F){const T=new m.a;F.NO.forEach(Y=>{2===Y.type&&T.add(Y.$k);return!0});F.jO.forEach(Y=>{2===Y.type&&T.remove(Y.$k);return!0});
return T}jHi(F){const T=new f.a;F.jO.forEach(Y=>{2===Y.type&&T.add(Y.$k);return!0});return T}Q$h(F){const T=new f.a;let Y=0,P=0;F.jO.forEach(S=>{2===S.type&&(T.add(new D(S.$k,Y<F.ND?Y:Y<F.ND+F.Vta?F.ND:Y-F.Vta+F.xCa)),Y=P);P+=S.length;return!0});return T}iEl(F,T){var Y=this.Q$h(F);const P=this.Q$h(T);F=this.IKi(F);const S=this.IKi(T);T=new f.a;const N=new m.a;let V=0;for(let Z=0;Z<Y.length;Z++){const ca=Y.K(Z);if(V<P.length){let W=P.K(V);for(;V<P.length&&W.index<=ca.index;){if(W.id.equals(ca.id)){V++;
break}F.contains(W.id)||N.contains(W.id)||(T.add(W.id),N.add(W.id));V++;W=P.K(V)}}S.contains(ca.id)||(T.add(ca.id),N.add(ca.id))}for(;V<P.length;)Y=P.K(V),F.contains(Y.id)||N.contains(Y.id)||(T.add(Y.id),N.add(Y.id)),V++;return T}initialize(){if(this.vi){const F=!!this.FA&&!!this.Uq;this.we.logger.mj(Object.assign(new H.a,{Dk:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return F}this.vi=!0;if(!({NO:this.Rya,d3c:this.WSa,ewd:this.SAa,KWd:this.oeh,Y5d:this.Smh,YHe:this.wOh}=
J.a.Sei(this.we,this.Ng,this.tJ,this.nIa,this.LJa,this.vza,!1,!1)).returnValue)return!1;this.FA=new y(this.Rya,this.WSa,this.Ng,void 0,void 0,this.wza);this.Uq=new y(this.Rya,this.SAa,this.Ng,void 0,void 0,this.wza);a.a.instance.fb(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.FA.xCa,this.FA.Vta,this.Uq.xCa,this.Uq.Vta));return!0}dRa(){a.a.instance.fb(593826836,1,4,"Attempting to merge with LCS");let F=!1;
const T=new x.a(this.Ng,this.we);let Y=null,P=null;var S=null;const N=Z=>this.we.runtime.Ao.K(Z),V=Z=>this.we.runtime.Pw.K(Z)||this.we.runtime.Ao.K(Z);this.FA=new y(this.Rya,this.WSa,this.Ng,void 0,void 0,this.wza,!1);this.Uq=new y(this.Rya,this.SAa,this.Ng,void 0,void 0,this.wza,!1);({sM:Y}=T.tgi(this.tJ,N,this.nIa,Z=>this.we.runtime.BC.K(Z)||this.we.runtime.Ao.K(Z),this.FA.ND,this.FA.ND+this.FA.xCa,this.FA.ND+this.FA.Vta)).returnValue&&({sM:P}=T.tgi(this.tJ,N,this.LJa,V,this.Uq.ND,this.Uq.ND+this.Uq.xCa,
this.Uq.ND+this.Uq.Vta)).returnValue&&(F=!0);F||(a.a.instance.fb(593826835,1,2,"Failed to create update hints with LCS"),F=!1);F&&(S=new G.a(this.we,this.tJ,this.nIa,this.LJa,Z=>this.we.runtime.Dc?this.we.runtime.Dc.isFeatureEnabled(Z):!1,this.Ng,null,Y,P),({ks:S}=S.qDc()).returnValue||(a.a.instance.fb(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.we.logger.mj(Object.assign(new H.a,{Dk:"TryLCSMerge",eventId:"9zrqs"})),F=!1));a.a.instance.fb(593826833,1,F?4:2,"TryLCSMerge: [Success: {0}]",
F);return{returnValue:F,ks:S}}qDc(){let F;F=null;if(!this.initialize())return this.we.logger.EZ("ParagraphMerge Initialize"),this.Cdb(),{returnValue:!1,ks:F};this.we.logger.EZ("ParagraphMerge Initialize");let T;this.we.logger.uBe(2);let Y=({dRa:T}=this.O1l()).returnValue;Y=Y&&({ks:F,dRa:T}=this.G6c(this.we,this.Ng,this.vza,this.Ybc,this.uJb)).returnValue;this.we.logger.wDg();if(!Y){this.we.logger.EZ("ParagraphMerge DoMergeInteral");if(T){this.we.logger.uBe(3);({ks:F,returnValue:Y}=this.dRa());this.we.logger.wDg();
if(Y)return{returnValue:!0,ks:F};this.Cdb();return{returnValue:!1,ks:F}}this.Cdb();return{returnValue:!1,ks:F}}if(!({ks:F,dRa:T}=this.G6c(this.we,this.Ng,this.vza,this.Ybc,this.uJb)).returnValue)return this.we.logger.EZ("ParagraphMerge DoMergeInteral"),this.Cdb(),{returnValue:!1,ks:F};this.we.logger.EZ("ParagraphMerge DoMergeInteral");return{returnValue:!0,ks:F}}G6c(){let F;if(!({jte:F}=J.a.G6c(this.we,this.Ng,this.vza,this.Ybc,this.uJb)).returnValue)return this.we.logger.EZ("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.Cdb(),{returnValue:!1,ks:F,dRa:!0};this.we.logger.EZ("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,ks:F,dRa:!1}}Cdb(F=!1){a.a.instance.nqa(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+F+"] BaseRevisionMergeBlocksList: {0}",this.oeh);a.a.instance.nqa(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.Smh);a.a.instance.nqa(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.wOh);F=new f.a;J.a.Dtc(this.Ng,"BaseObjects_",this.tJ,F);J.a.Dtc(this.Ng,"FavoredObjects_",
this.nIa,F);J.a.Dtc(this.Ng,"ConflictObjects_",this.LJa,F);J.a.eLn(this.we,F)}B3h(F){let T,Y;Y=T=0;if(0===this.FA.XC)T=this.Uq.ND;else if(1===this.FA.XC)T=this.Uq.ND<this.FA.ND?this.Uq.ND:this.Uq.ND===this.FA.ND?F||1!==this.Uq.XC?this.Uq.ND+this.FA.Vta:this.Uq.ND:this.Uq.ND+this.FA.Vta;else if(2===this.FA.XC||3===this.FA.XC)T=this.Uq.ND<=this.FA.ND?this.Uq.ND:this.Uq.ND+(this.FA.Vta-this.FA.xCa);if(2===this.Uq.XC||3===this.Uq.XC)Y=T+this.Uq.xCa;return{tQi:T,CZm:Y}}Mti(F,T){let Y;Y=0;if(!T)return{returnValue:!0,
phd:Y};let P=0,S=0;for(;P<F.length;){let N;for(let V=P;V<F.length;V++){P=V;N=F.K(V);const Z=N.length;S+=Z;if(!(S<T)){if(S>T)if(N.jhb)F.VJ(P),F.PC(P,N.wtd()),S-=Z;else return a.a.instance.fb(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",T),this.we.logger.mj(Object.assign(new H.a,{Dk:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,phd:Y};break}}if(S===T)return P++,
Y=P,{returnValue:!0,phd:Y}}a.a.instance.fb(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",T);this.we.logger.mj(Object.assign(new H.a,{Dk:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,phd:Y}}Rel(F,T,Y){let P=0;var S=0,N=!1;const V=this.Uq.xAf.pQa();if(this.Uq.rrl())for(--T;0<=T;T--){let Z=F.K(T);if(this.Uq.Vbd(Z)){S=F.K(T);P=S.runId;S=S.Eg;N=!0;break}}N||((S=F.K(Y))&&this.Uq.Vbd(S)?
(P=S.runId,S=S.Eg):S=P=0);for(F=0;F<V.length;F++)Y=V.K(F),Y.C9()&&(N=Y,this.Uq.Vbd(Y)?(N.runId=P,N.Eg=S):(N.runId=0,N.Eg=0));return V}h5i(F){if(2===F.length){const T=1===F.K(0).type?F.K(0):null;F=2===F.K(1).type;if(T&&F&&""===T.text)return!0}return!1}O1l(){const F=this.FA.oun();if(!F&&0===this.FA.XC)return this.Ybc=this.Uq.jO.pQa(),this.uJb=this.jHi(this.Uq),{returnValue:!0,dRa:!1};if(0===this.Uq.XC)return this.Ybc=this.FA.jO.pQa(),this.uJb=this.jHi(this.FA),{returnValue:!0,dRa:!1};(this.h5i(this.FA.jO)||
this.h5i(this.Uq.jO))&&this.we.logger.lej(Object.assign(new H.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!F){var T=this.FA.JBf(this.Uq);T&&this.vza(48)&&(a.a.instance.fb(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.FA=new y(this.Rya,this.WSa,this.Ng,!0,void 0,this.wza),this.Uq=new y(this.Rya,this.SAa,this.Ng,!0,void 0,this.wza),T=this.FA.JBf(this.Uq));if(T)return a.a.instance.fb(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.we.logger.mj(Object.assign(new z.a,{Dk:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,dRa:!0}}var Y;T=0;this.uJb=this.iEl(this.FA,this.Uq);({tQi:Y,CZm:S}=this.B3h(!1));const P=this.FA.jO.pQa();if(!({phd:Y}=this.Mti(P,Y)).returnValue||(2===this.Uq.XC||3===this.Uq.XC)&&!({phd:T}=this.Mti(P,S)).returnValue)return{returnValue:!1,dRa:!1};if(2===this.Uq.XC||3===this.Uq.XC){this.Bzc(P,T);this.Bzc(P,Y-1);var S=null;for(var N=T-1;N>=Y;N--)2===P.K(N).type&&(S=P.K(N)),P.VJ(N);0<P.length&&(N=P.K(P.length-
1),2!==N.type&&4!==N.type&&S&&(this.we.runtime.Dc.bJ(69),this.we.runtime.Dc.isFeatureEnabled(69)&&(P.add(S),this.uJb.add(S.$k))));a.a.instance.fb(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",T-Y-1,Y)}if(1===this.Uq.XC||3===this.Uq.XC)S=this.Uq.xAf,F&&(S=this.Rel(P,Y,T)),this.Bzc(P,Y-1),this.Bzc(P,Y),this.Bzc(S,0),this.Bzc(S,S.length-1),P.PC(Y,S),a.a.instance.fb(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
Y,F,S.Bt());this.Ybc=P;return{returnValue:!0,dRa:!1}}Bzc(F,T){0>T||T>=F.length||(F=F.K(T),Object(l.a)(w.a,F)&&(F.VZa=!0))}owd(F,T){let Y;Y=T;if(!this.initialize())return{returnValue:!1,Nfb:F,rxa:Y};if(this.Uq.JBf(this.FA))return this.Cdb(!0),this.we.logger.mj(Object.assign(new z.a,{Dk:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,Nfb:F,rxa:Y};if(0===this.Uq.XC||3===this.Uq.XC&&this.Uq.pun())return{returnValue:!0,Nfb:F,rxa:T};let P;({tQi:P}=this.B3h(!0));T<P||T===P&&(1!==this.Uq.XC||1===
this.Uq.XC&&1===this.FA.XC&&T===this.FA.ND+this.FA.Vta)?Y=T:(Y=T+this.Uq.Vta-this.Uq.xCa,Y<P&&(Y=P));return{returnValue:!0,Nfb:F,rxa:Y}}}Object(I.a)(U,"ParagraphMerge",null,[835])},2010:function(I,K,e){e.r(K);I=e(0);var m=e(13),f=e(5),a=e(33),l=e(185),w=e(231),z=e(49),x=e(1727),u=e(1600),v=e(1534),E=e(1504);class y{constructor(J,U,F=null,T=null){this.author=J;this.Dgd=U;this.Upg=F||z.a.nil;this.zOa=T}aE(J){return J?this.author===J.author&&this.Dgd===J.Dgd&&this.Upg===J.Upg&&this.zOa===J.zOa:!1}}Object(I.a)(y,
"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(J,U,F){this.nvb=J||H.eDf;this.drb=U||H.eDf;this.xPa=F||H.eDf}get y4m(){return 0<this.nvb.author.length}get Y3m(){return 0<this.drb.author.length}get e5m(){return 0<this.xPa.author.length}aE(J){return J?this.nvb.aE(J.nvb)&&this.drb.aE(J.drb)&&this.xPa.aE(J.xPa):!1}}H.eDf=new y("",0);Object(I.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var D=e(1794);e.d(K,"ParagraphMergeBlockCreator",function(){return G});class G extends u.a{constructor(J,
U,F,T,Y,P,S,N){super();this.maxValue=Number.MAX_VALUE;this.sv=new x.a;this.q7b=null;this.pI=0;this.$th=!1;this.sOc="";this.DNe=J;this.Vr=U;this.Xw=F;this.tUk=T;this.bFd=Y;this.ith=P;this.V$b=N;this.Ng=S;if(this.Ng.hasProperty(this.Vr,m.a.so))if(this.Ng.hasProperty(this.Vr,f.a.qd))if(this.Ng.hasProperty(this.Vr,f.a.qU))if(this.Ng.hasProperty(this.Vr,f.a.A2))if(this.Ng.hasProperty(this.Vr,m.a.Qq))if(this.G7=this.Ng.getPropertyString(this.Vr,m.a.so),this.qgf=this.Ng.getPropertyUint32(this.Vr,f.a.qd),
this.Uu=this.Ng.getPropertyUint32s(this.Vr,f.a.qU),this.jMd=this.Ng.getPropertyUint32s(this.Vr,f.a.A2),this.dWe=this.Ng.getPropertyObjectIds(this.Vr,m.a.Qq),this.G7||""===this.G7)if(this.G7.length||1!==this.dWe.length||(this.Uu.length||(this.Uu.add(0),l.a.instance.fb(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.jMd.length||(this.jMd.add(0),l.a.instance.fb(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.KLk=this.q8d(this.Vr,f.a.Dfg,this.Uu.length),this.mQc=this.q8d(this.Vr,m.a.PEa,this.Uu.length),this.psa=this.q8d(this.Vr,m.a.ABb,this.Uu.length),this.Bra=this.q8d(this.Vr,f.a.DYa,this.Uu.length),this.csa=this.nWm(this.Vr,f.a.zPa,this.Uu.length),this.Jcn(),J=this.Ng.hasProperty(this.Vr,m.a.sw)?this.Ng.getPropertyUint32s(this.Vr,m.a.sw):new w.a,this.QOd=E.a.mVj(J,this.G7.length),this.Uu.length!==this.jMd.length)l.a.instance.fb(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
U.id);else if(this.Uu.length!==this.dWe.length)l.a.instance.fb(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",U.id);else{this.ith&&(this.Ng.hasProperty(this.Vr,f.a.vy)?this.q7b=this.Ng.getPropertyObjectIds(this.Vr,f.a.vy):(l.a.instance.fb(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",U.id),this.q7b=this.x4(this.Uu.length,z.a.nil)),this.Uu.length!==this.q7b.length&&(l.a.instance.fb(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
U.id,this.Uu.length,this.q7b.length),this.q7b=this.x4(this.Uu.length,z.a.nil)));if(this.Uu.length!==this.mQc.length||this.Uu.length!==this.psa.length||this.Uu.length!==this.Bra.length||this.Uu.length!==this.csa.length)this.Uu.length===this.mQc.length||this.bFd||l.a.instance.fb(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",U.id,this.Uu.length,this.mQc.length),this.Uu.length===this.psa.length||
this.bFd||l.a.instance.fb(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",U.id,this.Uu.length,this.psa.length),this.Uu.length===this.Bra.length||this.bFd||l.a.instance.fb(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",U.id,this.Uu.length,this.Bra.length),this.Uu.length===this.csa.length||
this.bFd||l.a.instance.fb(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",U.id,this.Uu.length,this.csa.length),J=this.Ng.getPropertyBool(this.Vr,m.a.quf),l.a.instance.fb(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",U.id,Y,null==J?!1:J),this.mQc=this.x4(this.Uu.length,!0),this.psa=this.x4(this.Uu.length,!1),this.Bra=this.x4(this.Uu.length,
!1),this.csa=this.x4(this.Uu.length,0),this.Ng.setPropertyBool(this.Vr,m.a.quf,!1);this.sv.cMp(this.Uu.length)?(this.QOd.length!==this.Uu.length+1&&l.a.instance.fb(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",U.id,this.Uu.length,this.QOd.length),this.HIk=!0):l.a.instance.fb(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",U.id)}else l.a.instance.fb(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",U.id);else l.a.instance.fb(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",U.id);else l.a.instance.fb(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",U.id);else l.a.instance.fb(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",U.id);else l.a.instance.fb(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",U.id);else l.a.instance.fb(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",U.id)}Jcn(){this.Ng.hasProperty(this.Vr,f.a.wNa)?this.sv.lvb=this.Ng.getPropertyBools(this.Vr,f.a.wNa):this.sv.lvb=this.x4(this.Uu.length,!1);this.Ng.hasProperty(this.Vr,f.a.Qma)?this.sv.crb=this.Ng.getPropertyBools(this.Vr,f.a.Qma):this.sv.crb=this.x4(this.Uu.length,!1);this.Ng.hasProperty(this.Vr,f.a.xNa)?this.sv.kvb=this.Ng.getPropertyStrings(this.Vr,f.a.xNa):this.sv.kvb=this.x4(this.Uu.length,"");this.Ng.hasProperty(this.Vr,
f.a.DLa)?this.sv.brb=this.Ng.getPropertyStrings(this.Vr,f.a.DLa):this.sv.brb=this.x4(this.Uu.length,"");this.Ng.hasProperty(this.Vr,f.a.yNa)?this.sv.mvb=this.Ng.getPropertyListOfMilliseconds(this.Vr,f.a.yNa):this.sv.mvb=this.x4(this.Uu.length,0);this.V$b&&this.Ng.hasProperty(this.Vr,a.a.lZa)?this.sv.kZa=this.Ng.ZPf(this.Vr,a.a.lZa):this.sv.kZa=null;this.Ng.hasProperty(this.Vr,f.a.ELa)?this.sv.h$a=this.Ng.getPropertyListOfMilliseconds(this.Vr,f.a.ELa):this.sv.h$a=this.x4(this.Uu.length,0);this.V$b&&
this.Ng.hasProperty(this.Vr,a.a.VWa)?this.sv.cQb=this.Ng.ZPf(this.Vr,a.a.VWa):this.sv.cQb=null;this.Ng.hasProperty(this.Vr,f.a.yPa)?this.sv.cfb=this.Ng.getPropertyBools(this.Vr,f.a.yPa):this.sv.cfb=this.x4(this.Uu.length,!1);this.Ng.hasProperty(this.Vr,f.a.bRa)?this.sv.ozb=this.Ng.getPropertyStrings(this.Vr,f.a.bRa):this.sv.ozb=this.x4(this.Uu.length,"");this.Ng.hasProperty(this.Vr,f.a.cRa)?this.sv.qzb=this.Ng.getPropertyListOfMilliseconds(this.Vr,f.a.cRa):this.sv.qzb=this.x4(this.Uu.length,0);this.V$b&&
this.Ng.hasProperty(this.Vr,a.a.h3a)?this.sv.w_b=this.Ng.ZPf(this.Vr,a.a.h3a):this.sv.w_b=null;this.Ng.hasProperty(this.Vr,f.a.MGa)?this.sv.pzb=this.Ng.getPropertyObjectIds(this.Vr,f.a.MGa):this.sv.pzb=this.x4(this.Uu.length,z.a.nil)}q8d(J,U,F){return this.Ng.hasProperty(J,U)?this.Ng.getPropertyBools(J,U):this.x4(F,!1)}nWm(J,U,F){return this.Ng.hasProperty(J,U)?this.Ng.getPropertyUint32s(J,U):this.x4(F,0)}x4(J,U){const F=new w.a;for(let T=0;T<J;T++)F.add(U);return F}IUm(J){const U=this.QOd.Lg(J);
J=this.QOd.Lg(J+1);return this.G7.substring(U,J)}CHi(){if(this.$th)return null;var J=this.pI<this.Uu.length?this.Uu.Lg(this.pI):this.maxValue;if(J===this.maxValue||this.tUk&&!this.G7.length)return this.$th=!0,J=new v.a(this.Xw,this.Vr.id,this.qgf),this.sOc=this.olf(this.sOc,J.toString()),J;const U=this.jMd.Lg(this.pI),F=this.dWe.Lg(this.pI),T=this.KLk.Lg(this.pI),Y=this.mQc.Lg(this.pI),P=this.psa.Lg(this.pI),S=this.Bra.Lg(this.pI),N=this.csa.Lg(this.pI),V=this.ith?this.q7b.Lg(this.pI):null;var Z=
null;this.sv.lvb.Lg(this.pI)&&(Z=new y(this.sv.kvb.Lg(this.pI)||"",this.sv.mvb.Lg(this.pI)));if(this.V$b&&null!=Z){var ca=this.sv.kZa.length<this.pI?this.sv.kZa[this.pI]:null;null!=ca&&null!=ca.Rea&&(Z.zOa=this.Ng.$Lf(new Date(ca.Rea)))}ca=null;this.sv.crb.Lg(this.pI)&&(ca=new y(this.sv.brb.Lg(this.pI)||"",this.sv.h$a.Lg(this.pI)));if(this.V$b&&null!=ca){var W=this.sv.cQb.length<this.pI?this.sv.cQb[this.pI]:null;null!=W&&null!=W.Rea&&(ca.zOa=this.Ng.$Lf(new Date(W.Rea)))}W=null;this.sv.cfb.Lg(this.pI)&&
(W=new y(this.sv.ozb.Lg(this.pI)||"",this.sv.qzb.Lg(this.pI),this.sv.pzb.Lg(this.pI)));if(this.V$b&&null!=W){const X=this.sv.w_b.length<this.pI?this.sv.w_b[this.pI]:null;null!=X&&null!=X.Rea&&(W.zOa=this.Ng.$Lf(new Date(X.Rea)))}Z=new H(Z,ca,W);ca=this.IUm(this.pI);this.pI++;W=ca.startsWith("\ufddfHYPERLINK ");J=new D.a(this.DNe,this.Xw,this.Vr.id,U,J,F,ca,T,!W,Y,P,S,N,Z,V);this.sOc=this.olf(this.sOc,J.toString());return J}hHi(){let J;J=null;var U="";if(!this.HIk)return{tbg:J,Rdb:U};if(U=this.CHi())J=
new w.a,J.add(U);for(;U=this.CHi();)J.add(U);U=this.sOc;return{tbg:J,Rdb:U}}}Object(I.a)(G,"ParagraphMergeBlockCreator",u.a,[])},2016:function(I,K,e){e.r(K);I=e(0);var m=e(231),f=e(1600),a=e(1533);class l extends a.a{constructor(z,x){super(4,z,x)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.$k)}Mlc(){return"Table"}clone(){return new l(this.source,this.$k)}aE(z,x,u,v=!1){return super.aE(z,x,u,v)?this.$k.equals(z.$k):!1}get length(){return 1}}Object(I.a)(l,"TableMergeBlock",
a.a,[]);e.d(K,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(z,x){super();this.zeh=new l(x,z.id)}hHi(){let z;z=new m.a;z.add(this.zeh);return{tbg:z,Rdb:this.olf("",this.zeh.toString())}}}Object(I.a)(w,"TableMergeBlockCreator",f.a,[])},2123:function(I,K,e){function m(a){var l=!0,w=[];a.forEach(function(z){var x,u=z.classification;if(u===f.a.RTg.HVg||u===f.a.RTg.ulk){u=(x={},x.name=z.name,x.bool=null,x.string=null,x["double"]=null,x.int64=null,x.date=null,x.contract=
null,x);switch(z.dataType){case f.a.Ayd.Boolean:u.bool=z.value;break;case f.a.Ayd.Double:u["double"]=z.value;break;case f.a.Ayd.Int64:u.int64=z.value;break;case f.a.Ayd.String:u.string=z.value;break;default:return}w.push(u)}else l=!1});return l?w:[]}e.d(K,"a",function(){return m});var f=e(2124)},2137:function(I,K,e){e.r(K);var m=e(2),f=e(0),a=e(191),l=e(792),w=e(8);class z extends a.a{constructor(ea,Pa){super(!1,!1,!0);this.jpd=(Bb,ac)=>{1===Bb&&(this.oHa.RWf=ac.tooltipPersistenceEnabled,Bb=ac.textSelectionChangeEnabled,
this.oHa.wCc!==Bb&&this.uWk.raiseEvent(l.a.Auj),this.oHa.wCc=Bb)};this.oHa=ea;this.uWk=Pa}start(){const ea={["tooltipPersistenceEnabled"]:this.oHa.RWf};ea.textSelectionChangeEnabled=this.oHa.wCc;this.ti("",this.jpd,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:ea});w.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(f.a)(z,"AccessibilitySettingsDialog",a.a,[]);var x=e(98),u=e(12);class v{constructor(ea,Pa){this.Xcp=()=>{(new z(this.oHa,l.a.instance())).start();
return 32};this.ga=ea;this.oHa=Pa}mc(){this.ga.qa(u.a.Wcp,x.a.frame,this.Xcp)}}Object(f.a)(v,"AccessibilitySettingsDialogActor",null,[871]);var E=e(347);const y=ea=>{const Pa=new E.a;m.AFrameworkApplication.pe.addRequest(D(ea),1,null,null,!0,2,Bb=>{200===Bb.data.Xe?Pa.setResult("true"===Bb.data.responseData.toLowerCase()):Pa.setResult(!1)},()=>{Pa.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return Pa.task},H=(ea,Pa)=>{m.AFrameworkApplication.pe.addRequest(D(ea),2,Pa.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},D=ea=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",ea,m.AFrameworkApplication.lm);var G=e(152);class J{constructor(){this.Cdc=this.Y9b=null}get RWf(){return!!this.Y9b}set RWf(ea){ea!==this.Y9b&&(this.Y9b=ea,G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ea),this.Yie()&&H("saveHoverableRibbonTooltipIsEnabled",ea))}get wCc(){return!!this.Cdc}set wCc(ea){ea!==
this.Cdc&&(this.Cdc=ea,this.Yie()&&H("saveTextSelectionHighlightChangeIsEnabled",ea))}BIn(){const ea=new E.a;if(this.Y9b)ea.setResult(this.Y9b);else if(this.Yie()){const Pa=y("getHoverableRibbonTooltipIsEnabled");Pa.continueWith(()=>{this.Y9b=Pa.result;G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Pa.result);ea.setResult(Pa.result)},8)}else ea.setResult(!1)}fJn(){const ea=new E.a;if(this.Cdc)ea.setResult(this.Cdc);else if(this.Yie()){const Pa=y("getTextSelectionHighlightChangeIsEnabled");
Pa.continueWith(()=>{this.Cdc=Pa.result;ea.setResult(Pa.result)},8)}else ea.setResult(!1)}Yie(){const ea=m.AFrameworkApplication.J.$("IsRoamingServiceEnabled"),Pa=m.AFrameworkApplication.J.$("IsAnonymousUser");return ea&&!Pa}}Object(f.a)(J,"AccessibilitySettingsInfo",null,[870]);var U=e(186),F=e(25);class T{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}Ec(ea){this.Z=ea;this.Z.register(J,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").fe(()=>
new J).ha();this.Z.register(v,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").fe(()=>new v(m.AFrameworkApplication.va,this.Z.Wa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const ea=this.Z.Wa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Pa=this.Z.Wa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");ea&&Pa?(Pa.mc(),ea.BIn(),ea.fJn(),F.b(508827098,
200,50,"Text Selection Highlight Change Setting value on boot: {0}",ea.wCc)):F.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){U.a.instance.Rc(new T)}}Object(f.a)(T,"AccessibilitySettingsPackage",null,[0,1]);var Y=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",
Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},P=e(118),S=e(92);class N extends Sys.EventArgs{constructor(ea,Pa){super();this.nGe=ea;this.actualValue=Pa}}Object(f.a)(N,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class V{constructor(){this.T7b=[];this.oih=this.HRe=0;this.Tk=null;this.sa=new S.a;this.mJl=(ea,Pa)=>{F.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.V0d(Pa.nGe,
Pa.actualValue))}}init(ea,Pa,Bb){this.Tk=ea;this.HRe=Pa;this.oih=Bb;this.Tk.mjf(Object(P.a)(this,this.Hpe,"onCpuMeterFrameAvailable"));this.k7k(this.mJl)}Hpe(ea,Pa){Pa.amj&&(Array.enqueue(this.T7b,Pa.amj.CP),this.T7b.length>this.oih&&(Array.dequeue(this.T7b),this.Rul()))}Rul(){var ea=this.T7b.length;let Pa=0;for(let Bb=0;Bb<ea;Bb++){const ac=Array.dequeue(this.T7b);Pa+=ac;Array.enqueue(this.T7b,ac)}ea=Pa/ea;ea>this.HRe&&this.sa.raiseEvent("CPTTE",new N(this.HRe,ea))}k7k(ea){this.sa.addHandler("CPTTE",
ea)}V0d(ea,Pa){const Bb={};Bb.ThresholdValue=ea;Bb.ActualValue=Pa;return Bb}}Object(f.a)(V,"CpuMeterMonitor",null,[957]);class Z{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(Z,"ProfileInformation",null,[]);var ca=e(10),W=e(37),X=e(226),ka=e(84);class ma{constructor(ea=0,Pa=0){this.ZGb=!1;this.zGb={};this.TJd=ea;this.lKd=Pa;this.Mef=0;W.a.addHandler(window.self,ca.a.dWh,()=>{this.ZGb=!0});W.a.addHandler(window.self,ca.a.eWh,()=>{this.ZGb=!1})}gWh(ea,Pa,Bb){const ac=ma.generateKey(Pa,Bb);
ac in this.zGb?Pa=this.zGb[ac]:(Pa=new Z,Pa.S=Bb?1:0,this.zGb[ac]=Pa,this.Mef++);Pa.C++;Pa.M=ea>Pa.M?ea:Pa.M;Pa.T+=ea}hKa(ea,Pa){this.gWh(ea,Pa,!1);this.ZGb&&this.gWh(ea,Pa,!0)}getData(){if(0<this.lKd&&this.Mef>this.lKd)return this.Xum();const ea=0<this.TJd,Pa={},Bb=this.zGb;for(const Gc in Bb){var ac=Gc;const ld=Bb[Gc];this.gOj(ld);ea&&ld.T>=this.TJd&&(Pa[ac]=ld)}return ea?ka.a.jg(Pa)?null:Pa:this.zGb}Xum(){var ea=0<this.TJd,Pa=[];const Bb=this.zGb;for(const ac in Bb){const Gc={key:ac,value:Bb[ac]},
ld=Gc.value;(!ea||ld.T>=this.TJd)&&Array.add(Pa,Gc)}if(Pa.length>this.lKd)Pa.sort((ac,Gc)=>Gc.value.T-ac.value.T),Pa=Pa.slice(0,this.lKd);else if(!Pa.length)return null;ea={};for(const ac of Pa)Pa=ac.value,this.gOj(Pa),ea[ac.key]=Pa;return ea}gOj(ea){ea.M=X.a.DP(ea.M,0);ea.T=X.a.DP(ea.T,0)}reset(){this.zGb={};this.Mef=0}static generateKey(ea,Pa){return Pa?ea+" [it]":ea}}Object(f.a)(ma,"FunctionCallAggregator",null,[873]);var ja=e(1189);class na{}Object(f.a)(na,"CpuMeterFrame",null,[]);class Ba extends Sys.EventArgs{constructor(ea){super();
this.amj=ea}}Object(f.a)(Ba,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class Ma{}Object(f.a)(Ma,"MiniTaskItemInfo",null,[]);class Ea{}Object(f.a)(Ea,"TaskItemInfo",null,[]);var ya=e(1056),ia=e(1285),za=e(189);class Ca{constructor(ea,Pa,Bb,ac,Gc){this.gLb=0;this.M3=null;this.TOd=this.yLh=0;this.tAa=!1;this.m9b=0;this.CMc=!1;this.dAa=null;this.iHd=0;this.h5e=new S.a;this.tRd=[];this.oD=ea;this.f3e=Pa;this.iWe=Bb;this.Bzh=ac;m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.vsc();this.ZAk=Gc;this.jWe=new ma(100);this.pKk=ya.a.OI(1,5,new ia.a)}mjf(ea){this.h5e.addHandler("OnCpuMeterFrameAvailable",ea)}HJj(ea){this.h5e.removeHandler("OnCpuMeterFrameAvailable",ea)}rzb(ea,Pa,Bb,ac=null){Bb=ac?ac.priority:7;const Gc=this.oD();this.start(Pa,Bb);try{ea()}finally{this.stop(Pa,ac),ea=this.oD()-Gc,this.Bzh.track(ea,Pa)}}Ae(ea,Pa){const Bb=this.oD();try{ea()}finally{ea=this.oD()-Bb,this.iWe.hKa(ea,Pa),0<this.gLb&&this.jWe.hKa(ea,Pa),this.Bzh.track(ea,Pa)}}Rkg(ea){const Pa=
new Ea;Pa.TN=ea.C$f;Pa.TP=ea.priority;this.cEj(1,Pa)}Ytc(ea){this.iHd|=ea}start(ea,Pa){if(!this.gLb){this.jWe.reset();const Bb=this.l9i(ea);Bb&&this.Jme(1);this.M3=new Ea;this.M3.TN=ea;this.M3.TP=Pa;this.M3.ST=(new Date).toISOString();this.M3.STS=X.a.DP(this.oD(),2);Bb?this.M3.UI=1:this.zun(ea)?this.M3.UI=2:this.M3.UI=0}this.gLb++}Jme(ea){this.m9b|=ea}gZd(ea=!0,Pa=0){this.m9b=ea?0:this.m9b&~Pa}stop(ea,Pa=null){let Bb;this.gLb--;0>=this.gLb&&this.M3&&(Bb=this.oD()-this.M3.STS,this.TOd+=Bb,this.f3e.hKa(Bb,
ea),this.l9i(ea)&&this.gZd(!1,1),this.M3.TRT=X.a.DP(Bb,2),Pa&&(this.M3.TQT=X.a.DP(Pa.Hto,2),this.M3.TDT=X.a.DP(Pa.I$i,2)),this.ZAk&&(this.cEj(0,this.M3),this.wMo()),this.gLb=0);0<=ea.indexOf(ja.a.mzp)&&this.Ytc(2);0<=ea.indexOf(ja.a.PKj)&&this.Ytc(4);1===(this.m9b&1)&&this.Ytc(1);2===(this.m9b&2)&&this.Ytc(8)}wMo(){var ea=this.M3.TRT;if(750<ea){let Bb=this.jWe.getData();if(Bb){const ac={};for(const Gc in Bb){var Pa=Bb[Gc];const ld=Gc;ld.startsWith("SiOp_")||ld.endsWith("[it]")||(ac[ld]=Math.round(100*
Pa.T/ea))}Bb=ac}ea=Object.assign(new Ma,{B:this.M3.STS,T:ea,S:Bb});this.pKk.track(ea,this.M3.TN)}}bip(){var ea=this.oD()-this.yLh,Pa=X.a.DP(this.TOd/ea*100,2);ea=new na;ea.CP=Pa;ea.II=this.iHd;Pa=this.f3e.getData();ka.a.count(Pa)&&(ea.LRT=Pa);Pa=this.iWe.getData();ka.a.count(Pa)&&(ea.FP=Pa);this.h5e.raiseEvent("OnCpuMeterFrameAvailable",new Ba(ea));this.k2j()}k2j(){this.f3e.reset();this.iWe.reset();this.TOd=this.gLb=0;this.yLh=this.oD();this.iHd=0;this.M3=null}run(){this.tAa?this.bip():(this.k2j(),
this.tAa=!0);this.dAa?this.dAa(Object(P.a)(this,this.run,"run"),1E3):window.setTimeout(Object(P.a)(this,this.run,"run"),1E3)}jUd(ea,Pa,Bb){const ac=Array(2);ac[0]=Pa;ac[1]=Bb;this.tRd[ea]||(this.tRd[ea]=[]);this.tRd[ea].push(ac)}cEj(ea,Pa){ea=this.tRd[ea];if(!za.a.jg(ea))for(let ac=0;ac<ea.length;ac++){var Bb=ea[ac];const Gc=Bb[0];Bb=Bb[1];Gc&&!Gc(Pa)||Bb(Pa)}}vsc(){if(!this.CMc){const ea=window.setTimeout;this.dAa=(Pa,Bb)=>ea(Pa,Bb);this.CMc=!0}}l9i(ea){return ea.startsWith("key")||ea.startsWith("input")}zun(ea){return ea.startsWith("click")||
ea.startsWith("mouse")||ea.startsWith("pointer")}}Object(f.a)(Ca,"CpuMeter",null,[110]);class db{constructor(ea){this.fIc=null;this.Xr=new E.a;this.oD=ea}initialize(ea,Pa,Bb,ac=!1){this.fIc||(this.fIc=new Ca(this.oD,ea,Pa,Bb,ac),this.Xr.setResult(this.fIc));return this.fIc}}Object(f.a)(db,"CpuMeterProvider",null,[956]);var pa=e(183);class ua{constructor(ea=1){this.ZG=[];this.aDd=[];this.ul=ea}sem(){let ea=0;for(let Pa=0;Pa<this.ZG.length;Pa++)this.ZG[Pa]<this.ZG[ea]&&(ea=Pa);return ea}hKa(ea,Pa){ea=
X.a.DP(ea,2);if(this.ZG.length<this.ul)Array.add(this.ZG,ea),Array.add(this.aDd,Pa);else{var Bb=this.sem();ea>this.ZG[Bb]&&(this.ZG[Bb]=ea,this.aDd[Bb]=Pa)}}getData(){return this.ZG.length?{["Vals"]:this.ZG,["Desc"]:this.aDd}:null}reset(){this.ZG=[];this.aDd=[]}}Object(f.a)(ua,"MaxDataAggregator",null,[873]);var Ga=e(59),wa=e(21);class xa{get name(){return"Common.App.CpuMeter"}Ec(ea){ea.register(db,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().fe(()=>new db(Ga.a.We));
ea.register(V,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().fe(()=>new V)}init(){const ea=m.AFrameworkApplication.J;if(ea.$("CpuMeterIsEnabled")){const Pa=wa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");pa.a.instance.dlf.continueWith(()=>{xa.zdn(ea,Pa)})}}dispose(){}static zdn(ea,Pa){const Bb=ya.a.OI(10,5,new ma(ea.sc("TaskManagerLoggingThreshold",0),ea.sc("CpuMeterMaximumEntriesToLog",0)));Pa=Pa.initialize(new ua(5),new ma,Bb,ea.$("CPUMeterExposeTaskDetailsIsEnabled"));
ea.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(Pa.run(),ea.$("CpuMeterMonitorIsEnabled")&&wa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Pa,ea.JL("CpuMeterAverageCpuPercentThreshold",80),ea.sc("CpuMeterRollingAverageFramesCount",15)));F.b(16827671,306,50,"Initializing CpuMeter")}static main(){U.a.instance.Rc(new xa)}}Object(f.a)(xa,"CpuMeterPackage",null,[0,1]);var sa=e(90),Ka=e(1079),Na=e(1066),ub=e(17),Ua=e(1286);class sb{constructor(){this.iAa=this.bGc=null;this.gMb=
!0;this.MMc=!1}Ec(ea){m.AFrameworkApplication.J.$("EventTimingMeterIsEnabled")&&ea.register(834,"Common.IEventTimingMeter").ha().fe(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var ea=new Na.a(m.AFrameworkApplication.J.sc("EventTimingMeterEventSamplingPercent",0)/100);ea=new Ka.a(Object(P.a)(ea,ea.P2b,"shouldBeInSample"));const Pa=ya.a.OI(16,1,ea);this.iAa=new Ua.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.JL("AshaVetoForTypingThresholdInMS",
150),m.AFrameworkApplication.J.JL("AshaVetoForTypingThresholdPercentile",95),this.gMb);(this.MMc=!ub.a.Xcb)&&m.AFrameworkApplication.IG(()=>{this.yrf()});this.bGc=Bb=>{Bb=Bb.rawEvent.detail;for(const ac of Bb)Pa.track(ac,"EventTimingData"),"false"!==ac.metadata.altPressed.toString()||"false"!==ac.metadata.ctrlPressed.toString()||"false"!==ac.metadata.repeat.toString()||"CharacterKey"!==ac.metadata.key.toString()&&"Space"!==ac.metadata.key.toString()||!this.MMc||this.iAa.BFa(ac.timeToRequestAnimationFrameMs)};
W.a.addHandler(window.self,ca.a.cWh,this.bGc)}dispose(){this.bGc&&(W.a.removeHandler(window.self,ca.a.cWh,this.bGc),this.bGc=null)}yrf(){this.iAa.k1a();this.iAa.Zvj&&(w.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),sa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){U.a.instance.Rc(new sb)}}Object(f.a)(sb,"EventTimingMeterPackage",null,[0,1]);var qb=e(76),ab=e(87),Xa=e(29);class wb{constructor(ea,
Pa,Bb,ac=null,Gc=null){this.sTb=ld=>{let Gd=!1,ue=null;try{if(0<ld.data.responseData.length){const Ce=Object(ab.a)(Object,Xa.a(ld.data.responseData)),tf=Ce?Ce[this.nQ.flf]:null;tf&&(ue=Object(ab.a)(Object,Xa.a(tf.toString())))}Gd=!0}catch(Ce){this.kbb(null)}Gd&&this.WKc&&this.WKc(ld.data,ue)};this.kbb=ld=>{this.QKc&&this.QKc(ld?ld.data:null)};this.Flo=ld=>{this.fFh&&this.fFh(ld?ld.data:null)};this.$eb=ld=>{this.zQc&&this.zQc(ld?ld.data:null)};this.nQ=ea;this.WKc=Pa;this.QKc=Bb;this.fFh=ac;this.zQc=
Gc}TEf(ea){const Pa=new Sys.StringBuilder(this.nQ.Dpd);Pa.append("RoamingServiceHandler.ashx?action=");Pa.append("getFirstRunExperienceSettings");Pa.append("&");Pa.append(this.cQf(ea));Pa.append("&");Pa.append(m.AFrameworkApplication.lm);m.AFrameworkApplication.pe.addRequest(Pa.toString(),1,null,null,!0,2,this.sTb,this.kbb,null)}A5d(ea){var Pa=new Sys.StringBuilder(this.nQ.Dpd);Pa.append("RoamingServiceHandler.ashx?action=");Pa.append("saveFirstRunExperienceSettings");Pa.append("&");Pa.append(m.AFrameworkApplication.lm);
Pa=Pa.toString();ea=Xa.c(ea);m.AFrameworkApplication.pe.addRequest(Pa,2,ea,null,!0,4,this.Flo,this.$eb,null)}cQf(ea){const Pa=new Sys.StringBuilder("requestedsettings=");for(let Bb=0;Bb<ea.count;Bb++)Pa.append(ea.K(Bb)),Bb<ea.count-1&&Pa.append(";");return Pa.toString()}}Object(f.a)(wb,"FirstRunExperienceRequestHandler",null,[]);var Sa=e(255);class cc{constructor(){this.wKc=this.PEd=this.nQ=null;this.sTb=(ea,Pa)=>{ea=ea?+ea.MQ-+ea.ZI:-1;ea>this.nQ.TNj?w.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
ea,this.nQ.TNj):Pa?this.Ucp(Pa)?(w.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.nQ.Mjj),this.NGg()):(this.WAf(!1),w.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(w.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.NGg())};this.kbb=ea=>
{this.WAf(!1);w.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",ea?ea.Xe:-1)};this.$eb=ea=>{w.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",ea?ea.Xe:-1)};this.R4n=ea=>{if(ea){var Pa=ea.detail;ea=ea.type;var Bb=this.nQ&&this.nQ.Y3h?this.nQ.Y3h.split("-")[0]:null;if("FRELaunchedEvent"===ea||Bb&&Pa&&Pa.id&&-1!==Pa.id.indexOf(Bb)){if("FRELaunchedEvent"===
ea||Pa&&Pa.success)w.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.YOj(this.nQ.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.wKc,!0),window.removeEventListener("FRELaunchedEvent",this.wKc,!0))}}}}iep(ea){ea?(this.nQ=ea,this.tun()&&(w.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),ea=new qb.a,ea.add(this.nQ.flf),this.PEd=new wb(this.nQ,
this.sTb,this.kbb,null,this.$eb),this.PEd.TEf(ea)),(this.nQ.B8i||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.NGg()):w.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}tun(){try{if(this.nQ.B8i)return!0;if(!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.J.$("IsAnonymousUser"))return!1;if(this.nQ.Mon||this.nQ.Urc||m.AFrameworkApplication.J.$("IsO365ConsumerHost"))return!0;
const ea=m.AFrameworkApplication.J.rb("FlightId");return-1!==(ea?ea.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(ea){w.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",ea?ea.toString():null)}return!1}YOj(ea){const Pa={},Bb={};Bb.FREDisplayedDate=(new Date).toUTCString();Bb.VersionDisplayed=ea;Bb.RemindMeLater=!1;Pa[this.nQ.flf]=Xa.c(Bb);w.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.PEd&&
this.PEd.A5d(Pa)}NGg(){this.WAf(!0);var ea=wa.a.instance.Wa("Common.ISystemInitiatedFeedback");ea?this.ZZj(ea):(w.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((ea=wa.a.instance.Za("Common.ISystemInitiatedFeedback"))?ea.execute(Pa=>{this.ZZj(Pa)}):w.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}ZZj(ea){if(ea){var Pa=
this.nQ.$gm;Pa&&m.AFrameworkApplication.Goa(Pa);w.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Pa);ea.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.wKc=this.R4n,window.addEventListener("FGWebSurfaceEvent",this.wKc,!0),window.addEventListener("FRELaunchedEvent",this.wKc,!0)):(w.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.YOj(this.nQ.currentVersion))}else w.ULS.sendTraceTag(539494112,
306,50,"Invalid ISystemInitiatedFeedback")}Ucp(ea){if("RemindMeLater"in ea&&"FREDisplayedDate"in ea){if("true"===ea.RemindMeLater.toString()&&(+new Date-+new Date(ea.FREDisplayedDate.toString()))/36E5>this.nQ.Mjj)return!0}else if(m.AFrameworkApplication.J.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in ea&&ea.VersionDisplayed<this.nQ.currentVersion)return w.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}WAf(ea){m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Sa.a.dispatch("FREDecisionEvent",{["show"]:ea})}}Object(f.a)(cc,"FirstRunExperienceLauncher",null,[833]);class Cb{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Ec(ea){this.Z=ea;this.Z.register(833,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().fe(()=>new cc)}init(){}dispose(){}static main(){U.a.instance.Rc(new Cb)}}Object(f.a)(Cb,"FirstRunExperienceLauncherPackage",null,[0,1]);class Wa{constructor(){this.y=this.x=0}}Object(f.a)(Wa,"HammerPoint",
null,[]);class Ja{constructor(ea,Pa,Bb,ac,Gc){this.Ixh=this.D5a=this.XGd=1;this.ASd=this.bUc=this.W7a=0;this.x4e=this.qSa=null;this.ZDb=this.AVe=this.tNd=!1;this.wk=ea;this.UUa=Pa;this.enb=Bb;this.ga=ac;Gc&&(this.tNd=Gc.$("PromoteLayerPinchToZoomIsEnabled"),this.AVe=Gc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.ZDb=Gc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get zK(){return this.UUa}get yAg(){return this.enb}yrn(){return!!this.wk.instance}p5n(ea){this.ga&&this.ga.Vb(u.a.y2j,2);const Pa=
this.wk.instance;this.tNd&&Pa.WDj();this.D5a=Pa.Ql;this.XGd=ea.B4c.scale;this.Ixh=1;this.x4e=this.H3h();this.qSa=this.UUa.getBounds();if(!this.qSa)return w.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;ea=this.AJi(ea);this.ZDb?this.OUj(this.UUa.scrollWidth,this.qSa.width,ea,this.D5a,Pa):this.W7a=this.UUa.scrollWidth>this.qSa.width?this.xXc(this.enb.scrollLeft,ea.x,this.D5a):null;this.ASd=this.UUa.scrollHeight>this.qSa.height?this.xXc(this.enb.scrollTop,ea.y,this.D5a):null;return!0}kyg(){this.W7a=
null;this.bUc=0}OUj(ea,Pa,Bb,ac,Gc){ea>Pa?this.W7a?(ea=Gc.v7f,ea!==this.bUc&&(this.W7a-=this.bUc-ea,this.bUc=ea)):(this.W7a=this.xXc(this.enb.scrollLeft,Bb.x,ac),this.bUc=Gc.v7f):this.kyg()}o5n(ea){const Pa=this.AJi(ea);if(!Pa)return w.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;ea=this.v0o(ea.B4c.scale/this.XGd)*this.D5a;this.EHp(Pa,ea);this.FHp(Pa,ea);return!0}EHp(ea,Pa){const Bb=this.UUa.scrollWidth,ac=this.qSa.width;this.ZDb?this.OUj(Bb,ac,ea,Pa,this.wk.instance):!this.W7a&&
Bb>ac&&(this.W7a=this.xXc(this.enb.scrollLeft,ea.x,Pa));if(ea=this.L3h(ea.x,this.W7a,Bb,ac,Pa))this.enb.scrollLeft=ea}FHp(ea,Pa){const Bb=this.UUa.scrollHeight,ac=this.qSa.height;!this.ASd&&Bb>ac&&(this.ASd=this.xXc(this.enb.scrollTop,ea.y,Pa));if(ea=this.L3h(ea.y,this.ASd,Bb,ac,Pa))this.enb.scrollTop=ea}L3h(ea,Pa,Bb,ac,Gc){return Bb<=ac||!Pa||!ac?null:Math.max(0,Math.min(Pa*Gc-ea,Bb-ac))}xXc(ea,Pa,Bb){return(ea+Pa)/Bb}n5n(ea){ea=ea.B4c.scale;this.AVe&&(ea/=this.XGd);this.jti(ea);this.tNd&&this.wk.instance.jtg();
this.ga&&this.ga.Vb(u.a.xDf,2);this.ZDb&&this.kyg()}m5n(ea){ea=ea.B4c.scale;this.AVe&&(ea/=this.XGd);this.jti(ea,!0);this.tNd&&this.wk.instance.jtg();this.ga&&this.ga.Vb(u.a.xDf,2);this.ZDb&&this.kyg()}v0o(ea){const Pa=this.wk.instance,Bb=new Date>=this.x4e;Bb&&(this.x4e=this.H3h());Math.abs(ea-this.Ixh)>=.01*ea&&Pa.B7o(ea*this.D5a,Bb);return Pa.Ql/this.D5a}jti(ea,Pa=!1){ea*=this.D5a;this.wk.instance.FEg(ea,!1);const Bb={};Bb.initialScale=this.D5a;Bb.finalScale=ea;Bb.cancelled=Pa;w.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",Bb)}AJi(ea){return(ea=ea.B4c.center)&&this.qSa?Object.assign(new Wa,{x:ea.x-this.qSa.x,y:ea.y-this.qSa.y}):null}H3h(){const ea=(new Date).getTime();return new Date(ea+1E3)}}Object(f.a)(Ja,"PinchZoomAdapter",null,[900]);class Va{constructor(ea){this._element=ea}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(Va,"ScrollContainerElement",null,
[899]);var mb=e(134);class Ab{constructor(ea,Pa,Bb,ac,Gc,ld){this.$bf=this.Lkb=null;this.Z=ea;this.qe=Pa;this.fId=Bb;this.tvh=ac;this.SHk=Gc;this.P9b=ld;this.KBd=new qb.a}register(ea,Pa){this.fId&&(4===m.AFrameworkApplication.ta.Pb.gl&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?mb.a.get_instance().Zk(8,()=>{this.vMj(ea,Pa)}):this.vMj(ea,Pa))}vMj(ea,Pa){this.Z.Za("Common.IGestureInputManager").execute(Bb=>{this.Nkp();this.Lkb=Bb;this.KBd.add(ea);
if(this.tvh){if(this.SHk&&0!==Bb.LAm()){this.f3j();return}var ac=this.Z.Za("Common.IZoomManager");this.Z.resolve("Common.IAppSettingsManager");const Gc=new Va(ea);ac=new Ja(ac,Gc,Pa,m.AFrameworkApplication.va,m.AFrameworkApplication.J);Bb.aCo(ea,ac)}this.f3j()})}unregister(){if(this.Lkb&&this.KBd){if(this.tvh){for(const ea of this.KBd)this.Lkb.TAp(ea);this.KBd.clear()}this.Lkb=null}}Nkp(){this.P9b&&(this.qe?this.$bf=this.qe.rg("Task","Register"):w.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}f3j(){this.P9b&&
(this.$bf?this.$bf.stop():w.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(Ab,"GestureInputRegistrar",null,[832]);class Xb{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInput"}init(){this.vi||(this.Z.resolve("Common.IGestureInputRegistrar"),this.vi=!0)}dispose(){}Ec(ea){this.Z=ea;ea.register(832,"Common.IGestureInputRegistrar").ha().fe(()=>new Ab(ea,m.AFrameworkApplication.ta.Kt,m.AFrameworkApplication.bcd(),m.AFrameworkApplication.T5i(),
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("PinchZoomOnlyPointerEventsIsEnabled"),!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled")))}static main(){U.a.instance.Rc(new Xb)}}Object(f.a)(Xb,"GestureInputPackage",null,[0,1]);var Lb=e(426),dc=e(103);class yc{constructor(){this.Bzb=this.Ixi=null}}Object(f.a)(yc,"GestureAdapterInfo",null,[]);var Wc=e(638),zb=e(308);class cd{constructor(){this.yFb=null}$8f(){if(!this.yFb){var ea="hammer.min.js";
m.AFrameworkApplication.J.RA("IsServerFlavorDebug")&&(ea=m.AFrameworkApplication.J.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");ea=m.AFrameworkApplication.Lz(String.format("{0}",ea),5);ea=zb.a.create(ea,null,null);Wc.a.UY(ea);this.yFb=ea.xdb}return this.yFb}static get instance(){cd._instance||(cd._instance=new cd);return cd._instance}}cd._instance=null;Object(f.a)(cd,"HammerJsDependencyLoader",null,[902]);const qc=(ea,Pa,Bb=null)=>{if(void 0===Pa||null===Pa)throw w.ULS.sendTraceTag(42256258,
310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let ac=null;switch(ea){case ca.a.Ete:ac=new Hammer.Pinch(Bb);break;case ca.a.pan:ac=new Hammer.Pan(Bb)}ac&&(ac.manager=Pa);return ac};var Dc;(function(ea){ea[ea.none=-1]="none";ea[ea.Ete=0]="pinch";ea[ea.pan=1]="pan";ea[ea.kKg=2]="swipe"})(Dc||(Dc={}));Object(f.b)("GestureEvent",Dc);var mc=e(73);class lc extends mc.a{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){super(ea,Bb,ac,ld);this.vHc=Pa;this.y7a=Gd;this.fza=ue;this.CCk=Gc}get shiftKey(){return this.y7a}get ctrlKey(){return this.fza}get clientPoint(){return this.vHc}get B4c(){return this.CCk}static create(ea,
Pa,Bb,ac,Gc,ld){if(Bb.rawEvent)if(ld){var Gd=Bb.rawEvent;Gd=new Sys.UI.Point(Gd.clientX,Gd.clientY)}else Gd=mc.a.D8d(Bb);else Gd=new Sys.UI.Point(Bb.clientX,Bb.clientY);return new lc(ea,Gd,Pa,Bb,ac,Gc,Bb.shiftKey,Bb.ctrlKey,ld)}}Object(f.a)(lc,"GestureEventArgs",mc.a,[]);class Vb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Vb,"GestureManagerData",null,[]);class yb{}yb.Nok=2;yb.Ook=4;yb.Pok=8;yb.Qok=8;Object(f.a)(yb,"HammerConstants",null,[]);var Db=e(116),$b=e(135),Fa=e(16),lb=e(119);class kb extends W.a{constructor(ea,Pa){super();this.BTa=Lb.a.$lm;this.p7e=!!window.PointerEvent;this.MNh=window.hasOwnProperty("ontouchstart");this.DGb=this.wPc=null;this.pTa=
!1;this.bsa=new dc.a;this.xQc=new dc.a;this.Moh=new qb.a;this.Qjb=null;this.i7b=this.P9b=this.dgh=this.VPe=this.X2e=this.sHh=this.wgh=this.jUc=!1;this.nOc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.acf=null;this.Kyb=(Bb,ac,Gc)=>{Bb=this.qFi(Bb);ac=this.qDm(Gc);Hammer.inputHandler(this,Bb,ac);this.pTa&&Gc.preventDefault();return this.pTa};this.Yqe=(Bb,ac,Gc)=>{var ld=Gc.rawEvent.pointerType.toString();const Gd=Gc.rawEvent.pointerId.toString();if("touch"!==ld)return!1;Bb=this.qFi(Bb);
if(1!==Bb&&!this.bsa.Bb(Gd))return!1;this.wgh&&1===Bb&&Gc.rawEvent.isPrimary&&this.bsa.count&&(w.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.cYd());this.jUc?this.D3k(Gd,ac,Gc):this.bsa.W(Gd,Gc);this.X2e&&2===Bb&&(!this.VPe||this.VPe&&"function"===typeof Gc.rawEvent.getCoalescedEvents)&&(ac=Gc.rawEvent.getCoalescedEvents())&&this.ZRi()&&(this.nOc=Math.max(this.nOc,ac.length));this.sHh&&(this.pTa=!1);ld=this.pDm(this.bsa,Gc,ld);Hammer.inputHandler(this,Bb,ld);if(4===Bb||
8===Bb)this.jUc?this.NIj(Gd):this.bsa.remove(Gd),this.bsa.count||(this.session=null,this.X2e&&-1!==this.nOc&&(w.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.nOc),this.nOc=-1));this.pTa&&Gc.preventDefault();return this.pTa};this.Jqe=()=>!1;this.Yg=Db.EventHandlerManager.instance;this.p7e?(w.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.wPc=this.Yqe,this.DGb=ca.a.bmm):this.MNh?(w.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.wPc=this.Kyb,
this.DGb=ca.a.u4b):(w.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.wPc=this.Jqe,this.DGb=ca.a.amm);this.qe=Pa;this.m7=ea;m.AFrameworkApplication.J&&(this.jUc=m.AFrameworkApplication.J.$("UsePointerCaptureIsEnabled"),this.wgh=m.AFrameworkApplication.J.$("ClearCacheOnPrimaryPointerIsEnabled"),this.sHh=m.AFrameworkApplication.J.$("ResetHandledBeforeInputHandlerIsEnabled"),this.X2e=m.AFrameworkApplication.J.$("LogCoalescedEventsIsEnabled"),this.VPe=m.AFrameworkApplication.J.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.dgh=m.AFrameworkApplication.J.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.P9b=m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled"),this.i7b=this.jUc&&m.AFrameworkApplication.J.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.J.$("UseGestureInputManagerPointerCacheIsEnabled"))}LAm(){return this.p7e?0:this.MNh?1:2}Sx(ea){super.Sx(ea);this.Yg.sNa(this.DGb,ea,0,this.wPc)}Nx(ea){super.Nx(ea);this.Yg.f$a(ea,this.DGb)}aCo(ea,Pa){m.AFrameworkApplication.bcd()?
cd.instance.$8f().continueWith(Bb=>{this.Mkp();if(Bb.wj||Bb.mq)w.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Bb.status);else{w.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Bb.status);if(this.dgh){Bb=window.Hammer;if("undefined"===typeof Bb){w.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.yEe();return}if("undefined"===typeof Bb.inputHandler){w.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.yEe();return}}if(!ea)throw this.yEe(),
Error.argumentNull("source element can not be null");Bb=$b.a.Mb(ea,this.BTa);if(void 0===Bb||null===Bb)Bb=new dc.a,$b.a.un(ea,this.BTa,Bb),this.bCo(ea);if(!Bb.Bb(Dc[0])){var ac=Object.assign(new yc,{Bzb:qc(Dc[0],this,null),Ixi:Pa});Bb.add(Dc[0],ac)}}this.yEe()}):w.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}Mkp(){this.P9b&&(this.qe?this.acf=this.qe.rg("Task","RegisterGestureAdapterAfterLoad"):w.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}yEe(){this.P9b&&
(this.acf?this.acf.stop():w.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}TAp(ea){w.ULS.sendTraceTag(42256223,310,ea?100:10,"source element {0} ",ea.id);const Pa=$b.a.Mb(ea,this.BTa);void 0!==Pa&&null!==Pa&&(Pa.remove(Dc[0]),Pa.count||($b.a.ZZ(ea,this.BTa),this.curRecognizer=null,this.UAp(ea)))}bCo(ea){this.Moh.add(ea);this.Yg.sNa(this.DGb,ea,0,this.wPc)}UAp(ea){this.Moh.remove(ea);this.Yg.f$a(ea,this.DGb)}recognize(ea){var Pa=Array(ea.pointers.length);
for(var Bb=0;Bb<ea.pointers.length;Bb++)Pa[Bb]=ea.pointers[Bb].target;Bb=null;for(this.Qjb=this.aGm(Pa);void 0!==this.Qjb&&null!==this.Qjb&&(Bb=$b.a.Mb(this.Qjb,this.BTa),void 0===Bb||null===Bb);this.Qjb=this.Qjb.parentNode);if(void 0!==Bb&&null!==Bb){this.curRecognizer&&this.curRecognizer.state===yb.Qok&&(this.curRecognizer=null);Pa=Bb.keys;for(const ac of Pa){Pa=Bb.K(ac);void 0!==Pa&&null!==Pa&&void 0!==Pa.Bzb&&null!==Pa.Bzb&&(void 0===this.curRecognizer||null===this.curRecognizer||Pa.Bzb===this.curRecognizer||
Pa.Bzb.canRecognizeWith(this.curRecognizer))&&Pa.Bzb.recognize(ea);const Gc=Pa.Bzb.state;this.curRecognizer||yb.Nok!==Gc&&yb.Ook!==Gc&&yb.Pok!==Gc||(this.curRecognizer=Pa.Bzb)}}}emit(ea,Pa){if("hammer.input"!==ea){this.pTa=!1;Pa=lc.create(ea,this.Qjb,Pa.srcEvent,Pa,3,this.p7e);var Bb=$b.a.Mb(this.Qjb,this.BTa);if(this.zwn(ea))var ac=0;else if(this.Wvn(ea))ac=1;else if(this.gAn(ea))ac=2;else{w.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Bb}=Bb.Nc(Dc[ac]));
void 0!==Bb&&null!==Bb&&((Bb=Bb.Ixi,Bb.yrn())?ea.endsWith("start")?this.pTa=Bb.p5n(Pa):ea.endsWith("end")?(Bb.n5n(Pa),this.pTa=!0):ea.endsWith("cancel")?(Bb.m5n(Pa),this.pTa=!0):ea.endsWith("move")&&(this.pTa=Bb.o5n(Pa)):w.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",ea))}}get(ea){return Object(ab.a)(Hammer.Recognizer,ea)}aGm(ea){if(1>ea.length)return null;if(1===ea.length)return ea[0];var Pa=ea[0],Bb=!0;for(let ac=1;ac<ea.length;ac++){if(!ea[ac])return null;if(Pa!==
ea[ac]){Bb=!1;break}}if(Bb)return Pa;Pa=this.myi(ea[0]);Bb=0;for(const ac of ea){ea=this.myi(ac);if(Pa.K(Pa.count-1)!==ea.K(ea.count-1))return null;for(let Gc=Pa.count-2,ld=ea.count-2;Gc>=Bb&&0<=ld;Gc--,ld--)if(Pa.K(Gc)!==ea.K(ld)){Bb=Gc+1;break}}return Pa.K(Bb)}myi(ea){const Pa=new qb.a;for(;void 0!==ea&&null!==ea;ea=ea.parentNode)Pa.add(ea);return Pa}qFi(ea){switch(ea){case ca.a.HU:case ca.a.PNb:return 1;case ca.a.GU:case ca.a.$of:return 2;case ca.a.gO:case ca.a.QNb:return 4;case ca.a.TGe:case ca.a.Zof:return 8}return 0}ZRi(){return 1<
this.bsa.count}cYd(){w.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.jUc)for(const ea of this.bsa)this.NIj(ea.key);else this.bsa=new dc.a;this.session=null}D3k(ea,Pa,Bb){w.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",ea);if(!this.xQc.Bb(ea)){try{Pa.setPointerCapture(ea)}catch(ac){w.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ac)}this.xQc.add(ea,Pa)}this.bsa.W(ea,Bb);this.i7b&&1<this.bsa.count&&this.m7&&!this.m7.IXc&&(this.m7.IXc=
!0)}NIj(ea){w.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",ea);if(this.xQc.Bb(ea)){try{this.xQc.K(ea).releasePointerCapture(ea)}catch(Pa){w.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Pa)}this.xQc.remove(ea)}else w.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",ea);this.bsa.remove(ea);this.i7b&&1>=this.bsa.count&&this.m7&&this.m7.IXc&&(this.m7.IXc=!1)}qDm(ea){const Pa=new Vb;var Bb=ea.rawEvent;const ac=Bb.touches;
Bb=Bb.changedTouches;Pa.pointers=Array.clone(ac);Pa.pointers=Array.clone(0<ac.length?ac:Bb);Pa.changedPointers=Array.clone(Bb);Pa.srcEvent=ea;Pa.pointerType="touch";return Pa}pDm(ea,Pa,Bb){const ac=new Vb;ac.pointers=lb.toArray(ea.values);ac.changedPointers=[Pa];ac.pointerType=Bb;ac.srcEvent=Pa;return ac}zwn(ea){return Fa.a.startsWith(ea,ca.a.Ete)}Wvn(ea){return Fa.a.startsWith(ea,ca.a.pan)}gAn(ea){return Fa.a.startsWith(ea,ca.a.kKg)}}Object(f.a)(kb,"GestureInputManager",W.a,[867,868]);var Ob=e(316);
class nc{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInputManager"}Ec(ea){ea.register(kb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().fe(()=>new kb(Ob.a.instance,m.AFrameworkApplication.ta.Kt));this.Z=ea}init(){this.vi||(this.Z.resolve("Common.App.GestureManager.GestureInputManager"),this.vi=!0)}dispose(){}static main(){U.a.instance.Rc(new nc)}}Object(f.a)(nc,"GestureInputManagerPackage",null,[0,1]);var zc=e(277),Pb=e(43),tb=
e(1489);class ib{constructor(ea,Pa,Bb){this.Aaf=this.zaf=null;this.Occ=new E.a;this.bjd=ac=>{let Gc=null;Gc&&Gc.length||!ac||!ac.data||(Gc=ac.data.responseData);if(Gc&&Gc.length)try{const ld=Xa.a(Gc);this.zaf=ld.NavBarDataJson;w.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.zaf?({Zv:this.Aaf}=Xa.d(ld.NavBarDataJson)).returnValue?(this.IMn(this.Aaf),this.Occ.setResult(this.Aaf)):(w.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:tb.a.Hvd(this.zaf)}),
this.Occ.oja()):(w.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Occ.oja())}catch(ld){w.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Occ.oja()}else w.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.eid=()=>{this.Occ.oja();w.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.$f=ea;this.oPc=Bb;this.Gla=Pa.appSettings[ib.UNp]||""}get f9o(){return this.Occ.task}get HV(){return this.$f.value}$Mo(){const ea=
{};ea[ib.z3m]=m.AFrameworkApplication.lm;ea["Content-Type"]="application/json; charset=utf-8";w.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Pa=Pb.a.Kq(this.Gla+ib.g9o,ib.r0n,m.AFrameworkApplication.ta.Pb.gl.toString());this.HV.addRequest(Pa,1,"",ea,!0,2,this.bjd,this.eid,null,void 0,void 0,void 0,void 0,"20")}IMn(ea){try{const Pa={};Pa.FlightName=ea.FlightName;Pa.SessionID=ea.SessionID;w.ULS.sendTraceTag(594883776,215,50,Xa.c(Pa))}catch(Pa){w.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return ib._instance||(ib._instance=ib.aSb())}static aSb(){return new ib(new zc.a(()=>m.AFrameworkApplication.pe),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.Pb.gl)}}ib.z3m="X-qs";ib.r0n="at";ib.g9o="O365ShellServiceProxy.ashx";ib._instance=null;ib.UNp="ShellWebServiceBase";Object(f.a)(ib,"O365ShellActor",null,[869]);class Rb{constructor(){this.Z=null;this.Gz=()=>{m.AFrameworkApplication.QQg&&m.AFrameworkApplication.ta.Pb.JN&&this.Z.resolve("Common.App.O365Shell.O365ShellActor").$Mo()}}get name(){return"Common.App.O365Shell"}Ec(ea){this.Z=
ea;this.Z.register(ib,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().fe(()=>new ib(new zc.a(()=>m.AFrameworkApplication.pe),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.Pb.gl))}init(){m.AFrameworkApplication.J.lq(this.Gz)}dispose(){}static main(){U.a.instance.Rc(new Rb)}}Object(f.a)(Rb,"PackageManager",null,[0,1]);class gc{B_a(){}init(){}dispose(){}}Object(f.a)(gc,"NoOpOfflineLogger",null,[909,11]);var xc=e(813);class Nc{}Nc.IVd=0;Object(f.a)(Nc,"OfflineLoggerConstants",
null,[]);var Kc=e(96),fd=e(259),jd=e(320);class Id{constructor(ea,Pa,Bb,ac,Gc,ld){this.M5a=!1;this.Waa=null;this.sIc=this.gac=this.kFb=0;this.NM=this.Mlb=this.lV=null;this.Vm=!1;this.ilg=(Gd,ue)=>{if(void 0!==ue&&null!==ue&&void 0!==ue.args&&null!==ue.args){Gd=!1;if(!this.Mlb.Bb(ue.args.tag)){if(!this.Mlb.Bb(Nc.IVd))return;Gd=!0}this.Mlb.remove(Gd?Nc.IVd:ue.args.tag);this.NM.Bb(ue.uploadId)||this.NM.W(ue.uploadId,new qb.a);this.NM.K(ue.uploadId).add(ue.args)}};this.klg=(Gd,ue)=>{this.NM.remove(ue.uploadId);
this.cIb&&(this.cIb=!1,this.y7h())};this.jlg=(Gd,ue)=>{this.cIb=!0;if(void 0!==ue&&null!==ue&&this.NM.Bb(ue.uploadId)){Gd=!0;var Ce=this.NM.K(ue.uploadId);for(const tf of Ce)Ce=Id.serialize(tf,this.xJa),this.Svd(this.kXc(this.sIc++),Ce)||(Gd=!1);Gd&&this.NM.remove(ue.uploadId)}};this.khg=()=>{this.dispose()};this.VIa=Bb;this.JJa=ac;this.xJa=Gc;this.$f=Pa;this.Sb=ea;this.N4a=ld;this.cIb=!1;this.k3e="OfflineLoggerManifest|"+this.N4a;this.gKk="OfflineLog|"+this.N4a+"|"}init(){this.REg();this.HIn();this.M5a=
!1;this.$f.m8a(this);this.lV=new Kc.a(3,2,2500,Object(P.a)(this,this.gAe,"sendOfflineLogs"),104);this.Sb.pc(this.lV)}kXc(ea){return this.gKk+ea}HIn(){const ea=this.VIa.getItem(this.k3e);void 0!==ea&&null!==ea&&0<ea.length&&(this.Waa=Id.Rvd(ea));this.Waa||(this.Waa={});if(void 0===this.Waa.end||null===this.Waa.end)this.Waa.end=0;if(void 0===this.Waa.offset||null===this.Waa.offset)this.Waa.offset=0;this.kFb=this.Waa.offset;isFinite(this.kFb)||(this.kFb=0);this.gac=this.Waa.end;isFinite(this.gac)||(this.gac=
0);this.sIc=this.gac}REg(){this.Mlb=new jd.a;this.NM=new fd.a;this.JJa.LUh(this.ilg);this.JJa.jVh(this.klg);this.JJa.iVh(this.jlg);this.JJa.CUh(this.khg)}Svd(ea,Pa){try{return this.VIa.setItem(ea,Pa),!0}catch(Bb){return!1}}gAe(){if(!this.M5a){for(var ea=this.kFb,Pa=new qb.a,Bb=null;ea<this.gac&&5>=Pa.count;++ea){var ac=this.kXc(ea);const Gc=this.VIa.getItem(ac);this.VIa.removeItem(ac);if(void 0===Gc||null===Gc)continue;const ld=({sessionId:ac}=Id.deserialize(Gc)).returnValue;if(ld){if(!Bb)Bb=ac;else if(ac!==
Bb)break;Pa.add(ld)}else w.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Gc)}0<Pa.count&&this.JJa.ULj(this,lb.toArray(Pa),Bb);this.kFb=ea;ea>=this.gac&&this.YQb()}}y7h(){this.YQb();this.lV=new Kc.a(3,2,2500,Object(P.a)(this,this.gAe,"sendOfflineLogs"),104);this.Sb.pc(this.lV)}B_a(ea,Pa,Bb){!this.Vm&&w.ULS.k6(Pa,Bb)&&this.Mlb.W(ea,!0)}dispose(){if(!this.Vm){this.lV&&this.Sb.Kf(this.lV);var ea=lb.toArray(this.NM.keys);ea.sort();for(const Pa of ea){ea=this.NM.K(Pa);for(const Bb of ea)ea=
Id.serialize(Bb,this.xJa),this.Svd(this.kXc(this.sIc++),ea)}this.kFb<this.sIc?(this.Waa.end=this.sIc,this.Waa.offset=this.kFb,this.Svd(this.k3e,JSON.stringify(this.Waa))):this.VIa.removeItem(this.k3e)}this.Vm=!0}KEa(){this.M5a=!0}Z_a(){this.M5a=!1;this.y7h()}YQb(){this.lV&&(this.Sb.Kf(this.lV),this.lV=null)}static serialize(ea,Pa){const Bb={};Bb.t=ea.tag;Bb.c=ea.category;Bb.l=ea.level;Bb.m=ea.message;Bb.lt=ea.logType;Bb.s=Pa;Bb.ts=ea.timestamp;Bb.o=ea.isMinified;Bb.a=ea.args;return JSON.stringify(Bb)}static deserialize(ea){return(ea=
Id.Rvd(ea))?{returnValue:new xc.a(ea.ts,ea.c,ea.t,ea.l,ea.m,ea.lt,ea.o,ea.a),sessionId:ea.s}:{returnValue:null,sessionId:null}}static Rvd(ea){try{return JSON.parse(ea)}catch(Pa){w.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",Pa.message)}return null}}Object(f.a)(Id,"OfflineLoggerImpl",null,[909,11,148]);class ce{constructor(ea,Pa,Bb,ac){this.sessionId=ea;this.version=Pa;this.AWd=Bb;this.Tlg=ac;this.logs=new qb.a}}Object(f.a)(ce,"CachedLogUpload",null,[]);
class Fe{constructor(ea){ea.name&&(this.n=ea.name);ea.stack&&(this.s=ea.stack);ea.message&&(this.m=ea.message);ea.file&&(this.f=ea.file);null!=ea.line&&(this.l=ea.line);null!=ea.column&&(this.c=ea.column)}}Object(f.a)(Fe,"LoggingExceptionArgsLocalStorage",null,[]);class Fd{constructor(ea){this.t=ea.tag;this.c=ea.category;this.l=ea.level;this.m=ea.message;this.lt=ea.logType;this.ts=ea.timestamp;this.o=ea.isMinified;this.a=ea.args;ea.exceptionArgs&&(this.e=new Fe(ea.exceptionArgs))}}Object(f.a)(Fd,
"LoggingArgsLocalStorage",null,[]);var Qb=e(502);class ch{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.t=ea;this.m=Pa;this.s=Bb;this.v=ac;this.i=Gc;this.a=ld;this.d=Gd;this.op="Log"}}Object(f.a)(ch,"LoggingKeyLocalStorage",null,[]);var Nf=e(127);const Mf=(ea,Pa,Bb,ac)=>!(void 0===ea||null===ea)&&!(void 0===ea.i||null===ea.i)&&!(void 0===ea.t||null===ea.t)&&!(void 0===ea.s||null===ea.s)&&"Log"===ea.op&&ea.t===Pa&&isFinite(ea.t)&&Nf.a.isValid(ea.s)&&(void 0===ea.m||null===ea.m||ea.m===Bb)&&(void 0===ea.d||
null===ea.d||ea.d===ac);class Df{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi){this.M5a=this.qzh=this.gzh=this.hzh=!1;this.NM=this.Mlb=this.Waa=this.lV=null;this.Vm=!1;this.bZl=()=>{this.nki(!0)};this.cZl=()=>{this.nki(!1)};this.jip=ph=>ph.s!==ph.s?ph.s.localeCompare(ph.s):ph.i-ph.i;this.gip=ph=>ph.s!==ph.s?ph.s.localeCompare(ph.s):ph.i-ph.i;this.ilg=(ph,Dh)=>{if(void 0!==Dh&&null!==Dh&&void 0!==Dh.args&&null!==Dh.args){if(this.Ued.Bb(Dh.args.tag))this.Ued.remove(Dh.args.tag);else if(this.Ued.Bb(Nc.IVd))this.Ued.remove(Nc.IVd);
else if(!(this.WJk&&50>Dh.args.level))return;({value:ph}=this.nOa.Nc(Dh.uploadId)).returnValue||(ph=new ce(Dh.sessionId,Dh.version,Dh.AWd,Dh.Tlg),this.nOa.W(Dh.uploadId,ph));this.nOa.K(Dh.uploadId).logs.add(Dh.args)}};this.klg=(ph,Dh)=>{this.nOa.remove(Dh.uploadId);this.cIb&&(this.cIb=!1,this.z7h())};this.jlg=(ph,Dh)=>{this.cIb=!0;void 0!==Dh&&null!==Dh&&this.nOa.Bb(Dh.uploadId)&&this.kkj(Dh.uploadId)&&!this.qzh&&(this.qzh=!0)};this.khg=()=>{this.dispose()};this.KHb=[];this.$$b=[];this.VIa=Bb;this.JJa=
ac;this.xJa=Gc;this.$f=Pa;this.Sb=ea;this.oPc=ld;this.U4e=Gd;this.FHh=ue;this.g6a=Ce;this.WJk=tf;this.D0e=Zg;this.N4a=Xi;this.cIb=!1}get manifest(){return this.Waa}get Ued(){return this.Mlb}get nOa(){return this.NM}init(){this.REg();this.M5a=!1;this.$f.m8a(this);this.lV=new Kc.a(3,1,2500,this.bZl,103);this.Sb.pc(this.lV)}nki(ea){this.YQb();this.KHb=[];ea&&(this.$$b=[]);for(var Pa=0;Pa<this.VIa.length;Pa++){const Bb=this.VIa.key(Pa),ac=Df.V9j(Bb,!1);Mf(ac,this.oPc,this.U4e,this.N4a)&&(ac.s===this.xJa?
Array.add(this.KHb,Bb):ea&&Array.add(this.$$b,Bb))}if(this.KHb.length||ea&&this.$$b.length)if(Pa=this.D0e?this.gip:this.jip,this.KHb.sort(Pa),ea&&this.$$b.sort(Pa),0<this.KHb.length||0<this.$$b.length)this.lV=new Kc.a(3,2,2500,Object(P.a)(this,this.gAe,"sendOfflineLogs"),105),this.Sb.pc(this.lV)}kXc(ea,Pa,Bb,ac){ea=new ch(this.oPc,this.U4e,Pa,Bb,ea,ac,this.N4a);return JSON.stringify(ea)}REg(){this.Mlb=new jd.a;this.NM=new fd.a;this.JJa.LUh(this.ilg);this.JJa.jVh(this.klg);this.JJa.iVh(this.jlg);this.JJa.CUh(this.khg)}kkj(ea){let Pa=
!1;if(({value:ac}=this.nOa.Nc(ea)).returnValue&&ac&&0<ac.logs.count){if(ac.AWd>=this.g6a)return this.nOa.remove(ea),!1;var Bb=ac.logs;const Gc=Array(Bb.count);for(let ld=0,Gd=Bb.count;ld<Gd;++ld)Gc[ld]=new Fd(Bb.K(ld));Bb=Df.serialize(Gc);var ac=this.kXc(ac.Tlg,ac.sessionId,ac.version,ac.AWd);this.Svd(ac,Bb)&&(this.nOa.remove(ea),Pa=!0)}return Pa}Svd(ea,Pa){try{return this.VIa.setItem(ea,Pa),!0}catch(Bb){return!1}}gAe(){if(!this.M5a){var ea=0<this.KHb.length?this.KHb:this.$$b,Pa=ea.length;if(Pa)for(;0<
Pa;){Pa--;var Bb=this.D0e?ea.pop():ea[0];this.D0e||Array.removeAt(ea,0);const ld=Df.V9j(Bb,!0);if(Mf(ld,this.oPc,this.U4e,this.N4a)){var ac=this.VIa.getItem(Bb);this.VIa.removeItem(Bb);if(void 0!==ac&&null!==ac)if(ld.a>this.g6a)w.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",ld.a,this.g6a);else if(Bb=Df.Rvd(ac,!0),void 0!==Bb&&null!==Bb&&isFinite(Bb.length))if(Bb.length){ac=Bb[Bb.length-1];var Gc=(new Date).getTime()-ac.ts;if(Gc<-Df.y6j)w.ULS.sendTraceTag(37290078,
222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",ac.ts);else if(Gc>this.FHh*Df.y6j)w.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.FHh,ac.ts);else{ld.s===this.xJa?this.hzh||(this.hzh=!0,w.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.gzh||(this.gzh=!0,w.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",ld.s));
Pa=Array(Bb.length);for(ac=0;ac<Bb.length;ac++){ea=ac;a:{Gc=Bb[ac];if(void 0===Gc||null===Gc){Gc=null;break a}let Gd=null;Gc.e&&(Gd=new Qb.a(null),Gd.name=Gc.e.n,Gd.stack=Gc.e.s,Gd.message=Gc.e.m,Gd.file=Gc.e.f,Gd.line=Gc.e.l,Gd.column=Gc.e.c);Gc=new xc.a(Gc.ts,Gc.c,Gc.t,Gc.l,Gc.m,Gc.lt,Gc.o,Gc.a,Gd)}Pa[ea]=Gc}this.JJa.ULj(this,Pa,ld.s,ld.v,ld.a+1,ld.i);break}}else w.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",ac);else w.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
ac)}}else this.YQb()}}z7h(){this.YQb();this.lV=new Kc.a(3,1,2500,this.cZl,102);this.Sb.pc(this.lV)}B_a(ea,Pa,Bb){!this.Vm&&w.ULS.k6(Pa,Bb)&&this.Ued.W(ea,!0)}dispose(){if(!this.Vm){this.lV&&this.Sb.Kf(this.lV);var ea=lb.toArray(this.nOa.keys);for(const Pa of ea)this.kkj(Pa)}this.Vm=!0}KEa(){this.M5a=!0;this.YQb()}Z_a(){this.M5a=!1;this.z7h()}YQb(){this.lV&&(this.Sb.Kf(this.lV),this.lV=null)}static serialize(ea){return JSON.stringify(ea)}static V9j(ea,Pa){(ea=Df.Rvd(ea,Pa))&&void 0===ea.d&&(ea=new ch(ea.t,
ea.m,ea.s,ea.v,ea.i,ea.a,0));return ea}static Rvd(ea,Pa){try{return JSON.parse(ea)}catch(Bb){Pa&&w.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",Bb.message)}return null}}Df.y6j=864E5;Object(f.a)(Df,"OfflineLoggerImplV2",null,[909,11,148]);class Ig{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(ea){return this.handleError("Length",ea),-1}}key(ea){try{return localStorage.key(ea)}catch(Pa){return this.handleError("Key",
Pa),null}}getItem(ea){try{return localStorage.getItem(ea)}catch(Pa){return this.handleError("GetItem",Pa),null}}setItem(ea,Pa){try{return localStorage.setItem(ea,Pa)}catch(Bb){return this.handleError("SetItem",Bb),null}}removeItem(ea){try{localStorage.removeItem(ea)}catch(Pa){this.handleError("RemoveItem",Pa)}}clear(){try{localStorage.clear()}catch(ea){this.handleError("Clear",ea)}}handleError(){}}Object(f.a)(Ig,"OfflineStorage",null,[908]);class pg{create(ea){var Pa=null;try{void 0!==localStorage&&
null!==localStorage&&(Pa=new Ig)}catch(ac){w.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",ac.message)}Object.getType(w.ULS.host).implementsInterface(892)&&Pa||(w.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Pa?"supported":"not supported",Object.getType(w.ULS.host).implementsInterface(892)?"supported":"not supported"),ea=0);const Bb=m.AFrameworkApplication.J;1===ea?Pa=new Id(m.AFrameworkApplication.zc,
m.AFrameworkApplication.pe,Pa,w.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Ehi):2===ea?(ea=m.AFrameworkApplication.ta.Pb,Pa=new Df(m.AFrameworkApplication.zc,m.AFrameworkApplication.pe,Pa,w.ULS.host,m.AFrameworkApplication.userSessionId,ea.gl,ea.Uoa,Bb.sc("OfflineLoggerRetentionInDays",30),Bb.sc("OfflineLoggerMaxAttempts",5),Bb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),Bb.$("SendOfflineLogsV2ImprovementIsEnabled"),m.AFrameworkApplication.Ehi)):Pa=new gc;Pa.init();
return Pa}}Object(f.a)(pg,"OfflineLoggerFactory",null,[]);class Rf{Ec(){}get name(){return"Common.App.OfflineLogger"}init(){const ea=m.AFrameworkApplication.J;let Pa=0;ea.$("OneNoteOfflineLoggerIsEnabled")?Pa=1:ea.$("OfflineLoggerV2IsEnabled")&&(Pa=2);0!==Pa&&(m.AFrameworkApplication.bGe=(new pg).create(Pa))}dispose(){}}Object(f.a)(Rf,"OfflineLoggerPackage",null,[0,1]);var qf=e(46),Mh=e(1254);class ed{constructor(ea){this.dhj=null;this.pSm=()=>{w.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};
this.rSm=Pa=>{w.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Pa=Xa.a(Pa.data.responseData).state+"";Mh.a.instance.setItem("AccountLinkedStatusCache",Pa)};w.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Nfd=m.AFrameworkApplication.J.rb("PhoneLinkServiceEndpoint");(this.vda=ea)||w.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Nfd&&this.Nfd.length||w.ULS.sendTraceTag(527574721,306,
10,"PhoneLinkManager - Missing service endpoint")}ccm(ea){ea&&(this.Nfd="https://dcg-df.microsoft.com/",w.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.bcm()}bcm(){w.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.dhj)w.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.dhj=new Date;var ea=new Date;this.vda.kX("BayBridge",
this.Nfd).then(Pa=>{const Bb=+new Date-+ea;Pa.IsSuccess?(w.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",Bb),this.Pbm(Pa.Token,this.rom())):w.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",Bb,Pa.ErrorCode,Pa.ErrorMessage)}).catch(Pa=>{w.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",
Pa,+new Date-+ea)})}}Pbm(ea,Pa){const Bb={};Bb.Authorization="Bearer "+ea;Bb["Authorization-Type"]="AAD";Bb.Accept="application/json";Bb["DCG-SessionId"]=m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.pe.addRequest(Pa,1,null,Bb,!1,2,this.rSm,this.pSm,null,void 0,void 0,void 0,void 0,"39");qf.a("FetchAccountLinkedStatus")}Gqm(){const ea=Mh.a.instance.getItem("AccountLinkedStatusCache");return ea&&ea.length?"true"===ea.toLowerCase()?!0:!1:!1}rom(){return this.Nfd+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}
Object(f.a)(ed,"PhoneLinkManager",null,[830]);class dd{constructor(){this.Z=null}get name(){return"Common.App.PhoneLink"}Ec(ea){this.Z=ea;this.Z.register(830,"Common.App.PhoneLink.IPhoneLinkManager").ha().fe(()=>new ed(this.Z.resolve("Common.App.OAuth.IOAuthManager")))}init(){m.AFrameworkApplication.J.lq(()=>{this.Wbb()})}Wbb(){this.Z.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){U.a.instance.Rc(new dd)}}Object(f.a)(dd,"PhoneLinkPackage",null,[0,1]);const Vh=ea=>{try{return Xa.a(ea)}catch(Pa){}return null};
class Gf{constructor(ea,Pa,Bb,ac,Gc,ld){this.z3=!1;this.Hl=null;this.$6e=!1;this.enf=Gd=>{const ue=Gd.NSb();ue.continueWith(()=>{this.Hl=ue.result;this.$6e&&(this.Hl.sE(2,null,!0),this.$6e=!1);this.Hl.CQ((Ce,tf)=>{2===tf.type&&this.Tb.Vb(u.a.vRb,2)});this.Hl.K0((Ce,tf)=>{2===tf.newState&&this.Tb.Vb(u.a.vRb,2)});2===this.Hl.connectionState&&this.Tb.Vb(u.a.vRb,2)})};this.vvc=Gd=>{this.z3=!1;const ue=Vh(Gd.data.responseData);Gd.data.state.iE(ue,this.syh.value)};this.e9n=Gd=>{5!==Gd.data.status||this.z3?
this.Ssj(Gd):(this.z3=!0,this.nri(Gd.data.state,!1))};this.Ssj=Gd=>{Gd.data.state.onFailure(-1)};this.Wid=Gd=>{this.z3=!1;const ue=Vh(Gd.data.responseData);Gd.data.state.iE(ue,this.syh.value);this.gnj()};this.i9n=Gd=>{5!==Gd.data.status||this.z3?this.Vsj(Gd):(this.z3=!0,this.ori(Gd.data.state,!1))};this.Vsj=Gd=>{Gd.data.state.onFailure(-1)};this.ga=ea;this.$f=Pa;this.Rk=Bb;this.syh=ac;this.za=Gc;this.yJk=ld}init(ea,Pa){Pa&&ea.Za("Common.Interface.IRtcBasicProvider").execute(this.enf)}vXa(ea){this.nri(ea,
!0)}nri(ea,Pa){const Bb=this.Mnl(ea.I0j),ac={};ac[Gf.qbi]=Gf.rbi;this.LLj.addRequest(Bb,2,"",ac,!1,2,this.vvc,Pa?this.e9n:this.Ssj,ea)}eRb(ea){this.ori(ea,!0)}ori(ea,Pa){const Bb=this.Nnl(),ac={};ac[Gf.qbi]=Gf.rbi;ac[Gf.x3m]=Fa.a.nj(ea.RLj);ac[Gf.v3m]=this.yJk.value.uAl;this.LLj.addRequest(Bb,2,"",ac,!1,2,this.Wid,Pa?this.i9n:this.Vsj,ea)}Nnl(){return this.a2h()}Mnl(ea){let Pa=this.a2h();return Pa=Pb.a.Kq(Pa,Gf.B3m,ea?"2":"1")}a2h(){let ea=(this.za.value.appSettings.RenameWebServiceBase||"")+Gf.w3m;
ea=Pb.a.Kq(ea,Gf.y3m,Fa.a.nj(m.AFrameworkApplication.lm));this.Un&&this.Un.rhe&&(ea=Pb.a.Kq(ea,Gf.A3m,"1"));return ea}gnj(){this.Hl?this.Hl.sE(2,null,!0):this.$6e=!0}get Tb(){return this.ga.value}get LLj(){return this.$f.value}get Un(){return this.Rk.value}static get instance(){return Gf._instance||(Gf._instance=Gf.aSb())}static aSb(){return new Gf(new zc.a(()=>m.AFrameworkApplication.va),new zc.a(()=>m.AFrameworkApplication.pe),new zc.a(()=>m.AFrameworkApplication.Un),new zc.a(()=>wa.a.instance.resolve("Postmessage.IHostPostmessenger")),
new zc.a(()=>m.AFrameworkApplication.J),new zc.a(()=>wa.a.instance.resolve("Common.IRenameProps")))}}Gf.qbi="Content-Type";Gf.rbi="application/json; charset=utf-8";Gf.w3m="renamehandler.ashx";Gf.y3m="qs";Gf.x3m="n";Gf.A3m="sl";Gf.v3m="X-CoauthLockId";Gf.B3m="u";Gf._instance=null;Object(f.a)(Gf,"ExecuteRenameFileHandler",null,[]);class Td{constructor(){this.onFailure=this.iE=null;this.I0j=!1}}Object(f.a)(Td,"ExecuteRefreshFilenameData",null,[]);class Xc{constructor(){this.onFailure=this.iE=this.RLj=
null}}Object(f.a)(Xc,"ExecuteRenameFileData",null,[]);class de{constructor(){this.Z=null;this.ZUe=Gf.instance;this.Gz=()=>{m.AFrameworkApplication.Icd()&&(Gf.instance.init(this.Z,m.AFrameworkApplication.rod),m.AFrameworkApplication.eRb=Object(P.a)(this,this.eRb,"executeRenameFile"),m.AFrameworkApplication.vXa=Object(P.a)(this,this.vXa,"executeRefreshFilename"),m.AFrameworkApplication.Gqd=Object(P.a)(this,this.Gqd,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}Ec(ea){this.Z=
ea}init(){m.AFrameworkApplication.J.lq(this.Gz)}eRb(ea,Pa,Bb){const ac=new Xc;ac.RLj=ea;ac.iE=Pa;ac.onFailure=Bb;this.ZUe.eRb(ac)}vXa(ea,Pa,Bb){const ac=new Td;ac.iE=ea;ac.onFailure=Pa;ac.I0j=Bb;this.ZUe.vXa(ac)}Gqd(){this.ZUe.gnj()}dispose(){}}Object(f.a)(de,"PackageManager",null,[0,1]);var ze=e(182);class jf{constructor(ea,Pa,Bb){this.aHg=this.bHg=this.cHg=!1;this.qHg=!ea&&!Pa;this.rHg=!ea&&!Bb;this.qHg||this.rHg||(this.cHg=!ea,this.bHg=!Pa,this.aHg=!Bb)}}Object(f.a)(jf,"RenameDisabledDialogInfo",
null,[]);class hc extends ze.StandardDialog{constructor(ea,Pa,Bb,ac,Gc){super();this.MLg=[];this.Rka=new jf(ea,Pa,Bb);this.aob=ac;this.xlb=Gc;this.$g="RenameDisabledDialog";this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.A6o();this.yKo()}A6o(){this.Rka.qHg?this.Usd(this.aob?this.xlb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Rka.rHg?this.Usd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.X2k();this.dUd(this.MLg)}Usd(ea){Array.add(this.MLg,ea)}X2k(){const ea=[];this.Rka.cHg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Rka.bHg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Rka.aHg||Array.add(ea,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<ea.length&&Array.add(this.MLg,ea)}}Object(f.a)(hc,"ReactRenameDisabledDialogBase",ze.StandardDialog,[]);class wc extends hc{constructor(ea,Pa,Bb,ac,Gc){super(ea,Pa,Bb,ac,Gc)}yKo(){this.Gxb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(f.a)(wc,"ReactRenameDisabledDialog",hc,[]);class Pc{static get Fh(){return a.a.iA(Pc.pp,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Pc.pp="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(Pc,"RenameDisabledDialogHtml",null,[]);class md extends a.a{constructor(ea,Pa,Bb,ac,Gc){super();this.Rka=new jf(ea,Pa,Bb);this.aob=ac;this.xlb=Gc;this.$g="RenameDisabledDialog";this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.Fh=Pc.Fh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.u$("RenameRow")}Cda(){if(this.Rka.qHg){let ea;ea=this.aob?this.xlb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;md.Usd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),ea)}else this.Rka.rHg?md.Usd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.d7m()}d7m(){this.Rka.cHg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Rka.bHg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Rka.aHg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Usd(ea,Pa,Bb){ea.style.display="none";Pa.innerText=Bb}}Object(f.a)(md,"RenameDisabledDialog",a.a,[]);class fe{constructor(ea,Pa){this.BIb=0;this.wtf=(Bb,ac,Gc,ld,Gd)=>{if(1===Gc)return this.ga.Vb(u.a.kxa,1);Bb=Fa.a.oN(this.JSa.sC);Gd=(0,Gd.getNewDocumentTitle)();Gd.length>this.BIb&&(Gd=Gd.substr(0,this.BIb));if(32!==this.ga.Zb(u.a.kxa,2,Gd))return this.QDc(Bb),8;this.QDc(Gd);return 32};
this.ga=ea;this.JSa=Pa}initialize(ea){if(!this.ga||!this.JSa)return!1;this.BIb=ea;this.mc();return!0}mc(){this.ga.qa(u.a.wtf,x.a.frame,this.wtf)}QDc(ea){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(ea))}static In(){return new fe(m.AFrameworkApplication.va,m.AFrameworkApplication.dv)}}Object(f.a)(fe,"ReactRenameUIHandler",null,[906]);var se=e(1041),$d=e(1577),Md=e(725),Ub=e(148),Vc=e(265),qd=e(204);class vb{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi){this._initialized=!1;this._element=
null;this.BIb=0;this.Z$e=this.tYe=!1;this.ga=ea;this.ajb=Pa;this.Ce=Bb;this.hz=ac;this.JSa=Gc;this.HIh=ld;this.iPd=Gd;this.nQe=ue;this.Ukb=Ce;this.jvh=tf;this.vj=Zg;this.b_e=Xi}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(ea,Pa,Bb){if(!(this.ga&&this.JSa&&this.HIh&&this.iPd&&this.nQe&&Pa)||0>=ea)return!1;this._element=Pa;this._element.title=Bb;this._element.setAttribute(qd.a.fi,qd.a.i4);this._element.setAttribute("Unselectable","on");this.BIb=ea;this.EG();
return this._initialized=!0}EG(){this.ajb&&(this.ajb.Cb(ca.a.blur,this._element,Object(P.a)(this,this.onBlur,"onBlur")),this.ajb.Cb(ca.a.paste,this._element,Object(P.a)(this,this.Jid,"onPaste")));this.Ce.Cb(ca.a.Bj,this._element,Object(P.a)(this,this.onKeyDown,"onKeyDown"));this.hz.Cb(ca.a.Lu,this._element,Object(P.a)(this,this.rA,"onPointerDown"));this.hz.Cb(ca.a.zR,this._element,Object(P.a)(this,this.Eda,"onPointerUp"))}onBlur(){this.isActive&&!this.tYe&&(this.jvh||this.nQe(this._element),this.n$h(),
this.Lyf(!1));return this.tYe=!1}Jid(){w.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(ea){return this.isActive?this.u6n(ea):this.v6n(ea)}u6n(ea){let Pa=!1;switch(ea.Yb.keyCode){case Sys.UI.Key.enter:this.n$h();this.Lyf(this.vj||this.b_e);Pa=!0;break;case Sys.UI.Key.tab:this.jvh&&this.nQe(this._element);break;case Sys.UI.Key.esc:this.Eyg(),this.Lyf(this.vj||this.b_e),Pa=!0}return Pa}v6n(ea){let Pa=!1;switch(ea.Yb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.X8j(this.b_e),
this.isActive&&this.iPd(this._element),Pa=!0}return Pa}rA(){this.isActive||(this.X8j(!1),this.isActive&&(this._element.focus(),this.iPd(this._element),this.Z$e=!0));return!1}Eda(){return this.Z$e?(this.iPd(this._element),this.Z$e=!1,!0):!1}trc(){return 32===this.ga.Vb(u.a.kxa,1)}n$h(){const ea=Fa.a.oN(this.JSa.sC);let Pa=this._element.innerText.trim();Pa.length>this.BIb&&(Pa=Pa.substr(0,this.BIb));Pa!==ea&&""!==Pa?32!==this.ga.Zb(u.a.kxa,2,Pa)?this.Eyg():this.QDc(Pa):this.Eyg()}Eyg(){this.QDc(Fa.a.oN(this.JSa.sC))}QDc(ea){this._initialized&&
(this._element.innerText=ea,this.HIh())}X8j(ea){this.trc()?this.isActive||(ea&&(this.tYe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(qd.a.fi,qd.a.KZh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,se.a.Kni),this.Ukb&&this.Ukb.execute(Pa=>{Pa.YDj(!0)}),ea&&this._element.focus(),w.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.Vb(u.a.UAc,
2)}Lyf(ea){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(qd.a.fi,qd.a.i4);Sys.UI.DomElement.removeCssClass(this._element,se.a.Kni);this.Ukb&&this.Ukb.execute(Pa=>{Pa.YDj(!1)});ea&&(this._element.blur(),this._element.focus())}static aGa(){$d.a.aGa(m.AFrameworkApplication.isRtl)}static In(){return new vb(m.AFrameworkApplication.va,Md.a.instance,Ub.KeyInputManager.instance,Vc.a.instance,m.AFrameworkApplication.dv,vb.aGa,Ga.a.gVo,
Ga.a.d8h,wa.a.instance.Za("Common.App.Header.HeaderEventSource"),ub.a.c2,ub.a.Yi,ub.a.Hj)}}Object(f.a)(vb,"RenameUIHandler",null,[906]);class Kb{static get instance(){return m.AFrameworkApplication.ta.Pb.JN?Kb._instance||(Kb._instance=fe.In()):Kb._instance||(Kb._instance=vb.In())}}Kb._instance=null;Object(f.a)(Kb,"RenameUIHandlerFactory",null,[]);var Ic=e(889);class kd{constructor(){this.nfg=this.bYn=this.ISl=null}}Object(f.a)(kd,"RenameMruEntryProperties",null,[]);var Wd=e(193),Ye=e(97),Re=e(1488),
le;(function(ea){ea[ea.unknown=-1]="unknown";ea[ea.success=0]="success";ea[ea.xrq=1]="renameInvalidFileName";ea[ea.wrq=2]="renameInCoauthNotSupported";ea[ea.yrq=3]="renameNotSupportedInViewMode";ea[ea.vio=4]="permissionDenied";ea[ea.guq=5]="serverCommunicationFailure";ea[ea.J8p=6]="fileNameTooLong"})(le||(le={}));Object(f.b)("CommonOperationResult",le);var Bh=e(1851);class gf{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi){this.ipc=()=>Kb.instance.initialize(m.AFrameworkApplication.p6d,m.AFrameworkApplication.Dmi,
m.AFrameworkApplication.aKj||CommonUIStrings.l_RenameFileTooltip)?32:8;this.UAc=()=>{const ph=this.FKp(),Dh=this.iYk();w.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.hIb,Dh,ph,this.aob);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.$I&&m.AFrameworkApplication.J.$("ReactRenameDisabledDialogIsEnabled")?new wc(this.hIb,!Dh,!ph,this.aob,
this.xlb()):new md(this.hIb,!Dh,!ph,this.aob,this.xlb());return 32};this.kxa=(ph,Dh,qk,Wn,wn)=>{var hr;if(1===qk)return this.trc();if(!m.AFrameworkApplication.eRb)return 8;if(8===this.trc())return this.Tb.Vb(u.a.UAc,2),8;w.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");ph=!1;(null===(hr=m.AFrameworkApplication.J)||void 0===hr?0:hr.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))&&wn instanceof Bh.a&&(ph=wn.disableFailedActionDialog,wn=wn.fileNameCandidate);
m.AFrameworkApplication.eRb(wn,Object(P.a)(this,this.Wid,"onRenameFileSuccess"),ph?()=>{}:this.h9n);m.AFrameworkApplication.$Jj=!0;return 32};this.h9n=ph=>{const Dh=new ze.StandardDialog;Dh.Md=0;switch(ph){case 1:w.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Dh.Rxa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:w.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Dh.Rxa(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileNameTooLong,null);break;default:w.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:ph}),Dh.Rxa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.NL().execute(qk=>{qk.sendMessage(Ye.a.Jcm,{["FailureMessage"]:le[ph]})});this.LMj()};this.bAo=(ph,Dh,qk)=>{if(1===qk)return this.trc();if(!m.AFrameworkApplication.vXa)return 8;m.AFrameworkApplication.vXa(Object(P.a)(this,this.vvc,"onRefreshFilenameSuccess"),
Object(P.a)(this,this.are,"onRefreshFilenameFailure"),!1);return 32};this.Sne=(ph,Dh,qk,Wn,wn)=>{if(1===qk)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?this.trc():8;if(2===qk){if(!m.AFrameworkApplication.Gqd)return sa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!wn)return sa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(wn[Wd.a.uon])if(wn[Wd.a.Eek])if(ph=wn[Wd.a.Eek].toLowerCase(),
Dh=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"),qk=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Dh&&m.AFrameworkApplication.Ewb&&qk){const hr={};hr[Wd.a.Jxc]="1";hr[Wd.a.documentUrl]=ph;hr[Wd.a.reason]=Re.a.$zg;sa.Health.instance.recordKpiSuccess("MoveToFolder",null);m.AFrameworkApplication.NL().execute(Ss=>{Ss.sendMessage(Ye.a.rQb,hr)})}else if(!m.AFrameworkApplication.Ewb&&qk)sa.Health.instance.recordKpiSuccess("MoveToFolder",
null),Ga.a.Zm(ph,Ga.a.Fya(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return sa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else sa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.vXa(Object(P.a)(this,this.vvc,"onRefreshFilenameSuccess"),Object(P.a)(this,this.are,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.Gqd(),sa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};
this.Fvh=ea;this.ga=Pa;this.Rk=Bb;this.gQ=ac;this.hIb=Gc;this.iYk=ld;this.aob=Gd;this.OOh=ue;this.TQk=Ce;this.xlb=tf;this.za=Zg;this.SQk=Xi}mc(){m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.JN||this.Tb.qa(u.a.ipc,x.a.frame,this.ipc);this.Tb.qa(u.a.UAc,x.a.frame,this.UAc);this.Tb.qa(u.a.kxa,x.a.frame,this.kxa);this.Tb.nb(u.a.vRb,x.a.frame,this.bAo,64);this.Tb.nb(u.a.Sne,x.a.frame,this.Sne,64);this.Tb.qa(u.a.uYb,x.a.frame,Object(P.a)(this,this.uYb,"moveToFolder"));(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",
!0)||m.AFrameworkApplication.ta&&(m.AFrameworkApplication.J.$("PostMessageEmbedded")||m.AFrameworkApplication.J.$("IsJsApi"))&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&m.AFrameworkApplication.NL().execute(ea=>{ea.$w(Ye.a.Ikj);ea.DG(Ye.a.Ikj,gf.xwo);ea.$w(Ye.a.ZFf);ea.DG(Ye.a.ZFf,gf.wwo)})}trc(){return 0===this.SQk.KKi()?32:8}FKp(){return this.Un?this.aob?this.Un.Lmi:this.Un.rab:!0}Wid(ea,Pa){ea?0!==ea.OperationResult?this.nRi(ea.OperationResult):
(this.bXo(Pa,ea.NewName),this.pCp(ea,Object(P.a)(m.AFrameworkApplication.ta.Pb,m.AFrameworkApplication.ta.Pb.$ck,"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.J.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ta.Ne(),this.TQk.Iak()):this.nRi(5)}bXo(ea,Pa){const Bb={};Bb[Wd.a.Kcm]=Pa;ea.sendMessage(Ye.a.ZFf,Bb)}pCp(ea,Pa){this.ECp(ea);m.AFrameworkApplication.a3d=ea.DirectInvokeDavUrl;Pa=Pa(ea.EditDocInClientUrl);const Bb=new kd;Bb.nfg=this.gQ.sC;Bb.ISl=Pa;Bb.bYn=ea.EditDocInClientUrl;
this.Tb.Zb(u.a.bKj,2,Bb)}nRi(ea){switch(ea){case 1:ea=new ze.StandardDialog,ea.Md=0,ea.tU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.LMj()}}ECp(ea){this.gQ.sC=gf.jcl(this.gQ.sC,ea.NewName);ea.BreadcrumbFolderName&&(this.gQ.breadcrumbFolderName=ea.BreadcrumbFolderName);ea.BreadcrumbFolderUrl&&(this.gQ.breadcrumbFolderUrl=ea.BreadcrumbFolderUrl);this.OOh(ea.NewName)}uYb(ea,Pa,Bb,ac,Gc){if(1===Bb)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?
32:8;if(2===Bb){const ld={};ea=m.AFrameworkApplication.Ewb;Pa=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");ea=(!ea||ea&&Pa)&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ld[Wd.a.onp]=ea;Gc&&Gc.MoveButtonClickedTime&&(ld[Wd.a.IVn]=Gc.MoveButtonClickedTime.getTime());m.AFrameworkApplication.NL().execute(Gd=>{Gd.sendMessage(Ye.a.uYb,ld)});if(Gc&&Gc.MoveButtonClickedTime){if(ea=Ic.a.HI())Gc=(new Date).getTime()-Gc.MoveButtonClickedTime.getTime(),
ea.set("MovePostDuration",Gc.toString());sa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",ea)}return 32}return 8}wcp(ea,Pa){return ea&&Pa?ea!==this.gQ.breadcrumbFolderName||Pa!==this.gQ.breadcrumbFolderUrl:!1}vvc(ea,Pa){ea&&(ea.NewName!==Fa.a.oN(this.gQ.sC)||this.wcp(ea.BreadcrumbFolderName,ea.BreadcrumbFolderUrl))&&this.Wid(ea,Pa)}are(){}LMj(){this.OOh(Fa.a.oN(this.gQ.sC))}get Tb(){return this.ga.value}get Un(){return this.Rk.value}static get instance(){return gf._instance||(gf._instance=
gf.aSb())}static aSb(){return new gf(m.AFrameworkApplication.Icd,new zc.a(()=>m.AFrameworkApplication.va),new zc.a(()=>m.AFrameworkApplication.Un),m.AFrameworkApplication.dv,m.AFrameworkApplication.awa,()=>m.AFrameworkApplication.YQg,m.AFrameworkApplication.rod,Object(P.a)(Kb.instance,Kb.instance.QDc,"updateTitle"),wa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>m.AFrameworkApplication.Tx,m.AFrameworkApplication.J,wa.a.instance.resolve("Common.IRenameProps"))}static jcl(ea,Pa){ea=
Fa.a.sna(ea);return Pa+ea}static xwo(ea){const Pa=ea.Values[Wd.a.Bun];w.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Pa);Pa?m.AFrameworkApplication.va.Zb(u.a.Sne,2,ea.Values):sa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static wwo(ea){m.AFrameworkApplication.va.Zb(u.a.kxa,2,ea.Values.NewName)}}gf._instance=null;Object(f.a)(gf,"RenameActor",null,[]);var Wf=e(218),$i=e(1261),wf=e(590),Hf=e(266);class vf{constructor(ea,
Pa){this.ga=ea;this.$Ic=Pa}mc(){this.ga.qa(u.a.lHg,x.a.frame,Object(P.a)(this,this.zfp,"showRenameDialogAction"))}zfp(ea,Pa,Bb){ea=32;if(1===Bb)return Hf.SessionStatusManager.instance.zk||m.AFrameworkApplication.Cva?8:32;2===Bb&&(32!==this.ga.Vb(u.a.kxa,1)?(this.ga.Vb(u.a.UAc,2),Wf.a.instance.qc($i.a.pua,{["Reason"]:wf.a.IJo}),ea=8):32===this.ga.Vb(u.a.VAc,1)?this.ga.Vb(u.a.VAc,2):this.$Ic.value.create().v2a());return ea}}Object(f.a)(vf,"RenameDialogActor",null,[888]);class Ui{constructor(ea,Pa,Bb){this.dialog=
null;this.ga=ea;this.gQ=Pa;this.Ckb=Bb}EOm(){const ea={};ea.nameInputProps={["type"]:"AppInputProps",["id"]:Ui.wjc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Fa.a.oN(this.gQ.sC),["maxLength"]:this.Ckb};return ea}v2a(){const ea={["id"]:"RenameDialog",["bodyControls"]:this.EOm()};this.dialog=new a.a(!1,!1,!0);this.dialog.Md=1;this.dialog.$g="RenameDialog";this.dialog.ti(CommonUIStrings.l_RenameDialogTitle,Object(P.a)(this,this.Pwg,"renameDialogHandler"),ea)}Pwg(ea,Pa){if(Pa&&1===ea){if(Pa[Ui.wjc]&&
(ea=Fa.a.oN(this.gQ.sC),Pa=(Pa[Ui.wjc]||"").trim(),Pa!==ea&&""!==Pa)){this.ga.Zb(u.a.kxa,2,Pa);return}Wf.a.instance.qc($i.a.tjc,{["Reason"]:wf.a.Wsi})}}}Ui.wjc="txtDocumentName";Object(f.a)(Ui,"ReactRenameDialog",null,[907]);class rf{static get Fh(){return a.a.iA(rf.pp,CommonUIStrings.l_RenameDialogLabel)}}rf.pp="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(rf,"RenameDialogHtml",null,[]);class ug extends a.a{constructor(ea,Pa,Bb){super();this.ga=ea;this.gQ=Pa;this.Ckb=Bb;this.$g="RenameDialog";this.Fh=rf.Fh}v2a(){var ea={["txtDocumentName"]:Fa.a.oN(this.gQ.sC)};this.ti(CommonUIStrings.l_RenameDialogTitle,Object(P.a)(this,this.Pwg,"renameDialogHandler"),ea);ea=document.getElementById(ug.wjc);0<this.Ckb&&(ea.maxLength=this.Ckb);ea.focus()}Pwg(ea,Pa){if(1===ea&&(ea=Fa.a.oN(this.gQ.sC),Pa=(Pa[ug.wjc]||"").trim(),Pa!==ea&&""!==Pa)){this.ga.Zb(u.a.kxa,
2,Pa);return}Wf.a.instance.qc($i.a.tjc,{["Reason"]:wf.a.Wsi})}}ug.wjc="txtDocumentName";Object(f.a)(ug,"RenameDialog",a.a,[907]);class Eg{constructor(ea){this.JSa=null;this.Ckb=0;this.ga=ea;this._initialized=!1}initialize(ea,Pa){this.JSa=ea;this.Ckb=Pa;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.$I&&m.AFrameworkApplication.J.$("ReactRenameDialogIsEnabled")?new Ui(this.ga,this.JSa,this.Ckb):new ug(this.ga,this.JSa,this.Ckb):null}}
Object(f.a)(Eg,"RenameDialogFactory",null,[887]);var th=e(243),ei=e(115);class Yj{constructor(ea,Pa){this.ga=ea;this.oc=Pa}mc(){this.ga.qa(u.a.VAc,x.a.frame,Object(P.a)(this,this.Afp,"showRenameFlyoutAction"))}Wrl(){return G.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ta.Pb.JN}Afp(ea,Pa,Bb){if(1===Bb)return this.Wrl()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}R4k(){Yj.nzn&&m.AFrameworkApplication.VL&&ei.TaskManager.instance.pc(new Kc.a(5,
1,5E3,()=>{32===this.ga.Vb(u.a.VAc,1)&&this.oc&&this.oc.currentScope.name===th.AFrame.Co&&(qf.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.Vb(u.a.VAc,2))}))}static get nzn(){Yj.zId&&null!=Yj.zId||(m.AFrameworkApplication.ud("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Yj.zId=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Yj.zId}}Yj.zId=null;Object(f.a)(Yj,
"RenameFlyoutActor",null,[886]);class Zk{constructor(ea,Pa,Bb,ac,Gc){this.uAl=null;this.Rk=Gc;this.Gvh=Bb;this.Fvh=ac;this.kYk=ea;this.xlb=Pa}get Un(){return this.Rk.value}KKi(){if(!this.Fvh())return 5;if(this.xlb())return 1;if(this.Un){if(this.Gvh&&!this.Un.Lmi)return 3;if(!this.Gvh&&!this.Un.rab)return 4}return this.kYk()?0:2}}Object(f.a)(Zk,"RenameProps",null,[885]);class yg{constructor(ea,Pa,Bb,ac,Gc,ld){this._isEnabled=!1;this.b2e=new dc.a;this.N8b=Pa;this.oD=Bb;this.n4a=ac;this.za=Gc;this.yla=
ld}enable(){this._isEnabled||(this.Iak(),this.VIg(),this._isEnabled=!0)}generateKey(ea,Pa,Bb){return String.format("{0}/{1}/{2}",Bb,ea,Pa)}VDm(){const ea=Fa.a.oN(this.N8b().sC);return this.generateKey(this.N8b().breadcrumbFolderName,this.N8b().breadcrumbFolderUrl,ea)}WDm(ea,Pa,Bb){return ea&&Pa?this.generateKey(ea,Pa,Bb):Bb}g_l(ea,Pa,Bb){return ea&&ea!==this.N8b().breadcrumbFolderName||Pa&&Pa!==this.N8b().breadcrumbFolderUrl?!0:Bb!==Fa.a.oN(this.N8b().sC)}Iak(){const ea=this.VDm();this.b2e.W(ea,new Date)}dog(ea){this.wap(ea)&&
this.kRh(ea)}wap(ea){const Pa=this.n4a();return Pa?this.yla&&this.yla.nq||!Pa.rhe||!m.AFrameworkApplication.vXa?(this.i3j(ea),this._isEnabled=!1):!0:!1}$tj(ea,Pa,Bb,ac){const Gc=this.g_l(ea,Pa,Bb);ea=this.WDm(ea,Pa,Bb);Pa=this.b2e.Nc(ea).returnValue;Gc&&!Pa&&(this.pRi(ac),w.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.c$f));Gc||this.b2e.W(ea,this.oD())}}Object(f.a)(yg,"ARenamedFileChecker",null,[865]);class Kk extends yg{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){super(ea,Pa,Bb,ac,
Gc,ld);this.LRi=(Ce,tf)=>{tf&&tf.GYb&&tf.ioj&&(tf.b_a("BreadcrumbDocName")||tf.b_a("BreadcrumbFolderName")||tf.b_a("BreadcrumbFolderUrl")||tf.b_a("DirectInvokeDAVUrl")||tf.b_a("EditDocInClientUrl"))&&(w.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.c$f),this.dog(tf))};this.uD=Gc;this.RQk=Gd;this.UXe=ue}get c$f(){return"RenamedFileCheckerUsingSettingsRefresh"}VIg(){this.uD.yVc(this.LRi)}i3j(){this.uD.ywg(this.LRi)}kRh(ea){if(ea&&ea.GYb){const Pa=ea.GYb;this.$tj(Pa.rb("BreadcrumbFolderName"),
Pa.rb("BreadcrumbFolderUrl"),Pa.rb("BreadcrumbDocName"),ea)}}pRi(ea){const Pa={OperationResult:0,classId:1};ea=ea.GYb;Pa.BreadcrumbFolderName=ea.rb("BreadcrumbFolderName");Pa.BreadcrumbFolderUrl=ea.rb("BreadcrumbFolderUrl");Pa.DirectInvokeDavUrl=ea.rb("DirectInvokeDAVUrl");Pa.EditDocInClientUrl=ea.rb("EditDocInClientUrl");ea=ea.rb("BreadcrumbDocName");Pa.NewName=m.AFrameworkApplication.B3d?ea:Fa.a.oN(ea);this.UXe.execute(Bb=>{this.Hkn(Pa,Bb)})}Hkn(ea,Pa){this.RQk().Wid(ea,Pa)}}Object(f.a)(Kk,"RenamedFileCheckerUsingSettingsRefresh",
yg,[]);class Jh extends yg{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf){super(ea,Bb,ac,Gc,ld,Ce);this.jRc=this.Wk=null;this.aPk=Pa;this.ga=Gd;this.Sb=ue;tf&&tf.execute(Zg=>{this.GEo(Zg)})}get c$f(){return"RenamedFileCheckerUsingTask"}GEo(ea){this.Wk=ea;this.Wk.Psa(Object(P.a)(this,this.KT,"handleVisibilityChange"))}KT(ea,Pa){!this._isEnabled||0!==Pa.newState&&1!==Pa.newState||this.jRc||(this.VIg(),this.dog(this.jRc))}VIg(){this.jRc=new Kc.a(3,2,this.aPk(),Object(P.a)(this,this.dog,"performRenameFileCheckTick"),
89);this.Sb.pc(this.jRc)}i3j(ea){this.Sb.Kf(ea)}kRh(ea){this.Wk&&2===this.Wk.pC?this.zGo(ea):m.AFrameworkApplication.vXa(Object(P.a)(this,this.vvc,"onRefreshFilenameSuccess"),Object(P.a)(this,this.are,"onRefreshFilenameFailure"),!0)}zGo(ea){this.Sb.Kf(ea);this.jRc=null}vvc(ea){ea&&this.$tj(ea.BreadcrumbFolderName,ea.BreadcrumbFolderUrl,ea.NewName,null)}pRi(){this.ga.Vb(u.a.vRb,2)}are(){}}Object(f.a)(Jh,"RenamedFileCheckerUsingTask",yg,[]);var zf=e(89);class cg{constructor(){this.za=this.Z=null;this.Gz=
()=>{const ea=m.AFrameworkApplication.ta.Pb.JN;m.AFrameworkApplication.Icd()&&Kb.instance.initialize(m.AFrameworkApplication.p6d,ea?null:m.AFrameworkApplication.Dmi,ea?null:m.AFrameworkApplication.aKj||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(Zk,"Common.App.Rename.RenameProps").as("Common.IRenameProps").fe(()=>new Zk(()=>m.AFrameworkApplication.YQg,()=>m.AFrameworkApplication.Tx,m.AFrameworkApplication.rod,m.AFrameworkApplication.Icd,new zc.a(()=>m.AFrameworkApplication.Un))).ha(),gf.instance.mc(),
this.za.$("RenameDialogIsEnabled")&&(this.Z.resolve("Common.App.Rename.RenameDialogFactory").initialize(m.AFrameworkApplication.dv,m.AFrameworkApplication.p6d),this.Z.resolve("Common.App.Rename.IRenameDialogActor").mc()),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").mc(),m.AFrameworkApplication.rod&&this.Z.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").R4k())}}get name(){return"Common.App.RenameFile"}Ec(ea){this.Z=ea;this.za=
m.AFrameworkApplication.J;this.Z.register(vf,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").fe(()=>new vf(m.AFrameworkApplication.va,this.Z.zf("Common.App.Rename.IRenameDialogFactory"))).ha();this.Z.register(Eg,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").fe(()=>new Eg(m.AFrameworkApplication.va)).ha();this.Z.register(865,"Common.App.Rename.IRenamedFileChecker").fe(()=>this.HPl()).ha();this.Z.register(Yj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").fe(()=>
new Yj(m.AFrameworkApplication.va,zf.FocusManager.instance())).ha()}HPl(){if(this.za.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const ea=this.Z.Wa("Common.IRefreshableAppSettings");if(ea&&ea.D6i)return new Kk(()=>ea.sc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.dv,()=>new Date,()=>m.AFrameworkApplication.Un,ea,this.Z.Wa("Common.ISessionStatus"),()=>gf.instance,this.Z.Za("Postmessage.IHostPostmessenger"))}return new Jh(()=>this.za.sc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.za.sc("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.dv,()=>new Date,()=>m.AFrameworkApplication.Un,m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.zc,this.Z.Wa("Common.ISessionStatus"),this.Z.Za("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.za.lq(this.Gz)}dispose(){}}Object(f.a)(cg,"PackageManager",null,[0,1]);class xe extends a.a{constructor(ea,Pa){super(!1,!1,!0);this.jpd=(Bb,ac)=>{if(1===Bb){Bb=ac.showRibbonChoice;
if(this.ZHh!==ac.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.KKh!==Bb&&("AlwaysShow"===Bb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.ZHh=ea;this.KKh=Pa}start(){this.ti("",this.jpd,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.ZHh,["showRibbonChoice"]:this.KKh}})}}Object(f.a)(xe,"RibbonSettingsDialog",a.a,[]);class wi{constructor(ea){this.ga=ea}mc(){this.ga.qa(u.a.Efp,x.a.frame,this.Ffp)}Ffp(){let ea="SingleLineRibbon";
"Multiline"===appChrome.selectors.getRibbonMode()&&(ea="ClassicRibbon");const Pa=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new xe(ea,Pa)).start();return 32}}Object(f.a)(wi,"RibbonSettingsDialogActor",null,[864]);class ig{constructor(){this.Z=null}get name(){return"Common.App.RibbonSettings"}Ec(ea){this.Z=ea;this.Z.register(wi,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").fe(()=>new wi(m.AFrameworkApplication.va)).ha()}init(){const ea=
this.Z.Wa("Common.App.RibbonSettings.IRibbonSettingsDialogActor");ea?ea.mc():F.b(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){U.a.instance.Rc(new ig)}}Object(f.a)(ig,"RibbonSettingsPackage",null,[0,1]);class Qi{static get Fh(){return a.a.iA(Qi.pp,CommonUIStrings.l_SaveACopyFileName)}}Qi.pp="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Qi,"FileNameDialogHtml",null,[]);class el extends a.a{constructor(ea,Pa,Bb,ac){super();this.sGb=this.cTa=null;this.ga=ea;this.Oya=Pa;this.eec=Bb;this.Ue(1,CommonUIStrings.l_SaveButtonLabel);this.Fh=Qi.Fh;this.$g="FileNameDialog-SaveACopy";this.Eh=ac}LLa(ea,Pa,Bb){this.sGb=ea;this.cTa=Bb;ea={["txtFileName"]:Fa.a.oN(m.AFrameworkApplication.dv.sC),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Pa)};this.ti(CommonUIStrings.l_SaveToOneDrive,Object(P.a)(this,this.o6d,"fileNameDialogHandler"),
ea);w.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}o6d(ea,Pa){1!==ea?w.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(ea=Pa.txtFileName.trim(),w.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Pa=Fa.a.sna(m.AFrameworkApplication.fileName),ea&&""!==ea&&""!==Pa&&(ea+=Pa),this.eec.zGa(this.sGb,this.cTa,ea,this.Eh))}}Object(f.a)(el,"FileNameDialog",
a.a,[996]);class mj{constructor(ea,Pa,Bb){this.ga=ea;this.Oya=Pa;this.eec=Bb}create(ea){return new el(this.ga,this.Oya,this.eec,ea)}}Object(f.a)(mj,"FileNameDialogFactory",null,[961]);class Uf extends ze.StandardDialog{constructor(ea){super();this.Ryg=Pa=>{1===Pa?(w.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.Vb(u.a.Zfb,2)):w.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Md=1;this.Ue(1,CommonUIStrings.l_RetryButtonLabel);this.Ue(0,CommonUIStrings.l_DialogClose);
this.ga=ea}fT(ea){w.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",ea);this.zA(ea,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.Ryg)}}Object(f.a)(Uf,"RetryDialog",ze.StandardDialog,[962]);var hh=e(1185);class Jj{}Jj.agb="SaveToCloudStorage";Jj.Zfb="SaveACopy";Object(f.a)(Jj,"SaveToCloudStorageConstants",null,[]);class $h{constructor(ea,Pa,Bb,ac){this.vOd=null;this.jSk=ea;this.za=Bb;this.iDh=Pa;this.Lyh=new E.a;this.qe=ac}Urc(){return this.za.$("SaveToCloudStorageUIIsEnabled")}Msb(){return u.a.agb}LXd(){Wc.a.exe(Object(P.a)(this,
this.jPj,"saveToCloudActionDispatcher"));Wc.a.o2c([new hh.a(u.a.agb,x.a.frame,0)],this.iDh.Qmc())}mc(){const ea=this.iDh.Qmc();ea?(ea.L0(()=>{this.Lyh.setResult(!0)}),this.LXd()):w.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}iFj(){w.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}jPj(ea,Pa,Bb,ac,Gc){ac=m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl;var ld="";switch(ea){case u.a.agb:ld=
Jj.agb;break;case u.a.Zfb:ld=Jj.Zfb;break;default:w.ULS.sendTraceTag(508372377,216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}if(Pa.contextId!==x.a.frame||ea!==this.Msb())return 2;if(!this.Urc())return 8;if(1===Bb)return Hf.SessionStatusManager.instance.zk||m.AFrameworkApplication.Cva?8:32;if(2===Bb){this.iFj();const Gd=ac&&ld===Jj.agb&&null===Gc&&m.AFrameworkApplication.J.$("FilePickerSkip_AfterSignIn_Fix")?{}:Gc;Gd&&m.AFrameworkApplication.J.$("EntryPoint_SaveToCloudStorage")&&
(Gd.SaveEntryPoint=ld);Gd&&Gd.FileDownloadUrl&&w.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.qe&&(this.vOd=this.qe.rg("DialogShown","SaveToOneDriveReponseTime"));this.Lyh.task.continueWith(()=>{this.vOd&&(this.vOd.stop(),this.vOd=null);this.jSk.start(Gd)});return 32}return 8}}Object(f.a)($h,"SaveToCloudStorageActor",null,[891]);class pi extends $h{constructor(ea,Pa,Bb,ac){super(ea,Pa,Bb,ac);this.ENk=Pa}Urc(){return this.za.$("SaveACopyBrsIsEnabled")}Msb(){return u.a.Zfb}LXd(){Wc.a.exe(Object(P.a)(this,
this.jPj,"saveToCloudActionDispatcher"));Wc.a.o2c([new hh.a(u.a.Zfb,x.a.frame,0)],this.ENk.Qmc())}iFj(){m.AFrameworkApplication.ud("CreateCopy_cf;CreateCopy_tf");w.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(pi,"SaveACopyActor",$h,[]);class vh{}vh.default=0;Object(f.a)(vh,"SaveToCloudErrorCodes",null,[]);class Bl{constructor(ea,Pa,Bb,ac,Gc,ld){this.Eh=null;this.dUk=ea;this.CAa=Pa;this.eec=Bb;this.za=ac;this.K6b=Gc;this.eL=ld}start(ea){this.Eh=
ea;var Pa=null!==this.Eh&&this.Eh.hasOwnProperty("SaveEntryPoint")&&this.Eh.SaveEntryPoint.toString()===Jj.agb;if("SharePointOnlineConsumer"===this.za.rb("FileSource")){const Bb=wa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(Bb){Bb.start(null,ea);return}}this.CAa.wad?(ea=Object(ab.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Host),m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl&&Pa&&("Open From URL"===
ea||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))?(w.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.eec.zGa("root","https://onedrive.live.com",null,this.Eh)):(w.ULS.sendTraceTag(6590559,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"User is signed in. We will show file picker."),this.Xql())):
(w.ULS.sendTraceTag(6590560,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"User is not signed in. We will show sign in dialog."),this.Mfp())}Mfp(){this.dUk.create().LLa()}Pq(){this.eL().fT(vh.default)}Xql(){try{w.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let ea={["client_id"]:this.za.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.K6b||2===this.K6b)ea={["client_id"]:this.za.appSettings.UploadToSkyDriveClientId};
WL.init(ea);w.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(P.a)(this,this.iE,"onSuccess"),Object(P.a)(this,this.onFailure,"onFailure"))}catch(ea){w.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",ea,ea.stack),this.Pq()}}iE(ea){w.ULS.sendTraceTag(6590592,216,
50,"Success Callback called. Calling UploadToCloudManger to start upload.");ea&&ea.data&&ea.data.folders&&this.eec.zGa(ea.data.folders[0].id,ea.data.folders[0].urls.viewInBrowser,null,this.Eh)}onFailure(ea){if(ea&&ea.error){if("user_canceled"===ea.error.code){w.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}w.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",ea.error.code,ea.error.message)}else w.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.Pq()}}Object(f.a)(Bl,"SaveToCloudManager",null,[889]);class Bj extends Bl{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){super(Pa,Bb,ac,Gc,ld,Gd);this.yBk=ea}iE(ea){ea&&ea.data&&ea.data.folders?(w.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.yBk.create(this.Eh).LLa(ea.data.folders[0].id,ea.data.folders[0].name,ea.data.folders[0].urls.viewInBrowser)):(w.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.Pq())}onFailure(ea){ea&&ea.error&&"user_canceled"===ea.error.code&&w.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(ea)}Pq(){w.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Pq()}}Object(f.a)(Bj,"SaveACopyManager",Bl,[]);var Vj=e(160);class mh{constructor(ea,Pa,Bb,ac,Gc){this.cTa=this.jm=this.cHc=null;this.z3=!1;this.Eh=this.Z7a=null;this.lff=ea;this.O6a=Pa;this.eL=Bb;this.Fk=ac;this.qe=Gc}Sgb(){this.Fk&&
1===this.Fk.state||(this.jm=this.O6a(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.Md=5,this.jm.hv=!1,this.jm.nM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Xta(){this.jm&&(this.jm.close(),this.jm=null)}A$(){1!==m.AFrameworkApplication.ta.state&&this.eL().fT(vh.default)}y0b(){w.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Ga.a.Zm(this.cTa,Ga.a.Fya(3),void 0,"UploadToCloudManager.RedirectToFolder")}x0b(ea){var Pa=null!==this.Eh&&this.Eh.hasOwnProperty("SaveEntryPoint")&&
this.Eh.SaveEntryPoint.toString()===Jj.agb;m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl&&Pa&&(ea+="&wdsvodm=true");let Bb=Pa=!1;m.AFrameworkApplication.J&&(Pa=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),Bb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));w.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
ea,Pa);if(Pa&&Bb){w.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const ac={};ac[Wd.a.Jxc]="1";ac[Wd.a.documentUrl]=ea;m.AFrameworkApplication.NL().execute(Gc=>{Gc.sendMessage(Ye.a.rQb,ac)})}else Ga.a.Zm(ea,Ga.a.Fya(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}zGa(ea,Pa,Bb=null,ac=null){w.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.qe&&(this.Z7a=this.qe.rg("DialogShown","SaveToOneDriveUploadTime"));this.Sgb();
this.cTa=Pa;this.cHc=this.lff.create(ea,Bb,ac);this.Eh=ac;this.ena()}ena(){w.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.cHc.execute(Object(P.a)(this,this.b$n,"onSaveToCloudUploadFinished"),Object(P.a)(this,this.a$n,"onSaveToCloudUploadFailed"))}b$n(ea){this.Xta();this.z3=!1;if(ea&&ea.data&&ea.data.responseData){var Pa;if(({Zv:Pa}=Xa.d(ea.data.responseData)).returnValue)if(ea=Pa,ea.StatusCode!==Vj.a.jB&&ea.StatusCode!==Vj.a.sic)w.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),
this.A$();else{w.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"UploadToCloudManager upload success.");try{ea.NewDocumentUrl&&""!==ea.NewDocumentUrl?this.x0b(ea.NewDocumentUrl):this.y0b()}catch(Bb){w.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Bb.toString())}this.tkd()}else w.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tb.a.Hvd(ea.data.responseData)}),
this.A$()}else w.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.A$()}a$n(ea){5!==ea.data.status&&12!==ea.data.status||this.z3?(w.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",ea.data.status),this.Xta(),this.A$(),this.tkd()):(w.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.z3=!0,this.ena())}tkd(){this.Z7a&&(this.Z7a.stop(),this.Z7a=null)}}Object(f.a)(mh,"UploadToCloudManager",
null,[890]);class xf extends mh{constructor(ea,Pa,Bb,ac,Gc,ld){super(Pa,Bb,ac,Gc,ld);this.ga=ea}h4f(){return!!this.Eh&&!!this.Eh.SaveEntryPoint&&"VersionHistory"===this.Eh.SaveEntryPoint.toString()}A$(){w.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.h4f()&&this.ga.Zb(u.a.qye,2,{["FailureReason"]:"Unknown"});super.A$()}y0b(){w.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.h4f()&&this.ga.Vb(u.a.Qod,2);super.y0b()}x0b(ea){w.ULS.sendTraceTag(7205461,
216,50,"Redirecting to edit url {0} for Save A Copy.",ea);this.h4f()&&this.ga.Vb(u.a.Qod,2);super.x0b(ea)}ena(){this.Eh&&"true"===this.Eh.SkipSaveToHost?super.ena():32!==this.ga.Vb(u.a.C1b,1)?(w.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.ena()):this.ga.Zb(u.a.C1b,2,[()=>{w.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");mh.prototype.ena.call(this)},()=>{w.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.A$()}])}}Object(f.a)(xf,"SaveACopyUploadToCloudManager",mh,[]);var Wg=e(780),Oj=e(1183);class Bg{constructor(){this.Z=null;this.Gz=()=>{m.AFrameworkApplication.J.$("SaveACopyBrsIsEnabled")&&this.Z.resolve("Common.App.SaveACopy.SaveACopyActor").mc()}}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.J.lq(this.Gz)}dispose(){}Ec(ea){this.Z=ea;this.Z.register(xf,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").fe(()=>new xf(m.AFrameworkApplication.va,ea.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new Oj.a).create(),()=>new Uf(m.AFrameworkApplication.va),m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Kt)).ha();this.Z.register(mj,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").fe(()=>new mj(m.AFrameworkApplication.va,m.AFrameworkApplication.ta.Pb,ea.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.Z.register(pi,"Common.App.SaveACopy.SaveACopyActor").fe(()=>new pi(ea.resolve("Common.App.SaveACopy.SaveACopyManager"),
ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.Kt)).ha();this.Z.register(Bj,"Common.App.SaveACopy.SaveACopyManager").fe(()=>new Bj(ea.resolve("Common.App.SaveACopy.FileNameDialogFactory"),ea.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Wg.a.instance,ea.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.Wga,()=>new Uf(m.AFrameworkApplication.va))).ha()}static main(){U.a.instance.Rc(new Bg)}}
Object(f.a)(Bg,"PackageManager",null,[0,1]);var Xg=e(44);class kl extends ze.StandardDialog{constructor(ea,Pa){super();this.kbc=!1;this.mS=null;this.Ryg=Bb=>{1===Bb?(w.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.mS?this.ga.Zb(u.a.$pd,2,[this.mS,this.kbc]):this.ga.Vb(u.a.$pd,2)):w.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.ga=ea;this.$Jc=Pa;this.tGa=!1}fT(ea,Pa,Bb){this.mS=Pa;this.kbc=Bb;w.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
ea,Bb);ea=this.qrf(ea);0===ea?(this.Md=6,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.Md=0,this.Ue(1,CommonUIStrings.l_DialogClose));0===ea&&w.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.zA(Xg.a.xSo,this.owm(ea),this.nwm(ea,Pa),this.Ryg,!0)}qrf(ea){return 0>ea||6<ea?(w.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",ea),0):ea}nwm(ea,Pa){ea=this.qrf(ea);return this.$Jc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Pa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][ea]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Pa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][ea]}owm(ea){ea=
this.qrf(ea);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][ea]}}Object(f.a)(kl,"ErrorRetryDialog",ze.StandardDialog,[884]);class ff{constructor(ea,Pa){this.za=ea;this.ga=Pa;this.$Jc=this.za.$("SaveToHostWithExtraCharsInFileName")}create(){return new kl(this.ga,this.$Jc)}}Object(f.a)(ff,"ErrorRetryDialogFactory",
null,[862]);class gj extends a.a{constructor(ea,Pa,Bb,ac,Gc,ld,Gd=null){super();this.Baa=null;this.ga=Pa;this.Oya=ac;this.$7a=ld;this.za=ea;this.eL=Gc;this.Fk=Bb;this.$Jc=this.za.$("SaveToHostWithExtraCharsInFileName");this.Eh=Gd;this.Ue(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Fk}hli(ea,Pa){this.Dxa(1,!!ea&&ea!==Pa);this.Baa=document.getElementById(gj.Vsi);W.a.addHandler(this.Baa,"change",Object(P.a)(this,this.Zpe,"onFileNameChange"));W.a.addHandler(this.Baa,"input",Object(P.a)(this,
this.Zpe,"onFileNameChange"));this.Baa.focus()}Usi(ea){return this.$Jc?(new RegExp("["+this.Dqi('\\/:*?"<>|')+"]")).test(ea):(new RegExp("["+this.Dqi('\\/:*?"<>|#{}%~&')+"]")).test(ea)}Dqi(ea){return ea.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}PUf(){const ea=Fa.a.oN(m.AFrameworkApplication.dv.sC);this.Dxa(1,!!this.Baa&&""!==this.Baa.value&&this.Baa.value!==ea)}Zpe(){this.Baa&&window.setTimeout(()=>{this.PUf()},0)}o6d(ea,Pa){if(1!==ea)w.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");
else{ea=Pa[gj.Vsi];Pa=gj.fwj in Pa?Pa[gj.fwj]:!1;w.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Fa.a.IFj(ea),Pa);const Bb=Fa.a.sna(m.AFrameworkApplication.fileName);(ea=ea?ea.trim():null)&&""!==ea&&""!==Bb||1===this.ta.state?this.Usi(ea)?this.eL.create().fT(1,ea,Pa):this.$7a.zGa(ea+Bb,Pa,this.Eh):this.eL.create().fT(2,ea,Pa)}}dispose(){this.Baa&&(W.a.removeHandler(this.Baa,"change",Object(P.a)(this,this.Zpe,"onFileNameChange")),
W.a.removeHandler(this.Baa,"input",Object(P.a)(this,this.Zpe,"onFileNameChange")),this.Baa=null);super.dispose()}}gj.Vsi="txtFileName";gj.fwj="chkOverwrite";Object(f.a)(gj,"FileNameDialogBase",a.a,[]);class ej{static get Fh(){return a.a.iA(ej.pp,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}ej.pp="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(ej,"FileNameDialogHtml",null,[]);class zi extends gj{constructor(ea,Pa,Bb,ac,Gc,ld){super(ea,Pa,Bb,ac,Gc,ld);this.Fh=ej.Fh;this.$g="FileNameDialog-SaveAsToHost"}LLa(ea,Pa){const Bb=Fa.a.oN(m.AFrameworkApplication.dv.sC);Pa={["txtFileName"]:ea||Bb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Pa};this.ti(CommonUIStrings.L_SaveAs,Object(P.a)(this,this.o6d,"fileNameDialogHandler"),Pa);this.hli(ea,Bb)}}Object(f.a)(zi,"FileNameDialog",gj,[883]);class Lk{constructor(ea,
Pa,Bb,ac,Gc,ld){this.ga=Pa;this.za=ea;this.Oya=ac;this.$7a=ld;this.eL=Gc;this.Fk=Bb}create(){return new zi(this.za,this.ga,this.Fk,this.Oya,this.eL,this.$7a)}}Object(f.a)(Lk,"FileNameDialogFactory",null,[863]);class Gh{constructor(ea,Pa,Bb){this.SOj=(ac,Gc,ld,Gd,ue)=>Gc.contextId!==x.a.frame||ac!==u.a.$pd?2:this.za.$("SaveAsToHostBrsIsEnabled")?1===ld?Hf.SessionStatusManager.instance.zk||m.AFrameworkApplication.Cva?8:32:2===ld?(w.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
ac=this.xVe.create(),ue&&Object.getType(ue)===Array&&2===ue.length?ac.LLa(ue[0],!!ue[1]):ac.LLa(null,!1),32):8:8;this.$7a=Bb;this.xVe=Pa;this.za=ea}mc(){2===m.AFrameworkApplication.ta.Pb.gl?m.AFrameworkApplication.va.nb(u.a.$pd,x.a.frame,this.SOj,4):m.AFrameworkApplication.va.qa(u.a.$pd,x.a.frame,this.SOj)}}Object(f.a)(Gh,"SaveAsToHostActor",null,[]);class aj{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){this.jm=null;this.kbc=this.z3=!1;this.Z7a=this.Eh=this.mS=null;this.za=Pa;this.Gla=this.za.appSettings.SaveAsToHostWebServiceBase;
this.bth=ac;this.O6a=Gc;this.$f=Bb;this.eL=ld;this.qe=ue;this.Fk=Gd;this.ga=ea;this.Eza=Pa.rb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Sgb(){1!==this.Fk.state&&(this.jm=this.O6a(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.Md=5,this.jm.hv=!1,this.jm.nM(CommonUIStrings.l_DefaultDialogTitle,null,null))}A$(ea=0){1!==this.Fk.state&&this.eL.create().fT(ea,Fa.a.oN(this.mS),this.kbc)}y0b(){const ea=this.za.appSettings.BreadcrumbFolderUrl;w.ULS.sendTraceTag(8194016,216,
50,"Redirecting to OneDrive for business Folder.");Ga.a.Zm(ea,Ga.a.Fya(3),void 0,"UploadToHostManager.RedirectToFolder")}x0b(ea){let Pa=!1,Bb=!1;this.za&&(Pa=this.za.$("SaveACopyIsEnabledForUiHost"),Bb=this.za.$("UiHostSupportsDocRebootFeatures"));w.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",ea,Pa,Bb);if(Pa&&Bb){w.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const ac=
{};ac[Wd.a.Jxc]="1";ac[Wd.a.documentUrl]=ea;ac[Wd.a.reason]=Re.a.$zg;m.AFrameworkApplication.NL().execute(Gc=>{Gc.sendMessage(Ye.a.rQb,ac)})}else Pa&&!Bb&&m.AFrameworkApplication.HN?Ga.a.Zm(ea,Ga.a.Fya(4),void 0,"UploadToHostManager.RedirectToEditUrl"):Ga.a.Zm(ea,Ga.a.Fya(3),void 0,"UploadToHostManager.RedirectToEditUrl")}zGa(ea,Pa,Bb=null){w.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.bth&&!this.bth()&&this.$f&&(this.qe&&(this.Z7a=this.qe.rg("DialogShown","SaveAsToHostUploadTime")),
this.Sgb(),this.kbc=Pa,this.mS=ea,(this.Eh=Bb)&&"true"===this.Eh.SkipSaveToHost?this.v5d():this.ena())}ena(){32!==this.ga.Vb(u.a.C1b,1)?(w.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.v5d()):this.ga.Zb(u.a.C1b,2,[()=>{w.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.v5d()},(ea,Pa)=>{w.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.A$(Pa)}])}cbo(ea){this.Xta();this.z3=!1;if(ea&&ea.data&&ea.data.responseData)if(({Zv:Pa}=Xa.d(ea.data.responseData)).returnValue)if(ea=Pa,ea.StatusCode!==Vj.a.jB&&ea.StatusCode!==Vj.a.sic){w.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Pa={};Pa.FailureReason=ea.StatusCode.toString();Pa.ExtraInfo=ea.ExtraInfo;this.H1a(Pa);this.A$(parseInt(ea.ExtraInfo))}else{w.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.Dxg();try{ea.NewDocumentUrl&&
""!==ea.NewDocumentUrl?this.x0b(ea.NewDocumentUrl):this.y0b()}catch(Bb){w.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Bb.toString())}this.tkd()}else w.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tb.a.Hvd(ea.data.responseData)}),this.H1a({["FailureReason"]:"Failed to deserialize response"}),this.A$();else w.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.H1a({["FailureReason"]:"null response"}),
this.A$()}bbo(ea){5!==ea.data.status&&12!==ea.data.status||this.z3?(w.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:ea.data.status,["HttpStatus"]:ea.data.Xe}),this.H1a({["FailureReason"]:ea.data.Xe.toString()}),this.Xta(),this.A$(),this.tkd()):(w.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.z3=!0,this.Eh&&"true"===this.Eh.SkipSaveToHost?this.v5d():this.ena())}Xta(){this.jm&&(this.jm.close(),this.jm=null)}tkd(){this.Z7a&&
(this.Z7a.stop(),this.Z7a=null)}Dxg(){this.Eh&&"VersionHistory"===this.Eh.SaveEntryPoint&&this.ga.Vb(u.a.Qod,2)}H1a(ea){this.Eh&&"VersionHistory"===this.Eh.SaveEntryPoint&&this.ga.Zb(u.a.qye,2,ea)}v5d(){let ea=this.Gla+this.Eza;ea=Pb.a.Kq(ea,"qs",Fa.a.nj(m.AFrameworkApplication.lm));ea=Pb.a.Kq(ea,"n",Fa.a.nj((new Date).getTime().toString()));ea=Pb.a.Kq(ea,"ov",Fa.a.nj(this.kbc.toString()));ea=Pb.a.Kq(ea,"fn",Fa.a.nj(this.mS));this.Eh&&this.Eh.FileDownloadUrl&&(ea=Pb.a.Kq(ea,"furl",Fa.a.nj(this.Eh.FileDownloadUrl)));
this.$f.addRequest(ea,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(P.a)(this,this.cbo,"onUploadFinished"),Object(P.a)(this,this.bbo,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(aj,"UploadToHostManager",null,[861]);class ck{constructor(){this.Z=null;this.Gz=()=>{m.AFrameworkApplication.J.$("SaveAsToHostBrsIsEnabled")&&this.Z.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").mc()}}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.J.lq(this.Gz)}Ec(ea){this.Z=
ea;this.Z.register(ff,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").fe(()=>new ff(m.AFrameworkApplication.J,m.AFrameworkApplication.va)).ha();this.Z.register(aj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").fe(()=>new aj(m.AFrameworkApplication.va,m.AFrameworkApplication.J,m.AFrameworkApplication.pe,()=>m.AFrameworkApplication.isShuttingDown,()=>(new Oj.a).create(),ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Kt)).ha();this.Z.register(Lk,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").fe(()=>new Lk(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Pb,ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),ea.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();this.Z.register(Gh,"Common.App.SaveAsToHost.SaveAsToHostActor").fe(()=>
new Gh(m.AFrameworkApplication.J,ea.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),ea.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){U.a.instance.Rc(new ck)}}Object(f.a)(ck,"SaveAsToHostPackage",null,[0,1]);class yk extends ze.StandardDialog{constructor(){super();this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose)}fT(ea){this.zA(ea,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(f.a)(yk,"ErrorDialog",ze.StandardDialog,
[962]);var eh=e(211);class vg extends ze.StandardDialog{constructor(ea,Pa,Bb){super();this.bgn=ac=>{0===ac?(w.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"User dismissed SignIn Dialog."),this.hide()):this.xte()};this.Xtj=()=>{this.toa&&this.hide();w.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb&&1===m.AFrameworkApplication.ta.Pb.gl?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.ga.Vb(u.a.agb,2)};this.ga=ea;this.CAa=Pa;this.Oya=Bb;this.rfa=!1;this.Md=1;this.YW(1);this.Ue(1,CommonUIStrings.l_SignIn);this.Ue(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}LLa(){this.CAa.oUh(this.Xtj);this.Yx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.bgn)}Kul(){let ea="2";if(this.Oya)switch(this.Oya.gl){case 3:ea="0";break;case 2:ea="3";break;case 1:ea="1"}return ea}hide(){this.CAa.uIo(this.Xtj);super.hide()}xte(){var ea=m.AFrameworkApplication.J.$("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";ea=new eh.QueryStringBuilder(ea);ea.Me("prompt","1");ea.Me("cbcxt",this.Kul());m.AFrameworkApplication.Qla(ea);Ga.a.Zm(ea.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(f.a)(vg,"SignInDialog",ze.StandardDialog,[998]);class tm{constructor(ea,Pa,Bb){this.ga=ea;this.CAa=Pa;this.Oya=Bb}create(){return new vg(this.ga,this.CAa,this.Oya)}}Object(f.a)(tm,"SignInDialogFactory",null,[964]);var Cm=e(386);class Fj{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.Gla=ea;this.mS=
Pa;this.t9b=Bb;this.sGb=ac;this.r8e=Gc;this.Eza=ld;this.Eh=Gd}execute(ea,Pa){if(!m.AFrameworkApplication.isShuttingDown&&m.AFrameworkApplication.pe){var Bb={"Content-Type":"application/json; charset=utf-8"};Cm.a.rx("ib994913;b48ce942");var ac=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSkyDriveUploadHandler",!1),Gc=m.AFrameworkApplication.pe.mDb,ld=!!Gc,Gd=!!m.AFrameworkApplication.pe.oib&&m.AFrameworkApplication.pe.oib<Date.now(),ue=ac&&ld&&
!Gd;ue?(Bb["X-UseGraphFileUploader"]="1",Bb["X-AADToken"]=Gc):(this.Gla="/start/",this.Eza.startsWith("/start/")&&(this.Eza=this.Eza.substring(7)));w.ULS.sendTraceTag(507908319,216,50,"Use GraphFileUploader:{0}, flight enabled:{1}, token available:{2}, token expired:{3}",ue,ac,ld,Gd);ac=this.Gla+this.Eza;ac=Pb.a.Kq(ac,"fo",Fa.a.nj(this.sGb));ac=Pb.a.Kq(ac,"fn",Fa.a.nj(this.mS));ac=Pb.a.Kq(ac,"qs",Fa.a.nj(this.r8e));ac=Pb.a.Kq(ac,"n",Fa.a.nj((new Date).getTime().toString()));this.Eh&&this.Eh.FileDownloadUrl&&
(ac=Pb.a.Kq(ac,"furl",Fa.a.nj(this.Eh.FileDownloadUrl)));this.t9b&&(ac=Pb.a.Kq(ac,"fnn",Fa.a.nj(this.t9b)));m.AFrameworkApplication.pe.addRequest(ac,1,"",Bb,!1,2,ea,Pa,null)}}}Object(f.a)(Fj,"SkyDriveUploadCaller",null,[997]);class hj{constructor(ea){this.za=ea;this.jMb=ea.appSettings.SkyDriveUploadWebServiceBase;this.mS=ea.appSettings.FileName;this.Eza=ea.rb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(ea,Pa,Bb){return new Fj(this.jMb,this.mS,Pa,ea,m.AFrameworkApplication.lm,this.Eza,
Bb)}}Object(f.a)(hj,"SkydriveUploadCallerFactory",null,[963]);class wg{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.J.$("SaveToCloudStorageUIIsEnabled")&&this.Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").mc()}dispose(){}Ec(ea){this.Z=ea;this.Z.register(tm,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").fe(()=>new tm(m.AFrameworkApplication.va,Wg.a.instance,
m.AFrameworkApplication.ta.Pb)).ha();this.Z.register(hj,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").fe(()=>new hj(m.AFrameworkApplication.J)).ha();this.Z.register($h,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").fe(()=>new $h(ea.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.Kt)).ha();
this.Z.register(mh,"Common.App.SaveToCloudStorage.UploadToCloudManager").fe(()=>new mh(ea.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Oj.a).create(),()=>new yk,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Kt)).ha();this.Z.register(Bl,"Common.App.SaveToCloudStorage.SaveToCloudManager").fe(()=>new Bl(ea.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Wg.a.instance,ea.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),m.AFrameworkApplication.J,
m.AFrameworkApplication.Wga,()=>new yk)).ha()}static main(){U.a.instance.Rc(new wg)}}Object(f.a)(wg,"PackageManager",null,[0,1]);class Od extends ze.StandardDialog{constructor(){super();this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose)}fT(ea,Pa){this.Gli(ea,Pa,Xg.a.zSo)}Gli(ea,Pa,Bb){w.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Bb);this.zA(Bb,ea,Pa,null)}gBf(ea,Pa){w.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.zA(Xg.a.BSo,
ea,Pa,null,!0)}}Object(f.a)(Od,"ErrorDialog",ze.StandardDialog,[971]);class zg{static get Fh(){return a.a.iA(zg.pp,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}zg.pp="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(zg,"FileNameDialogHtml",null,[]);var nh=e(101);class Vi extends gj{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){super(ea,Pa,Bb,ac,Gc,ld,ue);this.flb=this.B$e=this.nV=null;this.bpl=CommonUIStrings.l_SaveToAnotherFolder;this.Fh=zg.Fh;this.$g="FileNameDialog-SaveToSharePoint";this.TRc=Gd;this.SNk=ue}LLa(ea){const Pa=Fa.a.oN(m.AFrameworkApplication.dv.sC),Bb=m.AFrameworkApplication.breadcrumbFolderName,ac=m.AFrameworkApplication.breadcrumbBrandName,Gc={["txtFileName"]:ea||Pa};let ld=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ta.Pb.gl&&(ld=CommonUIStrings.L_SaveACopy);this.ti(ld,Object(P.a)(this,this.o6d,"fileNameDialogHandler"),Gc);this.hli(ea,Pa);this.cAf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost")||(this.nV=document.getElementById("anotherFolder"),ea=document.getElementById("folderLocation"),this.B$e=qd.a.qXh(ea,this.nV,"anotherFolderDescribedBy"),
this.nV.className="WACButton WACDialogButtonNormal",ea=!1,Bb&&Bb.length?(this.eSh(this.nV,this.B$e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,ac,Bb)),ea=this.m0k(ac,Bb)):this.eSh(this.nV,this.B$e,CommonUIStrings.l_CurrentOnlineFolder),this.l2k(this.nV),this.o0k(this.nV),ea?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.nV,"SaveToAnotherLocationTwo"),w.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.nV,"SaveToAnotherLocationOne"),W.a.addHandler(this.nV,ca.a.click,Object(P.a)(this,this.Bkg,"onSaveToAnotherLocationClick")),W.a.addHandler(this.nV,ca.a.Bj,Object(P.a)(this,this.ztj,"onSaveToAnotherLocationKeyDown")))}m0k(ea,Pa){let Bb;Bb=!1;const ac=document.getElementById("currentLocation");ac.innerText="";const Gc=this.xHi(ac,ea),ld=this.xHi(ac,Pa);let Gd=255,ue=255;255<Gc+ld&&(Gd=Math.max(238,408-Gc),ue=Math.max(170,408-ld),Bb=!0);this.V4k(ac,ea,ue,Pa,Gd);return Bb}xHi(ea,
Pa){const Bb=document.createElement("div");Bb.innerText=Pa;Bb.style.visibility="hidden";ea.appendChild(Bb);Pa=Bb.clientWidth;ea.removeChild(Bb);return Pa}V4k(ea,Pa,Bb,ac,Gc){Pa&&(this.dSh(ea,Pa,Bb),this.M4k(ea));ac&&this.dSh(ea,ac,Gc)}dSh(ea,Pa,Bb){const ac=document.createElement("div");ac.innerText=Pa;ac.title=Pa;ac.className="SaveToAnotherFolderBreadcrumb";ac.style.maxWidth=Bb.toString()+"px";ea.appendChild(ac)}M4k(ea){const Pa=document.createElement("span");Pa.id="FolderSeparator";const Bb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");Bb.setAttribute("class","SeparatorCaret");const ac=document.createElementNS("http://www.w3.org/2000/svg","polygon");ac.setAttribute("points","1 4 1 11 5 7.5");Bb.appendChild(ac);Pa.appendChild(Bb);ea.appendChild(Pa)}eSh(ea,Pa,Bb){Bb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Bb);Pa&&(Pa.innerText=Bb);ea.tabIndex=0;ea.setAttribute(qd.a.fi,qd.a.i4)}o0k(ea){const Pa=document.createElement("span");Pa.id="anotherFolderText";Pa.innerText=this.bpl;Pa.className="AnotherFolderTextSpan";
ea.appendChild(Pa)}l2k(ea){const Pa=document.createElement("span");Pa.className="cui-img-cont-float cui-img-16by16 ";this.flb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.flb.setAttribute("class","FolderIconSVG");const Bb=document.createElementNS("http://www.w3.org/2000/svg","path");Bb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.flb.appendChild(Bb);Pa.appendChild(this.flb);
ea.appendChild(Pa)}ztj(ea){!ea||ea.keyCode!==nh.a.vw&&ea.keyCode!==nh.a.jxd||this.Bkg(ea)}Bkg(){if(this.Baa){const ea=Fa.a.sna(m.AFrameworkApplication.fileName);let Pa=this.Baa.value;this.hide();Pa&&""!==Pa&&""!==ea||1===this.ta.state?(""!==ea&&(Pa+=ea),this.Usi(Pa)?this.eL.create().fT(1,Pa,!1):this.TRc.start(Pa,this.SNk)):this.eL.create().fT(2,Pa,!1)}}mul(ea){this.nV&&this.flb&&(ea?(this.nV.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.nV,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.flb,
"DisabledFolderIconSVG")):(this.nV.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.nV,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.flb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.nV,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.flb,"DisabledFolderIconSVG"))))}PUf(){super.PUf();this.mul(!!this.Baa&&""!==this.Baa.value)}dispose(){this.nV&&(W.a.removeHandler(this.nV,ca.a.click,Object(P.a)(this,this.Bkg,"onSaveToAnotherLocationClick")),W.a.removeHandler(this.nV,
ca.a.Bj,Object(P.a)(this,this.ztj,"onSaveToAnotherLocationKeyDown")),this.nV=null);super.dispose()}}Object(f.a)(Vi,"FileNameDialog",gj,[1E3]);var he=e(530),td=e(287),kh=e(1480),eg=e(1688);class li{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(li,"SaveAsDialogInput",null,[]);class Ll{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(Ll,"SaveLocation",null,[]);var mi=e(100);class Ek{constructor(ea,
Pa,Bb,ac,Gc,ld,Gd,ue,Ce){this.y2e=null;this.mS="";this.mwm=()=>{const tf=new qb.a;tf.add(this.ivm());const Zg=this.tRm();Zg&&tf.addRange(Zg);return Object.assign(new li,{enableMoreLocations:!m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.mS,extension:Fa.a.sna(this.gQ.sC),saveLocations:tf.toArray(),scenario:"SaveToSharePoint"})};this.TRc=ea;this.eL=Pa;this.Eh=Ce;this.$7a=Bb;this.Fk=Gc;this.gQ=ac;this.TLb=Gd;this.Ncc=ue;ld&&(this.y2e=new zc.a(()=>new kh.a(ld.value,
null)))}ivm(){const ea=new he.a(td.a.Oh());ea.W("type","currentHost");return Object.assign(new Ll,{folderName:this.gQ.breadcrumbFolderName,friendlyPath:this.gQ.breadcrumbBrandName,properties:ea})}jzn(ea){return!!ea&&"ClassicMru"===ea.type&&!!ea.service_info&&!!ea.service_info.service_id&&-1!==ea.service_info.service_id.indexOf("SHAREPOINT")}tRm(){if(!this.y2e||!this.TLb)return null;var ea=this.y2e.value.F1("SaveAsToSharePointDialog",!1);if(!ea||3!==ea.state||!ea.Rkj)return null;ea=ea.Rkj;const Pa=
new qb.a;let Bb=0,ac=0;for(var Gc=0;Gc<ea.length;Gc++){var ld=ea[Gc];if(!this.jzn(ld))continue;Bb++;const Gd=ld.title,ue=eg.b(ld,m.AFrameworkApplication.isRtl);if(!Gd||!ue)continue;if(!ld.sharepoint_info)continue;const Ce=ld.url,tf=ld.sharepoint_info.site_url;if(!Ce||!tf)continue;let Zg="",Xi="";ld.onedrive_info&&(Zg=ld.onedrive_info.drive_id,Xi=ld.onedrive_info.item_id);ac++;ld=new he.a(td.a.Oh());ld.W("type","SharePoint");ld.W("siteUrl",tf);ld.W("folderUrl",Ce);ld.W("driveId",Zg);ld.W("folderId",
Xi);ac++;Pa.add(Object.assign(new Ll,{folderName:Gd,friendlyPath:ue,properties:ld}))}Gc=new Map;Gc.set("NumPlaces",ea.length.toString());Gc.set("NumSharepointPlaces",Bb.toString());Gc.set("placesWithMetadata",ac.toString());sa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Gc);0<Bb&&(ac?.5>1*ac/Bb&&sa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):sa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",
!1,!1,null));return Pa}hMf(){const ea={};ea.inputPropsCallback=this.mwm;return ea}LLa(ea){this.mS=ea;this.mS||(this.mS=String.format(CommonUIStrings.l_SaveACopy_Filename,Fa.a.oN(this.gQ.sC)));ea={["id"]:"SaveAsDialog",["bodyControls"]:this.hMf()};let Pa=CommonUIStrings.L_SaveAs;2===this.Fk.Pb.gl&&(Pa=CommonUIStrings.L_SaveACopy);const Bb=new a.a(!1,!1,!0);Bb.Md=1;Bb.$g="SaveAsDialog";Bb.Ue(1,CommonUIStrings.l_SaveButtonLabel);Bb.ti(Pa,Object(P.a)(this,this.vSo,"saveAsDialogHandler"),ea)}Xep(ea,Pa){ea&&
""!==ea&&""!==Pa||1===this.Fk.state?this.izn()?this.WIn(ea,Pa):(""!==Pa&&(ea+=Pa),this.TRc.start(ea,this.Eh)):(w.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.eL.create().fT(2,ea,!1))}WIn(ea,Pa){sa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Bb=this.Ncc.$0d(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Ncc.P5c(Bb).then(ac=>{if(ac&&0<ac.length){const Gc=
ac[0][Wd.a.Ryj]||"root",ld=ac[0][Wd.a.Qyj],Gd=ac[0][Wd.a.Syj];ac=ac[0][Wd.a.Uyj];if(""!==Gd&&""!==ac)this.TLb.zGa(ac,ea+Pa,Gd,Gc,ld,this.Eh),sa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.eL.create().fT(0,ea,!1);const ue=Ic.a.HI();ue&&(ue.set("FolderIdAvailable",""===Gc?"false":"true"),ue.set("DriveIdAvailable",""===ld?"false":"true"),ue.set("SiteUrlAvailable",""===Gd?"false":"true"),ue.set("FolderUrlAvailable",""===ac?"false":"true"));sa.Health.instance.recordKpiFailure("SaveACopySFP",
"Not all values Available to start upload",!1,!1,Object.assign(new mi.a,{extendedProperties:ue}))}}else this.eL.create().fT(0,ea,!1),sa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(ac=>{"Canceled"===ac?((ac=Ic.a.HI())&&ac.set("IsCanceled","true"),sa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new mi.a,{extendedProperties:ac}))):sa.Health.instance.recordKpiFailure("SaveACopySFP",ac,!1,!1,null)})}izn(){return this.Ncc?this.Ncc.s4f():
(w.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}vSo(ea,Pa){if(Pa&&1===ea){ea=Pa.fileName;var Bb=Fa.a.sna(this.gQ.sC);Pa.moreLocationsSelected&&this.Xep(ea,Bb);if(Pa.locationCallback){var ac=Pa.locationCallback();if(ac)if(ac.properties&&"currentHost"===ac.properties.K("type"))this.$7a.zGa(ea+Bb,!1,this.Eh);else if(ac.properties&&"SharePoint"===ac.properties.K("type")){Pa=ac.properties.K("folderId");const Gc=ac.properties.K("driveId"),ld=ac.properties.K("siteUrl");ac=ac.properties.K("folderUrl");
this.TLb.zGa(ac,ea+Bb,ld,Pa,Gc,this.Eh)}else w.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back");else w.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else w.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Ek,"ReactSaveAsDialog",null,[1E3]);class Ml{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue=null,Ce=null,tf=null){this.ga=Pa;this.za=ea;this.Oya=ac;this.$7a=ld;this.eL=Gc;this.Fk=Bb;this.FIh=Gd;this.qJk=ue;this.TLb=Ce;this.Ncc=tf}create(ea){return this.Fk&&
this.Fk.Pb.$I?new Ek(this.FIh,this.eL,this.$7a,m.AFrameworkApplication.dv,this.Fk,this.qJk,this.TLb,this.Ncc,ea):new Vi(this.za,this.ga,this.Fk,this.Oya,this.eL,this.$7a,this.FIh,ea)}}Object(f.a)(Ml,"FileNameDialogFactory",null,[970]);class Qk{constructor(ea,Pa,Bb,ac){this.$y=this.GPc=null;this.aTb=Gc=>{this.$y||3!==Gc.state||(this.$y=Gc)};this.kGb=ea;this.Fk=Bb;this.$Ok=ac;this.s5a=new zc.a(()=>new kh.a(Pa.value,this.aTb))}get Zuj(){this.GPc||(this.s5a.value.F1("Save As",!0),this.$y&&this.$y.Mia&&
this.$y.Mia.length&&(this.GPc=this.oJm(this.$y.Mia)));return this.GPc}start(ea){if(!this.Zuj)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.GPc=m.AFrameworkApplication.breadcrumbFolderUrl;else return w.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.$y),!1;const Pa=this.$Ok();Pa.kfp();const Bb=Pa.bMm();if(!Bb)return w.ULS.sendTraceTag(24664067,
216,10,"Picker container is null, will not show picker."),!1;this.kGb.start((ac,Gc)=>{Pa.hide();ea(ac,Gc)},()=>{this.onCancel(Pa)},Bb,this.GPc);return!0}onCancel(ea){ea.hide();w.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}oJm(ea){ea=ea.toLowerCase();ea.endsWith("/")||(ea+="/");const Pa=ea.indexOf("/documents/");return-1!==Pa?ea.substring(0,Pa+1)+"_layouts/15/onedrive.aspx":""}}Object(f.a)(Qk,"OneDriveFilePickerHelper",null,[969]);class km extends a.a{constructor(){super()}kfp(){this.BIc=
"FilePickerDialog";this.Fh="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.$g="PickerDialog-MsoSp";this.showDialog("",null)}bMm(){return document.getElementById("FilePickerDiv")}JP(){}Ria(){}}Object(f.a)(km,"PickerDialog",a.a,[968]);class $l{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.za=ea;this.xVe=Bb;this.ga=Pa;this.TRc=ac;this.kGb=Gc;this.FPc=ld;this.Vvk=Gd}mc(){const ea=this.kGb.Qmc();ea?ub.a.bia||this.za.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ga.nb(u.a.bzc,x.a.frame,Object(P.a)(this,
this.mPj,"saveToSharePointActionDispatcher"),64):(ea.xdb.continueWith(Pa=>{Pa.wj&&this.kGb.ujg(Pa)}),this.LXd()):w.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}LXd(){Wc.a.exe(Object(P.a)(this,this.mPj,"saveToSharePointActionDispatcher"));Wc.a.o2c([new hh.a(u.a.bzc,x.a.frame,0)],this.kGb.Qmc())}get Urc(){return this.za.$("SaveToAnotherFolderBrsIsEnabled")}get t4h(){return this.za.$("UserCanWriteRelative")}mPj(ea,Pa,Bb,ac,Gc){return Pa.contextId!==x.a.frame||
ea!==u.a.bzc?2:this.Urc&&(this.FPc.Zuj||this.t4h)?1===Bb?Hf.SessionStatusManager.instance.zk||m.AFrameworkApplication.Cva?8:this.Vvk()?32:8:2===Bb?(w.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Gc&&Gc.SaveEntryPoint&&"VersionHistory"===Gc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.t4h?(w.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.xVe.create(Gc).LLa(null)):(w.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.TRc.start(null,Gc)),32):8:8}}Object(f.a)($l,"SaveToSharePointActor",null,[]);class ll{constructor(ea,Pa,Bb,ac){this.Eh=this.eBh=null;this.TLb=ea;this.eL=Pa;this.FPc=Bb;this.Fk=ac}start(ea,Pa){w.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.eBh=ea;this.Eh=Pa;this.FPc.start((Bb,ac)=>{this.processResponse(Bb,ac)})||this.hHg()}processResponse(ea,Pa){if(ea)this.iE(Pa);else this.onFailure(Pa)}hHg(){1!==this.Fk.state&&this.eL().gBf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}iE(ea){w.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");let Pa="",Bb="";ea&&ea.data&&ea.data.value&&ea.data.value.length&&ea.data.value[0].parentReference?(Pa=ea.data.value[0].id,Bb=ea.data.value[0].parentReference.driveId,Pa&&Bb||w.ULS.sendTraceTag(508040406,216,15,"Picker return invalid data, folder id is null: {0}, drive id is null: {1}.",!Pa,!Bb)):w.ULS.sendTraceTag(508040405,216,15,"Picker return invalid data or empty parent reference.");if(ea&&ea.data&&ea.data.value&&
ea.data.value.length&&ea.data.value[0].sharePoint){const ac=ea.data.value[0].sharePoint.url;ea=ea.data.value[0].sharePoint.listUrl;let Gc=null;if(ac&&(Gc=ea?this.FRm(ea):this.ERm(ac))){this.TLb.zGa(ac,this.eBh,Gc,Pa,Bb,this.Eh);return}w.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ac,!Gc)}w.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.hHg()}ERm(ea){ea.endsWith("/")||(ea+="/");let Pa=
0;for(let Bb=0;Bb<ea.length;Bb++)if("/"===ea.charAt(Bb)&&5===++Pa)return ea.substr(0,Bb);return null}FRm(ea){ea.endsWith("/")&&(ea=ea.substring(0,ea.length-1));const Pa=ea.lastIndexOf("/");return-1!==Pa?ea.substring(0,Pa):null}onFailure(ea){w.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");ea&&ea.error?w.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",ea.error.errorCode,ea.error.message):w.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");
this.hHg()}}Object(f.a)(ll,"SaveToSharePointManager",null,[967]);class tk{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf){this.Gla=ea;this.mS=Pa;this.t9b=ac;this.r8e=ue;this.cTa=Bb;this.qUk=Gc;this.sGb=ld;this.hlh=Gd;this.Eza=Ce;this.Eh=tf}execute(ea,Pa){if(!m.AFrameworkApplication.isShuttingDown&&m.AFrameworkApplication.pe){var Bb={"Content-Type":"application/json; charset=utf-8"},ac=this.Gla+this.Eza;Cm.a.rx("d6454864;54012657");m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSharePointSaveAsHandler",
!1)&&(Bb["X-UseGraphFileUploader"]="1",!m.AFrameworkApplication.pe.oib||m.AFrameworkApplication.pe.oib>=Date.now())&&(Bb["X-AADToken"]=m.AFrameworkApplication.pe.mDb);this.sGb&&(ac=Pb.a.Kq(ac,"fo",Fa.a.nj(this.sGb)));this.hlh&&(ac=Pb.a.Kq(ac,"dr",Fa.a.nj(this.hlh)));ac=Pb.a.Kq(ac,"fu",Fa.a.nj(this.cTa));ac=Pb.a.Kq(ac,"su",Fa.a.nj(this.qUk));ac=Pb.a.Kq(ac,"fn",Fa.a.nj(this.mS));ac=Pb.a.Kq(ac,"n",Fa.a.nj((new Date).getTime().toString()));this.Eh&&this.Eh.FileDownloadUrl&&(ac=Pb.a.Kq(ac,"furl",Fa.a.nj(this.Eh.FileDownloadUrl)));
ac=ac+"&"+this.r8e;this.t9b&&this.t9b.length?ac=Pb.a.Kq(ac,"fnn",Fa.a.nj(this.t9b)):w.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");w.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.pe.addRequest(ac,1,"",Bb,!1,2,ea,Pa,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(tk,"SharePointSaveAsCaller",null,[999]);class am{constructor(ea){this.jMb=ea.appSettings.SaveAsToHostWebServiceBase;this.mS=ea.appSettings.FileName;this.Eza=
ea.rb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(ea,Pa,Bb,ac,Gc,ld){return new tk(this.jMb,this.mS,ea,Pa,Bb,ac,Gc,m.AFrameworkApplication.lm,this.Eza,ld)}}Object(f.a)(am,"SharePointUploadCallerFactory",null,[966]);var bf=e(1259);class Cj{constructor(ea,Pa,Bb,ac,Gc){this.jm=this.cHc=null;this.HNe=!1;this.v$e=this.cTa=null;this.lff=Pa;this.O6a=Bb;this.eL=ac;this.Fk=Gc;this.ga=ea}zGa(ea,Pa,Bb,ac,Gc,ld){this.HNe=!1;w.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.Sgb();this.cTa=ea;ld&&ld.SaveEntryPoint&&(this.v$e=ld.SaveEntryPoint);this.cHc=this.lff.create(ea,Pa,Bb,ac,Gc,ld);ld&&"true"===ld.SkipSaveToHost?this.ena():this.$im()}$im(){const ea=()=>{w.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.ena()};32!==this.ga.Zb(u.a.C1b,2,[()=>{w.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.ena()},ea])&&ea()}ena(){w.ULS.sendTraceTag(23881924,216,50,
"Send SharePointSaveAsHandler.ashx request.");this.cHc.execute(Object(P.a)(this,this.d$n,"onSaveToSharePointUploadFinished"),Object(P.a)(this,this.c$n,"onSaveToSharePointUploadFailed"))}d$n(ea){if(ea&&ea.data&&ea.data.responseData){var Pa;if(({Zv:Pa}=Xa.d(ea.data.responseData)).returnValue)if(Pa.StatusCode!==Vj.a.jB&&Pa.StatusCode!==Vj.a.sic)w.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",ea.data.status,Pa.StatusCode),Pa.StatusCode!==
Vj.a.Hxg&&this.nmi(ea.data.status)||(this.H1a(Pa.StatusCode.toString()),this.aep(Pa.StatusCode));else{w.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.Dxg();try{Pa.NewDocumentUrl?this.x0b(Pa.NewDocumentUrl):this.y0b()}catch(Bb){w.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Bb.toString())}}else w.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:tb.a.Hvd(ea.data.responseData)}),this.u3d()||(this.H1a("Failed to deserialize response"),
this.$sd())}else w.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.u3d()||(this.H1a("Unknown"),this.$sd())}c$n(ea){ea&&ea.data?this.nmi(ea.data.status)||(w.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.H1a(bf.a[ea.data.status]),this.$sd()):(w.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.u3d()||(this.H1a("Unknown"),this.$sd()))}u3d(){if(!this.HNe)return w.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.HNe=!0,
this.ena(),!0;w.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}nmi(ea){w.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",ea);return this.u3d()}y0b(){w.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ga.a.Zm(this.cTa,Ga.a.Fya(3),void 0,"UploadToSharePointManager.RedirectToFolder")}x0b(ea){let Pa=!1,Bb=!1;m.AFrameworkApplication.J&&(Pa=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),Bb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));
w.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",ea,Pa);if(Pa&&Bb){w.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const ac={};ac[Wd.a.Jxc]="1";ac[Wd.a.documentUrl]=ea;ac[Wd.a.reason]=Re.a.$zg;m.AFrameworkApplication.NL().execute(Gc=>{Gc.sendMessage(Ye.a.rQb,ac)})}else Ga.a.Zm(ea,Ga.a.Fya(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Sgb(){this.Fk&&1===this.Fk.state||(this.jm=
this.O6a(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.Md=5,this.jm.hv=!1,this.jm.nM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Xta(){this.jm&&(this.jm.close(),this.jm=null)}$sd(){this.Pq(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Yep(){this.Pq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}gep(){const ea=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Pq(CommonUIStrings.l_SaveAsFileTooLargeTitle,
ea,Xg.a.wSo)}Pq(ea,Pa,Bb=Xg.a.ASo){w.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",ea,Pa);this.Xta();1!==this.Fk.state&&this.eL().Gli(ea,Pa,Bb)}aep(ea){w.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",ea);switch(ea){case Vj.a.QHe:this.Yep();break;case Vj.a.Hxg:this.gep();break;default:this.$sd()}}Dxg(){"VersionHistory"===this.v$e&&this.ga.Vb(u.a.Qod,2)}H1a(ea){"VersionHistory"===this.v$e&&this.ga.Zb(u.a.qye,2,{["FailureReason"]:ea})}}Object(f.a)(Cj,
"UploadToSharePointManager",null,[965]);var Wh=e(554),zk=e(144);class Hl{constructor(){this.onb=this.g4e=this.W3e=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Ec(ea){this.Z=ea;this.W3e=Wh.a.xr(ea.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.g4e=Wh.a.xr(ea.Za("Common.IEventEmitter<Common.IMruResult>"));this.onb=Wh.a.xr(ea.Za("Common.App.SharedFilePicker.ISharedFilePicker"));zk.Task.WAA.call(null,this.W3e,this.g4e,this.onb).continueWith(()=>{this.AAo()})}AAo(){this.Z.register(am,
"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").fe(()=>new am(m.AFrameworkApplication.J)).ha();this.Z.register(Cj,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").fe(()=>new Cj(m.AFrameworkApplication.va,this.Z.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Oj.a).create(),()=>new Od,m.AFrameworkApplication.ta)).ha();this.Z.register(ll,
"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").fe(()=>new ll(this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Od,this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),m.AFrameworkApplication.ta)).ha();this.Z.register(Qk,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").fe(()=>new Qk(this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
new zc.a(()=>this.W3e.result),m.AFrameworkApplication.ta,()=>new km)).ha();this.Z.register(Ml,"Common.App.SaveToSharePoint.FileNameDialogFactory").fe(()=>new Ml(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Pb,this.Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Z.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new zc.a(()=>this.g4e.result),
this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.onb?this.onb.result:null)).ha();this.Z.register($l,"Common.App.SaveToSharePoint.SaveToSharePointActor").fe(()=>new $l(m.AFrameworkApplication.J,m.AFrameworkApplication.va,this.Z.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),
()=>m.AFrameworkApplication.ta.esl)).ha();m.AFrameworkApplication.J.$("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").mc()}static main(){U.a.instance.Rc(new Hl)}}Object(f.a)(Hl,"PackageManager",null,[0,1]);class Xf{}Object(f.a)(Xf,"StringDifference",null,[973]);class we{constructor(ea,Pa){this.charCode=ea;this.description=Pa}}Object(f.a)(we,"UBTableEntry",null,[]);class Rk{}new we(8,"C0 Controls 1");new we(9,"Horizontal tab (HT)");new we(10,
"Line feed (LF)");new we(12,"C0 Controls 2");new we(13,"Carriage return (CR)");new we(31,"C0 Controls 3");new we(32,"Space");new we(47,"ASCII Punctuation and Symbols 1");new we(57,"ASCII Digits");new we(64,"ASCII Punctuation and Symbols 2");new we(90,"Uppercase Latin Alphabet");new we(96,"ASCII Punctuation and Symbols 3");new we(122,"Lowercase Latin Alphabet");new we(127,"U+0000..U+007F Basic Latin");new we(159,"C1 Controls");new we(160,"NB Space");new we(191,"Latin-1 Punctuation and Symbols");new we(255,
"U+0080..U+00FF Latin-1 Supplement");new we(383,"U+0100..U+017F Latin Extended-A");new we(591,"U+0180..U+024F Latin Extended-B");new we(687,"U+0250..U+02AF IPA Extensions");new we(767,"U+02B0..U+02FF Spacing Modifier Letters");new we(879,"U+0300..U+036F Combining Diacritical Marks");new we(1023,"U+0370..U+03FF Greek and Coptic");new we(1279,"U+0400..U+04FF Cyrillic");new we(1327,"U+0500..U+052F Cyrillic Supplement");new we(1423,"U+0530..U+058F Armenian");new we(1535,"U+0590..U+05FF Hebrew");new we(1791,
"U+0600..U+06FF Arabic");new we(1871,"U+0700..U+074F Syriac");new we(1919,"U+0750..U+077F Arabic Supplement");new we(1983,"U+0780..U+07BF Thaana");new we(2047,"U+07C0..U+07FF NKo");new we(2111,"U+0800..U+083F Samaritan");new we(2143,"U+0840..U+085F Mandaic");new we(2303,"U+08A0..U+08FF Arabic Extended-A");new we(2431,"U+0900..U+097F Devanagari");new we(2559,"U+0980..U+09FF Bengali");new we(2687,"U+0A00..U+0A7F Gurmukhi");new we(2815,"U+0A80..U+0AFF Gujarati");new we(2943,"U+0B00..U+0B7F Oriya");new we(3071,
"U+0B80..U+0BFF Tamil");new we(3199,"U+0C00..U+0C7F Telugu");new we(3327,"U+0C80..U+0CFF Kannada");new we(3455,"U+0D00..U+0D7F Malayalam");new we(3583,"U+0D80..U+0DFF Sinhala");new we(3711,"U+0E00..U+0E7F Thai");new we(3839,"U+0E80..U+0EFF Lao");new we(4095,"U+0F00..U+0FFF Tibetan");new we(4255,"U+1000..U+109F Myanmar");new we(4351,"U+10A0..U+10FF Georgian");new we(4607,"U+1100..U+11FF Hangul Jamo");new we(4991,"U+1200..U+137F Ethiopic");new we(5023,"U+1380..U+139F Ethiopic Supplement");new we(5119,
"U+13A0..U+13FF Cherokee");new we(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new we(5791,"U+1680..U+169F Ogham");new we(5887,"U+16A0..U+16FF Runic");new we(5919,"U+1700..U+171F Tagalog");new we(5951,"U+1720..U+173F Hanunoo");new we(5983,"U+1740..U+175F Buhid");new we(6015,"U+1760..U+177F Tagbanwa");new we(6143,"U+1780..U+17FF Khmer");new we(6319,"U+1800..U+18AF Mongolian");new we(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new we(6479,"U+1900..U+194F Limbu");
new we(6527,"U+1950..U+197F Tai Le");new we(6623,"U+1980..U+19DF New Tai Lue");new we(6655,"U+19E0..U+19FF Khmer Symbols");new we(6687,"U+1A00..U+1A1F Buginese");new we(6831,"U+1A20..U+1AAF Tai Tham");new we(7039,"U+1B00..U+1B7F Balinese");new we(7103,"U+1B80..U+1BBF Sundanese");new we(7167,"U+1BC0..U+1BFF Batak");new we(7247,"U+1C00..U+1C4F Lepcha");new we(7295,"U+1C50..U+1C7F Ol Chiki");new we(7375,"U+1CC0..U+1CCF Sundanese Supplement");new we(7423,"U+1CD0..U+1CFF Vedic Extensions");new we(7551,
"U+1D00..U+1D7F Phonetic Extensions");new we(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new we(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new we(7935,"U+1E00..U+1EFF Latin Extended Additional");new we(8191,"U+1F00..U+1FFF Greek Extended");new we(8303,"U+2000..U+206F General Punctuation");new we(8351,"U+2070..U+209F Superscripts and Subscripts");new we(8399,"U+20A0..U+20CF Currency Symbols");new we(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new we(8527,
"U+2100..U+214F Letterlike Symbols");new we(8591,"U+2150..U+218F Number Forms");new we(8703,"U+2190..U+21FF Arrows");new we(8959,"U+2200..U+22FF Mathematical Operators");new we(9215,"U+2300..U+23FF Miscellaneous Technical");new we(9279,"U+2400..U+243F Control Pictures");new we(9311,"U+2440..U+245F Optical Character Recognition");new we(9471,"U+2460..U+24FF Enclosed Alphanumerics");new we(9599,"U+2500..U+257F Box Drawing");new we(9631,"U+2580..U+259F Block Elements");new we(9727,"U+25A0..U+25FF Geometric Shapes");
new we(9983,"U+2600..U+26FF Miscellaneous Symbols");new we(10175,"U+2700..U+27BF Dingbats");new we(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new we(10239,"U+27F0..U+27FF Supplemental Arrows-A");new we(10495,"U+2800..U+28FF Braille Patterns");new we(10623,"U+2900..U+297F Supplemental Arrows-B");new we(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new we(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new we(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");
new we(11359,"U+2C00..U+2C5F Glagolitic");new we(11391,"U+2C60..U+2C7F Latin Extended-C");new we(11519,"U+2C80..U+2CFF Coptic");new we(11567,"U+2D00..U+2D2F Georgian Supplement");new we(11647,"U+2D30..U+2D7F Tifinagh");new we(11743,"U+2D80..U+2DDF Ethiopic Extended");new we(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");new we(11903,"U+2E00..U+2E7F Supplemental Punctuation");new we(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new we(12255,"U+2F00..U+2FDF Kangxi Radicals");new we(12287,"U+2FF0..U+2FFF Ideographic Description Characters");
new we(12351,"U+3000..U+303F CJK Symbols and Punctuation");new we(12447,"U+3040..U+309F Hiragana");new we(12543,"U+30A0..U+30FF Katakana");new we(12591,"U+3100..U+312F Bopomofo");new we(12687,"U+3130..U+318F Hangul Compatibility Jamo");new we(12703,"U+3190..U+319F Kanbun");new we(12735,"U+31A0..U+31BF Bopomofo Extended");new we(12783,"U+31C0..U+31EF CJK Strokes");new we(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new we(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new we(13311,
"U+3300..U+33FF CJK Compatibility");new we(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new we(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new we(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new we(42127,"U+A000..U+A48F Yi Syllables");new we(42191,"U+A490..U+A4CF Yi Radicals");new we(42239,"U+A4D0..U+A4FF Lisu");new we(42559,"U+A500..U+A63F Vai");new we(42655,"U+A640..U+A69F Cyrillic Extended-B");new we(42751,"U+A6A0..U+A6FF Bamum");new we(42783,"U+A700..U+A71F Modifier Tone Letters");
new we(43007,"U+A720..U+A7FF Latin Extended-D");new we(43055,"U+A800..U+A82F Syloti Nagri");new we(43071,"U+A830..U+A83F Common Indic Number Forms");new we(43135,"U+A840..U+A87F Phags-pa");new we(43231,"U+A880..U+A8DF Saurashtra");new we(43263,"U+A8E0..U+A8FF Devanagari Extended");new we(43311,"U+A900..U+A92F Kayah Li");new we(43359,"U+A930..U+A95F Rejang");new we(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new we(43487,"U+A980..U+A9DF Javanese");new we(43615,"U+AA00..U+AA5F Cham");new we(43647,
"U+AA60..U+AA7F Myanmar Extended-A");new we(43743,"U+AA80..U+AADF Tai Viet");new we(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new we(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new we(44031,"U+ABC0..U+ABFF Meetei Mayek");new we(55215,"U+AC00..U+D7AF Hangul Syllables");new we(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");new we(56191,"U+D800..U+DB7F High Surrogates");new we(56319,"U+DB80..U+DBFF High Private Use Surrogates");new we(57343,"U+DC00..U+DFFF Low Surrogates");new we(63743,"U+E000..U+F8FF Private Use Area");
new we(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new we(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new we(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new we(65039,"U+FE00..U+FE0F Variation Selectors");new we(65055,"U+FE10..U+FE1F Vertical Forms");new we(65071,"U+FE20..U+FE2F Combining Half Marks");new we(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new we(65135,"U+FE50..U+FE6F Small Form Variants");new we(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new we(65519,
"U+FF00..U+FFEF Halfwidth and fullwidth forms");new we(65535,"U+FFF0..U+FFFF Specials");new we(65663,"U+10000..U+1007F Linear B Syllabary");new we(65791,"U+10080..U+100FF Linear B Ideograms");new we(65855,"U+10100..U+1013F Aegean Numbers");new we(65935,"U+10140..U+1018F Ancient Greek Numbers");new we(65999,"U+10190..U+101CF Ancient Symbols");new we(66047,"U+101D0..U+101FF Phaistos Disc");new we(66207,"U+10280..U+1029F Lycian");new we(66271,"U+102A0..U+102DF Carian");new we(66351,"U+10300..U+1032F Old Italic");
new we(66383,"U+10330..U+1034F Gothic");new we(66463,"U+10380..U+1039F Ugaritic");new we(66527,"U+103A0..U+103DF Old Persian");new we(66639,"U+10400..U+1044F Deseret");new we(66687,"U+10450..U+1047F Shavian");new we(66735,"U+10480..U+104AF Osmanya");new we(67647,"U+10800..U+1083F Cypriot Syllabary");new we(67679,"U+10840..U+1085F Imperial Aramaic");new we(67871,"U+10900..U+1091F Phoenician");new we(67903,"U+10920..U+1093F Lydian");new we(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new we(68095,
"U+109A0..U+109FF Meoritic Cursive");new we(68191,"U+10A00..U+10A5F Kharoshthi");new we(68223,"U+10A60..U+10A7F Old South Arabian");new we(68415,"U+10B00..U+10B3F Avestan");new we(68447,"U+10B40..U+10B5F Inscriptional Parthian");new we(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new we(68687,"U+10C00..U+10C4F Old Turkic");new we(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");new we(69759,"U+11000..U+1107F Brahmi");new we(69839,"U+11080..U+110CF Kaithi");new we(69887,"U+110D0..U+110FF Sora Sompeng");
new we(69967,"U+11100..U+1114F Chakma");new we(70111,"U+11180..U+111DF Sharada");new we(71375,"U+11680..U+116CF Takri");new we(74751,"U+12000..U+123FF Cuneiform");new we(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new we(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new we(92735,"U+16800..U+16A3F Bamum Supplement");new we(94111,"U+16F00..U+16F9F Miao");new we(110847,"U+1B000..U+1B0FF Kana Supplement");new we(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new we(119295,"U+1D100..U+1D1FF Musical Symbols");
new we(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new we(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new we(119679,"U+1D360..U+1D37F Counting Rod Numerals");new we(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new we(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new we(127023,"U+1F000..U+1F02F Mahjong Tiles");new we(127135,"U+1F030..U+1F09F Domino Tiles");new we(127231,"U+1F0A0..U+1F0FF Playing Cards");new we(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");
new we(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new we(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new we(128591,"U+1F600..U+1F64F Emoticons");new we(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new we(128895,"U+1F700..U+1F77F Alchemical Symbols");new we(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");new we(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new we(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");
new we(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new we(917631,"U+E0000..U+E007F Tags");new we(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new we(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new we(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Rk,"UnicodeBlocks",null,[858]);class ml{constructor(){this.Z=null}Ec(ea){this.Z=ea;this.Z.register(Xf,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();
this.Z.register(Rk,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve("Common.App.SensitiveLogging.IStringDifference");this.Z.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){U.a.instance.Rc(new ml)}}Object(f.a)(ml,"SensitiveLoggingPackage",null,[0,1]);var Nl;(function(ea){ea[ea.Qlq=0]="myFiles";ea[ea.recent=1]="recent";ea[ea.i4p=2]="currentFolder";ea[ea.$Aq=
3]="yourPhone"})(Nl||(Nl={}));Object(f.b)("SharedFilePickerLandingLocation",Nl);class kk{constructor(ea){this.yUb=this.bxc=null;this._initialized=!1;this.KWf=ea}u2c(ea){this._initialized||(ea.$w(Ye.a.SEj),ea.DG(Ye.a.SEj,Object(P.a)(this,this.$8n,"onReceivedPickerResponse")),this._initialized=!0)}P5c(ea){return this.yUb=new Promise((Pa,Bb)=>{const ac={};ac[Wd.a.Rio]=ea;this.bxc=(Gc,ld)=>{""===ld?(w.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Pa(Gc)):("Canceled"===ld?w.ULS.sendTraceTag(572548164,
306,50,ld):w.ULS.sendTraceTag(556901065,306,10,ld),Bb(ld))};this.KWf.execute(Gc=>{this.u2c(Gc);Gc.sendMessage(Ye.a.Hco,ac)})})}$8n(ea){this.bxc(ea.Values[Wd.a.IVo],void 0===ea.Values[Wd.a.hog]||null===ea.Values[Wd.a.hog]?"":ea.Values[Wd.a.hog])}s4f(){return m.AFrameworkApplication.J.$("UiHostCommonFilePicker")}$0d(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce=null){const tf={};tf[Wd.a.iVo]=ea;tf[Wd.a.titleText]=Pa;tf[Wd.a.kal]=Bb;tf[Wd.a.lal]=ac;tf[Wd.a.nal]=Gc;tf[Wd.a.R0l]=!0;tf[Wd.a.Pcm]=ld;tf[Wd.a.$io]=Gd;tf[Wd.a.Zio]=
Nl[ue];G.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(tf[Wd.a.ajo]="Dark");Ce&&(null!=Ce.rfc&&(tf[Wd.a.rfc]=Ce.rfc),null!=Ce.Yoc&&(tf[Wd.a.Yoc]=Ce.Yoc),Ce.Pee&&(tf[Wd.a.Pee]=Ce.Pee));return tf}}Object(f.a)(kk,"SharedFilePickerManager",null,[859]);class Sn{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}Ec(ea){this.Z=ea;ea.register(kk,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().fe(()=>
new kk(ea.Za("Postmessage.IHostPostmessenger")))}init(){m.AFrameworkApplication.J.lq(()=>{this.Wbb()})}Wbb(){this.Z.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){U.a.instance.Rc(new Sn)}}Object(f.a)(Sn,"SharedFilePickerPackage",null,[0,1]);class kg extends Sys.EventArgs{constructor(){super()}}Object(f.a)(kg,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class gb{}Object(f.a)(gb,"TypingSpeedMeterWindow",null,[]);class Fb{constructor(ea,Pa){new S.a;this.Hpe=
()=>{};this.oD=ea;this.Tk=Pa;this.Tk.mjf(this.Hpe)}dispose(){this.Tk.HJj(this.Hpe)}}Object(f.a)(Fb,"TypingSpeedMeter",null,[1001]);class Wb{constructor(ea){this.sSd=null;this.Xr=new E.a;this.oD=ea}initialize(ea,Pa,Bb,ac){this.sSd||(this.sSd=new Fb(this.oD,ea,Pa,Bb,ac),this.Xr.setResult(this.sSd));return this.sSd}}Object(f.a)(Wb,"TypingSpeedMeterProvider",null,[972]);class Cc{constructor(){this.Gef=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.J.$("TypingSpeedMeterIsEnabled")){const ea=
wa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Pa=Wh.a.xr(wa.a.instance.Za("Common.ICpuMeterProvider"));Pa.continueWith(()=>{const Bb=Pa.result.Xr.task;var ac=new Na.a(m.AFrameworkApplication.J.sc("TypingSpeedMeterWindowSamplingPercent",0)/100);ac=new Ka.a(Object(P.a)(ac,ac.P2b,"shouldBeInSample"));const Gc=ya.a.OI(12,1,ac),ld=m.AFrameworkApplication.J.sc("TypingSpeedMeterWindowTimeoutMs",5E3),Gd=m.AFrameworkApplication.J.sc("TypingSpeedMeterMaxKeystrokesPerWindow",
5);Bb.CWR(()=>this.Gef=ea.initialize(Bb.result,Gc,ld,Gd))})}}dispose(){this.Gef&&this.Gef.dispose()}Ec(ea){ea.register(Wb,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().fe(()=>new Wb(Ga.a.We))}static main(){U.a.instance.Rc(new Cc)}}Object(f.a)(Cc,"TypingSpeedMeterPackage",null,[0,1]);class id{constructor(){this.events=[];this.Fxg=!1}static k6f(ea){return ea.ctrlKey&&"Control"!==ea.key||ea.altKey&&"Alt"!==ea.key||!!id.IDn[ea.key]}static onl(ea,Pa){let Bb;
Bb=id.k6f(ea)?ea.key:" "===ea.key?"Space":"CharacterKey";return null!=Pa?(Pa.altPressed=(!!ea.altKey).toString(),Pa.ctrlPressed=(!!ea.ctrlKey).toString(),Pa.key=Bb,Pa.repeat=(!!ea.repeat).toString(),Pa.shiftPressed=(!!ea.shiftKey).toString(),Pa):{["altPressed"]:(!!ea.altKey).toString(),["ctrlPressed"]:(!!ea.ctrlKey).toString(),["key"]:Bb,["repeat"]:(!!ea.repeat).toString(),["shiftPressed"]:(!!ea.shiftKey).toString()}}static Q5i(ea){return window.performance&&window.performance.now&&ea.timeStamp<performance.now()}static Qqi(ea){return!!ea&&
id.Q5i(ea)&&id.k6f(ea)}static Rqi(ea){return!!ea&&id.Q5i(ea)&&!id.k6f(ea)}keyPressedEventHandlerStart(ea,Pa){id.Rqi(ea)&&this.H2j(ea,Pa)}keyPressedEventHandlerEnd(ea){id.Rqi(ea)&&this.m3j(ea)}keyDownEventHandlerStart(ea,Pa){id.Qqi(ea)&&this.H2j(ea,Pa)}keyDownEventHandlerEnd(ea){id.Qqi(ea)&&this.m3j(ea)}H2j(ea,Pa){ea={["metadata"]:id.onl(ea,Pa),["timeStamp"]:this.pDc(ea.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.pDc(performance.now()-ea.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};
this.events.push(ea);this.LDo()}m3j(ea){if(0!==this.events.length){var Pa=this.pDc(ea.timeStamp);for(let Bb=this.events.length-1;0<=Bb;--Bb){const ac=this.events[Bb];if(ac.timeStamp===Pa){ac.timeToHandlerFinishMs=this.pDc(performance.now()-ea.timeStamp);ac.eventDurationMs=this.pDc(ac.timeToHandlerFinishMs-ac.timeToHandlerStartMs);break}}}}pDc(ea){return Number(ea.toFixed(2))}LDo(){if(!this.Fxg){const ea=document.createEvent("CustomEvent");ea.initCustomEvent("aggregateeventtimingstart",!1,!1,null);
dispatchEvent(ea);requestAnimationFrame(()=>{this.Fxg=!1;const Pa=performance.now();this.events.forEach(ac=>{ac.timeToRequestAnimationFrameMs=this.pDc(Pa-ac.timeStamp)});var Bb=document.createEvent("CustomEvent");Bb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(Bb);this.events=[];Bb=document.createEvent("CustomEvent");Bb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(Bb)});this.Fxg=!0}}}id.IDn={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,
["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Ad{constructor(){this.rye=this.Qdb=this.u_a=this.auc=null;this.vwb=!1;this.myc=null;this.l4c=[];this.ywd=()=>{Ad.Vvn()&&null==this.Qdb?(this.u_a=null,this.Qdb=requestAnimationFrame(this.mgd)):null!=this.Qdb&&(cancelAnimationFrame(this.Qdb),this.Qdb=null)};this.mgd=ea=>{if(null!=this.u_a){const Pa=ea-this.u_a;if(null==this.auc||this.auc<Pa)this.auc=Pa;for(let Bb=
0;Bb<Ad.ranges.length;++Bb)if(Pa<Ad.ranges[Bb]){++this.l4c[Bb];break}}this.u_a=ea;this.Qdb=requestAnimationFrame(this.mgd)};this.iLj=()=>{if(null!=this.auc){var ea={};for(var Pa=0;Pa<Ad.ranges.length;++Pa)ea[Ad.ranges[Pa]]=this.l4c[Pa],this.l4c[Pa]=0;Pa=performance.now();ea={["intervalStart"]:this.myc,["intervalEnd"]:Pa,["maxFrameLengthMs"]:this.auc,["frameData"]:ea};var Bb=document.createEvent("CustomEvent");Bb.initCustomEvent("reportframetiming",!1,!1,ea);dispatchEvent(Bb);this.auc=null;this.myc=
Pa}}}static u3f(){return!!window.performance&&!!window.performance.now}start(ea){!this.vwb&&Ad.u3f()&&(this.X7o(),this.rye=setInterval(this.iLj,1E3*ea),this.myc=performance.now(),this.ywd(),document.addEventListener("visibilitychange",this.ywd),this.vwb=!0)}stop(){this.vwb&&(document.removeEventListener("visibilitychange",this.ywd),null!=this.rye&&(clearInterval(this.rye),this.rye=null),null!=this.Qdb&&(cancelAnimationFrame(this.Qdb),this.Qdb=null),this.iLj(),this.vwb=!1)}get Wcb(){return this.vwb}X7o(){this.l4c=
[];for(let ea=0;ea<Ad.ranges.length;++ea)this.l4c.push(0)}}Ad.Vvn=()=>"visible"===document.visibilityState;Ad.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class Cd{create(ea){return new Na.a(ea)}}Object(f.a)(Cd,"RandomSamplerFactory",null,[1795]);var qe=e(18),df=e(69);class Ef{constructor(ea,Pa,Bb,ac,Gc){ea.VUd(()=>{ac.Hod()});ea.yjf((ld,Gd)=>{ac.Fod(Gd.revisionId,Gd.oeb)});ea.YUd((ld,Gd)=>{ac.San(Gd.iOa,Gd.oeb,Gd.C6j)});ea.L7k(()=>{ac.sxg()});Pa.o8k((ld,Gd)=>{ac.Bsp(Gd.TKj,
Gd.nGe,Gd.actualValue)});Pa.V6k((ld,Gd)=>{ac.Asp(Gd.TKj,Gd.nGe,Gd.actualValue)});Gc.UUd(()=>{ac.awd()});Bb.CQ((ld,Gd)=>{6===Gd.type&&ac.Vyc(Gd.fC)})}}Object(f.a)(Ef,"EventForwarder",null,[]);class Sf{constructor(ea,Pa,Bb){this.cMk=ea;this.L_=Bb;this.Ddc=Pa}create(ea,Pa){return new Ef(this.cMk,this.Ddc,ea,Pa,this.L_)}}Object(f.a)(Sf,"EventForwarderFactory",null,[]);var Je=e(351);class Ug{}Ug.ozp="TypingToOutboundReplicationStart";Ug.qdo="OutboundReplicationStartToOutboundReplicationEnd";Ug.mOj="RtcNotificationToInboundReplicationEnd";
Ug.z$j="TypingToInboundReplicationEnd";Object(f.a)(Ug,"PerfTrackerPhases",null,[]);class Kf{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce=null){this.fzh=!1;this.Q4e=5;this.sAh=50;this.v3e=20;this.f2e=this.e3e=this.rHa=null;this.pIc=this.eIc=0;this.Lbf=this.Ucf=!1;this.sRd=Array(7);this.FFc=null;this.Wph=!1;this.XPe=null;this.gpa={};this.QGd=ea;this.K4a=Pa;this.AKk=Bb;this.Wrh=ac.create(Ug.mOj,Gc,ld,20,!1);this.tSd=ac.create(Ug.z$j,Gd,ue,20,!0);if(this.za=m.AFrameworkApplication.J)this.fzh=this.za.$("LogSteppedInboundFrameIsEnabled"),
this.v3e=this.za.sc("InboundFrameMaxNumberOfLongRunningTasks",20),this.sAh=this.za.sc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.Q4e=this.za.sc("InboundFrameNumberOfLastShortTasks",5);this.TEb=Ce}get Ovl(){null==this.XPe&&(this.XPe=!!this.za&&this.za.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.XPe}initialize(ea){this.rHa=ea}$Lo(ea,Pa,Bb=null){this.m7h();w.ULS.shipAssertTag(8229761,324,0<ea.length);let ac=!1;for(const ld of ea){const Gd=ld.toString();if(Gd in
this.gpa){var Gc=this.gpa[Gd];if(!Gc.yzc){Gc.XRj(ea,Pa,Bb);if(ac)this.Efj(ld.toString(),Gc,null,null,this.sRd,null);else{const ue=this.Qam(),Ce=this.Qlm(this.FFc);ac=!0;this.Efj(ld.toString(),Gc,ue,this.f2e,this.sRd,Ce)}delete this.gpa[Gd]}}else Gc=this.QGd.create(this.Wrh,this.tSd),Gc.XRj(ea,Pa),this.gpa[Gd]=Gc}this.Lbf=!1}Vyc(ea){w.ULS.shipAssertTag(8257930,304,ea.t9i,"Expected data not sent on the wire");if(ea.t9i){if(ea.Wye in this.gpa){var Pa=this.gpa[ea.Wye];Pa.ize||(Pa.Vyc(ea.revisionId,ea.Qvj,
ea.$Yj,ea.oeb),delete this.gpa[ea.Wye])}else Pa=this.QGd.create(this.Wrh,this.tSd),Pa.Vyc(ea.revisionId,ea.Qvj,ea.$Yj,ea.oeb),this.gpa[ea.Wye]=Pa;this.m7h()}}Gcn(){this.Ucf||(this.e3e=Array(this.v3e),this.f2e=Array(this.Q4e),this.pIc=this.eIc=0,this.sRd=[0,0,0,0,0,0,0,0],this.FFc=Array(3),this.FFc[1]=[0,0],this.FFc[2]=[0,0],this.Ucf=!0)}dbp(ea){return!ea.TP&&ea.TN===ja.a.PKj&&(ea=Je.a(this.gpa))&&ea[0]?!0:!1}F3n(ea){this.Ucf=!1;const Pa=Je.a(this.gpa);Pa&&Pa[0]&&(ea.TRT>=this.sAh&&this.eIc<this.v3e?
this.e3e[this.eIc++]=ea:(this.f2e[this.pIc]=ea,this.pIc=this.pIc<this.Q4e-1?this.pIc+1:0),this.QNn(ea),this.eOn(ea))}E3n(){this.Gcn();this.Lbf=!0}QNn(ea){this.sRd[ea.TP]++}eOn(ea){if(ea&&ea.UI){const Pa=this.FFc[ea.UI];Pa[0]+=1;Pa[1]+=ea.TRT}}Qlm(ea){const Pa={};ea&&(ea[1]&&(Pa.Typing=ea[1]),ea[2]&&(Pa.Clicking=ea[2]));return Pa}Qam(){return this.eIc?this.e3e.slice(0,this.eIc-1):null}m7h(){var ea=Je.a(this.gpa);if(ea&&(this.Wph||this.wOn(ea),ea.length>this.AKk))for(const Pa of ea){ea=this.gpa[Pa];
const Bb=ea.createdTime,ac=this.K4a();6E4<ac-Bb&&(F.b(8438528,304,50,"{0}",{["Not Received"]:ea.yzc?"RtcNotification":"ServerRevision",["Duration"]:ac-Bb}),ea.yzc||F.b(42075798,304,15,"{0}",{["RevisionId"]:Pa,["Duration"]:ac-Bb}),delete this.gpa[Pa])}}wOn(ea){if(this.Ovl&&this.TEb)for(const Pa of ea)if(ea=this.gpa[Pa],ea.ize&&!ea.yzc&&(ea=ea.createdTime,2E3<this.K4a()-ea)){let Bb=null;qe.StaticActiveAppFrame.Aa()&&qe.StaticActiveAppFrame.Aa().tb&&qe.StaticActiveAppFrame.Aa().tb.rd&&(Bb=qe.StaticActiveAppFrame.Aa().tb.rd.Jg);
this.TEb.execute(ac=>{ac.flush(Bb,1)});this.Wph=!0}}Efj(ea,Pa,Bb,ac,Gc,ld){this.fzh&&(Pa=Pa.Dlm())&&(Pa.RevisionId=ea,Pa.LRTWR=Bb,Pa.LSTWR=ac,Pa.TSD=Gc,Pa.UIWR=ld,this.rHa&&this.rHa.track(Pa))}}Object(f.a)(Kf,"InboundMonitor",null,[1007]);class fl{constructor(ea,Pa,Bb,ac){this.TG=Pa;this.QGd=Bb;this.KWk=ac}create(ea,Pa,Bb,ac,Gc=null){return new Kf(this.QGd,this.TG,50,this.KWk,ea,Pa,Bb,ac,Gc)}}Object(f.a)(fl,"InboundMonitorFactory",null,[980]);var Ji=e(382);class lk{}lk.mJe="UserCount";lk.qQo="RevisionChainLength";
Object(f.a)(lk,"PerfTrackerPivotNames",null,[]);class Sj{}Object(f.a)(Sj,"PerfTrackingContext",null,[]);const dk=ea=>5>=ea?"5AndFewer":10>=ea?"6To10":15>=ea?"11To15":20>=ea?"15To20":25>=ea?"21To25":30>=ea?"26To30":"31AndAbove";class Zd{}Object(f.a)(Zd,"SteppedInboundFrame",null,[]);class qg{constructor(ea,Pa,Bb,ac,Gc){this.rmb=this.SGd=null;this.Rrh=500;this.RGd=this.Mza=this.aHb=this.f$b=this.ozd=-1;this.uWg=null;this.wJh=this.qIh=!1;this.VHh=null;this.LDh=this.hUa=0;this.ubc=ea;this.createdTime=
Pa();this.RPd=!1;this.c6e=0;this.SIb=Bb;this.vFk=ac;this.tSd=Gc;m.AFrameworkApplication.J&&(this.Rrh=m.AFrameworkApplication.J.sc("InboundFrameSamplingMinimalTotalTimeMs",500))}get ize(){return this.qIh}get yzc(){return this.wJh}get vNj(){return this.VHh}get oeb(){return this.hUa}get pdo(){return this.LDh}get IQb(){return this.SIb()}Vyc(ea,Pa,Bb,ac){this.ize||(this.RPd=Bb,this.c6e=Pa,this.ozd=X.a.DP(Ga.a.We(),2),this.uWg=(new Date).toISOString(),this.rmb=ea,this.LDh=ac,this.qIh=!0,this.yzc?this.ipi():
(this.I2j(),pa.a.instance.MA(ea.toString()+"Start"),Ji.a.instance.Jme(2)))}XRj(ea,Pa,Bb=null){this.yzc||(this.hUa=Pa,this.wJh=!0,this.VHh=ea,this.RGd=X.a.DP(Ga.a.We(),2),this.ize&&(pa.a.instance.MA(this.rmb.toString()+"End"),Bb&&(this.f$b=Bb.Oxg,this.aHb=Bb.lxa,this.Mza=Bb.uxg),Ji.a.instance.gZd(),this.ipi()))}Dlm(){if(!(0<this.ozd&&0<this.f$b&&0<this.aHb&&0<this.Mza&&0<this.RGd))return null;const ea=new Zd;ea.TT=X.a.DP(this.RGd-this.ozd,2);if(ea.TT<this.Rrh)return null;ea.ST=this.uWg;ea.UC=this.IQb;
ea.RS=X.a.DP(this.f$b-this.ozd,2);ea.SR=X.a.DP(this.aHb-this.f$b,2);ea.RRS=X.a.DP(this.Mza-this.aHb,2);ea.RP=X.a.DP(this.RGd-this.Mza,2);ea.ResponseLanded=X.a.DP(this.aHb,2);0<ea.RS?(pa.a.instance.q2("RTCToRequestSent",this.rmb.toString()+"Start","RequestInvoked"+this.f$b),pa.a.instance.q2("RequestSentToResponseReceived","RequestInvoked"+this.f$b,"RequestCompleted"+this.aHb),pa.a.instance.q2("ResponseReceivedToReplicationStart","RequestCompleted"+this.aHb,"ReplicationStart"+this.Mza)):pa.a.instance.q2("RTCToReplicationStart",
this.rmb.toString()+"Start","ReplicationStart"+this.Mza);pa.a.instance.q2("Replication","ReplicationStart"+this.Mza,this.rmb.toString()+"End");return ea}I2j(){this.SGd=this.ubc.create();this.SGd.start(Ug.mOj,Ug.z$j)}ipi(){this.SGd||this.I2j();const ea=this.SGd.end(this.RPd,this.hPl());this.vFk.pye(ea);this.tSd.pye(ea+this.c6e)}hPl(){const ea={};ea[lk.mJe]=dk(this.IQb);var Pa=this.vNj.length;ea[lk.qQo]=9>=Pa?Pa.toString():"10AndAbove";return Object.assign(new Sj,{P:ea,FC:this.oeb,CFC:this.pdo+this.oeb,
ID:this.rmb.toString(),CD:this.c6e,UC:this.IQb,RCL:this.vNj.length})}}Object(f.a)(qg,"InboundOperation",null,[1006]);class sh{constructor(ea,Pa,Bb){this.USa=ea;this.K4a=Pa;this.SIb=Bb}create(ea,Pa){return new qg(this.USa,this.K4a,this.SIb,ea,Pa)}}Object(f.a)(sh,"InboundOperationFactory",null,[979]);class qi{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce){this.SPd=!0;this.LEh=this.GMd=null;this.sE=tf=>{this.wi.sE(6,tf)};this.b6e=ea;this.AAk=Pa;this.ZOk=Bb;this.wi=ac;this.Hef=Gc.create("TypingToOutboundReplicationStart",
ld,Gd,20,!1);this.j9e=Gc.create("OutboundReplicationStartToOutboundReplicationEnd",ue,Ce,20,!1)}get Sng(){return this.GMd}get qte(){return this.LEh}awd(){!this.Sng&&this.SPd&&(this.SPd=this.AAk())&&(this.GMd=this.b6e.create(this.sE,this.ZOk(),this.Hef,this.j9e),this.Sng.awd())}Hod(){this.SPd=!0;this.LEh=this.Sng;this.qte&&(this.GMd=null,this.qte.Hod())}sxg(){this.GMd=null}Fod(ea,Pa){this.qte&&this.qte.Fod(ea,Pa)}}Object(f.a)(qi,"OutboundMonitor",null,[]);class Dm{constructor(ea,Pa){this.b6e=ea;this.WNk=
Pa}create(ea,Pa,Bb,ac,Gc,ld,Gd){return new qi(this.b6e,ea,Pa,Bb,this.WNk,ac,Gc,ld,Gd)}}Object(f.a)(Dm,"OutboundMonitorFactory",null,[]);var Ci=e(49);class nj{constructor(ea){this.Hmb=ea}get svo(){return this.Hmb}Bb(ea){return!!this.Hmb&&ea in this.Hmb}get t9i(){return this.Bb(nj.b4d)&&this.Bb(nj.n1b)&&this.Bb(nj.aGg)}get revisionId(){if(this.Bb(nj.n1b))return Ci.a.Of(this.Hmb[nj.n1b]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get Wye(){if(this.Bb(nj.n1b))return this.Hmb[nj.n1b];
throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get Qvj(){if(this.Bb(nj.b4d))return Number.parseInvariant(this.Hmb[nj.b4d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get $Yj(){if(this.Bb(nj.n1b))return Boolean.parse(this.Hmb[nj.aGg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get oeb(){if(this.Bb(nj.xgg))return Number.parseInvariant(this.Hmb[nj.xgg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");
}static mMl(ea){return new nj(ea)}static qMl(ea,Pa,Bb,ac){const Gc={};Gc[nj.b4d]=ea.toString();Gc[nj.n1b]=Pa.toString();Gc[nj.aGg]=Bb.toString();Gc[nj.xgg]=ac.toString();return new nj(Gc)}}nj.n1b="RevisionID";nj.b4d="Duration";nj.aGg="ShouldSample";nj.xgg="NumSequentialFailures";Object(f.a)(nj,"ReplicationNotificationMessage",null,[1004]);class mk{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.Su=this.Ci=0;this.kJb=this.YTc=null;this.gNe=[];this.HFh=null;this.jEd={};this.hUa=0;this.ubc=ea;this.ESk=Pa;this.K4a=
Bb;this.SIb=ac;this.rKh=Gc;this.rmb=null;this.jEd.TypingStartStage=null;this.jEd.ReplicationStartStage="TypingStartStage";this.jEd.ReplicationEndStage="ReplicationStartStage";this.ePh=1<this.IQb;this.Hef=ld;this.j9e=Gd}get IQb(){return this.SIb()}awd(){this.orf("TypingStartStage")&&(this.Xtg("TypingStartStage"),w.ULS.shipAssertTag(8257931,324,!this.kJb&&!this.Su,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.Ci=this.K4a(),this.YTc=this.ubc.create(),this.x2j(this.YTc,Ug.ozp))}Hod(){if(this.orf("ReplicationStartStage")){this.Xtg("ReplicationStartStage");
w.ULS.shipAssertTag(8257932,324,!!this.YTc,"TypingStart not called");if(this.YTc){const ea=this.$oi(this.YTc,this.rmb);this.Hef.pye(ea)}this.kJb=this.ubc.create();this.x2j(this.kJb,Ug.qdo)}}Fod(ea,Pa){this.orf("ReplicationEndStage")&&(this.Xtg("ReplicationEndStage"),this.Su=this.K4a(),this.hUa=Pa,w.ULS.shipAssertTag(8257933,324,!!this.kJb,"ReplicationStart not called"),this.kJb&&(w.ULS.shipAssertTag(8193425,324,!!this.kJb,"ReplicationStart not called"),Pa=this.$oi(this.kJb,ea),this.j9e.pye(Pa)),w.ULS.shipAssertTag(8257934,
324,!!this.Ci,"StartTime not set. No message sent to other editors."),this.Ci&&(ea=nj.qMl(this.Su-this.Ci,ea,this.rKh,this.hUa),this.ESk(ea.svo)))}orf(ea){if(this.jEd[ea]===this.HFh)return!0;w.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.G_k()});return!1}G_k(){const ea=new Sys.StringBuilder;ea.append("Actual Phase:");for(let Pa=0;Pa<this.gNe.length;Pa++)ea.append(" "+this.gNe[Pa]);return ea.toString()}Xtg(ea){this.gNe.push(ea);this.HFh=ea}x2j(ea,Pa){this.ePh&&ea.start(Pa)}$oi(ea,
Pa){if(!this.ePh)return-1;const Bb={};Bb[lk.mJe]=dk(this.IQb);Pa=Object.assign(new Sj,{P:Bb,FC:this.hUa,CFC:0,ID:Pa?Pa.toString():"",CD:0,UC:this.IQb,RCL:0});return ea.end(this.rKh,Pa)}}Object(f.a)(mk,"OutboundOperation",null,[1003]);class Jc{constructor(ea,Pa,Bb){this.ubc=ea;this.K4a=Pa;this.SIb=Bb}create(ea,Pa,Bb,ac){return new mk(this.ubc,ea,this.K4a,this.SIb,Pa,Bb,ac)}}Object(f.a)(Jc,"OutboundOperationFactory",null,[977]);class Ha{constructor(ea,Pa){this.whh=this._name=this.O7=null;this.qe=ea;
this.rHa=Pa}start(ea,Pa=null){this.O7=this.qe.rg("UserAction",ea);this._name=ea;this.whh=Pa}end(ea,Pa){let Bb=-1;ea&&(Bb=this.O7.qj,Pa.D=Bb,Pa.CN=this.whh,Pa.CD+=Bb,this.rHa.track(Pa,this._name));return Bb}}Object(f.a)(Ha,"PerfTracker",null,[1005]);class eb{constructor(ea,Pa){this.qe=ea;this.rHa=Pa}create(){return new Ha(this.qe,this.rHa)}}Object(f.a)(eb,"PerfTrackerFactory",null,[978]);class rc{constructor(ea,Pa,Bb){this.PPc=null;this.VNk=ea;this.Vrh=Pa;this.hGh=Bb}init(ea,Pa,Bb,ac,Gc,ld,Gd){Pa=
this.hGh.create(Pa/100);Bb=this.hGh.create(Bb/100);this.PPc=this.VNk.create(Object(P.a)(Pa,Pa.P2b,"shouldBeInSample"),Object(P.a)(Bb,Bb.P2b,"shouldBeInSample"),ea,ac,Gc,ld,Gd)}awd(){this.PPc.awd()}Hod(){this.PPc.Hod()}sxg(){this.PPc.sxg()}Fod(ea,Pa){this.PPc.Fod(ea,Pa)}San(ea,Pa,Bb=null){this.Vrh.$Lo(ea,Pa,Bb)}Vyc(ea){ea=nj.mMl(ea);this.Vrh.Vyc(ea);pa.a.instance.MA(ea.revisionId+"Start")}Bsp(ea,Pa,Bb){F.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.V0d(ea,Pa,Bb))}Asp(ea,
Pa,Bb){F.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.V0d(ea,Pa,Bb))}V0d(ea,Pa,Bb){const ac={};ac.PhaseName=ea;ac.ThresholdValue=Pa;ac.ActualValue=Bb;return ac}}Object(f.a)(rc,"ReplicationTelemetryManager",null,[]);var Uc=e(969);class bd extends Uc.a{constructor(ea,Pa){super(ea,Pa);this.ul=this.SQd=0}BFa(ea){this.SQd+=ea;this.ul++}getValue(){return this.ul?this.SQd/this.ul:0}L1a(){this.ul=this.SQd=0}}Object(f.a)(bd,"AverageMetric",Uc.a,[]);class Hd extends Uc.a{constructor(ea,
Pa){super(ea,Pa);this.Zaa=0}BFa(ea){ea>this.Zaa&&(this.Zaa=ea)}getValue(){return this.Zaa}L1a(){this.Zaa=0}}Object(f.a)(Hd,"MaxMetric",Uc.a,[]);var Pe=e(1928);class Le extends Uc.a{constructor(ea,Pa,Bb=100){super(ea,Pa);this.gKd=this.Zac=this.qdc=0;this.FOd=Bb;this.b$e=new Pe.a(this.FOd)}BFa(ea){if(this.Zac===this.FOd){const Pa=this.b$e.dequeue();this.qdc-=Pa;this.Zac--}this.b$e.enqueue(ea);this.qdc+=ea;this.Zac++;ea=this.qdc/this.Zac;ea>this.gKd&&this.Zac===this.FOd&&(this.gKd=ea)}getValue(){return this.gKd}L1a(){this.gKd=
0;this.b$e=new Pe.a(this.FOd);this.Zac=this.qdc=0}}Object(f.a)(Le,"MaxRollingAverageMetric",Uc.a,[]);class De extends Uc.a{constructor(ea,Pa){super(ea,Pa);this.ul=0}BFa(){this.ul++}getValue(){return this.ul}L1a(){this.ul=0}}Object(f.a)(De,"CounterMetric",Uc.a,[]);class lf{constructor(ea,Pa){var Bb;this.gMb=Pa;this.tOe=new bd(ea+"-AverageValue","Milliseconds");this.t3e=new Hd(ea+"-MaxValue","Milliseconds");this.y3e=new Le(ea+"-MaxRollingAverageValue","Milliseconds");this.FRe=new De(ea+"-NumberOfEvents",
"Count");this.iAa=new Ua.a(ea+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.JL("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.J.JL("CoAuthLatencySlowThresholdPercentile",95),this.gMb);Pa=null===(Bb=m.AFrameworkApplication.J)||void 0===Bb?void 0:Bb.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreaseWebLatencyVetoTime",!1);m.AFrameworkApplication.ud("12b7f130;h128e180");this.d7e=Pa?new Ua.a(ea+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.JL("CoAuthLatencyBrokenSlowTargetValueForWord",
1E4),m.AFrameworkApplication.J.JL("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.gMb):new Ua.a(ea+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.JL("CoAuthLatencyBrokenSlowTargetValue",5E3),m.AFrameworkApplication.J.JL("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.gMb)}W5(ea){this.tOe.BFa(ea);this.t3e.BFa(ea);this.y3e.BFa(ea);this.FRe.BFa(ea);this.iAa.BFa(ea);this.d7e.BFa(ea)}Uwe(){this.tOe.k1a();this.t3e.k1a();this.y3e.k1a();this.FRe.k1a();this.iAa.k1a();this.d7e.k1a();
this.tOe.L1a();this.t3e.L1a();this.y3e.L1a();this.FRe.L1a();this.iAa.L1a();this.d7e.L1a()}}Object(f.a)(lf,"ReplicationLatencyMetrics",null,[]);class Af{constructor(){this.s2e=new dc.a}yFj(ea,Pa,Bb){if(!(0>Pa)){if(!({value:ac}=this.s2e.Nc(ea,ac)).returnValue){var ac=new lf(ea,Bb);this.s2e.W(ea,ac)}ac.W5(Pa)}}Uwe(){for(const ea of this.s2e.values)ea.Uwe()}}Object(f.a)(Af,"ReplicationTelemetryMetricsManager",null,[976]);class mg{yFj(){}Uwe(){}}Object(f.a)(mg,"ReplicationTelemetryMetricsManagerStub",
null,[976]);class hi{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.P7a=this.dSd=0;this.aLk=ea;this.h7e=Bb;this.hNh=ac;this.jeh=Gc;this.Ddc=Pa;this.bLk=ld;this.gMb=Gd}pye(ea){this.aLk.yFj(this.h7e,ea,this.gMb);ea>this.hNh&&this.Ddc.gsp(this.h7e,this.hNh,ea);this.dSd+=ea;this.P7a++;this.dSd/this.P7a>this.jeh&&this.P7a>this.bLk&&this.Ddc.hil(this.h7e,this.jeh,this.dSd/this.P7a)}}Object(f.a)(hi,"TimeSpanVerifier",null,[1002]);class Uh{constructor(ea,Pa){this.jRk=ea;this.Ddc=Pa}create(ea,Pa,Bb,ac,Gc){return new hi(this.jRk,
this.Ddc,ea,Pa,Bb,ac,Gc)}}Object(f.a)(Uh,"TimeSpanVerifierFactory",null,[975]);class nk extends Sys.EventArgs{constructor(ea,Pa,Bb){super();this.TKj=ea;this.nGe=Pa;this.actualValue=Bb}}Object(f.a)(nk,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class fi{constructor(){this.sa=new S.a}gsp(ea,Pa,Bb){this.sa.raiseEvent("TSVTE",new nk(ea,Pa,Bb))}hil(ea,Pa,Bb){this.sa.raiseEvent("TSVATE",new nk(ea,Pa,Bb))}o8k(ea){this.sa.addHandler("TSVTE",ea)}V6k(ea){this.sa.addHandler("TSVATE",ea)}}Object(f.a)(fi,"TimeSpanVerifierNotifier",
null,[974]);var kc=e(1276);class Ze{constructor(){this.Z=this.za=null}get name(){return"Box4.ReplicationTelemetry"}Ec(ea){this.za=ea.resolve("Common.IAppSettingsManager");this.Z=ea;if(this.za.$("Box4ReplicationTelemetryIsEnabled")){ea.ja("ReplicationTelemetry.IPerfTrackerFactory",()=>new eb(qe.StaticActiveAppFrame.Aa().Kt,ya.a.OI(20,1,new ia.a))).ha();ea.ja("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new fi).ha();this.za.$("Box4ReplicationTelemetryMetricsIsEnabled")?ea.ja("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new Af).ha():ea.ja("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new mg).ha();ea.ja("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Uh(ea.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();ea.ja("ReplicationTelemetry.OutboundOperationFactory",()=>new Jc(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ze.xCi)).ha();ea.ja("ReplicationTelemetry.OutboundMonitorFactory",
()=>new Dm(ea.resolve("ReplicationTelemetry.OutboundOperationFactory"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();ea.ja("ReplicationTelemetry.InboundOperationFactory",()=>new sh(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ze.xCi)).ha();var Pa=new fl(ea.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),ea.resolve("ReplicationTelemetry.InboundOperationFactory"),ea.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),
Bb=this.za.$("ComponentStateLoggingPackageIsEnabled")?this.Z.Za("Common.IComponentStateLogManager"):null;ea.ja("ReplicationTelemetry.IInboundMonitor",()=>Pa.create(this.za.sc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.za.sc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.za.sc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.za.sc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),Bb)).ha();ea.ja("Common.IRandomSamplerFactory",()=>new Cd).ha();
ea.ja("ReplicationTelemetry.ReplicationTelemetryManager",()=>new rc(ea.resolve("ReplicationTelemetry.OutboundMonitorFactory"),ea.resolve("ReplicationTelemetry.IInboundMonitor"),ea.resolve("Common.IRandomSamplerFactory"))).ha();ea.ja("ReplicationTelemetry.EventForwarderFactory",()=>new Sf(kc.a.instance,ea.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),ea.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.za.$("Box4ReplicationTelemetryIsEnabled")){var ea=this.za.sc("Box4ReplicationTelemetrySamplePercent",
0),Pa=this.za.sc("Box4ReplicationTelemetryPhaseSamplePercent",0),Bb=this.za.sc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),ac=this.za.sc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Gc=this.za.sc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),ld=this.za.sc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Gd=this;this.Z.Za("Box4.Presence.IRtcProxyProvider").execute(Ce=>{Ce.jF().continueWith(()=>{const tf=
Ce.jF().result,Zg=Gd.Z.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Zg.init(tf,ea,Pa,Bb,ac,Gc,ld);Gd.Z.resolve("ReplicationTelemetry.EventForwarderFactory").create(tf,Zg);if(Gd.za.$("LogSteppedInboundFrameIsEnabled")){const Xi=Wh.a.xr(Gd.Z.Za("Common.ICpuMeterProvider"));Xi.continueWith(()=>{const ph=Gd.Z.resolve("ReplicationTelemetry.IInboundMonitor");var Dh=new Ka.a(()=>!0);Dh=ya.a.OI(19,1,Dh);ph.initialize(Dh);const qk=Xi.result.Xr.task;qk.continueWith(()=>{qk.result.jUd(0,()=>ph.Lbf,
Wn=>{ph.F3n(Wn)});qk.result.jUd(1,Wn=>ph.dbp(Wn),()=>{ph.E3n()})})})}w.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var ue=this;m.AFrameworkApplication.IG(()=>{ue.Z.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Uwe()})}}dispose(){}static xCi(){const ea=df.a.Gd();return ea?ea.Sni:0}}Object(f.a)(Ze,"ReplicationTelemetryPackage",null,[0,1]);var Fg=e(1258),ii=e(11),te=e(124),pe=e(3),Ee=e(85),rd=e(65),wj=e(39),ui=e(23),Ch=e(175),$g=e(7),fa=e(2121);class Ya{static get Fh(){return a.a.iA(Ya.pp,
Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Ya.pp="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(f.a)(Ya,"InsertSymbolsDialogHtml",null,[]);class Hb extends fa.a{constructor(ea,Pa,Bb){super();this.eac=this.eVa=
this.Gnb=null;this.hZe=0;this.nin=ac=>{1===ac?(this.jjg("symbol_d_"+Hb.qNc),this.oc.zP(this.ZO,!0),this.oc.Cv().Al.eC(this.YK),this.YK.focus()):this.hide()};this.y4j=ac=>{if(ac.target!==this.eac){const Gc=this.oc.Cv();Gc&&Gc.Al&&(Gc.Al.eC(ac.target),this.eac=ac.target)}this.q$n(ac.target.id)};this.kop=ac=>{const Gc=ac.Ff;if("a"!==Gc.tagName.toLowerCase())return!1;ac.eventName===ca.a.dF&&this.jjg(Gc.id);this.oc.zP(this.ZO,!0);this.oc.Cv().Al.eC(Gc);Gc.focus();return!0};this.mop=ac=>{var Gc=ac.Ff;if("a"!==
Gc.tagName.toLowerCase())return!1;const ld=parseInt(Gc.id.substr(Gc.id.lastIndexOf("_")+1));if(ac.Yb.ctrlKey||ac.Yb.altKey||ac.Yb.keyCode>=nh.a.i6b&&ac.Yb.keyCode<=nh.a.j6b)return!1;if(ac.eventName===ca.a.Bj){ac=ac.Yb.keyCode;let Gd=-1;ac===Sys.UI.Key.enter?(this.jjg(Gc.id),this.oc.zP(this.ZO,!0),this.oc.Cv().Al.eC(Gc),Gc.focus()):ac===Sys.UI.Key.up?Gd=ld-15:ac===Sys.UI.Key.down?Gd=ld+15:ac===Sys.UI.Key.left?Gd=m.AFrameworkApplication.isRtl?ld+1:ld-1:ac===Sys.UI.Key.right&&(Gd=m.AFrameworkApplication.isRtl?
ld-1:ld+1);0<=Gd&&(Gc=this.FRf("symbol_d_"+Gd))&&Gc.focus()}return!0};this.ga=ea;this.oc=Pa;this.Hnb=Bb;this.Ue(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ue(0,CommonUIStrings.l_DialogClose);this.rfa=!1;this.Fh=Ya.Fh;this.$g="InsertSymbolsDialog"}dispose(){0<Hb.cef&&w.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.hZe,Hb.cef);Hb.Yjh++;w.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Hb.Yjh);
this.ga=this.Hnb=null;super.dispose()}v2a(){this.ti(Box4Intl.Box4Strings.L_SymbolSingle,this.nin,null);this.hZe=0;Hb.dkh++;w.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Hb.dkh);const ea=this.FRf("symbol_d_"+Hb.qNc);ea&&ea.focus()}hide(){var ea=document.getElementById("symbolsContainer");if(ea&&(ea=ea.getElementsByTagName("a")))for(let Pa=0;Pa<ea.length;Pa++)W.a.removeHandler(ea[Pa],ca.a.focus,this.y4j);super.hide()}get Wwb(){return Hb.uNc}set Wwb(ea){Hb.uNc=ea}get Rwb(){return Hb.jNc}set Rwb(ea){Hb.jNc=
ea}Cda(){super.Cda();var ea=document.getElementById("symbolsContainer");if(ea&&(ea.innerHTML=this.Hnb.Uml(),ea=ea.getElementsByTagName("a")))for(let Pa=0;Pa<ea.length;Pa++)W.a.addHandler(ea[Pa],ca.a.focus,this.y4j)}cta(){const ea=document.getElementById("symbolsContainer");ea&&(this.Gnb||(this.Gnb=this.kop,this.Ws.Cb(ca.a.click,ea,this.Gnb),this.Ws.Cb(ca.a.dF,ea,this.Gnb)),this.eVa||(this.eVa=this.mop,this.Ce.Cb(ca.a.Bj,ea,this.eVa),this.Ce.Cb(ca.a.Jw,ea,this.eVa),this.Ce.Cb(ca.a.zi,ea,this.eVa)));
super.cta()}hrb(){const ea=document.getElementById("symbolsContainer");ea&&(this.Gnb&&(this.Ws.Gc(ca.a.click,ea,this.Gnb),this.Ws.Gc(ca.a.dF,ea,this.Gnb),this.Gnb=null),this.eVa&&(this.Ce.Gc(ca.a.Bj,ea,this.eVa),this.Ce.Gc(ca.a.Jw,ea,this.eVa),this.Ce.Gc(ca.a.zi,ea,this.eVa),this.eVa=null));super.hrb()}get LVf(){return!0}q$n(ea){this.JVj("symbol_d_"+Hb.qNc,!1);Hb.qNc=parseInt(ea.substr(ea.lastIndexOf("_")+1));this.JVj(ea,!0);if(ea=document.getElementById("SymbolNameValueLabel")){const Pa=this.Bbe(Hb.qNc);
ea.innerText=Pa.altText}}Bbe(ea){const Pa=this.Hnb.lFe.oKg.value,Bb=Je.a(Pa);return Pa[Bb[ea]]}jjg(ea){this.hZe++;Hb.cef++;ea=parseInt(ea.substr(ea.lastIndexOf("_")+1));const Pa=this.Bbe(ea),Bb={};Bb.SourceControlId="symbol_"+ea+"_"+Pa.jFe;this.ga.Zb(pe.a.jvb,2,Bb);w.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",ea)}FRf(ea){const Pa=document.getElementById("symbolsContainer");return Pa?Pa.querySelector("#"+ea):null}JVj(ea,Pa){if(ea=this.FRf(ea))Pa?(ea.setAttribute("selected",
"true"),ea.setAttribute("aria-selected","true"),ea.tabIndex=0):(ea.removeAttribute("selected"),ea.setAttribute("aria-selected","false"),ea.tabIndex=-1)}}Hb.qNc=0;Hb.uNc=null;Hb.jNc=null;Hb.dkh=0;Hb.Yjh=0;Hb.cef=0;Object(f.a)(Hb,"InsertSymbolsDialog",fa.a,[]);var Yb=e(1073);class qa{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.gTm=()=>this.Hnb.Knl();this.kDj=(ue,Ce,tf,Zg,Xi)=>{if(1===tf)return 32;ue=this.Hnb.Dxj(Xi);ue=String.format(this.Hnb.lop,ue.character);Xi[Fg.a.InnerHTML]=ue;Xi[Fg.a.On]=!1;return 32};
this.jZa=(ue,Ce,tf,Zg,Xi)=>{if(({ke:tf,selected:qk,jZa:Wn}=this.q0c(Ce,tf)).returnValue)return Wn;const ph=wj.a.Df(qk);let Dh=!0;var qk=8;var Wn=this.Zc.Vc(15);Wn.Eb(tf.Fd);Yb.a.ksd&&(Wn.Bh=ue);ph||(qk=this.ga.Sf(Ce,pe.a.Rta,2,!0,Zg,null),ue=32===qk,w.ULS.shipAssertTag(6407387,348,ue,"DeleteForReplace did not succeed. Response is {0}",qk),Dh=ue);Dh&&(ue=tf.ub.hh,Ce=wj.a.Df(ue),w.ULS.shipAssertTag(6407388,348,Ce,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",ue.contextId),
qk=8,Ce&&(qk=this.ga.Sf(ue,pe.a.jvb,2,!1,Zg,Xi),w.ULS.shipAssertTag(6407389,348,32===qk,"Insertion at IP context did not succeed. Response is {0}",qk),32===qk&&zf.FocusManager.instance().Rg(tf.lN)));Wn.dispose();return qk};this.kin=(ue,Ce,tf,Zg,Xi)=>{if(1===tf)return 32;if(wj.a.ncb(Ce))return 2;ue=this.Hnb.Dxj(Xi);Zg.Av=ue.index;Zg=this.td.Ag(Ce.node);tf=Zg.Ib(11);w.ULS.shipAssertTag(6379466,324,tf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",te.a[Ce.node.type]);tf=
this.Zc.Vc(15);tf.nw(Zg);qa.Ug.lf(Ce,ue.character,!0,!1);Ce=ui.SelectionFactory.Ie(Zg.currentNode,Ce.cpBegin+1);this.pb.Uc(Ce);tf.dispose();return 32};this.n_b=(ue,Ce,tf,Zg,Xi)=>{if(1===tf)return 32;Xi.MenuItems=this.uVk.value;return 32};this.z4j=(ue,Ce,tf)=>{({jZa:ue}=this.q0c(Ce,tf));return ue};this.r_j=(ue,Ce,tf)=>{2===tf&&(new Hb(this.ga,zf.FocusManager.instance(),wa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).v2a();return 32};this.dsg=()=>32;this.ga=ea;this.td=Pa;this.uVk=new zc.a(this.gTm);
this.Zc=Bb;this.Hnb=ac;this.sm=Gc;this.pb=ld;this.Qo=Gd}mc(){this.ga.nb(pe.a.dsg,ii.a.application,this.dsg,96);this.ga.qa(pe.a.n_b,ii.a.view,this.n_b);this.ga.qa(pe.a.kFe,ii.a.view,this.z4j);this.ga.qa(pe.a.Xve,ii.a.view,this.kDj);this.ga.qa(pe.a.jvb,ii.a.view,this.jZa);this.ga.qa(pe.a.n_b,ii.a.kd,this.n_b);this.ga.qa(pe.a.kFe,ii.a.kd,this.z4j);this.ga.qa(pe.a.Xve,ii.a.kd,this.kDj);this.ga.qa(pe.a.jvb,ii.a.kd,this.kin);this.ga.Oc(pe.a.n_b,1124);this.ga.Oc(pe.a.kFe,1036);this.ga.Oc(pe.a.Xve,1124);
this.ga.Oc(pe.a.jvb,1036);m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(pe.a.U$c,ii.a.view,this.r_j),this.ga.qa(pe.a.U$c,ii.a.kd,this.r_j),this.ga.Oc(pe.a.U$c,1124))}q0c(ea,Pa){let Bb,ac=null;ea.view.Ee&&(ac=ea.view);Bb=null;if(!ac||!ac.ub)return F.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ea.toString()),{returnValue:!0,ke:ac,selected:Bb,jZa:8};Bb=ac.ub.hh;
if(!Bb)return{returnValue:!0,ke:ac,selected:Bb,jZa:2};if(this.sm.t4(Bb)||this.sm.koa(Bb))return{returnValue:!0,ke:ac,selected:Bb,jZa:8};if(ac.ub.ob.IN||this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(Bb)||wj.a.ncb(ea.Pk))return{returnValue:!0,ke:ac,selected:Bb,jZa:2};if(Object(Ch.a)().eHa($g.ParagraphReader.uZ,Bb))return ea=8,qa.Jc.qc(Ee.a.$e,{["Reason"]:rd.a.NS}),{returnValue:!0,ke:ac,selected:Bb,jZa:ea};ea=32;return 1===Pa?{returnValue:!0,ke:ac,selected:Bb,jZa:ea}:{returnValue:!1,ke:ac,selected:Bb,
jZa:ea}}static get Ug(){return qa.ee||(qa.ee=wa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set Ug(ea){qa.ee=ea}static get Jc(){return Wf.a.instance}}qa.ee=null;Object(f.a)(qa,"SymbolsActor",null,[828]);class hb{constructor(ea,Pa){this.jFe=ea;this.altText=Pa}}Object(f.a)(hb,"Symbol",null,[]);class Tb{constructor(){this.Ecf=null;this.qMh=new zc.a(Tb.ixf)}get oKg(){return this.qMh}RFi(ea){this.Ecf||(this.Ecf=Je.a(this.qMh.value));return Array.indexOf(this.Ecf,ea)}static ixf(){const ea=
{};ea["\u2022"]=new hb("\u2022",Box4Intl.Box4Strings.L_Bullet);ea["\u20ac"]=new hb("\u20ac",Box4Intl.Box4Strings.L_EuroSign);ea["\u00a3"]=new hb("\u00a3",Box4Intl.Box4Strings.L_PoundSign);ea["\u00a5"]=new hb("\u00a5",Box4Intl.Box4Strings.L_YenSign);ea["\u00a9"]=new hb("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);ea["\u00ae"]=new hb("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);ea["\u2122"]=new hb("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);ea["\u00b1"]=new hb("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);
ea["\u2260"]=new hb("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);ea["\u2264"]=new hb("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);ea["\u2265"]=new hb("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);ea["\u00f7"]=new hb("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);ea["\u00d7"]=new hb("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);ea["\u221e"]=new hb("\u221e",Box4Intl.Box4Strings.L_Infinity);ea["\u00b5"]=new hb("\u00b5",Box4Intl.Box4Strings.L_MicroSign);ea["\u03b1"]=new hb("\u03b1",
Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);ea["\u03b2"]=new hb("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);ea["\u03c0"]=new hb("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);ea["\u03a9"]=new hb("\u03a9",Box4Intl.Box4Strings.L_OhmSign);ea["\u03a3"]=new hb("\u03a3",Box4Intl.Box4Strings.L_NArySummation);ea["\u00b0"]=new hb("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);ea["\u0394"]=new hb("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);ea["\u263a"]=new hb("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);
ea["\u2665"]=new hb("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);ea["\u20b9"]=new hb("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);ea["\u00bf"]=new hb("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);ea["\u00a1"]=new hb("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);ea["\u2014"]=new hb("\u2014",Box4Intl.Box4Strings.L_EmDash);ea["\u2026"]=new hb("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);ea["\u00c0"]=new hb("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
ea["\u00c1"]=new hb("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);ea["\u00c2"]=new hb("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);ea["\u00c3"]=new hb("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);ea["\u00c4"]=new hb("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);ea["\u00c5"]=new hb("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);ea["\u00c6"]=new hb("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);ea["\u00c7"]=
new hb("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);ea["\u00c8"]=new hb("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);ea["\u00c9"]=new hb("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);ea["\u00ca"]=new hb("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);ea["\u00cb"]=new hb("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);ea["\u00cc"]=new hb("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);ea["\u00cd"]=
new hb("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);ea["\u00ce"]=new hb("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);ea["\u00cf"]=new hb("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);ea["\u00d1"]=new hb("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);ea["\u00d2"]=new hb("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);ea["\u00d3"]=new hb("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);ea["\u00d4"]=
new hb("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);ea["\u00d5"]=new hb("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);ea["\u00d6"]=new hb("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);ea["\u00d9"]=new hb("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);ea["\u00da"]=new hb("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);ea["\u00db"]=new hb("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);ea["\u00dc"]=
new hb("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);ea["\u00df"]=new hb("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);ea["\u00e0"]=new hb("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);ea["\u00e1"]=new hb("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);ea["\u00e2"]=new hb("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);ea["\u00e3"]=new hb("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);ea["\u00e4"]=new hb("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);ea["\u00e5"]=new hb("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);ea["\u00e6"]=new hb("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);ea["\u00e7"]=new hb("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);ea["\u00e8"]=new hb("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);ea["\u00e9"]=new hb("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);ea["\u00ea"]=new hb("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
ea["\u00eb"]=new hb("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);ea["\u00ec"]=new hb("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);ea["\u00ed"]=new hb("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);ea["\u00ee"]=new hb("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);ea["\u00ef"]=new hb("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);ea["\u00f1"]=new hb("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);ea["\u00f2"]=
new hb("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);ea["\u00f3"]=new hb("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);ea["\u00f4"]=new hb("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);ea["\u00f5"]=new hb("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);ea["\u00f6"]=new hb("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);ea["\u00f9"]=new hb("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);ea["\u00fa"]=new hb("\u00fa",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);ea["\u00fb"]=new hb("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);ea["\u00fc"]=new hb("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);ea["\u00ff"]=new hb("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);ea["\u011e"]=new hb("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);ea["\u011f"]=new hb("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);ea["\u0130"]=new hb("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);
ea["\u0131"]=new hb("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);ea["\u0152"]=new hb("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);ea["\u0153"]=new hb("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);ea["\u015e"]=new hb("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);ea["\u015f"]=new hb("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);ea["\u0178"]=new hb("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return ea}}Object(f.a)(Tb,
"SymbolsLoader",null,[827]);var Mc=e(422),vc=e(352),fb=e(219),xd=e(650),We=e(1353),Ke=e(236),Qd=e(105);class Gg{constructor(ea){this.lFe=ea}get lop(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Dxj(ea){ea=ea.SourceControlId.split("_");const Pa={};2===ea.length?(Pa.character=ea[1],Pa.index=this.lFe.RFi(Pa.character)):(Pa.character=ea[2],Pa.index=parseInt(ea[1]));return Pa}Knl(){return this.WMi()}build(){return this.hTm()}Uml(){const ea=new Sys.StringBuilder;
ea.append('<table class="moreSymbolsTable">');const Pa=this.lFe.oKg.value,Bb=Je.a(Pa);let ac=0;for(;ac<Bb.length;){ac%15||ea.append('<tr role="presentation">');const Gc=Pa[Bb[ac]];ea.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+ac,Fa.a.N1(Gc.jFe),Fa.a.N1(Gc.altText)));ac++;ac%15&&ac!==Bb.length||
ea.append("</tr>")}ea.append("</table>");return ea.toString()}hTm(){const ea=this.WMi();return Ke.o(ea)}WMi(){const ea=Object.assign(new Mc.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});ea.MenuSectionList.push(this.h5k());m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&ea.MenuSectionList.push(this.h3k());return ea}h3k(){const ea=Object.assign(new vc.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),Pa=Object.assign(new fb.a,
{Id:"btnMoreSymbols",Command:pe.a.U$c.toString(),LabelText:Fa.a.Mf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Fa.a.Mf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.mr,Image16by16Class:Qd.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});ea.ControlList.push(Pa);return ea}h5k(){const ea=Object.assign(new vc.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),Pa=Object.assign(new xd.a,{Type:1,Id:"gallerySymbolsPosition",
ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Bb=this.lFe.oKg.value,ac=Je.a(Bb),Gc=Math.min(25,ac.length);for(let Gd=0;Gd<Gc;Gd++){var ld=Bb[ac[Gd]];ld=Object.assign(new We.a,{Id:String.format("{0}{1}_{2}","symbol_",Gd,ld.jFe),Character:ld.jFe,Command:pe.a.jvb.toString(),QueryCommand:pe.a.Xve.toString(),Alt:Fa.a.Mf(ld.altText)});Pa.GalleryItems.push(ld)}ea.ControlList.push(Pa);return ea}}Object(f.a)(Gg,"SymbolsUiBuilder",
null,[826]);var Xh=e(54),lh=e(258),Ge=e(565),sg=e(350);class Yf{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.J.$("InsertSymbolIsEnabled")&&this.Z.resolve("Box4.Symbols.ISymbolsActor").mc()}dispose(){}Ec(ea){this.Z=ea;this.Z.register(Tb,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.Z.ja("Box4.Symbols.SymbolsUiBuilder",()=>new Gg(this.Z.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();this.Z.ja("Box4.Symbols.SymbolsActor",
()=>new qa(m.AFrameworkApplication.va,new Ge.a,new sg.a,this.Z.resolve("Box4.Symbols.ISymbolsUIBuilder"),lh.a.instance,Xh.a.instance,this.Z.Za("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){U.a.instance.Rc(new Yf)}}Object(f.a)(Yf,"Box4SymbolsPackage",null,[0,1]);var Um=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",
attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},gl=e(1599),ah=e(1533),Qg=e(1504),xh=e(1996),je=e(307),He=e(421);class Bf{constructor(){this.MRa=null}Ec(ea){this.container=ea}init(){this.MRa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.MRa&&this.MRa.dispose()}}Object(f.a)(Bf,"ALiveBooksAccessibilityCheckPackageManager",null,[0,1]);class uk{get wGl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get xGl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get yGl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get mdo(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get gwc(){return CommonUIStrings.l_AccCheckerPaneTitle}get nho(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(f.a)(uk,"AccessibilityCheckStringsProvider",null,[1172]);class bm{constructor(){this.rOj=this.contentId=null}}Object(f.a)(bm,"ResultIds",null,[]);class Ai{constructor(ea,Pa){this._element=null;this.xh=Pa;this.Ce=ea}get element(){this._element||(this._element=this.vLl(),this.bD());return this._element}HEg(ea){this._element=ea}dispose(){this.element&&(this.Mea(),this.HEg(null))}bD(){this.xh&&this.Ce?(this.xh.Cb(ca.a.click,this.element,Object(P.a)(this,this.onClick,"onClick")),this.Ce.Cb(ca.a.Bj,
this.element,Object(P.a)(this,this.qK,"onKeyPress"))):w.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Mea(){this.xh&&this.Ce&&(this.xh.Gc(ca.a.click,this.element,Object(P.a)(this,this.onClick,"onClick")),this.Ce.Gc(ca.a.Bj,this.element,Object(P.a)(this,this.qK,"onKeyPress")))}onClick(){this.Zqj();return!0}qK(ea){return this.stn(ea.Yb.keyCode)?(this.Zqj(),!0):!1}stn(ea){return ea===nh.a.jxd||
ea===nh.a.vw}}Object(f.a)(Ai,"AInteractivePaneElement",null,[1198,11]);var Pd=e(469),ai=e(82);class Pg extends Ai{constructor(ea,Pa,Bb){super(ea,Pa);this.j5e=Bb}hide(){this.element.removeAttribute(qd.a.fi);qd.a.ju(this.element,qd.a.pz,qd.a.Zp);this.element.style.display="none"}show(){qd.a.ju(this.element,qd.a.pz,qd.a.VM);qd.a.ju(this.element,qd.a.fi,qd.a.rmf);this.element.style.display="block"}vLl(){const ea=Pd.b("div",this.$mj,"AccCheckerNotification");qd.a.ju(ea,qd.a.tZh,qd.a.Zp);qd.a.ju(ea,qd.a.Iba,
this.hgg);ea.tabIndex=0;const Pa=Pd.b("span",this.Zmj,"AccCheckerNotificationIcon");var Bb=Qd.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Pa.appendChild(Bb);Bb=Pd.b("span",this.hgg,"AccCheckerNotificationText");ai.a.Mz(Bb,this.anj);ea.appendChild(Pa);ea.appendChild(Bb);return ea}Zqj(){this.j5e()}}Object(f.a)(Pg,"APopupNotification",Ai,[1216,1198,11]);class Vl extends Pg{constructor(ea,Pa,Bb,ac){super(ea,Pa,Bb);this.HAa=ac}get $mj(){return"AccCheckerOutOfSyncNotificationId"}get Zmj(){return"AccCheckerOutOfSyncNotificationIconId"}get hgg(){return"AccCheckerOutOfSyncNotificationTextId"}get anj(){return this.HAa.mdo}}
Object(f.a)(Vl,"OutOfSyncNotification",Pg,[]);class fg extends Pg{constructor(ea,Pa,Bb,ac){super(ea,Pa,Bb);this.HAa=ac}get $mj(){return"AccCheckerPartialResultNotificationId"}get Zmj(){return"AccCheckerPartialResultNotificationIconId"}get hgg(){return"AccCheckerPartialResultNotificationTextId"}get anj(){return this.HAa.nho}}Object(f.a)(fg,"PartialResultNotification",Pg,[]);var um=e(192),oj=e(31),Dd=e(242);class pj{constructor(ea,Pa,Bb,ac=null,Gc=null,ld=null,Gd=null){this.CHh=this.vQ=this.Ce=this.MRa=
null;this.n_a=ac;this.xh=ea;this.oc=Pa;this.hr=Bb;this.HAa=Gd||new uk;this.$5e=Gc||new Vl(this.n_a,this.xh,Object(P.a)(this,this.t_l,"dimissOutOfSyncNotification"),this.HAa);this.L6e=ld||new fg(this.n_a,this.xh,Object(P.a)(this,this.u_l,"dimissPartialResultNotification"),this.HAa)}show(){}hide(){}get n_a(){return this.Ce||(this.Ce=m.AFrameworkApplication.ta.LG)}set n_a(ea){this.Ce=ea}Jdi(){}$ua(){}dispose(){}lRa(){}Ckn(ea){var Pa=this.CHh[ea];ea=Pa.contentId;if((Pa=Pa.rOj+"")&&Pa.length){const Bb=
[];Array.add(Bb,Object.assign(new oj.a,{name:"RuleID",string:Pa}));um.a.sendTelemetryEvent(Object.assign(new Dd.a,{name:String.format("{0}.{1}",pj.sLg,"ViolationSelected"),dataFields:Bb}))}this.CXn(ea)}CXn(ea){ea&&this.MRa.C0o(ea)||(this.oc.zP(th.AFrame.LQh,!1),this.Bdp())}t_l(){this.Lsd(!1)}u_l(){this.i_j(!1)}Bdp(){const ea=Object.assign(new ze.StandardDialog(!0),{hv:m.AFrameworkApplication.Uha,Md:1,tGa:!1});ea.YW(1);ea.Ue(1,this.HAa.wGl);ea.Ue(0,CommonUIStrings.l_DialogCancel);ea.tU(this.HAa.yGl,
this.HAa.xGl,Pa=>{1===Pa&&this.s_f()})}Qnl(ea){let Pa=null;if(ea.Results&&0<ea.Results.length){Pa={};let Bb=0;for(const ac of ea.Results)ac.ResultId=pj.BZk+ ++Bb,ea=new bm,ea.contentId=ac.ContentId,ea.rOj=ac.RuleId,Pa[ac.ResultId]=ea}return Pa}HNn(){um.a.addNamespaceMapping(pj.sLg,pj.Oqp);um.a.sendTelemetryEvent(Object.assign(new Dd.a,{name:String.format("{0}.{1}",pj.sLg,"ShowTaskpane")}))}}pj.BZk="AccCheckResult";pj.sLg="Office.UX.AccChecker";pj.Oqp="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(f.a)(pj,"BaseAccessibilityCheckPane",null,[1174,11]);class Kh{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(Kh,"AccCheckerTaskPaneProps",null,[]);var Rc=e(1738),ri=e(1876),Wi=e(1513),lm=e(205);class Sk extends pj{constructor(ea,Pa,Bb,ac,Gc=null,ld=null,Gd,ue=
null,Ce=null){super(Pa,Bb,ac,ld,void 0,void 0,ue);this.nch=null;this.mGh=this.K6e=this.TLd=this.YOd=this.wOd=!1;this.fff=null;this.Xcf=!!m.AFrameworkApplication.ta&&!!m.AFrameworkApplication.ta.Pb&&m.AFrameworkApplication.ta.Pb.Z4f;this.vKc=this.daa=null;this.iLc=0;this.aGd=null;this.g3=Gc;Ce&&(this.daa=Ce.RTd,this.vKc=Ce.Z8p,this.iLc=Ce.Maq);this.kC=new ri.a}get isVisible(){return this.mGh}Pxa(ea){this.mGh=ea}eBf(ea){ea&&(this.nch=ea,ea.IsSuccess&&(this.CHh=this.Qnl(ea),ea.IsPartialResult&&this.i_j(!0)),
this.wOd=!0,this.YOd=!1,this.ao())}Lsd(ea){this.isVisible&&ea!==this.TLd&&(this.TLd=ea,this.ao())}i_j(ea){this.K6e=ea;this.ao()}sU(){this.YOd||lm.UISurfaces.aw().then(ea=>{pa.a.instance.MA(Sk.PDb+":PaneOpen:Start");ea.showTaskPane(Sk.PDb,this.AB());this.s_f();return null});this.isVisible?lm.UISurfaces.aw().then(ea=>{var Pa;ea.setSelectedTaskPane(Sk.PDb);(null===(Pa=m.AFrameworkApplication.J)||void 0===Pa?0:Pa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTOAccessibilityPaneFocusFix"))&&
this.ZW();return null}):this.HNn()}ao(){lm.UISurfaces.aw().then(ea=>{ea.updateTaskPane(Sk.PDb,this.AB());return null})}AB(){var ea=new Kh;this.kC.Dgb(ea);ea=Object.assign(new Wi.a,{title:this.HAa.gwc,hideHeader:!1,width:320,location:2,contentProps:ea,onOpen:()=>{this.ZW();this.Pxa(!0);m.AFrameworkApplication.ta.Ne()},onClose:()=>{this.qja();this.Pxa(!1);this.YOd=this.wOd=!1;this.ao();m.AFrameworkApplication.ta.Ne()},isModernPane:!0});this.Xcf&&(ea.enableResize=!0,ea.minResizeWidth=268,ea.maxResizeWidth=
920);return ea}initialize(ea){const Pa=this.oc.te(Sk.PDb);Pa.parent=th.AFrame.rr;Pa.LN=!0;this.MRa=ea;this.K_k()}dispose(){this.lRa();this.$5e&&(this.$5e.dispose(),this.$5e=null);this.L6e&&(this.L6e.dispose(),this.L6e=null);super.dispose()}K_k(){this.kC.BP(this.onRecheckExecute());this.kC.BP(this.jmm());this.kC.BP(this.XOm());this.kC.BP(this.onInvokeNavigateExecute());this.kC.BP(this.MBm());this.kC.BP(this.PJm());this.kC.BP(this.HLm());this.kC.BP(this.updateLastScanTime());this.kC.BP(this.showHelpPane())}onRecheckExecute(){return ea=>
{ea.onRecheckExecute=()=>{this.s_f()}}}jmm(){return ea=>{ea.accessibilityCheckResultCollection=this.nch}}XOm(){return ea=>{ea.resultsReady=this.wOd}}onInvokeNavigateExecute(){return ea=>{ea.onInvokeNavigateExecute=Pa=>{this.Ckn(Pa)}}}MBm(){return ea=>{ea.helpLink=this.pam}}PJm(){return ea=>{ea.outOfSync=this.TLd}}HLm(){return ea=>{ea.partialResult=this.K6e}}updateLastScanTime(){return ea=>{ea.updateLastScanTime=Pa=>{this.fff=Pa}}}showHelpPane(){return ea=>{ea.showHelpPane=()=>{m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.BL||this.bZh()?this.aGd?this.aGd():this.daa.value&&this.vKc&&this.iLc&&this.daa.value.Zb(this.iLc,2,this.vKc):this.f0j():this.bZh()?this.aGd?this.aGd():this.daa.value&&this.vKc&&this.iLc&&this.daa.value.Zb(this.iLc,2,this.vKc):this.f0j()}}}bZh(){return!this.g3||!this.g3.value}f0j(){const ea=this.g3.value;if(ea){var Pa={};Pa.query=Sk.lQk+Sk.qEk;Pa=Object.assign(new Rc.a,
{DW:Pa});ea.l6(Sk.CXe,Pa)}}s_f(){this.K6e=this.TLd=this.wOd=!1;this.fff&&this.fff();this.ao();this.YOd=!0;this.MRa.M2n()}ZW(){this.oc.Rg(Sk.PDb)}qja(){this.ddb()&&this.oc.Rg(this.oc.NY)}ddb(){return!!this.oc.currentScope&&this.oc.currentScope.name===Sk.PDb}}Sk.PDb="AccessibilityCheckerPane";Sk.qEk="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Sk.CXe="FA000000012";Sk.lQk="AssetID=";Object(f.a)(Sk,"ReactAccessibilityCheckPane",pj,[]);class kf extends Sk{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce=null){super(ea,
Pa,Bb,ac,Gc,ld,void 0,Ce);this.bBk=ue;this.qY=Gd}get pam(){return this.bBk}sU(){this.qY.iLa();super.sU()}}Object(f.a)(kf,"ReactLiveBooksAccessibilityCheckPane",Sk,[]);var tp=e(1774),jn=e(137),Em=e(112),Vm=e(63),Rg=e(126),rb=e(610),Sb=e(534),Tc;(function(ea){ea[ea.error=0]="error";ea[ea.warning=1]="warning";ea[ea.Xxq=2]="tip";ea[ea.Mcq=3]="intelligentService"})(Tc||(Tc={}));Object(f.b)("AccessibilityRuleCategory",Tc);class pd{constructor(ea,Pa,Bb=null){this.HMe=null;this.Kuh=this.rth=!1;this.xVa=ea;
this.vzd=Pa;this.ga=Bb;this.Tb.qa(u.a.Ozl,x.a.frame,Object(P.a)(this,this.Esf,"closePane"))}get Tb(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set Tb(ea){this.ga=ea}t7l(){this.rth||(this.xVa.initialize(this),this.vzd.initialize(this),this.rth=!0)}M2n(){F.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.vzd.xRo()}sU(ea,Pa,Bb){if(1===Bb)return Hf.SessionStatusManager.instance.zk?8:32;this.xVa.isVisible||this.t7l();this.jfp();return 32}Esf(ea,Pa,Bb){1!==Bb&&this.xVa.$ua();return 32}D9n(){this.xVa.Lsd(!0)}eBf(ea){if(ea){if(ea.AccessibilityRules&&
Object.keys(ea.AccessibilityRules).length){const Bb=ea.AccessibilityRules;for(const ac in Bb){var Pa=ac;const Gc=Bb[ac].RuleId+"";Pa!==Gc&&F.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",Pa,Gc)}this.HMe=Bb}else!this.HMe&&ea.Results&&0<ea.Results.length?(F.b(18993251,200,15,"No accessibility rule definitions available"),ea.IsSuccess=!1):ea.AccessibilityRules=this.HMe;ea.IsSuccess||F.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.OGo(ea);this.xNn(ea);
this.xVa.eBf(ea)}}OGo(ea){const Pa=ea.AccessibilityRules;if(ea=ea.Results)for(let Bb=ea.length-1;0<=Bb;Bb--){const ac=ea[Bb];let Gc="";const ld=ac.RuleId;ac.ContentName||(Gc+="Result does not have content name. ");ld in Pa||(Gc+=String.format("No accessibility check rule exists for ID {0}.",ld));0<Gc.length&&(F.b(36214999,200,15,"Omitting invalid accessibility check result: "+Gc),Array.removeAt(ea,Bb))}}KQf(){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
wa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("accessibility-checker-pane-strings")}jfp(){this.Kuh?this.xVa.sU():this.KQf().then(()=>{this.Kuh=!0;this.xVa.sU()}).catch(ea=>w.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",ea))}xNn(ea){var Pa={};const Bb={};var ac=ea.Results,Gc=[];Array.add(Gc,Object.assign(new oj.a,{name:"FinalViolationCount",int64:0}));Array.add(Gc,Object.assign(new oj.a,{name:"FinalErrorCount",
string:"0"}));Array.add(Gc,Object.assign(new oj.a,{name:"FinalWarningCount",string:"0"}));Array.add(Gc,Object.assign(new oj.a,{name:"FinalTipCount",string:"0"}));Array.add(Gc,Object.assign(new oj.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(ac){for(const ue of ac)if(ea.AccessibilityRules){var ld=ea.AccessibilityRules[ue.RuleId];if(ld){if(Pa[Tc[ld.Category]]){let Ce=Pa[Tc[ld.Category]];Pa[Tc[ld.Category]]=++Ce}else Pa[Tc[ld.Category]]=1;Bb[ue.RuleId]?(ld=Bb[ue.RuleId],Bb[ue.RuleId]=++ld):
Bb[ue.RuleId]=1}}Gc[0].int64=ac.length;for(var Gd in Pa)switch(ea=Pa[Gd],ac=Gd,ac="Final"+ac.charAt(0).toUpperCase()+ac.substring(1,ac.length)+"Count",ac){case "FinalErrorCount":Gc[1].string=ea.toString();break;case "FinalWarningCount":Gc[2].string=ea.toString();break;case "FinalTipCount":Gc[3].string=ea.toString();break;case "FinalIntelligentServiceCount":Gc[4].string=ea.toString()}}um.a.sendTelemetryEvent(Object.assign(new Dd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),
dataFields:Gc}));for(const ue in Bb)Pa=ue,Gc=Bb[ue],Gd=[],Array.add(Gd,Object.assign(new oj.a,{name:"RuleID",string:Pa})),Array.add(Gd,Object.assign(new oj.a,{name:"FinalViolationCount",string:Gc.toString()})),um.a.sendTelemetryEvent(Object.assign(new Dd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Gd}))}dispose(){this.xVa&&this.xVa.dispose();this.vzd&&this.vzd.dispose()}}Object(f.a)(pd,"AAccessibilityCheckManager",null,[29,11]);var Ae=
e(465);const ne=[12,14,22,19,30,43,44];class Oe extends pd{constructor(ea,Pa,Bb,ac,Gc,ld){super(Pa,Bb,ea);this.Tb.qa(u.a.zGg,x.a.frame,this.sU.bind(this));this.Tb.nb(u.a.pto,x.a.frame,this.mDj.bind(this),96);this.GT=Gc;this.uLk=ac;this.IHk=ld;this.Cvc=()=>{this.D9n()};this.kDo()}mDj(ea,Pa,Bb,ac,Gc){if(1===Bb)return 32;Gc[Ae.a.On]=this.xVa.isVisible;return 32}C0o(ea){if(this.IHk)return w.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;w.ULS.shipAssertTag(20272215,334,!!ea);
return this.uLk.vXn(ea)}kDo(){for(const ea of ne){const Pa=this.GT.Hf(ea);Pa.yq(this.Cvc);Pa.wv(this.Cvc);Pa.bA(this.Cvc)}}dBp(){for(const ea of ne){const Pa=this.GT.Hf(ea);Pa.nU(this.Cvc);Pa.VW(this.Cvc);Pa.jxa(this.Cvc)}}dispose(){super.dispose();this.dBp()}}Object(f.a)(Oe,"WordAccessibilityCheckManager",pd,[]);var Of=e(86),Yg=e(26),If=e(110),Ph=e(133),Se=e(174),Cg=e(5),Vg=e(19),qj=e(491);class Tn{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.Wo=null;this.HPb=0;this.td=Pa;this.nI=Bb;this.pb=ac;this.ga=
Gc;this.zd=ld;this.LA=ea;this.Ld=Gd}get IU(){if(!this.Wo){const ea=this.td.Ag(this.LA.rd);this.nI.ZNg(ea);if(ea.Ib(7)||ea.xd(7))this.Wo=Of.a.$u(ea,ea.origin)}return this.Wo}vXn(ea){if(!ea||!ea.Eg||0>=ea.Eg.length)return w.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Pa=Array(ea.Eg.length);let Bb=7,ac=null;for(let ld=0;ld<ea.Eg.length;ld++)if(ac=this.Eem(ea.Eg[ld])){if(7===Bb)Bb=this.HPb;else if(Bb!==this.HPb)return w.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),
!1;var Gc=this.Ld.J0a(ac.characterData,ac.ra);const Gd=ea.cpBegin?this.Ld.bPb(Gc,ea.cpBegin):-1;Gc=ea.cpEnd?this.Ld.bPb(Gc,ea.cpEnd):-1;if(-1>Gd||-1>Gc)return w.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Pa[ld]=Yg.a.OV(Gd,Gc,!1,ac);switch(ea.contentType){case 5:if(!If.a.O8c(Pa[ld],!1))return!1;break;case 6:if(!Ph.a.v9(Pa[ld]))return!1;break;case 7:Pa[ld]=Yg.a.OV(-1,-1,!1,ac)}}else return!1;Pa=new Se.Selection(Pa,!1);return this.D5o(ac,Pa,ea.contentType)}Eem(ea){if(this.IU)for(this.IU.reset(),
this.HPb=7;this.IU.moveNext();){var Pa=this.IU.currentNode.type;if(38===Pa||36===Pa||23===Pa)this.HPb=Pa;else if(12===Pa){Pa=this.IU.currentNode;const Bb=Pa.ka(Cg.a.qd,0);if(ea===Bb)return Pa}}return null}v4j(ea){this.ga.Vb(Vg.a.PY,2);this.ga.Vb(Vg.a.C8,2);let Pa=2;switch(this.HPb){case 23:Pa=32;break;case 38:Pa=this.ga.Zb(Vg.a.Aeb,2,new qj.a(ea));break;case 36:Pa=this.ga.Zb(Vg.a.Xwb,2,new qj.a(ea));break;default:w.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.HPb)}if(32===
Pa)return!0;w.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.HPb);return!1}D5o(ea,Pa,Bb){if(this.v4j(ea)){ea=this.LA.py;const ac=this.pb.ob.currentSelection;ac&&ac.equals(Pa)&&this.zd.xja(ea,null);this.zd.xja(ea,Pa);switch(Bb){case 0:case 1:this.ga.Vb(pe.a.M1b,2);break;case 2:this.ga.Vb(pe.a.qqd,2);break;case 3:this.ga.Vb(pe.a.fGa,2)}return!0}return!1}}Object(f.a)(Tn,"WordAccessibilityCheckNavigateManager",null,[857]);class Wp{constructor(ea){this.MRa=null;this.Soh=ea}get fileId(){return this.Soh?
this.Soh():null}initialize(ea){this.MRa=ea}gpj(ea){this.MRa.eBf(ea)}}Object(f.a)(Wp,"AAccessibilityCheckService",null,[1173,11]);class bj{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(ea){ea=Sys.Serialization.JavaScriptSerializer.deserialize(ea);const Pa=ea.AccessibilityRules,Bb={};if(Pa)for(let ac=0;ac<Pa.length;++ac){const Gc=Pa[ac];Bb[Gc.Key]=Gc.Value}ea.AccessibilityRules=Bb;return ea}}Object(f.a)(bj,"AccessibilityCheckResultCollection",
null,[]);class Kj extends Wp{constructor(ea){super(ea);this.onFailure=(Pa,Bb)=>{w.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",Bb);Pa=Object.assign(new bj,{IsSuccess:!1});this.gpj(Pa)};this.iE=Pa=>{Pa=Kj.VOm(Pa);let Bb=null;if(Pa)try{Bb=this.KXl(Pa)}catch(ac){w.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",ac.message),Bb=Object.assign(new bj,{IsSuccess:!1})}else w.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),
Bb=Object.assign(new bj,{IsSuccess:!1});this.gpj(Bb)}}dispose(){}static VOm(ea){let Pa=null;ea&&ea.rl&&(Pa=ea.rl[0]);return Pa?Pa.Body:null}}Object(f.a)(Kj,"ALiveBooksAccessibilityCheckService",Wp,[]);var Tj=e(1085),oh=e(1023),Fc=e(1342),Io=e(262),Rl=e(459);class tg extends Io.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Hn(){return Rl.a.AZk}static construct(ea,Pa){const Bb=new tg;Bb.FileId=ea;Bb.IsCoauthorable=Pa;return Bb}}Object(f.a)(tg,"WordAccessibilityCheckRequest",Io.a,[]);
class Dq{}Object(f.a)(Dq,"AccessibilityCheckRule",null,[]);var Gp=e(190);class Hp{static parse(ea){switch(Fa.a.Ph(ea)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw ea=String.format("Invalid Accessibility result category: {0}",ea),Gp.a.argument(ea);}}}Object(f.a)(Hp,"AccessibilityRuleCategoryParser",null,[]);class ic{constructor(){this.Category=this.Text=this.Id=null}static Wsp(ea){const Pa=new Dq;Pa.RuleId=ea.Id;Pa.RuleName=
ea.Text;Pa.Category=Hp.parse(ea.Category);return Pa}}Object(f.a)(ic,"WordAccessibilityCheckRule",null,[]);class Dj{}Object(f.a)(Dj,"AccessibilityCheckResult",null,[]);class Fm{constructor(){this.cpEnd=this.cpBegin=this.Eg=null;this.contentType=0}}Object(f.a)(Fm,"WordAccessibilityCheckContentId",null,[]);const Il=ea=>{switch(Fa.a.Ph(ea)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;
case "anchoredepicture":return 7;default:return 8}};var Mk=e(1549);class Eq{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static Usp(ea){const Pa=new Dj;Pa.RuleId=ea.RuleId;Pa.ContentName=ea.Label;const Bb=new Fm;Bb.Eg=ea.ParaId;Bb.cpBegin=Mk.b(ea.OS);Bb.cpEnd=Mk.b(ea.OE);Bb.contentType=Il(ea.ContentType);Pa.ContentId=Bb;return Pa}}Object(f.a)(Eq,"WordAccessibilityViolation",null,[]);class ge{constructor(){this.Violations=this.Rules=null}static Vsp(ea){const Pa=
new bj;try{var Bb={};if(ea.Rules){for(let ac=0;ac<ea.Rules.length;++ac){const Gc=ic.Wsp(ea.Rules[ac]);Bb[Gc.RuleId]=Gc}Pa.AccessibilityRules=Bb}if(ea.Violations){const ac=Array(ea.Violations.length);for(Bb=0;Bb<ea.Violations.length;++Bb)ac[Bb]=Eq.Usp(ea.Violations[Bb]);Pa.Results=ac}Pa.IsPartialResult=!1;Pa.IsSuccess=!0}catch(ac){w.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",ac.message),Pa.IsSuccess=!1}return Pa}}
Object(f.a)(ge,"WordAccessibilityCheckResult",null,[]);class Lj extends Kj{constructor(ea,Pa,Bb){super(ea);this.wGb=Pa;this.olb=Bb}xRo(){const ea=Object.assign(new Tj.a,{Ls:tg.construct(this.fileId,this.olb),status:oh.a.xK,MH:"AccessibilityCheck"});this.wGb(Fc.a.CZk,!1,this.iE,this.onFailure,ea,null,ea)}KXl(ea){ea=Xa.b(ea);return ge.Vsp(ea)}}Object(f.a)(Lj,"WordAccessibilityCheckService",Kj,[]);class Xp extends Bf{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}Ec(ea){super.Ec(ea);
ea.ja("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new kf(m.AFrameworkApplication.va,je.a.instance,zf.FocusManager.instance(),He.a.instance,ea.zf("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ub.KeyInputManager.instance,tp.a.instance,m.AFrameworkApplication.J.rb("AccessibilityCheckerHelpUrl"))).ha();ea.ja("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Lj(()=>m.AFrameworkApplication.rootQuerySignature,Sb.a.rT,jn.a.instance.t$d(qe.StaticActiveAppFrame.Aa().tb.rd))).ha();
ea.ja("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Tn(qe.StaticActiveAppFrame.Aa().tb,ea.resolve("Box4.Graph.IGraphIteratorFactory"),Object(Em.a)(),ea.resolve("Box4.ISelectionManager"),m.AFrameworkApplication.va,Object(Vm.a)(),ea.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();ea.ja("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Oe(m.AFrameworkApplication.va,ea.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
ea.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),ea.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Rg.a.wf.Um,rb.a.gcd)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{Bf.prototype.init.call(this)})}}Object(f.a)(Xp,"WordAccCheckerPackageManager",Bf,[]);var Cl;(function(ea){ea[ea.gaq=0]="graphSpaceReplicatorNotSendingContent";ea[ea.fcq=1]="inboundRequestTakesTooLongToSendAfterRTC";ea[ea.V5p=2]="docxSaveMonitorKickoutElapsed"})(Cl||
(Cl={}));Object(f.b)("ComponentLoggingScenario",Cl);var Yp=e(1335);class Qo{flush(ea,Pa){const Bb=this.lwm(ea);Bb.LoggingScenario=Cl[Pa];Je.a(Bb).length?w.ULS.sendTraceTag(594571986,3013,15,"{0}",Bb):w.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",Yp.a[ea.zWa])}lwm(ea){const Pa={};if(!ea)return Pa;const Bb=new Pe.a;for(Bb.enqueue(ea);!Bb.isEmpty;){ea=Bb.dequeue();const ac=Yp.a[ea.zWa];try{Pa[ac]=ea.hF()}catch(Gc){w.ULS.sendTraceTag(594571985,
3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",ac.toString(),{["Kind"]:"Exception",["Stack"]:Gc.stack,["Message"]:Gc.message,["FileName"]:Gc.fileName,["LineNumber"]:Gc.lineNumber})}if((ea=ea.y_d)&&ea.length)for(const Gc of ea)!Gc||Yp.a[Gc.zWa]in Pa||Bb.enqueue(Gc)}return Pa}}Object(f.a)(Qo,"ComponentStateLogManager",null,[824]);class oq{flush(){}}Object(f.a)(oq,"NoOpComponentStateLogManager",null,[824]);class Fk{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve("Common.IComponentStateLogManager")}dispose(){}Ec(ea){this.Z=
ea;m.AFrameworkApplication.J.$("ComponentStateLoggingPackageIsEnabled")?ea.ja("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Qo).as("Common.IComponentStateLogManager").ha():ea.ja("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new oq).as("Common.IComponentStateLogManager").ha()}static main(){U.a.instance.Rc(new Fk)}}Object(f.a)(Fk,"WordEditorComponentStateLoggingPackage",null,[0,1]);var Di=e(797),tn=e(656),vk=e(805),bg=e(806),Ri=e(70);class vm{constructor(ea,
Pa=null,Bb=-1,ac=null){this.Z3=ea;this.MPh=ac||(()=>Pa);this.WCd=Bb}addRequest(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf=null,Zg=!1,Xi=null,ph=null){const Dh=new XMLHttpRequest;let qk="";ld="";2===Pa?(qk="POST",Bb&&(ld=Bb)):qk="GET";Pa={};this.Z3&&(ea=Di.a.$1k(Pa,ea,Ri.a.pJe,m.AFrameworkApplication.fDb,this.Z3));Dh.open(qk,ea,!0);this.Pnl(Pa,ea);if(ac)for(const wn in ac)Dh.setRequestHeader(wn,Fa.a.gR(ac[wn]));for(const wn in Pa)Dh.setRequestHeader(wn,Pa[wn]);ea=Xi||this.WCd;0<ea&&(Dh.timeout=ea);ea=[];Array.add(ea,
Ri.a.u4);ac=new Sys.Net.WebRequest;const Wn=new vk.a(1,2,ac,ea,Gc,Gd,ue,Ce,Zg,tf,ph);Dh.onreadystatechange=()=>{this.X8n(Dh,Wn)};try{Dh.send(ld)}catch(wn){w.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}inc(){return 1}X8n(ea,Pa){if(this.fwl(ea,Pa)&&4===ea.readyState)if(ea.getResponseHeader(Ri.a.gpi)&&m.AFrameworkApplication.k2c)m.AFrameworkApplication.k2c();else{var Bb=ea.getResponseHeader(Ri.a.tqf);Di.a.mIe(Bb);this.nHp(ea,Pa);ea.status===Vj.a.jB?(Pa.status=
2,Pa.oM(new bg.a(Pa))):(Pa.status=ea.status&&ea.status!==Vj.a.Xzb?ea.status===Vj.a.e$?5:3:7,Pa.N8(new tn.a(Pa)))}}Pnl(ea,Pa){ea["X-xhr"]=1;m.AFrameworkApplication.buildVersion&&(ea[Ri.a.Tuc]=Fa.a.gR(m.AFrameworkApplication.buildVersion));let Bb=null;this.MPh&&(Bb=this.MPh());Bb&&(ea[Ri.a.ZRg]=Bb);m.AFrameworkApplication.QO&&(ea[Ri.a.hOb]=Fa.a.gR(m.AFrameworkApplication.QO),m.AFrameworkApplication.ztc&&w.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",ea[Ri.a.hOb]));m.AFrameworkApplication.accessToken&&
(Di.a.G6h(Pa,m.AFrameworkApplication.vV)||(ea[Ri.a.fRh]=Fa.a.gR(m.AFrameworkApplication.accessToken)),Di.a.G6h(Pa,m.AFrameworkApplication.ega)||(ea[Ri.a.gRh]=m.AFrameworkApplication.Nla.toString()));m.AFrameworkApplication.userType&&(ea[Ri.a.sfk]=Fa.a.gR(m.AFrameworkApplication.userType))}nHp(ea,Pa){Pa.Xe=ea.status?ea.status:Vj.a.Xzb;try{Pa.responseData=ea.responseText;if(void 0!==Pa.O1a&&null!==Pa.O1a){Pa.Pi={};for(let Bb=0;Bb<Pa.O1a.length;++Bb){const ac=Pa.O1a[Bb];Pa.Pi[ac]=ea.getResponseHeader(ac)}}Pa.FCe&&
(Pa.xpa=ea.responseText&&ea.responseText.length?ea.responseXML:null)}catch(Bb){w.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",Pa.id,Pa.request.get_url(),4===ea.readyState)}}fwl(ea,Pa){return ea?Pa?!0:(w.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(w.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),
!1)}static create(ea,Pa,Bb){return new vm(ea,null,Bb,Pa)}}Object(f.a)(vm,"SimpleClientRequestSender",null,[1779]);class ef{constructor(ea,Pa,Bb){this.$f=ea;this.iQd=Pa;this.kGh=Bb}addRequest(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf=null,Zg=!1,Xi=null,ph=null,Dh=null,qk=null,Wn=!1){return this.kGh?this.iQd.addRequest(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,ph,Dh):this.$f.addRequest(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi,ph,Dh,qk,Wn)}inc(ea){return this.kGh?this.iQd.inc():this.$f.inc(ea)}}Object(f.a)(ef,"ClientRequestAdapter",
null,[1837]);var xj=e(228),Sg=e(269),Zj=e(239),hl=e(1282),Ao=e(1291),Bn=e(1346),Ol=e(45),Jo=e(757),eo=e(616),tl=e(94),Ro=e(596),vr=e(623),up;(function(ea){ea[ea.none=0]="none";ea[ea.Mzi=1]="getCells";ea[ea.Wde=2]="hotStoreStatus";ea[ea.ZOj=3]="saveMonitor";ea[ea.atq=4]="saveMonitor_LineageTombstone";ea[ea.Mwb=5]="kickoutExecutor"})(up||(up={}));Object(f.b)("MostRecentRevisionIdOrigin",up);class kn extends Sys.EventArgs{constructor(ea,Pa,Bb,ac){super();this.odb=ea;this.httpStatusCode=Bb;this.Xj=ac}}
Object(f.a)(kn,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class ip{constructor(){this.kba=0}get isEmpty(){return!this.kba}rVc(ea){this.kba|=ea}Jcd(ea){return!!(this.kba&ea)}clear(){this.kba=0}FXc(){return!1}}Object(f.a)(ip,"DocxSaveMonitorRetryAttemptOnce",null,[]);class mm{constructor(ea,Pa=3){this.kba=0;this.zOd=new Map;this.HKk=ea;this.GRk=Pa}get isEmpty(){return!this.kba}rVc(ea){this.kba|=ea;let Pa=this.zOd.get(ea)||0;this.zOd.set(ea,++Pa)}Jcd(ea){return!!(this.kba&ea)}clear(){this.kba=
0;this.zOd.clear()}FXc(ea){return this.GRk&ea?(this.zOd.get(ea)||0)<this.HKk:!1}}Object(f.a)(mm,"DocxSaveMonitorRetryAttemptMany",null,[]);class Fq{static create(ea=!1,Pa=3,Bb=0){return ea?new mm(Pa,Bb):new ip}}Object(f.a)(Fq,"DocxSaveMonitorRetryAttemptFactory",null,[]);class br extends Io.a{constructor(){super();this.CellId=this.FileId=null}Hn(){return Rl.a.kOf}static construct(ea){const Pa=new br;Pa.FileId=ea.hk().Kr;Pa.CellId=tl.a(ea.ed.id);return Pa}}Object(f.a)(br,"LastSavedRevisionRequest",
Io.a,[]);var xi;(function(ea){ea[ea.vmq=-1]="noResultYet";ea[ea.ozq=0]="upToDate";ea[ea.nuq=1]="sessionLost";ea[ea.Kzq=2]="userSignedOut";ea[ea.jqq=3]="previousRequestPending";ea[ea.tye=4]="requestFailed";ea[ea.Xuq=5]="shuttingDown";ea[ea.fnq=6]="nullResponseData";ea[ea.hdq=7]="invalidResponseData";ea[ea.d8p=8]="failedRevisionLookup";ea[ea.otq=9]="savedWithinThreshold";ea[ea.Mmq=10]="notSavedWarning";ea[ea.Odq=11]="kickoutThreshold";ea[ea.Kyq=12]="unknownRevision";ea[ea.w3p=13]="contentNotYetLoaded";
ea[ea.zYo=14]="sessionExpired";ea[ea.qsl=15]="canaryError";ea[ea.timeout=16]="timeout";ea[ea.Pdq=17]="kickoutThreshold_Offline";ea[ea.o6p=18]="dssSessionDeleted";ea[ea.p6p=19]="dssSessionExpired";ea[ea.aAq=20]="waitingForSessionTokenRefresh";ea[ea.q6p=21]="dssSessionNotFound"})(xi||(xi={}));Object(f.b)("SaveMonitorResult",xi);class bh{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi,ph,Dh,qk,Wn,wn,hr,Ss,ev,Sv,mt,Tv,rs,fv,nt=null,ir){this.EOc=0;this.L$b=!1;this.sRc=null;this.iNc=this.q0=-1;this.O7e=
null;this.cNd=0;this.dNd=!1;this.ZIb=null;this.tPc=0;this.C$e=this.tNh=null;this.HX=this.Pxh=this.uJc=0;this.n2e=null;this.Nuh=!1;this.Wk=null;this.NHh=this.jQd=0;this.lKh=!1;this.Mfm=()=>{var Jg;w.ULS.sendTraceTag(524871194,bh.Jo,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.XT,["AppVisibilityState"]:hl.a[null===(Jg=this.Wk)||void 0===Jg?void 0:Jg.pC]});try{if(this.PKc){var Pl=this.PKc();w.ULS.sendTraceTag(509367249,bh.Jo,50,"Additional Details: {0}",Pl)}}catch(Ln){Jg=Xa.c({["Kind"]:"Exception",
["Stack"]:Ln.stack,["Message"]:Ln.message,["FileName"]:Ln.fileName,["LineNumber"]:Ln.lineNumber}),w.ULS.sendTraceTag(509367062,bh.Jo,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Jg)}Jg=this.aIb;this.aIb=this.oD();if(this.zfa())this.tD.event(5),this.stop("session has shut down");else if(this.nlb===bh.fNj&&this.WGa(this.fGb),Pl=this.N9b())if(this.XT)this.tD.event(0);else if(this.Q$b())this.tD.event(1),this.stop("session is lost"),m.AFrameworkApplication.ud("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),
this.Nuh&&!this.ttn()&&(w.ULS.sendTraceTag(554726995,bh.Jo,10,"DocxSaveMonitor: Session lost but not kicked out"),this.XL(Ol.a.Imi));else if(this.Pvh())20!==this.tD.currentState?(this.tD.event(20),this.tNh=this.oD(),w.ULS.sendTraceTag(593510691,bh.Jo,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.vNh)):this.oD().getTime()-this.tNh.getTime()>this.vNh&&(this.tD.event(14),this.rke(20,Ol.a.K3d,"TokenExpired"));else if(this.FIk())if(this.aIb=
Jg,this.L$b)this.tD.event(3),this.oD().getTime()-this.sRc.getTime()>this.B1e&&(Jg=this.rQe.inc(this.q0),w.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.q0,bf.a[Jg]),this.kOd&&this.kOd.log(),this.stop("stuck on previousRequestPending"),this.XL());else if(Jg=eo.b(br.construct(Pl)),this.L$b=!0,this.sRc=this.oRk(),this.q0=this.rQe.addRequest(bh.serviceUrl,2,Jg,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.iwl,this.hwl,null,
void 0,void 0,this.v8e,this.oSc,void 0,void 0,!0),0>=this.q0)this.L$b=!1,w.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.q0.toString());else{Jg=this.rQe.inc(this.q0);Pl=100;if(Jg&&1!==Jg||this.bsh)Pl=50;w.ULS.sendTraceTag(19161612,bh.Jo,Pl,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.q0,["Status"]:bf.a[Jg]});this.kOd&&this.kOd.start(this.q0)}else this.tD.event(2);else this.tD.event(13)};this.hwl=Jg=>{this.HX=this.H_d+1;let Pl=this.L$b=
!1,Ln=!1;Jg=Jg.data;ub.a.fm&&m.AFrameworkApplication.Goa("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Jg?(w.ULS.sendTraceTag(22552773,bh.Jo,15,"Request failed {0}",{["Status"]:Jg.status,["HttpStatus"]:Jg.Xe,["Correlation"]:Jg.Pi?Jg.Pi[Ri.a.u4]:"",["Id"]:Jg.id,["ConsecutiveErrors"]:this.H_d,["Request.InvokedTime"]:Jg.ZI,["Request.EnqueueTime"]:Jg.iua,["Request.CompletedTime"]:Jg.MQ}),Ln=7===Jg.status||13===Jg.status,this.FXc(2)&&Ln?(this.E4a.rVc(2),Pl=!0,this.iNc=Jg.Xe,
this.tD.event(16)):this.FXc(1)&&5===Jg.status?(this.E4a.rVc(1),Pl=!0,this.iNc=Jg.Xe,this.tD.event(15)):(this.tD.event(4),this.iNc=Jg.Xe)):(this.tD.event(4),w.ULS.sendTraceTag(23425240,bh.Jo,15,"RequestFailed and event data is null"));if(!Pl&&(this.E4a.clear(),Ln?this.rke(17,Ol.a.d3l,"while offline"):this.rke(11,Ol.a.IBf,"while online")))return;this.WGa(Pl?this.Vom(Ln):this.fGb)};this.iwl=Jg=>{this.HX=this.H_d+1;this.L$b=!1;var Pl={};this.E4a.clear();if(Jg=Jg.data){var Ln=Jg.Pi?Jg.Pi[Ri.a.u4]:"";Pl.HttpStatus=
Jg.Xe;Pl.Correlation=Ln;Pl.Id=Jg.id;w.ULS.sendTraceTag(23425242,bh.Jo,this.bsh?50:100,"Request succeeded at the HTTP level {0}",Pl);this.iNc=Jg.Xe}else w.ULS.sendTraceTag(23425241,bh.Jo,15,"Request succeeded with null response data");if(this.zfa()||!this.L3d)this.tD.event(5),this.stop("session has shut down");else if(!this.$yn())if(Jg&&Jg.responseData)if(Jg=this.WWa(Jg.responseData))if(this.zJ.r3a(Jg),Jg.StatusCode)this.q6f(Jg,Pl)||this.tD.event(8,Pl);else{this.HX=0;this.aIb=this.oD();this.M9e.clear();
Pl={["LastSavedRevisionId"]:Jg.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Jg.RevisionSequenceNumber};Jg=tl.b(Jg.LastSavedRevisionId);this.QAb(Jg,3);var Xo=this.ALf().UFa.NTb(Jg);if(Xo){Jg=null;Ln=this.jtb();Xo=(Xo=Xo.XXa(Ln))?Xo.id:Ci.a.nil;let Vk=Ln;for(;Vk&&!Vk.id.equals(Xo);)Jg=Vk,Vk=Vk.dH;this.j2m(Jg,Pl,Ln)||this.tD.event(9)}else this.T0m()||this.tD.event(12,Pl);this.WGa(this.pdc)&&w.ULS.sendTraceTag(22552774,bh.Jo,50,"Received response from server -- going back to normal interval")}else this.tD.event(7),
this.r6f("invalid response",Pl);else this.tD.event(6),this.r6f("null response",Pl)};this.tPo=(Jg,Pl)=>{Jg={};Jg.DocxSaveMonitorState=xi[Pl.newState];Jg.PreviousState=xi[Pl.Xpg];Jg.PreviousStateHits=Pl.Ypg;Jg.PreviousStateTransitionTime=Pl.Zpg.toISOString();Jg.LastHttpStatus=this.iNc;Jg.LastSuccessTime=this.aIb.toISOString();this.sRc&&(Jg.LastRequestStartTime=this.sRc.toISOString());Jg.LastSavedRevisionID=this.zne.toString();Jg.LastSavedRevisionIdOrigin=this.EOc;Jg.LastSavedRevisionIdSetTime=this.C$e?
this.C$e.toISOString():null;Jg.IsViable=this.qf.wEa;Jg.IsNetworkConnected=this.qf.WC;Jg.IsExpired=this.qf.ada;Jg.HasEmergencyViewModeBeenDeployed=this.qf.zk;Jg["Navigator.Online"]=window.navigator.onLine;const Ln=Pl.elp;Ln&&bh.njj(Jg,Ln);Pl=Pl.newState;switch(Pl){case 13:w.ULS.sendTraceTag(5830086,bh.Jo,50,"{0}",Jg);break;case 1:w.ULS.sendTraceTag(5884125,bh.Jo,50,"{0}",Jg);break;case 0:w.ULS.sendTraceTag(5830087,bh.Jo,50,"{0}",Jg);break;case 2:w.ULS.sendTraceTag(5830088,bh.Jo,50,"{0}",Jg);break;
case 3:w.ULS.sendTraceTag(5830089,bh.Jo,50,"{0}",Jg);break;case 4:w.ULS.sendTraceTag(5884126,bh.Jo,50,"{0}",Jg);break;case 5:w.ULS.sendTraceTag(5884127,bh.Jo,50,"{0}",Jg);break;case 6:w.ULS.shipAssertTag(5830090,bh.Jo,!1,"{0}",Jg);break;case 7:w.ULS.shipAssertTag(5830091,bh.Jo,!1,"{0}",Jg);break;case 8:w.ULS.sendTraceTag(5830092,bh.Jo,15,"{0}",Jg);break;case 10:w.ULS.sendTraceTag(5830094,bh.Jo,15,"{0}",Jg);break;case 9:w.ULS.sendTraceTag(5884128,bh.Jo,50,"{0}",Jg);break;case 11:w.ULS.sendTraceTag(5830096,
bh.Jo,15,"{0}",Jg);break;case 17:w.ULS.sendTraceTag(37835678,bh.Jo,15,"{0}",Jg);break;case 12:w.ULS.sendTraceTag(5830095,bh.Jo,15,"{0}",Jg);break;case 18:w.ULS.sendTraceTag(38122832,bh.Jo,15,"{0}",Jg);break;case 19:w.ULS.sendTraceTag(38122833,bh.Jo,15,"{0}",Jg);break;case 21:w.ULS.sendTraceTag(0,bh.Jo,15,"{0}",Jg);break;case 14:w.ULS.sendTraceTag(6575508,bh.Jo,15,"{0}",Jg);break;case 15:w.ULS.sendTraceTag(36739287,bh.Jo,50,"{0}",Jg);break;case 16:w.ULS.sendTraceTag(36767649,bh.Jo,15,"{0}",Jg);break;
case 20:w.ULS.sendTraceTag(593510690,bh.Jo,15,"{0}",Jg);break;default:w.ULS.shipAssertTag(5884129,bh.Jo,!1,"Bad state:{0} logInfo:{1}",Pl,Jg)}};this.pdc=ea;this.fGb=Pa;this.nlb=ea;this.VPh=Bb;this.ETk=ac;this.v8e=ld;this.oSc=Gd;this.bbc=ue;this.Okh=Ce;this.rQe=tf;this.I3=Zg;this.zJ=Xi;this.N9b=ph;this.FIk=Dh;this.Q$b=qk;this.Pvh=Wn;this.zfa=wn;this.oD=hr;this.oRk=Ss;this.Nuh=fv;this.E4a=Fq.create(ir.isEnabled,ir.maxRetries,mt.kba);this.M9e=new vr.a;this.PKc=Tv;this.tD=new Ao.a(-1);this.qf=nt;this.tD.Ljf(this.tPo);
this.kOd=ev;this.aIb=hr();this.bsh=Sv;this.itk=ir.isEnabled?null:mt;this.TEb=rs;this.vNh=this.VPh;this.Y3e=Ci.a.nil;this.sa=new S.a;wa.a.instance.Za("Common.App.VisibilityManagement.IVisibilityManager").execute(Jg=>{this.Wk=Jg;this.Wk.Psa((Pl,Ln)=>{this.KT(Pl,Ln)});this.Z7e=Jg.pC});this.qf&&this.qf.zob((Jg,Pl)=>{this.yia(Jg,Pl)});this.B1e=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",Gc):Gc;this.NHh=m.AFrameworkApplication.J?
m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.fGb):this.fGb;this.lKh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("StopDocxSaveMonitorKickoutIsEnabled"):!0;this.IRk=ir}yia(ea,Pa){w.ULS.sendTraceTag(528577692,bh.Jo,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Bn.a[Pa.Xuc],Bn.a[Pa.aeb]);1!==Pa.aeb&&3!==Pa.aeb&&(w.ULS.sendTraceTag(528566343,bh.Jo,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",
this.E4a.Jcd(1),this.E4a.Jcd(2)),this.E4a.clear())}get L3d(){return this.uJc}get zne(){return this.Y3e}get XT(){const ea=!this.jtb()||this.zne.equals(this.jtb().id);ea||w.ULS.sendTraceTag(521413851,bh.Jo,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.jtb().id.toString(),this.zne.toString());return ea}get T3i(){return this.oD().getTime()-this.aIb.getTime()>this.B1e}get H_d(){return this.HX}get zWa(){return 3}get y_d(){let ea=null;qe.StaticActiveAppFrame.Aa()&&
qe.StaticActiveAppFrame.Aa().tb&&qe.StaticActiveAppFrame.Aa().tb.rd&&(ea=qe.StaticActiveAppFrame.Aa().tb.rd.Jg);return[ea,rb.a.w6]}KT(ea,Pa){var Bb,ac,Gc;ea={["VisibilityState"]:hl.a[this.Wk.pC],["IsVisible"]:this.Wk.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.L$b,["KickoutIntervalElapsed"]:this.T3i,["LastSuccessfulIterationTime"]:null!==(Bb=this.aIb)&&void 0!==Bb?Bb:"null",["RequestStartTime"]:null!==(ac=this.sRc)&&void 0!==ac?ac:"null",["SkippedKickouts"]:this.jQd,["LastSkippedKickoutAt"]:null!==
(Gc=this.Uxh)&&void 0!==Gc?Gc:"null"},["IsViable"]:this.qf.wEa,["IsNetworkConnected"]:this.qf.WC,["IsExpired"]:this.qf.ada,["HasEmergencyViewModeBeenDeployed"]:this.qf.zk,["Navigator.Online"]:window.navigator.onLine};w.ULS.sendTraceTag(539874775,bh.Jo,50,Xa.c(ea));this.Z7e!=this.Wk.pC&&(0==Pa.oldState||1==Pa.oldState||0!==Pa.newState&&1!==Pa.newState||this.WGa(this.NHh),0===this.Wk.pC?qf.c(Vg.a.Gll,void 0,void 0,void 0,void 0,void 0,ea):0===this.Z7e&&qf.c(Vg.a.Hll,void 0,void 0,void 0,void 0,void 0,
ea),this.Z7e=this.Wk.pC)}start(){this.uJc=this.Okh.Lqb(this.Mfm,this.nlb)}WGa(ea){if(!this.L3d||this.nlb===ea)return!1;const Pa=this.nlb;this.nlb=ea;this.stop("changing save monitor interval from "+Pa+"ms to "+ea+"ms");this.start();return!0}QAb(ea,Pa){if(Pa>=this.EOc&&ea&&!Ci.a.nil.equals(ea)){var Bb=!this.Y3e.equals(ea);this.EOc=Pa;this.Y3e=ea;const ac=this.oD();this.C$e=ac;const Gc=this.XT;Bb&&(Pa={["Id"]:ea.toString(),["IsUpToDate"]:Gc,["Origin"]:up[Pa]},this.n2e&&(Pa.LastUpToDateTime=this.n2e.toISOString()),
(Bb=this.ALf())&&Bb.UFa&&(ea=Bb.UFa.NTb(ea))&&(Pa.LastSavedCreationTime=ea.creationTime.toISOString()),w.ULS.sendTraceTag(557320151,bh.Jo,50,"Updating Last Saved Revision: {0}",Pa));Gc&&(this.n2e=ac)}else Pa<this.EOc?w.ULS.sendTraceTag(572051800,bh.Jo,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.EOc,Pa):w.ULS.sendTraceTag(572051801,bh.Jo,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Pa)}stop(ea){this.Kf(ea)}Kf(ea){this.L3d&&(w.ULS.sendTraceTag(5830084,bh.Jo,50,"Stopping DocxSaveMonitor because {0}!",
ea),this.Okh.Kf(this.L3d),this.uJc=0)}T0m(){if(0>=this.bbc)return!1;var ea=this.gJm();if(!ea)return this.O7e=null,this.cNd=0,this.dNd=!1;this.ZIb=ea.T6d;this.ZIb===this.O7e?this.cNd++:(this.O7e=this.ZIb,this.cNd=1,this.dNd=!1);if(this.cNd<bh.QUn)return!1;this.tPc=+this.oD()-+this.ZIb;if(this.tPc<=this.bbc)return!1;if(!this.dNd)return this.dNd=!0,this.ZDj(),!1;if(this.TEb)this.TEb.execute(Pa=>{Pa.flush(this,0)});else{ea="";try{this.PKc&&(ea=this.PKc())}catch(Pa){ea=Xa.c({["Kind"]:"Exception",["Stack"]:Pa.stack,
["Message"]:Pa.message,["FileName"]:Pa.fileName,["LineNumber"]:Pa.lineNumber}),w.ULS.sendTraceTag(50426817,bh.Jo,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",ea)}w.ULS.sendTraceTag(50426818,bh.Jo,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.ZIb.toISOString(),this.tPc,this.bbc,ea)}this.bbc=-1;this.stop("Exceeded oldest allowed local revision");this.XL(Ol.a.e3l);return!0}gJm(){let ea=
null,Pa=this.jtb();for(;Pa&&!Pa.Nva;)ea=Pa,Pa=Pa.dH;return ea}$yn(){return this.Q$b()?(this.tD.event(1),this.stop("session is lost"),!0):this.Pvh()?(this.tD.event(14),w.ULS.sendTraceTag(20029718,bh.Jo,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.XL(Ol.a.K3d),!0):!1}ALf(){const ea=this.N9b();return ea?ea.ed:null}jtb(){const ea=this.ALf();return ea?ea.Dn:null}FXc(ea){return this.IRk.isEnabled?this.E4a.FXc(ea):this.itk.Jcd(ea)&&!this.E4a.Jcd(ea)}Vom(ea){return ea?bh.Nsp:bh.fNj}rke(ea,
Pa,Bb){if(this.T3i)if(this.Wk&&!this.Wk.isVisible)w.ULS.sendTraceTag(540669727,bh.Jo,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.jQd+=1,this.Uxh=this.oD();else return this.tD.event(ea,{}),this.stop("request failed after kickout interval "+Bb),this.TEb&&this.TEb.execute(ac=>{ac.flush(this,2)}),this.XL(Pa),!0;return!1}q6f(ea,Pa){const Bb=ea.StatusCode;return 88===Bb||89===Bb||236===Bb?(Pa.KickoutDiagnostics=this.PKc(),88===Bb?(Pa.Result=
"deleted DSS session",this.tD.event(18,Pa),this.stop("deleted DSS session"),this.XL(Ol.a.o9f)):89===Bb?(Pa.Result="expired DSS session",this.tD.event(19,Pa),this.stop("expired DSS session"),this.XL(Ol.a.EXb)):(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(ea=tl.b(ea.LastSavedRevisionId),this.QAb(ea,4)),Pa.Result="DSS session not found",this.tD.event(21,Pa),this.stop("DSS session not found"),this.XL(Ol.a.sle)),
!0):14===Bb?(this.stop("DSS returned an unspecified failure"),this.XL(Ol.a.sJn),!0):104===Bb?(this.stop("this operation is disabled on the server"),!0):this.r6f("unrecognized OperationResult: "+Bb,Pa)}r6f(ea,Pa){if(!this.M9e.contains(ea))this.M9e.add(ea);else if(this.rke(11,Ol.a.IBf,ea))return Pa.ConsecutiveErrors=this.H_d,Pa.Reason=ea,w.ULS.sendTraceTag(41997899,bh.Jo,15,"DocxSaveMonitor kickout. {0}",Pa),!0;this.WGa(this.fGb);return!1}j2m(ea,Pa,Bb){let ac=!1;if(ea){const Gc=this.oD().getTime()-
ea.creationTime.getTime();Gc>=this.VPh&&(ac=!0,bh.njj(Pa,this.fPm(ea,Gc,Bb)),Gc>=this.B1e&&10===this.tD.currentState?(this.tD.event(11,Pa),this.stop("didn't save in time"),this.XL()):(this.tD.event(10,Pa),this.ZDj(),this.hIf()))}return ac}R7k(ea){this.sa.addHandler(bh.Wzj,ea)}r7k(ea){this.sa.addHandler(bh.oIf,ea)}MJj(ea){this.sa.removeHandler(bh.oIf,ea)}ZDj(){this.sa.raiseEvent(bh.Wzj)}WWa(ea){let Pa;return({group:Pa}=Ro.a.A6(ea)).returnValue?Pa.Responses[0]:null}fPm(ea,Pa,Bb){const ac={};ac.FirstUnsavedRevisionId=
ea.id.toString();ac.FirstUnsavedRevisionLengthToRoot=ea.jR;ac.UnsavedTimeInMs=Pa;ac.CurrentRevisionId=Bb.id.toString();ac.CurrentRevisionLengthToRoot=Bb.jR;return ac}hIf(){Sb.a.iIf(Fc.a.ZOj)}XL(ea=Ol.a.IBf){this.ETk?this.lKh?(w.ULS.sendTraceTag(509146274,bh.Jo,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",ea,this.hCi()),0==this.uJc&&this.start()):this.Wk&&!this.Wk.isVisible?(w.ULS.sendTraceTag(509146273,bh.Jo,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",
ea,this.hCi()),0==this.uJc&&this.start()):(this.stop(bh.cEn),ea===Ol.a.K3d?this.I3.value.XL(ea,Object.assign(new Jo.a,{jma:4,R0:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,p8:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.I3.value.XL(ea,new Jo.a)):w.ULS.sendTraceTag(19247383,bh.Jo,50,"Kickout disabled")}hCi(){const ea={};var Pa=wa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");ea.HasDataloss=!Pa.XT;ea.UnSavedRevisionsCount=Pa.p3a;ea.OldestUnsavedRevisionCreationTime=
Pa.XT?"":Pa.$lc().toString();ea.RevisionsWithOutServerRevisionSequenceNumbers=Pa.$hc();ea.RevisionsWithServerRevisionSequenceNumbers=Pa.H0d();ea.RSNManager_Diagnostics=Pa.hF();if(Pa=wa.a.instance?wa.a.instance.Wa("WordEditor.RunawayDataLossMonitor"):null)ea.RunawayDataLossMonitor_Diagnostics=Pa.IOj;ea.DocxSaveMonitor_Diagnostics=this.hF();(Pa=wa.a.instance?wa.a.instance.Wa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(ea.LastSavedToHostDetailsManager_Diagnostics=Pa.hF());this.Wk&&(ea.VisibilityState=
hl.a[this.Wk.pC]);return ea}hF(){const ea={};this.ZIb&&(ea.ORT=this.ZIb.toISOString());0<this.tPc&&(ea.AA=this.tPc);0<this.bbc&&(ea.MAA=this.bbc);0<this.jQd&&(ea.LSKO=this.Uxh.toISOString());this.tD&&0<=this.tD.currentState&&(ea.SMS=xi[this.tD.currentState]);const Pa={};m.AFrameworkApplication.uoa&&(Pa.S=1);Rg.a.FZ&&(Pa.LS=1);this.qf&&(this.qf.nq&&(Pa.KO=1),this.qf.ada&&(Pa.TE=1));this.Wk&&(Pa.VS=hl.a[this.Wk.pC]);window.navigator&&(Pa.NW=!window.navigator.onLine);ea.AMD=Pa;return ea}vBm(){const ea=
{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(ea["X-OfficeVersion"]=Fa.a.gR(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(ea["X-AccessToken"]=Fa.a.gR(m.AFrameworkApplication.accessToken),ea["X-AccessTokenTtl"]=m.AFrameworkApplication.Nla.toString());m.AFrameworkApplication.QO&&(ea["X-Key"]=Fa.a.gR(m.AFrameworkApplication.QO));m.AFrameworkApplication.userType&&(ea["X-UserType"]=Fa.a.gR(m.AFrameworkApplication.userType));
const Pa=m.AFrameworkApplication.pe.b3;Pa&&(ea["X-WacCluster"]=Fa.a.gR(Pa));m.AFrameworkApplication.userSessionId&&(ea["X-UserSessionId"]=Fa.a.gR(m.AFrameworkApplication.userSessionId));return ea}ijm(){var ea=this.qf?this.qf.networkState:null;if(1===ea||3===ea)w.ULS.sendTraceTag(558158790,bh.Jo,15,"Not sending request because we dont have network.");else if(ea=this.N9b()){var Pa=new Sys.Net.WebRequest;Pa.set_httpVerb("POST");Pa.set_url(bh.serviceUrl);var Bb={};Bb.body=eo.b(br.construct(ea));Bb.headers=
this.vBm();Bb.method=Pa.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Pa.getResolvedUrl(),Bb).then(ac=>{w.ULS.sendTraceTag(561551382,bh.Jo,50,"Request succeeded at the HTTP level {0}",ac.statusText);this.Pxh=ac.status;return ac.json()},ac=>{w.ULS.sendTraceTag(561551383,bh.Jo,15,"Request failed at the HTTP level {0}",ac);return null}).then(ac=>{ac=JSON.stringify(ac);this.Wvl(ac,this.Pxh);return ac},()=>{w.ULS.sendTraceTag(561551385,bh.Jo,15,"Request succeeded with null response data");
return""}):w.ULS.sendTraceTag(561002076,bh.Jo,15,"Browser does not support Fetch.")}catch(ac){w.ULS.sendTraceTag(561551386,bh.Jo,15,String.format("Exception when attempting to get last revision save id : {0}",ac))}}else w.ULS.sendTraceTag(540079457,bh.Jo,15,"Target node is null, not sending last saved revision request.")}Wvl(ea,Pa){let Bb=Ci.a.nil,ac=!1,Gc=-1;Pa===Vj.a.jB&&((ea=this.WWa(ea))?(Bb=tl.b(ea.LastSavedRevisionId),ea.StatusCode||(ac=!0,Gc=ea.StatusCode)):w.ULS.sendTraceTag(561002077,bh.Jo,
50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(bh.oIf,new kn(Bb,ac,Pa,Gc))}static njj(ea,Pa){for(const Bb in Pa)ea[Bb]=Pa[Bb]}ttn(){return Hf.SessionStatusManager.instance.nq}}bh.fNj=0;bh.serviceUrl=Rg.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";bh.cEn="kickout";bh.Wzj="PS";bh.oIf="FLSR";bh.Jo=343;bh.QUn=5;bh.Nsp=5E4;Object(f.a)(bh,"DocxSaveMonitor",null,[831,101]);class Dl{Lqb(ea,Pa){return window.setInterval(ea,Pa)}Kf(ea){window.clearInterval(ea)}}
Dl.instance=new Dl;Object(f.a)(Dl,"DocxSaveMonitorTaskManager",null,[829]);class cr{constructor(ea){this.q0=0;this.GAa=ea}start(ea){this.GAa&&(this.q0=ea,this.GAa.reset())}log(){if(this.GAa){var ea={};ea.RequstId=this.q0;ea.InvokeCount=this.GAa.nad;ea.InvokeFailedCount=this.GAa.oad;ea.NoOpenConnectionCount=this.GAa.ihd;ea.SynchronousNotificationCount=this.GAa.nud;ea.ResponseNotAvailable=this.GAa.gpd;w.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",ea)}}}Object(f.a)(cr,
"RequestLifeCycleTelemetryManager",null,[823]);class ul{constructor(){this.Z=this.y$e=null;this.fQl=()=>{var ea=m.AFrameworkApplication.J;if(!ea.$("DocxSaveMonitorEnabled"))return null;var Pa=ea.$("DocxSaveMonitorKickoutEnabled");const Bb=ea.sc("DocxSaveMonitorIntervalMs",6E4),ac=ea.sc("DocxSaveMonitorFailureIntervalMs",5E3),Gc=ea.sc("DocxSaveMonitorWarningTimeMs",12E4),ld=ea.sc("DocxSaveMonitorKickoutTimeMs",6E5),Gd=ea.sc("DocxSaveMonitorQueueTimeoutMs",6E4),ue=ea.sc("DocxSaveMonitorSentTimeoutMs",
12E4),Ce=ea.sc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var tf=ea.$("DocxSaveMonitorTelemetryInfoEnabled");const Zg=ea.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Xi=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),ph=ea.$("DocxSaveMonitorRawWebRequestsEnabled")||Xi;Xi=ea.$("ComponentStateLoggingPackageIsEnabled");ea=ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",
!1);var Dh=m.AFrameworkApplication.pe,qk=ph?new vm(m.AFrameworkApplication.userSessionId,Dh.b3,Dh.n2d):null;qk=new ef(Dh,qk,ph);tf=tf&&Dh&&!ph?new cr(Dh.GK):null;ph=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Dh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Wn=Fq.create(ph,Dh);Wn.rVc(1);
Wn.rVc(2);Xi=Xi?this.Z.Za("Common.IComponentStateLogManager"):null;Pa=new bh(Bb,ac,Gc,Pa,ld,Gd,ue,Ce,Dl.instance,qk,wa.a.instance.zf("Wonca.KickoutExecutor"),Sg.a.instance,this.znc,()=>!m.AFrameworkApplication.koe||Wg.a.instance.wad,()=>Rg.a.FZ,Object(P.a)(xj.a.instance,xj.a.instance.GKa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.isShuttingDown,()=>new Date,()=>new Date,tf,Zg,Wn,this.Umm,Xi,ea,wa.a.instance.Wa("Common.ISessionStatus")||Hf.SessionStatusManager.instance,{isEnabled:ph,
maxRetries:Dh});Pa.start();w.ULS.sendTraceTag(5884131,bh.Jo,50,"SaveMonitor initialized");return Pa};this.znc=()=>{const ea=qe.StaticActiveAppFrame.Aa().tb.Xc;return ea?ea.Fd:null};this.Umm=()=>{const ea={};m.AFrameworkApplication.zc&&(ea.TM=m.AFrameworkApplication.zc.hF());Zj.WoncaApp.TH&&(ea.RS=Zj.WoncaApp.TH.hF());rb.a.w6&&(ea.CRS=rb.a.w6.hF());qe.StaticActiveAppFrame.Aa()&&qe.StaticActiveAppFrame.Aa().tb&&qe.StaticActiveAppFrame.Aa().tb.rd&&qe.StaticActiveAppFrame.Aa().tb.rd.Jg&&(ea.GSR=qe.StaticActiveAppFrame.Aa().tb.rd.Jg.hF());
m.AFrameworkApplication.uoa&&(ea.S=1);Rg.a.FZ&&(ea.LS=1);df.a.Gd()&&df.a.Gd().MG.nq&&(ea.KO=1);ea.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(ea)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Rg.a.Wu||Rg.a.Yn)this.y$e=this.Z.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.y$e&&this.y$e.stop("WordEditorDocxSaveMonitorPackage is being disposed")}Ec(ea){this.Z=ea;(Rg.a.Wu||Rg.a.Yn)&&ea.ja("WordEditor.DocxSaveMonitor.DocxSaveMonitor",
this.fQl).as("Wonca.IDocxSaveMonitor").ha()}static main(){U.a.instance.Rc(new ul)}}Object(f.a)(ul,"WordEditorDocxSaveMonitorPackage",null,[0,1]);var oa=e(1040);class Za{constructor(ea,Pa){this.fp=ea;this.fUo=Object(oa.b)(Pa)}async loadChunk(ea){return this.fp.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(ea):(await this.fUo).JE.loadScript(ea)}}Object(f.a)(Za,"WordOnlineChunksLoader",null,[]);class xb{constructor(){this.name="WordEditor.EditorAi.Entry"}Ec(ea){ea.ja("WordEditor.EditorAi.WordOnlineChunksLoader",
()=>new Za(m.AFrameworkApplication.J,ea.Za("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){U.a.instance.Rc(new xb)}}Object(f.a)(xb,"EditorAiEntryPackage",null,[0,1]);var Zb;(function(ea){ea[ea.tMp=0]="version0";ea[ea.version1=1]="version1"})(Zb||(Zb={}));Object(f.b)("FirstRunExperienceVersion",Zb);class sc{get flf(){return"Word"}get Y3h(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Zb.tMp}get currentVersion(){return Zb.version1}get Mon(){return sc.isEnabled()&&
m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Urc(){return sc.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get B8i(){return m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceTestIsEnabled")}get $gm(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Mjj(){return 24}get TNj(){return 4E3}get Dpd(){return""}static isEnabled(){const ea=m.AFrameworkApplication.sessionStartInfoSettings?
m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==ea&&"Automation"!==ea}}Object(f.a)(sc,"FirstRunExperienceLauncherSettings",null,[981]);class $c{constructor(ea){this.Enh=ea}hep(ea){void 0==m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",void 0)&&this.Enh&&this.Enh.iep(ea)}}Object(f.a)($c,"FirstRunExperienceManager",null,[855]);class Ed{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}Ec(ea){this.Z=
ea;this.Z.ja("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new $c(this.Z.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const ea=this.Z.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");ea&&ea.hep(new sc)}dispose(){}}Object(f.a)(Ed,"WordEditorFirstRunExperiencePackageManager",null,[0,1]);class Ud{constructor(ea,Pa){this.uQa=(Bb,ac,Gc,ld,Gd)=>{var ue,Ce;if(1===Gc)return Gd=null===(Ce=null===(ue=ac.view.ub)||void 0===ue?
void 0:ue.ob)||void 0===Ce?void 0:Ce.currentSelection,(null===Gd||void 0===Gd?0:Gd.GN)||Bb===Vg.a.Ksd&&(null===Gd||void 0===Gd?0:Gd.AZa)?32:8;if(2===Gc){ue=this.dlb.pk.isVisible;this.dlb.dC(!0,1===Gd);Ce=0;switch(Bb){case Vg.a.d_j:Gd=1;break;case Vg.a.e_j:Gd=2;break;case Vg.a.$Ce:Gd=2;Ce=1;break;case Vg.a.aDe:Gd=1;Ce=2;break;case Vg.a.Ksd:Gd=1;Ce=3;break;case Vg.a.EGe:Gd=this.dlb.Jic;break;default:Ce=Gd=0}ue&&Bb===Vg.a.uQa||this.dlb.X0o(Gd,Ce);return 32}return 8};this.Hde=(Bb,ac,Gc,ld,Gd)=>{this.toggleButton(Gd,
!1);return this.aAl(Gc)};this.EGe=(Bb,ac,Gc,ld,Gd)=>this.dlb.pk.isVisible?this.Hde(Bb,ac,Gc,ld,Gd):this.uQa(Bb,ac,Gc,ld,Gd);this.ga=ea;this.dlb=Pa}dispose(){this.dlb&&this.dlb.dispose()}mc(){this.ga.qa(Vg.a.EGe,ii.a.view,this.EGe);this.ga.nb(Vg.a.uQa,ii.a.view,this.uQa,4);this.ga.qa(Vg.a.Hde,ii.a.view,this.Hde);this.ga.nb(Vg.a.$Ce,ii.a.view,this.uQa,4);this.ga.qa(Vg.a.aDe,ii.a.view,this.uQa);this.ga.qa(Vg.a.Ksd,ii.a.view,this.uQa)}aAl(ea){if(1===ea)return 32;this.dlb.dC(!1);return 32}toggleButton(ea,
Pa){ea&&(ea[Ae.a.On]=Pa)}}Object(f.a)(Ud,"FormatPictureActor",null,[11]);class Vd{constructor(ea){this.ALb=!1;this.pk=ea}get Jic(){return this.pk.LSl}X0o(ea,Pa){switch(ea){case 0:case 1:this.pk.lfp(Pa);break;case 2:this.pk.wfp(Pa)}}dC(ea,Pa=!1){this.ALb||this.HYf();ea?this.pk.sU(Pa):this.pk.$ua()}dispose(){this.pk.dispose()}HYf(){this.ALb||(this.pk.initialize(),this.ALb=!0)}}Object(f.a)(Vd,"FormatPictureManager",null,[822,11]);var Ie=e(323),Ue=e(156),dg=e(165);class Pf{}Pf.zU=dg.a.M7d;Pf.fwc=1;Pf.gwc=
WacWordeditorStrings.FormatPicture;Pf.rCa="FormatPictureTaskPaneData";Object(f.a)(Pf,"FormatPicturePaneConstants",null,[]);class pc{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(pc,"FormatPictureTaskPaneProps",
null,[]);class yi{constructor(ea,Pa,Bb,ac){this.N$e=0;this.WIc=this.Esa=null;this.JOd=this.COd=this.CJd=this.zAd=this.bSd=0;this.Vw=this.I8b=!1;this.VRe=0;this.y$n=()=>{this.FTj()};this.qo=()=>{let Gc=!1;Gc=this.fso()||Gc;Gc=this.kfb()||Gc;Gc=this.jfb()||Gc;Gc=this.ixc()||Gc;(Gc=this.bso()||Gc)&&this.ao()};this.qY=ea;this.mJk=Pa;this.w2e=Bb;this.xh=ac}initialize(){this.CY();this.qea()}get isVisible(){return this.Vw}sU(ea){this.Ssd(ea)}$ua(){this.qja();this.U6m()}lfp(ea){this.KVj(ea,1)}wfp(ea){this.KVj(ea,
2)}KVj(ea,Pa){this.VRe=Pa;this.N$e=ea}get LSl(){return this.VRe}dispose(){}CY(){this.qY.iLa();this.N$e=this.VRe=0}get focusManager(){return this.mJk.value}get Tb(){return this.w2e.value}ddb(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===Pf.zU}FTj(){this.focusManager.Rg(Pf.zU)}qea(){const ea=this.focusManager.te(Pf.zU);ea.parent=th.AFrame.rr;ea.Rla(this.y$n)}qja(){this.ddb()&&this.focusManager.Rg(this.focusManager.NY)}Ssd(ea){lm.UISurfaces.aw().then(Pa=>{Pa.showTaskPane(Pf.zU,
this.AB(ea));this.isVisible&&ea&&this.focusManager.Rg(Pf.zU);return null})}ao(){lm.UISurfaces.aw().then(ea=>{ea.updateTaskPane(Pf.zU,this.AB(!1));return null})}U6m(){lm.UISurfaces.aw().then(ea=>{ea.hideTaskPane(Pf.zU,2);return null})}AB(){const ea=new pc;this.p8o(ea);return Object.assign(new Wi.a,{title:Pf.gwc,hideHeader:!1,width:320,location:2,contentProps:ea,onOpen:Pa=>{this.Vw=!0;qe.StaticActiveAppFrame.Aa().GVa(this.qo);qe.StaticActiveAppFrame.Aa().Ne();this.FTj();this.xh.hVc(Pf.zU,Pa)},onClose:()=>
{this.qja();this.Vw=!1;qe.StaticActiveAppFrame.Aa().cyc(this.qo);qe.StaticActiveAppFrame.Aa().Ne()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}p8o(ea){const Pa=G.e().numberFormatInfo;ea.section=this.N$e;ea.numberFormatInfo="object"===typeof Pa?Pa:null;ea.title=this.Esa;ea.description=this.WIc;ea.topCrop=this.bSd;ea.bottomCrop=this.zAd;ea.leftCrop=this.CJd;ea.rightCrop=this.COd;ea.rotationAngle=this.JOd;ea.onTitleChange=this.onTitleChange();ea.onDescriptionChange=this.onDescriptionChange();
ea.onCropSpinButtonChange=this.onCropSpinButtonChange();ea.onRotationSpinButtonChange=this.onRotationSpinButtonChange();ea.disabled=this.I8b}onTitleChange(){return ea=>{if(ea!==this.Esa){this.Esa=ea;var Pa=new Ie.DictionaryPropertySet;Pa.setValue(Ue.a.Lub,ea);this.Tb.Zb(pe.a.grd,2,Pa);this.ao()}}}onDescriptionChange(){return ea=>{if(ea!==this.WIc){var Pa=new Ie.DictionaryPropertySet;Pa.setValue(Ue.a.P1,ea);this.WIc=ea;this.Tb.Zb(pe.a.d2b,2,Pa);this.ao()}}}onCropSpinButtonChange(){return(ea,Pa)=>{const Bb=
new Ie.DictionaryPropertySet;switch(Pa){case 0:this.bSd=ea;Bb.setValue(Ue.a.Qub,ea);this.Tb.Zb(Vg.a.S9c,2,Bb);break;case 1:this.zAd=ea;Bb.setValue(Ue.a.Nub,ea);this.Tb.Zb(Vg.a.P9c,2,Bb);break;case 2:this.CJd=ea;Bb.setValue(Ue.a.Oub,ea);this.Tb.Zb(Vg.a.Q9c,2,Bb);break;case 3:this.COd=ea,Bb.setValue(Ue.a.Pub,ea),this.Tb.Zb(Vg.a.R9c,2,Bb)}this.ao()}}onRotationSpinButtonChange(){return ea=>{this.JOd=ea;const Pa=new Ie.DictionaryPropertySet;Pa.setValue(Ue.a.Z9c,0);Pa.setValue(Ue.a.mZ,ea);this.Tb.Zb(pe.a.k9,
2,Pa);this.ao()}}fso(){const ea=2===this.Tb.Zb(pe.a.grd,1,null),Pa=ea!==this.I8b;this.I8b=ea;return Pa}kfb(){var ea=new Ie.DictionaryPropertySet;this.Tb.Zb(pe.a.kfb,2,ea);ea=ea.ka(Ue.a.Lub,"");const Pa=ea!==this.Esa;this.Esa=ea;return Pa}jfb(){var ea=new Ie.DictionaryPropertySet;this.Tb.Zb(pe.a.jfb,2,ea);ea=ea.ka(Ue.a.P1,"");const Pa=ea!==this.WIc;this.WIc=ea;return Pa}ixc(){var ea=new Ie.DictionaryPropertySet;this.Tb.Zb(Vg.a.Xld,2,ea);const Pa=ea.ka(Ue.a.Qub,0),Bb=ea.ka(Ue.a.Nub,0),ac=ea.ka(Ue.a.Oub,
0);ea=ea.ka(Ue.a.Pub,0);const Gc=Pa!==this.bSd||Bb!==this.zAd||ac!==this.CJd||ea!==this.COd;this.bSd=Pa;this.zAd=Bb;this.CJd=ac;this.COd=ea;return Gc}bso(){var ea=new Ie.DictionaryPropertySet;this.Tb.Zb(pe.a.U_b,2,ea);ea=ea.ka(Ue.a.mZ,0);const Pa=ea!==this.JOd;this.JOd=ea;return Pa}}Object(f.a)(yi,"ReactFormatPicturePane",null,[821,11]);class Ei{constructor(){this.dFd=this.Z=null}get name(){return"WordEditor.FormatPicture"}Ec(ea){this.Z=ea;this.Z.ja("WordEditor.FormatPicture.IFormatPictureManager",
()=>new Vd(this.Z.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.Z.ja("WordEditor.FormatPicture.IFormatPicturePane",()=>new yi(tp.a.instance,new zc.a(()=>zf.FocusManager.instance()),new zc.a(()=>m.AFrameworkApplication.va),je.a.instance)).ha();this.Z.ja("WordEditor.FormatPicture.FormatPictureActor",()=>new Ud(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(rb.a.BSg||rb.a.Qhk)this.dFd=this.Z.resolve("WordEditor.FormatPicture.FormatPictureActor"),
this.dFd.mc(),qe.StaticActiveAppFrame.Aa().Ne()}dispose(){this.dFd&&this.dFd.dispose()}static main(){U.a.instance.Rc(new Ei)}}Object(f.a)(Ei,"WordEditorFormatPicturePackage",null,[0,1]);var ok=e(1370),ji=e(582),hk=e(1180);class Sl extends Io.a{constructor(){super();this.Prompt=0;this.FileId=null}Hn(){return Rl.a.GZm}static construct(ea,Pa){const Bb=new Sl;Bb.FileId=ea;Bb.Prompt=Pa;return Bb}}Object(f.a)(Sl,"GraphMergeConsentChangedRequest",Io.a,[]);var Ko=e(527);class cm extends Ko.a{constructor(){super();
this.Location=this.FileId=null}Hn(){return Rl.a.Hjo}static construct(ea,Pa){const Bb=new cm;Bb.FileId=ea;Bb.Location=Pa;return Bb}}Object(f.a)(cm,"PlayGraphMergeReplayRequest",Ko.a,[]);class Lo{constructor(ea,Pa,Bb,ac,Gc,ld=null,Gd=null){this.Vm=!1;this.mTa=null;this.pJh=this.c1e=!1;this.Ztf=()=>{if(this.AHa.nde)this.c1e=!0;else if(this.c1e=!1,!this.aYo){this.pJh=!0;var ue=this.oSa.vFa;w.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",ue===hk.a.$tf);if(ue===hk.a.nZc||ue===hk.a.$tf)ue=
Sl.construct(this.ZU(),ue),this.iu(ue)}};this.CRi=(ue,Ce)=>{Ce&&Ce.ybg&&Ce.ybg.jwf&&!this.AHa.isThrottled&&(this.AHa.Hak(),this.AHa.nde=!0,this.iu(Ce.ybg.jwf))};this.ARi=(ue,Ce)=>{Ce&&Ce.Exd&&this.AHa.Hak()};this.BRi=(ue,Ce)=>{Ce&&(Ce.ShowMergePrompt&&this.oSa.HLj(this.Ztf),m.AFrameworkApplication.Kg&&(m.AFrameworkApplication.Kg.SessionMergeInfo|=Ce.PartMergeInfo))};this.ZU=ea;this.uTd=Bb;this.AHa=ac;this.oSa=Gc;this.uTd&&this.uTd.w7k(this.CRi);this.zJ=ld||Sg.a.instance;if(!Gd){const ue=new ji.a;
Gd=Ce=>ue.Bca(0,Ce)}this.Suk=Gd}get iCn(){return this.c1e}get aYo(){return this.pJh}iu(ea){const Pa=new Tj.a;Pa.Ls=ea;Pa.status=oh.a.xK;Pa.MH="GraphMerge";const Bb=this.Suk(()=>{this.fpd(Pa,ea.Hn()===Rl.a.sei)});Bb.yI(Pa);Bb.h1()}fpd(ea,Pa){this.Vm||(Pa&&(this.AHa.nde=!1),2===ea.statusCode&&!za.a.bWb(ea.rl)&&1===ea.rl.length&&ea.rl[0]?(ea=ea.rl[0],ea.StatusCode?this.AHa.IDg():Pa&&this.oSa.HLj(this.Ztf),this.zJ.r3a(ea),this.iCn&&this.Ztf()):this.AHa.IDg())}kid(ea){this.mTa=ea;this.mTa.dfc(this.ARi);
this.mTa.SMb(this.BRi)}dispose(){this.Vm||(this.uTd&&this.uTd.UIo(this.CRi),this.mTa&&(this.mTa.nod(this.ARi),this.mTa.byc(this.BRi)),this.Vm=!0)}}Object(f.a)(Lo,"GraphMergeBackupManager",null,[852,11]);class nm{constructor(ea,Pa=null,Bb=null,ac=null){this.AOe=0;this.W_e=!1;this.$wh=new Date(0);this.nde=!1;this.oSa=ea;this.oD=Pa||(()=>new Date);Bb||(Bb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.sc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.cLk=Bb;ac||(ac=m.AFrameworkApplication.J?
m.AFrameworkApplication.J.sc("WordEditorGraphMergeMaxBackups",1):1);this.Mzh=ac}get OAn(){return+this.oD()-+this.$wh<this.cLk}get isThrottled(){return this.oSa.vFa===hk.a.automatic?!1:this.oSa.vFa===hk.a.nZc?!0:this.W_e||this.nde||this.OAn}Hak(){this.$wh=this.oD();this.AOe++;this.AOe>=this.Mzh&&this.IDg()}IDg(){this.W_e||(this.W_e=!0,w.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.AOe,this.Mzh))}}Object(f.a)(nm,"GraphMergeBackupThrottler",
null,[851]);class pq{constructor(ea,Pa,Bb=null){this.Pph=!1;this.maa=ea;this.rBk=Pa;null==Bb&&(Bb=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WordEditorGraphMergeBypassConsentPrompt"));this.f8e=Bb?hk.a.automatic:hk.a.Lue}get vFa(){return this.f8e}HLj(ea){if(!this.Pph&&this.vFa===hk.a.Lue){var Pa=this.rBk.value;Pa&&Pa.isFeatureEnabled(45)&&(this.Pph=!0,this.maa.execute(Bb=>{Bb.uep(()=>{this.XEl(ea)},()=>{this.nZc(ea)})}))}}nZc(ea){this.vFa===hk.a.Lue&&(w.ULS.sendTraceTag(42333270,300,
50,"Consent denied for investigating merge failures."),this.f8e=hk.a.nZc,ea());this.fIj()}XEl(ea){this.vFa===hk.a.Lue&&(w.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.f8e=hk.a.$tf,ea());this.fIj()}fIj(){this.maa.execute(ea=>{ea.R6m()})}}Object(f.a)(pq,"GraphMergeCollectionConsentManager",null,[850]);class vl extends Sys.EventArgs{constructor(ea){super();this.ybg=ea}}Object(f.a)(vl,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Gk=e(907),vi=e(1059),
so=e(631),Zp;(function(ea){ea[ea.none=0]="none";ea[ea.fk=1]="failure";ea[ea.dCa=2]="crash";ea[ea.success=3]="success"})(Zp||(Zp={}));Object(f.b)("GraphMergeReplayReason",Zp);var El=e(1782),Lm=e(1779),Nk=e(61),wl=e(231),ln=e(185);class wr{constructor(ea,Pa,Bb,ac,Gc,ld){this.mrg=this.mh=null;this.cdd=this.hSg=!1;this.Fm=null;this.Bsd=ea.runtime.Bsd;this.kv=ea;this.xf=Pa;this.Ah=Bb;this.np=ac;this.KEl=Gc;this.zQi=ld}}Object(f.a)(wr,"GraphNodeComplexMergeState",null,[]);var un=e(1481),Rr=e(1458);class dr{constructor(ea,
Pa=null){this.Ng=ea;this.Jac=Pa||this.F6c()}get Dxb(){return this.Jac}get xf(){return this.Ng}F6c(){return[Object(P.a)(this,this.Zgp,"simpleMerge"),Object(P.a)(this,this.SDl,"complexMerge")]}w8o(ea,Pa,Bb,ac,Gc,ld){Pa=new wr(ea,Bb,new zc.a(()=>new un.a(ac?ac.rn:null,Gc)),new zc.a(()=>new un.a(ac?ac.rn:null,ld)),new zc.a(()=>new un.a(ld,Gc)),Pa.tei(Gc,()=>ea.runtime.Dc));Pa.mh=ac.Ndc;Pa.mrg=new wl.a;return Pa}merge(ea,Pa,Bb,ac,Gc,ld){Pa=this.w8o(ea,Pa,Bb,ac,Gc,ld);Bb=!0;for(ac=0;ac<this.Dxb.length&&
Bb;ac++)(Bb=(0,this.Dxb[ac])(Pa))||ea.logger.Ole("GraphNodeMerge.GetMergeFunctions()",ac);if(ea=Pa.cdd&&Pa.Fm?new Rr.a(Pa.Fm,!1):null)switch(ea.M6o(Pa.mh),(ea?ea.rn:Gc).yc){case Nk.a.je:Pa.kv.runtime.Nwe.hGl.W(ea.rn.id,ea.rn);break;case Nk.a.ipb:Pa.kv.runtime.Nwe.qkl.W(ea.rn.id,ea.rn);break;case Nk.a.vL:Pa.kv.runtime.Nwe.PCl.W(ea.rn.id,ea.rn);break;case Nk.a.paragraphNode:Pa.kv.runtime.hne.add(ea.rn.id)}return{returnValue:Pa.cdd,Fm:ea}}Zgp(ea){if(ea.kv.runtime.Dc&&ea.kv.runtime.Dc.TTb(1000005)&&0<
ea.mh.count)return!0;var Pa=ea.zQi.Tue;return ea.np.value.Yad(Pa)&&ea.KEl.value.Yad(Pa)?ea.Ah.value.Yad(Pa)?!0:(Pa=ea.np.value.Xf,ea.cdd=!0,ea.Fm=Pa.KQ(),!1):(ea.cdd=!0,!1)}SDl(ea){const Pa=ea.np.value.Xf;ea.Bsd&&ln.a.instance.fb(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Pa.id,Pa.yc);const Bb=ea.zQi.XNg(ea);ea.cdd=Bb;ln.a.instance.fb(4018184,1,Bb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",Bb?"Succeeded":"Failed",Pa.id,Pa.yc,!!ea.Fm);
return Bb}}Object(f.a)(dr,"GraphNodeMerge",null,[837]);var qq;(function(ea){ea[ea.none=0]="none";ea[ea.Z3p=1]="crashesOnly";ea[ea.irq=2]="rejectionsAndCrashes";ea[ea.R_p=3]="allMerges"})(qq||(qq={}));Object(f.b)("GraphMergeBackupCases",qq);var Yh=e(1331),ek=e(1280);class Ok extends Io.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=Yh.a.none;this.RequestId=this.ObjectSpaceId=
null;this.Source=ek.a.none;this.Reason=Zp.none;this.Prompt=0}Hn(){return Rl.a.sei}static construct(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg){const Xi=new Ok;Xi.FileId=ea;Xi.BaseRevisions=Pa;Xi.TheirRevisions=Bb;Xi.YourRevisions=ac;Xi.IgnoreConflictsInLastServerRevision=Gc;Xi.MergeHint=ld;Xi.ObjectSpaceId=Gd?tl.a(Gd):null;Xi.RequestId=ue?tl.a(ue):null;Xi.Source=Ce;Xi.Reason=tf;Xi.Prompt=Zg;return Xi}}Object(f.a)(Ok,"CreateGraphMergeReplayRequest",Io.a,[]);var Fi=e(833),ls=e(247),Wm=e(13),Fs=e(1924),Gq=e(2005);
class Hq{constructor(ea,Pa=null,Bb=null){this.X1l=(ac,Gc)=>{let ld=ac;var Gd=Gc,ue=this.Xlb.get(ac);if(!ue)return{RPa:ld,g1b:Gd};Gd=new wl.a;Gd.add(ue);var Ce=this.GIb.get(ac)||this.tJ.K(ac);ue=new wl.a;ue.add(Ce);Ce=new wl.a;Ce.add(this.tJ.K(ac));w.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.iL.xTf,this.iL.Ooa,this.PGi(ue),this.PGi(Gd));var tf=this.lHi(this.iL.Ooa);this.wgm(tf,ac,Gd);ue=new Fs.a(tf,
Ce,tf.input.Ooa===Yh.a.HEc?ue:Gd,tf.input.Ooa===Yh.a.HEc?Gd:ue,this.lHi(Yh.a.HEc),ue,Gd);Gd=new wl.a;for(Ce=0;Ce<Gc.length;Ce++){this.iL.IK("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Zg=({Nfb:ld,rxa:tf}=ue.owd(ac,Gc.K(Ce))).returnValue;Gd.add(tf);Zg?w.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",ac,Gc.K(Ce),ld,tf):w.ULS.sendTraceTag(4339677,
318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",ac)}return{RPa:ld,g1b:Gd}};this.iL=ea;this.tJ=ea.Ao;this.Xlb=ea.Nrp;this.GIb=ea.GSp;this.ZJk=ea.rJn;this.Ng=Pa||new vi.a;this.GOk=Bb||this.X1l}r1c(ea){const Pa=new wl.a;for(let Bb=0;Bb<ea.length;Bb++){const ac=this.P1l(ea.K(Bb));Pa.add(ac)}return Pa}q1c(ea,Pa,Bb){const ac=ea.ow===ea.EB&&ea.startCp===ea.endCp;Pa&&({RPa:ea.ow,rxa:ea.startCp}=this.u3a(ea.ow,ea.startCp,ea.ow),
ac&&(ea.EB=ea.ow,ea.endCp=ea.startCp));Bb&&!ac&&({RPa:ea.EB,rxa:ea.endCp}=this.u3a(ea.EB,ea.endCp,ea.EB));return ea}P1l(ea){if(ea.ow===ea.EB){var Pa=new wl.a;Pa.add(ea.startCp);Pa.add(ea.endCp);({RPa:ea,g1b:Pa}=this.hQg(ea.ow,Pa));return new Fi.a(ea,Pa.K(0),ea,Pa.K(1))}Pa=new wl.a;var Bb=new wl.a;let ac;Pa.add(ea.startCp);({RPa:Pa,g1b:ac}=this.hQg(ea.ow,Pa));Bb.add(ea.endCp);({RPa:ea,g1b:Bb}=this.hQg(ea.EB,Bb));return new Fi.a(Pa,ac.K(0),ea,Bb.K(0))}hQg(ea,Pa){let Bb=ea,ac=Pa;if(!this.tJ.K(ea))return w.ULS.sendTraceTag(4339675,
318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",ea),{RPa:Bb,g1b:ac};if(this.Xlb.get(ea))({RPa:Bb,g1b:ac}=this.GOk(ea,Pa,Bb,ac));else if(this.iL.SXf&&!this.iL.SXf.K(this.iL.SXf.length-1).p5(ea)){ac=new wl.a;for(let Gc=0;Gc<Pa.length;Gc++){let ld;({RPa:Bb,rxa:ld}=this.u3a(ea,Pa.K(Gc),Bb));ac.add(ld)}}return{RPa:Bb,g1b:ac}}PGi(ea){let Pa="";ea.forEach(Bb=>{Pa+=Bb.OCc();Pa+=" ";return!0});return Pa}lHi(ea){const Pa=wa.a.instance.Wa("Box4.IFeatureHelper"),
Bb=new Gq.a;Bb.input.source=this.iL.xTf;Bb.input.Ooa=this.iL.Ooa;Bb.input.f3c=()=>Pa;Bb.runtime.Ao=this.tJ;Bb.runtime.RKa=this.iL.sDl;ea===Yh.a.HEc?(Bb.runtime.BC=this.GIb,Bb.runtime.Pw=this.Xlb,Bb.runtime.X5d=this.iL.N$i,Bb.runtime.XHe=this.iL.haj):ea===Yh.a.gGe&&(Bb.runtime.BC=this.Xlb,Bb.runtime.Pw=this.GIb,Bb.runtime.X5d=this.iL.haj,Bb.runtime.XHe=this.iL.N$i);Bb.runtime.Dc=Pa;return Bb}wgm(ea,Pa,Bb){if(ea.runtime.BC.Bb(ls.a.NP)){var ac=ea.runtime.BC.K(ls.a.NP);ac=this.Ng.getPropertyObjectIds(ac,
Cg.a.t_);if(1===ac.length&&(ac=ac.K(0),ea.runtime.BC.Bb(ac)&&(ac=ea.runtime.BC.K(ac),3===this.Ng.getPropertyInt32(ac,Cg.a.TCb)))){const Gc=this.Ng.getPropertyString(ac,Cg.a.sqa),ld=this.Ng.getPropertyString(ac,Cg.a.S4b);Pa.toString()===Gc&&Gc===ld&&(Pa=this.Ng.getPropertyObjectId(ac,Cg.a.uwd),ea.runtime.BC.Bb(Pa)&&Bb.add(ea.runtime.BC.K(Pa)))}}}UKm(ea,Pa){let Bb=0;for(let ac=0;ac<ea.length;ac++)if(Pa.equals(ea.K(ac)))return Bb=ac,{returnValue:!0,idx:Bb};return{returnValue:!1,idx:Bb}}u3a(ea,Pa){const Bb=
this.ZJk&&!!this.GIb.K(ea)&&!this.tJ.K(ea);let ac=ea,Gc=Pa,ld=!1,Gd=!1;(Bb?this.GIb:this.Xlb).forEach((ue,Ce)=>{this.iL.IK("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.j3f(Ce.yc)&&this.tJ.K(ue)){Ce=null;if(Bb){Ce=this.b7c(Zg=>this.GIb.K(Zg)||this.tJ.K(Zg),ue);var tf=this.wie(Ce,ea)}else tf=this.b7c(Zg=>this.tJ.K(Zg),ue),tf=this.wie(tf,ea);if(tf&&(Gd=!0,Ce||(Ce=this.b7c(Zg=>this.GIb.K(Zg)||this.tJ.K(Zg),ue)),ue=this.b7c(Zg=>this.Xlb.K(Zg)||this.tJ.K(Zg),ue),
tf=0,({idx:tf}=this.UKm(Ce,ea)).returnValue)){for(let Zg=tf+1;Zg<Ce.length;Zg++)if(this.wie(ue,Ce.K(Zg)))return Gc=0,ac=Ce.K(Zg),ld=!0,!1;for(--tf;0<=tf;tf--)if(this.wie(ue,Ce.K(tf)))return Gc=Number.MAX_VALUE,ac=Ce.K(tf),ld=!0,!1}}return!0});ld||(w.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",ea,Pa,Bb,Gd),this.iL.xTf===ek.a.undo&&(w.ULS.sendTraceTag(17340240,
318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",ac),({nui:Pa}=this.zzm()).returnValue?(ac=Pa,Gc=0,w.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",ac)):w.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",
ac)));return{RPa:ac,rxa:Gc}}zzm(){let ea=Ci.a.nil,Pa=new wl.a;this.Xlb.forEach((Bb,ac)=>{this.iL.IK("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.j3f(ac.yc)?(Pa=this.b7c(Gc=>this.Xlb.K(Gc)||this.tJ.K(Gc),Bb),!1):!0});return 0<Pa.length?(ea=Pa.K(0),{returnValue:!0,nui:ea}):{returnValue:!1,nui:ea}}j3f(ea){return ea===Nk.a.hFa||ea===Nk.a.Fq||ea===Nk.a.fqa||ea===Nk.a.Bea}b7c(ea,Pa){var Bb=ea(Pa);Pa=new wl.a;if(!this.j3f(Bb.yc))return Pa;Bb=this.Ng.getPropertyObjectIds(Bb,
Wm.a.Fg);for(let ac=0;ac<Bb.length;ac++){const Gc=new wl.a;this.FPf(ea,Bb.K(ac),Gc);Pa.PC(Pa.length,Gc)}return Pa}FPf(ea,Pa,Bb){var ac=ea(Pa);if(ac)if(ac.yc===Nk.a.paragraphNode)Bb.add(Pa);else if(ac.yc===Nk.a.MZ)Pa=this.Ng.getPropertyObjectIds(ac,Wm.a.FI).Lg(0),this.FPf(ea,Pa,Bb);else if(ac.yc===Nk.a.Fq||ac.yc===Nk.a.fqa||ac.yc===Nk.a.Bea)for(Pa=this.Ng.getPropertyObjectIds(ac,Wm.a.Fg),ac=0;ac<Pa.length;ac++)this.FPf(ea,Pa.K(ac),Bb)}wie(ea,Pa){for(let Bb=0;Bb<ea.length;Bb++)if(Pa.equals(ea.K(Bb)))return!0;
return!1}}Object(f.a)(Hq,"GraphMergeSelectionRecordUpdater",null,[]);var rj=e(660),om=e(301);class Iq extends El.a{constructor(ea=null,Pa=null,Bb=null,ac=null,Gc=null,ld=null,Gd=null,ue=null,Ce=null,tf=null,Zg=null){var Xi;super();this.Ufi=ph=>{const Dh=ph.rL,qk=qe.StaticActiveAppFrame.Aa().tb.rd;return Object(rj.b)({oE:ph,ko:Dh,fileId:qk.fileId,Yia:qk.Yia,contextId:qk.contextId,G5d:Dh?Dh.id:Ci.a.nil,Rfb:this.Rfb,Ahe:!1,Mee:!0,cellId:qk.ed.id},!0,qk.ed.store)};this.ZU=ea||(()=>m.AFrameworkApplication.rootQuerySignature);
Pa||(Pa=ph=>new Gk.a(ph));this.THh=Pa;this.Ng=Bb||new vi.a;this.pgh=Gd||new Lm.ChildNodeListMerge(this.xf);this.$bc=ue;this.Rfb||(this.$bc=(ph,Dh,qk)=>new so.a(ph,Dh,qk));this.Jac=ac||this.F6c();this.Okb=Gc||new xh.a;this.vph=ld||new dr(this.xf);this.Uzh=(null===(Xi=m.AFrameworkApplication.J)||void 0===Xi?void 0:Xi.sc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.AHa=Ce;this.oSa=tf;this.zce=this.VYl(Zg);this.Vmh=()=>wa.a.instance.Wa("Box4.IFeatureHelper")}VYl(ea){ea||(ea=qq.none,ea=m.AFrameworkApplication.J?
m.AFrameworkApplication.J.sc("WordEditorGraphMergeBackupCasesBrowser",ea):ea);return ea}AMa(){return(new Date).getTime()}x3j(ea,...Pa){return String.format.apply(null,[ea].concat(Pa))}jsp(ea){throw Gp.a.invalidOperation(ea);}D9d(ea){return String.format("Name: {0}, Message: {1}, Stack: {2}",ea.name,ea.message,ea.stack)}tmo(ea){if(this.AHa&&this.AHa.isThrottled||!this.Enp(ea))return null;this.vMn(ea);let Pa;({Gil:ac,Mrp:Gc,FSp:Pa}=this.oQl(ea,this.Ufi));const Bb=El.a.SAm(ea);var ac=Ok.construct(this.ZU(),
ac.JGa(),Gc.JGa(),Pa.JGa(),ea.input.GUb,ea.input.Ooa,ea.input.Wl,ea.input.mYb,ea.input.source,Bb,this.oSa.vFa);var Gc=ea.output.QN;Bb===Zp.success&&0<Gc.length&&(ac.MergedRevision=this.Ufi(ea.output.QN.last()));return ac}r1c(ea,Pa){return(new Hq(ea)).r1c(Pa)}q1c(ea,Pa,Bb,ac){return(new Hq(ea)).q1c(Pa,Bb,ac)}}Object(f.a)(Iq,"GraphMerger",El.a,[]);Object(om.a)(dr,{merge:!0});class Zh extends Iq{constructor(ea,Pa=null,Bb=null){super(ea,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Pa,Bb);this.sa=
new S.a}get vFa(){return this.oSa?this.oSa.vFa:hk.a.unknown}get aQb(){return null}set aQb(ea){}w7k(ea){this.sa.addHandler(Zh.vTf,ea)}UIo(ea){this.sa.removeHandler(Zh.vTf,ea)}OFg(){return!1}lYb(ea,Pa,Bb,ac,Gc,ld,Gd){(ea=super.lYb(ea,Pa,Bb,ac,Gc,ld,Gd))&&this.sa.raiseEvent(Zh.vTf,new vl(ea));return ea}}Zh.vTf="GMC";Object(f.a)(Zh,"WordEditorGraphMerger",Iq,[848,849,836]);class $m{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}Ec(ea){this.Z=ea;this.Z.ja("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",
()=>new pq(this.Z.Za("WordEditor.IBusinessBarController"),new zc.a(()=>ea.Wa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.Z.ja("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new nm(this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();this.Z.ja("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Zh(()=>m.AFrameworkApplication.rootQuerySignature,this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),
this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.Z.ja("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Lo(()=>m.AFrameworkApplication.rootQuerySignature,m.AFrameworkApplication.va,this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){Rg.a.DU||
(Rg.a.DU=ok.a.fca());const ea=this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Rg.a.DU.zjl(ea);this.Z.resolve("Box4.IGraphMergeBackupManager")}dispose(){let ea=this.Z.Wa("Box4.IGraphMergeBackupManager");ea&&ea.dispose()}}Object(f.a)($m,"GraphMergePackage",null,[0,1]);var to=e(297);class Ip{constructor(ea){this.IQe="FontPicker";this.A_e=null;this.qRb=Pa=>{this.A_e=Pa.isEnabled;Pa=appChrome.actions.updateFontPickerLicenseState(this.IQe,Pa.isEnabled);appChrome.api.dispatch(Pa)};this.Sib=
ea;this.rEd=this.Sib.dxa(to.a.qXb,this.qRb);this.Sib.isFeatureEnabled(to.a.qXb,!1).then(Pa=>{this.A_e=Pa})}get isLicensed(){return this.A_e}dispose(){this.Sib.O0b(to.a.qXb,this.rEd)}}Object(f.a)(Ip,"ModernFontPickerFeatureHelper",null,[1941,11]);var Km=e(495),Cn=e(651),mn=e(1659);class Mo{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(Mo,"FontInfoTaskPaneProps",null,[]);
class rq{constructor(ea,Pa,Bb,ac=null){this.yef=this.Y_=this.rEd=null;this._state=this.fac=0;this.onOpen=()=>{this._state=2;this.LP()};this.onShow=Gc=>{0!==this._state&&(this._state=2,1===Gc&&(this.fac=Gc),this.LP())};this.onClose=()=>{this.fac=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.fac=0};this.onUpsellButtonClicked=()=>{this.Sib.launchUpsellExperience(mn.a.experienceId)};this.w2e=ea;this.Sib=Pa;this.Puk=Bb;this.oc=ac}get Tb(){return this.w2e.value}initialize(){this.Tb.qa(u.a.Ixg,
x.a.frame,Object(P.a)(this,this.Ixg,"requestFontInfo"));this.rEd=this.Sib.dxa(to.a.qXb,Object(P.a)(this,this.qRb,"featureStateChangeCallback"));this.qea()}sU(ea=!1){const Pa=lm.UISurfaces.aw(),Bb=this.Sib.isFeatureEnabled(to.a.qXb,!1),ac=[];ac.push(Pa);ac.push(Bb);Promise.all(ac).then(Gc=>{Gc[0].showTaskPane(mn.a.ORb,this.AB(Gc[1]));ea&&this.LP()})}JGp(ea){lm.UISurfaces.aw().then(Pa=>{Pa.updateTaskPane(mn.a.ORb,this.AB(ea));return null})}qRb(ea){this.JGp(ea.isEnabled)}Ixg(ea,Pa,Bb,ac,Gc){this.Y_=
Gc.CommandValueId;this.yef=Gc.Trigger;this.fac=Gc.InputMethod;this.sU(2===this._state&&1===this.fac);return 32}AB(ea){const Pa=new Mo;Pa.onUpsellButtonClicked=this.onUpsellButtonClicked;Pa.fontName=this.Y_;Pa.isLicensed=ea;Pa.trigger=this.yef;Pa.helpArticleUrl=this.jFl();Pa.paneId=mn.a.ORb;ea=this.Hcn();ea.contentProps=Pa;return ea}Hcn(){return Object.assign(new Wi.a,{title:mn.a.gwc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,
onClose:this.onClose,onShow:this.onShow,onHide:this.onHide})}qea(){if(this.oc){var ea=this.oc.te(mn.a.ORb);ea.parent=th.AFrame.rr;ea.LN=!0}}LP(){this.oc&&1===this.fac&&this.oc.Rg(mn.a.ORb)}blur(){this.oc&&this.oc.currentScope&&this.oc.currentScope.name===mn.a.ORb&&this.oc.Rg(this.oc.NY)}dispose(){this.Sib.O0b(to.a.qXb,this.rEd)}jFl(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.Puk,this.LBm(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}LBm(){switch(this.yef){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return rq.dml(this.Y_)}static dml(ea){let Pa="hlpFontInfo";for(let Bb=0;Bb<ea.length;++Bb){const ac=Fa.a.charAt(ea,Bb);if(255<ea.charCodeAt(Bb)||Fa.a.uad(ac))Pa+=ac}return Pa}}Object(f.a)(rq,"FontInfoPane",null,[1884,11]);class er extends rq{constructor(ea,Pa,Bb,ac,Gc){super(ea,Pa,ac.rb("FontInfoHelpBaseUrl"),Gc);this.qY=Bb}sU(ea){this.CY();super.sU(ea)}qRb(ea){super.qRb(ea);
qe.StaticActiveAppFrame.Aa().Ne()}CY(){this.qY.iLa()}}Object(f.a)(er,"WordEditorFontInfoPane",rq,[]);class Dn{constructor(){this.C9b=this.wKd=this.AKc=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}Ec(ea){this.Z=ea;ea.ja("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new Ip(this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();ea.ja("Common.ModernFontPicker.IFontInfoPane",()=>new er(new zc.a(()=>m.AFrameworkApplication.va),this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
tp.a.instance,m.AFrameworkApplication.J,zf.FocusManager.instance())).ha()}init(){this.wKd=this.Z.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.AKc=this.Z.resolve("Common.ModernFontPicker.IFontInfoPane");this.AKc.initialize();m.AFrameworkApplication.J.$("IsAnonymousUser")||((this.C9b=this.Z.Wa(Cn.a))?this.C9b.initialize():w.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));qe.StaticActiveAppFrame.Aa().Ne()}dispose(){this.AKc&&(this.AKc.dispose(),
this.AKc=null);this.wKd&&(this.wKd.dispose(),this.wKd=null);this.C9b&&(this.C9b.Xba(),this.C9b=null)}static main(){Object(Km.a)()&&U.a.instance.Rc(new Dn)}}Object(f.a)(Dn,"ModernFontPickerPackage",null,[0,1]);var Qh=e(68),vn=e(6),$k=e(773),Jp=e(30),hu=e(1123);class cj{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue,Ce,tf,Zg,Xi=null){this.h3=Bb;this.td=ea;this.Zc=Pa;this.ni=Gc;this.aSa=ld;this.F_=Gd;this.Ufh=ue;this.Tfh=Ce;this.lB=tf;this.kyk=Xi||cj.uz}get ii(){return this.lB?this.lB.ii:!1}xXi(ea){return this.uNa(ea,
0)}ogn(ea){return this.uNa(ea,1)}uNa(ea,Pa){let Bb=null;if(this.ii&&this.F_&&(this.Tfh.instance&&this.Tfh.instance.fRa(ea),Pa?1===Pa&&(Bb=this.F_.TGi(ea.node)):Bb=this.F_.xLf(ea.node,ea.cpBegin,ea.Ob),Bb&&!Bb.ka(Cg.a.Yca,!1)))return w.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const ac=vn.a.ZY(this.td.Lm());ac.set(ea.node);ac.Ib(10);const Gc=this.Zc.Vc(15);Gc.nw(ac);Pa?Jp.a.xe(ac):(this.E2a(ac,ea),this.h3.yDc(ea.node,nh.a.vw));ea=$g.ParagraphReader.Vn(ac.currentNode);
this.Mhn(ac);this.ii&&Bb&&this.Ufh&&(Pa=new qb.a,Pa.add(ac.currentNode),this.Ufh.aSh(Pa,Bb.id));this.Y1o(ea);Gc.dispose();return 32}Y1o(ea){ea=ui.SelectionFactory.Ie(ea,0);Xh.a.instance.Uc(ea)}Mhn(ea){this.ni.mA(ea,!0,!0,null,!1,!1);ea=Jp.a.Ze(ea);this.pgn(ea)}E2a(ea,Pa){const Bb=Jp.a.xe(ea);if(Pa.cpBegin||this.ii&&(!this.ii||-1!==Pa.Ob)){df.a.Gd().pn&&Pa.cpBegin!==$g.ParagraphReader.textLength(Pa.node)&&df.a.Gd().Qk.uI(Pa.node);this.ni.mA(ea,!1,!0,null,!1,!0);var ac=vn.a.ZY(this.td.Lm());ac.set(Bb);
this.ni.wea(ac,ea,Pa,!0,!0,!0)}}pgn(ea){ea=this.kyk(ea);this.aSa.WXi(ea)}static JI(){return new cj(new Ge.a,new sg.a,wa.a.instance.resolve("Box4.IAutoCorrectScheduler"),hu.a.instance,wa.a.instance.resolve("Box4.IOutlineElementEditor"),wa.a.instance.resolve("Box4.IBlobEditor"),wa.a.instance.Wa("Box4.IContentControlReader"),wa.a.instance.Wa("Box4.IContentControlEditor"),wa.a.instance.Za("Box4.IContentControlConverter"),wa.a.instance.Wa("Box4.ContentControlConfigSettings"),wa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=
cj.O2g?cj.O2g:cj.O2g=cj.JI()}static uz(ea){return Yg.a.uz(ea)}}Object(f.a)(cj,"PageBreakInserter",null,[879]);class og{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){this.Phn=(Ce,tf,Zg,Xi)=>{var ph=tf.view,Dh=ph.ub.hh;if(!Dh)return 2;if(!this.lrf(tf))return 8;if(1===Zg)return 32;let qk=!0;Zg=8;const Wn=this.B0e(Dh);Dh=this.Zc.Vc(15);Dh.Eb(ph.Fd);Dh.Bh=Ce;Wn||(Zg=this.ga.Sf(tf,pe.a.Rta,2,!0,Xi,null),Ce=32===Zg,w.ULS.shipAssertTag(4208012,314,Ce),qk=Ce);qk&&(ph=ph.ub.hh,Ce=this.B0e(ph),w.ULS.shipAssertTag(4208013,
314,Ce,"{0}",{["ContextId"]:tf.contextId}),Zg=8,Ce&&(Zg=this.iZe.xXi(ph),w.ULS.shipAssertTag(4208014,314,32===Zg)));Dh.dispose();32===Zg&&this.me.Vv(10);return Zg};this.Ohn=(Ce,tf,Zg)=>{if(!tf||tf.contextId!==ii.a.kd)return 8;if(1===Zg)return tf.contextId===ii.a.kd?32:8;if(2===Zg){if(!this.lrf(tf))return 8;Ce=this.iZe.xXi(tf);32===Ce&&this.me.Vv(10);return Ce}return 32};this.Nhn=(Ce,tf,Zg)=>{if(!tf||tf.contextId!==ii.a.table)return 8;if(1===Zg)return 32;if(2===Zg){if(!this.lrf(tf))return 8;Ce=this.iZe.ogn(tf);
32===Ce&&this.me.Vv(10);return Ce}return 32};this.ga=ea;this.iZe=Pa;this.Zc=Bb;this.Qo=ac;this.B0e=Gc;this.sm=ld;this.yHk=Gd;this.me=ue}mc(){this.ga.qa(Vg.a.uNa,ii.a.view,this.Phn);this.ga.qa(Vg.a.uNa,ii.a.kd,this.Ohn);this.ga.qa(Vg.a.uNa,ii.a.table,this.Nhn);this.ga.Oc(Vg.a.uNa,4)}i$(){const ea=zf.FocusManager.instance().te(Qh.a.LI);th.AFrame.Fj(ea,Ub.KeyInputManager.xc(nh.a.vw,Ub.KeyInputManager.Ji),Vg.a.uNa)}ltn(ea){return this.Cz(ea.iterator)}mxn(ea){ea=ea.K(0);const Pa=wj.a.Xk(ea,!0,!1);if(this.Cz(Pa.Ya.iterator))return!0;
ea=wj.a.Xk(ea,!1,!1);return this.Cz(ea.Ya.iterator)}Cz(ea){return ea.Ib(14)}lrf(ea){let Pa=null,Bb=ea;if(Bb.contextId===ii.a.view){Pa=Bb.view;if(!Pa.features.aKg)return!1;Bb=Pa.ub.hh;if(!Bb)return!1}else{const ac=vn.a.kb(Bb.node);if(ac.Ib(36)||ac.Ib(38)||ac.Ib(40)||ac.Ib(14))return!1}return $k.a.bda(ea)?!1:Bb.contextId===ii.a.table?this.sm.Wsn(Bb.node):!this.sm.Usn(Bb)||this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(Bb)?!1:((ea=this.B0e(Bb))?this.ltn(Bb):this.mxn(Pa.ub.ob))||ea&&this.yHk(Bb,!0)?!1:
!0}static JI(){return new og(m.AFrameworkApplication.va,cj.instance,new sg.a,wa.a.instance.Za("Box4.IExternalSelectionManager"),wj.a.Df,lh.a.instance,If.a.aEa,wa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=og.G1g?og.G1g:og.G1g=og.JI()}}Object(f.a)(og,"PageBreakActor",null,[847]);class pm{constructor(){this.l6e=this.Z=null}get name(){return"WordEditor.PageBreak"}Ec(ea){this.Z=ea}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>
{this.Sp()})}Sp(){this.l6e=og.instance;this.l6e.mc();this.l6e.i$();qe.StaticActiveAppFrame.Aa().Ne()}dispose(){}}Object(f.a)(pm,"PackageManager",null,[0,1]);var nl=e(1263);class an{constructor(ea,Pa,Bb){this.ga=ea;this.YDh=Pa;this.rQ=Bb}mc(){this.ga.nb(Vg.a.xmd,ii.a.application,this.xmd.bind(this),96);this.ga.nb(Vg.a.IGe,ii.a.application,this.IGe.bind(this),96)}IGe(ea,Pa,Bb){return 1===Bb?32:this.ga.Vb(Vg.a.c3a,2)}xmd(ea,Pa,Bb,ac,Gc){if(1===Bb)return 32;ea=this.YDh.getTotalPageCount();-1===ea?ea=
"":1===this.rQ.vz||2===this.rQ.vz?(Pa=this.YDh.mvm(),Pa>ea&&(ea=Pa),ea=String.format(WacWordeditorStrings.CurrentPageAndCount,Pa,ea)):ea=1===ea?String.format(WacWordeditorStrings.TotalPageCountSingular,ea):String.format(WacWordeditorStrings.TotalPageCount,ea);Gc[nl.a.Visible]=!0;Gc[nl.a.LabelText]=ea;return 32}}Object(f.a)(an,"PaginationActor",null,[]);class Zf{constructor(){this.Wza=!1;this.Sbl=()=>{this.ZWh()}}get name(){return"WordEditor.Pagination"}Ec(ea){this.Z=ea;this.Qd=this.Z.resolve("Box4.IFeatureHelper");
this.Z.ja("WordEditor.Pagination.PaginationActor",()=>new an(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.IPageNumberFinder"),this.Z.resolve("WordEditor.IMainViewModeManager"))).ha()}init(){this.Qd.Fs.continueWith(()=>{this.Sp()})}Sp(){const ea=qe.StaticActiveAppFrame.Aa().tb;ea.uva?this.ZWh():ea.gga(this.Sbl)}ZWh(){this.Wza||(this.Wza=!0,wa.a.instance.resolve("WordEditor.Pagination.PaginationActor").mc())}dispose(){}}Object(f.a)(Zf,"PackageManager",null,[0,1]);class Wj{constructor(){this.Z=
null}Ec(ea){this.Z=ea||wa.a.instance}dispose(){}}Object(f.a)(Wj,"TellMePackage",null,[0,1]);var Hg=e(1997),al=e(1394),yj=e(359),ki=e(1390),tj=e(1270);class Mm{constructor(ea=null,Pa=null,Bb=null,ac,Gc=null){this.oNe=null;this.Qch=!1;this.tnh=this.M6b=null;this.UTk=this.hKh=this.Otk=this.unh=!1;this.$Bd=null;this.euk=null==Pa?m.AFrameworkApplication.nNb:Pa;this.SFk=null==Bb?m.AFrameworkApplication.b5:Bb;this.zUk=null==Gc?m.AFrameworkApplication.Xgb:Gc;this.sEk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeHelpOnHelpIsEnabled");
this.mWk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled");this.O7o(!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIgnoreQueryForHelp"));this.dWk=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.ldd;this.eWk=!ki.a.bia()&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePeopleSuggestionIsEnabled");this.cWk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeFileSuggestionIsEnabled");this.vBk=!!m.AFrameworkApplication.ta&&
m.AFrameworkApplication.ta.Pb.T2b;this.fWk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.BTk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HelpShowsTopSearchResult");this.INk=this.rsd||this.qsd;this.GNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("OnlineCommandSuggestionsIsEnabled");this.HNk=this.P2f;this.mIk=!!m.AFrameworkApplication.J&&this.W2a&&m.AFrameworkApplication.J.$("StyledHeaderInLabelIsEnabled");this.SCk=
m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.wDk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.GCk=m.AFrameworkApplication.J?parseFloat(m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.iIk=!!m.AFrameworkApplication.J&&
(m.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.NHk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.IIk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.oGk=!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isActionAIEnabledInTellMe",!1)&&(this.xCn||this.Pvn);this.Rcc=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.iVk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";
this.yDk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.CTk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.mUk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.QTk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("ShowFindInDocumentInZeroTermSearchBox")||
this.vU;this.xIk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeTemplateProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.JHk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.bIk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
m.AFrameworkApplication.uiCulture;this.uIk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeFeedbackProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.KIk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Rtk=this.W2a&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.YDk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.sUk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.J.rb("Application"));this.nvk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.dYk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePerformanceMarkerEnabled");this.rGk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.vGk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.vDk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.wIk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeNotesSuggestionIsEnabled")||this.CAn;this.tGk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.uGk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.sGk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.vAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.wAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.uAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.jvf&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.LNk=
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.jvf&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1);this.gWk=this.y8i&&(this.ylg||this.zlg||this.ljd||this.W2a&&ki.a.Mva()&&!!m.AFrameworkApplication.J&&(this.AAc||this.Y2b||this.Z2b||this.$2b||this.a3b||m.AFrameworkApplication.J.$("ShowAnswerSearchResults")||m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.J.$("ShowEntitySearchResults")||m.AFrameworkApplication.J.$("ShowWolframSearchResults")));
this.Qsk=!!m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&m.AFrameworkApplication.B8a;this.Rsk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled");this.xdn(ea||{});this.K$e="2918242107";this.J$e="1454393937";this.yJb={};this.Rnb=[];this.eHl=[ki.a.zHe]}get application(){return this.M6b}get nNb(){return this.euk}get FUo(){return this.K$e}get EUo(){return this.J$e}get sGf(){return this.tnh}get Eti(){return this.unh}get b5(){return this.SFk}get Xgb(){return this.zUk}get jNb(){return this.Otk}get C6m(){return this.sEk}get crp(){return this.mWk}get y8i(){return!0}get Tqp(){return this.gWk}get S$o(){return this.hKh}O7o(ea){this.hKh=
ea}get W2a(){return this.dWk}get Eud(){return this.eWk}get Cud(){return this.cWk}get ncm(){return this.vBk}get Rqp(){return this.fWk}get gHe(){return!1}get ljd(){return this.INk}get ylg(){return this.GNk}get zlg(){return this.HNk}get edb(){return!1}get Fje(){return!1}get G4f(){return this.mIk}get QCe(){return this.UTk}get AAc(){return!1}get Dbp(){return!1}get nGn(){return""}get NOf(){return 2}get XNm(){return 4}get YNm(){return 5}get QLi(){return""}get zym(){return this.SCk}get hMi(){return this.wDk}get SLi(){return 1E3}get RLi(){return 1E-6}get enp(){return this.iVk}get JJg(){return!1}get U3j(){return!1}get jyn(){return this.bIk}get lje(){return!1}get mje(){return!1}get E4i(){return!1}get D4i(){return!1}get CAn(){return!1}get z8i(){return!1}get C6d(){return!1}get jBb(){return!1}get Y2b(){return!1}get Z2b(){return!1}get $2b(){return!1}get a3b(){return!1}get rsd(){return this.BTk}get tAc(){return this.CTk}get qsd(){return!1}get ELf(){return null}get eje(){return!1}get ICe(){return this.QTk}get dIi(){return 0}get $rm(){return this.GCk}get NMi(){return this.yDk}get vzn(){return this.iIk}get nge(){return this.oGk}get GCe(){return this.Rcc}get wHm(){return-3.9}get vU(){return this.mUk}get mdd(){return this.xIk}get c3f(){return this.JHk}get $4f(){return this.uIk}get Tob(){return this.Rtk}get HCn(){return this.KIk}get zDa(){return this.YDk}get L0j(){return this.sUk}get tll(){return this.nvk}get gJe(){return this.dYk}get uge(){return this.rGk}get rln(){return this.vGk}get Px(){return this.vDk}get Cwb(){return this.wIk}get pln(){return this.tGk}get qln(){return this.uGk}get oln(){return this.sGk}get u9k(){return this.Qsk}get v9k(){return this.Rsk}get ana(){return this.vAk}get y4d(){return this.wAk}get Yjc(){return this.uAk}get xCn(){return this.IIk}get Pvn(){return this.NHk}get Wbo(){return this.LNk}get vWb(){return!!m.AFrameworkApplication.ta&&
m.AFrameworkApplication.ta.Pb.$t}get $t(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.$t}get Cun(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.wAc}get HYn(){return Qd.getImageClass("OfficeAssistant_32x32x32")}K9d(){return Promise.reject("GetFindMatchCount method is not overridden")}Ddd(ea){return Array.contains(appChrome.selectors.getVisibleControlIds(),ea)}ahe(){return!1}get rie(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeModelRankerEnabled")}get I5j(){return m.AFrameworkApplication.J?
m.AFrameworkApplication.J.rb("TellMeServiceHelpClassifierModelName"):""}get P2f(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeMultiLingualCommandModelEnabled")}get mUb(){return"NoOpHeaderUi"}get aHl(){return this.$Bd}get parameterData(){return this.yJb}get yyp(){return this.Rnb}N8l(){if(this.oNe&&!this.Qch&&(this.Qch=!0,this.cBb(this.oNe),this.$t)){var ea=wa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");ea=(new tj.a(ea)).Z7d(this.oNe.KK);appChrome.api.dispatch(ea)}}cBb(){}mZl(ea){const Pa=
[];for(let Bb=0;Bb<ea.length;++Bb)ea[Bb].Gcp?Pa.push(new yj.a(ea[Bb].zo,ki.a.X9j+Bb.toString())):Pa.push(new yj.a(ea[Bb].standard,ki.a.zHe+Bb.toString()));return Pa}xdn(ea){const Pa={};for(const Bb in ea){const ac=Bb,Gc=ea[Bb];for(const ld in Gc){const Gd=ld,ue=Gc[ld];(Pa[Gd]||(Pa[Gd]={}))[ac]=ue}}this.$Bd=Pa}get J5j(){return""}get D_j(){return!1}}Object(f.a)(Mm,"TellMeApplicationData",null,[1943]);class dm{constructor(ea,Pa=null,Bb=!1){this.standard=ea;this.zo=Pa;this.Gcp=Bb}}Object(f.a)(dm,"TryQuerySet",
null,[]);class bl{constructor(){this.EAh=this.FAh=null}get AVn(){return this.EAh}Kma(ea){this.FAh=ea;return this.Fwf(ea)}UZn(){this.EAh=this.FAh}z$d(ea){return 8===ea.type?String.format(CommonUIStrings.l_FindInDocumentText,ea.wG):ea.wG}fLf(ea){return ea.wG}}Object(f.a)(bl,"ParameterizedCommand",null,[]);class Un extends bl{constructor(ea){super();this.Vcd=ea}get commandId(){return this.Vcd?"DefinitionsParameterized":"DefinitionButton"}get hng(){return"Definition"}Fwf(ea){const Pa=Fa.a.Mf(String.format(WacWordeditorStrings.TellMeButtonLabel_DefinitionsParam,
ea.wG));return Ke.a(ki.a.xxf(ea.value),u.a.$yf.toString(),Pa,ki.a.EZf,null,Fa.a.Mf(ki.a.xPb(ea.wG)),Pa,null,null)}z$d(ea){return String.format(WacWordeditorStrings.TellMeButtonLabel_DefinitionsParam,ea.wG)}fLf(ea){return ki.a.xPb(ea.wG)}}Object(f.a)(Un,"DefinitionsParameterizedCommand",bl,[]);class ak extends bl{constructor(ea){super();this.Vcd=ea}get commandId(){return this.Vcd?m.AFrameworkApplication.ta.Pb.Eqn?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get hng(){return"Find"}Fwf(ea){const Pa=
Fa.a.Mf(String.format(WacWordeditorStrings.ParamFindInDocTitle,ea.wG));return Ke.a(ki.a.xxf(ea.value),u.a.Pkc.toString(),Pa,"Find_16x16x32",null,Fa.a.Mf(ea.wG),Pa,null,null)}z$d(ea){return String.format(CommonUIStrings.l_TextWithQuotation,ea.wG)}}Object(f.a)(ak,"FindParameterizedCommand",bl,[]);class Gj extends bl{constructor(ea){super();this.Vcd=ea}get commandId(){return this.Vcd?"SynonymsParameterized":"SynonymButton"}get hng(){return"Synonym"}Fwf(ea){const Pa=Fa.a.Mf(String.format(WacWordeditorStrings.TellMeButtonLabel_SynonymsParam,
ea.wG));return Ke.a(ki.a.xxf(ea.value),u.a.$yf.toString(),Pa,ki.a.EZf,null,Fa.a.Mf(ki.a.xPb(ea.wG)),Pa,null,null)}z$d(ea){return String.format(WacWordeditorStrings.TellMeButtonLabel_DefinitionsParam,ea.wG)}fLf(ea){return ki.a.xPb(ea.wG)}}Object(f.a)(Gj,"SynonymsParameterizedCommand",bl,[]);var Tk=e(2122),ms=e(2149),Sr=e(2157),Uk=e(2109),vp=e(2110),ns=e(1529);class Kp extends Tk.a{constructor(){super(...arguments);this.mV=null;this.L7a=ms.a.createInstance(this,Sr.a.instance,ns.a.instance,!0,!0)}static get instance(){return Kp._instance}Nkc(){this.mV(this.L7a.il.lqa);
this.L7a.b9a(!0)}K9d(ea){const Pa=new Promise((Bb,ac)=>{this.mV=Bb;setTimeout(()=>{ac("Find manager execution timed out");this.L7a.b9a(!0)},500)});ea=Uk.a.createQuery(ea,vp.a.none);this.L7a.find(ea);return Pa}}Kp._instance=new Kp;Object(f.a)(Kp,"TellMeFindStatusSpy",Tk.a,[]);class En extends Mm{constructor(ea){super({});this.M6b="Word";this.dDk=ea;m.AFrameworkApplication.J.$("TellMeFindInDocumentIsEnabled")&&(this.unh=!0,this.tnh=this.C6d?"FindWithMatchesParameterized":"FindParameterized");ea=new Un(this.vWb);
const Pa=new Gj(this.vWb);this.parameterData[ea.commandId]=ea;this.parameterData[Pa.commandId]=Pa;ea=new ak(this.vWb);this.parameterData[ea.commandId]=ea;m.AFrameworkApplication.J.$("TellMeTryQueriesIsEnabled")&&(ea=[new dm(WacWordeditorStrings.TellMeTryQuery01,"",!1),new dm(WacWordeditorStrings.TellMeTryQuery02,"",!1),new dm(WacWordeditorStrings.TellMeTryQuery03,"",!1),new dm(WacWordeditorStrings.TellMeTryQuery04,"",!1),new dm(WacWordeditorStrings.TellMeTryQuery05,"",!1)],this.Rnb=this.mZl(ea))}K9d(ea){return Kp.instance.K9d(ea)}get Tfb(){return Qh.a.uxa}get mUb(){return Qh.a.QYa}cBb(ea){var Pa=
m.AFrameworkApplication.J;ea=ea.KK;ea.WordCountFlyout=!this.dDk();ea.SelectAllButton=!Pa.$("TellMeSelectAllResultIsEnabled");const Bb=Pa.$("TellMeDesktopUpSellIsEnabled");let ac=m.AFrameworkApplication.Gje;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!ac));ac=!1;ea.TextBoxUpSellButton=!Bb||ac;ea.TableOfContentsUpSellButton=!Bb||ac;ea.SmartArtUpSellButton=!Bb||ac;ea.WordArtUpSellButton=!Bb||ac;ea.MultiColumnLayoutUpSellButton=!Bb||ac;ea.InsertEquationUpSellButton=
!Bb||ac;ea.TrackChangesUpSellButton=!Bb||ac;ea.ShapesUpSellButton=!Bb||ac;ea.LabelsUpSellButton=!Bb||ac;ea.InsertCitationUpSellButton=!Bb||ac;ea.TextBoxUpSellButtonEnterprise=!Bb||!ac;ea.TableOfContentsUpSellButtonEnterprise=!Bb||!ac;ea.SmartArtUpSellButtonEnterprise=!Bb||!ac;ea.WordArtUpSellButtonEnterprise=!Bb||!ac;ea.MultiColumnLayoutUpSellButtonEnterprise=!Bb||!ac;ea.InsertEquationUpSellButtonEnterprise=!Bb||!ac;ea.TrackChangesUpSellButtonEnterprise=!Bb||!ac;ea.ShapesUpSellButtonEnterprise=!Bb||
!ac;ea.LabelsUpSellButtonEnterprise=!Bb||!ac;ea.InsertCitationUpSellButtonEnterprise=!Bb||!ac;Pa=!Pa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.b5;ea.SynonymButton=Pa;ea.DefinitionButton=Pa}get J5j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get JJg(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get I5j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName",
"")}get AAc(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get P2f(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get NOf(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get D_j(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get Fje(){return m.AFrameworkApplication.J.$("TellMeRankerLoggingIsEnabled")&&
m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get rie(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get lje(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get mje(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get SLi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",
1E3)}get RLi(){return 1E-6*m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get E4i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get D4i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get QLi(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName",
"")}get z8i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get dIi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get y8i(){return m.AFrameworkApplication.J.$("TellMeServiceForSearchIsEnabled")}get gHe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get edb(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",
!1)}get QCe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get U3j(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get eje(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get Y2b(){return m.AFrameworkApplication.J.$("ShowAnswerSearchResults")}get Z2b(){return m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")}get $2b(){return m.AFrameworkApplication.J.$("ShowEntitySearchResults")}get a3b(){return m.AFrameworkApplication.J.$("ShowWolframSearchResults")}get ELf(){return m.AFrameworkApplication.J.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(En,"WordEditorTellMeApplicationData",Mm,[]);var Vn=e(1456),em;(function(ea){ea[ea.none=0]="none";ea[ea.cSg=1]="waitAll";ea[ea.Swq=2]="synchronizeFast";ea[ea.wop=3]="synchronizeSlow"})(em||(em={}));Object(f.b)("ProviderSynchronizationType",em);var uo;(function(ea){ea[ea.immediate=0]="immediate";ea[ea.cSg=1]="waitAll";ea[ea.Qwq=2]="synchronizeAndWaitAll";ea[ea.Rwq=3]="synchronizeAndWaitForRanker"})(uo||(uo={}));Object(f.b)("MenuUpdatePolicy",
uo);var So=e(1400),Bo=e(1396),nn=e(1606),$p=e(1398),zj=e(1449),xr=e(129),fm=e(306);class To extends Tk.a{constructor(ea){super();this.ZYk=ea}Nkc(){this.ZYk.update()}}Object(f.a)(To,"TellMeFindStatusManager",Tk.a,[]);class Co{constructor(ea){this.Lnb=this.pfh=null;this.Ci=0;this.jHd="TellMeWAC.";const Pa=ea.sGf;this.$c=ea;this.EEd=Pa;this.t2e=Object.assign(new Vn.a,{landingTab:"Indoc",data:null});ea=new To(this);this.L7a=ms.a.createInstance(ea,Sr.a.instance,ns.a.instance,!0,!0)}iP(){return"WordFindInDocument"}eZ(){return this.$c.NOf?
this.$c.NOf===uo.cSg?em.cSg:em.wop:em.none}WL(ea,Pa){this.OBn(ea)?(this.Lnb=ea,this.pfh=Pa,ea=Uk.a.createQuery(ea.sh,vp.a.none),this.Ci=window.performance.now(),this.L7a.find(ea)):Pa.mv(new So.a(ea))}update(){this.IXo(Math.round(window.performance.now()-this.Ci));var ea=String.format(CommonUIStrings.l_TextWithQuotation,this.Lnb.sh);var Pa=m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pb.jBb?ki.a.MWa(this.Lnb.sh,15,this.t2e):Fa.a.Mf(this.Lnb.sh);const Bb=[];Bb.push(appChrome.actions.setControlLabel(this.EEd,
ea));Bb.push(appChrome.actions.setCompoundButtonCommandValueId(this.EEd,Pa));Bb.push(appChrome.actions.updateCompoundButtonDescription(this.EEd,this.uSf()));appChrome.api.dispatch(Bb);ea=new Bo.a(this.EEd,nn.a.FindInDocument,this.Lnb.sh,this.L7a.il.lqa.toString());Pa=new $p.a(zj.a.FindInDocument);Pa.displayName=WacWordeditorStrings.FindInDocument;Pa.aA(ea);const ac=new So.a(this.Lnb);ac.Jx(Pa);window.requestAnimationFrame(()=>{this.pfh.mv(ac)});this.L7a.b9a(!0);this.JXo(Math.round(window.performance.now()-
this.Ci))}uSf(){const ea=this.L7a.il.lqa.toString();return"1"===ea?String.format(CommonUIStrings.l_SearchResultText,ea):String.format(CommonUIStrings.l_SearchResultsText,ea)}OBn(ea){return!!ea&&!!ea.sh&&""!==ea.sh.trim()}IXo(ea){const Pa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Lnb.sh.length};this.sendActivityEvent(Pa,ea)}JXo(ea){const Pa={["Time"]:(new Date).getTime(),["Event"]:"Latency",
["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Lnb.sh.length};this.sendActivityEvent(Pa,ea)}sendActivityEvent(ea,Pa){ea=xr.a.iG(ea);um.a.eQa(Object.assign(new fm.a,{name:"Latency",dataFields:ea,durationMs:Pa}),this.jHd)}}Object(f.a)(Co,"WordFindInDocumentWithMatchesProvider",null,[845]);class fo{constructor(ea,Pa){this.Tb=ea;this.Pfe=Pa}ecb(ea,Pa,Bb){return this.Pfe.ecb(0,ea,Pa,Bb)}insertHtmlText(ea){return ea?32===this.dZf(ea):!1}dZf(ea){return this.executeCommand(pe.a.$sa,
ea)}executeCommand(ea,Pa){const Bb=new Ie.DictionaryPropertySet;Bb.setValue(Ue.a.PZ,Pa);Bb.setValue(Ue.a.aQa,!1);Pa=this.Tb.Vb(ea,1);32===Pa&&(Pa=this.Tb.Zb(ea,2,Bb));return Pa}}Object(f.a)(fo,"WordInsertContentHandler",null,[844]);class Jq extends Wj{constructor(){super();this.Gz=()=>{if(m.AFrameworkApplication.yLg){var ea=qe.StaticActiveAppFrame.Aa().Pb.dRf(u.a.Pv);ea.cbd?this.mzj():ea.L0(this.gUo);var Pa=new En(()=>!1);Hg.a.instance.initialize(Pa,null,null,null,null,null,Object(P.a)(qe.StaticActiveAppFrame.Aa(),
qe.StaticActiveAppFrame.Aa().J7d,"forceUpdateRibbonControls"),m.AFrameworkApplication.J,this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.Za("Common.IActionContextProvider"),this.Z.Za("Common.ISystemInitiatedFeedback"));Hg.a.instance.rAo(ea);Hg.a.instance.BCo(new fo(m.AFrameworkApplication.va,this.Z.Wa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));Pa.Eti&&Pa.C6d&&Hg.a.instance.addProvider(new Co(Pa),al.a.Pv)}};this.gUo=()=>{this.mzj()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.J.lq(this.Gz)}mzj(){qe.StaticActiveAppFrame.Aa().Ne()}}
Object(f.a)(Jq,"WordEditorTellMePackage",Wj,[]);var gm=e(1359),Lp=e(121);class Mp{constructor(ea,Pa){this.nOj=ea;this.Tb=Pa;this.kAe=(Bb,ac,Gc,ld,Gd)=>{if(1===Gc)return 32;this.nOj.sE(9,Gd,!1);return 32};this.fU=(Bb,ac)=>{if(9===ac.type){var Gc;(Bb=ac.fC)?("string"===typeof Bb?Gc=Bb:"data"===Bb.type&&(Gc=Lp.a.Vfi(Bb.rno,Bb.newState,Bb.R7o)),Gc&&Mp.pVc(Gc)):w.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.pnd()}pnd(){this.Tb.qa(Vg.a.kAe,x.a.frame,
this.kAe);this.nOj.CQ(this.fU)}dispose(){}static pVc(ea){ea=qe.StaticActiveAppFrame.Aa().$L.Hma(ea,!1);ea.image=5;ea.Pna="CoAuth_AuthorStatus_16x16x32";qe.StaticActiveAppFrame.Aa().$L.yB(ea)}}Object(f.a)(Mp,"TrackChangeNotificationActor",null,[]);class fr{constructor(){this.wi=this.qef=this.Z=null;this.$id=()=>{if(this.wi=gm.a.W7c().result)this.Z.ja("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Mp(this.wi,m.AFrameworkApplication.va)).ha(),this.qef=this.Z.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}Ec(ea){this.Z=
ea}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){gm.a.W7c().continueWith(this.$id)}dispose(){this.qef&&this.qef.dispose()}}Object(f.a)(fr,"WordEditorTrackChangeNotificationActorPackageManager",null,[0,1]);var Xm=e(113),bn=e(1367),sq=e(2102);class Ak{}Ak.QOg="UnsavedChanges";Ak.ROg="UnsavedChangesThemed";Ak.lTo="SavedChanges";Ak.mak="UnsavedChangesOpenPipe";Ak.DBp="UnsavedChangesOpenPipeCssClassNameThemed";Ak.lak="UnsavedChangesClosePipe";Ak.ABp="UnsavedChangesClosePipeThemed";
Ak.BBp="UnsavedChanges";Ak.CBp="UnsavedChangesThemed";Ak.SOg="UnsavedChangesIndicatorPositionRef";Object(f.a)(Ak,"UnsavedChangesHighlightUtils",null,[]);class Nm extends bn.a{constructor(ea,Pa){super();this.Nka=ea;this.VF=Pa;this.w7=[this.VF?new sq.a(Ak.ROg,Ak.CBp):new sq.a(Ak.QOg,Ak.BBp)]}get Fha(){return!0}get Cub(){return 4}get Kbb(){return this.w7}$Oa(ea,Pa){if(this.Nka){var Bb=this.Nka.ecg;if(Bb&&Bb.count&&Bb.contains(ea.id))for(ea=Pa.DPa("span"),Pa=0;Pa<ea.length;Pa++)Bb=ea[Pa],Pa||Bb.classList.add(this.VF?
Ak.DBp:Ak.mak),Pa===ea.length-1&&Bb.classList.add(this.VF?Ak.ABp:Ak.lak),Bb.classList.add(this.VF?Ak.ROg:Ak.QOg)}}fbb(){}}Object(f.a)(Nm,"UnsavedChangesHighlightActor",bn.a,[]);var Qs=e(1055);class Rs{constructor(ea){this.$Re=null;this.Nka=ea;this.w_e=!1}get key(){return"UnsavedChangesHighlight"}get hx(){return"UnsavedChanges"}reset(ea){if(this.Nka){ea=ea.node;if($g.ParagraphReader.lc(ea)){const Pa=this.Nka.ecg;if(Pa&&Pa.contains(ea.id)){this.w_e=!0;this.$Re=ea.id;return}}this.w_e=!1;this.$Re=Ci.a.nil}}NGa(){let ea=
null;return this.w_e?(ea=Object.assign(new Qs.a,{NH:this.key,contentObject:this.$Re,description:null}),{returnValue:!0,vI:ea}):{returnValue:!1,vI:ea}}}Object(f.a)(Rs,"UnsavedChangesHighlightCpContentDetailsProvider",null,[376,377]);class It{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.CAh=null;this.paa=ea;this.qf=Pa;this.u0=Bb;this.Oaa=ac;this.HNh=Gc;this.ksa=ld;this.VF=Gd;this.qf.cKa(this.u2.bind(this))}get ecg(){return this.CAh}u7m(){if(this.paa){if(1===this.paa.Xsf){if(0===this.paa.H6f&&this.paa.evj()){this.CAh=
this.paa.xne;const ea=this.paa.hwd;this.paa.mTo.forEach(this.p_l.bind(this));ea.forEach(this.v7m.bind(this));0<ea.length&&this.Z0l(this.u0);return 0}return this.jwo(this.paa.H6f)}return 2}return 1}jwo(ea){switch(ea){case 0:return this.paa.eTi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}WTi(ea,Pa,Bb){if(Pa)if(Bb){Bb=Pa.querySelectorAll("span");for(let ac=0;ac<Bb.length;ac++){const Gc=Bb[ac];ac||Gc.classList.add(Ak.mak);ac===Bb.length-1&&Gc.classList.add(Ak.lak);Gc.classList.add(this.VF?
Ak.ROg:Ak.QOg)}Pa.classList.add(Ak.SOg);ea&&this.Oaa.LDc(ea)}else Pa.classList.add(Ak.lTo)}soc(ea,Pa){const Bb=this.uVm(ea);if(ea&&(ea=ea.ug(qe.StaticActiveAppFrame.Aa().tb.Xc.Lc)))if(ea.lg&&ea.lg.Rj&&0!==ea.lg.Rj.count)for(const ac of ea.lg.Rj)this.WTi(Bb,ac,Pa);else this.WTi(Bb,ea.htmlElement,Pa)}uVm(ea){return this.HNh&&(ea=this.HNh.HTb(ea))&&ea&&(ea=ea.ug(qe.StaticActiveAppFrame.Aa().tb.Xc.Lc))?ea:null}v7m(ea){this.soc(ea,!0);return!0}p_l(ea){this.soc(ea,!1);return!0}Z0l(ea){ea&&ea.continueWith(()=>
{ea.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}u2(ea,Pa){Pa===Sys.EventArgs.Empty?w.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Pa&&Pa.errorCode?this.ksa.XT||(ea=this.u7m(),w.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",ea),sa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==ea&&4!==ea&&this.gvp(ea)):w.ULS.sendTraceTag(572364514,
306,50,"HighlightUnsavedChanges Not Run: No {0}",Pa?"Error Code":"Kickout Event Args")}gvp(ea){let Pa;const Bb=new mi.a;Bb.extendedProperties=new Map;Bb.extendedProperties.set("HighlightUnsavedChangesResult",ea.toString());Bb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(ea){case 1:case 2:case 6:Pa="HighlightInternalError";break;case 5:Pa="ChangeOutsideCanvas"}6!==ea&&5!==ea||Bb.extendedProperties.set("UnsavedChangesCollectionResult",this.paa.H6f.toString());Pa&&(sa.Health.instance.recordQosError(Pa,
["UnsavedContentNotHighlighted"],!0,!0,!1,!1,Bb),sa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Pa,!0,!0,Bb))}dispose(){this.qf.Q0b(this.u2.bind(this))}}Object(f.a)(It,"UnsavedChangesHighlighter",null,[11]);var lt=e(886),dn=e(722),Pk=e(1365);class Lc extends Pk.a{constructor(ea,Pa){super();this.Nka=ea;this.VF=Pa}s2a(ea){if(!this.Nka)return!1;const Pa=this.Nka.ecg;return Pa?Pa.contains(ea.Jb.id)||ea.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}vql(ea,Pa){Pa=ea.rNa?ea.rNa[Pa]?
ea.rNa[Pa].style?ea.rNa[Pa].style.marginLeft:null:null:null;var Bb=ea.zoa;ea=1440<=Bb?-(Bb/1440*96):ea.Y8a(0,96,this.zoom);Bb=0;Pa&&(Pa=Pa.match(/^(\d+)px/))&&Pa[1]&&(Bb=Number(Pa[1]));return ea-Bb}Qql(ea,Pa,Bb){return Sys.UI.DomElement.getBounds(ea).y-Bb.l9[Pa].y}lql(ea){return Sys.UI.DomElement.getBounds(ea).height}lfi(ea,Pa,Bb,ac){let Gc;Gc=this.vql(Bb,Pa);Pa=this.Qql(ea,Pa,Bb);ea=this.lql(ea);ac=lt.a.createElement(ac,dn.a.div);ac.className=this.VF?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";
ac.style.left=Gc+"px";ac.style.top=Pa+"px";ac.style.height=ea+"px";return ac}Dei(ea,Pa,Bb,ac){const Gc=[],ld=ea.querySelectorAll("."+Ak.SOg);if(0===ld.length&&ea.classList.contains(Ak.SOg))Bb=this.lfi(ea,Pa,Bb,ac),Bb.zma=Pa,Gc.push(Bb);else for(ea=0;ea<ld.length;ea++){const Gd=this.lfi(ld[ea],Pa,Bb,ac);Gd.zma=Pa;Gc.push(Gd)}return Gc}JWa(ea){let Pa=[];var Bb=ea.z2;const ac=Bb.Gh.ownerDocument;if(Bb.ik){let Gc=0;for(const ld of Bb.lg.Rj)(Bb=this.Dei(ld,Gc,ea,ac))&&(Pa=Pa.concat(Bb)),Gc+=1}else Pa=
this.Dei(Bb.htmlElement,0,ea,ac);return Pa}}Object(f.a)(Lc,"UnsavedChangesIndicatorActor",Pk.a,[]);class pk{constructor(){this.$_=this.Wz=this.gTa=this.Oaa=this.VGd=this.Nka=null}get name(){return"WordEditor.UnsavedChangesHighlight"}Ec(){}init(){this.Oaa=wa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.Nka=new It(wa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Hf.SessionStatusManager.instance,Wh.a.xr(wa.a.instance.Za("Common.ISystemInitiatedFeedbackWithTimeLapse")),
this.Oaa,wa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),wa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!Rg.a.instance&&Rg.a.instance.jEa);this.gTa=wa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager");this.$_=wa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.VGd=new Lc(this.Nka,!!Rg.a.instance&&Rg.a.instance.jEa);this.Oaa.LPa(this.VGd);this.gTa&&this.gTa.execute(ea=>{ea.SW(new Rs(this.Nka))});this.Wz=new Nm(this.Nka,
!!Rg.a.instance&&Rg.a.instance.jEa);this.$_.xfb(this.Wz)}dispose(){this.Oaa&&this.VGd&&this.Oaa.dIe(this.VGd);this.$_&&this.Wz&&this.$_.HOg(this.Wz);Xm.a.BF(this.Nka)}static main(){U.a.instance.Rc(new pk)}}Object(f.a)(pk,"WordEditorUnsavedChangesHighlightPackage",null,[0,1,11]);var Fn=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},Wl;(function(ea){ea[ea.GVp=0]="Healthy";ea[ea.xWp=1]="MissedScan";ea[ea.IWp=2]="NeedsReset";ea[ea.lUp=3]="CriticalUnresponsive";ea[ea.bWp=4]="KickoutComponent"})(Wl||(Wl={}));
Object(f.b)("TimerBasedWatchDogStatus",Wl);class Mj{constructor(ea,Pa,Bb){this.XOd=this.fxh=this.jyh=this.b8b=this.NIa=0;this.Yjj=3;this.m2d=3E4;this.Gdc=ea;this.SEb=Pa;this.pQi=Bb}SFa(){this.NIa=0}async wVn(){const ea=Date.now(),Pa=this.Gdc.Nsc;this.XOd++;if(this.fxh==Pa&&this.Xbp(ea,this.jyh))return{["WatchDogScanTime"]:ea,["LastComponentScanTime"]:Pa,["ComponentStatus"]:Wl[this.b8b],["ActionTaken"]:"None. Skipping to Match Interval"};this.fxh=Pa;this.jyh=ea;this.SEb=this.Gdc.$gi;this.b8b=this.LAi(ea,
Pa);3===this.b8b&&(await this.Hzp(),this.b8b=this.LAi(ea,this.Gdc.Nsc));return this.Jal(this.b8b,ea,Pa)}kCn(){return 0===this.b8b}LAi(ea,Pa){let Bb=0;ea>Pa+Math.max(this.SEb,this.m2d)+this.pQi&&(Bb=0===this.NIa?1:this.NIa<this.Yjj?2:this.NIa===this.Yjj?3:4);return Bb}Jal(ea,Pa,Bb){const ac={};ac.WatchDogScanNumber=this.XOd;ac.WatchDogScanTime=Pa;ac.LastComponentScanTime=Bb;ac.ComponentStatus=Wl[ea];ac.ExpectedComponentScanInterval=this.SEb;ac.GraceTimeInMS=this.pQi;ac.ActualTimeBetweenWatchDogAndComponentScans=
Pa-Bb;switch(ea){case 0:ac.ActionTaken="None";this.NIa=0;break;case 1:this.NIa++;ac.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.NIa++;ac.ActionTaken="Component restarted";w.ULS.sendTraceTag(509686347,3037,20,"Restarting Component with interval {0}",this.SEb);this.Gdc.X2j();this.Gdc.g2j(Math.min(this.SEb,this.m2d/2));break;case 3:this.NIa++;ac["ActionTaken?"]="Attempted Synchronous run: "+Wl[ea];break;case 4:w.ULS.sendTraceTag(512570578,3037,15,"Component is not Responding. WatchDog would kickout now"),
ac["ActionTaken?"]="Kickout",ac.ShouldKickout=!0,this.NIa++}ac.NextExpectedComponentScanTimeInMs=Bb+(this.NIa+1)*this.SEb;ac.MissedScans=this.NIa;return ac}async Hzp(){return this.Gdc.Yvi()}Xbp(ea,Pa){return Pa+this.SEb>ea}}Object(f.a)(Mj,"TimerBasedWatchDog",null,[1548]);class bk{constructor(ea,Pa,Bb,ac,Gc,ld,Gd,ue){this.V_=null;this.rQc=this.kla=0;this.XHb=new Date(Date.UTC(0,1,1,0,0));this.EM={};this.NRc=this.MRc=0;this.J6h=async()=>{var Ce;w.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",
this.MRc++);if(this.qf.nq)this.Zod(),this.stop(),w.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.kz.p3a);else{this.XHb=new Date;var tf={};Rg.a.Qxa||(tf.DocxSaveMonitor_IsUpToDate=null===(Ce=this.V_)||void 0===Ce?void 0:Ce.XT);tf.RSNManager_IsUpToDate=this.kz.XT;tf.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.kz.$hc();tf.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.kz.H0d();w.ULS.sendTraceTag(521413850,
3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",tf);if(this.Wk&&!this.Wk.isVisible)w.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.kz.p3a),this.rmo();else if(Ce=this.kz.aic(this.UOd),0<Ce){Ce=this.Dyi(Ce);w.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(Ce));this.rZl&&w.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.hF());if(0==this.kla)this.rQc=this.Nsc;else if(1<this.kla){w.ULS.sendTraceTag(524137233,
3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.kla,this.Nsc-this.rQc);if(this.$mn&&(!await this.kz.ede(this.W3m)||0===this.kz.aic(this.UOd))){this.Zod();return}this.Nhj(Ce,this.Nsc);this.EM.ShouldKickout&&(w.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.EM)),this.I3.TWb(this.YDm()))}this.kla++}else this.Zod(),this.dwl()}};this.K6h=async()=>{await this.J6h();this.m2j()};this.kz=ea;this.qf=Pa;this.I3=Gd;this.KSk=ue;this.AIh=ac;this.UOd=Gc;this.BIh=ld;this.V_=wa.a.instance.Wa("Wonca.IDocxSaveMonitor");
this.EM.ShouldKickout=!1;this.fog=this.Jio;this.Kyj=this.Kio;Bb.execute(Ce=>{this.Wk=Ce});this.qf.cKa(this.u2.bind(this))}get Nsc(){return this.XHb.getTime()}Dyi(ea){return{["NumberOfStaleRevisions"]:ea,["BrowserIsOnline"]:Bn.a[this.qf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.qf.nq,["IsSessionExpired"]:this.qf.ada,["IsSessionLost"]:this.qf.Xqc,["HasEmergencyViewDeployed"]:this.qf.zk,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),
["VisibilityManager_AppVisibilityState"]:this.Wk?hl.a[this.Wk.pC]:"undefined"}}u2(ea,Pa){if(Pa){ea=Date.now();var Bb=this.kz.aic(this.UOd);0<Bb&&(Bb=this.Dyi(Bb),this.Nhj(Bb,ea));this.ORo();this.hMn(Pa.errorCode)}this.stop();this.V_=wa.a.instance.Wa("Wonca.IDocxSaveMonitor")}dwl(){this.ucp?0<this.kz.aic(this.BIh)&&this.uak():this.kz.sde(this.BIh)&&this.uak()}uak(){w.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.KSk.uqf();Sb.a.iIf(Fc.a.ARo)}YDm(){return this.azn?
Ol.a.iQp:this.qf.ada?Ol.a.dik:Ol.a.hQp}stop(){0!==this.NRc&&(window.clearInterval(this.NRc),this.NRc=0);w.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async Yvi(){this.TZp&&this.stop();this.K6h();w.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}zkp(ea){this.NRc=window.setTimeout(this.K6h,ea);w.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.Zod()}m2j(){this.NRc=window.setInterval(this.J6h,this.AIh);w.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");
this.Zod()}ORo(){this.Rwi(this.EM);w.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.EM))}get IOj(){const ea=Object.assign({},this.EM);this.Rwi(ea);return ea}Rwi(ea){ea.shouldKickout||(0==this.kz.aic(this.UOd)?(ea.NoKickoutReason="No Stale Revisions",ea.OldestRevisionCreationTime=this.kz.$lc()):this.Wk&&!this.Wk.isVisible?(ea.NoKickoutReason="Session not active",ea.VisibilityManager_AppVisibilityState=this.Wk.pC):this.q7i&&this.kla<=this.Kyj?(ea.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",
ea.ScansWithPersistentRunawayDataLoss=this.kla):this.kla<=this.fog?(ea.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",ea.ScansWithPersistentRunawayDataLoss=this.kla):ea.NoKickoutReason="undefined");ea.LastScanTime=this.XHb.toISOString();ea.RunCounter=this.MRc}hF(){const ea={};Rg.a.Qxa||this.V_&&(ea.DSM=this.V_.hF());this.kz&&(ea.RSN=this.kz.hF());return ea}Zod(){w.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.kla,this.rQc);this.rQc=this.kla=0}rmo(){this.kla=Math.min(this.fog-1,this.kla);this.rQc=Date.now()}q7i(){return 0===this.Wk.pC&&this.qf.WC&&!this.qf.Xqc&&!this.qf.ada&&!this.qf.zk}Nhj(ea,Pa){this.kla>this.Kyj&&this.q7i()?this.EM.ShouldKickout||(this.EM.ShouldKickout=!0,this.Swi("Persistent RunawayDataLoss detected in active session",Pa,ea)):this.kla>this.fog&&!this.EM.ShouldKickout&&(this.EM.ShouldKickout=!0,this.Swi("Runaway DataLoss persists for more than 3 minutes.",Pa,ea))}Swi(ea,Pa,Bb){this.EM.KickoutTime=
(new Date(Pa)).toISOString();this.EM.KickoutReason=ea;Rg.a.Qxa||(this.EM.DSM_isUpToDate=this.V_?this.V_.XT:"Undefined");this.EM.SessionInfo=Bb}hMn(ea){const Pa=this.EM.ShouldKickout;sa.Health.instance.recordKpiUsage(bk.ALe,1,bk.$5d,null);const Bb=new Map;ea&&Bb.set("ErrorCode",ea.toString());Pa?(Bb.set("ShouldKickout","true"),Bb.set("KickoutTime",this.EM.KickoutTime),Bb.set("Reason",this.EM.KickoutReason),sa.Health.instance.recordKpiSuccess(bk.ALe,Object.assign(new mi.a,{extendedProperties:Bb}))):
(Bb.set("ShouldKickout","false"),ea=this.EM.NoKickoutReason,Bb.set("Reason",ea),sa.Health.instance.recordKpiFailure(bk.ALe,ea,!1,!1,Object.assign(new mi.a,{extendedProperties:Bb})))}X2j(){w.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}g2j(ea){w.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",ea);this.zkp(ea)}get rZl(){return null!=this.SYg?this.SYg:this.SYg=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get W3m(){return null!=this.T0g?this.T0g:this.T0g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get $mn(){return null!=this.w3g?this.w3g:this.w3g=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get Kio(){return null!=this.S7g?this.S7g:this.S7g=m.AFrameworkApplication.J.sc("RunawayDataLossMinimumScansBeforeKickout",1)}get Jio(){return null!=this.R7g?
this.R7g:this.R7g=m.AFrameworkApplication.J.sc("RunawayDataLossMaximumScansBeforeKickout",5)}get ucp(){return null!=this.T8g?this.T8g:this.T8g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUnstuckReplicatorForServerRevision",!1):!1}get azn(){return 1===this.qf.networkState||3===this.qf.networkState}get $gi(){return this.AIh}}bk.ALe="RunAwayDataLossKickout";bk.$5d="wwrelfc";Object(f.a)(bk,"RunawayDataLossMonitor",null,[818,819]);class go{constructor(){this.wjh=
3E4;this.Syk=24E4;this.Tyk=12E4;this.Z=this.VOd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(Rg.a.Wu||Rg.a.Yn)this.VOd=this.Z.resolve(this.name),this.VOd.m2j(),this.Z.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==m.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.Kg.Xhj()}eQl(){return new bk(this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.Z.resolve("Common.ISessionStatus")||Hf.SessionStatusManager.instance,this.Z.Za("Common.App.VisibilityManagement.IVisibilityManager"),
m.AFrameworkApplication.J.sc("RunawayDataLossScanIntervalInMs",this.wjh),this.bSo,this.Tyk,wa.a.instance.Wa("Box4.IKickoutExecutor"),Zj.WoncaApp.TH)}Ec(ea){if(Rg.a.Wu||Rg.a.Yn)this.Z=ea,ea.ja(this.name,this.eQl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.Xug()}dispose(){this.VOd&&this.VOd.stop()}static main(){U.a.instance.Rc(new go)}Xug(){this.Z.ja("WordEditor.RunawayDataLossMonitorWatchDog",()=>new Mj(this.Z.resolve(this.name),m.AFrameworkApplication.J.sc("RunawayDataLossScanIntervalInMs",
this.wjh),m.AFrameworkApplication.J.sc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get bSo(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.cSo)}get cSo(){return m.AFrameworkApplication.J.sc("RunawayDataLossKickoutIntervalInMs",this.Syk)}}Object(f.a)(go,"WordEditorRunawayDataLossMonitorPackage",null,[0,1]);var ng=e(299);class Np{constructor(ea,Pa){this.MRk=ea;this.NRk=Pa}}Object(f.a)(Np,"LastSavedToHostDetailsEventArgs",
null,[853]);class jp{constructor(ea,Pa,Bb,ac,Gc,ld,Gd){this.OWk=5E4;this.Gdf=0;this.XHb=new Date(Date.UTC(0,1,1,0,0));this.xyk=6E4;this.MRc=this.lac=0;this.sa=new S.a;this.wXo=()=>{w.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.MRc++);this.qf.nq||this.llc().then(ue=>{this.sa.raiseEvent(jp.baj,ue);this.Xxh=new Date;ue=this.pdc;this.Wk&&!this.Wk.isVisible&&(ue=this.jVk);this.WGa(ue)}).catch(ue=>{this.WGa(this.eVm(ue))})};this.iQd=ea;this.qf=Bb;
this.zJ=Gc;this.kz=ld;this.pdc=Pa.sc("LastSavedToHostDetailsIntervalMs",6E4);this.fGb=Pa.sc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.jVk=Pa.sc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.pdc);this.oSc=Pa.sc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.v8e=Pa.sc("Microsoft.Office.WordOnline.LastSavedToHostDetailsQueueTimeoutMs",3E4);this.Xxh=new Date;ac.execute(ue=>{this.Wk=ue;this.Wk.Psa((Ce,tf)=>{this.KT(tf)})});this.$f=Gd;0==m.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&
m.AFrameworkApplication.Kg.Xhj();this.WGa(this.pdc)}KT(ea){0!==ea.newState&&1!==ea.newState||0===ea.oldState||1===ea.oldState||this.qf.nq||(this.WGa(this.Gdf),w.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.Xxh,this.Gdf))}Eva(){return 1==this.qf.networkState}llc(){this.XHb=new Date;return new Promise((ea,Pa)=>{if(this.Eva())w.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),
Pa(0);else if(this.qf.ada)w.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),Pa(2);else if(this.kz.XT)w.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),Pa(3);else{var Bb=eo.b(br.construct(this.znc())),ac={"Content-Type":"application/json; charset=utf-8"};w.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");if(this.ecp)Rg.a.ACc.iu({url:jp.serviceUrl,method:"POST",body:Bb,headers:ac,
vzc:this.oSc,w0f:!0}).then(ld=>{this.mpo(ld,ea,Pa)}).catch(ld=>{w.ULS.sendTraceTag(508073635,3037,15,"Failed to get LastSavedToHostDetails with CRMV2. Failed with error code: {0}",ld.errorCode);ld.errorCode===ng.b.Timeout?Pa(0):Pa(2)});else if(this.fcp){var Gc=0;Gc=this.$f.addRequest(jp.serviceUrl,2,Bb,ac,!1,0,ld=>this.caj(ld,ea,Pa),ld=>this.daj(ld,Pa),null,null,!1,this.v8e,this.oSc,null,null,!0);0>=Gc&&(w.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Gc.toString()),Pa(0))}else Gc=
0,Gc=this.iQd.addRequest(jp.serviceUrl,2,Bb,ac,!1,0,ld=>this.caj(ld,ea,Pa),ld=>this.daj(ld,Pa),null,null,!0,this.oSc),0>=Gc&&(w.ULS.sendTraceTag(508650827,3037,15,"Invalid request id returned "+Gc.toString()),Pa(0))}})}mpo(ea,Pa,Bb){const ac={},Gc=ea.headers.get(Ri.a.u4);ac.HttpStatus=ea.status;ac.Correlation=Gc;w.ULS.sendTraceTag(508650831,3037,50,"LastSavedRevisionID Response Summary: {0}",ac);ea.ok?ea.text().then(ld=>{ld=this.WWa(ld);ld||(w.ULS.sendTraceTag(508650829,3037,15,"LastSavedRevisionResponse is null"),
Bb(2));w.ULS.sendTraceTag(508073634,3037,50,"Successfully retrieve LastSavedToHostDetails.");this.zJ.r3a(ld);Pa(new Np(ld.LastSavedRevisionId,ld.RevisionSequenceNumber))}).catch(ld=>{w.ULS.sendTraceTag(508650828,3037,15,"Failed to parse LastSavedRevisionResponse. Exception: {0}",ld.toString());Bb(2)}):(w.ULS.sendTraceTag(508650830,3037,15,"LastSavedRevisionResponse failed with status code: {0}",ea.status),ea.status===Vj.a.e$?Bb(1):ea.status===Vj.a.Xzb?Bb(0):Bb(2))}daj(ea,Pa){let Bb=2;if(ea=ea.data){if(5===
ea.status)Bb=1;else if(7===ea.status||13===ea.status)Bb=0;w.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",ea.status))}else w.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");Pa(Bb)}caj(ea,Pa,Bb){if(ea=ea.data){var ac={},Gc=ea.Pi?ea.Pi[Ri.a.u4]:"";ac.HttpStatus=ea.Xe;ac.Correlation=Gc;ac.Id=ea.id;w.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",ac);(ea=this.WWa(ea.responseData))?
(this.zJ.r3a(ea),Pa(new Np(ea.LastSavedRevisionId,ea.RevisionSequenceNumber))):(w.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),Bb(2))}else w.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),Bb(2)}WGa(ea){0!==this.lac&&window.clearTimeout(this.lac);this.lac=window.setTimeout(this.wXo,ea);w.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+ea)}znc(){const ea=qe.StaticActiveAppFrame.Aa().tb.Xc;return ea?ea.Fd:null}eVm(ea){return 1===
ea?this.Gdf:0===ea?this.OWk:3===ea?this.pdc:this.fGb}WWa(ea){let Pa;return({group:Pa}=Ro.a.A6(ea)).returnValue?Pa.Responses[0]:null}c9k(ea){this.sa.addHandler(jp.baj,ea)}async Yvi(){const ea=new Promise((Pa,Bb)=>{window.setTimeout(Bb,3E3)});await Promise.race([ea,this.llc()]).then(()=>{w.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{w.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}X2j(){0!==this.lac&&(w.ULS.sendTraceTag(509215702,3037,
50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.lac),this.lac=0)}g2j(ea){w.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",ea);this.WGa(ea)}get Nsc(){return this.XHb.getTime()}get $gi(){return this.xyk}hF(){const ea={};ea.LastScanTime=this.XHb.toISOString();ea.RunCounter=this.MRc;return ea}get ecp(){return null!=this.R8g?this.R8g:this.R8g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseCRMV2",
!1):!1}get fcp(){return null!=this.S8g?this.S8g:this.S8g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToClientRequestManager",!1):!1}}jp.baj="ULSTHD";jp.serviceUrl=Rg.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(f.a)(jp,"LastSavedToHostDetailsManager",null,[820,819]);class aq{constructor(ea,Pa,Bb){this.Z4m=ea;this.YFa=Pa;this.PEn=Bb;this.Nng=()=>{const ac=this.Z4m();return 32!==ac?ac:!this.YFa||this.YFa.XT?
32:8};this.KFp=(ac,Gc,ld,Gd,ue)=>{this.PEn.WGa(parseInt(ue.toString()));return 32}}mc(ea){ea.qa(Vg.a.Nng,ii.a.view,this.Nng);ea.qa(Vg.a.Kbk,ii.a.view,this.KFp);ea.Oc(Vg.a.Kbk,101)}}Object(f.a)(aq,"LastSavedToHostDetailsManagerActor",null,[]);class ho{constructor(){this.Z=null}get name(){return"WordEditor.LastSavedToHost"}Ec(ea){const Pa=m.AFrameworkApplication.J;this.Z=ea;const Bb=new vm(m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.pe.b3,m.AFrameworkApplication.pe.n2d);this.Z.ja("WordEditor.ILastSavedToHostDetailsManager",
()=>new jp(Bb,Pa,this.Z.Wa("Common.ISessionStatus")||Hf.SessionStatusManager.instance,this.Z.Za("Common.App.VisibilityManagement.IVisibilityManager"),Sg.a.instance,this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),m.AFrameworkApplication.pe)).ha();this.Xug()}init(){(new aq(()=>Zj.WoncaApp.TH.PSi(),this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager"))).mc(m.AFrameworkApplication.va);this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager");
this.Z.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){U.a.instance.Rc(new ho)}Xug(){this.Z.ja("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new Mj(this.Z.resolve("WordEditor.ILastSavedToHostDetailsManager"),m.AFrameworkApplication.J.sc("LastSavedToHostDetailsIntervalMs",6E4),m.AFrameworkApplication.J.sc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(f.a)(ho,"LastSavedToHostDetailsPackage",null,[0,1]);var Hk=e(1428),io=e(1498);class bq{constructor(ea,
Pa,Bb,ac){this.iIl=ea;this.XOb=Pa;this.gIl=Bb;this.appSettings=ac;this.Avl=async()=>{const Gc=io.a.I2a(),ld=Promise.race([this.r6n(),new Promise(Gd=>setTimeout(()=>Gd(!1),5E3))]);w.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",Gc.Tjc);return ld};this.r6n=async()=>{if(!this.yqn||!this.Gmn)return!1;await this.dSg();return await this.gIl.mrf()&&await this.iIl.mrf()?!0:!1};this.$pn=new zc.a(this.Avl)}async isEnabled(){return this.$pn.value}get yqn(){const ea=
this.XOb.isInsertActionEnabled,Pa=this.XOb.isRewriteActionEnabled,Bb=this.XOb.isVisualizeAsTableEnabled;return this.XOb.isStartActionEnabled||ea||Pa||Bb}get Gmn(){return ub.a.Hj?this.XOb.isFirefoxAllowed:!0}async dSg(){return new Promise(ea=>{this.appSettings.lq(()=>{ea(!0)})})}}Object(f.a)(bq,"CopilotComposeFeatureCondition",null,[]);class os{constructor(ea){this.nid=async()=>{const Pa=await this.Vbj.value;await this.z$c(Pa);return Pa};this.heo=U.a.instance;this.Vbj=new zc.a(ea);this.nen=new zc.a(this.nid)}async K8(){await this.Vbj.value}async u2c(){return await this.nen.value}async z$c(ea){U.a.instance.Rc(ea);
return new Promise(Pa=>{this.heo.registerOnPackageInit(ea.name,Pa)})}}Object(f.a)(os,"LazyLoadedPackage",null,[]);var ti=e(2160),Fl=e(2123);const Kq=new os(()=>Promise.all([e.e(4),e.e(2),e.e(11)]).then(e.bind(null,2141)).then(ea=>ea.instance));class Tl{constructor(ea,Pa){this.wPp=ea;this.logger=Pa;this.nid=async()=>{await this.logger.measureActivityPerformanceAsync(this.p1c,{name:"Initialize",dataFields:[...Object(Fl.a)(ti.a.getFields({featureName:"CopilotCompose",eYd:ti.a.R5b.ContentGeneration,oRb:ti.a.lHa.IsEnabled,
isUserInitiated:!1}))]})};this.p1c=async()=>{await Promise.all([Kq.K8(),this.wPp.loadChunk("copilotComposeUx")]);await Kq.u2c()}}initialize(){this.nid().catch(ea=>{w.ULS.yA(508913495,3048,10,ea,"Failed to initialize CopilotCompose")})}}Object(f.a)(Tl,"CopilotComposeInitializer",null,[]);class Om{constructor(ea,Pa){this.appSettings=ea;this.Ncl=Pa;this.B7f="Copilot";this.fpl="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped";this.Xdo="Microsoft.Office.WordOnline.CopilotLicensePaywallNoPassOverrideEnabled"}async mrf(){const ea=
await this.Yvl();w.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",ea);return 1===ea||0===ea}async Yvl(){if(this.prl())return 0;const ea=io.a.I2a(),Pa=await this.CVf();w.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",ea.Tjc);return Pa?this.tap()?3:1:2}prl(){return this.appSettings.getBooleanFeatureGate(this.fpl,!1)}tap(){return this.appSettings.getBooleanFeatureGate(this.Xdo,!1)}async CVf(){return(await Object(oa.b)(this.Ncl)).isFeatureEnabled(this.B7f,!1)}}Object(f.a)(Om,
"CopilotComposeLicenseCondition",null,[]);var cq=e(1641);class on{constructor(ea){this.appSettings=ea}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",
!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isCiqTeachingUiEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqTeachingUiEnabled",!1)}get isCiqMultilingualEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqMultilingualEnabled",
!1)}get isCiqBrowseCloudFilesEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCiqBrowseCloudFilesEnabled",!1)}get isCiqAuthenticationFilterEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCiqAuthenticationFilterEnabled",!0)}get isCopilotPluginsEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCopilotPluginsEnabled",!1)}get isLogToAshaEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsLogToAshaEnabled",
!1)}get isTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.CopilotCompose.isTableRenderingEnabled",!1)}get isVisualizeAsDiagramEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.CopilotCompose.isVisualizeAsDiagramEnabled",!1)}get isStylizedTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isStylizedTableRenderingEnabled",!1)}get streamingWordsPerSecond(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingWordsPerSecond",
15)}get streamingBetweenChunkDelayMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingBetweenChunkDelayMs",110)}get isFirefoxAllowed(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsFirefoxAllowed",!1)}get streamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingChunkGenerationTimeoutMs",2E4)}get isAdminControlEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",
!1)}get isFeedbackSdkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.FeedbackSdkEnabled",!1)}get isSupportedLanguagesLinkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSupportedLanguagesLinkEnabled",!1)}get isAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoAcceptFixEnabled",!1)}get isMultiTurnEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnEnabled",
!1)}get isProactiveSurveysEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsProactiveSurveysEnabled",!1)}get isRewriteV2Enabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteStreamingWorkflowEnabled",!1)}get isRewriteFormattedTextBoxEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isRewriteFormattedTextBoxEnabled",!0)}get insertTextContextParagraphsCountLimit(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.InsertTextContextParagraphsCountLimit",
6)}get isMultiTurnExpandedInputEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnExpandedInputEnabled",!1)}get isDesignerSuggestionsSuppressionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDesignerSuggestionsSuppressionEnabled",!1)}get isSetParagraphLanguageEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSetParagraphLanguageEnabled",
!1)}get isWrongIntentUnhighlightEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsWrongIntentUnhighlightEnabled",!0)}get isDynamicAnchoringEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDynamicAnchoringEnabled",!1)}get isVisualizeAsTableEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsVisualizeAsTableEnabled",!1)}get isNewLineAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNewLineAutoAcceptFixEnabled",
!0)}get isPromptAssistanceEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsPromptAssistanceEnabled",!1)}get isFrameModeEditOnlyEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isFrameModeEditOnlyEnabled",!0)}get isFeedbackAdminPolicyCheckEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isFeedbackAdminPolicyCheckEnabled",!0)}get isSensitivityLabelInheritanceEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isSensitivityLabelInheritanceEnabled",
!1)}get suppressStartProactiveOpening(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.suppressStartProactiveOpening",!1)}get removePreviewTag(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.RemovePreviewTag",!1)}get pluginEntityAdditionalGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.pluginEntityAdditionalGenerationTimeoutMs",3E4)}get isRewriteAshaLoggingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isRewriteAshaLoggingEnabled",
!0)}}Object(f.a)(on,"CopilotComposeFeatureGatesImpl",null,[]);class Jl{constructor(ea,Pa){this.HYc=ea;this.XOb=Pa}async mrf(){if(!this.XOb.isAdminControlEnabled)return!0;const ea=io.a.I2a();try{return!await (await Object(oa.b)(this.HYc)).nN("CopilotContentGeneration",!0)}finally{w.ULS.sendTraceTag(508651538,3048,50,"Admin policy check took: {0}ms",ea.Tjc)}}}Object(f.a)(Jl,"CopilotComposeAdminPolicyCondition",null,[]);class Uo extends Hk.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}bXa(ea){ea.ja("WordEditor.Copilot.Compose.EditorAiTelemetryLogger",
()=>new cq.a(ea.resolve("Wac.Common.Utils.IOtelWrapper"),"CopilotCompose")).ha()}dXa(){const ea=wa.a.instance;(new Tl(ea.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),ea.resolve("WordEditor.Copilot.Compose.EditorAiTelemetryLogger"))).initialize()}cXa(){}static main(){Uo.rum().isEnabled().then(ea=>{ea&&U.a.instance.Rc(new Uo)}).catch(()=>{w.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static rum(){const ea=wa.a.instance;ea.ja("WordEditor.Copilot.Compose.CopilotComposeFeatureGates",
()=>new on(m.AFrameworkApplication.J)).ha();ea.ja("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new Om(m.AFrameworkApplication.J,ea.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();ea.ja("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition",()=>new Jl(ea.Za("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"))).ha();ea.ja("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",
()=>new bq(ea.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"),ea.resolve("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition"),m.AFrameworkApplication.J)).ha();return ea.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}Object(f.a)(Uo,"CopilotComposeEntryPackage",Hk.a,[]);var Vo=e(1432);class dq extends Vo.a{constructor(ea){var Pa;super("BooleanFeatureGateConditionId");this.ns=ea.ns;
this.e3c=ea.e3c;this.defaultValue=null!==(Pa=ea.defaultValue)&&void 0!==Pa?Pa:!1}initialize(){super.initialize();const ea=m.AFrameworkApplication.J;ea.lq(()=>{const Pa=ea.getBooleanFeatureGate(this.e3c,this.defaultValue);this.ri(Pa)})}ri(ea){super.ri(ea);w.ULS.sendTraceTag(512369937,3028,50,this.d1(this.ns,ea,`featureGate=${this.e3c}`))}}Object(f.a)(dq,"BooleanFeatureGateCondition",Vo.a,[]);class gr extends Vo.a{constructor(ea){var Pa;super("DocumentOwnerConditionId");this.ns=ea.ns;this.lFg=null!==
(Pa=ea.lFg)&&void 0!==Pa?Pa:!0}initialize(){super.initialize();const ea=m.AFrameworkApplication.J;ea.lq(()=>{const Pa=ea.$("IsDocumentOwner");this.ri(Pa===this.lFg)})}ri(ea){super.ri(ea);w.ULS.sendTraceTag(508958623,3028,50,this.d1(this.ns,ea))}}Object(f.a)(gr,"DocumentOwnerCondition",Vo.a,[]);var Pm=e(1391);class Wo extends Pm.a{constructor(ea,Pa,Bb){super("LicensePaywallCondition");this.Qnb=ea.ns;this.sBk=ea.Abm;this.za=Pa;this.Rw=Bb}initialize(){super.initialize();this.mIl()}he(){super.he()}mIl(){this.za.lq(()=>
{!this.za.$("IsAnonymousUser")&&this.Rw?this.Rw.execute(ea=>{this.r2e=Date.now();ea.isFeatureEnabled(this.sBk,!1).then(Pa=>{this.r2e=Date.now()-this.r2e;this.ri(Pa)})}):this.ri(!1)})}ri(ea){super.ri(ea);w.ULS.sendTraceTag(508884163,3028,50,this.d1(this.Qnb,ea,"Latency for license check: "+this.r2e.toString()+"ms"))}}Object(f.a)(Wo,"LicensePaywallCondition",Pm.a,[]);var vo=e(1781),hg=e(1796),co=e(1464);class tq extends co.a{constructor(ea){super(23,ea,null,3028,"SkittleInitializationTriggered")}}Object(f.a)(tq,
"SkittleInitializationTriggerModel",co.a,[]);var iu=e(546);class Qm{constructor(){this.Aia=(ea,Pa)=>{Pa.succeeded||w.ULS.sendTraceTag(508618435,3049,10,"Async loading of skittle module failed")}}Sen(ea){const Pa=iu.a.Instance().eTb().Ptb("WordEditor.Skittles");Pa.Tqc()||this.XIn(ea).then(()=>{Pa.qtc(this.Aia)}).catch(()=>{w.ULS.sendTraceTag(508618436,3049,10,"Async loading of skittle ux chunk failed")})}async XIn(ea){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):
(await Object(oa.b)(ea)).JE.loadScript("copilotSummarySkittleUx")}}Object(f.a)(Qm,"SkittlesProxyConsumerImpl",null,[878]);class Ik{static JRm(){return new Qm}}Object(f.a)(Ik,"SkittlesProxyConsumerFactory",null,[]);class zh{constructor(ea,Pa){this.S0j=ea;this.rAg=Pa;this.x0i=!1;this.fjd=async(Bb,ac)=>{if(ac.zja){Object(qf.a)("SkittleInitializationTriggered");for(const Gc of this.S0j)Gc.NFa(this.fjd),Gc.he();this.x0i||(this.x0i=!0,Ik.JRm().Sen(this.rAg))}}}initialize(){w.ULS.sendTraceTag(508621533,
3049,50,"SkittleInitializer has begun initializing skittle trigger models");for(const ea of this.S0j)ea.Qsa(this.fjd),ea.initialize()}}Object(f.a)(zh,"SkittleInitializer",null,[]);class jo extends Hk.a{get name(){return"WordEditor.SkittleEntryPackage"}bXa(ea){this.container=ea}dXa(){const ea=new qb.a;if(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",!1)){var Pa=ea.push,Bb=this.container,ac=Bb.resolve("WordEditor.WordCount.IWordCountManagerFactory"),
Gc=Bb.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Bb=Bb.Za("Common.App.Policy.Contracts.IPolicyManager");var ld=new dq({ns:24,e3c:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const Gd=new dq({ns:24,e3c:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),ue=new gr({ns:24,lFg:!1});ld=new qb.a([ld,Gd,ue]);m.AFrameworkApplication.ud("fbc73697;a29b4114");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",
!1)&&(Gc=new Wo({ns:24,Abm:"Copilot"},m.AFrameworkApplication.J,Gc),ld.add(Gc));m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SummarySkittleDocumentAccessConditionSkipped",!1)&&(Gc=Object(hg.b)(24,Bb),ld.add(Gc));m.AFrameworkApplication.ud("f5gia801;0f27g313");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)&&(ac=new vo.a({ns:24,$Op:ac,Swa:Bb}),
ld.add(ac));Pa.call(ea,new tq(ld))}0!==ea.count&&(new zh(ea,this.container.Za("Common.IDynamicScriptLoaderProvider"))).initialize()}cXa(){}static main(){U.a.instance.Rc(new jo)}}Object(f.a)(jo,"SkittleEntryPackage",Hk.a,[]);var ps=e(212),qs=e(229),ko=e(131);class La{constructor(ea,Pa,Bb){this.ga=ea;this.vv=Pa;this.za=Bb}mc(){this.za.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(u.a.YAc,x.a.frame,Object(P.a)(this.vv,this.vv.YAc,"showZoomDialog")),this.ga.nb(u.a.vto,x.a.frame,Object(P.a)(this.vv,this.vv.Msj,
"onQueryZoomText"),96),this.ga.qa(u.a.ayd,x.a.frame,Object(P.a)(this.vv,this.vv.Eik,"zoomDialogTabFocusHandler")),this.ga.qa(u.a.$xd,x.a.frame,Object(P.a)(this.vv,this.vv.Eik,"zoomDialogTabFocusHandler")));this.za.$("ZoomSliderIsEnabled")&&(this.ga.nb(u.a.tDj,x.a.frame,Object(P.a)(this.vv,this.vv.R8n,"onQueryZoomPercentage"),96),this.ga.nb(u.a.Hik,x.a.frame,Object(P.a)(this.vv,this.vv.wbo,"onZoomToPercentage"),96),this.ga.qa(u.a.WSp,x.a.frame,ko.ActionManager.qg))}}Object(f.a)(La,"CommonZoomActor",
null,[1875]);class $a extends La{constructor(ea,Pa,Bb){super(ea,Pa,Bb);this.Ila=Pa}mc(){super.mc();this.za.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(Vg.a.hTg,x.a.frame,ko.ActionManager.qg),this.ga.qa(Vg.a.GKe,x.a.frame,Object(P.a)(this.Ila,this.Ila.VSp,"zoomTo100")));this.ga.qa(Vg.a.P5b,x.a.frame,Object(P.a)(this.Ila,this.Ila.P5b,"zoomToPageWidth"));this.ga.qa(u.a.Vub,x.a.frame,Object(P.a)(this.Ila,this.Ila.Vub,"increaseZoom"));this.ga.qa(u.a.Zqb,x.a.frame,Object(P.a)(this.Ila,this.Ila.Zqb,"decreaseZoom"));
this.ga.qa(Vg.a.SAg,x.a.frame,Object(P.a)(this.Ila,this.Ila.C7o,"setZoomLevelFromRibbon"));this.ga.nb(Vg.a.vzb,x.a.frame,Object(P.a)(this.Ila,this.Ila.Msj,"onQueryZoomText"),96);this.ga.nb(Vg.a.jwe,ii.a.application,Object(P.a)(this.Ila,this.Ila.Q8n,"onQueryZoomLevelLabelText"),96);this.ga.qa(pe.a.Rgi,x.a.frame,ko.ActionManager.qg);this.ga.qa(pe.a.Qgi,x.a.frame,ko.ActionManager.qg);this.ga.qa(pe.a.Vgi,x.a.frame,ko.ActionManager.qg);this.ga.qa(pe.a.Sgi,x.a.frame,ko.ActionManager.qg);this.ga.qa(Vg.a.vqa,
x.a.frame,ko.ActionManager.qg)}}Object(f.a)($a,"WordEditorZoomActor",La,[]);class Jb{constructor(ea,Pa){this.zoom=ea;this.ral=Pa}}Object(f.a)(Jb,"SetCustomZoomArgs",null,[]);var uc=e(1791),Sc=e(169);class nd{constructor(ea,Pa){this.vUl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.wUl=[nd.gAf,nd.Y2d,"200","150","100","75","50"];this.Nta=3;this.iS=0;this.delta=.1;this.v7f=0;this.vd=new S.a;this.Xi=null;this.J=ea;this.Tb=Pa;this.DWj(1)}get Ql(){return this.iS}DWj(ea){this.iS=
ea}get c0c(){return Math.round(100*this.Ql)}get uYn(){return Math.floor(this.c0c/10)/10+this.delta}get tYn(){return Math.ceil(this.c0c/10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}g9k(ea){this.vd.addHandler("ZoomChanged",ea)}CJo(ea){this.vd.removeHandler("ZoomChanged",ea)}UW(ea){this.g9k(ea)}NPa(ea){this.CJo(ea)}TGj(){}MIj(){}SGj(){}LIj(){}byd(ea){this.Fik(ea,this.Ql)}Fik(ea,Pa){null!==ea&&Sc.a.oVj(ea,Pa)}FEg(ea,Pa=!0){let Bb=ea*=100;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&
(Bb=new Jb(ea,Pa));this.lTj(Bb)}B7o(ea,Pa=!1){this.vqa(ea,3|(Pa?0:4))}ubo(ea,Pa,Bb){if(1===ea)return 32;ea=Bb/100;ea<this.Igd?ea=this.Igd:ea>this.kgd&&(ea=this.kgd);this.vqa(ea,1);Pa&&(Pa.Av=Math.floor(100*ea));return 32}Msj(ea,Pa,Bb,ac,Gc){if(1===Bb)return 32;ea=Fa.a.tMa(this.c0c,6,m.AFrameworkApplication.numberFormat);Gc.Value=ea;Gc.LabelText=ea;return 32}wbo(ea,Pa,Bb,ac,Gc){return 1===Bb?32:this.ubo(Bb,ac,Gc.value)}R8n(ea,Pa,Bb,ac,Gc){Gc.MinValue=100*this.Igd;Gc.MaxValue=100*this.kgd;Gc.value=
this.c0c;return 32}yPi(){return this.vUl}zPi(){return this.wUl}rvm(){let ea=Math.floor(100*this.Ql).toString();1===this.Nta?ea=nd.gAf:2===this.Nta&&(ea=nd.Y2d);return ea}Vub(ea,Pa,Bb){if(1===Bb)return 32;this.yfd(this.Tb?this.Tb.JD:0,"IncreaseZoom");this.Nta=0;this.vqa(this.uYn);return 32}Zqb(ea,Pa,Bb){if(1===Bb)return 32;this.yfd(this.Tb?this.Tb.JD:0,"DecreaseZoom");this.Nta=0;this.vqa(this.tYn);return 32}C7o(ea,Pa,Bb,ac,Gc){if(1===Bb)return 32;this.yfd(this.Tb?this.Tb.JD:0,"SetZoomLevelFromRibbon");
ea=Gc.Value;if(ea.toLowerCase().startsWith("fit"))return ea=new Kc.a(0,1,0,()=>{this.P5b(0,null,2,null,null)},138,void 0,!0),ei.TaskManager.instance.pc(ea),32;ea=parseInt(ea)/100;if(isNaN(ea))return 2;this.Nta=0;this.vqa(ea);return 32}yfd(ea,Pa){w.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",ea,Pa,m.AFrameworkApplication.ta.Pb.$t)}YAc(ea,Pa,Bb){if(1===Bb)return 32;w.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();
return 32}showDialog(){const ea=this.rvm();this.Xi=new uc.a(this.yPi(),this.zPi(),Object(P.a)(this,this.t3m,"handleZoomDialogResult"),zf.FocusManager.instance(),!0);this.Xi.YAc(CommonUIStrings.l_ZoomDialogTitle,ea)}epn(ea){return ea.toLowerCase()===nd.gAf.toLowerCase()}fpn(ea){return ea.toLowerCase()===nd.Y2d.toLowerCase()}t3m(ea){if(ea){if(this.epn(ea)){this.Nta=1;var Pa=32}else if(this.fpn(ea))this.Nta=2,Pa=this.P5b(0,null,2,null,null);else if(Pa=Number.parseInvariant(ea)){this.Nta=0;let Bb=Pa;
this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(Bb=new Jb(Pa,!0));Pa=this.lTj(Bb)}else Pa=8;32===Pa?w.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:ea}):w.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:ea})}else w.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:ea})}kvo(){this.vd.raiseEvent("ZoomChanged",null)}WDj(){}jtg(){}Eik(ea){if(!this.Xi)return 2;var Pa=this.Xi.focusManager.Cv().Al.Kta;if(Pa===this.Xi.mD&&
ea===u.a.ayd||Pa===this.Xi.YK&&ea===u.a.$xd)this.Xi.AMb||this.Xi.pVo(),this.Xi.focusManager.Cv().Al.eC(this.Xi.AMb);else if(Pa.id.startsWith(this.Xi.Bmd)||Pa.className.startsWith(this.Xi.BDj))Pa=null,ea===u.a.ayd?Pa=this.Xi.YK:ea===u.a.$xd&&(Pa=this.Xi.mD),this.Xi.focusManager.Cv().Al.eC(Pa),Sys.UI.DomElement.removeCssClass(this.Xi.AMb.parentNode,this.Xi.Tsg);else if(ea===u.a.ayd)this.Xi.focusManager.Cv().quc();else if(ea===u.a.$xd)this.Xi.focusManager.Cv().ouc();else return 2;return 32}}nd.gAf="FullPage";
nd.Y2d="PageWidth";Object(f.a)(nd,"ZoomManager",null,[88]);var O;(function(ea){ea[ea.Ghj=0]="manual";ea[ea.b9p=1]="fitToFullPage";ea[ea.vui=2]="fitWidth";ea[ea.Mhg=3]="onBoot"})(O||(O={}));Object(f.b)("ZoomStatus",O);e(1264);var la;(function(ea){ea[ea.normal=0]="normal";ea[ea.Kto=1]="quiet";ea[ea.ili=2]="disableScrollUpdate";ea[ea.O_l=4]="disableUiControlUpdate"})(la||(la={}));Object(f.b)("ZoomUpdateFlags",la);var cb=e(288),Nb=e(57),fc=e(237),Hc=e(346),Qc=e(257),ud=e(1045),Xd=e(485);class $e extends nd{constructor(ea,
Pa,Bb,ac,Gc,ld,Gd){super(ea,Pa);this.hPp=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.iPp=[nd.Y2d,"200","150","125","100","75","50"];this.kff=this.rMj=!1;this.ceh="AutoFitForAdaptiveLayout";this.SBk="FitPageWidthFailure";this.TXk="UpdateZoomFailure";this.jZk="wwf";this.Egf=null;this.SFj=()=>{this.Nta===O.vui&&this.dHf()};this.BSl=ue=>{if(ue.ctrlKey){m.AFrameworkApplication.va.Vb(pe.a.Sgi,2);ue=ue.$Np;if(!ue)return!1;this.vqa(this.Ql-(0<ue?.1:-.1));this.yfd(6,"CtrlScroll");
return!0}return!1};this.vbo=()=>{w.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.Jla=Bb;this.Rn=ac;this.oc=Gc;this.xh=ld;this.RKc=Gd;this.Hwh=ea.$("KeepViewAfterZoomIsEnabled");this.kZk=ea.$("ZoomShortCutIsEnabled");this.gYk=ea.$("DoNotAutoScrollAfterPinchIsEnabled");this.CGk=(this.qGk=ea.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&ea.$("AutoFitForSmallScreenModeIsEnabled");this.Nzk=ea.$("DoNotProcessUpdateZoomActionIsEnabled");this.lZk=
ea.$("ZoomSliderIsEnabled");this.bD()}get appName(){return"WordEditor"}get kgd(){return 4}get Igd(){return.1}get CSl(){return wacBoot.CtrlWheelMetrics}D8k(ea){this.vd.addHandler("PinchStart",ea)}pJo(ea){this.vd.removeHandler("PinchStart",ea)}C8k(ea){this.vd.addHandler("PinchEnd",ea)}oJo(ea){this.vd.removeHandler("PinchEnd",ea)}get rJ(){return null!=this.s9g?this.s9g:this.s9g=wa.a.instance.Wa("WordEditor.IStatusBarUser")}uek(ea){ea=!(ea&la.O_l);const Pa=mb.a.get_instance().isCompleted(7);return ea&&
Pa?(ea={SelectZoomOption:"ComboBoxModel"},qe.StaticActiveAppFrame.Aa()&&qe.StaticActiveAppFrame.Aa().UH(ea),this.eJp(),!0):!1}vqa(ea,Pa=la.normal){let Bb=!0;this.Nzk||m.AFrameworkApplication.va.Vb(Vg.a.vqa,2);if(this.Ql===ea)return this.kff||(this.kff=this.uek(Pa)),Bb;ea>this.kgd?ea=this.kgd:ea<this.Igd&&(ea=this.Igd);var ac=!!(Pa&la.Kto);1===ea||ac||m.AFrameworkApplication.va.Vb(Vg.a.hTg,2);try{ac=null;qe.StaticActiveAppFrame.Aa()&&Object(Qc.a)(ud.a,qe.StaticActiveAppFrame.Aa().tb.Xc)&&(ac=qe.StaticActiveAppFrame.Aa().tb.Xc);
let Gc=-1,ld=-1,Gd=-1;const ue=!(Pa&la.ili);this.Hwh&&ue&&(Gc=wj.a.cPi(Xh.a.instance.ob.currentSelection,ac),ld=ac.zK.scrollLeft,Gd=ac.zK.scrollTop);const Ce=this.Ql;this.DWj(ea);this.kvo();this.kff=this.uek(Pa);ue&&this.DHp(ac,Gc,ld,Gd,Ce)}catch(Gc){Bb=!1,w.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Gc)}return Bb}DHp(ea,Pa,Bb,ac,Gc){ea&&ea.isActive?this.Hwh?0<=Pa&&100>=Pa?ea.Ir.c6(100-Pa,!0,!0):ea.Ir.ADn(Bb,ac,Gc,this.Ql):ea.Ir.c6():w.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}VSp(ea,
Pa,Bb){2===Bb&&(this.yfd(this.Tb?this.Tb.JD:0,"ZoomTo100"),this.Nta=O.Ghj,this.vqa(1));return 32}lTj(ea){this.Nta=O.Ghj;let Pa,Bb=!0;if(this.gYk){if(!Object(Qc.a)(Jb,ea))return w.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Pa=ea.zoom/100;Bb=ea.ral}else Pa=Number.parseInvariant(String.format("{0}",ea))/100;w.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Pa);ea=la.normal;Bb||(ea=la.ili);this.vqa(Pa,ea);return 32}P5b(ea,Pa,Bb){if(1===Bb)return 32;
w.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(qf.a)("ZoomToPageWidth",!0);this.Nta=O.vui;this.t8l();return this.dHf()}Q8n(ea,Pa,Bb,ac,Gc){if(1===Bb)return 32;ea=Fa.a.tMa(this.c0c,6,m.AFrameworkApplication.numberFormat);Gc[cb.a.labelText]=ea;return 32}yPi(){return this.hPp}zPi(){return this.iPp}t8l(){this.rMj||(qe.StaticActiveAppFrame.Aa()?(qe.StaticActiveAppFrame.Aa().f4(this.SFj),this.rMj=!0):w.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}dHf(){var ea=
this.Jla.sDi();if(!ea)return 8;for(var Pa=0;ea;)Pa=Math.max(Pa,fc.a.instance.nx(ea)),ea=this.Jla.N6c(ea);ea=Nb.a.Zj(Pa,0);(Pa=this.RKc())&&Pa.oCe()&&(ea+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());ea+=2*Hc.a.JSg;ea=qe.StaticActiveAppFrame.Aa().VH.offsetWidth/ea;this.vqa(ea);return 32}eJp(){this.rJ&&(this.lZk?(this.rJ.OW(Xd.a.QSp),this.rJ.OW(Xd.a.SSp)):this.rJ.OW(Xd.a.TSp))}Clp(ea){ea||(ea=window.self.CtrlWheelMetrics);if(ea){var Pa=ea.ctrlWheelOccurred;if("boolean"!==typeof Pa)w.ULS.sendTraceTag(594346948,
353,15,"ctrlWheelMetrics module not found");else{w.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Pa);try{ea.stop()}catch(Bb){w.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",Bb)}}}else w.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}bD(){this.Clp(this.CSl);if(this.Rn){var ea=document.getElementById(Qh.a.G3d);ea&&this.Rn.Cb(ca.a.Jxb,ea,this.BSl)}this.oc&&(ea=this.oc.te(Qh.a.LI),this.kZk&&(ea.bindAction(Ub.KeyInputManager.xc(nh.a.cEc,Ub.KeyInputManager.Ji),
u.a.Vub),ea.bindAction(Ub.KeyInputManager.xc(nh.a.hxd,Ub.KeyInputManager.Ji),u.a.Vub),ea.bindAction(Ub.KeyInputManager.xc(nh.a.dEc,Ub.KeyInputManager.Ji),u.a.Zqb),ea.bindAction(Ub.KeyInputManager.xc(nh.a.eEc,Ub.KeyInputManager.Ji),u.a.Zqb),ea.bindAction(Ub.KeyInputManager.xc(nh.a.ezd,Ub.KeyInputManager.Ji),Vg.a.GKe)));this.xh&&(this.Egf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.xh.Cb(ca.a.click,this.Egf,this.vbo);this.CGk&&(qe.StaticActiveAppFrame.Aa().ES.registerLayoutBreakpointChanged("canvas",
Pa=>{this.$mf(Pa)}),qe.StaticActiveAppFrame.Aa().ES.registerBoundingWindowRectsChanged("canvas",()=>{this.$mf(qe.StaticActiveAppFrame.Aa().ES.getLayoutBreakpoint())}))}$mf(ea){let Pa=!0,Bb="";if(this.Nta!==O.Mhg)return Pa;sa.Health.instance.recordKpiUsage(this.ceh,0,this.jZk,null);switch(ea){case "Small":8===this.dHf()&&(Bb=this.SBk,Pa=!1);break;default:1===this.Ql||this.vqa(1)||(Bb=this.TXk,Pa=!1)}Pa||sa.Health.instance.recordKpiFailure(this.ceh,Bb,!0,!0,null);return Pa}TGj(ea){this.D8k(ea)}MIj(ea){this.pJo(ea)}SGj(ea){this.C8k(ea)}LIj(ea){this.oJo(ea)}WDj(){this.vd.raiseEvent("PinchStart",
null)}jtg(){this.vd.raiseEvent("PinchEnd",null)}}Object(f.a)($e,"WordEditorZoomManager",nd,[87,88]);class oe{constructor(){this.Z=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")){const ea=this.Z.resolve("WordEditor.Zoom.WordEditorZoomActor"),Pa=this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager");ea.mc();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.J.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.J.$("AutoFitForSmallScreenModeIsEnabled")&&
Pa&&mb.a.get_instance().Zk(4,()=>{Pa.$mf(qe.StaticActiveAppFrame.Aa().ES.getLayoutBreakpoint())||w.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}Ec(ea){this.Z=ea;m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")&&(this.Z.ja("WordEditor.Zoom.WordEditorZoomManager",()=>new $e(m.AFrameworkApplication.J,m.AFrameworkApplication.va,qs.a.instance,ps.a.instance,zf.FocusManager.instance(),je.a.instance,()=>ea.Wa("Box4.IFloatingObjectUpdater"))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.Z.ja("WordEditor.Zoom.WordEditorZoomActor",()=>new $a(m.AFrameworkApplication.va,this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager"),m.AFrameworkApplication.J)).ha())}static main(){U.a.instance.Rc(new oe)}}Object(f.a)(oe,"ZoomPackage",null,[0,1]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");
Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Yf.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");Y;Type.registerNamespace("CACPU");xa.main();Type.registerNamespace("CAEventTimingMeter");sb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Cb.main();Type.registerNamespace("Common.App.GestureInput");Xb.main();Type.registerNamespace("Common.App.GestureManager");nc.main();Type.registerNamespace("Common.ModernFontPicker");
null==m.AFrameworkApplication.J||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),U.a.instance.Rc(new Rf));Type.registerNamespace("Common.App.O365Shell");Rb.main();Type.registerNamespace("Common.App.PhoneLink");dd.main();Type.registerNamespace("Common.App.SensitiveLogging");ml.main();Type.registerNamespace("Common.App.Rename");U.a.instance.Rc(new cg,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
U.a.instance.Rc(new de);Type.registerNamespace("Common.App.SaveAsToHost");ck.main();Type.registerNamespace("Common.App.SaveToCloudStorage");wg.main();Type.registerNamespace("Common.App.SaveACopy");Bg.main();Type.registerNamespace("Common.App.SaveToSharePoint");Hl.main();Type.registerNamespace("Common.App.SharedFilePicker");Sn.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");
Type.registerNamespace("CATypingSpeedMeter");Cc.main();Um;U.a.instance.Rc(new Zf);Rg.a.Qxa||ul.main();Fn;Ei.main();U.a.instance.Rc(new Ed);Dn.main();gl.a.prototype.toString=ah.a.prototype.toString;Qg.a.AQi=new xh.a;U.a.instance.Rc(new $m);Type.registerNamespace("WordEditor.Zoom");oe.main();U.a.instance.Rc(new Xp);U.a.instance.Rc(new pm);U.a.instance.Rc(new Jq);Fk.main();pk.main();Type.registerNamespace("NLRT");U.a.instance.Rc(new Ze);Type.registerNamespace("Common.App.AccessibilitySettings");T.main();
Type.registerNamespace("Common.App.RibbonSettings");ig.main();U.a.instance.Rc(new fr);xb.main();jo.main();Uo.main();go.main();ho.main();window.EventTiming={EventTimingMeter:id,FrameTimingMeter:Ad}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23790900/wdjs/WordEditorDS.box4.dll2.js.map