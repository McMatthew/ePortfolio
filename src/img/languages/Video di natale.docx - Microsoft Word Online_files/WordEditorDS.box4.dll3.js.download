/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1381:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);var m=e(1539);class f{constructor(){this.Jp=null;this.kp=!1}$o(){this.kp||(this.kp=!0,this.Jp=m.a.instance.uOm(),m.a.instance.$o(this.Jp,this))}Hpj(){this.Lnd();this.kp=!1}Lnd(){}}Object(I.a)(f,"Base",null,[])},1419:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(){this.JLc=this.ILc=this.hOc=this.gOc=this.iOc=this.Xaa=this.Yaa=
!1}get ignorePunct(){return this.ILc}set ignorePunct(f){this.ILc=f}get ignoreSpace(){return this.JLc}set ignoreSpace(f){this.JLc=f}get matchCase(){return this.Xaa}set matchCase(f){this.Xaa=f}get matchPrefix(){return this.gOc}set matchPrefix(f){this.gOc=f}get matchSuffix(){return this.hOc}set matchSuffix(f){this.hOc=f}get matchWholeWord(){return this.Yaa}set matchWholeWord(f){this.Yaa=f}get matchWildcards(){return this.iOc}set matchWildcards(f){this.iOc=f}getTypeName(){return"Microsoft.WordServices.SearchOptions"}invokePropertyGet(f){switch(f){case 1:return this.ignorePunct;
case 2:return this.ignoreSpace;case 3:return this.matchCase;case 4:return this.matchPrefix;case 6:return this.matchSuffix;case 8:return this.matchWholeWord;case 7:return this.matchWildcards}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,a){switch(f){case 1:this.ignorePunct=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 2:this.ignoreSpace=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 3:this.matchCase=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 4:this.matchPrefix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 6:this.matchSuffix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 8:this.matchWholeWord=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 7:this.matchWildcards=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,a){this.invokePropertySet(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,a){f=this.invokeMethod(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}
Object(I.a)(m,"SearchOptions",null,[])},1450:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.before=0]="before";f[f.after=1]="after";f[f.start=2]="start";f[f.end=3]="end";f[f.replace=4]="replace"})(m||(m={}));Object(I.b)("InsertLocation",m)},1539:function(I,K,e){e.d(K,"a",function(){return z});I=e(0);var m=e(49),f=e(8),a=e(530),l=e(287),w=e(1379);class z{constructor(){this.emb=new a.a(l.a.Oh())}uOm(){return m.a.create().toString()}$o(x,u){x&&u||(f.ULS.sendTraceTag(17168157,
369,10,"Cannot keep reference for null object."),w.a.vg());this.F5k(x,u)}F5k(x,u){try{this.emb.add(x,u)}catch(v){f.ULS.sendTraceTag(17168158,369,10,"Failed to add object into the cache with exception message {0}.",v.message)}}B6d(x){let u=null;({value:u}=this.emb.Nc(x,u));u||f.ULS.sendTraceTag(17168159,369,15,"This object with reference Id {0} hasn't been added to the cache yet.",x);return u}yGo(x){try{let u=null;({value:u}=this.emb.Nc(x,u));u&&(u.Hpj(),this.emb.remove(x))}catch(u){f.ULS.sendTraceTag(17168160,
369,10,"Failed to remove the object from the cache with exception message {0}.",u.message)}}pyl(){if(this.emb&&this.emb.values){for(const x of this.emb.values)x.Hpj();this.emb=new a.a(l.a.Oh())}}static get instance(){return z._instance||(z._instance=new z)}}z._instance=null;Object(I.a)(z,"ObjectCache",null,[])},1607:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.Z2c="extId";m.G$h="ComponentType";m.cZc="ComponentId";m.p9m="HostProps";m.sjd="OptionalProps";Object(I.a)(m,"ActionPropertyNames",
null,[])},1749:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.unknown=0]="unknown";f[f.Qmq=1]="notYetImplemented";f[f.mzq=2]="unsupportedSelection";f[f.Vvi=3]="forceSaveFailed";f[f.Aoq=4]="ooxmlStringIsNull";f[f.X4p=5]="dependencyNotReady";f[f.H5p=6]="documentNotSupported";f[f.zoq=7]="ooxmlIsMalformated";f[f.Y_p=8]="anchoredObjectSelection";f[f.fdq=9]="invalidParameter"})(m||(m={}));Object(I.b)("OoxmlApiInvocationError",m)},1750:function(I,K,e){e.d(K,"a",function(){return m});
I=e(0);class m{static Hvg(f){delete m.instances[f]}}m.lEd=null;m.instances={};Object(I.a)(m,"ExtensionLifeCycleManagerStatic",null,[])},1751:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}m.taskPaneWidth="TaskPaneWidth";m.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";m.AU="TaskPaneTitle";m.DW="NonPersistedSettings";m.onTaskPaneClose="OnTaskPaneClose";m.onExtensionLaunchCallback="OnExtensionLaunchCallback";m.nRh="ActionArgs";m.dialogWidth="DialogWidth";m.dialogHeight=
"DialogHeight";m.dialogLeft="DialogLeft";m.dialogTop="DialogTop";m.dialogTitle="DialogTitle";m.Q0c="DialogCloseCallback";m.showLoadingSpinner="ShowLoadingSpinner";m.actionName="ActionName";Object(I.a)(m,"PropertyNames",null,[])},1754:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,
l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1937),K);f(e(1938),K);f(e(1939),K);f(e(1940),K)},1929:function(I,K,e){(function(m){e.d(K,"a",function(){return ca});var f=e(0),a=e(21),l=e(2),w=e(26),z=e(6),x=e(11),u=e(464),v=e(30),E=e(627),y=e(88),H=e(550),D=e(3),G=e(2E3),J=e(5),U=e(8),F=e(76),T=e(118),Y=e(19),P=e(1749),S=e(1931),N=e(1450),
V=e(1379),Z=e(1930);class ca{constructor(W,X,ka,ma,ja,na,Ba,Ma,Ea,ya,ia,za,Ca,db,pa,ua){this.gsa=this.mV=this._context=this.yd=this.uh=null;this.W6=0;this.ga=W;this.ee=X;this.ni=ka;this.qb=ma;this.Lqa=ja;this.XIa=na;this.sm=Ba;this.me=Ma;this.VE=Ea;this.hI=ya;this.Cza=ia;this.E_=za;this.cmb=Ca;this.pb=db;this.iGb=pa;this.tVe=ua}Vu(W,X){this.uh=W;this.yd=X}get U4(){return null!=this.P0g?this.P0g:this.P0g=a.a.instance.resolve("Box4.IBox4GraphWriter")}RXi(W,X,ka){var ma;({yN:ma}=this.bP(W.K(0),W.K(W.count-
1),1));W=Object.assign(new Z.a,{GNa:ma,vrc:!0,keepCurrentFocus:!0});if(32!==this.ga.Zb(0===ka?Y.a.insertFootnote:Y.a.insertEndnote,2,W))return V.a.zE(),null;ka=new F.a;(ma=this.E_.pKf(ma.node,ma.cpBegin))||V.a.vg();ma=ma.Y8();ma=this.Bzm(ma);ka.add(w.a.uz(ma));X||(X="");this.insertText(ka,X,1);return W.Umj}WWl(W){var X=this.pb.ob;if(X&&X.currentSelection&&X.currentSelection.Ya&&(X=X.currentSelection.Ya.node,12===X.type&&this.hI.Kab(X)===W&&32!==this.ga.Zb(Y.a.C8,2,null))){V.a.vg();return}X=new F.a;
if(W=W.tua)W=W.Rb,X.add(w.a.createTextRange(W.paragraph,W.cp,W.cp+1));this.Yic(X)}Ica(W){W=this.hI.Ica(W);if(1===W)return 0;if(0===W)return 1}aIm(W,X){if(W=W.tua)if(W=W.Rb,X=this.Cza.EHi(W.paragraph,W.cp+1,0===X?1:0))return X.Y8();return null}Bzm(W){W&&38===W.type||V.a.vg();W=z.a.kb(W);W.ue();return W.ue()}omc(W,X){var ka=new z.a;ka.set(W);W=new F.a;this.qb.oTb(ka,!0,!1,W);ka=new F.a;for(const ma of W)W=this.hNf(ma,X),ka.addRange(W);return ka}hNf(W,X){var ka=this.E_.V4c(W,7);W=new F.a;X=0===X?1:0;
for(const ma of ka)ka=ma.Y8(),ma.Ica()===X&&W.add(ka);return W}T9d(W,X){const ka=new F.a,ma=W.count;if(this.k5f(W.K(0).node))return W=this.ALm(W.K(0).node,X),ka.add(W),ka;for(let Ma=0;Ma<ma;Ma++){var ja=W.K(Ma);if(ja.contextId==x.a.od)continue;var na=ja.node;let Ea=0,ya=na.characterData.length;0===Ma&&0<=ja.cpBegin&&(Ea=ja.cpBegin);Ma===ma-1&&0<=ja.cpEnd&&(ya=ja.cpEnd);ja=na.ra;for(na=0;na<ja.length;na++)if(!(ja.jc(na).cp<Ea)){if(ja.jc(na).cp>ya)break;var Ba=ja.jc(na).blob;if(Ba&&7==Ba.xi){const ia=
0===X?1:0;Ba.Ica()===ia&&(Ba=Ba.Y8(),ka.add(Ba))}}}return ka}fCa(W,X){const ka=new F.a;let ma=0;for(const ja of W)ka.add(this.cmb.create(ja,X,ma++));return ka}bP(W,X,ka,ma=!1){let ja=0,na=null;switch(ka){case 2:case 0:if(W.contextId===x.a.paragraph)X=0,this.kbd(W.node)&&(ma=this.L9d(W.node),-1!==ma&&(X=ma+2>this.qb.textLength(W.node)?this.qb.textLength(W.node):ma+2)),na=w.a.jd(W.node,X),ja=2===ka?0:4;else if(W.contextId===x.a.od)na=w.a.uz(W.node),ja=this.qb.textLength(W.node)?2===ka?2:6:2===ka?1:
5;else if(W.contextId===x.a.Nd||W.contextId===x.a.kd)na=w.a.jd(W.node,W.cpBegin),ja=2===ka?3:7;else{if(W.contextId===x.a.table)return{returnValue:8,yN:W};V.a.Cd()}na.Ob=na.nc=W.rp();break;case 3:case 1:X.contextId===x.a.paragraph||X.contextId===x.a.od?(3===ka?(na=w.a.uz(X.node),na.Ob=na.nc=X.vp()):(na=this.Utm(X,ma),0<this.qb.nn(na.node,0)?na.Ob=na.nc=this.qb.jA(na.node):na.Ob=na.nc=-1),ja=3===ka?9:11):X.contextId===x.a.Nd||X.contextId===x.a.kd?(na=w.a.jd(X.node,X.cpEnd),na.Ob=na.nc=X.vp(),ja=3===
ka?10:12):V.a.Cd();break;case 4:({yN:na}=this.bP(W,X,0));ja=13;break;default:U.ULS.sendTraceTag(17339329,369,15,"Undefined insert location: {0}",N.a[ka]),V.a.Cd()}return{returnValue:ja,yN:na}}axe(W,X){if(1<W.count){const ka=W.K(0);let ma=W.K(W.count-1);switch(X){case 2:if(ma.contextId===x.a.kd)W.remove(ma),ma=W.K(W.count-1),ma.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(ma.node,0,this.qb.textLength(ma.node))),this.Cx(W.K(W.count-1),2));else for(const ja of W)if(ja.contextId===x.a.od){W.remove(ja);
W.insert(0,ja);break}break;case 0:case 4:2===W.count&&ma.contextId===x.a.kd?(W.remove(ma),W.W(0,w.a.uz(ka.node)),this.Cx(W.K(0),2,ma)):X||W.K(1).contextId!==x.a.od?W.remove(ka):W.removeAt(1);break;case 3:ka.contextId===x.a.kd&&(W.remove(ka),ma.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(ma.node,0,this.qb.textLength(ma.node))),this.Cx(W.K(W.count-1),2)));break;case 1:2===W.count&&ka.contextId===x.a.kd?W.remove(ka):W.remove(ma)}}}xIe(W,X,ka,ma,ja){if(!ma)return 13===ka&&(W.clear(),
W.add(X)),X;let na=null;const Ba=W.K(0),Ma=W.K(W.count-1);switch(ka){case 0:na=w.a.createTextRange(X.node,0,ma);W.W(0,w.a.create(X.node));W.K(0).nc=Ba.vp();this.Cx(W.K(0),0);break;case 1:na=w.a.createTextRange(X.node,0,ma);W.W(0,w.a.create(X.node));W.K(0).Ob=0<this.qb.nn(X.node,0)?this.qb.nn(X.node,0):-1;W.K(0).nc=0<this.qb.nn(X.node,ma)?this.qb.xz(X.node):-1;break;case 2:na=w.a.createTextRange(X.node,ja,ja+ma);W.insert(0,na);this.Cx(W.K(0),2);break;case 3:na=w.a.createTextRange(X.node,Ba.cpBegin,
Ba.cpBegin+ma);W.W(0,w.a.createTextRange(X.node,Ba.cpBegin,Ba.cpEnd+ma));Ba.contextId===x.a.Nd?(W.K(0).nc=Ba.vp(),this.Cx(W.K(0),0)):this.Cx(W.K(0),2);break;case 4:na=w.a.createTextRange(X.node,0,ma);W.W(0,w.a.Pm(X.node));ka=this.qb.nn(X.node,ma+ja);0<ja?(W.insert(0,w.a.createTextRange(X.node,ma,ma+ja)),W.K(0).nc=Ba.vp(),this.TGa(W.K(0))):(W.K(0).Ob=0<ka?0:-1,W.K(0).nc=0<ka?this.qb.xz(X.node):-1);break;case 5:case 6:this.TGa(W.K(0));W.K(0).nc=0<this.qb.nn(W.K(0).node,this.qb.textLength(W.K(0).node))?
this.qb.xz(X.node):-1;6===ka&&this.KHf(X.node,ja);na=w.a.createTextRange(X.node,ja,ja+ma);break;case 7:Ba.cpBegin&&this.KHf(X.node,Ba.cpBegin);na=w.a.createTextRange(X.node,Ba.cpBegin,Ba.cpBegin+ma);Ba.contextId===x.a.Nd?(W.W(0,w.a.createTextRange(X.node,Ba.cpBegin+ma,Ba.cpEnd+ma)),this.TGa(W.K(0)),W.K(0).nc=Ba.vp()):(W.W(0,w.a.jd(X.node,Ba.cpBegin+ma)),this.TGa(W.K(0)),W.K(0).nc=W.K(0).rp()+Ba.vp()-Ba.rp());break;case 9:na=w.a.createTextRange(X.node,ja,ja+ma);W.removeAt(W.count-1);Ma.contextId===
x.a.paragraph?(W.add(w.a.create(X.node)),W.K(W.count-1).Ob=Ma.rp(),this.Cx(W.K(W.count-1),1)):(W.add(w.a.createTextRange(X.node,ja,ja+ma)),W.add(w.a.Pm(X.node)),ma=this.qb.nn(X.node,ma+ja),W.K(W.count-1).Ob=0<ma?0:-1,W.K(W.count-1).nc=0<ma?this.qb.xz(X.node):-1);break;case 10:na=w.a.createTextRange(X.node,Ma.cpEnd,Ma.cpEnd+ma);Ma.cpEnd&&this.KHf(X.node,Ma.cpEnd);W.W(W.count-1,w.a.createTextRange(X.node,Ma.cpBegin,Ma.cpEnd+ma));Ma.contextId!==x.a.kd||Ma.rp()?W.K(W.count-1).Ob=Ma.rp():W.K(W.count-1).Ob=
-1;this.Cx(W.K(W.count-1),1);break;case 11:na=ja?w.a.createTextRange(X.node,0,ma):w.a.create(X.node);break;case 12:na=w.a.createTextRange(X.node,Ma.cpEnd,Ma.cpEnd+ma);break;case 13:na=w.a.createTextRange(W.K(0).node,W.K(0).cpBegin,W.K(0).cpBegin+ma),W.W(0,na),this.Cx(W.K(0),2)}this.Cx(na,2);return na}pRa(W,X,ka=2){if(2===ka||!ka){var ma=W.node.ra;0<ma.length&&((ma=ma.first)&&-1!==W.rp()?W.Ob=ma.hD:W.Ob=-1)}if(2===ka||1===ka)W=X.node.ra,0<W.length&&((W=W.last)&&-1!==X.vp()?X.nc=W.hD+W.l_+W.qca:X.nc=
-1)}qRa(W,X=null){switch(W.contextId){case x.a.paragraph:this.RCp(W);break;case x.a.Nd:this.TCp(W,X);break;case x.a.kd:this.OCp(W,X)}}OCp(W,X=null){0<this.qb.nn(W.node,W.cpBegin)?W.Ob=W.nc=this.qb.jA(W.node):W.Ob=W.nc=-1;W.nc=W.Ob+(X?X.vp()-X.rp():0)}TCp(W,X){const ka=this.qb.nn(W.node,W.cpBegin);W.nc=X.vp();W.Ob=0<ka?this.qb.jA(W.node):-1}RCp(W){var X=this.qb.textLength(W.node);const ka=this.qb.nn(W.node,0);X=this.qb.nn(W.node,X);W.Ob=0<ka?this.qb.jA(W.node):-1;W.nc=0<X?this.qb.xz(W.node):-1}Cx(W,
X=2,ka=null){switch(W.contextId){case x.a.paragraph:this.QCp(W,X);break;case x.a.Nd:this.SCp(W,X);break;case x.a.kd:this.PCp(W,ka)}}TGa(W){const X=W.contextId!==x.a.od?W.cpBegin:this.qb.textLength(W.node);W.Ob=0<this.qb.nn(W.node,X)?0:-1}PCp(W,X=null){0<this.qb.nn(W.node,W.cpBegin)?W.Ob=0:W.Ob=-1;W.nc=W.Ob+(X?X.vp()-X.rp():0)}SCp(W,X=2){const ka=this.qb.nn(W.node,W.cpBegin),ma=this.qb.nn(W.node,W.cpEnd);switch(X){case 2:W.Ob=0<ka?ka:-1;W.nc=0<ma?0:-1;break;case 0:W.Ob=0<ka?ka:-1;break;case 1:W.nc=
0<ma?0:-1}}QCp(W,X=2){const ka=this.qb.textLength(W.node);var ma=this.qb.nn(W.node,0),ja=this.qb.nn(W.node,ka);const na=0<ma?ma:-1;ja=0<ja?0:-1;const Ba=0<ma?ma/2:-1;ma=0<ma?ma/2:-1;switch(X){case 2:W.Ob=0<ka?na:Ba;W.nc=0<ka?ja:ma;break;case 0:W.Ob=0<ka?na:Ba;break;case 1:W.nc=0<ka?ja:ma}}Utm(W,X=!1){const ka=W.node;var ma=this.qb.Cg(ka,!1);if(!ma)ma=w.a.jd(ka,this.qb.textLength(ka)),ma.Ob=ma.nc=W.vp(),{SPb:ma}=this.npc(ma,!1),ma=ma.ic(2);else if(X){W=this.yd.S4(ma);for(X=null;W&&ma===this.qb.Vn(W);)X=
W,W=this.yd.S4(W);X&&(ma=this.yd.YXi(X,!0))}return w.a.jd(ma,0)}insertBreak(W,X,ka,ma,ja,na,Ba,Ma=null,Ea=!1){this.DY(W,ka,6===X?0:1);let ya=null,ia=({yN:ya}=this.bP(W.K(0),W.K(W.count-1),ka)).returnValue;const za=new z.a;za.set(ya.node);za.Ib(23)||6===X||(U.ULS.sendTraceTag(17577860,369,15,"Inserting Break (excpect LineBreak) is only allowed in the main document."),V.a.vg());Ma&&Ma.Jzb();switch(X){case 0:ya=this.uh.fRa(ya,W);32!==this.ga.Sf(ya,Y.a.uNa,2,!1,null,null)&&V.a.vg();Ea&&this.fck(W,X,ia);
Ma&&Ma.hCa(W);ja(null);break;case 6:(ma=this.aie(W,ka))&&({yN:ya,returnValue:ia}=this.bP(W.K(0),W.K(W.count-1),ka));this.ee.Vna(ya,Ca=>new u.a(Ca));Ea&&this.fck(W,X,ia);ma&&this.axe(W,ka);Ma&&Ma.hCa(W);ja(null);break;case 2:case 1002:case 3:case 4:case 5:(ka=this.uh.fJi(ya,ya))&&0<ka.count&&(Ma&&Ma.hCa(W),V.a.HCc(ma.appId,"Insert section break in content control is not allowed on wac currently.",void 0,S.a[X]));this.A$c(ma,ja,na,Ba);this.din(ya,X,W,ia,Object(T.a)(this,this.KEp,"updateGncListForInsertSectionBreak"),
Ma);break;default:U.ULS.sendTraceTag(17179037,369,15,"The breakType parameter is invalid: {0}.",S.a[X]),V.a.Cd()}}din(W,X,ka,ma,ja,na){let Ba=0;switch(X){case 2:case 1002:Ba=2;break;case 3:Ba=3;break;case 4:Ba=4;break;case 5:Ba=5;break;default:U.ULS.sendTraceTag(18957145,369,15,"The breakType parameter is undefined: {0}.",S.a[X]),V.a.Cd()}this._context.vo.qH();this.XIa.xBe([W],"<w:p xmlns:w='http://schemas.microsoft.com/office/word/2003/wordml'><w:r><w:rPr><w:b/><w:b-cs/><w:color w:val='FF0000'/><w:sz w:val='28'/><w:sz-cs w:val='28'/></w:rPr><w:t>H</w:t></w:r></w:p>",
0,0,Ba,null,()=>{ja&&ja(ka,ma);this.mV(null);this._context.vo.ex();na&&na.hCa(ka);V.a.lR("InsertApiOperations.InsertSectionBreakUsingOoxml",V.a.WR(this.W6),191)},Ma=>{U.ULS.sendTraceTag(18957146,369,10,"AppId:{0}, {1}",this._context.appId,P.a[Ma]);this.gsa(P.a[Ma]);this._context.vo.ex();na&&na.hCa(ka);V.a.lR("InsertApiOperations.InsertSectionBreakUsingOoxml",V.a.WR(this.W6),191,!1)})}KEp(W,X){const ka=W.K(0),ma=W.K(W.count-1);if(7===X)W.W(0,w.a.OV(0,ka.cpEnd-ka.cpBegin,!1,ka.node));else if(12===X){const ja=
this.qb.Cg(ma.node,!0,!0);W.W(W.count-1,w.a.OV(ma.cpBegin,ma.cpEnd,!1,ja))}this.abk(ka,W,X)}fck(W,X,ka){const ma=W.K(0);var ja=ma.node;switch(X){case 6:4===ka?(X=this.qb.textLength(ja),W.W(0,w.a.Pm(ja)),1<X&&W.insert(0,w.a.createTextRange(ja,1,X))):7===ka&&((X=ma.cpEnd-ma.cpBegin)?W.W(0,w.a.createTextRange(ja,ma.cpBegin+1,ma.cpEnd+1)):W.W(0,w.a.jd(ja,ma.cpBegin+1)));this.GCp(ma,W,ka);break;case 0:7===ka&&ma.cpBegin?(ja=this.qb.Cg(this.qb.Cg(ja,!1),!1),X=ma.cpEnd-ma.cpBegin,W.W(0,X?w.a.createTextRange(ja,
0,X):w.a.jd(ja,0)),1<W.count&&W.K(1).contextId===x.a.od&&W.W(1,w.a.Pm(ja))):6===ka&&(ja=this.qb.Cg(this.qb.Cg(ja,!1),!1),W.W(0,w.a.Pm(ja))),this.abk(ma,W,ka)}}abk(W,X,ka){7===ka||6===ka||5===ka?(ka=X.K(0).node.ra,0<ka.length?(ka=ka.first)&&-1!==X.K(0).rp()&&0<ka.hD&&(X.K(0).Ob=ka.hD):X.K(0).Ob=-1,this.dbk(X.K(0),W)):12===ka&&(W=X.K(X.count-1),X=this.qb.nn(W.node,W.cpEnd),W.nc=0<X?W.vp():-1,W.contextId===x.a.kd&&(W.Ob=0<X?W.rp():-1))}GCp(W,X,ka){4===ka||7===ka||5===ka||6===ka?(ka=X.K(0).contextId===
x.a.kd||X.K(0).contextId===x.a.Nd?X.K(0).cpBegin:this.qb.textLength(X.K(0).node),ka=this.qb.nn(X.K(0).node,ka),X.K(0).Ob=0<ka?0:-1,this.dbk(X.K(0),W)):12===ka&&(W=X.K(X.count-1),X=W.vp()-W.rp(),ka=this.qb.nn(W.node,W.cpEnd),W.nc=0<ka?ka:-1,W.contextId===x.a.kd&&(W.Ob=W.vp()-X))}dbk(W,X){W&&X&&(W.nc=W.contextId===x.a.kd||W.contextId===x.a.od?W.rp()+(X.vp()-X.rp()):X.vp())}A$c(W,X,ka,ma){this._context=W;this.mV=X;this.gsa=ka;this.W6=ma}Q9a(W,X=!0){var ka=0;if(this.kbd(W)){const ma=this.L9d(W);-1!==
ma&&(ka=ma+2>this.qb.textLength(W)?this.qb.textLength(W):ma+2)}ka=X?ka:this.qb.textLength(W);ka=w.a.jd(W,ka);ka.Ob=ka.nc=X?this.qb.jA(W):this.qb.xz(W);return ka}k5f(W){return V.a.r4c()?z.a.kb(W).Ib(37)?!0:!1:!1}kbd(W){const X=this.hI.Kab(W);if(X&&this.qb.Vn(X)==W)return!0}Kab(W){return this.hI.Kab(W)}L9d(W){W=W.ra;for(let X=0;X<W.length;X++){const ka=W.jc(X),ma=ka.blob;if(null!==ma&&10===ma.xi)return ka.cp}return-1}insertParagraph(W,X,ka){this.DY(W,ka,1);var ma=!1;switch(ka){case 0:ma=!0;break;case 1:ma=
!1}X=V.a.MZc(X);const ja=ma?W.K(0):W.K(W.count-1),na=this.qb.textLength(ja.node);let Ba;var Ma=this.qb.Cg(W.K(W.count-1).node,!1);({yN:Ba}=this.bP(W.K(0),W.K(W.count-1),ka,!0));Ba=this.uh.fRa(Ba,W);if(ja.contextId===x.a.paragraph||ja.contextId===x.a.od){ma=this.yd.S4(ja.node);const Ea=this.yd.S4(Ma);Ma=!Ma;ma=!Ma&&!!Ea&&Ea!==ma;if(1===ka&&(Ma||ma)){let ya;ka=this.Z$c((ya=new F.a,ya.add(Ba),ya),X,3).K(0).node}else!ka&&ja.contextId===x.a.od&&0<na?(ka=this.iZa(Ba,X,!1),W.W(0,w.a.Pm(ka)),W.K(0).Ob=W.K(0).nc=
this.qb.xz(ka)):ka=this.iZa(Ba,X,!0)}else ma?ja.cpBegin?ja.cpBegin===na?(ka=this.iZa(Ba,X,!1),W.W(0,w.a.uz(ka)),0<X.length?this.Cx(W.K(0),2,ja):(X=this.qb.nn(ka,0),W.K(0).Ob=0<X?X/2:-1,W.K(0).nc=W.K(0).Ob+ja.vp()-ja.rp())):ka=this.rZf(Ba,X,ma,W):ka=this.iZa(Ba,X,!0):ja.cpEnd===na?ka=this.iZa(Ba,X,!1):ja.cpEnd?ka=this.rZf(Ba,X,ma):(ka=this.iZa(Ba,X,!0),W.W(0,w.a.jd(ka,0)),0<X.length?this.qRa(W.K(0),ja):(X=this.qb.nn(ka,0),W.K(0).Ob=0<X?X/2:-1,W.K(0).nc=W.K(0).Ob+ja.vp()-ja.rp()));return ka}rZf(W,X,
ka,ma=null){let ja;({KOj:Ba,SPb:ja}=this.npc(W));W=this.ni.kva(Ba);if(ka){ka=ja.ic(2);var na=ma.K(0).rp();var Ba=ma.K(0).vp();ma.K(0).contextId===x.a.Nd?(na=ma.K(0).cpEnd-ma.K(0).cpBegin,ma.W(0,w.a.createTextRange(ka,0,na)),0<this.qb.nn(ka,ma.K(0).cpBegin)?ma.K(0).Ob=this.qb.jA(ka):ma.K(0).Ob=-1,ma.K(0).nc=Ba):(ma.W(0,w.a.jd(ka,0)),0<this.qb.nn(ka,ma.K(0).cpBegin)?(ma.K(0).Ob=na+this.qb.jA(ka),ma.K(0).nc=ma.K(0).Ob+Ba-na):ma.K(0).Ob=ma.K(0).nc=-1);1<ma.count&&ma.K(1).contextId===x.a.od&&ma.W(1,w.a.Pm(ka));
ja.Ac();ma=w.a.jd(ka,0);0<this.qb.nn(ka,ma.cpBegin)&&(ma.Ob=ma.nc=this.qb.jA(ka));this.ni.wea(ja,W,ma,!0,!0,!1)}else ka=Ba.ic(2),Ba.Ac(),ma=w.a.uz(ka),0<this.qb.nn(ka,ma.cpBegin)?ma.Ob=ma.nc=this.qb.xz(ka):ma.Ob=ma.nc=-1,this.ni.wea(Ba,W,ma,!0,!0,!0);W=W.ic(2);ma=w.a.jd(W,0);0<this.qb.nn(W,0)?ma.Ob=ma.nc=this.qb.jA(W):ma.Ob=ma.nc=-1;this.ee.lf(ma,X);return W}iZa(W,X,ka,ma=!1){({SPb:W}=this.npc(W,ka,ma));W=W.ic(2);ka=w.a.jd(W,0);0<this.qb.nn(W,0)&&(ka.Ob=ka.nc=this.qb.nn(W,0)/2);this.ee.lf(ka,X);return W}npc(W,
X=!1,ka=!1){var ma,ja=null;const na=new z.a;na.set(W.node);na.Ib(11)&&(ja=na.Gq(11));if((null===(ma=this.U4)||void 0===ma?0:ma.E2a)&&!ka)return ja=z.a.kb(ja),W=this.U4.E2a(W.node,W.cpBegin,{nkm:!0,ngn:X,Ob:W.Ob,nc:W.nc}),{KOj:ja,SPb:W};ka?(ka=z.a.kb(ja),ka.Ib(40),ka.xd(40),ma=new E.a,ka.QL(ma,ja,1),ka=z.a.kb(ma),ja=z.a.kb(ja)):(ja=z.a.kb(ja),ja.Wd(),v.a.xe(ja),ka=X?this.ni.Ihn(ja):this.ni.kva(ja));this.ni.wea(ja,ka,W,!0,!0,!X);return{KOj:ja,SPb:ka}}DY(W,X,ka){W&&W.count||(U.ULS.sendTraceTag(22577489,
369,10,"The gncList shouldn't be null or empty."),V.a.vg());if(V.a.r4c()){var ma=this.yd.bJi(W.K(0).node,W.K(W.count-1).node);ma&&4===X&&0===ka&&37===ma.type&&V.a.fMg()}if(1!==W.count||W.K(0).contextId!==x.a.table){ma=new F.a;var ja=3;if(ka&&1!==ka)2===ka?ma=W:V.a.vg();else switch(ja=1,X){case 2:case 0:W=this.Vzi(W.K(0));ma.add(W);1===ka&&(ja=5);break;case 3:case 1:W=this.Vzi(W.K(W.count-1),!1);ma.add(W);1===ka&&(ja=5);break;case 4:ma=W,ja=4,1===ka&&(ja=6)}(y.a.vca?this.Lqa.cYc(ma,ja):this.Lqa.cYc(ma,
ja)&&!this.tcm(ma))||(U.ULS.sendTraceTag(21033307,369,15,"The inserting operation here is not allowed due to conflict with non-deletable or non-editable content control or field range."),V.a.zE())}}tcm(W){for(let X=0;X<W.count;X++){const ka=W.K(X);if(ka.contextId===x.a.kd||ka.contextId===x.a.Nd){if(this.ucm(ka))return!0}else if((ka.contextId===x.a.od||ka.contextId===x.a.paragraph)&&this.scm(ka))return!0}return!1}ucm(W){const X=W.cpBegin,ka=W.cpEnd;W=this.qb.jYa(W.node);let ma=0;for(;ma<W.length;){const ja=
W[ma];if(ja.end<=X)ma++;else{if(ka<=ja.Mc)break;return X>ja.Mc||ja.end>ka}}return!1}scm(W){W=W.node;return W.ka(J.a.mEa,!1)||this.sm.Scb(W)}insertText(W,X,ka,ma=-1,ja=null,na=null){if(void 0===X||null===X)U.ULS.sendTraceTag(18477965,369,15,"Inserted text can not be null"),V.a.Cd();this.DY(W,ka,0);const Ba=4!==ka&&this.aie(W,ka);var Ma=V.a.lBc(X),Ea=Ma.length;if(1<Ea){this.DY(W,ka,1);var ya=null;W.K(0).contextId===x.a.paragraph&&4===ka?ya=w.a.jd(W.K(W.count-1).node,0):{yN:ya}=this.bP(W.K(0),W.K(W.count-
1),ka);X=Ma.shift();const Ca=Ma.pop();var ia=" "+X;const db=Ca+" ";4!==ka&&(ya=this.uh.fRa(ya,W));var za=new F.a;za.addRange(W);this.Z$c(za,ia+db,ka,!1,ma,ja,na);ja=w.a.jd(ya.node,ya.cpBegin+ia.length);ja.Ob=ja.nc=-1;4===ka&&(na=this.uh.til(ya,ja),ja=this.uh.fRa(ja,za),ya=w.a.jd(ja.node,Math.max(ja.cpBegin-ia.length,0)),this.uh.dPo(ya,na,ya,ja));({SPb:za}=this.npc(ja,!1));ia=ya.node;za=za.ic(2);ja=null;if(2<Ea&&(ja=this.cH(Ma,ya.node,!1),1===ma&&(ma=ja.count,Ea=za.ra.first,Ma=this.tVe.YMi(ia.ra.last),
Ea=this.tVe.XMi(Ea),Ea.length!==Ma.length&&(U.ULS.sendTraceTag(508654922,324,15,"Number of field begins and ends that should be copied should be the same, but it's not."),V.a.Cd()),0!==Ea.length&&0!==Ma.length)))for(na=1;na<ma;na++)this.tVe.Hci(ja.K(na).node,Ea,Ma);ma=w.a.createTextRange(ia,ya.cpBegin,ya.cpBegin+1);this.Cx(ma,2);this.ee.lf(ma,"");ya.cpBegin||this.qb.textLength(ia)!==X.length?X.length?(Ma=w.a.createTextRange(ia,ya.cpBegin,ya.cpBegin+X.length),this.Cx(Ma,2)):(Ma=w.a.Pm(ia),Ma.Ob=Ma.nc=
this.qb.xz(ia)):(Ma=w.a.create(ia),this.Cx(Ma,2));ya=w.a.createTextRange(za,Ca.length,Ca.length+1);this.Cx(ya,2);this.ee.lf(ya,"");Ea=w.a.OV(0,Ca.length,!1,za);this.qb.textLength(za)===Ca.length&&(Ea=w.a.create(za),this.Cx(Ea,2));ya=new F.a;ma=new F.a;ma.add(Ma);ma.K(ma.count-1).contextId===x.a.Nd&&(Ma=w.a.Pm(ia),Ma.Ob=Ma.nc=this.qb.xz(ia),ma.add(Ma));ja&&ma.addRange(ja);ma.add(Ea);ja=W.K(0);Ma=W.K(W.count-1);switch(ka){case 2:ya.addRange(ma);W.K(0).contextId===x.a.paragraph||W.K(0).contextId===x.a.od?
(ya.removeAt(ya.count-1),W.W(0,w.a.create(za)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0)):W.K(0).contextId===x.a.Nd?(ya.removeAt(ya.count-1),1<W.count&&W.K(0).node.id.equals(W.K(1).node.id)&&W.K(1).contextId===x.a.od?(W.W(0,w.a.create(za)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0),W.removeAt(1)):(W.W(0,w.a.createTextRange(za,0,W.K(0).cpEnd-W.K(0).cpBegin+Ca.length)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0))):W.K(0).contextId===x.a.kd&&W.removeAt(0);ya.addRange(W);break;case 3:if(Ma.contextId===x.a.paragraph||Ma.contextId===
x.a.od||Ma.contextId===x.a.Nd&&!Ma.cpBegin)W.W(W.count-1,w.a.create(ia)),W.K(W.count-1).Ob=Ma.rp(),this.Cx(W.K(W.count-1),1);else if(Ma.contextId===x.a.Nd||Ma.contextId===x.a.kd)Ma.cpBegin!==Ma.cpEnd||Ma.cpBegin===Ma.cpEnd&&X.length?(W.W(W.count-1,w.a.createTextRange(ia,Ma.cpBegin,Ma.cpEnd+X.length)),W.K(W.count-1).Ob=Ma.rp(),this.Cx(W.K(W.count-1),1)):W.removeAt(W.count-1),W.add(w.a.Pm(ia)),W.K(W.count-1).Ob=W.K(W.count-1).nc=0<this.qb.nn(ia,this.qb.textLength(ia))?this.qb.xz(ia):-1;ya.addRange(W);
X=ma.K(0);ma.removeAt(0);ya.addRange(ma);ma.insert(0,X);break;case 0:W.K(0).contextId===x.a.Nd?(W.W(0,w.a.createTextRange(za,Ca.length,Ca.length+W.K(0).cpEnd-W.K(0).cpBegin)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0),1<W.count&&W.K(1).contextId===x.a.od&&(X=W.K(1),W.W(1,w.a.Pm(za)),W.K(1).Ob=X.rp(),W.K(1).nc=X.vp())):W.K(0).contextId===x.a.kd?(W.W(0,w.a.jd(za,Ca.length+W.K(0).cpBegin)),this.Cx(W.K(0),0),W.K(0).nc=W.K(0).Ob+ja.vp()-ja.rp()):W.K(0).contextId===x.a.od?(W.W(0,w.a.Pm(za)),W.K(0).Ob=-1!==ja.vp()?
0:-1,W.K(0).nc=0<this.qb.nn(za,this.qb.textLength(za))?this.qb.xz(za):-1):W.K(0).contextId===x.a.paragraph&&(Ca.length&&this.qb.textLength(za)?(W.W(0,w.a.OV(Ca.length,this.qb.textLength(za),!1,za)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0),1<W.count&&(W.insert(1,w.a.Pm(za)),W.K(1).Ob=W.K(1).nc=ja.vp(),W.K(0).contextId===x.a.kd&&W.removeAt(0))):(W.W(0,w.a.create(za)),W.K(0).nc=ja.vp(),this.Cx(W.K(0),0)));ya.addRange(W);break;case 1:ya.addRange(W);break;case 4:ya.addRange(ma)}Ba&&this.axe(ya,ka);W.clear();
W.addRange(ya);return ma}return this.Z$c(W,X,ka,Ba,ma,ja,na)}aie(W,X){let ka;({yN:ka}=this.bP(W.K(0),W.K(W.count-1),X));var ma=this.uh.Hcb(ka);ma&&(this.uh.Tvd(ka),ma=this.uh.Hcb(ka));if(!ma)return!1;ma=null;let ja=0;var na=W.K(W.count-1);if(1===X&&(na.contextId===x.a.od||na.contextId===x.a.paragraph)&&(na=this.qb.Cg(na.node,!1))){const Ba=w.a.jd(na,0);this.uh.Hcb(Ba)||(ma=Ba,ma.Ob=ma.nc=0<this.qb.nn(na,0)?this.qb.jA(na):-1,ja=W.count)}if(!ma){let Ba;na=this.insertParagraph((Ba=new F.a,Ba.add(ka),
Ba),"",0);2!==X&&X&&4!==X?(ma=w.a.jd(na,0),ja=W.count):(ma=w.a.create(na),ja=0);X=this.qb.nn(na,0);ma.Ob=ma.nc=0<X?X/2:-1}W.insert(ja,ma);return!0}Z$c(W,X,ka,ma=!1,ja=-1,na=null,Ba=null){const Ma=X.length;let Ea=new F.a;var ya=W.K(0);var ia=W.K(W.count-1);const za=({yN:ia}=this.bP(ya,ia,ka)).returnValue,Ca=ia.node.characterData.length;if(13===za)return this.uh.hQb(),this.sOb(W),this.uh.WLa(),ya.contextId!==x.a.kd&&this.uh.Hcb(W.K(0))&&this.Bck(W.K(0)),Ea=this.insertText(W,X,0,ja,na,Ba),W.clear(),
W.addRange(Ea),Ea;if(1===ja){if((ja=ia.node.ra.Vh(ia.cpBegin))&&ja.Fc)if(0===ka)if(ya=ja.Fc.Rkc(2))na=ja.pA.indexOf(ya),-1!==na&&(ia.Tga=na+1,ia.dua=ia.Tga),this.ee.lf(ia,X,this.EWb);else for(Ba?this.iGb.insertField(ia,Ba,X):this.iGb.insertField(ia," ADDIN \\* MERGEFORMAT ",X),X=ja.Fc.length-1;0<=X;X--)Ba=ja.Fc.K(X),0===Ba.ze&&na&&(Ba.data=m.from(na,"utf8").toString("base64"));else ya=2===ka?ja.Fc.Rkc(2):ja.Fc.Rkc(3),na=ja.pA.indexOf(ya),-1!==na&&(ia.Tga=2===ka?na+1:na,ia.dua=ia.Tga),this.ee.lf(ia,
X,this.EWb)}else this.ee.lf(ia,X,this.EWb);Ea.add(this.xIe(W,ia,za,Ma,Ca));ma&&this.axe(W,ka);return Ea}cH(W,X,ka){const ma=new F.a;var ja=W.length;if(0<ja&&X){X=w.a.create(X);this.Cx(X);ma.add(X);if(ka)for(--ja;0<=ja;ja--)ka=this.insertParagraph(ma,W[ja],0),ka=w.a.create(ka),this.Cx(ka),ma.insert(0,ka);else for(let na=0;na<ja;na++)ka=this.insertParagraph(ma,W[na],1),ka=w.a.create(ka),this.Cx(ka),ma.add(ka);ma.remove(X)}return ma}SWl(W){let X;this.DY((X=new F.a,X.add(W),X),4,2);this.ee.lf(W,"")}Fxl(W,
X,ka,ma,ja){this.DY(W,4,2);this.A$c(X,ka,ma,ja);this._context.vo.qH();this.XIa.xBe(W.toArray(),"<pkg:package xmlns:pkg='http://schemas.microsoft.com/office/2006/xmlPackage'><pkg:part pkg:name='/_rels/.rels' pkg:contentType='application/vnd.openxmlformats-package.relationships+xml' pkg:padding='512'><pkg:xmlData><Relationships xmlns='http://schemas.openxmlformats.org/package/2006/relationships'><Relationship Id='rId1' Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument' Target='word/document.xml'/></Relationships></pkg:xmlData></pkg:part><pkg:part pkg:name='/word/document.xml' pkg:contentType='application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml'><pkg:xmlData><w:document xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main' ><w:body></w:body></w:document></pkg:xmlData></pkg:part></pkg:package>",
0,0,0,null,()=>{this.mV(null);this._context.vo.ex();V.a.lR("InsertApiOperations.ClearBody",V.a.WR(this.W6),void 0,!0)},na=>{U.ULS.sendTraceTag(19170978,369,10,"AppId:{0}, {1}",this._context.appId,P.a[na]);this.gsa(P.a[na]);this._context.vo.ex();V.a.lR("InsertApiOperations.ClearBody",V.a.WR(this.W6),void 0,!1)})}eic(W,X){const ka=w.a.create(W);X?ka.Ob=this.qb.jA(W):ka.nc=this.qb.xz(W);return ka}KHf(W,X){W=W.ra;for(let ka=0;ka<W.length;ka++)if(W.jc(ka).cp===X){1<=ka&&(!W.jc(ka-1).blob||W.jc(ka-1).formatting)&&
(W.jc(ka).formatting=W.jc(ka-1).formatting?W.jc(ka-1).formatting.og(W.jc(ka)):null);break}}Vzi(W,X=!0){if(!W)return null;let ka=null;switch(W.contextId){case x.a.paragraph:ka=X?w.a.jd(W.node,0):w.a.uz(W.node);break;case x.a.od:ka=w.a.uz(W.node);break;case x.a.Nd:case x.a.kd:ka=w.a.jd(W.node,X?W.cpBegin:W.cpEnd)}ka.Ob=X?ka.nc=W.rp():ka.nc=W.vp();return ka}E2d(W){const X=[];for(var ka of W)if(ka&&ka.contextId!==x.a.kd){if(ka.contextId===x.a.od){const ma=ka.iterator;ma.Wd();ma.Ac();if(ma.cEa(1))continue}X.push(ka)}ka=
32;0<X.length&&(ka=this.ga.Sf(new H.a(null),D.a.uCa,2,!0,null,W.toArray()));return 32===ka}sOb(W){if(W.count&&(1!==W.count||W.K(0).contextId!==x.a.kd)){this.DY(W,4,2);var X=new F.a;X.addRange(W);var ka=W.K(W.count-1),ma=this.lxn(W);if(ma)this.yd.f8h(ma),W.clear(),W.addRange(this.qb.LC(ma,!0,!1));else{ma=this.q6i(W);this.s6i(W)||ma||!this.r6i(W)||V.a.vg();if(ka.contextId===x.a.od)if(1<W.count)W.removeAt(W.count-1);else return;else ka.contextId!==x.a.paragraph||ma||(W.W(W.count-1,w.a.OV(0,this.qb.textLength(ka.node),
!1,ka.node)),W.K(W.count-1).nc=ka.vp(),1===W.count&&(W.K(W.count-1).Ob=ka.rp()));this.Yii(W,X);V.a.gHf()&&this.hin(X)}}}Yic(W){if(W.count&&(1!==W.count||W.K(0).contextId!==x.a.kd)){this.DY(W,4,2);var X=new F.a;X.addRange(W);var ka=W.K(W.count-1);this.s6i(W)||this.q6i(W)||!this.r6i(W)||V.a.vg();this.ixn(W)&&(ka.contextId===x.a.od?W.removeAt(W.count-1):ka.contextId===x.a.paragraph&&(W.W(W.count-1,w.a.createTextRange(ka.node,0,this.qb.textLength(ka.node))),this.qRa(W.K(W.count-1),ka),1===W.count&&(W.K(W.count-
1).Ob=ka.rp())));this.Yii(W,X)}}Yii(W,X){const ka=W.K(0),ma=W.K(W.count-1);let ja=null,na=!1,Ba=!1;ka.contextId===x.a.paragraph?({yN:ja}=this.bP(ka,ma,1),na=ma.contextId===x.a.Nd&&!this.EWb):this.EWb&&1===W.count&&ka.contextId===x.a.Nd?(Ba=!0,ja=this.PVm(ka,ja)):({yN:ja}=this.bP(ka,ma,this.EWb?1:2),Ba=this.EWb);this.E2d(W)||(W.clear(),W.addRange(X),U.ULS.sendTraceTag(21641408,369,15,"AppId:{0}, Clear or Delete is not allowed on the current object.",this._context.appId),V.a.vg());Ba&&!this.VE.huf(ma)&&
({yN:ja}=this.bP(ka,ma,0));na&&(ja=w.a.jd(ja.node,0),this.Bck(ja));this.qb.nn(ja.node,ja.cpBegin)||(ja.Ob=ja.nc=-1);W.clear();W.add(ja)}PVm(W,X){X=0;const ka=this.VE.sDa(W.node,W.cpBegin,W.cpEnd);for(const ma of ka)ma.Sd.authorName===l.AFrameworkApplication.userName&&1===ma.Sd.changeType&&(X=W.cpBegin<=ma.Kd?ma.endCp>=W.cpEnd?X+W.cpEnd-ma.Kd:X+ma.endCp-ma.Kd:ma.endCp<=W.cpEnd?X+ma.endCp-W.cpBegin:X+W.cpEnd-W.cpBegin);X=w.a.jd(W.node,W.cpBegin+(W.cpEnd-W.cpBegin-X));X.Ob=W.rp();X.nc=W.rp();return X}Bck(W){var X=
W.node.ra;if(0<X.length){if(X=X.Vh(W.cpBegin))X=X.hD+X.l_,W.Ob=W.nc=0<X?X:-1}else W.Ob=W.nc=-1}lxn(W){const X=W.K(0);W=W.K(W.count-1);const ka=this.yd.Ana(X.node,!0),ma=this.qb.Vn(ka),ja=this.qb.vH(ka);return X.contextId!==x.a.paragraph&&X.contextId!==x.a.od||W.contextId!==x.a.paragraph&&W.contextId!==x.a.od||!ma||ma.id!==X.node.id||!ja||ja.id!==W.node.id?null:ka}s6i(W){const X=W.K(0);var ka=W.K(W.count-1);W=this.yd.Ana(X.node,!0);const ma=this.qb.Vn(W);ka=this.yd.Ana(ka.node,!0);return!ma||ma.id!==
X.node.id||ka&&W.id===ka.id?!1:!0}q6i(W){var X=W.K(0);W=W.K(W.count-1);const ka=this.yd.Ana(W.node,!0),ma=this.qb.vH(ka);X=this.yd.Ana(X.node,!0);return!ma||ma.id!==W.node.id||X&&ka.id===X.id?!1:!0}ixn(W){var X=W.K(0),ka=W.K(W.count-1);X=this.qb.Cg(X.node,!0);W=this.yd.Ana(X,!0);W=this.qb.vH(W);ka=this.qb.Cg(ka.node,!1);var ma=this.yd.Ana(ka,!0);ma=this.qb.Vn(ma);return W&&W.id===X.id&&ma&&ma.id===ka.id?!0:!1}r6i(W){const X=W.K(0);W=W.K(W.count-1);const ka=this.yd.Ana(X.node,!0),ma=this.yd.Ana(W.node,
!0),ja=this.yd.Ana(X.node,!1),na=this.yd.Ana(W.node,!1),Ba=this.qb.Vn(ka),Ma=this.qb.vH(ma);return!ka&&!ma||Ba&&Ba.id===X.node.id&&Ma&&Ma.id===W.node.id||ja&&na&&ja.id===na.id?!1:!0}get EWb(){return this.me.Zg}uhn(W,X,ka){var ma=V.a.lBc(X),ja=ma.length;if(1<ja){var na=null;W.K(0).contextId===x.a.paragraph&&4===ka?na=w.a.jd(W.K(W.count-1).node,0):{yN:na}=this.bP(W.K(0),W.K(W.count-1),ka);X=ma.shift();const ya=ma.pop();var Ba=" "+X,Ma=ya+" ",Ea=new F.a;Ea.addRange(W);this.Z$c(Ea,Ba+Ma,ka,!1);Ma=w.a.jd(na.node,
na.cpBegin+Ba.length);Ma.Ob=Ma.nc=-1;4===ka&&(na=w.a.jd(Ma.node,Math.max(Ma.cpBegin-Ba.length,0)));({SPb:Ma}=this.npc(Ma,!1,!0));Ba=na.node;Ma=Ma.ic(2);Ea=null;2<ja&&(Ea=this.N3k(ma,na.node));ma=w.a.createTextRange(Ba,na.cpBegin,na.cpBegin+1);ma.Ob=ma.nc=-1;this.ee.lf(ma,"");ja=na.cpBegin||this.qb.textLength(Ba)!==X.length?X.length?w.a.createTextRange(Ba,na.cpBegin,na.cpBegin+X.length):w.a.Pm(Ba):w.a.create(Ba);na=w.a.createTextRange(Ma,ya.length,ya.length+1);this.ee.lf(na,"");let ia=w.a.OV(0,ya.length,
!1,Ma);this.qb.textLength(Ma)===ya.length&&(ia=w.a.create(Ma));na=new F.a;ma=new F.a;ma.add(ja);ma.K(ma.count-1).contextId===x.a.Nd&&(ja=w.a.Pm(Ba),ma.add(ja));Ea&&ma.addRange(Ea);ma.add(ia);Ea=W.K(W.count-1);switch(ka){case 2:na.addRange(ma);W.K(0).contextId===x.a.paragraph||W.K(0).contextId===x.a.od?(na.removeAt(na.count-1),W.W(0,w.a.create(Ma))):W.K(0).contextId===x.a.Nd?(na.removeAt(na.count-1),1<W.count&&W.K(0).node.id.equals(W.K(1).node.id)&&W.K(1).contextId===x.a.od?(W.W(0,w.a.create(Ma)),
W.removeAt(1)):W.W(0,w.a.createTextRange(Ma,0,W.K(0).cpEnd-W.K(0).cpBegin+ya.length))):W.K(0).contextId===x.a.kd&&W.removeAt(0);na.addRange(W);break;case 3:if(Ea.contextId===x.a.paragraph||Ea.contextId===x.a.od||Ea.contextId===x.a.Nd&&!Ea.cpBegin)W.W(W.count-1,w.a.create(Ba));else if(Ea.contextId===x.a.Nd||Ea.contextId===x.a.kd)Ea.cpBegin!==Ea.cpEnd||Ea.cpBegin===Ea.cpEnd&&X.length?W.W(W.count-1,w.a.createTextRange(Ba,Ea.cpBegin,Ea.cpEnd+X.length)):W.removeAt(W.count-1),W.add(w.a.Pm(Ba));na.addRange(W);
ka=ma.K(0);ma.removeAt(0);na.addRange(ma);ma.insert(0,ka);break;case 0:W.K(0).contextId===x.a.Nd?(W.W(0,w.a.createTextRange(Ma,ya.length,ya.length+W.K(0).cpEnd-W.K(0).cpBegin)),1<W.count&&W.K(1).contextId===x.a.od&&W.W(1,w.a.Pm(Ma))):W.K(0).contextId===x.a.kd?W.W(0,w.a.jd(Ma,ya.length+W.K(0).cpBegin)):W.K(0).contextId===x.a.od?W.W(0,w.a.Pm(Ma)):W.K(0).contextId===x.a.paragraph&&(ya.length&&this.qb.textLength(Ma)?(W.W(0,w.a.OV(ya.length,this.qb.textLength(Ma),!1,Ma)),1<W.count&&(W.insert(1,w.a.Pm(Ma)),
W.K(0).contextId===x.a.kd&&W.removeAt(0))):W.W(0,w.a.create(Ma)));na.addRange(W);break;case 1:na.addRange(W);break;case 4:for(ka=0;ka<W.count-1;++ka)X=W.K(ka).node,X=z.a.kb(X),X.Ib(40),X.Ac(),X.qh();na.addRange(ma)}W.clear();W.addRange(na);return ma}}N3k(W,X){const ka=new F.a,ma=W.length;if(0<ma&&X){X=w.a.create(X);ka.add(X);for(let na=0;na<ma;na++){var ja=this.Cgn(ka,W[na]);ja=w.a.create(ja);ka.add(ja)}ka.remove(X)}return ka}Cgn(W,X){X=V.a.MZc(X);var ka=W.K(W.count-1);const ma=this.qb.textLength(ka.node);
let ja;const na=this.qb.Cg(W.K(W.count-1).node,!1);ja=this.LDm(W.K(W.count-1));if(ka.contextId===x.a.paragraph||ka.contextId===x.a.od)if(na)ka.contextId===x.a.od&&0<ma?(ka=this.iZa(ja,X,!1,!0),W.W(0,w.a.Pm(ka))):ka=this.iZa(ja,X,!0,!0);else{let Ba;ka=this.Z$c((Ba=new F.a,Ba.add(ja),Ba),X,3).K(0).node}else ka.cpEnd===ma?ka=this.iZa(ja,X,!1,!0):ka.cpEnd?ka=this.rZf(ja,X,!1):(ka=this.iZa(ja,X,!0,!0),W.W(0,w.a.jd(ka,0)));return ka}LDm(W){var X=null;W.contextId===x.a.paragraph||W.contextId===x.a.od?(W=
W.node,X=this.qb.Cg(W,!1),X||(W=w.a.jd(W,this.qb.textLength(W)),X=this.Ehn(W).ic(2)),X=w.a.jd(X,0)):W.contextId===x.a.Nd||W.contextId===x.a.kd?X=w.a.jd(W.node,W.cpEnd):V.a.Cd();return X}Ehn(W){var X=null,ka=new z.a;ka.set(W.node);ka.Ib(11)&&(X=ka.Gq(11));ka=z.a.kb(X);var ma=z.a.kb(X);ma.Ib(40);ma.xd(40);const ja=new E.a;ma.QL(ja,X,1);X=z.a.kb(ja);ma.yk(ja);ma=this.ni.dN(X,void 0,!0);G.a.gm.F2a(z.a.kb(ka.ic(2)),z.a.kb(ma),W,!0,!0,!0,!1);v.a.xe(X);return X}hin(W){for(const X of W)this.kbd(X.node)&&
this.insertText(new F.a([X])," ",2)}ALm(W,X){return(W=this.Kab(W))&&this.Ica(W)===X?W:null}}Object(f.a)(ca,"InsertApiOperations",null,[1153])}).call(this,e(966).Buffer)},1930:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(){this.GNa=this.Umj=null;this.keepCurrentFocus=this.vrc=!1}}Object(I.a)(m,"NoteItemActionData",null,[])},1931:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.page=0]="page";f[f.next=2]="next";f[f.Qtq=1002]="sectionNext";f[f.Ntq=
3]="sectionContinuous";f[f.Otq=4]="sectionEven";f[f.Rtq=5]="sectionOdd";f[f.line=6]="line"})(m||(m={}));Object(I.b)("BreakType",m)},1932:function(I,K,e){(function(m){e.d(K,"a",function(){return x});var f=e(0),a=e(88),l=e(1170),w=e(1381),z=e(1379);class x extends w.a{constructor(u,v,E,y,H,D,G,J,U,F){super();this.Ud=u;this._context=v;this._id=E;this.orh=y;this.Jk=H;this.Tz=D;this.yd=G;this.uh=J;this.nd=U;this.Wr=F}get ZWf(){return this.orh}set ZWf(u){this.orh=u}get _Id(){return this._id}get _ReferenceId(){return this.kp?
this.Jp:null}get code(){return this.Tz.Gym(this)}set code(u){81===this.type&&(null===u||void 0===u?0:u.trim().toLowerCase().startsWith("addin"))?this.Tz.r0o(this,u):z.a.fMg()}get result(){if(this.Ud){const u=this.Jk.create(this.Ud,this._context);81===this.type?(u.l6d=1,u.isb=this.data,u.g6d=this.code):(u.l6d=0,u.isb=null,u.g6d=null);return u}return null}get parentBody(){return this.yd.KPf(this.Ud.K(0).node,this.Ud.K(this.Ud.count-1).node,this._context)}get parentContentControl(){const u=this.parentContentControlOrNullObject;
u||z.a.tl();return u}get parentContentControlOrNullObject(){const u=this.Ud.K(0),v=this.Ud.K(this.Ud.count-1);return this.uh.xnc(u,v,this._context)}get parentTable(){const u=this.parentTableOrNullObject;u||z.a.tl();return u}get parentTableCell(){const u=this.parentTableCellOrNullObject;u||z.a.tl();return u}get parentTableCellOrNullObject(){const u=this.Ud.K(0),v=this.Ud.K(this.Ud.count-1);return this.yd.$mc(u.node,this._context,v.node)}get parentTableOrNullObject(){const u=this.Ud.K(0),v=this.Ud.K(this.Ud.count-
1);return this.yd.Mtb(u.node,this._context,v.node)}ndm(u){return null===u||void 0===u?void 0:u.replace(/\r?\n|\r/g,"")}Bhn(u){var v;const E=RegExp(".{1,76}","g");return(null===(v=null===u||void 0===u?void 0:u.match(E))||void 0===v?void 0:v.join("\r\n").concat("\r\n"))||u}get data(){a.a.vca||z.a.Yj();if(81!==this.type)return null;const u=this.Tz.H9d(this);return z.a.eLe?u.data?m.from(this.ndm(u.data),"base64").toString("utf16le"):null:u.data?m.from(u.data,"base64").toString("utf8"):null}set data(u){a.a.vca||
z.a.Yj();81!==this.type&&z.a.vg();1E6<(null===u||void 0===u?void 0:u.length)&&z.a.Cd();u=z.a.eLe?m.from(u,"utf16le").toString("base64"):m.from(u,"utf8").toString("base64");this.Tz.H9d(this).data=z.a.eLe?this.Bhn(u):u}get kind(){a.a.vca||z.a.Yj();switch(this.type){case 81:case 88:case 13:case 31:return 2;default:return 0}}get locked(){a.a.vca||z.a.Yj();return 88===this.type?!0:this.Tz.H9d(this).PZa}set locked(u){a.a.vca||z.a.Yj();88!==this.type&&(this.Tz.H9d(this).PZa=u)}get showCodes(){return null}set showCodes(u){}get type(){a.a.vca||
z.a.Yj();const u=l.a.Ckc(this.code);return"addin"===u?81:"toc"===u?13:"hyperlink"===u?88:"date"===u?31:100}_KeepReference(){this.$o()}_OnAccess(){}delete(){a.a.vca||z.a.Yj();this.nd.Yic(this.Ud)}getNext(){const u=this.getNextOrNullObject();u||z.a.tl();return u}getNextOrNullObject(){return this.Tz.getNextOrNullObject(this,this._context)}getRange(){return this.Ud?this.Jk.create(this.Ud,this._context):null}select(u){a.a.vca||z.a.Yj();this.Wr.select(this.Ud,u)}updateResult(){a.a.vca||z.a.Yj();this.Tz.updateResult(this)}getTypeName(){return"Microsoft.WordServices.Field"}invokePropertyGet(u){switch(u){case 1:return this._Id;
case 2:return this._ReferenceId;case 3:return this.code;case 16:return this.data;case 13:return this.kind;case 15:return this.locked;case 5:return this.parentBody;case 6:return this.parentContentControl;case 7:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 10:return this.parentTableCell;case 11:return this.parentTableCellOrNullObject;case 9:return this.parentTableOrNullObject;case 4:return this.result;case 14:return this.showCodes;case 12:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,v){switch(u){case 3:this.code=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return;case 16:this.data=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return;case 15:this.locked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");return;case 14:this.showCodes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,v){this.invokePropertySet(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,v){switch(u){case 1002:return this.Sg();case 1001:return this.Tg();case 1003:return this.bF(v);case 1004:return this.b9();case 1005:return this.c9();case 1007:return this.lja(v);case 1006:return this.sHp()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokeMethodAsync(u,v){u=this.invokeMethod(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}bF(){return this.delete()}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}lja(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"int");this.select(u);return null}sHp(){this.updateResult();return null}}Object(f.a)(x,"Field",w.a,[866])}).call(this,e(966).Buffer)},1933:function(I,
K,e){e.r(K);e.d(K,"ExtensionComponentInstance",function(){return l});I=e(0);e(1751);e(1607);var m=e(2),f=e(12),a=e(1750);class l{constructor(w,z,x,u){this.L6b=this.ZP=null;this._id=w;this.oxk=x;this.VFk=u;this.ga=m.AFrameworkApplication.va?m.AFrameworkApplication.va:null}jLf(){return this.oxk}get appVersion(){return this.L6b}LYo(w){this.ZP=w}stop(){const w=this.ga.Zb(f.a.K8h,2,this.ZP);a.a.Hvg(this.VFk);return 32===w}restart(){return 32===this.ga.Zb(f.a.GMj,2,this.ZP)}}Object(I.a)(l,"ExtensionComponentInstance",
null,[1170])},1934:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[w]}})}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1935),K);f(e(1936),K)},1935:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1936:function(I,
K,e){Object.defineProperty(K,"__esModule",{value:!0});K.Security=K.DLP=K.CLP=K.SecurityShared=K.SeedAnnotation=K.EditAnnotation=K.SensitiveItemFullDocumentAnnotation=K.SensitiveItemRangeAnnotation=void 0;const m=e(532);class f{constructor(E){m.SchemaObject.assign(f,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemRangeAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}}K.SensitiveItemRangeAnnotation=
f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(E){m.SchemaObject.assign(a,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemFullDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}K.SensitiveItemFullDocumentAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(E){m.SchemaObject.assign(l,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_SecurityShared_EditAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
K.EditAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(E){m.SchemaObject.assign(w,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_SecurityShared_SeedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}K.SeedAnnotation=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(E){m.SchemaObject.assign(z,this,E)}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}
K.SecurityShared=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(E){m.SchemaObject.assign(x,this,E)}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}K.CLP=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(E){m.SchemaObject.assign(u,this,E)}static getTypeName(){return"AugLoop_SecurityShared_DLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}K.DLP=u;u.H_={T_:u.getTypeName(),
B_:u.getBaseTypes()};class v{constructor(E){m.SchemaObject.assign(v,this,E)}static getTypeName(){return"AugLoop_SecurityShared_Security"}static getBaseTypes(){return[]}}K.Security=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()}},1937:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1938:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.RoamingSettingsExampleAnotherCustomAnnotation=K.RoamingSettingsExampleCustomAnnotation=K.RoamingSettingAnnotation=void 0;const m=e(532);
class f{constructor(w){m.SchemaObject.assign(f,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[f.getTypeName()])}}K.RoamingSettingAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=
w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}K.RoamingSettingsExampleCustomAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleAnotherCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,
[l.getTypeName()])}}K.RoamingSettingsExampleAnotherCustomAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1939:function(I,K){Object.defineProperty(K,"__esModule",{value:!0});K.RoamingSettingType=void 0;I=K.RoamingSettingType||(K.RoamingSettingType={});I.SingleValue="SingleValue";I.Dictionary="Dictionary"},1940:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.RoamingSettingsWriteSignal=K.RoamingSettingsReadSignal=K.RoamingSettingsSignal=void 0;const m=e(532);class f{constructor(w){m.SchemaObject.assign(f,
this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[f.getTypeName()])}}K.RoamingSettingsSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsReadSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal",
"AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}K.RoamingSettingsReadSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsWriteSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal","AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[l.getTypeName()])}}K.RoamingSettingsWriteSignal=
l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1941:function(I){function K(e,m,f){function a(){x=this;z=arguments;u=Date.now();var E=f&&!w;w||(w=setTimeout(l,m));E&&(v=e.apply(x,z),x=z=null);return v}function l(){var E=Date.now()-u;E<m&&0<=E?w=setTimeout(l,m-E):(w=null,f||(v=e.apply(x,z),x=z=null))}var w,z,x,u,v;null==m&&(m=100);a.clear=function(){w&&(clearTimeout(w),w=null)};a.flush=function(){w&&(v=e.apply(x,z),x=z=null,clearTimeout(w),w=null)};return a}K.QWa=K;I.exports=K;Object.defineProperty(I.exports,
"debounce",{enumerable:!0,get(){return I.exports.QWa}})},1945:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,
"__esModule",{value:!0});f(e(1946),K);f(e(1947),K);f(e(1948),K);f(e(1949),K)},1946:function(I,K){Object.defineProperty(K,"__esModule",{value:!0});K.DocumentTone=K.DocumentType=K.CitationStyle=K.OutputLength=K.FilterSensitivity=K.DetailedStatusCode=K.Status=void 0;(function(e){e.Success="Success";e.BlockedByPrefilter="BlockedByPrefilter";e.BlockedByPostfilter="BlockedByPostfilter";e.UnexpectedError="UnexpectedError"})(K.Status||(K.Status={}));(function(e){e[e.Pass=0]="Pass";e[e.SourceEmpty=1]="SourceEmpty";
e[e.SourceExceedLength=2]="SourceExceedLength";e[e.BRS=3]="BRS";e[e.OutputIdentical=4]="OutputIdentical";e[e.FilteredCharInRewrite=5]="FilteredCharInRewrite";e[e.UnkInRewrite=6]="UnkInRewrite";e[e.FluencyTooMuchChange=7]="FluencyTooMuchChange";e[e.ConcisenessLonger=8]="ConcisenessLonger";e[e.InvalidSpan=9]="InvalidSpan";e[e.InputException=10]="InputException";e[e.PredictionException=11]="PredictionException";e[e.PolitenessClassifierFiltered=12]="PolitenessClassifierFiltered";e[e.SourceTooShort=13]=
"SourceTooShort";e[e.PolitenessClassifierException=14]="PolitenessClassifierException";e[e.SentenceNotEnd=15]="SentenceNotEnd";e[e.PolitenessDeltaTooSmall=16]="PolitenessDeltaTooSmall";e[e.PolitenessTooLittleChange=17]="PolitenessTooLittleChange";e[e.Prefiltered=18]="Prefiltered";e[e.RegexFiltered=19]="RegexFiltered";e[e.PostfilteredLvl2=20]="PostfilteredLvl2";e[e.PostfilteredLvl3=21]="PostfilteredLvl3";e[e.OutputFiltered=91]="OutputFiltered";e[e.InputFilteredIncompleteBP=92]="InputFilteredIncompleteBP"})(K.DetailedStatusCode||
(K.DetailedStatusCode={}));(function(e){e.High="High";e.Medium="Medium";e.Low="Low";e.Disabled="Disabled"})(K.FilterSensitivity||(K.FilterSensitivity={}));(function(e){e.Short="Short";e.Medium="Medium";e.Long="Long"})(K.OutputLength||(K.OutputLength={}));(function(e){e.APA="APA";e.Chicago="Chicago";e.MLA="MLA"})(K.CitationStyle||(K.CitationStyle={}));(K.DocumentType||(K.DocumentType={})).News="News";(function(e){e.Neutral="Neutral";e.Casual="Casual";e.Excited="Excited";e.Passionate="Passionate";e.Persuasive=
"Persuasive";e.Professional="Professional";e.Optimistic="Optimistic";e.Technical="Technical";e.Thankful="Thankful"})(K.DocumentTone||(K.DocumentTone={}))},1947:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.WritersUnblockAnnotation=K.QualityStatus=void 0;const m=e(532);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_WritersUnblock_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[f.getTypeName()])}}K.QualityStatus=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_WritersUnblock_WritersUnblockAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}K.WritersUnblockAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1948:function(I,K){Object.defineProperty(K,
"__esModule",{value:!0})},1949:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.WritersUnblockRequest=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_WritersUnblock_WritersUnblockRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.WritersUnblockRequest=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1950:function(I,K,e){var m=
this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1951),K);f(e(1952),K);f(e(1953),K);f(e(1954),
K)},1951:function(I,K){Object.defineProperty(K,"__esModule",{value:!0});K.Result=void 0;I=K.Result||(K.Result={});I.Success="Success";I.UnknownError="UnknownError"},1952:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1953:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.TextAbstractiveSummaryAnnotation=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_TextAbstractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.TextAbstractiveSummaryAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1954:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.GenerateTextAbstractiveSummarySignal=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_GenerateTextAbstractiveSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.GenerateTextAbstractiveSummarySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1955:function(I){I.exports=JSON.parse('{"Spelling":["Spelling","Drejtshkrimi","\u1225\u122d\u12d3\u1270 \u1206\u1204\u12eb\u1275","\u0627\u0644\u062a\u062f\u0642\u064a\u0642 \u0627\u0644\u0625\u0645\u0644\u0627\u0626\u064a","\u0548\u0582\u0572\u0572\u0561\u0563\u0580\u0578\u0582\u0569\u0575\u0578\u0582\u0576","\u09ac\u09be\u09a8\u09be\u09a8","Orfoqrafiya","Ortografia","\u0410\u0440\u0444\u0430\u0433\u0440\u0430\u0444\u0456\u044f","Pravopis","\u041f\u0440\u0430\u0432\u043e\u043f\u0438\u0441\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430","\u062d\u0648\u0646\u062c\u06d5\u06a9\u0631\u062f\u0646","\u13a0\u13aa\u13b5\u13f0\u13cd\u13a9","\u62fc\u5199\u68c0\u67e5","\u62fc\u5b57\u6aa2\u67e5","Provjera pravopisa","Kontrola pravopisu","Stavekontrol","\u0627\u0645\u0644\u0627","\u00d5igekiri","Oikeinkirjoitus","Orthographe","Ortograf\u00eda","\u10db\u10d0\u10e0\u10d7\u10da\u10ec\u10d4\u10e0\u10d0","Rechtschreibung","\u039f\u03c1\u03b8\u03bf\u03b3\u03c1\u03b1\u03c6\u03af\u03b1","\u0a9c\u0acb\u0aa1\u0aa3\u0ac0","Sifellin","\u05d1\u05d3\u05d9\u05e7\u05ea \u05d0\u05d9\u05d5\u05ea","\u0935\u0930\u094d\u0924\u0928\u0940","Helyes\u00edr\u00e1s-ellen\u0151rz\u00e9s","Stafsetning","Nsupe","Ejaan","Titirarniq titirausikkut","Litri\u00fa","Upelo","Isipelingi","\u30b9\u30da\u30eb \u30c1\u30a7\u30c3\u30af","\u0c95\u0cbe\u0c97\u0cc1\u0ca3\u0cbf\u0ca4","\u0415\u043c\u043b\u0435\u043d\u0456 \u0442\u0435\u043a\u0441\u0435\u0440\u0443","\u17a2\u1780\u17d2\u1781\u179a\u17b6\u179c\u17b7\u179a\u17bb\u1791\u17d2\u1792","Usuk\'manem tz\'ib\'","Imyandikire","Tahajia","\u0935\u0930\u094d\u0923\u0930\u091a\u0928\u093e","\ub9de\ucda4\ubc95","\u0416\u0430\u0437\u044b\u043b\u044b\u0448","\u0e81\u0eb2\u0e99\u0eaa\u0eb0\u0e81\u0ebb\u0e94\u0e84\u0eb3","Pareizrakst\u012bba","Ra\u0161ybos tikrinimas","Orthographie","\u041f\u0440\u0430\u0432\u043e\u043f\u0438\u0441","\u0d38\u0d4d\u0d2a\u0d46\u0d32\u0d4d\u0d32\u0d3f\u0d02\u0d17\u0d4d","Ortografija","Takikupu","\u0935\u0930\u094d\u0923\u0935\u093f\u0928\u094d\u092f\u093e\u0938","\u0417\u04e9\u0432 \u0431\u0438\u0447\u0433\u0438\u0439\u043d \u0434\u04af\u0440\u044d\u043c","\u0939\u093f\u091c\u094d\u091c\u0947","Stavekontroll","\u0b2c\u0b28\u0b3e\u0b28\u0b4d","Pisownia","\u0a36\u0a2c\u0a26\u0a1c\u0a4b\u0a5c","\u0627\u0645\u0644\u0627\u0621","Allin qillqay","Corectare ortografic\u0103","Litreachadh","\u041e\u0440\u0444\u043e\u0433\u0440\u0430\u0444\u0438\u044f","Mopeleto","\u0647\u062c\u064a","\u0d85\u0d9a\u0dca\u0dc2\u0dbb \u0dc0\u0dd2\u0db1\u0dca\u200d\u0dba\u0dcf\u0dc3\u0dba","\u010crkovanje","Stavning","\u0418\u043c\u043b\u043e","\u0b8e\u0bb4\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1 \u0b9a\u0bb0\u0bbf\u0baa\u0bbe\u0bb0\u0bcd\u0baa\u0bcd\u0baa\u0bc1","\u0414\u04e9\u0440\u0435\u0441 \u044f\u0437\u044b\u043b\u044b\u0448","\u0c05\u0c15\u0c4d\u0c37\u0c30\u0c15\u0c4d\u0c30\u0c2e\u0c02","\u0e01\u0e32\u0e23\u0e2a\u0e30\u0e01\u0e14","\u12a3\u1340\u1213\u1215\u134b","Yaz\u0131m Denetimi","Orfografi\u00fda","\u041e\u0440\u0444\u043e\u0433\u0440\u0430\u0444\u0456\u044f","\u06c1\u062c\u06d2","\u0626\u0649\u0645\u0644\u0627","Imlo","Ki\u00ea\u0309m tra chi\u0301nh ta\u0309","Sillafu","Bindiin","\u00c0y\u1eb9\u0300w\u00f2 \u1eb8y\u1ecd \u1ecc\u0300r\u1ecd\u0300"],"Perspectives":["Perspectives"],"Acronyms":["Acronyms","Acronymes","Akronyme","Acr\u00f3nimos"],"Uncommon Words":["Uncommon Words"],"Grammar":["\u0646\u062d\u0648","\u8bed\u6cd5","\u8a9e\u6cd5","Gramatika","Grammatik","Grammatica","Grammar","Kielioppi","Grammaire","\u05d3\u05e7\u05d3\u05d5\u05e7","Nyelvtan","\u6587\u6cd5","\uc5b4\ubc95","Grammatikk","Gramatyka","Gram\u00e1tica","\u0413\u0440\u0430\u043c\u043c\u0430\u0442\u0438\u043a\u0430","Gramer"],"Clarity":["\u0627\u0644\u0648\u0636\u0648\u062d","\u660e\u6670\u6027","\u6e05\u6670\u6027","Jasnost","Klarhed","Duidelijkheid","Clarity","Selkeys","Clart\u00e9","Verst\u00e4ndlichkeit","\u05e9\u05e4\u05d4 \u05d1\u05e8\u05d5\u05e8\u05d4","\u00c9rthet\u0151s\u00e9g","Chiarezza","\u660e\u77ad\u306a\u8868\u73fe","\uba85\ub8cc\uc131","Klarhet","Przejrzysto\u015b\u0107","Clareza","\u042f\u0441\u043d\u043e\u0441\u0442\u044c","Claridad","A\u00e7\u0131kl\u0131k"],"Conciseness":["\u0627\u0644\u062f\u0642\u0629","\u7b80\u660e\u6027","\u7c21\u660e\u6027","V\u00fdsti\u017enost","Kortfattethed","Beknoptheid","Conciseness","Ytimekkyys","Concision","Pr\u00e4gnanz","\u05e9\u05e4\u05d4 \u05ea\u05de\u05e6\u05d9\u05ea\u05d9\u05ea","T\u00f6m\u00f6rs\u00e9g","Concisione","\u7c21\u6f54\u306a\u8868\u73fe","\uac04\uacb0\uc131","Presisjon","Zwi\u0119z\u0142o\u015b\u0107","Concis\u00e3o","\u041a\u0440\u0430\u0442\u043a\u043e\u0441\u0442\u044c","Concisi\u00f3n","Precision","Yal\u0131nl\u0131k"],"Formality":["\u0644\u063a\u0629 \u0631\u0633\u0645\u064a\u0629","\u6b63\u5f0f\u8bed\u4f53","\u6b63\u5f0f\u8a9e\u8a00","Form\u00e1ln\u00ed vyjad\u0159ov\u00e1n\u00ed","Formelt sprog","Formeel taalgebruik","Formality","Virallinen kieli","Langage formel","Formelle Sprache","\u05e9\u05e4\u05d4 \u05ea\u05e7\u05e0\u05d9\u05ea","Nyelvhaszn\u00e1lat","Registro formale","\u6b63\u5f0f\u306a\u7528\u6cd5","\ud615\uc2dd \uc5b8\uc5b4","Formelt spr\u00e5k","J\u0119zyk literacki","Linguagem formal","\u041e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u044f\u0437\u044b\u043a","Lenguaje formal","Formellt spr\u00e5k","Resm\u00ee dil"],"Inclusiveness":["\u0627\u0644\u0634\u0645\u0648\u0644\u064a\u0629","\u5305\u5bb9\u6027\u8bed\u8a00","\u5305\u5bb9\u6027\u8a9e\u8a00","Nediskriminuj\u00edc\u00ed jazyk","Inkluderende sprog","Inclusief taalgebruik","Inclusiveness","Syrjiv\u00e4 kielenk\u00e4ytt\u00f6","Langage non-discriminant","Neutrale Sprache","\u05e9\u05e4\u05d4 \u05de\u05db\u05d9\u05dc\u05d4","Politikailag korrekt nyelvhaszn\u00e1lat","Linguaggio inclusivo","\u975e\u5dee\u5225\u7528\u8a9e","\uac00\uce58 \uc911\ub9bd\uc801 \uc5b8\uc5b4","Inkluderende spr\u00e5k","J\u0119zyk r\u00f3wno\u015bciowy","Linguagem inclusiva","\u041d\u0435\u0434\u0438\u0441\u043a\u0440\u0438\u043c\u0438\u043d\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u044f\u0437\u044b\u043a","Lenguaje no discriminatorio","Inkluderande spr\u00e5kbruk","Ayr\u0131mc\u0131 dil"],"Punctuation Conventions":["\u0627\u0644\u062a\u0631\u0642\u064a\u0645","\u6807\u70b9\u89c4\u8303","\u6a19\u9ede\u7b26\u865f\u898f\u5247","Interpunkce","Tegns\u00e6tning","Interpunctie","Punctuation Conventions","V\u00e4limerkit","Ponctuation","Interpunktion","\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea \u05e4\u05d9\u05e1\u05d5\u05e7","K\u00f6zpontoz\u00e1si szok\u00e1sok","Punteggiatura","\u53e5\u8aad\u70b9","\uad6c\ub450\ubc95","Tegnsetting","Interpunkcja","Pontua\u00e7\u00e3o","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u0438","Puntuaci\u00f3n","Noktalama i\u015faretleri kurallar\u0131"],"Resume":["\u0627\u0644\u0633\u064a\u0631\u0629 \u0627\u0644\u0630\u0627\u062a\u064a\u0629","\u7b80\u5386","\u5c65\u6b77","\u017divotopis","Curriculum Vitae","CV","Resume","Ansioluettelo","Lebenslauf","\u05e7\u05d5\u05e8\u05d5\u05ea \u05d7\u05d9\u05d9\u05dd","\u00d6n\u00e9letrajz","\u5c65\u6b74\u66f8","\uc774\ub825\uc11c","\u017byciorys","Curr\u00edculo","\u0410\u0432\u0442\u043e\u0431\u0438\u043e\u0433\u0440\u0430\u0444\u0438\u044f","Meritf\u00f6rteckning","\u00d6z ge\u00e7mi\u015f"],"Sensitive Geopolitical References":["\u0639\u0628\u0627\u0631\u0627\u062a \u062c\u064a\u0648\u0633\u064a\u0627\u0633\u064a\u0629 \u062d\u0633\u0627\u0633\u0629","\u654f\u611f\u5730\u7f18\u653f\u6cbb\u53c2\u8003","\u654f\u611f\u5730\u7de3\u653f\u6cbb\u53c3\u7167","Citliv\u00e9 geopolitick\u00e9 odkazy","F\u00f8lsomme geopolitiske betegnelser","Gevoelige geopolitieke referenties","Sensitive Geopolitical References","Ongelmalliset geopoliittiset viittaukset","R\u00e9f\u00e9rences g\u00e9opolitiques sensibles","Problematische geopolitische Bezeichnungen","\u05d4\u05e7\u05e9\u05e8\u05d9\u05dd \u05d2\u05d9\u05d0\u05d5-\u05e4\u05d5\u05dc\u05d9\u05d8\u05d9\u05d9\u05dd \u05e8\u05d2\u05d9\u05e9\u05d9\u05dd","\u00c9rz\u00e9keny geopolitikai kifejez\u00e9se","Riferimenti geopolitici problematici","\u5730\u653f\u7684\u306b\u914d\u616e\u3059\u3079\u304d\u7528\u8a9e","\ubbfc\uac10\ud55c \uc9c0\uc815\ud559\uc801 \uc6a9\uc5b4","Geopolitisk sensitive spr\u00e5kformer","Poprawno\u015b\u0107 geopolityczna","Refer\u00eancias geopol\u00edticas delicadas","\u0413\u0435\u043e\u043f\u043e\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u044b","Referencias geopol\u00edticas sensibles","K\u00e4nsliga geopolitiska referenser","Hassas jeopolitik ifadeler"],"Vocabulary":["\u0627\u0644\u0645\u0641\u0631\u062f\u0627\u062a","\u8bcd\u6c47\u9009\u62e9","\u8a5e\u5f59\u9078\u64c7","Slovn\u00ed z\u00e1soba","Ordvalg","Woordkeuze","Vocabulary","Sanasto","Vocabulaire","Wortwahl","\u05d1\u05d7\u05d9\u05e8\u05ea \u05d0\u05d5\u05e6\u05e8 \u05de\u05d9\u05dc\u05d9\u05dd","Sz\u00f3v\u00e1laszt\u00e1s","Scelte lessicali","\u8a9e\u5f59\u306e\u8003\u616e","\uc5b4\ud718 \uc120\ud0dd","S\u0142ownictwo","Escolha vocabular","\u0412\u044b\u0431\u043e\u0440 \u0441\u043b\u043e\u0432 \u0438 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0439","Vocabulario","Ordval","S\u00f6zc\u00fckler"],"Consistent Written Forms":["\u062a\u0646\u0627\u0633\u0642 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u5f02\u4f53\u8bcd\u7edf\u4e00","\u7570\u9ad4\u8a5e\u7d71\u4e00\u7528\u6cd5","Konzistentn\u00ed psan\u00e9 tvary","Konsistente staveformer","Consistent taalgebruik","Consistent Written Forms","Yhten\u00e4inen kirjoitusasu","Coh\u00e9rence","Konsistente Schreibformen","\u05e2\u05e7\u05d1\u05d9\u05d5\u05ea \u05d1\u05db\u05ea\u05d9\u05d1\u05d4","Konzisztens \u00edrott alak","Coerenza formale","\u8868\u8a18\u306e\u63fa\u308c","\uc77c\uad00\ub41c \uc11c\uc2dd","Konsekvente skriftformer","Sp\u00f3jno\u015b\u0107 zapisu","Escritura coerente","\u0415\u0434\u0438\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u044f","Coherencia","Konsekventa skriftformer","Tutarl\u0131 yaz\u0131m bi\u00e7imleri"],"Error Corrections":["\u062a\u0635\u062d\u064a\u062d \u0623\u062e\u0637\u0627\u0621","\u7ea0\u9519","\u7cfe\u932f","Oprava chyb","Fejlkorrigering","Foutcorrectie","Error Corrections","Virheen korjaukset","Correction d\'erreurs","Fehlerkorrigierungen","\u05ea\u05d9\u05e7\u05d5\u05df \u05e9\u05d2\u05d9\u05d0\u05d5\u05ea","Hiba jav\u00edt\u00e1s","Correzione degli errori","\u8aa4\u308a\u306e\u30c1\u30a7\u30c3\u30af","\uc624\ub958 \uc218\uc815","Feilretting","Korekta b\u0142\u0119d\u00f3w","Corre\u00e7\u00e3o de erros","\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a","Correcci\u00f3n de errores","Felkorrigering","Hata d\u00fczeltmeleri"],"Writing Conventions":["\u0623\u0633\u0627\u0644\u064a\u0628 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u4e66\u5199\u89c4\u8303","\u66f8\u5beb\u898f\u5247","Pravopis","Skriftkonventioner","Schrijfregels","Writing Conventions","Kirjoitustyyli","Conventions","Schreibkonventionen","\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea \u05db\u05ea\u05d9\u05d1\u05d4","Helyes\u00edr\u00e1si szok\u00e1sok","Convenzioni di scrittura","\u8868\u8a18\u306e\u57fa\u6e96","\uae00\uc4f0\uae30 \uaddc\uce59","Skriftnormer","Konwencje zapisu","Normas de escrita","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b \u043f\u0438\u0441\u044c\u043c\u0435\u043d\u043d\u043e\u0439 \u0440\u0435\u0447\u0438","Convenciones de escritura","Skrivregler","Yaz\u0131m kurallar\u0131"],"Typing Errors":["\u0623\u062e\u0637\u0627\u0621 \u0625\u0645\u0644\u0627\u0626\u064a\u0629","\u7b14\u8bef","\u7b46\u8aa4","P\u0159eklepy","Tastefejl","Typefouten","Typing Errors","Ly\u00f6ntivirheet","Fautes de frappe","Tippfehler","\u05d8\u05e2\u05d5\u05d9\u05d5\u05ea \u05d4\u05e7\u05dc\u05d3\u05d4","G\u00e9pel\u00e9si hib\u00e1k","Errori di digitazione","\u5165\u529b\u30df\u30b9","\uc624\ud0c0","Skrivefeil","Liter\u00f3wki","Erros de digita\u00e7\u00e3o","\u041e\u043f\u0435\u0447\u0430\u0442\u043a\u0438","Erratas","Skrivfel","Yaz\u0131m hatalar\u0131"],"Rewrite":["\u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0643\u062a\u0627\u0628\u0629","\u6539\u5199","\u6539\u5beb","P\u0159eformulov\u00e1n\u00ed","Omskrivning","Herschrijving","Rewrite","Uudelleenkirjoitus","Reformulations","Umschreibung","\u05e9\u05db\u05ea\u05d5\u05d1","\u00c1t\u00edr\u00e1s","Riscrittura","\u7de8\u96c6","\ub2e4\uc2dc \uc4f0\uae30","Omskriving","Przeformu\u0142owanie","Reescrita","\u041f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u043d\u0438\u0435","Reformulaciones","Yeniden yaz\u0131m"],"Different phrasing":["Different phrasing"],"Improves flow":["Improves flow"],"Improves readability":["Improves readability"],"More concise":["More concise"],"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling.":["These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."],"The goal of these suggestions is to express an idea clearly, without extra words.":["The goal of these suggestions is to express an idea clearly, without extra words."],"These suggestions provide alternative ways of wording a phrase or sentence.":["These suggestions provide alternative ways of wording a phrase or sentence."],"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording.":["The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording."],"More formal":["More formal"],"These suggestions help make your writing more formal by reducing casual wording.":["These suggestions help make your writing more formal by reducing casual wording."]}')},
1956:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1957),K);f(e(1958),
K);f(e(1959),K);f(e(1960),K);f(e(1961),K);f(e(1962),K);f(e(1963),K);f(e(1964),K)},1957:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1958:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1959:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1960:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1961:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.BasicChatResponse=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,
this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_BasicChatResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextChatResponse","AugLoop_Chat_ChatResponse","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.BasicChatResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1962:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.DslResponse=void 0;const m=
e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_DslResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.DslResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1963:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.BasicChat=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,
this,a)}static getTypeName(){return"AugLoop_BasicChat_BasicChat"}static getBaseTypes(){return["AugLoop_Chat_Chat"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.BasicChat=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1964:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.DslInput=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_BasicChat_DslInput"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.DslInput=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2136:function(I,K,e){function m(d){"Committed"===d.RT?Object(Zi.w)(d,"HoveredCommitted"):"Highlighted"===d.RT&&Object(Zi.w)(d,"HoveredHighlighted")}function f(d){"HoveredCommitted"===d.RT?Object(Zi.w)(d,"Committed"):"HoveredHighlighted"===d.RT&&Object(Zi.w)(d,"Highlighted")}function a(d,n){var B=d.getByTag(n).getFirst().MKg;if(B){d=oj.TableReader.kA(B,0,oj.TableReader.Hg(B)-1).K(0);d=Fy.a.wbd(d);n=oj.TableReader.Nh(B);
const Aa=[];B=oj.TableReader.kA(B,0,0).K(0);B=Fy.a.UD(B);for(var Q of B){B="";var ha=new vc.a;ha.set(Q);ha.ic(1);ha=ha.ue();ha=new ge.a(ha,ed.a.paragraph);ha=bf.ParagraphReader.text(ha.node);B+=Ed.AParagraphNode.DR(ha);B=B.trim();Aa.push(B)}Q=JSON.stringify({columnsList:Aa,totalColumns:n,isHeaderTable:d});Object(Zi.o)("SendTableColumnDetails",Q)}}function l(d,n,B,Q,ha,Aa,bb,Ib,oc){let Ac=0;for(const sd of bb){bb=new vc.a;bb.set(sd);bb.ic(1);bb=bb.ue();var ad=new ma.a;const wd=ge.a.OV(0,bf.ParagraphReader.textLength(bb),
!1,bb);ad.add(wd);"thumbnail"===oc[Ac]||"FileLeafRef"===oc[Ac]?n.kma(wd)&&(Ib[Ac]?(bb=ha.create(bb,B),ad=Q.create(sd,B),bb.Q$c(Ib[Ac],4,{height:ad.columnWidth,width:ad.columnWidth,useSourceImageProps:!1})):d.insertText(ad,Ib[Ac]||"",4)):"RichMultiText"===oc[Ac]?ha.create(bb,B).insertHtml(Ib[Ac],4):(d.insertText(ad,Ib[Ac],4),"hyperlink"===oc[Ac]&&Aa.SJ(ad.K(0),Ib[Ac],!1));Ac++}}function w(d,n,B,Q,ha,Aa,bb,Ib){let oc=!1;(d.GN||1===n.kq.count&&1===n.text.length)&&0===B&&1===n.QPf(n.kq.K(0)).count&&(oc=
!0,!bb&&ha&&Aa&&(ha.Values.type="ImageSelection",ha.Values.payload="ImageSelection",ha.Values.Action="SuccessfulSelectionV2",Ib&&(ha.Values.payload=JSON.stringify({text:"ImageSelection",typeOfField:{regular:!0,conditional:!1}})),Q.flag=!0,window.parent.postMessage(JSON.stringify(ha),Aa)));return oc}async function z(d,n){var B=d.vSb();B=d.getRange(0).QPf(B.K(0));1===B.count&&Cj.a.U5i(B.K(0))&&(B=Cj.a.Io(B.K(0)),B=Cj.a.OEi(B),B={height:B.height,width:B.width,imageSelection:!0,useSourceImageProps:!1,
altText:n.altText},n.useSourceImageProps||(B.useSourceImageProps=!0),Object(Zi.w)(d,"Filled"),d.Q$c(n.imageUrl,4,B))}function x(d,n,B,Q){var ha,Aa;if(Q&&n.tag.startsWith("mscacr"))if(Q=n.vSb(),n.Pg)for(Aa=0;Aa<Q.count;Aa++){var bb=null===(ha=Q.K(Aa))||void 0===ha?void 0:ha.node;n=d;var Ib=B;for(let oc=0;oc<bb.ra.length;oc++){const Ac=bb.ra.jc(oc).formatting;n.rWj(Ac,Ib)}}else{ha=null===(Aa=n.vSb().K(0))||void 0===Aa?void 0:Aa.node;Q=n.vSb().K(0).cpBegin;Aa=n=n.vSb().K(0).cpEnd;n=[];for(bb=0;bb<ha.ra.length;bb++)Ib=
ha.ra.jc(bb).cp,Ib>=Q&&Ib<Aa&&n.push(ha.ra.jc(bb));for(ha=0;ha<n.length;ha++)n[ha].blob||d.rWj(n[ha].formatting,B)}}function u(d){sD.has(d)||(F.ULS.sendTraceTag(528506889,2253,10,`Stat ${d} is undefined or zero`),sD.set(d,{valueMissing:!0,yRg:!1}))}function v(d){var n,B;null!==(n=sD.get(d))&&void 0!==n&&n.yRg||(F.ULS.sendTraceTag(528506890,2253,10,`Stat ${d} defined and non-zero`),n=null!==(B=sD.get(d))&&void 0!==B?B:{valueMissing:!1,yRg:!1},n.yRg=!0,sD.set(d,n))}function E(){var d,n;return null!==
(n=null===(d=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1))&&void 0!==n?n:!1}e.r(K);var y={};e.r(y);e.d(y,"getDocument",function(){return ov});var H=e(1077),D=e(0),G=e(2);class J{get name(){return"AppLoadStateTracker"}Ec(){}init(){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MarkAppFullyLoadedExplicitly",!1)||H.a.get_instance().Lhj()}dispose(){}}
Object(D.a)(J,"AppLoadStateTrackerPackage",null,[0,1]);var U=e(186),F=e(8),T=e(43);class Y{constructor(){this.Gtj=d=>{d=d.rawEvent;let n=d.blockedURI;n=T.a.Zda(n);const B={};B.effectiveDirective=d.effectiveDirective;B.violatedDirective=d.violatedDirective;B.originalPolicy=d.originalPolicy;B.blockedURI=n;B.disposition=d.disposition;F.ULS.sendTraceTag(588084128,306,15,"{0}",B)};$addHandler(document,"securitypolicyviolation",this.Gtj)}dispose(){$removeHandler(document,"securitypolicyviolation",this.Gtj)}}
Object(D.a)(Y,"ContentSecurityPolicyListener",null,[11]);class P{constructor(){this.Z=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Z.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const d=this.Z.Wa("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");d&&d.dispose()}Ec(d){this.Z=d;this.Z.register(Y,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").ha().fe(()=>new Y)}static main(){U.a.instance.Rc(new P)}}Object(D.a)(P,
"ContentSecurityPolicyPackage",null,[0,1]);var S=e(98),N=e(1264),V=e(288),Z=e(12);class ca{constructor(d,n){this.MJc=null;this.mEp=(B,Q,ha,Aa,bb)=>{if(1===ha)return 32;bb[N.a.Value]=this.MJc;bb[V.a.labelText]=this.MJc;bb[N.a.Visible]=!0;return 32};this.ga=d;this.za=n}mc(){(this.MJc=this.za.rb("StatusBarEnvironmentNameToUse"))&&""!==this.MJc&&this.ga.nb(Z.a.PCj,S.a.frame,this.mEp,96)}}Object(D.a)(ca,"DisplayEnvironmentName",null,[]);class W{constructor(){this.Z=null}get name(){return"Common.App.DisplayEnvironmentName"}Ec(d){this.Z=
d;this.Z.register(ca,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ha().fe(()=>new ca(G.AFrameworkApplication.va,G.AFrameworkApplication.J))}init(){this.Z.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").mc()}dispose(){}static main(){U.a.instance.Rc(new W)}}Object(D.a)(W,"DisplayEnvironmentNamePackage",null,[0,1]);var X=e(118),ka=e(782),ma=e(76),ja=e(287);class na{constructor(d,n,B=null){this.id=d.Id;B||(B="");this.Fwo=B;this.sensitivityLabel=d}}Object(D.a)(na,"AutoPolicyLabelData",
null,[]);class Ba{constructor(d,n){this.oKa=d;this.displayName=n}}Object(D.a)(Ba,"PolicyLabelRequestState",null,[]);class Ma{constructor(){this.JAg=this.Qfg=""}}Object(D.a)(Ma,"PolicyStrings",null,[]);var Ea=e(191),ya=e(105),ia=e(10),za=e(37),Ca=e(16);class db{static get W5f(){return db.tDn}}db.tDn="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(D.a)(db,"JustificationDialogHtml",null,[]);class pa extends Ea.a{constructor(d,n){super(!1,!1,pa.OP);this.Alb=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.DNd=null;this.CNd=!1;this.sDn=(B,Q)=>{let ha="";if(1===B)for(let Aa=0;Aa<this.Alb.length;Aa++)if(Q[pa.Ssg+Aa]){ha=Aa===this.Alb.length-1?Q[pa.Kud]:this.Alb[Aa];break}this.ey(B,this.kPd,ha)};this.AEj=B=>{let Q="";1===B&&
this.DNd&&(Q=this.DNd);this.ey(B,this.kPd,Q)};this.s6n=B=>{this.DNd=B;B=this.validate();this.CNd!==B&&(this.CNd=B,this.U$(CommonUIStrings.l_SensitivityJustificationTitle,this.AEj,this.uKi(this.CNd)))};this.lrp=B=>{B.target&&this.Dxa(1,this.validate())};this.mwe=B=>{if(B=B.target){B.checked=!0;var Q=$get(pa.Kud);B.id===pa.Ssg+(this.Alb.length-1)?(Q.disabled=!1,Sys.UI.DomElement.setVisible(Q,!0),Q.focus()):(Q.disabled=!0,B.focus());this.Dxa(1,this.validate())}};this.kPd=d;this.ey=n;this.Fh=this.Cml();
this.Md=1;this.$g=pa.id;this.Ue(1,CommonUIStrings.l_DialogChange);this.Dxa(1,!1);this.YW(0)}XGg(){if(pa.OP)this.ti(CommonUIStrings.l_SensitivityJustificationTitle,this.AEj,this.uKi(this.CNd));else{const d={};for(let n=0;n<this.Alb.length;n++)d[pa.Ssg+n]=!1;d[pa.Kud]="";this.ti(CommonUIStrings.l_SensitivityJustificationTitle,this.sDn,d);this.wug();za.a.addHandler($get(pa.Kud),ia.a.input,this.lrp)}}validate(){if(pa.OP)return this.$fk(this.DNd);const d=$get(pa.Kud);return d.disabled?!0:this.$fk(d.value)}$fk(d){const n=
2>d.length,B=500<d.length,Q=RegExp("[{|}|;|\\\\]").test(d);d=""===Ca.a.LFa(d);return!n&&!B&&!Q&&!d}uKi(d){return{["id"]:this.$g,["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!d},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,
["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,["onJustificationUpdated"]:this.s6n}}Cml(){return Ea.a.iA(pa.W5f,G.AFrameworkApplication.mr,ya.getImageClass(pa.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.Alb[0],this.Alb[1],this.Alb[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}wug(){const d=document.getElementsByName(pa.NHn);for(let n=0;n<d.length;n++)za.a.addHandler(d[n],ia.a.focus,this.mwe),za.a.addHandler(d[n],ia.a.click,this.mwe)}static get OP(){return G.AFrameworkApplication.ta.Pb.$I&&
G.AFrameworkApplication.ta.Pb.N3f}}pa.W5f=db.W5f;pa.NHn="ListRadioBox";pa.Ssg="radiobox";pa.Kud="txtJustification";pa.iconName="Info_32x32x32";pa.id="JustificationDialog";Object(D.a)(pa,"JustificationDialog",Ea.a,[]);class ua extends Ea.a{constructor(d,n,B){super(!1,!1,!0);this.kQn=(ha,Aa)=>{1===ha&&Aa.selectedLabel&&(ha=Aa.selectedLabel,""!==ha&&this.ozk(ha))};if(d&&B){var Q={["id"]:"MandatoryLabellingDialog"};this.ozk=B;this.D2e=n;if(!G.AFrameworkApplication.J.$("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||
this.D2e&&""!==this.D2e)Q.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.D2e,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};n={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(n.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:d});Q.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,
["hideIcon"]:!0,["menuDefinition"]:n};d={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Q};Q.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Q.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;this.ti(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,this.kQn,d)}else F.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}}Object(D.a)(ua,"MandatoryLabellingDialog",Ea.a,[]);class Ga{constructor(){this.ITa=
!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb.$I}NNl(d,n,B){this.ITa&&new ua(d,n,B)}static get instance(){return Ga._instance||(Ga._instance=new Ga)}}Ga._instance=null;Object(D.a)(Ga,"MandatoryLabellingDialogFactory",null,[1097]);class wa{}wa.vlp="sbProtectForm14";wa.ylp="SBStatusBarMarkAsReadOnly14";wa.Uaj="Info_16x16x32";wa.bYc="QuickSearchCompletedToday_16x16x32";wa.utg="CommonControlCheckboxCheck_16";wa.S6j="On";wa.visible="Visible";wa.yhm="ImageIsVisible";wa.AQa="SourceControlId";
wa.menuItemId="MenuItemId";wa.fh="Menu";wa.bXh="AppLockId";wa.value="Value";wa.labelText="LabelText";wa.alt="Alt";wa.dVi="Image16by16";wa.Moc="Image16by16Class";wa.ulp="SBProtectForm_16";wa.xlp="SBStatusBarMarkAsReadOnly_16";wa.icon="Icon";wa.iconColor="IconColor";wa.customTooltip="CustomTooltip";wa.Qvo="MipTagDynamicFillWithOutline_20";wa.Rvo="MipTagLockDynamicFillWithOutline_20";wa.Pvo="MipTagErrorOutline_20";wa.Svo="MipTagQuestionOutline_20";wa.aHe="transparent";wa.vzp="UILocation";Object(D.a)(wa,
"PolicyConstants",null,[]);class xa extends Ea.a{constructor(d,n,B){super(!1,!1,xa.OP);this.IKp=Q=>{1!==Q&&this.ey(Q,this.kPd,"",this.Bfa)};this.kPd=d;this.Bfa=n;this.ey=B;this.Md=1;this.$g=xa.id;this.YW(1);this.YW(0)}xHg(){const d={["id"]:"UserDefinedPermissionsDialog"};xa.OP&&this.ti("Defined Permissions",this.IKp,d)}static get OP(){return G.AFrameworkApplication.ta.Pb.$I&&G.AFrameworkApplication.ta.Pb.N3f}}xa.id="UserDefinedPermissionsDialog";Object(D.a)(xa,"UserDefinedPermissionsDialog",Ea.a,
[]);var sa=e(790),Ka=e(219),Na=e(236),ub=e(784),Ua=e(90),sb=e(46),qb=e(422),ab=e(352),Xa=e(152),wb=e(494),Sa=e(182),cc=e(204),Cb=e(141),Wa=e(21),Ja=e(31),Va=e(144);const mb=d=>d?d.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CleanUpMsospPolicyScript",!1):G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CleanUpMsospPolicyScript",!1);class Ab{constructor(d,n,B,Q){this.bNc=this.MHb=null;this.Luh=this.j0e=this.b1e=this.GMc=this.Rwh=this.Ezh=this.BSe=!1;this.a8b=this.I4a=
this.V6a=this.$ib=this.Bfa=this.my=this.fba=this.im=null;this.cyk=this.uOe=0;this.dnh=this.kwh=this.Aeh=this.q7e=null;this.aAo=()=>{this.j0e&&!this.jhe()&&(this.j0e=!1,this.oi.value.$zo())};this.jQn=ha=>{this.zEf(this.Gzh[ha])};this.tqg=()=>{if(!this.oi.value.r7i()){var ha=this.my[this.im.AppliedPolicyId];this.GMc&&this.$ib&&this.a8b!==this.$ib.id&&(!ha||ha.Order<this.$ib.sensitivityLabel.Order)&&(ha=this.YAb(this.$ib.id,{},4),32!==ha?F.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
ha):(this.a8b=this.$ib.id,this.I4a&&(ha=this.my[this.I4a])&&ha.Order<=this.$ib.sensitivityLabel.Order&&(this.oi.value.v1a(29),this.I4a=null)));ha=this.my[this.oi.value.nu.AppliedPolicyId];if(this.V6a&&this.I4a!==this.V6a.id&&(!ha||ha.Order<this.V6a.sensitivityLabel.Order)){const Aa=this.V6a.id;this.oi.value.v1a(29);this.oi.value.aVc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.Xmc(this.V6a.sensitivityLabel))+" "+this.V6a.Fwo,CommonUIStrings.l_PolicyLabelRecommendationButton,
()=>{this.YAb(Aa,{},8)});this.I4a=this.V6a.id}this.V6a=this.$ib=null}};this.YGl=(ha,Aa,bb,Ib)=>{1===ha&&this.VAb(Aa,Ib,bb)};this.XGl=(ha,Aa,bb)=>{1===ha?this.FWb()?this.YAb(Aa,null,2,bb):this.VAb(Aa===this.im.AppliedPolicyId?"":Aa,bb,""):this.Fk.Ne()};this.Sjl=ha=>{1===ha&&this.oi.value.cvo()};this.D3d=()=>32;this.Zao=(ha,Aa)=>{Aa.iE&&this.my&&(ha=this.my[this.oi.value.nu.AppliedPolicyId])&&(this.I4a&&(Aa=this.my[this.I4a])&&Aa.Order<=ha.Order&&(this.oi.value.v1a(29),this.I4a=null),this.a8b&&this.a8b!==
ha.Id&&(this.oi.value.v1a(28),this.a8b=null))};this.ga=d;this.Fk=n;this.za=B;this.oi=Q;this.oOc={};this.bFh={};this.Gzh={};this.xvb=B.$("WacApplyManualPolicyLabelIsEnabled");this.oi.value.aVd(this.tqg);this.oi.value.Kjf(this.tqg);this.oi.value.RMb(this.Zao);G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.t8a(this.aAo);B.$("SupportsPolicies")&&B.rb("AppliedPolicyId")&&(this.MHb=B.rb("IrmPolicyTitle"),this.bNc=B.rb("IrmPolicyDescription"));this.Huk=this.za.sc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",
6);this.Iuk=this.za.sc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get VL(){return G.AFrameworkApplication.VL||!!this.kwh&&this.kwh()}mc(){this.ga.qa(Z.a.Elg,S.a.frame,this.D3d);this.ga.nb(Z.a.pxc,S.a.frame,Object(X.a)(this,this.pxc,"queryPolicyLabel"),96);this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.qa(Z.a.ivj,S.a.frame,this.D3d),this.ga.nb(Z.a.lmd,S.a.frame,Object(X.a)(this,this.lmd,"queryPolicyShortLabel"),96));this.ga.qa(Z.a.p4b,
S.a.frame,Object(X.a)(this,this.p4b,"toggleSensitivity"));this.ga.qa(Z.a.m_b,S.a.frame,Object(X.a)(this,this.m_b,"populateSensitivityFlyout"));this.ga.qa(Z.a.Fgb,S.a.frame,Object(X.a)(this,this.Fgb,"setSensitivity"));this.ga.nb(Z.a.nmd,S.a.frame,Object(X.a)(this,this.nmd,"querySensitivity"),96);this.ga.qa(Z.a.mfb,S.a.frame,Object(X.a)(this,this.mfb,"querySensitivityToggleButton"));this.ga.qa(Z.a.Azb,S.a.frame,Object(X.a)(this,this.Azb,"querySensitivitySubFlyout"));this.PUc(Z.a.p4b)||this.ga.Oc(Z.a.p4b,
4);this.PUc(Z.a.m_b)||this.ga.Oc(Z.a.m_b,4);this.PUc(Z.a.Fgb)||this.ga.Oc(Z.a.Fgb,4);this.PUc(Z.a.mfb)||this.ga.Oc(Z.a.mfb,4);this.PUc(Z.a.Azb)||this.ga.Oc(Z.a.Azb,4);this.Fk.Ne();G.AFrameworkApplication.J&&Xa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.oi.value.zJj(Object(X.a)(this,this.iGj,"registerActionsHandler"))}iGj(){this.mc()}lRa(){this.ga.Jz(Z.a.Elg,S.a.frame,this.D3d);this.ga.Jz(Z.a.pxc,S.a.frame,Object(X.a)(this,
this.pxc,"queryPolicyLabel"));this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.Jz(Z.a.ivj,S.a.frame,this.D3d),this.ga.Jz(Z.a.lmd,S.a.frame,Object(X.a)(this,this.lmd,"queryPolicyShortLabel")));this.ga.Jz(Z.a.p4b,S.a.frame,Object(X.a)(this,this.p4b,"toggleSensitivity"));this.ga.Jz(Z.a.m_b,S.a.frame,Object(X.a)(this,this.m_b,"populateSensitivityFlyout"));this.ga.Jz(Z.a.Fgb,S.a.frame,Object(X.a)(this,this.Fgb,"setSensitivity"));this.ga.Jz(Z.a.nmd,S.a.frame,
Object(X.a)(this,this.nmd,"querySensitivity"));this.ga.Jz(Z.a.mfb,S.a.frame,Object(X.a)(this,this.mfb,"querySensitivityToggleButton"));this.ga.Jz(Z.a.Azb,S.a.frame,Object(X.a)(this,this.Azb,"querySensitivitySubFlyout"))}p4b(){return 32}Gyi(d){const n="mandatoryLabelling_"+d.Id;this.Gzh[n]=d.Id;return{["type"]:"AppToggleButtonProps",["id"]:n,["label"]:d.DisplayName,["hideLabel"]:!1,["customTooltip"]:d.Tooltip}}FWb(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}H2f(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)}eGm(){const d=[];for(const Q in this.fba){var n=void 0,B=void 0;mb(this.za)?(n=this.fba[Q],B=this.my[Q]):(B=Q,n=this.fba[Q],B=this.my[B]);if(B&&B.Enabled&&!B.HasUserDefinedPermissions)if(n.count){const ha={["sections"]:[],["shouldAutoOpen"]:!1},Aa={["id"]:"mandatoryLabelling_flyoutMenuSection_"+B.Id,["controls"]:[]};for(const bb of n)(n=this.my[bb])&&n.Enabled&&!n.HasUserDefinedPermissions&&Array.add(Aa.controls,this.Gyi(n));Array.add(ha.sections,Aa);Array.add(d,{["type"]:"AppFlyoutAnchorProps",
["id"]:"mandatoryLabelling_"+B.Id,["label"]:B.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:ha})}else Array.add(d,this.Gyi(B))}return d}m_b(d,n,B,Q,ha){if(1===B||!this.oi.value.Sob(!0))return 32;ha.MenuItems=Object.assign(new qb.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(ha.MenuItems.MenuSectionList,this.eCa(!this.isReactRibbonEnabled()));this.im.CustomUrl&&Array.add(ha.MenuItems.MenuSectionList,this.pNl(this.isReactRibbonEnabled()?
this.im.CustomUrl:Ca.a.Mf(this.im.CustomUrl)));this.isReactRibbonEnabled()||(ha.PopulationXML=Na.o(ha.MenuItems));return 32}nmd(d,n,B,Q,ha){if(1===B||!ha||!this.xvb)return 32;this.im=this.oi.value.nu;if(this.oi.value.Sob(!0)&&(ha[wa.visible]=!0,this.Rwh||(sb.a("MipLabelsAvailable"),this.Rwh=!0),this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&!this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",!1)&&this.im&&this.im.AreLabelsAvailable&&
(d=Wa.a.instance.Za("Common.ISystemInitiatedFeedback"))))if(mb(this.za)){const Aa=this.im.AppliedPolicyId?"LouderLabel_LabelExistsOnLoadActivity":"LouderLabel_NoLabelAppliedOnLoadActivity";d.execute(bb=>{bb.logActivity(Aa,null)})}else{const Aa=Ab.jg(this.im.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";d.execute(bb=>{bb.logActivity(Aa,null)})}return 32}mfb(d,n,B,Q,ha){if(1===B||!ha)return 32;let Aa,bb;ha[wa.S6j]=!!(Aa=ha[wa.menuItemId])&&!!(bb=
this.oOc[Aa])&&bb===this.im.AppliedPolicyId;return 32}Azb(d,n,B,Q,ha){if(1===B||!ha)return 32;let Aa,bb,Ib;d=!!(Aa=ha[wa.AQa])&&!!(bb=this.oOc[Aa])&&!!(Ib=this.fba[bb])&&Ib.contains(this.im.AppliedPolicyId);ha[wa.yhm]=d;ha[wa.S6j]=d;return 32}Fgb(d,n,B,Q,ha){if(1===B||!ha)return 32;d=this.oOc[ha[wa.AQa]];n=this.wzp(ha[wa.vzp]);B=new Ja.a;B.name="SensitivityPickerLocation";B.int64=n;sb.a("SensitivityPickerUsage",void 0,void 0,[B]);return this.YAb(d,ha,2)}jhe(){return!!G.AFrameworkApplication.ta&&1===
G.AFrameworkApplication.ta.mode}Xvp(){this.im.DefaultLabelId&&this.im.MandatoryLabelingEnforced?this.BSe||this.jhe()?this.im.AppliedPolicyId?this.zEf(""):(this.oi.value.Vxn(this.oi.value.ked)||this.jhe())&&this.kpi():this.nTj():this.im.DefaultLabelId?this.nTj():this.im.MandatoryLabelingEnforced&&(this.im.AppliedPolicyId?this.zEf(""):this.kpi())}v4i(){return this.im.MandatoryLabelingEnforced?this.im&&this.im.AreLabelsAvailable?this.za.$("TestOverrideIsReactDialogEnabled")||this.Fk&&this.Fk.Pb&&this.Fk.Pb.$I?
!0:(F.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(F.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(F.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}kpi(){!this.v4i()||G.AFrameworkApplication.Cva||this.Ezh||(this.Ezh=G.AFrameworkApplication.Cva=!0,F.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),
this.oi.value.NDj("",1),this.oi.value.bif(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.iQn()}))}zEf(d){this.v4i()&&G.AFrameworkApplication.Cva&&(G.AFrameworkApplication.Cva=!1,F.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.oi.value.Kvg(),this.oi.value.NDj(d,2))}iQn(){Ga.instance.NNl(this.eGm(),this.im.CustomUrl,this.jQn)}J_h(){return this.za.$("CoAuthForProtectedFilesEnabled")&&
this.za.$("SupportsOfficeClientCoauthoring")&&this.za.$("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.dnh&&this.VL}YAb(d,n,B,Q=null){this.oi.value.Wuo(B);let ha=32,Aa=!1,bb=!0;const Ib=2===B||8===B||16===B,oc=d===this.im.AppliedPolicyId;if(this.Aeh&&this.Aeh(d,Ib))F.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",B),this.Fk.Ne();else if(n&&wa.bXh in n&&this.oi.value.Q2o(n[wa.bXh]),d)if(this.oi.value.r7i()||
this.J_h()&&this.b1e)F.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",B),this.Fk.Ne(),Ib&&this.tVd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.za.$("HasDocumentEditRights"))if(this.oi.value.isl(d))if(!this.FWb()&&this.my[d]&&this.my[d].HasUserDefinedPermissions&&!oc)F.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",
B),1!==B&&4!==B&&this.P$k();else if(Ib&&this.im.MandatoryLabelingEnforced&&oc)F.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",B),this.tVd(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(Ib&&this.za.$("WacLabelingJustificationDialogIsEnabled")&&this.im.RequiredDowngradeJustification&&(oc||this.my[d].RequiredDowngradeJustification)&&
(this.FWb()?!this.Luh&&!Q:!this.Bfa))return F.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",B),this.XGg(d),ha;if(this.FWb()&&this.my[d].HasUserDefinedPermissions&&!oc)return F.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",B),this.xHg(d,Q),ha;if(this.J_h()&&!this.dnh())this.uOe<this.Huk?(F.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.uOe,
B),this.b1e=!0,this.uOe++,Va.Task.delay(this.Iuk).continueWith(()=>{this.b1e=!1;this.YAb(d,n,B)})):(F.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",B),Aa=1!==B,bb=!1,ha=8);else{if(this.jwn(d)&&(F.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",B),1===B||8===B||4===B))return ha;F.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",
B);this.VAb(oc?"":d,this.FWb()?Q:this.Bfa,"",B);return ha}}else F.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",B),this.Fk.Ne(),Ib&&this.tVd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else F.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",B),this.Fk.Ne(),Ib&&this.tVd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else F.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",B),this.Fk.Ne(),Aa=Ib,bb=!1,ha=8;this.oi.value.aEj(0,B,Aa,bb);return ha}Xcl(d,n,B=null,Q=!1){Ua.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.za.$("SupportsOfficeClientCoauthoring")&&this.za.$("CoAuthForProtectedFilesIsEnabled")?(this.GMc=!1,(this.im=this.oi.value.nu)&&!this.im.AppliedPolicyId?
this.GMc=!0:this.im&&this.im.PolicyLabelAssignmentMethod&&(this.GMc=Cb.e(this.im.PolicyLabelAssignmentMethod)===Cb.e("standard"))):this.GMc=Q;mb(this.za)?(d=d?this.my[d]:null,n=n?this.my[n]:null):(d=Ab.jg(d)?null:this.my[d],n=Ab.jg(n)?null:this.my[n]);n?this.V6a=new na(n,!0,B):(this.oi.value.v1a(29),this.I4a=null);d?this.$ib=new na(d,!1):this.a8b=null;this.tqg(null,null)}Xdl(d){this.YAb(d,null,16)}B1o(){this.my={};if(this.im=this.oi.value.nu)for(const d of this.im.SensitivityLabels)this.my[d.Id]=
d}jwn(d){if(this.fba&&d in this.fba){d=this.fba[d];for(const n of d)if((d=this.my[n])&&d.Enabled)return!0}return!1}$3o(){this.fba={};if(this.im=this.oi.value.nu){for(const d of this.im.SensitivityLabels)d.ParentId||(this.fba[d.Id]=new ma.a);for(const d of this.im.SensitivityLabels)this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)?d.ParentId&&d.ParentId in this.fba&&(this.my[d.ParentId]&&(d.ParentName=this.my[d.ParentId].DisplayName),d.Enabled&&this.fba[d.ParentId].add(d.Id)):
d.ParentId&&d.ParentId in this.fba&&d.Enabled&&this.fba[d.ParentId].add(d.Id)}}wso(){this.im=this.oi.value.nu;const d=this.xvb&&this.isReactRibbonEnabled()&&this.oi.value.Sob();Ab.nye(d)}nTj(){if(this.za.$("WacApplyDefaultPolicyLabelIsEnabled"))if(this.jhe())this.j0e=!0;else if(!this.BSe&&(this.BSe=!0,(this.im=this.oi.value.nu)&&this.im.DefaultLabelId))if(!this.im.AppliedPolicyId)F.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.im.DefaultLabelType),this.YAb(this.im.DefaultLabelId,
null,1);else if(ja.a.Oh().equals(this.im.DefaultLabelType,"documentLibraryDefault")){const d=this.my[this.im.AppliedPolicyId],n=this.my[this.im.DefaultLabelId];this.im.AppliedPolicyId!==this.im.DefaultLabelId&&ja.a.Oh().equals(this.im.PolicyLabelAssignmentMethod,"standard")&&d.Order<n.Order&&(F.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.im.DefaultLabelType),this.YAb(this.im.DefaultLabelId,null,1))}}VAb(d,n,B,Q=2){this.FWb()?n&&(this.Luh=!0):this.Bfa=
n;this.oi.value.VAb(d);this.Fk.Ne();B=new Ba(Q,this.Xmc(this.my[d]));this.oi.value.BBe(d,this.FWb()?n:this.Bfa,B)}XGg(d){(new pa(d,this.XGl)).XGg()}xHg(d,n){(new xa(d,n,this.YGl)).xHg()}tVd(d="",n=""){const B=new Sa.StandardDialog;B.hv=G.AFrameworkApplication.Uha;B.Md=0;B.Ue(1,CommonUIStrings.l_DialogClose);B.tU(d,n,null)}P$k(){const d=new Sa.StandardDialog;d.hv=G.AFrameworkApplication.Uha;d.Md=1;d.Ue(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);d.Ue(0,CommonUIStrings.l_DialogClose);d.tU(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,this.Sjl)}isReactRibbonEnabled(){return!!this.Fk&&!!this.Fk.Pb&&this.Fk.Pb.$t}prc(){return this.Fk&&this.Fk.Pb?this.Fk.Pb.prc:!1}D4o(d,n,B,Q){d?(Q[wa.value]=d,Q[wa.labelText]=d,Q[wa.customTooltip]=n,this.lUj(B,G.AFrameworkApplication.nE,Q)):(Q[wa.iconColor]=wa.aHe,this.im.MandatoryLabelingEnforced?(Q[wa.value]=Q[wa.labelText]=this.Hae().JAg,Q[wa.icon]=wa.Pvo):(Q[wa.value]=Q[wa.labelText]=this.Hae().Qfg,Q[wa.icon]=wa.Svo));Q[wa.visible]=!0}d2o(d){let n=
"",B="",Q="";if(this.im.AreLabelsAvailable){let ha=null;this.my&&(ha=this.my[this.im.AppliedPolicyId]);ha&&(n=this.Xmc(ha),B=ha.Tooltip,this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)||(G.AFrameworkApplication.nE=this.oi.value.lwb(ha)),Q=this.$Kf(ha));if(!this.oi.value.Sob()&&!ha)return}else{if(!this.MHb)return;n=this.MHb;Q=wa.aHe;B=this.bNc?this.bNc:""}this.D4o(n,B,Q,d)}pxc(d,n,B,Q,ha){if(1===B)return 32;this.im=this.oi.value.nu;if(!this.im||!ha)return 32;
ha[wa.value]="";ha[wa.labelText]="";ha[wa.alt]=null;ha[wa.dVi]=null;ha[wa.Moc]=null;ha[wa.customTooltip]="";ha[wa.visible]=!1;ha[wa.iconColor]="";ha[wa.icon]="";if(this.H2f())this.d2o(ha);else{B=n=d="";if(!this.im.AreLabelsAvailable){if(!this.MHb)return 32;d=this.MHb;B=wa.aHe;this.bNc&&(n=this.bNc)}else if(this.im.AppliedPolicyId){Q=null;for(const Aa of this.im.SensitivityLabels)if(Aa.Id.toLowerCase()===this.im.AppliedPolicyId.toLowerCase()){Q=Aa;break}Q&&(d=this.Xmc(Q),n=Q.Tooltip,this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)||(G.AFrameworkApplication.nE=this.oi.value.lwb(Q)),B=this.$Kf(Q))}d&&(ha[wa.value]=d,ha[wa.labelText]=d,this.prc()?ha[wa.customTooltip]=n:ha[wa.alt]=n,this.lUj(B,G.AFrameworkApplication.nE,ha),ha[wa.visible]=!0)}return 32}lmd(d,n,B,Q,ha){if(1===B)return 32;this.im=this.oi.value.nu;if(!this.im||!ha)return 32;ha[wa.labelText]="";if(this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.im.HideBarByDefault)return 32;d="";if(this.im.AreLabelsAvailable)if(this.im.AppliedPolicyId){if(!this.my)return 32;
(n=this.my[this.oi.value.nu.AppliedPolicyId])&&(d=n.ParentId&&this.my[n.ParentId]?this.my[n.ParentId].DisplayName:n.DisplayName)}else d=this.im.MandatoryLabelingEnforced?this.Hae().JAg:this.Hae().Qfg;else{if(!this.MHb)return 32;d=this.MHb}ha[wa.labelText]=d;return 32}Xmc(d){return d?this.my?d.ParentId&&this.my[d.ParentId]?this.my[d.ParentId].DisplayName+"\\"+d.DisplayName:d.DisplayName:(F.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),d.DisplayName):
""}lUj(d,n,B){this.H2f()?(B[wa.icon]=this.tNi(n),B[wa.iconColor]=this.TRf(d)):this.prc()?B[wa.icon]=n?wa.ulp:wa.xlp:(B[wa.dVi]=G.AFrameworkApplication.mr,B[wa.Moc]=n?ya.getImageClass(wa.vlp):ya.getImageClass(wa.ylp))}pNl(d){const n=this.nPb("LearnMoreSection",!0);d=mb(this.za)?Object.assign(new Ka.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:d,LabelText:CommonUIStrings.l_LearnMore,Command:Z.a.DZb.toString(),Image16by16:G.AFrameworkApplication.mr,Image16by16Class:ya.getImageClass(wa.Uaj),
Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"}):Object.assign(new Ka.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:d,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:G.AFrameworkApplication.mr,Image16by16Class:ya.getImageClass(wa.Uaj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(n.ControlList,d);return n}qgi(d,n,B=!1){let Q;Q="Toggle_"+d.Id;Q="Sensitivity_"+Q;const ha=d.DisplayName,Aa=d.Tooltip;var bb=d.Id===
this.im.AppliedPolicyId,Ib=B?Ca.a.Mf(Q):Q;this.H2f()?(bb=this.$Kf(d),n=mb(this.za)?Object.assign(new wb.a,{Id:Ib,ExternalId:Ib,LabelText:B?Ca.a.Mf(ha):ha,Command:Z.a.Fgb.toString(),MenuItemId:Ib,QueryCommand:Z.a.mfb.toString(),Visible:!0,Alt:B?Ca.a.Mf(Aa):Aa,AriaLabel:cc.a.Uob,IconColor:this.TRf(bb),KeyTip:n}):Object.assign(new wb.a,{Id:Ib,ExternalId:Ib,LabelText:B?Ca.a.Mf(ha):ha,Command:"2935633379",MenuItemId:Ib,QueryCommand:"991261903",Visible:!0,Alt:B?Ca.a.Mf(Aa):Aa,AriaLabel:cc.a.Uob,IconColor:this.TRf(bb),
KeyTip:n}),n.ExternalImageId=this.tNi(this.oi.value.lwb(d))):(Ib=mb(this.za)?Object.assign(new sa.a,{Id:Ib,ExternalId:Ib,LabelText:B?Ca.a.Mf(ha):ha,Command:Z.a.Fgb.toString(),MenuItemId:Ib,QueryCommand:Z.a.mfb.toString(),CheckedImage:G.AFrameworkApplication.mr,Visible:!0,Alt:B?Ca.a.Mf(Aa):Aa,IsChecked:bb,AriaLabel:cc.a.Uob,KeyTip:n}):Object.assign(new sa.a,{Id:Ib,ExternalId:Ib,LabelText:B?Ca.a.Mf(ha):ha,Command:"2935633379",MenuItemId:Ib,QueryCommand:"991261903",CheckedImage:G.AFrameworkApplication.mr,
Visible:!0,Alt:B?Ca.a.Mf(Aa):Aa,IsChecked:bb,AriaLabel:cc.a.Uob,KeyTip:n}),this.isReactRibbonEnabled()?(Ib.CheckedImageClass=ya.getImageClass(wa.utg),Ib.ExternalImageId=wa.utg):Ib.CheckedImageClass=ya.getImageClass(wa.bYc),n=Ib);Ib=Q;this.oOc[Ib]=d.Id;this.bFh[d.Id]=Ib;return n}nPb(d,n=!1){return Object.assign(new ab.a,{Title:"",Id:d,DisplayMode:wa.fh,ShowMenuSectionSeparator:n,ControlsId:"Ctrl_"+d,ControlList:[]})}SQl(d,n,B){d=this.nPb(d+"Sub");let Q=1;for(const ha of n)(n=this.my[ha])&&n.Enabled&&
(Array.add(d.ControlList,this.qgi(n,Q.toString(),B)),Q++);return d}eCa(d=!1){const n=this.nPb("SensitivitySection");let B=1;for(const ha in this.fba){let Aa;var Q=void 0;mb(this.za)?(Aa=this.fba[ha],Q=this.my[ha]):(Q=ha,Aa=this.fba[ha],Q=this.my[Q]);if(Q&&Q.Enabled){if(Aa.count){const bb="Label"+this.cyk++;let Ib;Ib=mb(this.za)?Object.assign(new ub.a,{Id:bb,ExternalId:bb,LabelText:d?Ca.a.Mf(Q.DisplayName):Q.DisplayName,Command:Z.a.Ssa.toString(),QueryCommand:Z.a.Azb.toString(),Menu:Object.assign(new qb.a,
{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:cc.a.Uob,KeyTip:B.toString(),Alt:d?Ca.a.Mf(Q.Tooltip):Q.Tooltip}):Object.assign(new ub.a,{Id:bb,ExternalId:bb,LabelText:d?Ca.a.Mf(Q.DisplayName):Q.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new qb.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:cc.a.Uob,KeyTip:B.toString(),
Alt:d?Ca.a.Mf(Q.Tooltip):Q.Tooltip});this.isReactRibbonEnabled()?Ib.ExternalImageId=wa.utg:(Ib.Image16by16=G.AFrameworkApplication.mr,Ib.Image16by16Class=ya.getImageClass(wa.bYc));Array.add(Ib.Menu.MenuSectionList,this.SQl(bb,Aa,d));Array.add(n.ControlList,Ib);this.oOc[Ib.Id]=Q.Id;this.bFh[Q.Id]=Ib.Id}else Array.add(n.ControlList,this.qgi(Q,B.toString(),d));B++}}return n}PUc(d){return!!this.ga.s1(d)&&!!this.ga.s1(d).flags&&!!this.ga.s1(d).flags.length}tNi(d){return d?wa.Rvo:wa.Qvo}TRf(d){return d?
d:wa.aHe}$Kf(d){if(d.Color||!d.ParentId)return d.Color;const n=this.my[d.ParentId];return n?n.Color:d.Color}wzp(d){switch(d){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}Hae(){this.q7e||(this.q7e=Object.assign(new Ma,{Qfg:HeaderStrings.NoSensitivityLabel,JAg:HeaderStrings.SelectASensitivityLabel}));return this.q7e}static NHp(){G.AFrameworkApplication.J&&!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)||!Xa.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",
!0))}static nye(d){Xa.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!d))}static jg(d){return d&&d.length?!1:!0}}Object(D.a)(Ab,"PolicyActor",null,[1075]);var Xb=e(529);class Lb{constructor(){this.Id=null;this.Enabled=!1;this.DisplayName=this.Name=null;this.Order=0;this.Tooltip=null;this.IsEndpointProtectionEnabled=!1;this.ParentId=null;this.RequiredDowngradeJustification=!1;this.Color=this.AutoLabelingSensitiveTypeIds=this.LabelActions=null;this.HasUserDefinedPermissions=
!1;this.DefaultSublabelId=null;this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.Id=this.ParentName="";this.Enabled=!1;this.DisplayName=this.Name="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=
!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=[];this.AutoLabelingSensitiveTypeIds=[];this.Color="";this.HasUserDefinedPermissions=!1;this.DefaultSublabelId="";this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=
!1;this.HasExtractForUser=!0;this.ParentName=""}}Object(D.a)(Lb,"SensitivityLabel",null,[]);var dc=e(92),yc;(function(d){d[d.unknown=0]="unknown";d[d.Znf=1]="boot";d[d.refresh=2]="refresh";d[d.eWo=3]="selfSetPolicyLabel"})(yc||(yc={}));Object(D.b)("GetPolicyLabelsReason",yc);class Wc extends Sys.EventArgs{constructor(d,n,B,Q,ha,Aa){super();this.Cgc=d;this.title=n;this.message=B;this.buttonText=Q;this.oXc=ha;this.Uie=Aa}}Object(D.a)(Wc,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class zb extends Sys.EventArgs{constructor(d,
n,B,Q,ha){super();this.Cgc=d;this.title=n;this.message=B;this.buttonText=Q;this.oXc=ha}}Object(D.a)(zb,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var cd;(function(d){d[d.none=0]="none";d[d.Uqq=1]="reasonDefaultLabel";d[d.Wqq=2]="reasonManual";d[d.Tqq=4]="reasonAutomatic";d[d.Xqq=8]="reasonRecommended";d[d.Vqq=16]="reasonMandatory";d[d.Sqq=32]="reasonAI"})(cd||(cd={}));Object(D.b)("ApplyLabelFlags",cd);class qc extends Sys.EventArgs{constructor(d,n,B){super();this.U8h=d;this.T8h=
n;this.existingLabelPriority=B}}Object(D.a)(qc,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Dc extends Sys.EventArgs{constructor(d){super();this.tMm=d}}Object(D.a)(Dc,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class mc extends Sys.EventArgs{constructor(){super()}}Object(D.a)(mc,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);var lc=e(1130),Vb=e(854);class yb extends Sys.EventArgs{constructor(d=!1,n=null,B=null,Q=null){super();this.iE=d;this.ulf=n;this.context=B;this.LDg=Q}}Object(D.a)(yb,
"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Db extends Sys.EventArgs{constructor(d,n){super();this.Fhj=d;this.appMode=n}}Object(D.a)(Db,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class $b extends Sys.EventArgs{constructor(d,n,B,Q){super();this.title=d;this.Rjo=n;this.buttonText=B;this.m2n=Q}}Object(D.a)($b,"PolicyTipEventArgs",Sys.EventArgs,[]);class Fa extends Sys.EventArgs{constructor(d,n){super();this.Cgc=d;this.Uie=n}}Object(D.a)(Fa,"RemoveAutoPolicyBusinessBarEntryEventArgs",
Sys.EventArgs,[]);class lb extends Sys.EventArgs{constructor(){super()}}Object(D.a)(lb,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class kb extends Sys.EventArgs{constructor(d,n){super();this.Cog=d;this.oKa=n}}Object(D.a)(kb,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Ob extends Sys.EventArgs{constructor(d,n,B,Q=null,ha=null,Aa=null,bb=null){super();this.errorType=d;this.Llf=n;this.Tep=B;this.title=Q;this.message=ha;this.buttonText=Aa;this.oXc=bb}}Object(D.a)(Ob,"SetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);class nc extends Sys.EventArgs{constructor(d){super();this.Llf=d}}Object(D.a)(nc,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class zc extends Sys.EventArgs{constructor(d){super();this.rap=d}}Object(D.a)(zc,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Pb=e(880),tb=e(96),ib=e(115),Rb=e(29),gc=e(59),xc=e(463),Nc=e(189);class Kc{static f0o(d,n){if(!d||!n||d.count!==n.count)return!1;for(const B of d)if(!n.contains(B))return!1;return!0}static toArray(d){if(!d)return null;
const n=Array(d.count);let B=0;for(const Q of d)n[B]=Q,B++;return n}}Object(D.a)(Kc,"HashSetUtils",null,[]);var fd=e(202),jd=e(100),Id=e(70);class ce{constructor(d,n,B,Q=0,ha=null,Aa=0){this.sSe=this.dL=null;this.mnb=this.SKc=this.VKc=0;this.$P="";this.LKb=this.Qwh=this.Ddh=this.kth=this.WRa=this.V2e=null;this.Ouh=!1;this.jEb=null;this.OXe=0;this.VMd=this.PKb=this.GGb=this.UMd=null;this.sa=new dc.a;this.Drd=this.h7c=this.Hl=null;this.wZe=!1;this.ked=null;this.enf=bb=>{if(!this.W6i){var Ib=bb.NSb();
Ib.continueWith(()=>{this.Hl=Ib.result;this.Hl.CQ(this.A6n)})}};this.A6n=(bb,Ib)=>{12===Ib.type&&(this.Qwh?this.Qwh():this.mtb(this.$P,2,this.WRa,!0))};this.za=d;this.$f=n;this.qe=B;this.fKd=Q;this.nu=new lc.a;this.e$j();this.aFh=this.za.rb("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.Rw=ha;this.oPc=0===Aa?this.Snj(G.AFrameworkApplication.ta.Pb.gl):this.Snj(Aa);this.xvb=d.$("WacApplyManualPolicyLabelIsEnabled");this.aqc=d.$("CoAuthForProtectedFilesIsEnabled");this.OBb=d.$("SupportsOfficeClientCoauthoring");
this.s7i=!1;this.$Uj=3E4;this.Sb=ib.TaskManager.instance;d.$("SupportsPolicies")&&sb.a("MipSupportsPolicies");this.aqc&&this.OBb&&sb.a("MipSupportsOfficeClientCoauthoring")}get N_f(){return this.wZe}E8k(d){this.sa.addHandler("PolicyTipEvent",d)}RMb(d){this.sa.addHandler("LabelInfoUpdateEvent",d)}zJj(d){this.sa.removeHandler("LabelInfoUpdateEvent",d)}S8k(d){this.sa.addHandler("SetPolicyLabelTriggeredEventKey",d)}aVd(d){this.sa.addHandler("SetPolicyLabelEventKey",d)}Kjf(d){this.sa.addHandler("SetPolicyLabelFailureEventKey",
d)}J6k(d){this.sa.addHandler("GetPolicyLabelEventKey",d)}I6k(d){this.sa.addHandler("GetAutoPolicyLabelEventKey",d);this.N_f&&(F.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.Zsg(new Dc(0)))}F6k(d){this.sa.addHandler("CreateAutoCLPSecurityNodesEventKey",d)}a9k(d){this.sa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",d)}b9k(d){this.sa.addHandler("UpdateAutoCLPSITNodesEventKey",d)}m6k(d){this.sa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",
d)}M8k(d){this.sa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",d)}n6k(d){this.sa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",d)}N8k(d){this.sa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",d)}zUh(d){this.sa.addHandler("MandatoryLabellingAppHandlerEventKey",d)}Z8k(d){this.sa.addHandler("UDPLabelingAppHandlerEventKey",d)}get nqn(){if(!this.dL)return!1;for(const d of this.dL.J4c())if(!d.Capabilities||!d.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get W6i(){return!!this.Hl}xcn(d){d&&
this.aqc&&this.OBb&&d.execute(this.enf)}ccn(d){d&&this.aqc&&this.OBb&&d.continueWith(()=>{this.dL=d.result})}Qvl(){return this.kth?this.kth():!1}Zq(){return(new Date).getTime()}nEa(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}oMf(){this.qe&&(this.UMd=this.qe.rg("WebServiceCall","Call Get Policy Endpoint On Server"));var d=fd.a.R9a(1,1);this.za.$("SendHostAttributionInfoForPolicyLabelEnabled")?(d=new xc.a(this.$kd("datalosspolicy"),
1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,d),this.$f.send(d).cxa(Object(X.a)(this,this.Gpj,"onDataLossPolicySuccessCallback"),Object(X.a)(this,this.Fpj,"onDataLossPolicyFailureCallback"))):this.$f.addRequest(this.$kd("datalosspolicy"),1,null,null,!0,2,Object(X.a)(this,this.Gpj,"onDataLossPolicySuccessCallback"),Object(X.a)(this,this.Fpj,"onDataLossPolicyFailureCallback"),null);this.VKc++;F.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.aFh,this.VKc)}$zo(){this.mtb(this.$P,2,this.WRa)}mtb(d,n=0,B=null,Q=!1,ha=null){Ua.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.Hab(void 0,n));this.h7c=this.Zq();const Aa=this.pwf(n);this.o9d(d,Aa,B,Q,n,ha);this.Z0b(!0)}e$j(){const d=Object(Vb.b)();if(this.vvh=!!d)this.nu=d}W5i(){this.e$j();return this.vvh}Gpj(d){this.jzj();let n="";({data:n}=this.QNg(d)).returnValue&&(F.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.VKc=
0,this.qe&&(this.VMd=this.qe.rg("Task","Parse and Handle Get Policy Response")),this.ugo(n),this.VMd&&(this.VMd.stop(),this.VMd=null))}Fpj(d){this.jzj();this.VKc<=this.fKd?this.oMf():(F.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",d?d.data?d.data.xpa:null:null),this.VKc=0)}r7i(){return 0<this.mnb}VAb(d){this.nu.AppliedPolicyId=d}BBe(d,n,B=null,Q=null){const ha=this.HMl(B);this.o4o(d,n,ha,B,Q)}Ntj(d){this.PKb&&(this.PKb.stop(),this.PKb=
null);const {MQj:n,YUj:B,Jfb:Q}=this.ULi(d),ha=d.data.state,Aa=ha?ha.oKa:2;let bb="";({data:bb}=this.QNg(d)).returnValue?(F.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Aa),this.mnb=0,this.bho(bb,n,B,ha,Q)):this.Zyg(Aa,Q)}Wuo(d){Ua.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.Hab(d));this.Drd=this.Zq();F.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.sa.raiseEvent("SetPolicyLabelTriggeredEventKey",
new nc(d))}WZn(){this.aqc&&this.OBb&&this.W6i&&this.Hl.sE(12,null,!0)}Mtj(d){this.PKb&&(this.PKb.stop(),this.PKb=null);const {MQj:n,YUj:B,Jfb:Q}=this.ULi(d);if(this.mnb<=this.fKd)this.BBe(n,B,null,Q);else{var ha=d.data.state;ha=ha?ha.oKa:2;F.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",d?d.data?d.data.xpa:null:null,ha);this.ked="WACServerConnectionFailed";this.mnb=0;this.Zyg(ha,Q)}}Vxn(d){if(d&&("LabelNotSupported"===d||"LabelErrorRetryLater"===
d||"CoherencyFailure"===d||"LabelIdNotFound"===d||"LabelDisabled"===d))return F.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",d),!0;F.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",d);return!1}lwb(d){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?d.IsEndpointProtectionEnabled||d.HasUserDefinedPermissions:d.IsEndpointProtectionEnabled}isl(d){if(!d)return!1;let n=null,B=null;for(const Q of this.nu.SensitivityLabels)Q.Id===
d&&(n=Q),Q.Id===this.$P&&(B=Q);if(!n)return!1;if(this.aqc&&this.OBb){if(this.Ddh&&this.Ddh()||this.nqn)return!0}else if(G.AFrameworkApplication.Un&&G.AFrameworkApplication.Un.rab||this.WRa&&this.WRa())return!0;return this.lwb(n)===(!!B&&this.lwb(B))}aVc(d,n,B,Q,ha){28===d?this.DDj(new Wc(d,n,B,Q,ha,!1)):this.DDj(new Wc(d,n,B,Q,ha,!0))}v1a(d){28===d?this.XDj(new Fa(d,!1)):this.XDj(new Fa(d,!0))}euo(d,n,B){F.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.sa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",
new qc(d,n,B))}dvo(d){F.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.sa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new qc(null,null,d))}evo(d,n){F.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.sa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new qc(d,n,null))}NDj(d,n){F.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===n?"Reading":"Edit")+" switch event.");this.sa.raiseEvent("MandatoryLabellingAppHandlerEventKey",
new Db(d,n))}bif(d,n,B,Q,ha){37===d&&this.Sto(new zb(37,n,B,Q,ha))}Kvg(){this.Ruo(new lb)}cvo(){F.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.sa.raiseEvent("UDPLabelingAppHandlerEventKey",new zc(!0))}Sob(d=!1){const n=Object(Pb.a)(this.nu);n||d||Ab.nye(!1);return n}cXo(){window.postMessage(JSON.stringify({type:"mipProperties",isProtected:G.AFrameworkApplication.nE,sensitivity:{labelId:this.$P},usageRights:{docEdit:this.nu.EditEnabled,extract:G.AFrameworkApplication.XLa,
print:G.AFrameworkApplication.Due,export:G.AFrameworkApplication.w4d,objModel:G.AFrameworkApplication.akc,owner:G.AFrameworkApplication.x4d}}),"*")}Wko(d){d&&(this.WRa=d);F.ULS.shipAssertTag(507888257,306,this.W5i(),"populatePolicyLabelsDataFromCache was called with no cached response");Object(Vb.c)()?Object(Vb.e)(this.mWi.bind(this)):this.mWi()}mWi(){this.nWi(Object(Vb.b)(),Object(Vb.a)());this.LDj(1,!0)}LDj(d,n){this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableEdgeBlockScreenCapture",!1)&&n&&this.cXo();Ua.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.Psb(void 0,d,this.h7c));this.h7c=null;d=new Dc(d);this.ouo(d);this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?n&&this.x9o()?this.N_f?this.wCp():(this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.Q0d(),this.Zsg(d),this.wZe=!0):n||
this.Awe():!this.N_f&&n&&this.za.$("WacApplyManualPolicyLabelIsEnabled")&&this.cZh()?(this.Zsg(d),this.wZe=!0):n||this.Awe()}Vig(d){this.GGb&&(this.GGb.stop(),this.GGb=null);var n=null;d&&d.data&&(n=d.data.Jfb);let B;this.Z0b(!1);({data:B}=this.QNg(d)).returnValue?(F.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.SKc=0,n=this.Lgo(B,n),this.LDj(this.HJi(d.data),n)):this.Awe()}x9o(){if(!this.za.$("WacApplyManualPolicyLabelIsEnabled"))return F.ULS.sendTraceTag(539877667,
306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.cZh())return!1;if(""===this.$P)return F.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.jEb===this.OXe)return F.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;F.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");
return!0}Q0d(){this.Sak();F.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.LKb.count,this.jEb);const d=Kc.toArray(this.LKb);this.euo(d,d,this.jEb)}wCp(){var d=this.LKb;this.Sak();Kc.f0o(d,this.LKb)||(F.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.LKb.count),d=Kc.toArray(this.LKb),this.evo(d,d));this.Ouh&&(F.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",
this.jEb),this.dvo(this.jEb))}Sak(){const d=new Xb.a(ja.a.Oh());for(const n of this.nu.SensitivityLabels)if(n&&n.AutoLabelingSensitiveTypeIds&&0<n.AutoLabelingSensitiveTypeIds.length)for(const B of n.AutoLabelingSensitiveTypeIds)B&&d.add(B);this.LKb=d}Uig(d){const n=this.HJi(d.data);let B=null;d&&d.data&&(B=d.data.Jfb);Ua.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.Psb(void 0,n,this.h7c));this.h7c=null;this.GGb&&(this.GGb.stop(),this.GGb=null);if(this.SKc<=
this.fKd){if(this.za.$("SendHostAttributionInfoForPolicyLabelEnabled")){const Q=d.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in Q&&Q[fd.a.Aze]&&"HostAttributionInfo.ScenarioTypeParamName"in Q&&Q[fd.a.dqd]){d.data.request.get_headers();d.data.request.get_headers()[fd.a.dqd];d=this.pwf(n);this.o9d(this.$P,d,this.WRa,void 0,n,B);return}}this.mtb(this.$P,n,this.WRa,!1,B)}else F.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",d?
d.data?d.data.xpa:null:null),this.Awe(),this.SKc=0,this.Z0b(!1)}HJi(d){return d.state?d.state:0}$kd(d,n=!1){return Object(Pb.c)(this.za.rb("PolicyHandlerWebServiceBase")||G.AFrameworkApplication.ta.Pb.HOa,this.aFh,G.AFrameworkApplication.lm,d===Pb.e&&G.AFrameworkApplication.Un&&G.AFrameworkApplication.Un.rhe,d,n)}ULi(d){let n=null,B=null,Q=null;d&&d.data&&d.data.request&&d.data.request.get_headers()&&(n=d.data.request.get_headers()[Id.a.NQj],B=d.data.request.get_headers()[Id.a.ZUj],Q=d.data.Jfb);
return{MQj:n,YUj:B,Jfb:Q}}QNg(d){d=d?d.data?d.data.responseData:null:null;return d&&d.length&&!this.Yyn(d)?{returnValue:!0,data:d}:(F.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:d})}ugo(d){let n;try{n=Rb.b(d)}catch(B){F.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(n)if(n.IsPolicyTipAvailable)switch(n.IsPolicyTipAvailable.toLowerCase()){case "false":F.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");
break;case "true":F.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.sSe=n.NavigateUrl;this.pfp(n.GeneralText,Object(X.a)(this,this.L3n,"onDataLossPolicyOverrideButtonClick"));break;default:F.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",n.IsPolicyTipAvailable)}else F.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else F.ULS.sendTraceTag(25565185,
306,10,"policyData is null after deserializing DataLossPrevention response.")}bIl(d){switch(d){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}bho(d,n,B,Q,ha=null){var Aa=Q?Q.oKa:2;let bb=0;var Ib="";let oc;if(({Zv:oc}=Rb.d(d)).returnValue)if(oc){Ib="Success";d=this.pwf(3);if(oc.IsSuccessful){Ua.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.Psb(Aa,void 0,this.Drd));this.ked=this.Drd=null;F.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",
Aa);2===Aa&&this.v1a(29);this.u5o(n,Aa);this.WZn();this.v1a(28);this.nEa()?Q&&4===Aa&&(Ib=ha.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"),this.aVc(28,Ib?"SENSITIVITY":CommonUIStrings.l_PolicyBusinessBarTitle,String.format(Ib?"Due to content created by Copilot, your organization automatically applied the sensitivity label: {0}.":CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Q.displayName),CommonUIStrings.l_DialogOk,()=>{})):Q&&4===Aa&&this.aVc(28,CommonUIStrings.l_PolicyBusinessBarTitle,
String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Q.displayName),CommonUIStrings.l_DialogOk,()=>{});sb.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Ja.a,{name:"SetPolicyLabelApplyFlag",string:cd[Aa]})]);this.o9d(n,d,this.WRa,void 0,3,ha);return}F.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",Aa,oc.FailureReason);this.ked=oc.FailureReason;bb=this.bIl(oc.FailureReason);
this.s7i&&0<=oc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Q=new tb.a(2,1,this.$Uj,()=>{F.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.mnb);this.mnb<=this.fKd&&this.BBe(n,B,null,ha)}),this.Sb.pc(Q));this.aqc&&this.OBb&&this.o9d(this.nu.AppliedPolicyId,d,this.WRa,!0,3,ha)}else Ib="setPolicyLabelData null.",F.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",
Aa);else Ib="TryDeserialize failed.",F.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Aa);this.Zyg(Aa,ha,bb);Aa=this.Psb(Aa,void 0,this.Drd);this.Drd=null;Aa.extendedProperties.set("SetPolicyLabelDataFailureReason",this.ked);Aa.extendedProperties.set("SetPolicyLabelDataParseStatus",Ib.toString());Ua.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Aa)}x6c(d){if(""===d)return null;for(const n of this.nu.SensitivityLabels)if((null===
n||void 0===n?void 0:n.Id)===d)return n;return null}sCp(){if(""!==this.$P)for(const d of this.nu.SensitivityLabels)(null===d||void 0===d?void 0:d.Id)===this.$P&&(d.HasExtractForUser=this.lwb(d)?this.nu.ExtractEnabled:!0)}Zyg(d,n=null,B=0){const Q=2===d||8===d||16===d,ha=new yb;this.VAb(this.$P);this.nEa()&&(ha.ulf=this.x6c(this.$P),ha.context=n,ha.LDg=B);this.MDj(ha);this.aEj(B,d,Q,!1)}u5o(d,n){this.VAb(this.$P=d);if(!this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1))if(""===d)G.AFrameworkApplication.nE=!1,G.AFrameworkApplication.akc=!1;else for(const B of this.nu.SensitivityLabels)if(B.Id===d){G.AFrameworkApplication.nE=this.lwb(B);break}this.Vuo(new kb(d,n))}CFp(){for(const d of this.nu.SensitivityLabels)if(null===d||void 0===d?0:d.Enabled)d.Id===this.$P&&(this.Ouh=this.jEb!==d.Order,this.jEb=d.Order),d.Order>this.OXe&&(this.OXe=d.Order)}XGp(){this.za.appSettings&&(this.za.appSettings.AppliedPolicyId=this.$P);let d=!1;if(""!==this.$P)for(const n of this.nu.SensitivityLabels)if(n.Id===
this.$P){d=this.lwb(n);break}G.AFrameworkApplication.nE=d;G.AFrameworkApplication.AR=d?this.nu.ViewEnabled&&!this.nu.EditEnabled:!1;G.AFrameworkApplication.Due=d?this.nu.PrintEnabled:!1;G.AFrameworkApplication.akc=d?this.nu.MacrosEnabled:!1;G.AFrameworkApplication.XLa=d?this.nu.ExtractEnabled:!1;G.AFrameworkApplication.w4d=d?this.nu.ExportEnabled:!1;G.AFrameworkApplication.x4d=d?this.nu.FullControlEnabled:!1}nWi(d,n){if(!d)return F.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),
!1;if(!d.AreLabelsAvailable)return!1;this.nu=d;this.$P=d.AppliedPolicyId;this.nEa()&&this.sCp();this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)?this.XGp():this.za.appSettings&&(this.za.appSettings.AppliedPolicyId=this.$P);this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.CFp();this.Sob()&&F.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");d=new yb(!0);this.nEa()&&
(d.ulf=this.x6c(this.$P),d.context=n);this.MDj(d);return!0}Lgo(d,n=null){return({Zv:d}=Rb.d(d)).returnValue?this.nWi(d,n):(F.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1)}cZh(){if(!this.Sob())return F.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const d of this.nu.SensitivityLabels)if(d&&d.AutoLabelingSensitiveTypeIds&&0<d.AutoLabelingSensitiveTypeIds.length)return!0;F.ULS.sendTraceTag(539877700,
306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}MDj(d){F.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.sa.raiseEvent("LabelInfoUpdateEvent",d)}ouo(d){F.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.sa.raiseEvent("GetPolicyLabelEventKey",d)}Awe(){Ab.nye(!1);this.sa.raiseEvent("GetPolicyLabelFailureEventKey",new mc)}Zsg(d){this.Rw&&this.Rw.execute(n=>{n=[n.isFeatureEnabled("MsoClpSpTwo",!0),
n.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(n).then(B=>{Nc.a.any(B,Q=>Q)&&(F.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.sa.raiseEvent("GetAutoPolicyLabelEventKey",d),this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.Q0d(),sb.a("MipAutoClassificationEnabled"));return null})})}Hab(d=null,n=null){const B=new Map;B.set("ClpCoauth",this.OBb.toString());null!=d&&B.set("ApplyLabelFlags",cd[d]);null!=
n&&B.set("GetPolicyLabelsReason",yc[n]);return B}Psb(d=null,n=null,B=null){const Q=new jd.a;Q.extendedProperties=this.Hab(d,n);null!=B&&(Q.durationMs=this.Zq()-B);return Q}Vuo(d){F.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.sa.raiseEvent("SetPolicyLabelEventKey",d)}DDj(d){F.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");d&&d.Uie&&sb.a("MipRecommendations");this.sa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",d)}XDj(d){F.ULS.sendTraceTag(51128256,
306,50,"Raising an remove auto policy business bar entry event.");this.sa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",d)}Sto(d){F.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.sa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",d)}Ruo(d){F.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.sa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",d)}pfp(d,n=null){F.ULS.sendTraceTag(34996496,
306,50,"Showing policy tip to user.");this.sa.raiseEvent("PolicyTipEvent",new $b(CommonUIStrings.l_PolicyBusinessBarTitle,d,CommonUIStrings.l_PolicyOverrideButton,n))}aEj(d,n,B,Q=!0){F.ULS.sendTraceTag(42074656,306,Q?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",n);Q=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let ha=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Aa=null,bb=null;switch(d){case 2:Q=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;
ha=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:ha=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Q=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;ha=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:Q=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;ha=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;
break;case 9:Q=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;ha=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:ha=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:Q=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;ha=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;break;case 15:Q=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,
ha=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Aa=CommonUIStrings.l_LearnMore,bb=()=>{this.p4o()}}d=new Ob(d,n,B,Q,ha,Aa,bb);this.sa.raiseEvent("SetPolicyLabelFailureEventKey",d)}Q2o(d){this.V2e=d}L3n(){this.sSe?(F.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),gc.a.wsb(this.sSe)):F.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}Yyn(d){if(!d.startsWith("<")||-1===d.indexOf("Error")&&
-1===d.indexOf("Unavailable"))return!1;F.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}jzj(){this.UMd&&(this.UMd.stop(),this.UMd=null)}tmm(d){if(!d)return"manual";switch(d.oKa){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";case 32:return"ai";default:return"manual"}}Jom(d){if(!d)return"privileged";
d=d.oKa;let n="privileged";if(4===d||1===d||32===d)n="standard";return n}Snj(d){switch(d){case 1:return"Excel";case 4:return"OneNote";case 2:return"PowerPoint";case 5:return"Visio";case 3:return"Word";default:return"Unknown"}}o9d(d,n,B=null,Q=!1,ha=0,Aa=null){this.za.$("WacLabelingGetPolicyLabelsIsEnabled")&&(this.$P=d,this.WRa=B,this.qe&&(this.GGb=this.qe.rg("WebServiceCall","Call Get Policy Endpoint On Server")),Object(Pb.d)(this.za,this.$f,Object(X.a)(this,this.Vig,"onGetPolicyLabelsSuccessCallback"),
Object(X.a)(this,this.Uig,"onGetPolicyLabelsFailureCallback"),this.$kd("getpolicylabels",Q),d,n,ha,Aa),this.SKc++,F.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.SKc))}o4o(d,n,B,Q=null,ha=null){if(this.xvb){this.qe&&(this.PKb=this.qe.rg("WebServiceCall","Call Set Policy Endpoint On Server"));var Aa={};Aa[Id.a.NQj]=d;n&&(Aa[Id.a.ZUj]=encodeURIComponent(n));this.V2e&&(Aa[Id.a.Ubl]=this.V2e);Q?(Aa[Id.a.WUj]=this.tmm(Q),Aa[Id.a.XUj]=this.Jom(Q),1===
Q.oKa&&this.nu.DefaultLabelType&&(Aa[Id.a.m4o]=this.nu.DefaultLabelType)):(Aa[Id.a.WUj]="manual",Aa[Id.a.XUj]="privileged");this.OBb&&this.nu&&(Aa[Id.a.Pjo]=this.nu.PolicyLabelVersionToken);this.za.$("SendHostAttributionInfoForPolicyLabelEnabled")?(d=new xc.a(this.$kd(Pb.e,!0),1,null,Aa,!0,2,Q,void 0,this.nEa()?ha:void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,B),this.$f.send(d).cxa(Object(X.a)(this,this.Ntj,"onSetPolicyLabelSuccessCallback"),Object(X.a)(this,this.Mtj,
"onSetPolicyLabelFailureCallback"))):this.$f.addRequest(this.$kd(Pb.e,!0),1,null,Aa,!0,2,Object(X.a)(this,this.Ntj,"onSetPolicyLabelSuccessCallback"),Object(X.a)(this,this.Mtj,"onSetPolicyLabelFailureCallback"),Q,this.nEa()?ha:void 0,void 0,void 0,void 0,"32");this.mnb++;F.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.mnb)}else F.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}p4o(){const d=
new Sa.StandardDialog,n=this.za.rb("BreadcrumbFolderUrl");n?(d.Md=11,d.Ue(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),d.Ue(2,CommonUIStrings.l_DialogOk)):(d.Md=0,d.Ue(1,CommonUIStrings.l_DialogOk));d.sUd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");d.tGo();d.tU(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,
B=>{1===B&&n&&gc.a.Zm(n,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}pwf(d){return Object(Pb.b)(d)}HMl(d=null){if(!d)return fd.a.R9a(8,0);switch(d.oKa){case 1:case 16:return fd.a.R9a(1,1);case 4:case 2:case 8:return fd.a.R9a(8,1);default:return fd.a.R9a(8,0)}}Z0b(d){Xa.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",d)}Xmc(d){return d?d.ParentId&&d.ParentName?d.ParentName+"\\"+d.DisplayName:d.DisplayName:""}getHighestSensitivityLabel(d){if(!d||0==
d.length)return null;let n=null;for(const B of d)if(""!==B){d=!1;for(const Q of this.nu.SensitivityLabels)(null===Q||void 0===Q?void 0:Q.Id)===B&&(d=!0,!n||Q.Order>n.Order)&&(n=Q);if(!d)return null}n||(n=new Lb);return n}Fom(){return""===this.$P?new Lb:this.x6c(this.$P)}tryUpgradeLabel(d,n){if(""===d.Id)return 0;var B=this.x6c(this.$P);d=this.x6c(d.Id);if(!d)return 2147205112;if(!d.Enabled)return 2147205117;if(d.HasUserDefinedPermissions)return 2147205116;if(1==G.AFrameworkApplication.va.mode)return 2147205119;
if(d.RequiredDowngradeJustification||(null===B||void 0===B?void 0:B.Order)>=d.Order)return 2147205105;B=new Ba(4,this.Xmc(d));this.BBe(d.Id,"",B,n);return 0}}Object(D.a)(ce,"PolicyManager",null,[1020]);var Fe=e(134);class Fd{constructor(){this.paf=this.r7e=this.Fzh=this.yGh=this.eeh=this.pv=this.Jfa=this.Z=this.oi=null;this.voj=()=>{this.pv=this.Z.Wa("CommonUI.BusinessBar");this.oi||(this.oi=this.Z.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.Jfa=this.Z.resolve("Common.App.Policy.PolicyActor");
Xa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.oi.RMb(Object(X.a)(this.Jfa,this.Jfa.iGj,"registerActionsHandler")):this.Jfa.mc();this.oi.RMb(this.BFp);G.AFrameworkApplication.J.$("WacApplyManualPolicyLabelIsEnabled")&&(this.oi.Kjf(this.E2m),this.oi.m6k(this.aVc),this.oi.M8k(this.v1a),this.oi.n6k(this.bif),this.oi.N8k(this.Kvg))};this.BFp=()=>{this.Jfa.B1o();this.Jfa.$3o();this.Jfa.wso();const d=this.oi.Qvl();G.AFrameworkApplication.J.$("HasDocumentEditRights")&&
!d?this.Jfa.Xvp():F.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",G.AFrameworkApplication.J.$("HasDocumentEditRights"),d);G.AFrameworkApplication.ta.Ne()};this.ofp=(d,n)=>{this.r7e&&this.pv.s9(38)&&this.pv.removeEntry(this.r7e);d=this.FJi(n.title,n.Rjo,38,n.m2n,n.buttonText);G.AFrameworkApplication.ta.Pb.dBa(d,!0)?(this.r7e=d,F.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):
F.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};this.E2m=(d,n)=>{n.Tep&&(this.paf&&this.pv.s9(21)&&this.pv.removeEntry(this.paf),d=this.FJi(n.title,n.message,21,null,null,n.oXc,n.buttonText),G.AFrameworkApplication.ta.Pb.dBa(d,!0)?(this.paf=d,F.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):F.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))};
this.v1a=(d,n)=>{(d=n.Uie?this.yGh:this.eeh)&&this.pv&&this.pv.s9(n.Cgc)&&this.pv.removeEntry(d)};this.aVc=(d,n)=>{this.pv&&(this.oi.v1a(n.Cgc),d=new ka.a(n.title,n.message,null),d.id=n.Cgc,d.closeable=!0,d.image=3,d.addButton(n.buttonText,n.oXc,n.buttonText,!0),this.pv.yB(d,!1),n.Uie?this.yGh=d:this.eeh=d)};this.bif=(d,n)=>{this.pv&&(d=new ka.a(n.title,n.message,null),d.id=n.Cgc,d.closeable=!1,d.image=3,d.addButton(n.buttonText,n.oXc,n.buttonText,!1),this.pv.yB(d,!1),this.Fzh=d)};this.Kvg=()=>{const d=
this.Fzh;d&&this.pv&&this.pv.s9(d.id)&&this.pv.removeEntry(d)}}get name(){return"Common.App.Policy"}init(){G.AFrameworkApplication.J.$("ShouldInitCommonPolicyPackage")&&(G.AFrameworkApplication.J.$("IsDataLossPreventionEnabledForUser")&&G.AFrameworkApplication.ta&&(this.oi=this.Z.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.oi.E8k(this.ofp),F.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",
!1)?Fe.a.get_instance().Zk(5,()=>{this.oi.oMf()}):Fe.a.get_instance().Zk(6,()=>{this.oi.oMf()})),G.AFrameworkApplication.J.$("WacLabelingPoliciesIsEnabled")&&G.AFrameworkApplication.J.$("SupportsPolicies")?G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?Fe.a.get_instance().Zk(5,this.voj):Fe.a.get_instance().Zk(6,this.voj):(Ab.NHp(),Ab.nye(!1)))}dispose(){}Ec(d){d.register(1020,"Common.App.Policy.Contracts.IPolicyManager").ha().fe(()=>
new ce(G.AFrameworkApplication.J,G.AFrameworkApplication.pe,G.AFrameworkApplication.ta.Kt,G.AFrameworkApplication.J.sc("MaxGetPolicyRetries",1),d.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),G.AFrameworkApplication.ta.Pb.gl));d.register(Ab,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ha().fe(()=>new Ab(G.AFrameworkApplication.va,G.AFrameworkApplication.ta,G.AFrameworkApplication.J,d.zf("Common.App.Policy.Contracts.IPolicyManager")));this.Z=
d}FJi(d,n,B,Q=null,ha=null,Aa=null,bb=null){d=new ka.a(d,n,null);d.id=B;d.closeable=!0;Q&&d.wUd(ha,Q);Aa&&d.addButton(bb,Aa,bb);return d}static main(){U.a.instance.Rc(new Fd)}}Object(D.a)(Fd,"PackageManager",null,[0,1]);var Qb=e(160),ch=e(596),Nf=e(126),Mf=e(616),Df=e(459),Ig=e(262);class pg extends Ig.a{constructor(){super();this.Offset=this.Top=this.CollectionId=this.Authorization=this.FileId=this.Language=null}Hn(){return Df.a.templates}static construct(d,n,B,Q,ha,Aa){const bb=new pg;bb.Language=
B;bb.FileId=n;bb.Authorization=d;bb.CollectionId=Q;bb.Top=ha;bb.Offset=Aa;return bb}}Object(D.a)(pg,"TemplatesRequest",Ig.a,[]);class Rf{constructor(d,n,B){this.HV=d;this.J=n;this.h0n=B;this.Gbj=async(Q,ha,Aa,bb)=>{var Ib;let oc=pg.construct(null,G.AFrameworkApplication.rootQuerySignature,Q,ha,Aa,bb);this.h0n.kX("ContentPlatform",null!==(Ib=this.J.rb("ContentPlatformUrl"))&&void 0!==Ib?Ib:"https://contentplatform.office.net").then(Ac=>{Ac.IsSuccess?oc=pg.construct(Ac.Token,Q,G.AFrameworkApplication.rootQuerySignature):
F.ULS.sendTraceTag(509693953,3042,15,"Failed to acquire access token for Content Platform [OAuthResult Error: {0}]",Ac.ErrorMessage)}).catch(()=>{F.ULS.sendTraceTag(509693952,3042,15,"Failed to acquire access token for Content Platform")});return this.r5k(oc)}}r5k(d){return new Promise((n,B)=>{this.HV.addRequest(`${Nf.a.webServiceBase}OfficeTemplatesMetadata.ashx?perfTag=Templates`,2,Mf.b(d),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,Q=>{var ha,Aa;if(null===(ha=null===Q||void 0===Q?
void 0:Q.data)||void 0===ha||!ha.responseData)return B("No response data!");if(Q.data.Xe!==Qb.a.jB)return B(`Bad Http Status ${Q.data.Xe}`);if(!({group:Q}=ch.a.A6(Q.data.responseData)).returnValue)return B("Empty Server response!");ha=null;if(null===(Aa=null===Q||void 0===Q?void 0:Q.Responses)||void 0===Aa||!Aa.length||!(ha=Q.Responses[0]))return B("No valid response!");n(ha.Templates)},Q=>{var ha,Aa;F.ULS.sendTraceTag(509692131,3042,10,"Templates request failed [Status: {0}]",null===(ha=null===Q||
void 0===Q?void 0:Q.data)||void 0===ha?void 0:ha.status);B(null===(Aa=null===Q||void 0===Q?void 0:Q.data)||void 0===Aa?void 0:Aa.status)},d)})}}Object(D.a)(Rf,"OfficeTemplatesDiscoveryService",null,[]);class qf{get name(){return"Box4.OfficeTemplates"}init(){}dispose(){}Ec(d){this.container=d;this.container.register(Rf,"Box4.OfficeTemplates.OfficeTemplatesDiscoveryService").ha().fe(()=>new Rf(G.AFrameworkApplication.pe,this.container.resolve("Common.IAppSettingsManager"),this.container.resolve("Common.App.OAuth.IOAuthManager")))}static main(){U.a.instance.Rc(new qf);
F.ULS.sendTraceTag(509692130,3042,50,"Box4 Office Templates package registered.")}}Object(D.a)(qf,"OfficeTemplatesPackage",null,[0,1]);var Mh=e(1253),ed=e(11),dd=e(19);class Vh{constructor(d,n){this.ga=d;this.JFc=n}mc(){F.ULS.sendTraceTag(558965411,390,50,"Registering AcronymsWeb actions");try{this.ga.nb(dd.a.b3b,S.a.frame,this.JFc.NRi,1028),this.ga.nb(dd.a.Jsg,ed.a.view,this.JFc.XRi,1124)}catch(d){F.ULS.sendTraceTag(558965440,390,10,"Registering actions failed",d.message)}}lRa(){F.ULS.sendTraceTag(558965441,
390,50,"Unregistering AcronymsWeb actions");this.ga.Jz(dd.a.b3b,S.a.frame,this.JFc.NRi);this.ga.Jz(dd.a.Jsg,ed.a.view,this.JFc.XRi)}dispose(){this.JFc=this.ga=null}}Object(D.a)(Vh,"AcronymsWebActionDelegator",null,[11]);var Gf=e(465);class Td{constructor(d){this.KFc=d;this.NRi=(n,B,Q)=>{if(1===Q)return 32;try{this.KFc.isVisible()?this.KFc.hide():this.KFc.show()}catch(ha){return F.ULS.sendTraceTag(558965410,390,10,"Show/hide pane failed",ha.message),8}return 32};this.XRi=(n,B,Q,ha,Aa)=>{if(1===Q)return 32;
Aa&&(Aa[Gf.a.On]=this.KFc.isVisible(),Aa[Gf.a.Visible]=!0);return 32}}dispose(){this.KFc=null}}Object(D.a)(Td,"AcronymsWebActionHandler",null,[11]);var Xc=e(1738);class de{constructor(d,n,B,Q){this.Ai=d;this.lQd=n;this.kWe=B;this.PLd=Object.assign(new Xc.a,{isModernPane:!0,sourceLocationOverrideResourceId:this.lQd,AU:WacWordeditorStrings.AcronymsPaneTitle});Q(this)}static Zul(){return d=>{d.kWe.execute(async n=>{n=await n.isFeatureEnabled("mso_sendASmile",!0)&&G.AFrameworkApplication.uE;const B={};
B.EnableFeedback=n;d.PLd.DW=B})}}isVisible(){return this.Ai.g5(`${"FA000000085"}.${this.lQd}`)}show(){if(this.isVisible())return F.ULS.sendTraceTag(558965405,390,10,"Show pane called when already shown"),!0;sb.c(dd.a.b3b,void 0,void 0,void 0,2);let d=!1;try{d=this.Ai.l6("FA000000085",this.PLd,!0)}catch(n){F.ULS.sendTraceTag(558965406,390,10,"Show pane failed due to exception",n.message)}d||F.ULS.sendTraceTag(558965407,390,10,"Show pane failed");return d}hide(){if(this.isVisible()){sb.c(dd.a.b3b,void 0,
void 0,void 0,2);try{this.Ai.yOb("FA000000085",this.PLd)}catch(d){F.ULS.sendTraceTag(558965409,390,10,"Hide pane failed",d.message)}}else F.ULS.sendTraceTag(558965408,390,10,"Hide pane called when already hidden")}dispose(){this.PLd=this.Ai=null}}Object(D.a)(de,"AcronymsWebPane",null,[11]);var ze=e(1428);class jf extends ze.a{constructor(){super(...arguments);this.Z=null}get name(){return"WordEditor.AcronymsWeb"}bXa(d){this.Z=d;this.Z.ja("WordEditor.AcronymsWeb.IAcronymsWebPane",()=>new de(this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
G.AFrameworkApplication.J.rb("WordEditorAcronymsWebSourceLocationOverrideResourceId"),this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),de.Zul())).ha();this.Z.ja("WordEditor.AcronymsWeb.IAcronymsWebActionHandler",()=>new Td(this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane"))).ha();this.Z.ja("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator",()=>new Vh(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler"))).ha()}dXa(){let d=
!1;try{this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").mc(),d=!0}catch(n){F.ULS.sendTraceTag(558965404,390,10,"Initializing package failed",n.message)}sb.a("InitializeAcronymsWebPackage",d)}cXa(){this.Z&&(this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").lRa(),this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane").dispose(),this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler").dispose(),this.Z.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").dispose(),
this.Z=null)}static get aln(){return Object(Mh.a)(G.AFrameworkApplication.J,G.AFrameworkApplication.uiCulture)}static main(){G.AFrameworkApplication.BL||jf.aln&&U.a.instance.Rc(new jf)}}Object(D.a)(jf,"WordEditorAcronymsWebPackage",ze.a,[]);class hc{constructor(){this.Nvk=new ma.a}get EXd(){return this.Nvk}eJm(d){F.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",d);const n=new ma.a;for(const B of this.EXd)for(const Q of B.Ehd)Q.id===d&&n.add(Q);return n}vml(d){var n=this.eJm(d);if(n&&0<n.count){d=
Object.assign(new ab.a,{ControlList:[]});for(const B of n)n=B.avd(),0<n.length&&Array.addRange(d.ControlList,n);return d}return null}pSh(d){this.EXd.add(d)}ZFo(d){for(const n of this.EXd)if(n.aWh===d.aWh){this.EXd.remove(n);break}}static z_l(d,n,B=null){d=hc.Ytm(d);0<d.length&&(hc.QAe(d,!1),B&&B(n,d))}static Ytm(d){const n=[];if(d&&d.Ehd&&0<d.Ehd.count)for(const B of d.Ehd)if(B.controls&&0<B.controls.count)for(const Q of B.controls)if(Q.menuItems&&0<Q.menuItems.count)for(const ha of Q.menuItems)Array.add(n,
ha.id);return n}static QAe(d,n){if(d.length){var B=[];for(const Q of d)B.push(appChrome.actions.updateControlEnabledDisabledState(Q,n));appChrome.api.dispatch(B)}}}Object(D.a)(hc,"ContextMenuExtensibilityCache",null,[1958,1959]);class wc{constructor(){this.w4l=this.displayName=this.FZc=this.pE=this.LZ=null;this.isUpgraded=!1}b7i(d,n){return this.LZ.getStoreType().toLowerCase()===d.toLowerCase()&&this.LZ.getSolutionId().toLowerCase()===n.toLowerCase()}}Object(D.a)(wc,"AddinCommandsResourceItem",null,
[]);class Pc{constructor(){this.lNe=null;this.fXe=0;this.YZe=!1;this.sa=new dc.a;this.UFk=new ma.a}q6k(d){this.sa.addHandler("AddinCommandsLoadingMessageChanged",d)}get AVc(){return this.lNe}dAc(d){d!==this.lNe&&(this.lNe=d,this.sa.raiseEvent("AddinCommandsLoadingMessageChanged"))}oZo(){this.fXe++;this.AVc||this.dAc(CommonUIStrings.l_LoadingAddInsTitle)}MCg(){this.fXe--;this.rle()&&(this.YZe?this.AVc!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.dAc(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.dAc(null))}q0o(){this.YZe=!0;this.dAc(CommonUIStrings.l_ErrorLoadingAddInsTitle)}i7h(){this.YZe=!1;this.rle()?this.dAc(null):this.dAc(CommonUIStrings.l_LoadingAddInsTitle)}rle(){return 0>=this.fXe}get tpc(){return this.UFk}Qkc(d,n,B=0){for(const Q of this.tpc)if(Q.b7i(d,n)&&(!Q.pE||Q.pE.Plm===B))return Q;return null}$Sh(d,n,B,Q){const ha=new wc;ha.LZ=d;ha.pE=n;ha.FZc=B;ha.displayName=Q;this.tpc.add(ha)}n3k(d,n,B,Q){const ha=new wc;ha.LZ=d;ha.pE=n;ha.FZc=null;ha.w4l=B;ha.displayName=Q;this.tpc.add(ha)}uFo(d,
n){let B=0;for(const Q of this.tpc)Q.LZ.getStoreType()===d&&Q.LZ.getSolutionId()===n?this.tpc.removeAt(B):B++}static getInstance(){Pc._instance||(Pc._instance=new Pc);return Pc._instance}}Pc._instance=null;Object(D.a)(Pc,"AddinCommandsResourceManager",null,[]);var md=e(2003),fe=e(44),se=e(1565),$d=e(793),Md=e(557),Ub=e(1566),Vc=e(205),qd=e(82);class vb{constructor(){this.title=this.id=this.tabs=null}}Object(D.a)(vb,"AddInDataTransferObject",null,[]);class Kb{constructor(d,n,B){this.Ezd=d;this.Hsk=
n;this.Jsk=B}get qL(){return this.Ezd}get addInId(){return this.Hsk}get N2k(){return this.Jsk}static u4c(d){return(d=d.dFa)?Object.assign(new vb,{tabs:d.qL.toArray(),id:d.addInId,title:d.N2k}):null}}Object(D.a)(Kb,"OneLineRibbonExtensibility",null,[]);var Ic=e(1376);class kd{static get ry(){return kd.Tq||(kd.Tq=Wa.a.instance.Wa("Common.Utils.IAriaNotifier"))}static ndi(d,n,B,Q){kd.h0&&kd.h0.RL&&kd.h0.dismiss();kd.h0=md.a.Tei(n,d,d,3);kd.h0.content=B;Ic.b(Q)||(kd.h0.title=Q,kd.h0.ude=!0);d=new Sys.UI.Bounds(0,
0,qd.a.aub(),qd.a.G1());kd.h0.dma=kd.IKf(d,n,kd.h0.Eqa,1);kd.h0.show();kd.ry&&kd.ry.sendNotification(B.innerText,!0)}static Gvf(d,n,B,Q=null){Vc.UISurfaces.tN().then(ha=>{let Aa=null;kd.SQc&&(ha.removeNotification(kd.SQc),kd.SQc=null);const bb=ha.callout(Object.assign(new se.a,{target:d,title:n,content:B,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new Ub.a,{onDismiss:()=>{ha.removeNotification(Aa)},directionalHint:null!=Q?Q:null})})),Ib=Object.assign(new Md.a,
{expirationOptions:Object.assign(new $d.a,{displayTimeoutSeconds:7,onExpire:()=>{ha.removeNotification(kd.SQc)}})});Aa=kd.SQc=ha.addNotification(bb,Ib);return null},ha=>{F.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",ha);return null})}static AGg(d){kd.h0&&kd.h0.RL&&kd.h0.dismiss();const n=new Sa.StandardDialog;n.tGa=!1;n.Md=0;n.zA(fe.a.bFn,CommonUIStrings.l_DialogError,Ic.b(d)?kd.jCi():d,null)}static Ycp(d){kd.h0&&kd.h0.RL&&kd.h0.dismiss();F.ULS.sendTraceTag(17425951,
220,10,String.format("AddinCommandsActivationError : error code {0}.",d.errorCode));const n=Ic.b(d.description)?kd.jCi():d.description,B=new Sa.StandardDialog;let Q=null;d.qXc?(B.Md=1,B.Ue(1,d.buttonText),B.YW(1)):B.Md=0;Q=ha=>{1===ha?d.qXc():d.Wta&&d.Wta()};B.tGa=!1;0===d.Mha?B.zA(d.errorCode,d.title?d.title:CommonUIStrings.l_DialogError,n,Q):1===d.Mha?B.tU(d.title?d.title:CommonUIStrings.l_DialogWarning,n,Q):B.Rxa(d.title?d.title:CommonUIStrings.l_DialogInfo,n,Q)}static IKf(d,n,B,Q){let ha=0===
Q?0:4;const Aa=d.x+d.width-n.x-n.width;n.x-d.x+n.width/2<=B/2?ha=0===Q?2:5:Aa+n.width/2<=B/2&&(ha=0===Q?3:6);return ha}static pdp(d,n,B,Q=!1){(n=Kb.u4c(n))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(n,ha=>{ha&&(Q||kd.Gvf(ha,B,d,5))})}static qdp(d,n,B=!1){kd.pdp(n.startedNode?n.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,d),n,n.startedNode?n.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,
d),B)}static odp(d,n,B,Q){if(kd.Yek)d=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,B,Q,CommonUIStrings.l_InsertionDialogRefresh)),kd.Gvf(n,d,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{n=gc.a.getElementBounds(n);var ha=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Aa=document.createElement("span");Aa.innerText=ha[0];var bb=document.createElement("span");bb.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
B,Q,CommonUIStrings.l_InsertionDialogRefresh);bb.className="UIFontBold";B=document.createElement("span");B.innerText=ha[1];Q=document.createElement("div");Sys.UI.DomElement.addCssClass(Q,"ModalCalloutControl");Q.appendChild(Aa);Q.appendChild(bb);Q.appendChild(B);kd.ndi(d,n,Q,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static Uep(d,n){var B=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,Q=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;kd.Yek?kd.Gvf(n,B,Q):(n=gc.a.getElementBounds(n),
kd.ndi(d,n,kd.qol(Q),B))}static j0l(){kd.h0&&kd.h0.RL&&kd.h0.dismiss()}static qol(d){const n=document.createElement("div");Sys.UI.DomElement.addCssClass(n,"ModalCalloutControl");n.innerText=d;return n}static jCi(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Yek(){return G.AFrameworkApplication.ta.Pb.$t&&G.AFrameworkApplication.ta.Pb.ZZa}}kd.h0=null;kd.SQc=null;kd.Tq=null;Object(D.a)(kd,"AddInCommandsNotificationFactory",null,[]);class Wd{constructor(d,
n){this.j3a=(B,Q,ha,Aa,bb)=>{if(Q.contextId!==ed.a.application)return 2;if(1===ha)return B!==Z.a.Nec||this.Nya&&this.Nya.F_m(bb)?32:8;if(!bb)return 8;switch(B){case Z.a.iXb:this.Nya.iXb(bb);break;case Z.a.Nec:this.Nya.Gce(bb);break;case Z.a.Nld:this.Nya.Nld(bb);break;case Z.a.FAc:this.Nya.FAc(bb);break;case Z.a.lU:this.Nya.Fro(bb);break;case Z.a.zyc:this.Nya.zyc(bb);break;case Z.a.hug:this.Nya.Qzo();break;case Z.a.c3b:this.Nya.c3b(bb);break;case Z.a.wQa:this.Nya.wQa(bb);break;case Z.a.$Ma:this.Nya.$Ma(bb)}return 32};
this.ga=d;this.Nya=n}mc(){this.ga.qa(Z.a.iXb,ed.a.application,this.j3a);this.ga.nb(Z.a.Nec,ed.a.application,this.j3a,64);this.ga.nb(Z.a.Nld,ed.a.application,this.j3a,96);this.ga.qa(Z.a.FAc,ed.a.application,this.j3a);this.ga.nb(Z.a.zyc,ed.a.application,this.j3a,64);this.ga.nb(Z.a.lU,ed.a.application,this.j3a,64);this.ga.qa(Z.a.hug,ed.a.application,this.j3a);this.ga.qa(Z.a.c3b,ed.a.application,this.j3a);this.ga.qa(Z.a.wQa,ed.a.application,this.j3a);this.ga.qa(Z.a.$Ma,ed.a.application,this.j3a)}}Object(D.a)(Wd,
"AddInCommandsActor",null,[]);class Ye{constructor(){this.sQh={["tabhome"]:"tabHome",["tabinsert"]:"tabInsert",["tabpagelayoutword"]:"tabPageLayout",["tabreviewword"]:"tabReview",["tabview"]:"tabView",["tabhelp"]:"tabHelp"};this.oQh={["tabworddesign"]:["tabWordDesign",WoncaIntl.WoncaStrings.L_TabWordDesign,CommonUIStrings.l_TabWordDesignKeytip],["tabreferences"]:["tabReferences",WoncaIntl.WoncaStrings.L_TabReferences,CommonUIStrings.l_TabReferencesKeytip],["tabmailings"]:["tabMailings",WoncaIntl.WoncaStrings.L_TabMailings,
CommonUIStrings.l_TabMailingsKeytip],["tabdeveloper"]:["tabDeveloper",WoncaIntl.WoncaStrings.L_TabDeveloper,CommonUIStrings.l_TabDeveloperKeytip],["tabaddins"]:["tabAddIns",WoncaIntl.WoncaStrings.L_TabAddIns,CommonUIStrings.l_TabAddInsKeytip]};this.vTd=null}get Fbi(){return"SourceControlId"}get M1(){return"Document"}get formFactor(){return"DesktopFormFactor"}EGm(){if(!this.vTd){this.vTd={};for(const d of Object.keys(this.sQh))this.vTd[d]=this.sQh[d];for(const d of Object.keys(this.oQh))this.vTd[d]=
this.oQh[d][0]}}}Object(D.a)(Ye,"AddInCommandsStringProvider",null,[1018]);var Re=e(1836),le;(function(d){d[d.Goe=0]="notSupported";d[d.veq=1]="launchByLocalCacheInitializer";d[d.qeq=2]="launchByAnonymousApiInitializer";d[d.teq=3]="launchByInsertion";d[d.weq=4]="launchByRefresh";d[d.ueq=5]="launchByLastUpdateInitializer";d[d.req=6]="launchByDynamicCall"})(le||(le={}));Object(D.b)("AddinCommandsLaunchOperationType",le);class Bh{}Bh.wsp=864E5;Bh.m9k=3;Bh.M0n=144E5;Object(D.a)(Bh,"AddinConstantsNum",
null,[]);var gf=e(1399),Wf;(function(d){d[d.Goe=-1]="notSupported";d[d.OMEX=0]="OMEX";d[d.fwq=1]="spCatalog";d[d.ewq=2]="spApp";d[d.O8p=3]="fileSystem";d[d.exchange=4]="exchange";d[d.oneDrive=5]="oneDrive";d[d.Rxc=6]="registry";d[d.dcq=7]="inMemory";d[d.uzq=8]="uploadFileDevCatalog";d[d.Baq=9]="hardCodedPreinstall";d[d.Eue=10]="privateCatalog";d[d.pAq=16]="wopiCatalog"})(Wf||(Wf={}));Object(D.b)("AddinProviderType",Wf);class $i{static Uap(d){return parseInt($i.E4b(gf.a.xVh,d)||"-1")<=(new Date).getTime()}static Rxi(d){return parseInt($i.E4b(gf.a.mfc,
d)||"-1")}static $Ri(d){return Boolean.parse($i.E4b(gf.a.Vjf,d)||"false")}static E4b(d,n){let B=null;try{const Q=$i.O$d();if(void 0!==Q&&Q){const ha=gf.a.Glc(d)+n;B=Q.getItem(ha)}else F.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Q){F.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",d,n)}return B}static FCb(d,n,B){try{const Q=$i.O$d();if(void 0!==Q&&Q){const ha=gf.a.Glc(d)+B;Q.setItem(ha,n)}else F.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Q){F.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",d,B)}}static O$d(){if(!$i.FDa)return null;let d=null;try{d=localStorage}catch(n){$i.FDa=!1,d=null}return d}static cJm(){switch(G.AFrameworkApplication.ta.Pb.gl){case 1:return"ExcelOnline";case 2:return"PowerPointOnline";case 3:return"WordOnline";case 4:return"OneNoteOnline";case 5:return"VisioOnline";default:return"Unknown"}}}
$i.FDa=!0;Object(D.a)($i,"AddinUtil",null,[]);class wf{constructor(d,n,B,Q=null){this.J=Q?Q:G.AFrameworkApplication.J;this.SYe=2;this.OUb=d;this.jYk=n;this.Eq=B}get Vbb(){return this.SYe}get GKp(){return this.jYk}Myg(d){if(this.J.$("AgaveSupportsLiveIdSpoofing")){var n=(new Date).getTime();this.OUb(d,this.Vbb,{["ak0"]:n})}else if($i.Uap(d)){n=String.format(G.AFrameworkApplication.ta.Pb.HOa+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",G.AFrameworkApplication.ta.Pb.gl,
this.GKp,G.AFrameworkApplication.lm);const B=G.AFrameworkApplication.pe;let Q=null;this.Eq&&(Q=this.Eq.rg("ComponentAttach",Wf[d]+le[this.Vbb]));B.addRequest(n,1,null,null,!0,4,ha=>{this.nbo(d,ha.data.responseData);Q&&Q.stop()},ha=>{F.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",ha.data.Xe);this.Dvc(d,1,"request failed");Q&&Q.stop()},null)}else $i.$Ri(d)?(n=$i.Rxi(d),this.OUb(d,this.Vbb,{["ak0"]:n})):this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(this.qT?this.Dvc(d,1,"no local timestamp"):this.OUb(d,this.Vbb,null))}nbo(d,n){if(n&&""!==n)if(n=Sys.Net.XMLDOM(n)){$i.FCb(gf.a.xVh,((new Date).getTime()+Bh.M0n).toString(),d);let B=n.getElementsByTagName("update");B&&B.length||(B=n.getElementsByTagName("o:update"));B&&0<B.length?(n=Date.parse(B[0].firstChild.nodeValue),$i.Rxi(d)<n||$i.$Ri(d)?this.OUb(d,this.Vbb,{["ak0"]:n}):this.Dvc(d,1,"outdate timestamp in reponse")):this.Dvc(d,2,"no timestamp in response")}else this.Dvc(d,1,"response data is invalid");
else this.Dvc(d,1,"no responseData")}Dvc(d,n,B){this.qT&&this.OUb(d,this.Vbb,{["AddinServiceUserState"]:n,["DiagnosticInfo"]:B})}get qT(){return this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(D.a)(wf,"AddinCommandsAnonymousAPIInitializer",null,[810]);class Hf{constructor(d,n,B){this.SYe=B;this.OUb=d;this.qe=n}get Vbb(){return this.SYe}Myg(d){let n=
null;this.qe&&(n=this.qe.rg("ComponentAttach",Wf[d]+le[this.Vbb]));if(null==this.ZFg(d)?0:this.ZFg(d)){const B=(new Date).getTime()-Bh.m9k*Bh.wsp;this.OUb(d,this.Vbb,{["ak0"]:B})}n&&n.stop()}}Object(D.a)(Hf,"AddinCommandsInitializerBase",null,[810]);class vf extends Hf{constructor(d,n){super(d,n,5)}ZFg(){return!0}}Object(D.a)(vf,"AddinCommandsInitializer",Hf,[]);class Ui extends Hf{constructor(d,n){super(d,n,1)}ZFg(d){try{const n=gf.a.zDi()+d;return Boolean.parse(this.Fqm(n)||"false")}catch(n){F.ULS.sendTraceTag(17306844,
220,50,"LocalStorage is not allowed, {0}.",n.toString())}return null}Fqm(d){const n=localStorage;return void 0!==n&&null!==n?n.getItem(d):null}}Object(D.a)(Ui,"AddinCommandsLocalCacheInitializer",Hf,[]);var rf=e(552);class ug{constructor(d,n=null){this.Eq=d;this.J=n?n:G.AFrameworkApplication.J}get appUILocale(){return rf.a.Vg(G.AFrameworkApplication.lcid).name}ddn(){const d=this.Nyi();if(d)if(this.J.$("OcpsIsEnabled"))Wa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>
{n.isFeatureEnabled("ConnectedServices",!0).then(B=>{for(const Q of d){if(!B&&0===Q.key){this.qT&&this.B8j(0,Q.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const ha=this.kxi(Q.value);ha&&ha.Myg(Q.key)}return null})});else for(const n of d){const B=this.kxi(n.value);B&&B.Myg(n.key)}}Nyg(d,n,B){B&&B[gf.a.mfc]?(B[gf.a.fKa]=d,B[gf.a.eKa]=n,this.wqg(Z.a.zyc,B),$i.FCb(gf.a.mfc,B[gf.a.mfc].toString(),d)):this.qT?this.B8j(d,n,B):this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&0===d&&(B={},B[gf.a.fKa]=d,B[gf.a.eKa]=n,this.wqg(Z.a.lU,B))}kxi(d){let n=null;switch(d){case 1:n=new Ui(Object(X.a)(this,this.Nyg,"retrieveAddinFlagCompleted"),this.Eq);break;case 2:n=new wf(Object(X.a)(this,this.Nyg,"retrieveAddinFlagCompleted"),this.appUILocale,this.Eq,this.J);break;case 5:n=new vf(Object(X.a)(this,this.Nyg,"retrieveAddinFlagCompleted"),this.Eq)}return n}B8j(d,n,B){0===d&&B&&B[gf.a.hVd]&&(B[gf.a.fKa]=d,B[gf.a.eKa]=n,F.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
B[gf.a.hVd].toString(),JSON.stringify(B)),this.wqg(Z.a.lU,B))}get qT(){return this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(D.a)(ug,"AddinCommandsInitializerHost",null,[]);var Eg=e(159);class th extends ug{constructor(d,n){super(n);this.ga=d}Qxp(){this.ddn()}Hnm(){return this.Nyi()}Nyi(){const d=new Eg.a;G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&
(G.AFrameworkApplication.J.$("AddInCommandsRoamingStoreIsEnabled")?d.W(0,2):d.W(0,1),d.W(16,5));G.AFrameworkApplication.J.$("InsertAgaveMyOrgEnabledForHost")&&d.W(1,1);G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled")&&d.W(10,5);G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&d.W(8,1);return d}wqg(d,n){this.ga.Zb(d,2,n)}}Object(D.a)(th,"AddInCommandsInitService",ug,[392]);class ei extends th{constructor(d,n){super(d,n);Re.a.p9c=Re.a.sik}}Object(D.a)(ei,"WordEditorAddInCommandsInitService",
th,[]);class Yj{constructor(){this.labelText=null;this.visible=!1}}Object(D.a)(Yj,"AddinStatusCommandValues",null,[]);class Zk{static jso(d){const n=new Yj;n.labelText=d.AVc;n.visible=n.labelText?!0:!1;return n}static jDe(d,n,B,Q,ha){const Aa=document.getElementById(B);Aa?Zk.Qep(d,n,Aa,Q,ha):F.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",B))}static Qep(d,n,B,Q,ha){B?d.AVc===CommonUIStrings.l_ErrorLoadingAddInsTitle?kd.odp(n,B,Q,ha):d.AVc===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
kd.Uep(n,B):F.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(D.a)(Zk,"AddinCommandsStatusHandler",null,[]);var yg=e(18),Kk=e(1274),Jh=e(49),zf=e(129),cg=e(192);class xe extends Sys.EventArgs{constructor(){super();this.pE=this.Nr=null}}Object(D.a)(xe,"InsertionParamEventArgs",Sys.EventArgs,[]);class wi{constructor(d,n,B,Q,ha,Aa){this.aJ=d;this.Nr=n;this.VFa=B;this.displayName=ha;this.F$i=Aa}}Object(D.a)(wi,"PostLaunchAddinCommandsParameters",
null,[]);var ig=e(207),Qi=e(359);class el{}Object(D.a)(el,"AppsForOfficeEntitlementQueryInfo",null,[]);class mj{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(D.a)(mj,"AddinAbstract",null,[]);var Uf=e(87);class hh{constructor(d,n,B,Q=null){this.sTb=ha=>{let Aa=!1,bb=null;try{if(0<ha.data.responseData.length){const Ib=Object(Uf.a)(Object,Rb.a(ha.data.responseData)),oc=Ib?Ib[this.appName]:null;oc&&(bb=Object(Uf.a)(Object,Rb.a(oc.toString())))}Aa=!0}catch(Ib){this.kbb(null)}Aa&&
this.WKc&&this.WKc(bb)};this.kbb=ha=>{this.QKc&&this.QKc(ha?ha.data:null)};this.$eb=ha=>{this.zQc&&this.zQc(ha?ha.data:null)};this.Dpd=G.AFrameworkApplication.J.rb("RoamingServiceHandlerWebServiceBase");this.appName=d;this.WKc=n;this.QKc=B;this.zQc=Q}TEf(d){this.b$l(d,this.sTb,this.kbb)}b$l(d,n,B){const Q=new Sys.StringBuilder(this.Dpd);Q.append("RoamingServiceHandler.ashx?action=");Q.append("getAddinTeachingCalloutSettings");Q.append("&");Q.append(this.cQf(d));Q.append("&");Q.append(G.AFrameworkApplication.lm);
G.AFrameworkApplication.pe.addRequest(Q.toString(),1,null,null,!0,2,n,B,null)}A5d(d){this.f$l(d)}f$l(d){var n=new Sys.StringBuilder(this.Dpd);n.append("RoamingServiceHandler.ashx?action=");n.append("saveAddinTeachingCalloutSettings");n.append("&");n.append(G.AFrameworkApplication.lm);n=n.toString();d=Rb.c(d);G.AFrameworkApplication.pe.addRequest(n,2,d,null,!0,4,null,this.$eb,null)}cQf(d){const n=new Sys.StringBuilder("requestedsettings=");for(let B=0;B<d.count;B++)n.append(d.K(B)),B<d.count-1&&n.append(";");
return n.toString()}}Object(D.a)(hh,"AddinTeachingUIRoamingRequestHandler",null,[]);class Jj extends Sys.EventArgs{constructor(d){super();this.solutionId=d.solutionId;this.assetId=d.assetId;this.storeType=d.storeType;this.storeId=d.storeId;this.assetStoreId=d.assetStoreId;this.targetType=d.targetType;this.width=d.width;this.height=d.height;this.displayName=d.displayName;this.version=d.version}}Object(D.a)(Jj,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var $h=e(242);class pi{constructor(d){this.nfc=
this.Nr=null;this.QNj=!1;this.Ajb=this.Izd=this.f1a=this.nt=this.XDb=this.Pyc=null;this.D6n=()=>{const n=new ig.ScriptSharpLegacyMap;this.nfc&&this.nfc.tabs&&!this.nfc.tabs[0].isOfficeTab&&n.W("SDX.FeatureFlags","NonOfficeTab");this.xtc(pi.E1(this.Nr),"ClickOnLaunch",n);this.Mme();this.nfc?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.nfc,()=>{const B=new xe;B.Nr=this.Nr;this.vd.raiseEvent(gf.a.qaj,B)}):F.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
this.T2n=()=>{this.xtc(pi.E1(this.Nr),"ClickOnClose");this.Mme()};this.f4n=()=>{this.xtc(pi.E1(this.Nr),"ClickOnDismiss");this.Mme()};this.bpj=n=>{if(n&&(n=n.detail)&&n.id&&this.Pmn(n.id)){const B=(n.action||"").toLowerCase();if(n.success&&"opened"===B)this.xtc(pi.E1(this.Nr),"CampaignLaunched"),F.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Mme(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.bpj,!0);else{let Q;
try{Q=JSON.stringify(n),F.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+Q)}catch(ha){Q="id : "+n.id+" telemetryEventName: "+n.telemetryEventName,F.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+Q+" Error: "+(ha?ha.toString():""))}}}};this.sTb=n=>{n?this.Jbp(n)?(F.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.Pyc="AddinHasShown"in n&&n.AddinHasShown?n.AddinHasShown.toString():null,this.L$h()):(F.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),
this.f1a(this.Eob,null)):(F.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.Pyc=null,this.L$h())};this.kbb=n=>{F.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",n?n.Xe:-1);this.f1a(this.Eob,null)};this.$eb=n=>{F.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",n?n.Xe:-1)};this.vd=d}get appName(){return G.AFrameworkApplication.J.rb("WebAppShortName")}get DVh(){this.XDb||(this.XDb=
new hh(this.appName,this.sTb,this.kbb,this.$eb));return this.XDb}get Eob(){this.Izd||(this.Izd=new ma.a);return this.Izd}set Eob(d){this.Izd=d}get OOb(){this.Ajb||(this.Ajb=new ma.a);return this.Ajb}set OOb(d){this.Ajb=d}pUd(d,n){window.addEventListener?(this.Nr=d,this.nfc=n,window.addEventListener("LaunchAddinTaskpane",this.D6n,!0),window.addEventListener("DismissCallout",this.f4n,!0),window.addEventListener("CloseCallout",this.T2n,!0),window.addEventListener("FGWebSurfaceEvent",this.bpj,!0)):F.ULS.sendTraceTag(508625357,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}lDc(d,n,B,Q){this.nt=d;this.Eob=n;this.OOb=B;this.f1a=Q;F.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",n?n.count.toString():"null",B?B.count.toString():"null");0<this.Eob.count||0<this.OOb.count?(d=new ma.a,d.add(this.appName),this.DVh.TEf(d)):this.f1a(new ma.a,null)}Pmn(d){d=Ca.a.Ph(d);return-1!==d.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==d.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==d.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==d.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==d.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==d.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}wze(d){if(this.appName){const n={},B={};B.LastTeachingUIShowTime=(new Date).toUTCString();B.AddinHasShown=d;n[this.appName]=Rb.c(B);this.DVh.A5d(n);F.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else F.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}Mme(){if(!this.QNj){const d=window.g_roamingAddinList;d&&(this.wze(d),this.QNj=!0)}}L$h(){const d=this.HYl();0===d.targetType?(d.solutionId?this.Nro(d):this.xtc(null,"NoSolutionId"),this.Gdk(d),this.f1a(this.Eob,null)):this.f1a(this.Eob,d);F.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",d.addinId)}Nro(d){const n=new el;n.callbackFunc=B=>{if(B.errorCode){this.xtc(d.solutionId,"FailToGetAppDetails");var Q=window.g_roamingAddinList;
Q&&this.wze(Q)}else if(B.value)for(Q of B.value)if(B=Q[1],B===d.solutionId){const ha={};ha.solutionId=B;ha.assetId=Q[5];ha.storeType=Q[12];ha.storeId=Q[11];ha.assetStoreId=Q[6];ha.targetType=Q[3];ha.width=Q[7];ha.height=Q[8];ha.displayName=Q[0];ha.version=Q[4];F.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",d.solutionId);Q=new Jj(ha);this.vd.raiseEvent(gf.a.ndp,Q);break}};n.storeType=OSF.StoreTypeEnum.PrivateCatalog;n.fromInsertDialog=!1;n.refresh=!1;this.nt.queryEntitlementDetails(n)}Jbp(d){if("LastTeachingUIShowTime"in
d){if(d=+new Date-+new Date(d.LastTeachingUIShowTime.toString()),d<G.AFrameworkApplication.J.dZ("AddinShowTeachingUIIntervalInMS",864E5))return F.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",d),!1}else F.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}HYl(){let d=new Qi.a(new mj,0),n=new Qi.a(new mj,0),B=0,Q=0,ha=0;var Aa=new ma.a;for(var bb of this.Eob)Aa.add(bb);for(const Ib of this.OOb)Aa.add(Ib);for(const Ib of Aa)if(!("excatalog"!==
Ib.storeType||Ic.c(Ib.installTimeInMS)||!Ib.installTimeInMS||Ib.installTimeInMS<=G.AFrameworkApplication.J.dZ("DateTimeInMSForNewAddin",16409952E5))){Aa=pi.Sxi(Ib);if(this.Pyc&&(bb=this.Pyc.split(","),0<bb.length&&Array.contains(bb,Aa))){ha++;F.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}Aa.startsWith("private_")?(d=pi.eGi(Ib,d),Q++):(n=pi.eGi(Ib,n),B++)}F.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
Q,B,ha);return 0<n.value?n.key:0<d.value?d.key:Object.assign(new mj,{addinId:null,targetType:-1,solutionId:null})}xtc(d,n,B=null){d={["AppTeachingUICalloutAction"]:n,["SDX.Id"]:d,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(B)for(const Q of B.keys)d[Q]=B.K(Q);cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zf.a.iG(d)}))}Gdk(d){d&&(window.g_roamingAddinList=this.Pyc?this.Pyc+","+d.addinId:
d.addinId)}static E1(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static eGi(d,n){return n.value<d.installTimeInMS?new Qi.a(Object.assign(new mj,{addinId:pi.Sxi(d),targetType:d.targetType,solutionId:d.solutionId}),d.installTimeInMS):n}static Sxi(d){return Telemetry.PrivacyRules.IsPrivateAddin(d.storeType,d.assetId,null,null,d.storeId)?"private_"+d.installTimeInMS:d.solutionId}}Object(D.a)(pi,"PrivateCatalogTeachingCalloutHandler",null,
[]);class vh{constructor(d){this.H1e=null;this.qsh=d}get WWb(){return this.H1e}Uec(d,n=null){this.qsh.Uec(d,n);this.H1e=d}Wvg(d){this.qsh.Wvg(d)}qUj(d){this.H1e=d}}Object(D.a)(vh,"RibbonExtensibilityManagerWithChangeDetection",null,[1970]);const Bl=()=>{const d=T.a.Jtb(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"4"===d},Bj=()=>T.a.Jtb(window.location.href.toLowerCase(),"wdtpl"),Vj=()=>{const d=T.a.Jtb(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"1"===d},mh=d=>
{let n=null;switch(d){case 0:n="omex";break;case 1:n="spcatalog";break;case 2:n="spapp";break;case 3:n="filesystem";break;case 4:n="exchange";break;case 6:n="registry";break;case 7:n="inmemory";break;case 8:n="uploadfiledevcatalog";break;case 9:n="hardcodedpreinstall";break;case 10:n="excatalog";break;case 16:n="wopicatalog"}return n},xf=d=>{let n=-1;switch(d.toLowerCase()){case "omex":n=0;break;case "spcatalog":n=1;break;case "spapp":n=2;break;case "filesystem":n=3;break;case "exchange":n=4;break;
case "registry":n=6;break;case "inmemory":n=7;break;case "uploadfiledevcatalog":n=8;break;case "hardcodedpreinstall":n=9;break;case "excatalog":n=10;break;case "wopicatalog":n=16}return n};class Wg{Uec(d,n=null){if(d=Kb.u4c(d)){appChrome.addInApi.dispatchActionsToInstallAddIn(d,n);for(const B of d.tabs)if(B.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(d,()=>{});break}}}Wvg(d){(d=Kb.u4c(d))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(d)}qUj(){}static K_l(d,n,B=null){d=Wg.jPm(d);
0<d.length&&(Wg.QAe(d,!1),B&&B(n,d))}static jPm(d){const n=[];if(d&&(d=d.dFa,d.qL&&0<d.qL.count))for(const B of d.qL)if(B.groups&&0<B.groups.length)for(const Q of B.groups)if(Q.controls&&0<Q.controls.length)for(const ha of Q.controls)Array.add(n,ha.id);return n}static QAe(d){if(d.length){var n=[];for(const B of d)n.push(appChrome.actions.updateControlEnabledDisabledState(B,!0));appChrome.api.dispatch(n)}}}Object(D.a)(Wg,"OneLineRibbonExtensibilityManager",null,[1970]);class Oj{constructor(){this.Ver=
1}}Object(D.a)(Oj,"CacheItem",null,[]);class Bg{constructor(d){this.bY=d}}Object(D.a)(Bg,"AppsDataCacheManager",null,[1904]);var Xg=e(1254);class kl{constructor(){new Bg(Xg.a.instance)}jSj(d,n){d=gf.a.zDi()+d;Xg.a.instance.setItem(d,n.toString())}XMm(){var d=gf.a.cKi();F.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",d);d=Xg.a.instance.getItem(d);return Rb.a(d)}s4o(d){const n=gf.a.cKi();F.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",n);Xg.a.instance.setItem(n,Rb.c(d))}bun(){return!!Xg.a.instance.localStorage}static get instance(){kl._instance||
(kl._instance=new kl);return kl._instance}}kl._instance=null;Object(D.a)(kl,"AddInCommandsCacheManager",null,[1881]);var ff=e(103);class gj{static BEi(d){const n=new ma.a;if(gj.q$h)for(var B of gj.q$h)n.add(B);B=null;switch(d){case "Workbook":B=gj.eSp;break;case "Document":B=gj.v2l;break;case "Presentation":B=gj.mno}if(B)for(const Q of B)n.add(Q);return n}}gj.q$h=["PrimaryCommandSurface","ContextMenu"];gj.eSp=null;gj.v2l=null;gj.mno=null;Object(D.a)(gj,"ExtensionPointType",null,[]);class ej{constructor(d){this.XBh=
null;if(Ic.c(d))throw F.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Wsk=d}get Ehd(){return this.XBh||(this.XBh=new ma.a)}get aWh(){return this.Wsk}}Object(D.a)(ej,"ContextMenuExtensibility",null,[1955]);class zi{constructor(d,n=null,B=0){if(Ic.c(d))throw F.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.FNk=d;this.QUk=n;this.BCk=B}get dFa(){return this.FNk}get startedNode(){return this.QUk}get Plm(){return this.BCk}}Object(D.a)(zi,"RibbonExtensibility",null,[2019]);class Lk{constructor(d){this.FAk=d.entitlement}get entitlement(){return this.FAk}createActionContext(d,n){d={};d.ownerAddinInfo=this.entitlement;d.action=n;return d}}Object(D.a)(Lk,"AddInCommandsContextProvider",null,[]);class Gh{constructor(d,n,B){this.Pch=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=d;this.eventBuilder=n;this.contextMenuBuilder=B}get addinInfo(){return this.Pch}LKl(d){return new Lk(d)}createActionBuilder(d,n){return OfficeExt.DefaultControlActionBinder.createActionBuilder(d,n.entitlement,n.manifest)}startApplyAddin(d){this.Pch=d;const n=this.LKl(d);this.actionBuilder=this.createActionBuilder(n,d)}endApplyAddin(){}pJf(d,n,B=0){return this.ribbonBuilder.qL&&0<this.ribbonBuilder.qL.count?new zi(this.nlm(d,n),this.addinInfo.startedNode,
B):null}cxi(){var d=null;if(this.contextMenuBuilder.ene&&0<this.contextMenuBuilder.ene.count){d||(d=this.addinInfo.entitlement.solutionId);d=new ej(d);for(const n of this.contextMenuBuilder.ene)d.Ehd.add(n);return d}return null}nlm(d,n){return this.ribbonBuilder.qL&&0<this.ribbonBuilder.qL.count?new Kb(this.ribbonBuilder.qL,d,n):null}}Object(D.a)(Gh,"AddinCommandsBuilder",null,[]);class aj{constructor(d,n,B,Q,ha,Aa,bb){this.y3b=new ff.a;this.aJ=d;this.nt=n;this.e8=B;this.Nyc=Q;this.Suf=ha;this.Lfb=
Aa;this.ifc=bb;this.dX=G.AFrameworkApplication.ta.Kt}cFn(d,n,B,Q,ha,Aa,bb){const Ib=(oc,Ac,ad,sd)=>{ha(oc,Ac,ad,sd);oc=le[this.aJ]+Ac.assetId;({value:Ac}=this.y3b.Nc(oc)).returnValue&&(Ac.stop(),this.y3b.remove(oc))};if(0!==this.aJ&&d){F.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",d.count);4===this.aJ&&(F.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Q)),this.Cxl(d,Q),Aa());for(const oc of d)if(d=oc,F.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",
this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.mgk(d))if(bb&&d.requireConsent)bb(d,Ac=>{try{if(this.dX){const sd=le[this.aJ]+Ac.solutionId,wd=this.dX.rg("ComponentAttach",sd);this.y3b.W(sd,wd)}const ad=this.Lfb.Qkc(Ac.storeType,Ac.solutionId);6!==this.aJ&&(ad&&(this.hZd(ad),ad.LZ.purge(!1)),this.nt.insertOsfControl(this.Zkd(Ac,n,B,Ib)),ad&&this.nt.ownerAddinControlRecreated(Ac.solutionId,Ac.storeType))}catch(ad){F.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ac.solutionId,Ac.ownerAddinStoreType||Ac.storeType,Ac.assetId,null,null,Ac.storeId),Ac.version,Ac.storeType,Ac.storeId,ad.message)),Ib(!1,Ac,null,null)}});else try{if(this.dX){const ad=le[this.aJ]+d.solutionId,sd=this.dX.rg("ComponentAttach",ad);this.y3b.W(ad,sd)}const Ac=this.Lfb.Qkc(d.storeType,d.solutionId);
!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==G.AFrameworkApplication.ta.Pb.gl&&1!==G.AFrameworkApplication.ta.Pb.gl&&2!==G.AFrameworkApplication.ta.Pb.gl||3!==this.aJ||"excatalog"===d.storeType||!Ac||Ac.isUpgraded?6!==this.aJ&&(Ac&&(this.hZd(Ac),Ac.LZ.purge(!1)),this.nt.insertOsfControl(this.Zkd(d,n,B,Ib)),Ac&&this.nt.ownerAddinControlRecreated(d.solutionId,d.storeType)):(this.Nyc.qUj(Ac.pE),Ib(!0,d,null,Ac.displayName))}catch(Ac){F.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Ac.message)),Ib(!1,d,null,null)}else Ib(!1,d,null,null)}}lFn(d,n,B,Q,ha,Aa){const bb=(Ib,oc,Ac,ad)=>{Aa(Ib,oc,Ac,ad);Ib=le[this.aJ]+oc.solutionId;({value:oc}=this.y3b.Nc(Ib)).returnValue&&(oc.stop(),
this.y3b.remove(Ib))};if(6===this.aJ&&d)if(F.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.mgk(d))try{if(this.dX){const oc=le[this.aJ]+d.solutionId,Ac=this.dX.rg("ComponentAttach",oc);this.y3b.W(oc,Ac)}const Ib=this.Lfb.Qkc(d.storeType,d.solutionId);Ib||bb(!1,d,null,null);G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb.Pii?
this.Dxi(d,n,Q,ha,B,oc=>{bb(oc,d,B,Ib.displayName)}):(this.Dxi(d,n,Q,ha,B),bb(!0,d,B,Ib.displayName))}catch(Ib){F.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Ib.message)),bb(!1,d,null,null)}else bb(!1,
d,null,null)}Y0n(d,n,B,Q,ha,Aa){if(Aa)if(Aa._isAddinCommandsManifest(this.e8.M1))try{G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb.Pii?this.Cxi(d,n,B,ha,Aa,bb=>{Q(bb,d,Aa,Aa.getDefaultDisplayName())}):(this.Cxi(d,n,B,ha,Aa),Q(!0,d,Aa,Aa.getDefaultDisplayName()))}catch(bb){F.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,bb.message)),Q(!1,d,Aa,Aa.getDefaultDisplayName())}else F.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),Q(!1,
d,null,null);else F.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.e8.M1,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),Q(!1,d,null,null)}Zkd(d,n,B,Q){const ha={},Aa=document.createElement("div");Aa.setAttribute("visible","false");ha.div=Aa;ha.id=d.solutionId;ha.solutionId=d.solutionId;
ha.version=d.version;ha.storeType=d.storeType;ha.storeId=d.storeId;ha.assetId=d.assetId;ha.assetStoreId=d.assetStoreId;ha.isvirtualOsfControl=!0;ha.virtualOsfControlActivationCallback=(bb,Ib)=>{const oc=this.Lfb.Qkc(d.storeType,d.solutionId);oc&&(oc.isUpgraded&&(d.isUpgraded=!0),this.hZd(oc));this.Y0n(d,n,B,Q,bb,Ib)};ha.reason=3===this.aJ?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return ha}Cxi(d,n,B,Q,ha,Aa=null){const bb=
{};bb.solutionId=Q.getSolutionId();bb.version=Q.getVersion();bb.storeType=Q.getStoreType();bb.storeId=Q.getStoreId();bb.assetId=Q.getAssetId();bb.assetStoreId=Q.getAssetStoreId();bb.targetType=Q.getOsfControlType();let Ib=null,oc=null;if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ib=(new OfficeExt.Parser.AddinCommandsManifestParser(this.e8.M1,this.e8.formFactor)).parseExtensions(bb,ha,this.ifc),oc=gj.BEi(this.e8.M1);
else try{Ib=(new OfficeExt.Parser.AddinCommandsManifestParser(this.e8.M1,this.e8.formFactor)).parseExtensions(bb,ha,this.ifc),oc=gj.BEi(this.e8.M1)}catch(ad){throw F.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+ad.message),ad;}if(oc&&0<oc.count){if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Ac=n(d);n=B(d);B=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AddinCommandsMultipleCustomTabsEnabled");
Ac=new Gh(Ac,null,n);for(const ad of oc)Ac.commandSurface=ad,Ib.apply(Ac,this.ifc,B)}else try{const ad=n(d),sd=B(d),wd=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AddinCommandsMultipleCustomTabsEnabled");Ac=new Gh(ad,null,sd);for(const yd of oc)Ac.commandSurface=yd,Ib.apply(Ac,this.ifc,wd)}catch(ad){throw F.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+ad.message),ad;}if(OSF.OUtil.checkFlight(14))try{const ad=Ac.pJf(d.solutionId,ha.getDefaultDisplayName()),
sd=Ac.cxi();ad&&this.Nyc.Uec(ad,Aa);sd&&this.Suf.pSh(sd);this.Lfb.$Sh(Q,ad,sd,ha.getDefaultDisplayName());F.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",ha.getDefaultDisplayName())}catch(ad){throw OfficeExt.DevConsole.log(ad),F.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+ad.message),ad;}else try{const ad=Ac.pJf(d.solutionId,ha.getDefaultDisplayName()),sd=Ac.cxi();ad&&this.Nyc.Uec(ad);sd&&this.Suf.pSh(sd);this.Lfb.$Sh(Q,ad,sd,ha.getDefaultDisplayName());
F.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",ha.getDefaultDisplayName())}catch(ad){throw F.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+ad.message),ad;}}}Dxi(d,n,B,Q,ha,Aa=null){const bb={};bb.solutionId=d.solutionId;bb.version=d.version;bb.storeType=d.storeType;bb.storeId=d.storeId;bb.assetId=d.assetId;bb.assetStoreId=d.assetStoreId;bb.targetType=d.targetType;const Ib=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.e8.M1,this.e8.formFactor);
try{const oc=n.getManifest(),Ac=Ib.parse(bb,oc,ha,this.ifc,n.getSharedRuntimeId(),n),ad=B(d),sd=Q(d),wd=new Gh(ad,null,sd);wd.commandSurface="PrimaryCommandSurface";Ac.apply(wd,this.ifc,!0);if(wd.ribbonBuilder.qL&&0<wd.ribbonBuilder.qL.count){const yd=wd.pJf(d.solutionId,n.getManifest().getDefaultDisplayName(),1);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.Nyc.Uec(yd,Aa):yd&&this.Nyc.Uec(yd,Aa);this.Lfb.n3k(n,yd,ha,
n.getManifest().getDefaultDisplayName());F.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",n.getManifest().getDefaultDisplayName())}}catch(oc){F.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",n.getManifest().getDefaultDisplayName(),oc.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(oc)}}hZd(d){d.pE&&this.Nyc.Wvg(d.pE);d.FZc&&this.Suf.ZFo(d.FZc);this.Lfb.uFo(d.LZ.getStoreType(),d.LZ.getSolutionId())}Cxl(d,n){n=mh(n);
for(const B of this.Lfb.tpc){if(B.LZ.getStoreType()!==n)continue;let Q=!0;for(const ha of d){const Aa=ha;if(Aa&&B.b7i(Aa.storeType,Aa.solutionId)){Q=!1;break}}Q&&(this.hZd(B),B.LZ.purge(!1))}}mgk(d){return!!d&&!!d.solutionId&&!!d.version&&!!d.storeType&&!!d.storeId}}Object(D.a)(aj,"AddInCommandsIntegration",null,[]);class ck{constructor(d,n,B,Q,ha,Aa,bb,Ib=null){this.sa=new dc.a;this.SRa=d;this.Vxk=n;this.Bk=B;this.lOh=Q;this.Vbc=ha;this.Ksk=Aa;this.Jzd=bb;this.qMk=Ib}p6k(d){this.sa.addHandler(gf.a.tVh,
d)}L6k(d){this.sa.addHandler(gf.a.qaj,d)}U8k(d){this.sa.addHandler(gf.a.FZj,d)}x6k(d){this.sa.addHandler(gf.a.anf,d)}GFn(d,n,B){const Q=B[gf.a.cVd],ha=void 0===B[gf.a.eKa]?0:B[gf.a.eKa];if(Q&&0!==ha)if(0>=Q.count&&4!==ha)this.Pzj(new wi(ha,null,null,n,null,!0));else{var Aa=Q.count,bb=new vh(new Wg),Ib=void 0===B[gf.a.fKa]?-1:B[gf.a.fKa],oc=new aj(ha,this.Bk,this.SRa,bb,this.Vxk,this.Vbc,this.Jzd),Ac=be=>this.lOh.znl(be.solutionId,this.Jzd,this.SRa,d),ad=be=>this.lOh.uml(be.solutionId),sd=(be,ye,Qe)=>
{Aa--;Qe=new wi(ha,ye,bb,n,Qe,0>=Aa);if(be&&ye)this.Pzj(Qe);else{if(3===ha||ye&&ye.isUpgraded)be="",ye&&(be=Telemetry.PrivacyRules.GetPrivacyCompliantId(ye.solutionId,ye.ownerAddinStoreType||ye.storeType,ye.assetId,null,null,ye.storeId)),ye={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:be},cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zf.a.iG(ye)}));this.Ozj(Qe)}Aa||G.AFrameworkApplication.ta.Ne()},
wd=(be,ye,Qe,af)=>{sd(be,ye,af)},yd=()=>{this.qgg();0>=Q.count&&4===ha&&this.Vbc.MCg()};6===ha?(Ib=B[gf.a.t4l],B=B[gf.a.u4l],oc.lFn(Q.K(0),Ib,B,Ac,ad,(be,ye,Qe,af)=>{sd(be,ye,af)})):oc.cFn(Q,Ac,ad,Ib,wd,yd,this.qMk)}else cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zf.a.iG({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),F.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.SRa.M1)),this.Ozj(new wi(ha,null,null,n,null,!0))}Ozj(d){this.qgg(d);this.E_j(!1,d)}Pzj(d){const n=d.Nr;let B=null;null!==n&&(B=n.storeType,B=B.toLowerCase());if(d&&"omex"===B&&(3===d.aJ||n.isUpgraded)){var Q={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId)};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:zf.a.iG(Q)}))}this.qgg(d);Q=Vj()&&"omex"===B&&!!d.VFa&&!!n.solutionId&&2===d.aJ&&n.solutionId.toLowerCase()===Bj().toLowerCase();var ha="excatalog"===B&&3===d.aJ;if("omex"===B&&d.VFa&&(3===d.aJ&&"hardcodedpreinstall"!==B||n.isUpgraded)||Q||ha)Q=new xe,Q.Nr=n,Q.pE=d.VFa.WWb,this.sa.raiseEvent(gf.a.anf,Q);Q=Bl();ha=Bj();Q&&n&&"excatalog"===n.storeType&&d.VFa&&5===d.aJ&&ha&&(n.storeId&&n.storeId.toLowerCase()===ha.toLowerCase()||n.assetId&&n.assetId.toLowerCase()===ha.toLowerCase())&&(Q=new xe,
Q.Nr=n,Q.pE=d.VFa.WWb,this.sa.raiseEvent(gf.a.anf,Q),F.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));n&&(kl.instance.jSj(xf(B),!0),"uploadfiledevcatalog"===B&&(Q=this.Ksk.createAddinDataProvider(B,this.Bk))&&Q.localCacheAddinCommands(this.Bk.u0a,n.solutionId,n.version,n.storeId),$i.FCb(gf.a.Vjf,"true",xf(B)));this.E_j(!0,d)}E_j(d,n){d?n.VFa&&5===n.aJ&&n.VFa.WWb&&void 0!==n.Nr.showCallout&&null!==n.Nr.showCallout&&n.Nr.showCallout?((new pi(this.sa)).pUd(n.Nr,Kb.u4c(n.VFa.WWb)),
d=new xe,d.pE=n.VFa.WWb,d.Nr=n.Nr,this.sa.raiseEvent(gf.a.FZj,d)):3!==n.aJ?n.F$i&&this.Vbc.MCg():n.VFa&&n.VFa.WWb&&"hardcodedpreinstall"!==n.Nr.storeType&&kd.qdp(n.displayName,n.VFa.WWb,n.Nr.isAutoLaunched):3===n.aJ?n.Nr&&"uploadfiledevcatalog"===n.Nr.storeType.toLowerCase()?(n=this.Jzd.cym(n.Nr.solutionId),kd.AGg(n?n:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.Vbc.q0o():n.F$i&&this.Vbc.MCg()}qgg(d=null){var n=d?d.Nr:null;const B=new xe;if(B.Nr=n){var Q=this.Vbc.Qkc(n.storeType,
n.solutionId,6===d.aJ?1:0);if(Q&&Q.pE){B.pE=Q.pE;var ha=Bj();ha=Vj()&&!!n.solutionId&&!!ha&&n.solutionId.toLowerCase()===ha.toLowerCase()&&2===d.aJ;if(3===d.aJ&&"hardcodedpreinstall"!==n.storeType||ha)d="",Q.pE.dFa&&Q.pE.dFa.qL&&(Q=Q.pE.dFa.qL.K(0))&&(d=Q.id),n={["SDX_CommandPlacement"]:d,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId)},cg.a.sendTelemetryEvent(Object.assign(new $h.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:zf.a.iG(n)}))}}this.sa.raiseEvent(gf.a.tVh,B)}}Object(D.a)(ck,"LaunchAddinCommandsHandler",null,[1953]);class yk{constructor(d){this.TNk=d}get u0a(){return this.TNk}insertOsfControl(d){return this.u0a.insertOsfControl(d)}getManifestInvaildErrorString(){return this.u0a.getManifestInvaildErrorString()}isAddinCommandsAsync(d,n){this.u0a.isAddinCommandsAsync(d,n)}isAddinCommandsExAsync(d,n){this.u0a.isAddinCommandsExAsync(d,n)}ownerAddinControlRecreated(d,
n){this.u0a.ownerAddinControlRecreated(d,n)}queryEntitlementDetails(d){this.u0a.queryEntitlementDetails(d)}}Object(D.a)(yk,"ContextActivationMgrWrapper",null,[1956]);class eh{}eh.uib="Alt";eh.S3a="Command";eh.id="Id";eh.zib="Image16by16";eh.Aib="LabelText";eh.V3a="Title";eh.fLe="Groups";eh.DDb="Controls";eh.button="Button";eh.mMa="FlyoutAnchor";Object(D.a)(eh,"AddinDataNodeConstants",null,[]);class vg{constructor(d,n){this.i6a=this.Thh=null;if(Ic.c(d)||Ic.c(n))throw F.ULS.sendTraceTag(9175312,220,
10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.vRe=n;this._id=d;this.c1[eh.id]=this._id}get id(){return this._id||""}get c1(){return this.Thh||(this.Thh={})}get controlType(){return this.vRe||""}get menuItems(){return this.i6a||(this.i6a=new ma.a)}avd(){let d=null;this.vRe===eh.mMa?d=Object.assign(new ub.a,{Menu:this.ZSn()}):this.vRe===eh.button&&(d=Object.assign(new Ka.a,{}));d&&(this.c1[eh.id]&&
(d.ExternalId=this.c1[eh.id]),this.c1[eh.S3a]&&(d.Command=this.c1[eh.S3a].toString()),this.c1[eh.Aib]&&(d.LabelText=this.c1[eh.Aib]),this.c1[eh.uib]&&(d.Alt=this.c1[eh.uib]),this.c1[eh.zib]&&(Xa.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.c1[eh.zib]),d.ExternalImageId=this._id));return d}ZSn(){const d=Object.assign(new qb.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.i6a){const n=Object.assign(new ab.a,{ControlList:[]});for(const B of this.i6a)Array.add(n.ControlList,
B.avd());Array.add(d.MenuSectionList,n)}return d}}Object(D.a)(vg,"ControlDefinition",null,[1922]);class tm{constructor(d){this.Xza=null;if(Ic.c(d))throw F.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=d;this.vgd[eh.id]=this._id}get vgd(){return this.Xza||(this.Xza={})}get id(){return this._id||""}avd(){const d=Object.assign(new Ka.a,{});this.Xza[eh.id]&&(d.ExternalId=this.Xza[eh.id]);
this.Xza[eh.S3a]&&(d.Command=this.Xza[eh.S3a].toString());this.Xza[eh.Aib]&&(d.LabelText=this.Xza[eh.Aib]);this.Xza[eh.uib]&&(d.Alt=this.Xza[eh.uib]);this.Xza[eh.zib]&&(Xa.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Xza[eh.zib]),d.ExternalImageId=this._id);return d}}Object(D.a)(tm,"MenuItemDefinition",null,[1923]);class Cm{constructor(d){this.xSa=null;if(Ic.c(d))throw F.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),
Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=d}get id(){return this._id}get controls(){return this.xSa||(this.xSa=new ma.a)}avd(){const d=[];if(this.xSa)for(const n of this.xSa){const B=n.avd();B&&d.push(B)}return d}}Object(D.a)(Cm,"OfficeMenuDefinition",null,[1921]);class Fj{constructor(d,n,B){this.uaa=this.j8b=null;this.l4e=d;this.I7b=n;this.o6b=B;this.TKk=new ma.a}get doe(){return this.l4e}get RYc(){return this.I7b}get Tgf(){return this.o6b}addButton(d){F.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",d.actionType);this.uaa=new vg(this.qpb(d.id),eh.button);this.uaa.c1[eh.Aib]=d.label;this.uaa.c1[eh.uib]=d.label;this.uaa.c1[eh.zib]=d.icon["16"];this.LWc(this.uaa.c1[eh.id],d.action);this.DMb(this.uaa.c1);this.j8b.controls.add(this.uaa);this.uaa=null}startBuildMenu(d){if(Ic.c(this.j8b))this.j8b=new Cm(d.id);else{const n=this.qpb(d.id);this.uaa=new vg(n,eh.mMa);this.wgc(this.uaa.c1,d);this.uaa.c1[eh.zib]=d.icon["16"];this.uaa.c1[eh.S3a]=Z.a.Ssa}}addMenuItem(d){F.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",d.actionType);const n=new tm(this.qpb(d.id));this.wgc(n.vgd,d);d.icon&&(n.vgd[eh.zib]=d.icon["16"]);this.LWc(n.vgd[eh.id],d.action);this.DMb(n.vgd);this.uaa.menuItems.add(n)}endBuildMenu(){Ic.c(this.uaa)?(this.ene.add(this.j8b),this.j8b=null):(this.j8b.controls.add(this.uaa),this.uaa=null)}get ene(){return this.TKk}LWc(d,n){this.Tgf.bindAction(d,n)}DMb(d){this.RYc.DMb(d)}qpb(d){return this.doe.Xlc(d)}wgc(d,n){d[eh.Aib]=n.label;d[eh.uib]=n.label}}Object(D.a)(Fj,
"ContextMenuExtensibilityCreator",null,[1900,1897]);class hj{constructor(d){this.LOc=d}get Vgd(){return this.LOc}Xlc(d){return this.Vgd+d}}Object(D.a)(hj,"DefaultContextMenuNamingProvider",null,[1901]);class wg{constructor(d,n,B,Q){this.LOc=d;G.AFrameworkApplication.J.$("AddInCommandsMissingTabIsEnabled")&&B.EGm();this.cLh=n;this.FTk=Q}get Vgd(){return this.LOc}get solutionId(){return this.cLh}get NFg(){return this.FTk}Xlc(d){d=this.Vgd+this.solutionId+d;return this.NFg?(d in wg.fVd||(wg.fVd[d]="AddinControl"+
wg.o9k++),wg.fVd[d]):d}Bhi(d){if(this.NFg){const B=wg.fVd;for(const Q in B){var n=Q;if(d===B[Q])return n.substr(this.Vgd.length+this.solutionId.length)}}return d}sTm(d){d=this.Vgd+this.solutionId+d;return this.NFg?(d in wg.gkf||(wg.gkf[d]="AddinTab"+wg.w9k++),wg.gkf[d]):d}}wg.fVd={};wg.gkf={};wg.w9k=0;wg.o9k=0;Object(D.a)(wg,"DefaultRibbonNamingProvider",null,[1899]);class Od{bindAction(d,n){OfficeExt.DefaultControlActionBinder.bindAction(d,n)}}Object(D.a)(Od,"DefaultUIControlActionBinder",null,[1898]);
class zg{constructor(d){this.LEb=d}get command(){return this.LEb}DMb(d){d[eh.S3a]=this.command}}Object(D.a)(zg,"DefaultUIControlCommandBinder",null,[1895]);var nh=e(50);class Vi{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(D.a)(Vi,"AddInControl",null,[]);class he{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(D.a)(he,"AddInGroup",null,[]);class td{constructor(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(D.a)(td,"AddInMenuItem",null,[]);class kh{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(D.a)(kh,"AddInTab",null,[]);class eg{constructor(d,n,B,Q,ha,Aa){this.Ezd=new ma.a;this.rIc=this.F4a=this.m8b=null;this.l4e=d;this.o6b=n;this.I7b=B;this.cLh=Q;this.Jzd=ha;this.Cmh=Aa}get doe(){return this.l4e}get qL(){return this.Ezd}get Tgf(){return this.o6b}get RYc(){return this.I7b}startBuildTab(d){const n=
d.isOfficeTab?d.id:this.doe.sTm(d.id),B=d.isOfficeTab?null:d.label;this.m8b=Object.assign(new kh,{id:n,title:B,isOfficeTab:d.isOfficeTab,visible:d.visible,groups:[],tabType:d.tabType,insertBefore:d.insertBefore,insertAfter:d.insertAfter,autoFocus:d.autoFocus})}startBuildGroup(d){const n=this.qpb(d.id);this.F4a=Object.assign(new he,{id:n,mlrId:d.mlrId,title:d.label,controls:[],groupType:0})}addNativeGroup(d){this.F4a=Object.assign(new he,{id:d.id,mlrId:d.mlrId,title:d.label,controls:[],groupType:1});
this.m8b.groups.push(this.F4a)}addButton(d){const n=this.qpb(d.id);n&&(this.LWc(n,d.action),F.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",d.actionType),d=Object.assign(new Vi,{id:n,title:d.label,iconLocation:this.INf(d),enabled:d.enabled,controlType:0,attributes:this.wgc()}),this.Cmh.PRh(new nh.a(n,this.RYc.command.toString())),this.F4a.controls.push(d))}addNativeControl(d){d.id&&(F.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
d.actionType),d=Object.assign(new Vi,{id:d.id,title:"",iconLocation:"",enabled:d.enabled,controlType:2,attributes:this.wgc()}),this.F4a.controls.push(d))}startBuildMenu(d){const n=this.qpb(d.id);n&&(this.rIc=Object.assign(new Vi,{id:n,title:d.label,iconLocation:this.INf(d),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(d){const n=this.qpb(d.id);n&&(this.LWc(n,d.action),F.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",d.actionType),d=Object.assign(new td,
{id:n,title:d.label,iconLocation:this.INf(d),enabled:d.enabled,attributes:this.wgc()}),this.Cmh.PRh(new nh.a(n,this.RYc.command.toString())),this.rIc.menuItems.push(d))}endBuildMenu(){Ic.c(this.rIc.id)||this.F4a.controls.push(this.rIc);this.rIc=null}endBuildGroup(){Ic.c(this.F4a.id)||this.m8b.groups.push(this.F4a);this.F4a=null}endBuildTab(){Ic.c(this.m8b.id)||this.Ezd.add(this.m8b);this.m8b=null}wgc(){const d={};this.DMb(d);return d}INf(d){return d.icon["80"]?d.icon["80"]:d.icon["32"]}DMb(d){this.RYc.DMb(d)}qpb(d){return this.doe.Xlc(d)}LWc(d,
n){this.Tgf.bindAction(d,n)}}Object(D.a)(eg,"OneLineRibbonExtensibilityCreator",null,[1896,1897]);class li{constructor(d,n){this.LOc=d;this.o6b=new Od;this.I7b=new zg(n)}uml(d){d=new hj(d);return new Fj(d,this.I7b,this.o6b)}znl(d,n,B,Q){B=new wg(this.LOc,d,B,!0);return new eg(B,this.o6b,this.I7b,d,n,Q)}}Object(D.a)(li,"UIExtensibilityFactory",null,[1883]);class Ll{createAddinDataProvider(d,n){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(d,n.u0a)}static get instance(){Ll._instance||
(Ll._instance=new Ll);return Ll._instance}}Ll._instance=null;Object(D.a)(Ll,"OSFAddinDataProviderFactory",null,[1952]);class mi{constructor(){this.jfc=null}setErrorMessageForAddin(d,n){this.jfc||(this.jfc={});this.jfc[d]=n}cym(d){return this.jfc&&d in this.jfc?this.jfc[d]:null}}Object(D.a)(mi,"AddinCommandsErrorManager",null,[]);class Ek{constructor(){this.Mha=0;this.qXc=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.TTi=!1;this.n$m=this.Wta=null}}Object(D.a)(Ek,"AddInCommandsNotificationParameters",
null,[]);class Ml{constructor(){this.ieh=this.NMe=null;this.uWi=(d,n)=>{let B=null;B=()=>{d.getIsUpgrading()?window.setTimeout(B,1E3):d.getUpgradingFailed()?Wg.QAe(n,!0):G.AFrameworkApplication.ta.Ne()};window.setTimeout(B,1E3)}}get Ugf(){return this.NMe||(this.NMe=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Ugf(d){this.NMe=d}get cil(){return this.ieh||(this.ieh=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(d,
n){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(d,n)}J_m(d,n,B,Q,ha){F.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",d);if((d=n.Qkc(ha.ownerAddinInfo.storeType,ha.ownerAddinInfo.solutionId))&&d.LZ&&!d.LZ.getIsUpgrading())if(n=null,0<d.LZ.getNotificationParams().length&&(n=this.R1h(d.LZ.getNotificationParams()[0]))&&2147758681===n.errorCode&&(d.isUpgraded=!0),2!==d.LZ.getStatus()&&(1!==d.LZ.getStatus()||n&&2147758681===n.errorCode))n&&this.AZj(d,n,null);
else try{B.setOwnerAddinEToken(d.LZ.getEToken()),ha.action(B,Q.u0a)}catch(Aa){F.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Aa.stack:Aa.message)),kd.AGg(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}AZj(d,n,B=null){const Q=d.LZ;if(1===Q.getNotificationParams().length||n.TTi){const ha=n.qXc,Aa=n.Wta;n.qXc=()=>{Q.removeFirstNotification();
if(0<Q.getNotificationParams().length){const bb=this.R1h(Q.getNotificationParams()[0]);this.AZj(d,bb)}2147758681===n.errorCode&&(Wg.K_l(d.pE,Q,this.uWi),hc.z_l(d.FZc,Q,this.uWi));ha&&ha()};n.Wta=()=>{Aa&&Aa();B&&B()};kd.Ycp(n)}}R1h(d){const n=new Ek;n.Mha=d.infoType;n.id=d.id;n.title=d.title;n.description=d.description;n.buttonText=d.buttonTxt;n.qXc=d.buttonCallback;n.TTi=d.highPriority;n.Wta=d.dismissCallback;n.errorCode=d.errorCode;n.n$m=d.iframeNotificationUrl;return n}}Object(D.a)(Ml,"AddinCommandsActionHandler",
null,[1948]);var Qk=e(1263);class km{constructor(){this.aJ=this.hfb=0;this.Wjf=null;this.Jue=this.QGe=0;this.Ajb=this.eWe=this.kNe=null}get eVd(){this.kNe||(this.kNe=new ma.a);return this.kNe}get NIf(){this.eWe||(this.eWe=new ma.a);return this.eWe}get OOb(){this.Ajb||(this.Ajb=new ma.a);return this.Ajb}}Object(D.a)(km,"AddinCommandsListLoaderContext",null,[]);class $l{constructor(d,n){this.entitlement=d;this.metadata=n}NCc(){var d=this.entitlement;const n={};n.solutionId=d.solutionId;n.version=d.version;
n.storeType=d.storeType;n.storeId=d.storeId;n.assetId=d.assetId;n.assetStoreId=d.assetStoreId;n.targetType=d.targetType;n.requireConsent=d.requireConsent||!1;n.isAddinCommands=!0;n.addinCommandsActionType=0;n.targetType=this.targetType;return n}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(D.a)($l,"AddinEntitlementEx",null,[]);class ll extends Sys.EventArgs{constructor(d){super();this.properties=d}}Object(D.a)(ll,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class tk{constructor(d,n,B){this.vd=new dc.a;this.context=
new km;this.Zcf=null;this.q6n=(Q,ha,Aa,bb)=>{Q?(Q=new $l(Aa.targetData,bb),ha&&this.context.eVd.add(Q),10===this.context.hfb&&(this.context.NIf.add(Q),0===Q.targetType&&this.context.OOb.add(Q))):(ha=Aa.targetData,F.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ha.solutionId,ha.storeType,ha.assetId,null,null,ha.storeId),ha.storeType));this.dhg()};this.contextActivationMgr=d;this.p9k=n;this.dVd=B;this.appName=G.AFrameworkApplication.J.rb("WebAppShortName")}get t5j(){this.Zcf||
(this.Zcf=new pi(this.vd));return this.Zcf}o6k(d){this.vd.addHandler(gf.a.sVh,d)}Eyp(d){null!==d&&(this.context.hfb=d[gf.a.fKa],this.context.aJ=d[gf.a.eKa],this.context.QGe=this.context.Jue=0,d=gf.a.mfc in d?d[gf.a.mfc]:0,-1!==this.context.hfb&&0!==this.context.aJ&&(this.context.Wjf=this.p9k.createAddinDataProvider(mh(this.context.hfb),this.contextActivationMgr),this.context.Wjf?this.context.Wjf.getEntitlementsAsync(this.contextActivationMgr.u0a,!0,d,n=>{this.N6n(n)}):F.ULS.sendTraceTag(17638145,
220,10,"Create AddinDataProvider fails for {0}",this.context.hfb)))}N6n(d){if(d&&0<d.length){this.context.QGe=d.length;const B=Bj();for(let Q=0;Q<d.length;Q++){const ha=d[Q];if(Vj()&&ha&&ha.storeType&&"omex"===ha.storeType.toLowerCase()&&ha.assetId&&B&&ha.assetId.toLowerCase()===B.toLowerCase()){var n={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:tk.E1(ha)};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zf.a.iG(n)}))}!ha||1!==ha.targetType&&
-1!==ha.targetType?this.dhg():(n={},G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(n.solutionId=ha.solutionId,n.version=ha.version):(n.marketplaceId=ha.solutionId,n.marketplaceVersion=ha.version),n.storeType=ha.storeType,n.storeId=ha.storeId,n.targetData=ha,this.contextActivationMgr.isAddinCommandsExAsync(n,this.q6n))}}else this.dhg()}dhg(){var d;(d=this.context).Jue=d.Jue+1;this.context.Jue>=this.context.QGe&&
(this.dVd.jSj(this.context.hfb,!1),0<this.context.QGe&&10===this.context.hfb&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(d=!1,Bl()&&(d=this.TKn(this.context.NIf)),this.ZJn(this.context.NIf),d?this.f1a(this.K$h(this.context.eVd)):this.t5j.lDc(this.contextActivationMgr,this.context.eVd,this.context.OOb,(n,B)=>{const Q=new ma.a;for(const ha of n)n=ha.NCc(),B&&B.solutionId===ha.solutionId&&(n.showCallout=!0,this.t5j.Gdk(B)),Q.add(n);this.f1a(Q)})):this.f1a(this.K$h(this.context.eVd)))}K$h(d){const n=
new ma.a;if(d)for(const B of d)n.add(B.NCc());return n}f1a(d){d&&d.count||$i.FCb(gf.a.Vjf,"false",this.context.hfb);d={["ack2"]:d};d[gf.a.fKa]=this.context.hfb;d[gf.a.eKa]=this.context.aJ;this.vd.raiseEvent(gf.a.sVh,new ll(d),this)}TKn(d){let n=!1;if(d&&1>d.count)return n;const B=Bj();if(!B)return n;for(const Q of d)if(Q.storeId&&Q.storeId.toLowerCase()===B.toLowerCase()||Q.assetId&&Q.assetId.toLowerCase()===B.toLowerCase())d={["SDX_Id"]:tk.bKi(Q),["SDX_TargetType"]:Ic.c(Q.targetType)?"":Q.targetType.toString()},
cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:zf.a.iG(d)})),n=!0;return n}ZJn(d){if(!(d&&1>d.count))if(this.dVd.bun()){var n=this.dVd.XMm();n?(d=this.EBi(d,n),F.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(d=this.EBi(d,null),F.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.dVd.s4o(d)}else F.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}EBi(d,n){const B={};let Q=!1;for(const ha of d)if(d=
tk.bKi(ha))!n||d in n||(this.mR(ha,d),F.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===d.toLowerCase()?Q||(Q=!0,B[d]=null):B[d]=null;return B}mR(d,n){var B=d.installTimeInMS?(new Date(d.installTimeInMS)).toISOString():"";B={["SDX.Id"]:n,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ic.c(d.targetType)?"":d.targetType.toString(),["SDX.AdminDeploymentTime"]:B};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:zf.a.iG(B)}));1===d.targetType&&(d={["SDX.Id"]:n,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:zf.a.iG(d)})))}static E1(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static bKi(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}}Object(D.a)(tk,
"AddInCommandsListLoader",null,[]);var am;(function(d){d[d.Jee=0]="inactive";d[d.background=1]="background"})(am||(am={}));Object(D.b)("AppBackgroundState",am);var bf=e(7),Cj=e(133),Wh=e(80),zk=e(257);class Hl{}Hl.text=1;Hl.image=2;Hl.table=4;Object(D.a)(Hl,"ContentCatagory",null,[]);class Xf{}Object(D.a)(Xf,"AddinCommandsHost",null,[]);class we extends Ea.a{constructor(){super(void 0,void 0,void 0,!0);this.bJc="AddinCommandsUILessDialog";this.Ndf="WACDialogTitleText";this.$ya="0";this.s3=380;this.U_=
190;this.$g=this.bJc;this.Md=5;this.Axk=String.format("{0}px",this.s3);this.Zya=String.format("{0}px",this.U_);this.gSi=this.hv=!1;this.QW()}QW(){super.QW();this.zr.style.width=this.Axk;this.zr.style.height=this.Zya;this.zr.style.padding=this.$ya}a2a(d){this.JP();document.getElementById(this.Vj(this.Ndf)).innerText=d}JP(){super.JP();this.Yc.style.width=String.format("{0}px",this.s3);this.Yc.style.height=String.format("{0}px",this.U_);this.Yc.removeAttribute(cc.a.fi);this.Yc.removeAttribute(cc.a.Iba)}hide(){this.Kde()}get jrb(){return this.zr}initializeAndShowWithTitle(){this.ti(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(D.a)(we,"AddinCommandsUILessDialog",Ea.a,[1957]);class Rk extends Xf{constructor(d,n){super();this.Ai=d;this.aMd=n}setOwnerAddinEToken(d){this.aMd.eToken=d}showTaskpane(d,n,B){F.ULS.sendTraceTag(19507426,220,50,"ShowTaskpane action called.");n=this.cnl(d,this.aMd,n);n.addinCommandsActionType=2;this.Ai.VUb(n);(d=this.Ai.Z$a(d.solutionId))?(B(d,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),G.AFrameworkApplication.J.isChangeGateEnabled("TelemetryForActiveAddinSuccessOnWordWacEnabled")&&
F.ULS.sendTraceTag(526410901,220,50,"ShowTaskpane: succeed to call.")):(F.ULS.sendTraceTag(19507427,220,10,"ShowTaskpane: instance id is null."),B(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}showDialog(){}createUILessSandbox(d,n,B){F.ULS.sendTraceTag(19509248,220,50,"UILess action called.");var Q=d.solutionId,ha=this.aMd.solutionId;const Aa=this.getSharedRuntimeId(n,!0,Q,ha);Q=Aa?ha:Q;ha=this.Ai.Z$a(Q);ha||(d=this.cml(d,this.aMd),d.addinCommandsActionType=3,d.isForUILessAction=!0,
d.sharedRuntimeId=Aa,d.solutionId=Q,n=n.getDefaultDisplayName(),Rk.Udc.W(d.id,new we),d.div=Rk.Udc.K(d.id).jrb,this.Ai.createUILessSandbox(Q,n,d),ha=this.Ai.Z$a(Q));ha?B(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(F.ULS.sendTraceTag(19509249,220,10,"UILess: instance id is null."),B(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}disposeHost(){}cnl(d,n,B){const Q={};Q.solutionId=d.solutionId;Q.version=d.version;Q.storeType=d.storeType;Q.storeId=d.storeId;Q.assetId=d.assetId;Q.assetStoreId=
d.assetStoreId;Q.targetType=OSF.OsfControlTarget.TaskPane;Q.displayName=B.getDefaultDisplayName();Q.ownerAddinSolutionId=n.solutionId;Q.ownerAddinStoreType=n.storeType;Q.isAddinCommands=!0;Q.sharedRuntimeId=this.getSharedRuntimeId(B,!1,d.solutionId,n.solutionId);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring")&&Q.sharedRuntimeId&&(Q.solutionId=Q.ownerAddinSolutionId,Q.storeType=Q.ownerAddinStoreType);return Q}getSharedRuntimeId(d,n,B,
Q){if(!d)return null;const ha=Wa.a.instance.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider");if(!ha)return null;if(n)return d.getSharedRuntimeId(ha.M1,n,null);B=(new wg("",Q,ha,!0)).Bhi(B.substr(Q.length));return d.getSharedRuntimeId(ha.M1,n,B)}cml(d,n){var B=Jh.a.create().toString();B=new Kk.a(B,d.solutionId,d.version,d.storeId,d.storeType,{});B.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;B.osfControlType=OSF.OsfControlTarget.TaskPane;B.assetId=d.assetId;B.assetStoreId=
d.assetStoreId;B.ownerAddinSolutionId=n.solutionId;B.ownerAddinStoreType=n.storeType;B.isAddinCommands=!0;return B}static wQa(d){Rk.Udc.Bb(d)&&Rk.Udc.K(d).initializeAndShowWithTitle()}static $Ma(d){Rk.Udc.Bb(d)&&Rk.Udc.K(d).hide()}}Rk.Udc=new ff.a;Object(D.a)(Rk,"Box4AddInCommandsHost",Xf,[]);class ml{constructor(d){this.VMb=this.hga=this.Nr=this.pE=null;this.eJj=this.yvg=0;this.XDb=this.appName=null;this.$eb=n=>{F.ULS.sendTraceTag(523319329,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
n?n.Xe:-1)};this.Yhf=d;this.appName=G.AFrameworkApplication.J.rb("WebAppShortName")||"Word"}static GetPrivacyCompliantId(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}B6n(){this.Nr&&this.VMb&&(this.Yhf.Gce({["SourceControlId"]:this.VMb}),F.ULS.sendTraceTag(529110620,220,50,"Launch addin command has been triggered"))}CGg(d,n){d=null;n?(d=n,this.Nr=d.Nr,(this.pE=d.pE)&&this.pE.dFa&&this.pE.dFa.qL&&(this.hga=this.pE.dFa.qL.K(0)),this.hga&&
this.hga.id?(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.sUj(),this.hga.isOfficeTab?(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)||this.sUj(),this.VMb?"TabHome"===this.hga.id?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Kb.u4c(this.pE),()=>{this.sDe(this.hbb(this.VMb))}):G.AFrameworkApplication.va.qa(Z.a.T2a,ed.a.application,Object(X.a)(this,
this.T2a,"tabSwitch2")):(this.mR("NoEnabledButtonFound"),F.ULS.sendTraceTag(529110623,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.Vtc())):this.Y_j(this.hbb(this.hga.id),0)):(this.mR("NoTabFound"),F.ULS.sendTraceTag(529110621,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.Vtc())):this.Vtc()}sUj(){const d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),n=this.Nr.solutionId;n in d?this.VMb=d[n]:(F.ULS.sendTraceTag(529110622,
220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",ml.GetPrivacyCompliantId(this.Nr)),this.VMb=this.MJf(this.pE))}T2a(d,n,B,Q,ha){this.hga.id.includes(ha.NewContextId)&&(G.AFrameworkApplication.va.Jz(Z.a.T2a,ed.a.application,Object(X.a)(this,this.T2a,"tabSwitch2")),this.N6h(ha.NewContextId,G.AFrameworkApplication.J.sc("AddinMaxTabSwitchDetectionTimesForTeachingUI",10)));return 32}N6h(d,n){if(0>=n)this.mR("TabSwitchTimeOut");else{var B=document.querySelector("button"+
this.hbb(d));B.hasAttribute("aria-selected")&&"false"!==B.getAttribute("aria-selected")?(window.clearTimeout(this.eJj),this.sDe(this.hbb(this.VMb))):this.eJj=window.setTimeout(()=>{this.N6h(d,n-1)},1E3)}}hbb(d){return"[id="+d+"]"}Y_j(d,n){n>G.AFrameworkApplication.J.sc("AddinMaxDOMElementDetectionTimesForTeachingUI",10)?(window.clearTimeout(this.yvg),this.Ysd("[data-unique-id='pivotOverflowButton']"),F.ULS.sendTraceTag(529110624,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time")):
document.querySelector("button"+d)?(window.clearTimeout(this.yvg),this.Ysd(d)):this.yvg=window.setTimeout(()=>{this.Y_j(d,n+1)},1E3)}sDe(d){let n=document.querySelector("button[data-unique-id='RightPaddle']");if(n)this.mR("RightPaddlePresent");else if(n=document.querySelector("button"+d),!n||"none"===window.getComputedStyle(n).display)if(n=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!n){this.mR("NoAnchor");F.ULS.sendTraceTag(529110625,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");
this.Vtc();return}this.BCb(n,"ShowTeachingUIForAddinButton")}Ysd(d){let n=document.querySelector("button"+d);if(!n&&("[data-unique-id='pivotOverflowButton']"!==d&&(n=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!n)){this.mR("NoAnchor");F.ULS.sendTraceTag(529110626,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.Vtc();return}this.BCb(n,"ShowTeachingUIForAddinTab")}BCb(d,n){d.setAttribute("lpp-id","latestAddin");const B=Wa.a.instance.Za("Common.ISystemInitiatedFeedback");
B&&d?(B.execute(Q=>{Q.logActivity(n,null)}),this.mR("Show"),F.ULS.sendTraceTag(529110656,220,50,"triggerLPPActivity triggered an LPP activity")):(this.mR("NoSifFutureObject"),F.ULS.sendTraceTag(529110627,220,15,"triggerLPPActivity failed to get a sifFuture"),this.Vtc())}MJf(d){if(d&&(d=d.dFa)&&d.qL&&0<d.qL.count)for(const n of d.qL)if(n.groups&&0<n.groups.length)for(const B of n.groups)if(B.controls&&0<B.controls.length)for(const Q of B.controls){if(Q.attributes&&!Q.controlType&&Q.enabled)return Q.id;
if(Q.menuItems)for(const ha of Q.menuItems)if(ha.attributes&&ha.enabled)return Q.id}}mR(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:[{name:"AppTeachingUICalloutAction",string:d},{name:"SDX.Id",string:ml.GetPrivacyCompliantId(this.Nr)},{name:"AppTeachingUICalloutGoal",string:"NewAdminDeployment"},{name:"SDX.AppInstallOrigin",string:"Organization"}]}))}wze(d){const n={},B={};B.LastTeachingUIShowTime=(new Date).toUTCString();B.AddinHasShown=
d;n[this.appName]=Rb.c(B);this.XDb=new hh(this.appName,null,null,this.$eb),this.XDb.A5d(n),F.ULS.sendTraceTag(523319328,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Vtc(){this.wze(window.g_roamingAddinList)}}Object(D.a)(ml,"AddinTeachingCalloutHandler",null,[]);var Nl=e(2009);class kk{constructor(d,n,B,Q,ha,Aa,bb,Ib=null){this.qRe=d;this.Bk=n;this.$3a=B;this.SRa=Q;this.TRk=ha;this.Ai=Aa;this.hm=Ib;this.Ai&&this.Ai.y7k(this.iyl.bind(this))}Yll(d,
n,B){if(d){switch(this.RQm(n,B)){case Hl.text:n="ContextMenuText";break;case Hl.image:n="ContextMenuImage";break;default:return}(n=this.qRe.vml(n))&&d.push(n)}}Cli(d){let n;switch(d){case 22:var B=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;n=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:B=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;n=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}B=new ka.a(B,n,null);B.id=d;B.image=1;B.closeable=
!0;G.AFrameworkApplication.ta.Pb.dBa(B,!0)||F.ULS.sendTraceTag(36790731,306,10,"Failed to add entry to business bar. Addin disabled message could not be shown to user.")}iXb(d){F.ULS.sendTraceTag(19507423,220,50,"LaunchAddInCommands log: {0}",{["HostType"]:this.SRa.M1,["LaunchOperationType"]:d[gf.a.eKa]});if(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")||!G.AFrameworkApplication.B8a){var n=d[gf.a.cVd];if(n&&0<n.count){const ha=n.count;for(let Aa=ha-1;0<=Aa;Aa--){const bb=n.K(Aa);
OSF.OsfControl.isFirstPartyStoreString(bb.storeType)||n.remove(n.K(Aa))}n.count<ha&&G.AFrameworkApplication.ta&&(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&!G.AFrameworkApplication.ta.Pb.s9(22)&&this.Cli(22),G.AFrameworkApplication.B8a||G.AFrameworkApplication.ta.Pb.s9(36)||this.Cli(36));if(!n.count)return}}let B=null;if(G.AFrameworkApplication.J.$("HostInstallAddInsIsEnabled")){const ha=this;B=new ck(this.SRa,this.qRe,new yk(this.Bk.value),new li("",Z.a.Nec),this.$3a,Ll.instance,
new mi,(Aa,bb)=>{const Ib=new Kk.a(Jh.a.create().toString(),Aa.solutionId,Aa.version,Aa.storeId,Aa.storeType,null);Ib.assetId=Aa.assetId;Ib.assetStoreId=Aa.assetStoreId;Ib.osfControlType=1;ha.Ai.a0j(Ib,()=>{bb(Aa)})})}else B=new ck(this.SRa,this.qRe,new yk(this.Bk.value),new li("",Z.a.Nec),this.$3a,Ll.instance,new mi);B.x6k(this.P1n.bind(this));B.p6k(this.C6n.bind(this));n=new ml(this);B.L6k(n.B6n.bind(n));B.U8k(n.CGg.bind(n));const Q=this;this.TRk.continueWith(()=>{try{Fe.a.get_instance().Zk(10,
null).continueWith(()=>{B.GFn(Q.hm,yg.StaticActiveAppFrame.Aa().Cua(),d)},3)}catch(ha){F.ULS.sendTraceTag(19507424,220,10,"LaunchAddInCommands failure log: {0}",{["HostType"]:Q.SRa.M1,["ExceptionMessage"]:ha.message})}},11)}P1n(d,n){n?n?Vj()||Bl()?(d=Wa.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper"))?d.q_f(()=>{Wa.a.instance.Za("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(B=>{B.n8d(n.Nr.solutionId)?this.vTg(n):F.ULS.sendTraceTag(512274763,220,15,"No ref for current add-in.")})}):
F.ULS.sendTraceTag(512274764,220,15,"initializeHelper isn't ready."):this.vTg(n):F.ULS.sendTraceTag(528544852,220,15,"agaveParams is null"):F.ULS.sendTraceTag(529110619,220,15,"No args for OnAutoLaunchAddin event")}F_m(d){var n=null;d&&(n=d[this.SRa.Fbi]);if(n){if(d=(new Ml).Ugf(n))return G.AFrameworkApplication.B8a||OSF.OsfControl.isFirstPartyStoreString(d.ownerAddinInfo.storeType);n='Failed to look up ActionContext for buttonId "'+n+'" in HandleAddInCommandsActionEnabled.'}else n="Failed to retrieve required buttonId property in HandleAddInCommandsActionEnabled.";
F.ULS.sendTraceTag(561816859,306,10,n);return G.AFrameworkApplication.B8a}Gce(d){let n=null;d&&(n=d[this.SRa.Fbi]);n?(d=new Ml,this.IUf(d,n)):F.ULS.sendTraceTag(561816861,306,10,"Failed to retrieve required buttonId property in HandleAddInCommandsAction.")}IUf(d,n){const B=d.Ugf(n);if(B){const Q=new Rk(this.Ai,B.ownerAddinInfo);d.J_m(n,this.$3a,Q,new yk(this.Bk.value),B);Nl.b.ZEc()&&B.ownerAddinInfo&&Nl.b.PZn(B.ownerAddinInfo)}else F.ULS.sendTraceTag(561816863,306,10,'Failed to look up ActionContext for buttonId "'+
n+'" in HandleAddInCommandsActionInternal.')}Nld(d){const n=Zk.jso(this.$3a);d[Qk.a.Visible]=n.visible;d[Qk.a.LabelText]=n.visible?n.labelText:""}FAc(){}get qT(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}Fro(d){if(d&&gf.a.fKa in d)if(this.Ai){var n=d[gf.a.fKa];this.qT?gf.a.hVd in d&&(d=d[gf.a.hVd],this.Ai.C0b(n,
d),1===d&&this.lU(n,!0)):this.lU(n,!0)}else F.ULS.sendTraceTag(508625026,220,10,"queryAddinDetailsWithActionData: abort because _appsForOfficeUiActor is null.");else F.ULS.sendTraceTag(509695234,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}lU(d,n=!1){this.Ai?(F.ULS.sendTraceTag(509695232,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",d,n),this.Ai.lU(d,n)):F.ULS.sendTraceTag(509695233,220,10,"QueryAddinDetails: abort because _appsForOfficeUiActor is null.")}zyc(d){F.ULS.sendTraceTag(19507425,
220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",d[gf.a.eKa],d[gf.a.fKa]);this.$3a.oZo();window.setTimeout(()=>{const n=new tk(new yk(this.Bk.value),Ll.instance,kl.instance);n.o6k((B,Q)=>{this.iXb(Q.properties);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.lU(d[gf.a.fKa])});n.Eyp(d)},0)}Qzo(){if(this.$3a.rle()){this.$3a.i7h();var d=Wa.a.instance.resolve("Wonca.AddInCommands.IAddInCommandsInitService").Hnm();
if(d)for(const n of d)d={["ack1"]:n.key,["ack0"]:4,["ak0"]:(new Date).getTime()},this.zyc(d)}else G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(F.ULS.sendTraceTag(509695235,220,50,"RefreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.$3a.rle()),this.lU(10,!0),this.lU(0,!0))}c3b(d){kd.AGg(d[gf.a.r9k].toString())}wQa(d){Rk.wQa(d[gf.a.gVd].toString())}$Ma(d){Rk.$Ma(d[gf.a.gVd].toString())}vTg(d){var n=d.Nr;
const B=d.pE,Q=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&n.solutionId in Q)n=Q[n.solutionId];else if(n.assetId in Q)n=Q[n.assetId];else if(n=this.gum(B),void 0===n||null===n){F.ULS.sendTraceTag(528544853,220,15,"addinCommandControlId is NullOrUndefined");return}this.Gce({["SourceControlId"]:n});d.Nr.isAutoLaunched=!0}gum(d){if(!d)return F.ULS.sendTraceTag(528561871,
220,10,"Failed to get button id for addin"),null;if((d=d.dFa)&&d.qL&&0<d.qL.count)for(const n of d.qL){if(n.groups&&1===n.groups.length){d=n.groups[0];if(d.controls&&1===d.controls.length){const B=d.controls[0];if(B.attributes&&!B.controlType&&B.enabled)return B.id}d.controls&&F.ULS.sendTraceTag(528261908,220,15,"It has multiple buttons")}n.groups&&F.ULS.sendTraceTag(528261909,220,15,"It has multiple groups")}return null}RQm(d,n){let B=0;if(!d||!n)return B;for(var Q=0;Q<n.Bs();Q++){if(n.Gy(Q)){if(n.ue()&&
14===n.Jf){B|=Hl.table;break}n.Ac()}n.Ac()}for(n=0;n<d.length;++n)if(Q=d.K(n),Q.contextId===ed.a.Nd||Q.contextId===ed.a.paragraph||Q.contextId===ed.a.image)bf.ParagraphReader.lc(Q.node)?B=Wh.a(Q.node,5)?B|Hl.image:B|Hl.text:Cj.a.nr(Q.node)&&(B|=Hl.image);return B}iyl(){this.$3a.i7h()}bil(d){if(d&&d.solutionId){var n=Wa.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper");n?n.q_f(()=>{Wa.a.instance.Za("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(B=>{var Q=d.solutionId,ha=B.n8d(Q);
ha?ha.sharedRuntimeId&&ha.backgroundState===am.background?this.Qhl(ha.sharedRuntimeId,Q):(B=B.Atg(ha),(B=gf.a.rVh in B?B[gf.a.rVh]:null)&&"true"===B.toLowerCase()?(B=new Ml,ha=B.cil,ha=Q in ha?ha[Q]:null,Q=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q,d.storeType,d.assetId,null,null,d.storeId),ha?(this.IUf(B,ha),F.ULS.sendTraceTag(22360455,220,100,"LaunchAddInCommands AutoShowTaskPane Success for app "+Q)):F.ULS.sendTraceTag(22360454,220,15,"LaunchAddInCommands AutoShowTaskPane: No TaskPane set to autoshow for app "+
Q)):F.ULS.sendTraceTag(22360453,220,50,"LaunchAddInCommands AutoShowTaskPane: Document settings don't set AddinCommandsAutoShowTaskPaneWithDocument = true.")):F.ULS.sendTraceTag(22360452,220,50,"LaunchAddInCommands AutoShowTaskPane failed for afoRefData is null.")})}):F.ULS.sendTraceTag(22360451,220,10,"LaunchAddInCommands AutoShowTaskPane failed for initializeHelper is null.")}else F.ULS.sendTraceTag(571248988,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid asset id.")}Qhl(d,n){const B=
new Ml;(d=B.getTaskPaneControlIdFromSolutionIdRuntimeId(n,d))&&this.IUf(B,d)}C6n(d,n){Object(zk.a)(xe,n);G.AFrameworkApplication.J.$("AddInCommandsAutoShowTaskPaneIsEnabled")&&(n?window.setTimeout(()=>{n.Nr&&this.bil(n.Nr)},0):F.ULS.sendTraceTag(21546839,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null.")));Nl.b.ZEc()&&n&&Nl.b.QZn(this,n)}}Object(D.a)(kk,"AddInCommandsManager",null,[393]);class Sn extends kk{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){super(d,n,B,Q,ha,Aa,bb,Ib);this.K_m=
()=>{Wa.a.instance.Wa("WordEditor.IStatusBarUser").h_b();this.jDe()};(this.mNe=B)&&this.mNe.q6k(this.K_m);Re.a.p9c=Re.a.sik;this.za=oc}FAc(){this.jDe()}jDe(){const d=this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1);Zk.jDe(this.mNe,yg.StaticActiveAppFrame.Aa().Cua(),"AddInCommandsLoadStatus-Medium14",d?WoncaIntl.WoncaStrings.L_TabHome:WoncaIntl.WoncaStrings.L_TabInsert,
CommonUIStrings.L_ButtonOfficeAddins)}}Object(D.a)(Sn,"WordEditorAddInCommandsManager",kk,[]);class kg{get name(){return"WordEditor.AddInCommands"}Ec(d){this.Z=d;this.Z.ja("CommandUI.AddInCommands.ContextMenuExtensibilityCache",()=>new hc).ha();this.Z.ja("CommandUI.AddInCommands.AddinCommandsResourceManager",()=>G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddinResourceManagerGetInstance",!0)?Pc.getInstance():new Pc).ha();this.Z.ja("CommandUI.AddInCommands.IAddinCommandsStringProvider",
()=>new Ye).ha();this.Z.ja("Wonca.AddInCommands.IAddInCommandsManager",()=>new Sn(d.resolve("CommandUI.AddInCommands.ContextMenuExtensibilityCache"),d.zf("Common.App.AppsForOfficeCommon.IContextActivationManager"),d.resolve("CommandUI.AddInCommands.AddinCommandsResourceManager"),d.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider"),d.resolve("Wonca.ICommandUiManager").IR,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.ISharedDependencyLoader"),d.resolve("Common.IExternalUICommandDefinitionMapping"),
d.resolve("Common.IAppSettingsManager"))).ha();this.Z.ja("Wonca.AddInCommands.AddInCommandsActor",()=>new Wd(G.AFrameworkApplication.va,d.resolve("Wonca.AddInCommands.IAddInCommandsManager"))).ha();this.Z.ja("Wonca.AddInCommands.IAddInCommandsInitService",()=>new ei(G.AFrameworkApplication.va,G.AFrameworkApplication.ta.Kt)).ha()}init(){G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&(this.Z.resolve("Wonca.AddInCommands.AddInCommandsActor").mc(),this.Z.resolve("WordEditor.UI.EditSurfaceContextMenu").xAo(Object(X.a)(this.Z.resolve("Wonca.AddInCommands.IAddInCommandsManager"),
this.Z.resolve("Wonca.AddInCommands.IAddInCommandsManager").Yll,"buildAddInCommandsContextMenuProps")),G.AFrameworkApplication.J.$("AddInCommandsLoadedInBootingIsEnabled")&&this.Z.resolve("Wonca.AddInCommands.IAddInCommandsInitService").Qxp())}dispose(){kd.j0l()}static main(){G.AFrameworkApplication.BL||U.a.instance.Rc(new kg)}}Object(D.a)(kg,"PackageManager",null,[0,1]);class gb{constructor(d,n){this.zD=d;this.appId=n}}Object(D.a)(gb,"ActivatedAfoData",null,[]);class Fb{constructor(d,n,B,Q,ha,Aa,
bb,Ib=!0,oc=null,Ac=0,ad=null,sd=null){this.settings=null;this.Itk=d;this.cHd=n;this.EQk=B;this.aMb=Q;this.oY=ha;this.IQd=Aa;this.cWc=bb;this.rK=null;this.isToBePersisted=Ib;this.sharedRuntimeId=oc;this.backgroundState=Ac;this.P6b=ad;this.duk=sd}get cXh(){return this.Itk}get instanceId(){return this.cHd}get $n(){return this.EQk}get version(){return this.aMb}get store(){return this.oY}get storeType(){return this.IQd}get assetId(){return this.P6b}get assetStoreId(){return this.duk}get qoa(){return"inmemory"===
this.storeType||this.rK&&!this.rK.qoa||!this.isToBePersisted?!1:!0}nZh(d){return d.$n.toLowerCase()===this.$n.toLowerCase()&&d.store.toLowerCase()===this.store.toLowerCase()&&d.storeType.toLowerCase()===this.storeType.toLowerCase()}}Object(D.a)(Fb,"AppsForOfficeReferenceData",null,[]);class Wb{constructor(){this.Lya=new ff.a}add(d,n){this.Lya.Bb(d.id)&&F.ULS.sendTraceTag(7143680,344,15,"instance Id {0} already exists when adding new activated apps for office info",d.id);n=new gb(d,n);this.Lya.W(d.id,
n)}QXa(d){return this.Lya.Bb(d)?this.Lya.K(d).appId:(F.ULS.sendTraceTag(7143681,344,15,"instance Id {0} not exists when trying to get App Id",d),null)}OSb(d){for(const n of this.Lya)if(d===n.value.appId)return n.key;return null}G4c(d){return this.Lya.K(d).zD.addinCommandsActionType}ZLf(d){d=this.Lya.K(d).zD;const n=new Fb(null,d.id,d.solutionId,d.version,d.storeId,d.storeType,!0,d.isToBePersisted);d.ownerAddinSolutionId&&(n.rK=new Fb(d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.ownerAddinSolutionId,
d.version,d.storeId,d.ownerAddinStoreType,!1,d.isToBePersisted,d.sharedRuntimeId,d.backgroundState,d.assetId,d.assetStoreId));return n}rUm(d){return this.Lya.K(d).zD.onTaskPaneClose}tSb(d){return this.Lya.K(d).zD.div}Avm(d){return this.Lya.K(d).zD.customizedActionDic}xFi(d){const n=new ma.a;for(const B of this.Lya){const Q=B.value.zD;Q.ownerAddinSolutionId&&d.toLowerCase()===Q.ownerAddinSolutionId.toLowerCase()&&n.add(Q.id)}return n}vom(d){const n=new ma.a;for(const B of this.Lya){const Q=B.value.zD;
Q.ownerAddinSolutionId&&d.toLowerCase()===Q.ownerAddinSolutionId.toLowerCase()&&n.add(B.value.appId)}return n}}Object(D.a)(Wb,"ActivatedAfoDataManager",null,[1891]);class Cc{constructor(d,n,B,Q,ha){this.Iqi=d;this.controlId=n;this.dCb=B;this.handler=Q;this.callback=ha}}Object(D.a)(Cc,"EventRegistrationParams",null,[]);class id{constructor(d,n,B){this.vBo=Q=>{this.FBj(Q.customData,(ha,Aa)=>{ha.addHandler(Aa.controlId,Aa.handler,Aa.callback,Aa.dCb)})};this.QAp=Q=>{this.FBj(Q.customData,(ha,Aa)=>{ha.removeHandler(Aa.controlId,
Aa.callback,Aa.dCb)})};this.Sb=d;this.Zzd=n;this.Uch=B}invokeDdaMethod(d,n,B){const Q=d.DdaMethod.DispatchId,ha=this.Zzd.vbl.cKf(Q);ha?(ha.parameters=d,ha.callback=n,ha.C9k=B,ha.controlId=d.DdaMethod.ControlId,ha.xk=this.Uch.ZLf(ha.controlId),ha.customizedActionDic=this.Uch.Avm(ha.controlId),this.Hif(Object(X.a)(ha,ha.go,"go"),null)):(F.ULS.sendTraceTag(5902750,341,10,"API Call for method ID {0} does not exist.",Q),this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}registerDdaEventAsync(d,
n,B,Q,ha){this.Hif(this.vBo,new Cc(d,n,B,Q,ha))}unregisterDdaEventAsync(d,n,B,Q,ha){this.Hif(this.QAp,new Cc(d,n,B,Q,ha))}getThrottleForCall(d){return this.Zzd.wbl.cVm(d)}Hif(d,n){d=new tb.a(2,1,0,d,116);d.customData=n;this.Sb.pc(d)}FBj(d,n){const B=this.Zzd.ubl.Jlc(d.Iqi);B?n(B,d):(F.ULS.sendTraceTag(5902751,341,10,"Event for dispatch ID {0} does not exist.",d.Iqi),this.ft(d.callback,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}PJ(d){this.ft(d,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}ft(d,
n){if(d){var B={};B.Error=n;d(B)}}}Object(D.a)(id,"AppsForOfficeApiAdapter",null,[1915]);class Ad{constructor(){this.N6b=this.Z=null}Ec(d){this.Z=d;d.register(Wb,"Common.App.AppsForOfficeCommon.ActivatedAfoDataManager").as("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager").ha().fe(()=>new Wb);d.register(id,"Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter").as("Common.App.AppsForOfficeCommon.IHostApi").ha().fe(()=>new id(G.AFrameworkApplication.zc,d.resolve("Common.App.AppsForOfficeCommon.ApiManager"),
d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager")))}init(){}dispose(){this.N6b&&(this.N6b.dispose(),this.N6b=null)}}Object(D.a)(Ad,"AppsForOfficeCommonPackage",null,[0,1]);var Cd=e(1372);class qe{constructor(d,n,B){this.ztk=d;this.ytk=n;this.Atk=B}get vbl(){return this.ztk}get ubl(){return this.ytk}get wbl(){return this.Atk}}Object(D.a)(qe,"ApiManager",null,[1919]);var df=e(89),Ef=e(421),Sf=e(218),Je=e(226);class Ug extends Sa.StandardDialog{constructor(d,n){super();this.lgh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;
this.Fmh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.Gmh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.P5e=!1;this.$fc=()=>{this.hide();this.P5e&&this.e0j()};this.O2n=()=>{Xg.a.instance.getItem("optedIntoAddinDeveloperMode")?(Xg.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.P5e=!1):(Xg.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.P5e=!0)};this.P2n=(B,Q)=>{1===B&&Q.optInCheckbox&&(Xg.a.instance.getItem("optedIntoAddinDeveloperMode")?Xg.a.instance.removeItem("optedIntoAddinDeveloperMode"):
(Xg.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.e0j()))};this.S4a=d;this.aJc=n}showDialog(d,n){this.$g=void 0===this.$g||null===this.$g?Je.a.Fxc(0,Number.MAX_VALUE).toString():this.$g;G.AFrameworkApplication.ta.Pb.$I?this.Kvo(d,n):this.zGn(d,n)}zGn(d,n){const B=new Ea.a(void 0,void 0,!1);B.Md=0;B.$g=Je.a.Fxc(0,Number.MAX_VALUE).toString();B.Fh=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
n,this.Gmh,this.Fmh,this.lgh);B.ti(d,this.P2n,{optInCheckbox:!1})}Kvo(d,n){this.j6a=this.$fc;this.show({["type"]:"StandardDialogProps",["id"]:this.$g,["dialogIcon"]:3,["headerText"]:d,["titleText"]:n,["resultHandler"]:this.j6a,["messageAreaLink"]:this.FPl(),["permanentDismissCheckbox"]:this.CPl(),["renderMicrosoftLogoInHeader"]:!1})}FPl(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.Fmh,["handler"]:{["href"]:this.Gmh,["target"]:"_blank"},["onExecute"]:null}}CPl(){return{["type"]:"AppCheckboxProps",
["id"]:"WACDialogOptInCheckbox",["label"]:this.lgh,["onExecute"]:this.O2n}}e0j(){const d=new Sa.StandardDialog;d.Md=4;const n=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.S4a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;d.tU(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,n,this.aJc)}}Object(D.a)(Ug,"AppsForOfficeDeveloperModeOptInDialog",Sa.StandardDialog,[]);class Kf{constructor(d,
n){this.S4a=this.cDd=null;this.wGj=B=>{1===B&&this.S4a&&this.iBo()};this.Y3=d;this.lka=n}initialize(){this.lka&&(this.lka.initialize(),this.bdp())}bdp(){if(this.lka){var d=this.lka.Xxi();if(d){for(let B=0;B<d.count;B++){var n=!OSF.OsfControl.isFirstPartyStoreString(d.K(B).storeType);if(G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&n)G.AFrameworkApplication.ta&&!G.AFrameworkApplication.ta.Pb.s9(22)&&(n=new ka.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,CommonUIStrings.l_ThirdPartyAddinDisabledMessage,
null),n.id=22,n.image=1,n.closeable=!0,G.AFrameworkApplication.ta.Pb.dBa(n,!0)||F.ULS.sendTraceTag(36790730,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user."));else if(d.K(B).cWc||"registry"===d.K(B).storeType)if(n=new Kk.a(d.K(B).instanceId,d.K(B).$n,d.K(B).version,d.K(B).store,d.K(B).storeType,d.K(B).settings),n.assetId=d.K(B).assetId,n.assetStoreId=d.K(B).assetStoreId,n.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,
n.osfControlType=1,G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")){const Q={};G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Q.solutionId=n.solutionId,Q.version=n.version):(Q.marketplaceId=n.solutionId,Q.marketplaceVersion=n.version);Q.storeType=n.storeType;Q.storeId=n.storeId;Q.targetData=n;this.Y3.t8i(Q,(ha,Aa,bb)=>{const Ib=bb.targetData;if(!Aa)this.Y3.showTaskPane(Ib.solutionId,null,Ib);else if(G.AFrameworkApplication.J.$("InstallVisibleAddinCommandsEnabled")){if("omex"!==
Q.storeType.toLowerCase())return;let oc=!1;this.Qrg(Ac=>{if(!Ac[gf.a.q9k]){if(Ac[gf.a.vVh])for(const ad of Ac[gf.a.vVh])if(oc=Cb.e(ad[1])===Cb.e(Ib.solutionId))break;oc||this.Y3.rRh(Ib)}})}ha||F.ULS.sendTraceTag(542978530,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.solutionId,Ib.storeType,Ib.assetId,null,null,Ib.storeId),Ib.storeType)})}else this.Y3.showTaskPane(d.K(B).$n,null,n)}this.Byp()}}}Qrg(d){const n={};n.callback=d;G.AFrameworkApplication.va.Zb(Z.a.P_b,
2,n)}fvb(d){if(this.lka){var n=new Fb(d.id,d.id,d.solutionId,d.version,d.storeId,d.storeType,!0,d.isToBePersisted,null,0,d.assetId,d.assetStoreId);d.ownerAddinSolutionId&&(n.rK=new Fb(d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.version,d.storeId,d.ownerAddinStoreType,!1,d.isToBePersisted));this.lka.fvb(n)}}ZYf(d,n,B,Q){this.lka&&(Q=new Fb(Q.id,Q.id,Q.solutionId,Q.version,Q.storeId,Q.storeType,!0),this.lka.ZYf(d,n,B,Q))}f0l(d){this.lka&&(d=this.lka.m8d(d))&&(d.cWc=!1,this.lka.gZo(d))}dispose(){this.Y3&&
(this.Y3.dispose(),this.Y3=null);this.lka&&(this.lka.dispose(),this.lka=null)}Byp(){this.S4a=G.AFrameworkApplication.J.rb("DevAddinManifestFileUrl");this.cDd=G.AFrameworkApplication.J.rb("DevAddinManifestGuid");var d=G.AFrameworkApplication.J.rb("IsDevAddinTest");if(this.S4a&&this.cDd&&d){d="true"===d;var n=Xg.a.instance.getItem("optedIntoAddinDeveloperMode");const B=Xg.a.instance.getItem(this.cDd);n||d&&G.AFrameworkApplication.J.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?B||
d&&G.AFrameworkApplication.J.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?this.Y3.nt.validateAndCacheNewDevAddinManifest(this.S4a):(d=new Sa.StandardDialog,d.Md=4,n=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.S4a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,d.tU(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,n,this.wGj)):(d=new Ug(this.S4a,this.wGj),
d.Md=0,d.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}iBo(){this.Y3.nt.validateAndCacheNewDevAddinManifest(this.S4a);Xg.a.instance.setItem(this.cDd,"true")}}Object(D.a)(Kf,"AppsForOfficeManager",null,[1913,11]);class fl{constructor(d,n){this.hostControl=d;this.controlStatusChanged=n.uom();this.notifyHost=n.Gtk}}Object(D.a)(fl,"HostControlInfo",null,[]);class Ji{constructor(d){this.nnb=d}create(){return new OSF.ContextActivationManagerBuilder(this.nnb.CEi(),
this.nnb.JGi())}}Object(D.a)(Ji,"ContextActivationManagerBuilderFactory",null,[1911]);class lk{constructor(d,n,B){this.Uce=Q=>{try{if(Q&&Q.rawEvent&&Q.rawEvent.origin&&this.FUb&&this.FUb.id){var ha=this.xxj(Q.rawEvent.origin);const Aa=this.xxj(document.domain);if(ja.a.Oh().equals(Aa,ha))if(Q.rawEvent.source&&Q.rawEvent.source.frameElement&&Q.rawEvent.source.frameElement.id&&ja.a.Oh().equals(Q.rawEvent.source.frameElement.id,this.FUb.id)){ha=null;try{ha=JSON.parse(Q.rawEvent.data)}catch(bb){F.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",bb.message)}ha?(ha.statusCode!==Qb.a.jB||void 0!==ha.error&&ha.error?(F.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ha.statusCode,ha.error),this.onError()):(F.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.iE(ha.authorizationCode?ha.authorizationCode:
ha.signInUrl)),$removeHandler(window,"message",this.Uce),this.FUb?document.body.contains(this.FUb)?document.body.removeChild(this.FUb):F.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):F.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):F.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else F.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else F.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else F.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Aa){F.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Aa.message)}};this.FUb=d;this.iE=n;this.onError=B;$addHandler(window,"message",this.Uce)}xxj(d){let n="";try{d&&(n=-1<d.indexOf("//")?d.split("/")[2]:
d.split("/")[0])&&(n=n.split(":")[0],n=n.split("?")[0])}catch(B){F.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",B.message)}return n}static qC(d,n,B){new lk(d,n,B)}}Object(D.a)(lk,"ResponseHandler",null,[]);var Sj=e(211);class dk{constructor(d){this.jMb=d}tryAuthenticate(d,n){this.wte(dk.$Ek,()=>{d()},n)}tryAuthorize(d,n){this.wte(dk.wuk,d,n)}getSignInUrl(d,n){this.wte(dk.OKh,d,n)}signOut(d,n){this.wte(dk.eUk,d,n)}wte(d,n,B){var Q=new Sj.QueryStringBuilder("AuthenticationProxyHandler.aspx");
Q.Me("responseType",d);G.AFrameworkApplication.Qla(Q);Q=String.format("{0}{1}&{2}",this.jMb,Q.toString(),G.AFrameworkApplication.lm);const ha=document.createElement("iframe");ha.setAttribute("id","privateCatalogIframe");ha.setAttribute("name","privateCatalogIframe");ha.setAttribute("style","display: none");ja.a.Oh().equals(d,dk.OKh)||ha.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");lk.qC(ha,n,B);ha.setAttribute("src",Q);document.body.appendChild(ha)}}
dk.wuk="authcode";dk.$Ek="identitytoken";dk.OKh="signinurl";dk.eUk="signout";Object(D.a)(dk,"AuthenticationProxy",null,[]);class Zd{}Zd.getUserId="getUserId";Zd.getLastStoreUpdate="laststoreupdate";Zd.getEntitlement="getEntitlements";Zd.getEToken="getEToken";Zd.getManifest="getManifest";Zd.getAppState="getAppState";Zd.getKilledApps="getRemovedAddins";Zd.getAppDetails="getAppDetails";Zd.removeApps="removeAddin";Zd.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Zd.getPrivateCatalogAddIns=
"getAddIns";Zd.getPrivateCatalogManifests="getAppManifests";Zd.isStoreDisabled="isStoreDisabled";Object(D.a)(Zd,"S2SWebRequestActions",null,[]);var qg=e(1062);class sh{getUserId(d,n){const B=new ma.a;B.add(new Qi.a("corr",d));this.iu(Zd.getUserId,B,1,n)}getLastStoreUpdate(d,n,B){const Q=new ma.a;Q.add(new Qi.a("lc",d));Q.add(new Qi.a("corr",n));this.iu(Zd.getLastStoreUpdate,Q,1,B)}getEntitlement(d,n,B,Q){d=new ma.a;d.add(new Qi.a("av",n));d.add(new Qi.a("corr",B));this.iu(Zd.getEntitlement,d,1,Q)}getEToken(d,
n,B,Q,ha,Aa){const bb=new ma.a;bb.add(new Qi.a("cmu",d));bb.add(new Qi.a("cmf",n));bb.add(new Qi.a("assetid",B));bb.add(new Qi.a("expver",Q));bb.add(new Qi.a("corr",ha));this.iu(Zd.getEToken,bb,1,Aa)}getManifest(d,n,B,Q){const ha=new ma.a;ha.add(new Qi.a("cmu",d));ha.add(new Qi.a("assetid",n));ha.add(new Qi.a("corr",B));this.iu(Zd.getManifest,ha,1,Q)}getAppState(d,n,B){const Q=new ma.a;Q.add(new Qi.a("ma",d));Q.add(new Qi.a("corr",n));this.iu(Zd.getAppState,Q,1,B)}getKilledApps(d,n){const B=new ma.a;
B.add(new Qi.a("corr",d));this.iu(Zd.getKilledApps,B,1,n)}getAppDetails(d,n,B,Q){const ha=new ma.a;ha.add(new Qi.a("cmo",d));ha.add(new Qi.a("corr",B));this.sendWithBody(Zd.getAppDetails,ha,n,2,Q,!1)}removeApps(d,n,B){const Q=new ma.a;Q.add(new Qi.a("corr",n));this.sendWithBody(Zd.removeApps,Q,d,2,B,!1)}getLastPrivateCatalogUpdate(d,n,B,Q,ha,Aa){const bb=new ma.a;bb.add(new Qi.a("catalog","privatecatalog"));bb.add(new Qi.a("clientCode",d));bb.add(new Qi.a("clientVersion",n));bb.add(new Qi.a("corr",
ha));d=String.format("authorizationCode={0}&refreshToken={1}",B?Ca.a.nj(B):"",Q?Ca.a.nj(Q):"");this.sendWithBody(Zd.getLastPrivateCatalogUpdate,bb,d,2,Aa,!0)}getPrivateCatalogAddIns(d,n,B,Q,ha,Aa){const bb=new ma.a;bb.add(new Qi.a("catalog","privatecatalog"));bb.add(new Qi.a("clientCode",d));bb.add(new Qi.a("clientVersion",n));bb.add(new Qi.a("corr",ha));d=String.format("authorizationCode={0}&refreshToken={1}",B?Ca.a.nj(B):"",Q?Ca.a.nj(Q):"");this.sendWithBody(Zd.getPrivateCatalogAddIns,bb,d,2,Aa,
!0)}getPrivateCatalogManifests(d,n,B,Q,ha){const Aa=new ma.a;Aa.add(new Qi.a("catalog","privatecatalog"));Aa.add(new Qi.a("corr",Q));d=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Ca.a.nj(d),n?Ca.a.nj(n):"",B?Ca.a.nj(B):"");this.sendWithBody(Zd.getPrivateCatalogManifests,Aa,d,2,ha,!0)}isStoreDisabled(d,n){const B=new ma.a;B.add(new Qi.a("corr",d));this.iu(Zd.isStoreDisabled,B,2,n)}iu(d,n,B,Q){this.sendWithBody(d,n,null,B,Q,!1)}sendWithBody(d,n,B,Q,ha,Aa){const bb=new Sj.QueryStringBuilder("AddinServiceHandler.ashx");
bb.Me("action",d);bb.Me("app",qg.a[G.AFrameworkApplication.ta.Pb.gl]);for(const Ib of n)bb.Me(Ib.key,Ib.value);n=String.format("{0}{1}&{2}",G.AFrameworkApplication.ta.Pb.HOa,bb.toString(),G.AFrameworkApplication.lm);G.AFrameworkApplication.pe.addRequest(n,Q,B,null,!1,2,Ib=>{let oc=null,Ac=null;Ib&&Ib.data&&(Ib.data.Pi["X-BlockedForMinor"]&&"1"===Ib.data.Pi["X-BlockedForMinor"].toString()&&(Ib.data.Xe=451),oc=Ib.data.responseData,Ac=Ib.data.Pi);ha(Ib.data.Xe,oc,Ac)},Ib=>{var oc=null;let Ac=null;Aa&&
Ib&&Ib.data&&Ib.data.responseData&&(oc=Ib.data.responseData,Ac=Ib.data.Pi);ha(Ib.data.Xe,oc,Ac);if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){oc={message:"AddinServiceHandler request failed"};oc.code=Ib.data.Xe;oc.action=d;if(Ib.data.request||Ib.data.request.get_headers())oc["X-UserSessionId"]=Ib.data.request.get_headers()["X-UserSessionId"];408===Ib.data.Xe||503===Ib.data.Xe?F.ULS.sendTraceTag(538784582,220,10,JSON.stringify(oc)):
F.ULS.sendTraceTag(18392345,220,50,JSON.stringify(oc))}else F.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ib.data.Xe)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+d,void 0,void 0,void 0,void 0,["X-UserKey"])}}Object(D.a)(sh,"S2SWebRequestManager",null,[]);class qi{constructor(d,n,B){this.SBd=null;this.PGc=d;this.nnb=n;this.GEk=B}create(){if(!this.SBd){G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AppsForOfficeServerToServerIsEnabled")&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new sh);
G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled")&&OfficeExt.PrivateCatalogService.initRequestHandler(new sh,new dk(G.AFrameworkApplication.J.appSettings.WebServiceBase),G.AFrameworkApplication.J.$("PrivateCatalogThirdPartyHostsEnabled"),G.AFrameworkApplication.J.$("PrivateCatalogIsResultCodesEnabled"));"undefined"!==typeof OfficeExt.MosRequestHandler&&"undefined"!==typeof OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new sh);"undefined"!==
typeof OfficeExt.ProxyBasedCatalogService&&"undefined"!==typeof OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new sh);const d=this.SBd=this.PGc.setHostInfo(this.nnb.CEi()).setLocaleInfo(this.nnb.JGi()).setUrlInfo(this.nnb.JWm()).setMiscellaneousActivationParameters(this.nnb.NGm()).setHostControlInfo(this.GEk).setUserInfo(this.nnb.TWm()).construct();void 0!==d&&null!==d&&"undefined"!==typeof d.hostCheckReadyHandler?G.AFrameworkApplication.K6k(Object(X.a)(d,
d.hostCheckReadyHandler,"hostCheckReadyHandler")):F.ULS.sendTraceTag(594613527,1403,15,"ContextActivationManager or its hostCheckReadyHandler is null")}return this.SBd}}Object(D.a)(qi,"ContextActivationManagerFactory",null,[1909]);class Dm{constructor(d,n,B,Q){this._id=d;this.bVk=n;this.IQd=B;this.L6b=Q}getId(){return this._id}getStoreId(){return this.bVk}getStoreType(){return this.IQd}}Object(D.a)(Dm,"ExtensionIdentity",null,[1124]);class Ci{constructor(d,n,B){this.Syh=B}}Object(D.a)(Ci,"HostProperties",
null,[]);class nj{constructor(){this.optionalProperties={};this.gjc={}}}Object(D.a)(nj,"ExtensionLaunchProperties",null,[]);var mk=e(1751),Jc=e(1607);class Ha{}Ha.MFe="Taskpane";Ha.action="Action";Ha.yUo="SDXDialog";Object(D.a)(Ha,"ComponentTypeNames",null,[]);var eb=e(1750);class rc{constructor(){this.ga=G.AFrameworkApplication.va}med(d,n,B,Q,ha){this.pFn(d,n,B,Q,ha)}pFn(d,n,B,Q,ha){const {ExtensionComponentInstance:Aa}=e(1933),bb={};bb[Jc.a.Z2c]=d;bb[Jc.a.G$h]=n;bb[Jc.a.cZc]=B;bb[Jc.a.p9m]=Q;bb[Jc.a.sjd]=
ha;Q=8;if(G.AFrameworkApplication.e7i(d.getId()))switch(n){case Ha.action:Q=this.ga.Zb(Z.a.w5d,2,bb);break;case Ha.MFe:Q=this.ga.Zb(Z.a.UZj,2,bb);break;case Ha.yUo:Q=this.ga.Zb(Z.a.Ike,2,bb);break;default:Q=16}32===Q?(Q=Jh.a.create().toString(),ha.optionalProperties.InstanceToken&&(Q=ha.optionalProperties.InstanceToken),d=new Aa(d,n,B,Q),eb.a.instances[Q]=d):d=new Aa(d,n,B,null);d.LYo(bb)}oFn(d){var n=d.ExtId;const B=d.ComponentType,Q=d.ComponentId;var ha=d.HostProps;d=d.OptionalProps;n=new Dm(n.Id,
n.StoreId,n.StoreType,n.AppVersion);ha=new Ci(ha.HostType,ha.FormFactor,ha.Locale);const Aa=new nj;Aa.optionalProperties=d.OptionalProperties;Aa.gjc=d.DevProperties;rc.instance.med(n,B,Q,ha,Aa)}getInstance(d){return eb.a.instances[d]}Hvg(d){return eb.a.Hvg(d)}static get instance(){rc.lEd||(rc.lEd=new rc);return rc.lEd}}rc.lEd=null;Object(D.a)(rc,"ExtensionLifeCycleManager",null,[1151]);var Uc=e(731),bd=e(137);class Hd{constructor(d,n,B){this._id=d;this.Nsk=n;this.Uwk=B;this.PZi=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get XMb(){return this.Nsk}get MBl(){return this.Uwk}execute(d,
n,B){B=B||{};B.commandMode=this.PZi;n.invokeAppCommand(this.XMb,this.MBl,B,()=>{d.q7n(this.id)})}}Object(D.a)(Hd,"AddinNativeActionBase",null,[782]);class Pe extends Hd{constructor(d,n){super(1,d,n);this.PZi=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(D.a)(Pe,"AddinTakeSnapshotAction",Hd,[]);class Le{yJl(d){return new Hd(3,d,this.Smm().getNativeActionName(3))}Smm(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(D.a)(Le,"AddinNativeActionManager",null,[757]);class De{invokeAppCommand(d,
n,B,Q){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(d,n,B,Q)}static getInstance(){De._instance||(De._instance=new De);return De._instance}}De._instance=null;Object(D.a)(De,"OSFAddinCommandsRuntimeManager",null,[75]);var lf=e(209),Af=e(17);class mg extends Ea.a{constructor(d,n,B){super();this.jVa=null;this.Ndf="WACDialogTitleText";this.$ya="0";this.rSa="15px";this.zxk="0px";this.Zya="calc(100% - 30px)";this.yxk="100%";this.MGh=0;this.sa=new dc.a;this.Psk=new Le;this.Md=5;this.$g=this.bJc=
B;this.ZSe=d;this.$jh=n;this.sUe=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix")}ojf(d){this.sa.addHandler("OnDialogClosedEventKey",d)}JJj(d){this.sa.removeHandler("OnDialogClosedEventKey",d)}a3o(){this.j6a=null}QW(){super.QW();this.zr.style.width="100%";this.zr.style.height=this.b9c?this.Zya:this.yxk;this.zr.style.marginTop=this.b9c?this.rSa:this.zxk;this.zr.style.padding=this.$ya}JP(){super.JP();this.Yc.style.width=String.format("{0}px",
this.ZSe*window.innerWidth/100);this.Yc.style.height=String.format("{0}px",this.$jh*window.innerHeight/100);this.Yc.style.minWidth="0px";this.sUe&&G.AFrameworkApplication.isRtl&&100===this.ZSe&&(this.Yc.style.right="0px",this.Yc.style.marginRight="0px");this.jVa=document.getElementById(this.Vj(this.Ndf));this.jVa.style.position="absolute";this.jVa.style.whiteSpace="nowrap";this.jVa.style.textOverflow="ellipsis";G.AFrameworkApplication.isRtl?(this.jVa.style.right="14px",this.jVa.style.left="44px"):
(this.jVa.style.right="44px",this.jVa.style.left="14px")}a2a(d){super.a2a(d);this.jVa&&this.jVa.setAttribute("title",d)}get jrb(){return this.zr}fyg(){this.Yc.style.width=String.format("{0}px",this.ZSe*window.innerWidth/100);this.Yc.style.height=String.format("{0}px",this.$jh*window.innerHeight/100);this.Yc.style.overflowY="hidden";this.Yc.style.overflowX="hidden";this.Yc.style.marginTop="";this.Yc.style.top="";Af.a.$Da&&G.AFrameworkApplication.isRtl?(this.Yc.style.right="",this.Yc.style.marginRight=
""):(this.Yc.style.left="",this.Yc.style.marginLeft="")}hide(){this.Psk.yJl(this.bJc).execute(this,De.getInstance(),{});this.MGh=window.setTimeout(()=>{this.sa.raiseEvent("OnDialogClosedEventKey",this.bJc);lf.a.prototype.hide.call(this)},500)}q7n(d){3===d&&(window.clearTimeout(this.MGh),this.sa.raiseEvent("OnDialogClosedEventKey",this.bJc),super.hide())}}Object(D.a)(mg,"AppsForOfficeDialog",Ea.a,[46,47]);class hi{constructor(){this.dialog=this.$g=null}}Object(D.a)(hi,"DialogInfo",null,[]);class Uh{}
Uh.url="url";Uh.height="height";Uh.width="width";Uh.bBf="displayInIframe";Uh.Nde="hideTitle";Object(D.a)(Uh,"DialogSettings",null,[]);class nk{constructor(){this.height=this.width=0;this.$g=this.controlId=this.pageUrl=null;this.Nde=this.bBf=!1}}Object(D.a)(nk,"DisplayDialogParams",null,[]);class fi extends Sys.EventArgs{constructor(d,n,B=null,Q="",ha=""){super();this.controlId=d;this.messageType=n;this.messageContent=B;this.Gbg=Q;this.phb=ha}}Object(D.a)(fi,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);class kc extends Sys.EventArgs{constructor(d,n,B=null,Q="",ha=""){super();this.controlId=d;this.messageType=n;this.messageContent=B;this.Gbg=Q;this.phb=ha}}Object(D.a)(kc,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Ze=e(127);class Fg{constructor(d){this.sa=new dc.a;this.Q3n=(n,B)=>{if(n=this.Xlc(B))this.Bk.purgeDialogControl(B),Fg.URa.remove(n),this.sa.raiseEvent("OnMessageParentEventKey",new kc(n,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.Bk=d}J7k(d){this.sa.addHandler("OnMessageParentEventKey",
d)}RJj(d){this.sa.removeHandler("OnMessageParentEventKey",d)}I7k(d){this.sa.addHandler("OnMessageDialogEventKey",d)}XIo(d){this.sa.removeHandler("OnMessageDialogEventKey",d)}showDialog(d,n,B,Q){if(Fg.URa.Bb(n))F.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),B(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const ad=Rb.b(d),sd=ad[Uh.url];if(this.Bk.getOsfControl(n).checkAppDomains(sd)){var ha=new nk;ha.width=ad[Uh.width];
ha.height=ad[Uh.height];ha.pageUrl=sd;ha.bBf=ad[Uh.bBf];ha.Nde=ad[Uh.Nde];ha.controlId=n;ha.$g=Ze.a.create().toString();var Aa=new hi;Aa.$g=ha.$g;var bb=this.Bk.getOsfControl(ha.controlId).getManifest().getDefaultDisplayName(),Ib=this.Bk.getOsfControl(ha.controlId).getStoreType().toLowerCase();d=null;d=(4===G.AFrameworkApplication.ta.Pb.gl&&"hardcodedpreinstall"===Ib||"sdxcatalog"===Ib)&&ha.Nde?this.createAndShowAppsForOfficeDialog(ha.width,ha.height,ha.$g,!0,bb):this.createAndShowAppsForOfficeDialog(ha.width,
ha.height,ha.$g,!1,bb);var oc=this.Bk.getOsfControl(ha.controlId),Ac=oc.getManifest();n={};n.id=ha.$g;n.solutionId=oc.getSolutionId();n.version=oc.getVersion();n.storeType=Ib;n.storeId=oc.getStoreId();n.assetId=oc.getAssetId();n.assetStoreId=oc.getAssetStoreId();n.ownerAddinSolutionId=oc.getOwnerAddinSolutionId();n.ownerAddinStoreType=oc.getOwnerAddinStoreType();n.appDomains=Ac.getAppDomains();n.dialogUrl=sd;n.osfControlType=1;n.agaveName=bb;n.div=d.jrb;F.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(n.solutionId,n.ownerAddinStoreType||n.storeType,n.assetId,null,null,n.storeId),Ca.a.DV(ha.pageUrl));this.Bk.insertDialogControl(n);d.ojf(this.Q3n);Aa.dialog=d;Fg.URa.W(ha.controlId,Aa);Q&&Q(n);B(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else F.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),B(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ad){F.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
ad.message),B(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}tUn(d,n,B,Q){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Q&&(Q=B);try{const ha=this.Xlc(d);ha&&this.sa.raiseEvent("OnMessageParentEventKey",new kc(ha,OSF.DialogMessageType.DialogMessageReceived,n,B,Q))}catch(ha){return F.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ha.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}LBa(d,
n){if(Fg.URa.Bb(d))try{const B=Fg.URa.K(d);B.dialog&&B.dialog.hide();this.Bk.purgeDialogControl(B.$g);Fg.URa.remove(d);n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(B){F.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",B.message),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else F.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}aXo(d,
n,B,Q){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Q&&(Q=B);if(Fg.URa.Bb(d)&&(d=Fg.URa.K(d),d.dialog))try{this.sa.raiseEvent("OnMessageDialogEventKey",new fi(d.$g,OSF.DialogMessageType.DialogParentMessageReceived,n,B,Q))}catch(ha){F.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",ha.message)}}Xlc(d){let n=null;for(const B of Fg.URa)if(B.value.$g===d){n=B.key;break}return n}createAndShowAppsForOfficeDialog(d,
n,B,Q,ha){d=new mg(d,n,B);ha=Q?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,ha);Q&&(d.b9c=!1,d.hv=!1);d.ti(ha,null,null);d.a3o();return d}static LYm(){return Fg.URa}static getInstance(d){Fg._instance||(Fg._instance=new Fg(d));return Fg._instance}}Fg._instance=null;Fg.URa=new ff.a;Object(D.a)(Fg,"AppsForOfficeDialogManager",null,[31]);class ii{constructor(d,n,B){this.Bk=this.bOe=null;this.Ai=n;this.faa=B}get contextActivationMgr(){!this.Bk&&this.Ai&&(this.Bk=this.Ai.nt);return this.Bk}get l$a(){this.bOe||
(this.bOe=Fg.getInstance(this.contextActivationMgr));return this.bOe}showDialog(d,n,B){try{this.l$a.showDialog(n,d,B,Q=>{this.faa.add(this.Xll(Q),Q.id)})}catch(Q){F.ULS.sendTraceTag(19670552,344,10,"ShowDialogApiHelper: show dialog failed. Exception message: {0}",Q.message),B(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}wjj(d,n,B,Q){return this.l$a.tUn(d,n,B,Q)}LBa(d,n){this.l$a.LBa(d,n)}wQa(d){return this.Ai.wQa(d)}$Ma(d){return this.Ai.$Ma(d)}sendMessage(d,n,B,Q){this.l$a.aXo(d,n,B,Q)}Xll(d){return d?
new Kk.a(d.id,d.solutionId,d.version,d.storeId,d.storeType,null):null}}Object(D.a)(ii,"ShowDialogApiHelper",null,[1594]);var te=e(54),pe=e(350),Ee=e(244),rd=e(565),wj=e(246),ui=e(1774),Ch=e(258),$g=e(112),fa=e(277),Ya=e(41),Hb=e(351),Yb=e(323),qa=e(57),hb=e(514),Tb=e(986),Mc=e(38),vc=e(6),fb=e(123),xd=e(13),We=e(720),Ke=e(734);class Qd{constructor(d,n){this.ll=d;Qd.Xnb=n}hgn(d,n,B,Q){const ha=Ze.a.create(),Aa=new Yb.DictionaryPropertySet;Aa.setValue(xd.a.Zva,qa.a.Zn(n,0));Aa.setValue(xd.a.zEa,qa.a.Zn(B,
1));Aa.setValue(Ya.a.S1,We.a.YGa);B=d.view;n=new Mc.GraphTransaction(15);n.Eb(B.Fd);B=null;const bb=({HYb:B}=this.ll.dmi(d,Aa,ha)).returnValue;if(!bb)return null;var Ib=new vc.a;Ib.set(bb.node);Ib=this.ign(Ib,Q);n.dispose();B&&d.view.ub.Uc(B);Qd.Xnb&&Qd.Xnb.Pwf(d,Aa,Q,bb.node,Ib.id.toString(),bb.blob,ha);return Ib}ign(d,n){if(!d||!d.currentNode||19!==d.Jf)return null;const B=new Ke.a,Q=new Yb.DictionaryPropertySet;Q.setValue(Ya.a.zVh,n.id);Q.setValue(Ya.a.CVh,n.version);Q.setValue(Ya.a.AVh,n.store);
Q.setValue(Ya.a.BVh,n.storeType);B.setValue(Ya.a.Ioc,20);B.setValue(Ya.a.XMb,n.instanceId);B.setValue(Ya.a.yVh,Q);B.setValue(Ya.a.wVh,n.isContent);d.pg(B,2);d.yk(B);return B}saveSettings(d,n,B){var Q=d.ka(Ya.a.akf,null);let ha=0;var Aa=Q?Q.length:0;const bb=[];for(var Ib=0;Ib<Aa;Ib++){var oc=Q.K(Ib),Ac=oc.Uf(Ya.a.Yjf);if(Ac in n){const ad=d.ed,sd=new fb.a;sd.setValue(Ya.a.Zjf,n[Ac]);Ac=ad.Mv(sd,null);oc.setValue(Ya.a.$jf,Ac);ha+=1}bb.push(oc)}if(B&&ha!==B.length)for(Q=0;Q<B.length-ha;Q++)Aa=new Yb.DictionaryPropertySet,
Ib=B[ha+Q],oc=d.ed,Ac=new fb.a,Ac.setValue(Ya.a.Zjf,n[Ib]),oc=oc.Mv(Ac,null),Aa.setValue(Ya.a.Yjf,Ib),Aa.setValue(Ya.a.$jf,oc),bb.push(Aa);return new hb.a(Tb.CommonProperties.kf.id,bb)}}Qd.Xnb=null;Object(D.a)(Qd,"AddinEditor",null,[202]);var Gg=e(905);class Xh{constructor(d){this.eee={};this.Zc=d}k2k(d){if(d){var n=d.properties.ka(Ya.a.XMb,"");this.eee[n]=d}}saveSettings(d,n){if(!n||!Hb.a(n))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(!(d.instanceId in this.eee))return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;
this.eTo(this.eee[d.instanceId],n);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}eTo(d,n){const B=this.Zc.Vc(15);B.Eb(d);n=(new Qd(null,null)).saveSettings(d,n,Hb.a(n));d.setValue(Ya.a.akf,n);B.dispose()}fKf(d){if(!d)return null;d=this.eee[d.instanceId];let n={};d&&(n=(new Gg.a(d)).getSettings());return n}}Object(D.a)(Xh,"SaveSettingsHelper",null,[]);class lh{constructor(d,n,B){this.Bk=d;this.z_=n;this.iSk=B}activate(d,n){var B=n.ka(Ya.a.XMb,null);B||(B=String.format("{{{0}}}",Ze.a.create()),
n.setValue(Ya.a.XMb,B));var Q=new Gg.a(n);B=Q.getSettings();Q=Q.m$d();B=new Kk.a(Q.instanceId,Q.id,Q.version,Q.store,Q.storeType,B);B.div=d;B.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;B.osfControlType=Q.isContent?OSF.OsfControlType.DocumentLevel:OSF.OsfControlType.ContainerLevel;this.z_.add(B,Q.id);this.iSk.k2k(n);this.Bk.value.insertOsfControl(B)}}Object(D.a)(lh,"AddinActivator",null,[150]);var Ge=e(1689),sg=e(1636),Yf=e(884),Um=e(1581),gl=e(94),ah=e(472),Qg=e(457);const xh=
()=>{};class je extends Ge.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){super(d,n,B);this.ikg=Ac=>{if(Um.c(this.ng)){var ad={},sd=this.XK?this.XK.properties.yc.toString():this.ng.yc.toString();ad[ah.a.nodeId]=this.XK?this.XK.id.toString():this.ng.id.toString();ad[ah.a.classId]=sd;ad[Qg.a.Joc]=this.bFk;sd=qa.a.Rf(Cj.a.uH(this.ng),0);var wd=qa.a.Rf(Cj.a.pN(this.ng),1);ad[Qg.a.width]=sd;ad[Qg.a.height]=wd;Um.d(Ac,this.ng,this.xn,ad)&&Ac.Ytd()}};this.Wwd=!1;this.ng=Aa;this.bFk=bb;this.XK=Ib;this.xn=oc;this.dbo=
this.Myb.bind(this);this.pJp=this.wqa.bind(this)}Pwf(){new sg.a(document.body,this.dbo,this.pJp,this.J,!1,null)}PCa(d){this.Dod(d)}Dod(d){Yf.a.instance.BQg(this.ng.hk());this.ng.hk().Jg.lG(this.ikg,xh,d)}wqa(d){d&&!d.StatusCode&&this.ng.bK().Jg.Uub(d,gl.b(d.RevisionList[0].BaseId),!1,new Date,"");this.ng&&d?Yf.a.instance.SDc(this.ng.hk(),d.StatusCode):F.ULS.sendTraceTag(594929294,339,50,"Not able to notify upload notifier for completion")}yqa(){return!0}}Object(D.a)(je,"BackCompatImageUploader",Ge.a,
[]);class He{Pwf(d,n,B,Q,ha,Aa,bb){(new je(d,ib.TaskManager.instance,G.AFrameworkApplication.J,n,B,Q,ha,Aa,bb)).Pwf()}}Object(D.a)(He,"BackCompatImageUploaderWrapper",null,[391]);var Bf=e(610),uk=e(1104);class bm{create(){return new uk.a}}Object(D.a)(bm,"AppNodeFactory",null,[265]);var Ai=e(1105);class Pd{create(){return new Ai.a}}Object(D.a)(Pd,"AppPropNodeFactory",null,[265]);class ai{constructor(){this.M5e=[]}jDo(d){this.M5e.push(d)}cYc(d,n){if(!d||!d.count)return F.ULS.sendTraceTag(17356047,341,
15,"The GNC list passed into CheckOperation() should not be null or empty"),!1;for(let B=0;B<this.M5e.length;++B)if(!(0,this.M5e[B])(d,n))return!1;return!0}}Object(D.a)(ai,"ApiOperationChecker",null,[1106]);var Pg=e(936);class Vl{constructor(){this.sa=new dc.a;this.EDj=()=>{var d=(new Date).getTime();this.k_i()&&this.sa&&(this.sa.raiseEvent("GraphSpaceLoadContentReadyEventKey"),this.sa.dispose(),this.sa=null,Pg.a.zHj("GraphSpaceLoadContentReadyEventKey"));d=(new Date).getTime()-d;F.ULS.sendTraceTag(17585671,
341,50,"{0}",d)}}q_f(d){this.k_i()?(Pg.a.zHj(),d()):this.sa&&(this.sa.addHandler("GraphSpaceLoadContentReadyEventKey",d),Pg.a.O_k(this.EDj))}k_i(){let d=null;const n=Bf.a.Xm.tb.rd;n&&(d=new vc.a,d.set(n),this.wcg(d)||(d=null));return d&&d.ic(19)?!0:!1}wcg(d){Object($g.a)().bU(d);return d.ic(18)}}Object(D.a)(Vl,"InitializeHelper",null,[1107]);var fg=e(534);class um{setTimeout(d,n=0){return window.setTimeout(d,n)}clearTimeout(d){window.clearTimeout(d)}setInterval(d,n=0){return window.setInterval(d,
n)}clearInterval(d){window.clearInterval(d)}}Object(D.a)(um,"WindowTimer",null,[1105]);var oj=e(27),Dd=e(5);class pj{}pj.text="text";pj.table="table";pj.eYb="matrix";Object(D.a)(pj,"AppBindingType",null,[]);class Kh{}Kh.QWh="appBindingData";Kh.zfc="appInstanceId";Kh.KVd="appReferenceId";Object(D.a)(Kh,"AppConstants",null,[]);class Rc{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac=null){this.lB=this.hEd=null;this.nig=(ad,sd)=>{if(this.m0f){ad=this.cS.Xxi();var wd=new ma.a;for(var yd=0;yd<ad.count;++yd){var be=
ad.K(yd);be=this.cS.Klc(be);wd.add(be)}yd=new ma.a;be=new ma.a;for(var ye of sd.Fhi){sd=this.nKf(ye.id);for(let af=0;af<wd.count;++af){const Qf=new ma.a;for(var Qe of wd.K(af))sd===Qe.GS&&Qf.add(Qe);0<Qf.count&&(yd.add(ad.K(af)),be.add(Qf))}}if(0<be.count){ye=this.Zc.Vc(15);ye.Eb(this.cS.zna());for(Qe=0;Qe<be.count;++Qe)for(const af of be.K(Qe))(ad=this.n5d.Jlc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent))&&yd.K(Qe)&&ad.IDj(yd.K(Qe).instanceId,af.yY),this.cS.lvg(yd.K(Qe),af.yY);ye.dispose()}}};
this.cS=d;this.gr=n;this.pb=B;this.Zc=Q;this.oj=ha;this.R7=Aa;this.sTa=Ib;this.tI=bb;this.faa=Ac;this.m0f=!0;this.Lh=oc}get g8i(){return G.AFrameworkApplication.J.$("TableCellRowSelectionIsEnabled")}get fl(){return this.oj.value}get n5d(){this.hEd||(this.hEd=Wa.a.instance.resolve("WordEditor.AppsForOffice.WordEditorEventStore"));return this.hEd}set n5d(d){this.hEd=d}get Wge(){this.lB||(this.lB=Wa.a.instance.Wa("Box4.ContentControlConfigSettings"));return this.lB?this.lB.ii:!1}get J_i(){return G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingDataChangedEventIsEnabled")}VCa(d,
n){const B={};n=this.cS.Klc(n);for(var Q of n)if(Q.yY===d){d={};Q=({f0h:d}=this.Xyi(Q)).returnValue;if(Q!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:Q,YM:B};B[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]=d;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,YM:B}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,YM:B}}xyi(d,n){n=this.cS.Klc(n);for(const B of n)if(B.yY===d)return d=B,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Dnf:d};return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Dnf:null}}Xyi(d){const n={};let B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;n[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=d.yY;n[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=d.EQ;if(d.EQ===pj.table||d.EQ===pj.eYb){let Q=null;({root:Q,returnValue:B}=this.iNi(d));B===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(n[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount]=oj.TableReader.Nh(Q),n[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=
oj.TableReader.Hg(Q),d.EQ===pj.table&&(d=this.tI.Nab(Q),n[OSF.DDA.Marshaling.AppBindingKeys.HasHeaders]=0<d,n[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=oj.TableReader.Hg(Q)-d))}return{returnValue:B,f0h:n}}vil(d){let n=null;const B=({Ata:d}=this.qLf(d)).returnValue;if(B!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:B,graphNode:n};n=d.je.KQ();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,graphNode:n}}QTm(d,n){let B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Q=null;(d=this.cS.VCa(d,n))?{root:Q,returnValue:B}=this.iNi(d):B=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:B,root:Q}}iNi(d){let n=null,B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;d?d.EQ!==pj.table&&d.EQ!==pj.eYb?B=OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType:(d=this.gr.getById(this.TXa(d.GS)))?{Fq:n,returnValue:B}=this.Fbe(d):B=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:B=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;
return{returnValue:B,root:n}}Fbe(d){let n=null;var B=d.ow;d=d.EB;B=B&&d&&B.equals(d)?(n=this.fl.Mb(B))&&14===n.type?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;return{returnValue:B,Fq:n}}r5c(d,n,B){var Q=null;d=({Ata:Q}=this.q5c(n,d)).returnValue;return d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?d:(Q=Q.sH(!0))?(B.push(...Q.toArray()),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}QJf(d){const n=[];if(d=this.cS.Klc(d))for(const B of d){let Q;({f0h:Q}=this.Xyi(B)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&n.push(Q)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,e0h:n}}lHj(d,n,B=null){var Q=this.cS.VCa(n,d);if(!Q)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var ha=Q.GS;Q=this.TXa(ha);const Aa=this.gr.getById(Q);if(!Aa)return F.ULS.sendTraceTag(17581638,341,10,"The content control bound id : {0} did not exist.",
Q),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;ha=this.cS.tom(ha);d=this.cS.lvg(n,d);d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(B&&B(),Aa.zie&&1===ha.count?this.gr.J0b(Q):Aa.frc&&1===ha.count&&(Aa.frc=!1));return d}IFa(d){let n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;d=this.TXa(d.GS);this.gr.getById(d)?this.gr.J0b(d)&&(n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return n}GOl(){let d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;
var n=2;let B=0;const Q=[];for(var ha of this.pb.ob)Q.push(...ha.toArray());const Aa=Q[0];ha=Q[Q.length-1];2===Q.length&&Aa.contextId===ed.a.Nd&&ha.contextId===ed.a.od&&(ha=Aa);const bb=this.gr.ZQ(Aa,ha,0);if(bb&&0<bb.count)return B=bb.K(0).id,bb.K(0).frc=!0,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,yy:B};if(Aa.contextId===ed.a.Nd&&(1===Q.length||2===Q.length))d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{id:B,returnValue:n}=this.gr.k8a(Aa);else if((this.g8i||1===this.pb.ob.length)&&
Aa.contextId===ed.a.paragraph&&ha.contextId===ed.a.paragraph){let Ib;if(!({BFe:n}=this.p$j(Aa.node)).returnValue||!({BFe:Ib}=this.p$j(ha.node)).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,yy:B};d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;({id:B,returnValue:n}=this.gr.Msa(n.id,Ib.id))}if(d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:d,yy:B};if(n)return F.ULS.sendTraceTag(17585562,341,15,"{0}",{["ccError"]:n,["errMsg"]:"Unable to create content control for selection"}),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,yy:B};this.gr.getById(B).zie=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,yy:B}}Fzo(d,n){this.Lh.NK(n.id,d.Ya.node.id,!0);this.Lh.NK(n.id,d.hd.node.id,!1);({returnValue:d}=this.gr.Msa(d.Ya.node.id,d.hd.node.id));return d?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}p$j(d){let n=d;if(!d||12!==d.type)return{returnValue:!1,BFe:n};d=vc.a.kb(d);
if(d.Ib(14))if(this.R7.Cje(d.xd(14)))n=d.currentNode;else return{returnValue:!1,BFe:n};return{returnValue:!0,BFe:n}}Itm(d){var n;return(n=this.gr.getById(d))?(d=this.fl.Mb(n.ow),n=this.fl.Mb(n.EB),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,p2j:d,Xoi:n}):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,p2j:null,Xoi:null}}Btm(d){const n=this.gr.getByTitle(d);if(!n.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound,yy:0};if(1<n.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound,
yy:0};d=n.K(0).id;n.K(0).frc=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,yy:d}}q5c(d,n){d=this.cS.VCa(d,n);return this.qLf(d)}$Rh(d,n){const B=this.cS.VCa(d,n.yY);let Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(B){if(!this.gr.getById(this.TXa(n.GS)))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(B.GS===n.GS){if(n.EQ===B.EQ)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else Q=this.lHj(n.yY,d);if(Q!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return Q}return this.cS.UXi(d,
n)}oKf(d,n){if(d=this.cS.VCa(d,n)){if(d=this.gr.getById(this.TXa(d.GS)))return d=d.getText(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,text:d};d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:d,text:null}}rCg(d,n,B){(d=this.cS.VCa(d,n))?d.EQ!==pj.text?B=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType:(d=this.TXa(d.GS),B=(d=this.gr.getById(d))?d.RBe(B)?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):B=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return B}Wyi(d,n,B,Q){let ha=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Aa,bb={};({root:Aa}=this.QTm(d,n)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Q.isPartialTable&&this.R7.l8i(Aa)?ha=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported:{LTl:bb,returnValue:ha}=this.R7.RTm(Aa,B,Q));return{returnValue:ha,
Z4j:bb}}npm(d,n){let B="";const Q=[];(d=this.r5c(n,d,Q))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&({UYa:B,returnValue:d}=this.sTa.mMf(Q,!0));return{returnValue:d,UYa:B}}tSj(d,n,B,Q,ha,Aa,bb){let Ib=null,oc=null;if((d=({Ata:Ib}=this.q5c(d,n)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=({Fq:oc}=this.Fbe(Ib)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(Aa.isPartialTable&&this.R7.l8i(oc))d=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported;
else if({Dpp:Aa,returnValue:d}=this.R7.Dxp(oc,B,Aa),d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.R7.sAn(B,oc,Aa,ha,Q)){if({Tpp:Q,returnValue:d}=this.R7.umo(Aa,ha,Q),d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){bb(this.tI.z_o(Ib,Q[0],Q[1])?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,B?"table":"matrix");return}}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize;bb(d,B?"table":"matrix")}lQm(){const d=new ma.a;
var n=new ma.a;for(var B of this.pb.ob)n.addRange(this.gr.ZQ(B.Ya,B.hd,1));if(0<n.count){B=this.cS.yyi();vc.a.kb(this.pb.iX);const Aa=this.Qyn(),bb={};for(var Q of n)bb[Q.id.toString()]=Q;for(const Ib of Object.keys(bb)){n=bb[Ib];for(const oc of B){var ha=oc[Kh.QWh];if(this.TXa(ha.GS)===n.id){Q={["appInstanceId"]:oc[Kh.zfc]};const Ac=this.cS.m8d(oc[Kh.zfc]);Ac&&(Q[Kh.KVd]=Ac.$n);Q[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ha.yY;Q[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=ha.EQ;ha.EQ===pj.table&&
n.ow&&this.g8i&&Aa&&(ha=null,{S3j:ha}=this.R7.AQm(this.fl.Mb(n.ow)),Q[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=ha);d.add(Q)}}}}return d}som(d){const n=new ma.a;var B=this.cS.yyi();for(const Q of B)if(B=Q[Kh.QWh],this.TXa(B.GS)===d){const ha={["appInstanceId"]:Q[Kh.zfc]},Aa=this.cS.m8d(Q[Kh.zfc]);ha[Kh.KVd]=Aa.$n;ha[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=B.yY;ha[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=B.EQ;n.add(ha)}return n}JFo(d,n){d&&(d=d.instanceId,this.n5d.Jlc(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent).removeHandler(d,
null,n))}IFo(d,n){d&&(d=d.instanceId,this.n5d.Jlc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent).removeHandler(d,null,n))}Ale(d,n,B){d=this.cS.m8d(d);n=this.cS.VCa(d,n);F.ULS.sendTraceTag(16798856,341,50,"{0}",{["method"]:B,["appId"]:d?d.$n:null,["bindingType"]:n?n.EQ:null})}TXa(d){d=Number.parseInvariant(d);return 2147483648>d?d:d+-4294967296}nKf(d){return-1<d?d.toString():(d- -4294967296).toString()}Cqm(d){let n=0;(d=this.fl.Mb(d))&&(n=d.ka(Dd.a.yy,0));return n}UAo(){this.gr.p1k(this.nig)}bzn(d){let n=
null;return({Ata:n}=this.qLf(d)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess||!n.Pg&&!this.Wge?!1:n.isEditable&&n.isSupported}Qyn(){const d=vc.a.kb(this.pb.iX);if(1>=d.Bs())return!0;var n=d.ue();let B=null;for(;n;){n=vc.a.kb(n);if(!n.Ib(16))return!1;if(!B)B=n.xd(16);else if(B!==n.xd(16))return!1;n=d.px()}return!0}qLf(d){let n=null;if(!d)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Ata:n};d=this.TXa(d.GS);return(n=this.gr.getById(d))?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Ata:n}:{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Ata:n}}hzf(d,n,B){let Q=null;(d=({Ata:Q}=this.q5c(n,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=this.tI.dWl(Q)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);B(d)}zif(d,n,B,Q){let ha=null;var Aa=null;(d=({Ata:ha}=this.q5c(n,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=({Fq:Aa}=this.Fbe(ha)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(Aa=oj.TableReader.Nh(Aa),d=this.R7.nln(Aa,B)?this.tI.Bcl(ha,B)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);Q(d)}Chf(d,n,B,Q,ha,Aa){let bb=null;var Ib=null;(d=({Ata:bb}=this.q5c(n,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=({Fq:Ib}=this.Fbe(bb)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=oj.TableReader.Hg(Ib),n=this.tI.Nab(Ib),Ib=
null,d=({U4j:Ib}=this.R7.mln(n,d-n,B,Q,ha)).returnValue?this.tI.icl(bb,Ib)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);Aa(d)}Wzi(d){return d?this.faa.xFi(d):new ma.a}i6c(d,n){if(d.Bb(n))return d.K(n);const B=RegExp("\t","g");for(const Q of d)if(Q.key.replace(B," ")===n)return Q.value;return null}}Object(D.a)(Rc,"AppBindingHelper",null,[1104]);class ri extends Sys.EventArgs{constructor(d,
n,B){super();this.Mic=d;this.Iee=n;this.tfg=B}}Object(D.a)(ri,"OnDataNodeInsertedEventArgs",Sys.EventArgs,[]);class Wi extends Sys.EventArgs{constructor(d,n,B,Q){super();this.Mic=d;this.Iee=n;this.hoj=B;this.tfg=Q}}Object(D.a)(Wi,"OnDataNodeReplacedEventArgs",Sys.EventArgs,[]);var lm=e(373);class Sk{constructor(d,n,B){this.yLa=B.dYa(d);this.Xxd=n}get Mic(){return this.yLa.id}}Object(D.a)(Sk,"CustomXmlNodeList",null,[]);class kf{constructor(d,n){this.Vs=new lm.a;this.sGd=new ma.a;this.IDh=new ma.a;
this.smh=new ma.a;this.Kvk=d;this.rm=n}add(d,n){if(!n)return null;if(this.sGd.count>=this.Kvk.value){var B=this.sGd.K(0);this.$ii(B);this.smh.add(B);F.ULS.sendTraceTag(9187593,341,50,"Put the first custom xml node list id: {0} in exceeded quota array as the added custom xml touches the quota which is 1024",B)}B=Ze.a.create().toString();this.Vs.add(B,new Sk(d,n,this.rm));this.sGd.add(B);return B}get(d){const n=this.Vs.K(d);if(void 0===n||null===n){if(-1<this.IDh.indexOf(d))throw F.ULS.sendTraceTag(9187594,
341,50,"Custom xml node list id: {0} is in out of date array",d),Error.invalidOperation(kf.Ulg);if(-1<this.smh.indexOf(d))throw F.ULS.sendTraceTag(9187595,341,50,"Custom xml node list id: {0} is in exceeded quota array where the quota is 1024",d),Error.invalidOperation(kf.Vqi);return null}if(this.rm.dYa(n.Mic)!==n.yLa)throw this.zhj(d),F.ULS.sendTraceTag(9187596,341,50,"Put custom xml node list id: {0} in out of date array as the custom xml document has been changed",d),Error.invalidOperation(kf.Ulg);
return n.Xxd}zhj(d){this.$ii(d);this.IDh.add(d)}$ii(d){this.Vs.remove(d);this.sGd.remove(d)}}kf.Vqi="exceedQuota";kf.Ulg="outOfDate";Object(D.a)(kf,"CustomXmlNodeListCache",null,[1079]);class tp{constructor(){this.NodeListCacheId=this.CustomXmlId=null;this.NodeIndex=0}}Object(D.a)(tp,"CustomXmlNodePointer",null,[]);class jn{constructor(d,n){this.sa=new dc.a;this.rm=d;this.u8b=n}OTb(d){let n,B=null,Q=null;const ha=({Xxd:n}=this.xPi(d)).returnValue;if(void 0===n||null===n)return{returnValue:ha,yLa:Q,
CDb:B};B=n[d.NodeIndex];Q=this.rm.dYa(d.CustomXmlId);return{returnValue:void 0!==Q&&null!==Q&&void 0!==B&&null!==B?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,yLa:Q,CDb:B}}xPi(d){let n=null;try{n=this.u8b.get(d.NodeListCacheId)}catch(B){return{returnValue:this.$xm(B),Xxd:n}}return{returnValue:n?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,Xxd:n}}$7j(d,n){const B=[],Q=this.u8b.add(d,n);
let ha;for(let Aa=0;Aa<n.length;Aa++){ha=n[Aa];const bb=new tp;bb.CustomXmlId=d;bb.NodeListCacheId=Q;bb.NodeIndex=Aa;B.push(this.k9d(bb,ha))}return B}k9d(d,n){const B=this.rm.dYa(d.CustomXmlId),Q={};Q[OSF.DDA.Marshaling.DataNodeProperties.Handle]=d;Q[OSF.DDA.Marshaling.DataNodeProperties.BaseName]=B.getNodeBaseName(n);Q[OSF.DDA.Marshaling.DataNodeProperties.NamespaceUri]=B.getNodeNamespaceURI(n);Q[OSF.DDA.Marshaling.DataNodeProperties.NodeType]=B.getNodeType(n);return Q}fif(d,n){this.sa.addHandler(d,
n)}Mvg(d,n){this.sa.removeHandler(d,n)}yuo(d,n){d=this.k9d(n,d);n=new ri(n.CustomXmlId,!1,d);return this.ODj(jn.Mjg,n)}Emd(d,n,B){n=this.k9d(B,n);n[OSF.DDA.Marshaling.DataNodeProperties.Handle]=null;d=this.k9d(B,d);B=new Wi(B.CustomXmlId,!1,n,d);return this.ODj(jn.Pjg,B)}ODj(d,n){try{this.sa.raiseEvent(d,n)}catch(B){return F.ULS.sendTraceTag(19489935,344,10,"RaiseNodeEvent({0}): action failed. Exception message: {1}",d,B.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}$xm(d){return 0>
d.message.indexOf(":")?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:d.message.split(":")[1].trim()===kf.Ulg?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate:d.message.split(":")[1].trim()===kf.Vqi?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}jn.Mjg="OnNodeInsertedInfoReceivedHandlerKey";jn.Pjg="OnNodeReplacedInfoReceivedHandlerKey";jn.Nrj="OnNodeDeletedInfoReceivedHandlerKey";Object(D.a)(jn,"CustomXmlHelper",null,
[1102]);var Em=e(582),Vm=e(1085),Rg=e(1023),rb=e(1342),Sb=e(259);class Tc extends Ig.a{constructor(){super();this.FileId=null;this.IsSecondaryRevision=!1}Hn(){return Df.a.$zl}static construct(d,n){const B=new Tc;B.FileId=d;B.IsSecondaryRevision=n;return B}}Object(D.a)(Tc,"CloseFileAgaveAsyncRequest",Ig.a,[]);class pd extends Ig.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.SliceSize=this.FileType=0}Hn(){return Df.a.O5c}static construct(d,n,B,Q){const ha=new pd;ha.FileId=d;ha.IsCoauthorable=
n;ha.FileType=B;ha.SliceSize=Q;return ha}}Object(D.a)(pd,"GetFileAgaveApiRequest",Ig.a,[]);class Ae extends Ig.a{constructor(){super();this.FileId=null;this.SliceIndex=0;this.IsSecondaryRevision=!1}Hn(){return Df.a.Rym}static construct(d,n,B){const Q=new Ae;Q.FileId=d;Q.SliceIndex=n;Q.IsSecondaryRevision=B;return Q}}Object(D.a)(Ae,"GetFileSliceRequest",Ig.a,[]);class ne{constructor(d,n){this.Brc=d;this.handler=n}}Object(D.a)(ne,"CloseAsyncRequestData",null,[]);class Oe{constructor(d,n,B,Q,ha=!1){this.b5f=
!1;this.Rsi=d;this.fileSize=n;this.NHg=B;this.XFf=Q;this.Brc=ha}}Object(D.a)(Oe,"DocumentFile",null,[]);class Of{constructor(d,n,B,Q){this.alf=d;this.fileType=n;this.NHg=B;this.handler=Q}}Object(D.a)(Of,"GetFileRequestData",null,[]);class Yg{constructor(d,n,B,Q){this.controlId=d;this.Ehp=n;this.Brc=B;this.handler=Q}}Object(D.a)(Yg,"GetFileSliceRequestData",null,[]);class If{constructor(d,n,B,Q,ha,Aa,bb){this.Sn=this.tjb=this.r5a=this.jTa=null;this.NWo=Ib=>{if(this.ZU&&this.omb){var oc=pd.construct(this.ZU(),
this.omb.t$d(this.zsk),Ib.fileType,Ib.NHg);this.jTa=new Vm.a;this.jTa.Ls=oc;this.jTa.status=Rg.a.xK;this.jTa.MH="GetFileAgave";oc=this.QU(()=>{this.l2c();if(2===this.jTa.statusCode&&this.jTa.rl&&this.jTa.rl.length&&this.jTa.rl[0]){var Ac=this.jTa.rl[0];this.x1i(Ib.alf)?(F.ULS.sendTraceTag(7123615,344,15,"App {0} has reach the limit of number of cached files.",Ib.alf),Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit,null)):(Ac=this.Xdi(Ib.alf,Ac.FileSize,Ib.NHg,null,Ac.IsSecondaryRevision),
Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ac))}else F.ULS.sendTraceTag(7123614,344,15,"Fail to obtain the file."),Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)});oc.yI(this.jTa);oc.h1()}else this.l2c(),Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.OWo=Ib=>{if(this.ZU&&this.omb){var oc=Ae.construct(this.ZU(),Ib.Ehp,Ib.Brc);this.r5a=new Vm.a;this.r5a.Ls=oc;this.r5a.status=Rg.a.xK;oc=this.QU(()=>{this.l2c();if(2===this.r5a.statusCode&&
this.r5a.rl&&this.r5a.rl.length&&this.r5a.rl[0]){var Ac=this.r5a.rl[0];"undefined"===typeof Ac.SliceData?(F.ULS.sendTraceTag(20711200,344,15,"Undefined error possibly because we failed to get the file slice data"),Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)):Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ac.SliceData)}else F.ULS.sendTraceTag(20711199,344,15,"Fail to obtain the file."),Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,
null)});oc.yI(this.r5a);oc.h1()}};this.sWo=Ib=>{var oc=Ib.Brc;this.ZU&&this.omb&&(oc=Tc.construct(this.ZU(),oc),this.tjb=new Vm.a,this.tjb.Ls=oc,this.tjb.status=Rg.a.xK,oc=this.QU(()=>{this.l2c();2===this.tjb.statusCode&&this.tjb.rl&&this.tjb.rl.length&&this.tjb.rl[0]?Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):F.ULS.sendTraceTag(20854626,344,15,"Fail to obtain the file.")}),oc.yI(this.tjb),oc.h1())};this.mZb=Ib=>{this.l2c();F.ULS.sendTraceTag(7123616,344,15,"Fail to force save the file.");
Ib.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.YEo=(Ib,oc)=>{this.bIa.Bb(oc)&&this.bIa.remove(oc)};this.QU=d;this.ZU=n;this.omb=B;this.zsk=Q;this.bIa=new ff.a;this.qe=ha;this.za=Aa;this.Ai=bb;this.Ai.ljf(this.YEo)}Owm(d,n,B,Q){this.qe&&(this.Sn=this.qe.rg("UserAction","GetFileAgaveApi"));d=new Of(d,n,B,Q);this.hIf(d)}Twm(d,n,B,Q){this.qe&&(this.Sn=this.qe.rg("UserAction","GetFileSliceAgaveApi"));d=new Yg(d,n,B,Q);this.cjm(d)}rWo(d,n,B,Q){this.qe&&(this.Sn=this.qe.rg("UserAction",
"CloseFileAsyncApi"));n=new ne(n,Q);this.ajm(n);this.nHj(d,B)}hIf(d){fg.a.rT(rb.a.O5c,!1,this.NWo,this.mZb,d)}cjm(d){fg.a.rT(rb.a.O5c,!1,this.OWo,this.mZb,d)}ajm(d){fg.a.rT(rb.a.O5c,!1,this.sWo,this.mZb,d)}Xdi(d,n,B,Q,ha=!1){const Aa=If.Mvk++;n=new Oe(Aa,n,B,Q,ha);this.x1k(d,n);return n}l2c(){this.Sn&&(this.Sn.stop(),this.Sn=null)}x1k(d,n){this.bIa.Bb(d)||this.bIa.W(d,new Sb.a);this.bIa.K(d).W(n.Rsi,n)}oCi(d,n){let B=null;this.bIa.Bb(d)&&({value:B}=this.bIa.K(d).Nc(n,B));B||F.ULS.sendTraceTag(7123617,
344,15,"File {0}:{1} doesn't exist",d,n);return B}x1i(d){return this.bIa.Bb(d)?2<=this.bIa.K(d).count:!1}nHj(d,n){return this.bIa.Bb(d)?this.bIa.K(d).remove(n)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}static LWd(d){return(new Em.a).Bca(0,d)}}If.Mvk=0;Object(D.a)(If,"GetFileApiHelper",null,[1078]);var Ph=e(174),Se=e(3),Cg=e(63),Vg=e(536),qj=e(60),Tn=e(692),Wp=e(412),bj=e(106),Kj=e(1098),
Tj=e(215),oh=e(156),Fc=e(61),Io=e(886),Rl=e(722),tg=e(208),Dq=e(662);class Gp extends tg.a{constructor(d,n){super(new Dq.a,d,n);this.qec=null}get $na(){return 192}createElement(d){d=super.createElement(d);this.qec.appendChild(d);return d}Zl(d){d=super.Zl(d);this.qec.appendChild(d);return d}get Lrp(){return this.qec.cloneNode(!0)}fZb(){super.fZb();this.qec=Io.a.createElement(this.container.ownerDocument,Rl.a.div)}dvc(){super.dvc();this.qec=null}dispose(){super.dispose();this.qec=null}}Object(D.a)(Gp,
"HtmlDataRenderingView",tg.a,[]);class Hp{get Zf(){return null!=this.C9g?this.C9g:this.C9g=Wa.a.instance.Wa("Box4.Styles.StyleSettings")}constructor(d,n,B,Q,ha){this.pb=d;this.sjb=n;this.ga=B;this.REk=Q;this.CTc=ha}OAe(d,n,B,Q){if(!d.length||!B)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;const ha=new Ph.Selection(d,n);try{this.pb.y1b(()=>{this.pb.Uc(ha)})}catch(bb){return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}const Aa=new Yb.DictionaryPropertySet;Aa.setValue(oh.a.PZ,
B);Aa.setValue(oh.a.y3a,!0);return 32===this.ga.Zb(Se.a.$sa,1,Aa)?(this.ga.Oia(null,Se.a.$sa,Aa,bb=>{const Ib=Aa.ka(oh.a.Vxj,null);Q(32===bb.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ib)}),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}mMf(d,n){let B="";if(!d.length)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,UYa:B};if(!this.sjb.qBn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
UYa:B};let Q=new Mc.GraphTransaction(7);const ha=new Ph.Selection(d,n);let Aa=null,bb=null;try{this.pb.y1b(()=>{this.pb.Uc(ha,void 0,!0);this.sjb.efk();Q.Eb(this.sjb.kqa);Aa=d[0].node.ed;bb=this.sjb.kqa.ed;this.sjb.B0d(Object(Cg.a)().Ve.ke);this.sjb.dfk()})}catch(wd){return Q.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,UYa:B}}Q.dispose();var Ib=[];n=new vc.a;n.set(this.sjb.a6j);for(var oc=n.ue();oc;)Ib.push(oc),oc=n.LAf();if(0<Ib.length){this.EIl(Aa,bb);var Ac=new vc.a;
Ac.set(d[0].node);if(!Ac.Ib(7))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,UYa:B};oc=Ac.Mu(8);n=this.v_m(this.sjb.a6j,Ib);Q=new Mc.GraphTransaction(7);Q.Eb(n);Ac=new vc.a;Ac.set(Ib[0]);if(!Ac.Ib(8))return Q.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,UYa:B};Ib=Ac.Mu(8);if(this.Zf.zl){oc=(new Vg.a).pna(oc);Ac=(new Vg.a).pna(Ib);for(var ad=0;ad<oc.ix;ad++){var sd=oc.uha(ad);Ac.Mhf(qj.a.ESm(sd))}Ac.zze(Ib)}else{oc=(new Vg.a).Oca(oc);Ac=(new Vg.a).Oca(Ib);
for(ad=0;ad<oc.ix;ad++)sd=oc.nDa(ad),Ac.PTh(qj.a.BSm(sd));Ac.fEg(Ib)}Ib=new Gp(this.REk,this.CTc);oc=document.createElement("div");Ib.egc(oc);Ib.qC(n);Q.H2b(Ib.Lc);Q.dispose();B+=Ib.Lrp.innerHTML.replace('\\"','"');Ib.dispose();Ib=null}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,UYa:"<HTML>\r\n<HEAD></HEAD>\r\n<BODY>\r\n"+B+"\r\n</BODY>\r\n</HTML>"}}v_m(d,n){const B=new Tn.a;vc.a.kb(d).pg(B,1);return this.u_m(B,n)}u_m(d,n){var B=!1;let Q,ha=null;1===n.length&&10===n[0].type?
(B=!0,ha=Q=n[0]):Q=new Wp.a(new bj.a(10,Fc.a.gka));d=vc.a.kb(d);d.pg(Q,1);d.yk(Q);if(B)return Q;B=[];for(d=0;d<n.length;d++){const Aa=n[d];23===Aa.type?0<B.length&&(ha=this.RQi(Q,B),B=[]):B.push(Aa)}0<B.length&&(n=this.RQi(Q,B),ha=ha?Q:n);return ha}RQi(d,n){var B=!1;let Q;1===n.length&&23===n[0].type?(B=!0,Q=n[0]):Q=new Kj.a;d=vc.a.kb(d);d.pg(Q,1);d.yk(Q);if(B)return Q;for(B=0;B<n.length;B++){const ha=n[B];ha.id=Jh.a.nil;d.pg(ha,1)}return Q}EIl(d,n){d=d.Dn;d=Object(Tj.d)(d).K7f();var B=n.EIg();for(var Q=
0;Q<d.length;Q++){var ha=d[Q];if(ha.yc===Fc.a.hpa){if(!n.Mna(ha.id)){var Aa=ha.clone();n.Mv(Aa,ha.id)}}else ha.yc===Fc.a.q2a?(Aa=ha.clone(),Aa.id=ha.id,B.iBa(Aa)):ha.yc===Fc.a.JBb&&(Aa=ha.clone(),Aa.id=ha.id,B.iBa(Aa))}d=n.QGf();d=Object(Tj.d)(d).K7f();for(B=0;B<d.length;B++)Q=d[B],Q.yc===Fc.a.q2a?n.Mna(Q.id)||(ha=Q.clone(),ha.id=Q.id,n.mU(ha)):Q.yc!==Fc.a.JBb||n.Mna(Q.id)||(ha=Q.clone(),ha.id=Q.id,n.Bnd(ha))}}Object(D.a)(Hp,"HtmlDataGetSetProvider",null,[1077]);var ic=e(151);class Dj{constructor(d){this.u6a=
d}getOoxml(d,n,B){d=this.Y1h(d);this.u6a.qIi(d,n,B)}Qyg(d,n,B,Q){this.u6a.Qyg(d,n,B,Q)}xBe(d,n,B,Q,ha,Aa,bb,Ib){d=this.Y1h(d);this.u6a.NUj(d,n,B,Q,ha,Aa,bb,Ib)}ymc(d,n){return this.u6a.ymc(d,n)}Y1h(d){if(Nc.a.jg(d))return null;d=[new Ph.Selection(d,!0)];return new ic.SelectionCollection(d,0)}}Object(D.a)(Dj,"OoxmlRangeManager",null,[1076]);var Fm=e(527);class Il extends Fm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=null;this.WordOperationId=this.InsertLocationWithContentControl=
this.ContentControlId=0}Hn(){return Df.a.Jbo}static construct(d,n,B,Q,ha,Aa){const bb=new Il;bb.FileId=d;bb.IsCoauthorable=n;bb.AnchorData=B;bb.ContentControlId=Q;bb.InsertLocationWithContentControl=ha;bb.WordOperationId=Aa;return bb}}Object(D.a)(Il,"OoXmlGetRequest",Fm.a,[]);class Mk extends Fm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=0}Hn(){return Df.a.Kbo}static construct(d,n,B,Q,ha){const Aa=new Mk;Aa.FileId=d;Aa.IsCoauthorable=
n;Aa.Ooxml=Q;Aa.AnchorData=B;Aa.WordOperationId=ha;return Aa}}Object(D.a)(Mk,"OoXmlRetrieveStylesRequest",Fm.a,[]);class Eq extends Fm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0;this.InsertFileOptions=null}Hn(){return Df.a.Lbo}static construct(d,n,B,Q,ha,Aa,bb,Ib){const oc=new Eq;oc.FileId=d;oc.IsCoauthorable=n;oc.Ooxml=Q;oc.AnchorData=B;oc.ContentControlId=ha;oc.InsertLocationWithContentControl=
Aa;oc.WordOperationId=bb;oc.InsertFileOptions=Ib;return oc}}Object(D.a)(Eq,"OoXmlSetRequest",Fm.a,[]);var ge=e(26),Lj=e(39),Xp;(function(d){d[d.unknown=-1]="unknown";d[d.main=0]="main";d[d.B9p=1]="footnote";d[d.Y6p=2]="endnote";d[d.Ixq=3]="textbox";d[d.comment=4]="comment";d[d.c9c=5]="headerFooter"})(Xp||(Xp={}));Object(D.b)("DocumentKindType",Xp);var Cl=e(1448),Yp=e(1549);class Qo{constructor(d,n,B,Q,ha,Aa){this.oM=d;this.N8=n;this.Oqd=B;this.AGa=Q;this.ooxml=ha;this.Ilo=Aa}}Object(D.a)(Qo,"OoxmlSelectionManagerCallBackData",
null,[]);class oq{constructor(d){this.AN=null;this.AN=d}}Object(D.a)(oq,"SerializableOoxmlData",null,[]);class Fk{constructor(d,n,B,Q,ha,Aa){this.LJh=WacWordeditorStrings.Inserting;this.onFailure=bb=>{this.W0(bb.AGa);bb.N8&&bb.N8(3)};this.iE=bb=>{var Ib=bb.Oqd.rl;Ib?Ib.length?(Ib=bb.Oqd.rl[0])?Ib.StatusCode?this.FCn(bb.ooxml)?this.rZb("ooxml failed for an unknown reason",bb,0):this.rZb("Agave sent malformated OOXML",bb,7):bb.Ilo(bb):this.rZb("ooxml response is null",bb,0):this.rZb("response list is empty",
bb,0):this.rZb("response list is null",bb,0)};this.Glo=bb=>{const Ib=bb.Oqd.rl[0];Ib.RetrievedStyles?(bb.oM&&bb.oM(Ib.RetrievedStyles),this.W0(bb.AGa)):this.rZb("retrieved styles is null",bb,0)};this.tlo=bb=>{const Ib=bb.Oqd.rl[0];Ib.OoXml?(bb.oM&&bb.oM(Ib.OoXml),this.W0(bb.AGa)):this.rZb("ooxml is null",bb,0)};this.Hlo=bb=>{const Ib=bb.Oqd.rl[0];ib.TaskManager.instance.pc(new tb.a(0,1,0,()=>{this.wGb(rb.a.Alg,!0,()=>{Nf.a.wf.mFe(()=>{var oc=Ib.InsertedContentInfo;if(""!==oc){oc=Rb.b(oc);var Ac=Yp.a(oc.AN);
oc=Ac.C0a;const ad=Yp.d(Ac.EW),sd=Ac.jPa;Ac=Yp.d(Ac.P9);oc=oc.toString()+"|"+Rb.c(ad)+"|"+sd.toString()+"|"+Rb.c(Ac);bb.oM(oc)}else bb.oM(oc)});this.W0(bb.AGa)},(oc,Ac)=>{this.W0(bb.AGa);this.pOa("we succeeded to set ooxml but failed in the second save, most likely, the user can't see the change yet. [errorCode: {0}]",Ac);bb.oM(null)},null,this.LJh,null)}))};this.nY=d;this.olb=n;this.ZU=B;this.VAa=Q;this.wGb=ha;this.huh=Aa}qIi(d,n,B){this.jri(d,n,B,"ForceSaveAndGetOoXmlForSelection",!1,this.tlo,null,
null,0,0,0,null,(Q,ha,Aa)=>Il.construct(Q,ha,Aa,0,0,0))}Qyg(d,n,B,Q){const ha=this.nY.rg("Task","ForceSaveAndRetrieveStyles");try{const Aa=Mk.construct(this.ZU(),this.olb(),"{}",d,n),bb=Object.assign(new Vm.a,{Ls:Aa,status:Rg.a.xK,MH:"OoxmlRetrieveStyles"}),Ib=new Qo(B,Q,bb,ha,d,this.Glo);this.wGb(rb.a.Alg,!1,this.iE,this.onFailure,Ib,null,bb)}catch(Aa){this.pOa("failed in the call to retrieveStyles. most likely during ForceSave. [e:{0}] [callstack: {1}]",Aa.message,Aa.stack),this.W0(ha),Q(0)}}NUj(d,
n,B,Q,ha,Aa,bb,Ib){void 0===n||null===n?(this.pOa("Agave sent NULL OOXML"),Ib(4)):this.olb()?this.jri(d,bb,Ib,"ForceSaveAndSetOoXmlForSelection",!0,this.Hlo,n,this.LJh,B,Q,ha,Aa,Eq.construct):(this.pOa("Document is non-coauthorable. Disabled for SET OOXML"),Ib(6))}ymc(d,n){if(!d)return new ma.a;var B=d.split("|");if(4!==B.length)return new ma.a;d=Number.parseLocale(B[0]);var Q=Rb.b(B[1]);Q=Yp.b(Q);const ha=Number.parseLocale(B[2]);B=Rb.b(B[3]);const Aa=Yp.b(B);B=new ma.a;let bb=!1,Ib=!1,oc=!1,Ac=
null,ad,sd=-1;for(let wd=0;wd<n.count;wd++)if(ad=n.K(wd).ka(Dd.a.qd,0),bb)if(oc||(sd?(sd!==Ac.characterData.length&&B.add(ge.a.createTextRange(Ac,sd,Ac.characterData.length)),B.add(ge.a.Pm(Ac))):B.add(ge.a.create(Ac)),oc=!0),ha===ad){Ib=!0;(d=this.ILf(n.K(wd),Aa))&&B.add(ge.a.createTextRange(n.K(wd),0,d));break}else B.add(ge.a.create(n.K(wd)));else if(d===ad&&(bb=!0,Ac=n.K(wd),sd=this.ILf(Ac,Q),ha===ad)){Ib=!0;d=this.ILf(Ac,Aa);d===sd?B.add(ge.a.jd(n.K(wd),sd)):B.add(ge.a.createTextRange(n.K(wd),
sd,d));break}return bb&&Ib?B:new ma.a}ILf(d,n){d=this.VAa.J0a(d.characterData,d.ra);return this.VAa.bPb(d,n)}jri(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd){Q=this.nY.rg("Task",Q);const yd={};try{let lg=0,Lg=0,gp=0,Fu=0;if(d){var be=d.currentSelection;if(be)if(Lj.a.JNa(be))this.pOa("User has selected an anchored object and it's not yet supported."),this.W0(Q),B(8);else{var ye=be.Ya.node,Qe=be.hd.node;lg=ye.ka(Dd.a.qd,0);gp=Qe.ka(Dd.a.qd,0);Lg=wj.a.itb(be,!0);Fu=wj.a.itb(be,!1);yd.startParaId=lg;yd.endParaId=
gp;yd.cpBegin=Lg;yd.cpEnd=Fu;if(this.VAa){var af=this.VAa.J0a(ye.characterData,ye.ra),Qf=this.VAa.DEc(af,Lg,this.huh);d=Qf;af=this.VAa.J0a(Qe.characterData,Qe.ra);af=Qf=this.VAa.DEc(af,Fu,this.huh);var hf=ye.ka(Dd.a.kk,2147483646),di=Qe.ka(Dd.a.kk,2147483646);yd.textIdStart=hf;yd.textIdEnd=di;var vj=ye.$ta;yd.documentKind=Xp[vj];if(-1===vj||1===vj||2===vj)this.pOa("Unsupported DocumentKind is "+vj),this.W0(Q),B(2);else{var Wk=new Cl.a(1,lg,hf,d,gp,di,af,vj),Tm=new oq(Yp.c(Wk)),Dk=Rb.c(Tm),gi=sd?JSON.stringify({["_importChangeTrackingMode"]:sd.importChangeTrackingMode,
["_importCustomProperties"]:sd.importCustomProperties,["_importCustomXmlParts"]:sd.importCustomXmlParts,["_importPageColor"]:sd.importPageColor,["_importParagraphSpacing"]:sd.importParagraphSpacing,["_importStyles"]:sd.importStyles,["_importTheme"]:sd.importTheme}):"",oi=wd(this.ZU(),this.olb(),Dk,bb,oc,Ac,ad,gi),Ni=Object.assign(new Vm.a,{Ls:oi,status:Rg.a.xK,MH:"OoxmlSelection"}),wh=new Qo(n,B,Ni,Q,bb,Aa);this.wGb(rb.a.Alg,ha,this.iE,this.onFailure,wh,Ib,Ni)}}else this.pOa("IWordTextOffsetTranslator is null as it did not resolve"),
this.W0(Q),B(5)}else this.W0(Q),B(2)}else this.pOa("SelectionCollection is null"),this.W0(Q),B(9)}catch(lg){this.pOa("failed in the call to GetOoxmlForSelection. most likely during ForceSave. [e:{0}] [logData: {1}] [callstack: {2}]",lg.message,yd,lg.stack),this.W0(Q),B(0)}}rZb(d,n,B){this.pOa("[reason:{0}].",d);n.N8&&n.N8(B)}FCn(d){let n=!0;const B=this.nY.rg("Task","SetOoxmlIsValidXML");try{const Q=Sys.Net.XMLDOM(d);if(0<Q.getElementsByTagName("parsererror").length)n=!1;else{const ha=Q.parseError;
void 0!==ha&&null!==ha&&ha.errorCode&&(n=!1)}}catch(Q){n=!0,this.pOa("Failed in parsing the xml string: [message: {0}] [callstack: {1}]",Q.message,Q.stack)}finally{B.stop()}return n}W0(d){d&&d.stop()}pOa(d,...n){F.ULS.sendTraceTag.apply(null,[7902996,341,15,"OoXml Operation Failed. "+d].concat(n))}}Object(D.a)(Fk,"OoxmlSelectionManager",null,[1074]);var Di=e(23),tn=e(72),vk=e(128),bg=e(30);class Ri{mHi(d,n,B){({QVo:d,cpBegin:Q,VVo:n,cpEnd:B}=this.Mpl(d,n,B));if(d===n)d=Di.SelectionFactory.eN(d,Q,
B);else{var Q=Di.SelectionFactory.Ie(d,Q);n=Di.SelectionFactory.Ie(n,B);d=tn.a.k3f(d)?Q:Di.SelectionFactory.SA(Q,n.pf?n.pf.Ya:n.Ya)}return d}Mpl(d,n,B){let Q;d=Ri.sIf(d);n=Ri.sIf(n);B=Ri.sIf(B);if(d.contains(n)){var ha=Ri.zqc(d.Ya)?d.Ya.node:B.Ya.node;Q=d.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(ha):d.Ya.contextId===ed.a.paragraph?0:d.Ya.cpBegin;if(Ri.zqc(d.hd))if(1===d.length||2===d.length&&d.Ya.node.id===d.hd.node.id&&d.Ya.contextId===ed.a.Nd&&d.hd.contextId===ed.a.od)if(B.hd.contextId===
ed.a.paragraph||B.hd.contextId===ed.a.od){var Aa=vk.a.kb(B.hd.node);Aa.ku();Aa.Mu(11);bg.a.Fu(Aa,!0,!1)?(bg.a.Ze(Aa),Aa=Aa.currentNode):Aa=B.hd.node}else Aa=B.hd.node;else Aa=d.hd.node;else B.hd.contextId===ed.a.paragraph||B.hd.contextId===ed.a.od?(Aa=vk.a.kb(B.hd.node),Aa.ku(),Aa.Mu(11),bg.a.Fu(Aa,!0,!1)?(bg.a.Ze(Aa),Aa=Aa.currentNode):Aa=B.hd.node):Aa=B.hd.node;d=d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?B.hd.contextId!==ed.a.paragraph&&B.hd.contextId!==ed.a.od||B.hd.node.id===Aa.id?
bf.ParagraphReader.textLength(Aa):0:d.hd.node.id===n.hd.node.id?B.hd.contextId===ed.a.paragraph||B.hd.contextId===ed.a.od?Aa===B.hd.node?bf.ParagraphReader.textLength(B.hd.node):d.hd.cpEnd-n.hd.cpEnd:B.hd.cpEnd+d.hd.cpEnd-n.hd.cpEnd:d.hd.cpEnd}else n.contains(d)?(d=Lj.a.qn(B)?B:Lj.a.QCa(B,{FG:!0,gw:!1,NI:!1,JK:!0}),ha=Aa=d.Ya.node,Q=d=d.Ya.cpBegin):Ri.Hvl(d,n)?d.Ya.node.id===d.hd.node.id?n.Ya.node.id===d.Ya.node.id&&d.Ya.cpBegin<n.Ya.cpBegin?(ha=Aa=d.Ya.node,Q=d.Ya.contextId===ed.a.paragraph?0:d.Ya.cpBegin,
d=n.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(Aa):n.Ya.cpBegin):(B.hd.contextId===ed.a.paragraph||B.hd.contextId===ed.a.od?(ha=vk.a.kb(B.hd.node),ha.ku(),ha.Mu(11),bg.a.Fu(ha,!0,!1),bg.a.Ze(ha),ha=ha.currentNode,Q=0):(ha=B.hd.node,Q=B.hd.cpEnd),Aa=ha,d=d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?bf.ParagraphReader.textLength(Aa):Q+d.hd.cpEnd-n.hd.cpEnd):Ri.zqc(d.Ya)&&(d.Ya.node.id!==n.Ya.node.id||d.Ya.contextId===ed.a.paragraph||n.Ya.contextId===ed.a.od||d.Ya.contextId!==
ed.a.od&&d.Ya.cpBegin<=n.Ya.cpBegin)?(ha=d.Ya.node,Q=d.Ya.contextId===ed.a.paragraph?0:d.Ya.contextId===ed.a.od?n.Ya.node.id===d.Ya.node.id?B.Ya.contextId===ed.a.paragraph||B.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(ha):B.Ya.cpBegin:bf.ParagraphReader.textLength(ha):d.Ya.cpBegin,d=Ri.sfm(d),Aa=d.node,d=n.Ya.contextId===ed.a.paragraph||n.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(d.node):n.Ya.cpBegin):Ri.zqc(d.hd)?(B.hd.contextId===ed.a.paragraph||B.hd.contextId===ed.a.od?(n=
vk.a.kb(B.hd.node),n.ku(),n.Mu(11),bg.a.Fu(n,!0,!1),bg.a.Ze(n),ha=n.currentNode,Q=0):(ha=B.hd.node,Q=B.hd.cpEnd),Aa=d.hd.node,d=d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?bf.ParagraphReader.textLength(Aa):d.hd.cpEnd):(B.hd.contextId===ed.a.paragraph||B.hd.contextId===ed.a.od?(ha=vk.a.kb(B.hd.node),ha.ku(),ha.Mu(11),bg.a.Fu(ha,!0,!1),bg.a.Ze(ha),ha=ha.currentNode,Q=0):(ha=B.hd.node,Q=B.hd.cpEnd),Aa=ha,d=d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?bf.ParagraphReader.textLength(ha):
Q+d.hd.cpEnd-n.hd.cpEnd):d.Ya.node.id===n.hd.node.id&&(d.Ya.cpBegin>=n.hd.cpEnd||d.Ya.contextId===ed.a.od)?(B.hd.contextId===ed.a.od||B.hd.contextId===ed.a.paragraph?(ha=vk.a.kb(B.hd.node),ha.ku(),ha.Mu(11),bg.a.Fu(ha,!0,!1),bg.a.Ze(ha),ha=ha.currentNode,Q=d.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(d.Ya.node)-n.hd.cpEnd:d.Ya.cpBegin-n.hd.cpEnd):(ha=B.hd.node,Q=d.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(ha):d.Ya.cpBegin-n.hd.cpEnd+B.hd.cpEnd),Aa=d.Ya.node.id===d.hd.node.id?
ha:d.hd.node,d=ha===Aa?Q+d.hd.cpEnd-d.hd.cpBegin:d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?bf.ParagraphReader.textLength(Aa):d.hd.cpEnd):(ha=d.Ya.node,Q=d.Ya.contextId===ed.a.paragraph?0:d.Ya.contextId===ed.a.od?bf.ParagraphReader.textLength(d.Ya.node):d.Ya.cpBegin,Aa=d.hd.node,d=d.hd.contextId===ed.a.paragraph||d.hd.contextId===ed.a.od?bf.ParagraphReader.textLength(d.hd.node):d.hd.cpEnd);return{QVo:ha,cpBegin:Q,VVo:Aa,cpEnd:d}}static sIf(d){d.ig||(d=d.toArray(),d.reverse(),d=new Ph.Selection(d,
!0));return d}static Hvl(d,n){const B=d.toArray(),Q=n.toArray();let ha,Aa;if(d.contains(n)||n.contains(d))return!1;for(let bb=0;bb<d.length;bb++){ha=B[bb];for(let Ib=0;Ib<n.length;Ib++)if(Aa=Q[Ib],ha.node.id===Aa.node.id&&(ha.contextId===ed.a.paragraph||Aa.contextId===ed.a.paragraph||ha.contextId===ed.a.od&&Aa.contextId===ed.a.od||ha.contextId===ed.a.Nd&&Aa.contextId===ed.a.Nd&&(ha.cpBegin>=Aa.cpBegin&&ha.cpBegin<Aa.cpEnd||Aa.cpBegin>=ha.cpBegin&&Aa.cpBegin<ha.cpEnd)))return!0}return!1}static zqc(d){return!!d.node.anchor&&
!d.node.anchor.mW&&d.node.TB}static sfm(d){if(!Ri.zqc(d.Ya))return null;let n=d.Ya;d=d.QV();for(d.moveNext();d.moveNext();)if(Ri.zqc(d.current))n=d.current;else break;return n}}Object(D.a)(Ri,"SetDataVirtualSelectionMerger",null,[1073]);var vm=e(22),ef=e(15);class xj{constructor(d,n,B){this.ga=d;this.pb=n;this.tI=B}Dun(){this.pb.iX||F.ULS.sendTraceTag(8452246,341,15,"Unexpected error to selectionManager and the selectionRoot cannot return");return 1<vc.a.kb(this.pb.iX).Bs()}RNg(){let d=null;const n=
vc.a.kb(this.pb.iX);if(n.ue()){const B=vc.a.kb(n.currentNode);n.XNa&&n.ue()&&oj.TableReader.isTable(n)?d=n.currentNode:B.Ib(14)&&(d=B.xd(14))}return d?{returnValue:!0,CFe:d}:{returnValue:!1,CFe:d}}Fxp(d,n){let B="";var Q=null;for(let ha=0;ha<n.length;ha++)if(d.equals(n[ha].node)){Q=n[ha];break}if(Q){d=bf.ParagraphReader.text(Q.node);switch(Q.contextId){case ed.a.paragraph:B+=d;break;case ed.a.Nd:n=Q.cpBegin;Q=Q.cpEnd-n;0<Q&&(B+=d.substr(n,Q));break;case ed.a.od:break;default:return F.ULS.sendTraceTag(8452249,
341,15,"Unexpected context type when trying get selected text of paragraph node, context type is:"+Q.contextId),{returnValue:!1,lzc:B}}return{returnValue:!0,lzc:B}}return{returnValue:!1,lzc:B}}A9j(d,n,B){let Q="",ha=!1;d=vc.a.kb(d);const Aa=d.Bs();for(let Ib=0;Ib<Aa;Ib++){if(d.Gy(Ib)){d.ue();if(12===d.Jf){if(B)Q+=bf.ParagraphReader.text(d.currentNode);else{var bb=void 0;({lzc:bb}=this.Fxp(d.currentNode,n)).returnValue&&(Q+=bb,ha=!0)}Ib!==Aa-1&&(Q+="\r")}else if(14===d.Jf)for(bb=d.ic(1);bb;){for(bb=
d.ic(1);bb;)ha=({SXc:bb}=this.A9j(bb,n,B)).returnValue||ha,Q+=bb,d.XNa||(Q+="\t"),bb=d.px();Q+="\r\n";bb=d.px()}d.Ac()}d.Ac()}return{returnValue:ha,SXc:Q}}FLi(d){const n={rows:[],headers:[]};if(!({CFe:Ib}=this.RNg()).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType,Tze:n};const B=vc.a.kb(Ib),Q=[];var ha={};if((ha.isSelectionManagerNull=!this.pb)||(ha.isSelectionCollectionNull=!this.pb.ob))return F.ULS.sendTraceTag(8452252,341,10,"Unexpected error to selectionManager and contigousSelection data cannot return.{0}",
ha),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Tze:n};for(var Aa of this.pb.ob)Q.push(...Aa.toArray());ha=[];var bb;var Ib=this.tI.Nab(Ib);Aa=0;for(bb=B.ic(1);bb;){bb=!1;d===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&Aa<Ib&&(bb=!0);for(var oc=B.ic(1);oc;){if(!vm.TableCellReader.Js(oc)){let Ac="";(({SXc:Ac}=this.A9j(oc,Q,bb)).returnValue||bb)&&ha.push(Ac)}oc=B.px()}0<ha.length&&(oc=Array.clone(ha),bb?Array.add(n.headers,oc):Array.add(n.rows,oc),Array.clear(ha));bb=B.px();Aa++}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Tze:n}}vVj(d,n,B){if(this.Dun())this.Nqn()?this.kxf(d,n,B,!1):B(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);else{let Q;if(({CFe:Q}=this.RNg()).returnValue){let ha,Aa;({lwn:ha,JVo:Aa}=this.zQm(Q));ha?(F.ULS.sendTraceTag(8458370,344,15,"SetSelectedTable failed due to the attempt to set data in a partially selected table"),B(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)):this.Fyn(Aa,n,d)?this.Wcm(Q,Aa,d,n,B):this.kxf(d,n,B,!0)}else this.kxf(d,n,B,!1)}}NUm(d){let n=
"";if(vm.TableCellReader.Js(d))return{returnValue:!1,SXc:n};d=vc.a.kb(d);const B=d.Bs();for(let Q=0;Q<B;Q++)d.Gy(Q)&&(d.ue(),12===d.Jf&&(n+=bf.ParagraphReader.text(d.currentNode),Q!==B-1&&(n+="\r")),d.Ac()),d.Ac();return{returnValue:!0,SXc:n}}l8i(d){let n=!1;oj.TableReader.bwi(d,B=>{vm.TableCellReader.Js(B)&&(n=!0)});return n}RTm(d,n,B){let Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const ha={},Aa=this.tI.Nab(d),bb=oj.TableReader.Hg(d)-(n?Aa:0),Ib=oj.TableReader.Nh(d);let oc,Ac,ad,sd,wd;oc=
B[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];Ac=B[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];ad=B[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];B=B[OSF.DDA.Marshaling.BindingParameterKeys.ColCount];if(0>oc||oc>=bb||oc+Ac>bb||0>ad||ad>=Ib||ad+B>Ib)Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{sd=Ac?oc+Ac-1:bb;wd=B?ad+B-1:Ib;d=vc.a.kb(d);const yd=[];let be;ha.rows=[];ha.headers=[];ef.b(d,(ye,Qe,af)=>{const Qf=n&&Qe<Aa,hf=n?Aa:0;Qe=Qe>=oc+hf&&Qe<=sd+hf;af=af>=
ad&&af<=wd;(Qf||Qe)&&af&&({SXc:be}=this.NUm(ye.currentNode)).returnValue&&yd.push(be);ye.XNa&&0<yd.length&&(ye=Array.clone(yd),Array.add(Qf?ha.headers:ha.rows,ye),Array.clear(yd));return!0})}return{returnValue:Q,LTl:ha}}isTable(d,n){return d.id===n.id&&14===d.type?!0:!1}Cje(d){if(!d||14!==d.type)return!1;let n=!0;const B=this.WJf(),Q=new vc.a;Q.set(d);ef.b(Q,ha=>vm.TableCellReader.Js(ha.currentNode)||this.Ihe(ha.currentNode,B)?!0:n=!1);return n}Gyn(){let d;return({CFe:d}=this.RNg()).returnValue?this.Cje(d):
!1}Wcm(d,n,B,Q,ha){const Aa=dd.a.YYh,bb=[];bb.push(n);bb.push(B);bb.push(Q);bb.push(d);32===this.ga.Vb(Aa,1)?this.ga.Oia(null,Aa,bb,Ib=>{32!==Ib.response&&F.ULS.sendTraceTag(8458371,344,10,"SetSelectedTable failed with error {0}",Ib.response);ha(32===Ib.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):(F.ULS.sendTraceTag(8458372,344,10,"SetSelectedTable failed due to the action is not enabled"),ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection))}kxf(d,
n,B,Q){Q?this.ga.Vb(Se.a.OY,2):this.ga.Vb(Se.a.WJ,2);n=this.WHl(d,n);d=new Yb.DictionaryPropertySet;d.setValue(oh.a.PZ,n);d.setValue(oh.a.aQa,!0);n=Se.a.$sa;32===this.ga.Vb(n,1)?this.ga.Oia(null,n,d,ha=>{B(32===ha.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):B(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}WHl(d,n){const B=document.createElement("div"),Q=document.createElement("table");var ha=document.createAttribute("border");
ha.value="1";Q.attributes.setNamedItem(ha);B.appendChild(Q);if(d&&d.length){ha=document.createElement("tr");Q.appendChild(ha);for(var Aa=0;Aa<d.length;++Aa){var bb=document.createElement("th");bb.innerText=d[Aa]?d[Aa].toString():"";ha.appendChild(bb)}}for(d=0;d<n.length;++d)for(ha=n[d],Aa=document.createElement("tr"),Q.appendChild(Aa),bb=0;bb<ha.length;++bb){const Ib=document.createElement("td");Ib.innerText=ha[bb]?ha[bb].toString():"";Aa.appendChild(Ib)}return B.innerHTML}Fyn(d,n,B){if(d.length!==
n.length+(B?1:0))return!1;if(B){if(d[0].length<B.length)return!1;for(B=1;B<d.length;++B)if(d[B].length<n[B-1].length)return!1}else for(B=0;B<d.length;++B)if(d[B].length<n[B].length)return!1;return!0}WJf(){const d=[];for(const n of this.pb.ob)d.push(...n.toArray());return d}zQm(d){let n=!1,B=!1,Q=!1;const ha=[],Aa=this.WJf();d=vc.a.kb(d);var bb=d.ic(1);let Ib=!0;for(;bb;){bb=[];let oc=d.ic(1);for(;oc;)vm.TableCellReader.Js(oc)?B=!0:this.Ihe(oc,Aa)?(Ib&&(Q=!0),bb.push(oc)):n=!0,oc=d.xl();Ib=!1;ha.push(bb);
d.Ac();bb=d.xl()}return{lwn:n,Bdq:B,ydq:Q,JVo:ha}}Ihe(d,n){var B=this.uDi(d);d=this.YFi(d);let Q=0,ha=!1;for(;Q<n.length;++Q){const Aa=n[Q];if(Aa.node===B)if(Aa.contextId===ed.a.paragraph||Aa.contextId===ed.a.od){ha=!0;++Q;break}else return!1}if(!ha||B===d)return ha;for(;Q<n.length;++Q)if(B=n[Q],B.node===d)if(B.contextId===ed.a.paragraph||B.contextId===ed.a.od){ha=!0;break}else return!1;return ha}isSelected(d,n){let B;for(let Q=0;Q<n.length;++Q)if(B=vc.a.kb(n[Q].node),B.Ib(16)&&B.xd(16)===d)return!0;
return!1}YFi(d){d=vc.a.kb(d);var n=d.Bs();for(--n;-1<n;--n){if(d.Gy(n)){d.ue();if(12===d.Jf)return d.currentNode;if(14===d.Jf){const B=this.YFi(d.currentNode);if(B)return B}d.Ac()}d.Ac()}return null}uDi(d){d=vc.a.kb(d);const n=d.Bs();for(let B=0;B<n;++B){if(d.Gy(B)){d.ue();if(12===d.Jf)return d.currentNode;if(14===d.Jf){const Q=this.uDi(d.currentNode);if(Q)return Q}d.Ac()}d.Ac()}return null}Nqn(){let d=null,n=null,B=vc.a.kb(this.pb.iX);0<B.Bs()&&B.ue()&&B.ue()&&14===B.Jf&&(d=B.currentNode);B=vc.a.kb(this.pb.iX);
1<B.Bs()&&B.g9()&&B.ue()&&14===B.Jf&&(n=B.currentNode);return d&&!this.Cje(d)||n&&!this.Cje(n)?!1:!0}AQm(d){const n={},B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(d.Qge())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported,S3j:n};const Q=this.WJf(),ha=vc.a.kb(d);let Aa=-1,bb=-1,Ib=-1,oc=-1;ef.b(ha,(Ac,ad,sd)=>{if(this.isSelected(Ac.currentNode,Q)){if(-1===Aa||-1===bb)Aa=ad,bb=sd;Ib=Ib<ad?ad:Ib;oc=oc<sd?sd:oc}else if(-1<bb&&sd>=bb&&sd<=oc)return!1;return!0});
B===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=this.tI.Nab(d),Ib>=d&&(Aa=Aa>=d?Aa-d:0,n[OSF.DDA.Marshaling.TableSubsetKeys.StartRow]=Aa,n[OSF.DDA.Marshaling.TableSubsetKeys.RowCount]=Ib-d-Aa+1),n[OSF.DDA.Marshaling.TableSubsetKeys.StartColumn]=bb,n[OSF.DDA.Marshaling.TableSubsetKeys.ColumnCount]=oc-bb+1);return{returnValue:B,S3j:n}}nln(d,n){let B=0;for(let Q=0;Q<n.length;Q++)n[Q].length>B&&(B=n[Q].length);return B===d}mln(d,n,B,Q,ha){let Aa=[];ha||(B=Array(d));return(!B&&!d||B&&B.length===
d)&&n===Q.length?(Aa=B.concat(Q),{returnValue:!0,U4j:Aa}):{returnValue:!1,U4j:Aa}}sAn(d,n,B,Q,ha){d=d?this.tI.Nab(n):0;if(!B||!Q||B.length<Q.length+d)return!1;if(ha){if(ha.length!==d)return!1;for(n=0;n<Q.length+d;n++)if(B[n].length<(n<d?ha[n]:Q[n-d]).length)return!1}else for(ha=0;ha<Q.length;ha++)if(B[ha].length<Q[ha].length)return!1;return!0}Dxp(d,n,B){const Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;let ha=0,Aa=0;ha=B.startRow;Aa=B.startCol;const bb=this.tI.Nab(d),Ib=n?bb:0,oc=[],Ac=[],ad=
vc.a.kb(d);ef.b(ad,(sd,wd,yd)=>{if(!vm.TableCellReader.eh(ad)){const be=wd>=ha+Ib;yd=yd>=Aa;(n&&wd<bb||be)&&yd&&oc.push(sd.currentNode);sd.XNa&&0<oc.length&&(sd=Array.clone(oc),Ac.push(sd),Array.clear(oc))}return!0});return{returnValue:Q,Dpp:Ac}}umo(d,n,B){const Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha=[],Aa=[],bb=[],Ib=B?B.length:0;for(let oc=0;oc<n.length+Ib;oc++){const Ac=oc<Ib?B[oc]:n[oc-Ib],ad=d[oc];for(let sd=0;sd<Ac.length;sd++)Aa.push(ad[sd]),bb.push(Ac[sd])}ha.push(Aa);ha.push(bb);
return{returnValue:Q,Tpp:ha}}}Object(D.a)(xj,"TableMatrixHelper",null,[]);var Sg=e(1881),Zj=e(84),hl=e(85),Ao=e(65),Bn=e(1523);class Ol{}Object(D.a)(Ol,"JSanityOptions",null,[]);class Jo extends Bn.a{constructor(d,n,B,Q,ha){super(d,n,B);this.wkb=Q;this.Gk=ha}nMp(){return Af.a.TEe}xDc(d){var n;let B=null;if(this.rV&&!d)return F.ULS.sendTraceTag(594408837,307,10,"No htmlDomContent"),{returnValue:!1,Vma:B};if(!this.nMp())return this.Jc.qc(hl.a.pua,{["Reason"]:Ao.a.s1h}),{returnValue:!1,Vma:B};try{if(null===
(n=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===n?0:n.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_7588861_InsertHtmlEnhancement")){const ha=this.Gk.Peb(d),Aa=this.Gk.wFf(d).getElementsByTagName("style");if(0<(null===Aa||void 0===Aa?void 0:Aa.length)&&this.wkb&&ha){for(n=0;n<Aa.length;n++)this.wkb.eci(ha,Aa[n]);d=ha.innerHTML}}const Q=Jo.kFl(d);B=jSanity.sanitize(Q)}catch(Q){return F.ULS.shipAssertTag(6423694,
307,!1),this.Jc.qc(hl.a.pua,{["Reason"]:Ao.a.Vof}),{returnValue:!1,Vma:B}}return{returnValue:!0,Vma:B}}static kFl(d){var n;const B=new Ol;B.inputString=d;B.allowLinks=!0;B.customProtocols={};B.customProtocols["data:image/"]=1;B.externalContentCallback=(Q,ha,Aa,bb)=>{let Ib=!1;if("attribute"===Q&&"src"===ha){ha=Zj.a.zT(bb);for(const oc of ha)if(Aa.startsWith(oc)){Ib=!0;break}ha=Zj.a.zT(B.customProtocols);for(const oc of ha)if(Aa.startsWith(oc)){Ib=!0;break}}Ib||(Aa="CSSURL"===Q?'url("about:blank")':
"about:blank");return Aa};if(null===(n=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===n?0:n.getBooleanFeatureGate("Microsoft.Office.WordOnline.PreserveParastyleAttributeIsEnabled",!1))B.dataAttributeCallback=(Q,ha)=>"data-ccp-parastyle"===Q?ha:null;return B}}Object(D.a)(Jo,"ExternalHtmlStringImportStrategy",Bn.a,[]);var eo=e(239);class tl{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac=null,ad=null){var sd;this.iUc=!1;this.r6o=4;this.q6o=(wd,yd,
be,ye,Qe)=>{if(1===be)return 32;if(!Qe||Qe.length!==this.r6o)return 8;wd=Qe[0];ye=Qe[1];yd=Qe[2];be=Qe[3];Qe=this.Zc.Vc(15);Qe.Eb(be);if(32!==this.ga.Vb(Se.a.Rta,2))return 8;be=0;if(ye){for(var af=0;af<ye.length;++af){var Qf=wd[be];ye[af]&&this.VVj(Qf[af],ye[af].toString())}be++}for(ye=0;ye<yd.length;++ye){af=yd[ye];Qf=wd[be];for(let hf=0;hf<af.length;++hf)af[hf]&&this.VVj(Qf[hf],af[hf].toString());be++}Qe.dispose();return 32};this.xVi=(wd,yd,be,ye,Qe,af)=>{var Qf,hf;if(yd===Se.a.$sa&&(null===(Qf=
be.view)||void 0===Qf?0:Qf.Ee)&&(Qf=be.view,Qf.ub&&(null===(hf=this.sm)||void 0===hf?0:hf.koa(Qf.ub.hh))))return null;hf=this.pB.K(yd.toString());this.Bla&&af&&Object(zk.a)(66,af)&&(Qf=this.Bla.Dtd(),Qf.Gfc("ImportDataAction"),af.setValue(oh.a.KBa,Qf));return this.zZd.create(wd,yd,hf,new fa.a(()=>this.N0c(yd,af)),be,ye,Qe,af)};this.ga=d;this.Jd=n;this.ee=Q;this.Ewk=Aa;this.Zc=ha;this.Gk=bb;this.Bla=Ac;this.hV=B;this.sm=oc;this.wkb=ad;Ib&&(this.iUc=Ib.$("UseClipboardDataHelperInMultiLineImportIsEnabled"));
this.pB=new ff.a;this.pB.W(Se.a.iWd.toString(),262145);this.pB.W(Se.a.$sa.toString(),262145);if(null===(sd=null===G.AFrameworkApplication||void 0===G.AFrameworkApplication?void 0:G.AFrameworkApplication.J)||void 0===sd?0:sd.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveEmptyParagraphAfterPasteIsEnabled",!1))d=this.pB.K(Se.a.$sa.toString()),this.pB.W(Se.a.$sa.toString(),d|524288)}get zZd(){return this.Ewk.value}mc(){this.ga.uY(Se.a.iWd,ed.a.view,this.xVi,1028);this.ga.uY(Se.a.$sa,ed.a.view,
this.xVi,4|(G.AFrameworkApplication.$v&&16384));this.ga.nb(dd.a.YYh,ed.a.view,this.q6o,4)}VVj(d,n){d=vc.a.kb(d);d.ic(1)||this.hV.Yla(d,!0);d=bg.a.Ze(d);this.ee.lf(ge.a.jd(d,0),n)}N0c(d,n){if(d===Se.a.iWd)return new Sg.a(n,this.Jd,this.Gk,this.iUc,eo.WoncaApp.instance.t2a);if(d===Se.a.$sa)return new Jo(n,this.Jd,eo.WoncaApp.instance.t2a,this.wkb,this.Gk);F.ULS.shipAssertTag(6348963,341,!1,"Could not find an import strategy for action {0}",d);return null}}Object(D.a)(tl,"AppsForOfficeApiActor",null,
[]);class Ro{constructor(d,n,B,Q=null){this.appName=d;this.appVersion=n;this.clientMode=B;this.formFactor=Q||"DefaultSettings"}}Object(D.a)(Ro,"HostInfo",null,[]);class vr{constructor(d,n,B=null){this.appUILocale=d;this.dataLocale=n;this.lcid=B}}Object(D.a)(vr,"LocaleInfo",null,[]);var up=e(1333);class kn{constructor(){this.startTime=0;this.callback=null}}Object(D.a)(kn,"SSOCallbackInfo",null,[]);class ip{constructor(){this.accessToken=null}}Object(D.a)(ip,"AccessTokenInformation",null,[1207]);class mm{constructor(){this.token=
null;this.errorCode=0;this.expiresOn=this.H8a=this.q4b=this.FNf=this.pSf=this.K7c=this.rLg=null}}Object(D.a)(mm,"AppsForOfficeOauthResult",null,[]);class Fq{constructor(){this.token=null;this.expiresOn=0;this.H8a=this.authChallenge=null}}Object(D.a)(Fq,"CachedTokenInfo",null,[]);class br{constructor(){this.oka=new ma.a;this.LVa=this.KVa=!1;this.yhb=this.authChallenge=null;this.startTime=this.retryCount=0;this.EVh=null}get callbacks(){return this.oka}}Object(D.a)(br,"SSORequestInfo",null,[]);class xi extends br{constructor(){super();
this.errorCode=0}}Object(D.a)(xi,"SSOFailedRequestInfo",br,[]);class bh{static oOa(d,n,B,Q){var ha=d.startTime;let Aa=0;0<ha&&(Aa=bh.Zq()-ha);ha={["callInstanceId"]:ha.toString(),["callDuration"]:Aa.toString(),["errorCode"]:n.toString()};if(Q)for(const bb in Q)ha[bb]=Q[bb];F.ULS.sendTraceTag(51401116,344,50,"{0}",ha);cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:zf.a.iG(ha)}));d.callback(n,B)}static Zq(){try{if(window.performance&&
window.performance.now)return window.performance.now()}catch(d){}return Date.now()}}Object(D.a)(bh,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class Dl{constructor(d,n,B,Q){this.hsa=new ma.a;this.s7=new ma.a;this.ljb=null;this.YQc=new ma.a;this.Lxh=Promise.resolve(null);this.LKh=!1;this.rOd=n;this.taa=d;this.IQd=B;this.Osk=Q}Sap(d){if(this.ljb&&this.ljb.authChallenge===d.authChallenge){if(Date.now()/1E3+Dl.YRn>this.ljb.expiresOn)return this.ljb=null,!1;d=new mm;d.token=this.ljb.token;d.expiresOn=
this.ljb.expiresOn;d.H8a=this.ljb.H8a;d.q4b=!0;d.K7c=0;this.E8c(d);return!0}return!1}R9o(d){for(let n=0;n<this.s7.count;n++)if(this.s7.K(n).authChallenge===d.authChallenge&&this.s7.K(n).yhb===d.yhb){let B;(B=this.s7.K(n)).retryCount=B.retryCount+1;d.retryCount=this.s7.K(n).retryCount;if(this.s7.K(n).retryCount<Dl.Zag||!this.s7.K(n).KVa&&d.KVa||!this.s7.K(n).LVa&&d.LVa){if(!this.s7.K(n).KVa&&d.KVa||!this.s7.K(n).LVa&&d.LVa)d.retryCount=0;this.s7.removeAt(n);break}d=new mm;d.errorCode=this.s7.K(n).errorCode;
this.E8c(d);return!0}return!1}z5k(d,n){for(let B=0;B<this.s7.count;B++)if(this.s7.K(B).yhb===d.yhb&&this.s7.K(B).authChallenge===d.authChallenge)return;this.s7.add(Object.assign(new xi,{KVa:d.KVa,LVa:d.LVa,authChallenge:d.authChallenge,yhb:d.yhb,errorCode:n,retryCount:d.retryCount}))}get resource(){return this.rOd}EJf(d,n,B,Q,ha,Aa){""===B&&(B=null);if(this.LKh)bh.oOa(Aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var bb=null;for(const Ib of this.hsa)if(Ib.KVa===d&&Ib.LVa===
n&&Ib.authChallenge===B&&Ib.yhb===ha){bb=Ib;break}bb||(bb=Object.assign(new br,{KVa:d,LVa:n,authChallenge:B,EVh:Q,yhb:ha,retryCount:0,startTime:bh.Zq()}),this.hsa.add(bb));bb.retryCount=0;bb.callbacks.add(Aa);this.Lxh=this.Lxh.then(()=>{if(0<this.hsa.count){var Ib=this.hsa.K(0);if(this.Sap(Ib)||this.R9o(Ib))return null;for(var oc=0;oc<this.YQc.count;)this.YQc.K(oc)+Dl.hsp<bh.Zq()?this.YQc.removeAt(oc):oc++;if(this.YQc.count>=Dl.uSn||this.hsa.count>=Dl.URn)return Ib=new mm,Ib.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,
this.E8c(Ib),null;let Ac=null;G.AFrameworkApplication.ta&&(oc=G.AFrameworkApplication.ta.Kt)&&(Ac=oc.rg("ComponentAttach",this.taa+Dl.aVk));return Ib.yhb.h_k(this.resource,Ib.KVa,Ib.LVa,Ib.authChallenge,this.Osk,Ib.EVh).then(ad=>{Ac&&Ac.stop();this.E8c(ad)},()=>{Ac&&Ac.stop();const ad=new mm;ad.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.E8c(ad)})}return null})}}E8c(d){try{if(this.hsa.count){var n=this.hsa.K(0);this.hsa.removeAt(0);var B=null;d.errorCode||(B=new ip,B.accessToken=
d.token);d.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&d.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&d.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&d.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.z5k(n,d.errorCode);var Q={};null!=d.K7c&&(Q.getTokenSilentTime=d.K7c.toString());null!=d.pSf&&(Q.getTokenPopupTime=d.pSf.toString());null!=d.FNf&&(Q.getIDTokenTime=d.FNf.toString());null!=d.q4b&&(Q.tokenCached=
d.q4b.toString());d.rLg&&(Q.detailedError=d.rLg);d.H8a&&(Q.authLibrary=d.H8a);n.retryCount&&(Q.retryCount=n.retryCount);for(var ha of n.callbacks)bh.oOa(ha,d.errorCode,B,Q);null!=d.q4b&&d.q4b||this.YQc.add(n.startTime);if(!d.errorCode)for(null!=d.expiresOn&&(this.ljb=Object.assign(new Fq,{token:d.token,expiresOn:d.expiresOn,authChallenge:n.authChallenge,H8a:d.H8a})),this.s7.clear(),ha=0;ha<this.hsa.count;)if(this.hsa.K(ha).authChallenge===n.authChallenge){for(const Aa of this.hsa.K(ha).callbacks)bh.oOa(Aa,
d.errorCode,B,Q);this.hsa.removeAt(ha)}else ha++}}catch(Aa){F.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",Aa.message)}}shutdown(){this.LKh=!0;this.hsa.clear()}}Dl.hsp=6E4;Dl.uSn=6;Dl.URn=6;Dl.Zag=3;Dl.YRn=300;Dl.aVk="GetAccessToken";Object(D.a)(Dl,"SSOCallbackManager",null,[]);var cr=e(639);class ul{constructor(d,n,B=null){this.z6b=new ff.a;const Q=new ma.a;n&&Q.add(n.yPn);B&&Q.addRange(B);this.Bk=d;this.RWk=Q}MFo(d){this.z6b.Bb(d)&&(this.z6b.K(d).shutdown(),
this.z6b.remove(d))}FJf(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){Ac=Object.assign(new kn,{startTime:bh.Zq(),callback:Ac});try{const wd=!!B&&""!==B;var ad=Ac.startTime;const yd=this.getOsfControl(d);let be=yd.getStoreType()||"",ye=yd.getOwnerAddinStoreType()||"",Qe=yd.getSolutionId()||"";const af=yd.getVersion()||"";be=be.toLowerCase();ye=ye.toLowerCase();Qe=Qe.toLowerCase();var sd=T.a.CNf(n)||"";const Qf=T.a.CNf(yd.getIframeUrl())||"",hf=sd.toLowerCase()===Qf.toLowerCase();sd=be;"inmemory"===be&&(sd=ye);const di=
Telemetry.PrivacyRules.GetPrivacyCompliantId(Qe,sd,yd.getAssetId(),null,null,yd.getStoreId()),vj={["callInstanceId"]:ad.toString(),["controlSolutionId"]:di,["controlVersion"]:af,["storeType"]:be,["ownerStoreType"]:ye,["allowConsentPrompt"]:Q.toString(),["forMSGraphAccess"]:ha.toString(),["allowSignInPrompt"]:Aa.toString(),["hasAddinAuthChallenge"]:wd.toString(),["securityOriginEqualsSourceLocation"]:hf.toString(),["singleSignOnEnabled"]:bb.toString(),["accountTypeFilter"]:Ib||""};F.ULS.sendTraceTag(51401115,
344,50,"{0}",vj);cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:zf.a.iG(vj)}));ad=!0;const Wk=G.AFrameworkApplication.J.rb("HostAuthType");switch(Ib){case "aad":ad="aad"===Wk;break;case "msa":ad="msa"===Wk;break;default:ad=!Ib||"noFilter"===Ib}if(ad){Ib=null;if(bb)for(const Tm of this.RWk)if(Tm.Xpn(Qe)){Ib=Tm;break}Ib?this.isSSOAddin(d)?(bb=!0,"omex"===sd&&(bb=!1),"spapp"===sd||"spcatalog"===sd?(F.ULS.sendTraceTag(594043737,
344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ha&&!bb?(F.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ha&&"exchange"===sd&&(Q=!1),this.EJf(d,n,B,sd,Q,Aa,oc,Ib,Ac))):(F.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),
bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(wd){this.zle(),F.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",wd.message),bh.oOa(Ac,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(d,n,B,Q){this.FJf(d,B[gf.a.bkf]||null,
B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,n,B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,B[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Q)}EJf(d,n,B,Q,ha,Aa,bb,Ib,oc){this.z6b.Bb(d)?
Q=this.z6b.K(d):(Q=new Dl(d,this.getWebApplicationResource(d).split(",")[0],Q,this.getDefaultDisplayName(d)),this.z6b.add(d,Q));const Ac=Q.resource;d=ul.UOm(Ac,this.getWebApplicationId(d));const ad=OfficeExt.WACUtils.getHostSecure(n);d&&ad?d.toLowerCase()===ad.toLowerCase()?Q.EJf(ha,Aa,B,bb,Ib,oc):(ul.QXb('SSO Resource "'+Ac+'" cannot be used from "'+n+'" origin due to domain mismatch.'),F.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
bh.oOa(oc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(d||F.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ad||F.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),bh.oOa(oc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}zle(){F.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(d){return this.Bk.getOsfControl(d)}isSSOAddin(d){return this.getOsfControl(d).getManifest().isSSOAddin()}getWebApplicationId(d){return this.getOsfControl(d).getManifest().getWebApplicationId()}getWebApplicationResource(d){return this.getOsfControl(d).getManifest().getWebApplicationResource()}getDefaultDisplayName(d){return this.getOsfControl(d).getManifest().getDefaultDisplayName()}static DRm(){try{const d=
{};Af.a.e_a&&cr.a.t9c&&(d.UiHostSupportsAuthTokenAddinList=ul.pui);d.UiHostSupportsAuthToken=cr.a.t9c;return d}catch(d){F.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",d.message)}return null}static getInstance(d,n,B=null){ul._instance||(ul._instance=new ul(d,B));return ul._instance}static Ful(d){ul._instance&&ul._instance.MFo(d)}static QXb(d){window.console.warn&&window.console.warn(d)}static UOm(d,n){if(!d)return"";n||(n="");let B=d.toLowerCase();var Q=
n.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Q)||(ul.QXb('SSO App Id "'+n+'" is not a valid format. It will be rejected from store submission.'),F.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));B.endsWith(Q)||(ul.QXb('SSO Resource "'+d+'" does not end with App Id "'+n+'". It will be rejected from store submission.'),F.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!B.startsWith("https://")&&!B.startsWith("api://"))return ul.QXb('SSO Resource "'+
d+'" must be https:// or api:// protocol.'),F.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(n=0;n<d.length;n++){Q=d.charAt(n);const ha=Ca.a.charCodeAt(d,n);if(33>ha||126<ha||"&"===Q||"?"===Q||"#"===Q||"%"===Q||"\\"===Q)return ul.QXb('SSO Resource "'+d+'" contains an invalid character "'+Q+'".'),F.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Q+"' in resource URI."),""}if(0<=d.indexOf("::"))return ul.QXb('SSO Resource "'+d+'" contains an invalid string "::".'),
F.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<d.length)return ul.QXb('SSO Resource "'+d+'" is '+d.length+" characters and exceeds the max length of 120 characters."),F.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+d.length+"."),"";B.startsWith("api://")&&(B="https://"+B.substring(6,B.length));return 8===B.length?"":OfficeExt.WACUtils.getHostSecure(B)||""}}ul.pui="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
ul._instance=null;Object(D.a)(ul,"AppsForOfficeSingleSignOnManager",null,[1169]);var oa=e(104);class Za{constructor(d=null,n=null,B,Q=null,ha=null,Aa=null,bb=null,Ib=null,oc=null,Ac=null,ad=null,sd=null,wd=null,yd=null,be=null,ye=null){this.osfOmexBaseUrl=d;this.devCatalogUrl=n;this.spBaseUrl=Q;this.docUrl=ha;this.pageBaseUrl=Aa;this.localizedScriptsUrl=bb;this.localizedImagesUrl=Ib;this.localizedStylesUrl=oc;this.localizedResourcesUrl=Ac;this.firstPartyManifestCDNUrl=ad;this.sdxCdnUrl=sd;this.sdx1CdnUrl=
yd;this.sdxDmsUrl=wd;this.sovereignFederationDMSToken=be;this.sovereignFederationDMSTokenSuffix=ye}}Object(D.a)(Za,"UrlInfo",null,[]);class xb{constructor(d,n=null){this.userNameHashCode=d;this.loggableUserId=n}}Object(D.a)(xb,"UserInfo",null,[]);class Zb{constructor(){this.hostFeatureGateFlag=0;this.HZc=!1;this.Kek=!0}CEi(){return new Ro(OSF.AppName.WordWebApp,"16",OSF.ClientMode.ReadWrite)}JGi(){const d=rf.a.Vg(G.AFrameworkApplication.lcid);return new vr(d?d.name:null,up.a.dataCulture.name,G.AFrameworkApplication.lcid.toString())}NGm(){G.AFrameworkApplication.J.$("SetAppContextInIframeNameIsEnabled")&&
(this.hostFeatureGateFlag|=1);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SetAppContextInIframeEnabledFor3rdPartyIsEnabled",!1)&&(this.hostFeatureGateFlag|=2);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitFlightingTreatmentAppSettings",!1)&&(G.AFrameworkApplication.J.appSettings.FlightingTreatmentVariables=G.AFrameworkApplication.J.aab);return{["omexForceAnonymous"]:!1,["allowExternalMarketplace"]:G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&
this.HZc,["approvedAddIns"]:G.AFrameworkApplication.J.rb("ApprovedAddIns"),["enableAddinCommands"]:G.AFrameworkApplication.J.$("AddInCommandsIsEnabled"),["enableBlackForestRedirect"]:G.AFrameworkApplication.J.$("BlackForestRedirectIsEnabled"),["enableMyApps"]:G.AFrameworkApplication.J.$("InsertAgaveEnableMyAppsForHost"),["enableMyOrg"]:G.AFrameworkApplication.J.$("InsertAgaveMyOrgEnabledForHost"),["enableDevCatalog"]:G.AFrameworkApplication.J.$("AppsForOfficeDevCatalogIsEnabled"),["enableTaskpaneUpgradeToAppCommand"]:G.AFrameworkApplication.J.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled"),
["enableUploadFileDevCatalog"]:G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&!G.AFrameworkApplication.J.$("UploadFileDevCatalogIsDisabled")&&this.Kek,["enablePrivateCatalog"]:G.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled"),["showSignOutFromPrivateCatalogMessage"]:G.AFrameworkApplication.J.$("ShowSignOutFromPrivateCatalogMessage"),["envCode"]:G.AFrameworkApplication.J.appSettings.OfficeAddinTelemetryDataSourceCode,["enableFirstPartySSO"]:G.AFrameworkApplication.J.$("WordEditorAppsForOfficeFirstPartySSO"),
["enableSingleSignOnForAddin"]:G.AFrameworkApplication.J.$("WordEditorAppsForOfficeSingleSignOnIsEnabled")&&G.AFrameworkApplication.Qln,["hideAppsExtensionUrl"]:G.AFrameworkApplication.hideAppsExtensionUrl,["enableAnonymousUseLegacyCatalogService"]:G.AFrameworkApplication.J.$("AnonymousUseLegacyCatalogServiceIsEnabled"),["enableInsertDialogAccessibilityFix"]:G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix"),["FollowDestinationFormattingPasteIsEnabled"]:!1,["enableDisplayBlockedMinorError"]:G.AFrameworkApplication.J.$("WordEditorDisplayBlockedMinorErrorIsEnabled"),
["disableAppsForOfficeThirdParty"]:G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"),["wacSessionId"]:G.AFrameworkApplication.userSessionId,["disableLogging"]:!G.AFrameworkApplication.J.$("AriaLoggingIsEnabled"),["enableFirstPartySDXErrorMessages"]:G.AFrameworkApplication.J.$("OfficeAddinEnableFirstPartySDXErrorMessages"),["isHostDocumentDomain"]:G.AFrameworkApplication.J.$("AppsForOfficeIsJSHostDocumentDomain"),["sessionStartInfoJson"]:G.AFrameworkApplication.J.rb("SessionStartInfoJson"),
["FollowDestinationThemePasteIsEnabled"]:!1,["sdxAssetsToPrefetchMapping"]:G.AFrameworkApplication.J.rb("SdxAssetsToPrefetchMapping"),["wopiHostOriginFromPostMessage"]:G.AFrameworkApplication.wopiHostOriginFromPostMessage,["wopiHostOriginFromWacPropBag"]:G.AFrameworkApplication.J.rb("PostMessageOrigin"),["wacIsEmbedded"]:G.AFrameworkApplication.J.$("IsEmbedded"),["accessibilityAllowFocusAddinTaskpane"]:G.AFrameworkApplication.J.$("AccessibilityAllowFocusAddinTaskpane"),["isHostFrameTrustCheckEnabledForAddIns"]:G.AFrameworkApplication.J.$("HostFrameTrustCheckIsEnabledForAddIns"),
["isHostFrameTrusted"]:G.AFrameworkApplication.isHostFrameTrusted,["isUpnCheckEnabled"]:G.AFrameworkApplication.J.$("IsUpnCheckEnabled"),["wacUpn"]:G.AFrameworkApplication.J.rb("UserPrincipalName"),["hostInstallAddIns"]:G.AFrameworkApplication.J.rb("HostInstallAddIns"),["hostInstallAddInsIsEnabled"]:G.AFrameworkApplication.J.$("HostInstallAddInsIsEnabled"),["hostAllowedOfficeStore"]:G.AFrameworkApplication.J.$("HostAllowedOfficeStore"),["hostAllowedSdxEmbedding"]:G.AFrameworkApplication.J.$("HostAllowedSdxEmbedding"),
["addinEnforceHttpsIsEnabled"]:G.AFrameworkApplication.J.$("AddinEnforceHttpsIsEnabled"),["hostFeatureGateFlag"]:this.hostFeatureGateFlag,["appSettings"]:G.AFrameworkApplication.J.appSettings,["singleSignOnSettings"]:ul.DRm(),["flightingTreatmentVariables"]:G.AFrameworkApplication.J.aab,["addinActionDefinitionHybridModeIsEnabled"]:G.AFrameworkApplication.J.$("AddinActionDefinitionHybridModeIsEnabled"),["AllowStorageAccessByUserActivationOnIFrame"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AllowStorageAccessByUserActivationOnIFrame",
!1),["enableSetFocusOnTaskpaneOnUserAction"]:!0,["officeJsUrl"]:G.AFrameworkApplication.Lz("OfficeJs/word.js",5),["enableOfficeJsUrlParam"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableOfficeJsUrlParam",!1)}}JWm(){var d=G.AFrameworkApplication.oDb?G.AFrameworkApplication.J.rb("StaticContentHostNonOverriden"):oa.a.o6;const n=d+oa.a.r$h,B=d+oa.a.$Yc;d+=oa.a.p$h;const Q=oa.a.yZk(oa.a.$Yc);return new Za(G.AFrameworkApplication.J.appSettings.AppsForOfficeOmexBaseUrl,
G.AFrameworkApplication.J.appSettings.AppsForOfficeDevCatalogUrl,null,G.AFrameworkApplication.SWh,G.AFrameworkApplication.J.appSettings.EditDocInClientUrl,G.AFrameworkApplication.J.appSettings.StaticContentHost,n,B,d,Q,G.AFrameworkApplication.J.appSettings.AppsForOfficeFirstPartyManifestUrl,G.AFrameworkApplication.J.rb("SdxCdnUrl"),G.AFrameworkApplication.J.appSettings.SdxDmsUrl,G.AFrameworkApplication.J.rb("Sdx1CdnUrl"),G.AFrameworkApplication.J.rb("SovereignFederationDMSToken"),G.AFrameworkApplication.J.rb("SovereignFederationDMSTokenSuffix"))}TWm(){const d=
G.AFrameworkApplication.J.rb("LoggableUserId");return new xb(Ca.a.DV(G.AFrameworkApplication.userName),d)}}Object(D.a)(Zb,"WordEditorActivationSettingsProvider",null,[1071]);class sc{constructor(d){this.YNe=d}fKf(d){const n={};d=this.dKf(d);if(!d)return F.ULS.sendTraceTag(7143683,344,15,"propertyIterator is null"),n;if(!d.ic(21))return n;do{var B=d.currentNode;const Q=B.getValue(Dd.a.aWc);B=B.getValue(Dd.a.Afc);n[Q]=B}while(d.gg(21));return n}uSo(d,n){n||(F.ULS.sendTraceTag(7143684,344,15,"property is null, assume it means empty setting"),
n={});let B=this.dKf(d);if(!B)return F.ULS.sendTraceTag(7143685,344,15,"propertyIterator is null"),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const Q=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");for(;B.ic(21);)B.p$a(!Q);B=this.dKf(d);for(const ha in n){const Aa=this.bxf(ha,n[ha]),bb=Ze.a.create();B.a8(Aa,21,new Jh.a(bb,1),!Q)}Q&&(Object(zk.a)(65,d)?d.gE(21):F.ULS.sendTraceTag(22024345,344,15,"appObj is not a graph node"));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}dispose(){}bxf(d,
n){const B=this.YNe.create(Fc.a.ZMb);B.setValue(Dd.a.aWc,d);B.setValue(Dd.a.Afc,n);return B}dKf(d){if(!Object(zk.a)(65,d))return F.ULS.sendTraceTag(7143686,344,15,"appObj is not a graph node"),null;let n=null;d&&(n=new vc.a,n.set(d));return n}}Object(D.a)(sc,"WordEditorAfoSettingsModel",null,[1070,11]);class $c{constructor(d,n,B){this.yY=d;this.EQ=n;this.GS=B}}Object(D.a)($c,"AppBindingData",null,[]);var Ed=e(117);class Ud{constructor(d,n,B,Q,ha){this.oJ=ha;this.fGd=0;this.sR=()=>{this.vd.raiseEvent(Ud.YAg)};
this.vd=new dc.a;this.ub=d;this.Tb=n;this.XTk=B;this.kga=Q}get sQa(){return this.XTk}oVh(d){this.fGd||this.ub.BD(this.sR);this.vd.addHandler(Ud.YAg,d);this.fGd++}Fwg(d){this.vd.removeHandler(Ud.YAg,d);this.fGd--;this.fGd||this.ub.vpa(this.sR)}getSelectedText(){let d="";for(const n of this.ub.ob)d+=this.lbe(n);if(d===Ed.AParagraphNode.jG)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,lzc:d};d=Ed.AParagraphNode.DR(d);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
lzc:d}}lbe(d){var n=8|(Nf.a.B$?4:0);if(0!==n)return this.oJ.getSelectedText(n,d);n="";if(d)for(const B of d){d=B.cpBegin;const Q=B.cpEnd-d;let ha="";bf.ParagraphReader.lc(B.node)&&(ha=B.node.characterData);switch(B.contextId){case ed.a.paragraph:n+=ha+"\r";break;case ed.a.Nd:0<Q&&(n+=ha.substr(d,Q));break;case ed.a.od:n+="\r"}}return n}w5o(d,n){this.Qqg(Se.a.iWd,d,n)}r5o(d,n,B,Q){const ha=document.createElement("img");d=d.trim();var Aa=new Dq.a;let bb=Aa.Rna(n/72,0),Ib=Aa.Rna(B/72,0),oc="";n=()=>
{var Ac=ha.width;const ad=ha.height;if(ad&&Ac){if(bb&&!Ib||!bb&&Ib)Ac/=ad,bb?Ib=bb/Ac:bb=Ib*Ac;oc=this.Bei(d,bb,Ib);this.Qqg(Se.a.$sa,oc,Q)}else Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};B=()=>{Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};Aa=!1;(Aa=void 0!==ha.onload&&void 0!==ha.onerror)?(ha.onload=n,ha.onerror=B,ha.src=String.format("data:image/png;base64,{0}",d)):(oc=this.Bei(d,bb,Ib),this.Qqg(Se.a.$sa,oc,Q))}Bei(d,n,B){return String.format("<img src='data:image/png;base64,{0}'{1}{2} />",
d,n?String.format(" width='{0}px'",n):"",B?String.format(" height='{0}px'",B):"")}Qqg(d,n,B){const Q=new Yb.DictionaryPropertySet;Q.setValue(oh.a.PZ,n);Q.setValue(oh.a.aQa,!0);Q.setValue(xd.a.dEa,!0);32===this.Tb.Vb(d,1)?this.Tb.Oia(null,d,Q,ha=>{B(32===ha.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):B(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}}Ud.YAg="SelectionChangedEventKey";Object(D.a)(Ud,"ApiObjectModel",
null,[1069]);var Vd=e(93),Ie=e(86);const Ue=d=>{switch(d){case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:return!0;default:return!1}};class dg{constructor(d){this.Yz=d}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Yz)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.NZn()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}NZn(){this.notifyActionHandlerReady();return null}}Object(D.a)(dg,"AddinInternalService",null,[]);class Pf{constructor(d,n,B,Q){this.menuItemId=
d;this.AQa=n;this.jmp=B;this.Ncm=Q}}Object(D.a)(Pf,"NewDocumentParameters",null,[]);var pc=e(1379);class yi{constructor(d,n,B,Q,ha,Aa){this._context=d;this.Qzk=n;this.za=B;this.ELk=Q;this.fz=ha;this.Bk=Aa}createDocument(d){pc.a.yj()||pc.a.Yj();d&&d.length>this.za.sc("WordEditorCreateDocumentApiMaxAllowedBase64",52428800)&&(F.ULS.sendTraceTag(36714716,369,15,"Too large base64 stream size:{0}",d.length),pc.a.Cd());this._context.vo.qH();const n=new Pf("blank","agave",d?"streamBase64":"streamEmpty",d);
return OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{const ha=new Sa.StandardDialog;ha.Md=4;ha.Yx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Aa=>{2!==Aa&&Aa?this.ELk.create(B,Q,n).C_c():Q("Cancelled")})}).then(B=>{this._context.vo.ex();return B?OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Qzk.create(B)):(pc.a.vg(),null)},B=>{this._context.vo.ex();"Cancelled"===B?pc.a.ksp():pc.a.vg();return null})}getEnterpriseUserInfo(){return null}getMruFriendlyPath(){return null}getSharePointTenantRoot(){return null}isTapEnabled(){pc.a.Yj();
return!1}launchFileUrlInOfficeApp(){return!1}openDocument(d){pc.a.aco||pc.a.Yj();d.endsWith(".docx")||pc.a.Cd();const n=this._context.appId?this.Bk.value.getOsfControl(this._context.appId).getManifest().getDefaultDisplayName():"";return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=new Sa.StandardDialog;Q.Md=4;Q.Yx(String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,n),"This Add-In is about to open the document "+d,1,ha=>{1===ha&&gc.a.Zm(d+"?web=1",void 0,void 0,"ExtensionPackage.OpenDialog");
B(null)})})}retrieveStylesFromBase64(d){pc.a.nPp()||pc.a.Yj();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{this.fz.KPo(d,n,B)})}getTypeName(){return"Microsoft.WordServices.Application"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1004:return this.Txm();case 1005:return this.lHm(n);case 1003:return this.oRm();case 1002:return this.wAn();case 1006:return this.tFn(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1001:return this.sLl(n);case 1008:return this.bco(n);case 1007:return this.LPo(n)}d=this.invokeMethod(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}sLl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.createDocument(d)}Txm(){return this.getEnterpriseUserInfo()}lHm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMruFriendlyPath(d)}oRm(){return this.getSharePointTenantRoot()}wAn(){return this.isTapEnabled()}tFn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.launchFileUrlInOfficeApp(n,d)}bco(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.openDocument(d)}LPo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.retrieveStylesFromBase64(d)}}Object(D.a)(yi,"Application",null,[]);class Ei{constructor(){this.nL=null}get types(){return this.nL}set types(d){this.nL=d}getTypeName(){return"Microsoft.WordServices.ContentControlOptions"}invokePropertyGet(d){switch(d){case 1:return this.types}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 1:this.types=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<int>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(Ei,"ContentControlOptions",null,[904]);class ok{constructor(){this.Krh=this.Jrh=this.Orh=this.Nrh=this.Mrh=this.Lrh=this.Irh=!1}get importChangeTrackingMode(){return this.Irh}set importChangeTrackingMode(d){this.Irh=d}get importCustomProperties(){return this.Jrh}set importCustomProperties(d){this.Jrh=d}get importCustomXmlParts(){return this.Krh}set importCustomXmlParts(d){this.Krh=
d}get importPageColor(){return this.Lrh}set importPageColor(d){this.Lrh=d}get importParagraphSpacing(){return this.Mrh}set importParagraphSpacing(d){this.Mrh=d}get importStyles(){return this.Nrh}set importStyles(d){this.Nrh=d}get importTheme(){return this.Orh}set importTheme(d){this.Orh=d}getTypeName(){return"Microsoft.WordServices.InsertFileOptions"}invokePropertyGet(d){switch(d){case 5:return this.importChangeTrackingMode;case 6:return this.importCustomProperties;case 7:return this.importCustomXmlParts;
case 4:return this.importPageColor;case 3:return this.importParagraphSpacing;case 2:return this.importStyles;case 1:return this.importTheme}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 5:this.importChangeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 6:this.importCustomProperties=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 7:this.importCustomXmlParts=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 4:this.importPageColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 3:this.importParagraphSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 2:this.importStyles=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 1:this.importTheme=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(D.a)(ok,"InsertFileOptions",null,[]);var ji=e(1419);class hk{constructor(){this.rOd=this.Tdh=null;this._correlationId=this.q7a="";this.QKh=!0;this.options=null}get authChallenge(){return this.Tdh}set authChallenge(d){this.Tdh=d}get correlationId(){return this._correlationId}set correlationId(d){this._correlationId=d}get policy(){return null}set policy(d){}get resource(){return this.rOd}set resource(d){this.rOd=d}get scope(){return this.q7a}set scope(d){this.q7a=d}get silentLogin(){return this.QKh}set silentLogin(d){this.QKh=
d}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(d){switch(d){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.authChallenge=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.silentLogin=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(hk,
"TokenParameters",null,[250]);class Sl{constructor(d){if(!d)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.rag=d}areShortcutsInUse(d){return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{this.rag.checkShortcutsInUse(d).then(Q=>{n(Q)}).catch(Q=>{B(Q)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((d,n)=>{this.rag.getShortcuts().then(B=>{d(B)}).catch(B=>{n(B)})})}replaceShortcuts(d){return OfficeExtension.WacRuntime.Utility.createPromise((n,
B)=>{this.rag.replaceShortcuts(d).then(()=>{n(null)}).catch(Q=>{B(Q)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){switch(d){case 3:return this.Vfl(n);case 1:return this.uRm();case 2:return this.ILo(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vfl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");return this.areShortcutsInUse(d)}uRm(){return this.getShortcuts()}ILo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.replaceShortcuts(d)}}Object(D.a)(Sl,"ActionService",
null,[]);class Ko{constructor(){this.data=null}}Object(D.a)(Ko,"AugLoopHostMessageReceivedEventArgs",null,[]);var cm=e(1004);class Lo{constructor(d,n=!1,B=null){this.taa=d;this.Rza=n;this.p7=B||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(d){this.Rza||cm.a.AXo(d)}_RegisterHostMessageReceivedEvent(){this.Rza||(Lo.iHj||(cm.a.nCo(d=>{this.p7.fireEvent("",65542,Object.assign(new Ko,{data:d}))}),Lo.iHj=!0),this.p7.register(this.taa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.Rza||
this.p7.unregister(this.taa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1:return this.$Wo(n);case 2:return this.Grk();case 3:return this.Srk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}$Wo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.sendMessage(d);return null}Grk(){this._RegisterHostMessageReceivedEvent();return null}Srk(){this._UnregisterHostMessageReceivedEvent();return null}}
Lo.iHj=!1;Object(D.a)(Lo,"AugLoopEventService",null,[]);var nm=e(1467),pq=e(554);class vl{constructor(d,n,B){this.dmb=this.Ooh=null;this.taa=d;this.CDh=n;if(this.za=B)this.Ooh=this.za.rb("GetAccessTokenOAuthFirstPartyAllowList")}WIm(){this.dmb||(this.dmb=pq.a.xr(Wa.a.instance.Za("Common.App.OAuth.IOAuthManager")));return this.dmb}zrn(d,n){if(!this.CDh||""===this.taa||!this.za)return!1;const B=this.CDh.getOsfControl(this.taa);if(!B)return!1;let Q=!1;this.Ooh.split(";").forEach(ha=>{n===ha&&(Q=!0)});
return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===G.AFrameworkApplication.ta.Pb.gl&&B.isFirstParty()&&d===vl.sal&&Q&&Cb.d(B.getSolutionId())===vl.yal}getAccessTokenFirstPartyOAuth(d,n){let B;B=this.zrn(d,n)?Q=>{const ha=this.WIm();ha.continueWith(()=>{ha.result.kX(d,n).then(Aa=>{Q(Aa);return Aa})})}:Q=>{Q(Object.assign(new nm.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(B)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1:return this.hmm(n)}d=this.invokeMethod(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}hmm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.getAccessTokenFirstPartyOAuth(n,d)}}vl.sal="Maker";vl.yal="fa000000043";Object(D.a)(vl,"Auth",null,[]);class Gk{constructor(){this.onb=null}rRm(){this.onb||(this.onb=pq.a.xr(Wa.a.instance.Za("Common.App.SharedFilePicker.ISharedFilePicker")));return this.onb}getSharedFilePickerResponse(d){return OfficeExtension.WacRuntime.Utility.createPromise((n,
B)=>{try{const Q=this.rRm();Va.Task.WAA.call(null,Q).continueWith(()=>{const ha=Q.result;if(ha){let Aa={};({Zv:Aa}=Rb.d(d)).returnValue?ha.P5c(Aa).then(bb=>{bb&&0<bb.length?n(bb):B(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(bb=>{B(bb)}):B(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else B(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(Q){B(Q)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){switch(d){case 1:return this.qRm(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}qRm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getSharedFilePickerResponse(d)}}Object(D.a)(Gk,"SharedFilePicker",null,[]);class vi{fci(d){return'[data-unique-id="Ribbon-'+d+'"]'}Axj(d,n){n=JSON.parse(n);if("callout"===n.type)return n.params.target=this.fci(n.params.target),d.callout(n.params);n.props.target=
this.fci(n.props.target);return n.props}Ugo(d){return JSON.parse(d)}addNotification(d,n){if(!this.Rza)return Vc.UISurfaces.tN().then(B=>B.addNotification(this.Axj(B,d),this.Ugo(n)))}removeNotification(d){if(!this.Rza)return Vc.UISurfaces.tN().then(n=>n.removeNotification(d))}updateNotification(d,n){if(!this.Rza)return Vc.UISurfaces.tN().then(B=>B.updateNotification(d,this.Axj(B,n)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1:return this.r3k(n);case 3:return this.gHo(n);
case 2:return this.yGp(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}r3k(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.addNotification(n,d)}gHo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.removeNotification(d)}yGp(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.updateNotification(n,d)}}Object(D.a)(vi,"NotificationService",null,[]);class so{createInstance(d,n,B="",Q=null,ha=null){switch(d){case "Microsoft.Office.ActionService":return new Sl(n);case "Microsoft.Office.SharedFilePicker":return new Gk;case "Microsoft.Office.Auth":return new vl(B,Q,ha);case "Microsoft.Office.AugLoopEventService":return new Lo(B);case "Microsoft.Office.NotificationService":return new vi}return null}}
Object(D.a)(so,"WacApiHost",null,[]);class Zp{constructor(d,n,B,Q,ha,Aa=null){this.Yz=d;this.yXk=n;this.ga=B;this.HQk=Q;this.GXk=ha;this.fCd=Aa}endCopilotOperation(d){return this.fCd.endCopilotOperation(d)}startCopilotOperation(d){return this.fCd.startCopilotOperation(d)}undo(){return 32===this.ga.Vb(this.yXk,2)}_RegisterUndoStackChangedEvent(){const d=OfficeExtension.WacRuntime.RichApi.getEventManager();d.isEventRegistered("",65543)||this.HQk(Zp.kui);d.register(this.Yz,"",65543)}_UnregisterUndoStackChangedEvent(){const d=
OfficeExtension.WacRuntime.RichApi.getEventManager();d.unregister(this.Yz,"",65543);d.isEventRegistered("",65543)||this.GXk(Zp.kui)}getTypeName(){return"Microsoft.Office.UndoService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.Wzp();case 2:return this.Jrk();case 3:return this.Vrk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 5:return this.G6l(n);case 4:return this.hkp(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}G6l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.endCopilotOperation(d)}hkp(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.startCopilotOperation(d)}Wzp(){return this.undo()}Jrk(){this._RegisterUndoStackChangedEvent();return null}Vrk(){this._UnregisterUndoStackChangedEvent();return null}static kui(){OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent("",65543,null)}}Object(D.a)(Zp,"UndoService",null,[]);class El{constructor(){this.responseData=null}}Object(D.a)(El,"UserFeedbackResponseEventArgs",
null,[]);class Lm{constructor(){this.isFeedbackSent=!1}}Object(D.a)(Lm,"UserFeedbackUIDismissedEventArgs",null,[]);class Nk{constructor(d,n,B=!1,Q=null){this.taa=d;this.qFb=n;this.Rza=B;this.p7=Q||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(d){this.p7.fireEvent("",65546,Object.assign(new Lm,{isFeedbackSent:d}))}onError(){}Dam(d){this.p7.fireEvent("",65550,Object.assign(new El,{responseData:JSON.stringify(d)}))}aJm(d){switch(d){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";
case 3:return"Unclassified";default:return"Unclassified"}}bJm(d){switch(d){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}$Im(d){const n={};n.isScenarioEnabled=d.isScenarioEnabled;n.scenarioType=d.scenarioType;if(d=d.question){const B={};B.questionUiType=d.questionUIType;B.questionUiBehavior=d.questionUIBehavior;B.questionInstruction=d.questionInstruction;B.questionOptions=d.questionOptions;n.questionDetails=B}return n}$ec(d,n,B){"True"===B?d[n]=!0:"False"===B&&(d[n]=!1)}canCollectUserFeedback(){return G.AFrameworkApplication.uE}collectUserFeedback(d,
n,B,Q){if(!this.Rza){const ha={};G.AFrameworkApplication.J.tUd(ha);const Aa=this.qFb.getContext(ha);Aa.initialFeedbackType=this.aJm(d);Aa.uiType=this.bJm(n);Aa.telemetryGroup.featureArea=B;Q.v2Config.contextDataFiles&&(Aa.isShareContextDataEnabled=!0,Aa.getContextData=()=>Promise.all(Nc.a.map(Q.v2Config.contextDataFiles,bb=>window.fetch("data:application/octet-stream;base64,"+bb.base64Data).then(Ib=>Ib.blob()).then(Ib=>new File([Ib],bb.fileName,{type:bb.fileType})))));(d=Q.v2Config.scenarioConfig)&&
(Aa.scenarioConfig=this.$Im(d));this.$ec(Aa,"showEmailAddress",Q.v2Config.isEmailCollectionEnabled);this.$ec(Aa,"isFileUploadEnabled",Q.v2Config.isFileUploadEnabled);this.$ec(Aa,"screenshot",Q.v2Config.isScreenshotEnabled);this.$ec(Aa,"isThankYouPageDisabled",Q.v2Config.isThankYouPageDisabled);this.$ec(Aa,"isHostManagedContextDataEnabled",Q.v2Config.isHostManagedContextDataEnabled);this.$ec(Aa,"isRetrieveFormDataEnabled",Q.v2Config.isRetrieveFormDataEnabled);Aa.hostManagedContextDataExplanationUrl=
Q.v2Config.hostManagedContextDataExplanationUrl;Vc.UISurfaces.eae().then(bb=>{bb.initializeFeedbackModal(Aa,Object(X.a)(this,this.onDismiss,"onDismiss"),Object(X.a)(this,this.onError,"onError"),Object(X.a)(this,this.Dam,"extractFeedbackDataForHost"));return bb})}}_RegisterUserFeedbackResponseEvent(){this.Rza||this.p7.register(this.taa,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.Rza||this.p7.register(this.taa,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.Rza||this.p7.unregister(this.taa,
"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.Rza||this.p7.unregister(this.taa,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 27:return this.qrl();case 1:return this.bBl(n);case 28:return this.Krk();case 18:return this.Lrk();case 29:return this.Wrk();case 19:return this.Xrk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}qrl(){return this.canCollectUserFeedback()}bBl(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"object");this.collectUserFeedback(n,B,Q,d);return null}Krk(){this._RegisterUserFeedbackResponseEvent();return null}Lrk(){this._RegisterUserFeedbackUIDismissedEvent();return null}Wrk(){this._UnregisterUserFeedbackResponseEvent();
return null}Xrk(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(D.a)(Nk,"UserFeedbackService",null,[]);class wl{VUf(d){const n=new Dm("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),B=new Ci($i.cJm(),"Web","en-Us"),Q=new nj;Q.gjc=d;rc.instance.med(n,Ha.MFe,"CopilotHelpTaskpane",B,Q)}launchHelpPaneByArticleId(d){this.VUf({SourceControlId:"SearchHelp",query:"AssetID="+d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(d){this.VUf({SourceControlId:"SearchHelp",
query:"AssetID="+d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(d){this.VUf({SourceControlId:"SearchHelp",query:d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 2:return this.wFn(n);case 3:return this.xFn(n);case 1:return this.yFn(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}wFn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.launchHelpPaneByArticleId(d)}xFn(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchHelpPaneByArticleIdString(d)}yFn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchHelpPaneByQuery(d)}}Object(D.a)(wl,"CopilotService",null,[]);var ln;(function(d){d[d.Fxi=0]="generic";d[d.yAl=1]="coherencyFailure";d[d.lli=2]="disabledByPolicy";d[d.ycm=3]="fileCheckedOut";d[d.E8p=4]="fileEncrypted";d[d.G8p=5]="fileLocked";d[d.L8p=6]="fileNotSupported";d[d.Ocm=7]="fileTooLarge";
d[d.edq=8]="invalidOperationOnZeroByteFile";d[d.x$i=9]="labelDisabled";d[d.Ydq=10]="labelErrorRetryLater";d[d.qEn=11]="labelIdNotFound";d[d.$dq=12]="labelIrmDisabledByTenant";d[d.aeq=13]="labelNotSupported";d[d.vfq=14]="mandatoryConflict";d[d.lgq=15]="minorVersionLimitExceeded"})(ln||(ln={}));Object(D.b)("SetPolicyLabelErrorType",ln);class wr{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=
0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(d){switch(d){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;
case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,
"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,
"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(D.a)(wr,"SensitivityLabelInfo",null,[]);class un{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(d){switch(d){case 20:return this.context;case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(un,"SensitivityLabelChangedEventArgs",null,[]);class Rr{constructor(d,
n){this.p7=OfficeExtension.WacRuntime.RichApi.getEventManager();this.taa=d;this.oFd=n}nEa(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}Hoa(d,n){d={["Class"]:"SensitivityService",["ControlId"]:this.taa,["Api"]:d,["Hr"]:n.toString()};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",dataFields:zf.a.iG(d)}))}QXm(d){return d.HasUserDefinedPermissions?2:
d.IsEndpointProtectionEnabled?1:0}aSg(d){const n=new wr;n.color=d.Color;n.description=d.Tooltip;n.displayName=d.ParentName?d.ParentName+"\\"+d.DisplayName:d.DisplayName;n.encryptionType=this.QXm(d);n.hasExtractForUser=d.HasExtractForUser;n.isDke=!1;n.isEnabled=d.Enabled;n.labelId=d.Id;n.order=d.Order;n.parentName=d.ParentName;n.tenantId="";n.version=0;return n}z0n(d){const n=new Lb;n.Id=d.labelId;n.Enabled=d.isEnabled;n.DisplayName=d.displayName;n.Order=d.order;n.Tooltip=d.description;n.IsEndpointProtectionEnabled=
1==d.encryptionType||2==d.encryptionType;n.Color=d.color;n.HasUserDefinedPermissions=2==d.encryptionType;n.ParentName=d.parentName;return n}n4o(d){switch(d){case ln.Fxi:return 2147467259;case ln.lli:return 2147205115;case ln.qEn:return 2147205112;case ln.x$i:return 2147205117;default:return 2147467259}}getHighestSensitivityLabel(d){return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{var Q;this.nEa()||(this.Hoa("getHighestSensitivityLabel",2147500033),B(2147500033));d&&0!=d.length||(this.Hoa("getHighestSensitivityLabel",
2147942487),B(2147942487));var ha=null===(Q=this.oFd)||void 0===Q?void 0:Q.instance;ha||(this.Hoa("getHighestSensitivityLabel",2147942488),B(2147942488));Q=[];for(const Aa of d)Q=Q.concat(Aa.labelId);ha=ha.getHighestSensitivityLabel(Q);null==ha?(this.Hoa("getHighestSensitivityLabel",2147205112),B(2147205112)):n(this.aSg(ha))})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((d,n)=>{var B;this.nEa()||(this.Hoa("getLabel",2147500033),n(2147500033));const Q=null===(B=this.oFd)||void 0===
B?void 0:B.instance;Q||(this.Hoa("getLabel",2147942488),n(2147942488));(B=Q.Fom())?d(this.aSg(B)):(this.Hoa("getLabel",2147500037),n(2147500037))})}tryUpgradeLabel(d,n){return OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{var ha;this.nEa()||(this.Hoa("tryUpgradeLabel",2147500033),Q(2147500033));d||(this.Hoa("tryUpgradeLabel",2147942487),Q(2147942487));const Aa=null===(ha=this.oFd)||void 0===ha?void 0:ha.instance;Aa||(this.Hoa("tryUpgradeLabel",2147942488),Q(2147942488));n="OFFICEJS_SENSITIVITY_CONTEXT_"+
n;ha=Aa.tryUpgradeLabel(this.z0n(d),n);0==ha?B(ha):(this.Hoa("tryUpgradeLabel",ha),Q(ha))})}_RegisterSensitivityLabelChangedEvent(){var d;if(this.nEa()){var n=null===(d=this.oFd)||void 0===d?void 0:d.instance;n?(n.RMb((B,Q)=>{var ha;B=new un;B.context=(null===(ha=Q.context)||void 0===ha?0:ha.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?Q.context.substring(29):Q.context;B.error=Q.iE?0:this.n4o(Q.LDg);B.newLabel=this.aSg(Q.ulf);this.p7.fireEvent("",65549,B)}),this.p7.register(this.taa,"",65549)):this.Hoa("registerSensitivityLabelChangedEvent",
2147942488)}else this.Hoa("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.nEa()?this.p7.unregister(this.taa,"",65549):this.Hoa("unregisterSensitivityLabelChangedEvent",2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 16:return this.Hrk();case 17:return this.Trk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 3:return this.OBm(n);case 1:return this.eEm();case 2:return this.dzp(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}OBm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(d)}eEm(){return this.getLabel()}dzp(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"SensitivityLabelInfo");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.tryUpgradeLabel(n,d)}Hrk(){this._RegisterSensitivityLabelChangedEvent();return null}Trk(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(D.a)(Rr,"SensitivityService",
null,[]);class dr{get critiques(){return this.tyk}set critiques(d){this.tyk=d}getTypeName(){return"Microsoft.WordServices.AnnotationSet"}invokePropertyGet(d){switch(d){case 1:return this.critiques}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 1:this.critiques=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"Array<WordEditor.Extension.Critique>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(dr,"AnnotationSet",null,[]);class qq{get colorScheme(){return this.Twk}set colorScheme(d){this.Twk=
d}get length(){return this.jI}set length(d){this.jI=d}get start(){return this.Ufa}set start(d){this.Ufa=d}getTypeName(){return"Microsoft.WordServices.Critique"}invokePropertyGet(d){switch(d){case 1:return this.colorScheme;case 2:return this.length;case 3:return this.start}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 1:this.colorScheme=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 2:this.length=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 3:this.start=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(qq,"Critique",null,[]);class Yh{constructor(){this.Yrh=this.Xrh=!1}get includeHiddenText(){return this.Xrh}set includeHiddenText(d){this.Xrh=d}get includeTextMarkedAsDeleted(){return this.Yrh}set includeTextMarkedAsDeleted(d){this.Yrh=d}getTypeName(){return"Microsoft.WordServices.GetTextOptions"}invokePropertyGet(d){switch(d){case 1:return this.includeHiddenText;case 2:return this.includeTextMarkedAsDeleted}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 1:this.includeHiddenText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 2:this.includeTextMarkedAsDeleted=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(Yh,"GetTextOptions",null,[]);class ek{constructor(d,n,B){this.Tff=null;this.Tib=n;this.Yz=B;this._context=d}hostName(){return"WordOnline"}appId(){return this.Tib}createInstance(d){switch(d){case "Microsoft.WordServices.Application":return new yi(Wa.a.instance.resolve("WordEditor.Extension.RequestContext"),
Wa.a.instance.resolve("WordEditor.Extension.DocumentCreatedFactory"),G.AFrameworkApplication.J,Wa.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory"),Wa.a.instance.resolve("WordEditor.Extension.FileApiOperations"),Wa.a.instance.zf("Common.App.AppsForOfficeCommon.IContextActivationManager"));case "Microsoft.WordServices.SearchOptions":return new ji.a;case "Microsoft.WordServices.ContentControlOptions":return new Ei;case "Microsoft.WordServices.InsertFileOptions":return new ok;
case "Microsoft.WordServices.GetTextOptions":return new Yh;case "Microsoft.Authentication.AuthenticationService":return Wa.a.instance.resolve("WordEditor.Extension.AuthenticationServiceFactory").create(this._context,this.Yz);case "Microsoft.Authentication.TokenParameters":return new hk;case "Microsoft.Office.Licensing.License":return Wa.a.instance.resolve("WordEditor.Extension.LicenseFactory").create(this.Yz);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return Wa.a.instance.resolve("WordEditor.Extension.AppRuntimePersistenceServiceFactory").create(this._context,
this.Yz);case "Microsoft.AppRuntime.AppRuntimeService":return Wa.a.instance.resolve("WordEditor.Extension.AppRuntimeServiceFactory").create(this._context,this.Yz);case "Microsoft.InternalService.AddinInternalService":return new dg(this.Yz);case "Microsoft.Office.AugLoopEventService":case "Microsoft.Office.NotificationService":var n=Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").nt.getOsfControl(this.Yz);if(null===n||void 0===n?0:n.isFirstParty())return this.Tff||(this.Tff=
new so),this.Tff.createInstance(d,null,this.Yz);break;case "Microsoft.Office.UndoService":n=Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").nt.getOsfControl(this.Yz);if(null===n||void 0===n?0:n.isFirstParty()){const B=Wa.a.instance.resolve("Box4.IUndoManager");d=Wa.a.instance.resolve("WordEditor.CopilotOperationLifecycleHandler");return new Zp(this.Yz,Se.a.undo,Wa.a.instance.resolve("Common.IActionManager"),Q=>B.E7k(Q),Q=>B.WIo(Q),d)}break;case "Microsoft.Office.UserFeedbackService":n=
Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").nt.getOsfControl(this.Yz);if(null===n||void 0===n?0:n.isFirstParty())return G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8426373_IocCrashFix")?new Nk(this.Yz,Wa.a.instance.Wa("Common.App.ICustomerFeedbackUiWrapper"),!1):new Nk(this.Yz,Wa.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1);break;case "Microsoft.Office.SensitivityLabelInfo":return new wr;case "Microsoft.Office.SensitivityService":n=
Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").nt.getOsfControl(this.Yz);if(null===n||void 0===n?0:n.isFirstParty)return new Rr(this.Yz,Wa.a.instance.Za("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":n=Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").nt.getOsfControl(this.Yz);if("9202c06a-b7d3-466f-9adb-acad75789dbc"===(null===n||void 0===n?void 0:n.getSolutionId()))return new wl;break;case "Microsoft.WordServices.AnnotationSet":return new dr;
case "Microsoft.WordServices.Critique":return new qq}F.ULS.sendTraceTag(17359129,369,10,"Typename: {0} is an invalid parameter. Only instance for Application or SearchOptions can be created through this method.",d);pc.a.vg();return null}}Object(D.a)(ek,"RichApiHost",null,[1095]);var Ok;(function(d){d[d.none=0]="none";d[d.oqq=1]="primitive";d[d.Pzq=2]="valueObject";d[d.n2p=3]="classObject"})(Ok||(Ok={}));Object(D.b)("TypeCategory_Deprecated",Ok);var Fi=e(803);const ls=d=>{if(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.IncludeWacApiHostTypeRegister")){let Ti,
jl;Ti=d.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);jl=Ti.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);jl.addParameter("shortcuts","String[]",1,null,0);jl=Ti.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);jl=Ti.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);jl.addParameter("shortcuts","Object",1,null,0);Ti=d.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);jl=Ti.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);jl.addParameter("pickerCustomizationJsonString","String",1,null,0);Ti=d.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);jl=Ti.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);jl.addParameter("appName","String",1,null,0);jl.addParameter("target","String",
1,null,0);Ti=d.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Ti.addProperty("Data",4,"String",1,!1,null,0);Ti=d.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);jl=Ti.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);jl.addParameter("data","String",1,null,0);jl=Ti.addMethod("_RegisterHostMessageReceivedEvent",
2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);jl=Ti.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);Ti=d.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);Ti.addProperty("BatchId",6,"String",1,!1,null,0);Ti=d.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);jl=Ti.addMethod("EndCopilotOperation",
5,"Void",0,0,"EndCopilotOperation",4);jl.addParameter("batchId","String",1,null,0);jl=Ti.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);jl.addParameter("batchId","String",1,null,0);jl=Ti.addMethod("Undo",1,"Boolean",1,0,"Undo",4);jl=Ti.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);jl=Ti.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Ti=d.addEnumType("Microsoft.Office.UserFeedbackType");
Ti.addEnumField("Like",0);Ti.addEnumField("Dislike",1);Ti.addEnumField("Idea",2);Ti.addEnumField("Unclassified",3);Ti=d.addEnumType("Microsoft.Office.UserFeedbackUIType");Ti.addEnumField("ModalDialog",0);Ti.addEnumField("Taskpane",1);Ti=d.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);jl=Ti.addMethod("CanCollectUserFeedback",27,"Boolean",1,1,"CanCollectUserFeedback",4);jl=Ti.addMethod("CollectUserFeedback",1,"Void",
0,1,"CollectUserFeedback",4);jl.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);jl.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);jl.addParameter("featureArea","String",1,null,0);jl.addParameter("options","Object",1,null,0);jl=Ti.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",4);jl=Ti.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);jl=Ti.addMethod("_UnregisterUserFeedbackResponseEvent",
29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);jl=Ti.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);Ti=d.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);jl=Ti.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);jl.addParameter("props","String",1,null,0);jl.addParameter("options","String",1,null,0);jl=Ti.addMethod("RemoveNotification",
3,"Void",0,0,"RemoveNotification",4);jl.addParameter("id","String",1,null,0);jl=Ti.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);jl.addParameter("id","String",1,null,0);jl.addParameter("props","String",1,null,0);Ti=d.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",2,0);Ti.addProperty("Color",15,"String",1,!1,null,0);Ti.addProperty("Description",13,"String",1,!1,null,0);Ti.addProperty("DisplayName",
12,"String",1,!1,null,0);Ti.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);Ti.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);Ti.addProperty("IsDke",9,"Boolean",1,!1,null,0);Ti.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);Ti.addProperty("LabelId",5,"String",1,!1,null,0);Ti.addProperty("Order",11,"Int32",1,!1,null,0);Ti.addProperty("ParentName",14,"String",1,!1,null,0);Ti.addProperty("TenantId",6,"String",1,!1,null,0);Ti.addProperty("Version",4,"Int32",
1,!1,null,0);Ti=d.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);Ti.addProperty("Context",20,"String",1,!1,null,0);Ti.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);Ti.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);Ti.addProperty("PreviousLabel",18,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);Ti=d.addType("Microsoft.Office.SensitivityService",
"{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);jl=Ti.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);jl.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);jl=Ti.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);jl=Ti.addMethod("TryUpgradeLabel",2,"Void",0,0,"TryUpgradeLabel",4);jl.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",
2,null,0);jl.addParameter("context","String",1,null,0);jl=Ti.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);jl=Ti.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);Ti=d.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",3,2);jl=Ti.addMethod("LaunchHelpPaneByArticleId",2,"Void",0,0,"LaunchHelpPaneByArticleId",
4);jl.addParameter("articleId","Int32",1,null,0);jl=Ti.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);jl.addParameter("articleId","String",1,null,0);jl=Ti.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);jl.addParameter("query","String",1,null,0)}const n=Fi.a.EF?"Microsoft.WordServices.AugloopAnnotation":"Microsoft.WordServices.Annotation",B=Fi.a.EF?"Microsoft.WordServices.AugloopAnnotationCollection":"Microsoft.WordServices.AnnotationCollection",
Q=Fi.a.EF?"Microsoft.WordServices.AugloopAnnotationState":"Microsoft.WordServices.AnnotationState",ha=Fi.a.EF?"Microsoft.WordServices.Annotation":"Microsoft.WordServices.AddInCritiqueAnnotation",Aa=Fi.a.EF?"Microsoft.WordServices.AnnotationCollection":"Microsoft.WordServices.AddInCritiqueAnnotationCollection",bb=Fi.a.EF?"Microsoft.WordServices.AnnotationState":"Microsoft.WordServices.AddInCritiqueAnnotationState",Ib=d.addType(n,"{4a0f635f-767e-4a07-b75e-80e8432ca12c}","",3,0);Ib.addProperty("Content",
1,"Object",1,!0,null,0);Ib.addProperty("Id",2,"String",1,!0,null,0);Ib.addProperty("_ReferenceId",3,"String",1,!0,null,0);Ib.addProperty("_State",4,Q,1,!1,null,0);Ib.addMethod("Delete",1006,"Void",0,0,"Delete",0);Ib.addMethod("GetParentAsAnnotation",1005,n,3,1,"ParentAsAnnotation",0);Ib.addMethod("GetParentAsParagraph",1004,"Microsoft.WordServices.Paragraph",3,1,"ParentAsParagraph",0);Ib.addMethod("GetParentType",1003,"Microsoft.WordServices.AnnotationParentType",1,1,"ParentType",0);Ib.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);Ib.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const oc=d.addType(B,"{0b4dc55f-db0a-4fda-93fe-2a32432b87d3}","",3,0);oc.addProperty("_ReferenceId",2,"String",1,!0,null,0);oc.addMethod("GetFirst",1003,n,3,1,"First",0);oc.addMethod("GetFirstOrNullObject",1004,n,3,1,"FirstOrNullObject",0);oc.addIndexerMethod(1,n,3,0).addParameter("index","Object",1,null,0);oc.addMethod("Refresh",1005,"Void",0,1,"Refresh",0);oc.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",
0);oc.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);oc.setCollectionInfo(n,!0);const Ac=d.addEnumType("Microsoft.WordServices.CritiqueColorScheme");Ac.addEnumField("Red",0);Ac.addEnumField("Green",1);Ac.addEnumField("Blue",2);Ac.addEnumField("Lavender",3);Ac.addEnumField("Berry",4);const ad=d.addType("Microsoft.WordServices.Critique","{a080509b-c019-4abd-b9c0-537b1acbec13}","{9b24a8ca-e482-4a0d-9088-2f15ee3314d5}",2,0);ad.addProperty("ColorScheme",1,"Microsoft.WordServices.CritiqueColorScheme",
1,!1,null,0);ad.addProperty("Length",2,"Int32",1,!1,null,0);ad.addProperty("Start",3,"Int32",1,!1,null,0);const sd=d.addType("Microsoft.WordServices.CritiqueAnnotation","{29bdec2a-9618-4f5b-ac8e-b7c662f25e8b}","",3,0);sd.addProperty("Critique",2,"Microsoft.WordServices.Critique",2,!0,null,0);sd.addProperty("Range",3,"Microsoft.WordServices.Range",3,!0,null,0);sd.addProperty("_ReferenceId",1,"String",1,!0,null,0);sd.addMethod("Accept",1003,"Void",0,0,"Accept",0);sd.addMethod("Reject",1004,"Void",0,
0,"Reject",0);sd.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);sd.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const wd=d.addEnumType(bb);wd.addEnumField("Created",0);wd.addEnumField("Accepted",1);wd.addEnumField("Rejected",2);d.addType("Microsoft.WordServices.AnnotationSet","{dfd377f4-ffb7-4af4-9693-ac7693daf019}","{6aa74201-b4b9-49b6-8430-00bfaa074b76}",2,0).addProperty("Critiques",1,"Microsoft.WordServices.Critique[]",2,!1,null,0);const yd=d.addType(ha,"{9bea77fa-982e-44ef-bb15-3c8c98be2f58}",
"",3,0);yd.addProperty("CritiqueAnnotation",3,"Microsoft.WordServices.CritiqueAnnotation",3,!0,null,0);yd.addProperty("Id",1,"String",1,!0,null,0);yd.addProperty("State",4,bb,1,!0,null,0);yd.addProperty("_ReferenceId",2,"String",1,!0,null,0);yd.addMethod("Delete",1003,"Void",0,0,"Delete",0);yd.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);yd.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const be=d.addType(Aa,"{7028c6d1-419f-455d-9832-b669a875986a}","",3,0);be.addProperty("_ReferenceId",
2,"String",1,!0,null,0);be.addMethod("GetFirst",1003,ha,3,0,"First",0);be.addMethod("GetFirstOrNullObject",1004,ha,3,0,"FirstOrNullObject",0);be.addIndexerMethod(1,ha,3,0).addParameter("index","Object",1,null,0);be.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);be.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);be.setCollectionInfo(ha,!0);const ye=d.addType("Microsoft.WordServices.Application","{e033f092-ac87-40f7-a865-769c9fdacd72}","{2c000fc1-c973-41fc-b5e3-8f3a0cc65c12}",3,
0);ye.addMethod("CreateDocument",1001,"Microsoft.WordServices.DocumentCreated",3,1,"CreateDocument",0).addParameter("base64File","String",1,null,0);ye.addMethod("GetEnterpriseUserInfo",1004,"String",1,1,"EnterpriseUserInfo",4);ye.addMethod("GetMruFriendlyPath",1005,"String",1,1,"MruFriendlyPath",4).addParameter("documentUrl","String",1,null,0);ye.addMethod("GetSharePointTenantRoot",1003,"String",1,1,"SharePointTenantRoot",4);ye.addMethod("IsTapEnabled",1002,"Boolean",1,1,"IsTapEnabled",4);const Qe=
ye.addMethod("LaunchFileUrlInOfficeApp",1006,"Boolean",1,1,"LaunchFileUrlInOfficeApp",4);Qe.addParameter("documentUrl","String",1,null,0);Qe.addParameter("useUniversalAsBackUp","Boolean",1,null,0);ye.addMethod("OpenDocument",1008,"Void",0,1,"OpenDocument",0).addParameter("fileLocation","String",1,null,0);ye.addMethod("RetrieveStylesFromBase64",1007,"String",1,1,"RetrieveStylesFromBase64",0).addParameter("base64File","String",1,null,0);const af=d.addType("Microsoft.WordServices.Body","{5516bb1d-cf31-4aa9-97cd-ccebc2ee9e6d}",
"",3,0);af.addProperty("ContentControls",3,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);af.addProperty("Endnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);af.addProperty("Fields",20,"Microsoft.WordServices.FieldCollection",3,!0,null,0);af.addProperty("Font",5,"Microsoft.WordServices.Font",3,!0,null,0);af.addProperty("Footnotes",18,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);af.addProperty("InlinePictures",7,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);af.addProperty("Lists",11,"Microsoft.WordServices.ListCollection",3,!0,null,0);af.addProperty("Paragraphs",2,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);af.addProperty("ParentBody",10,"Microsoft.WordServices.Body",3,!0,null,0);af.addProperty("ParentBodyOrNullObject",16,"Microsoft.WordServices.Body",3,!0,null,0);af.addProperty("ParentContentControl",4,"Microsoft.WordServices.ContentControl",3,!0,null,0);af.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",
3,!0,null,0);af.addProperty("ParentSection",13,"Microsoft.WordServices.Section",3,!0,null,0);af.addProperty("ParentSectionOrNullObject",17,"Microsoft.WordServices.Section",3,!0,null,0);af.addProperty("Style",6,"String",1,!1,null,0);af.addProperty("StyleBuiltIn",14,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);af.addProperty("Tables",12,"Microsoft.WordServices.TableCollection",3,!0,null,0);af.addProperty("Text",8,"String",1,!0,null,0);af.addProperty("Type",9,"Microsoft.WordServices.BodyType",
1,!0,null,0);af.addProperty("_ReferenceId",1,"String",1,!0,null,0);af.addMethod("Clear",1011,"Void",0,0,"Clear",0);af.addMethod("GetComments",1019,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);af.addMethod("GetContentControls",1021,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);af.addMethod("GetHtml",1013,"String",1,1,"Html",0);af.addMethod("GetOoxml",
1014,"String",1,1,"Ooxml",0);af.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const Qf=af.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);Qf.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);Qf.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);af.addMethod("InsertContentControl",1007,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",
0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const hf=af.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);hf.addParameter("base64File","String",1,null,0);hf.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const di=af.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);di.addParameter("html","String",1,null,0);di.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);const vj=af.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);vj.addParameter("base64EncodedImage","String",1,null,0);vj.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Wk=af.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);Wk.addParameter("ooxml","String",1,null,0);Wk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,
0);const Tm=af.addMethod("InsertParagraph",1006,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Tm.addParameter("paragraphText","String",1,null,0);Tm.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);af.addMethod("GetReviewedText",1020,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);af.addMethod("GetTrackedChanges",1022,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",
0);const Dk=af.addMethod("InsertTable",1017,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Dk.addParameter("rowCount","Int32",1,null,0);Dk.addParameter("columnCount","Int32",1,null,0);Dk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Dk.addParameter("values","String[][]",1,null,0);const gi=af.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);gi.addParameter("text","String",1,null,0);gi.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);const oi=af.addMethod("Search",1012,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);oi.addParameter("searchText","String",1,null,0);oi.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);af.addMethod("Select",1015,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);af.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);af.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Ni=af.addMethod("_Search2",
1018,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Ni.addParameter("searchText","String",1,null,0);Ni.addParameter("searchFlags","Int32",1,null,0);const wh=d.addType("Microsoft.WordServices.Border","{72d3db56-49ef-44f4-b2df-fbac10f1de2a}","",3,0);wh.addProperty("Color",2,"String",1,!1,null,0);wh.addProperty("Type",3,"Microsoft.WordServices.BorderType",1,!1,null,0);wh.addProperty("Width",4,"Microsoft.WordServices.BorderWidth",1,!1,null,0);wh.addProperty("Location",6,"Microsoft.WordServices.BorderLocation",
1,!0,null,0);wh.addProperty("Visible",5,"Boolean",1,!1,null,0);wh.addProperty("_ReferenceId",1,"String",1,!0,null,0);wh.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);wh.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const lg=d.addType("Microsoft.WordServices.BorderCollection","{494be04f-fab5-4b2b-9f72-b755495ee558}","",3,0);lg.addProperty("InsideBorderColor",2,"String",1,!1,null,0);lg.addProperty("InsideBorderType",3,"Microsoft.WordServices.BorderType",1,!1,null,0);lg.addProperty("InsideBorderWidth",
4,"Microsoft.WordServices.BorderWidth",1,!1,null,0);lg.addProperty("OutsideBorderColor",5,"String",1,!1,null,0);lg.addProperty("OutsideBorderType",6,"Microsoft.WordServices.BorderType",1,!1,null,0);lg.addProperty("OutsideBorderWidth",7,"Microsoft.WordServices.BorderWidth",1,!1,null,0);lg.addProperty("_ReferenceId",8,"String",1,!0,null,0);lg.addMethod("GetByLocation",1001,"Microsoft.WordServices.Border",3,1,"ByLocation",0).addParameter("location","Microsoft.WordServices.BorderLocation",1,null,0);lg.addMethod("GetFirst",
1004,"Microsoft.WordServices.Border",3,1,"First",0);lg.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.Border",3,1,"FirstOrNullObject",0);lg.addIndexerMethod(1,"Microsoft.WordServices.Border",3,0).addParameter("index","Object",1,null,0);lg.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);lg.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);lg.setCollectionInfo("Microsoft.WordServices.Border",!0);const Lg=d.addType("Microsoft.WordServices.ContentControl","{b86e5ae1-476e-4e56-825d-885468e549f3}",
"",3,0);Lg.addProperty("Appearance",7,"Microsoft.WordServices.ContentControlAppearance",1,!1,null,0);Lg.addProperty("CannotDelete",10,"Boolean",1,!1,null,0);Lg.addProperty("CannotEdit",11,"Boolean",1,!1,null,0);Lg.addProperty("CheckboxContentControl",32,"Microsoft.WordServices.CheckboxContentControl",3,!0,null,0);Lg.addProperty("Color",8,"String",1,!1,null,0);Lg.addProperty("ContentControls",15,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Lg.addProperty("Endnotes",30,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Lg.addProperty("Fields",31,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Lg.addProperty("Font",12,"Microsoft.WordServices.Font",3,!0,null,0);Lg.addProperty("Footnotes",29,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Lg.addProperty("Id",1,"UInt32",1,!0,null,0);Lg.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Lg.addProperty("Lists",19,"Microsoft.WordServices.ListCollection",3,!0,null,0);Lg.addProperty("Paragraphs",14,"Microsoft.WordServices.ParagraphCollection",
3,!0,null,0);Lg.addProperty("ParentBody",25,"Microsoft.WordServices.Body",3,!0,null,0);Lg.addProperty("ParentContentControl",16,"Microsoft.WordServices.ContentControl",3,!0,null,0);Lg.addProperty("ParentContentControlOrNullObject",26,"Microsoft.WordServices.ContentControl",3,!0,null,0);Lg.addProperty("ParentTable",22,"Microsoft.WordServices.Table",3,!0,null,0);Lg.addProperty("ParentTableCell",21,"Microsoft.WordServices.TableCell",3,!0,null,0);Lg.addProperty("ParentTableCellOrNullObject",27,"Microsoft.WordServices.TableCell",
3,!0,null,0);Lg.addProperty("ParentTableOrNullObject",28,"Microsoft.WordServices.Table",3,!0,null,0);Lg.addProperty("PlaceholderText",5,"String",1,!1,null,0);Lg.addProperty("RemoveWhenEdited",9,"Boolean",1,!1,null,0);Lg.addProperty("Style",13,"String",1,!1,null,0);Lg.addProperty("StyleBuiltIn",24,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Lg.addProperty("Subtype",23,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Lg.addProperty("Tables",20,"Microsoft.WordServices.TableCollection",
3,!0,null,0);Lg.addProperty("Tag",4,"String",1,!1,null,0);Lg.addProperty("Text",18,"String",1,!0,null,0);Lg.addProperty("Title",3,"String",1,!1,null,0);Lg.addProperty("Type",6,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Lg.addProperty("_ReferenceId",2,"String",1,!0,null,0);Lg.addMethod("Clear",1010,"Void",0,0,"Clear",0);Lg.addMethod("Delete",1011,"Void",0,0,"Delete",0).addParameter("keepContent","Boolean",1,null,0);Lg.addMethod("GetComments",1021,"Microsoft.WordServices.CommentCollection",
3,1,"Comments",0);Lg.addMethod("GetContentControls",1023,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Lg.addMethod("GetHtml",1013,"String",1,1,"Html",0);Lg.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);Lg.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",
1,null,0);const gp=Lg.addMethod("GetTextRanges",1019,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);gp.addParameter("endingMarks","String[]",1,null,0);gp.addParameter("trimSpacing","Boolean",1,null,0);Lg.addMethod("GetTrackedChanges",1024,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);const Fu=Lg.addMethod("InsertBreak",1008,"Void",0,0,"InsertBreak",0);Fu.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);Fu.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const YI=Lg.addMethod("InsertFileFromBase64",1006,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);YI.addParameter("base64File","String",1,null,0);YI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const iG=Lg.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);iG.addParameter("html","String",1,null,0);iG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,
0);const jG=Lg.addMethod("InsertInlinePictureFromBase64",1009,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);jG.addParameter("base64EncodedImage","String",1,null,0);jG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ZI=Lg.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);ZI.addParameter("ooxml","String",1,null,0);ZI.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Xw=
Lg.addMethod("InsertParagraph",1007,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Xw.addParameter("paragraphText","String",1,null,0);Xw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const gC=Lg.addMethod("InsertTable",1018,"Microsoft.WordServices.Table",3,0,"InsertTable",0);gC.addParameter("rowCount","Int32",1,null,0);gC.addParameter("columnCount","Int32",1,null,0);gC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);gC.addParameter("values",
"String[][]",1,null,0);const lL=Lg.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);lL.addParameter("text","String",1,null,0);lL.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Xk=Lg.addMethod("Search",1015,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Xk.addParameter("searchText","String",1,null,0);Xk.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Lg.addMethod("Select",1012,"Void",0,1,"Select",
0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const hC=Lg.addMethod("Split",1017,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);hC.addParameter("delimiters","String[]",1,null,0);hC.addParameter("multiParagraphs","Boolean",1,null,0);hC.addParameter("trimDelimiters","Boolean",1,null,0);hC.addParameter("trimSpacing","Boolean",1,null,0);Lg.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Lg.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);
const yA=Lg.addMethod("_Search2",1020,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);yA.addParameter("searchText","String",1,null,0);yA.addParameter("searchFlags","Int32",1,null,0);Lg.addMethod("GetReviewedText",1022,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const au=d.addType("Microsoft.WordServices.ContentControlCollection","{a6a87ba8-6037-4625-ba4b-ece14e708219}","",3,0);au.addProperty("_ReferenceId",
2,"String",1,!0,null,0);au.addMethod("GetByChangeTrackingStates",1010,"Microsoft.WordServices.ContentControlCollection",3,1,"ByChangeTrackingStates",0).addParameter("types","Microsoft.WordServices.ChangeTrackingState[]",1,null,0);au.addMethod("GetById",1002,"Microsoft.WordServices.ContentControl",3,1,"ById",0).addParameter("id","Int32",1,null,0);au.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.ContentControl",3,1,"ByIdOrNullObject",0).addParameter("id","Int32",1,null,0);au.addMethod("GetByTag",
1004,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTag",0).addParameter("tag","String",1,null,0);au.addMethod("GetByTitle",1003,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTitle",0).addParameter("title","String",1,null,0);au.addMethod("GetByTypes",1006,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTypes",0).addParameter("types","Microsoft.WordServices.ContentControlType[]",1,null,0);au.addMethod("GetFirst",1007,"Microsoft.WordServices.ContentControl",3,1,"First",
0);au.addMethod("GetFirstOrNullObject",1009,"Microsoft.WordServices.ContentControl",3,1,"FirstOrNullObject",0);au.addIndexerMethod(1,"Microsoft.WordServices.ContentControl",3,0).addParameter("index","Object",1,null,0);au.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);au.addMethod("_OnAccess",1005,"Void",0,1,"_OnAccess",0);au.setCollectionInfo("Microsoft.WordServices.ContentControl",!0);d.addType("Microsoft.WordServices.ContentControlOptions","{dc3307d1-f680-40be-94b4-c50e53399d0e}",
"{81d9e31a-cd15-43a2-8ee0-614fb6e37a0a}",2,0).addProperty("types",1,"Microsoft.WordServices.ContentControlType[]",1,!1,null,0);d.addType("Microsoft.WordServices.CheckboxContentControl","{70b1363a-da4f-4cf0-a688-cafd68052109}","",3,0).addProperty("IsChecked",1,"Boolean",1,!1,null,0);const es=d.addType("Microsoft.WordServices.Comment","{9446f5cf-2bce-46d3-ae41-2a70c1398270}","",3,0);es.addProperty("AuthorEmail",1,"String",1,!0,null,0);es.addProperty("AuthorName",2,"String",1,!0,null,0);es.addProperty("Content",
3,"String",1,!1,null,0);es.addProperty("CreationDate",4,"DateTime",1,!1,null,0);es.addProperty("Id",5,"String",1,!0,null,0);es.addProperty("_ReferenceId",6,"String",1,!0,null,0);es.addProperty("Replies",7,"Microsoft.WordServices.CommentReplyCollection",3,!0,null,0);es.addProperty("Resolved",8,"Boolean",1,!1,null,0);es.addProperty("ContentRange",9,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);es.addMethod("GetRange",1001,"Microsoft.WordServices.Range",3,0,"GetRange",0);es.addMethod("Reply",
1002,"Microsoft.WordServices.CommentReply",3,0,"Reply",0).addParameter("replyText","String",1,null,0);es.addMethod("Delete",1003,"Void",0,0,"Delete",0);es.addMethod("_KeepReference",1005,"Void",0,1,"_KeepReference",0);es.addMethod("_OnAccess",1004,"Void",0,1,"_OnAccess",0);const tw=d.addType("Microsoft.WordServices.CommentContentRange","{fc4ae520-29e9-45ee-82ae-c0b29f2feefc}","",3,0);tw.addProperty("_ReferenceId",1,"String",1,!0,null,0);tw.addProperty("Text",2,"String",1,!0,null,0);tw.addProperty("IsEmpty",
3,"Boolean",1,!0,null,0);tw.addProperty("Hyperlink",4,"String",1,!1,null,0);tw.addProperty("Bold",5,"Boolean",1,!1,null,0);tw.addProperty("Italic",6,"Boolean",1,!1,null,0);tw.addProperty("StrikeThrough",7,"Boolean",1,!1,null,0);tw.addProperty("Underline",8,"Microsoft.WordServices.UnderlineType",1,!1,null,0);tw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);tw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const mL=tw.addMethod("InsertText",1003,"Microsoft.WordServices.CommentContentRange",
3,0,"InsertText",0);mL.addParameter("text","String",1,null,0);mL.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const rr=d.addType("Microsoft.WordServices.CommentCollection","{f1054c20-9d4b-4c62-9c80-e0e57ac4df64}","",3,0);rr.addProperty("_ReferenceId",2,"String",1,!0,null,0);rr.addMethod("GetFirst",1003,"Microsoft.WordServices.Comment",3,1,"First",0);rr.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Comment",3,1,"FirstOrNullObject",0);rr.addIndexerMethod(1,
"Microsoft.WordServices.Comment",3,0).addParameter("index","object",1,null,0);rr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);rr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);rr.setCollectionInfo("Microsoft.WordServices.Comment",!0);const qr=d.addType("Microsoft.WordServices.CommentReply","{cd697f4e-f862-b2b3-bfa1-5a5a2231b3d4}","",3,0);qr.addProperty("AuthorEmail",1,"String",1,!0,null,0);qr.addProperty("AuthorName",2,"String",1,!0,null,0);qr.addProperty("Content",3,"String",
1,!1,null,0);qr.addProperty("CreationDate",4,"DateTime",1,!1,null,0);qr.addProperty("ParentComment",7,"Microsoft.WordServices.Comment",3,!0,null,0);qr.addProperty("Id",5,"String",1,!0,null,0);qr.addProperty("_ReferenceId",6,"String",1,!0,null,0);qr.addProperty("ContentRange",8,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);qr.addMethod("Delete",1002,"Void",0,0,"Delete",0);qr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);qr.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",
0);const uw=d.addType("Microsoft.WordServices.CommentReplyCollection","{bfce5553-cb82-aa57-dec3-0c164055f29e}","",3,0);uw.addProperty("_ReferenceId",2,"String",1,!0,null,0);uw.addMethod("GetFirst",1003,"Microsoft.WordServices.CommentReply",3,1,"First",0);uw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.CommentReply",3,1,"FirstOrNullObject",0);uw.addIndexerMethod(1,"Microsoft.WordServices.CommentReply",3,0).addParameter("index","object",1,null,0);uw.addMethod("_KeepReference",1001,
"Void",0,1,"_KeepReference",0);uw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);uw.setCollectionInfo("Microsoft.WordServices.CommentReply",!0);const nz=d.addType("Microsoft.WordServices.CustomProperty","{5edbd9c9-449f-440c-bfae-d59d2db340bb}","",3,0);nz.addProperty("Key",2,"String",1,!0,null,0);nz.addProperty("Type",4,"Microsoft.WordServices.DocumentPropertyType",1,!0,null,0);nz.addProperty("Value",3,"Object",1,!1,null,0);nz.addProperty("_Id",5,"String",1,!0,null,0);nz.addProperty("_ReferenceId",
1,"String",1,!0,null,0);nz.addMethod("Delete",1003,"Void",0,0,"Delete",0);nz.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);nz.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Zx=d.addType("Microsoft.WordServices.CustomPropertyCollection","{85869847-ef5b-4377-9a0b-0eb6da2059e5}","",3,0);Zx.addProperty("_ReferenceId",2,"String",1,!0,null,0);const kG=Zx.addMethod("Add",1003,"Microsoft.WordServices.CustomProperty",3,0,"Add",0);kG.addParameter("key","String",1,null,0);kG.addParameter("value",
"Object",1,null,0);Zx.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);Zx.addMethod("GetCount",1004,"Int32",1,1,"Count",0);Zx.addIndexerMethod(1,"Microsoft.WordServices.CustomProperty",3,0).addParameter("key","String",1,null,0);Zx.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomProperty",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);Zx.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Zx.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Zx.setCollectionInfo("Microsoft.WordServices.CustomProperty",
!0);const bu=d.addType("Microsoft.WordServices.CustomXmlPart","{e0f5b881-5a49-403f-adc1-627b9479ad11}","",3,0);bu.addProperty("Id",2,"String",1,!0,null,0);bu.addProperty("NamespaceUri",3,"String",1,!0,null,0);bu.addProperty("_ReferenceId",1,"String",1,!0,null,0);bu.addMethod("Delete",1003,"Void",0,0,"Delete",0);const nL=bu.addMethod("DeleteAttribute",1012,"Void",0,0,"DeleteAttribute",0);nL.addParameter("xpath","String",1,null,0);nL.addParameter("namespaceMappings","Object",1,null,0);nL.addParameter("name",
"String",1,null,0);const oL=bu.addMethod("DeleteElement",1009,"Void",0,0,"DeleteElement",0);oL.addParameter("xpath","String",1,null,0);oL.addParameter("namespaceMappings","Object",1,null,0);bu.addMethod("GetXml",1004,"String",1,1,"Xml",0);const lG=bu.addMethod("InsertAttribute",1010,"Void",0,0,"InsertAttribute",0);lG.addParameter("xpath","String",1,null,0);lG.addParameter("namespaceMappings","Object",1,null,0);lG.addParameter("name","String",1,null,0);lG.addParameter("value","String",1,null,0);const mG=
bu.addMethod("InsertElement",1007,"Void",0,0,"InsertElement",0);mG.addParameter("xpath","String",1,null,0);mG.addParameter("xml","String",1,null,0);mG.addParameter("namespaceMappings","Object",1,null,0);mG.addParameter("index","Int32?",1,null,0);const nG=bu.addMethod("Query",1006,"String[]",1,0,"Query",0);nG.addParameter("xpath","String",1,null,0);nG.addParameter("namespaceMappings","Object",1,null,0);bu.addMethod("SetXml",1005,"Void",0,0,"SetXml",0).addParameter("xml","String",1,null,0);const iC=
bu.addMethod("UpdateAttribute",1011,"Void",0,0,"UpdateAttribute",0);iC.addParameter("xpath","String",1,null,0);iC.addParameter("namespaceMappings","Object",1,null,0);iC.addParameter("name","String",1,null,0);iC.addParameter("value","String",1,null,0);const hp=bu.addMethod("UpdateElement",1008,"Void",0,0,"UpdateElement",0);hp.addParameter("xpath","String",1,null,0);hp.addParameter("xml","String",1,null,0);hp.addParameter("namespaceMappings","Object",1,null,0);bu.addMethod("_KeepReference",1002,"Void",
0,1,"_KeepReference",0);bu.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Fv=d.addType("Microsoft.WordServices.CustomXmlPartCollection","{cf95a7e8-7b45-4a7a-9de5-db47e5f9b66b}","",3,0);Fv.addProperty("_ReferenceId",1,"String",1,!0,null,0);Fv.addMethod("Add",1004,"Microsoft.WordServices.CustomXmlPart",3,0,"Add",0).addParameter("xml","String",1,null,0);Fv.addMethod("GetByNamespace",1005,"Microsoft.WordServices.CustomXmlPartScopedCollection",3,1,"ByNamespace",0).addParameter("namespaceUri",
"String",1,null,0);Fv.addMethod("GetCount",1003,"Int32",1,1,"Count",0);Fv.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);Fv.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);Fv.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Fv.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Fv.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const sr=d.addType("Microsoft.WordServices.CustomXmlPartScopedCollection",
"{9fc07322-b3a6-407b-827e-c40e6e188f68}","",3,0);sr.addProperty("_ReferenceId",1,"String",1,!0,null,0);sr.addMethod("GetCount",1003,"Int32",1,1,"Count",0);sr.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);sr.addMethod("GetItemOrNullObject",1004,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);sr.addMethod("GetOnlyItem",1005,"Microsoft.WordServices.CustomXmlPart",3,1,"OnlyItem",0);sr.addMethod("GetOnlyItemOrNullObject",
1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0);sr.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);sr.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);sr.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const sm=d.addType("Microsoft.WordServices.Document","{1fd33ae5-86f2-4770-95f1-8bba5b1dce15}","",3,0);sm.addProperty("AllowCloseOnUntitled",9,"Boolean",1,!1,null,0);sm.addProperty("ChangeTrackingMode",10,"Microsoft.WordServices.ChangeTrackingMode",1,!1,null,0);
sm.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);sm.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);sm.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",3,!0,null,0);sm.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",3,!0,null,0);sm.addProperty("Saved",1,"Boolean",1,!0,null,0);sm.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);sm.addProperty("Settings",
7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);sm.addProperty("_ReferenceId",5,"String",1,!0,null,0);const $I=sm.addMethod("AddStyle",1028,"Microsoft.WordServices.Style",Ok.ClassObject,0,"AddStyle",0);$I.addParameter("name","String",1,null,0);$I.addParameter("type","Microsoft.WordServices.StyleType",1,null,0);sm.addMethod("DeleteBookmark",1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);sm.addMethod("GetAnnotationById",1031,ha,3,0,"AnnotationById",0).addParameter("id",
"String",1,null,0);sm.addMethod("GetAnnotationsByType",1020,B,3,1,"AnnotationsByType",0).addParameter("annotationType","String",1,null,0);sm.addMethod("GetBookmarkRange",1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);sm.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);sm.addMethod("GetContentControls",1026,"Microsoft.WordServices.ContentControlCollection",
3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);sm.addMethod("GetEndnoteBody",1025,"Microsoft.WordServices.Body",3,1,"EndnoteBody",0);sm.addMethod("GetFootnoteBody",1024,"Microsoft.WordServices.Body",3,1,"FootnoteBody",0);sm.addMethod("GetMetadata",1013,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);sm.addMethod("GetNeighborhoodTextAroundSelection",1017,"String",1,1,"NeighborhoodTextAroundSelection",
4).addParameter("maxLength","Int32?",1,null,0);sm.addMethod("GetSelection",1006,"Microsoft.WordServices.Range",3,1,"Selection",0);sm.addMethod("GetStyles",1029,"Microsoft.WordServices.StyleCollection",Ok.ClassObject,1,"GetStyles",0);sm.addMethod("ImportStylesFromJson",1032,"String[]",1,0,"ImportStylesFromJson",0).addParameter("stylesJson","String",1,null,0);sm.addMethod("LaunchTapPane",1016,"Void",0,1,"LaunchTapPane",4).addParameter("documentUrl","String",1,null,0);const Jr=sm.addMethod("Save",1005,
"Void",0,0,"Save",0);Jr.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",1,null,0);Jr.addParameter("fileName","String",1,null,0);sm.addMethod("Close",1027,"Void",0,0,"Close",0).addParameter("closeBehavior","Microsoft.WordServices.CloseBehavior",1,null,0);const zA=sm.addMethod("Search",1022,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);zA.addParameter("searchText","String",1,null,0);zA.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);const pL=
sm.addMethod("SetMetadata",1014,"Void",0,0,"SetMetadata",0);pL.addParameter("propertyGUID","String",1,null,0);pL.addParameter("propertyValue","Object",1,null,0);const gt=sm.addMethod("SetMetadataOnTile",1015,"Void",0,0,"SetMetadataOnTile",0);gt.addParameter("tileID","String",1,null,0);gt.addParameter("propertyGUID","String",1,null,0);gt.addParameter("propertyValue","Object",1,null,0);sm.addMethod("SetNavigationPaneVisibility",1021,"Void",0,0,"SetNavigationPaneVisibility",4).addParameter("visible",
"Boolean",1,null,0);sm.addMethod("_GetObjectByReferenceId",1001,"Object",1,1,"_GetObjectByReferenceId",0).addParameter("referenceId","String",1,null,0);sm.addMethod("_GetObjectTypeNameByReferenceId",1002,"String",1,1,"_GetObjectTypeNameByReferenceId",0).addParameter("referenceId","String",1,null,0);sm.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);sm.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const lM=sm.addMethod("_RegisterEvent",1018,"Void",0,1,"_RegisterEvent",0);lM.addParameter("referenceId",
"String",1,null,0);lM.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);sm.addMethod("_RemoveAllReferences",1004,"Void",0,1,"_RemoveAllReferences",0);sm.addMethod("_RemoveReference",1003,"Void",0,1,"_RemoveReference",0).addParameter("referenceId","String",1,null,0);const im=sm.addMethod("_Search2",1023,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);im.addParameter("searchText","String",1,null,0);im.addParameter("searchFlags","Int32",1,null,0);const vw=sm.addMethod("_UnregisterEvent",
1019,"Void",0,1,"_UnregisterEvent",0);vw.addParameter("referenceId","String",1,null,0);vw.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);const Al=sm.addMethod("InsertFileFromBase64",1030,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);Al.addParameter("base64File","String",1,null,0);Al.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Al.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",
0);sm.addMethod("GetParagraphByUniqueLocalId",1033,"Microsoft.WordServices.Paragraph",3,1,"ParagraphById",0).addParameter("id","String",1,null,0);const Wq=d.addType("Microsoft.WordServices.DocumentCreated","{1a6e7a8e-fa7a-4f86-b7d0-b50a3c10f515}","",3,0);Wq.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);Wq.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Wq.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",
3,!0,null,0);Wq.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",3,!0,null,0);Wq.addProperty("Saved",1,"Boolean",1,!0,null,0);Wq.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);Wq.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);Wq.addProperty("_ReferenceId",5,"String",1,!0,null,0);Wq.addMethod("DeleteBookmark",1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);Wq.addMethod("GetBookmarkRange",
1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);Wq.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);Wq.addMethod("GetContentControls",1013,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);const aJ=Wq.addMethod("InsertFileFromBase64",
1014,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);aJ.addParameter("base64File","String",1,null,0);aJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);aJ.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",0);Wq.addMethod("Open",1009,"Void",0,1,"Open",0);const AA=Wq.addMethod("Save",1005,"Void",0,0,"Save",0);AA.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",
1,null,0);AA.addParameter("fileName","String",1,null,0);Wq.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);Wq.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const fs=d.addType("Microsoft.WordServices.DocumentProperties","{642e1471-0cac-4dd2-bc76-1d1d0a3e130f}","",3,0);fs.addProperty("ApplicationName",11,"String",1,!0,null,0);fs.addProperty("Author",5,"String",1,!1,null,0);fs.addProperty("Category",20,"String",1,!1,null,0);fs.addProperty("Comments",7,"String",1,!1,null,0);fs.addProperty("Company",
23,"String",1,!1,null,0);fs.addProperty("CreationDate",13,"DateTime",1,!0,null,0);fs.addProperty("CustomProperties",2,"Microsoft.WordServices.CustomPropertyCollection",3,!0,null,0);fs.addProperty("Format",21,"String",1,!1,null,0);fs.addProperty("Keywords",6,"String",1,!1,null,0);fs.addProperty("LastAuthor",9,"String",1,!0,null,0);fs.addProperty("LastPrintDate",12,"DateTime?",1,!0,null,0);fs.addProperty("LastSaveTime",14,"DateTime?",1,!0,null,0);fs.addProperty("Manager",22,"String",1,!1,null,0);fs.addProperty("RevisionNumber",
10,"String",1,!0,null,0);fs.addProperty("Security",19,"Int32?",1,!0,null,0);fs.addProperty("Subject",4,"String",1,!1,null,0);fs.addProperty("Template",8,"String",1,!0,null,0);fs.addProperty("Title",3,"String",1,!1,null,0);fs.addProperty("_ReferenceId",1,"String",1,!0,null,0);fs.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);fs.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const zq=d.addType("Microsoft.WordServices.Field","{5109ffb2-cad2-4420-8f1d-edf33916127a}","",3,0);zq.addProperty("_Id",
1,"Int32",1,!0,null,0);zq.addProperty("_ReferenceId",2,"String",1,!0,null,0);zq.addProperty("Code",3,"String",1,!0,null,0);zq.addProperty("Result",4,"Microsoft.WordServices.Range",3,!0,null,0);zq.addProperty("ParentBody",5,"Microsoft.WordServices.Body",3,!0,null,0);zq.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);zq.addProperty("ParentContentControlOrNullObject",7,"Microsoft.WordServices.ContentControl",3,!0,null,0);zq.addProperty("ParentTable",8,"Microsoft.WordServices.Table",
3,!0,null,0);zq.addProperty("ParentTableOrNullObject",9,"Microsoft.WordServices.Table",3,!0,null,0);zq.addProperty("ParentTableCell",10,"Microsoft.WordServices.TableCell",3,!0,null,0);zq.addProperty("ParentTableCellOrNullObject",11,"Microsoft.WordServices.TableCell",3,!0,null,0);zq.addProperty("Data",16,"String",1,!1,null,0);zq.addProperty("Kind",13,"Microsoft.WordServices.FieldKind",1,!0,null,0);zq.addProperty("Locked",15,"Boolean",1,!1,null,0);zq.addProperty("ShowCodes",14,"Boolean",1,!1,null,0);
zq.addProperty("Type",12,"Microsoft.WordServices.FieldType",1,!0,null,0);zq.addMethod("GetNextOrNullObject",1005,"Microsoft.WordServices.Field",3,1,"NextOrNullObject",0);zq.addMethod("GetNext",1004,"Microsoft.WordServices.Field",3,1,"Next",0);zq.addMethod("Delete",1003,"Void",0,0,"Delete",0);zq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);zq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);zq.addMethod("Select",1007,"Void",Ok.None,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",
1,null,0);zq.addMethod("UpdateResult",1006,"Void",Ok.None,0,"UpdateResult",0);const oz=d.addType("Microsoft.WordServices.FieldCollection","{1eb67e75-ccdb-483a-afb0-03a447729113}","",3,0);oz.addProperty("_ReferenceId",2,"String",1,!0,null,0);oz.addMethod("GetFirst",1003,"Microsoft.WordServices.Field",3,1,"First",0);oz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Field",3,1,"FirstOrNullObject",0);oz.addIndexerMethod(1,"Microsoft.WordServices.Field",3,0).addParameter("index","Object",
1,null,0);oz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);oz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);oz.addMethod("getByTypes",1005,"Microsoft.WordServices.FieldCollection",Ok.ClassObject,1,"getByTypes",0).addParameter("types","Microsoft.WordServices.FieldType[]",1,null,0);oz.setCollectionInfo("Microsoft.WordServices.Field",!0);const Gu=d.addType("Microsoft.WordServices.Font","{896a961f-e647-4b59-82da-5f1143b5afc1}","",3,0);Gu.addProperty("Bold",4,"Boolean?",1,!1,null,
0);Gu.addProperty("Color",6,"String",1,!1,null,0);Gu.addProperty("DoubleStrikeThrough",11,"Boolean?",1,!1,null,0);Gu.addProperty("HighlightColor",12,"String",1,!1,null,0);Gu.addProperty("Italic",5,"Boolean?",1,!1,null,0);Gu.addProperty("Name",2,"String",1,!1,null,0);Gu.addProperty("Size",3,"Single?",1,!1,null,0);Gu.addProperty("StrikeThrough",10,"Boolean?",1,!1,null,0);Gu.addProperty("Subscript",8,"Boolean?",1,!1,null,0);Gu.addProperty("Superscript",9,"Boolean?",1,!1,null,0);Gu.addProperty("Underline",
7,"Microsoft.WordServices.UnderlineType",1,!1,null,0);Gu.addProperty("_ReferenceId",1,"String",1,!0,null,0);Gu.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Gu.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const zo=d.addType("Microsoft.WordServices.InlinePicture","{ef524552-be9e-413b-8030-e5eb3db24f19}","",3,0);zo.addProperty("AltTextDescription",3,"String",1,!1,null,0);zo.addProperty("AltTextTitle",4,"String",1,!1,null,0);zo.addProperty("Height",5,"Single",1,!1,null,0);zo.addProperty("Hyperlink",
6,"String",1,!1,null,0);zo.addProperty("ImageFormat",11,"Microsoft.WordServices.ImageFormat",1,!0,null,0);zo.addProperty("LockAspectRatio",7,"Boolean",1,!1,null,0);zo.addProperty("Paragraph",10,"Microsoft.WordServices.Paragraph",3,!0,null,0);zo.addProperty("ParentContentControl",9,"Microsoft.WordServices.ContentControl",3,!0,null,0);zo.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);zo.addProperty("ParentTable",14,"Microsoft.WordServices.Table",
3,!0,null,0);zo.addProperty("ParentTableCell",13,"Microsoft.WordServices.TableCell",3,!0,null,0);zo.addProperty("ParentTableCellOrNullObject",16,"Microsoft.WordServices.TableCell",3,!0,null,0);zo.addProperty("ParentTableOrNullObject",17,"Microsoft.WordServices.Table",3,!0,null,0);zo.addProperty("Width",8,"Single",1,!1,null,0);zo.addProperty("_Id",1,"Int32",1,!0,null,0);zo.addProperty("_ReferenceId",2,"String",1,!0,null,0);zo.addMethod("Delete",1012,"Void",0,0,"Delete",0);zo.addMethod("GetBase64ImageSrc",
1003,"String",1,1,"Base64ImageSrc",0);zo.addMethod("GetNext",1015,"Microsoft.WordServices.InlinePicture",3,1,"Next",0);zo.addMethod("GetNextOrNullObject",1016,"Microsoft.WordServices.InlinePicture",3,1,"NextOrNullObject",0);zo.addMethod("GetRange",1014,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const mM=zo.addMethod("InsertBreak",1006,"Void",0,0,"InsertBreak",0);mM.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);mM.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);zo.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const Yw=zo.addMethod("InsertFileFromBase64",1011,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);Yw.addParameter("base64File","String",1,null,0);Yw.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const QL=zo.addMethod("InsertHtml",1008,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);QL.addParameter("html","String",1,null,0);QL.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const RL=zo.addMethod("InsertInlinePictureFromBase64",1005,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);RL.addParameter("base64EncodedImage","String",1,null,0);RL.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const BJ=zo.addMethod("InsertOoxml",1009,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);BJ.addParameter("ooxml","String",1,null,0);BJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const CJ=zo.addMethod("InsertParagraph",1010,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);CJ.addParameter("paragraphText","String",1,null,0);CJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const xC=zo.addMethod("InsertText",1007,"Microsoft.WordServices.Range",3,0,"InsertText",0);xC.addParameter("text","String",1,null,0);
xC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);zo.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);zo.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);zo.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const yz=d.addType("Microsoft.WordServices.InlinePictureCollection","{ea74232b-e74b-4a8b-9d30-04d181c29cfa}","",3,0);yz.addProperty("_ReferenceId",2,"String",1,!0,null,
0);yz.addMethod("GetFirst",1003,"Microsoft.WordServices.InlinePicture",3,1,"First",0);yz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.InlinePicture",3,1,"FirstOrNullObject",0);yz.addIndexerMethod(1,"Microsoft.WordServices.InlinePicture",3,0).addParameter("index","Object",1,null,0);yz.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);yz.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);yz.setCollectionInfo("Microsoft.WordServices.InlinePicture",!0);const ks=d.addType("Microsoft.WordServices.List",
"{92cb59a8-b889-4985-840c-42b2f740ef33}","",3,0);ks.addProperty("Id",1,"Int32",1,!0,null,0);ks.addProperty("LevelExistences",5,"Boolean[]",1,!0,null,0);ks.addProperty("LevelTypes",4,"Microsoft.WordServices.ListLevelType[]",1,!0,null,0);ks.addProperty("Paragraphs",3,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);ks.addProperty("_ReferenceId",2,"String",1,!0,null,0);ks.addMethod("GetLevelFont",1010,"Microsoft.WordServices.Font",3,1,"LevelFont",0).addParameter("level","Int32",1,null,0);ks.addMethod("GetLevelParagraphs",
1004,"Microsoft.WordServices.ParagraphCollection",3,1,"LevelParagraphs",0).addParameter("level","Int32",1,null,0);ks.addMethod("GetLevelPicture",1009,"String",1,1,"LevelPicture",0).addParameter("level","Int32",1,null,0);ks.addMethod("GetLevelString",1007,"String",1,1,"LevelString",0).addParameter("level","Int32",1,null,0);const DJ=ks.addMethod("InsertParagraph",1003,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);DJ.addParameter("paragraphText","String",1,null,0);DJ.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const aE=ks.addMethod("ResetLevelFont",1011,"Void",0,0,"ResetLevelFont",0);aE.addParameter("level","Int32",1,null,0);aE.addParameter("resetFontName","Boolean",1,null,0);const qL=ks.addMethod("SetLevelAlignment",1012,"Void",0,0,"SetLevelAlignment",0);qL.addParameter("level","Int32",1,null,0);qL.addParameter("alignment","Microsoft.WordServices.Alignment",1,null,0);const Gv=ks.addMethod("SetLevelBullet",1005,"Void",0,0,"SetLevelBullet",0);Gv.addParameter("level",
"Int32",1,null,0);Gv.addParameter("listBullet","Microsoft.WordServices.ListBullet",1,null,0);Gv.addParameter("charCode","Int32",1,null,0);Gv.addParameter("fontName","String",1,null,0);const cu=ks.addMethod("SetLevelIndents",1013,"Void",0,0,"SetLevelIndents",0);cu.addParameter("level","Int32",1,null,0);cu.addParameter("textIndent","Single",1,null,0);cu.addParameter("bulletNumberPictureIndent","Single",1,null,0);const yC=ks.addMethod("SetLevelNumbering",1006,"Void",0,0,"SetLevelNumbering",0);yC.addParameter("level",
"Int32",1,null,0);yC.addParameter("listNumbering","Microsoft.WordServices.ListNumbering",1,null,0);yC.addParameter("formatString","Object[]",1,null,0);const $x=ks.addMethod("SetLevelPicture",1008,"Void",0,0,"SetLevelPicture",0);$x.addParameter("level","Int32",1,null,0);$x.addParameter("base64EncodedImage","String",1,null,0);const DE=ks.addMethod("SetLevelStartingNumber",1014,"Void",0,0,"SetLevelStartingNumber",0);DE.addParameter("level","Int32",1,null,0);DE.addParameter("startingNumber","Int32",1,
null,0);ks.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);ks.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const Pv=d.addType("Microsoft.WordServices.ListCollection","{d36f169f-d0b0-44e9-a933-62c4dcb1964f}","",3,0);Pv.addProperty("_ReferenceId",2,"String",1,!0,null,0);Pv.addMethod("GetById",1002,"Microsoft.WordServices.List",3,1,"ById",0).addParameter("id","Int32",1,null,0);Pv.addMethod("GetByIdOrNullObject",1005,"Microsoft.WordServices.List",3,1,"ByIdOrNullObject",0).addParameter("id",
"Int32",1,null,0);Pv.addMethod("GetFirst",1004,"Microsoft.WordServices.List",3,1,"First",0);Pv.addMethod("GetFirstOrNullObject",1006,"Microsoft.WordServices.List",3,1,"FirstOrNullObject",0);Pv.addIndexerMethod(1,"Microsoft.WordServices.List",3,0).addParameter("index","Object",1,null,0);Pv.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Pv.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);Pv.setCollectionInfo("Microsoft.WordServices.List",!0);const bv=d.addType("Microsoft.WordServices.ListItem",
"{f32748c0-d8dd-44ae-a550-92ed26a085a8}","",3,0);bv.addProperty("Level",4,"Int32",1,!1,null,0);bv.addProperty("ListString",3,"String",1,!0,null,0);bv.addProperty("SiblingIndex",2,"Int32",1,!0,null,0);bv.addProperty("_ReferenceId",1,"String",1,!0,null,0);bv.addMethod("GetAncestor",1003,"Microsoft.WordServices.Paragraph",3,1,"Ancestor",0).addParameter("parentOnly","Boolean",1,null,0);bv.addMethod("GetAncestorOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"AncestorOrNullObject",0).addParameter("parentOnly",
"Boolean",1,null,0);bv.addMethod("GetDescendants",1004,"Microsoft.WordServices.ParagraphCollection",3,1,"Descendants",0).addParameter("directChildrenOnly","Boolean",1,null,0);bv.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);bv.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const gs=d.addType("Microsoft.WordServices.ListLevel","{533c4bba-63a4-4254-b249-2a6cf843330f}","",3,0);gs.addProperty("Alignment",3,"Microsoft.WordServices.Alignment",1,!1,null,0);gs.addProperty("Font",4,
"Microsoft.WordServices.Font",Ok.ClassObject,!0,null,0);gs.addProperty("LinkedStyle",5,"String",1,!1,null,0);gs.addProperty("NumberFormat",6,"String",1,!1,null,0);gs.addProperty("NumberPosition",7,"Single",1,!1,null,0);gs.addProperty("NumberStyle",8,"Microsoft.WordServices.ListBuiltInNumberStyle",1,!1,null,0);gs.addProperty("ResetOnHigher",9,"Int32",1,!1,null,0);gs.addProperty("StartAt",10,"Int32",1,!1,null,0);gs.addProperty("TabPosition",11,"Single",1,!1,null,0);gs.addProperty("TextPosition",12,
"Single",1,!1,null,0);gs.addProperty("TrailingCharacter",13,"Microsoft.WordServices.TrailingCharacter",1,!1,null,0);gs.addProperty("_Id",1,"Int32",1,!0,null,0);gs.addProperty("_ReferenceId",2,"String",1,!0,null,0);gs.addMethod("_KeepReference",1002,"Void",Ok.None,1,"_KeepReference",0);gs.addMethod("_OnAccess",1001,"Void",Ok.None,1,"_OnAccess",0);const hx=d.addType("Microsoft.WordServices.ListLevelCollection","{0bb00b5d-0a29-41f6-a0d8-f74c3a153600}","",3,0);hx.addProperty("_ReferenceId",2,"String",
1,!0,null,0);hx.addMethod("GetFirst",1003,"Microsoft.WordServices.ListLevel",Ok.ClassObject,1,"First",0);hx.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.ListLevel",Ok.ClassObject,1,"FirstOrNullObject",0);hx.addIndexerMethod(1,"Microsoft.WordServices.ListLevel",Ok.ClassObject,0).addParameter("index","Object",1,null,0);hx.addMethod("_KeepReference",1001,"Void",Ok.None,1,"_KeepReference",0);hx.addMethod("_OnAccess",1002,"Void",Ok.None,1,"_OnAccess",0);hx.setCollectionInfo("Microsoft.WordServices.ListLevel",
!0);const zz=d.addType("Microsoft.WordServices.ListTemplate","{6f2e0a54-8e99-420c-9716-81cae154ac0e}","",3,0);zz.addProperty("ListLevels",2,"Microsoft.WordServices.ListLevelCollection",Ok.ClassObject,!0,null,0);zz.addProperty("OutlineNumbered",3,"Boolean",1,!1,null,0);zz.addProperty("_ReferenceId",1,"String",1,!0,null,0);zz.addMethod("_KeepReference",1002,"Void",Ok.None,1,"_KeepReference",0);zz.addMethod("_OnAccess",1001,"Void",Ok.None,1,"_OnAccess",0);const Qv=d.addType("Microsoft.WordServices.NoteItem",
"{4869fd78-c024-4e18-9405-ffa60e9bfd51}","",3,0);Qv.addProperty("Body",4,"Microsoft.WordServices.Body",3,!0,null,0);Qv.addProperty("Reference",5,"Microsoft.WordServices.Range",3,!0,null,0);Qv.addProperty("Type",3,"Microsoft.WordServices.NoteItemType",1,!0,null,0);Qv.addProperty("_Id",1,"String",1,!0,null,0);Qv.addProperty("_ReferenceId",2,"String",1,!0,null,0);Qv.addMethod("Delete",1003,"Void",0,0,"Delete",0);Qv.addMethod("GetNext",1004,"Microsoft.WordServices.NoteItem",3,1,"Next",0);Qv.addMethod("GetNextOrNullObject",
1005,"Microsoft.WordServices.NoteItem",3,1,"NextOrNullObject",0);Qv.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Qv.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Hv=d.addType("Microsoft.WordServices.NoteItemCollection","{38a0db4c-d855-40aa-879e-2251a0f17b11}","",3,0);Hv.addProperty("_ReferenceId",2,"String",1,!0,null,0);Hv.addMethod("GetFirst",1003,"Microsoft.WordServices.NoteItem",3,1,"First",0);Hv.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.NoteItem",
3,1,"FirstOrNullObject",0);Hv.addIndexerMethod(1,"Microsoft.WordServices.NoteItem",3,0).addParameter("index","Object",1,null,0);Hv.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Hv.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Hv.setCollectionInfo("Microsoft.WordServices.NoteItem",!0);const Pi=d.addType("Microsoft.WordServices.Paragraph","{d0c9772c-becf-4961-a582-8024ebdc614c}","",3,0);Pi.addProperty("Alignment",7,"Microsoft.WordServices.Alignment",1,!1,null,0);Pi.addProperty("ContentControls",
5,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Pi.addProperty("Endnotes",36,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Pi.addProperty("FirstLineIndent",8,"Single",1,!1,null,0);Pi.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Pi.addProperty("Footnotes",35,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Pi.addProperty("Fields",37,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Pi.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);Pi.addProperty("IsLastParagraph",28,"Boolean",1,!0,null,0);Pi.addProperty("IsListItem",19,"Boolean",1,!0,null,0);Pi.addProperty("LeftIndent",9,"Single",1,!1,null,0);Pi.addProperty("LineSpacing",11,"Single",1,!1,null,0);Pi.addProperty("LineUnitAfter",16,"Single",1,!1,null,0);Pi.addProperty("LineUnitBefore",15,"Single",1,!1,null,0);Pi.addProperty("List",24,"Microsoft.WordServices.List",3,!0,null,0);Pi.addProperty("ListItem",27,"Microsoft.WordServices.ListItem",3,!0,null,0);Pi.addProperty("ListItemOrNullObject",
34,"Microsoft.WordServices.ListItem",3,!0,null,0);Pi.addProperty("ListOrNullObject",33,"Microsoft.WordServices.List",3,!0,null,0);Pi.addProperty("OutlineLevel",12,"Int32",1,!1,null,0);Pi.addProperty("ParentBody",23,"Microsoft.WordServices.Body",3,!0,null,0);Pi.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Pi.addProperty("ParentContentControlOrNullObject",30,"Microsoft.WordServices.ContentControl",3,!0,null,0);Pi.addProperty("ParentTable",26,"Microsoft.WordServices.Table",
3,!0,null,0);Pi.addProperty("ParentTableCell",25,"Microsoft.WordServices.TableCell",3,!0,null,0);Pi.addProperty("ParentTableCellOrNullObject",31,"Microsoft.WordServices.TableCell",3,!0,null,0);Pi.addProperty("ParentTableOrNullObject",32,"Microsoft.WordServices.Table",3,!0,null,0);Pi.addProperty("RightIndent",10,"Single",1,!1,null,0);Pi.addProperty("SpaceAfter",14,"Single",1,!1,null,0);Pi.addProperty("SpaceBefore",13,"Single",1,!1,null,0);Pi.addProperty("Style",4,"String",1,!1,null,0);Pi.addProperty("StyleBuiltIn",
29,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Pi.addProperty("TableNestingLevel",22,"Int32",1,!0,null,0);Pi.addProperty("Text",18,"String",1,!0,null,0);Pi.addProperty("_Id",1,"Int32",1,!0,null,0);Pi.addProperty("_ReferenceId",2,"String",1,!0,null,0);Pi.addProperty("UniqueLocalId",38,"String",1,!0,null,0);const bJ=Pi.addMethod("AttachToList",1022,"Microsoft.WordServices.List",3,0,"AttachToList",0);bJ.addParameter("listId","Int32",1,null,0);bJ.addParameter("level","Int32",1,null,0);Pi.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Pi.addMethod("Delete",1012,"Void",0,0,"Delete",0);Pi.addMethod("DetachFromList",1023,"Void",0,0,"DetachFromList",0);Pi.addMethod("GetAnnotations",1036,Aa,3,1,"Annotations",0);Pi.addMethod("GetComments",1032,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Pi.addMethod("GetContentControls",1034,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",
0);Pi.addMethod("GetHtml",1014,"String",1,1,"Html",0);Pi.addMethod("GetMetadata",1028,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);Pi.addMethod("GetNext",1024,"Microsoft.WordServices.Paragraph",3,1,"Next",0);Pi.addMethod("GetNextOrNullObject",1026,"Microsoft.WordServices.Paragraph",3,1,"NextOrNullObject",0);Pi.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Pi.addMethod("GetPrevious",1025,"Microsoft.WordServices.Paragraph",3,1,"Previous",0);Pi.addMethod("GetPreviousOrNullObject",
1027,"Microsoft.WordServices.Paragraph",3,1,"PreviousOrNullObject",0);Pi.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);Pi.addMethod("GetReviewedText",1033,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const Jk=Pi.addMethod("GetSubrange",1030,"Microsoft.WordServices.Range",3,1,"Subrange",0);Jk.addParameter("start",
"Int32",1,null,0);Jk.addParameter("length","Int32",1,null,0);const EJ=Pi.addMethod("GetTextRanges",1020,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);EJ.addParameter("endingMarks","String[]",1,null,0);EJ.addParameter("trimSpacing","Boolean",1,null,0);Pi.addMethod("GetTrackedChanges",1035,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);Pi.addMethod("InsertAnnotations",1037,"String[]",1,0,"InsertAnnotations",0).addParameter("annotations","Microsoft.WordServices.AnnotationSet",
2,null,0);const bE=Pi.addMethod("InsertBreak",1010,"Void",0,0,"InsertBreak",0);bE.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);bE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Pi.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const EE=Pi.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",
3,0,"InsertFileFromBase64",0);EE.addParameter("base64File","String",1,null,0);EE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const cE=Pi.addMethod("InsertHtml",1006,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);cE.addParameter("html","String",1,null,0);cE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const FJ=Pi.addMethod("InsertInlinePictureFromBase64",1003,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",
0);FJ.addParameter("base64EncodedImage","String",1,null,0);FJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const rL=Pi.addMethod("InsertOoxml",1007,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);rL.addParameter("ooxml","String",1,null,0);rL.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const cJ=Pi.addMethod("InsertParagraph",1009,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);cJ.addParameter("paragraphText","String",
1,null,0);cJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ix=Pi.addMethod("InsertTable",1019,"Microsoft.WordServices.Table",3,0,"InsertTable",0);ix.addParameter("rowCount","Int32",1,null,0);ix.addParameter("columnCount","Int32",1,null,0);ix.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);ix.addParameter("values","String[][]",1,null,0);const jC=Pi.addMethod("InsertText",1005,"Microsoft.WordServices.Range",3,0,"InsertText",0);
jC.addParameter("text","String",1,null,0);jC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const oG=Pi.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);oG.addParameter("searchText","String",1,null,0);oG.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Pi.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const AC=Pi.addMethod("SetMetadata",
1029,"Void",0,0,"SetMetadata",0);AC.addParameter("propertyGUID","String",1,null,0);AC.addParameter("propertyValue","Object",1,null,0);const BA=Pi.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);BA.addParameter("delimiters","String[]",1,null,0);BA.addParameter("trimDelimiters","Boolean",1,null,0);BA.addParameter("trimSpacing","Boolean",1,null,0);Pi.addMethod("StartNewList",1021,"Microsoft.WordServices.List",3,0,"StartNewList",0);Pi.addMethod("_KeepReference",1002,"Void",
0,1,"_KeepReference",0);Pi.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const CA=Pi.addMethod("_Search2",1031,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);CA.addParameter("searchText","String",1,null,0);CA.addParameter("searchFlags","Int32",1,null,0);Pi.addMethod("GetText",1038,"String",1,1,"Text",0).addParameter("options","Microsoft.WordServices.GetTextOptions",2,null,0);const Iv=d.addType("Microsoft.WordServices.ParagraphCollection","{20a0d5b4-fb08-460c-96aa-6af4afe8f1ba}",
"",3,0);Iv.addProperty("_ReferenceId",2,"String",1,!0,null,0);Iv.addMethod("GetFirst",1003,"Microsoft.WordServices.Paragraph",3,1,"First",0);Iv.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"FirstOrNullObject",0);Iv.addMethod("GetLast",1004,"Microsoft.WordServices.Paragraph",3,1,"Last",0);Iv.addMethod("GetLastOrNullObject",1006,"Microsoft.WordServices.Paragraph",3,1,"LastOrNullObject",0);Iv.addMethod("GetById",1007,"Microsoft.WordServices.Paragraph",3,1,"ById",4).addParameter("id",
"String",1,null,0);Iv.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.Paragraph",3,1,"ByIdOrNullObject",4).addParameter("id","String",1,null,0);Iv.addIndexerMethod(1,"Microsoft.WordServices.Paragraph",3,0).addParameter("index","Object",1,null,0);Iv.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Iv.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Iv.setCollectionInfo("Microsoft.WordServices.Paragraph",!0);const Ds=d.addType("Microsoft.WordServices.ParagraphFormat",
"{83717b74-133d-406e-b769-670eb67c577c}","",3,0);Ds.addProperty("Alignment",2,"Microsoft.WordServices.Alignment",1,!1,null,0);Ds.addProperty("FirstLineIndent",3,"Single",1,!1,null,0);Ds.addProperty("KeepTogether",4,"Boolean",1,!1,null,0);Ds.addProperty("KeepWithNext",5,"Boolean",1,!1,null,0);Ds.addProperty("LeftIndent",6,"Single",1,!1,null,0);Ds.addProperty("LineSpacing",7,"Single",1,!1,null,0);Ds.addProperty("LineUnitAfter",8,"Single",1,!1,null,0);Ds.addProperty("LineUnitBefore",9,"Single",1,!1,
null,0);Ds.addProperty("MirrorIndents",10,"Boolean",1,!1,null,0);Ds.addProperty("OutlineLevel",11,"Microsoft.WordServices.OutlineLevel",1,!1,null,0);Ds.addProperty("RightIndent",12,"Single",1,!1,null,0);Ds.addProperty("SpaceAfter",13,"Single",1,!1,null,0);Ds.addProperty("SpaceBefore",14,"Single",1,!1,null,0);Ds.addProperty("WidowControl",15,"Boolean",1,!1,null,0);Ds.addProperty("_ReferenceId",1,"String",1,!0,null,0);Ds.addMethod("_KeepReference",1002,"Void",Ok.None,1,"_KeepReference",0);Ds.addMethod("_OnAccess",
1001,"Void",Ok.None,1,"_OnAccess",0);const Ij=d.addType("Microsoft.WordServices.Range","{4869fd78-c024-4e18-9405-ffa60e9bfd50}","",3,0);Ij.addProperty("ContentControls",6,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Ij.addProperty("Endnotes",22,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ij.addProperty("Fields",23,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ij.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Ij.addProperty("Footnotes",21,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Ij.addProperty("Hyperlink",11,"String",1,!1,null,0);Ij.addProperty("InlinePictures",8,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Ij.addProperty("IsEmpty",10,"Boolean",1,!0,null,0);Ij.addProperty("Lists",12,"Microsoft.WordServices.ListCollection",3,!0,null,0);Ij.addProperty("Paragraphs",5,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Ij.addProperty("ParentBody",16,"Microsoft.WordServices.Body",3,!0,null,0);Ij.addProperty("ParentContentControl",7,"Microsoft.WordServices.ContentControl",
3,!0,null,0);Ij.addProperty("ParentContentControlOrNullObject",18,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ij.addProperty("ParentTable",15,"Microsoft.WordServices.Table",3,!0,null,0);Ij.addProperty("ParentTableCell",14,"Microsoft.WordServices.TableCell",3,!0,null,0);Ij.addProperty("ParentTableCellOrNullObject",19,"Microsoft.WordServices.TableCell",3,!0,null,0);Ij.addProperty("ParentTableOrNullObject",20,"Microsoft.WordServices.Table",3,!0,null,0);Ij.addProperty("Style",4,"String",1,!1,
null,0);Ij.addProperty("StyleBuiltIn",17,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ij.addProperty("Tables",13,"Microsoft.WordServices.TableCollection",3,!0,null,0);Ij.addProperty("Text",9,"String",1,!0,null,0);Ij.addProperty("_Id",1,"Int32",1,!0,null,0);Ij.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ij.addMethod("GetReviewedText",1041,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);Ij.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Ij.addMethod("CompareLocationWith",1019,"Microsoft.WordServices.LocationRelation",1,1,"CompareLocationWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Ij.addMethod("Delete",1012,"Void",0,0,"Delete",0);Ij.addMethod("EndPreview",1035,"Void",0,1,"EndPreview",0);Ij.addMethod("ExpandTo",1020,"Microsoft.WordServices.Range",3,0,"ExpandTo",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Ij.addMethod("ExpandToOrNullObject",1028,"Microsoft.WordServices.Range",
3,0,"ExpandToOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);const ay=Ij.addMethod("GetBookmarks",1026,"String[]",1,1,"Bookmarks",0);ay.addParameter("includeHidden","Boolean",1,null,0);ay.addParameter("includeAdjacent","Boolean",1,null,0);Ij.addMethod("GetComments",1040,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Ij.addMethod("GetContentControls",1042,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options",
"Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Ij.addMethod("GetHtml",1014,"String",1,1,"Html",0);Ij.addMethod("GetHyperlinkRanges",1023,"Microsoft.WordServices.RangeCollection",3,1,"HyperlinkRanges",0);const dJ=Ij.addMethod("GetNextTextRange",1022,"Microsoft.WordServices.Range",3,1,"NextTextRange",0);dJ.addParameter("endingMarks","String[]",1,null,0);dJ.addParameter("trimSpacing","Boolean",1,null,0);const dE=Ij.addMethod("GetNextTextRangeOrNullObject",
1030,"Microsoft.WordServices.Range",3,1,"NextTextRangeOrNullObject",0);dE.addParameter("endingMarks","String[]",1,null,0);dE.addParameter("trimSpacing","Boolean",1,null,0);Ij.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Ij.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const Zw=Ij.addMethod("GetTextRanges",1025,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);Zw.addParameter("endingMarks",
"String[]",1,null,0);Zw.addParameter("trimSpacing","Boolean",1,null,0);Ij.addMethod("GetTrackedChanges",1044,"Microsoft.WordServices.TrackedChangeCollection",3,1,"TrackedChanges",0);Ij.addMethod("Highlight",1032,"Void",0,1,"Highlight",0).addParameter("color","String",1,null,0);Ij.addMethod("InsertBookmark",1027,"Void",0,0,"InsertBookmark",0).addParameter("name","String",1,null,0);const Lu=Ij.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);Lu.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);Lu.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ij.addMethod("InsertComment",1039,"Microsoft.WordServices.Comment",3,0,"InsertComment",0).addParameter("commentText","String",1,null,0);Ij.addMethod("InsertContentControl",1003,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);Ij.addMethod("InsertEndnote",1038,"Microsoft.WordServices.NoteItem",3,0,"InsertEndnote",
0).addParameter("insertText","String",1,null,0);const ww=Ij.addMethod("InsertField",1043,"Microsoft.WordServices.Field",Ok.ClassObject,0,"InsertField",0);ww.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);ww.addParameter("fieldType","Microsoft.WordServices.FieldType",1,null,0);ww.addParameter("text","String",1,null,0);ww.addParameter("removeFormatting","Boolean",1,null,0);const eE=Ij.addMethod("InsertFileFromBase64",1007,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",
0);eE.addParameter("base64File","String",1,null,0);eE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ij.addMethod("InsertFootnote",1037,"Microsoft.WordServices.NoteItem",3,0,"InsertFootnote",0).addParameter("insertText","String",1,null,0);const FE=Ij.addMethod("InsertHtml",1005,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);FE.addParameter("html","String",1,null,0);FE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const PG=Ij.addMethod("InsertInlinePictureFromBase64",
1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);PG.addParameter("base64EncodedImage","String",1,null,0);PG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const GJ=Ij.addMethod("InsertOoxml",1006,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);GJ.addParameter("ooxml","String",1,null,0);GJ.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const QG=Ij.addMethod("InsertParagraph",1008,"Microsoft.WordServices.Paragraph",
3,0,"InsertParagraph",0);QG.addParameter("paragraphText","String",1,null,0);QG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const zC=Ij.addMethod("InsertTable",1024,"Microsoft.WordServices.Table",3,0,"InsertTable",0);zC.addParameter("rowCount","Int32",1,null,0);zC.addParameter("columnCount","Int32",1,null,0);zC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);zC.addParameter("values","String[][]",1,null,0);const GE=Ij.addMethod("InsertTapObjectFromFileContent",
1031,"Microsoft.WordServices.Range",3,0,"InsertTapObjectFromFileContent",4);GE.addParameter("fileContent","String",1,null,0);GE.addParameter("objectType","Microsoft.WordServices.TapObjectType",1,null,0);GE.addParameter("contentFormat","Microsoft.WordServices.FileContentFormat",1,null,0);const kC=Ij.addMethod("InsertText",1004,"Microsoft.WordServices.Range",3,0,"InsertText",0);kC.addParameter("text","String",1,null,0);kC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,
0);Ij.addMethod("IntersectWith",1021,"Microsoft.WordServices.Range",3,0,"IntersectWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Ij.addMethod("IntersectWithOrNullObject",1029,"Microsoft.WordServices.Range",3,0,"IntersectWithOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Ij.addMethod("PreviewTextReplacement",1034,"Void",0,1,"PreviewTextReplacement",0).addParameter("replacement","String",1,null,0);Ij.addMethod("RemoveHighlight",1033,"Void",0,1,
"RemoveHighlight",0);const eJ=Ij.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);eJ.addParameter("searchText","String",1,null,0);eJ.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Ij.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const pG=Ij.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);pG.addParameter("delimiters","String[]",
1,null,0);pG.addParameter("multiParagraphs","Boolean",1,null,0);pG.addParameter("trimDelimiters","Boolean",1,null,0);pG.addParameter("trimSpacing","Boolean",1,null,0);Ij.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ij.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const RG=Ij.addMethod("_Search2",1036,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);RG.addParameter("searchText","String",1,null,0);RG.addParameter("searchFlags","Int32",1,null,0);const Pr=d.addType("Microsoft.WordServices.RangeCollection",
"{38a0db4c-d855-40aa-879e-2251a0f17b1f}","",3,0);Pr.addProperty("_ReferenceId",2,"String",1,!0,null,0);Pr.addMethod("GetFirst",1003,"Microsoft.WordServices.Range",3,1,"First",0);Pr.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Range",3,1,"FirstOrNullObject",0);Pr.addIndexerMethod(1,"Microsoft.WordServices.Range",3,0).addParameter("index","Object",1,null,0);Pr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Pr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Pr.setCollectionInfo("Microsoft.WordServices.Range",
!0);const pz=d.addType("Microsoft.WordServices.InsertFileOptions","{d396444d-d57f-45bb-a6b1-656f573b250f}","{0ad8e799-7550-4095-aa56-c0c6171febe8}",2,0);pz.addProperty("importCustomXmlParts",7,"Boolean",1,!1,null,0);pz.addProperty("importCustomProperties",6,"Boolean",1,!1,null,0);pz.addProperty("importChangeTrackingMode",5,"Boolean",1,!1,null,0);pz.addProperty("importPageColor",4,"Boolean",1,!1,null,0);pz.addProperty("importParagraphSpacing",3,"Boolean",1,!1,null,0);pz.addProperty("importStyles",
2,"Boolean",1,!1,null,0);pz.addProperty("importTheme",1,"Boolean",1,!1,null,0);const by=d.addType("Microsoft.WordServices.SearchOptions","{957e194f-14af-462d-bd95-e29a55de3b4a}","{88b0a400-950b-42b1-b183-258f504bf71f}",3,0);by.addProperty("IgnorePunct",1,"Boolean",1,!1,null,0);by.addProperty("IgnoreSpace",2,"Boolean",1,!1,null,0);by.addProperty("MatchCase",3,"Boolean",1,!1,null,0);by.addProperty("MatchPrefix",4,"Boolean",1,!1,null,0);by.addProperty("MatchSuffix",6,"Boolean",1,!1,null,0);by.addProperty("MatchWholeWord",
8,"Boolean",1,!1,null,0);by.addProperty("MatchWildcards",7,"Boolean",1,!1,null,0);const fJ=d.addType("Microsoft.WordServices.GetTextOptions","{56e44ca6-8d40-4a75-9174-6fa534b3fe9b}","{168a8246-cc51-4a90-9047-67cb9a0465a6}",2,0);fJ.addProperty("IncludeHiddenText",1,"Boolean",1,!1,null,0);fJ.addProperty("IncludeTextMarkedAsDeleted",2,"Boolean",1,!1,null,0);const Aq=d.addType("Microsoft.WordServices.Section","{a9d1403c-908b-4178-aa45-6b406aeb8cbf}","",3,0);Aq.addProperty("Body",3,"Microsoft.WordServices.Body",
3,!0,null,0);Aq.addProperty("_Id",1,"Int32",1,!0,null,0);Aq.addProperty("_ReferenceId",2,"String",1,!0,null,0);Aq.addMethod("GetFooter",1004,"Microsoft.WordServices.Body",3,1,"Footer",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);Aq.addMethod("GetHeader",1003,"Microsoft.WordServices.Body",3,1,"Header",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);Aq.addMethod("GetNext",1005,"Microsoft.WordServices.Section",3,1,"Next",0);Aq.addMethod("GetNextOrNullObject",
1006,"Microsoft.WordServices.Section",3,1,"NextOrNullObject",0);Aq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Aq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const cy=d.addType("Microsoft.WordServices.SectionCollection","{23ef4423-1c46-48ee-951a-cec1d21d3a5b}","",3,0);cy.addProperty("_ReferenceId",2,"String",1,!0,null,0);cy.addMethod("GetFirst",1003,"Microsoft.WordServices.Section",3,1,"First",0);cy.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Section",
3,1,"FirstOrNullObject",0);cy.addIndexerMethod(1,"Microsoft.WordServices.Section",3,0).addParameter("index","Object",1,null,0);cy.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);cy.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);cy.setCollectionInfo("Microsoft.WordServices.Section",!0);const qz=d.addType("Microsoft.WordServices.Setting","{03764d8a-7c3a-4a5f-82ec-029fbc6f57ee}","",3,0);qz.addProperty("Key",2,"String",1,!0,null,0);qz.addProperty("Value",3,"Object",1,!1,null,0);qz.addProperty("_Id",
4,"String",1,!0,null,0);qz.addProperty("_ReferenceId",1,"String",1,!0,null,0);qz.addMethod("Delete",1003,"Void",0,0,"Delete",0);qz.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);qz.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Hu=d.addType("Microsoft.WordServices.SettingCollection","{02c3b0b1-2468-48c1-8c30-c1e38c6734f7}","",3,0);Hu.addProperty("_ReferenceId",2,"String",1,!0,null,0);const Zm=Hu.addMethod("Add",1003,"Microsoft.WordServices.Setting",3,0,"Add",0);Zm.addParameter("key",
"String",1,null,0);Zm.addParameter("value","Object",1,null,0);Hu.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);Hu.addMethod("GetCount",1004,"Int32",1,1,"Count",0);Hu.addIndexerMethod(1,"Microsoft.WordServices.Setting",3,0).addParameter("key","String",1,null,0);Hu.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.Setting",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);Hu.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Hu.addMethod("_OnAccess",1001,
"Void",0,1,"_OnAccess",0);Hu.setCollectionInfo("Microsoft.WordServices.Setting",!0);const py=d.addType("Microsoft.WordServices.StyleCollection","{fee8d15d-a953-4906-aa80-af8d02008719}","",3,0);py.addProperty("_ReferenceId",2,"String",1,!0,null,0);py.addMethod("GetByName",1003,"Microsoft.WordServices.Style",Ok.ClassObject,1,"GetByName",0).addParameter("name","String",1,null,0);py.addMethod("GetByNameOrNullObject",1004,"Microsoft.WordServices.Style",Ok.ClassObject,1,"GetByNameOrNullObject",0).addParameter("name",
"String",1,null,0);py.addMethod("GetCount",1005,"Int32",1,1,"Count",0);py.addIndexerMethod(1,"Microsoft.WordServices.Style",Ok.ClassObject,0).addParameter("index","Object",1,null,0);py.addMethod("_KeepReference",1002,"Void",Ok.None,1,"_KeepReference",0);py.addMethod("_OnAccess",1001,"Void",Ok.None,1,"_OnAccess",0);py.setCollectionInfo("Microsoft.WordServices.Style",!0);const Cq=d.addType("Microsoft.WordServices.Style","{c2b96925-a089-4d9d-b70e-9a842277a864}","",3,0);Cq.addProperty("BaseStyle",2,"String",
1,!1,null,0);Cq.addProperty("BuiltIn",3,"Boolean",1,!0,null,0);Cq.addProperty("Description",4,"String",1,!0,null,0);Cq.addProperty("Font",5,"Microsoft.WordServices.Font",Ok.ClassObject,!0,null,0);Cq.addProperty("InUse",6,"Boolean",1,!0,null,0);Cq.addProperty("Linked",7,"Boolean",1,!0,null,0);Cq.addProperty("ListTemplate",16,"Microsoft.WordServices.ListTemplate",Ok.ClassObject,!0,null,0);Cq.addProperty("NameLocal",8,"String",1,!0,null,0);Cq.addProperty("NextParagraphStyle",9,"String",1,!1,null,0);
Cq.addProperty("ParagraphFormat",15,"Microsoft.WordServices.ParagraphFormat",Ok.ClassObject,!0,null,0);Cq.addProperty("Priority",10,"Int32",1,!1,null,0);Cq.addProperty("QuickStyle",11,"Boolean",1,!1,null,0);Cq.addProperty("Type",12,"Microsoft.WordServices.StyleType",1,!0,null,0);Cq.addProperty("UnhideWhenUsed",13,"Boolean",1,!1,null,0);Cq.addProperty("Visibility",14,"Boolean",1,!1,null,0);Cq.addProperty("Shading",17,"Microsoft.WordServices.Shading",3,!0,null,0);Cq.addProperty("TableStyle",18,"Microsoft.WordServices.TableStyle",
3,!0,null,0);Cq.addProperty("Borders",19,"Microsoft.WordServices.BorderCollection",3,!0,null,0);Cq.addProperty("_ReferenceId",1,"String",1,!0,null,0);Cq.addMethod("Delete",1003,"Void",Ok.None,0,"Delete",0);Cq.addMethod("_KeepReference",1002,"Void",Ok.None,1,"_KeepReference",0);Cq.addMethod("_OnAccess",1001,"Void",Ok.None,1,"_OnAccess",0);const QA=d.addType("Microsoft.WordServices.Shading","{0753129d-a2b7-436c-a96d-92c68efb3eae}","",3,0);QA.addProperty("BackgroundPatternColor",3,"String",1,!1,null,
0);QA.addProperty("ForegroundPatternColor",4,"String",1,!1,null,0);QA.addProperty("Texture",5,"Microsoft.WordServices.ShadingTextureType",1,!1,null,0);QA.addProperty("_ReferenceId",2,"String",1,!0,null,0);QA.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);QA.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const rk=d.addType("Microsoft.WordServices.Table","{55eb3bc4-acec-4fed-b8d3-10414e633465}","",3,0);rk.addProperty("Alignment",33,"Microsoft.WordServices.Alignment",1,!1,null,
0);rk.addProperty("Endnotes",38,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);rk.addProperty("Fields",39,"Microsoft.WordServices.FieldCollection",3,!0,null,0);rk.addProperty("Font",24,"Microsoft.WordServices.Font",3,!0,null,0);rk.addProperty("Footnotes",37,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);rk.addProperty("HeaderRowCount",12,"Int32",1,!1,null,0);rk.addProperty("HorizontalAlignment",22,"Microsoft.WordServices.Alignment",1,!1,null,0);rk.addProperty("IsUniform",4,"Boolean",
1,!0,null,0);rk.addProperty("NestingLevel",6,"Int32",1,!0,null,0);rk.addProperty("ParentBody",32,"Microsoft.WordServices.Body",3,!0,null,0);rk.addProperty("ParentContentControl",25,"Microsoft.WordServices.ContentControl",3,!0,null,0);rk.addProperty("ParentContentControlOrNullObject",36,"Microsoft.WordServices.ContentControl",3,!0,null,0);rk.addProperty("ParentTable",8,"Microsoft.WordServices.Table",3,!0,null,0);rk.addProperty("ParentTableCell",7,"Microsoft.WordServices.TableCell",3,!0,null,0);rk.addProperty("ParentTableCellOrNullObject",
34,"Microsoft.WordServices.TableCell",3,!0,null,0);rk.addProperty("ParentTableOrNullObject",35,"Microsoft.WordServices.Table",3,!0,null,0);rk.addProperty("RowCount",11,"Int32",1,!0,null,0);rk.addProperty("Rows",3,"Microsoft.WordServices.TableRowCollection",3,!0,null,0);rk.addProperty("ShadingColor",18,"String",1,!1,null,0);rk.addProperty("Style",10,"String",1,!1,null,0);rk.addProperty("StyleBandedColumns",17,"Boolean",1,!1,null,0);rk.addProperty("StyleBandedRows",16,"Boolean",1,!1,null,0);rk.addProperty("StyleBuiltIn",
31,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);rk.addProperty("StyleFirstColumn",14,"Boolean",1,!1,null,0);rk.addProperty("StyleLastColumn",15,"Boolean",1,!1,null,0);rk.addProperty("StyleTotalRow",13,"Boolean",1,!1,null,0);rk.addProperty("Tables",5,"Microsoft.WordServices.TableCollection",3,!0,null,0);rk.addProperty("Values",9,"String[][]",1,!1,null,0);rk.addProperty("VerticalAlignment",23,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);rk.addProperty("Width",27,"Single",1,!1,null,
0);rk.addProperty("_Id",1,"Int32",1,!0,null,0);rk.addProperty("_ReferenceId",2,"String",1,!0,null,0);const jx=rk.addMethod("AddColumns",1004,"Void",0,0,"AddColumns",0);jx.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);jx.addParameter("columnCount","Int32",1,null,0);jx.addParameter("values","String[][]",1,null,0);const Zq=rk.addMethod("AddRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"AddRows",0);Zq.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);Zq.addParameter("rowCount","Int32",1,null,0);Zq.addParameter("values","String[][]",1,null,0);rk.addMethod("AutoFitWindow",1012,"Void",0,0,"AutoFitWindow",0);rk.addMethod("Clear",1008,"Void",0,0,"Clear",0);rk.addMethod("Delete",1007,"Void",0,0,"Delete",0);const SG=rk.addMethod("DeleteColumns",1010,"Void",0,0,"DeleteColumns",0);SG.addParameter("columnIndex","Int32",1,null,0);SG.addParameter("columnCount","Int32?",1,null,0);const SL=rk.addMethod("DeleteRows",1009,"Void",0,0,"DeleteRows",0);
SL.addParameter("rowIndex","Int32",1,null,0);SL.addParameter("rowCount","Int32?",1,null,0);rk.addMethod("DistributeColumns",1014,"Void",0,0,"DistributeColumns",0);rk.addMethod("GetBorder",1015,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);const kx=rk.addMethod("GetCell",1005,"Microsoft.WordServices.TableCell",3,1,"Cell",0);kx.addParameter("rowIndex","Int32",1,null,0);kx.addParameter("cellIndex","Int32",1,null,0);
const TL=rk.addMethod("GetCellOrNullObject",1028,"Microsoft.WordServices.TableCell",3,1,"CellOrNullObject",0);TL.addParameter("rowIndex","Int32",1,null,0);TL.addParameter("cellIndex","Int32",1,null,0);rk.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);rk.addMethod("GetNext",1025,"Microsoft.WordServices.Table",3,1,"Next",0);rk.addMethod("GetNextOrNullObject",1029,"Microsoft.WordServices.Table",
3,1,"NextOrNullObject",0);rk.addMethod("GetParagraphAfter",1027,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfter",0);rk.addMethod("GetParagraphAfterOrNullObject",1031,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfterOrNullObject",0);rk.addMethod("GetParagraphBefore",1026,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBefore",0);rk.addMethod("GetParagraphBeforeOrNullObject",1030,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBeforeOrNullObject",0);rk.addMethod("GetRange",1019,"Microsoft.WordServices.Range",
3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);rk.addMethod("InsertContentControl",1020,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const jt=rk.addMethod("InsertParagraph",1022,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);jt.addParameter("paragraphText","String",1,null,0);jt.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const uh=rk.addMethod("InsertTable",1021,"Microsoft.WordServices.Table",
3,0,"InsertTable",0);uh.addParameter("rowCount","Int32",1,null,0);uh.addParameter("columnCount","Int32",1,null,0);uh.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);uh.addParameter("values","String[][]",1,null,0);const $q=rk.addMethod("MergeCells",1006,"Microsoft.WordServices.TableCell",3,0,"MergeCells",0);$q.addParameter("topRow","Int32",1,null,0);$q.addParameter("firstCell","Int32",1,null,0);$q.addParameter("bottomRow","Int32",1,null,0);$q.addParameter("lastCell",
"Int32",1,null,0);const zw=rk.addMethod("Search",1018,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);zw.addParameter("searchText","String",1,null,0);zw.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);rk.addMethod("Select",1017,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const Kn=rk.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);Kn.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",
1,null,0);Kn.addParameter("cellPadding","Single",1,null,0);rk.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);rk.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const ur=rk.addMethod("_Search2",1032,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);ur.addParameter("searchText","String",1,null,0);ur.addParameter("searchFlags","Int32",1,null,0);const kt=d.addType("Microsoft.WordServices.TableStyle","{9aca4b51-cc8a-4af2-ae75-9ad9dd974f8d}","",3,0);kt.addProperty("Alignment",
3,"Microsoft.WordServices.Alignment",1,!1,null,0);kt.addProperty("AllowBreakAcrossPage",2,"Boolean",1,!1,null,0);kt.addProperty("BottomCellMargin",4,"Single",1,!1,null,0);kt.addProperty("CellSpacing",8,"Single",1,!1,null,0);kt.addProperty("LeftCellMargin",5,"Single",1,!1,null,0);kt.addProperty("RightCellMargin",6,"Single",1,!1,null,0);kt.addProperty("TopCellMargin",7,"Single",1,!1,null,0);kt.addProperty("_ReferenceId",1,"String",1,!0,null,0);kt.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",
0);kt.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Os=d.addType("Microsoft.WordServices.TableCollection","{793ca292-e6dc-48f7-b0e6-16311394a5b2}","",3,0);Os.addProperty("_ReferenceId",2,"String",1,!0,null,0);Os.addMethod("GetFirst",1003,"Microsoft.WordServices.Table",3,1,"First",0);Os.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Table",3,1,"FirstOrNullObject",0);Os.addIndexerMethod(1,"Microsoft.WordServices.Table",3,0).addParameter("index","Object",1,null,0);Os.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);Os.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Os.setCollectionInfo("Microsoft.WordServices.Table",!0);const Nh=d.addType("Microsoft.WordServices.TableRow","{7a28087b-2d9c-4db1-95af-b1ce69d1d4db}","",3,0);Nh.addProperty("CellCount",4,"Int32",1,!0,null,0);Nh.addProperty("Cells",3,"Microsoft.WordServices.TableCellCollection",3,!0,null,0);Nh.addProperty("Endnotes",20,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Nh.addProperty("Font",14,"Microsoft.WordServices.Font",
3,!0,null,0);Nh.addProperty("Fields",21,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Nh.addProperty("Footnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Nh.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);Nh.addProperty("IsHeader",16,"Boolean",1,!0,null,0);Nh.addProperty("ParentTable",5,"Microsoft.WordServices.Table",3,!0,null,0);Nh.addProperty("PreferredHeight",17,"Single",1,!1,null,0);Nh.addProperty("RowIndex",6,"Int32",1,!0,null,0);
Nh.addProperty("ShadingColor",8,"String",1,!1,null,0);Nh.addProperty("Values",7,"String[][]",1,!1,null,0);Nh.addProperty("VerticalAlignment",13,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);Nh.addProperty("_Id",1,"Int32",1,!0,null,0);Nh.addProperty("_ReferenceId",2,"String",1,!0,null,0);Nh.addMethod("Clear",1006,"Void",0,0,"Clear",0);Nh.addMethod("Delete",1005,"Void",0,0,"Delete",0);Nh.addMethod("GetBorder",1009,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation",
"Microsoft.WordServices.BorderLocation",1,null,0);Nh.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Nh.addMethod("GetNext",1012,"Microsoft.WordServices.TableRow",3,1,"Next",0);Nh.addMethod("GetNextOrNullObject",1013,"Microsoft.WordServices.TableRow",3,1,"NextOrNullObject",0);Nh.addMethod("InsertContentControl",1025,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const sn=
Nh.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,1,"InsertRows",0);sn.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);sn.addParameter("rowCount","Int32",1,null,0);sn.addParameter("values","String[][]",1,null,0);Nh.addMethod("Merge",1004,"Microsoft.WordServices.TableCell",3,0,"Merge",0);const Aj=Nh.addMethod("Search",1008,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Aj.addParameter("searchText","String",1,null,0);Aj.addParameter("searchOptions",
"Microsoft.WordServices.SearchOptions",3,null,0);Nh.addMethod("Select",1007,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const Rv=Nh.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);Rv.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Rv.addParameter("cellPadding","Single",1,null,0);Nh.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Nh.addMethod("_OnAccess",1001,"Void",0,1,
"_OnAccess",0);const Ps=Nh.addMethod("_Search2",1026,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Ps.addParameter("searchText","String",1,null,0);Ps.addParameter("searchFlags","Int32",1,null,0);const Az=d.addType("Microsoft.WordServices.TableRowCollection","{f752737f-a469-460b-a2c1-08b958efb48f}","",3,0);Az.addProperty("_ReferenceId",2,"String",1,!0,null,0);Az.addMethod("GetFirst",1003,"Microsoft.WordServices.TableRow",3,1,"First",0);Az.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableRow",
3,1,"FirstOrNullObject",0);Az.addIndexerMethod(1,"Microsoft.WordServices.TableRow",3,0).addParameter("index","Object",1,null,0);Az.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Az.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Az.setCollectionInfo("Microsoft.WordServices.TableRow",!0);const sp=d.addType("Microsoft.WordServices.TableCell","{276a08f8-2afc-42fd-a336-8890d712e195}","",3,0);sp.addProperty("Body",8,"Microsoft.WordServices.Body",3,!0,null,0);sp.addProperty("CellIndex",
6,"Int32",1,!0,null,0);sp.addProperty("ColumnWidth",15,"Single?",1,!1,null,0);sp.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);sp.addProperty("ParentRow",4,"Microsoft.WordServices.TableRow",3,!0,null,0);sp.addProperty("ParentTable",3,"Microsoft.WordServices.Table",3,!0,null,0);sp.addProperty("RowIndex",5,"Int32",1,!0,null,0);sp.addProperty("ShadingColor",9,"String",1,!1,null,0);sp.addProperty("Value",7,"String",1,!1,null,0);sp.addProperty("VerticalAlignment",
14,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);sp.addProperty("Width",16,"Single",1,!0,null,0);sp.addProperty("_Id",1,"Int32",1,!0,null,0);sp.addProperty("_ReferenceId",2,"String",1,!0,null,0);sp.addMethod("DeleteColumn",1007,"Void",0,0,"DeleteColumn",0);sp.addMethod("DeleteRow",1006,"Void",0,0,"DeleteRow",0);sp.addMethod("GetBorder",1008,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);sp.addMethod("GetCellPadding",
1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);sp.addMethod("GetNext",1011,"Microsoft.WordServices.TableCell",3,1,"Next",0);sp.addMethod("GetNextOrNullObject",1012,"Microsoft.WordServices.TableCell",3,1,"NextOrNullObject",0);const TG=sp.addMethod("InsertColumns",1004,"Void",0,0,"InsertColumns",0);TG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);TG.addParameter("columnCount","Int32",1,null,
0);TG.addParameter("values","String[][]",1,null,0);const $w=sp.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"InsertRows",0);$w.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);$w.addParameter("rowCount","Int32",1,null,0);$w.addParameter("values","String[][]",1,null,0);const dy=sp.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);dy.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);dy.addParameter("cellPadding",
"Single",1,null,0);const jk=sp.addMethod("Split",1005,"Void",0,0,"Split",0);jk.addParameter("rowCount","Int32",1,null,0);jk.addParameter("columnCount","Int32",1,null,0);sp.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);sp.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const cv=d.addType("Microsoft.WordServices.TableCellCollection","{67dffdfa-3a5c-431b-8ea7-9600e82453e3}","",3,0);cv.addProperty("_ReferenceId",2,"String",1,!0,null,0);cv.addMethod("GetFirst",1003,"Microsoft.WordServices.TableCell",
3,1,"First",0);cv.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableCell",3,1,"FirstOrNullObject",0);cv.addIndexerMethod(1,"Microsoft.WordServices.TableCell",3,0).addParameter("index","Object",1,null,0);cv.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);cv.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);cv.setCollectionInfo("Microsoft.WordServices.TableCell",!0);const ar=d.addType("Microsoft.WordServices.TableBorder","{3e45a91b-f887-4feb-8fef-21e1e40f6fb6}","",
3,0);ar.addProperty("Color",2,"String",1,!1,null,0);ar.addProperty("Type",3,"Microsoft.WordServices.BorderType",1,!1,null,0);ar.addProperty("Width",4,"Single",1,!1,null,0);ar.addProperty("_ReferenceId",1,"String",1,!0,null,0);ar.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);ar.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const sk=d.addType("Microsoft.WordServices.TrackedChange","{fb2462ee-ab45-426e-9637-de15ad6bf81d}","",3,0);sk.addProperty("Author",2,"String",1,!0,null,0);
sk.addProperty("Date",3,"DateTime",1,!0,null,0);sk.addProperty("Text",4,"String",1,!0,null,0);sk.addProperty("Type",5,"Microsoft.WordServices.TrackedChangeType",1,!0,null,0);sk.addProperty("_ReferenceId",1,"String",1,!0,null,0);sk.addMethod("Accept",1003,"Void",0,0,"Accept",0);sk.addMethod("GetNext",1006,"Microsoft.WordServices.TrackedChange",3,1,"Next",0);sk.addMethod("GetNextOrNullObject",1007,"Microsoft.WordServices.TrackedChange",3,1,"NextOrNullObject",0);sk.addMethod("GetRange",1005,"Microsoft.WordServices.Range",
3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);sk.addMethod("Reject",1004,"Void",0,0,"Reject",0);sk.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);sk.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Qr=d.addType("Microsoft.WordServices.TrackedChangeCollection","{072f5cd0-50c2-4619-9478-8605fbe0797b}","",3,0);Qr.addProperty("_ReferenceId",2,"String",1,!0,null,0);Qr.addMethod("AcceptAll",1006,"Void",0,0,"AcceptAll",0);Qr.addMethod("GetFirst",
1004,"Microsoft.WordServices.TrackedChange",3,1,"First",0);Qr.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.TrackedChange",3,1,"FirstOrNullObject",0);Qr.addIndexerMethod(1,"Microsoft.WordServices.TrackedChange",Ok.ClassObject,0).addParameter("index","Object",1,null,0);Qr.addMethod("RejectAll",1007,"Void",0,0,"RejectAll",0);Qr.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Qr.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Qr.setCollectionInfo("Microsoft.WordServices.TrackedChange",
!0);const nq=d.addEnumType("Microsoft.WordServices.EventType");nq.addEnumField("ContentControlDeleted",0);nq.addEnumField("ContentControlSelectionChanged",1);nq.addEnumField("ContentControlDataChanged",2);nq.addEnumField("ContentControlAdded",3);nq.addEnumField("AnnotationAdded",4);nq.addEnumField("AnnotationChanged",5);nq.addEnumField("AnnotationDeleted",6);nq.addEnumField("CommentDeleted",7);nq.addEnumField("CommentSelected",8);nq.addEnumField("CommentDeselected",9);nq.addEnumField("CommentChanged",
10);nq.addEnumField("CommentAdded",11);nq.addEnumField("ContentControlEntered",12);nq.addEnumField("ContentControlExited",13);nq.addEnumField("DocumentWordCountChanged",14);nq.addEnumField("ParagraphAdded",15);nq.addEnumField("ParagraphChanged",16);nq.addEnumField("ParagraphDeleted",17);nq.addEnumField("AnnotationClicked",18);nq.addEnumField("AnnotationHovered",19);nq.addEnumField("AnnotationInserted",20);nq.addEnumField("AnnotationRemoved",21);const Es=d.addEnumType("Microsoft.WordServices.ContentControlType");
Es.addEnumField("Unknown",0);Es.addEnumField("RichTextInline",1);Es.addEnumField("RichTextParagraphs",2);Es.addEnumField("RichTextTableCell",4);Es.addEnumField("RichTextTableRow",8);Es.addEnumField("RichTextTable",16);Es.addEnumField("PlainTextInline",32);Es.addEnumField("PlainTextParagraph",64);Es.addEnumField("Picture",128);Es.addEnumField("BuildingBlockGallery",256);Es.addEnumField("CheckBox",512);Es.addEnumField("ComboBox",1024);Es.addEnumField("DropDownList",2048);Es.addEnumField("DatePicker",
4096);Es.addEnumField("RepeatingSection",8192);Es.addEnumField("RichText",31);Es.addEnumField("PlainText",96);const ey=d.addEnumType("Microsoft.WordServices.ContentControlAppearance");ey.addEnumField("BoundingBox",0);ey.addEnumField("Tags",1);ey.addEnumField("Hidden",2);const Im=d.addEnumType("Microsoft.WordServices.UnderlineType");Im.addEnumField("Mixed",-1);Im.addEnumField("None",0);Im.addEnumField("Hidden",5);Im.addEnumField("DotLine",8);Im.addEnumField("Single",1);Im.addEnumField("Word",2);Im.addEnumField("Double",
3);Im.addEnumField("Thick",6);Im.addEnumField("Dotted",4);Im.addEnumField("DottedHeavy",20);Im.addEnumField("DashLine",7);Im.addEnumField("DashLineHeavy",23);Im.addEnumField("DashLineLong",39);Im.addEnumField("DashLineLongHeavy",55);Im.addEnumField("DotDashLine",9);Im.addEnumField("DotDashLineHeavy",25);Im.addEnumField("TwoDotDashLine",10);Im.addEnumField("TwoDotDashLineHeavy",26);Im.addEnumField("Wave",11);Im.addEnumField("WaveHeavy",27);Im.addEnumField("WaveDouble",43);const Jv=d.addEnumType("Microsoft.WordServices.BreakType");
Jv.addEnumField("Page",0);Jv.addEnumField("Next",2);Jv.addEnumField("SectionNext",1002);Jv.addEnumField("SectionContinuous",3);Jv.addEnumField("SectionEven",4);Jv.addEnumField("SectionOdd",5);Jv.addEnumField("Line",6);const DA=d.addEnumType("Microsoft.WordServices.InsertLocation");DA.addEnumField("Before",0);DA.addEnumField("After",1);DA.addEnumField("Start",2);DA.addEnumField("End",3);DA.addEnumField("Replace",4);const Iu=d.addEnumType("Microsoft.WordServices.Alignment");Iu.addEnumField("Mixed",
-2);Iu.addEnumField("Unknown",-1);Iu.addEnumField("Left",0);Iu.addEnumField("Centered",1);Iu.addEnumField("Right",2);Iu.addEnumField("Justified",3);const fE=d.addEnumType("Microsoft.WordServices.HeaderFooterType");fE.addEnumField("Primary",0);fE.addEnumField("FirstPage",1);fE.addEnumField("EvenPages",2);const fy=d.addEnumType("Microsoft.WordServices.BodyType");fy.addEnumField("Unknown",-1);fy.addEnumField("MainDoc",0);fy.addEnumField("Section",1);fy.addEnumField("Header",2);fy.addEnumField("Footer",
3);fy.addEnumField("TableCell",4);fy.addEnumField("Footnote",5);fy.addEnumField("Endnote",6);fy.addEnumField("NoteItem",7);const ht=d.addEnumType("Microsoft.WordServices.SelectionMode");ht.addEnumField("Select",0);ht.addEnumField("Start",1);ht.addEnumField("End",2);const du=d.addEnumType("Microsoft.WordServices.ImageFormat");du.addEnumField("Unsupported",-2);du.addEnumField("Undefined",-1);du.addEnumField("Bmp",0);du.addEnumField("Jpeg",1);du.addEnumField("Gif",2);du.addEnumField("Tiff",3);du.addEnumField("Png",
4);du.addEnumField("Icon",5);du.addEnumField("Exif",6);du.addEnumField("Wmf",7);du.addEnumField("Emf",8);du.addEnumField("Pict",9);du.addEnumField("Pdf",10);du.addEnumField("Svg",11);const gy=d.addEnumType("Microsoft.WordServices.RangeLocation");gy.addEnumField("Whole",0);gy.addEnumField("Start",1);gy.addEnumField("End",2);gy.addEnumField("Before",3);gy.addEnumField("After",4);gy.addEnumField("Content",5);const As=d.addEnumType("Microsoft.WordServices.LocationRelation");As.addEnumField("Unrelated",
0);As.addEnumField("Equal",1);As.addEnumField("ContainsStart",2);As.addEnumField("ContainsEnd",3);As.addEnumField("Contains",4);As.addEnumField("InsideStart",5);As.addEnumField("InsideEnd",6);As.addEnumField("Inside",7);As.addEnumField("AdjacentBefore",8);As.addEnumField("OverlapsBefore",9);As.addEnumField("Before",10);As.addEnumField("AdjacentAfter",11);As.addEnumField("OverlapsAfter",12);As.addEnumField("After",13);const av=d.addEnumType("Microsoft.WordServices.BorderLocation");av.addEnumField("Top",
0);av.addEnumField("Left",1);av.addEnumField("Bottom",2);av.addEnumField("Right",3);av.addEnumField("InsideHorizontal",4);av.addEnumField("InsideVertical",5);av.addEnumField("Inside",6);av.addEnumField("Outside",7);av.addEnumField("All",8);const Ju=d.addEnumType("Microsoft.WordServices.BorderWidth");Ju.addEnumField("None",0);Ju.addEnumField("Pt025",2);Ju.addEnumField("Pt050",4);Ju.addEnumField("Pt075",6);Ju.addEnumField("Pt100",8);Ju.addEnumField("Pt150",12);Ju.addEnumField("Pt225",18);Ju.addEnumField("Pt300",
24);Ju.addEnumField("Pt450",36);Ju.addEnumField("Pt600",48);Ju.addEnumField("Mixed",9999999);const gE=d.addEnumType("Microsoft.WordServices.CellPaddingLocation");gE.addEnumField("Top",0);gE.addEnumField("Left",1);gE.addEnumField("Bottom",2);gE.addEnumField("Right",3);const Bq=d.addEnumType("Microsoft.WordServices.BorderType");Bq.addEnumField("Mixed",-1);Bq.addEnumField("None",0);Bq.addEnumField("Single",1);Bq.addEnumField("Double",3);Bq.addEnumField("Dotted",6);Bq.addEnumField("Dashed",7);Bq.addEnumField("DotDashed",
8);Bq.addEnumField("Dot2Dashed",9);Bq.addEnumField("Triple",10);Bq.addEnumField("ThinThickSmall",11);Bq.addEnumField("ThickThinSmall",12);Bq.addEnumField("ThinThickThinSmall",13);Bq.addEnumField("ThinThickMed",14);Bq.addEnumField("ThickThinMed",15);Bq.addEnumField("ThinThickThinMed",16);Bq.addEnumField("ThinThickLarge",17);Bq.addEnumField("ThickThinLarge",18);Bq.addEnumField("ThinThickThinLarge",19);Bq.addEnumField("Wave",20);Bq.addEnumField("DoubleWave",21);Bq.addEnumField("DashedSmall",22);Bq.addEnumField("DashDotStroked",
23);Bq.addEnumField("ThreeDEmboss",24);Bq.addEnumField("ThreeDEngrave",25);const qG=d.addEnumType("Microsoft.WordServices.VerticalAlignment");qG.addEnumField("Mixed",-1);qG.addEnumField("Top",0);qG.addEnumField("Center",1);qG.addEnumField("Bottom",2);const hs=d.addEnumType("Microsoft.WordServices.ListLevelType");hs.addEnumField("Bullet",0);hs.addEnumField("Number",1);hs.addEnumField("Picture",2);const eu=d.addEnumType("Microsoft.WordServices.ListBullet");eu.addEnumField("Custom",0);eu.addEnumField("Solid",
258231);eu.addEnumField("Hollow",131183);eu.addEnumField("Square",716967);eu.addEnumField("Diamonds",716918);eu.addEnumField("Arrow",717016);eu.addEnumField("Checkmark",717052);const EA=d.addEnumType("Microsoft.WordServices.ListNumbering");EA.addEnumField("None",-1);EA.addEnumField("Arabic",0);EA.addEnumField("UpperRoman",1);EA.addEnumField("LowerRoman",2);EA.addEnumField("UpperLetter",3);EA.addEnumField("LowerLetter",4);const Cf=d.addEnumType("Microsoft.WordServices.StyleBuiltIn");Cf.addEnumField("Other",
-1);Cf.addEnumField("Normal",0);Cf.addEnumField("Heading1",1);Cf.addEnumField("Heading2",2);Cf.addEnumField("Heading3",3);Cf.addEnumField("Heading4",4);Cf.addEnumField("Heading5",5);Cf.addEnumField("Heading6",6);Cf.addEnumField("Heading7",7);Cf.addEnumField("Heading8",8);Cf.addEnumField("Heading9",9);Cf.addEnumField("Toc1",19);Cf.addEnumField("Toc2",20);Cf.addEnumField("Toc3",21);Cf.addEnumField("Toc4",22);Cf.addEnumField("Toc5",23);Cf.addEnumField("Toc6",24);Cf.addEnumField("Toc7",25);Cf.addEnumField("Toc8",
26);Cf.addEnumField("Toc9",27);Cf.addEnumField("FootnoteText",29);Cf.addEnumField("Header",31);Cf.addEnumField("Footer",32);Cf.addEnumField("Caption",34);Cf.addEnumField("FootnoteReference",38);Cf.addEnumField("EndnoteReference",42);Cf.addEnumField("EndnoteText",43);Cf.addEnumField("Title",62);Cf.addEnumField("Subtitle",74);Cf.addEnumField("Hyperlink",85);Cf.addEnumField("Strong",87);Cf.addEnumField("Emphasis",88);Cf.addEnumField("NoSpacing",157);Cf.addEnumField("ListParagraph",179);Cf.addEnumField("Quote",
180);Cf.addEnumField("IntenseQuote",181);Cf.addEnumField("SubtleEmphasis",260);Cf.addEnumField("IntenseEmphasis",261);Cf.addEnumField("SubtleReference",262);Cf.addEnumField("IntenseReference",263);Cf.addEnumField("BookTitle",264);Cf.addEnumField("Bibliography",265);Cf.addEnumField("TocHeading",266);Cf.addEnumField("TableGrid",154);Cf.addEnumField("PlainTable1",267);Cf.addEnumField("PlainTable2",268);Cf.addEnumField("PlainTable3",269);Cf.addEnumField("PlainTable4",270);Cf.addEnumField("PlainTable5",
271);Cf.addEnumField("TableGridLight",272);Cf.addEnumField("GridTable1Light",111);Cf.addEnumField("GridTable1Light_Accent1",280);Cf.addEnumField("GridTable1Light_Accent2",287);Cf.addEnumField("GridTable1Light_Accent3",294);Cf.addEnumField("GridTable1Light_Accent4",301);Cf.addEnumField("GridTable1Light_Accent5",308);Cf.addEnumField("GridTable1Light_Accent6",315);Cf.addEnumField("GridTable2",274);Cf.addEnumField("GridTable2_Accent1",281);Cf.addEnumField("GridTable2_Accent2",288);Cf.addEnumField("GridTable2_Accent3",
295);Cf.addEnumField("GridTable2_Accent4",302);Cf.addEnumField("GridTable2_Accent5",309);Cf.addEnumField("GridTable2_Accent6",316);Cf.addEnumField("GridTable3",275);Cf.addEnumField("GridTable3_Accent1",282);Cf.addEnumField("GridTable3_Accent2",289);Cf.addEnumField("GridTable3_Accent3",296);Cf.addEnumField("GridTable3_Accent4",303);Cf.addEnumField("GridTable3_Accent5",310);Cf.addEnumField("GridTable3_Accent6",317);Cf.addEnumField("GridTable4",276);Cf.addEnumField("GridTable4_Accent1",283);Cf.addEnumField("GridTable4_Accent2",
290);Cf.addEnumField("GridTable4_Accent3",297);Cf.addEnumField("GridTable4_Accent4",304);Cf.addEnumField("GridTable4_Accent5",311);Cf.addEnumField("GridTable4_Accent6",318);Cf.addEnumField("GridTable5Dark",277);Cf.addEnumField("GridTable5Dark_Accent1",284);Cf.addEnumField("GridTable5Dark_Accent2",291);Cf.addEnumField("GridTable5Dark_Accent3",298);Cf.addEnumField("GridTable5Dark_Accent4",305);Cf.addEnumField("GridTable5Dark_Accent5",312);Cf.addEnumField("GridTable5Dark_Accent6",319);Cf.addEnumField("GridTable6Colorful",
278);Cf.addEnumField("GridTable6Colorful_Accent1",285);Cf.addEnumField("GridTable6Colorful_Accent2",292);Cf.addEnumField("GridTable6Colorful_Accent3",299);Cf.addEnumField("GridTable6Colorful_Accent4",306);Cf.addEnumField("GridTable6Colorful_Accent5",313);Cf.addEnumField("GridTable6Colorful_Accent6",320);Cf.addEnumField("GridTable7Colorful",279);Cf.addEnumField("GridTable7Colorful_Accent1",286);Cf.addEnumField("GridTable7Colorful_Accent2",293);Cf.addEnumField("GridTable7Colorful_Accent3",300);Cf.addEnumField("GridTable7Colorful_Accent4",
307);Cf.addEnumField("GridTable7Colorful_Accent5",314);Cf.addEnumField("GridTable7Colorful_Accent6",321);Cf.addEnumField("ListTable1Light",322);Cf.addEnumField("ListTable1Light_Accent1",329);Cf.addEnumField("ListTable1Light_Accent2",336);Cf.addEnumField("ListTable1Light_Accent3",343);Cf.addEnumField("ListTable1Light_Accent4",350);Cf.addEnumField("ListTable1Light_Accent5",357);Cf.addEnumField("ListTable1Light_Accent6",364);Cf.addEnumField("ListTable2",323);Cf.addEnumField("ListTable2_Accent1",330);
Cf.addEnumField("ListTable2_Accent2",337);Cf.addEnumField("ListTable2_Accent3",344);Cf.addEnumField("ListTable2_Accent4",351);Cf.addEnumField("ListTable2_Accent5",358);Cf.addEnumField("ListTable2_Accent6",365);Cf.addEnumField("ListTable3",324);Cf.addEnumField("ListTable3_Accent1",331);Cf.addEnumField("ListTable3_Accent2",338);Cf.addEnumField("ListTable3_Accent3",345);Cf.addEnumField("ListTable3_Accent4",352);Cf.addEnumField("ListTable3_Accent5",359);Cf.addEnumField("ListTable3_Accent6",366);Cf.addEnumField("ListTable4",
325);Cf.addEnumField("ListTable4_Accent1",332);Cf.addEnumField("ListTable4_Accent2",339);Cf.addEnumField("ListTable4_Accent3",346);Cf.addEnumField("ListTable4_Accent4",353);Cf.addEnumField("ListTable4_Accent5",360);Cf.addEnumField("ListTable4_Accent6",367);Cf.addEnumField("ListTable5Dark",326);Cf.addEnumField("ListTable5Dark_Accent1",333);Cf.addEnumField("ListTable5Dark_Accent2",340);Cf.addEnumField("ListTable5Dark_Accent3",347);Cf.addEnumField("ListTable5Dark_Accent4",354);Cf.addEnumField("ListTable5Dark_Accent5",
361);Cf.addEnumField("ListTable5Dark_Accent6",368);Cf.addEnumField("ListTable6Colorful",327);Cf.addEnumField("ListTable6Colorful_Accent1",334);Cf.addEnumField("ListTable6Colorful_Accent2",341);Cf.addEnumField("ListTable6Colorful_Accent3",348);Cf.addEnumField("ListTable6Colorful_Accent4",355);Cf.addEnumField("ListTable6Colorful_Accent5",362);Cf.addEnumField("ListTable6Colorful_Accent6",369);Cf.addEnumField("ListTable7Colorful",328);Cf.addEnumField("ListTable7Colorful_Accent1",335);Cf.addEnumField("ListTable7Colorful_Accent2",
342);Cf.addEnumField("ListTable7Colorful_Accent3",349);Cf.addEnumField("ListTable7Colorful_Accent4",356);Cf.addEnumField("ListTable7Colorful_Accent5",363);Cf.addEnumField("ListTable7Colorful_Accent6",370);const rn=d.addEnumType("Microsoft.WordServices.ShadingTextureType");rn.addEnumField("DarkDiagonalDown",-3);rn.addEnumField("DarkDiagonalUp",-4);rn.addEnumField("DarkGrid",-5);rn.addEnumField("DarkHorizontal",-1);rn.addEnumField("DarkTrellis",-6);rn.addEnumField("DarkVertical",-2);rn.addEnumField("LightDiagonalDown",
-9);rn.addEnumField("LightDiagonalUp",-10);rn.addEnumField("LightGrid",-11);rn.addEnumField("LightHorizontal",-7);rn.addEnumField("LightTrellis",-12);rn.addEnumField("LightVertical",-8);rn.addEnumField("None",0);rn.addEnumField("Percent10",100);rn.addEnumField("Percent12Pt5",125);rn.addEnumField("Percent15",150);rn.addEnumField("Percent20",200);rn.addEnumField("Percent25",250);rn.addEnumField("Percent30",300);rn.addEnumField("Percent35",350);rn.addEnumField("Percent37Pt5",375);rn.addEnumField("Percent40",
400);rn.addEnumField("Percent45",450);rn.addEnumField("Percent5",50);rn.addEnumField("Percent50",500);rn.addEnumField("Percent55",550);rn.addEnumField("Percent60",600);rn.addEnumField("Percent62Pt5",625);rn.addEnumField("Percent65",650);rn.addEnumField("Percent70",700);rn.addEnumField("Percent75",750);rn.addEnumField("Percent80",800);rn.addEnumField("Percent85",850);rn.addEnumField("Percent87Pt5",875);rn.addEnumField("Percent90",900);rn.addEnumField("Percent95",950);rn.addEnumField("Solid",1E3);const hE=
d.addEnumType("Microsoft.WordServices.DocumentPropertyType");hE.addEnumField("String",0);hE.addEnumField("Number",1);hE.addEnumField("Date",2);hE.addEnumField("Boolean",3);const hy=d.addEnumType("Microsoft.WordServices.TapObjectType");hy.addEnumField("Chart",1);hy.addEnumField("SmartArt",2);hy.addEnumField("Table",3);hy.addEnumField("Image",4);hy.addEnumField("Slide",5);hy.addEnumField("OLE",6);hy.addEnumField("Text",7);const ax=d.addEnumType("Microsoft.WordServices.FileContentFormat");ax.addEnumField("Base64",
0);ax.addEnumField("Html",7);ax.addEnumField("Ooxml",9);const FA=d.addEnumType("Microsoft.WordServices.AnnotationParentType");FA.addEnumField("None",0);FA.addEnumField("Document",1);FA.addEnumField("Paragraph",2);FA.addEnumField("Annotation",3);const iy=d.addEnumType(Q);iy.addEnumField("Undefined",0);iy.addEnumField("Created",10);iy.addEnumField("Sent",20);iy.addEnumField("Duplicated",30);iy.addEnumField("Seen",40);iy.addEnumField("Tried",50);iy.addEnumField("Kept",60);iy.addEnumField("Rejected",
70);const iE=d.addEnumType("Microsoft.WordServices.StyleType");iE.addEnumField("Character",0);iE.addEnumField("List",1);iE.addEnumField("Paragraph",2);iE.addEnumField("Table",3);const GA=d.addEnumType("Microsoft.WordServices.OutlineLevel");GA.addEnumField("OutlineLevel1",0);GA.addEnumField("OutlineLevel2",1);GA.addEnumField("OutlineLevel3",2);GA.addEnumField("OutlineLevel4",3);const Sh=d.addEnumType("Microsoft.WordServices.FieldType");Sh.addEnumField("Addin",81);Sh.addEnumField("AddressBlock",93);
Sh.addEnumField("Advance",84);Sh.addEnumField("Ask",38);Sh.addEnumField("Author",17);Sh.addEnumField("AutoText",79);Sh.addEnumField("AutoTextList",89);Sh.addEnumField("BarCode",63);Sh.addEnumField("Bibliography",97);Sh.addEnumField("BidiOutline",92);Sh.addEnumField("Citation",96);Sh.addEnumField("Comments",19);Sh.addEnumField("Compare",80);Sh.addEnumField("CreateDate",21);Sh.addEnumField("Data",40);Sh.addEnumField("Database",78);Sh.addEnumField("Date",31);Sh.addEnumField("DisplayBarcode",99);Sh.addEnumField("DocProperty",
85);Sh.addEnumField("DocVariable",64);Sh.addEnumField("EditTime",25);Sh.addEnumField("Embedded",58);Sh.addEnumField("EQ",49);Sh.addEnumField("Expression",34);Sh.addEnumField("FileName",29);Sh.addEnumField("FileSize",69);Sh.addEnumField("FillIn",39);Sh.addEnumField("FormCheckbox",71);Sh.addEnumField("FormDropdown",83);Sh.addEnumField("FormText",70);Sh.addEnumField("GotoButton",50);Sh.addEnumField("GreetingLine",94);Sh.addEnumField("Hyperlink",88);Sh.addEnumField("If",7);Sh.addEnumField("Import",55);
Sh.addEnumField("Include",36);Sh.addEnumField("IncludePicture",67);Sh.addEnumField("IncludeText",68);Sh.addEnumField("Index",8);Sh.addEnumField("Info",14);Sh.addEnumField("Keywords",18);Sh.addEnumField("LastSavedBy",20);Sh.addEnumField("Link",56);Sh.addEnumField("ListNum",90);Sh.addEnumField("MacroButton",51);Sh.addEnumField("MergeBarcode",98);Sh.addEnumField("MergeField",59);Sh.addEnumField("MergeRec",44);Sh.addEnumField("MergeSeq",75);Sh.addEnumField("Next",41);Sh.addEnumField("NextIf",42);Sh.addEnumField("NoteRef",
72);Sh.addEnumField("NumChars",28);Sh.addEnumField("NumPages",26);Sh.addEnumField("NumWords",27);Sh.addEnumField("OCX",87);Sh.addEnumField("Page",33);Sh.addEnumField("PageRef",37);Sh.addEnumField("Print",48);Sh.addEnumField("PrintDate",23);Sh.addEnumField("Private",77);Sh.addEnumField("Quote",35);Sh.addEnumField("RD",11);Sh.addEnumField("Ref",3);Sh.addEnumField("RevNum",24);Sh.addEnumField("SaveDate",22);Sh.addEnumField("Section",65);Sh.addEnumField("SectionPages",66);Sh.addEnumField("Seq",12);Sh.addEnumField("Set",
6);Sh.addEnumField("Shape",95);Sh.addEnumField("SkipIf",43);Sh.addEnumField("StyleRef",10);Sh.addEnumField("Subject",16);Sh.addEnumField("Subscriber",82);Sh.addEnumField("Symbol",57);Sh.addEnumField("TA",74);Sh.addEnumField("TC",9);Sh.addEnumField("Template",30);Sh.addEnumField("Time",32);Sh.addEnumField("Title",15);Sh.addEnumField("TOA",73);Sh.addEnumField("TOC",13);Sh.addEnumField("UserAddress",62);Sh.addEnumField("UserInitials",61);Sh.addEnumField("UserName",60);Sh.addEnumField("XE",4);Sh.addEnumField("Empty",
-1);Sh.addEnumField("Others",100);Sh.addEnumField("Undefined",0);const jE=d.addEnumType("Microsoft.WordServices.FieldKind");jE.addEnumField("None",0);jE.addEnumField("Hot",1);jE.addEnumField("Warm",2);jE.addEnumField("Cold",3);const xw=d.addEnumType("Microsoft.WordServices.TrailingCharacter");xw.addEnumField("TrailingTab",0);xw.addEnumField("TrailingSpace",1);xw.addEnumField("TrailingNone",2);const Hj=d.addEnumType("Microsoft.WordServices.ListBuiltInNumberStyle");Hj.addEnumField("None",-1);Hj.addEnumField("Arabic",
0);Hj.addEnumField("UpperRoman",1);Hj.addEnumField("LowerRoman",2);Hj.addEnumField("UpperLetter",3);Hj.addEnumField("LowerLetter",4);Hj.addEnumField("Ordinal",5);Hj.addEnumField("CardinalText",6);Hj.addEnumField("OrdinalText",7);Hj.addEnumField("Kanji",10);Hj.addEnumField("KanjiDigit",11);Hj.addEnumField("AiueoHalfWidth",12);Hj.addEnumField("IrohaHalfWidth",13);Hj.addEnumField("ArabicFullWidth",14);Hj.addEnumField("KanjiTraditional",16);Hj.addEnumField("KanjiTraditional2",17);Hj.addEnumField("NumberInCircle",
18);Hj.addEnumField("Aiueo",20);Hj.addEnumField("Iroha",21);Hj.addEnumField("ArabicLZ",22);Hj.addEnumField("Bullet",23);Hj.addEnumField("Ganada",24);Hj.addEnumField("Chosung",25);Hj.addEnumField("GBNum1",26);Hj.addEnumField("GBNum2",27);Hj.addEnumField("GBNum3",28);Hj.addEnumField("GBNum4",29);Hj.addEnumField("Zodiac1",30);Hj.addEnumField("Zodiac2",31);Hj.addEnumField("Zodiac3",32);Hj.addEnumField("TradChinNum1",33);Hj.addEnumField("TradChinNum2",34);Hj.addEnumField("TradChinNum3",35);Hj.addEnumField("TradChinNum4",
36);Hj.addEnumField("SimpChinNum1",37);Hj.addEnumField("SimpChinNum2",38);Hj.addEnumField("SimpChinNum3",39);Hj.addEnumField("SimpChinNum4",40);Hj.addEnumField("HanjaRead",41);Hj.addEnumField("HanjaReadDigit",42);Hj.addEnumField("Hangul",43);Hj.addEnumField("Hanja",44);Hj.addEnumField("Hebrew1",45);Hj.addEnumField("Arabic1",46);Hj.addEnumField("Hebrew2",47);Hj.addEnumField("Arabic2",48);Hj.addEnumField("HindiLetter1",49);Hj.addEnumField("HindiLetter2",50);Hj.addEnumField("HindiArabic",51);Hj.addEnumField("HindiCardinalText",
52);Hj.addEnumField("ThaiLetter",53);Hj.addEnumField("ThaiArabic",54);Hj.addEnumField("ThaiCardinalText",55);Hj.addEnumField("VietCardinalText",56);Hj.addEnumField("LowercaseRussian",58);Hj.addEnumField("UppercaseRussian",59);Hj.addEnumField("LowercaseGreek",60);Hj.addEnumField("UppercaseGreek",61);Hj.addEnumField("ArabicLZ2",62);Hj.addEnumField("ArabicLZ3",63);Hj.addEnumField("ArabicLZ4",64);Hj.addEnumField("LowercaseTurkish",65);Hj.addEnumField("UppercaseTurkish",66);Hj.addEnumField("LowercaseBulgarian",
67);Hj.addEnumField("UppercaseBulgarian",68);Hj.addEnumField("PictureBullet",249);Hj.addEnumField("Legal",253);Hj.addEnumField("LegalLZ",254);const rz=d.addEnumType("Microsoft.WordServices.NoteItemType");rz.addEnumField("Footnote",0);rz.addEnumField("Endnote",1);const lC=d.addEnumType("Microsoft.WordServices.ChangeTrackingMode");lC.addEnumField("Off",0);lC.addEnumField("TrackAll",1);lC.addEnumField("TrackMineOnly",2);const jy=d.addEnumType("Microsoft.WordServices.ChangeTrackingState");jy.addEnumField("Unknown",
0);jy.addEnumField("Normal",1);jy.addEnumField("Added",2);jy.addEnumField("Deleted",4);const kE=d.addEnumType("Microsoft.WordServices.TrackedChangeType");kE.addEnumField("None",0);kE.addEnumField("Added",1);kE.addEnumField("Deleted",2);kE.addEnumField("Formatted",3);const sz=d.addEnumType("Microsoft.WordServices.ChangeTrackingVersion");sz.addEnumField("Original",0);sz.addEnumField("Current",1);const gJ=d.addEnumType("Microsoft.WordServices.SaveBehavior");gJ.addEnumField("Save",0);gJ.addEnumField("Prompt",
1);const HA=d.addEnumType("Microsoft.WordServices.CloseBehavior");HA.addEnumField("Save",0);HA.addEnumField("SkipSave",1);const hJ=d.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);hJ.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);hJ.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",
1,null,0);const ky=d.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ky.addEnumField("Inactive",0);ky.addEnumField("Background",1);ky.addEnumField("Visible",2);const iJ=d.addEnumType("Microsoft.AppRuntime.Visibility");iJ.addEnumField("Hidden",1);iJ.addEnumField("Visible",2);const rG=d.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);rG.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeStartState",0);rG.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);d.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0).addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);const nM=d.addEnumType("Microsoft.Authentication.IdentityType");nM.addEnumField("OrganizationAccount",
0);nM.addEnumField("MicrosoftAccount",1);const jJ=d.addEnumType("Microsoft.Authentication.AuthorityType");jJ.addEnumField("External",0);jJ.addEnumField("Msa",1);jJ.addEnumField("Aad",2);const bx=d.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);bx.addProperty("DisplayName",4,"String",1,!1,null,0);bx.addProperty("Email",3,"String",1,!1,null,0);bx.addProperty("FederationProvider",2,"String",1,!1,null,0);bx.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);const tz=d.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);tz.addProperty("AppId",4,"String",1,!1,null,0);tz.addProperty("Authority",2,"String",1,!1,null,0);tz.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);tz.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);tz.addProperty("TenantId",6,"String",1,!1,null,0);tz.addProperty("Upn",
1,"String",1,!1,null,0);const lE=d.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);lE.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);lE.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4).addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);lE.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);lE.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);const IA=d.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);IA.addProperty("AuthChallenge",3,"String",1,!1,null,0);IA.addProperty("CorrelationId",7,"String",1,!1,null,0);IA.addProperty("Policy",4,"String",1,!1,null,0);IA.addProperty("Resource",2,"String",1,!1,null,0);IA.addProperty("Scope",
5,"String",1,!1,null,0);IA.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);const sL=d.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);sL.addProperty("AccessToken",2,"String",1,!1,null,0);sL.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);const tL=d.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);tL.addProperty("Id",
1,"String",1,!0,null,0);tL.addProperty("Value",2,"Object",1,!1,null,0);const uL=d.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);uL.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0).addParameter("id","String",1,null,0);uL.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0).addParameter("id","String",1,null,0);const sG=d.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
sG.addEnumField("Unknown",0);sG.addEnumField("Basic",1);sG.addEnumField("Premium",2);const fu=d.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0),JA=fu.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);JA.addParameter("feature","String",1,null,0);JA.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);fu.addMethod("GetLicenseFeature",5,
"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0).addParameter("feature","String",1,null,0);const kJ=fu.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);kJ.addParameter("resource","String",1,null,0);kJ.addParameter("policy","String",1,null,0);kJ.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);const tG=fu.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);tG.addParameter("feature","String",1,null,0);tG.addParameter("fallbackValue",
"Boolean",1,null,0);fu.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);fu.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0).addParameter("experienceId","String",1,null,0);fu.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4).addParameter("feature","String",1,null,0);const lJ=d.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);lJ.addProperty("Id",5,"String",
1,!0,null,0);lJ.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);lJ.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);d.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0).addProperty("Scopes",1,"String",1,!1,null,0)};class Wm extends Ud{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye){super(d,n,Q,Aa,ye);this.TCk=B;this.oB=ha;this.u6a=bb;this.XIa=
Ib;this.R7=wd;this.Zc=Ac;this.rq=ad;this.t3=sd;this.td=yd;this.sTa=oc;this.qb=be}get CMa(){return this.TCk}get Lic(){return this.oB}yQm(){let d={};return{returnValue:({Tze:d}=this.R7.FLi(OSF.DDA.Marshaling.CoercionTypeKeys.Table)).returnValue,NVo:d}}uQm(){let d={};return{returnValue:({Tze:d}=this.R7.FLi(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)).returnValue,HVo:d.rows}}mKf(d,n){const B={};return n.$n?this.rq.VCa(d,n):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,YM:B}}sZm(d,
n,B,Q){const ha=[];if(!this.rq)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;d=this.rq.r5c(d,Q,ha);if(d===OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;if(d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return d;d=ha[0];Q=d.node;if(!bf.ParagraphReader.lc(Q))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;const Aa=this.td.Ag(Q);if(!Aa.Ib(23))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(!Vd.a.rKa(Aa.origin)){const bb=new Mc.GraphTransaction(7);bb.Eb(Aa.origin);Vd.a.q2b(Aa.origin);bb.dispose()}B=Q.ug(B.Lc).htmlElement;if(!B)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;B.scrollIntoView();n===OSF.DDA.Marshaling.SelectionMode.Selected?(n=new Ph.Selection(ha,!0),this.ub.Uc(n)):(n=d.cpBegin,d.contextId===ed.a.paragraph?n=0:d.contextId===ed.a.od&&(n=bf.ParagraphReader.textLength(Q)),n=Di.SelectionFactory.Ie(Q,n),this.ub.Uc(n));window.focus();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}inm(d){if(d.$n){var n=
vc.a.kb(this.kga.zna());for(n=Ie.a.Zr(n);n.moveNext();)bf.ParagraphReader.lc(n.currentNode);return this.rq.QJf(d)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e0h:[]}}d0k(d,n,B){const Q=this.Zc.Vc(15);Q.Eb(this.kga.zna());B===OSF.DDA.Marshaling.BindingType.Text.toString()?{YM:d,returnValue:n}=this.pqg(d,n,pj.text):B===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{YM:d,returnValue:n}=this.pqg(d,n,pj.eYb):B===OSF.DDA.Marshaling.BindingType.Table.toString()?{YM:d,returnValue:n}=
this.pqg(d,n,pj.table):(d=null,n=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);Q.dispose();return{returnValue:n,YM:d}}c0k(d,n,B,Q){const ha=this.Zc.Vc(15);ha.Eb(this.kga.zna());Q===OSF.DDA.Marshaling.BindingType.Text.toString()?{YM:d,returnValue:n}=this.oqg(d,n,pj.text,B):Q===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{YM:d,returnValue:n}=this.oqg(d,n,pj.eYb,B):Q===OSF.DDA.Marshaling.BindingType.Table.toString()?{YM:d,returnValue:n}=this.oqg(d,n,pj.table,B):(d=null,n=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);
ha.dispose();return{returnValue:n,YM:d}}oKf(d,n){return this.rq.oKf(d,n)}spm(d,n,B){return this.rq.Wyi(d,n,!0,B)}ppm(d,n,B){let Q;return{returnValue:({Z4j:Q}=this.rq.Wyi(d,n,!1,B)).returnValue,KRn:Q.rows}}opm(d,n){return this.rq.npm(d,n)}rCg(d,n,B){const Q=this.Zc.Vc(15);Q.Eb(this.kga.zna());d=this.rq.rCg(d,n,B);Q.dispose();return d}rpm(d,n,B){const Q=[];d=this.rq.r5c(n,d,Q);d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?B(d,null):0>=Q.length?B(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
null):this.XIa.getOoxml(Q,ha=>{B(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha)},ha=>{const Aa=this.Hme(ha);this.Qle(ha,3);B(Aa,null)})}uZo(d,n,B,Q,ha){const Aa=B.TableHeaders;B=B.TableRows;if(Aa&&Aa.length||B&&B.length){var bb=this.Zc.Vc(15);bb.Eb(this.kga.zna());this.rq.tSj(d,n,!0,Aa,B,Q,ha);bb.dispose()}else ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"table")}sZo(d,n,B,Q,ha){if(B&&B.length){var Aa=this.Zc.Vc(15);Aa.Eb(this.kga.zna());this.rq.tSj(d,n,!1,null,B,Q,ha);
Aa.dispose()}else ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"matrix")}VEo(d,n,B){return n.$n?(B(this.Lpo(d,n)),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}hzf(d,n,B){if(n.$n){const Q=this.Zc.Vc(15);Q.Eb(this.kga.zna());this.rq.hzf(d,n,B);Q.dispose()}else B(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}zif(d,n,B,Q){if(B&&B.length)if(n.$n){const ha=this.Zc.Vc(15);ha.Eb(this.kga.zna());this.rq.zif(d,n,B,Q);ha.dispose()}else Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}Chf(d,n,B,Q,ha,Aa){if(B&&B.length||Q&&Q.length)if(n.$n){const bb=this.Zc.Vc(15);bb.Eb(this.kga.zna());this.rq.Chf(d,n,B,Q,ha,Aa);bb.dispose()}else Aa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else Aa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}Qle(d,n){switch(n){case 0:Ue(d)?F.ULS.sendTraceTag(8159503,341,50,"SetSelectedOoxml failed with error code: {0}",d):F.ULS.sendTraceTag(7611806,341,10,"SetSelectedOoxml failed with error code: {0}",
d);break;case 1:Ue(d)?F.ULS.sendTraceTag(8159504,341,50,"GetSelectedOoxml failed with error code: {0}",d):F.ULS.sendTraceTag(7151686,341,10,"GetSelectedOoxml failed with error code: {0}",d);break;case 2:Ue(d)?F.ULS.sendTraceTag(17385219,341,50,"SetBindingOoxml failed with error code: {0}",d):F.ULS.sendTraceTag(17385220,341,10,"SetBindingOoxml failed with error code: {0}",d);break;case 3:Ue(d)?F.ULS.sendTraceTag(17331611,341,50,"GetBindingOoxml failed with error code: {0}",d):F.ULS.sendTraceTag(17331612,
341,10,"GetBindingOoxml failed with error code: {0}",d)}}vQm(d){this.u6a.qIi(this.ub.ob,n=>{d(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,n)},n=>{const B=this.Hme(n);this.Qle(n,1);d(B,null)})}pQm(){let d="";const n=this.ub.ob.currentSelection;return 1<this.ub.ob.length||!n||!n.length?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,JQj:d}:{returnValue:({UYa:d}=this.sTa.mMf(n.toArray(),n.ig)).returnValue,JQj:d}}q5o(d,n){const B=this.ub.ob.currentSelection;!d||1<this.ub.ob.length||
!B||!B.length||this.sTa.OAe(B.toArray(),B.ig,d,Q=>{n&&n(Q)})}t5o(d,n){const B=this.tPf(this.ub.ob.K(0).Ya.node);this.u6a.NUj(this.ub.ob,d,0,0,0,null,Q=>{var ha=this.u6a.ymc(Q,this.qb.ox(B,!0,!0));ha.count||(ha=this.u6a.ymc(Q,this.eLm()));if(ha.count){var Aa=[];for(let bb=0;bb<ha.count;bb++)Q=new Ph.Selection([ha.K(bb)],!0),Aa.push(Q);ha=new ic.SelectionCollection(Aa,0);this.ub.$W(ha);n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else F.ULS.sendTraceTag(19994848,341,10,"AppId:{0}, Can't find the inserted ooxml when invoking SetSelectedOoxml"),
n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},Q=>{const ha=this.Hme(Q);this.Qle(Q,0);n(ha)})}rZo(d,n,B,Q){let ha=null,Aa=({Dnf:ha}=this.rq.xyi(n,d)).returnValue;if(Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Q(Aa);else if(ha.EQ!==pj.text)Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else if(this.rq.bzn(ha)){var bb=[];Aa=this.rq.r5c(n,d,bb);if(Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Q(Aa);else if(0>=bb.length)Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else{var Ib=null;if(!this.rq.Wge&&({graphNode:Ib,returnValue:Aa}=this.rq.vil(ha),Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){Q(Aa);return}var oc=this.Zc.Vc(15);oc.Eb(this.kga.zna());if(!this.rq.Wge&&(this.rq.m0f=!1,Aa=this.rq.IFa(ha),this.rq.m0f=!0,Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){Q(Aa);return}d=(Ac,ad)=>{if(!this.rq.Wge){if(Ac!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){let sd=!0;for(const wd of bb)if(!wd.isValid){sd=!1;break}sd&&(ad=new Ph.Selection(bb,!0))}ad&&
(ad=this.rq.Fzo(ad,Ib),Ac===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Ac=ad))}oc.dispose();Q(Ac)};Aa=this.sTa.OAe(bb,!0,B,d);Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&d(Aa,null)}}else Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType)}v5o(d,n){let B=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders];d=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];B&&B.length||d&&d.length?B&&1<B.length?(F.ULS.sendTraceTag(8458368,344,15,"SetSelectedTable failed for app want to add multi-row header table"),
n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)):(B=B[0],this.R7.vVj(B,d,n)):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}s5o(d,n){d&&d.length?this.R7.vVj(null,d,n):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}tZo(d,n,B,Q){let ha=null,Aa=({Dnf:ha}=this.rq.xyi(n,d)).returnValue;if(Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Q(Aa);else if(ha.EQ!==pj.text)Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else{var bb=
[];Aa=this.rq.r5c(n,d,bb);Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Q(Aa):0>=bb.length?Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(d=this.rq.TXa(ha.GS),this.XIa.xBe(bb,B,d,4,0,null,()=>{Q(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},Ib=>{const oc=this.Hme(Ib);this.Qle(Ib,2);Q(oc)}))}}tPf(d){const n=new vc.a;n.set(d);d=null;n.Ib(10)&&(d=n.Gq(10));return d}eLm(){const d=this.kga.jKm();return this.qb.ox(d,!0,!0)}Lpo(d,n){let B=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
const Q=this.Zc.Vc(15);Q.Eb(this.kga.zna());B=this.rq.lHj(d,n,()=>{this.rq.JFo(n,d);this.rq.IFo(n,d)});Q.dispose();return B}pqg(d,n,B){if(!n||""===n)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,YM:null};if((B===pj.eYb||B===pj.table)&&!this.R7.Gyn())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,YM:null};let Q,ha=({yy:Q}=this.rq.GOl()).returnValue;if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,YM:null};
B=new $c(n,B,this.rq.nKf(Q));ha=this.rq.$Rh(d,B);return ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:ha,YM:null}:this.rq.VCa(n,d)}oqg(d,n,B,Q){if(!n||""===n)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,YM:null};let ha=({yy:Q}=this.rq.Btm(Q)).returnValue;if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,YM:null};if(B!==pj.text){let Aa,bb;({p2j:Aa,Xoi:bb,returnValue:ha}=this.rq.Itm(Q));if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,
YM:null};if(!this.R7.isTable(Aa,bb))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType,YM:null}}B=new $c(n,B,this.rq.nKf(Q));ha=this.rq.$Rh(d,B);return ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:ha,YM:null}:this.rq.VCa(n,d)}Hme(d){switch(d){case 1:return OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;case 7:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat;default:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}j$l(d,
n,B,Q=null,ha=null){F.ULS.sendTraceTag(18354818,369,50,"A Word Rich API batch execution is requested.");const Aa=this.kga.zna(),bb=this.t3.create(),Ib=!!(d[6]&1);bb.context.vo.ex(Aa);bb.context.appId=n;bb.context.controlId=Q;bb.context.jsc=Ib;bb.context.xk=ha;Q=new ek(bb.context,n,Q);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Q,ls,bb,d).then(oc=>{bb.context.vo.qH();if(!oc)return F.ULS.sendTraceTag(9204820,344,10,"The rich api executor call failed."),B(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),
null;B(oc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{F.ULS.sendTraceTag(35733829,369,10,"A Word Rich API batch execution was failed, AppId:{0}",n);bb.context.vo.qH();B(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})}wxp(){let d;return Nf.a.BYc?(d=Nf.a.BYc,{returnValue:!0,url:d}):{returnValue:!1,url:null}}k$l(d,n,B,Q,ha){this.j$l(d,n,ha,B,Q)}saveSettings(d,n){return this.kga.ePj(d,n)}ydb(d){return this.kga.Atg(d)}}Object(D.a)(Wm,"WordEditorApiObjectModel",
Ud,[1068,1069]);class Fs{static mHe(d,...n){for(let B=0;B<n.length;B++){if(!d||!d.hasOwnProperty(n[B]))return d=null,{returnValue:!1,value:d};d=d[n[B]]}return{returnValue:!0,value:d}}}Object(D.a)(Fs,"AppsForOfficeCommonUtils",null,[]);class Gq{constructor(d,n){this.J5e=null;this.vdf=d;this.za=n}cVm(d){return Gq.Qxn(d)?this.Mbo:null}get Mbo(){if(!this.J5e){const d=[];d.push(this.vdf.createIncompleteRequestThrottle(this.za.sc("WordEditorAppsForOfficeSelectionOoxmlMaxIncompleteRequests",1),this.za.sc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",
3E4)));d.push(this.vdf.createTokenBucketThrottle(this.za.sc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketCapacity",3),this.za.sc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketFillingIntervalMilliSec",2E3)));this.J5e=this.vdf.createChainedThrottle(d)}return this.J5e}static Qxn(d){const n=d.DdaMethod.DispatchId;let B=null,Q=n===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod&&({value:B}=Fs.mHe(d,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue;
return Q=(Q=(Q=(Q=Q||n===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod&&({value:B}=Fs.mHe(d,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)||n===OSF.DDA.MethodDispId.dispidGetBindingDataMethod&&({value:B}=Fs.mHe(d,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue)||n===OSF.DDA.MethodDispId.dispidSetBindingDataMethod&&({value:B}=Fs.mHe(d,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)&&
!!B&&B===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml}}Object(D.a)(Gq,"WordEditorApiThrottleStore",null,[1067]);class Hq{constructor(d,n,B,Q,ha){this.Vea=d;this.Zzd=B;this.g3=ha}get Mfc(){return this.g3}initialize(){this.Vea.initialize();this.Mfc.mc()}dispose(){this.Vea&&(this.Vea.dispose(),this.Vea=null);this.Mfc&&(this.Mfc.dispose(),this.g3=null)}}Object(D.a)(Hq,"AppsForOfficeIntegrationManager",null,[11]);class rj extends Hq{constructor(d,n,B,Q,ha,Aa,bb,Ib){super(d,n,B,Q,ha);this.Dg=null;this.xtk=
Ib;this.rq=Aa}initialize(){super.initialize();this.xtk.mc();this.rq&&this.rq.UAo()}}Object(D.a)(rj,"WordEditorAppsForOfficeIntegrationManager",Hq,[]);var om=e(1261),Iq=e(590),Zh=e(550),$m=e(33),to=e(1154),Ip=e(1106);class Km{create(){return new Ip.a}}Object(D.a)(Km,"AppBindingNodeFactory",null,[265]);class Cn{constructor(d,n,B,Q,ha,Aa,bb){this.Zc=n;this.aAd=B;this.qaf=Q;this.nI=d;this.Lsk=ha;this.ga=Aa;Cn.Jd=bb}initialize(){}zna(){const d=vc.a.kb(Bf.a.Xm.tb.rd);this.nI.bU(d);return d.currentNode}jKm(){const d=
this.zna(),n=new vc.a;n.set(d);return this.nI.xPf(n.currentNode)}m8d(d){return this.Cyi(d,!1)}Cyi(d,n){let B=null;const Q=this.Usb();if(Q&&Q.ic(19)){do{var ha=Q.currentNode;if(!ha.getValue(Dd.a.$Vc)){const Aa=ha.getValue(Dd.a.PVa);ha=ha.id.toString();if(n&&Aa.toLowerCase()===d.toLowerCase()||ha===d){B=this.i_c(Q);break}}}while(Q.gg(19))}return B}n8d(d){return this.Cyi(d,!0)}Klc(d){if(d&&d.rK)return this.$Df(d),this.Klc(d.rK);const n=new ma.a;if(d&&d.qoa)for(d=this.WCa(d),d=Ie.a.Mp(d);d.moveNext();){const B=
d.currentNode;50===B.type&&n.add(new $c(B.getValue(Dd.a.yY),B.getValue(Dd.a.EQ),B.getValue(Dd.a.GS)))}return n}QJf(){const d=new ma.a;var n=this.Usb();for(n=Ie.a.Mp(n.currentNode);n.moveNext();){const B=n.currentNode;50===B.type&&d.add(new $c(B.getValue(Dd.a.yY),B.getValue(Dd.a.EQ),B.getValue(Dd.a.GS)))}return d}yyi(){const d=new ma.a,n=this.Usb();this.Kim(n,B=>{const Q=B.currentNode.id.toString();this.Jim(B,ha=>{d.add({["appInstanceId"]:Q,["appBindingData"]:new $c(ha.getValue(Dd.a.yY),ha.getValue(Dd.a.EQ),
ha.getValue(Dd.a.GS))})})});return d}Kim(d,n){if(d&&d.ic(19)){do n(d);while(d.Di(19))}}Jim(d,n){if(d&&d.ic(22)){do n(d.currentNode);while(d.Di(22))}}lvg(d,n){if(!d||!n)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(d.rK)return this.lvg(d.rK,n);if(d.qoa&&(d=this.WCa(d))){const B=vc.a.kb(d);let Q=B.ic(22);for(;Q;){if(Q.getValue(Dd.a.yY)===n)return B.qh(),d.setValue(xd.a.qW,new Date),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;Q=B.Di(22)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}VCa(d,
n){d=this.Klc(d);for(const B of d)if(B.yY===n)return B;return null}tom(d){const n=this.QJf(),B=new ma.a;for(const Q of n)Q.GS===d&&B.add(Q);return B}UXi(d,n){if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(d.rK)return this.$Df(d),this.UXi(d.rK,n);if(d.qoa){const B=this.WCa(d);if(!B)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.VCa(d,n.yY))return this.qCp(d,n);d=this.UJl(n);this.e0k(B,d)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Xxi(){const d=new ma.a,
n=this.Usb();if(n&&n.ic(19)){do{const B=this.i_c(n);B&&d.add(B)}while(n.gg(19))}return d}fvb(d){var n;if(d&&d.qoa&&!this.WCa(d)){const B=this.Nwf(d);this.uhf(B,d);if(null===(n=d.assetId)||void 0===n?0:n.toLowerCase().startsWith("wa"))d=this.AJl(d),this.P_k(B,d)}}ZYf(d,n,B,Q){if(G.AFrameworkApplication.J.$("ContentAppIsEnabled")){for(;d&&!Object(zk.a)(Zh.a,d);)d=d.Pk;d?this.Lrl(d)?(Q=Object.assign(new to.a,{id:Q.$n,version:Q.version,store:Q.store,storeType:Q.storeType,instanceId:String.format("{{{0}}}",
Ze.a.create()),isContent:!0}),d=this.Lsk.hgn(d,n,B,Q),Gg.a.A_f(d)&&this.Ufd(d)):this.ga.Zb(Z.a.c3b,2,{["ak1"]:WacWordeditorStrings.ContentAppError}):F.ULS.sendTraceTag(593876625,344,15,"Context is null")}}Ufd(d){d=vc.a.kb(d);d.Ib(12);d.xd(12);d.Jr.LV=!0}Lrl(d){d.contextId===ed.a.view&&d.view.Ee&&d.view.ub&&(d=d.view.ub.hh);return d?d.nm?!0:!1:(Cn.Jd.qc(om.a.$e,{["Reason"]:Iq.a.Mo}),!1)}gZo(d){const n=this.WCa(d);if(n){const B=this.Zc.Vc(15);B.Eb(n);n.setValue(Dd.a.Mob,d.cWc);n.setValue(xd.a.qW,new Date);
B.dispose()}}ZYo(d){const n=this.WCa(d);if(n){const B=this.Zc.Vc(4);B.Eb(n);n.setValue($m.a.inf,d.sharedRuntimeId);n.setValue($m.a.jnf,d.backgroundState);n.setValue(xd.a.qW,new Date);B.dispose()}}Atg(d){return d?d.rK?this.Atg(d.rK):d.qoa&&(d=this.WCa(d))?this.qaf.fKf(d):null:null}ePj(d,n){if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(d.rK)return this.$Df(d),this.ePj(d.rK,n);if(d.qoa&&(d=this.WCa(d))){const B=this.Zc.Vc(15);B.Eb(d);n=this.qaf.uSo(d,n);d.setValue(xd.a.qW,new Date);
B.dispose();return n}F.ULS.sendTraceTag(7143687,344,15,"App Node not found when trying to save settings");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}dispose(){}WCa(d){const n=this.Usb();if(n&&n.ic(19)){do if(this.i_c(n).nZh(d))return n.currentNode;while(n.gg(19))}return null}i_c(d){var n=d.currentNode;const B=this.qaf.fKf(n),Q=n.getValue(Dd.a.PVa),ha=n.getValue(Dd.a.bWc),Aa=n.getValue(Dd.a.Lob),bb=n.getValue(Dd.a.$Mb);let Ib;if(d.ic(20)){var oc=d.currentNode;Ib=oc.getValue(Dd.a.PVa);
oc=oc.getValue(Dd.a.Lob);d.Ac()}d=n.getValue(Dd.a.$Vc);const Ac=n.getValue(Dd.a.Mob),ad=n.ka($m.a.inf,null),sd=n.ka($m.a.jnf,0);n=n.id.toString();let wd=null;d||(wd=new Fb(n,n,Q,ha,Aa,bb,Ac,!0,ad,sd,Ib,oc),wd.settings=B);return wd}wcg(d){this.nI.bU(d);return d.ic(18)}Usb(){let d=null;const n=Bf.a.Xm.tb.rd;n&&(d=new vc.a,d.set(n),this.wcg(d)||(d=null));return d}Nwf(d){const n=this.aAd.create(Fc.a.mKa);n.setValue(Dd.a.PVa,d.$n);n.setValue(Dd.a.$Mb,d.storeType);n.setValue(Dd.a.bWc,d.version);n.setValue(Dd.a.Lob,
d.store);n.setValue(Dd.a.Mob,d.cWc);n.setValue(Dd.a.$Vc,!1);n.setValue(Dd.a.YWh,!1);n.setValue(Dd.a.dXh,"");n.setValue(Dd.a.iXh,"right");n.setValue(Dd.a.lXh,350);n.setValue(Dd.a.kXh,1);n.setValue(Dd.a.jXh,!1);return n}AJl(d){const n=this.aAd.create(Fc.a.Bfc);n.setValue(Dd.a.PVa,d.assetId);n.setValue(Dd.a.bWc,d.version);n.setValue(Dd.a.Lob,d.assetStoreId);n.setValue(Dd.a.$Mb,"omex");return n}P_k(d,n){n&&vc.a.kb(d).pg(n,20)}qpm(d,n){if((d=vc.a.kb(d))&&d.ic(22)){do{const B=d.currentNode,Q=B.getValue(Dd.a.yY);
if(n===Q)return B}while(d.gg(22))}return null}UJl(d){const n=(new Km).create(Fc.a.xfc);n.setValue(Dd.a.yY,d.yY);n.setValue(Dd.a.EQ,d.EQ);n.setValue(Dd.a.GS,d.GS);return n}qCp(d,n){d=this.WCa(d);if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const B=this.qpm(d,n.yY);if(!B)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;B.setValue(Dd.a.EQ,n.EQ);B.setValue(Dd.a.GS,n.GS);d.setValue(xd.a.qW,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}e0k(d,n){vc.a.kb(d).pg(n,
22);d.setValue(xd.a.qW,new Date)}uhf(d,n){const B=this.Usb();B&&!d.anchor&&(n=Jh.a.Of(n.cXh),Ze.a.compare(n.gv,Ze.a.nil)&&(F.ULS.sendTraceTag(20796771,344,15,"Instance id is not a extended guid. Create a new extended guid for app node."),n=new Jh.a(Ze.a.create(),1)),B.a8(d,19,n))}$Df(d){this.fvb(d.rK)}}Cn.Jd=null;Object(D.a)(Cn,"WordEditorAppsForOfficeModel",null,[1066,11]);var mn;(function(d){d[d.Kmq=0]="notRegistered";d[d.Eqq=1]="queryStarted";d[d.hrq=2]="registrationFailed";d[d.grq=3]="registered"})(mn||
(mn={}));Object(D.b)("CommandRegistrationStatus",mn);var Mo;(function(d){d[d.OK=0]="OK";d[d.Jmq=1]="notReady";d[d.xwq=2]="storeDisabled";d[d.qdq=3]="invokeFailure";d[d.kuq=4]="serviceDisabled";d[d.y1p=5]="builtinAddinDetails"})(Mo||(Mo={}));Object(D.b)("AddinDetailsQueryError",Mo);class rq{constructor(){this.addInDetails=this.title=null}}Object(D.a)(rq,"AddInCategoryData",null,[]);class er{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(D.a)(er,
"AddInDetailData",null,[]);class Dn{constructor(){this.href=this.text=null}}Object(D.a)(Dn,"AddInLinkData",null,[]);class Qh{constructor(d,n,B){this.RRa=0;this.Sph=!1;this.TSc=[];this.za=d;this.QRa=n;this.u7e=B;F.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}MOa(d,n){d&&n&&this.zap(n)&&this.rzj()}zap(d){0===d.wV&&(this.RRa|=1);1===d.wV&&(this.RRa|=2);2===d.wV&&(this.RRa|=4);return!!this.RRa}rzj(){const d=[];let n=null;const B={},Q=this.Nwn,ha=this.zWn;var Aa=this.QRa.$Y(0);
const bb=this.QRa.$Y(1),Ib=this.QRa.$Y(2);(2===Aa.errorCode||this.z3b&&2===Ib.errorCode)&&!ha.length?(n={ariaDescription:CommonUIStrings.l_AddinPickerDisableError,iconName:"StoreDisabled",label:CommonUIStrings.l_AddinPickerDisableError,title:CommonUIStrings.l_AddInBackstageErrorViewTitle},d.push("storeDisabled")):3===Aa.errorCode&&3===bb.errorCode?(n={ariaDescription:CommonUIStrings.l_AddinPickerGeneralError,iconName:"Common",label:CommonUIStrings.l_AddinPickerGeneralError,title:CommonUIStrings.l_AddInBackstageErrorViewTitle},
d.push("invokeFailure")):4!==Aa.errorCode||ha.length?!this.X5i&&(!this.poa||0!==Ib.errorCode&&5!==Ib.errorCode)||Ib.ED.length||(F.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.RRa,Ib.errorCode),d.push(`emptyCategory:${Ib.errorCode}`)):(n={ariaDescription:CommonUIStrings.l_AddinPickerServiceDisconnectedError,iconName:"StoreDisabled",label:CommonUIStrings.l_AddinPickerServiceDisconnectedError,title:CommonUIStrings.l_AddInBackstageErrorViewTitle},
d.push("serviceDisabled"));this.A4b&&this.kej("Backstage",ha.length,Aa,bb,Ib);Aa=!n;!Aa||Q||ha.length?(Aa?(B.mruAddIns=ha,Q&&(B.categories=this.kko)):B.errorViewProps=n,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(B,Aa)),Q&&Aa&&!this.Sph&&(this.Sph=!0,F.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.RRa))):d.push("emptyPage");this.A4b&&F.ULS.sendTraceTag(508047441,220,15,`${d.join("|")}`)}kej(d,n,B,Q,ha){d={["Source"]:d,["MRUListNumber"]:n.toString(),
["MyAddinsErrorCode"]:Mo[B.errorCode],["MyAddInsResult"]:B.ED.length.toString(),["MyAddinsInvokeResultCode"]:B.fk?B.fk.invokeResultCode:"N/A",["AdminManagedErrorCode"]:Mo[Q.errorCode],["AdminManagedResult"]:Q.ED.length.toString(),["AdminManageInvokeResultCode"]:Q.fk?Q.fk.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:this.z3b?Mo[ha.errorCode]:"undefined",["PopularAddinsResult"]:ha.ED.length.toString(),["PopularAddinsInvokeResultCode"]:ha.fk?ha.fk.invokeResultCode:"N/A"};cg.a.sendTelemetryEvent(Object.assign(new $h.a,
{name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:zf.a.iG(d)}))}get X5i(){return!!(this.RRa&4)}get A4b(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get Nwn(){const d=this.QRa.$Y(2);return(this.X5i||this.poa||this.A4b)&&(0===d.errorCode||5===d.errorCode)&&!!d.ED.length}get kko(){var d=this.Bvm();0<d.length&&(this.u7e=d);if(Ic.c(this.u7e))return[];var n=JSON.parse(this.u7e);d=[];for(var B of n)n=Object.assign(new rq,
{title:B.title,addInDetails:[]}),this.kml(n,B.solutionIds),0<n.addInDetails.length&&Array.add(d,n);0<this.TSc.length&&(B=this.QRa.$Y(2),F.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.TSc.length,this.TSc,B.ED.length),this.TSc=[]);return d}get zWn(){var d=[],n=this.QRa.$Y(0);Array.addRange(d,n.ED);n=this.QRa.$Y(1);Array.addRange(d,n.ED);d.sort((B,Q)=>{B=Cb.d(B.displayName);Q=Cb.d(Q.displayName);return Ca.a.localeCompare(B,Q)});n=[];for(const B of d)d=
Object.assign(new er,{description:B.description,displayName:B.displayName,solutionId:B.solutionId,uniqueId:this.v4c(B)}),Array.add(n,d);return n}kml(d,n){const B=this.AWn;let Q=0;for(const ha of n){if(4===Q)break;if(B.contains(ha))continue;n=this.QRa.PXa(ha);if(!n){this.TSc.push(ha);continue}const Aa=Object.assign(new er,{description:n.description,displayName:n.displayName,solutionId:n.solutionId,uniqueId:this.v4c(n)});Aa.links=[Object.assign(new Dn,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+
n.solutionId})];Array.add(d.addInDetails,Aa);++Q}}get AWn(){const d=[];var n=this.QRa.$Y(0);Array.addRange(d,n.ED);n=this.QRa.$Y(1);Array.addRange(d,n.ED);n=new Xb.a(ja.a.Oh());for(const B of d)n.add(B.solutionId);return n}v4c(d){return this.poa?String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}get poa(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}Bvm(){return this.za?this.za.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get z3b(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}}Object(D.a)(Qh,"AddInCategoryManager",null,[]);var vn=e(530),$k;(function(d){d[d.Plq=0]="myAddins";d[d.G_p=1]="adminManaged";d[d.Opq=2]="popular"})($k||($k={}));Object(D.b)("AddinCollectionType",$k);class Jp{constructor(){this.releaseDate=this.diffAUP=this.AUP=this.priority=
0}}Object(D.a)(Jp,"AddinDetailInfo",null,[]);class hu{constructor(d){this.solutionIds=null;this.errorCode=0;this.fk=null;this.xga=d}}Object(D.a)(hu,"AddinCollection",null,[]);class cj extends Sys.EventArgs{constructor(d,n,B,Q=null){super();this.wV=d;this.errorCode=n;this.ED=B;this.fk=Q}}Object(D.a)(cj,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class og{constructor(d){this.errorCode=d;this.ED=[];this.fk=null}}Object(D.a)(og,"GetAddinDetailsResult",null,[]);class pm{}Object(D.a)(pm,"GetEntitlementDetailsParameters",
null,[]);var nl=e(119);class an{constructor(d,n,B=null){this.sa=new dc.a;this.EE=new vn.a(ja.a.Oh());this.Ot=new Eg.a;this.GX=0;this.JJb=null;this.Fyb=(Q,ha,Aa)=>{if(Aa)if(this.pfd(Q,Aa,window.performance.now()-ha),0===Aa.errorCode){let Ib;if(Aa.value){let oc=0;Ib=Array(Aa.value.length);Aa.value.forEach(Ac=>{Ib[oc++]=Ac})}else Ib=[];this.aM(Q,Ib)}else if(-1===Aa.errorCode||10===Aa.errorCode)this.aM(Q,[]);else{var bb={};bb.collectionType=$k[Q];bb.invokeResultCode=Aa.errorCode;bb["queryResult.Value"]=
Aa.value?String.format("Length: {0}",Aa.value.length):"null";bb.queryStart=ha;bb.queryDuration=window.performance.now()-ha;this.Ot.W(Q,Object.assign(new hu(Q),{errorCode:3,fk:Error.create("QueryAddinDetails hit an invocation failure",bb)}));F.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",$k[Q],this.Ot.K(Q).fk.toString(),JSON.stringify(this.Ot.K(Q).fk))}else bb={},bb.collectionType=$k[Q],bb.queryResult=
Aa?"not null":"null",bb.queryStart=ha,bb.queryDuration=window.performance.now()-ha,this.Ot.W(Q,Object.assign(new hu(Q),{errorCode:3,fk:Error.create("QueryAddinDetails hit an invocation failure",bb)})),F.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",$k[Q],this.Ot.K(Q).fk.toString(),JSON.stringify(this.Ot.K(Q).fk))};this.MOa=(Q,ha)=>{Q=Object.assign(new hu(ha.wV),{solutionIds:new ma.a});var Aa=ha.ED;
for(const bb of Aa)Aa=bb.solutionId,this.EE.Bb(Aa)?this.EE.W(Aa,this.xgd(this.EE.K(Aa),ha.wV,bb)):this.EE.add(Aa,bb),Q.solutionIds.add(Aa);this.Ot.W(ha.wV,Q)};this.usa=new Sb.a;this.usa.add(OSF.StoreTypeEnum.MarketPlace,0);this.usa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.za=d;this.Bk=n;this.yw=B;this.RLc=an.r6c(d,"https://store-images.s-microsoft.com");this.yob(this.MOa)}get rfd(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get pbd(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get nt(){return this.Bk.value}$Y(d){if(!this.HNa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:$k[d]}),Object.assign(new og(1),{fk:d});if(this.Ot.K(d).fk)return Object.assign(new og(this.Ot.K(d).errorCode),{fk:this.Ot.K(d).fk});F.ULS.shipAssertTag(509870082,220,!!this.Ot.K(d).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const n=new og(0);for(const B of this.Ot.K(d).solutionIds)this.EE.Bb(B)&&
Array.add(n.ED,this.EE.K(B));return n}PXa(d){return this.EE.Bb(d)?this.EE.K(d):null}HFa(d){if(d){this.yob(d);for(const B of this.Ot.keys)if(this.HNa(B)&&!this.Ot.K(B).fk){F.ULS.shipAssertTag(509870081,220,!!this.Ot.K(B).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",B);var n=[];for(const Q of this.Ot.K(B).solutionIds)Array.add(n,this.EE.K(Q));n=new cj(B,this.Ot.K(B).errorCode,n);d(null,n)}}}get name(){return"AddinDetailsManager"}C0b(){}lU(d,n=!1){0!==
d&&10!==d?F.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Wf[d]):this.Pld(d,this.Fyb,n)}yob(d){this.sa.addHandler(gf.a.kfc,d)}dVf(d){const n={};n.collectionType=$k[d];this.Ot.W(d,Object.assign(new hu(d),{errorCode:2,fk:Error.create("The store is disabled.",n)}));F.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",$k[d],this.Ot.K(d).fk.toString(),JSON.stringify(this.Ot.K(d).fk))}SFg(){return this.HNa(2)?
this.za.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Ot.K(2).fk:!1:!0}Pld(d,n,B=!1){F.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog?F.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d):(this.SFg()&&this.queryStoreDisabled(0,(Q,ha)=>{ha?this.dVf(2):(Q=window.performance.now(),n(2,Q,this.uMm()))}),this.queryStoreDisabled(d,(Q,ha)=>{if(Q===OSF.StoreTypeEnum.MarketPlace&&
ha)this.dVf(0);else if(Q===OSF.StoreTypeEnum.PrivateCatalog&&ha)this.dVf(1);else{var Aa=window.performance.now();this.nt.getEntitlementDetails(Object.assign(new pm,{storeType:Q,refresh:B}),bb=>{n(this.usa.K(Q),Aa,bb)})}}))}aM(d,n){d=new cj(d,0,n);this.sa.raiseEvent(gf.a.kfc,d)}HNa(d){return this.Ot.Bb(d)?!!this.EE:!1}get Nfc(){return this.yw?!this.yw.AreThirdPartyAddInsAllowed||this.yw.AppsForOfficeThirdPartyIsDisabled:!this.za.$("AreThirdPartyAddInsAllowed")||this.za.$("AppsForOfficeThirdPartyIsDisabled")}get Yqc(){return this.yw?
!this.yw.AppsForOfficeAllowExternalMarketplace:!this.za.$("AppsForOfficeAllowExternalMarketplace")}get gzb(){return this.yw?this.yw.PopularAddinDetailsJsonString:this.za.rb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,n){if(this.Nfc)n(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.Yqc)n(d,!0);else{const B=an.RCc(d);if(B){const Q=window.performance.now();this.nt.queryStoreDisabled(B,ha=>{F.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
d,ha,Q,window.performance.now()-Q);n(d,ha)})}else n(d,!1)}}xgd(d,n,B){return d?B?2===n?an.Cxb(B,d):an.Cxb(d,B):d:B}uMm(){if(!this.JJb){const d=JSON.parse(this.gzb);this.N3c(d);this.JJb=d}return an.ygc(0,this.JJb)}N3c(d){an.hWc(d);this.Ifc(d);this.O3c(d)}Ifc(d){const n=this.nXc();for(var B=0;B<d.length&&0<n.count;B++){const Q=d[B];if(n.Bb(Q.solutionId)){let ha=String.format("Found an override, solutionId: {0}",Q.solutionId);const Aa=n.K(Q.solutionId);Aa&&(isNaN(Aa.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
ha,Q.addinInfo.priority,Aa.addinInfo.priority),Q.addinInfo.priority=Aa.addinInfo.priority),isNaN(Aa.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,Q.addinInfo.AUP,Aa.addinInfo.AUP),Q.addinInfo.AUP=Aa.addinInfo.AUP),Aa.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,Q.displayName,Aa.displayName),Q.displayName=Aa.displayName),Aa.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,Q.iconUrl,Aa.iconUrl),Q.iconUrl=Aa.iconUrl),Aa.description&&
(ha=String.format("{0}; Description: update {1} to {2}",ha,Q.description,Aa.description),Q.description=Aa.description));n.remove(Q.solutionId);this.pbd&&F.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ha)}}for(const Q of n.keys)B=n.K(Q),B.displayName&&B.iconUrl&&B.addinInfo&&(d.push(B),this.pbd&&F.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(B)))}nXc(){const d=new vn.a(ja.a.Oh());
let n=this.za.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return d;n=n.trim();if(12>=n.length)return 0<n.length&&F.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),d;this.pbd&&F.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const B=[],Q=n.split("|");for(let ha=Q.length-1;0<=ha;ha--){const Aa=Q[ha],bb=Aa.split("\\");if(2>bb.length){B.push(Aa);continue}const Ib=
an.dkd(bb);Ib?d.Bb(Ib.solutionId)||d.add(Ib.solutionId,Ib):B.push(Aa)}this.pbd&&0<B.length&&F.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",B.join("|"));this.pbd&&0<d.count&&F.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(nl.toArray(d.values)));return d}catch(B){F.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
n,B.toString())}return d}O3c(d){for(let n=0;n<d.length;n++)Cb.c(d[n].iconUrl.toLowerCase(),"http",0)||(d[n].iconUrl=String.format("{0}/image/apps.{1}",this.RLc,d[n].iconUrl))}qfd(d,n,B){const Q={};Q.AddinCollectionType=$k[d];Q.ErrorCode=n.errorCode;Q.AddinCount=n.value?n.value.length:0;d=window.performance.now();n=Date.now()-G.AFrameworkApplication.eH;F.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",
B,d,n,JSON.stringify(Q))}pfd(d,n,B){this.rfd?(B={["AddinCollectionType"]:$k[d],["ErrorCode"]:n.errorCode,["QueryDuration"]:B,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.eH},this.qbd(d)&&F.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(B)),B.AddinCount=n.value?n.value.length:0,F.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(B))):this.qfd(d,n,B)}qbd(d){0===d?this.GX|=1:1===d&&(this.GX|=2);d=this.GX&131;if(d=1===d||2===d)this.GX=255;return d}static ygc(d,
n){const B={};B.errorCode=d;B.value=n;return B}static RCc(d){return d===OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Cxb(d,n){n.solutionId=n.solutionId||d.solutionId;n.version=n.version||d.version;n.storeType=n.storeType||d.storeType;n.storeId=n.storeId||d.storeId;n.assetId=n.assetId||d.assetId;n.assetStoreId=n.assetStoreId||d.assetStoreId;n.displayName=n.displayName||d.displayName;n.provider=n.provider||d.provider;n.description=n.description||
d.description;n.iconUrl=n.iconUrl||d.iconUrl;n.webApplicationId=n.webApplicationId||d.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||d.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||d.licenseUrl;n.privacyUrl=n.privacyUrl||d.privacyUrl;n.addinInfo=n.addinInfo||d.addinInfo;isNaN(n.targetType)&&(n.targetType=d.targetType);isNaN(n.height)&&(n.height=d.height);isNaN(n.width)&&(n.width=d.width);return n}static hWc(d){for(const n of d)isNaN(n.targetType)&&(n.targetType=1),n.assetId=
n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static dkd(d){const n={};let B=0;B<d.length&&0<d[B].trim().length&&d[B].trim().toLowerCase().startsWith("wa")&&(n.solutionId=d[B].trim(),n.addinInfo=Object.assign(new Jp,{priority:Number.NaN,AUP:Number.NaN}),++B<d.length&&0<d[B].trim().length&&(n.addinInfo.priority=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&
(n.addinInfo.AUP=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&(n.displayName=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.iconUrl=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.description=d[B].trim()));return n.solutionId?n:null}static r6c(d,n){d=d.rb("AddinImageStoreServiceUrl");if(!d)return n;d=d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:n}}Object(D.a)(an,"AddinDetailsManager",null,[1925,1926]);class Zf{constructor(d,n=0){this.fk=null;this.xga=
d;this.errorCode=n}}Object(D.a)(Zf,"AddinQueryResult",null,[]);class Wj extends Zf{constructor(d,n=0){super(d,n);this.solutionIds=null}}Object(D.a)(Wj,"AddinCollection",Zf,[]);var Hg;(function(d){d[d.stop=-1]="stop";d[d.skip=0]="skip";d[d.query=1]="query"})(Hg||(Hg={}));Object(D.b)("QueryStrategy",Hg);class al{constructor(d){this.afh=432E5;d&&(this.afh=36E5*d.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",12))}uSm(d){const n=new Date;let B=new Date(-1);try{const Q=al.n9j(`${d}_ExpirationTime`);
Q&&(B=new Date(parseInt(Q,10)))}catch(Q){F.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${d}: ${Q}`)}if(n.getTime()<B.getTime()&&(d=al.n9j(`${d}_StoreDisabled`)))return"true"===d}$5o(d,n){void 0!==n&&null!==n&&(al.c$j(n.toString(),`${d}_StoreDisabled`),al.c$j(((new Date).getTime()+this.afh).toString(),`${d}_ExpirationTime`))}static n9j(d){let n=null;try{const B=al.Mud;if(void 0!==B&&B){const Q=gf.a.Glc("Flyout")+"_"+d;n=B.getItem(Q)}else F.ULS.sendTraceTag(508063828,
220,50,"tryGetCache: Storage.Local null")}catch(B){F.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",d)}return n}static c$j(d,n){try{const B=al.Mud;if(void 0!==B&&B){const Q=gf.a.Glc("Flyout")+"_"+n;B.setItem(Q,d)}else F.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(B){F.ULS.sendTraceTag(508063825,220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",n)}}static get Mud(){if(!al.FDa)return null;
let d=null;try{d=localStorage}catch(n){al.FDa=!1,d=null,F.ULS.sendTraceTag(508063824,220,10,`Failed to use localStorage: error name: ${n.name}; message: ${n.message}; stack: ${n.stack}`)}return d}}al.FDa=!0;Object(D.a)(al,"StoreDisabledCache",null,[]);class yj{constructor(d,n,B=null){var Q;this.sa=new dc.a;this.EE=new vn.a(ja.a.Oh());this.Ot=new Eg.a;this.GX=0;this.Ofa=new Eg.a;this.JJb=null;this.Fyb=(ha,Aa,bb)=>{if(bb)if(this.pfd(ha,bb,window.performance.now()-Aa),0===bb.errorCode){let Ib;if(bb.value){let oc=
0;Ib=Array(bb.value.length);bb.value.forEach(Ac=>{Ib[oc++]=Ac})}else Ib=[];this.aM(new Zf(ha),Ib)}else-1===bb.errorCode||10===bb.errorCode?this.aM(new Zf(ha),[]):(ha=this.rpf(ha,Aa,bb),this.aM(ha));else ha=yj.spf(ha,Aa),this.aM(ha)};this.MOa=(ha,Aa)=>{if(0!==Aa.errorCode)this.Ot.W(Aa.wV,Object.assign(new Wj(Aa.wV,Aa.errorCode),{fk:Aa.fk})),this.aVn&&this.GFa(Aa.wV,1);else{ha=Object.assign(new Wj(Aa.wV),{solutionIds:new ma.a});var bb=Aa.ED;for(const Ib of bb)bb=Ib.solutionId,this.EE.Bb(bb)?this.EE.W(bb,
this.xgd(this.EE.K(bb),Aa.wV,Ib)):this.EE.add(bb,Ib),ha.solutionIds.add(bb);this.Ot.W(Aa.wV,ha);this.GFa(ha.xga,1)}};this.usa=new Sb.a;this.usa.add(OSF.StoreTypeEnum.MarketPlace,0);this.usa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.za=d;this.Bk=n;this.yw=B;this.RLc=yj.r6c(d,"https://store-images.s-microsoft.com");this.yob(this.MOa);this.PLh=null!==(Q=B.StoreDisabledCache)&&void 0!==Q?Q:new al(d)}get aVn(){return!!this.za&&this.za.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get qT(){return!!this.za&&
this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get rfd(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get JHg(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get Xlp(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.za&&this.za.$("IsAnonymousUser")}get AHf(){return!!this.za&&
this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get clc(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get nMa(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get nt(){return this.Bk.value}$Y(d){if(this.qT&&!this.kcb(d))return new og(0);if(!this.HNa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:$k[d]}),
Object.assign(new og(1),{fk:d});if(this.Ot.K(d).fk)return Object.assign(new og(this.Ot.K(d).errorCode),{fk:this.Ot.K(d).fk});F.ULS.shipAssertTag(509870082,220,!!this.Ot.K(d).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const n=new og(0);for(const B of this.Ot.K(d).solutionIds)this.EE.Bb(B)&&Array.add(n.ED,this.EE.K(B));return n}PXa(d){return this.EE.Bb(d)?this.EE.K(d):null}HFa(d){if(d){this.yob(d);for(const n of this.Ot.keys){if(this.qT&&!this.kcb(n))continue;
if(!this.HNa(n)||this.Ot.K(n).fk)continue;F.ULS.shipAssertTag(509870081,220,!!this.Ot.K(n).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",n);const B=[],Q=this.Ot.K(n);for(const ha of Q.solutionIds)Array.add(B,this.EE.K(ha));d(null,new cj(n,Q.errorCode,B,Q.fk))}}}get name(){return"AddinDetailsManager1"}C0b(d,n){if(this.qT&&yj.zwb(d)){var B=ha=>{this.aM(yj.TNb(ha,4,"The connected service is disabled."));this.GFa(ha,-1)},Q=ha=>{this.aM(yj.TNb(ha,0,
"The user doesn't have any addin installed."),[]);this.GFa(ha,0)};0===d?(this.w$c(0,n,B,Q),this.w$c(2,n,B,()=>{this.X_b(this.Fyb)})):10===d&&this.GFa(1,1)}}lU(d,n=!1){yj.zwb(d)?this.Pld(d,this.Fyb,n):F.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Wf[d])}yob(d){this.sa.addHandler(gf.a.kfc,d)}w$c(d,n,B,Q){this.kcb(d)||(3===n&&B?B(d):2===n&&Q?Q(d):this.GFa(d,1))}kcb(d){return this.Ofa.Bb(d)}GFa(d,n){if(this.qT){var B=this.kcb(d);if(!B||-1!==this.Ofa.K(d)&&this.Ofa.K(d)!==
n)F.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",$k[d],B?Hg[this.Ofa.K(d)]:"undefined",Hg[n]),this.Ofa.W(d,n)}}rpf(d,n,B){const Q={};Q.collectionType=$k[d];Q.invokeResultCode=B.errorCode;Q["queryResult.Value"]=B.value?String.format("Length: {0}",B.value.length):"null";Q.queryStart=n;Q.queryDuration=window.performance.now()-n;return Object.assign(new Zf(d,3),{fk:Error.create("QueryAddinDetails hit an invocation failure",Q)})}Cap(){return this.HNa(2)?
this.za.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.Ot.K(2).errorCode:!1:!0}vAc(d){return this.qT&&this.Ofa.Bb(d)?1===this.Ofa.K(d):!0}Pld(d,n,B=!1){F.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);if(d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog)F.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d);else{var Q=this.usa.K(d);(!this.JHg||this.clc&&this.isAnonymousUser)&&d===OSF.StoreTypeEnum.MarketPlace&&
this.vAc(2)&&this.X_b(n);this.vAc(Q)&&(this.clc&&this.isAnonymousUser?(d=yj.hpf(Q),this.aM(d)):this.yrg(d,n,B))}}yrg(d,n,B){this.jDj(d,(Q,ha)=>{if(Q===OSF.StoreTypeEnum.MarketPlace&&ha)ha=yj.spb(0),this.aM(ha),this.JHg&&this.aM(yj.spb(2));else if(Q===OSF.StoreTypeEnum.PrivateCatalog&&ha)ha=yj.spb(1),this.aM(ha);else{this.JHg&&Q===OSF.StoreTypeEnum.MarketPlace&&this.vAc(2)&&n(2,window.performance.now(),this.XMj());var Aa=window.performance.now();this.nt.getEntitlementDetails(Object.assign(new pm,{storeType:Q,
refresh:B}),bb=>{n(this.usa.K(Q),Aa,bb)})}})}X_b(d){this.Cap()&&this.jDj(0,(n,B)=>{B?(n=yj.spb(2),this.aM(n)):(n=window.performance.now(),d(2,n,this.XMj()))})}aM(d,n=null){0!==d.errorCode?(F.ULS.shipAssertTag(509116673,220,!n,"The parameter addinDetails must be null for any failed queries"),F.ULS.shipAssertTag(509116672,220,!!d.fk,"The result.Failure must not be available for any failed queries"),this.KFg(d)?F.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",$k[d.xga],Mo[d.errorCode],d.fk?d.fk.toString():"null",JSON.stringify(d.fk)):F.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",$k[d.xga],Mo[d.errorCode],d.fk?d.fk.toString():"null",JSON.stringify(d.fk))):(F.ULS.shipAssertTag(509116643,220,!!n,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",$k[d.xga]),F.ULS.sendTraceTag(509116642,220,
50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",$k[d.xga],n?n.length:-1));d=new cj(d.xga,d.errorCode,n,d.fk);this.sa.raiseEvent(gf.a.kfc,d)}KFg(d){return 3===d.errorCode&&(this.clc&&-2147208619===yj.v6c(d)||this.AHf&&-2===yj.v6c(d))||4===d.errorCode?!1:2!==d.errorCode}HNa(d){return this.Ot.Bb(d)?!!this.EE:!1}get Nfc(){return this.yw?!this.yw.AreThirdPartyAddInsAllowed||this.yw.AppsForOfficeThirdPartyIsDisabled:!this.za.$("AreThirdPartyAddInsAllowed")||this.za.$("AppsForOfficeThirdPartyIsDisabled")}get Yqc(){return this.yw?
!this.yw.AppsForOfficeAllowExternalMarketplace:!this.za.$("AppsForOfficeAllowExternalMarketplace")}get gzb(){return this.yw?this.yw.PopularAddinDetailsJsonString:this.za.rb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,n){if(this.Nfc)n(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.Yqc)n(d,!0);else{const B=yj.RCc(d);if(B){const Q=window.performance.now();this.nt.queryStoreDisabled(B,ha=>{F.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
d,ha,Q,window.performance.now()-Q);n(d,ha)})}else n(d,!1)}}jDj(d,n){if(this.Xlp)if(this.Nfc)n(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.Yqc)n(d,!0);else{const B=yj.RCc(d),Q=this.PLh.uSm(d);if(void 0===Q)if(B){const ha=window.performance.now();this.nt.queryStoreDisabled(B,Aa=>{this.PLh.$5o(d,Aa);F.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",d,Aa,ha,window.performance.now()-ha);n(d,void 0!==Aa?Aa:!0)})}else n(d,
!1);else n(d,Q)}else this.queryStoreDisabled(d,n)}xgd(d,n,B){return d?B?2===n?yj.Cxb(B,d):yj.Cxb(d,B):d:B}XMj(){if(!this.JJb){const d=JSON.parse(this.gzb);this.N3c(d);this.JJb=d}return yj.ygc(0,this.JJb)}N3c(d){yj.hWc(d);this.Ifc(d);this.O3c(d)}Ifc(d){const n=this.nXc();for(var B=0;B<d.length&&0<n.count;B++){const Q=d[B];if(n.Bb(Q.solutionId)){let ha=String.format("Found an override, solutionId: {0}",Q.solutionId);const Aa=n.K(Q.solutionId);Aa&&(isNaN(Aa.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
ha,Q.addinInfo.priority,Aa.addinInfo.priority),Q.addinInfo.priority=Aa.addinInfo.priority),isNaN(Aa.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,Q.addinInfo.AUP,Aa.addinInfo.AUP),Q.addinInfo.AUP=Aa.addinInfo.AUP),Aa.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,Q.displayName,Aa.displayName),Q.displayName=Aa.displayName),Aa.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,Q.iconUrl,Aa.iconUrl),Q.iconUrl=Aa.iconUrl),Aa.description&&
(ha=String.format("{0}; Description: update {1} to {2}",ha,Q.description,Aa.description),Q.description=Aa.description));n.remove(Q.solutionId);this.nMa&&F.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ha)}}for(const Q of n.keys)B=n.K(Q),B.displayName&&B.iconUrl&&B.addinInfo&&(d.push(B),this.nMa&&F.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(B)))}nXc(){const d=new vn.a(ja.a.Oh());
let n=this.za.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return d;n=n.trim();if(12>=n.length)return 0<n.length&&F.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),d;this.nMa&&F.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const B=[],Q=n.split("|");for(let ha=Q.length-1;0<=ha;ha--){const Aa=Q[ha],bb=Aa.split("\\");if(2>bb.length){B.push(Aa);continue}const Ib=
yj.dkd(bb);Ib?d.Bb(Ib.solutionId)||d.add(Ib.solutionId,Ib):B.push(Aa)}this.nMa&&0<B.length&&F.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",B.join("|"));this.nMa&&0<d.count&&F.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(nl.toArray(d.values)));return d}catch(B){F.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
n,B.toString())}return d}O3c(d){for(let n=0;n<d.length;n++)Cb.c(d[n].iconUrl.toLowerCase(),"http",0)||(d[n].iconUrl=String.format("{0}/image/apps.{1}",this.RLc,d[n].iconUrl))}static zwb(d){return 0===d||10===d}static spf(d,n){const B={};B.collectionType=$k[d];B.queryResult="null";B.queryStart=n;B.queryDuration=window.performance.now()-n;return Object.assign(new Zf(d,3),{fk:Error.create("QueryAddinDetails hit an invocation failure",B)})}static TNb(d,n,B){const Q={};Q.collectionType=$k[d];d=new Zf(d,
n);0!==n&&(d.fk=Error.create(B,Q));return d}static spb(d){return yj.TNb(d,2,"The store is disabled.")}static hpf(d){const n={};n.collectionType=$k[d];n.invokeResultCode=-2147208619;n.queryDuration=0;return Object.assign(new Zf(d,3),{fk:Error.create("Anonymous users do not have installed add-ins.",n)})}static v6c(d){return d.fk?d.fk.invokeResultCode:-1E3}qfd(d,n,B){const Q={};Q.AddinCollectionType=$k[d];Q.ErrorCode=n.errorCode;Q.AddinCount=n.value?n.value.length:0;d=window.performance.now();n=Date.now()-
G.AFrameworkApplication.eH;F.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",B,d,n,JSON.stringify(Q))}pfd(d,n,B){this.rfd?(B={["AddinCollectionType"]:$k[d],["ErrorCode"]:n.errorCode,["QueryDuration"]:B,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.eH},this.qbd(d)&&F.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(B)),B.AddinCount=n.value?n.value.length:0,F.ULS.sendTraceTag(512231322,
220,50,"logQueryCompletedResult: {0}",JSON.stringify(B))):this.qfd(d,n,B)}qbd(d){0===d?this.GX|=1:1===d&&(this.GX|=2);d=this.GX&131;if(d=1===d||2===d)this.GX=255;return d}static ygc(d,n){const B={};B.errorCode=d;B.value=n;return B}static RCc(d){return d===OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Cxb(d,n){n.solutionId=n.solutionId||d.solutionId;n.version=n.version||d.version;n.storeType=n.storeType||d.storeType;n.storeId=n.storeId||d.storeId;
n.assetId=n.assetId||d.assetId;n.assetStoreId=n.assetStoreId||d.assetStoreId;n.displayName=n.displayName||d.displayName;n.provider=n.provider||d.provider;n.description=n.description||d.description;n.iconUrl=n.iconUrl||d.iconUrl;n.webApplicationId=n.webApplicationId||d.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||d.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||d.licenseUrl;n.privacyUrl=n.privacyUrl||d.privacyUrl;n.addinInfo=n.addinInfo||d.addinInfo;isNaN(n.targetType)&&(n.targetType=
d.targetType);isNaN(n.height)&&(n.height=d.height);isNaN(n.width)&&(n.width=d.width);return n}static hWc(d){for(const n of d)isNaN(n.targetType)&&(n.targetType=1),n.assetId=n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static dkd(d){const n={};let B=0;B<d.length&&0<d[B].trim().length&&d[B].trim().toLowerCase().startsWith("wa")&&(n.solutionId=d[B].trim(),n.addinInfo=
Object.assign(new Jp,{priority:Number.NaN,AUP:Number.NaN}),++B<d.length&&0<d[B].trim().length&&(n.addinInfo.priority=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&(n.addinInfo.AUP=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&(n.displayName=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.iconUrl=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.description=d[B].trim()));return n.solutionId?n:null}static r6c(d,n){d=d.rb("AddinImageStoreServiceUrl");if(!d)return n;d=
d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:n}}Object(D.a)(yj,"AddinDetailsManager1",null,[1925,1926]);class ki{constructor(d,n=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=d.solutionId;this.version=
d.version;this.storeType=d.storeType;this.storeId=d.storeId;this.assetId=d.assetId;this.assetStoreId=d.assetStoreId;this.displayName=d.displayName;this.provider=d.provider;this.description=d.description;this.targetType=d.targetType;this.height=d.height;this.width=d.width;this.iconUrl=d.iconUrl;this.webApplicationId=d.webApplicationId;this.highResolutionIconUrl=d.highResolutionIconUrl;this.licenseUrl=d.licenseUrl;this.privacyUrl=d.privacyUrl;this.addinInfo=n}NCc(){const d={};d.solutionId=this.solutionId;
d.version=this.version;d.storeType=this.storeType;d.storeId=this.storeId;d.assetId=this.assetId;d.assetStoreId=this.assetStoreId;d.targetType=this.targetType;d.displayName=this.displayName;d.width=this.width;d.height=this.height;return d}}Object(D.a)(ki,"AddinDetail",null,[]);class tj{constructor(d,n,B,Q,ha){this.kQd=null;this.za=d;this.Bk=n;this.KJb=B;this.dQk=Q;this.Mjb=ha}lU(d,n){this.nt.queryAppDetails(this.dQk,this.Mjb,this.solutionIds,d,(B,Q)=>{let ha=null;if(Q){ha=Array(Q.length);for(let Aa=
0;Aa<Q.length;Aa++)ha[Aa]=new ki(Q[Aa],this.MOn(Q[Aa].solutionId))}n(B,ha||[])})}get wrn(){return!!this.nt.queryAppDetails}MOn(d){return this.KJb.K(d)}get solutionIds(){if(!this.kQd){this.kQd=new ma.a;for(const d of this.KJb.keys)this.kQd.add(Cb.d(d))}return this.kQd.toArray()}get nt(){return this.Bk.value}}Object(D.a)(tj,"AddinDetailsLoader",null,[]);class Mm{constructor(d,n=0){this.fk=null;this.xga=d;this.errorCode=n}}Object(D.a)(Mm,"AddinQueryResult",null,[]);class dm extends Mm{constructor(d,
n=0){super(d,n);this.mJg=this.solutionIds=null}}Object(D.a)(dm,"AddinCollection",Mm,[]);var bl=e(1193);class Un extends bl.a{constructor(){super(ja.a.Oh())}}Object(D.a)(Un,"AddinDetailTable",bl.a,[]);var ak;(function(d){d[d.stop=-1]="stop";d[d.skip=0]="skip";d[d.query=1]="query"})(ak||(ak={}));Object(D.b)("QueryStrategy",ak);class Gj{constructor(d,n,B=null){this.sa=new dc.a;this.EE=new vn.a(ja.a.Oh());this.Ot=new Eg.a;this.GX=0;this.Ofa=new Eg.a;this.KJb=this.aPe=null;this.Fyb=(Q,ha,Aa)=>{Aa?(this.pfd(Q,
Aa,window.performance.now()-ha),0===Aa.errorCode?(ha=Aa.value?Gj.Dbl(Aa.value):[],this.aM(new Mm(Q),ha)):-1===Aa.errorCode||10===Aa.errorCode?this.aM(new Mm(Q),[]):(Q=this.rpf(Q,ha,Aa),this.aM(Q))):(Q=Gj.spf(Q,ha),this.aM(Q))};this.MOa=(Q,ha)=>{if(0!==ha.errorCode&&5!==ha.errorCode)this.Eak(ha.wV,Object.assign(new dm(ha.wV,ha.errorCode),{fk:ha.fk}));else{Q=Object.assign(new dm(ha.wV,ha.errorCode),{solutionIds:new ma.a,mJg:new ma.a});var Aa=ha.ED;for(const Ib of Aa){Aa=Ib.solutionId;const oc=Ib.storeId;
if(this.EE.Bb(Aa)){var bb=this.EE.K(Aa);bb.Bb(oc)?bb.W(oc,this.xgd(bb.K(oc),ha.wV,Ib)):bb.add(oc,Ib)}else bb=new Un,bb.add(oc,Ib),this.EE.add(Aa,bb);Q.solutionIds.add(Aa);Q.mJg.add(oc)}this.Eak(ha.wV,Q)}};this.usa=new Sb.a;this.usa.add(OSF.StoreTypeEnum.MarketPlace,0);this.usa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.za=d;this.Bk=n;this.yw=B;this.RLc=Gj.r6c(d,"https://store-images.s-microsoft.com");this.v7e=null;this.yob(this.MOa)}get xXd(){this.aPe||(this.aPe=this.pzi());return this.aPe}pzi(){const d=
JSON.parse(this.gzb);this.N3c(d);return d.map(n=>new ki(n,n.addinInfo))}get qT(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get rfd(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.za&&this.za.$("IsAnonymousUser")}get AHf(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get clc(){return!!this.za&&
this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get nMa(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get nt(){return this.Bk.value}get Mog(){this.v7e||(this.v7e=new tj(this.za,this.Bk,this.lko,0,this.nt.getAppUILocale()));return this.v7e}$Y(d){if(this.qT&&!this.kcb(d))return new og(0);if(!this.HNa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:$k[d]}),
Object.assign(new og(1),{fk:d});const n=this.Ot.K(d);if(n.fk)return Object.assign(new og(n.errorCode),{fk:n.fk});F.ULS.shipAssertTag(509870082,220,!!n.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const B=new og(n.errorCode);for(let Q=0;Q<n.solutionIds.count;Q++){const ha=n.solutionIds.K(Q),Aa=n.mJg.K(Q);if(this.EE.Bb(ha)){const bb=this.EE.K(ha);bb.Bb(Aa)?Array.add(B.ED,bb.K(Aa)):F.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",
ha,d,Aa)}else F.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",ha,d)}return B}PXa(d,n=null){if(d=this.Qmm(d))if(n||(n=this.uiCulture),d.Bb(n))return d.K(n);return null}Qmm(d){return this.EE.Bb(d)?this.EE.K(d):null}HFa(d){if(d){this.yob(d);for(const n of this.Ot.keys){if(this.qT&&!this.kcb(n))continue;if(!this.HNa(n)||this.Ot.K(n).fk)continue;F.ULS.shipAssertTag(509870081,220,!!this.Ot.K(n).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
n);const B=[],Q=this.Ot.K(n);for(const ha of Q.solutionIds)Array.add(B,this.EE.K(ha));d(null,new cj(n,Q.errorCode,B,Q.fk))}}}get name(){return"AddinDetailsManager2"}C0b(d,n){if(this.qT&&Gj.zwb(d)){var B=ha=>{this.aM(Gj.TNb(ha,4,"The connected service is disabled."));this.GFa(ha,-1)},Q=ha=>{this.aM(Gj.TNb(ha,0,"The user doesn't have any addin installed."),[]);this.GFa(ha,0)};0===d?(this.w$c(0,n,B,Q),this.w$c(2,n,B,()=>{this.X_b(this.Fyb,this.xXd)})):10===d&&this.GFa(1,1)}}lU(d,n=!1){Gj.zwb(d)?this.Pld(d,
this.Fyb,n):F.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Wf[d])}yob(d){this.sa.addHandler(gf.a.kfc,d)}w$c(d,n,B,Q){this.kcb(d)||(3===n&&B?B(d):2===n&&Q?Q(d):this.GFa(d,1))}kcb(d){return this.Ofa.Bb(d)}GFa(d,n){if(this.qT){var B=this.kcb(d);if(!B||-1!==this.Ofa.K(d)&&this.Ofa.K(d)!==n)F.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",$k[d],B?ak[this.Ofa.K(d)]:"undefined",ak[n]),this.Ofa.W(d,n)}}rpf(d,n,B){const Q=
{};Q.collectionType=$k[d];Q.invokeResultCode=B.errorCode;Q["queryResult.Value"]=B.value?String.format("Length: {0}",B.value.length):"null";Q.queryStart=n;Q.queryDuration=window.performance.now()-n;return Object.assign(new Mm(d,3),{fk:Error.create("QueryAddinDetails hit an invocation failure",Q)})}SFg(d){if(d!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.vAc(2)){if(!this.HNa(2))return!0;if(this.za.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.Ot.K(2).errorCode}return!1}vAc(d){return this.qT&&
this.Ofa.Bb(d)?1===this.Ofa.K(d):!0}Pld(d,n,B=!1){F.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);if(d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog)F.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d);else{var Q=this.usa.K(d);this.SFg(d)&&this.X_b(n,this.dmo);this.vAc(Q)&&(this.clc&&this.isAnonymousUser?(d=Gj.hpf(Q),this.aM(d)):this.yrg(d,n,B))}}get dmo(){return this.Ot.Bb(2)?null:this.xXd}yrg(d,n,B){this.queryStoreDisabled(d,
(Q,ha)=>{if(Q===OSF.StoreTypeEnum.MarketPlace&&ha)ha=Gj.spb(0),this.aM(ha);else if(Q===OSF.StoreTypeEnum.PrivateCatalog&&ha)ha=Gj.spb(1),this.aM(ha);else{var Aa=window.performance.now();this.nt.getEntitlementDetails(Object.assign(new pm,{storeType:Q,refresh:B}),bb=>{n(this.usa.K(Q),Aa,bb)})}})}X_b(d=null,n=null){null===d&&(d=this.Fyb);this.queryStoreDisabled(0,(B,Q)=>{Q?(B=Gj.spb(2),this.aM(B)):null!=n?this.aM(new Mm(2,5),n):this.qso(d)})}aM(d,n=null){0!==d.errorCode&&5!==d.errorCode?(F.ULS.shipAssertTag(509116673,
220,!n,"The parameter addinDetails must be null for any failed queries"),F.ULS.shipAssertTag(509116672,220,!!d.fk,"The result.Failure must not be available for any failed queries"),this.KFg(d)?F.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",$k[d.xga],Mo[d.errorCode],d.fk?d.fk.toString():"null",JSON.stringify(d.fk)):F.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",$k[d.xga],Mo[d.errorCode],d.fk?d.fk.toString():"null",JSON.stringify(d.fk))):(F.ULS.shipAssertTag(509116643,220,!!n,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",$k[d.xga]),F.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",$k[d.xga],n?n.length:-1,Mo[d.errorCode]));d=new cj(d.xga,d.errorCode,n,d.fk);this.sa.raiseEvent(gf.a.kfc,d)}KFg(d){return 3===
d.errorCode&&(this.clc&&-2147208619===Gj.v6c(d)||this.AHf&&-2===Gj.v6c(d))||4===d.errorCode?!1:2!==d.errorCode}Eak(d,n){this.Ot.W(d,n);this.GFa(d,1)}HNa(d){return this.Ot.Bb(d)?!!this.EE:!1}get uiCulture(){return this.yw&&this.yw.UICulture?this.yw.UICulture:G.AFrameworkApplication.uiCulture}get Nfc(){return this.yw?!this.yw.AreThirdPartyAddInsAllowed||this.yw.AppsForOfficeThirdPartyIsDisabled:!this.za.$("AreThirdPartyAddInsAllowed")||this.za.$("AppsForOfficeThirdPartyIsDisabled")}get Yqc(){return this.yw?
!this.yw.AppsForOfficeAllowExternalMarketplace:!this.za.$("AppsForOfficeAllowExternalMarketplace")}get lko(){if(!this.KJb){this.KJb=new vn.a(ja.a.Oh());const d=JSON.parse(this.gzb);for(const n of d)this.KJb.add(n.solutionId,n.addinInfo)}return this.KJb}get gzb(){return this.yw?this.yw.PopularAddinDetailsJsonString:this.za.rb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,n){if(this.Nfc)n(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.Yqc)n(d,!0);else{const B=Gj.RCc(d);if(B){const Q=
window.performance.now();this.nt.queryStoreDisabled(B,ha=>{F.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",d,ha,Q,window.performance.now()-Q);n(d,ha)})}else n(d,!1)}}xgd(d,n,B){return d?B?2===n?Gj.Cxb(B,d):Gj.Cxb(d,B):d:B}qso(d){const n=(Q,ha,Aa)=>{d(2,Aa,Gj.ygc(Q,ha))},B=window.performance.now();this.Mog&&this.Mog.wrn?this.Mog.lU(!1,(Q,ha)=>{this.Ifc(ha);d(2,B,Gj.ygc(Q,ha))}):n(0,this.pzi(),B)}N3c(d){Gj.hWc(d);this.Ifc(d);
this.O3c(d)}Ifc(d){const n=this.nXc();for(var B=0;B<d.length&&0<n.count;B++){const Q=d[B];if(n.Bb(Q.solutionId)){let ha=String.format("Found an override, solutionId: {0}",Q.solutionId);const Aa=n.K(Q.solutionId);Aa&&(isNaN(Aa.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ha,Q.addinInfo.priority,Aa.addinInfo.priority),Q.addinInfo.priority=Aa.addinInfo.priority),isNaN(Aa.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,Q.addinInfo.AUP,
Aa.addinInfo.AUP),Q.addinInfo.AUP=Aa.addinInfo.AUP),Aa.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,Q.displayName,Aa.displayName),Q.displayName=Aa.displayName),Aa.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,Q.iconUrl,Aa.iconUrl),Q.iconUrl=Aa.iconUrl),Aa.description&&(ha=String.format("{0}; Description: update {1} to {2}",ha,Q.description,Aa.description),Q.description=Aa.description));n.remove(Q.solutionId);this.nMa&&F.ULS.sendTraceTag(509379136,220,50,
"ApplyOverridesToPopularAddinDetails: {0}.",ha)}}for(const Q of n.keys)B=n.K(Q),B.displayName&&B.iconUrl&&B.addinInfo&&(d.push(B),this.nMa&&F.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(B)))}nXc(){const d=new vn.a(ja.a.Oh());let n=this.za.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!n)return d;n=n.trim();if(12>=n.length)return 0<n.length&&F.ULS.sendTraceTag(509379106,220,
10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",n),d;this.nMa&&F.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",n);try{const B=[],Q=n.split("|");for(let ha=Q.length-1;0<=ha;ha--){const Aa=Q[ha],bb=Aa.split("\\");if(2>bb.length){B.push(Aa);continue}const Ib=Gj.dkd(bb);Ib?d.Bb(Ib.solutionId)||d.add(Ib.solutionId,Ib):B.push(Aa)}this.nMa&&0<B.length&&F.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
B.join("|"));this.nMa&&0<d.count&&F.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(nl.toArray(d.values)));return d}catch(B){F.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",n,B.toString())}return d}O3c(d){for(let n=0;n<d.length;n++)Cb.c(d[n].iconUrl.toLowerCase(),"http",0)||(d[n].iconUrl=String.format("{0}/image/apps.{1}",this.RLc,d[n].iconUrl))}static zwb(d){return 0===
d||10===d}static spf(d,n){const B={};B.collectionType=$k[d];B.queryResult="null";B.queryStart=n;B.queryDuration=window.performance.now()-n;return Object.assign(new Mm(d,3),{fk:Error.create("QueryAddinDetails hit an invocation failure",B)})}static TNb(d,n,B){const Q={};Q.collectionType=$k[d];d=new Mm(d,n);0!==n&&(d.fk=Error.create(B,Q));return d}static spb(d){return Gj.TNb(d,2,"The store is disabled.")}static hpf(d){const n={};n.collectionType=$k[d];n.invokeResultCode=-2147208619;n.queryDuration=0;
return Object.assign(new Mm(d,3),{fk:Error.create("Anonymous users do not have installed add-ins.",n)})}static v6c(d){return d.fk?d.fk.invokeResultCode:-1E3}qfd(d,n,B){const Q={};Q.AddinCollectionType=$k[d];Q.ErrorCode=n.errorCode;Q.AddinCount=n.value?n.value.length:0;d=window.performance.now();n=Date.now()-G.AFrameworkApplication.eH;F.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",B,d,n,JSON.stringify(Q))}pfd(d,
n,B){this.rfd?(B={["AddinCollectionType"]:$k[d],["ErrorCode"]:n.errorCode,["QueryDuration"]:B,["FlyoutDataReadySinceBoot"]:Date.now()-G.AFrameworkApplication.eH},this.qbd(d)&&F.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(B)),B.AddinCount=n.value?n.value.length:0,F.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(B))):this.qfd(d,n,B)}qbd(d){0===d?this.GX|=1:1===d&&(this.GX|=2);d=this.GX&131;if(d=1===d||2===d)this.GX=255;return d}static ygc(d,n){const B={};
B.errorCode=d;B.value=n;return B}static RCc(d){return d===OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Cxb(d,n){n.solutionId=n.solutionId||d.solutionId;n.version=n.version||d.version;n.storeType=n.storeType||d.storeType;n.storeId=n.storeId||d.storeId;n.assetId=n.assetId||d.assetId;n.assetStoreId=n.assetStoreId||d.assetStoreId;n.displayName=n.displayName||d.displayName;n.provider=n.provider||d.provider;n.description=n.description||d.description;
n.iconUrl=n.iconUrl||d.iconUrl;n.webApplicationId=n.webApplicationId||d.webApplicationId;n.highResolutionIconUrl=n.highResolutionIconUrl||d.highResolutionIconUrl;n.licenseUrl=n.licenseUrl||d.licenseUrl;n.privacyUrl=n.privacyUrl||d.privacyUrl;n.addinInfo=n.addinInfo||d.addinInfo;isNaN(n.targetType)&&(n.targetType=d.targetType);isNaN(n.height)&&(n.height=d.height);isNaN(n.width)&&(n.width=d.width);return n}static Dbl(d){const n=Array(d.length);for(let B=0;B<n.length;B++)n[B]=new ki(d[B],d[B].addinInfo);
return n}static hWc(d){for(const n of d)isNaN(n.targetType)&&(n.targetType=1),n.assetId=n.assetId||n.solutionId,n.storeId=n.storeId||"en-US",n.storeType=n.storeType||"omex",n.assetStoreId=n.assetStoreId||"omex",isNaN(n.width)&&(n.width=0),isNaN(n.height)&&(n.height=0)}static dkd(d){const n={};let B=0;B<d.length&&0<d[B].trim().length&&d[B].trim().toLowerCase().startsWith("wa")&&(n.solutionId=d[B].trim(),n.addinInfo=Object.assign(new Jp,{priority:Number.NaN,AUP:Number.NaN}),++B<d.length&&0<d[B].trim().length&&
(n.addinInfo.priority=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&(n.addinInfo.AUP=parseInt(d[B].trim())),++B<d.length&&0<d[B].trim().length&&(n.displayName=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.iconUrl=d[B].trim()),++B<d.length&&0<d[B].trim().length&&(n.description=d[B].trim()));return n.solutionId?n:null}static r6c(d,n){d=d.rb("AddinImageStoreServiceUrl");if(!d)return n;d=d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:n}}Object(D.a)(Gj,"AddinDetailsManager2",
null,[1924]);class Tk{constructor(d,n){this.Lwc="popular";this.uVh="addinDetails";this.l3h="cache-lastUpdate";this.h2h="builtin-lastUpdate";this.qzj=144E5;this.za=this.Uea=null;this.Z0n=(B,Q)=>{2===Q.wV&&0===Q.errorCode&&(this.Qpf=Q.ED,this.FXd=this.now,F.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.Uea=n;this.za=d;this.Uea.HFa(this.Z0n);this.qzj=this.za.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",
144E5)}get Mwn(){return this.FXd?this.now.getTime()-this.FXd.getTime()>=this.qzj:!0}$Y(d){var n=this.Uea.$Y(d);2===d&&this.Lwn(n.errorCode)&&(d=this.Qpf,null!=d?(this.Mwn&&this.Uea.X_b(null,null),n=this.toDateString(this.now),n=this.toDateString(this.ypf)===n?this.epf(5,this.Uea.xXd):this.epf(0,d)):(Tk.FDa&&(n=this.epf(5,this.Uea.xXd)),this.ypf=this.now,this.Uea.X_b(null,null)));return n}epf(d,n){return Object.assign(new og(d),{ED:n,fk:null})}toDateString(d){return d.toISOString().substring(2,16)}get ypf(){const d=
Tk.E4b(this.Lwc,this.h2h);return null!==d?new Date(d):new Date(0)}set ypf(d){Tk.FCb(this.Lwc,d.toISOString(),this.h2h)}get FXd(){const d=Tk.E4b(this.Lwc,this.l3h);return null!==d?new Date(d):new Date(0)}set FXd(d){Tk.FCb(this.Lwc,d.toISOString(),this.l3h)}get Qpf(){const d=Tk.E4b(this.Lwc,this.uVh);let n=null;d&&(n=JSON.parse(d));return n}set Qpf(d){d=JSON.stringify(d);Tk.FCb(this.Lwc,d,this.uVh)}get now(){return new Date}Lwn(d){return 2!==d&&4!==d}PXa(d,n=null){return this.Uea.PXa(d,n)}HFa(d){this.Uea.HFa(d)}get name(){return"AddinDetailsCacheManager"}C0b(d,
n){this.Uea.C0b(d,n)}lU(d,n=!1){this.Uea.lU(d,n)}static E4b(d,n){let B=null;try{const Q=Tk.Mud;if(void 0!==Q&&Q){const ha=gf.a.Glc(d)+"_"+n;B=Q.getItem(ha)}else F.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Q){F.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",d,n)}return B}static FCb(d,n,B){try{const Q=Tk.Mud;if(void 0!==Q&&Q){const ha=gf.a.Glc(d)+"_"+B;Q.setItem(ha,n)}else F.ULS.sendTraceTag(508352217,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Q){F.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",d,B)}}static get Mud(){if(!Tk.FDa)return null;let d=null;try{d=localStorage}catch(n){Tk.FDa=!1,d=null,F.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${n.name}; message: ${n.message}; stack: ${n.stack}`)}return d}}Tk.FDa=!0;Object(D.a)(Tk,"AddinDetailsCacheManager",null,[1925]);class ms{static createInstance(d,
n,B=null){d=ms.drc(d)?ms.Xjf(d)?new Tk(d,new Gj(d,n,B)):new yj(d,n,B):new an(d,n,B);F.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${d.name}`);return d}static drc(d){return(d||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static Xjf(d){return(d||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(D.a)(ms,
"AddinDetailsManagerFactory",null,[]);class Sr{constructor(d){this.P$e=d}next(d){this.P$e=(9301*this.P$e+49297)%233280;return Math.floor(this.P$e/233280*d)}}Object(D.a)(Sr,"Random",null,[]);var Uk=e(1708),vp=e(650);class ns{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(D.a)(ns,"GallerySectionProps",null,[]);var Kp=e(1879);class En{constructor(){this.text=this.href=null}}Object(D.a)(En,"LinkProps",null,[]);var Vn=e(1709),em=e(169);class uo{constructor(d,
n){this.xKh=!0;this.rVk=d;this.sVk=n}taj(){null==Xg.a.instance.getItem("AddinEntryPointSurveyShowed")&&this.xKh&&(this.xKh=!1,window.setTimeout(()=>{this.sMh=Wa.a.instance.Za("Common.ISystemInitiatedFeedback");null!=this.sMh&&this.sMh.execute(d=>{const n=this.bNf();this.Xom()||n&&(!n||"hidden"!==n.visibility)||(d.y2a(this.rVk,null),Xg.a.instance.setItem("AddinEntryPointSurveyShowed","1"))})},this.sVk))}bNf(){let d=null;try{const n=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");n&&(d=
em.a.JB(n.parentNode.parentNode.parentNode))}catch(n){F.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(n?n.toString():""))}return d}Xom(){let d=null;try{d=document.getElementById("BackstageGetAddIns")}catch(n){F.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+(n?n.toString():""))}return d}}Object(D.a)(uo,"FpsHelper",null,[]);class So{constructor(){this.icon=this.text=this.href=null}}Object(D.a)(So,"LinkWithLabelProps",null,
[]);const Bo="wa104380862 wa104381526 wa104295828 wa104380121 wa200000113 wa104380907 wa104379997 wa104379231 wa104382064 wa104379481 wa104379193 wa104380278 wa104380848 wa200000729 wa104381335 wa104379264 wa104363616 wa104380510 wa104323558 wa104379806 wa104381029 wa104379804 wa104381025 wa104356783 wa104381139 wa104380375 wa104380871 wa104380274 wa104379714 wa104379790 wa200003233 wa200003915 wa200005566 wa200001661 wa104363477 wa104382059 wa104380256 wa104381814 wa104380181 wa104379673 wa104380844 wa200000125 wa104381558 wa104281577 wa104381331 wa200001937 wa200000410 wa200006046 wa200003666 wa200005264 wa200004858 wa104379830 wa104379772 wa104381350 wa200001086 wa104380781 wa200005503 wa200002329 wa104379987 wa200002433 wa200005638 wa200004764 wa200004551 wa200005542 wa200002388 wa200001943 wa104379474 wa200003602 wa200002274 wa200005359 wa200005030 wa200005559 wa200003574 wa200004465 wa200003912 wa104379951 wa200000724 wa104379852 wa200000745 wa200004798 wa200003821 wa200004784 wa200003732 wa200002185 wa200005928 wa200005801 wa200005040 wa200005921 wa200004497 wa200005694 wa200005159 wa200004578 wa200004648 wa200003903 wa200005793 wa200005812 wa200005628 wa200005496 wa200005653 wa200003619 wa200003567 wa200002197 wa200004677 wa200005373 wa200004040 wa200004984 wa200005220 wa200004675 wa200004771 wa200003520 wa200003599".split(" ");
class nn{constructor(d,n,B,Q,ha,Aa=null,bb=null,Ib={}){this.nWe={};this.QJk={};this.sFd={};this.qlh=this.Doh=0;this.kFd=null;this.cCk=6E4;this.Rqa={};this.HPe={};this.MOa=(oc,Ac)=>{this.poa?this.wCo(Ac):(this.wnd(Ac),!this.A4b&&this.PRa&&this.PRa.MOa(oc,Ac))};this.TRa=n;this.G6a=null;this.dJk=B;this.fJk=Q;this.rSk=ha;this.PRa=bb;this.za=Aa||G.AFrameworkApplication.J;this.lfc&&(this.Rqa=Ib,this.jel(),this.jdl());this.TRa.HFa(this.MOa);appChrome.addInApi.loadOfficeAddInIcons()}get Xuf(){return this.sFd}wnd(d){if(d.ED)for(let n=
0;n<d.ED.length;n++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+d.ED[n].solutionId,d.ED[n].iconUrl);else 0===d.errorCode&&F.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get c0l(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get poa(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}get z3b(){return!!this.za&&this.za.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get Mqp(){return!!this.za&&this.za.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get A4b(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get lfc(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}Q5h(){if(this.m0h)return!0;let d=this.TRa.$Y(0);if(1!==
d.errorCode)return!0;d=this.TRa.$Y(1);return 1!==d.errorCode}bjo(d){const n=[];var B=new Sr((new Date).getDate());for(var Q=0;30>Q;Q++)Array.add(n,B.next(d.count));B=0;for(const ha of d){Q=!1;for(const Aa of n)if(B===Aa){Q=!0;break}B++;if(Q){let Aa;(Aa=ha.addinInfo).AUP=20*Aa.AUP}else if(1===ha.addinInfo.priority){let Aa;(Aa=ha.addinInfo).AUP=4*Aa.AUP}else if(2===ha.addinInfo.priority){let Aa;(Aa=ha.addinInfo).AUP=2*Aa.AUP}}d.Sc((ha,Aa)=>ha.addinInfo.AUP<Aa.addinInfo.AUP?1:-1);return d}KAm(){const d=
{},n={},B={};n.root={margin:"0px","margin-left":"12px",width:"100%",maxWidth:"unset"};n.inner={margin:"-4px","margin-left":"18px"};B.root={width:100,height:100,backgroundColor:"transparent"};B.flexContainer={flexDirection:"column"};B.label={"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"};d.galleryButtonInExpanded=B;d.galleryStack=n;return d}Alm(){return Object.assign(new Kp.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.rSk,
LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}elm(d,n,B){const Q={},ha={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};
G.AFrameworkApplication.isRtl&&(ha.direction="ltr");Q.root=ha;return Object.assign(new Kp.a,{Id:B,ExternalId:B,Icon:"AddinFlyoutControl"+n.solutionId,Command:d===CommonUIStrings.l_PopularAddins?this.dJk:this.fJk,LabelText:n.displayName,Role:"menuitem",FullIconStyle:Q,Alt:n.description})}Fko(d,n,B){const Q=Object.assign(new ns,{SectionId:d,GalleryButtons:[]});for(let ha=0;ha<B;ha++)Array.add(Q.GalleryButtons,this.elm(d,n[ha],this.nWe[n[ha].solutionId]));return Q}gOm(){const d=[],n=[];var B=this.TRa.$Y(0);
Array.addRange(n,B.ED);const Q=this.TRa.$Y(1);Array.addRange(n,Q.ED);let ha=n.length;n.sort((yd,be)=>{yd=Cb.d(yd.displayName);be=Cb.d(be.displayName);return Ca.a.localeCompare(yd,be)});const Aa=3<ha;Aa&&(ha=2);for(var bb=0;bb<ha;bb++)this.H1h(n[bb]);let Ib=[],oc=null;bb=null;this.z3b||this.poa||!this.G6a?(oc=this.TRa.$Y(2),0!==oc.errorCode&&5!==oc.errorCode||oc.ED.forEach(yd=>{-1!==yd.addinInfo.priority&&(this.H1h(yd),Ib.push(yd))})):Ib=this.G6a;F.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",
ha,Mo[B.errorCode],B.ED.length,Mo[Q.errorCode],Q.ED.length,this.z3b?Mo[oc.errorCode]:"undefined",Ib.length);G.AFrameworkApplication.J.isChangeGateEnabled("OfficeVSO:8365528_FlyoutAddinEntryPointDisplayMetrics")&&this.PRa&&this.PRa.kej("Flyout",ha,B,Q,oc);let Ac=!0;if(this.lfc||!Ib.length)Ac=!1;Ac&&(Ib=this.poa?this.qVm(Ib,n):this.yel(Ib,n),this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.kFd=new uo("AddinFlyoutFeedbackSurvey",this.za.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",
this.cCk)),this.kFd.taj()));if(this.lfc)if((bb=this.Xqm())&&0<Object.keys(bb).length){if(n&&0<n.length)for(var ad in bb){var sd=bb[ad];sd&&0<sd.length&&(bb[ad]=sd.filter(yd=>!n.some(be=>be.solutionId.toLowerCase()===yd.solutionId.toLowerCase())))}}else F.ULS.sendTraceTag(507892616,220,15,"Category addins details dict is empty");ad=Object.assign(new ab.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});sd=Object.assign(new Ka.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});
Array.add(ad.ControlList,sd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));ad=Object.assign(new qb.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:ad,UpdateDynamically:!0,IsFlexLayout:!0});if((2===B.errorCode||this.z3b&&2===oc.errorCode)&&!n.length){d.push("storeDisabled");F.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var wd=this.cJf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError);
Array.add(ad.MenuSectionList,wd)}else if(3===B.errorCode&&3===Q.errorCode)d.push("invokeFailure"),F.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),wd=this.cJf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(ad.MenuSectionList,wd);else if(this.c0l&&4===B.errorCode&&!n.length)d.push("serviceDisabled"),F.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),wd=this.cJf("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),
Array.add(ad.MenuSectionList,wd);else{0<ha&&this.zJl(ad,n,ha,Aa);if(this.lfc&&bb&&0<Object.keys(bb).length)for(wd in bb)(B=bb[wd])&&0<B.length&&Array.add(ad.MenuSectionList,this.Nkm(B,3<B.length?3:B.length,this.Zqm(wd),wd));Ac&&(this.qlh=30<Ib.length?30:Ib.length,Array.add(ad.MenuSectionList,this.ulm(Ib,this.qlh)))}this.jwl();0===ad.MenuSectionList.length&&(ad.IsFlexLayout=!1,d.push("emptyMenuSection"),F.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.Mqp&&F.ULS.sendTraceTag(508047442,
220,15,`${d.join("|")}`);return ad}Xvl(){const d=[],n=this.TRa.$Y(0);Array.addRange(d,n.ED);const B=this.TRa.$Y(1);Array.addRange(d,B.ED);if(2!==n.errorCode||d.length){if(3===n.errorCode&&3===B.errorCode)return F.ULS.sendTraceTag(508360459,220,10,"dataProvider invoke error hit, launch survey fail."),!1;if(4===n.errorCode&&!d.length)return F.ULS.sendTraceTag(508360458,220,10,"dataProvider disconnecteddisabled error hit, launch survey fail."),!1}else return F.ULS.sendTraceTag(508360460,220,10,"store disabled hit, launch survey fail."),
!1;return!0}jwl(){window.setTimeout(()=>{var d=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");d&&d.firstChild&&d.firstChild.firstChild&&d.firstChild.firstChild.firstChild&&(d=d.firstChild.firstChild.firstChild.scrollTop,0<d&&(d={["scrollTopValue"]:d.toString()},cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:zf.a.iG(d)}))))},6E4)}ulm(d,n){const B=Object.assign(new ab.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",
ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(var Q=0;Q<0+n&&Q<d.length;Q++)this.QJk.PopularAddInsListItem0=d[Q].solutionId,this.Zwi(B.ControlList,"PopularAddInsListItem",Q.toString(),d[Q]);if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)){Q=[];for(let ha=0;ha<0+n&&ha<d.length;ha++)Array.add(Q,d[ha].solutionId);d={["solutionIds"]:Q.toString()};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",
dataFields:zf.a.iG(d)}))}return B}jel(){const d={};var n=this.za.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping","");if(0===n.length){for(var B in this.Rqa)"WN"!==B&&"TD"!==B&&(d[B]=this.Rqa[B]);this.Rqa=d}else{F.ULS.sendTraceTag(507892615,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",n);B=!0;var Q="";n=n.trim();try{const ha=n.split("$");for(let Aa=0;Aa<ha.length&&B;Aa++){const bb=ha[Aa].split(":");if(2<bb.length){Q="Invalid override string format: "+
ha[Aa];B=!1;break}const Ib=bb[0].trim(),oc=[];if(2===bb.length){const Ac=bb[1].split("|");for(let ad=0;ad<Ac.length&&B;ad++){const sd=Ac[ad],wd=sd.split("\\");if(2>wd.length||5<wd.length){Q="Invalid override string format: "+sd;B=!1;break}const yd=wd[0].trim(),be={};for(let ye=1;ye<wd.length&&B;ye++)if(0<wd[ye].trim().length)switch(ye){case 1:be.priority=parseInt(wd[ye].trim());break;case 2:be.AUP=parseInt(wd[ye].trim());break;case 3:be.diffAUP=parseInt(wd[ye].trim());break;case 4:const Qe=wd[ye].trim();
if(8!==Qe.length){Q="Invalid override string format: "+Qe;B=!1;break}const af=parseInt(Qe.substring(0,4)),Qf=parseInt(Qe.substring(4,6)),hf=parseInt(Qe.substring(6));be.releaseDate=(new Date(af,Qf-1,hf)).getTime();break;default:Q="Invalid override string format: "+sd,B=!1}if(!B)break;Array.add(oc,{solutionId:yd,addinInfo:be})}}d[Ib]=oc}}catch(ha){Q="Failed in parsing the overrideString: "+n+". Exception: "+ha.toString(),B=!1}if(B){for(const ha in d){if(!this.Rqa[ha])continue;const Aa=d[ha];n=this.Rqa[ha].filter(bb=>
!Aa.some(Ib=>Ib.solutionId.toLowerCase()===bb.solutionId.toLowerCase()));Array.addRange(Aa,n)}this.Rqa=d}else F.ULS.sendTraceTag(507892614,220,10,"Override Failed: {0}.",Q)}}jdl(){for(const d in this.Rqa){const n=this.Rqa[d];for(let B=0;B<n.length;B++){const Q=n[B];Q.addinInfo||(Q.addinInfo={});if(!Q.addinInfo.priority||isNaN(Q.addinInfo.priority))Q.addinInfo.priority=0;if(!Q.addinInfo.AUP||isNaN(Q.addinInfo.AUP))Q.addinInfo.AUP=0;if(!Q.addinInfo.diffAUP||isNaN(Q.addinInfo.diffAUP))Q.addinInfo.diffAUP=
0;if(!Q.addinInfo.releaseDate||isNaN(Q.addinInfo.releaseDate))Q.addinInfo.releaseDate=0}}}Xqm(){if(0===Object.keys(this.HPe).length){const d=[];if(!this.Rqa||0===Object.keys(this.Rqa).length)return F.ULS.sendTraceTag(507892613,220,15,"The category add-in ids mapping is empty."),{};for(const n in this.Rqa){const B=this.Rqa[n];if(!B||0===B.length){F.ULS.sendTraceTag(507892612,220,15,"The addin content list is empty for category: {0}.",n);continue}const Q=[];for(let ha=0;ha<B.length;ha++){const Aa=B[ha],
bb=this.TRa.PXa(Aa.solutionId);if(!bb){Array.add(d,Aa.solutionId);continue}const Ib={};Ib.solutionId=bb.solutionId;Ib.version=bb.version;Ib.storeType=bb.storeType;Ib.storeId=bb.storeId;Ib.assetId=bb.assetId;Ib.assetStoreId=bb.assetStoreId;Ib.displayName=bb.displayName;Ib.provider=bb.provider;Ib.description=bb.description;Ib.targetType=bb.targetType;Ib.height=bb.height;Ib.width=bb.width;Ib.iconUrl=bb.iconUrl;Ib.webApplicationId=bb.webApplicationId;Ib.highResolutionIconUrl=bb.highResolutionIconUrl;
Ib.addinInfo=Aa.addinInfo;Array.add(Q,Ib)}0<Q.length&&("WN"===n?Q.sort((ha,Aa)=>ha.addinInfo.releaseDate<Aa.addinInfo.releaseDate?1:-1):"TD"===n?Q.sort((ha,Aa)=>ha.addinInfo.diffAUP<Aa.addinInfo.diffAUP?1:-1):Q.sort((ha,Aa)=>ha.addinInfo.AUP<Aa.addinInfo.AUP?1:-1),this.HPe[n]=Q)}0<d.length&&F.ULS.sendTraceTag(507892611,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",d.length,d.toString())}return this.HPe}Nkm(d,n,B,Q){B=Object.assign(new ab.a,{Id:`${Q}CategoryAddinListSection`,
ControlsId:`${Q}CategoryAddinListSection.Controls`,ControlList:[],Title:B});for(let ha=0;ha<n&&ha<d.length;ha++)this.Zwi(B.ControlList,`${Q}_CategoryAddinListItem`,ha.toString(),d[ha]);d={["category"]:Q,["solutionIds"]:d.slice(0,n).map(ha=>this.E1({solutionId:ha.solutionId,storeType:ha.storeType,storeId:ha.storeId,assetId:ha.assetId}))};cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.ShowCategoryAddinsFromFlyout",dataFields:zf.a.iG(d)}));return B}E1(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
d.storeType,d.assetId,null,null,d.storeId)}Zqm(d){switch(d){case "APIC":return CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts;case "APID":return CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndDiagrams;case "BBM":return CommonUIStrings.l_AddInCategoryTitleBuildByMicrosoft;case "CAIP":return CommonUIStrings.l_AddInCategoryTitleDesigningAnInteractivePresentation;case "DA":return CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis;case "DWT":return CommonUIStrings.l_AddInCategoryTitleDesigningWithTemplates;
case "ER":return CommonUIStrings.l_AddInCategoryTitleEducationalPurpose;case "FA":return CommonUIStrings.l_AddInCategoryTitleFinancialAnalytics;case "IPWAI":return CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI;case "TD":return CommonUIStrings.l_AddInCategoryTitleTrendingAddins;case "WN":return CommonUIStrings.l_AddInCategoryTitleNewAddins;case "WF":return CommonUIStrings.l_AddInCategoryTitleWritingFluently;default:return CommonUIStrings.l_PopularAddins}}Zwi(d,n,B,Q){n=this.zwf(n,
B,Q);Array.add(d,n)}zwf(d,n,B){const Q={default:"AddinFlyoutControl"+B.solutionId},ha=this.v4c(B),Aa=[],bb=[],Ib=Object.assign(new En,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+B.solutionId});if(this.s9k){const oc=Object.assign(new So,{text:CommonUIStrings.l_AddInFreeLabel});Bo.includes(B.solutionId.toLowerCase())&&Array.add(Aa,oc);Array.add(Aa,Ib)}else Array.add(bb,Ib);return Object.assign(new Vn.a,{Id:d+n,ExternalId:d+n,CommandId:d+n,CommandIdMapped:Z.a.raj.toString(),
iconSet:Q,SecondaryLabel:null,Details:Aa,Label:B.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:B.description,Links:bb,ActionId:d+"Add"+n,ActionIdMapped:Z.a.tYi.toString(),ActionCommandValueId:ha,CommandValueId:ha})}v4c(d){return this.poa?String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}c8d(d){if(!d)return null;var n=d.split("#");if(1!==n.length&&2!==n.length)return F.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;d=n[0].trim();
n=2===n.length?n[1].trim():G.AFrameworkApplication.uiCulture;return this.TRa.PXa(d,n)}H1h(d){if(!(d.solutionId in this.nWe)){const n="AddinGalleryButton"+this.Doh.toString();this.nWe[d.solutionId]=n;d=this.v4c(d);this.sFd[n]=d;this.sFd[n+"Add"]=d;this.Doh++}}NOi(d){return d?this.sFd[d]:null}cJf(d,n){const B=Object.assign(new ab.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});d=Object.assign(new Uk.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:d,Label:n,RetryButtonTitle:"",
OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===d?n:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(B.ControlList,d);return B}yel(d,n){var B=new ma.a;for(let Q=0;Q<d.length;Q++)B.add(d[Q]);if(this.z3b||!this.G6a)30<B.count&&(B=this.bjo(B)),this.G6a=B.toArray();for(d=0;d<this.G6a.length;d++)for(B=0;B<n.length;B++)if(this.G6a[d].solutionId.toLowerCase()===n[B].solutionId.toLowerCase()){Array.remove(this.G6a,this.G6a[d--]);break}return this.G6a}vMm(d){var n=30,B=(new Date).getDate();
n>d.length&&(n=d.length);var Q=new Sr(B);for(B=new Set;B.size<n;){const ha=Q.next(d.length);B.add(ha)}for(n=0;n<d.length;n++)Q=d[n].addinInfo,B.has(n)?Q.AUP*=20:Q.AUP=1===Q.priority?4*Q.AUP:2===Q.priority?2*Q.AUP:1*Q.AUP;d.sort((ha,Aa)=>ha.addinInfo.AUP<Aa.addinInfo.AUP?1:-1);return d}qVm(d,n){d=d.filter(B=>!n.some(Q=>Q.solutionId.toLowerCase()===B.solutionId.toLowerCase()));return this.vMm(d).slice(0,30)}wCo(d){if(0===d.errorCode||2===d.wV&&5===d.errorCode)d.ED?this.vCo(d.ED):F.ULS.sendTraceTag(509687429,
220,10,`fail to register icons for addin collection: ${$k[d.wV]}`)}vCo(d){var n,B,Q,ha;for(let Aa=0;Aa<d.length;Aa++)d[Aa]&&d[Aa].solutionId&&d[Aa].iconUrl?appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+d[Aa].solutionId,d[Aa].iconUrl):F.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(B=null===(n=d[Aa])||void 0===n?void 0:n.solutionId)&&void 0!==B?B:"null",null!==(ha=null===(Q=d[Aa])||void 0===Q?void 0:Q.iconUrl)&&void 0!==ha?
ha:"null")}zJl(d,n,B,Q=!1){var ha=CommonUIStrings.l_MyAddinSection;const Aa=Object.assign(new ab.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[],Title:ha}),bb=Object.assign(new vp.a,{Id:"MRUAddinsGalleryControl",ExternalId:"MRUAddinsGalleryControl",GalleryStyle:this.KAm(),Width:3,Type:4,GallerySections:[]});Array.add(d.MenuSectionList,Aa);Array.add(Aa.ControlList,bb);d=this.Fko(ha,n,B);Q&&Array.add(d.GalleryButtons,this.Alm());bb.GallerySections.push(d)}Nko(d){if(d)try{d.MenuItems=
this.gOm()}catch(n){F.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(n?n.toString():""))}else F.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}get m0h(){return"Dev Box"===G.AFrameworkApplication.J.rb("StatusBarEnvironmentNameToUse")}get s9k(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFreeLabelExpEnabled",!1)}}Object(D.a)(nn,"AppsFlyoutGenerator",null,[11]);var $p=e(993);class zj{}zj.solutionId=
"solutionId";zj.version="version";zj.storeType="storeType";zj.storeId="storeId";zj.assetId="assetId";zj.assetStoreId="assetStoreId";zj.displayName="displayName";zj.targetType="targetType";zj.isAddinCommands="isAddinCommands";zj.height="height";zj.width="width";zj.sharedRuntimeId="sharedRuntimeId";zj.backgroundState="backgroundState";Object(D.a)(zj,"InsertAgaveParametersConstantsString",null,[]);class xr extends Ea.a{constructor(d,n,B,Q){super();this.Zya="calc(100% - 46px)";this.rSa="15px";this.$ya=
"0";this.nJc="WACDialogPanel";this.s3=695;this.oJc=462;this.U_="80%";this.FGc=350;this.fjb="100%";this._frame=null;this.Md=5;this.$g="AddinInstallDialog";this.P6b=d;this.Hza=n;this.uXk=B;this.OMk=Q}QW(){super.QW();this.zr.style.width=this.fjb;this.zr.style.height=this.Zya;this.zr.style.marginTop=this.rSa;this.zr.style.padding=this.$ya;document.getElementById(this.Vj("WACDialogButtonPanel")).style.display="none";this.Vpb.setAttribute("tabindex","0");$addHandler(this.Vpb,"keyup",Object(X.a)(this,this.WB,
"onKeyUp"));const d=document.createElement("iframe");d.setAttribute("id","InstallAddinDialog");d.setAttribute("src","about:blank");d.setAttribute("width","100%");d.setAttribute("height","100%");d.setAttribute("marginHeight","0");d.setAttribute("marginWidth","0");d.setAttribute("frameBorder","0");d.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const n=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.P6b,this.Hza,this.uXk);d.setAttribute("src",n);this._frame=d;$addHandler(d,"load",Object(X.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(X.a)(this,this.onMessage,"onMessage"));this.zr.appendChild(d);this.zr.appendChild(this.dMl())}dMl(){const d=document.createElement("div");d.setAttribute("tabindex","0");$addHandler(d,"focus",Object(X.a)(this,this.T6n,"onLoopPivotFocus"));return d}WB(d){13!==d.keyCode&&32!==d.keyCode||this.hide()}T6n(){this.Vpb.focus()}onLoad(){this._frame.focus()}onMessage(d){d=
d.rawEvent;if(d.source===this._frame.contentWindow&&(d=(d=d.data)?d.split("|"):null)&&0<d.length&&("REFRESH_REQUIRED"===d[0]||"PRELOAD_MANIFEST"===d[0])){Xg.a.instance.setItem("refreshRequired","true");const n={};n.solutionId=d[1];n.version=xr.fZn(d[3]);n.storeType=d[4];n.storeId=d[5];n.assetId=d[6];n.targetType=xr.gho(d[2]);n.assetStoreId=d[7];n.width=parseInt(d[8]);n.height=parseInt(d[9]);this.OMk(n)}}Ria(){this.zr.style.width=this.fjb;this.zr.style.height=this.Zya;this.zr.style.marginTop=this.rSa;
this.zr.style.padding=this.$ya;this.s3>lf.a.pageWidth?(this.Yc.style.width=String.format("{0}px",lf.a.pageWidth),this.Yc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?this.Yc.style.right="0":this.Yc.style.left="0"):(this.Yc.style.width=String.format("{0}px",this.s3),this.Yc.style.overflowX="hidden");this.Yc.offsetHeight>lf.a.pageHeight||this.oJc+50>lf.a.pageHeight?(this.Yc.style.height=String.format("{0}px",lf.a.pageHeight),this.Yc.style.overflowY="scroll",this.Yc.style.top="0",G.AFrameworkApplication.isRtl?
this.Yc.style.right="0":this.Yc.style.left="0",this.zr.style.minHeight=String.format("{0}px",this.FGc)):(this.Yc.style.overflowY="hidden",this.Yc.style.top="10%",this.Yc.style.height=this.U_);this.CKa()}CKa(){if(this.Yc){var d=this.Yc.style.zIndex;this.Yc.style.zIndex="-9999";if(this.s3>lf.a.pageWidth)G.AFrameworkApplication.isRtl?this.Yc.style.marginRight="0":this.Yc.style.marginLeft="0";else{const n=String.format("{0}px",Math.floor(-this.Yc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Yc.style.marginRight=
n:this.Yc.style.marginLeft=n;G.AFrameworkApplication.isRtl?this.Yc.style.right="50%":this.Yc.style.left="50%"}this.Yc.style.zIndex=String(d)}else F.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}JP(){super.JP();const d=document.getElementById(this.Vj(this.nJc));d.style.width=String.format("{0}px",this.s3);d.style.height=this.U_}get jrb(){return this.zr}dispose(){super.dispose();$removeHandler(window,"message",Object(X.a)(this,this.onMessage,"onMessage"))}static gho(d){switch(d){case "1":return 0;
case "2":return 1;default:return 0}}static fZn(d){const n=d.split(".");for(let B=0;B<4-n.length;B++)d+=".0";return d}}Object(D.a)(xr,"AddinInstallDialog",Ea.a,[]);class fm extends Ea.a{constructor(){super();this.Zya="calc(100% - 46px)";this.rSa="15px";this.$ya="0";this.nJc="WACDialogPanel";this.s3=695;this.oJc=462;this.U_="80%";this.FGc=350;this.fjb="100%";this.Md=5;this.$g="AppsForOfficeInsertionDialog";this.sUe=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("OfficeAddinEnableInsertDialogAccessibilityFix")}QW(){var d;
super.QW();this.zr.style.width=this.fjb;this.zr.style.height=this.Zya;this.zr.style.marginTop=this.rSa;this.zr.style.padding=this.$ya;if(null===(d=G.AFrameworkApplication.J)||void 0===d?0:d.isChangeGateEnabled("AddInDialogBugFix"))this.Aka.classList.add("AddInDialog"),this.zr.classList.add("AddInDialog")}Ria(){this.zr.style.width=this.fjb;this.zr.style.height=this.Zya;this.zr.style.marginTop=this.rSa;this.zr.style.padding=this.$ya;this.s3>lf.a.pageWidth?(this.Yc.style.width=String.format("{0}px",
lf.a.pageWidth),this.Yc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?this.Yc.style.right="0":this.Yc.style.left="0"):(this.Yc.style.width=String.format("{0}px",this.s3),this.Yc.style.overflowX="hidden");this.Yc.offsetHeight>lf.a.pageHeight||this.oJc+50>lf.a.pageHeight?(this.Yc.style.height=String.format("{0}px",lf.a.pageHeight),this.Yc.style.overflowY="scroll",this.Yc.style.top="0",G.AFrameworkApplication.isRtl?this.Yc.style.right="0":this.Yc.style.left="0",this.sUe||(this.Yc.style.marginTop=
"-48px"),this.zr.style.minHeight=String.format("{0}px",this.FGc)):(this.Yc.style.overflowY="hidden",this.Yc.style.top="10%",this.Yc.style.height=this.U_);this.CKa()}CKa(){if(this.Yc){var d=this.Yc.style.zIndex;this.Yc.style.zIndex="-9999";if(this.s3>lf.a.pageWidth)G.AFrameworkApplication.isRtl?this.Yc.style.marginRight="0":this.Yc.style.marginLeft="0";else{const n=String.format("{0}px",Math.floor(-this.Yc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Yc.style.marginRight=n:this.Yc.style.marginLeft=
n;G.AFrameworkApplication.isRtl?this.Yc.style.right="50%":this.Yc.style.left="50%"}this.Yc.style.zIndex=String(d)}else F.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}JP(){super.JP();const d=document.getElementById(this.Vj(this.nJc));d.style.width=String.format("{0}px",this.s3);d.style.height=this.U_}get jrb(){return this.zr}}Object(D.a)(fm,"AppsForOfficeInsertionDialog",Ea.a,[1914]);var To=e(796);class Co extends Ea.a{constructor(d=!0,n=!0,B=null){super();this.Zya=
"calc(100% - 46px)";this.rSa="15px";this.$ya="0";this.nJc="WACDialogPanel";this.s3=695;this.oJc=462;this.U_="80%";this.FGc=350;this.fjb="100%";this.Xjh=this.cHd=null;this.Izk="auto";this.Jzk="5px";this.Kzk="auto";this.Hzk="40px";this.nDd="100px";this.pJc="200px";this.Md=5;this.$g="SDXDialog";this.slb=d;this.b9c=n;this.eDd=B}QW(){super.QW();this.zr.style.width=this.fjb;this.zr.style.height=this.Zya;this.zr.style.marginTop=this.rSa;this.zr.style.padding=this.$ya}Ria(){this.zr.style.width=this.fjb;this.zr.style.height=
this.slb?this.Zya:"100%";this.zr.style.marginTop=this.slb?this.rSa:"0px";this.zr.style.padding=this.$ya;if(this.slb){this.nDd&&this.pJc&&(this.s3=parseInt(this.pJc.substring(0,this.pJc.length-2)),this.U_=this.nDd);this.s3>lf.a.pageWidth?(this.Yc.style.width=String.format("{0}px",lf.a.pageWidth),this.Yc.style.overflowX="scroll",G.AFrameworkApplication.isRtl?this.Yc.style.right="0":this.Yc.style.left="0"):(this.Yc.style.width=String.format("{0}px",this.s3),this.Yc.style.overflowX="hidden");if(this.Yc.offsetHeight>
lf.a.pageHeight||this.oJc+50>lf.a.pageHeight)this.Yc.style.height=String.format("{0}px",lf.a.pageHeight),this.Yc.style.overflowY="scroll",this.Yc.style.top="0",G.AFrameworkApplication.isRtl?this.Yc.style.right="0":this.Yc.style.left="0",this.zr.style.minHeight=String.format("{0}px",this.FGc);else{this.Yc.style.overflowY="hidden";const d="%"===this.U_.substring(this.U_.length-1,this.U_.length),n=d?parseInt(this.U_.substring(0,this.U_.length-1)):parseInt(this.U_.substring(0,this.U_.length-2));this.Yc.style.top=
d?(100-n)/2+"%":100*(lf.a.pageHeight-n)/lf.a.pageHeight/2+"%";this.Yc.style.height=this.U_}this.CKa()}else this.Yc.style.left=this.Izk,this.Yc.style.right=this.Jzk,this.Yc.style.top=this.Kzk,this.Yc.style.bottom=this.Hzk,this.Yc.style.width=this.pJc,this.Yc.style.height=this.nDd,this.Yc.style.overflowX="hidden",this.Yc.style.overflowY="hidden"}CKa(){if(this.Yc){var d=this.Yc.style.zIndex;this.Yc.style.zIndex="-9999";if(this.s3>lf.a.pageWidth)G.AFrameworkApplication.isRtl?this.Yc.style.marginRight=
"0":this.Yc.style.marginLeft="0";else{const n=String.format("{0}px",Math.floor(-this.Yc.offsetWidth/2));G.AFrameworkApplication.isRtl?this.Yc.style.marginRight=n:this.Yc.style.marginLeft=n;G.AFrameworkApplication.isRtl?this.Yc.style.right="50%":this.Yc.style.left="50%"}this.Yc.style.zIndex=String(d)}else F.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}JP(){super.JP();const d=document.getElementById(this.Vj(this.nJc));d.style.width=String.format("{0}px",this.s3);d.style.height=
this.U_}get Ybd(){return this.slb}get jrb(){return this.zr}get instanceId(){return this.cHd}set instanceId(d){this.cHd=d}get Q0c(){return this.Xjh}set Q0c(d){this.Xjh=d}J_o(d,n){this.nDd=d;this.pJc=n}}Object(D.a)(Co,"SDXDialog",Ea.a,[]);var fo=e(377),Jq=e(101),gm=e(148),Lp=e(967);const Mp={["TD"]:[{solutionId:"wa104380122",addinInfo:{diffAUP:15470}},{solutionId:"wa104381155",addinInfo:{diffAUP:12986}},{solutionId:"wa104381909",addinInfo:{diffAUP:14180}},{solutionId:"wa104382081",addinInfo:{diffAUP:13315}},
{solutionId:"wa200000113",addinInfo:{diffAUP:14716}},{solutionId:"wa200003944",addinInfo:{diffAUP:13475}},{solutionId:"wa200004257",addinInfo:{diffAUP:17792}},{solutionId:"wa200005287",addinInfo:{diffAUP:24135}}],["WN"]:[{solutionId:"wa200004216",addinInfo:{releaseDate:16863264E5}},{solutionId:"wa200005106",addinInfo:{releaseDate:16751808E5}},{solutionId:"wa200005817",addinInfo:{releaseDate:16886592E5}},{solutionId:"wa200005826",addinInfo:{releaseDate:16910784E5}},{solutionId:"wa200005983",addinInfo:{releaseDate:16960032E5}},
{solutionId:"wa200006000",addinInfo:{releaseDate:16947072E5}},{solutionId:"wa200006001",addinInfo:{releaseDate:16872768E5}}],["IPWAI"]:[{solutionId:"wa200005107",addinInfo:{priority:1,AUP:11261}},{solutionId:"wa104381714",addinInfo:{priority:1,AUP:1947}},{solutionId:"wa200005312",addinInfo:{priority:1,AUP:385}},{solutionId:"wa200005287",addinInfo:{priority:1,AUP:8795}},{solutionId:"wa200005260",addinInfo:{priority:1,AUP:305}},{solutionId:"wa200005444",addinInfo:{priority:1,AUP:1023}},{solutionId:"wa200005502",
addinInfo:{priority:1,AUP:1276}}],["WF"]:[{solutionId:"wa104382081",addinInfo:{priority:1,AUP:60346}},{solutionId:"wa200001011",addinInfo:{priority:1,AUP:65470}},{solutionId:"wa200000368",addinInfo:{priority:1,AUP:11603}},{solutionId:"wa104381727",addinInfo:{priority:1,AUP:1322}},{solutionId:"wa200003478",addinInfo:{priority:1,AUP:935}},{solutionId:"wa104380050",addinInfo:{priority:1,AUP:3794}},{solutionId:"wa200000011",addinInfo:{priority:1,AUP:412}},{solutionId:"wa200000199",addinInfo:{priority:1,
AUP:2144}},{solutionId:"wa104382046",addinInfo:{priority:1,AUP:917}},{solutionId:"wa104381613",addinInfo:{priority:1,AUP:1450}},{solutionId:"wa104381658",addinInfo:{priority:1,AUP:1055}},{solutionId:"wa200001841",addinInfo:{priority:1,AUP:297}},{solutionId:"wa104381841",addinInfo:{priority:1,AUP:264}},{solutionId:"wa200005339",addinInfo:{priority:1,AUP:299}}],["ER"]:[{solutionId:"wa104381909",addinInfo:{priority:1,AUP:6950}},{solutionId:"wa200001482",addinInfo:{priority:1,AUP:921}},{solutionId:"wa200002534",
addinInfo:{priority:1,AUP:648}},{solutionId:"wa104380848",addinInfo:{priority:1,AUP:281}},{solutionId:"wa104380917",addinInfo:{priority:1,AUP:3282}},{solutionId:"wa104380429",addinInfo:{priority:1,AUP:88}},{solutionId:"wa200004257",addinInfo:{priority:1,AUP:47226}},{solutionId:"wa104380122",addinInfo:{priority:1,AUP:4913}},{solutionId:"wa200002334",addinInfo:{priority:1,AUP:2232}},{solutionId:"wa200002891",addinInfo:{priority:1,AUP:509}}],["APID"]:[{solutionId:"wa104380121",addinInfo:{priority:1,
AUP:3009}},{solutionId:"wa104379997",addinInfo:{priority:1,AUP:708}},{solutionId:"wa104379370",addinInfo:{priority:1,AUP:1672}},{solutionId:"wa200000113",addinInfo:{priority:1,AUP:3928}},{solutionId:"wa104051163",addinInfo:{priority:1,AUP:2180}},{solutionId:"wa104379279",addinInfo:{priority:1,AUP:2137}},{solutionId:"wa200000729",addinInfo:{priority:1,AUP:1914}},{solutionId:"wa104381063",addinInfo:{priority:1,AUP:632}},{solutionId:"wa200002281",addinInfo:{priority:1,AUP:1284}},{solutionId:"wa104381411",
addinInfo:{priority:1,AUP:232}},{solutionId:"wa200001486",addinInfo:{priority:1,AUP:42}},{solutionId:"wa104218065",addinInfo:{priority:1,AUP:3733}},{solutionId:"wa104178141",addinInfo:{priority:1,AUP:1614}},{solutionId:"wa104380118",addinInfo:{priority:1,AUP:1218}},{solutionId:"wa104380278",addinInfo:{priority:1,AUP:390}},{solutionId:"wa104381155",addinInfo:{priority:1,AUP:10724}},{solutionId:"wa200003944",addinInfo:{priority:1,AUP:9181}},{solutionId:"wa104381519",addinInfo:{priority:1,AUP:146}},
{solutionId:"wa104381637",addinInfo:{priority:1,AUP:133}},{solutionId:"wa103296784",addinInfo:{priority:1,AUP:148}},{solutionId:"wa200003220",addinInfo:{priority:1,AUP:162}},{solutionId:"wa200005313",addinInfo:{priority:1,AUP:292}},{solutionId:"wa200005298",addinInfo:{priority:1,AUP:53}}]},fr={};class Xm{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc=null){this.nGc=null;this.Kuk=6E4;this.aBd=3E3;this.yLb=!1;this.P6=this.THb=null;this.Och=6E4;this.F$b=!1;this.LQe=3E3;this.KQe=0;this.PRa=this.Uea=this.yJa=null;
this.meh=!1;this.MOa=(Ac,ad)=>{!this.UGj||this.qT?this.F$b||(this.F$b=!0,this.znd()):2!==ad.wV&&3!==this.yga&&this.znd()};this.NJo=()=>{this.PRa?this.PRa.rzj():F.ULS.sendTraceTag(508049287,220,10,"_addInCategoryManager is null")};this.YQi=(Ac,ad,sd,wd,yd)=>{if(2!==sd)return 32;this.aBd&&(this.yLb=!0);if(!this.poa)return this.G_m(sd,yd);if(2!==sd)return 32;Ac=yd.Href;ad=this.P6.c8d(this.GSf(yd));if(!ad)return F.ULS.sendTraceTag(508913680,220,10,"Failed to get a valid AddinDetail object in LaunchAddinInstallDialog"),
8;ad=ad.NCc();ad={["solutionId"]:Xm.E1(ad)};ad.href=Ac;ad.UILocation=yd.UILocation;cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:zf.a.iG(ad)}));return 32};this.Y6f=(Ac,ad,sd,wd,yd)=>{if(!this.poa)return this.KFn(sd,yd);if(2!==sd)return 32;Ac=yd.SourceControlId;Ac=this.P6.c8d(this.Tin?this.GSf(yd):this.P6.NOi(Ac));if(!Ac)return F.ULS.sendTraceTag(509751330,344,10,"No add-in details."),8;Ac=Ac.NCc();this.VUb(Ac);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&
(Ac={["solutionId"]:Xm.E1(Ac)},Ac.UILocation=yd.UILocation,cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:zf.a.iG(Ac)})));return 32};this.r1m=(Ac,ad,sd,wd,yd)=>{if(2!==sd)return 32;this.kjc&&(this.yLb=!0);if(!this.poa)return this.s1m(sd,yd);if(2!==sd)return 32;Ac=this.P6.c8d(yd.CommandValueId);if(!Ac)return F.ULS.sendTraceTag(508913679,344,10,"No add-in details."),8;Ac=Ac.NCc();this.ZDc("InstalledByListView",41,Ac);this.VUb(Ac);
Ac={["solutionId"]:Xm.E1(Ac)};Ac.UILocation=yd.UILocation;cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:zf.a.iG(Ac)}));return 32};this.qao=()=>{this.nGc=Xa.a("getTheme")?appChrome.api.getTheme():null;this.Bk.value.setAppTheme(this.nGc);return this.nGc};this.P_b=(Ac,ad,sd,wd,yd)=>{if(2===sd){Ac=yd.callback;if(!Ac)return 16;this.o6i()&&yd.storeType?this.OCj(Ac,yd.storeType):this.Mro(Ac)}return 32};this.yAo=(Ac,ad,sd,
wd,yd)=>{if(2===sd)if(this.Ula)yd&&yd.Observer?this.Ula.HFa(yd.Observer):F.ULS.sendTraceTag(510248469,220,10,"RegisterAddinDetailObserver: invalid actionData: {0}",JSON.stringify(yd));else return F.ULS.sendTraceTag(512231321,220,10,"RegisterAddinDetailObserver: this.AddinDetailsManager is null."),8;return 32};this.TNn=(Ac,ad,sd,wd,yd)=>{2===sd&&F.ULS.sendTraceTag(16847762,341,50,String.format("[TellMeForOfficeAddIn-FlyoutRendered]: AppName:{0} | SessionId:{1} | Lcid:{2}",yd.LabelText,G.AFrameworkApplication.userSessionId,
G.AFrameworkApplication.lcid));return 32};this.oug=(Ac,ad,sd,wd,yd)=>{2===sd&&(Ac=yd.callback)&&this.S6k(Ac);return 32};this.uXi=(Ac,ad,sd,wd,yd)=>{wd=yd.ownerAddinSolutionId||yd.solutionId;Ac=G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring");sd=yd.targetType;wd=this.fAd.n8d(wd);var be=1===sd&&wd&&wd.settings?wd.settings:{};Ac||!wd||Xm.jg(wd.sharedRuntimeId)||(yd.sharedRuntimeId=wd.sharedRuntimeId,yd.backgroundState=wd.backgroundState);
const ye=!Xm.jg(yd.sharedRuntimeId);var Qe=yd.storeType;const af=yd.ownerAddinStoreType;let Qf;!Ac&&ye?(Qf=yd.ownerAddinSolutionId||yd.solutionId,Qe=af||Qe):Qf=yd.solutionId;const hf=(new Jh.a(Ze.a.create(),1)).toString();be=new Kk.a(hf,Qf,yd.version,yd.storeId,Qe,be);be.assetId=yd.assetId;be.assetStoreId=yd.assetStoreId;be.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;be.osfControlType=sd;be.sharedRuntimeId=yd.sharedRuntimeId;be.backgroundState=Ac?wd?wd.backgroundState:be.backgroundState:
yd.backgroundState;be.isPreload=ye&&1===be.backgroundState;void 0!==yd.isAddinCommands&&(be.isAddinCommands=yd.isAddinCommands);void 0!==yd.addinCommandsActionType&&(be.addinCommandsActionType=yd.addinCommandsActionType);be.isAddinCommands&&(be.ownerAddinSolutionId=yd.ownerAddinSolutionId,be.ownerAddinStoreType=af);be.isResizable=!0;be.resizeMinWidth=$p.a.taskPaneWidth;1===sd?this.yin(be,yd.displayName):0===sd&&this.Vea.value.ZYf(ad,yd.width,yd.height,be);this.sa.raiseEvent("OnAppForOfficeActivated",
this.hHl(be));return 32};this.Vea=d;this.Bk=B;this.oc=Q;this.hr=ha;this.ga=Aa;this.za=bb;this.fAd=Ib;this.h$b=oc;this.OLk=!oc;null!=this.za&&this.za.getIntFeatureGate("DismissAddinFlyoutTime",this.aBd);this.WMb&&(this.Ula?(this.P6=new nn(this.ga,this.Ula,"3935259562","2544406033","1945259303",this.za,this.o2k,this.lfc?this.Yqm():{}),this.drc()&&(this.Ula.HFa(this.MOa),this.qT?window.setTimeout(()=>{this.F$b||(this.F$b=!0,this.znd(),F.ULS.sendTraceTag(508630613,220,15,"Timeout occurs even when the initializer's fix is applied."))},
this.Och):this.UGj?this.aEf(this.LQe):window.setTimeout(()=>{this.F$b||(this.F$b=!0,this.znd(),F.ULS.sendTraceTag(509088386,220,15,"AddinDetailsManager not triggered"))},this.Och))):F.ULS.sendTraceTag(509749262,220,10,"AddinDetailsManger is null"));this.hza=null;this.Gtk=Object(X.a)(this,this.ZDc,"userActionHandler");this.sa=new dc.a;this.A6b=this.vAa=this.eCh=null;G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddInThemes",!1)&&(this.nGc=Xa.a("getTheme")?appChrome.api.getTheme():
null)}aEf(d){window.setTimeout(()=>{this.ADo()},d)}get qT(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get kjc(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DismissFlyoutCollectionEnabled",!1)}ADo(){0===this.yga?(F.ULS.sendTraceTag(508830284,220,15,"commandRegistrationState: {0}, the 1st attempt was timeout, explicitly call queryAddinDetails.",mn[this.yga]),this.lU(0,!0),this.aEf(this.LQe)):1===this.yga?
(F.ULS.sendTraceTag(508830283,220,50,"commandRegistrationState: {0}, wait for queryAddinDetails for a few more seconds to complete.",mn[this.yga]),this.yga=2,this.aEf(3*this.LQe)):2===this.yga?(F.ULS.sendTraceTag(508839687,220,15,"commandRegistrationState: {0}, the 2nd attempt was timeout, register the command anyway and complete.",mn[this.yga]),this.znd()):F.ULS.sendTraceTag(508839686,220,50,"commandRegistrationState: {0}, registration completed.",mn[this.yga])}get Ula(){this.oVd&&!this.Uea&&(this.Uea=
ms.createInstance(this.za,this.Bk,{["AppsForOfficeAllowExternalMarketplace"]:this.za.$("AppsForOfficeAllowExternalMarketplace"),["AppsForOfficeThirdPartyIsDisabled"]:this.za.$("AppsForOfficeThirdPartyIsDisabled"),["AreThirdPartyAddInsAllowed"]:G.AFrameworkApplication.B8a,["PopularAddinDetailsJsonString"]:this.gzb,["UICulture"]:G.AFrameworkApplication.uiCulture}));return this.Uea}get o2k(){this.mfg&&!this.PRa&&(this.PRa=new Qh(this.za,this.Ula,this.jko));return this.PRa}get poa(){return this.drc&&
this.Xjf}get A4b(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get lfc(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}get q1l(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get Xjf(){return(this.za||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}drc(){return(this.za||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}get jko(){return`[{"title":"${CommonUIStrings.l_AddInCategoryTitleWritingFluently}","solutionIds":["wa200001011","wa200000368","wa104381714","wa200002281","wa200005107","wa200003478","wa104380050","wa104380449","wa104380140","wa104380519","wa104380278"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleEducationalPurpose}","solutionIds":["wa104099688","wa104382081","wa104381909","wa104379370","wa200001482","wa200002534","wa104380848","wa200001486","wa104380917","wa104380429"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndDiagrams}","solutionIds":["wa104380121","wa104051163","wa200000113","wa104379279","wa104218065","wa104381063","wa104379997","wa200000729","wa200001486","wa104178141","wa104380118"]}]`}get isBusinessUser(){return!!G.AFrameworkApplication.sessionStartInfoSettings.IsBusinessUser}get isEduUser(){return!!G.AFrameworkApplication.sessionStartInfoSettings.IsEduUser}get isAnonymousUser(){return this.za.$("IsAnonymousUser")}Eol(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}Yqm(){return this.q1l&&
this.isBusinessUser?fr:Mp}get UGj(){return(this.za||G.AFrameworkApplication.J).getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}get oVd(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get WMb(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.oVd}get mfg(){return!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1)}get nt(){return this.Bk.value}get uip(){this.yJa||(this.yJa={},this.yJa.InsertAddInsFromBackstage="Backstage",this.yJa.InsertMoreAddInsFromBackstageFooter="InsertMoreAddInsFromBackstageFooter",this.yJa.LaunchMyAddInsFromBackstage="BackstageSeeAll",this.yJa.InsertAddIns="Ribbon",this.yJa.LaunchAddinDialogFromTellMe="TellMe",this.yJa.TeachingCallout="TeachingCallout",this.yJa.AddinFlyoutMoreButton="AddinFlyoutSeeAll",this.yJa.InsertMoreAddInsFromFooter="InsertMoreAddInsFromFooter");return this.yJa}mc(){this.ga.nb(Z.a.led,
S.a.frame,Object(X.a)(this,this.led,"launchAppForOfficeDialog"),4);this.ga.nb(Z.a.P_b,S.a.frame,this.P_b,96);this.ga.nb(Z.a.zAo,S.a.frame,this.yAo,96);this.ga.qa(Z.a.Qqp,S.a.frame,this.TNn);this.ga.qa(Z.a.oug,S.a.frame,this.oug);this.ga.qa(Z.a.lZf,S.a.frame,this.uXi);this.ga.qa(Z.a.TXi,S.a.frame,this.uXi);this.ga.qa(Z.a.w5d,S.a.frame,Object(X.a)(this,this.jRi,"handleExecuteAddinAction"));this.ga.qa(Z.a.UZj,S.a.frame,Object(X.a)(this,this.G2m,"handleShowExtensionTaskPane"));this.ga.qa(Z.a.K8h,S.a.frame,
Object(X.a)(this,this.h0m,"handleCloseExtensionTaskPane"));this.ga.qa(Z.a.GMj,S.a.frame,Object(X.a)(this,this.r2m,"handleRestartExtensionTaskPane"));this.ga.qa(Z.a.Ike,S.a.frame,Object(X.a)(this,this.A1m,"handleLaunchSDXDialog"));this.ga.qa(Z.a.S8l,S.a.frame,Object(X.a)(this,this.Q0m,"handleEnterAddinBackstageAction"));this.WMb&&(this.ga.qa(Z.a.dFn,S.a.frame,Object(X.a)(this,this.uRi,"handleLaunchAddinInstallDialog")),this.ga.qa(Z.a.Y6f,S.a.frame,this.Y6f),this.drc()||this.ga.qa(Z.a.szj,S.a.frame,
Object(X.a)(this,this.GRi,"handlePopulateAddInGallery")),this.ga.nb(Z.a.Ero,S.a.frame,Object(X.a)(this,this.m2m,"handleQueryAddInFlyout"),100),this.ga.qa(Z.a.M2k,S.a.frame,this.YQi));if(this.mfg||this.WMb)this.ga.qa(Z.a.raj,S.a.frame,Object(X.a)(this,this.z1m,"handleLaunchAddinInstallDialogFromList")),this.ga.qa(Z.a.tYi,S.a.frame,this.r1m);G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddInThemes",!1)&&Xa.a("registerOnThemeChangeCallback")&&(this.Bk.value.setAppTheme(this.nGc),
appChrome.api.registerOnThemeChangeCallback(this.qao))}znd(){this.yga=3;this.ga.qa(Z.a.szj,S.a.frame,Object(X.a)(this,this.GRi,"handlePopulateAddInGallery"))}mAj(){return new ma.a}jRi(d,n,B,Q,ha){if(2!==B)return 32;d=ha[Jc.a.Z2c];n=ha[Jc.a.G$h];if(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.CG.VSO8102927_UseComponentTypeAsTaskpaneForWord")){if("Action"!==n&&"Taskpane"!==n)return 8}else if("Action"!==n)return 8;n=ha[Jc.a.cZc];B=ha[Jc.a.sjd];Q=B.optionalProperties[mk.a.nRh];
var Aa=(ha=this.sPf(ha))?this.Z$a(ha):null;Aa||(ha=new Xc.a,Aa=B.optionalProperties[mk.a.taskPaneWidth],0<=Aa&&(ha.taskPaneWidth=Aa),ha.AU=B.optionalProperties[mk.a.AU],ha.sourceLocationOverrideResourceId=B.optionalProperties[mk.a.sourceLocationOverrideResourceId],ha.DW=B.gjc,ha.onTaskPaneClose=B.optionalProperties[mk.a.onTaskPaneClose],ha.onExtensionLaunchCallback=B.optionalProperties[mk.a.onExtensionLaunchCallback],ha.aad=B.optionalProperties.InstanceToken?B.optionalProperties.InstanceToken:(new Jh.a(Ze.a.create(),
1)).toString(),ha.isPreload=!0,Aa=ha.aad,this.l6(d.getId(),ha,!0));return this.MEf(Aa,n,Q)?32:8}z1m(d,n,B,Q,ha){if(2!==B)return 32;this.kjc&&(this.yLb=!0);return ha&&"LinkClickedPayload"===ha.Type?this.YQi(d,n,B,Q,ha):this.uRi(d,n,B,Q,ha)}uRi(d,n,B,Q,ha){if(2!==B)return 32;d=this.NRm(ha);if(!d)return F.ULS.sendTraceTag(509687395,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;n=this.Bk.value?this.Bk.value.getAppUILocale()||"en-US":"en-US";this.A6b=new xr(d,"wac_word",
n,Aa=>{Aa.fromInstallDialog=!0;Aa.UILocation=ha.UILocation;this.ZDc("0",3,Aa)});this.A6b.ti("",null,null);return 32}NRm(d){var n=null;if(!d)return n;if(this.poa){if(d=this.P6.c8d(this.GSf(d)))n=d.solutionId}else n=d.CommandValueId,n=Ic.c(n)?this.P6.Xuf[d.SourceControlId]:n;return n}GSf(d){let n;if(!d)return null;(n=d.CommandValueId)||(n=this.P6.NOi(d.SourceControlId));return n}A1m(d,n,B,Q,ha){return 2!==B?32:this.Ike(ha[Jc.a.Z2c],ha[Jc.a.sjd])?32:8}Q0m(d,n,B){if(2!==B)return 32;!this.poa&&!this.A4b||
this.meh||(this.Ula.HFa(this.NJo),this.meh=!0);this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowBackstageSurveyEnabled",!1)&&this.P6.Xvl()&&(this.kFd=new uo("AddinBackstageFeedbackSurvey",this.za.getIntFeatureGate("Microsoft.Office.SharedOnline.BackstageSurveyTriggerTime",this.Kuk)),this.kFd.taj());return 32}G2m(d,n,B,Q,ha){if(2!==B)return 32;const Aa=ha[Jc.a.Z2c],bb=ha[Jc.a.cZc],Ib=ha[Jc.a.sjd],oc=new Xc.a,Ac=Ib.optionalProperties[mk.a.taskPaneWidth];if(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.CG.VSO8102927_UseComponentTypeAsTaskpaneForWord")&&
null!=Ib.optionalProperties[mk.a.actionName])return this.jRi(d,n,B,Q,ha);0<=Ac&&(oc.taskPaneWidth=Ac);oc.AU=Ib.optionalProperties[mk.a.AU];oc.sourceLocationOverrideResourceId=Ib.optionalProperties[mk.a.sourceLocationOverrideResourceId];oc.DW=Ib.gjc;oc.onTaskPaneClose=Ib.optionalProperties[mk.a.onTaskPaneClose];oc.onExtensionLaunchCallback=Ib.optionalProperties[mk.a.onExtensionLaunchCallback];oc.showLoadingSpinner=Ib.optionalProperties[mk.a.showLoadingSpinner];oc.cZc=bb;Ib.optionalProperties.InstanceToken&&
(oc.aad=Ib.optionalProperties.InstanceToken);return this.l6(Aa.getId(),oc,!0)?32:8}m2m(d,n,B){return 2!==B||this.P6.m0h?32:(d=!G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&G.AFrameworkApplication.B8a)&&this.P6&&!this.drc()&&this.P6.Q5h()||d&&this.P6?32:8}GRi(d,n,B,Q,ha){if(2!==B)return this.P6.Q5h()?32:8;cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.HandlePopulateAddInGallery"}));this.za.isChangeGateEnabled("ShowUserSegmentInformationEnabled")&&
(d={["UserSegment"]:this.Eol()},n=new $h.a,n.name="Office.Extensibility.Host.UserSegmentInformation",n.dataFields=zf.a.iG(d),cg.a.sendTelemetryEvent(n));this.P6.Nko(ha);this.kjc&&(this.yLb=!1,this.SAl());return 32}G_m(d,n){if(2!==d)return 32;d=n.Href;var B=n.CommandValueId;B=Ic.c(B)?this.P6.Xuf[n.SourceControlId]:B;if(!B)return F.ULS.sendTraceTag(508887646,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;const Q=this.Ula.PXa(B);if(Q){const ha={};ha.solutionId=B;ha.storeType=
Q.storeType;ha.storeId=Q.storeId;ha.assetId=Q.assetId;ha.assetStoreId=Q.assetStoreId;B={["solutionId"]:Xm.E1(ha)};B.href=d;B.UILocation=n.UILocation;cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:zf.a.iG(B)}))}return 32}s1m(d,n){if(2!==d)return 32;d=n.CommandValueId;if(!d)return F.ULS.sendTraceTag(509219802,344,10,"No solutionId."),8;const B=this.Ula.PXa(d),Q={};if(B)Q.solutionId=d,Q.version=B.version,Q.storeType=B.storeType,
Q.storeId=B.storeId,Q.assetId=B.assetId,Q.assetStoreId=B.assetStoreId,Q.targetType=B.targetType,Q.displayName=B.displayName,Q.width=B.width,Q.height=B.height,this.ZDc("InstalledByListView",41,Q),this.VUb(Q),d={["solutionId"]:Xm.E1(Q)},d.UILocation=n.UILocation,cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:zf.a.iG(d)}));else return F.ULS.sendTraceTag(509219801,344,10,"No add-in details."),8;return 32}SAl(){this.kjc&&
window.setTimeout(()=>{const d=this.bNf();d&&"hidden"==d.visibility&&!this.yLb&&F.ULS.sendTraceTag(508072718,220,15,"Flyout dismiss after {0} seconds without taking any action",this.aBd)},this.aBd)}bNf(){let d=null;try{const n=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");n&&(d=em.a.JB(n.parentNode.parentNode.parentNode))}catch(n){F.ULS.sendTraceTag(508072717,220,10,"AddinFlyout get parent and parent get exception "+(n?n.toString():""))}return d}h0m(d,n,B,Q,ha){return 2!==B?32:(d=this.sPf(ha))?
(this.qWa(d),32):8}r2m(d,n,B,Q,ha){if(2!==B)return 32;if(d=this.sPf(ha))if(d=this.Bk.value.getOsfControl(d))return d.refresh(),32;return 8}sPf(d){let n=null;const B=d[Jc.a.Z2c].getId();d=d[Jc.a.sjd].optionalProperties[mk.a.sourceLocationOverrideResourceId];B&&(n=this.x4c(B,d));return n}yin(d,n){const B=ha=>{var Aa={};Aa.solutionId=ha.solutionId;Aa.version=ha.version;Aa.storeType=ha.storeType;Aa.storeId=ha.storeId;Aa.assetId=ha.assetId;Aa.assetStoreId=ha.assetStoreId;Aa.targetType=1;ha=new ma.a;ha.add(Aa);
Aa={};Aa[gf.a.cVd]=ha;Aa[gf.a.eKa]=3;this.ga.Zb(Z.a.iXb,2,Aa)},Q=(ha,Aa)=>{this.showTaskPane(ha.solutionId,Aa,ha);this.Vea&&this.Vea.value&&this.Vea.value.fvb(ha)};G.AFrameworkApplication.J.$("OfficeJsUseExperimentHostJsIsEnabled")&&(d.hostInfoFlags|=8);if(G.AFrameworkApplication.J.$("AddInCommandsIsEnabled"))if(d.isAddinCommands)0===d.addinCommandsActionType?B(d):2===d.addinCommandsActionType?Q(d,n):3===d.addinCommandsActionType&&(this.createUILessSandbox(d.solutionId,n,d),this.Vea&&this.Vea.value&&
this.Vea.value.fvb(d));else{const ha={};G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ha.solutionId=d.solutionId,ha.version=d.version):(ha.marketplaceId=d.solutionId,ha.marketplaceVersion=d.version);ha.storeType=d.storeType;ha.storeId=d.storeId;ha.targetData=d;this.t8i(ha,(Aa,bb,Ib)=>{Ib=Ib.targetData;bb?B(Ib):Q(Ib,n);Aa||F.ULS.sendTraceTag(542978529,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.solutionId,
Ib.storeType,Ib.assetId,null,null,Ib.storeId),Ib.storeType)})}else Q(d,n)}led(d,n,B,Q,ha){if(1===B)return G.AFrameworkApplication.B8a?32:8;2===B&&(this.sa.raiseEvent("OnInsertionDialogOpened"),d=ha.SourceControlId,ha=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)?ha.Query:ha.CommandValueId,window.g_InstallOrigin=this.uip[d]||"Unknown",n=this.vgo(d),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.TellMeLaunchAddinDialogSetTabIdEnabled")&&
"LaunchAddinDialogFromTellMe"===d&&!Xm.jg(ha)?(n.navigationMode=0,n.assetId=ha,this.Psd("{98143890-AC66-440E-A448-ED8771A02D52}",n)):G.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&(this.WMb||this.mfg)?"InsertMoreAddInsFromFooter"===d||"InsertMoreAddInsFromBackstageFooter"===d?(this.Psd("{98143890-AC66-440E-A448-ED8771A02D52}",n),this.kjc&&(this.yLb=!0)):"AddinFlyoutMoreButton"===d?(this.Psd("0",n),this.kjc&&(this.yLb=!0)):this.Psd(null,n):this.Psd(null,n),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.LogTelemetryForStoreDialog")&&
(ha={["controlId"]:d},cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:zf.a.iG(ha)}))));return 32}o6i(){return G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.AllowQueryEntitledAppsForSpecificStoreType")}w5d(){return!1}MEf(){return!1}l6(d,n=null,B=!1){if(!G.AFrameworkApplication.e7i(d))return F.ULS.sendTraceTag(527720961,1403,15,"First Party Taskpane blocked: Not in allow list: {0}",d),!1;n||(n=new Xc.a);n.DW||
(n.DW={});n.DW.ShowFeedback=G.AFrameworkApplication.uE;const Q=n.aad?n.aad:(new Jh.a(Ze.a.create(),1)).toString();B=new Kk.a(Q,d,"","",B?"sdxcatalog":"firstparty",null,!1,{showResizeChatButton:n.showResizeChatButton,titleTag:n.pqp});B.activationStart=window.performance.now();B.taskPaneWidth=n.taskPaneWidth;B.sourceLocationOverrideResourceId=n.sourceLocationOverrideResourceId;B.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;B.osfControlType=1;B.onTaskPaneClose=n.onTaskPaneClose;
B.onExtensionLaunchCallback=n.onExtensionLaunchCallback;B.isModernPane=n.isModernPane;B.isResizable=n.isResizable;B.resizeMinWidth=n.resizeMinWidth;B.resizeMaxWidth=n.resizeMaxWidth;B.hostSettings=OSF.OUtil.serializeSettings(n.DW);B.settings=OSF.OUtil.serializeSettings(n.DW);B.featureGates=G.AFrameworkApplication.J.ZMf(d);B.sharedRuntimeId=n.sharedRuntimeId;B.isPreload=n.isPreload;B.showLoadingSpinner=n.showLoadingSpinner;B.isPaneAutoOpened=n.isPaneAutoOpened;d=this.x4c(B.solutionId,n.sourceLocationOverrideResourceId);
return this.showTaskPane(d,n.AU,B)}yOb(d,n=null){d=n?this.x4c(d,n.sourceLocationOverrideResourceId):this.x4c(d,null);this.qWa(d)}qWa(){}g5(){return!1}n_i(){return!1}showTaskPane(){return!0}Lbe(){return null}eKf(){return 0}nSj(){}rRh(){}a0j(){}createUILessSandbox(){}Z$a(){return null}wQa(d){var n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const B=this.$Rb();B&&(3===B.G4c(d)?(n={},n[gf.a.gVd]=d,this.ga.Zb(Z.a.wQa,2,n),n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);
return n}$Ma(d){var n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const B=this.$Rb();B&&(3===B.G4c(d)?(n={},n[gf.a.gVd]=d,this.ga.Zb(Z.a.$Ma,2,n),n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):n=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return n}G6m(d){for(const n of Fg.LYm())if(n.value.$g===d)return n.value.dialog.hide(),n.key;return null}dispose(){this.Bk&&this.Bk.value&&"undefined"!==typeof this.Bk.value.hostCheckReadyHandler&&(G.AFrameworkApplication.CIo(Object(X.a)(this.Bk.value,
this.Bk.value.hostCheckReadyHandler,"hostCheckReadyHandler")),F.ULS.sendTraceTag(590943260,1403,100,"ContextActivationManager::HostCheckReadyHandler is unregistered"))}t8i(d,n){this.Bk.value.isAddinCommandsAsync(d,n)}uom(){return Object(X.a)(this,this.XWh,"appForOfficeStatusChangedHandler")}sRh(d){this.Bk.value||F.ULS.shipAssertTag(6068437,341,!1,"ContextActivationManager unavailable while trying to activate app: {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||
d.storeType,d.assetId,null,null,d.storeId));this.Bk.value.insertOsfControl(d)}pEj(d){this.Bk.value?this.Bk.value.activateOsfControl(d):F.ULS.shipAssertTag(6431491,341,!1,"ContextActivationManager unavailable while trying to reactivate app: {0}",d)}PTl(d){this.Bk.value?this.Bk.value.deActivateOsfControl(d):F.ULS.shipAssertTag(6431492,341,!1,"ContextActivationManager unavailable while trying to deactivate app: {0}",d)}Lln(d){return this.Bk.value?2===this.Bk.value.getOsfControlStatus(d):(F.ULS.shipAssertTag(18114241,
341,!1,"ContextActivationManager unavailable while trying to firgure out if app is active: {0}",d),!1)}$Rb(){return null}ZDc(d,n,B=null){if(5===n)this.DHj(!1);else if(6===n)this.DHj(!0);else if(0===n)this.d6h(d,!1),G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb.oEa&&Lp.ShyRibbon.Fpb(1,0);else if(7===n)this.d6h(d,!0);else if(1===n)this.Ebl();else if(2===n)this.aYd();else if(3===n)this.h$b&&this.h$b.hide(),this.WMb&&this.A6b&&this.A6b.hide(),B?(this.THb=d=this.rXd(B),F.ULS.sendTraceTag(509679069,
220,50,"UserActionEnum.InsertAgave: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",Xm.E1(this.THb)),this.WMb&&"fromInstallDialog"in B&&B.fromInstallDialog?this.kgn(d,B):this.VUb(d)):F.ULS.sendTraceTag(17113349,344,10,"InsertAgave: should have valid insert agave parameters");else if(41===n)this.oVd&&B&&(this.THb=this.rXd(B),F.ULS.sendTraceTag(509674968,220,50,"UserActionEnum.ClickTrust: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",Xm.E1(this.THb)));else if(40===n)this.oVd&&this.THb&&
B&&(d=this.rXd(B),this.Tfl(this.THb,d)&&(F.ULS.sendTraceTag(509679068,220,50,"UserActionEnum.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",Xm.E1(d)),this.THb=null,this.lU(0)));else if(36===n)B?this.VUb(this.rXd(B)):F.ULS.sendTraceTag(587579545,344,10,"InsertDevManifest: should have valid insert agave parameters");else if(37===n)d={["ak1"]:this.Bk.value.getDevManifestInvalidUrlErrorString(B.manifestUrl)},this.ga.Zb(Z.a.c3b,2,d);else if(9===n)G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&
G.AFrameworkApplication.J.$("AddInCommandsLoadedInBootingIsEnabled")&&this.ga.Zb(Z.a.hug,2,B);else if(8===n)d={["ak1"]:this.Bk.value.getManifestInvaildErrorString()},this.ga.Zb(Z.a.c3b,2,d);else if(13===n||14===n)(B=this.$Rb())&&3===B.G4c(d)&&this.Bk.value.notifyAgave(d,11);else if(15===n)(d=this.G6m(d))?(B=this.$Rb())&&3!==B.G4c(d)&&this.nt.notifyAgave(d,11):(G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.SdxDialogHandleEscKey")&&this.vAa&&this.vAa.hide(),this.WMb&&
this.A6b&&this.A6b.hide());else if(23===n)cg.a.sendOtelEvent(Object.assign(new To.a,{otelEvent:B}));else if(38===n)cg.a.sendOtelCustomerContent(Object.assign(new To.a,{otelEvent:B}));else if(26===n)rc.instance.oFn(B);else if(27===n)(d=B.Id.Id)&&this.qWa(d);else if(32===n){d=this.$Rb().vom(B.solutionId);for(const Q of d)this.qWa(Q)}else n===OSF.AgaveHostAction.CloseSDXDialog&&this.vAa&&B.InstanceId===this.vAa.instanceId&&(this.vAa.hide(),this.vAa.Q0c(B.DialogCloseCallbackParam,!0))}Tfl(d,n){return ja.a.Oh().equals(d.solutionId,
n.solutionId)&&ja.a.Oh().equals(d.storeType,n.storeType)&&ja.a.Oh().equals(d.storeType,"OMEX")}XWh(){}aZo(d,n){d!==this.hza&&(n&&this.blur(),this.Bk.value&&(this.Bk.value.notifyAgave(d,4),this.hza=d))}cZo(d){this.Bk.value.appHasNotifications(d)&&(this.hza=null)}x4c(d,n=null){return d?n?String.format("{0}.{1}",d,n):d:""}DHj(d){d?(document.activeElement.blur(),this.hr.Lce(0,null,2,null,null)):(document.activeElement.blur(),this.hr.u8c(0,null,2,null,null));this.hza=null}Ebl(){this.hza=null}d6h(d,n){this.hza=
d;const B=this.VRf(d);if(B){var Q=this.oc.te(B);n&&!this.oc.getRegion(Q.name)&&(n=new fo.DOMFocusListing(()=>document.getElementById(this.p6c(d))),n.$ia=!0,n.jo(3),n.jo(2),n.jo(1),n=this.oc.jta(()=>document.getElementById(this.p6c(d)),this.oc.te(B),n),n.nR=!0,n.s1a(),Q.Pu(gm.KeyInputManager.xc(Jq.a.iB,0)),Q.Pu(gm.KeyInputManager.xc(Jq.a.iB,4)));this.oc.Rg(B)}}p6c(d){return d}blur(){document.activeElement.blur()}ljf(d){this.sa.addHandler("OnAppForOfficeClose",d)}y7k(d){this.sa.addHandler("OnInsertionDialogOpened",
d)}reb(d,n=!1){n||(this.PTl(d),this.sa.raiseEvent("OnAppForOfficeClose",d));this.Vea&&this.Vea.value&&this.Vea.value.f0l(d);this.hza=null}VRf(){return null}Psd(d,n){this.OLk&&(this.h$b=new fm);this.h$b.ti("",null,null);this.Bk.value.launchInsertDialog(this.h$b.jrb,d,n)}aYd(){this.h$b.hide()}Ike(d,n){const B=n.optionalProperties.InstanceToken?n.optionalProperties.InstanceToken:(new Jh.a(Ze.a.create(),1)).toString(),Q=new Kk.a(B,d.getId(),"","","sdxcatalog",null,!1);Q.sourceLocationOverrideResourceId=
n.optionalProperties[mk.a.sourceLocationOverrideResourceId];Q.onExtensionLaunchCallback=n.optionalProperties[mk.a.onExtensionLaunchCallback];Q.settings=OSF.OUtil.serializeSettings(n.gjc?n.gjc:{});Q.featureGates=G.AFrameworkApplication.J.ZMf(d.getId());this.x4c(Q.solutionId,Q.sourceLocationOverrideResourceId);d=n.optionalProperties[mk.a.Q0c];this.vAa=new Co(!0,!0);const ha=n.optionalProperties[mk.a.dialogTitle];this.vAa.J_o(n.optionalProperties[mk.a.dialogHeight],n.optionalProperties[mk.a.dialogWidth]);
this.vAa.instanceId=B;this.vAa.Q0c=d;this.vAa.ti(ha,null,null);Q.div=this.vAa.jrb;Q.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Q.osfControlType=1;this.Bk.value.insertOsfControl(Q);return!0}VUb(d){this.ga.Zb(Z.a.lZf,2,d)}kgn(d,n){this.ga.Zb(Z.a.TXi,2,d);G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled")&&(d={["solutionId"]:Xm.E1(d)},d.UILocation=n.UILocation,cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",
dataFields:zf.a.iG(d)})))}KFn(d,n){if(2!==d)return 32;d=n.CommandValueId;var B=Ic.c(d)?this.P6.Xuf[n.SourceControlId]:d;if(!B)return F.ULS.sendTraceTag(508913678,344,10,"No solutionId."),8;d={};d.solutionId=B;if(B=this.Ula.PXa(B))d.version=B.version,d.storeType=B.storeType,d.storeId=B.storeId,d.assetId=B.assetId,d.assetStoreId=B.assetStoreId,d.targetType=B.targetType,d.displayName=B.displayName,d.width=B.width,d.height=B.height,this.VUb(d),G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&
(d={["solutionId"]:Xm.E1(d)},d.UILocation=n.UILocation,cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:zf.a.iG(d)})));else return F.ULS.sendTraceTag(509724485,344,10,"No add-in details."),8;return 32}Mro(d){if(this.o6i())this.OCj(d,OSF.StoreTypeEnum.MarketPlace);else{const n=new el;n.callbackFunc=d;n.storeType=OSF.StoreTypeEnum.MarketPlace;n.fromInsertDialog=!1;n.refresh="true"===Xg.a.instance.getItem("refreshRequired");this.Bk.value.queryEntitlementDetails(n)}}OCj(d,
n){const B=new el;B.callbackFunc=d;B.storeType=n;B.fromInsertDialog=!1;B.refresh="true"===Xg.a.instance.getItem("refreshRequired");this.Bk.value.queryEntitlementDetails(B)}vgo(d){const n={navigationMode:0,assetId:null,category:null};if(!d)return n;d=d.split("|");F.ULS.sendTraceTag(16847763,344,50,"LaunchInsertionDialog with parameters: {0}",JSON.stringify(d));if(3>d.length)return n;d[0]&&1===d[0].length&&(n.navigationMode=parseInt(d[0]));d[1]&&0<d[1].length&&(n.assetId=d[1]);d[2]&&0<d[2].length&&
(n.category=d[2]);return n}rXd(d){const n={};n.solutionId=d[zj.solutionId];n.version=d[zj.version];n.storeType=d[zj.storeType];n.storeId=d[zj.storeId];n.assetId=d[zj.assetId];n.assetStoreId=d[zj.assetStoreId];n.targetType=d[zj.targetType]?d[zj.targetType]:0;n.displayName=d[zj.displayName];n.isAddinCommands=d[zj.isAddinCommands];n.width=d[zj.width]?d[zj.width]:0;n.height=d[zj.height]?d[zj.height]:0;n.sharedRuntimeId=d[zj.sharedRuntimeId];n.backgroundState=d[zj.backgroundState]?d[zj.backgroundState]:
0;return n}hHl(d){return[d.solutionId,d.version,d.storeId,d.storeType,d.osfControlType]}S6k(d){this.sa.addHandler("OnAppForOfficeActivated",d)}a5b(){}TIe(){}C0b(d,n){this.Ula&&(0===this.yga&&Xm.zwb(d)&&(this.yga=1),this.Ula.C0b(d,n))}lU(d,n=!1){this.Ula&&(0===this.yga&&Xm.zwb(d)&&(this.yga=1),this.Ula.lU(d,n))}get gzb(){return'[{"displayName":"Vertex42 Template Gallery","solutionId":"wa103296784","version":"1.1.0.0","description":"Browse over 300 templates created by Vertex42.com for Excel and Word","iconUrl":"18364.a3e7eafc-7761-4c16-8f90-68c3819a47e4.54117612-5f8b-47b0-a844-684631c459ca.131ca4d3-9ef1-4788-93e9-08aef4a16490.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com","addinInfo":{"priority":2,"AUP":3726}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.5.0.0","description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1529}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","description":"Unlimited access to licensed photos, clipart and your company\u2019s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":3,"AUP":1187}},{"displayName":"DocuSign for Word","solutionId":"wa104218065","version":"4.2.0.0","description":"Enhance productivity by electronically signing or sending any document from Microsoft Word","iconUrl":"18865.cc9ae10a-ba5e-4ca5-8ece-5bf0bbacdeaf.b1c97a18-3e7f-49b2-8024-46db9b8faebd.b566087e-eda0-4453-880e-f47a7d848eb9.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.docusign.com/company/privacy-policy","addinInfo":{"priority":3,"AUP":1970}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":2,"AUP":893}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":534}},{"displayName":"JAGGAER Contract Authoring","solutionId":"wa104379585","version":"3.0.0.0","description":"Author and review contracts faster than ever directly in Word with JAGGAER Contract Authoring.","iconUrl":"559.1462f0c6-f61c-42fe-ad1d-dc4d87b45174.2dc5016b-cdbc-41af-abd9-7c915ae43c4e.06280d94-a345-4639-ae39-da11227674ac.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474843308/Product_42949677815/Asset_52e3d4a8-11b7-420e-802b-a0ff29736a82/JAGGAERMasterAgreementTermsand.doc","privacyUrl":"https://www.jaggaer.com/about/privacy-policy","addinInfo":{"priority":-1,"AUP":244}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":453}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":2,"AUP":2464}},{"displayName":"Lucidchart Diagrams for Word","solutionId":"wa104380118","version":"2.0.0.0","description":"The easiest way to create and insert flowcharts, mockups, UML, mind maps and more in Microsoft Word.","iconUrl":"21470.8707174d-9346-4e3b-89fb-42a1eae7a042.2a02cd8e-edc2-44c8-9dca-10b7e851ac5a.eab30db5-84fe-4e19-b983-6d66f961dcff.png","licenseUrl":"https://lucid.co/tos","privacyUrl":"https://lucid.co/privacy","addinInfo":{"priority":3,"AUP":937}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":916}},{"displayName":"RefWorks Citation Manager","solutionId":"wa104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":3,"AUP":3304}},{"displayName":"PDFfiller \u2013 edit your PDFs","solutionId":"wa104380140","version":"1.0.0.0","description":"Instantly add a document from Office365 to PDFfiller! Edit, sign, save, and share anytime, anywhere,","iconUrl":"14229.ae6bc553-5473-4b85-b0ea-714f7ce7f7b9.4763b6eb-4228-47cb-a466-650454ba5fe1.50b4e5e1-1ed9-4d90-9151-3b6be2f4bbb4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.pdffiller.com/en/privacy_policy.htm","addinInfo":{"priority":2,"AUP":216}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":91}},{"displayName":"Fejlretter - Powerful feedback","solutionId":"wa104380429","version":"2.0.0.0","description":"Save time when correcting student assignments with the critically acclaimed feedback tool.","iconUrl":"48038.4a8f5705-cdd6-4d3d-9ea1-eb6001a61fcf.e50840ee-5e4b-445e-8253-d4b06f278dd1.bd226b93-2fc4-4ecd-a04d-950b408fd15d.png","licenseUrl":"https://fejlretter.squarespace.com/betingelser","privacyUrl":"https://fejlretter.squarespace.com/privacy-policy","addinInfo":{"priority":3,"AUP":44}},{"displayName":"officeatwork | Wizard for Office","solutionId":"wa104380519","version":"3.5.0.0","description":"Create personalized documents and insert personalized content with just a few clicks.","iconUrl":"21517.0e251595-714f-4044-bf20-b68cba626477.4a09e61b-6aa7-4911-b267-164255e59dcf.c0787172-1cc0-41f2-8885-5fd04ccf297d.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":3517}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":1926}},{"displayName":"LEAP for Word","solutionId":"wa104380529","version":"3.0.0.0","description":"LEAP for Word helps automate documents and keep them up-to-date.","iconUrl":"11128.dc087b8a-bb43-477e-80a5-4d417ca5c857.dc25a14c-c04d-44cd-ac74-27e3a6537bd0.9630b45c-ae56-4630-8203-50fa08daa9b6.png","licenseUrl":"https://leap.us/terms.html","privacyUrl":"https://www.leap.us/privacy.html","addinInfo":{"priority":-1,"AUP":62}},{"displayName":"FMath Editor","solutionId":"wa104380848","version":"2.1.0.1","description":"Allow users to insert equations into documents.","iconUrl":"21513.6a3c2fa6-ade2-4929-a881-1dd4c188f978.63d347ef-61d0-4ddb-a5af-5102243732ae.0ad9963c-9d43-4f1d-b599-319229de2eda.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://math-on-web.com/privacy_policy.html","addinInfo":{"priority":2,"AUP":169}},{"displayName":"SmartCite for Papers","solutionId":"wa104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":3,"AUP":1696}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":-1,"AUP":332}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":-1,"AUP":273}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":2,"AUP":336}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":10474}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":144}},{"displayName":"SiteMap","solutionId":"wa104381519","version":"1.0.0.0","description":"Create SiteMaps and UI flows for Office document","iconUrl":"53703.e16f30a8-c796-46a0-8144-87f78c1714fc.0179cf34-ff8d-44ab-909e-62d8ca7404b7.16f23b12-05ab-4080-b531-395b75fa6046.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://mockflow.com/privacy_policy","addinInfo":{"priority":-1,"AUP":107}},{"displayName":"Stava Rex","solutionId":"wa104381613","version":"3.1.0.0","description":"Stava Rex \u00e4r ett r\u00e4ttstavningsprogram som r\u00e4ttar stavfel och grammatikfel i svensk text.","iconUrl":"6657.d163e868-f594-4452-9c43-a8e27b9d84b7.0033d815-1490-4021-b259-c8d11fa928f7.571b8cbb-7e92-41a2-a8ae-edf3c143c467.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr/tillagg-for-office","addinInfo":{"priority":-1,"AUP":1049}},{"displayName":"Visual Paradigm Online for Office","solutionId":"wa104381637","version":"1.0.0.0","description":"Draw and insert flowcharts, UML, mind maps, BPMN, Venn, ERD, ArchiMate and more in Office documents.","iconUrl":"37179.b19e18e4-8129-4f14-9c5f-94ff9f478a8e.7039006e-f2b2-4482-98db-255ae2f58628.bd478170-6d94-42f7-b043-44f31827a0d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://online.visual-paradigm.com/privacy.jsp","addinInfo":{"priority":-1,"AUP":100}},{"displayName":"SpellRight","solutionId":"wa104381658","version":"3.2.1.0","description":"Advanced spellchecker, specially designed for people with reading and writing difficulties.","iconUrl":"44740.a94c453b-9a33-4274-bbd3-812c98659aa6.6f414cd6-fdfa-4f0d-981d-e4ab7d165a01.d68a7473-2a11-46c9-8fb4-1532d54df637.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr","addinInfo":{"priority":-1,"AUP":612}},{"displayName":"Outwrite - AI Writing Assistant","solutionId":"wa104381714","version":"4.2.0.0","description":"Write better everywhere with Outwrite\'s proofreading and paraphrasing tool","iconUrl":"24265.44fd0c0a-670c-4940-9d4a-ed3b74576b95.005f9722-a130-46d4-8ebf-c65a5bc3ef81.d1dd5745-4742-4a49-86b9-d9cc20daa98e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://outwrite.com/privacy","addinInfo":{"priority":3,"AUP":270}},{"displayName":"LanguageTool","solutionId":"wa104381727","version":"1.0.0.9","description":"Advanced spell and grammar checker","iconUrl":"30578.091db8b2-7164-4fa1-ba0e-12b186fa9d3f.69a95916-c102-4f4e-9fe0-d891c84d0925.9dbc2d81-9492-4743-824a-db1a191f4605.png","licenseUrl":"https://languagetool.org/legal/terms","privacyUrl":"https://languagetool.org/legal/privacy","addinInfo":{"priority":1,"AUP":704}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":-1,"AUP":206}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":2,"AUP":2855}},{"displayName":"PolicyTech\u00ae Tools","solutionId":"wa104382046","version":"1.0.0.5","description":"Insert always up-to-date fields and links into securely stored PolicyTech\u00ae documents","iconUrl":"16192.0cc4c2a8-ba9f-46fd-843f-0da849b0a778.96177cd9-9568-4427-9e9c-3d4f85b12c3a.aafbd44f-5f1b-4745-96cf-86e320c1ab28.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.navexglobal.com/en-us/privacy-statement","addinInfo":{"priority":3,"AUP":1171}},{"displayName":"Mendeley Cite","solutionId":"wa104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":37759}},{"displayName":"Easy Syntax Highlighter","solutionId":"wa200000011","version":"1.0.1.0","description":"Code Syntax Highlighting for Word","iconUrl":"46879.e5d00319-8175-4ba7-9d6e-fdc1ea53abc5.228f1720-24bd-47ed-bbd3-59c73c454e5d.99fe41bb-6c5b-43f9-bc6d-585e984740bc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://app.pyxll.com/word-syntax-highlighter/privacy.html","addinInfo":{"priority":3,"AUP":411}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":1512}},{"displayName":"PERRLA","solutionId":"wa200000199","version":"8.1.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":3,"AUP":1663}},{"displayName":"QuillBot","solutionId":"wa200000368","version":"1.0.0.0","description":"Save time and immediately improve your writing with QuillBot\u2019s Paraphrasing and Summarizing Tool. ","iconUrl":"5821.0c33b03b-ab2a-4712-ba09-d11a2edcbca7.e48cfd16-849a-473d-bfaa-746249630244.a00131df-ab1c-47cc-bef5-8d22f76e49dc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://word.quillbot.com/privacy.html","addinInfo":{"priority":1,"AUP":2949}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":908}},{"displayName":"Grammarly for Microsoft Word","solutionId":"wa200001011","version":"1.2.0.0","description":"Compose clear, mistake-free writing with Grammarly for Microsoft Word on Mac.","iconUrl":"44160.caa10083-95fd-4aa5-9299-a40c68cdc829.9e6b7934-9a4d-4e0f-948d-4f54dafab3f8.df43bd30-714e-4369-803a-00c9491be63b.png","licenseUrl":"https://www.grammarly.com/terms","privacyUrl":"https://www.grammarly.com/privacy-policy","addinInfo":{"priority":1,"AUP":23962}},{"displayName":"Writefull","solutionId":"wa200001482","version":"1.0.5.0","description":"Writefull is automated proofreading for science.","iconUrl":"15661.6e967273-a217-48f5-afd0-9c2b8e777bb9.c564a228-3fcf-4b0c-a7f3-a972b79c328c.25cff90e-9ce9-4a8f-8745-6e60c4b9b659.png","licenseUrl":"https://www.writefull.com/terms.html","privacyUrl":"https://www.writefull.com/privacy.html","addinInfo":{"priority":2,"AUP":400}},{"displayName":"Corinth Screenshots","solutionId":"wa200001486","version":"1.0.0.0","description":"Sync the visual content of the Corinth app with your Office teaching materials","iconUrl":"51869.9a32c413-7910-4eea-8110-596bd8a40a09.a203af63-a892-4e73-b9ad-dcb325ba30f2.16ceca3f-8b79-45b4-8593-4dae5d022848.png","licenseUrl":"https://www.corinth3d.com/EULA","privacyUrl":"https://www.corinth3d.com/corinth-privacy-policy","addinInfo":{"priority":2,"AUP":21}},{"displayName":"Spell checker and Grammar checker by Scribens","solutionId":"wa200001841","version":"1.0.0.0","description":"A powerful spelling and grammar checker. Scribens corrects 250 types of grammar mistakes.","iconUrl":"26848.b2f1ecc7-4017-4115-ae79-09c086924cf5.3c1daf8c-bc5d-4ffb-b4eb-160b11006f27.68175203-816b-48fd-ac79-99d7038badec.png","licenseUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","privacyUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","addinInfo":{"priority":-1,"AUP":255}},{"displayName":"ProWritingAid for Microsoft Word","solutionId":"wa200002281","version":"1.0.0.0","description":"The best writing style and grammar checker for everything you write.","iconUrl":"47676.90dd7d5f-0d94-454f-b4f8-247593fefda6.32a96d9b-d1fb-487e-b93a-532357aec0f1.6355c122-c3b0-4f89-8f7a-e3e9a6c0adff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://prowritingaid.com/en/Home/PrivacyWord","addinInfo":{"priority":2,"AUP":226}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":2517}},{"displayName":"Sciwheel","solutionId":"wa200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":381}},{"displayName":"Citavi Assistant","solutionId":"wa200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":-1,"AUP":391}},{"displayName":"Impression Signatures","solutionId":"wa200003216","version":"1.0.0.0","description":"Securely sign and send documents for signature directly from Word and Excel.","iconUrl":"10171.55569ba6-8707-48a8-b3df-6e6413574914.d131bcfb-dba2-4b50-bccb-a2ad4f770edc.75c9fdcb-00dd-41b7-81f5-2637d24ad344.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.iubenda.com/privacy-policy/8039352/full-legal","addinInfo":{"priority":-1,"AUP":114}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"Wordtune","solutionId":"wa200003478","version":"1.0.0.0","description":"Wordtune helps you rewrite your text into a concise, engaging and well-written message.","iconUrl":"24151.f6b24171-2782-4f28-8af6-e38438631fbe.91ba765d-d20e-4d2e-9486-a3a498a5b3a1.7e060834-f678-403e-8cc9-4b80c9f87d7f.png","licenseUrl":"https://www.wordtune.com/terms-of-use","privacyUrl":"https://www.wordtune.com/privacy-policy","addinInfo":{"priority":1,"AUP":476}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":-1,"AUP":549}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":10144}},{"displayName":"Draft Coach","solutionId":"wa200004257","version":"1.1.121.0","description":"Formative writing feedback for students: available for Turnitin customers","iconUrl":"32351.26374e0d-06e7-47bd-b6cb-0a1e5e54f167.a165e027-3385-42db-bc1e-38bcbb939a51.ffef3075-692f-4d29-a0e2-b1ca1925b0d4.png","licenseUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm#Usage_Policy","privacyUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm","addinInfo":{"priority":3,"AUP":17823}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","description":"Introducing Ghostwriter OpenAI ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":533}},{"displayName":"Legal AI Assistant","solutionId":"wa200005260","version":"1.0.0.0","description":"This add-in is designed to assist users in generating contracts and adding missing clauses using AI","iconUrl":"63548.f4c25bf7-14f2-46fe-9e82-501e47cf4e22.89c55224-07c3-47f2-ad1c-74f01a5391f8.c3bdc80b-1ae3-468f-adbe-d1bf1206b422.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://e-arbitrator.com/legal-ai-privacy-policy","addinInfo":{"priority":2,"AUP":111}},{"displayName":"GenText AI Assistant","solutionId":"wa200005287","version":"1.0.0.2","description":"GenText is an AI Assistant developed to help business professionals write reports","iconUrl":"39094.562d3128-5997-43ce-aded-f5b52b966432.c9dbaa0c-35ee-443a-8942-03744376197e.97368fc6-d794-4d0e-8282-a96670ef2828.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gentext.ai/privacy","addinInfo":{"priority":2,"AUP":138}},{"displayName":"TrustSigner","solutionId":"wa200005298","version":"1.0.0.0","description":"Sign documents fast, secure and affordable. Made in EU with legal binding.","iconUrl":"24353.f2399955-265f-4d0e-9e27-45e114545472.ebc76c58-2921-4d53-84bc-fefad793b03d.fc65492d-5b37-41f9-aca4-ca5b72c3a5a9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://trustsigner.eu/privacy","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Ghostwriter Consultant Edition","solutionId":"wa200005312","version":"1.5.0.0","description":"Ghostwriter Consultant with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"36233.163ead30-016b-4591-a5b9-f2d2930e5403.bdc1efa7-a706-48f0-baf7-d76c2c5222ef.601d7792-1b34-4021-b4e7-15435a733bf1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":355}},{"displayName":"Dall-e Image Generator","solutionId":"wa200005313","version":"1.0.0.2","description":"Use AI to generate unique and stunning images based on the descriptive text within a document. ","iconUrl":"31431.4f416b91-4c5c-4aa1-b737-8aa50d8c65dc.bde80e16-2c77-4064-9ad7-a99a077ef64a.c508525c-965d-44b5-aec8-deb21c6941df.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.pegamento.nl/en/terms-conditions-text-to-image-extension","addinInfo":{"priority":2,"AUP":56}},{"displayName":"DrillBit-Plagiarism","solutionId":"wa200005339","version":"1.0.0.4","description":"Plagiarism detection software to detect similar or copied content.","iconUrl":"23545.e4fc7991-8bb7-408e-ad63-b9ab3b164d86.5c4bfb60-fbec-489d-a4dd-d294bfea0c0e.d48a04e3-6609-4d98-bcda-7e70107b93bc.png","licenseUrl":"https://drillbitplagiarism.com/termsCondition","privacyUrl":"https://drillbitplagiarism.com/customerHelp","addinInfo":{"priority":2,"AUP":17}},{"displayName":"Ghostwriter Legal","solutionId":"wa200005348","version":"1.5.0.0","description":"Ghostwriter Legal with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"19401.a89bf831-da40-48cb-aea0-9fdb99d2dfb6.24bb5297-c19d-4109-9ddc-4233c6565136.3d1468c5-2f55-4362-815a-846fdf9c7167.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":34}},{"displayName":"Ghostwriter Education","solutionId":"wa200005360","version":"1.5.0.0","description":"Ghostwriter Education with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"64228.96000578-f337-4e2a-9458-bf4f19bfed19.965f3cd0-f0cb-4f83-b18e-a1bba1290eab.8dd5e85f-59af-439e-9136-92bebf18e1d6.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Spellbook","solutionId":"WA200004774","version":"1.2.0.0","description":"AI assistant for contract drafting & reviews","iconUrl":"2248.98a244f3-017a-4ff1-9a57-51c9bcb8dc52.3da7c824-0fd2-42df-9da5-5512230625d7.0dbc3752-ca78-4b17-a8be-82dc9cd273e7.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://spellbook.legal/privacy-policy","addinInfo":{"priority":3,"AUP":320}},{"displayName":"GPTZero","solutionId":"WA200005444","version":"1.0.0.0","description":"GPTZero detects AI-generated text right inside Word. Just highlight and get results!","iconUrl":"50366.6301eda2-a871-4076-b79c-e43711f93b87.450815d6-a39d-4d11-8105-54c6a6fcf733.6a7be30c-a1db-4b14-834e-4b6d149bb1fa.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gptzero.me/privacy-policy.html","addinInfo":{"priority":1,"AUP":227}},{"displayName":"ChatGPT for Excel Word","solutionId":"WA200005502","version":"1.0.0.9","description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":7400}},{"displayName":"Academic English Auto-Suggest","solutionId":"WA200004216","version":"1.0.0.7","description":"Academic phrase auto-suggest tool.","iconUrl":"4171.2c5b8d7e-1fc7-4ab6-b94c-186b59627348.8f892e7b-46da-41a7-ad69-d25e14417324.35343752-4270-4449-9047-f7d0746254df.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://aeas.atazir.net.au/privacy.html","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Wordvice AI For MS Word","solutionId":"WA200005106","version":"1.0.1.0","description":"Wordvice AI identifies and corrects errors in any type of document.","iconUrl":"53180.aead9fc9-f2df-449f-9ab9-dc1fe294e8f7.16672732-7908-472e-b336-90fbecb97b1e.ce61bf09-17d7-485b-a001-10c2c1eb1112.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://wordvice.ai/ko/policy/privacy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"DeepL","solutionId":"WA200005826","version":"1.0.0.0","description":"Translate your work accurately and create well-written, error-free texts in seconds.","iconUrl":"38350.d9d77db1-2a27-44b4-813d-adfcef460a9a.0a4c0ce7-a703-4ecb-bb90-3c49aa3e5754.63ab3f5a-ae96-44cf-aae3-a5310bdbaa4d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.deepl.com/en/privacy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"EndNote 21 Cite While You Write\u2122 for Word Online","solutionId":"WA200005983","version":"1.0.3","description":"Insert in-text citations while simultaneously creating a bibliography with Cite While You Write\u2122","iconUrl":"29751.ac5fb94c-9f9b-453b-a5ac-fecb20593f4e.7052bc0d-7631-4821-bc17-86df446ab06d.f9287209-4488-4e0f-9b23-3030ad68d0f0.png","licenseUrl":"https://endnote.com/license","privacyUrl":"https://endnote.com/privacy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot: Private ChatGPT","solutionId":"WA200006000","version":"1.0.7.0","description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.76f6d8e7-715b-441b-8a4d-2139865ec45a.7610f06b-2158-4106-a7c2-fdce566d231b.edb31b7f-4abe-4ef4-a041-2873ff07d0c0.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Jasper AI","solutionId":"WA200006001","version":"1.0.7.0","description":"The Jasper Add-in brings Jasper Chat into Microsoft Word\u2122.","iconUrl":"47595.9a5b943f-887a-4fe7-b1c6-d44a90c658fe.31db5641-66e6-4f64-9ab4-2a3ba66c2d73.9653c625-a855-4a91-bc32-ab984fa9bd91.png","licenseUrl":"https://www.jasper.ai/legal/eula","privacyUrl":"https://www.jasper.ai/legal/privacy","addinInfo":{"priority":-1,"AUP":0}}]'}get Tin(){return!!this.za&&
this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserInstalledAddinCommandValueIdEnabled",!0)}get yga(){return this.KQe}set yga(d){F.ULS.sendTraceTag(508830282,220,50,"commandRegistrationState: {0} --\x3e {1}",mn[this.KQe],mn[d]);this.KQe=d}static zwb(d){return 0===d||10===d}static E1(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static jg(d){return!d||!d.length}}Object(D.a)(Xm,"AppsForOfficeUIActor",null,[11,1912]);var bn=
e(266),sq=e(131),Ak=e(35);class Nm{constructor(){this.onTabKeyDown=this.onExecute=this.icon=this.label=null}}Object(D.a)(Nm,"TaskPaneHeaderButtonProps",null,[]);var Qs=e(773);class Rs{constructor(d,n,B){this.a$a=B;this.XOh=this.VOh=null;this.GOo=()=>{this.dGn();this.SAc(this.XOh,this.VOh)};this.uqc=Q=>Q===Z.a.Hna;this.Y3=d;this.qFb=n}sU(d,n){this.XOh=d;this.VOh=n;this.a$a.P2c(this.GOo)}dGn(){this.qFb=Wa.a.instance.Wa("Common.App.ICustomerFeedbackUiWrapper")}SAc(d,n){d={};n&&(d.query=n.sh);if(this.Y3){const B=
Object.assign(new Xc.a,{taskPaneWidth:352});G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb&&G.AFrameworkApplication.ta.Pb.vhe&&(B.isResizable=!0,B.resizeMinWidth=352,B.resizeMaxWidth=920);switch(n.actionId){case Z.a.sai:d.query="contactsupport";B.AU=WoncaIntl.WoncaStrings.L_ContactSupport;B.sourceLocationOverrideResourceId="Help.ContactSupport.Url";break;case Z.a.Hna:B.AU=WoncaIntl.WoncaStrings.L_GiveFeedback;B.sourceLocationOverrideResourceId="Help.GiveFeedback.Url";d.feedback=this.ZCi(n);
break;case Z.a.W7j:d.query="showtraining";B.AU=WoncaIntl.WoncaStrings.L_Training;break;case Z.a.pSg:d.query="whatsnew";B.AU=WoncaIntl.WoncaStrings.L_WhatsNew;break;default:B.AU=WoncaIntl.WoncaStrings.L_Help}B.DW=d;G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackDelayTaskpane")?this.uqc(n.actionId)?this.WZj("FA000000012",B,n):(B.isModernPane=!0,this.Y3.l6("FA000000012",B)):this.Y3.l6("FA000000012",B)}}ZCi(d){d=d.Ed;G.AFrameworkApplication.J.tUd(d);
d=this.qFb.getContext(d);let n={};"telemetryGroup"in d&&(n=d.telemetryGroup);n.processSessionId=d.sessionId;n.officeBuild=d.build;d.telemetryGroup=n;if(void 0===d.feedbackType||null===d.feedbackType)d.feedbackType=-1;d.disableIncludeScreenshot="disableIncludeScreenshot"in d?d.disableIncludeScreenshot:!1;d.screenshot="screenshot"in d?d.screenshot:!0;d.disableScreenshotPreview=!1;d.includeScreenshotSelectedDefault=!0;return d}WZj(d,n,B,Q=300){this.qFb.imf()?(n.DW.feedback=this.ZCi(B),this.Y3.l6(d,n)):
this.CVl(Q).then(()=>{this.WZj(d,n,B,2*Q)})}$ua(){this.Y3&&this.Y3.yOb("FA000000012")}dispose(){}CVl(d){return new Promise(n=>{window.setTimeout(()=>{n(null)},d)})}}Object(D.a)(Rs,"AgaveAssistancePane",null,[1047,11]);class It{constructor(d){this.URk=d}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(d,n){this.URk.Xrb(d,n)}}Object(D.a)(It,"RichApiEventManagerHost",null,[1101]);class lt{constructor(){this.zh=new ff.a}PJ(d){this.ft(d,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}ft(d,
n){if(d){var B={};B.Error=n;d(B)}}}Object(D.a)(lt,"ApiEvent",null,[]);class dn extends lt{constructor(){super();this.Dg=null}}Object(D.a)(dn,"WordEditorApiEvent",lt,[]);class Pk extends dn{constructor(){super();this.Y9e=null}addHandler(d,n,B,Q){this.Dg&&Ic.b(Q)?(this.Y9e||(this.Y9e=new It(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.Y9e)),this.zh.W(d,n),F.ULS.sendTraceTag(41513415,341,50,"Add RichApiMessage event handler for control: {0}.",d),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,
n,B){this.Dg&&Ic.b(B)&&this.zh.Bb(d)?(this.zh.remove(d),F.ULS.sendTraceTag(41513416,341,50,"Remove RichApiMessage event for control: {0}.",d),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}hE(){}Xrb(d,n){const B={};B[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData]=n;this.zh.Bb(d)&&this.zh.K(d)(B)}R6d(d,n){this.Xrb(d,[[65536,65539,"",Pk.VJl(n),-1,!1]])}tJl(d,n){return[[2,1E3,"",JSON.stringify([d,n]),0,!1]]}static VJl(d){const n={};n.visibility=d?"Visible":"Hidden";return JSON.stringify(n)}static get instance(){return null!=
Pk.e2g?Pk.e2g:Pk.e2g=new Pk}}Object(D.a)(Pk,"RichApiMessageEvent",dn,[]);class Lc{constructor(){this.iconUrl=this.title=this.id=null;this.Tcd=this.isVisible=!1;this.cZb=this.a4b=this.Jyb=this.zD=null;this.hde=!1}}Object(D.a)(Lc,"ReactAppsForOfficeTaskPaneData",null,[]);var pk=e(1513),Fn=e(328),Wl=e(196);class Mj{constructor(d,n,B){this.yQc=0;this.qAa=d;this.Ai=n;this.vWg=B}start(){this.yQc||(this.yQc=window.setInterval(()=>{OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.Ai.Z$a(this.vWg),
Mj.OHm,null,(d,n)=>{d?F.ULS.sendTraceTag(591177106,3011,10,"Failed to send message to transcription pane, status: {0}.",d):this.H_m(n)})},Mj.uUn))}stop(){this.yQc&&(window.clearInterval(this.yQc),this.yQc=0)}H_m(d){if(d&&d.completedContext){var n;if(({Zv:n}=Rb.d(d.completedContext)).returnValue&&n)for(d=0;d<n.length;d++)this.l3m(n[d])}}l3m(d){if(d[Mj.Hbg]&&d[Mj.Hbg]===Mj.SMo&&d[Mj.Sod]&&d[Mj.QLj])this.qAa.m3m(d[Mj.QLj],d).then(n=>{this.Bp(d[Mj.Sod],n)}).catch(n=>{const B={};B[Mj.Bqi]=n;this.Bp(d[Mj.Sod],
B)});else{const n={};n[Mj.Bqi]=Mj.Fjn;this.Bp(d[Mj.Sod],n)}}Bp(d,n){n[Mj.svp]=!0;n[Mj.Hbg]=Mj.YOo;n[Mj.Sod]=d;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.Ai.Z$a(this.vWg),Mj.Abl,n,B=>{B&&F.ULS.sendTraceTag(591152963,3011,10,"Failed to send message to transcription pane, status: {0}.",B)})}}Mj.Abl="onTranscriptionHostMessage";Mj.OHm="getNewTranscriptionMessages";Mj.svp="transcription_message";Mj.Hbg="messageType";Mj.QLj="requestType";Mj.Sod="requestId";Mj.SMo="request";Mj.YOo="response";
Mj.uUn=3E3;Mj.Bqi="error";Mj.Fjn="invalidMessage";Object(D.a)(Mj,"TranscriptionAddInMessaging",null,[]);var bk=e(1046);class go{constructor(d,n){this.fob=d;this.LFb=n}icm(d){let n;n=this.jcm(d);0==n.length&&(n=this.hcm(d));return n}hcm(d){if(!this.LFb||!this.LFb.customProperties)return"";var n=this.LFb.customProperties.getItemOrNullObject("StoredTranscription");n=n?n.value:"";if(isNullOrUndefined(n)||0==n.length)return"";F.ULS.sendTraceTag(512522206,3011,50,"Fetched Transcription From Custom property storage");
d(!0);return n}jcm(d){if(!this.fob)return F.ULS.sendTraceTag(512522205,3011,10,"CustomXMLManager object is NULL"),"";var n=this.fob.j9d("http://schemas.microsoft.com/office/transcription/2022");if(isNullOrUndefined(n)||0==n.length)return"";n=n[0].getValue(Dd.a.$9a);if(isNullOrUndefined(n)||0==n.length)return F.ULS.sendTraceTag(512522204,3011,10,"Not able to get the transcription data from XML Node"),"";n=(new DOMParser).parseFromString(n,"text/xml");if(!isNullOrUndefined(n)&&!isNullOrUndefined(n.lastChild)){n=
n.lastChild.textContent;if(isNullOrUndefined(n)||0==n.length)return"";F.ULS.sendTraceTag(512522207,3011,50,"Fetched Transcription From XML Storage");d(!1);return n}return""}}Object(D.a)(go,"TranscriptionDocumentStorageManager",null,[]);class ng{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){this.fob=null;this.Saa="TranscriptionPane";this.TLf=()=>{const ad=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.rb("StatusBarEnvironmentNameToUse").toLowerCase();return"string"==typeof ad&&ad.includes("inner ring")?
"DOGFOOD":"string"==typeof ad&&ad.includes("outer ring")?"MICROSOFT":"PRODUCTION"};this.Jao=()=>{F.ULS.sendTraceTag(594331858,3011,50,"Transcription pane closed by user.");const ad=this.xOi();ad.PaneOpenDurationInSecs=((performance.now()-this.gEh)/1E3).toFixed(2);this.K7a.gXo(ad);this.gEh=0;this.WNh.stop()};this.T7a=d;this.Ai=n;this.LFb=B;this.K7a=Q;this.za=ha;this.ZJb=Aa;this.dXk=bb;this.WNh=new Mj(this.dXk,this.Ai,ng.fzc);this.RAa=Ib;this.fob=Ac;this.LLb=oc;this.$d=Fn.a.getInstance(ng.rvp)}load(){F.ULS.sendTraceTag(51667731,
3011,50,"Loading Transcription pane.");this.T7a&&(this.T7a.irc=!0)}xOi(){const d={},n=window.navigator;if(n){const B=n.connection||n.mozConnection||n.webkitConnection;B&&(d.DeviceNetDownLink=B.downlink,d.EffectiveNetworkType=B.effectiveType);d.IsOnline=n.onLine}return d}kgp(d){if(1===d)return 32;F.ULS.sendTraceTag(51667732,3011,50,"User intended to show Transcription Pane.");this.$d.logKpiUsage({kpiName:this.Saa,kpiType:0});this.gEh=performance.now();this.K7a.iXo(this.xOi());this.T7a&&!this.T7a.irc&&
this.load();if(!this.Ai)return F.ULS.sendTraceTag(51667733,3011,10,"Failed to show Transcription pane, null object of AppsForOfficeUiActor"),this.$d.logKpiFailure({kpiName:this.Saa,errorName:"FailedToTriggerPaneLaunch"}),16;d=Wl.a.get("TeachingUIShowCount");d=parseInt(d);if(isNaN(d)||!isFinite(d))d=0;const n={};n.IsProductionEnvironment=(2===G.AFrameworkApplication.Wga).toString();n.TranscriptionSessionId=this.K7a.vef;n.AugLoopCloudALServiceUrl=this.za.rb("AugLoopCloudALServiceUrl");n.DocumentStorageType=
"DocumentXmlStorage";let B=!1;const Q=(new go(this.fob,this.LFb)).icm(Aa=>{B=Aa});n.HasStoredTranscription=(0!=Q.length).toString();n.StoredTranscription=Q;n.IsTranscriptionFetchedFromCustomProperties=B.toString();Object(bk.b)()?n.MonthlyMinutesUsed=this.LLb.u$c:n.MonthlyMinutesUsed=this.ZJb.u$c;n.TeachingUIShowCount=d;n.FrontDoorBaseUrl=this.za.rb("DictationFrontdoorDomain");n.DefaultTranscriptionLocale=this.T7a.locale;n.EnableSetAnnotationsFromALVoiceClient=(!!G.AFrameworkApplication.J&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSetAnnotationsFromALVoiceClient",
!0)||G.AFrameworkApplication.J.$("SetAnnotationsFromALVoiceClient"))).toString();n.UnlimitedMins="true";n.ALSessionInitRetryEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ALSessionInitRetryEnabled",!1)).toString();n.RoamingCallsRetry=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.RoamingCallsRetry",!1)).toString();n.FileSizeUploadLimit=3E8;n.isSharedUXDarkModeOn=
this.XNf().toString();n.UserTenantId=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.rb("TenantId").toString()||"";n.IsTranscriptionNewFlowEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsTranscriptionNewFlowEnabled",!1)).toString();n.ShouldSkipUpnCheck=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ShouldSkipUpnCheck",!1)).toString();n.EnableFlightAuthVersion=
(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.EnableFlightAuthVersion",!1)).toString();n.UseOfficeJsApiForLanguages=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.UseOfficeJsApiForLanguages",!1)).toString();n.IsAddToDocumentCallbackEnabled=(!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsAddToDocumentCallbackEnabled",
!1)).toString();n.Audience=this.TLf();const ha=Object.assign(new Xc.a,{taskPaneWidth:330,isResizable:!0,resizeMinWidth:330,resizeMaxWidth:920,isModernPane:!0,AU:WacWordeditorStrings.TranscriptionPaneTitle,onTaskPaneClose:this.Jao,DW:n,sourceLocationOverrideResourceId:this.QVm()});return this.RAa?(this.RAa.initialized.then(()=>{ha.DW.IsFreemiumUpsellEnabled=this.RAa.isFreemiumUpsellEnabled.toString();ha.DW.IsLicensedUser=this.RAa.y2f.toString();this.iui(ha,!this.RAa.isFreemiumUpsellEnabled||this.RAa.y2f)}),
32):this.iui(ha,!0)}XNf(){return Xa.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}QVm(){return"DOGFOOD"==this.TLf()||"MICROSOFT"==this.TLf()?"Taskpane_Dogfood.Url":"Taskpane.Url"}iui(d,n){this.K7a.JWo(n);if(d=this.Ai.l6(ng.fzc,d,!0))this.T7a.S4m=!0;else return this.K7a.jXo(d),F.ULS.sendTraceTag(587309125,3011,10,"Failed to show Transcription pane."),this.$d.logKpiFailure({kpiName:this.Saa,errorName:"FailedToShowPane"}),16;this.WNh.start();this.$d.logKpiSuccess({kpiName:this.Saa});
return 32}c7m(d){if(1===d)return 32;F.ULS.sendTraceTag(51667735,3011,50,"User intended to close Transcription pane.");if(!this.Ai)return F.ULS.sendTraceTag(51667736,3011,10,"Failed to close Transcription pane, null object of AppsForOfficeUiActor"),this.$d.logKpiFailure({kpiName:this.Saa,errorName:"FailedToClosePane"}),16;this.Ai.yOb(ng.fzc);return 32}zxc(d,n,B,Q,ha){if(1===B)return 32;if(!this.Ai)return F.ULS.sendTraceTag(51667737,3011,10,"Failed to QueryToggle Transcription pane, null object of AppsForOfficeUiActor"),
16;ha&&(ha[Gf.a.On]=this.Ai.g5(ng.fzc));return 32}aGj(){console.log("refreshMinutes minified");Object(bk.b)()?this.LLb.sRb():this.ZJb.sRb()}}ng.fzc="FA000000051";ng.rvp={topLevelKpiName:"TranscribeFeatureUsage",featureName:"Transcribe",crewAlias:"VoiceTransEngg",areaName:"ContentCreation"};Object(D.a)(ng,"TranscriptionAddIn",null,[985]);class Np{constructor(){this.type="EmbeddedTaskPaneProps";this.uniqueID=this.getContent=null;this.isSharedRuntimePane=!1;this.feedbackTaskPaneProps=this.addinSharingTaskPaneProps=
null}}Object(D.a)(Np,"WordAddInTaskPaneProps",null,[]);class jp{constructor(){this.rightActionButtonProps=null;this.canBeShared=!0}}Object(D.a)(jp,"AddinSharingProps",null,[]);class aq{constructor(){this.type="AddinSharingTaskPaneProps";this.assetId=this.sharingLink=this.iconUrl="";this.copySuccessCallback=null}}Object(D.a)(aq,"AddinSharingTaskPaneProps",null,[]);var ho=e(165);class Hk{constructor(d,n){this.O5b=n;this.fRe="AppsForOfficeReactContainer";this.Iwk="TaskPaneCloseBtn";this.YSk="TaskPaneRightActionButton";
this.Muk="FA000000012";this.qY=d||ui.a.instance;this.Cn=new ff.a;this.oIa=new ff.a;this.oIa.add("FA000000012","Help");this.oIa.add("FA000000012.Help.GiveFeedback.Url","Feedback");this.oIa.add("FA000000002","Translator");this.oIa.add("FA000000006","Search");this.oIa.add("FA000000029","Editor");this.oIa.add("FA000000085","AcronymsWeb");this.oIa.add(ng.fzc,"Transcription")}g2(d){return this.Cn.Bb(d)?this.Cn.K(d).isVisible:!1}zAn(d){if(this.Cn.Bb(d))return this.Cn.K(d).Tcd;if(Fi.a.TVc)for(const n of this.Cn.keys)if(n.startsWith(d)&&
this.Cn.K(n).Tcd)return!0;return!1}qWa(d){const n=this.Cn.K(d);n.isVisible&&(n.isVisible=!1,n.Tcd=!1,Vc.UISurfaces.aw().then(B=>{B.hideTaskPane(n.id,2);return null}))}aIo(d){this.Cn.remove(d)}Bnc(d){return this.Cn.Bb(d)?this.Cn.K(d).id:null}showTaskPane(d,n,B,Q,ha=null,Aa=null){this.qY.iLa();if(this.Cn.Bb(d))this.Cn.K(d).zD.isPaneAutoOpened=B.isPaneAutoOpened,G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackRefreshActivationInfo")&&this.uqc(d)&&
(this.Cn.K(d).zD.settings.feedback=B.settings.feedback);else{var bb=document.createElement("div");bb.className=this.fRe;bb.id=this.fRe+B.id;B.div=bb;bb=String.format("AppForOfficePanel{0}",this.Cn.count);let Ib;for(const oc of this.Cn.keys)if(Ib=this.Cn.K(oc),Ib.id==bb){bb=String.format("AppForOfficePanel{0}|{1}",this.Cn.count,B.id);break}this.Cn.add(d,Object.assign(new Lc,{id:bb,title:n,zD:B,isVisible:!1,Jyb:Aa,cZb:ha,hde:!1}))}this.Ssd(d,Q)}qUm(d){return this.Cn.Bb(d)?this.Cn.K(d).zD.backgroundState:
am.Jee}x6o(d,n){this.Cn.Bb(d)&&(this.Cn.K(d).zD.backgroundState=n)}Lbe(d){return this.Cn.Bb(d)?this.Cn.K(d).zD:null}S_m(d,n){n===OSF.AgaveHostAction.TabExitShift?this.j7d(d):n===OSF.AgaveHostAction.TabExit&&(d=this.Cn.K(d),this.isResizable(d)?Vc.UISurfaces.aw().then(B=>{B.focusResizeHandle();return null}):df.FocusManager.instance().Hrd(ho.a.RBc))}eem(d){if(this.oIa.Bb(d))return this.oIa.K(d);for(const n of this.oIa.keys)if(!d.indexOf(n))return this.oIa.K(n);return null}j7d(d){(d=this.Cn.K(d).a4b)&&
d.querySelector("[data-unique-id^='"+this.Iwk+"']").focus()}getContent(d){return()=>this.Cn.K(d).zD.div}vmm(d){return this.Cn.K(d).zD}getAssetId(d){const n=this.Cn.K(d).zD,B=/^WA\d{9}/i;let Q;B.test(n.ownerAddinSolutionId)?Q=B.exec(n.ownerAddinSolutionId)[0]:B.test(n.solutionId)?Q=B.exec(n.solutionId)[0]:B.test(n.assetId)?Q=B.exec(n.assetId)[0]:B.test(n.storeId)?Q=B.exec(n.storeId)[0]:B.test(d)&&(Q=B.exec(d)[0]);return Q}DNi(d,n,B,Q){return()=>{cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Extensibility.Host.AddinSharing",
dataFields:[{name:"AssetId",string:Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,n,null,null,d.storeId)},{name:"ActionType",string:B},{name:"CorrelationId",string:Q}]}))}}Ssd(d,n){const B=this.Cn.K(d).id,Q=ha=>{ha=this.Cn.K(ha).a4b.querySelector("[data-unique-id^='"+this.YSk+"']");this.BCb(ha)};Vc.UISurfaces.aw().then(ha=>{n?ha.doNotUse_InitializePersistedTaskPane(B,this.AB(d,n)):(this.Cn.K(d).isVisible?ha.setSelectedTaskPane(B):ha.showTaskPane(B,this.AB(d)),this.Cn.K(d).zD.isPaneAutoOpened||
(this.uqc(d)?(ha=document.getElementById(this.Cn.K(d).a4b.id),df.FocusManager.LP(ha)):(ha=document.getElementById(this.Cn.K(d).zD.id),df.FocusManager.LP(ha.contentWindow))),G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowAddInSharingTeachingCalloutIsEnabled",!1)&&Q(d));return null})}BCb(d){const n=Wa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&d?(d.setAttribute("lpp-id","addInTaskPaneShareButton"),n.execute(B=>{B.logActivity("ShowTeachingCalloutForAddinSharingButton",
null);F.ULS.sendTraceTag(526989395,341,50,"triggerLPPActivity triggered an LPP activity")})):F.ULS.sendTraceTag(526989394,341,15,"triggerLPPActivity failed to get a sifFuture")}AB(d,n=!1){var B=new Np;B.getContent=this.getContent(d);B.uniqueID=this.eem(d);const Q=this.Cn.K(d);Q.zD.sharedRuntimeId&&(B.isSharedRuntimePane=!0);var ha=this.getAssetId(d);const Aa=this.vmm(d),bb=Jh.a.create().gv.toString();ha&&(B.addinSharingTaskPaneProps={type:"AddinSharingTaskPaneProps",iconUrl:this.Cn.K(d).iconUrl,sharingLink:`https://appsource.microsoft.com/product/office/${ha}?ocid=PROD_OfficeApps_CONS_OCMA_ACQ_OfficeOnline_shareViaLinkOnWacWord&correlationId=${bb}`,
assetId:ha,copySuccessCallback:this.DNi(Aa,ha,"copy",bb)});const Ib=new jp;Ib.canBeShared=!!ha;Ib.rightActionButtonProps=ha?{onExecute:this.DNi(Aa,ha,"share",bb)}:void 0;B=Object.assign(new pk.a,Ib,{title:this.Cn.K(d).title,titleTag:this.Cn.K(d).zD.titleTag,iconUrl:this.Cn.K(d).iconUrl,hideHeader:!1,width:this.Cn.K(d).zD.taskPaneWidth,location:2,contentProps:B,isModernPane:Q.zD.isModernPane,onOpen:oc=>{n||(Q.isVisible=!0);this.Cn.K(d).a4b=oc;yg.StaticActiveAppFrame.Aa().Ne()},onClose:()=>{if(!n){Q.hde=
!1;const oc=Q.Jyb;oc&&oc(d);Q.isVisible=!1}yg.StaticActiveAppFrame.Aa().Ne()},onCloseButtonTabKeyDown:oc=>{if(Q.cZb){const Ac=oc.shiftKey?OSF.AgaveHostAction.TabInShift:OSF.AgaveHostAction.TabIn;Ac===OSF.AgaveHostAction.TabIn?this.uqc(d)?(oc=document.getElementById(this.Cn.K(d).a4b.id),df.FocusManager.LP(oc)):(oc.preventDefault(),Q.cZb(d,Ac)):Q.hde||(oc.preventDefault(),Vc.UISurfaces.aw().then(ad=>{this.qkj(ad,Q,d,Ac);return null}))}},enableResize:Q.zD.isResizable,minResizeWidth:Q.zD.resizeMinWidth,
maxResizeWidth:Q.zD.resizeMaxWidth,showResizeChatButton:this.Cn.K(d).zD.showResizeChatButton,isPaneAutoOpened:Q.zD.isPaneAutoOpened||n,onShow:()=>{Fi.a.EF&&(this.Cn.K(d).Tcd=!0,this.O5b.Owe())},onHide:()=>{Fi.a.EF&&(this.Cn.K(d).Tcd=!1,this.O5b.Owe())}});G.AFrameworkApplication.J&&!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddingSharingIsEnabled",!1)&&(B.canBeShared=void 0,B.rightActionButtonProps=void 0,B.contentProps.addinSharingTaskPaneProps=void 0);this.uqc(d)&&
(ha=JSON.parse(Q.zD.settings.feedback),ha={...B.contentProps,type:"OcvFeedbackTaskPaneProps",hideHeader:!1,feedbackTaskPaneProps:{customerUiWrapperFeedbackData:ha,taskPaneLocation:B.location,taskPaneIdToClose:this.Cn.K(d).id}},B.contentProps=ha);G.AFrameworkApplication.J&&G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.HeaderIconURL")&&"fa000000125"==d.toLowerCase()&&(B.iconId="fa000000125",B.headerIconUrl="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Blue.svg");
return B}uqc(d){return this.Cn.Bb(d)?"Help.GiveFeedback.Url"===this.Cn.K(d).zD.sourceLocationOverrideResourceId:!1}a5b(d,n){this.Cn.Bb(d)&&(this.Cn.K(d).title=n,this.iek(d))}TIe(d,n){this.Cn.Bb(d)&&(this.Cn.K(d).iconUrl=n,this.iek(d))}iek(d){Vc.UISurfaces.aw().then(n=>{n.updateTaskPane(this.Cn.K(d).id,this.AB(d));return null})}hek(d,n){if(this.Cn.Bb(d)){const B=this.Cn.K(d);B.hde=!0;Vc.UISurfaces.aw().then(Q=>{const ha=this.AB(d);ha.actionButtonProps=n;ha.actionButtonProps.onTabKeyDown=Aa=>{Aa.shiftKey&&
B.cZb&&(Aa.preventDefault(),this.qkj(Q,B,d,OSF.AgaveHostAction.TabInShift))};Q.updateTaskPane(this.Cn.K(d).id,ha);return null})}}qkj(d,n,B,Q){2<=d.selectors.getTabbedTaskPaneCount()?d.focusTabbedTaskPaneArea():this.isResizable(n)?d.focusResizeHandle():n.cZb(B,Q)}E7c(d){return this.Cn.Bb(d)?this.Cn.K(d).title:null}CNi(d){return this.Cn.Bb(d)?this.Cn.K(d).iconUrl:null}dispose(){}qHe(d){let n=null;d=d.toLowerCase();for(const B of this.Cn.keys){let Q=d;B.toLowerCase()!==this.Muk.toLowerCase()&&(Q=d.substring(0,
B.length));if(Q===B.toLowerCase())return n=B,{returnValue:!0,LXc:n}}return{returnValue:!1,LXc:n}}p6c(d){return this.fRe+d}isResizable(d){return!!d&&!!d.zD&&d.zD.isResizable}}Object(D.a)(Hk,"ReactWordEditorAppsForOfficeUIManager",null,[1094]);class io extends Xm{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd=null,be){super(d,n,B,Q,ha,Aa,bb,oc,ad);this.O5b=be;this.Ljm={["fa000000059"]:!0,["FA000000002"]:!0};this.YMd=new ma.a;this.c2l=()=>{for(const ye of this.YMd)this.imo(ye)};this.bhf=(ye,Qe,af)=>
{if(2!==af)return ye!==dd.a.lDe||this.dZj()?bn.SessionStatusManager.instance.zk||Qs.a.bda(Qe.Pk)?8:32:16;Qe=this.g5("FA000000002.Ogma.Document.Url")?"FA000000002.Ogma.Document.Url":this.g5("FA000000002.Ogma.Settings.Url")?"FA000000002.Ogma.Settings.Url":"FA000000002.Ogma.Lookup.Url";ye=ye===dd.a.kDe?"Ogma.Cdn.Document.Url":ye===dd.a.lDe?"Ogma.Cdn.Settings.Url":"Ogma.Cdn.Lookup.Url";Qe!=="FA000000002."+ye&&this.g5(Qe)&&(F.ULS.sendTraceTag(39145870,399,50,"Closing Modern Translator task pane with Office CDN is used"),
this.yOb(Qe));F.ULS.sendTraceTag(39145871,399,50,"Opening Modern Translator task pane with Office CDN is used");Qe={};Qe.Locale=G.AFrameworkApplication.J.rb("ModernTranslatorLocale");Qe.SessionId=G.AFrameworkApplication.userSessionId;Qe.UserId=G.AFrameworkApplication.J.rb("ModernTranslatorLoggableUserId");Qe.MachineId=G.AFrameworkApplication.J.rb("ModernTranslatorMachineId");Qe.AugLoopUrl=G.AFrameworkApplication.J.rb("AugLoopCloudALServiceUrl");Qe.ReadingMode=2===eo.WoncaApp.instance.Uoa?"true":"false";
Qe.DocProtected=G.AFrameworkApplication.AR?"true":"false";Qe.DisableEdit=!Nf.a.Wu||Nf.a.Yn||Nf.a.q5&&G.AFrameworkApplication.Tx?"true":"false";Qe.DisableCopyCut=G.AFrameworkApplication.J.$("DisablePrint")&&G.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")?"true":"false";Qe.Reason=(0).toString();Qe.UseGoToTranslatedDocument="true";Qe.MicrofeedbackWacEnabled=G.AFrameworkApplication.J.$("MicrofeedbackSurveyIsEnabled");af=Wa.a.instance.Wa("WordEditor.TranslatorRoamingServiceManager");Qe.SettingsEnabled=
af?G.AFrameworkApplication.J.$("LanguageIntelligentSuggestionIsEnabled")&&void 0!==af.i3a&&null!==af.i3a&&""!==af.i3a.trim()?"true":"false":"false";af=new Xc.a;af.DW=Qe;af.sourceLocationOverrideResourceId=ye;af.AU=WacWordeditorStrings.ModernTranslatorTaskPaneTitle;af.isModernPane=!0;ye=G.AFrameworkApplication.J.$("LanguageTranslationIsEnabled");(ye=this.l6("FA000000002",af,ye))||F.ULS.sendTraceTag(42074889,399,10,"Modern Translator task pane failed to display with Office CDN is used");return ye?32:
16};this.bwe=(ye,Qe,af,Qf,hf)=>{if(1===af)return 32;ye=this.g5("FA000000002.Ogma.Document.Url")||this.g5("FA000000002.Ogma.Lookup.Url");hf&&(hf[Gf.a.On]=ye);return 32};this.rto=(ye,Qe,af,Qf,hf)=>{if(1===af)return 32;hf&&(hf[Qk.a.Visible]=this.dZj());return 32};this.Vfp=(ye,Qe,af)=>{if(2!==af)return 32;this.ga.Vb(dd.a.nLj,2);ye=new Xc.a;ye.AU="Suggested Tasks (Preview)";return this.l6("FA000000030",ye,!0)?32:16};this.kWo=(ye,Qe)=>{Pk.instance.Xrb(ye,Qe)};this.Jyb=ye=>{const Qe=this.z_.OSb(ye);ul.Ful(Qe);
const af=this.imi(Qe)||this.k1f(Qe);af&&this.lu.g2(ye)&&Pk.instance.R6d(Qe,!1);if(this.Sqn(Qe)){const Qf=this.z_.rUm(Qe);Qf&&Qf()}this.reb(Qe,af);this.lu.qWa(ye);this.oc.PW(this.VRf(Qe));this.O5b.Owe()};this.cZb=(ye,Qe)=>{let af=null;ye&&(af=this.z_.OSb(ye));if(!af)return F.ULS.sendTraceTag(19138189,344,10,"Add-in instanceId not found when pressing {Tab} on close button."),!1;this.nt.notifyAgave(af,Qe);this.hza=af;return!0};this.z_=Ib;this.nY=Ac;this.lu=yd||new Hk(sd,this.O5b)}mc(){super.mc();this.ga.qa(dd.a.i3b,
S.a.frame,this.bhf);this.ga.qa(dd.a.kDe,S.a.frame,this.bhf);this.ga.qa(dd.a.lDe,S.a.frame,this.bhf);this.ga.qa(dd.a.V_j,ed.a.view,this.Vfp);this.ga.nb(dd.a.bwe,ed.a.view,this.bwe,96);this.ga.qa(dd.a.nLj,S.a.frame,sq.ActionManager.qg);this.ga.nb(dd.a.qDj,S.a.frame,this.rto,96)}mAj(){const d=this.QPm();this.lEg(()=>{this.requestIdleCallback(this.c2l,0)},io.YPj);return d}QPm(){var d=!1;const n={};this.YMd.clear();var B=G.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.OEP.SdxAssetIdsToPreload",
"");if(!Ca.a.Vba(B)){d=!0;for(var Q of B.split("_"))n[Ca.a.Ph(Q)]=!0}if(d&&(B=this.OJi(),!Zj.a.isEmpty(B))){Q=Date.now()-6048E5;for(const ha in B)d=ha,B[ha]>Q&&(n[Ca.a.Ph(d)]=!0)}if(!Zj.a.isEmpty(n))for(const ha in n)this.YMd.add(ha);return this.YMd}imo(d){switch(d){case io.ykc:this.hmo();break;case "FA000000002":this.jmo();break;default:this.vpg(d,new Xc.a)}}hmo(){const d=Object.assign(new Xc.a,{AU:"Experimentation SDX",taskPaneWidth:0});this.i0o(d);this.vpg(io.ykc,d)}jmo(){const d=Object.assign(new Xc.a,
{sourceLocationOverrideResourceId:"Ogma.Cdn.Lookup.Url",sharedRuntimeId:"Ogma.Cdn.Lookup.Url"});this.vpg("FA000000002",d)}vpg(d,n){n.isPreload=!0;this.lEg(()=>{this.requestIdleCallback(()=>{this.l6(d,n,!0)},0)},200)}i0o(d){d.sourceLocationOverrideResourceId=io.eFf;d.sharedRuntimeId=io.eFf}requestIdleCallback(d,n){let B=!1;try{window.self.requestIdleCallback(d)}catch(Q){B=!0}B&&this.lEg(d,n)}lEg(d,n){n=new tb.a(2,1,n,()=>{d()});G.AFrameworkApplication.zc.pc(n)}dZj(){const d=Wa.a.instance.Wa("WordEditor.TranslatorRoamingServiceManager");
return!!d&&d.Pwn()}g5(d){return this.lu.g2(d)}n_i(d){return this.lu.zAn(d)}qWa(d){let n=null;({LXc:n}=this.lu.qHe(d)).returnValue&&this.Jyb(n)}k1f(d){if(!d)return!1;d=this.rPf(d);return!!d&&!!d.getSharedRuntimeId()}eKf(d){return this.lu.qUm(d)}nSj(d,n){if(this.fAd&&this.eKf(d)!=n){var B=this.z_.OSb(d);if(B=(B=this.rPf(B))?B.getSharedRuntimeId():null){var Q=this.fAd.n8d(d);Q?(Q.sharedRuntimeId=B,Q.backgroundState=n,this.fAd.ZYo(Q),this.lu.x6o(d,n)):Ak.Debug.Cgl("No appRef in setAppTaskPaneBackgroundState.",
544318937)}else Ak.Debug.Cgl("Not shared runtime in setAppTaskPaneBackgroundState.",544318859)}}Lbe(d){return this.lu.Lbe(d)}w5d(d,n,B){let Q=null;return({LXc:Q}=this.lu.qHe(d)).returnValue?(d=this.z_.OSb(Q))?this.MEf(d,n,B):!1:!1}MEf(d,n,B){n=Pk.instance.tJl(n,B);OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(d,n,this.kWo);return!0}Txo(d){let n="none";Ca.a.Vba(d)||(n=Ca.a.Ph(d.split(".")[0]));if(n in this.Ljm){d=this.OJi();d[n]=Date.now();try{localStorage.setItem("_OSF_Word_Preload_FPA_List",
JSON.stringify(d))}catch(B){}}}OJi(){let d={},n=null;try{n=localStorage.getItem("_OSF_Word_Preload_FPA_List")}catch(B){}Ca.a.Vba(n)||(d=JSON.parse(n));return d}showTaskPane(d,n,B){let Q=null;var ha=({LXc:Q}=this.lu.qHe(d)).returnValue,Aa=null;Aa=B.isPreload;const bb=B.isForUILessAction||Ca.a.Ph(d)===io.ykc;var Ib=!Ca.a.Vba(B.sharedRuntimeId);Aa?B.initialDisplayMode=1:(this.Txo(d),Ib&&(B.initialDisplayMode=bb?1:2));Ib&&(B.hostInfoFlags=1,n||(n=this.lu.E7c(d)));if(ha){ha=this.z_.OSb(Q);if(Ib=this.rPf(ha))B.settings&&
(Ib.setSettings(B.settings),Ib.setHostSettings(B.hostSettings)),n&&G.AFrameworkApplication.J.$("WordEditorAppsForOFficeRefreshTaskPaneTitleIsEnabled")&&"Help.GiveFeedback.Url"!==B.sourceLocationOverrideResourceId&&this.lu.a5b(Q,n);const oc=this.lu.g2(Q),Ac=this.lu.Bnc(Q);this.imi(ha)?(this.U1l(ha)&&(F.ULS.sendTraceTag(50685986,344,50,"Reactivating app before showing because it's in an error state."),this.pEj(ha)),oc||(this.lu.showTaskPane(Q,n,B,Aa,null,this.Jyb),Pk.instance.R6d(ha,!0))):(oc||this.k1f(ha))&&
this.Lln(ha)?Ib&&(Ib.isFirstParty()&&!this.k1f(ha)&&Ib.refresh(),this.lu.showTaskPane(d,n,B,bb),Pk.instance.R6d(ha,!0)):(this.pEj(ha),this.lu.showTaskPane(Q,n,B,bb,null,this.Jyb),Pk.instance.R6d(ha,!0));Aa=this.oc.te(Ac)}else G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")&&G.AFrameworkApplication.J.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled")&&!B.isAddinCommands&&(B.virtualOsfControlActivationCallback=()=>{this.Jyb(d);this.x8j(B)}),this.fdi(d,n,B,bb||Aa),n=this.lu.Bnc(d),Aa=this.oc.te(n),
this.XRh(Aa,B.id);Aa?(Aa.Pu(gm.KeyInputManager.xc(Jq.a.iB,0)),Aa.Pu(gm.KeyInputManager.xc(Jq.a.iB,4))):F.ULS.sendTraceTag(36767389,344,10,"FocusScope should be initialized.");bb||(this.oc.Rg(this.oc.NY),this.hza=null);return!0}rRh(d){const n=()=>{this.lu.qWa(d.solutionId);this.oc.Rg(this.oc.NY);Xg.a.instance.setItem("refreshRequired","true");this.x8j(d);this.lu.aIo(d.solutionId)};let B=null;const Q=d.solutionId;({LXc:B}=this.lu.qHe(Q)).returnValue?this.lu.g2(B)||this.lu.showTaskPane(B,"",d,!1):(this.lu.showTaskPane(Q,
"",d,this.rBf(Q)),this.Bk.value.insertBlankControlWithErrorUX(this.Zkd(d),n));this.oc.Rg(this.oc.NY);this.hza=null}a0j(d,n){const B=d.solutionId;this.lu.showTaskPane(B,"",d,this.rBf(B));this.Bk.value.insertBlankControlWithErrorUX(this.Zkd(d),()=>{this.lu.qWa(d.solutionId);this.oc.Rg(this.oc.NY);n()});this.oc.Rg(this.oc.NY);this.hza=null}x8j(d){var n={};n.solutionId=d.solutionId;n.version=d.version;n.storeType=d.storeType;n.storeId=d.storeId;n.assetId=d.assetId;n.assetStoreId=d.assetStoreId;n.targetType=
OSF.OsfControlType.ContainerLevel;G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")&&(n.sharedRuntimeId=d.sharedRuntimeId);d=new ma.a;d.add(n);n={};n[gf.a.cVd]=d;n[gf.a.eKa]=3;this.ga.Zb(Z.a.iXb,2,n)}Zkd(d){const n={};n.div=d.div;n.id=d.id;n.solutionId=d.solutionId;n.version=d.version;n.storeType=d.storeType;n.storeId=d.storeId;n.osfControlType=d.osfControlType;G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")&&(n.sharedRuntimeId=d.sharedRuntimeId);return n}createUILessSandbox(d,
n,B){this.rBf(d)?(this.fdi(d,n,B,!0),d=this.lu.Bnc(d),d=this.oc.te(d),this.XRh(d,B.id)):B.sharedRuntimeId?this.showTaskPane(d,n,B):(this.sRh(B),this.z_.add(B,d))}Z$a(d){return this.z_.OSb(d)}dispose(){super.dispose();this.lu.dispose()}ZDc(d,n,B=null){if(n===OSF.AgaveHostAction.TabExit||n===OSF.AgaveHostAction.TabExitShift){if(B=this.$Rb())3===B.G4c(d)?this.Bk.value.notifyAgave(d,OSF.AgaveHostAction.TabIn):(Af.a.Hj&&this.blur(),this.lu.S_m(this.z_.QXa(d),n))}else if(n===OSF.AgaveHostAction.EnableTaskPaneHeaderButton){const Q=
this.z_.QXa(d);B=Object.assign(new Nm,{label:B.Label,icon:B.Icon,onExecute:()=>{this.iao(Q)}});this.lu.hek(Q,B)}else n===OSF.AgaveHostAction.DisableTaskPaneHeaderButton?(B=this.z_.QXa(d),this.lu.hek(B,null)):n===OSF.AgaveHostAction.GetOriginalControlId?(d=B.controlId,n=new wg("",B.ownerAddinSolutionId,new Ye,!0),B.originalControlId=null==n?d:n.Bhi(d)):n===OSF.AgaveHostAction.PageIsReady?this.eCh&&this.eCh(d):super.ZDc(d,n,B)}VRf(d){d=this.z_.QXa(d);return this.lu.Bnc(d)}$Rb(){return this.z_}E7c(d){return this.lu.E7c(d)}XWh(d){if(d){var n=
d.getSolutionId();d=d.getVersion();var B=this.lu.E7c(n);if(!B||""===B)if(B=OSF.OsfManifestManager.getCachedManifest(n,d)){let Q=null;const ha=this.Bk.value.getAppUILocale();ha&&""!==ha&&(Q=B.getDisplayName(ha));Q&&""!==Q||(Q=B.getDefaultDisplayName());this.lu.a5b(n,Q)}B=this.lu.CNi(n);if(!B||""===B)if(d=OSF.OsfManifestManager.getCachedManifest(n,d))d=d.getDefaultIconUrl(),this.lu.TIe(n,d)}}XRh(d,n){d.Rla(()=>{this.aZo(n,Af.a.Hj)});d.n8a(()=>{this.cZo(n)})}U1l(d){if(!this.Bk.value)return F.ULS.shipAssertTag(50685987,
341,!1,"ContextActivationManager unavailable while trying to figure out if app is one of the error states: {0}",d),!1;d=this.Bk.value.getOsfControlStatus(d);return d!==OSF.OsfControlStatus.Activated&&d!==OSF.OsfControlStatus.NotActivated}imi(d){return this.Oln(d)}rBf(d){return"FA000000029"===d}fdi(d,n,B,Q){G.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&!OSF.OsfControl.isFirstPartyStoreString(B.storeType)?G.AFrameworkApplication.ta&&!G.AFrameworkApplication.ta.Pb.s9(22)&&(d=new ka.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,
CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),d.id=22,d.image=1,d.closeable=!0,G.AFrameworkApplication.ta.Pb.dBa(d,!0)||F.ULS.sendTraceTag(36962447,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user.")):G.AFrameworkApplication.B8a||OSF.OsfControl.isFirstPartyStoreString(B.storeType)?(this.lu.showTaskPane(d,n,B,Q,this.cZb,this.Jyb),this.sRh(B),this.z_.add(B,d)):(F.ULS.sendTraceTag(571860445,344,50,"Taskpane web add-in disabled by doc IRM"),
G.AFrameworkApplication.ta&&!G.AFrameworkApplication.ta.Pb.s9(36)&&(d=new ka.a(CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle,CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage,null),d.id=36,d.image=1,d.closeable=!0,G.AFrameworkApplication.ta.Pb.dBa(d,!0)||F.ULS.sendTraceTag(573388438,306,10,"Failed to add entry to business bar. CLP protected doc addins disabled message could not be shown to user.")))}p6c(d){return this.lu.p6c(d)}iao(d){let n=null;d&&(n=this.z_.OSb(d));n?(this.nt.notifyAgave(n,
OSF.AgaveHostAction.TaskPaneHeaderButtonClicked),this.hza=n):F.ULS.sendTraceTag(50738267,344,10,"Add-in instanceId not found when clicking on TaskPaneAction button.")}Oln(d){d=this.z_.ZLf(d);return!!d&&"FA000000029"===d.$n}Sqn(d){d=this.z_.ZLf(d).storeType.toLowerCase();return d===OSF.StoreType.FirstParty.toLowerCase()||d===OSF.StoreType.Sdx.toLowerCase()}rPf(d){return this.Bk.value?this.Bk.value.getOsfControl(d):null}a5b(d,n){this.lu.Bnc(d);this.lu.E7c(d)!==n&&this.lu.a5b(d,n)}TIe(d,n){this.lu.Bnc(d);
this.lu.CNi(d)!==n&&this.lu.TIe(d,n)}}io.ykc="fa000000059";io.eFf="FA59SharedRuntime.Url";io.YPj=1E4;Object(D.a)(io,"WordEditorAppsForOfficeUIActor",Xm,[]);class bq{constructor(d,n){this.Ai=d;this.Ai.ljf(Object(X.a)(this,this.$xl,"clearHandlersForApp"));this.OAk=n}get EEf(){return this.OAk}Jlc(d){F.ULS.shipAssertTag(5902748,341,!!this.EEf);let n;return({value:n}=this.EEf.Nc(d)).returnValue?n:null}$xl(d,n){for(const B of this.EEf)B.value&&B.value.removeHandler(n,null)}}Object(D.a)(bq,"ApiEventStore",
null,[1920]);var os=e(637),ti;(function(d){d[d.K$p=1]="getSelectedDataAsync";d[d.suq=2]="setSelectedDataAsync";d[d.m_p=3]="addAppBindingFromSelectionAsync";d[d.l_p=4]="addAppBindingFromNamedItemAsync";d[d.s$p=5]="getDataAsync";d[d.ouq=6]="setDataAsync";d[d.V0p=7]="bindingSelectionChangedEvent";d[d.u$p=8]="getFileAsync";d[d.A_p=9]="addTableBindingRowsAsync";d[d.z_p=10]="addTableBindingColumnsAsync";d[d.S4p=11]="deleteAllDataValuesAsync";d[d.g$p=12]="getAllAsync";d[d.k$p=13]="getByIdAsync";d[d.krq=
14]="releaseByIdAsync";d[d.T$p=15]="goToByIdAsync";d[d.wjj=16]="messageParent";d[d.cuq=17]="sendMessageToDialog";d[d.getAccessToken=18]="getAccessToken";d[d.U0p=19]="bindingDataChangedEvent";d[d.v5p=20]="displayRibbonCalloutAsync";d[d.vuq=21]="setTextAsync";d[d.p_p=22]="addCustomXmlNodeAsync"})(ti||(ti={}));Object(D.b)("ApiName",ti);const Fl=(d,n,B,Q=null)=>{Q||(Q={});Q.ApiName=ti[d];Q.ApiCode=d;Q.AppId=n;Q.Result=B;F.ULS.sendTraceTag(17131735,341,50,"{0}",Q)};class Kq extends dn{constructor(){super();
this.BM=this.rq=null;this.Ihg=(d,n)=>{n.Fe&&(d=this.M0.Cqm(n.Fe),this.Ghi=this.M0.som(d),this.hE())};this.Ghi=new ma.a}get M0(){this.rq||(this.rq=Wa.a.instance.Wa("WordEditor.AppsForOffice.IAppBindingHelper"));return this.rq}set M0(d){this.rq=d}get E9a(){this.BM||(this.BM=Wa.a.instance.Wa("Box4.IContentControlDataChangedManager"));return this.BM}set E9a(d){this.BM=d}addHandler(d,n,B,Q=null){this.E9a&&this.M0?this.M0.J_i?(this.zh.count||this.E9a.addHandler(os.a.I0b,this.Ihg),this.zh.W(this.D8a(d,Q),
n),this.M0.Ale(d,Q,"Binidng.AddHandler for BindingDataChangedEvent"),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,n,B=null){this.E9a&&this.M0?this.M0.J_i?B?this.M0.i6c(this.zh,this.D8a(d,B))?(this.zh.remove(this.D8a(d,B)),this.zh.count||this.E9a.removeHandler(os.a.I0b,this.Ihg),this.M0.Ale(d,B,"Binidng.RemoveHandler for BindingDataChangedEvent"),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
this.mvg(d,n):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}IDj(d,n=null){if(this.M0&&(d=this.M0.i6c(this.zh,this.D8a(d,n)))){const B={};B[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=n;n={};n[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=B;d(n)}}mvg(d,n){if(this.E9a){const B=new ma.a;for(const Q of this.zh.keys)Q.startsWith(d)&&B.add(Q);for(const Q of B)this.zh.remove(Q);this.zh.count||this.E9a.removeHandler(os.a.I0b,
this.Ihg);this.PJ(n)}else this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}D8a(d,n){return d+"-"+n}hE(){for(const d of this.Ghi){const n=d[Kh.zfc],B=d[Kh.KVd],Q=d[OSF.DDA.Marshaling.AppBindingKeys.BindingId];let ha=this.M0.Wzi(B);ha=ha?ha:new ma.a;ha.add(n);for(const Aa of ha)this.IDj(Aa,Q),Fl(19,B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}static get instance(){return null!=Kq.J1g?Kq.J1g:Kq.J1g=new Kq}}Object(D.a)(Kq,"BindingDataChangedEvent",dn,[]);class Tl extends dn{constructor(d){super();
this.RHa=this.rq=null;this.Fvc=()=>{this.IQj=this.M0.lQm();this.RHa?this.Sb.Kf(this.RHa):this.RHa=new tb.a(4,1,Tl.Bjl,()=>{this.RHa=null;this.hE()});this.Sb.pc(this.RHa)};this.Sb=d;this.IQj=new ma.a}get M0(){this.rq||(this.rq=Wa.a.instance.resolve("WordEditor.AppsForOffice.IAppBindingHelper"));return this.rq}set M0(d){this.rq=d}addHandler(d,n,B,Q=null){this.Dg?(this.zh.count||this.Dg.oVh(this.Fvc),this.zh.W(this.D8a(d,Q),n),this.M0.Ale(d,Q,"Binidng.AddHandler for bindingSelectionChangedEvent"),this.PJ(B)):
this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,n,B=null){B?this.Dg&&this.i6c(this.zh,this.D8a(d,B))?(this.zh.remove(this.D8a(d,B)),this.zh.count||this.Dg.Fwg(this.Fvc),this.M0.Ale(d,B,"Binidng.RemoveHandler for bindingSelectionChangedEvent"),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.mvg(d,n)}mvg(d,n){if(this.Dg){const B=new ma.a;for(const Q of this.zh.keys)Q.startsWith(d)&&B.add(Q);for(const Q of B)this.zh.remove(Q);this.zh.count||
this.Dg.Fwg(this.Fvc);this.PJ(n)}else this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}D8a(d,n){return d+"-"+n}hE(){for(const B of this.IQj){var d=B[Kh.zfc];const Q=B[Kh.KVd],ha=B[OSF.DDA.Marshaling.AppBindingKeys.BindingId]?B[OSF.DDA.Marshaling.AppBindingKeys.BindingId]:null,Aa=B[OSF.DDA.Marshaling.AppBindingKeys.BindingType]?B[OSF.DDA.Marshaling.AppBindingKeys.BindingType]:null;var n=this.M0.Wzi(Q);n=n?n:new ma.a;n.add(d);for(const bb of n)if(d=this.i6c(this.zh,this.D8a(bb,ha))){Fl(7,
Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{["BindingType"]:Aa});n={};n[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ha;n[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=Aa;const Ib={};Ib[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=n;Aa===pj.table&&(Ib[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=B[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]);d(Ib)}}}i6c(d,n){if(d.Bb(n))return d.K(n);const B=RegExp("\t","g");for(const Q of d)if(Q.key.replace(B," ")===n)return Q.value;return null}static get instance(){return null!=
Tl.O1g?Tl.O1g:Tl.O1g=new Tl(G.AFrameworkApplication.zc)}}Tl.Bjl=100;Object(D.a)(Tl,"BindingSelectionChangedEvent",dn,[]);const Om=(d,n,B)=>{for(const Q of n.keys)-1<Q.indexOf(d)&&n.K(Q)(B)};class cq extends dn{constructor(){super();this.FCh=this.v7n=(d,n)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Iee;d[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=n.hoj;d[OSF.DDA.Marshaling.DataNodeEventProperties.NextSiblingNode]=n.gmq;Om(n.Mic,this.zh,d)}}addHandler(d,n,B,Q){this.Dg&&
Q?(this.zh.count||this.Dg.Lic.fif(jn.Nrj,this.FCh),this.zh.W(d+"-"+Q,n),F.ULS.sendTraceTag(19489929,341,50,"Add handler for nodeDeleted event on custom xml file whose id is: {0}.",Q),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,n,B){d=d+"-"+B;this.Dg&&B&&this.zh.Bb(d)?(this.zh.remove(d),this.zh.count||this.Dg.Lic.Mvg(jn.Nrj,this.FCh),F.ULS.sendTraceTag(19489930,341,50,"Remove handler for nodeDeleted event on custom xml file whose id is: {0}.",B),this.PJ(n)):
this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}hE(){}static get instance(){return null!=cq.J2g?cq.J2g:cq.J2g=new cq}}Object(D.a)(cq,"DataNodeDeletedEvent",dn,[]);class on extends dn{constructor(){super();this.GCh=this.w7n=(d,n)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Iee;d[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=n.tfg;Om(n.Mic,this.zh,d)}}addHandler(d,n,B,Q){this.Dg&&Q?(this.zh.count||this.Dg.Lic.fif(jn.Mjg,this.GCh),this.zh.W(d+"-"+Q,n),F.ULS.sendTraceTag(19489931,
341,50,"Add handler for nodeInserted event on custom xml file whose id is: {0}.",Q),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,n,B){d=d+"-"+B;this.Dg&&B&&this.zh.Bb(d)?(this.zh.remove(d),this.zh.count||this.Dg.Lic.Mvg(jn.Mjg,this.GCh),F.ULS.sendTraceTag(19489932,341,50,"Remove handler for nodeInserted event on custom xml file whose id is: {0}.",B),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}hE(){}static get instance(){return null!=
on.F2g?on.F2g:on.F2g=new on}}Object(D.a)(on,"DataNodeInsertedEvent",dn,[]);class Jl extends dn{constructor(){super();this.HCh=this.x7n=(d,n)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=n.Iee;d[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=n.hoj;d[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=n.tfg;Om(n.Mic,this.zh,d)}}addHandler(d,n,B,Q){this.Dg&&Q?(this.zh.count||this.Dg.Lic.fif(jn.Pjg,this.HCh),this.zh.W(d+"-"+Q,n),F.ULS.sendTraceTag(19489933,341,50,"Add handler for nodeReplaced event on custom xml file whose id is: {0}.",
Q),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,n,B){d=d+"-"+B;this.Dg&&B&&this.zh.Bb(d)?(this.zh.remove(d),this.zh.count||this.Dg.Lic.Mvg(jn.Pjg,this.HCh),F.ULS.sendTraceTag(19489934,341,50,"Remove handler for nodeReplaced event on custom xml file whose id is: {0}.",B),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}hE(){}static get instance(){return null!=Jl.M1g?Jl.M1g:Jl.M1g=new Jl}}Object(D.a)(Jl,"DataNodeReplacedEvent",
dn,[]);class Uo extends dn{constructor(d){super();this.Fjg=(n,B)=>{this.zh.Bb(B.controlId)&&(n={},n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=B.messageType,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=B.messageContent,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=B.Gbg,n[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=B.phb,this.zh.K(B.controlId)(n),B.messageType===OSF.DialogMessageType.DialogClosed&&
(this.zh.remove(B.controlId),this.zh.count||this.Dg.sQa.l$a.RJj(this.Fjg)))};this.Sza=d}addHandler(d,n,B,Q=null){if(this.Sza)if(this.Dg){F.ULS.sendTraceTag(19787875,341,50,"DialogMessageReceivedEvent.AddHandler called!");const ha=Aa=>{Aa===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.zh.count||this.Dg.sQa.l$a.J7k(this.Fjg),this.zh.W(d,n),this.PJ(B)):(Aa!==OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains&&F.ULS.sendTraceTag(19787904,341,10,"DialogMessageReceivedEvent.AddHandler failed!"),
this.ft(B,Aa))};this.zh.Bb(d)?ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Dg.sQa.showDialog(d,Q,ha)}else this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,n){this.Sza?this.Dg&&this.zh.Bb(d)?(F.ULS.sendTraceTag(19787905,341,50,"DialogMessageReceivedEvent.RemoveHandler called!"),this.Dg.sQa.LBa(d,B=>{this.zh.remove(d);this.zh.count||this.Dg.sQa.l$a.RJj(this.Fjg);B===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
this.PJ(n):(F.ULS.sendTraceTag(19787906,341,10,"DialogMessageReceivedEvent.RemoveHandler failed!"),this.ft(n,B))})):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}hE(){}static get instance(){const d=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return Uo._instance||(Uo._instance=new Uo(d))}}Uo._instance=null;Object(D.a)(Uo,"DialogMessageReceivedEvent",
dn,[]);class Vo extends dn{constructor(d){super();this.Sza=d}addHandler(d,n,B){if(this.Sza)if(this.Dg){F.ULS.sendTraceTag(19787907,344,50,"DialogNotificationShownInAddinEvent.AddHandler called!");try{const Q=this.Dg.sQa.wQa(d);Q===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.PJ(B):this.ft(B,Q)}catch(Q){F.ULS.sendTraceTag(19787908,344,10,"DialogNotificationShownInAddinEvent.AddHandler failed. Error message: {0}.",Q.message),this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.ft(B,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,n){if(this.Sza)if(this.Dg){F.ULS.sendTraceTag(19787909,344,50,"DialogNotificationShownInAddinEvent.RemoveHandler called!");try{const B=this.Dg.sQa.$Ma(d);B===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.PJ(n):this.ft(n,B)}catch(B){F.ULS.sendTraceTag(19787910,344,10,"DialogNotificationShownInAddinEvent.RemoveHandler failed. Error message: {0}.",
B.message),this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}hE(){}static get instance(){const d=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return Vo._instance||(Vo._instance=new Vo(d))}}Vo._instance=null;Object(D.a)(Vo,"DialogNotificationShownInAddinEvent",dn,[]);class dq extends dn{constructor(d){super();
this.srj=(n,B)=>{this.zh.Bb(B.controlId)&&(n={},n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=B.messageType,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=B.messageContent,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=B.Gbg,n[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=B.phb,this.zh.K(B.controlId)(n))};this.Sza=d}addHandler(d,n,B){this.Sza?this.Dg?(F.ULS.sendTraceTag(595130066,
341,50,"DialogParentMessageReceivedEvent.AddHandler called!"),this.zh.count||this.Dg.sQa.l$a.I7k(this.srj),this.zh.W(d,n),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,n){this.Sza?this.Dg&&this.zh.Bb(d)?(F.ULS.sendTraceTag(595130065,341,50,"DialogParentMessageReceivedEvent.RemoveHandler called!"),this.zh.remove(d),this.zh.count||this.Dg.sQa.l$a.XIo(this.srj),this.PJ(n)):this.ft(n,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}hE(){}static get instance(){const d=G.AFrameworkApplication.J?G.AFrameworkApplication.J.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return dq._instance||(dq._instance=new dq(d))}}dq._instance=null;Object(D.a)(dq,"DialogParentMessageReceivedEventWord",dn,[]);class gr extends dn{constructor(d){super();this.RHa=null;this.Fvc=()=>{this.RHa?this.Sb.Kf(this.RHa):this.RHa=
new tb.a(4,1,gr.Q2l,()=>{this.RHa=null;this.hE()});this.Sb.pc(this.RHa)};this.Sb=d}addHandler(d,n,B){this.Dg?(this.zh.count||this.Dg.oVh(this.Fvc),this.zh.W(d,n),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,n){this.Dg&&this.zh.Bb(d)?(this.zh.remove(d),this.zh.count||this.Dg.Fwg(this.Fvc),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}hE(){for(const d of this.zh.values)d&&d({})}static get instance(){return null!=gr.X1g?gr.X1g:
gr.X1g=new gr(G.AFrameworkApplication.zc)}}gr.Q2l=100;Object(D.a)(gr,"DocumentSelectionChangedEvent",dn,[]);class Pm extends dn{constructor(d,n,B,Q){super();this.lGc=null;this.Ptj=(ha,Aa)=>{if(Aa)if(ha=Aa.node,!ha)F.ULS.sendTraceTag(22024347,341,10,"node is null");else{if(47===ha.type&&21===Aa.W6h){if((Aa=this.td.Ag(ha))&&Aa.ic(21))for(;Aa.gg(21););Aa=new ma.a;this.faa&&(Aa=ha.getValue(Dd.a.PVa),Aa=this.faa.xFi(Aa));Aa.add(ha.id.toString());for(const bb of Aa)this.zh.Bb(bb)&&(ha=this.zh.K(bb))&&ha({})}}else F.ULS.sendTraceTag(22024346,
341,10,"TopologyChangedEventArgs is null")};d&&(this.lGc=d.Hf(47));this.td=n;this.PJh=Q;this.faa=B}addHandler(d,n,B){this.PJh?this.lGc?(this.zh.count||this.lGc.MUh(this.Ptj),this.zh.W(d,n),this.PJ(B)):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.ft(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,n){this.PJh?this.lGc&&this.zh.Bb(d)?(this.zh.remove(d),this.zh.count||this.lGc.FJj(this.Ptj),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}hE(){}static get instance(){try{const d=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");return Pm._instance||(Pm._instance=new Pm(Nf.a.wf.Um,new rd.a,Wa.a.instance.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d))}catch(d){return F.ULS.sendTraceTag(22024348,341,10,"Failed to get SettingsChangedEvent Instance: {0}.",d),null}}}Pm._instance=null;Object(D.a)(Pm,
"SettingsChangedEvent",dn,[]);class Wo extends dn{hE(){throw Error("Method not implemented.");}constructor(d){super();this.Bk=d}addHandler(d,n,B){this.zh.count||this.Bk.value.setOfficeThemeChangedHandler(this.C7n);this.zh.W(d,n);this.PJ(B)}C7n(d){for(const n of Wo._instance.zh.values)n&&n(d)}removeHandler(d,n){this.zh.Bb(d)?(this.zh.remove(d),this.PJ(n)):this.ft(n,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){try{return Wo._instance||(Wo._instance=new Wo(Wa.a.instance.zf("Common.App.AppsForOfficeCommon.IContextActivationManager")))}catch(d){return F.ULS.sendTraceTag(512300628,
341,10,"Failed to get OfficeThemeChangedEvent Instance: {0}.",d),null}}}Wo._instance=null;Object(D.a)(Wo,"OfficeThemeChangedEvent",dn,[]);class vo extends bq{constructor(d,n,B){super(d,n);this.SXe=B}Jlc(d){if(d=super.Jlc(d))d.Dg=this.SXe;return d}static MLl(d,n){const B=new Sb.a;B.W(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,gr.instance);B.W(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent,Tl.instance);B.W(OSF.DDA.EventDispId.dispidBindingDataChangedEvent,Kq.instance);B.W(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,
Uo.instance);B.W(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,dq.instance);B.W(OSF.DDA.EventDispId.dispidDataNodeAddedEvent,on.instance);B.W(OSF.DDA.EventDispId.dispidDataNodeReplacedEvent,Jl.instance);B.W(OSF.DDA.EventDispId.dispidDataNodeDeletedEvent,cq.instance);B.W(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,Vo.instance);B.W(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Pm.instance);B.W(OSF.DDA.EventDispId.dispidRichApiMessageEvent,Pk.instance);B.W(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,
Wo.instance);return new vo(d,B,n)}}Object(D.a)(vo,"WordEditorEventStore",bq,[]);class hg{constructor(){this.ZKk=new fa.a(()=>this.Pko())}get zjj(){return this.ZKk.value}cKf(d){F.ULS.shipAssertTag(5902749,341,!!this.zjj);let n;return({value:n}=this.zjj.Nc(d)).returnValue?n():null}}Object(D.a)(hg,"ApiMethodFactory",null,[1918]);class co{constructor(d,n,B){this.customizedActionDic=this.xk=this.controlId=null;this.parameters=d;this.callback=n;this.C9k=B;this.Rv={};this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get errorCode(){return this._errorCode}get result(){return this.Rv}go(){this.execute();
this.Bp()}execute(){}Bp(){this.callback&&(this.result.Error=this.errorCode,this.callback(this.result))}}Object(D.a)(co,"ApiMethod",null,[]);class tq extends co{constructor(){super();this.Dg=null}static h1d(d){const n=new tq;n._errorCode=d;return n}}Object(D.a)(tq,"LiveBooksApiMethod",co,[]);class iu extends tq{constructor(d){super();this.Sza=d}go(){let d;this.Sza?this.Dg?(this.Dg.sQa.sendMessage(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[gf.a.bkf],
this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.ZWo(d)}ZWo(d){this._errorCode=d;this.Bp()}}Object(D.a)(iu,"SendMessageMethod",tq,[]);var Qm=e(1834);class Ik extends tq{constructor(d){super();this.Ai=d}go(){var d=this.Ai.nt.getOsfControl(this.controlId);if(!G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",
!1)||d.isFirstParty()){d=d.getManifest();var n=d.getMarketplaceID(),B=d.getWebApplicationId(),Q=d.getWebApplicationMsaId();Wa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(n).then(ha=>{this._errorCode=0;const Aa={};Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ha.upn;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ha.userId;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=B;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
Q?Q:B;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ha.authority;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Qm.a.Lyi(ha.authorityType);Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ha.isAnonymous;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ha.tenantId;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ha.supportsAuthToken;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Aa;this.Bp()},ha=>{const Aa={},bb=new Qm.a;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=bb.upn;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=bb.userId;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=B;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Q?Q:B;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=bb.authority;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Qm.a.Lyi(bb.authorityType);Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
bb.isAnonymous;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=bb.tenantId;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=bb.supportsAuthToken;Aa[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ha;this._errorCode=1;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Aa;this.Bp()})}}}Object(D.a)(Ik,"GetAuthContextMethod",tq,[]);class zh extends co{constructor(){super();this.Dg=null}static h1d(d){const n=new zh;n._errorCode=
d;return n}}Object(D.a)(zh,"WordEditorApiMethod",co,[]);class jo extends zh{constructor(d){super();this.b0=d}go(){let d="";if(this.b0)if(this.Dg){var n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]&&n[OSF.DDA.Marshaling.BindingParameterKeys.ItemName]){let B=null;n[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(B=n[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());d=n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();
this._errorCode=({YM:n}=this.Dg.c0k(this.xk,B,n[OSF.DDA.Marshaling.BindingParameterKeys.ItemName].toString(),d)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;Fl(4,this.xk.$n,this.errorCode,{["BindingType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
F.ULS.sendTraceTag(16795283,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to AddAppBindingFromNamedItem api"});this.Bp()}}Object(D.a)(jo,"AddAppBindingFromNamedItemMethod",zh,[]);class ps extends zh{constructor(d){super();this.b0=d}go(){let d="";if(this.b0)if(this.Dg){var n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]){let B=null;n[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&
(B=n[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());d=n[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();this._errorCode=({YM:n}=this.Dg.d0k(this.xk,B,d)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;Fl(3,this.xk.$n,
this.errorCode,{["BindingType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(16795285,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to AddAppBindingFromSelection api"});this.Bp()}}Object(D.a)(ps,"AddAppBindingFromSelectionMethod",zh,[]);class qs extends zh{constructor(d,n){super();this.EIa=d;this.rm=n}execute(){if(this.EIa){var d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],
B=this.rm.dYa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this._errorCode=void 0===B||null===B||B.builtIn?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:B.ZSh(d,n)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Bp()}}Object(D.a)(qs,"AddDataNamespaceMethod",zh,[]);const ko=(d,n,B)=>{let Q=B.$n||"00000000-0000-0000-0000-000000000000";B=B.rK?
B.rK:B;B.storeType&&B.store&&B.$n&&(Q=Telemetry.PrivacyRules.GetPrivacyCompliantId(B.$n,B.storeType,null,null,null,null));F.ULS.sendTraceTag(509368257,341,10,"{0}",{["ApiCode"]:d,["AppId"]:Q,["Result"]:n});n!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&F.ULS.sendTraceTag(509368256,341,10,"{0}",{["error"]:n,["apiName"]:d,["appId"]:Q})};class La extends zh{constructor(d,n){super();this.EIa=d;this.rm=n}execute(){if(this.EIa){var d=null;this._errorCode=({lhd:d}=this.rm.Ghf(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml])).returnValue;
if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){const n={};n[OSF.DDA.Marshaling.DataPartProperties.Id]="{"+d.id.gv.toString().toUpperCase()+"}";n[OSF.DDA.Marshaling.DataPartProperties.BuiltIn]=!1;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=n}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;ko(22,this.errorCode,this.xk);this.Bp()}}Object(D.a)(La,"AddDataPartMethod",zh,[]);class $a extends zh{constructor(d){super();this.RTh=
n=>{this._errorCode=n;this.ZL();this.Bp()};this.b0=d}go(){if(this.b0)if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&d[OSF.DDA.Marshaling.SetDataKeys.Data]){var n=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let B,Q;0<d[OSF.DDA.Marshaling.SetDataKeys.Data].length?(B=null,d=d[OSF.DDA.Marshaling.SetDataKeys.Data],Q=!1):(d=d[OSF.DDA.Marshaling.SetDataKeys.Data],B=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders],
d=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows],Q=!0);this.Dg.Chf(n,this.xk,B,d,Q,this.RTh);return}n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else n=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.RTh(n)}ZL(){Fl(10,this.xk.$n,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(17580612,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,
["errMsg"]:"unexpected error to AddTableBindingColumnsAsync API"})}}Object(D.a)($a,"AddTableBindingColumnsMethod",zh,[]);class Jb extends zh{constructor(d){super();this.STh=n=>{this._errorCode=n;this.ZL();this.Bp()};this.b0=d}go(){if(this.b0)if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&d[OSF.DDA.Marshaling.SetDataKeys.Data]){this.Dg.zif(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.xk,d[OSF.DDA.Marshaling.SetDataKeys.Data],
this.STh);return}d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.STh(d)}ZL(){Fl(9,this.xk.$n,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(17580613,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to AddTableBindingRowsAsync API"})}}Object(D.a)(Jb,"AddTableBindingRowsMethod",
zh,[]);class uc extends zh{constructor(){super()}execute(){try{OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[gf.a.l9k][gf.a.k9k],this.parameters),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(d){F.ULS.sendTraceTag(17306273,341,10,"AppCommandInvocationCompletedMethod: unexpected exception {0}",d.message),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}this.Bp()}}Object(D.a)(uc,"AppCommandInvocationCompletedMethod",zh,[]);class Sc extends zh{constructor(){super()}go(){this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;F.ULS.shipAssertTag(20854624,341,!!this.Dg.CMa);if(this.Dg&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]){const n=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle],B=this.Dg.CMa.oCi(this.controlId,n);if(B){var d=B.Brc;if(B.b5f)this._errorCode=this.Dg.CMa.nHj(this.controlId,n),this.Bp();else try{this.Dg.CMa.rWo(this.controlId,d,n,
Q=>{this._errorCode=Q;this.Bp()})}catch(Q){F.ULS.sendTraceTag(20854625,341,15,"Error happens when send close document request. "+Q.message)}}}}}Object(D.a)(Sc,"CloseDocumentCopyMethod",zh,[]);class nd extends zh{constructor(d,n){super();this.EIa=d;this.rm=n}execute(){this._errorCode=this.EIa?this.rm.jji(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]):OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Bp()}}Object(D.a)(nd,"DeleteDataPartMethod",zh,[]);class O extends zh{constructor(d){super();
this.Cji=n=>{this._errorCode=n;this.ZL();this.Bp()};this.b0=d}go(){if(this.b0)if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]){this.Dg.hzf(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.xk,this.Cji);return}d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Cji(d)}ZL(){Fl(11,
this.xk.$n,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(17580614,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to deleteAllDataValuesAsync API"})}}Object(D.a)(O,"DeleteTableBindingRowsMethod",zh,[]);class la extends zh{constructor(d){super();this.i$l=(n,B)=>{this._errorCode=B;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
n);this.Bp()};this.ZHk=d}go(){if(this.ZHk)if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData];if(d)try{let n=this.xk.$n||"00000000-0000-0000-0000-000000000000";const B=this.xk.rK?this.xk.rK:this.xk;B.storeType&&B.store&&B.$n&&(n=Telemetry.PrivacyRules.GetPrivacyCompliantId(B.$n,B.storeType,null,null,null,null));this.Dg.k$l(d,n,this.controlId,this.xk,this.i$l)}catch(n){F.ULS.sendTraceTag(17126306,344,10,"{0}",n.message),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
this.Bp()}else F.ULS.sendTraceTag(9204821,344,10,"The rich api executor input parameter should not be null."),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.Bp()}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.Bp();else F.ULS.sendTraceTag(9291534,341,15,"The Rich App API feature is not enabled."),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,this.Bp()}}Object(D.a)(la,"ExecuteRichApiRequestMethod",zh,[]);var cb=
e(1637);class Nb{}Nb.nab="generalException";Nb.Ufe="invalidArgument";Nb.$fg="notAllowed";Nb.Zkf="apiNotAvailable";Nb.zBp="unresolvedPendingRequest";Nb.timeout="timeout";Nb.rhf="adalTimeout";Nb.ofk="userNotSignedIn";Nb.dxd="userAborted";Nb.q0j="silentSignInFailed";Nb.kad="invalidResourceUrl";Nb.VZf="invalidGrant";Nb.iai="connectionLost";Nb.lsf="clientError";Nb.ZBg="serverError";Object(D.a)(Nb,"WopiHostErrorCodes",null,[]);class fc{}Object(D.a)(fc,"OAuthCallerMetadata",null,[]);class Hc{constructor(d){this.vda=
d;this.xAk=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}h_k(d,n,B,Q,ha,Aa){if(!this.vda)return Q=new mm,Q.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Q);const bb=new fc;bb.AddinName=ha;bb.AddinTrustId=Aa;let Ib=-1;Aa=null;if(Q&&this.G3i())Aa=this.vda.C9j(gf.a.mGe,d,Q,Hc.fKi(ha),bb);else{const oc=Date.now();Aa=this.vda.kX(gf.a.mGe,d,bb).then(Ac=>{Ib=Date.now()-oc;const ad=(n||B)&&"login_required"===Ac.ErrorCode;
return(n&&("interaction_required"===Ac.ErrorCode||"consent_required"===Ac.ErrorCode||"invalid_grant"===Ac.ErrorCode)||ad)&&this.G3i()?this.vda.C9j(gf.a.mGe,d,null,Hc.fKi(ha),bb):Promise.resolve(Ac)})}return Aa.then(oc=>{const Ac=new mm;oc.IsSuccess?(Ac.token=oc.Token,oc.Telemetry&&(Ac.q4b=oc.Telemetry.fromCache,Ac.expiresOn=oc.Telemetry.expiresOn)):(Ac.errorCode=this.uQn(oc),Ac.rLg=this.rgo(oc));return Ac}).catch(()=>{const oc=new mm;oc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
return Promise.resolve(oc)}).then(oc=>{oc.H8a="OauthManager";0<=Ib&&(oc.K7c=Ib);return oc})}Xpn(d){const n=(G.AFrameworkApplication.J.rb(G.AFrameworkApplication.Zja)||"").toLowerCase();return(Af.a.e_a||"teams"===n&&cr.a.t9c)&&!Hc.vpn(d)||!this.vda||!this.vda.Zln()?!1:!0}G3i(){return this.xAk||1!==cb.a.p8d()}uQn(d){switch(d.ErrorCode){case "UserCancelled":case "interaction_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;
break;case "login_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:d=d.ErrorCode===Nb.dxd?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:d.ErrorCode===Nb.q0j?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:d.ErrorCode===Nb.kad?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:d.ErrorCode===Nb.VZf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:d.ErrorCode===Nb.iai?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return d}rgo(d){let n="";(d=RegExp("AADSTS(\\d+)").exec(d.ErrorMessage))&&1<d.length&&(n=d[1]);return n}static fKi(d){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,
d)}static vpn(d){if(!d)return!1;d=d.toLowerCase();for(const n of ul.pui)if(n===d)return!0;return!1}}Object(D.a)(Hc,"AppsforOfficeTokenFromOauthManager",null,[1905]);class Qc{constructor(d){this.yPn=d}static UNg(){if(G.AFrameworkApplication.J.$("AppForOfficeSSOV2IsEnabled")){var d=null;try{d=Wa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(n){F.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+n)}d=new Hc(d);Qc._instance=new Qc(d)}}static getInstance(){Qc.dsh||(Qc.UNg(),
Qc.dsh=!0);return Qc._instance}}Qc._instance=null;Qc.dsh=!1;Object(D.a)(Qc,"AppsForOfficeOauthManagerFactory",null,[1887]);class ud extends zh{constructor(d,n){super();this.AGk=d;this.Ai=n}go(){F.ULS.sendTraceTag(22402398,341,50,"GetAccessToken was called!");const d=(n,B)=>{n===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(B=B.accessToken,this.result[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=B):F.ULS.sendTraceTag(22402399,341,10,"{0}",{["errorCode"]:n.toString(),["appId"]:this.xk.$n,
["storeType"]:this.xk.storeType});this._errorCode=n;this.Bp()};Wa.a.instance.Za("Postmessage.IHostPostmessenger").execute(n=>{const B=this.Ai.nt,Q=Qc.getInstance();ul.getInstance(B,n,Q).getAccessToken(this.controlId,this.AGk,this.parameters,d)})}}Object(D.a)(ud,"GetAccessTokenMethod",zh,[]);class Xd extends zh{constructor(d){super();this.b0=d}go(){if(this.b0)if(this.Dg){let d=[];this._errorCode=({e0h:d}=this.Dg.inm(this.xk)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=
d}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;Fl(12,this.xk.$n,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(9049033,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to getAllAsync api"});this.Bp()}}Object(D.a)(Xd,"GetAllAppBindingsMethod",zh,[]);const $e=(d,n,B,Q,ha)=>{F.ULS.sendTraceTag(7886233,
341,50,"{0}",{["type"]:d?"get":"set",["error"]:n,["xmlSize"]:B,["latency"]:Math.max(Q,0),["appId"]:ha})},oe=(d,n)=>{F.ULS.sendTraceTag(7886234,341,50,"{0}",{["type"]:n?"get":"set",["delay"]:Math.max(d,0)})},ea=d=>(new Date).getTime()-d;class Pa{constructor(d,n){this.dga=d;this.NWk=n;this.MAd=this.W6=this.PAa=0}rEe(d){this.W6=(new Date).getTime();this.MAd=0;this.PAa=this.dga.setTimeout(()=>{this.MAd=(new Date).getTime();d()},this.NWk)}clearTimeout(){this.dga.clearTimeout(this.PAa)}get Lje(){return!!this.MAd}get upb(){return this.W6}get NXd(){return this.MAd}}
Object(D.a)(Pa,"TimeoutMethodHelper",null,[]);class Bb extends zh{constructor(d,n,B,Q){super();this.C0e=d;this.b0=n;this.fJb=B;this.dga=Q}go(){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let n=null;if(this.b0)if(this.Dg)if(void 0===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===d[OSF.DDA.Marshaling.BindingParameterKeys.Id])this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{n=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();const Q=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let ha;({YM:B}=this.Dg.mKf(Q,this.xk));if(B&&(ha=B[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var B=ha[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this._errorCode=({text:d}=this.Dg.oKf(this.xk,Q)).returnValue,this.YOa(d);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table)B===OSF.DDA.Marshaling.CoercionTypeKeys.Table?
(this.lNi(d),this._errorCode=({Z4j:d}=this.Dg.spm(this.xk,Q,d)).returnValue,this.YOa(d)):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)B===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix||B===OSF.DDA.Marshaling.CoercionTypeKeys.Table?(this.lNi(d),this._errorCode=({KRn:d}=this.Dg.ppm(this.xk,Q,d)).returnValue,this.YOa(d)):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&
this.C0e){this.tJm(Q);return}n===OSF.DDA.Marshaling.CoercionTypeKeys.Html?(this._errorCode=({UYa:d}=this.Dg.opm(this.xk,Q)).returnValue,this.YOa(d)):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.n2(n)}lNi(d){d.isPartialTable=!!d&&
(!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]);d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]=d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]?d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]:0;d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]=d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]?d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]:
0;d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]=d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]?d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]:0;d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]=d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]?d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]:0}tJm(d){const n=new Pa(this.dga,this.fJb);n.rEe(()=>{this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Byb(null,n.upb)});this.Dg.rpm(this.xk,d,(B,Q)=>{n.Lje?oe(ea(n.NXd),
!0):(n.clearTimeout(),this._errorCode=B,this.Byb(Q,n.upb))})}n2(d){Fl(5,this.xk.$n,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(16795287,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to GetAppBindingData api",["CoercionType"]:d});this.Bp()}YOa(d){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d)}Byb(d,
n){$e(!0,this.errorCode,(d||"").length,ea(n),this.xk.$n);this.YOa(d);this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(D.a)(Bb,"GetAppBindingDataMethod",zh,[]);class ac extends zh{constructor(d){super();this.b0=d}go(){if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id])if(d=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.b0){let n={};this._errorCode=({YM:n}=this.Dg.mKf(d,this.xk)).returnValue;
this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=n}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Fl(13,this.xk.$n,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(9000010,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to getAppBindingById api"});
this.Bp()}}Object(D.a)(ac,"GetAppBindingMethod",zh,[]);class Gc extends zh{constructor(d){super();this.oB=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath];let B,Q;this._errorCode=({yLa:B,CDb:Q}=this.oB.OTb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)try{const ha=B.selectNodes(n,Q);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.oB.$7j(d.CustomXmlId,
ha)}catch(ha){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}this.Bp()}}Object(D.a)(Gc,"GetDataNodesMethod",zh,[]);class ld extends zh{constructor(d){super();this.oB=d}execute(){let d,n;this._errorCode=({yLa:d,CDb:n}=this.oB.OTb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d.getNodeText(n));this.Bp()}}Object(D.a)(ld,"GetDataNodeTextMethod",
zh,[]);class Gd extends zh{constructor(d){super();this.oB=d}execute(){let d,n;this._errorCode=({yLa:d,CDb:n}=this.oB.OTb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=9===n.nodeType||1===n.nodeType?d.getNodeXml(n):d.getNodeText(n));this.Bp()}}Object(D.a)(Gd,"GetDataNodeValueMethod",zh,[]);class ue extends zh{constructor(d){super();this.oB=d}execute(){let d,
n;this._errorCode=({yLa:d,CDb:n}=this.oB.OTb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d.getNodeXml(n));this.Bp()}}Object(D.a)(ue,"GetDataNodeXmlMethod",zh,[]);class Ce extends zh{constructor(d){super();this.rm=d}execute(){const d=this.rm.dYa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);if(void 0===d||null===d||this.rm.F0f(d))this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;else{const n={};n.id=d.id;n.DataPartBuiltIn=d.builtIn;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=n;this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}this.Bp()}}Object(D.a)(Ce,"GetDataPartByIdMethod",zh,[]);class tf extends zh{constructor(d,n){super();this.rm=d;this.oB=n}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],
B=this.rm.dYa(d);if(void 0!==B&&null!==B)try{const Q=B.selectNodes(n,null);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.oB.$7j(d,Q);this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(Q){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.Bp()}}Object(D.a)(tf,"GetDataPartNodesMethod",zh,[]);class Zg extends zh{constructor(d){super();this.rm=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],
n=this.rm.K4c(),B=[];this.result[OSF.DDA.Marshaling.ListDescriptors.DataPartList]=B;this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;for(let Q=0;Q<n.length;Q++){const ha=n[Q];if(d===ha.namespace&&!this.rm.F0f(ha)){const Aa={};Aa.id=ha.id;Aa.DataPartBuiltIn=ha.builtIn;B.push(Aa)}}this.Bp()}}Object(D.a)(Zg,"GetDataPartsByNamespaceMethod",zh,[]);class Xi extends zh{constructor(d){super();this.rm=d}execute(){const d=this.rm.dYa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);
this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=void 0===d||null===d?null:d.Q3a;this._errorCode=void 0===d||null===d?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.Bp()}}Object(D.a)(Xi,"GetDataPartXmlMethod",zh,[]);class ph extends zh{constructor(d){super();this.rm=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],n=this.rm.dYa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==n&&
null!==n?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=n.J6c(d),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.Bp()}}Object(D.a)(ph,"GetDataPrefixByUriMethod",zh,[]);class Dh extends zh{constructor(d){super();this.rm=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],n=this.rm.dYa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==n&&null!==n?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
n.WOf(d),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.Bp()}}Object(D.a)(Dh,"GetDataUriByPrefixMethod",zh,[]);var qk=e(753);class Wn{constructor(){this.transaction=this.rCi=this.Tqb=this.IU=null}}Object(D.a)(Wn,"GetDocumentTextOperationContext",null,[]);class wn extends zh{constructor(){super();this.aOj=null;this.EKk=100;this.Vwm=(d,n)=>{for(d=0;d<this.EKk;d++)if(n.IU.moveNext()){if(n.IU.currentNode.bB){var B=
Di.SelectionFactory.ot(n.IU.currentNode);B=this.Dg.lbe(B);B!==Ed.AParagraphNode.jG&&(n.Tqb+=Ed.AParagraphNode.DR(B))}}else return n.transaction&&n.transaction.dispose(),n.rCi(n.Tqb),!1;return!0}}go(){let d=!1;this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Dg&&this.Dg.CMa&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]&&
null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]){const n=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType],B=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize];this.Dg.CMa.x1i(this.controlId)?this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:0>=B?(F.ULS.sendTraceTag(7123611,341,15,"Invalid slice size. It should be greater than 0."),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize):this.Yzn(n)?
d=this.POm(n,B):(F.ULS.sendTraceTag(7123612,341,15,"Requested file type {0} is not supported.",n),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported)}d||this.Bp()}Yzn(d){return d===OSF.DDA.Marshaling.File.FileType.Compressed||d===OSF.DDA.Marshaling.File.FileType.Pdf||d===OSF.DDA.Marshaling.File.FileType.Text}POm(d,n){const B=(Q,ha)=>{const Aa={};Aa.FileType=d;Aa.SliceSize=n;Fl(8,this.xk.$n,Q,Aa);this.Uoo(ha);this.Iwm(Q)};if(d===OSF.DDA.Marshaling.File.FileType.Text)return this.Uwm(n,
B);this.Dg.CMa.Owm(this.controlId,d,n,B);return!0}Uwm(d,n){F.ULS.sendTraceTag(8914013,341,100,"Started to get document content in text format; sliceSize is "+d);const B=this.VVm();if(!B)return!1;this.CRm(d,n,B).run();return!0}CRm(d,n,B){const Q=new Wn;Q.IU=B;Q.Tqb="";Q.transaction=this.VAm(B);Q.rCi=ha=>{(ha=this.Lwm(ha,d))?(n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha),F.ULS.sendTraceTag(8914015,341,100,"Finished getting text content.")):(n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,
null),F.ULS.sendTraceTag(8914014,341,10,"Cannot get DocumentFile object."))};B=new qk.a(null,this.Vwm,Q);B.$m("GetDocumentCopyInText");this.d4f()&&(B.Ei=!0);return B}d4f(){return!!this.aOj}VAm(d){if(this.d4f())return null;const n=(new pe.a).Vc(3);n.Eb(d.currentNode);return n}VVm(){if(this.d4f())var d=this.aOj;else{if(!Bf.a.Xm||!Bf.a.Xm.tb||!Bf.a.Xm.tb.Xc)return F.ULS.sendTraceTag(8914016,341,10,"Cannot find ContentView in workspace of word frame."),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,
null;d=(new rd.a).Gua(Bf.a.Xm.tb.Xc.Fd,7,7).currentNode}const n=new vk.a;n.set(d);d=Ie.a.Zr(n);d.Oq(Lj.a.orb,null);return d}Lwm(d,n){if(!d&&""!==d)return null;const B=wn.Aqm(d);if(!this.nwl(n,B))return null;d=wn.KRm(d,n);if(!d)return null;n=this.Dg.CMa.Xdi(this.controlId,B,n,d);n.b5f=!0;F.ULS.sendTraceTag(8914017,341,100,"Got DocumentFile; total bytes are "+B);return n}nwl(d,n){return d<n&&d%2?(F.ULS.sendTraceTag(8914018,341,15,"Invalid slice size. It should not be odd number."),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,
!1):!0}Uoo(d){d&&(this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle]=d.Rsi,this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize]=d.fileSize)}Iwm(d){this._errorCode=d;this.Bp()}static Aqm(d){return 2*d.length+2}static KRm(d,n){const B=new ma.a;var Q=0;n/=2;do{const ha=Q+(B.count?n:n-1);Q=Ca.a.substring(d,Q,ha);B.add(Q);Q=ha}while(Q<d.length);return B}}Object(D.a)(wn,"GetDocumentCopyMethod",zh,[]);class hr extends zh{constructor(){super()}go(){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
F.ULS.shipAssertTag(20711197,341,!!this.Dg.CMa);if(this.Dg&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]){const B=this.Dg.CMa.oCi(this.controlId,this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]);if(B){var d=B.Brc,n=this.parameters[""+
OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex];if(B.b5f)this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=B.XFf.K(n),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.Bp();else try{this.Dg.CMa.Twm(this.controlId,n,d,(Q,ha)=>{if(ha){ha=window.self.atob(ha);const Aa=Array(ha.length);for(let bb=0;bb<ha.length;bb++)Aa[bb]=ha.charCodeAt(bb);this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=Aa;this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize]=
ha.length;this._errorCode=Q;this.Bp()}})}catch(Q){F.ULS.sendTraceTag(20711198,341,15,"Error happens when converting string data to binary data. "+Q.message)}}}}}Object(D.a)(hr,"GetDocumentCopySliceMethod",zh,[]);class Ss extends zh{constructor(){super()}execute(){let d=null;if(this.Dg&&({url:d}=this.Dg.wxp()).returnValue){const n={};n[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=d;this.result[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=n;this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}}
Object(D.a)(Ss,"GetFilePropertiesMethod",zh,[]);class ev{constructor(){this.context=null;this.errorCode=0}}Object(D.a)(ev,"NestedAppAuthContextResult",null,[]);class Sv{static FHm(d,n){const B=new ev;(d=d.getOsfControl(n))&&d.isFirstParty()?(B.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,d={},n=G.AFrameworkApplication.J.rb("AADUserObjectId"),d.userObjectId=n?n:G.AFrameworkApplication.J.rb("HostUserId"),d.userPrincipalName=G.AFrameworkApplication.J.rb("UserPrincipalName"),d.tenantId=G.AFrameworkApplication.J.rb("TenantId"),
n=(G.AFrameworkApplication.J.rb("HostAuthType")||"").toLowerCase(),d.authorityType="aad"===n?"aad":"msa"===n?"msa":"other",B.context=d):B.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return B}}Object(D.a)(Sv,"NestedAppAuthUtil",null,[]);class mt extends zh{constructor(d){super();this.Ai=d}go(){const d=Sv.FHm(this.Ai.nt,this.controlId||"");this._errorCode=d.errorCode;if(d.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)for(const [n,B]of Object.entries(d.context))this.result[n]=
B;this.Bp()}}Object(D.a)(mt,"GetNestedAppAuthContextMethod",zh,[]);class Tv extends zh{constructor(d,n,B,Q,ha,Aa){super();this.rHk=d;this.mHk=n;this.sIk=B;this.EHk=Q;this.fJb=ha;this.dga=Aa}go(){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let n=null;if(this.Dg)if(void 0===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType])this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else if(n=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString(),
n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this._errorCode=({lzc:d}=this.Dg.getSelectedText()).returnValue,this.YOa(d);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.sIk)this._errorCode=({NVo:d}=this.Dg.yQm()).returnValue,this.YOa(d);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.EHk)this._errorCode=({HVo:d}=this.Dg.uQm()).returnValue,this.YOa(d);else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.mHk){this.wQm();return}n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&
this.rHk?(this._errorCode=({JQj:d}=this.Dg.pQm()).returnValue,this.YOa(d)):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.n2(n)}wQm(){const d=new Pa(this.dga,this.fJb);d.rEe(()=>{this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Byb(null,d.upb)});this.Dg.vQm((n,B)=>{d.Lje?oe(ea(d.NXd),!0):(d.clearTimeout(),this._errorCode=n,this.Byb(B,d.upb))})}YOa(d){this.errorCode===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d)}Byb(d,n){$e(!0,this.errorCode,(d||"").length,ea(n),this.xk.$n);this.YOa(d);this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}n2(d){Fl(1,this.xk.$n,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(17385222,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to GetSelectedDataAsync api",
["CoercionType"]:d});this.Bp()}execute(){}}Object(D.a)(Tv,"GetSelectedDataMethod",zh,[]);class rs{constructor(){this.languageId=0;this.displayName=this.name=null}}Object(D.a)(rs,"TranslationLanguageInfo",null,[]);class fv{constructor(d,n){this.XNh=null;this.wef=!1;this.Zuc=B=>{B={["Status"]:B.data.status,["HttpStatus"]:B.data.Xe,["ResponseData"]:Ca.a.O8j(B.data.responseData)};F.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",
B)};this.Qhd=B=>{F.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");let Q;try{Q=Rb.b(B.data.responseData)}catch(ha){F.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",ha);return}this.rCp(Q)};this.pRk=d;this.Oyk=n}cNo(){G.AFrameworkApplication.pe.addRequest(this.pRk(),1,null,null,!1,2,this.Qhd,this.Zuc,null)}jEm(){const d=(this.XNh||this.Oyk()).split(","),
n=this.wef?d.length/3:d.length/2,B=Array(n);for(let Q=0;Q<n;Q++){B[Q]=new rs;B[Q].name=d[Q];const ha=parseInt(d[Q+n]);B[Q].languageId=ha;B[Q].displayName=this.wef?d[Q+2*n]:rf.a.IPi()[ha]}return B}rCp(d){this.XNh=d.TranslationLanguages;this.wef=Boolean.parse(d.TranslationLanguagesLocalized||"false")}}Object(D.a)(fv,"TranslationLanguagesManager",null,[]);var nt=e(1183),ir=e(2012);class Jg{constructor(){this.dHc=!1}start(d){Jg.Sgb(this.BNp,Object(X.a)(this,this.onCancel,"onCancel"));ir.a.D8(this.fNo,
Object(X.a)(this,this.onComplete,"onComplete"),d)}onCancel(){this.dHc=!0;Jg.Xta()}onComplete(d,n,B){this.dHc||(n||(n=d?"Success":"UnknownError"),"Success"===n?(this.wli&&Jg.Xta(),this.iE(B)):(this.ppn(n)?F.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+n):F.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+n),Jg.Xta(),d=this.nha(n),1!==G.AFrameworkApplication.ta.state&&(G.AFrameworkApplication.J.$("ReportConversionFailedErrorUnderAdditionalVetoes")&&
G.AFrameworkApplication.pU(fe.a.Kbi,void 0,["TranslationFailed"]),n=new Sa.StandardDialog,n.Md=0,n.Ue(1,CommonUIStrings.l_DialogClose),n.zA(fe.a.Kbi,CommonUIStrings.l_DefaultDialogTitle,d,null))))}static Sgb(d,n){const B=new nt.a;Jg.jm=B.create();Jg.jm.message=d;Jg.jm.nM(CommonUIStrings.l_DefaultDialogTitle,n,null)}static Xta(){Jg.jm&&(Jg.jm.close(),Jg.jm=null)}}Jg.jm=null;Object(D.a)(Jg,"TranslationRequest",null,[]);class Pl extends Jg{constructor(d,n=0){super();this.VId=d;this.pOk=n;this.Ci=(new Date).getTime();
G.AFrameworkApplication.uo.Sbb(9984)}start(d){F.ULS.sendTraceTag(23184016,301,50,"Translation started");super.start(d)}onCancel(d){super.onCancel(d);G.AFrameworkApplication.uo.Sbb(9986);F.ULS.sendTraceTag(40953793,301,50,"Translation canceled")}iE(){const d=(new Date).getTime()-this.Ci;G.AFrameworkApplication.uo.setDw(9985,d);this.redirect();F.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")}get BNp(){return 10<=this.pOk?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation}get wli(){return!1}nha(d){return"TranslationServiceUnavailable"===
d?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===d?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===d?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===d?CommonUIStrings.l_DocumentCannotBeTranslatedLength:CommonUIStrings.l_GenericTranslationError}ppn(d){return"DocumentCannotBeTranslated"===d||"DocumentHasOCX"===d||"DocumentTooLong"===d}}Object(D.a)(Pl,"TranslateDocumentRequest",Jg,[]);var Ln=e(435);class Xo extends Pl{constructor(d){super(d)}redirect(){F.ULS.sendTraceTag(592255192,
324,100,"Navigate to view mode for translation");if(Ln.b(G.AFrameworkApplication.J)){var d=new ff.a;d.add("language",this.VId);d.add("fromeditor","1");Ln.d("view",d,Ln.e)}else d=T.a.Kq(Bf.a.Xm.lDb,"language",this.VId)+"&fromeditor=1",gc.a.openWindow(1,d)}get wli(){return!0}get fNo(){return Nf.a.webServiceBase+"docdatahandler.ashx?"+G.AFrameworkApplication.lm+"&language="+Ca.a.nj(this.VId)+"&languagename="+Ca.a.nj(this.VId)+"&type=png&o15=1"}}Object(D.a)(Xo,"TranslateDocumentRequestFromEditor",Pl,
[]);class Vk{static f8j(d){(new Xo(d)).start(yg.StaticActiveAppFrame.Aa().$L)}static kEm(){return Nf.a.webServiceBase+"translation.ashx?"+G.AFrameworkApplication.lm+"&uilang="+Ca.a.nj(G.AFrameworkApplication.uiCulture)}static awm(){return Nf.a.Avd}}Vk.Avd=new fv(Vk.kEm,Vk.awm);Object(D.a)(Vk,"TranslationManager",null,[]);class Do extends zh{constructor(d,n,B){super();this.Grp=n;this.enabled=B}go(){if(this.enabled){var d=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],n=d[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),
B=d[OSF.DDA.Marshaling.NavigationKeys.GoToType];d=d[OSF.DDA.Marshaling.NavigationKeys.SelectionMode];var Q=null;n&&n.startsWith("TranslatedDocument")&&(Q=n.split("|"),Q=2===Q.length?Q[1]:null);Q?(Vk.f8j(Q),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=this.GBn(B)&&this.WBn(d)?this.Dg.sZm(n,d,this.Grp,this.xk):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;Fl(15,this.xk.$n,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
F.ULS.sendTraceTag(17585945,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to goToByIdAsync api"})}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}GBn(d){return d===OSF.DDA.Marshaling.GoToType.Binding}WBn(d){return d===OSF.DDA.Marshaling.SelectionMode.Default||d===OSF.DDA.Marshaling.SelectionMode.Selected||d===OSF.DDA.Marshaling.SelectionMode.None}}Object(D.a)(Do,"GoToByIdAsyncMethod",zh,[]);class en extends zh{constructor(){super()}execute(){this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Dg){const d=this.tIf(this.Dg.ydb(this.xk));if(d){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const n={};n.Settings=d;this.result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=n}}}tIf(d){const n={};let B=0;for(const Q in d)n[""+B]=[Q,d[Q]],B++;return n}}Object(D.a)(en,"LoadSettingsMethod",zh,[]);class eq extends zh{constructor(d){super();this.Sza=d}go(){let d;d=this.Sza?this.Dg?this.Dg.sQa.wjj(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
this.parameters[gf.a.bkf],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.sUn(d)}ZL(){Fl(16,this.xk.$n,this.errorCode,null);this.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&F.ULS.sendTraceTag(18376392,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.xk.$n,["errMsg"]:"MessageParent API failed!"})}sUn(d){this._errorCode=d;this.ZL();this.Bp()}}
Object(D.a)(eq,"MessageParentMethod",zh,[]);class Uv extends zh{constructor(d){super();this.UEo=n=>{this._errorCode=n;this.Bp()};this.b0=d}go(){if(this.b0)if(this.Dg){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];d=d[OSF.DDA.Marshaling.BindingParameterKeys.Id]?this.Dg.VEo(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.xk,this.UEo):OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
Fl(14,this.xk.$n,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(9225408,341,10,"{0}",{["error"]:d,["appId"]:this.xk.$n,["errMsg"]:"unexpected error to releaseAppBindingById api"});d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this._errorCode=d,this.Bp())}}Object(D.a)(Uv,"ReleaseAppBindingMethod",zh,[]);class Bz extends zh{constructor(){super()}execute(){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SettingsRequest];
d=Array.isArray(d[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?d[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null;this.Dg&&(this._errorCode=this.Dg.saveSettings(this.xk,this.tIf(d)))}tIf(d){const n={};if(d)for(let B=0;B<d.length;B++){const Q=Array.isArray(d[B])?d[B]:null;Q&&1<Q.length&&(n[Q[0]]=Q[1])}return n}}Object(D.a)(Bz,"SaveSettingsMethod",zh,[]);class Tr extends zh{constructor(d,n,B,Q,ha){super();this.mSj=(Aa,bb)=>{this._errorCode=Aa;this.n2(bb)};this.C0e=d;this.FNe=n;this.b0=
B;this.fJb=Q;this.dga=ha}go(){const d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let n=null;if(this.b0)if(this.Dg)if(void 0===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.SetDataKeys.Data]||null===d[OSF.DDA.Marshaling.SetDataKeys.Data]||void 0===d[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===d[OSF.DDA.Marshaling.BindingParameterKeys.Id])this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{n=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var B=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString();const ha=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let Aa;({YM:Q}=this.Dg.mKf(ha,this.xk));if(Q&&(Aa=Q[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var Q=Aa[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this._errorCode=this.Dg.rCg(this.xk,ha,B);else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.C0e){if(B.startsWith("<")){this.E3o(ha,
B);return}this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.FNe){this.v1o(ha,B);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(Q===OSF.DDA.Marshaling.CoercionTypeKeys.Table){if((this._errorCode=({ACj:B}=this.n$j(d,Aa)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.Dg.uZo(this.xk,ha,d[OSF.DDA.Marshaling.SetDataKeys.Data],B,this.mSj);return}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;
else if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(Q===OSF.DDA.Marshaling.CoercionTypeKeys.Table||Q===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix){if((this._errorCode=({ACj:B}=this.n$j(d,Aa)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.Dg.sZo(this.xk,ha,d[OSF.DDA.Marshaling.SetDataKeys.Data],B,this.mSj);return}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.n2(n)}n$j(d,n){let B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const Q=n[OSF.DDA.Marshaling.AppBindingKeys.RowCount];n=n[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount];var ha=!!d&&(!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]);
const Aa={};(Aa.isPartialTable=ha)?(ha=d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow],d=d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol],0>ha||ha>=Q||0>d||d>=n?B=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn:(Aa.startRow=ha,Aa.startCol=d)):(Aa.startRow=0,Aa.startCol=0);return{returnValue:B,ACj:Aa}}n2(d){Fl(6,this.xk.$n,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(16795289,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.xk.$n,["errMsg"]:"unexpected error to SetAppBindingData API",["CoercionType"]:d});this.Bp()}v1o(d,n){this.Dg.rZo(this.xk,d,n,B=>{this._errorCode=B;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}E3o(d,n){const B=new Pa(this.dga,this.fJb);B.rEe(()=>{this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Byb(B.upb,n.length)});this.Dg.tZo(this.xk,d,n,Q=>{B.Lje?oe(ea(B.NXd),!1):(B.clearTimeout(),this._errorCode=Q,this.Byb(B.upb,n.length))})}Byb(d,n){$e(!1,this.errorCode,
n,ea(d),this.xk.$n);this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(D.a)(Tr,"SetAppBindingDataMethod",zh,[]);class Jt extends zh{constructor(d,n){super();this.EIa=d;this.oB=n}execute(){if(this.EIa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Text],B,Q;this._errorCode=({yLa:B,CDb:Q}=this.oB.OTb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(B.builtIn){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;
ko(21,this.errorCode,this.xk);this.Bp();return}const ha=Q.cloneNode(!0);B.setNodeText(Q,n)?1!==Q.nodeType?this.oB.Emd(Q,ha,d):(n=ha.childNodes,this._errorCode=void 0!==n&&null!==n&&n.length?1===n.length&&3===n[0].nodeType?this.oB.Emd(Q.firstChild,n[0],d):this.oB.Emd(Q.firstChild,ha,d):this.oB.yuo(Q.firstChild,d)):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;ko(6,this.errorCode,this.xk);this.Bp()}}
Object(D.a)(Jt,"SetDataNodeTextMethod",zh,[]);class Cz extends zh{constructor(d,n){super();this.EIa=d;this.oB=n}execute(){if(this.EIa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.Data],B,Q;this._errorCode=({yLa:B,CDb:Q}=this.oB.OTb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(B.builtIn){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.Bp();return}const ha=
Q.cloneNode(!0);9!==Q.nodeType&&1!==Q.nodeType&&B.setNodeText(Q,n)?this._errorCode=this.oB.Emd(Q,ha,d):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Bp()}}Object(D.a)(Cz,"SetDataNodeValueMethod",zh,[]);class TA extends zh{constructor(d,n,B){super();this.EIa=d;this.oB=n;this.u8b=B}execute(){if(this.EIa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],n=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml],
B,Q;this._errorCode=({yLa:B,CDb:Q}=this.oB.OTb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(B.builtIn){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.Bp();return}const ha=Q.cloneNode(!0);if(n=B.setNodeXml(Q,n)){({Xxd:B}=this.oB.xPi(d));if(void 0!==B&&null!==B&&B[d.NodeIndex]===Q)try{B[d.NodeIndex]=n}catch(Aa){this.u8b.zhj(d.NodeListCacheId)}this._errorCode=this.oB.Emd(n,ha,d)}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Bp()}}Object(D.a)(TA,"SetDataNodeXmlMethod",zh,[]);class UA extends zh{constructor(d,n,B,Q,ha){super();this.FNe=d;this.htk=n;this.fJb=B;this.dga=Q;this.eIk=ha.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeTableIsEnabled");this.dIk=ha.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeMatrixIsEnabled");this.cIk=ha.$("WordEditorAppsForOfficeImageCoercionTypeIsEnabled")}go(){const d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];
let n="";if(this.Dg)if(void 0===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.SetDataKeys.Data]||null===d[OSF.DDA.Marshaling.SetDataKeys.Data])this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{n=d[OSF.DDA.Marshaling.SetDataKeys.CoercionType].toString();if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Text){this.Wpo(d);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.FNe){this.Rpo(d);
return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.htk){if(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString().startsWith("<")){this.Upo(d);return}this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.eIk){this.Vpo(d);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.dIk){this.Tpo(d);return}if(n===OSF.DDA.Marshaling.CoercionTypeKeys.Image&&this.cIk){this.Spo(d);return}this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this._errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.n2(n)}Vpo(d){this.Dg.v5o(d[OSF.DDA.Marshaling.SetDataKeys.Data],n=>{this._errorCode=n;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Table)})}Tpo(d){this.Dg.s5o(d[OSF.DDA.Marshaling.SetDataKeys.Data],n=>{this._errorCode=n;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)})}Wpo(d){this.Dg.w5o(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),n=>{this._errorCode=n;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Text)})}Rpo(d){this.Dg.q5o(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),
n=>{this._errorCode=n;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}Upo(d){const n=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),B=new Pa(this.dga,this.fJb);B.rEe(()=>{this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.uVj(B.upb,n.length)});this.Dg.t5o(n,Q=>{B.Lje?oe(ea(B.NXd),!1):(B.clearTimeout(),this._errorCode=Q,this.uVj(B.upb,n.length))})}Spo(d){const n=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),B=d[OSF.DDA.Marshaling.SetDataKeys.ImageWidth];d=d[OSF.DDA.Marshaling.SetDataKeys.ImageHeight];
0>B||0>d?(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Image)):this.Dg.r5o(n,B,d,Q=>{this._errorCode=Q;this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Image)})}uVj(d,n){$e(!1,this.errorCode,n,ea(d),this.xk.$n);this.n2(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}n2(d){Fl(2,this.xk.$n,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&F.ULS.sendTraceTag(17585946,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.xk.$n,["errMsg"]:"unexpected error to setSelectedDataAsync API",["CoercionType"]:d});this.Bp()}}Object(D.a)(UA,"SetSelectedDataMethod",zh,[]);class Dz extends zh{constructor(){super()}go(){32===G.AFrameworkApplication.va.Vb(this.parameters[0],2)?this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Bp()}}Object(D.a)(Dz,"ExecuteFeature",zh,[]);class lx extends zh{constructor(){super()}go(){const d=G.AFrameworkApplication.va.Vb(this.parameters[0],
1);this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.Rv[0]=32===d;this.Rv[1]=!0;this.Bp()}}Object(D.a)(lx,"QueryFeature",zh,[]);class Kt extends hg{constructor(d,n,B,Q,ha,Aa,bb){super();this.SXe=d;this.za=n;this.dga=B;this.rm=Q;this.u8b=ha;this.oB=Aa;this.Ai=bb}cKf(d){if(d=super.cKf(d))d.Dg=this.SXe;return d}Pko(){const d=this.za.$("WordEditorAppsForOfficeImportExternalHtmlDataIsEnabled")&&Af.a.TEe,n=this.za.$("WordEditorAppsForOfficeSelectionOoxmlIsEnabled"),B=this.za.sc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",
3E4),Q=this.za.$("WordEditorAppsForOfficeCustomXmlWriteIsEnabled"),ha=new Sb.a;ha.W(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>{const Ib=this.za.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeHtmlIsEnabled"),oc=this.za.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeTableIsEnabled"),Ac=this.za.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeMatrixIsEnabled");return new Tv(Ib,n,oc,Ac,B,this.dga)});ha.W(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new UA(d,
n,B,this.dga,this.za));ha.W(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Ss);ha.W(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new mt(this.Ai));ha.W(OSF.DDA.MethodDispId.dispidAddDataPartMethod,()=>new La(Q,this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod,()=>new Ce(this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod,()=>new Zg(this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod,()=>new Xi(this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod,
()=>new tf(this.rm,this.oB));ha.W(OSF.DDA.MethodDispId.dispidDeleteDataPartMethod,()=>new nd(Q,this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod,()=>new Gd(this.oB));ha.W(OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod,()=>new ue(this.oB));ha.W(OSF.DDA.MethodDispId.dispidGetDataNodeTextMethod,()=>new ld(this.oB));ha.W(OSF.DDA.MethodDispId.dispidGetDataNodesMethod,()=>new Gc(this.oB));ha.W(OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod,()=>new Cz(Q,this.oB));ha.W(OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod,
()=>new TA(Q,this.oB,this.u8b));ha.W(OSF.DDA.MethodDispId.dispidSetDataNodeTextMethod,()=>new Jt(Q,this.oB));ha.W(OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod,()=>new qs(Q,this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod,()=>new Dh(this.rm));ha.W(OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod,()=>new ph(this.rm));const Aa=this.za.$(Kt.RWh),bb=this.za.$(Kt.xbl);ha.W(OSF.DDA.MethodDispId.dispidGetBindingMethod,()=>new ac(Aa));ha.W(OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,
()=>new Xd(Aa));ha.W(OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,()=>new ps(bb));ha.W(OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,()=>new jo(bb));ha.W(OSF.DDA.MethodDispId.dispidSetBindingDataMethod,()=>new Tr(n,d,bb,B,this.dga));ha.W(OSF.DDA.MethodDispId.dispidGetBindingDataMethod,()=>new Bb(n,Aa,B,this.dga));ha.W(OSF.DDA.MethodDispId.dispidReleaseBindingMethod,()=>new Uv(bb));ha.W(OSF.DDA.MethodDispId.dispidAddColumnsMethod,()=>new $a(bb));ha.W(OSF.DDA.MethodDispId.dispidAddRowsMethod,
()=>new Jb(bb));ha.W(OSF.DDA.MethodDispId.dispidClearAllRowsMethod,()=>new O(bb));Af.a.bFe?(ha.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new hr),ha.W(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Sc),ha.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new wn)):(ha.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>zh.h1d(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),ha.W(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>zh.h1d(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),
ha.W(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>zh.h1d(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)));ha.W(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>{const Ib=this.za.$("WordEditorExtensionRichAPIIsEnabled");return new la(Ib)});ha.W(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new en);ha.W(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new Bz);ha.W(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>{const Ib=this.za.$(Kt.RWh);return new Do(te.a.instance,
Object(Cg.a)().Ve.ke,Ib)});ha.W(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>{const Ib=this.za.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new eq(Ib)});ha.W(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>{const Ib=this.za.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new iu(Ib)});ha.W(OSF.DDA.MethodDispId.dispidExecuteFeature,()=>new Dz);ha.W(OSF.DDA.MethodDispId.dispidQueryFeature,()=>new lx);ha.W(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>
new uc);ha.W(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>{const Ib=this.za.$("WordEditorAppsForOfficeSingleSignOnIsEnabled");return new ud(Ib,this.Ai)});ha.W(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Ik(this.Ai));return ha}}Kt.RWh="WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled";Kt.xbl="WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled";Object(D.a)(Kt,"WordEditorMethodFactory",hg,[]);class yr{constructor(d,n){this.ax=d;this.DBc=n}async Owe(){Fi.a.EF&&this.ax.Oec.count&&
this.DBc.wye()}}Object(D.a)(yr,"WritingAssistanceAddInHelper",null,[]);class ry extends Ad{constructor(){super()}Ec(d){if(Bf.a.Lxd||Bf.a.r7f||Uc.a.RVb||G.AFrameworkApplication.nNb||G.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")||G.AFrameworkApplication.J.$("AddInCommandsIsEnabled")){super.Ec(d);var n=G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled"),B=G.AFrameworkApplication.J.$("WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled"),Q=G.AFrameworkApplication.J.$("WordEditorContentControlReadIsEnabled"),
ha=G.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled");d.ja("WordEditor.AppsForOffice.GetFileApiHelper",()=>new If(If.LWd,()=>G.AFrameworkApplication.rootQuerySignature,bd.a.instance,yg.StaticActiveAppFrame.Aa().tb.rd,new Cd.a,G.AFrameworkApplication.J,d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("WordEditor.AppsForOffice.IGetFileApiHelper").ha();d.ja("Box4.AppsForOffice.ShowDialogApiHelper",()=>new ii(yg.StaticActiveAppFrame.Aa(),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),
d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("Box4.AppsForOffice.IShowDialogApiHelper").ha();Q&&n&&d.ja("WordEditor.AppsForOffice.AppBindingHelper",()=>new Rc(d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel"),d.resolve("WordEditor.ContentControl.IContentControlManager"),te.a.instance,new pe.a,new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.rd.Hd),d.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),d.resolve("WordEditor.ITableEditor"),d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),
d.resolve("Box4.ContentControlParagraphMapping"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("WordEditor.AppsForOffice.IAppBindingHelper").ha();d.ja("WordEditor.AppsForOffice.TableMatrixHelper",()=>new xj(G.AFrameworkApplication.va,te.a.instance,d.resolve("WordEditor.ITableEditor"))).ha();d.ja("WordEditor.AppsForOffice.CustomXmlHelper",()=>new jn(d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"))).as("WordEditor.AppsForOffice.ICustomXmlHelper").ha();
d.ja("WordEditor.AppsForOffice.CustomXmlNodeListCache",()=>new kf(new fa.a(()=>G.AFrameworkApplication.J.sc("WordEditorCustomXmlMaximumDataCollectionNumber",1024)),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).as("WordEditor.AppsForOffice.ICustomXmlNodeListCache").ha();d.ja("WordEditor.AppsForOffice.OoxmlSelectionManager",()=>new Fk(G.AFrameworkApplication.ta.Kt,()=>bd.a.instance.t$d(yg.StaticActiveAppFrame.Aa().tb.rd),()=>G.AFrameworkApplication.rootQuerySignature,d.Wa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),
fg.a.rT,G.AFrameworkApplication.J.$("AppsForOfficeFixIpIssueForInsertOoxmlIsEnabled"))).as("WordEditor.AppsForOffice.IOoxmlSelectionManager").ha();d.ja("WordEditor.AppsForOffice.OoxmlRangeManager",()=>new Dj(d.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"))).as("WordEditor.AppsForOffice.IOoxmlRangeManager").ha();d.ja("WordEditor.AppsForOffice.HtmlDataGetSetProvider",()=>new Hp(te.a.instance,d.Wa("Box4.Actors.InternalClipboard"),G.AFrameworkApplication.va,d.resolve("Box4.IHtmlViewRootFactory"),
Ee.a.Uua())).as("WordEditor.AppsForOffice.IHtmlDataGetSetProvider").ha();d.ja("WordEditor.AppsForOffice.WordEditorApiObjectModel",()=>new Wm(te.a.instance,G.AFrameworkApplication.va,d.resolve("WordEditor.AppsForOffice.GetFileApiHelper"),d.resolve("Box4.AppsForOffice.IShowDialogApiHelper"),d.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),d.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"),d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),
d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),new pe.a,Q&&n?d.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,d.resolve("WordEditor.Extension.DocumentFactory"),d.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),new rd.a,d.resolve("Box4.IParagraphReader"),wj.a.instance)).as("WordEditor.AppsForOffice.IWordEditorApiObjectModel").ha();d.ja("WordEditor.AppsForOffice.WindowTimer",()=>new um).as("WordEditor.AppsForOffice.IWindowTimers").ha();d.ja("WordEditor.AppsForOffice.WordEditorMethodFactory",
()=>new Kt(d.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"),G.AFrameworkApplication.J,d.resolve("WordEditor.AppsForOffice.IWindowTimers"),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"),d.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("Common.App.AppsForOfficeCommon.IApiMethodFactory").ha();d.ja("WordEditor.AppsForOffice.WordEditorEventStore",
()=>vo.MLl(d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),d.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"))).as("Common.App.AppsForOfficeCommon.IApiEventStore").ha();d.ja("WordEditor.AppsForOffice.WordEditorApiThrottleStore",()=>new Gq(new OsfRuntime.Throttling.ThrottleFactory,G.AFrameworkApplication.J)).as("Common.App.AppsForOfficeCommon.IApiThrottleStore").ha();d.ja("Common.App.AppsForOfficeCommon.ApiManager",()=>new qe(d.resolve("WordEditor.AppsForOffice.WordEditorMethodFactory"),
d.resolve("WordEditor.AppsForOffice.WordEditorEventStore"),d.resolve("WordEditor.AppsForOffice.WordEditorApiThrottleStore"))).as("Common.App.AppsForOfficeCommon.IApiManager").ha();d.ja("Box4.SetDataVirtualSelectionMerger",()=>new Ri).as("Box4.Actors.IVirtualSelectionMerger").ha();d.ja("WordEditor.AppsForOffice.WritingAssistanceAddInHelper",()=>new yr(d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),d.resolve("Box4.Proofing.SuggestionRerenderer"))).as("WordEditor.AppsForOffice.WritingAssistanceAddInHelper").ha();
d.ja("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor",()=>new io(d.zf("Common.App.AppsForOfficeCommon.IAppsForOfficeManager"),null,d.zf("Common.App.AppsForOfficeCommon.IContextActivationManager"),df.FocusManager.instance(),Ef.a.instance,G.AFrameworkApplication.va,G.AFrameworkApplication.J,d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),null,
ui.a.instance,d.resolve("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager"),null,d.resolve("WordEditor.AppsForOffice.WritingAssistanceAddInHelper"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").ha();d.ja("Wonca.AppsForOffice.SaveSettingsHelper",()=>new Xh(new pe.a)).ha();d.ja("Wonca.AppsForOffice.AddinActivator",()=>new lh(d.zf("Common.App.AppsForOfficeCommon.IContextActivationManager"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d.resolve("Wonca.AppsForOffice.SaveSettingsHelper"))).as("Wonca.IAddinActivator").ha();
d.ja("WordEditor.AppsForOffice.AppsForOfficeApiActor",()=>new tl(G.AFrameworkApplication.va,Sf.a.instance,d.resolve("Box4.IOutlineEditor"),d.resolve("Box4.ICharacterPropertiesEditor"),new pe.a,d.zf("Box4.Actors.IClipboardOperationFactory"),d.resolve("Box4.IClipboardDataHelper"),G.AFrameworkApplication.J,Ch.a.instance,d.resolve("Common.Utils.Telemetry.ITelemetry"),d.resolve("Box4.Actors.IExternalPasteCssConverter"))).ha();d.ja("WordEditor.AppsForOffice.WordEditorAfoSettingsModel",()=>new sc(new Pd)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel").ha();
d.ja("Wonca.AppsForOffice.BackCompatImageUploaderWrapper",()=>new He).as("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper").ha();d.ja("Wonca.IFrameEditors.AddinEditor",()=>new Qd(d.resolve("WordEditor.IImageEditor"),d.resolve("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper"))).as("Wonca.IFrameEditors.IAddinEditor").ha();d.ja("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel",()=>new Cn(Object($g.a)(),new pe.a,new bm,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel"),
d.resolve("Wonca.IFrameEditors.IAddinEditor"),G.AFrameworkApplication.va,Sf.a.instance)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").ha();d.ja("Common.App.AppsForOfficeCommon.AppsForOfficeManager",()=>new Kf(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeManager").ha();d.ja("Common.App.AppsForOfficeCommon.HostControlInfo",()=>new fl(d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),
d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).ha();d.register(Zb,"WordEditor.AppsForOffice.WordEditorActivationSettingsProvider").as("Common.App.AppsForOfficeCommon.IActivationSettingsProvider").ha();d.ja("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory",()=>new Ji(d.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"))).ha();d.ja("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory",()=>new qi(d.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory").create(),
d.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"),d.resolve("Common.App.AppsForOfficeCommon.HostControlInfo"))).ha();d.ja("Common.App.AppsForOfficeCommon.IContextActivationManager",()=>{const Aa=d.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory").create();Aa.setOAuthManager(d.resolve("Common.App.OAuth.IOAuthManager"));return Aa});d.ja("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager",()=>new rj(d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager"),
null,d.resolve("Common.App.AppsForOfficeCommon.ApiManager"),d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),ha&&B?d.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,G.AFrameworkApplication.J,d.resolve("WordEditor.AppsForOffice.AppsForOfficeApiActor"))).ha();this.Z.ja("WordEditor.AppsForOffice.ApiOperationChecker",()=>new ai).as("WordEditor.AppsForOffice.IApiOperationChecker").ha();this.Z.ja("Box4.AppsForOffice.IInitializeHelper",
()=>new Vl).ha()}}get name(){return"WordEditor.AppsForOffice"}init(){if(Bf.a.Lxd){var d=this.Z.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider");d.HZc=!0;G.AFrameworkApplication.J.$("OcpsIsEnabled")?this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{const B=this.Z.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([n.isFeatureEnabled("ConnectedServices",!0),B.nN("WACSideloadAddins")]).then(([Q,ha])=>{d.HZc=
Q;d.Kek=ha;this.initInternal();return null})}):this.initInternal()}}initInternal(){this.N6b=this.Z.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager");G.AFrameworkApplication.J.lq(()=>{this.N6b.initialize();yg.StaticActiveAppFrame.Aa().Ne();if(G.AFrameworkApplication.J.$("SdxIsEnabled")){var n={};n.Application=G.AFrameworkApplication.J.rb("Application");n.SdxDmsUrl=G.AFrameworkApplication.J.rb("SdxDmsUrl");n.SovereignFederationDMSToken=G.AFrameworkApplication.J.rb("SovereignFederationDMSToken");
n.SovereignFederationDMSTokenSuffix=G.AFrameworkApplication.J.rb("SovereignFederationDMSTokenSuffix");n.SdxCdnUrl=G.AFrameworkApplication.J.rb("SdxCdnUrl");n.Sdx1CdnUrl=G.AFrameworkApplication.J.rb("Sdx1CdnUrl");n.ForceUseSdx1Cdn=G.AFrameworkApplication.J.$("ForceUseSdx1Cdn");n.UICulture=G.AFrameworkApplication.J.rb("UICulture");n.LoggableUserId=G.AFrameworkApplication.J.rb("LoggableUserId");n.SessionStartInfoJson=G.AFrameworkApplication.J.rb("SessionStartInfoJson");n.StaticContentUrl=G.AFrameworkApplication.J.rb("StaticContentUrl");
n.DmsSdxList=G.AFrameworkApplication.Sli;var B={};B.generalParameters=n;B.flightingTreatmentVariables=G.AFrameworkApplication.J.aab;OfficeExt.SDXCatalog.InitializeSdx(B);let ha=!1;n=0;if(G.AFrameworkApplication.J.$("AppsForOfficeSharedRuntimeIsEnabled")){B=this.N6b.Mfc.mAj();for(var Q of B)OfficeExt.SDXCatalog.MarkSdxPreloadStart(Q),io.ykc===Ca.a.Ph(Q)&&(ha=!0,n=io.YPj)}OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.aab,G.AFrameworkApplication.J.rb("Application"),
"*");Uc.a.RVb&&OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.aab,G.AFrameworkApplication.J.rb("Application"),"fa000000029");Q=G.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationDelayInMilliseconds",1E4);Q+=n;G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationIsEnabled",!1)&&(OfficeExt.SDXCatalog.PrefetchSdxAssets(G.AFrameworkApplication.J.appSettings,G.AFrameworkApplication.J.aab,
G.AFrameworkApplication.J.rb("Application"),io.ykc),window.setTimeout(()=>{const Aa=new Dm(io.ykc,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),bb=new Ci("WordOnline","Web","en-Us"),Ib=new nj;Ib.optionalProperties[mk.a.AU]="Experimentation SDX";Ib.optionalProperties[mk.a.taskPaneWidth]=0;if(ha){const oc={};oc.hostAddinActivationTimeStamp=Date.now();Ib.optionalProperties[mk.a.nRh]=oc;Ib.optionalProperties[mk.a.sourceLocationOverrideResourceId]=io.eFf;rc.instance.med(Aa,Ha.MFe,"",bb,Ib)}G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.CG.VSO8102927_UseComponentTypeAsTaskpaneForWord")?
(Ib.optionalProperties[mk.a.actionName]="AddinActivationAction",rc.instance.med(Aa,Ha.MFe,"AddinActivationAction",bb,Ib)):rc.instance.med(Aa,Ha.action,"AddinActivationAction",bb,Ib)},Q))}});const d=this.Z.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager");this.Z.resolve("Box4.AppsForOffice.IInitializeHelper").q_f(()=>{d.initialize()});this.Z.resolve("WordEditor.ContentControl.IContentControlManager").pjl(this.Z.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))}}Object(D.a)(ry,
"AppsForOfficePackage",Ad,[]);class sy{constructor(){this.correlationId=this.sessionId=this.t8e=null;this.actionId=0;this.Ed=null}get sh(){return this.t8e?this.t8e:""}set sh(d){this.t8e=d}}Object(D.a)(sy,"AssistanceSearchVariableUrlParameterSet",null,[]);var ol=e(267);class xn{constructor(){this.vi=!1;this.H3=!0;this.PIh=this.rGc=null}get isInitialized(){return this.vi}initialize(d,n){const B=!!d&&!!n;B&&(this.rGc=d,this.PIh=n);this.vi=B;G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||Wa.a.instance.Za("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Q=>{Q.nN("Enabled").then(ha=>{this.H3=ha;return null},()=>null)})}mc(d){d||(d=G.AFrameworkApplication.va);G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.H3=G.AFrameworkApplication.uE,Wa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("mso_sendASmile",
!0).then(B=>{this.H3=G.AFrameworkApplication.uE&&B;(B=G.AFrameworkApplication.ta)&&B.Ne();return null},()=>null)}));d.qa(Z.a.J1b,S.a.frame,Object(X.a)(this,this.Hfp,"showSearchResults"))}Hfp(d,n,B,Q,ha){if(1===B)return G.AFrameworkApplication.J.$("IsFeedbackExperiencesAvailable")||(this.H3=!1),ha&&"SourceControlId"in ha&&(ha=ha.SourceControlId,("GiveFeedback"===ha||"btnFeedback"===ha||"btnFeedbackPane"===ha||"PptEditingStatusBar.GiveFeedbackPane"===ha||"GiveFeedbackPane"===ha)&&!this.H3)?8:bn.SessionStatusManager.instance.zk?
8:32;F.ULS.sendTraceTag(4761738,1302,50,"");ol.a.mark(4771);if(this.isInitialized){d=ha.CommandValueId;n=ha.SourceControlId;ha=Object.assign(new sy,{actionId:Z.a.J1b,Ed:ha});if(void 0!==d&&null!==d)ha=xn.KWm(d);else if(void 0!==n&&null!==n)switch(n){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":ha.actionId=Z.a.Hna;break;case "btnContactSupport":case "ContactSupport":ha.actionId=Z.a.sai;break;case "btnShowTraining":case "Training":ha.actionId=
Z.a.W7j;break;case "btnWhatsNew":case "WhatsNew":ha.actionId=Z.a.pSg}this.rGc.Adp(this.PIh,ha);ol.a.mark(4772);return 32}ol.a.mark(4772);return 8}dispose(){this.rGc&&(this.rGc.dispose(),this.rGc=null)}static get instance(){xn._instance||(xn._instance=new xn);return xn._instance}static KWm(d){const n=new sy,B=d.indexOf("|");n.sessionId=d.substring(0,B);const Q=d.indexOf("|",B+1);n.correlationId=d.substring(B+1,Q);n.sh=d.substr(Q+1);return n}}xn._instance=null;Object(D.a)(xn,"AssistanceActor",null,
[11]);class mx{constructor(){this.Kdh=this.za=this.Q6b=null;this.w6e=!1}Adp(d,n){if(n.actionId!==Z.a.Hna||G.AFrameworkApplication.uE)if(this.w6e&&!G.AFrameworkApplication.BL)this.Q6b||(this.Q6b=this.Kdh()),this.Q6b.sU(d,n);else if(n.actionId===Z.a.Hna)this.gdp();else{d=d.getUrl(n);n=null;try{Ca.a.BZ(d)&&(n=gc.a.Zm(d,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no","AssistanceDisplayManager:HelpWindow"))}catch(B){throw F.ULS.sendTraceTag(4543175,
1302,10,"An exception has occured while trying to launch the Online Assistance window: "+B.message),B;}n?F.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",d):F.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",d,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else F.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.Q6b&&(this.Q6b.dispose(),this.Q6b=null)}TWj(d,n,B){B&&Ic.c(d)?this.w6e=!1:(this.Kdh=d,this.w6e=B);this.za=n}gdp(){G.AFrameworkApplication.va.Vb(Z.a.Hna,2)}static createInstance(d,n,B=null){const Q=new mx;null==B?Q.TWj(d,n,G.AFrameworkApplication.WZh||n.$("HelpTabIsEnabled")):Q.TWj(d,n,B);return Q}}Object(D.a)(mx,"AssistanceDisplayManager",null,[1928,11]);class Vv{constructor(d,
n,B,Q,ha){this.Taa=d;this.LKd=n;this.VJd=B;this.Ntk=Q;this.Syh=ha}get lcid(){return this.Taa}get namespace(){return this.LKd}get Ndb(){return this.VJd}get xfl(){return this.Ntk}get locale(){return this.Syh}static bWm(d){const n=d.indexOf(".");return 0<=n&&n<d.length&&(d=parseInt(d.substring(0,n)),!isNaN(d))?d:Vv.Hgl}static createInstance(d){return new Vv(G.AFrameworkApplication.lcid,d,Vv.bWm(G.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",rf.a.Vg(G.AFrameworkApplication.lcid).name)}}
Vv.Hgl=16;Object(D.a)(Vv,"AssistanceSearchUrlParameterSet",null,[]);class Nu{constructor(d,n){d=new Sj.QueryStringBuilder(d);d.Me("clid",n.lcid.toString());d.Me("p1",n.namespace);d.Me("ver",n.Ndb.toString());d.Me("apps",n.xfl);d.Me("lc",n.locale);this._url=d.toString()}getUrl(d){const n=new Sj.QueryStringBuilder(this._url);n.Me("src","TellMe");n.Me("query",d.sh);n.Me("sessionid",d.sessionId);n.Me("correlationid",d.correlationId);return n.toString()}static createInstance(d){return new Nu(G.AFrameworkApplication.XZh,
d)}}Object(D.a)(Nu,"AssistanceSearchUrlProvider",null,[1927]);class nf{Ec(){}init(){G.AFrameworkApplication.nNb&&!G.AFrameworkApplication.dFe&&xn.instance.mc(G.AFrameworkApplication.va)}dispose(){xn.instance.dispose()}DWi(d){xn.instance.initialize(mx.createInstance(d,G.AFrameworkApplication.J),Nu.createInstance(Vv.createInstance("WDWAEndUser")))}}Object(D.a)(nf,"AssistancePackage",null,[0,1]);class wm{}wm.fwc=1;wm.CF="AssistanceTaskPane";wm.width=330;wm.iLg="AssistanceTaskPaneData";wm.$Wf="AssistanceContentFrame";
Object(D.a)(wm,"AssistanceConstants",null,[]);var kp=e(1380);class ss{constructor(d){this.q5e=this.r5e=this.NE=this.pk=null;this.M1n=n=>{n===this.pk&&this.$ua()};this.mvc=n=>{F.ULS.sendTraceTag(4474517,1302,50,"The resource at {0} is loaded successfully in assistance task pane",n.target.src);ol.a.mark(4776)};this.xyb=n=>{F.ULS.sendTraceTag(4474518,1302,15,"Loading the resource at {0} failed in assistance task pane",n.target.src);ol.a.mark(4776)};ol.a.mark(4773);this.xRd=d;this.CY();this.bD();ol.a.mark(4774)}CY(){this.pk=
this.xRd.N_c();this.BYf(this.pk.L2a.r0h);this.pk.Jug(this.M1n);this.pk.qo()}bD(){za.a.addHandler(this.NE,"load",this.r5e=this.mvc);za.a.addHandler(this.NE,"error",this.q5e=this.xyb)}Mea(){za.a.removeHandler(this.NE,"load",this.r5e);this.r5e=null;za.a.removeHandler(this.NE,"error",this.q5e);this.q5e=null}dispose(){this.Mea();this.NE.parentNode.removeChild(this.NE);this.NE=null;this.pk&&(this.xRd.pjc(wm.CF,this.pk),this.pk=null)}Myf(){this.NE.src=ss.FBh;this.pk.ro()}sU(d,n){d=d.getUrl(n);ol.a.mark(4775);
this.NE.src=d;this.pk.g2?this.pk.qo():this.xRd.showTaskPane(this.pk)}$ua(){this.xRd.hideTaskPane(this.pk);this.Myf()}BYf(d){const n=kp.a.createElement("iframe");n.src=ss.FBh;n.style.height="100%";this.NE=n;d.appendChild(this.NE);n.id=wm.$Wf}}ss.FBh="about:blank";Object(D.a)(ss,"AssistancePane",null,[1047,11]);var ju=e(1057),Wv=e(1041),Rm=e(95);class Xv{N_c(){const d=new Wv.a(Rm.a.Q8a,Box4Intl.Box4Strings);return ui.a.instance.hgi(wm.CF,wm.fwc,wm.width,wm.iLg,d)}showTaskPane(d){d.g2||(yg.StaticActiveAppFrame.Aa().qhb.X_j(d.id),
d.show(),Bf.a.Xm.GVa(Object(X.a)(d,d.qo,"pollForStateAndUpdate")),Bf.a.Xm.Ne())}hideTaskPane(d){ui.a.instance.hideTaskPane(d)}pjc(d,n){ui.a.instance.pjc(d,n)}}Object(D.a)(Xv,"WordEditorTaskPaneHandler",null,[1046]);class fq extends nf{constructor(){super();this.qFb=this.kOh=null}get name(){return"WordEditor.Assistance"}Ec(d){this.Z=d}init(){super.init();G.AFrameworkApplication.nNb&&(G.AFrameworkApplication.J.$("HelpTabIsEnabled")&&G.AFrameworkApplication.uE&&!G.AFrameworkApplication.BL?(this.kOh=
this.Z.Wa("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.DWi(()=>new Rs(this.kOh,this.qFb,ju.a.F5c()))):this.DWi(()=>new ss(new Xv)))}}Object(D.a)(fq,"WordEditorAssistancePackage",nf,[]);var ku=e(1107);class ty{create(){return new ku.a}}Object(D.a)(ty,"CustomXmlPartNodeFactory",null,[265]);class ot{constructor(d){this.H4e=0;this.E8a=new ff.a;this.sMb=d}ZOf(){if(this.H4e===Number.MAX_VALUE)throw F.ULS.sendTraceTag(19276675,366,10,"The namespace count reach the maximum allowed number"),
Error.create("The namespaces count is larger than the maximum allowed number");const d="ns"+this.H4e.toString();this.H4e++;return d}O4i(d){return void 0===d||null===d?!1:""!==this.J6c(d)?!0:!1}isDefaultNamespace(d){return void 0===d||null===d?!1:"http://www.w3.org/XML/1998/namespace"===d}mxi(){if(void 0!==this.sMb&&null!==this.sMb){var d=RegExp('xmlns=["\']([^"]*)["\']|xmlns:([^=]*)="([^"]*)"',"g"),n,B="";for(this.O4i("http://www.w3.org/XML/1998/namespace")||this.E8a.add("xml","http://www.w3.org/XML/1998/namespace");n=
d.exec(this.sMb);)void 0!==n[1]&&null!==n[1]?B=n[1]:void 0!==n[3]&&null!==n[3]&&(B=n[3]),""===B||this.O4i(B)||this.E8a.add(this.ZOf(),B)}}addNamespaceMapping(d,n){if(void 0===n||null===n||""===n||void 0===d||null===d||""===d)return F.ULS.sendTraceTag(19276676,366,10,"The namespace or prefix is empty"),!1;if(this.E8a.Bb(d))return F.ULS.sendTraceTag(19714131,366,10,"The prefix is already exists"),!1;this.E8a.add(d,n);return!0}WOf(d){if(void 0===d||null===d||""===d)return"";let n;({value:n}=this.E8a.Nc(d,
n));return void 0===n||null===n?"":n}J6c(d){if(void 0===d||null===d||""===d)return"";let n="";for(const B of this.E8a)if(B.value===d){n=B.key;break}return n}aRm(){this.mxi();let d=" ";for(const n of this.E8a)d=d+"xmlns:"+n.key+'="'+n.value+'" ';return d.trim()}}Object(D.a)(ot,"XmlNamespaceManager",null,[]);class ts{constructor(d,n){this.sMb=this.o6a=this.Zc=this.v8b=this._id=this.lAa=null;this.Veh=!1;this.LKd=null;this.init(d,n)}get Q3a(){return this.sMb}get builtIn(){return this.Veh}get namespace(){return this.LKd}get id(){return this._id}get bT(){return this.v8b}selectNodes(d,
n){return this.lAa.value.selectNodesByXPath(d,n)}getNodeXml(d){return this.lAa.value.getNodeXml(d)}setNodeXml(d,n){if(void 0!==n&&null!==n&&n.length>ts.$ag)return null;d=this.lAa.value.setNodeXml(d,n);void 0!==d&&null!==d&&(this.save(),this.Vck(n));return d}getNodeText(d){return this.lAa.value.getNodeText(d)}setNodeText(d,n){return void 0!==n&&null!==n&&n.length>ts.$ag?!1:this.lAa.value.setNodeText(d,n)?(this.save(),!0):!1}getNodeBaseName(d){return this.lAa.value.getNodeBaseName(d)}getNodeNamespaceURI(d){return this.lAa.value.getNodeNamespaceURI(d)||
""}getNodeType(d){return this.lAa.value.getNodeType(d)}J6c(d){return this.o6a.J6c(d)}WOf(d){return this.o6a.WOf(d)}ZSh(d,n){const B=this.o6a.addNamespaceMapping(d,n);B&&this.lAa.value.addNamespaceMapping(d,n);return B}appendChild(d,n){if(void 0!==n&&null!==n&&n.length>ts.$ag)return null;d=this.lAa.value.appendChild(d,n);void 0!==d&&null!==d&&(this.save(),this.Vck(n));return d}v2f(){return this.Q3a===this.v8b.getValue(Dd.a.$9a)}pQg(){this.init(this.v8b,this.Zc)}save(){const d=this.Zc.Vc(4);d.Eb(this.v8b);
const n=this.lAa.value.getDocumentElement();this.sMb=this.getNodeXml(n);this.v8b.setValue(Dd.a.$9a,this.Q3a);d.dispose()}init(d,n){this._id=d.getValue(Dd.a.QPb);this.sMb=d.getValue(Dd.a.$9a);this.Veh=d.getValue(Dd.a.Kic);this.LKd=d.getValue(Dd.a.X1d);this.o6a=new ot(this.Q3a);const B=this.o6a.aRm();this.lAa=new fa.a(()=>new OSF.XmlProcessor(this.Q3a,B));this.v8b=d;this.Zc=n}Vck(d){d=new ot(d);d.mxi();d=d.E8a;for(const n of d.keys)if(!this.o6a.isDefaultNamespace(d.K(n)))try{let B=this.o6a.ZOf();for(;this.o6a.E8a.Bb(B);)B=
this.o6a.ZOf();this.ZSh(B,d.K(n))}catch(B){F.ULS.sendTraceTag(20306075,366,10,"Cannot update namespace mapping as the namespace count has reached the maximum allowed number")}}}ts.$ag=1048576;Object(D.a)(ts,"CustomXmlDocument",null,[1045]);class zr{constructor(d,n,B){this.DIc=null;this.zQh=new lm.a;this.rB=d;this.CIc=n;this.Zc=B}get Pma(){if(void 0===this.DIc||null===this.DIc||23!==this.DIc.role)this.DIc=this.yvm();return this.DIc}yvm(){const d=new vc.a;d.set(this.rB.value);Object($g.a)().bU(d);d.ic(23);
return void 0!==d&&null!==d&&52===d.Jf?d:null}j9d(d,n=!1){const B=[],Q=this.Pma;if(Q){let ha=Q.ic(24);for(;ha;){const Aa=ha.getValue(Dd.a.X1d),bb=ha.getValue(Dd.a.Kic);Aa===d&&bb===n&&B.push(ha);ha=Q.gg(24)}}return B}XLf(d){let n=null;const B=this.Pma;if(B)for(var Q=B.ic(24);Q;){Q=Q.getValue(Dd.a.QPb);if(ja.a.Oh().equals(Q,d)){n=B;break}Q=B.gg(24)}return n}MBi(d){const n=d.getValue(Dd.a.QPb),B=d.getValue(Dd.a.$9a),Q=this.zQh.K(n);void 0!==Q&&null!==Q&&Q.Q3a===B?d=Q:(d=new ts(d,this.Zc),this.zQh.add(d.id,
d),void 0!==Q&&null!==Q&&Q.Q3a!==B&&F.ULS.sendTraceTag(9187598,366,50,"Custom xml id: {0} is out of date",n));return d}K4c(){const d=[],n=this.Pma;if(n)for(var B=n.ic(24);B;)B=this.MBi(B),d.push(B),B=n.gg(24);return d}dYa(d){let n=null;if(d=this.XLf(d))n=d.currentNode;return n?this.MBi(n):null}Ghf(d){let n=null;if(d.length>zr.ZRn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,lhd:n};var B=new OSF.XmlProcessor(d,"");if(B.isValidXml()){const Q=this.Zc.Vc(4);Q.nw(this.Pma);
B=B.getNodeNamespaceURI(B.getDocumentElement());const ha=this.Pma;n=this.CIc.create(Fc.a.bT);const Aa=new Jh.a(Ze.a.create(),1);n.setValue(Dd.a.QPb,"{"+Cb.e(Aa.gv.toString())+"}");n.setValue(Dd.a.$9a,d);n.setValue(Dd.a.X1d,B||"");n.setValue(Dd.a.Kic,!1);ha.a8(n,24,Aa);Q.dispose();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,lhd:n}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,lhd:n}}jji(d){if(d=this.XLf(d)){if(d.currentNode.getValue(Dd.a.Kic))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;
const n=this.Zc.Vc(4);n.nw(this.Pma);d.qh();n.dispose();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}w_o(d,n){if(d=this.XLf(d)){const B=d.currentNode;B.getValue(Dd.a.Kic)||(d=this.Zc.Vc(4),d.nw(this.Pma),B.setValue(Dd.a.$9a,n),d.dispose())}}F0f(d){return d.builtIn&&"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties"===d.namespace}}zr.ZRn=1048576;Object(D.a)(zr,"WordEditorCustomXmlManager",null,[1016]);class uy{get name(){return"WordEditor.CustomXml"}init(){}dispose(){}Ec(d){d.ja("WordEditor.CustomXmlPartNodeFactory",
()=>new ty).ha();d.ja("WordEditor.CustomXml.WordEditorCustomXmlManager",()=>new zr(new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.rd),Wa.a.instance.resolve("WordEditor.CustomXmlPartNodeFactory"),new pe.a)).as("WordEditor.CustomXml.IWordEditorCustomXmlManager").ha()}static main(){U.a.instance.Rc(new uy)}}Object(D.a)(uy,"CustomXmlPackage",null,[0,1]);var lo;(function(d){d[d.BTg=0]="Boot";d[d.ATg=1]="BeforeOpen";d[d.XUg=2]="OnPaneOpen";d[d.WUg=3]="OnPaneClose"})(lo||(lo={}));Object(D.b)("ReadyTime",lo);
class nx{constructor(d,n,B,Q,ha){this.container=d;this.Iv=n;this.actors=B;this.VN=Q;this.Zjg=(Aa,bb)=>{bb.data?this.VN.Ae(()=>{this.he(this.Iv.get(lo.WUg));this.initialize(this.Iv.get(lo.XUg))},"WD:IOO"):this.VN.Ae(()=>{this.he(this.Iv.get(lo.ATg));this.he(this.Iv.get(lo.XUg));this.initialize(this.Iv.get(lo.WUg))},"WD:DOC")};this.$1n=()=>{this.VN.Ae(()=>this.initialize(this.Iv.get(lo.ATg)),"WD:IBO")};ha.gfc(this.Zjg);ha.JUh(this.$1n)}Znf(){this.Mhg()}Mhg(){this.VN.Ae(()=>{this.initialize(this.Iv.get(lo.BTg));
this.actors.forEach(d=>d.mc())},"WD:BOOT")}initialize(d){d.forEach(n=>this.container.resolve(n).initialize())}he(d){d.forEach(n=>this.container.resolve(n).he())}}Object(D.a)(nx,"DesignerPackageInitializer",null,[]);class vy{jLl(d,n,B,Q,ha){return new nx(d,n,B,Q,ha)}}Object(D.a)(vy,"DesignerInitializerFactory",null,[]);var Ou=e(190),Da=e(307),Qa=e(212),R=e(1044),aa=e(69);class ta extends Ig.a{constructor(d,n,B){super();this.DesiredRevisionId=this.FileId=this.TemplateUrl=null;this.TemplateUrl=d;this.FileId=
n;this.DesiredRevisionId=B}Hn(){return Df.a.gWd}static construct(d,n,B){return new ta(d,n,B)}}Object(D.a)(ta,"ApplyTemplateRequest",Ig.a,[]);class Ra{constructor(d){this.HV=d}gWd(d,n){return new Promise((B,Q)=>{const ha=ta.construct(d,G.AFrameworkApplication.rootQuerySignature,n),Aa=String.format("{0}/we/OneNote.ashx?perfTag=ApplyTemplate&{1}",Nf.a.webServiceBase,G.AFrameworkApplication.rootQuerySignature);this.HV.addRequest(Aa,2,Mf.b(ha),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,
bb=>{var Ib,oc;if(null===(Ib=null===bb||void 0===bb?void 0:bb.data)||void 0===Ib||!Ib.responseData)return Q("No response data!");if(bb.data.Xe!==Qb.a.jB)return Q(`Bad Http Status ${bb.data.Xe}`);if(!({group:bb}=ch.a.A6(bb.data.responseData)).returnValue)return Q("Empty ServerResponse!");Ib=null;if(null===(oc=null===bb||void 0===bb?void 0:bb.Responses)||void 0===oc||!oc.length||!(Ib=bb.Responses[0])||Ib.classId!=Df.a.gWd)return Q("No valid response!");F.ULS.sendTraceTag(509642067,3016,50,"ApplyTemplate call successful.");
B(Ib)},bb=>{var Ib,oc;F.ULS.sendTraceTag(509642066,3042,10,"ApplyTemplates request failed [Status: {0}]",null===(Ib=null===bb||void 0===bb?void 0:bb.data)||void 0===Ib?void 0:Ib.status);Q(null===(oc=null===bb||void 0===bb?void 0:bb.data)||void 0===oc?void 0:oc.status)},ha)})}}Object(D.a)(Ra,"ApplyTemplatesProxyImplementation",null,[]);var pb=e(1490),Mb=e(1702),jc=e(1391);class tc extends jc.a{constructor(d,n,B,Q){super(tc.Gnf);this.ns=d;this.gh=n;this.view=B;this.options=Q}initialize(){super.initialize();
const d=this.options.$yc==this.gh.ama(this.view.Fd,{U1:this.options.U1,gva:this.options.e$c,oNa:this.options.d$c,T1:this.options.T1});d&&!this.Lva&&F.ULS.sendTraceTag(557114691,3028,50,this.d1(this.ns,!0,`satisfiedIfBlank=${this.options.$yc}`));this.ri(d)}he(){super.he()}}tc.Gnf="BlankDocumentConditionId";Object(D.a)(tc,"BlankDocumentCondition",jc.a,[]);var Zc=e(1075),gd=e(1103),od=e(1051),vd=e(1432);class Ld extends vd.a{constructor(d,n,B=0,Q=!0){super("DocumentEditedConditionId");this.wrb=d;this.Dh=
n;this.bzf=B;this.NBp=Q;this.Dgg=this.oGe=0;this.Eig=()=>{setTimeout(()=>{var ha,Aa;++this.Dgg;0==this.oGe&&(this.oGe=(new Date).getTime());if(this.Dh.Y4){const bb=null===(ha=this.Dh.AQ)||void 0===ha?void 0:ha.ZSl;ha=null===(Aa=null===bb||void 0===bb?void 0:bb.SQb)||void 0===Aa?void 0:Aa.wXb();null!==ha&&void 0!==ha&&ha.some(Ib=>Ib instanceof gd.a||Ib instanceof od.a||Ib instanceof Zc.a)||(0==this.bzf?this.dnj():(clearTimeout(this.timer),this.timer=setTimeout(()=>{this.l3j();this.dnj();F.ULS.sendTraceTag(521446627,
3016,50,"User stopped editing {0} seconds ago. Document has been edited {1} times. The last action was: {2}.                 {3} milliseconds have passed since the change began",this.bzf/1E3,this.Dgg,bb.actionId,(new Date).getTime()-this.oGe);this.oGe=this.Dgg=0},this.bzf)))}},1E3)};this.timer=void 0}initialize(){super.initialize();this.wrb.TMb(this.Eig)}he(){this.wrb.Pxe(this.Eig);this.l3j();super.he()}l3j(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}dnj(){this.ri(!0);this.NBp&&this.wrb.Pxe(this.Eig)}}
Object(D.a)(Ld,"DocumentEditedCondition",vd.a,[]);class ae extends vd.a{constructor(d,n,B){super("LocalStorageConditionId");this.bej=d;this.qwp=n;this.defaultValue=B}initialize(){var d;super.initialize();G.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.Designer.LocalStorageConditionOverride",void 0)===this.bej?this.ri(!0):this.ri((null!==(d=localStorage.getItem(this.bej))&&void 0!==d?d:this.defaultValue)===this.qwp)}}Object(D.a)(ae,"LocalStorageCondition",vd.a,[]);var ee=
e(1464),Be=e(1078),Ve=e(561),ve=e(42);class Jf{constructor(d,n,B){this.Wn=d;this.Heb=n;this.I3d=B;this.Wpj=(Q,ha)=>{this.documentType=ha.documentType;Jf.o4i||this.Bdb();this.I3d.SIo(this.Wpj)};this.I3d.o7k(this.Wpj)}Bdb(){if(void 0===this.documentType||null===this.documentType)this.documentType=-1;this.userType=this.$Wm();this.sBf();const d=new Ve.a;d.name=Jf.V2l;d.dataFields=this.YKl();d.dnmInterval=1;d.dnmAllowedPartA=[1,3,4,2,5];cg.a.sendDirectNumericEvent(d);Jf.o4i=!0}YKl(){const d=[];[this.cN("isBlank",
this.L_i),this.cN("DocumentType",this.documentType),this.cN("UserType",this.userType),this.cN("TableCount",this.Cea),this.cN("CharacterCount",this.characterCount),this.cN("ParagraphCount",this.KW),this.cN("ImageCount",this.xN),this.cN("ListElementsCount",this.vbj),this.cN("BlobsCount",this.NWc),this.cN("PageCount",this.vR)].forEach(n=>{d.push(n)});return d}cN(d,n){const B=new Ja.a;B.name=d;"number"===typeof n?B.int64=n:"boolean"===typeof n&&(B.bool=n);return B}sBf(){this.KW=this.NWc=this.vbj=this.Cea=
this.xN=this.characterCount=0;this.vR=this.Heb.getTotalPageCount();var d=Bf.a.Xm.tb.Xc.Fd;this.L_i=bf.ParagraphReader.ama(d);if(!this.L_i){d=this.Wn.Gua(d,7,7).currentNode;var n=vc.a.kb(d);for(d=Ie.a.$u(n,d);d.moveNext();)if(n=d.currentNode)if(Cj.a.nr(n))this.xN++;else if(oj.TableReader.pP(n))this.Cea++;else if(ve.a.Wg(n))this.vbj++;else if(bf.ParagraphReader.lc(n)){var B=Wh.e(n);for(let Q=0;Q<B.length;Q++)5===B[Q].xi?this.xN++:this.NWc++;B=Ed.AParagraphNode.DR(n.characterData);B=B.trim();this.characterCount+=
B.length;0<B.length&&!bf.ParagraphReader.AZ(n)&&!bf.ParagraphReader.zZ(n)&&this.KW++}}}$Wm(){return!0===G.AFrameworkApplication.J.$("IsO365ConsumerHost")?1:!0===G.AFrameworkApplication.J.$("IsO365CommercialHost")?2:!0===G.AFrameworkApplication.J.$("IsEduUser")?3:0}}Jf.V2l="Office.DNM.Word.Online.Designer.DocumentStatsEvent";Jf.o4i=!1;Object(D.a)(Jf,"DocumentStatsDnmLogger",null,[]);var rg=e(1493),gg=e(893),Tf;(function(d){d[d.initial=0]="initial";d[d.left=1]="left";d[d.center=2]="center";d[d.right=
3]="right";d[d.justify=4]="justify"})(Tf||(Tf={}));var fh;(function(d){d[d.initial=0]="initial";d[d.firstLine=1]="firstLine";d[d.hanging=2]="hanging"})(fh||(fh={}));var of;(function(d){d[d.none=0]="none";d[d.unknownError=1]="unknownError";d[d.nonTargetDocument=2]="nonTargetDocument";d[d.trackChangesNotSupported=3]="trackChangesNotSupported";d[d.lowConfidenceDocument=4]="lowConfidenceDocument";d[d.documentTooLarge=5]="documentTooLarge";d[d.multipleAuthorsNotSupported=6]="multipleAuthorsNotSupported"})(of||
(of={}));var Me;(function(d){d[d.table=0]="table";d[d.themeImage=1]="themeImage";d[d.complexDecorator=2]="complexDecorator";d[d.text2Image=3]="text2Image"})(Me||(Me={}));var Kg;(function(d){d[d.main=0]="main";d[d.coverPage=1]="coverPage";d[d.text2Image=2]="text2Image";d[d.letter=3]="letter";d[d.generalDocument=4]="generalDocument";d[d.toDoList=5]="toDoList";d[d.resume=6]="resume";d[d.coverLetter=7]="coverLetter";d[d.notes=8]="notes";d[d.journal=9]="journal";d[d.letterhead=10]="letterhead";d[d.report=
11]="report";d[d.article=12]="article";d[d.invoice=13]="invoice";d[d.favorites=14]="favorites";d[d.other=15]="other";d[d.none=16]="none"})(Kg||(Kg={}));var Og;(function(d){d[d.letters=0]="letters";d[d.writing=1]="writing";d[d.lists=2]="lists";d[d.resumes=3]="resumes";d[d.business=4]="business";d[d.education=5]="education";d[d.newsletters=6]="newsletters"})(Og||(Og={}));(function(){function d(n,B){void 0===n&&(n=Kg.none);void 0===B&&(B="");this.labelId=n;this.Gja=B}d.prototype.getLabel=function(){var n;
return null!==(n=this.labelId)&&void 0!==n?n:void 0};d.prototype.getStringId=function(){return this.Gja};d.prototype.equals=function(n){return this.Gja||n.Gja?this.Gja===n.Gja:this.labelId===n.labelId};d.equals=function(n,B){return n||B?n&&B?n.equals(B):!1:n===B};d.prototype.toString=function(){return null!==this.Gja?this.Gja:null!==this.labelId?this.labelId.toString():""};return d})();var pf;(function(d){d[d.main=0]="main";d[d.templates=1]="templates";d[d.templateStyles=2]="templateStyles"})(pf||
(pf={}));var uf;(function(d){d[d.theme=0]="theme";d[d.templateTheme=1]="templateTheme";d[d.officeTemplate=2]="officeTemplate"})(uf||(uf={}));var Li;(function(d){d[d.BetweenLeftAndRightMargin=0]="BetweenLeftAndRightMargin";d[d.BetweenLeftAndRightEdge=1]="BetweenLeftAndRightEdge"})(Li||(Li={}));var Yi;(function(d){d[d.stretchInsideMargins=0]="stretchInsideMargins";d[d.stretchEdgeToEdge=1]="stretchEdgeToEdge";d[d.original=2]="original"})(Yi||(Yi={}));var xm;(function(d){d[d.stretchInsideMargins=0]="stretchInsideMargins";
d[d.original=1]="original"})(xm||(xm={}));var Mn;(function(d){d[d.plain=0]="plain";d[d.predefined=1]="predefined";d[d.generatedByAI=2]="generatedByAI"})(Mn||(Mn={}));var ij=e(645),fn=e(1455),yf=e(149);class bi{}Object(D.a)(bi,"DesignerInfo",null,[]);class wp{constructor(d,n,B,Q,ha,Aa){this.fQb=d;this.assetId=n;this.isPremium=B;this.isL2Template=Q;this.collectionId=ha;this.collectionName=Aa}}Object(D.a)(wp,"DesignInfo",null,[]);class hm{}hm.byh="";hm.o$f=d=>{var n;d.cwb()&&bi.$E&&sb.a(yf.a.qrk,!0,
void 0,[{name:"CollectionID",string:bi.$E.collectionId},{name:"TemplateID",string:bi.$E.assetId},{name:"TemplateType",string:null===(n=bi.$E.fQb)||void 0===n?void 0:n.toString()},{name:"IsPremium",bool:bi.$E.isPremium},{name:"IsProactivePane",bool:bi.ycd},{name:"IsL2Template",bool:bi.$E.isL2Template}])};hm.Hfj=(d,n)=>{var B;n.cwb()&&(bi.$E?sb.a(yf.a.rrk,!0,null,[{name:"CollectionID",string:bi.$E.collectionId},{name:"TemplateID",string:bi.$E.assetId},{name:"TemplateType",string:null===(B=bi.$E.fQb)||
void 0===B?void 0:B.toString()},{name:"IsPremium",bool:bi.$E.isPremium},{name:"IsProactivePane",bool:bi.ycd},{name:"IsL2Template",bool:bi.$E.isL2Template},{name:"IsTemplateApplied",bool:d}]):F.ULS.shipAssertTag(509125727,3016,!1,"Could not log tried event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};hm.UNn=d=>{var n,B;d.cwb()&&(bi.$E?hm.byh!==bi.$E.assetId&&(hm.byh=bi.$E.assetId,sb.a(yf.a.prk,!0,void 0,[{name:"CollectionID",string:bi.$E.collectionId},{name:"TemplateID",
string:bi.$E.assetId},{name:"TemplateType",string:null===(n=bi.$E.fQb)||void 0===n?void 0:n.toString()},{name:"IsPremium",bool:bi.$E.isPremium},{name:"IsProactivePane",bool:bi.ycd},{name:"IsL2Template",bool:null===(B=bi.$E)||void 0===B?void 0:B.isL2Template}])):F.ULS.shipAssertTag(509096994,3016,!1,"Could not log edited event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};Object(D.a)(hm,"TemplateLogger",null,[]);class il{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,
ye,Qe,af,Qf,hf,di,vj,Wk,Tm){this.Tb=d;this.Un=n;this.oZc=B;this.mld=Q;this.vjc=ha;this.tca=Aa;this.lQo=bb;this.Qfb=Ib;this.AF=oc;this.GR=Ac;this.Eq=ad;this.jj=sd;this.jX=wd;this.bsp=yd;this.b6j=be;this.oe=ye;this.By=Qe;this.v6m=af;this.fpb=Qf;this.hN=hf;this.Uel=di;this.pCc=vj;this.rd=Wk;this.Dh=Tm;this.applyTheme=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(578856856,3016,!1),2;this.oZc.Fle();this.mld.Cnd();this.Un.Yq||F.ULS.sendTraceTag(573608067,3016,50,"Applying theme while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",
this.Un.iga,this.Un.Wy.gOa);const lg=wh.theme.id;this.Aqb(163,()=>{this.oe.NAn()&&gg.a.GCa(new ij.ThemeOperationSignal({operation:ij.IThemeOperation.Apply,themeId:lg}));bi.$E&&hm.o$f(this.oe);this.bsp.applyTheme(wh.theme,!1);const Lg=wh.theme,gp=bi.$E&&0!=bi.$E.fQb;bi.$E=new wp(Lg.type==uf.templateTheme?1:0,Lg.id.toString(),!1,Lg.IsL2Template,Lg.collectionId,Lg.collectionName);hm.Hfj(gp,this.oe);this.Dh.ffc(this.Jvc);wh.callback&&wh.callback(this.GR.Qn.r1b)});Ni&&(Ni.Av=lg,Ni.hG=wh.theme.isThemeInFavorites?
1:0);2!=this.oe.zYl()&&this.b6j.Ifj(wh.theme);return 32};this.fixInconsistencies=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(578856857,3016,!1),2;this.oZc.Fle();this.mld.Cnd();this.Un.Yq||F.ULS.sendTraceTag(573608068,3016,50,"Fixing inconsistencies while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.Un.iga,this.Un.Wy.gOa);this.Aqb(162,async()=>{try{const lg=this.Eq.rg("UserAction",yf.a.fixInconsistencies),Lg=Date.now();this.vjc.mdl().then(()=>{wh.callback&&wh.callback(this.GR.Qn.r1b);
sb.a(yf.a.ugm,!0,Date.now()-Lg);lg.stop()})}catch(lg){F.ULS.sendTraceTag(538240195,3016,10,lg)}});return 32};this.accept=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(578856858,3016,!1),2;this.By.isVisible&&this.mld.Cnd();this.Aqb(171,()=>{this.Qfb.accept(wh.paragraphNode,wh.Q0j)});Ni&&(Ni.Av=wh.role,Ni.hG=this.By.isVisible?0:1);this.oe.J0f()&&28==wh.role&&this.v6m.V5n();return 32};this.acceptAll=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(578856859,3016,!1),2;this.Aqb(167,()=>{this.Qfb.acceptAll()});
1!==wh.source&&this.mld.Cnd();Ni&&(Ni.Av=wh.source,Ni.hG=this.By.isVisible?0:1);return 32};this.reject=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(578856860,3016,!1),2;this.Qfb.reject(wh.paragraphNode,wh.Q0j);Ni&&(Ni.Av=wh.role,Ni.hG=this.By.isVisible?0:1);return 32};this.rejectAll=(Dk,gi,oi,Ni)=>{this.Aqb(168,()=>{this.Qfb.rejectAll()});Ni&&(Ni.hG=this.By.isVisible?0:1);return 32};this.ktd=(Dk,gi,oi,Ni)=>{this.Aqb(211,()=>{this.Qfb.ktd()});Ni&&(Ni.hG=this.By.isVisible?0:1);return 32};this.reviewChanges=
(Dk,gi,oi,Ni)=>{this.Aqb(169,()=>{const wh=this.GR.$Om();wh&&this.AF.Fmd(fn.a.create(wh))});Ni&&(Ni.hG=this.By.isVisible?0:1);return 32};this.tryAnyway=()=>{this.tca.l0l();return 32};this.showMoreThemes=(Dk,gi,oi,Ni)=>{Dk=this.jX.JIn();Ni&&(Ni.Av=Dk);return 32};this.logThemeInfo=(Dk,gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(546109061,3016,!1),2;this.b6j.Ifj(wh.theme);return 32};this.Epb=(Dk,gi,oi,Ni,wh)=>{wh&&this.Qfb.Epb(wh);this.By.isVisible&&this.mld.Cnd();Ni&&(Ni.Av=wh.role,Ni.hG=this.By.isVisible?
0:1);return 32};this.kRa=(Dk,gi,oi,Ni,wh)=>{wh&&this.Qfb.kRa(wh.paragraphNode);Ni&&(Ni.Av=wh.role,Ni.hG=this.By.isVisible?0:1);return 32};this.MRg=(Dk,gi,oi,Ni,wh)=>{wh.KWb?this.Qfb.kRa(wh.paragraphNode):this.Qfb.MRg(wh.paragraphNode);Ni&&(Ni.Av=wh.KWb?1:0,Ni.hG=this.By.isVisible?0:1);return 32};this.hco=()=>Ca.a.BZ(yf.a.LQi)?(gc.a.Zm(yf.a.LQi,void 0,void 0,"WordDesigner.OpenGreenroomPanel"),32):2;this.revertTheme=()=>{this.Aqb(208,()=>{this.lQo.revertTheme()});return 32};this.toggleFavorite=(Dk,
gi,oi,Ni,wh)=>{if(!wh)return F.ULS.shipAssertTag(520488720,3016,!1),2;Ni&&(Ni.Av=wh.theme.id,Ni.hG=wh.Asn?1:0);this.jX.toggleFavorite(wh.theme);return 32};this.applyOfficeTemplate=(Dk,gi,oi,Ni,wh)=>{var lg;if(!wh)return F.ULS.shipAssertTag(509693955,3016,!1),2;if(!wh)return F.ULS.shipAssertTag(509642068,3016,!1),2;null===(lg=this.hN)||void 0===lg?void 0:lg.BIg();this.fpb.showDialog();Dk=Ze.a.create();this.pCc.g1=Dk;this.pCc.B0n=wh;this.pCc.CYl=this.YSg;this.rd.addListener(this.pCc);this.Uel.gWd(wh.template.binaryUrl,
Dk.toString()).then(Lg=>{if(0!=Lg.StatusCode)F.ULS.shipAssertTag(509436170,3016,!1,`ApplyTemplate response not successful. OperationResult ${Lg.StatusCode}`),this.YSg(this.pCc,wh),this.zA();else{bi.$E&&hm.o$f(this.oe);Lg=bi.$E&&0!=bi.$E.fQb;const gp=wh.template;bi.$E=new wp(2,gp.templateId,gp.isPremium,gp.isL2Template,gp.collectionId,gp.collectionName);hm.Hfj(Lg,this.oe);this.Dh.ffc(this.Jvc)}}).catch(Lg=>{F.ULS.shipAssertTag(509638114,3016,!1,Lg);this.YSg(this.pCc,wh)});return 32};this.Jvc=(Dk,gi)=>
{if(gi.actionId===Se.a.oBa||this.Dh.Xca(gi.actionId))hm.o$f(this.oe),bi.$E=null,this.Dh.zwg(this.Jvc)};this.YSg=(Dk,gi)=>{var oi;this.rd.removeListener(Dk);this.fpb.LBa();null===(oi=this.hN)||void 0===oi?void 0:oi.B4d();gi.q4n(this.GR.Qn.r1b)};this.zA=()=>{const Dk=new Sa.StandardDialog;Dk.Md=0;Dk.Yx(WordRibbonStrings.ApplyTemplateErrorDialogTitle,WordRibbonStrings.ApplyTemplateErrorDialogMessage,0)}}mc(){this.Tb.nb(Se.a.y8a,ed.a.view,this.applyTheme,1036);this.Tb.nb(dd.a.X6d,ed.a.view,this.fixInconsistencies,
1028);this.Tb.nb(dd.a.DTd,ed.a.view,this.accept,1036);this.Tb.nb(Se.a.kob,ed.a.view,this.acceptAll,1036);this.Tb.nb(dd.a.pxe,ed.a.view,this.reject,1036);this.Tb.nb(dd.a.Ind,ed.a.view,this.rejectAll,1036);this.Tb.nb(dd.a.Vzf,ed.a.view,this.ktd,1036);this.Tb.nb(dd.a.Szf,ed.a.view,this.reviewChanges,1036);this.Tb.nb(dd.a.dki,ed.a.view,this.tryAnyway,1028);this.Tb.nb(dd.a.bki,ed.a.view,this.showMoreThemes,1036);this.Tb.nb(dd.a.Xji,ed.a.view,this.logThemeInfo,1124);this.Tb.nb(dd.a.Epb,ed.a.view,this.Epb,
1036);this.Tb.nb(dd.a.kRa,ed.a.view,this.kRa,1036);this.Tb.nb(dd.a.Xzf,ed.a.view,this.MRg,1036);this.Tb.nb(dd.a.Yji,ed.a.view,this.hco,1028);this.Tb.nb(dd.a.$yg,ed.a.view,this.revertTheme,1028);this.Tb.nb(dd.a.ksi,ed.a.view,this.toggleFavorite,1036);this.Tb.nb(Se.a.oBa,ed.a.view,this.applyOfficeTemplate,1036)}Aqb(d,n){d=this.Lqb(d,n);this.jj.pc(d)}Lqb(d,n){return new tb.a(2,1,0,n,d)}}Object(D.a)(il,"DesignerActionActor",null,[1147]);const Lh=d=>{ol.a.bpf&&window.performance.mark(d)};var Yo=e(1526);
class Nn{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.Tb=d;this.By=n;this.x_a=B;this.xQo=Q;this.yQo=ha;this.fp=Aa;this.xv=bb;this.oe=Ib;this.x_a.M6k(this.xjg.bind(this))}mc(){this.Tb.nb(dd.a.WQa,S.a.frame,this.WQa.bind(this),1036);this.Tb.nb(dd.a.yxc,ed.a.view,this.yxc.bind(this),1124);this.Tb.nb(dd.a.Nrg,ed.a.view,this.qmd.bind(this),1124);this.Tb.nb(dd.a.Lrg,ed.a.view,this.qmd.bind(this),1124);this.Tb.nb(dd.a.Mrg,ed.a.view,this.qmd.bind(this),1124);this.Tb.nb(dd.a.Krg,ed.a.view,this.qmd.bind(this),1124);
this.Tb.nb(dd.a.Org,ed.a.view,this.qmd.bind(this),1124);this.Tb.nb(dd.a.Qzf,ed.a.view,this.O2d.bind(this),1028);this.Tb.nb(dd.a.Ozf,ed.a.view,this.O2d.bind(this),1028);this.Tb.nb(dd.a.Pzf,ed.a.view,this.O2d.bind(this),1028);this.Tb.nb(dd.a.Nzf,ed.a.view,this.O2d.bind(this),1028);this.Tb.nb(dd.a.cki,ed.a.view,this.WQa.bind(this),1028);this.fp.efc(this.I5.bind(this))}xjg(){this.xQo.dispatch(this.yQo.updateControlHiddenState(yf.a.vEj,!1));Lh(yf.a.qyj);window.performance&&"function"===typeof window.performance.measure&&
window.performance.measure(yf.a.hio,yf.a.ryj,yf.a.qyj)}WQa(d,n,B,Q,ha){return 1===B?32:2===B?(d=Object(zk.a)(Yo.a,ha)?ha.id:0,bi.ycd=0!=d,Q&&(Q.Av=this.By.isVisible?0:1,Q.hG=d),this.By.isVisible?this.By.hide():this.By.show(d),32):2}yxc(d,n,B,Q,ha){if(1===B)return 32;if(!ha)return 2;ha&&(ha[Gf.a.On]=this.By.isVisible);return 32}qmd(d,n,B,Q,ha){if(1===B)return 32;if(!ha)return 2;if(ha)if(d===dd.a.Nrg)ha[Qk.a.Visible]=!this.fp.ata();else if(d===dd.a.Lrg)ha[Qk.a.Visible]=this.fp.ata();else if(d===dd.a.Mrg)ha[Qk.a.Visible]=
this.oe.L4f()&&this.fp.Xad(2);else if(d===dd.a.Krg)ha[Qk.a.Visible]=this.oe.L4f()&&!this.fp.Xad(2);else if(d!=dd.a.Org)return F.ULS.shipAssertTag(523850504,3016,!1,`unexpected actionId: ${d}`),8;return 32}O2d(d,n,B){if(1===B)return 32;F.ULS.sendTraceTag(523850505,3016,50,`designerChangeSettings actionId: ${d}`);if(d===dd.a.Qzf)this.fp.j6l();else if(d===dd.a.Ozf)this.fp.h4()?this.fp.ali():(F.ULS.sendTraceTag(509137224,3016,15,"designerDisableSuggestionsUntilUpdate fallback to local disable since roaming data is not ready"),
this.fp.EAf());else if(d===dd.a.YXl)this.fp.EAf();else if(d===dd.a.Pzf)this.fp.pak(2);else if(d===dd.a.Nzf)this.fp.oTj(2),this.By.isVisible&&this.By.hide();else return F.ULS.shipAssertTag(523850506,3016,!1,`unexpected actionId: ${d}`),8;return 32}I5(){this.xv.Ne()}}Object(D.a)(Nn,"DesignerActor",null,[1147]);var Lq=e(1095);class Oi{constructor(d,n,B){this.Tb=d;this.Txa=n;this.Pda=B;this.EFa=(Q,ha,Aa)=>{var bb,Ib,oc,Ac,ad;return 1===Aa?(0===this.Txa.Tpa&&this.Txa.PDc(0),F.ULS.sendTraceTag(524149770,
3016,50,"CCP floatie opened or refreshed. Designer paste state: {0}. CorrelationId: {1}",null===(bb=this.Txa.Tpa)||void 0===bb?void 0:bb.toString(),null===(Ib=this.Txa.bXb)||void 0===Ib?void 0:Ib.toString()),sb.a("Box4PasteFloatieOpenedOrRefreshed",!0,void 0,[Object.assign(new Ja.a,{name:"DesignerPasteState",string:null===(oc=this.Txa.Tpa)||void 0===oc?void 0:oc.toString()}),Object.assign(new Ja.a,{name:"CorrelationId",string:null===(Ac=this.Txa.bXb)||void 0===Ac?void 0:Ac.toString()})]),1===this.Txa.Tpa?
32:2):2===Aa?(this.Txa.M5i(this.Txa.Mma())&&!this.Txa.M5i(null===(ad=this.Txa.yQa)||void 0===ad?void 0:ad.qho)&&G.AFrameworkApplication.va.Zb(Se.a.m1a,2,null),this.Txa.j2o(Q),this.Pda.Exc(Object.assign(new Lq.a,{mbd:!0,OZ:"reformatPastedContentToDesignerPaste"})),Q=this.Txa.Eel(),F.ULS.sendTraceTag(524149771,3016,50,`Suggestions applied: ${Q}`),Nf.a.Oxc(()=>{this.Pda.Exc(Object.assign(new Lq.a,{mbd:!1,nGg:!0}))}),32):2}}mc(){this.Tb.nb(Se.a.EFa,ed.a.view,this.EFa,1036)}}Object(D.a)(Oi,"DesignerPasteActor",
null,[1147]);class ym{set g1(d){this.xn=d}set CYl(d){this.nzk=d}set B0n(d){this.jMk=d}constructor(d){this.Dh=d}kvc(){}g0a(){}lyb(d){d.Hd.Dn.id.gv.equals(this.xn)&&(this.Imo(),this.nzk(this,this.jMk))}Imo(){this.Dh.Ztc(Se.a.oBa,this.Dh.L4(),!0)}}Object(D.a)(ym,"TemplateAppliedListener",null,[]);class uq{constructor(d,n){this.vi=!1;this.P3n=(B,Q)=>{Q.data?this.start():this.stop()};this.mdh=n;this.bDd=d}initialize(){this.vi||(this.bDd.gfc(this.P3n),this.vi=!0)}he(){}start(){for(const d of this.mdh)d.register()}stop(){for(const d of this.mdh)d.unregister()}}
Object(D.a)(uq,"WorkflowManager",null,[1149,478]);class Ts{setTimeout(d,n){return window.setTimeout(d,n)}clearTimeout(d){window.clearTimeout(d)}}Object(D.a)(Ts,"WindowTimeout",null,[1148]);class Ar extends vd.a{constructor(d,n,B){super(yf.a.qAl);this.ns=d;this.Un=n;this.Reg=B}static wUg(d,n){return!n||d.Yq?!0:d.Wy.gOa&&0<(n&1)?0<(n&2)?!1:d.iga:!d.Wy.gOa&&0<(n&4)?0<(n&8)?!1:d.iga:!0}initialize(){super.initialize();Ar.wUg(this.Un,this.Reg)&&(this.Lva||F.ULS.sendTraceTag(540116318,3016,50,this.d1(this.ns,
!0)),this.ri(!0))}he(){super.he()}}Object(D.a)(Ar,"CoAuthCondition",vd.a,[]);class yn extends vd.a{ri(d){this.N$b===d&&d||super.ri(d)}}Object(D.a)(yn,"AOnChangeOrUnsatisfiedConditionProcessor",vd.a,[]);class zm extends yn{constructor(d,n,B){super("DocumentHasHeadingConditionId");this.gX=d;this.eT=n;this.KDa=B;this.isInitialized=!1}initialize(){if(!this.isInitialized){super.initialize();this.isInitialized=!0;var d=this.gX.GBm();for(const n of d)n&&!this.eT.O3d(n)&&this.KDa.lif(n,!1);this.KDa.size&&
(F.ULS.sendTraceTag(509649924,3016,50,"Document has headings suitable for image suggestions"),this.ri(!0))}}he(){this.isInitialized&&(this.isInitialized=!1,super.he())}}Object(D.a)(zm,"DocumentHasHeadingCondition",yn,[]);class xp extends yn{constructor(d,n,B,Q){super(yf.a.Ami);this.UNj=d;this.sQb=n;this.gX=B;this.KDa=Q;this.workflowsRegistered=this.isInitialized=!1;this.onTimeout=()=>{const ha=this.gX.oSf();ha&&this.KDa.lif(ha,!0);this.ri(!!ha)};this.Zhd=()=>{G.AFrameworkApplication.zc.pc(new tb.a(2,
1,500,this.onTimeout));this.he()}}initialize(){super.initialize();if(!this.isInitialized){this.isInitialized=!0;var d=this.gX.oSf();d?(this.KDa.lif(d,!0),this.ri(!0)):this.workflowsRegistered||(this.workflowsRegistered=!0,this.UNj.register(),this.sQb.register(),this.sQb.IJ(this.Zhd))}}he(){this.isInitialized&&(this.isInitialized=!1,this.workflowsRegistered&&(this.workflowsRegistered=!1,this.sQb.iM(this.Zhd),this.sQb.unregister(),this.UNj.unregister()));super.he()}}Object(D.a)(xp,"DocumentHasTitleCondition",
yn,[]);class jr extends yn{constructor(){super("HeadingsImageConditionId")}V5n(){this.ri(!0)}}Object(D.a)(jr,"HeadingsImageCondition",yn,[1146]);var pt=e(83);class Op extends vd.a{constructor(d,n,B,Q,ha=2E3){super(yf.a.nhk);this.wrb=d;this.jM=n;this.KDa=B;this.Xc=Q;this.Rgk=ha;this.isInitialized=!1;this.Q$i=1;this.vrf=()=>{if(!this.KDa.h5f){var Aa=bf.ParagraphReader.Vn(this.Xc.Fd),bb=this.KDa.yzm();null===Aa||void 0===Aa||!Aa.characterData||bb&&Aa.characterData===bb.L6f||100<=Aa.characterData.length||
this.jM.Kcd(Aa)||(bb=pt.a.uu(ge.a.create(Aa)),bb=pt.a.rh(bb,xd.a.fontSize,this.oui),Aa!==this.Wkc||this.oui!==bb||this.Yfm!==Aa.characterData?(this.Wkc=Aa,this.oui=bb,this.Yfm=Aa.characterData,this.omi()):(Aa=bf.ParagraphReader.ox(this.Xc.Fd,!1,!1).count,10>Aa&&Aa>this.Q$i&&(this.omi(),this.Q$i=Aa)))}}}vOl(){return new tb.a(2,1,this.Rgk,()=>{this.KDa.h5f=!0;this.ri(!0);this.Loe=null})}initialize(){super.initialize();this.isInitialized||(this.isInitialized=!0,this.wrb.TMb(this.vrf),this.vrf())}he(){this.isInitialized&&
(this.isInitialized=!1,this.wrb.Pxe(this.vrf));super.he()}omi(){this.Loe?G.AFrameworkApplication.zc.Z5(this.Loe,this.Rgk):(this.Loe=this.vOl(),G.AFrameworkApplication.zc.pc(this.Loe))}}Object(D.a)(Op,"ImageSuggestionWholeSessionTriggerCondition",vd.a,[]);class Zo extends yn{constructor(d,n){super(yf.a.umj);this.eT=d;this.Xc=n}initialize(){super.initialize();const d=bf.ParagraphReader.Vn(this.Xc.Fd);this.ri(!this.eT.O3d(d))}}Object(D.a)(Zo,"NoCoverPhotoCondition",yn,[]);class lu extends vd.a{constructor(d,
n){super(yf.a.tho);this.context=n;this.G5=(B,Q)=>{this.context.oif(Q.node);Q.W3i&&(this.context.Gfm(),this.ri(!0))};this.Vjd=d.Hf(12);this.context=n}initialize(){super.initialize();this.Vjd.DUh(this.G5)}he(){this.Vjd.DJj(this.G5);super.he()}}Object(D.a)(lu,"PasteCondition",vd.a,[]);class jh extends vd.a{constructor(d){super(yf.a.geo);this.x_a=d;this.jle=this.isInitialized=!1;this.Yrj=()=>{this.ri(this.x_a.lZh)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.x_a.lZh?
this.ri(!0):this.jle||(this.jle=!0,this.x_a.j6k(this.Yrj)))}he(){this.isInitialized&&(this.isInitialized=!1,this.jle&&(this.x_a.rIo(this.Yrj),this.jle=!1),super.he())}}Object(D.a)(jh,"PQLicenseCondition",vd.a,[]);var Lt=e(1582);class fk extends yn{constructor(d,n,B,Q,ha,Aa){super(yf.a.rro);this.yjc=d;this.I_b=n;this.EOn=B;this.Xc=Q;this.ub=ha;this.Iwa=Aa;this.isInitialized=!1;this.Lsj=(bb,Ib)=>{Ib.data.annotation?Ib.data.annotation.annotationType!==Lt.DocumentPullQuoteAnnotation.getTypeName()?(F.ULS.shipAssertTag(542500387,
3016,!1),this.ri(!1)):(bb=Ib.data.annotation.content)?(F.ULS.sendTraceTag(541446528,3016,50,"PullQuotes received; Number of detected pull quotes: {0}",bb.numberOfDetectedPullQuotes),this.ri(0<bb.numberOfDetectedPullQuotes)):(F.ULS.shipAssertTag(542500416,3016,!1),this.ri(!1)):(F.ULS.shipAssertTag(542500386,3016,!1),this.ri(!1))}}initialize(){if(!this.isInitialized){super.initialize();var d=this.EOn.m$d();let n=!1;75>d.paragraphCount&&10>d.listElementsCount&&10>d.blobsCount&&2>d.tableCount&&(this.I_b.register(),
this.yjc.register(),this.yjc.IJ(this.Lsj),d=this.nvm(),-1==d&&F.ULS.sendTraceTag(536941664,3016,15,"Current paragraph index for PQ signal could not be obtained."),d=new Lt.PullQuotesSignal({currentParagraphIndex:d}),this.yjc.GCa(d),this.I_b.GCa(d),this.isInitialized=n=!0);F.ULS.sendTraceTag(541446499,3016,50,"PullQuotes signal sent: {0}",n)}}he(){this.isInitialized&&(this.yjc.iM(this.Lsj),this.isInitialized=!1,super.he())}nvm(){var d=this.ub.ob.currentSelection;if(!d)return-1;d=d.ig?d.hd:d.Ya;if(!d||
0>d.cpBegin)return-1;d=d.node;let n=0;if(this.u9i(d)){var B=bf.ParagraphReader.Vn(this.Xc.Fd);B=this.Iwa.KWa(B,!1,!1);do if(this.u9i(B.uC)){if(B.uC===d)return n;n++}while(B.Jna())}return-1}u9i(d){return bf.ParagraphReader.lc(d)&&!bf.ParagraphReader.zZ(d)&&!bf.ParagraphReader.AZ(d)&&bf.ParagraphReader.Fcb(d)}}Object(D.a)(fk,"PullQuotesCondition",yn,[]);var Bk=e(1588),Ym=e(1438);class mo extends yn{constructor(d,n,B,Q){super(yf.a.X5j);this.gX=d;this.JUb=n;this.PH=B;this.oe=Q;this.isInitialized=!1;this.Umg=
0;this.Sge=!1;this.Qqj=(ha,Aa)=>{var bb;if(!Aa)F.ULS.shipAssertTag(520986718,3016,!1,"Got images for a non-existent paragraph");else if(this.JUb.has(Aa))if(++this.Umg,ha=this.gX.getImages(Aa))if((null===(bb=ha.jW)||void 0===bb?void 0:bb.length)<yf.a.Ume)F.ULS.shipAssertTag(543269218,3016,!1),this.Noe(!1);else{for(bb=0;bb<yf.a.Ume&&ha.jW[bb].category===Bk.SuggestionCategory.TextRelatedImage;)bb++;F.ULS.sendTraceTag(527210448,3016,50,`${bb} TextRelated image suggestions returned by workflow`);0<bb?
(Aa=this.JUb.get(Aa),Aa.suggestion=new Ym.b(Jh.a.create(),ha.jW,ha.baseUrl,this.PH,this.oe,Aa.Mje),this.Noe(!0)):this.Noe(!1)}else F.ULS.shipAssertTag(543269217,3016,!1),this.Noe(!1)}}initialize(){var d;super.initialize();if(!this.isInitialized){this.isInitialized=!0;var n=[];for(const [B,Q]of this.JUb)(null===(d=Q.paragraph)||void 0===d?0:d.characterData)?(Q.L6f=Q.paragraph.characterData,n.push({id:B,text:Q.L6f})):(F.ULS.shipAssertTag(543269214,3016,!1),this.JUb.delete(B));this.JUb.size?(this.G8i()||
F.ULS.sendTraceTag(509649923,3016,50,"Request images for headings"),this.gX.initialize(),this.gX.rjf(this.Qqj),this.gX.$0b(n)):(F.ULS.shipAssertTag(521184916,3016,!1),this.ri(!1))}}he(){this.isInitialized&&(this.gX.OJj(this.Qqj),this.gX.he(),this.isInitialized=!1);super.he()}Noe(d){this.Sge||(this.Sge=d);this.Umg==this.JUb.size&&(this.ri(this.Sge),this.Umg=0,this.Sge=!1,this.G8i()||F.ULS.sendTraceTag(509649922,3016,50,"Received all images requested for headings"))}G8i(){return this.JUb.values().next().value.Mje}}
Object(D.a)(mo,"TextToImageCondition",yn,[]);var kj=e(1096),$f=e(1405);class Kl{constructor(d,n,B,Q,ha){this.oe=d;this.vjc=n;this.vua=B;this.Qn=Q;this.context=ha;this.isInitialized=!1;this.gha=0;this.syb=(Aa,bb)=>{var Ib=bb.data.annotation;if(Ib)if(Ib.annotationType!==$f.FormattingSuggestionsAnnotation.getTypeName())F.ULS.shipAssertTag(523068247,3016,!1);else if(Aa=this.vua.getParent(Ib))if(bb.data.operationType===kj.b.getTypeName())this.vjc.K6m(Aa);else if(bb.data.operationType!==kj.a.getTypeName())F.ULS.shipAssertTag(523068249,
3016,!1,`unexpected operationType: ${bb.data.operationType}`);else{if(!this.oe.R3f()&&!this.context.qFa.includes(Aa))if((Ib=Ib.content)&&Ib.range===$f.FormattingSuggestionsRange.List&&this.context.MFl(Aa))F.ULS.sendTraceTag(509870788,3016,50,`Don't skip list paragraph: ${null===Aa||void 0===Aa?void 0:Aa.id}`);else{F.ULS.sendTraceTag(523068251,3016,50,`Skip paragraph not in pastedNodes: ${null===Aa||void 0===Aa?void 0:Aa.id}`);return}this.gha&&(Ib=[Object.assign(new Ja.a,{name:yf.a.Htg,string:this.oe.R3f()?
"RealTimeInconsistencies":"BlueDiamondSmartPaste"})],sb.a(yf.a.Gtg,!0,Date.now()-this.gha,Ib),this.gha=0);0<this.oe.zBb()&&this.context.qFa.includes(Aa)?F.ULS.sendTraceTag(521483353,3016,50,`Skip paragraph for SmartPaste CCP: ${null===Aa||void 0===Aa?void 0:Aa.id}`):this.vjc.Pdp(Aa,bb.data.annotation)}else F.ULS.shipAssertTag(523068248,3016,!1);else F.ULS.shipAssertTag(523068246,3016,!1)}}initialize(){this.isInitialized||(F.ULS.sendTraceTag(545874375,3016,50,"ConsistencySuggestionsProvider - initialize"),
this.gha=Date.now(),this.vua.IJ(this.syb),this.Qn.register(),this.vua.register(),this.isInitialized=!0)}he(){this.isInitialized&&(F.ULS.sendTraceTag(545874376,3016,50,"ConsistencySuggestionsProvider - deinitialize"),this.Qn.unregister(),this.vua.unregister(),this.vua.iM(this.syb),this.isInitialized=!1)}}Object(D.a)(Kl,"ConsistencySuggestionsProvider",null,[478]);class No{constructor(d,n,B,Q=!0){this.AUk=d;this.yQk=n;this.dMh=B;this.yMd=Q;this.F8j=(ha,Aa)=>{Aa.zja?this.yMd&&this._timer?(clearTimeout(this._timer),
this.nek()):this.Ekp():this.he()};this._timer=void 0}initialize(){F.ULS.sendTraceTag(545874373,3016,50,"ConsistencySuggestionsTriggerManager - initialize");const d=this.FOi();for(const n of d)n.Qsa(this.F8j),n.initialize()}he(){F.ULS.sendTraceTag(545874374,3016,50,"ConsistencySuggestionsTriggerManager - deinitialize");this.T2j();const d=this.FOi();for(const n of d)n.he(),n.NFa(this.F8j)}T2j(){if(this.yMd){if(!this._timer)return;clearTimeout(this._timer);this._timer=void 0}this.dMh.he()}Ekp(){this.dMh.initialize();
this.yMd&&this.nek()}FOi(){return this.yMd?this.AUk:this.yQk}nek(){this._timer=setTimeout(()=>{this.T2j()},3E4)}}Object(D.a)(No,"ConsistencySuggestionsTriggerManager",null,[1048]);class Pp{constructor(d){this.Vd=d;this.DNc=new Set;this.clear()}clear(){this.tyl()}get qFa(){return this.FEh}tyl(){this.FEh=[];this.DNc.clear();this.DEh=!1}oif(d){this.DEh&&this.clear();this.FEh.push(d);ve.a.Qe?ve.a.isListItem(d)&&({listId:d}=ve.a.ut(d),this.DNc.add(d)):this.Vd&&(d=this.Vd.pha(d))&&d.hasProperty(Dd.a.listID)&&
(d=d.getValue(Dd.a.listID),this.DNc.add(d))}Gfm(){this.DEh=!0}MFl(d){if(ve.a.Qe){if(ve.a.isListItem(d))return{listId:d}=ve.a.ut(d),this.DNc.has(d)}else if((d=this.Vd.pha(d))&&d.hasProperty(Dd.a.listID))return d=d.ka(Dd.a.listID,-1),this.DNc.has(d);return!1}}Object(D.a)(Pp,"ContextualSuggestionsContext",null,[]);var $o=e(1459);class Bi{constructor(d,n,B){this.eT=d;this.GR=n;this.AF=B;this.W5n=Q=>{this.AF.Dxc({role:28,paragraphNode:Q.Rb.paragraph,placeholder:!1,N9c:Q});G.AFrameworkApplication.zc.pc(new tb.a(2,
1,0,()=>{this.AF.Fmd(fn.a.create(Q.Rb.paragraph))},void 0,void 0,!0))}}Gep(d){d.paragraphNode?d.suggestion?d.suggestion.Kua(d.dva)?null==d.suggestion.z1(d.dva)?F.ULS.shipAssertTag(541435532,3016,!1):3===this.GR.VCe(new $o.b(d.suggestion,[d.paragraphNode],0,bf.ParagraphReader.textLength(d.paragraphNode),()=>this.nYh(d)))&&F.ULS.sendTraceTag(541435533,3016,50,"Contextual image suggestion offered"):F.ULS.shipAssertTag(541435531,3016,!1):F.ULS.shipAssertTag(540389592,3016,!1):F.ULS.shipAssertTag(541435530,
3016,!1)}nYh(d){if(d.paragraphNode)if(d.suggestion)if(d.suggestion.Kua(d.dva))if(null==d.suggestion.z1(d.dva))F.ULS.shipAssertTag(527521920,3016,!1);else return F.ULS.sendTraceTag(527210447,3016,50,"Applying image suggestion. {0}",{["imageIndex"]:d.dva,["imageConfidence"]:d.suggestion.yCm(d.dva)}),3===this.GR.DBj(d,n=>{n.suggestion.selectedIndex=n.dva;if(n=this.eT.fZf(n.suggestion.Kua(n.dva),n.paragraphNode,!0,Se.a.bNb,Se.a.Elf,{$od:{C3b:0,Axf:yf.a.qVi},altText:n.suggestion.z1(n.dva),uee:Se.a.WVd},
this.W5n))return{role:28,paragraphNode:n.Rb.paragraph,N9c:n,placeholder:!0}});else F.ULS.shipAssertTag(527521891,3016,!1);else F.ULS.shipAssertTag(527521890,3016,!1);else F.ULS.shipAssertTag(527521889,3016,!1)}}Object(D.a)(Bi,"ImageSuggestionHandlerImpl",null,[1145]);class ik{constructor(d,n,B){this.By=d;this.eT=n;this.Xc=B}initialize(){}vea(){return this.By.isVisible?(F.ULS.sendTraceTag(543269248,3016,50,"Auto launch suppressed: pane already visible"),!0):this.eT.O3d(bf.ParagraphReader.Vn(this.Xc.Fd))?
(F.ULS.sendTraceTag(543269249,3016,50,"Auto launch suppressed: first paragraph is an image"),!0):!1}w2(){}}Object(D.a)(ik,"ImageSuggestionSuppressionModel",null,[922]);class qm extends Map{constructor(){super(...arguments);this.h5f=!1}lif(d,n){if(d){var B=d.id.toString();this.has(B)?this.get(B).paragraph=d:this.set(B,{suggestion:null,paragraph:d,L6f:"",Mje:n})}}yzm(){return this.values().next().value}}Object(D.a)(qm,"ImageSuggestionContextMap",Map,[]);class wo{constructor(d,n,B){this.oqa=d;this.yXf=
n;this.KDa=B;this.isInitialized=!1;this.w8j=(Q,ha)=>{if(ha.zja)for(const Aa of this.KDa.values())Aa.suggestion&&this.yXf.Gep(new $o.a(Aa.suggestion,Aa.paragraph,0));this.KDa.h5f=!1}}initialize(){if(!this.isInitialized){for(const d of this.oqa)d.Qsa(this.w8j),d.initialize();this.isInitialized=!0}}he(){if(this.isInitialized){for(const d of this.oqa)d.he(),d.NFa(this.w8j);this.isInitialized=!1}}}Object(D.a)(wo,"ImageSuggestionTriggerManager",null,[1048]);class dj{constructor(d){this.By=d}initialize(){}vea(){return this.By.isVisible?
(F.ULS.sendTraceTag(542500385,3016,50,"Auto launch suppressed: pane already visible"),!0):!1}w2(){}}Object(D.a)(dj,"PullQuotesSuppressionModel",null,[922]);var Ul=e(1752);class wk{constructor(d,n,B,Q,ha,Aa,bb=null,Ib){this.oqa=d;this.tro=n;this.I_b=B;this.Tzf=Q;this.GR=ha;this.Qn=Aa;this.PH=bb;this.oe=Ib;this.Tae=(oc,Ac)=>{Ac.zja&&this.xfp().then(ad=>{F.ULS.sendTraceTag(542500378,3016,50,`PullQuotes showed: ${ad}`)});this.he()}}initialize(){F.ULS.sendTraceTag(542500376,3016,50,"PullQuotesTriggerManager.ts - initialize");
for(const d of this.oqa)d.Qsa(this.Tae),d.initialize()}he(){F.ULS.sendTraceTag(542500377,3016,50,"PullQuotesTriggerManager.ts - deinitialize");for(const d of this.oqa)d.he(),d.NFa(this.Tae)}xfp(){return this.I_b.getAnnotations().then(d=>{let n=0;try{for(const B of d){if(!B)return F.ULS.shipAssertTag(542500379,3016,!1),n;if(B.annotationType!==Lt.PullQuoteAnnotation.getTypeName())return F.ULS.shipAssertTag(542500380,3016,!1),n;const Q=B.content;if(!Q)return F.ULS.shipAssertTag(542500381,3016,!1),n;
if(0<Q.confidence){const ha=B.parent;if(!ha)return F.ULS.sendTraceTag(512239202,3016,50,"Paragraph node is null."),n;const Aa=this.Qn.YD(ha);if(!Aa||27===Aa.role||Aa.joa)continue;let bb=bf.ParagraphReader.text(ha);if(!bb)return F.ULS.shipAssertTag(512323934,3016,!1),n;const Ib=Q.range.start,oc=Q.range.length;F.ULS.sendTraceTag(538730699,3016,50,"PQ annotation info: {0}",{["annStart"]:Ib,["annLength"]:oc,["orgTextLength"]:bb.length,["paragraphLength"]:bf.ParagraphReader.textLength(ha)});0<oc&&(bb=
bb.substr(Ib,oc));const Ac=Math.floor(Math.random()*Ul.a.MOj),ad=Jh.a.create();F.ULS.sendTraceTag(541446497,3016,50,"Detected pull quote info: {0}",{["suggestionId"]:ad,["confidence"]:Q.confidence,["textLength"]:bb.length,["paragraphLength"]:bf.ParagraphReader.textLength(ha),["paragraphRole"]:Aa.role});this.Tzf.Dxc({role:27,paragraphNode:ha,placeholder:!1});const sd=this.GR.VCe(new $o.b(new Ym.d(ad,1,this.PH,this.oe,!0,Ac,bb),[ha],Ib,Ib+oc,(wd,yd)=>{if(!yd||1!=yd.length)return F.ULS.shipAssertTag(509744530,
3016,!1,`Wrong paragraph count when applying pull quote ${null===yd||void 0===yd?void 0:yd.length} suggestionId:${ad}`),!1;yd=yd[0];F.ULS.sendTraceTag(541446498,3016,50,"Blue dot clicked, creating pull quote with info: {0}",{["suggestionId"]:ad,["textLength"]:bb.length,["paragraphLength"]:bf.ParagraphReader.textLength(yd),["paragraphRole"]:wd.role,["styleId"]:Ac});wd=[new $o.c(new Ym.d(ad,1,this.PH,this.oe,!0,Ac,bb),yd,Ac,bb,be=>{this.Tzf.Fmd(fn.a.create(be));this.Tzf.Dxc({role:27,paragraphNode:be,
placeholder:!1})})];this.tro.bWd(wd);return!0}));sd&&1!==sd&&n++}}}catch(B){F.ULS.shipAssertTag(542500383,3016,!1,"Exception occurred: {0}",String.format("{0} {1}",B.message,B.stack))}finally{return n}}).catch(()=>{F.ULS.shipAssertTag(542500384,3016,!1);return Promise.resolve(0)})}}Object(D.a)(wk,"PullQuotesTriggerManager",null,[1048]);class Ej{constructor(d,n,B){this.source=d;this.event=n;this.target=B}}Object(D.a)(Ej,"Transition",null,[]);class ih{constructor(){this.d8j=[new Ej(0,0,1),new Ej(1,
0,1),new Ej(1,1,2),new Ej(0,1,3),new Ej(3,2,0),new Ej(1,2,0),new Ej(2,2,0)];this.isInitialized=!1}bOn(d){const n=new Ja.a,B=new Ja.a;n.name=yf.a.R2l;n.int64=d.event;B.name=yf.a.T2l;B.int64=d.target;sb.a(yf.a.S2l,!0,void 0,[n,B])}transition(d,n){if(this.isInitialized&&this.d8j)for(const B of this.d8j)if(B.event===d&&B.source===this.state)return n&&(this.bOn(B),this.state=B.target),!0;return!1}initialize(d){this.isInitialized||(this.state=d,this.isInitialized=!0)}getState(){return this.state}w3d(d){return this.transition(d,
!0)}}Object(D.a)(ih,"DocumentStateMachine",null,[]);var pl=e(1427);class Xl{constructor(d,n){this.N5j=d;this.yee=n}equals(d){return!!d&&this.N5j===d.N5j&&this.yee.length===d.yee.length&&this.yee.every((n,B)=>n===d.yee[B])}}Object(D.a)(Xl,"TemplateContent",null,[]);class Sm{xIp(d){this.UEn=this.YDi(d)}EAn(d){var n;return!(null===(n=this.UEn)||void 0===n?0:n.equals(this.YDi(d)))}YDi(d){var n,B;let Q=0;const ha=[];d=bf.ParagraphReader.ox(d,!0,!0);for(const Aa of d)if(d=Aa)bf.ParagraphReader.P8c(d)&&
ha.push(d.id.toString()),Q+=null!==(B=null===(n=d.characterData)||void 0===n?void 0:n.length)&&void 0!==B?B:0;return new Xl(Q,ha)}}Object(D.a)(Sm,"TemplateContentComparer",null,[]);class Eh{constructor(d,n,B,Q,ha,Aa){this.gh=d;this.view=n;this.wrb=B;this.Dh=Q;this.zjc=ha;this.oe=Aa;this.vd=new dc.a;this.K5j=new Sm;this.b9n=(bb,Ib)=>{this.Dh.Xca(Ib.actionId)&&this.BIg()};this.Vao=(bb,Ib)=>{this.N2i||(this.Tpj(bb,Ib),this.hWd&&this.B4d())};this.Tpj=()=>{if(!this.hWd){let bb=!1;this.$ad()?bb=this.zjc.w3d(2):
1===this.eYa()?this.K5j.EAn(this.view.Fd)&&(bb=this.zjc.w3d(1),hm.UNn(this.oe)):bb=this.zjc.w3d(1);bb&&this.vd.raiseEvent("OnDocumentStateChanged",new pl.a(this.eYa()))}};this.Vxp();this.wrb.TMb(this.Tpj);this.Dh.u8k(this.Vao);this.Dh.V7k(this.b9n)}$ad(){return this.gh.ama(this.view.Fd)}Vxp(){const d=this.$ad()?0:3;this.zjc.initialize(d)}eCi(){switch(this.eYa()){case 0:case 1:return pf.templates;case 2:return pf.templateStyles;default:return pf.main}}BIg(){this.hWd=!0}B4d(){this.hWd=!1;this.zjc.w3d(0)&&
this.ZDp();this.K5j.xIp(this.view.Fd)}ZDp(){this.vd.raiseEvent("OnDocumentStateChanged",new pl.a(this.eYa()))}eYa(){return this.zjc.getState()}UUh(d){this.vd.addHandler("OnDocumentStateChanged",d)}freeze(){this.N2i=!0}kAp(){this.N2i=!1}}Object(D.a)(Eh,"DocumentStateMonitor",null,[1144]);class no extends jc.a{constructor(d,n,B){super(n);this.SZe=!1;this.errorState=d;this.scb=B}get Lva(){return this.scb&&this.SZe?!1:super.Lva}dismiss(){this.scb&&!this.SZe&&(this.SZe=!0,this.ri(!1))}}Object(D.a)(no,
"AErrorStateConditionProcessor",jc.a,[1159,881,478]);class vq extends no{constructor(d){super(of.nonTargetDocument,"DocumentLanguageErrorConditionId",!0);this.Q8b=d;this.UOe=this.n4n.bind(this)}initialize(){super.initialize();void 0===this.Q8b.abd?this.Q8b.G6k(this.UOe):this.l1a()}he(){this.Q8b.tJj(this.UOe);super.he()}l1a(){this.ri(void 0!==this.Q8b.abd&&!this.Q8b.abd)}n4n(){this.l1a();this.Q8b.tJj(this.UOe)}}Object(D.a)(vq,"DocumentLanguageErrorCondition",no,[]);var Qj=e(1385);class Mt extends no{constructor(d){super(of.documentTooLarge,
"DocumentTooLargeErrorConditionId",!1);this.tyb=(n,B)=>{B.data.operationType===Qj.a.getTypeName()&&(B.data.annotation?B.data.annotation.annotationType!==$f.FormattingSuggestionsSummaryAnnotation.getTypeName()?F.ULS.shipAssertTag(570781981,3016,!1):(n=B.data.annotation.content)?this.ri(n.errorCode===$f.ErrorCode.DocumentTooLarge):F.ULS.shipAssertTag(570781982,3016,!1):F.ULS.shipAssertTag(570781980,3016,!1))};this.qoh=d}initialize(){super.initialize();this.qoh.IJ(this.tyb)}he(){super.he();this.qoh.iM(this.tyb)}l1a(){}}
Object(D.a)(Mt,"DocumentTooLargeErrorCondition",no,[]);var Te=e(1417);class Us extends no{constructor(d,n,B){super(of.lowConfidenceDocument,"LowConfidenceErrorConditionId",!0);this.yhh=-1;this.rlb=!1;this.zig=(Q,ha)=>{ha.data.operationType===Qj.a.getTypeName()&&(ha.data.annotation?ha.data.annotation.annotationType!==Te.DocumentRoleDetectionAnnotation.getTypeName()?F.ULS.shipAssertTag(570781977,3016,!1):(Q=ha.data.annotation.content,Q)?Q.errorCode||(this.yhh=Q.isTarget?1:0,this.rlb||this.l1a(),this.ETe.iM(this.zig)):
F.ULS.shipAssertTag(570781978,3016,!1):F.ULS.shipAssertTag(570781976,3016,!1))};this.ETe=d;this.qb=n;this.qk=B}initialize(){super.initialize();this.ETe.IJ(this.zig)}he(){super.he();this.ETe.iM(this.zig)}l1a(){this.rlb=this.qb.ama(this.qk.Fd);this.ri(!this.yhh&&!this.rlb)}}Object(D.a)(Us,"LowConfidenceErrorCondition",no,[]);var Oo=e(1222),lp=e(1223);class oo extends no{constructor(d,n){super(of.multipleAuthorsNotSupported,"MultipleAuthorsErrorConditionId",!1);this.Un=d;this.Reg=n;this.pkh=!1}l1a(){const d=
!Ar.wUg(this.Un,this.Reg);this.ri(d);d&&!this.pkh&&(this.pkh=!0,F.ULS.sendTraceTag(556888910,Oo.a.Peg,lp.a.info,"Coauthoring error satisfied: {{ AmIAlone: {0}, AmITheOnlyCoauthor: {1}, IsWebToWeb: {2} }}",this.Un.Yq,this.Un.iga,this.Un.Wy.gOa))}}Object(D.a)(oo,"MultipleAuthorsErrorCondition",no,[]);class Qp extends no{constructor(d,n){super(of.trackChangesNotSupported,"TrackChangeErrorConditionId",!1);this.Yd=d;this.ZQa=n;this.Juj=()=>{this.l1a()}}initialize(){super.initialize();this.ZQa.oxe("OnTrackChangesStatusUpdatedEventKey",
this.Juj);this.l1a()}he(){super.he();this.ZQa.hIo(this.Juj)}l1a(){this.ri(this.Yd.Zg)}}Object(D.a)(Qp,"TrackChangeErrorCondition",no,[]);class mu{constructor(d){this.vi=!1;this.sCd=of.none;this.KOe=!1;this.i0a=()=>{this.rPg()};this.sa=new dc.a;this.J_=d}initialize(){if(!this.J_.count)F.ULS.shipAssertTag(570781983,3016,!1);else if(!this.vi){for(const d of this.J_)d.initialize(),d.OUd(this.i0a);this.vi=!0;this.rPg()}}he(){if(this.vi){for(const d of this.J_)d.Nxe(this.i0a),d.he();this.vi=!1}}qUh(d){this.sa.addHandler("CurrentErrorStateChangedEventKey",
d)}wIo(d){this.sa.removeHandler("CurrentErrorStateChangedEventKey",d)}get EPb(){return this.sCd}AWj(d){this.sCd!==d&&(this.sCd=d,this.sa.raiseEvent("CurrentErrorStateChangedEventKey",new pl.a(this.sCd)))}l0l(){for(const d of this.J_)d.scb&&d.dismiss()}I7d(){this.KOe=!1;for(const d of this.J_)d.l1a();this.rPg();return this.EPb}dcp(d){return d.scb&&this.KOe&&this.EPb!==d.errorState}rPg(){for(const d of this.J_)if(d.Lva&&!this.dcp(d)){this.AWj(d.errorState);this.KOe=!0;return}this.AWj(of.none)}}Object(D.a)(mu,
"ErrorStateManagerV2",null,[1143,478]);class Vs{constructor(d,n,B,Q,ha,Aa){this.taskPane=d;this.u6=n;this.nqp=B;this.tca=Q;this.AF=ha;this.vE=Aa;this.isInitialized=!1;this.kDc=()=>{this.taskPane.isVisible&&this.nqp.irc&&!this.tca.EPb&&(this.u8j(11===this.taskPane.ns?yf.a.irk:yf.a.lfo),this.kfo=gc.a.We(),window.addEventListener("FGWebSurfaceEvent",this.qfj,!0),this.u6.WJj(this.kDc),this.u6.QJj(this.kDc),this.tca.wIo(this.kDc))};this.qfj=bb=>{var Ib;"d7c04a5a-c5ed-43b1-a927-d2f31717f7ee"===(null===
(Ib=null===bb||void 0===bb?void 0:bb.detail)||void 0===Ib?void 0:Ib.id)&&(bb=gc.a.We()-this.kfo,F.ULS.sendTraceTag(529348737,3016,50,`Pane FRE shown after: ${bb}`));window.removeEventListener("FGWebSurfaceEvent",this.qfj,!0)};this.jtj=()=>{this.u8j(yf.a.x2n);this.AF.aJo(this.jtj)}}initialize(){this.isInitialized||(this.isInitialized=!0,this.u6.gfc(this.kDc),this.u6.ujf(this.kDc),this.tca.qUh(this.kDc),this.AF.wjf(this.jtj))}he(){}u8j(d){this.vE.execute(n=>{n.logActivity(d,null)})}}Object(D.a)(Vs,
"DesignerFirstRunExperienceManager",null,[1142,478]);var Mi=e(142),nu=e(659),kr=e(53),wq=e(229),ag=e(237),Vf=e(75),Gs=e(1074);class yp{get state(){return this._state}constructor(){this._state="pending";this.SJb=new Promise((d,n)=>{this.mV=d;this.gsa=n})}finally(d){return this.SJb.finally(d)}then(d,n){return this.SJb.then(d,n)}catch(d){return this.SJb.catch(d)}resolve(d){this.mV(d);this._state="fulfilled"}reject(d){this.gsa(d);this._state="rejected"}}Symbol.toStringTag;Object(D.a)(yp,"DeferredPromise",
null,[]);var ou=e(1793),gv=e(1707),Gi=e(178),zp=e(1437);const yl=(d,n,B=!0,Q=()=>!0)=>{const ha=new vc.a;ha.set(d);ef.b(ha,Aa=>{(Aa=Aa.currentNode)&&Q(Aa)&&(Aa.setValue(Dd.a.XBb,Gi.a.zBa),Aa.setValue(Dd.a.UBb,Gi.a.zBa),Aa.setValue(Dd.a.VBb,Gi.a.zBa),Aa.setValue(Dd.a.WBb,Gi.a.zBa));return!0});B&&(d.setValue(Dd.a.vb,0),d.setValue(Dd.a.wb,Gi.a.zBa),d.setValue(Dd.a.xb,0),d.setValue(Dd.a.yb,Gi.a.zBa),d.setValue(Dd.a.ib,0),d.setValue(Dd.a.jb,Gi.a.zBa),d.setValue(Dd.a.gb,0),d.setValue(Dd.a.hb,Gi.a.zBa));
ha.set(d);n.vek(ha)},xq=(d,n)=>(null===d||void 0===d?void 0:d.type)===n,Ap=d=>{if(!d.Wd())return!1;d.xd(11);return!0},Ws=d=>{if(!d)return F.ULS.shipAssertTag(528779278,3016,!1),null;if(d=wq.a.instance.zW(d)){const n=new gv.a;n.marginTop=ag.a.instance.Mua(d);n.marginBottom=ag.a.instance.gDa(d);n.marginLeft=ag.a.instance.eP(d);n.marginRight=ag.a.instance.fP(d);n.pageWidth=ag.a.instance.nx(d);n.pageHeight=ag.a.instance.oG(d);n.bEa=ag.a.instance.Lbd(d);return n}F.ULS.shipAssertTag(529008003,3016,!1);
return null},wy=(d,n,B)=>{var Q;const ha=new Yb.DictionaryPropertySet;ha.setValue(oh.a.PZ,d);ha.setValue(oh.a.aQa,!0);ha.setValue(oh.a.$ha,!0);n.Zb(Se.a.nKa,2,ha);d=[];for(B=B.ob.currentSelection.QV(!0);B.moveNext();)(n=null===(Q=B.current)||void 0===Q?void 0:Q.node)&&d.push(n);return d},xy=()=>{var d=bd.a.instance.X6c();d=bf.ParagraphReader.Vn(d,!0,!0);if(!d)return F.ULS.shipAssertTag(527212705,3016,!1),!1;if(BC())return!1;d=Ws(d);if(!d)return!1;var n=ou.a.Vwa[3].z6a,B=ou.a.Vwa[0].y6a,Q=ou.a.Vwa[0].z6a;
if(!(d.pageHeight===ou.a.Vwa[3].y6a&&d.pageWidth===n||d.pageHeight===B&&d.pageWidth===Q))return!1;n=ou.a.V5[0].XJd;B=ou.a.V5[0]._marginLeft;Q=ou.a.V5[0].YJd;return d.marginTop===ou.a.V5[0].ZJd&&d.marginBottom===n&&d.marginLeft===B&&d.marginRight&&Q},BC=()=>{const d=vc.a.kb(Bf.a.Xm.tb.rd);Object($g.a)().bU(d);if(!d.currentNode)return F.ULS.shipAssertTag(527212706,3016,!1),!1;if(!d.CYa(0,n=>n instanceof Gs.a))return!1;d.ue();do{const n=d.currentNode;if(n&&n.ka(Dd.a.QOb,void 0)===yf.a.jJl)return!0}while(d.xl());
return!1},Oh=(d,n)=>{d=bf.ParagraphReader.ox(d,!1,!1);return null===d||void 0===d?void 0:d.toArray().filter(B=>{var Q;const ha=null===(Q=null===B||void 0===B?void 0:B.characterData)||void 0===Q?void 0:Q.trim();return 0!==(null===ha||void 0===ha?void 0:ha.length)&&!(null===n||void 0===n?0:n.find(Aa=>Aa===ha))})},Nt=(d,n,B,Q,ha,Aa,bb,Ib)=>{let oc=B.Ag(d);if(!oc.Ib(14)||!oc.xd(14))return F.ULS.shipAssertTag(524115976,3016,!1),!1;if(!Ap(oc))return F.ULS.shipAssertTag(524115977,3016,!1),!1;n.mA(oc,!1,
!1);n=n.dN(oc);Xn(d,n,Q,ha,Aa,bb,Ib,!0);oc=B.Ag(d);oc.Wd();oc.qh();oc.qh();return!0},ox=(d,n)=>{d=n.Ag(d);Ap(d)?d.xl()&&n.XDi(d).xl()&&(d.CYa(0,B=>xq(B,12)),null!==d&&bf.ParagraphReader.isEmpty(d)&&(d.qh(),d.qh())):F.ULS.shipAssertTag(527462685,3016,!1)},VA=(d,n,B,Q,ha=60)=>{var Aa,bb=bf.ParagraphReader.ox(n,!1,!1);if(bb&&0!==bb.count){n=[];for(const Ib of bb)if(bb=Ib,0===(null===(Aa=null===bb||void 0===bb?void 0:bb.characterData)||void 0===Aa?void 0:Aa.trim().length)&&(n.push(bb),2===n.length))break;
for(const Ib of d)rm(Ib,B,Q,ha);for(const Ib of n)rm(Ib,B,Q,ha)}},rm=(d,n,B,Q=60)=>{n.Dwc(d,0,bf.ParagraphReader.textLength(d),B,Q)},Br=(d,n,B,Q,ha)=>{Q=Q.Ag(d);Q.Ib(14);const Aa=Q.xd(14),bb=new yp;B.F_f(d,0,bf.ParagraphReader.textLength(d),ha,Ib=>{var oc;if(60===Ib){if(!n.read(Aa)){Ib=n.write;a:{switch(ha){case zp.a.CJg:var Ac={type:Me.table};break a;case zp.a.Dhc:Ac={type:Me.complexDecorator};break a}Ac=void 0}Ib.call(n,Aa,Ac)}0!==(null===(oc=null===d||void 0===d?void 0:d.characterData)||void 0===
oc?void 0:oc.trim().length)&&n.pSp(Aa,d)}bb.resolve()});return bb},Xn=(d,n,B,Q,ha,Aa,bb,Ib=!1)=>{var oc;const Ac=d.ZR,ad=B.RIi(d),sd=bb.YD(d);d=bf.ParagraphReader.U5(d);const wd=ge.a.createTextRange(n,0,bf.ParagraphReader.textLength(n));Q.lf(wd,d);B.hYh(n,ad);B=null!==(oc=null===sd||void 0===sd?void 0:sd.role)&&void 0!==oc?oc:1;Ib&&1===B&&(ha=ha.Je(Ac),ha===kr.a.wDb&&(B=2),ha===kr.a.Sxd&&(B=3));1!==B&&(Aa.$la(n,B),bb.prd(n,B,sd.Yrc,!1,sd.Rfd,sd.Eme,sd.listItemPrefix))},Ur=(d,n,B)=>{(d=d.properties)&&
n.hEg(d,B)},On=d=>d?d.replace(/((rgb\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}\s*\))|(#[0-9a-fA-F]{6}))/g,n=>Vf.a.m0d(n)):(F.ULS.shipAssertTag(523104409,3016,!1),d),gq=(d,n)=>{d=n.Ag(d);return Ap(d)?!0:(F.ULS.shipAssertTag(509207309,3016,!1),!1)};class Pu{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){this.Yf=d;this.Wn=n;this.ub=B;this.Nof=Q;this.OT=ha;this.kc=Aa;this.wC=bb;this.Xc=Ib;this.Ir=oc;this.gZf=(Ac,ad,sd,wd,yd)=>null!==ad&&void 0!==ad&&ad.properties?(null===Ac||void 0===Ac?void 0:Ac.property)===oh.a.Iw?(F.ULS.sendTraceTag(524076488,
3016,50,`Image loaded after ${gc.a.We()-sd}`),wd&&this.Gni(ad,wd),yd&&yd(ad),!0):!1:(F.ULS.shipAssertTag(524076485,3016,!1),!1)}fZf(d,n,B,Q=Se.a.o8,ha=Se.a.Elf,Aa,bb){var Ib,oc,Ac,ad;try{if(d&&""!==d){n||F.ULS.shipAssertTag(544011278,3016,!1,"Paragraph is not valid");var sd=String.format('<img src="{0}"/>',d),wd=this.QMl(n,B,ha);if(wd){const yd=null===(Ib=this.ub.ob)||void 0===Ib?void 0:Ib.currentSelection;this.ub.Uc(new Ph.Selection([ge.a.jd(wd,0)],!0));const be=new Yb.DictionaryPropertySet;be.setValue(oh.a.PZ,
sd);be.setValue(oh.a.$ha,!0);G.AFrameworkApplication.va.Zb(Q,2,be);const ye=bf.ParagraphReader.Cg(n,B);null===(oc=this.Ir)||void 0===oc?void 0:oc.c6(0);null===(Ac=this.Ir)||void 0===Ac?void 0:Ac.Q2a();this.ub.Uc(yd);null===(ad=this.Ir)||void 0===ad?void 0:ad.JVa();const Qe=Pu.f$d(ye);if(bb||Aa){const af=gc.a.We();Pu.fTh(Qe,Qf=>this.gZf(Qf,Qe,af,Aa,bb))}return Qe}F.ULS.shipAssertTag(545814281,3016,!1,"Unsuccessful node creation")}else F.ULS.shipAssertTag(545814280,3016,!1,"Invalid image URL")}catch(yd){F.ULS.shipAssertTag(545814282,
3016,!1,String.format("{0} {1}",yd.message,yd.stack))}}Gni(d,n){const B=null===d||void 0===d?void 0:d.properties;if(B)if(n){var Q=this.wC.Vc(15,n.uee);try{Q.KB.Eb(this.Xc.Fd),n.$od&&this.uOo(d,n.$od),n.altText&&this.OT.d2a(B,n.altText)}finally{Q.dispose()}}else F.ULS.shipAssertTag(523572621,3016,!1);else F.ULS.shipAssertTag(523572620,3016,!1)}QMl(d,n,B){B=this.wC.Vc(15,B,!1);try{B.KB.Eb(this.Xc.Fd);const Q=this.Wn.Ag(d);if(!Q.Wd())return null;bg.a.xe(Q);this.Yf.mA(Q,n,!1,void 0,void 0,!1);const ha=
new nu.a,Aa=this.kc.pG(d);Aa&&(ha.Cqa=Aa.Qg(kr.a.L5b));return this.Yf.dN(Q,ha)}finally{B.dispose()}}O3d(d){return null!=this.Wn.Ag(d).CYa(0,n=>Cj.a.wVb(n.properties))?!0:!!Pu.f$d(d)}Zpl(d,n,B){if(0>=B)F.ULS.shipAssertTag(545367367,3016,!1,String.format("Aspect ratio:{0} must be bigger than 0",B));else{var Q=d/n;if(B>Q)return n=Math.floor((n-d/B)/n*5E4),{width:d,height:d/B,mLa:n,jLa:n};if(B<Q)return d=Math.floor((d-n*B)/d*5E4),{width:n*B,height:n,kLa:d,lLa:d}}}zql(d,n,B,Q){let ha={width:d,height:n};
Q.Axf&&(d=this.Zpl(d,n,Q.Axf),ha={...ha,...d},d=ha.width,n=ha.height);if(0===Q.C3b&&B)return ha.width=2*Mi.a.kD(B.pageWidth-B.marginLeft-B.marginRight)-.08,ha.height=ha.width/d*n,ha;if(1===Q.C3b&&B)return ha.width=2*Mi.a.kD(B.pageWidth),ha.height=ha.width/d*n,ha.SVi=-B.marginLeft,ha;if(2===Q.C3b&&0<Q.g1h&&0<Q.c1h)return B=Math.min(1*Q.g1h/d,1*Q.c1h/n),ha.width=d*B,ha.height=n*B,ha;-1!==Q.C3b&&F.ULS.shipAssertTag(524105118,3016,!1,"Couldn't stretch image for stretchType {0}",Q.C3b);return ha}bel(d,
n){var B,Q,ha,Aa,bb,Ib;const oc=d.properties;this.Nof.kQa(oc,n.width);this.Nof.jQa(oc,n.height);n.SVi&&(null===(B=d.Rb)||void 0===B?0:B.paragraph)&&R.a.dbb.lQa(null===(Q=d.Rb)||void 0===Q?void 0:Q.paragraph,1,n.SVi);(n.mLa||n.jLa||n.kLa||n.lLa)&&this.OT.fDg(oc,null!==(ha=n.mLa)&&void 0!==ha?ha:0,null!==(Aa=n.jLa)&&void 0!==Aa?Aa:0,null!==(bb=n.kLa)&&void 0!==bb?bb:0,null!==(Ib=n.lLa)&&void 0!==Ib?Ib:0)}uOo(d,n){var B;if(d){var Q=d.properties;if(Q){var ha=Cj.a.uH(Q);Q=Cj.a.pN(Q);if(0>=ha)F.ULS.shipAssertTag(545814284,
3016,!1,String.format("Image width:{0} must be bigger than 0",ha));else if(0>=Q)F.ULS.shipAssertTag(545814285,3016,!1,String.format("Image height:{0} must be bigger than 0",Q));else{var Aa=Ws(null===(B=d.Rb)||void 0===B?void 0:B.paragraph);n=this.zql(ha,Q,Aa,n);this.bel(d,n)}}else F.ULS.shipAssertTag(545814283,3016,!1,"Image properties should not be null")}else F.ULS.shipAssertTag(539772548,3016,!1,"Image blob should not be null")}Wxc(d,n){this.Nof.KIj(n,d);d=this.Wn.Ag(n);bf.ParagraphReader.isEmpty(d)&&
this.Yf.hxa(d.currentNode)}static f$d(d){var n;const B=(null===d||void 0===d?0:d.ra)?d.ra.length:0;for(let Q=0;Q<B;Q++){const ha=d.ra.jc(Q);if(5==(null===(n=ha.blob)||void 0===n?void 0:n.xi))return ha.blob}return null}static fTh(d,n){const B=(Q,ha)=>{n(ha)&&(d.properties.remove_propertyChanged(B),d.properties.tJo(B))};d.properties.add_propertyChanged(B);d.properties.J8k(B)}static yLo(d){if(!d)return F.ULS.shipAssertTag(538996813,3016,!1),[d,!1];const n=/src="([\w\W]+?)"/g;let B,Q=d,ha=!1;for(;null!==
(B=n.exec(d));)Q=Q.replace(B[1],Rm.a.kh(B[1])),ha=!0;return[Q,ha]}}Object(D.a)(Pu,"DesignerImageManagerImpl",null,[1140]);var gn=e(1691),Yn=e(1401);class dh{constructor(d,n,B,Q){this.Qn=d;this.f4b=n;this.Xc=B;this.kc=Q;this.isInitialized=!1;this.yCc=new Map;this.Zjd=new Map;this.vd=new dc.a;this.Buj=(ha,Aa)=>{var bb;Aa.data.operationType===Qj.a.getTypeName()&&(Aa.data.annotation?(ha=this.VKm(Aa.data.annotation.parentPath),ha.id&&ha.text?Aa.data.annotation.annotationType!==gn.TextToImageAnnotation.getTypeName()?
F.ULS.shipAssertTag(526424277,3016,!1):(Aa=Aa.data.annotation.content)?null!==(bb=Aa.images)&&void 0!==bb&&bb.length?this.yCc.set(ha.text,{jW:Aa.images,baseUrl:Aa.baseUrl}):F.ULS.shipAssertTag(526424279,3016,!1):F.ULS.shipAssertTag(526424278,3016,!1):F.ULS.shipAssertTag(521184640,3016,!1),this.vd.raiseEvent("OnImagesChanged",ha.id)):(F.ULS.shipAssertTag(526424276,3016,!1),this.vd.raiseEvent("OnImagesChanged",null)))}}initialize(){this.isInitialized||(this.isInitialized=!0,this.f4b.register(),this.f4b.IJ(this.Buj))}he(){this.isInitialized&&
(this.isInitialized=!1,this.f4b.iM(this.Buj),this.f4b.unregister())}JLj(){const d=this.oSf();return d?this.$0b([{id:d.id.toString(),text:d.characterData}]):!0}$0b(d){d=d.filter(n=>{const B=n.id;n=n.text;return n?this.yCc.has(n)?(this.Zjd.get(B)!==n&&this.Zjd.set(B,n),this.vd.raiseEvent("OnImagesChanged",B),!1):!0:(F.ULS.sendTraceTag(512267554,3016,50,""===n?"DesignerTextToImageManager.RequestImages - paragraphText is empty":"DesignerTextToImageManager.RequestImages - paragraphText is null"),this.vd.raiseEvent("OnImagesChanged",
B),!1)});if(!d.length)return!0;d.forEach(n=>{this.Zjd.set(n.id,n.text);this.yCc.set(n.text,null)});this.LXo(d);return!1}rjf(d){this.vd.addHandler("OnImagesChanged",d)}OJj(d){this.vd.removeHandler("OnImagesChanged",d)}oSf(){var d;const n=bf.ParagraphReader.Vn(this.Xc.Fd);return null===n||void 0===n||!n.characterData||n.DI?null:2===(null===(d=this.Qn.YD(n))||void 0===d?void 0:d.role)||this.Qn.p3f(n)&&this.kc.Je(this.kc.Lr(n))===kr.a.wDb?n:null}GBm(){return bf.ParagraphReader.ox(this.Xc.Fd,!1,!1,!1).toArray().filter(d=>
{var n;const B=null===(n=this.Qn.YD(d))||void 0===n?void 0:n.role;return Object(Yn.b)(B)||this.Qn.p3f(d)&&this.kc.Je(this.kc.Lr(d))===kr.a.wordStyleIdHeader?!0:!1})}QCm(){return this.yCc.get(this.yCc.keys().next().value)}getImages(d){d=this.Zjd.get(d);return this.yCc.get(d)}LXo(d){d=d.map(n=>({id:n.id,body:new gn.TextToImageSignal({content:n.text})}));this.f4b.R5l(d,gn.TextToImageSignal.getTypeName())}VKm(d){let n="";d&&(d=d.split("\\",3),3<=d.length&&(n=d[2]));d=this.Zjd.get(n);return{id:n,text:d}}}
Object(D.a)(dh,"DesignerTextToImageManagerImpl",null,[1139]);class gx{constructor(d){this.sa=new dc.a;this.Gdh=this.Hth=this.vi=!1;this.Rw=d}get apn(){return this.Hth}get lZh(){return this.Gdh}M6k(d){this.sa.addHandler("LicenseStateChanged",d)}j6k(d){this.sa.addHandler("PQLicenseStateChanged",d)}rIo(d){this.sa.removeHandler("PQLicenseStateChanged",d)}initialize(){this.vi||(this.Rw.execute(d=>{d.isFeatureEnabled(yf.a.JFf,yf.a.hbj).then(n=>{n?d.getFeatureTier(yf.a.JFf,0).then(B=>{B=[Object.assign(new Ja.a,
{name:"tier",int64:B})];sb.a(yf.a.ePp,!0,0,B)}):sb.a(yf.a.gPp);this.Zdk(n);return null});d.dxa(yf.a.JFf,n=>{this.Zdk(n.isEnabled)});d.isFeatureEnabled(yf.a.yCj,yf.a.hbj).then(n=>{this.fdk(n);return null});d.dxa(yf.a.yCj,n=>{this.fdk(n.isEnabled)})}),this.vi=!0)}he(){}Zdk(d){this.Hth=d;this.sa.raiseEvent("LicenseStateChanged",new pl.a(d))}fdk(d){this.Gdh=d;this.sa.raiseEvent("PQLicenseStateChanged",new pl.a(d))}}Object(D.a)(gx,"LicenseManager",null,[1138,478]);class NG{constructor(d,n){this.gh=d;this.Xc=
n}initialize(){const d=this.gh.ama(this.Xc.Fd);F.ULS.sendTraceTag(541701569,3016,50,`isDocumentEmpty=${d}`)}he(){}}Object(D.a)(NG,"BlankDocumentLogger",null,[1137]);class zJ{constructor(d,n,B){this.J4=d;this.vua=n;this.u6=B;this.Zgf=!1;this.Hdb=null;this.gha=0;this.Swe=!1;this.phg=(Q,ha)=>{try{if(ha.data.operationType===Qj.a.getTypeName()){if(!this.Swe){const Aa=[Object.assign(new Ja.a,{name:yf.a.Htg,string:"PaneInconsistencies"})];sb.a(yf.a.Gtg,!0,Date.now()-this.gha,Aa);this.Swe=!0}if(this.Hdb){let Aa;
(Aa=this.Hdb).interval=Aa.interval+yf.a.jai}else this.Zgf||(this.Hdb=new tb.a(3,1,yf.a.jai,()=>{this.Fle();this.Hdb=null}),ib.TaskManager.instance.pc(this.Hdb))}}catch(Aa){F.ULS.shipAssertTag(575930784,3016,!1,String.format("{0} {1}",Aa.message,Aa.stack))}};this.Nse=(Q,ha)=>{ha.data&&this.gha&&sb.a(yf.a.mfo,!0,Date.now()-this.gha)}}initialize(){this.gha=Date.now();this.Swe=!1;this.J4.IJ(this.phg);this.u6.ujf(this.Nse)}he(){this.J4.iM(this.phg);this.u6.QJj(this.Nse);this.Swe=!0;this.gha=0}Fle(){try{this.Zgf||
this.vua.getAnnotations().then(d=>{F.ULS.sendTraceTag(575930781,3016,50,"Consistency fix actions: {0}",d.count);sb.a(yf.a.crk,!0,void 0,[Object.assign(new Ja.a,{name:"FormattingSuggestionsCount",int64:d.count})]);const n={};for(const B of d){d=B.content;for(const Q of d.suggestions)n[Q.type.toString()]=Q.type.toString()in n?n[Q.type.toString()]+1:1}F.ULS.sendTraceTag(575930782,3016,50,"Consistency fix actions: {0} ",JSON.stringify(n));this.Zgf=!0;this.Hdb=null;this.J4.iM(this.phg)})}catch(d){F.ULS.shipAssertTag(575930783,
3016,!1,String.format("{0} {1}",d.message,d.stack))}}}Object(D.a)(zJ,"ConsistencyFixActionsLogger",null,[1136,478]);class sl{constructor(d){this.gN=d;this.okh=this.vi=!1;this.myb=(n,B)=>{B.data.operationType===Qj.a.getTypeName()&&(B.data.annotation?B.data.annotation.annotationType!==Te.DocumentRoleDetectionAnnotation.getTypeName()?F.ULS.shipAssertTag(544035804,3016,!1):(n=B.data.annotation.content,n)?n.errorCode||(F.ULS.sendTraceTag(575248462,3016,50,"Document confidence: {0}",n.isTarget?1:0),F.ULS.sendTraceTag(544012318,
3016,50,"Is well-formatted document: {0}",n.isWellFormatted?1:0),n=[Object.assign(new Ja.a,{name:yf.a.I2l,double:n.isTarget?1:0}),Object.assign(new Ja.a,{name:yf.a.J2l,double:n.isWellFormatted?1:0})],sb.a(yf.a.H2l,!0,void 0,n),this.okh=!0,this.he()):F.ULS.shipAssertTag(544035805,3016,!1):F.ULS.shipAssertTag(544035803,3016,!1))}}initialize(){this.vi||this.okh||(this.gN.IJ(this.myb),this.vi=!0)}he(){this.vi&&(this.gN.iM(this.myb),this.vi=!1)}}Object(D.a)(sl,"DocumentRoleDetectionLogger",null,[1135,
478]);class px{constructor(d=null,n,B){this.PH=d;this.tSg=n;this.oe=B;this.J1d=0}fNn(){0===this.oe.mqg()&&this.PH&&0<this.J1d&&(this.PH.execute(d=>{for(let n=0;n<Math.min(this.J1d,yf.a.mSn);n++)d.logActivity(yf.a.lqg,null)}),this.J1d=0)}Cnd(){0===this.oe.mqg()?this.J1d++:this.PH&&this.PH.execute(d=>{this.tSg.setTimeout(()=>{d.logActivity(yf.a.lqg,null);2===this.oe.mqg()&&d.logActivity(yf.a.lqg,null)},yf.a.joo)})}}Object(D.a)(px,"ProactiveSurveyEventLogger",null,[1134]);var HJ=e(1784),Ez=e(1367),qx=
e(2102),po=e(34),IJ=e(125),JJ=e(726),rx=e(1706),Yv=e(135);class Vr extends Ez.a{constructor(d,n,B,Q){super();this.fra=d;this.xo=n;this.LTe=B;this.Rkh=Q;this.Zuk=[yf.a.Mnf,yf.a.Nnf]}get Fha(){return this.fra.isEnabled()}get Cub(){return 3}get Kbb(){return null!=this.V0g?this.V0g:this.V0g=[new qx.a(po.a.Ohk,null),new qx.a(po.a.xSg,null)]}$Oa(d,n){const B=this.Yt.pLa;var Q=this.Yt.ced;if(B)if(3===B.type){if(B.XN&&(Q=B.XN,this.A7h(Q.QWc),1===B.action&&Q.Ju.includes(d))){d=n.Yh.querySelectorAll("*");for(let ha=
0,Aa=d.length;ha<Aa;ha++)this.Rkh(d[ha],po.a.xSg);return}(Q=B.ZD)&&Q.Ju.includes(d)&&(Q.Ju[0]===d&&this.vZo(Q.QWc,B.action),this.TAb(n.Yh,B.action,d))}else Q&&3===Q.type&&3===B.action&&Q.ZD.Ju.includes(d)&&this.TAb(n.Yh,0,d)}g_a(d){return Object(zk.a)(rx.a,d)}fbb(d,n){(d=Object(Uf.a)(rx.a,d))&&d.Ju.forEach(B=>{n.add(B)})}TAb(d,n,B){if(2===n||!n){d=d.querySelectorAll("*");n=2===n?po.a.Ohk:po.a.xSg;for(let Q=0,ha=d.length;Q<ha;Q++){const Aa=d[Q];1===JJ.a(Aa)&&this.Pvl(B,Aa)&&this.LTe(Aa,n)}}}Pvl(d,
n){var B=this.xo.u6c(ge.a.create(d),1);if(!B||!B.count)return!0;d=B.K(0).Mc;B=B.K(0).end;const Q=Yv.a.Mb(n,IJ.a.oCa);n=Yv.a.Mb(n,IJ.a.Yxb);return Math.max(d,Q)<Math.min(B,n)}vZo(d,n){switch(n){case 4:case 1:case 3:this.A7h(d);break;case 0:this.LTe(d,yf.a.Nnf);break;case 2:this.LTe(d,yf.a.Mnf)}}A7h(d){for(const n of this.Zuk)this.Rkh(d,n)}}Object(D.a)(Vr,"HighlightActor",Ez.a,[]);var UG=e(1055);class yy{constructor(d,n){this.Z4e=this.Dxh=this.hS=null;this.qb=d;this.oba=n}get key(){return"DESIGNER REVIEW"}get hx(){return WacWordeditorStrings.DesignerReview}reset(d){this.qb.lc(d.node)?
this.hS=d.node:this.hS=null}NGa(){let d=null;if(!this.hS)return{returnValue:!1,vI:d};if(this.Dxh!==this.hS){const n=this.oba.YD(this.hS);this.Z4e=n.joa?n:null;this.Dxh=this.hS}if(!this.Z4e)return{returnValue:!1,vI:d};d=Object.assign(new UG.a,{NH:this.key,contentObject:this.Z4e,description:Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress});return{returnValue:!0,vI:d}}}Object(D.a)(yy,"ReviewDetailsProvider",null,[376,377]);class WA{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.ODa=d;this.Yt=n;
this.aNa=B;this.n0h=Q;this.pNj=ha;this.Pgf=Aa;this.gh=bb;this.Qn=Ib}initialize(){this.Yt.xfb(this.aNa);this.ODa.LPa(this.n0h);this.pNj.initialize();this.Pgf.execute(d=>{d.SW(new yy(this.gh,this.Qn))})}he(){this.Yt.HOg(this.aNa);this.ODa.dIe(this.n0h);this.pNj.he()}}Object(D.a)(WA,"OnCanvasInitializer",null,[478]);class VG{constructor(d,n,B){this.vi=!1;this.V9=(Q,ha)=>{if(ha&&ha.Pn&&ha.Pn.currentSelection&&ha.Pn.currentSelection.Ya&&ha.Pn.currentSelection.Ya.node){Q=ha.Pn.currentSelection;var Aa=Q.Ya.node;
1!==ha.aB&&ha.aB||!Lj.a.qn(Q)||!this.JRk.Kcd(Aa)?this.Beh.cyl():this.Beh.u1o(Aa)}};this.Beh=d;this.pb=n;this.JRk=B}initialize(){this.vi||(this.pb.BD(this.V9),this.vi=!0)}he(){}}Object(D.a)(VG,"ReviewSelectionManager",null,[478]);var qt=e(91),XA=e(203),Wr=e(326);const sx=d=>0>d.indexOf(",")?XA.a.iVc(d,XA.a.$Ba(d)):d,HE=d=>{d=XA.a.N9d(d).returnValue;return d.startsWith("'")||d.startsWith('"')?d.slice(1,-1):d},CC=[WordRibbonStrings.DesignerStyleFontAvenirNextDemiBold,WordRibbonStrings.DesignerStyleFontAvenir,
WordRibbonStrings.DesignerStyleFontCentury,WordRibbonStrings.DesignerStyleFontSitka,WordRibbonStrings.DesignerStyleFontWalbaum,WordRibbonStrings.DesignerStyleFontRockwellNova,WordRibbonStrings.DesignerStyleFontUnivers,WordRibbonStrings.DesignerStyleFontSagonaBook,WordRibbonStrings.DesignerStyleFontSagona,WordRibbonStrings.DesignerStyleFontFranklin,WordRibbonStrings.DesignerStyleFontPerpetua,WordRibbonStrings.DesignerStyleFontAmasisMTPro,WordRibbonStrings.DesignerStyleFontSabonNextLT,WordRibbonStrings.DesignerStyleFontTradeGothicNext,
WordRibbonStrings.DesignerStyleFontCooperBlack,WordRibbonStrings.DesignerStyleFontNeueHaasGroteskTextPro,WordRibbonStrings.DesignerStyleFontTisaOffcSerifPro,WordRibbonStrings.DesignerStyleFontQuireSans,WordRibbonStrings.DesignerStyleFontGillSansNova,WordRibbonStrings.DesignerStyleFontTheHand,WordRibbonStrings.DesignerStyleFontGoudyType,WordRibbonStrings.DesignerStyleFontPlantagenetCherokee,WordRibbonStrings.DesignerStyleFontFootlightMTLight,WordRibbonStrings.DesignerStyleFontBaskervilleOldFace,WordRibbonStrings.DesignerStyleFontLucidaCalligraphy,
WordRibbonStrings.DesignerStyleFontEbrima,WordRibbonStrings.DesignerStyleFontCorbel,WordRibbonStrings.DesignerStyleFontElephantPro,WordRibbonStrings.DesignerStyleFontDaytona,WordRibbonStrings.DesignerStyleFontBierstadt,WordRibbonStrings.DesignerStyleFontSitkaBanner,WordRibbonStrings.DesignerStyleFontGrandview,WordRibbonStrings.DesignerStyleFontSkeenaDisplay,WordRibbonStrings.DesignerStyleFontTenorite,WordRibbonStrings.DesignerStyleFontGadugi,WordRibbonStrings.DesignerStyleFontSeaford,WordRibbonStrings.DesignerStyleFontWalbaumDisplay,
WordRibbonStrings.DesignerStyleFontAgencyFB,WordRibbonStrings.DesignerStyleFontAharoni,WordRibbonStrings.DesignerStyleFontArial,WordRibbonStrings.DesignerStyleFontArialNova,WordRibbonStrings.DesignerStyleFontArialNovaBold,WordRibbonStrings.DesignerStyleFontArialNovaCondBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProDemi,WordRibbonStrings.DesignerStyleFontBaguetScript,WordRibbonStrings.DesignerStyleFontBaguetScriptRegular,WordRibbonStrings.DesignerStyleFontBahnschrifr,
WordRibbonStrings.DesignerStyleFontBahnschrift,WordRibbonStrings.DesignerStyleFontBierstadtRegular,WordRibbonStrings.DesignerStyleFontBiome,WordRibbonStrings.DesignerStyleFontBodoniMT,WordRibbonStrings.DesignerStyleFontBritannic,WordRibbonStrings.DesignerStyleFontCalibri,WordRibbonStrings.DesignerStyleFontCalistoMT,WordRibbonStrings.DesignerStyleFontCavolini,WordRibbonStrings.DesignerStyleFontDubai,WordRibbonStrings.DesignerStyleFontElephantProRegular,WordRibbonStrings.DesignerStyleFontErasBoldITC,
WordRibbonStrings.DesignerStyleFontGeorgia,WordRibbonStrings.DesignerStyleFontGeorgiaPro,WordRibbonStrings.DesignerStyleFontJumble,WordRibbonStrings.DesignerStyleFontMVBoli,WordRibbonStrings.DesignerStyleFontNewsGothicMT,WordRibbonStrings.DesignerStyleFontPerpetuaBoldItalic,WordRibbonStrings.DesignerStyleFontPerpetuaItalic,WordRibbonStrings.DesignerStyleFontRastantyCortez,WordRibbonStrings.DesignerStyleFontSegoe,WordRibbonStrings.DesignerStyleFontSegoeScript,WordRibbonStrings.DesignerStyleFontSegoeUI,
WordRibbonStrings.DesignerStyleFontSegoeUIBold,WordRibbonStrings.DesignerStyleFontSitkaHeading,WordRibbonStrings.DesignerStyleFontSitkaText,WordRibbonStrings.DesignerStyleFontTenoriteBold,WordRibbonStrings.DesignerStyleFontTenoriteRegular,WordRibbonStrings.DesignerStyleFontTradeGothic,WordRibbonStrings.DesignerStyleFontTradeGothicInline,WordRibbonStrings.DesignerStyleFontVijaya,WordRibbonStrings.DesignerStyleFontWideLatin,WordRibbonStrings.DesignerStyleFontNordiqueInlineRegular];class IE{constructor(d,
n){this.Qs=d;this.title=n}}Object(D.a)(IE,"TriageOption",null,[]);class tx extends IE{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){super(d,n);this.fontSize=Q;this.color=ha;this.bold=Aa;this.italic=bb;this.underline=Ib;this.backgroundImg=oc;this.font=sx(B)}}Object(D.a)(tx,"FormattedRangeTriageOption",IE,[]);class Aw extends tx{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){super(0,n,B,Q,ha,Aa,bb,Ib,oc);this.role=d}}Object(D.a)(Aw,"RoleTriageOption",tx,[]);class zy extends tx{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){super(1,
n,B,Q,ha,Aa,bb,Ib,oc);this.ifb=d}}Object(D.a)(zy,"PullQuoteTriageOption",tx,[]);class JE extends IE{constructor(d,n,B){super(2,void 0);this.imageUrl=d;this.altText=n;this.dva=B}}Object(D.a)(JE,"ImageTriageOption",IE,[]);class Ot{constructor(d,n,B,Q){this.mwc=d;this.Rfo=n;this.kc=B;this.oe=Q}HJm(d){if(!d)return F.ULS.shipAssertTag(574424853,3016,!1),this.fMf(1,WacWordeditorStrings.OriginalOptionTitle);let n=null;return({e1j:n}=this.Rfo.pHe(d.id)).returnValue?new Aw(1,WacWordeditorStrings.OriginalOptionTitle,
this.mwc.getPropertyValue(n,xd.a.font,qt.a.zL),Math.min(this.cvf(this.mwc.getPropertyValue(n,xd.a.fontSize,yf.a.Zyf)),Ot.BSn),Vf.a.zB(this.mwc.getPropertyValue(n,xd.a.fontColor,Vf.a.$qb.vib)),this.mwc.getPropertyValue(n,xd.a.bold,!1),this.mwc.getPropertyValue(n,xd.a.italic,!1),this.mwc.getPropertyValue(n,xd.a.underline,!1),null):(F.ULS.sendTraceTag(512276631,3016,50,"No formatting information for paragraph. Showing Title style in the triage menu."),this.fMf(1,WacWordeditorStrings.OriginalOptionTitle))}ZVm(d,
n){const B=this.kc.Il(),Q=B.Qg(Yn.j(d));if(!Q){if(14===d&&this.oe.vva()&&(F.ULS.sendTraceTag(541446534,3018,15,"No Caption style in the document."),n=this.WVm(B.Qg(Yn.j(13)),n),null!=n))return n;F.ULS.shipAssertTag(574424855,3016,!1);return this.fMf(d)}return new Aw(d,Q.ka(Ya.a.L0a,Yn.k(d)),Q.ka(xd.a.font,qt.a.zL),n,Vf.a.zB(Q.ka(xd.a.fontColor,Vf.a.$qb.vib)),Q.ka(xd.a.bold,!1),Q.ka(xd.a.italic,!1),Q.ka(xd.a.underline,!1),null)}YVm(d,n){let B=qt.a.zL,Q=Vf.a.zB(Vf.a.$qb.vib),ha=!1,Aa="";switch(d){case 0:Q=
"#201f1e";Aa="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="175" height="42" rx="2" fill="none"/><line x1="5" y1="4" x2="169" y2="4.00001" stroke="#EA6B14" stroke-width="2"/></svg>');break;case 1:Q="#ffffff";B="Helvetica Neue";ha=!0;Aa="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="4" width="160" height="37" fill="#5066DB"/><path d="M151 24V28.3178H152.859C152.859 29.0093 152.727 29.5981 152.464 30.0841C152.202 30.5514 151.713 30.9065 151 31.1495V33C151.582 32.9252 152.117 32.757 152.605 32.4953C153.112 32.215 153.544 31.8692 153.901 31.4579C154.257 31.0467 154.53 30.5701 154.717 30.028C154.924 29.486 155.018 28.9065 154.999 28.2897V24H151ZM156.999 14V28.3178H158.857C158.857 29.0093 158.726 29.5981 158.463 30.0841C158.2 30.5514 157.712 30.9065 156.999 31.1495V33C157.581 32.9252 158.116 32.757 158.604 32.4953C159.111 32.215 159.543 31.8692 159.899 31.4579C160.256 31.0467 160.528 30.5701 160.716 30.028C160.923 29.486 161.016 28.9065 160.998 28.2897V24H156.999Z" fill="white"/><rect x="5.6" y="0.6" width="158.8" height="35.8" stroke="black" stroke-width="1.2"/></svg>');
break;case 2:Q="#007fac";B="SF Pro Display";Aa="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="3" width="162" height="34" fill="#EAEFF6"/><path d="M162 37H168V3H6V37H87H107.25H147.5" stroke="#007FAC" stroke-width="2"/><path d="M155.998 33V37.3178H157.857C157.857 38.0093 157.726 38.5888 157.463 39.0561C157.2 39.5421 156.712 39.9065 155.998 40.1495V42C156.58 41.9252 157.125 41.7477 157.632 41.4673C158.12 41.2056 158.542 40.8692 158.899 40.4579C159.256 40.0467 159.537 39.5701 159.744 39.028C159.932 38.486 160.016 37.9065 159.997 37.2897V33H155.998ZM150 33V37.3178H151.859C151.859 38.0093 151.727 38.5888 151.464 39.0561C151.202 39.5421 150.713 39.9065 150 40.1495V42C150.582 41.9252 151.126 41.7477 151.633 41.4673C152.122 41.2056 152.544 40.8692 152.901 40.4579C153.257 40.0467 153.539 39.5701 153.746 39.028C153.933 38.486 154.018 37.9065 153.999 37.2897V33H150Z" fill="#007FAC"/></svg>');
break;case 3:Q="#3865a8";B="Avenir";Aa="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><svg x="0" y="2"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0C5.89543 0 5 0.895431 5 2V25C5 36.1046 5.89543 37 7 37H83.0061C83.1025 37.2646 83.2556 37.5127 83.4655 37.7252L85.8929 40.1821C86.6692 40.9679 87.9278 40.9679 88.7041 40.1821L91.1314 37.7252C91.3413 37.5127 91.4945 37.2646 91.5909 37H167C168.105 37 169 36.1046 169 35V2C169 0.895431 168.105 0 167 0H7Z" fill="#E9EBF4"/></svg></svg>');
break;case 4:Q="#201f1e",Aa="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="3" width="2" height="6" fill="#548235"/><rect x="5" y="5" width="2" height="6" transform="rotate(-90 5 5)" fill="#548235"/><rect x="-5" y="29" width="2" height="6" transform="rotate(-90 5 29)" fill="#548235"/><rect x="7" y="19" width="2" height="6" transform="rotate(180 7 29)" fill="#548235"/><rect x="169" y="19" width="2" height="6" transform="rotate(-180 169 29)" fill="#548235"/><rect x="179" y="27" width="2" height="6" transform="rotate(90 169 27)" fill="#548235"/><rect x="169" y="3" width="2" height="6" transform="rotate(90 169 3)" fill="#548235"/><rect x="167" y="3" width="2" height="6" fill="#548235"/></svg>')}return new zy(d,
n,B,this.cvf(yf.a.Zyf),Q,ha,!1,!1,Aa)}XVm(d,n){return new JE(null===d||void 0===d?void 0:d.kSf(n),null===d||void 0===d?void 0:d.z1(n),n)}fMf(d,n=null){return new Aw(d,n||Yn.k(d),qt.a.zL,this.cvf(yf.a.Zyf),Vf.a.zB(Vf.a.$qb.vib),!1,!1,!1,null)}WVm(d,n){return null==d?null:new Aw(14,Yn.k(14),d.ka(xd.a.font,qt.a.zL),n,Vf.a.zB(d.ka(xd.a.fontColor,Vf.a.$qb.vib)),!1,!0,!1,null)}cvf(d){return d/2}}Ot.BSn=25;Object(D.a)(Ot,"TriageOptionFactory",null,[1133]);class Bw{constructor(d,n){this.options=d;this.selectedIndex=
n}}Object(D.a)(Bw,"TriageOptions",null,[]);class us{constructor(d,n,B,Q){this.Qn=d;this.bHe=n;this.oe=B;this.jM=Q}BJm(d){var n;if(!d)return F.ULS.shipAssertTag(574424851,3016,!1),null;const B=null===(n=this.jM.fZ(d))||void 0===n?void 0:n.suggestion;n=this.Qn.YD(d);return Object(Ym.e)(B)?this.TNm(B):2===(null===B||void 0===B?void 0:B.Qs)?this.MCm(B):this.Xvm(d,n)}Xvm(d,n){const B=us.$Vm(n.role,this.oe.vva()),Q=Array(B.count-9+Math.max(3,this.Qn.qWf+1)+1);Q[us.original]=this.bHe.HJm(d);d=us.original;
let ha=1;for(let Aa=0;Aa<B.count;Aa++){const bb=B.K(Aa);if(this.qap(bb)){ha--;continue}const Ib=Aa+ha;bb.role===n.role&&(d=Ib);Q[Ib]=this.bHe.ZVm(bb.role,bb.additionalInfo)}return new Bw(Q,d)}TNm(d){const n=us.UNm();let B,Q=us.original;B=Array(n.count);for(let ha=0;ha<n.count;ha++){const Aa=n.K(ha);Aa.additionalInfo==d.ifb&&(Q=ha);B[ha]=this.bHe.YVm(Aa.additionalInfo,d.Jld)}return new Bw(B,Q)}MCm(d){let n;n=Array(d.EBc);for(let B=0;B<d.EBc;B++)n[B]=this.bHe.XVm(d,B);return new Bw(n,d.selectedIndex)}qQm(d,
n){var B;if(!d)return F.ULS.shipAssertTag(572301728,3016,!1),us.original;if(!n)return F.ULS.shipAssertTag(572301729,3016,!1),us.original;const Q=null===(B=this.jM.fZ(n))||void 0===B?void 0:B.suggestion;if(Object(Ym.e)(Q))return Q.ifb;if(2===(null===Q||void 0===Q?void 0:Q.Qs))return Q.selectedIndex;if(0===(null===Q||void 0===Q?void 0:Q.Qs))for(n=this.Qn.YD(n),B=0;B<d.length;B++)if(0!==d[B].Qs)F.ULS.shipAssertTag(527569926,3016,!1,`${d[B].Qs}`);else if(d[B].role===n.role)return B;return us.original}qap(d){return 6<
d.role&&12>=d.role&&4+this.Qn.qWf<d.role}static $Vm(d,n=!1){const B=new ma.a;B.add({role:13,additionalInfo:12});B.add({role:4,additionalInfo:19});B.add({role:5,additionalInfo:18});B.add({role:6,additionalInfo:17});B.add({role:7,additionalInfo:16});B.add({role:8,additionalInfo:15});B.add({role:9,additionalInfo:14});B.add({role:10,additionalInfo:13});B.add({role:11,additionalInfo:12});B.add({role:12,additionalInfo:12});B.add({role:2,additionalInfo:25});B.add({role:3,additionalInfo:19});n&&B.insert(us.Osl,
{role:14,additionalInfo:11});15===d&&B.insert(us.yHn,{role:15,additionalInfo:12});return B}static UNm(){const d=new ma.a;d.add({role:27,additionalInfo:0});d.add({role:27,additionalInfo:1});d.add({role:27,additionalInfo:2});d.add({role:27,additionalInfo:3});d.add({role:27,additionalInfo:4});return d}}us.original=0;us.Osl=1;us.yHn=4;Object(D.a)(us,"TriageOptionProvider",null,[1132]);class Fz extends jc.a{constructor(d){super("FormattingSuggestionsReadyConditionId");this.gN=d;this.Oig=(n,B)=>{B.data.operationType===
Qj.a.getTypeName()&&B.data.annotation&&B.data.annotation.annotationType===$f.FormattingSuggestionsSummaryAnnotation.getTypeName()&&(n=B.data.annotation.content)&&!n.errorCode&&(this.ri(!0),this.gN.iM(this.Oig))}}initialize(){super.initialize();this.gN.IJ(this.Oig)}he(){this.gN.iM(this.Oig);super.he()}}Object(D.a)(Fz,"FormattingSuggestionsReadyCondition",jc.a,[]);class YA extends jc.a{constructor(d){super("RoleDetectionReadyCondition");this.gN=d;this.ykg=(n,B)=>{B.data.operationType===Qj.a.getTypeName()&&
B.data.annotation&&B.data.annotation.annotationType===Te.DocumentRoleDetectionAnnotation.getTypeName()&&(n=B.data.annotation.content)&&!n.errorCode&&(this.ri(!0),this.gN.iM(this.ykg))}}initialize(){super.initialize();this.gN.IJ(this.ykg)}he(){this.gN.iM(this.ykg);super.he()}}Object(D.a)(YA,"RoleDetectionReadyCondition",jc.a,[]);class Ay extends jc.a{constructor(d){super("ThemeGeneratorReadyCondition");this.x6=d;this.Zkg=(n,B)=>{B.data.operationType===Qj.a.getTypeName()&&B.data.annotation&&B.data.annotation.annotationType===
ij.ThemeGeneratorAnnotation.getTypeName()&&B.data.annotation.content&&(this.ri(!0),this.x6.iM(this.Zkg))}}initialize(){super.initialize();this.x6.IJ(this.Zkg)}he(){this.x6.iM(this.Zkg);super.he()}}Object(D.a)(Ay,"ThemeGeneratorReadyCondition",jc.a,[]);var ux=e(243);class KE{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){this.xv=d;this.HLa=n;this.u6=B;this.tca=Q;this.focusManager=ha;this.s5j=Aa;this.qOg=bb;this.oZc=Ib;this.x_a=oc;this.koo=Ac;this.lId=this.Vw=this.vi=!1;this.Qnb=0;this.ero=(ad,sd)=>{sd?sd.data?
this.Cwd(sd.data):F.ULS.shipAssertTag(556373976,3016,!1):F.ULS.shipAssertTag(556373975,3016,!1)};this.Tmd=()=>{this.Pxa(!0);this.lId||this.ZW();this.xv.Ne()};this.Smd=()=>{this.oZc.Fle();this.oZc.he();this.koo.fNn();this.Pxa(!1);this.qja();this.xv.Ne();sb.c(dd.a.Uzl,void 0,void 0,void 0,12)}}get isVisible(){return this.Vw}get ns(){return this.Qnb}Pxa(d){d!==this.Vw&&(this.Vw=d,this.u6.Iuo(this.Vw))}show(d=0){this.isVisible?this.ZW():(this.u6.Guo(),this.initialize(),this.tca.I7d(),this.lId=!!d,this.Qnb=
d,this.Tsd())}hide(){this.qOg().then(d=>{d.hideTaskPane(yf.a.zU,yf.a.taskPaneLocation);return null})}initialize(){this.vi||(this.HLa.K8k(this.ero),this.CY(),this.qea(),this.vi=!0)}CY(){this.s5j.iLa();this.s5j.zPb(this.focusManager)}qea(){const d=this.focusManager.te(yf.a.zU);d.parent=ux.AFrame.rr;d.bindAction(gm.KeyInputManager.Jy(Box4Intl.Box4Strings.l_HK_Undo),Se.a.undo);d.bindAction(gm.KeyInputManager.Jy(Box4Intl.Box4Strings.l_HK_Redo),Se.a.Xia)}ZW(){this.focusManager.Rg(yf.a.zU)}qja(){this.focusManager.Rg(ux.AFrame.Co)}Tsd(){const d=
this.HLa.Lca();d.isPaneAutoOpened=this.lId;d.ns=this.Qnb;this.qOg().then(n=>{n.showTaskPane(yf.a.zU,this.AB(d));return null})}Cwd(d){this.isVisible&&this.qOg().then(n=>{n.updateTaskPane(yf.a.zU,this.AB(d));return null})}AB(d){return Object.assign(new pk.a,{title:this.x_a.apn?WacWordeditorStrings.Designer:String.format("{0} ({1})",WacWordeditorStrings.Designer,WacWordeditorStrings.Preview),hideHeader:!1,width:yf.a.taskPaneWidth,location:yf.a.taskPaneLocation,contentProps:d,onOpen:this.Tmd,onClose:this.Smd,
enableResize:!1,isModernPane:!0,isPaneAutoOpened:this.lId,ns:this.Qnb})}}Object(D.a)(KE,"DesignerTaskPane",null,[1130]);class DC{constructor(){this.sa=new dc.a}gfc(d){this.sa.addHandler("OnVisibilityChanged",d)}WJj(d){this.sa.removeHandler("OnVisibilityChanged",d)}ujf(d){this.sa.addHandler("OnLoadingStateChanged",d)}QJj(d){this.sa.removeHandler("OnLoadingStateChanged",d)}JUh(d){this.sa.addHandler("OnBeforeOpen",d)}Iuo(d){this.sa.raiseEvent("OnVisibilityChanged",new pl.a(d))}Huo(d){this.sa.raiseEvent("OnLoadingStateChanged",
new pl.a(d))}Guo(){this.sa.raiseEvent("OnBeforeOpen",new Sys.EventArgs)}}Object(D.a)(DC,"DesignerTaskPaneEvents",null,[1128,1129]);class ZA{constructor(d,n){this.u6=d;this.conditions=n;this.yHb=this.isInitialized=!1;this.i0a=()=>{this.A6h()}}initialize(){if(0==this.conditions.count)F.ULS.shipAssertTag(556619356,3016,!1);else if(!this.isInitialized){for(const d of this.conditions)d.initialize(),d.OUd(this.i0a);this.isInitialized=!0;this.A6h()}}he(){if(this.isInitialized){for(const d of this.conditions)d.Nxe(this.i0a),
d.he();this.isInitialized=!1}}get irc(){return this.yHb}KWj(d){this.yHb!==d&&(this.yHb=d,this.u6.Huo(this.yHb))}A6h(){for(const d of this.conditions)if(!d.Lva){this.KWj(!1);return}this.KWj(!0)}}Object(D.a)(ZA,"PaneLoadingManager",null,[1127]);class $A{constructor(d,n){this.Bi=!1;this.gGk=d;this.KB=n}dispose(){var d;this.Bi||(this.KB.dispose(),null===(d=this.gGk)||void 0===d?void 0:d.dispose(),this.Bi=!0)}}Object(D.a)($A,"DesignerTransaction",null,[1150,11]);class EC{constructor(d,n){this.Zc=d;this.oba=
n}Vc(d,n,B=!0){d=this.Zc.Vc(d);d.Bh=n;return new $A(B?this.oba.QMo():null,d)}}Object(D.a)(EC,"DesignerTransactionFactory",null,[1126]);class WG{constructor(d,n){this.RTd=d;this.nld=n}trigger(d,n){n?(F.ULS.sendTraceTag(554742742,3016,50,`DesignerProactiveTriggerManager.triggerDesigner - shouldStart=${n.zja}`),n.zja&&this.nld.Qmf(1,()=>{this.RTd.Zb(dd.a.WQa,2,new Yo.a(n.id))})):F.ULS.shipAssertTag(521172809,3016,!1)}}Object(D.a)(WG,"OpenDesignerPaneTriggerAction",null,[1131]);class FC{constructor(d,
n,B){this.ZTd=d;this.ohf=n;this.ns=B}}Object(D.a)(FC,"TeachingCalloutButtonEventAction",null,[]);class Zv{constructor(d,n,...B){this.vE=d;this.mLg=n;this.H8j=Q=>{for(const ha of this.x2h)(null===Q||void 0===Q?void 0:Q.type)===ha.ZTd&&ha.ohf&&(F.ULS.sendTraceTag(520127499,3016,50,`TeachingCalloutTriggerAction.triggerTeachingActivityEventAction - buttonAction=${ha.ohf}`),sb.a(ha.ZTd),ha.ohf.trigger(this,{id:ha.ns,zja:!0}),window.removeEventListener(ha.ZTd,this.H8j,!0))};if(B){this.x2h=B;for(const Q of this.x2h)window.addEventListener(Q.ZTd,
this.H8j,!0)}}trigger(d,n){n?(F.ULS.sendTraceTag(521172628,3016,50,`TeachingCalloutTriggerAction.trigger - shouldStart=${n.zja}`),n.zja&&this.vE&&this.mLg&&(sb.a(this.mLg),this.vE.execute(B=>{B.logActivity(this.mLg,null)}))):F.ULS.shipAssertTag(521172808,3016,!1)}}Object(D.a)(Zv,"TeachingCalloutTriggerAction",null,[1131]);class aB extends ee.a{constructor(d,n,B,Q){super(d,n,B,3016,"OnTriggerImageSuggestionEventKey");this.pMj=Q}XTb(d){super.XTb(d);super.Ekf()&&super.YTb(this.pMj)}YTb(d){super.YTb(d);
this.$Fa(!1);super.YTb(this.pMj)}$Fa(d=!0){var n;super.$Fa(d&&!(null===(n=this.xsa)||void 0===n?0:n.vea()))}}Object(D.a)(aB,"AutoResetSequentialTriggerModel",ee.a,[]);class hv extends jc.a{constructor(d){super(yf.a.N2d);this.zI=d}initialize(){super.initialize();this.$Wh=this.zI.Zk(19,()=>{this.ri(!0)})}he(){this.$Wh&&this.$Wh.pqa(!0);this.IGa&&G.AFrameworkApplication.zc.Kf(this.IGa);super.he()}}Object(D.a)(hv,"DesignerAfterApplicationBootCondition",jc.a,[]);class LE extends jc.a{constructor(d){super(yf.a.XXl);
this.Rii=d}initialize(){super.initialize();0<=this.Rii&&(this.IGa=new tb.a(2,1,1E3*this.Rii,()=>{this.ri(!0)}),G.AFrameworkApplication.zc.pc(this.IGa))}he(){this.IGa&&G.AFrameworkApplication.zc.Kf(this.IGa);super.he()}}Object(D.a)(LE,"DesignerDelayCondition",jc.a,[]);class ME extends yn{constructor(d,n,B){super(yf.a.bYl);this.fp=d;this.Eui=n;this.fki=B;this.I5=()=>{this.fp.h4()&&(this.ri(this.fp.Xad(this.Eui)===this.fki),this.fp.R0b(this.I5))}}initialize(){super.initialize();this.fp.h4()?this.ri(this.fp.Xad(this.Eui)===
this.fki):this.fp.efc(this.I5)}he(){this.fp.R0b(this.I5);super.he()}}Object(D.a)(ME,"DesignerFlagsSettingCondition",yn,[]);var UL=e(1002);class GC extends jc.a{constructor(){super(yf.a.U_l)}initialize(){super.initialize();Object(UL.a)().then(d=>{this.ri(!d)}).catch(()=>{this.ri(!0)})}}Object(D.a)(GC,"DisabledCopilotCondition",jc.a,[]);var KJ=e(1583);class LJ extends Sys.EventArgs{constructor(d){super();this.documentType=d}}Object(D.a)(LJ,"DocumentTypeObtainedEventArgs",Sys.EventArgs,[]);class Eo{constructor(){this.vd=
new dc.a}o7k(d){this.vd.addHandler("DocumentTypeObtainedEventId",d)}SIo(d){this.vd.removeHandler("DocumentTypeObtainedEventId",d)}huo(d){this.vd.raiseEvent("DocumentTypeObtainedEventId",d)}}Object(D.a)(Eo,"DocumentTypeEventSource",null,[]);class Cw extends yn{constructor(d,n,B,Q,ha,Aa=null){super(yf.a.Emi);this.ns=d;this.pca=n;this.I3d=B;this.fSp=Q;this.aqp=ha;this.N6f=null;this.jdd=this.isInitialized=!1;this.ryb=(bb,Ib)=>{if(Ib.data.operationType===Qj.a.getTypeName()||Ib.data.operationType===kj.o.getTypeName())Ib.data.annotation?
Ib.data.annotation.annotationType!==pb.DocumentTypeClassifierAnnotation.getTypeName()?F.ULS.shipAssertTag(573907533,3016,!1):(bb=Ib.data.annotation.content)?bb.documentTypeConfidences.length?(this.N6f=this.Zq(),bb=bb.documentTypeConfidences[0].documentTypeLabel,this.jdd=Array.contains(this.aqp,bb),this.I3d.huo(new LJ(bb)),this.jdd&&!this.Lva&&F.ULS.sendTraceTag(561309448,3016,50,this.d1(this.ns,!0)),this.ri(this.jdd)):F.ULS.shipAssertTag(573907535,3016,!1):F.ULS.shipAssertTag(573907534,3016,!1):F.ULS.shipAssertTag(573907532,
3016,!1)};this.Zq=Aa?Aa:()=>new Date}get shouldExecuteWorkflow(){return!this.N6f||+this.Zq()-+this.N6f>this.fSp}initialize(){super.initialize();this.isInitialized||(this.pca.IJ(this.ryb),this.pca.register(),this.isInitialized=!0);this.shouldExecuteWorkflow?(this.pca.GCa(new KJ.a),F.ULS.sendTraceTag(509874258,3016,50,"DocumentTypeClassifierSignal emitted by the DocumentTypeCondition.")):(this.jdd&&F.ULS.sendTraceTag(561109203,3016,50,this.d1(this.ns,!0)),this.ri(this.jdd))}he(){this.isInitialized&&
(this.pca.iM(this.ryb),this.isInitialized=!1);super.he()}}Object(D.a)(Cw,"DocumentTypeCondition",yn,[]);var rt;(function(d){d.hpk="E_Spelling_Grammar";d.wok="E_Refinements";d.AutoCorrect="E_AutoCorrect";d.Upk="E_TextPrediction";d.nFc="E_Similarity"})(rt||(rt={}));Object(D.b)("EditorAcceptSignalType",rt);class Pn{}Pn.O5h="CharacterTyped";Pn.Ywj="ParagraphAdded";Pn.exj="ParagraphDeleted";Pn.p7d="FontFormattingChangesCount";Pn.wordCount="WordCount";Pn.KW="ParagraphCount";Pn.zxf="Spelling;Grammar;Acronyms;Clarity;Conciseness;Formality;Inclusiveness;Perspectives;Punctuation Conventions;Sensitive Geopolitical References;Vocabulary;Uncommon Words".split(";");
Pn.Pjc=[rt.AutoCorrect,rt.wok,rt.nFc,rt.hpk,rt.Upk];Object(D.a)(Pn,"SignalIds",null,[]);class XG extends jc.a{constructor(d,n,B,Q,ha=null){super(yf.a.xjm);this.ns=d;this.uBb=n;this.xIf=B;this.Ggd=Q;this.fvc=(Aa,bb)=>{Aa=this.uBb.qCi();bb.wE===Pn.p7d&&(bb=Aa.values[Pn.p7d],Aa=(bb-1)%this.Ggd,this.wIf[Aa]=this.Zq(),bb<this.Ggd||+this.wIf[Aa]-+this.wIf[bb%this.Ggd]>this.xIf||(F.ULS.sendTraceTag(561309447,3016,50,this.d1(this.ns,!0)),this.uBb.xwg(this.fvc),this.ri(!0)))};this.Zq=ha?ha:()=>new Date;this.wIf=
Array(Q)}initialize(){super.initialize();this.uBb.TUh(this.fvc)}he(){this.uBb.xwg(this.fvc);super.he()}}Object(D.a)(XG,"FormattingActionsCondition",jc.a,[]);class Dw extends jc.a{constructor(d,n,B){super(yf.a.zjm);this.ns=d;this.Tb=n;this.oe=B;this.sca=new Set;this.d8a=0;this.A_d=1}initialize(){super.initialize();this.wYf();this.Tb.WZ(this)}he(){this.Tb.M4b(this);super.he()}H5(){}F5(d){2===d.behavior&&this.sca.has(d.actionId)&&(this.d8a+=1,this.d8a===this.A_d&&(F.ULS.sendTraceTag(523351776,3016,50,
this.d1(this.ns,!0)),this.ri(!0)))}wYf(){switch(this.oe.J3d()){case 2:this.sca.add(Se.a.font);this.A_d=1;break;case 3:this.sca.add(Se.a.FQ);this.A_d=1;break;case 4:this.sca.add(Se.a.font),this.sca.add(Se.a.tE),this.sca.add(Se.a.V4),this.sca.add(Se.a.m6),this.sca.add(Se.a.dG),this.sca.add(Se.a.bold),this.sca.add(Se.a.cC),this.sca.add(Se.a.underline),this.sca.add(Se.a.strikethrough),this.sca.add(Se.a.O2),this.sca.add(Se.a.hea),this.sca.add(Se.a.Uy),this.sca.add(Se.a.Ixa),this.A_d=3}}}Object(D.a)(Dw,
"FormattingChangeCondition",jc.a,[113]);class MJ extends yn{constructor(d,n,B){super(yf.a.nwi);this.ns=d;this.J4=n;this.Rbg=B;this.isInitialized=!1;this.syb=(Q,ha)=>{ha.data.operationType===Qj.a.getTypeName()&&(ha.data.annotation?ha.data.annotation.annotationType!==$f.FormattingSuggestionsSummaryAnnotation.getTypeName()?(F.ULS.shipAssertTag(574912652,3016,!1),this.ri(!1)):(Q=ha.data.annotation.content)?Q.errorCode?this.ri(!1):((Q=Q.numberOfSuggestions>=this.Rbg)&&!this.Lva&&F.ULS.sendTraceTag(561309445,
3016,50,this.d1(this.ns,!0)),this.ri(Q)):(F.ULS.shipAssertTag(574912653,3016,!1),this.ri(!1)):(F.ULS.shipAssertTag(574912651,3016,!1),this.ri(!1)))}}initialize(){super.initialize();this.isInitialized||(this.J4.IJ(this.syb),this.J4.register(),this.isInitialized=!0)}he(){this.isInitialized&&(this.J4.unregister(),this.J4.iM(this.syb),this.isInitialized=!1);super.he()}}Object(D.a)(MJ,"FormattingSuggestionsCondition",yn,[]);class NJ extends jc.a{constructor(d,n,B){super(yf.a.Hfo);this.ns=d;this.uBb=n;
this.Sbg=B;this.fvc=(Q,ha)=>{Q=this.uBb.qCi();ha.wE===Pn.KW&&((ha=Q.values[Pn.KW]>=this.Sbg)&&!this.Lva&&F.ULS.sendTraceTag(561309446,3016,50,this.d1(this.ns,!0)),this.ri(ha))}}initialize(){super.initialize();this.uBb.TUh(this.fvc)}he(){this.uBb.xwg(this.fvc);super.he()}}Object(D.a)(NJ,"ParagraphCountCondition",jc.a,[]);class YG extends yn{constructor(d,n,B){super(yf.a.VNj);this.ns=d;this.gN=n;this.MUn=B;this.Bmi=this.umi=this.isInitialized=!1;this.myb=(Q,ha)=>{ha.data.operationType===Qj.a.getTypeName()&&
(ha.data.annotation?ha.data.annotation.annotationType!==Te.DocumentRoleDetectionAnnotation.getTypeName()?(F.ULS.shipAssertTag(555812322,3016,!1),this.ri(!1)):(ha=ha.data.annotation.content)?ha.errorCode?this.ri(!1):((Q=ha.isTarget)&&!this.umi&&F.ULS.sendTraceTag(561309451,3016,50,this.d1(this.ns,!0,"subCondition=DocumentConfidenceCondition")),this.umi=Q,(ha=ha.supportedLanguagesCoverage>this.MUn)&&!this.Bmi&&F.ULS.sendTraceTag(555812353,3016,50,this.d1(this.ns,!0,"subCondition=DocumentLanguageCondition")),
this.Bmi=ha,(Q=Q&&ha)&&!this.Lva&&F.ULS.sendTraceTag(555812354,3016,50,this.d1(this.ns,!0)),this.ri(Q)):(F.ULS.shipAssertTag(555812323,3016,!1),this.ri(!1)):(F.ULS.shipAssertTag(555812321,3016,!1),this.ri(!1)))}}initialize(){super.initialize();this.isInitialized||(this.gN.IJ(this.myb),this.gN.register(),this.isInitialized=!0)}he(){this.isInitialized&&(this.gN.unregister(),this.gN.iM(this.myb),this.isInitialized=!1);super.he()}}Object(D.a)(YG,"RoleDetectionCondition",yn,[]);class mp extends yn{constructor(d,
n,B){super(yf.a.l6j);this.ns=d;this.x6=n;this.kGe=B;this.vi=!1;this.Hre=()=>{F.ULS.sendTraceTag(541385729,3016,50,this.d1(this.ns,!0));this.ri(!0)}}initialize(){super.initialize();this.vi||(this.x6.register(),this.kGe.ZUd(this.Hre),this.kGe.initialize(),this.vi=!0)}he(){this.vi&&(this.kGe.VJj(this.Hre),this.kGe.he(),this.x6.unregister(),this.vi=!1);super.he()}}Object(D.a)(mp,"ThemesLoadedCondition",yn,[]);class Gz{constructor(d,n,B){this.oqa=d;this.Onp=n;this.cHe=B;this.vi=!1;this.q8j=(Q,ha)=>{this.cHe&&
this.cHe.trigger(Q,ha);this.he()}}initialize(){F.ULS.sendTraceTag(554742740,3016,50,`DesignerProactiveTriggerManager.initialize - isInitialized=${this.vi}`);if(!this.vi){this.Onp.initialize();for(const d of this.oqa)d.Qsa(this.q8j),d.initialize();this.vi=!0}}he(){F.ULS.sendTraceTag(554742741,3016,50,`DesignerProactiveTriggerManager.deinitialize - isInitialized=${this.vi}`);if(this.vi){for(const d of this.oqa)d.he(),d.NFa(this.q8j);this.vi=!1}}}Object(D.a)(Gz,"DesignerProactiveTriggerManager",null,
[1048,478]);class Ki extends ee.a{constructor(d,n,B,Q=null,ha=null){super(d,n,B,3016,"OnTriggerDesigner");this.tio=ha;this.VOk=Q}XTb(d){var n;super.XTb(d);null===(n=this.tio)||void 0===n?void 0:n.XTb(d)}YTb(d){Array.contains(Ki.oUk,d)?(F.ULS.sendTraceTag(546137305,3016,50,`DesignerSequentialTriggerModel.handleConditionUnsatisfied - conditionId=${d}`),this.$Fa(!1)):super.YTb(d)}$Fa(d=!0){var n,B;super.$Fa(d&&!(null===(n=this.xsa)||void 0===n?0:n.vea())&&!(null===(B=this.VOk)||void 0===B?0:B.vea()))}}
Ki.oUk=[yf.a.VNj,yf.a.Emi,yf.a.nwi,yf.a.umj,yf.a.Ami,yf.a.X5j,yf.a.l6j];Object(D.a)(Ki,"DesignerSequentialTriggerModel",ee.a,[]);class By{constructor(d,n,B){this.Bjj=d;this.alp=n;this.Plp=B}XTb(d){d===this.alp&&(this.startTime=gc.a.We());d===this.Plp&&this.startTime&&(d=gc.a.We()-this.startTime,F.ULS.sendTraceTag(512492310,3016,50,`${this.Bjj} { elapsedTime: ${d} ms }`))}}Object(D.a)(By,"DesignerTriggerModelPerformanceMeter",null,[]);class Rp{constructor(d,n,B){this.lzk=d;this.kmh=n;this.VBk=B}initialize(){}vea(){return this.VBk?
this.lzk.isVisible?(F.ULS.sendTraceTag(555771225,3016,50,"Auto launch suppressed: pane already visible"),!0):this.kmh.I7d()?(F.ULS.sendTraceTag(555771226,3016,50,"Auto launch suppressed: errorState {0}",this.kmh.EPb),!0):!1:(F.ULS.sendTraceTag(508952729,3016,50,"Auto launch suppressed: flight is disabled"),!0)}w2(){}}Object(D.a)(Rp,"HeuristicSuppressionModel",null,[922]);class Xs{constructor(d){this.QEh=d;this.initialize()}initialize(){this.F0e=void 0;this.QEh.ezn(zp.a.$ji).then(d=>{this.F0e=d})}vea(){if(void 0===
this.F0e)return F.ULS.sendTraceTag(521199813,3016,50,"Auto launch suppressed: No results from intelligence"),!0;if(this.F0e)return F.ULS.sendTraceTag(521199812,3016,50,"Auto launch suppressed: pane was already opened for this document"),!0;this.QEh.Gio(zp.a.$ji);return!1}w2(){}}Object(D.a)(Xs,"PersistenceSuppressionModel",null,[922]);class vx{constructor(d){this.nqg=d}initialize(){F.ULS.sendTraceTag(554742739,3016,50,"ProactiveTriggerDeinitializer.initialize");this.nqg.he()}he(){}}Object(D.a)(vx,
"ProactiveTriggerDeinitializer",null,[478]);class HC{constructor(d,n,B){this.nfk=d;this.nld=n;this.nqg=B}initialize(){F.ULS.sendTraceTag(554742738,3016,50,"ProactiveTriggerInitializer.initialize");this.nfk.initialize();this.nld.CGj(this.nfk);this.nqg.initialize()}he(){}}Object(D.a)(HC,"ProactiveTriggerInitializer",null,[478]);var Uj=e(623);class ZG{constructor(d,n,B=null){this.GSa=new Uj.a;this.bbf=!1;this.ZFb=this.gJb=null;this.Opj=(Q,ha)=>{ha.data?(this.gJb=this.TG(),this.bbf=!1):(this.gJb=this.ZFb=
null,this.$1c())};this.ga=d;this.bDd=n;this.TG=B?B:()=>new Date}initialize(){this.bDd.gfc(this.Opj);this.ga.WZ(this);this.wYf()}he(){this.bDd.WJj(this.Opj);this.ga.M4b(this)}get id(){return 1}get Qvc(){return this.gJb}get n2c(){return this.ZFb}H5(){}F5(d){2===d.behavior&&this.GSa.contains(d.actionId)&&(this.ZFb=this.TG(),this.$1c())}$1c(){this.bbf||(this.bbf=!0)}wYf(){this.GSa.add(Se.a.y8a);this.GSa.add(dd.a.X6d);this.GSa.add(dd.a.Szf);this.GSa.add(Se.a.kob);this.GSa.add(dd.a.Ind);this.GSa.add(dd.a.DTd);
this.GSa.add(dd.a.pxe);this.GSa.add(dd.a.Epb);this.GSa.add(dd.a.kRa)}}Object(D.a)(ZG,"UserEngagementMonitor",null,[113,1125,478,929]);class $G extends jc.a{constructor(d){super("DocumentOwnerConditionId");this.ns=d}initialize(){super.initialize();const d=G.AFrameworkApplication.J.$("IsDocumentOwner");F.ULS.sendTraceTag(521430743,3016,50,this.d1(this.ns,d,d&&!this.Lva?"The owner of the document has changed":""));this.ri(d)}he(){super.he()}}Object(D.a)($G,"DocumentOwnerCondition",jc.a,[]);class aH extends jc.a{constructor(d,
n){super("ProactiveV2AllowedBySettingsConditionId");this.fp=d;this.ns=n;this.I5=()=>{if(this.fp.h4()){var B=this.fp.ata()&&this.fp.c6i();F.ULS.sendTraceTag(521446609,3016,50,this.d1(this.ns,B));this.ri(B)}else F.ULS.shipAssertTag(521446610,3016,!1)}}initialize(){super.initialize();this.fp.h4()?this.ri(this.fp.ata()&&this.fp.c6i()):this.fp.efc(this.I5)}he(){this.fp.R0b(this.I5);super.he()}}Object(D.a)(aH,"ProactiveV2AllowedBySettingsCondition",jc.a,[]);class Sp{constructor(d,n,B,Q,ha,Aa){this.oe=d;
this.J4=n;this.RTd=B;this.nld=Q;this.tca=ha;this.$Xl=Aa;this.isInitialized=!1;this.tyb=(bb,Ib)=>{Ib.data.operationType===Qj.a.getTypeName()&&(Ib.data.annotation?Ib.data.annotation.annotationType!==$f.FormattingSuggestionsSummaryAnnotation.getTypeName()?F.ULS.shipAssertTag(521446622,3016,!1):(bb=Ib.data.annotation.content)?this.tca.I7d()?(F.ULS.sendTraceTag(521446620,3016,50,`Auto launch suppressed by errorState ${this.tca.EPb}`),this.he()):(F.ULS.sendTraceTag(521446619,3016,50,"Other conditions for the opening of the panel have been satisfied, check numberOfSuggestions = {0}",
bb.numberOfSuggestions),!bb.errorCode&&bb.numberOfSuggestions>=this.oe.moo()?(this.nld.Qmf(1,()=>{this.RTd.Zb(dd.a.WQa,2,new Yo.a(11))}),F.ULS.sendTraceTag(521446618,3016,50,"All conditions have been met. Open Designer")):this.he()):F.ULS.shipAssertTag(521446621,3016,!1):F.ULS.shipAssertTag(521446623,3016,!1))}}initialize(){this.isInitialized||(this.tca.I7d()?F.ULS.sendTraceTag(521446626,3016,50,`ProactiveSuggestionsChecker - initialize supressed by errorState ${this.tca.EPb}`):(F.ULS.sendTraceTag(521446625,
3016,50,"ProactiveSuggestionsChecker - initialize"),this.J4.IJ(this.tyb),this.J4.register(),this.$Xl.initialize(),this.isInitialized=!0))}he(){this.isInitialized&&(F.ULS.sendTraceTag(521446624,3016,50,"ProactiveSuggestionsChecker - deinitialize"),this.J4.unregister(),this.J4.iM(this.tyb),this.isInitialized=!1)}}Object(D.a)(Sp,"ProactiveSuggestionsChecker",null,[478]);class $v{constructor(d,n,B,Q,ha){this.oqa=d;this.Y3j=n;this.Tb=Q;this.fp=ha;this.isInitialized=this.vAf=this.eSg=this.Ugk=!1;this.n2j=
(Aa,bb)=>{F.ULS.sendTraceTag(521446614,3016,50,"ProactiveTriggerManagerV2 startNewChecker");bb.zja?this.Y3j.initialize():this.S2j()};this.Zjg=(Aa,bb)=>{bb.data?(F.ULS.sendTraceTag(521446613,3016,50,"Stop on pane opened"),this.he()):this.Ugk&&(F.ULS.sendTraceTag(521446612,3016,50,"Restart due to AcceptAll from pane"),this.initialize())};B.gfc(this.Zjg);this.Tb.WZ(this)}initialize(){if(!this.isInitialized){this.isInitialized=!0;F.ULS.sendTraceTag(521446617,3016,50,"ProactiveTriggerManagerV2 init");
for(const d of this.oqa)d.Qsa(this.n2j),d.initialize()}}he(){if(this.isInitialized){this.isInitialized=!1;F.ULS.sendTraceTag(521446616,3016,50,"ProactiveTriggerManagerV2 deinit");this.S2j();for(const d of this.oqa)d.he(),d.NFa(this.n2j)}}S2j(){F.ULS.sendTraceTag(521446615,3016,50,"ProactiveTriggerManagerV2 stopActiveChecker");this.Y3j.he()}H5(){}F5(d){if(2===d.behavior)switch(d.actionId){case Se.a.kob:this.eSg=this.Ugk=!0;this.vAf&&this.fp.Ioi();break;case dd.a.WQa:d=d.Ed;!this.eSg&&d&&11===d.id&&
(this.fp.G_l(),this.vAf=!0);break;case Se.a.y8a:case dd.a.DTd:this.eSg=!0,this.vAf&&this.fp.Ioi()}}}Object(D.a)($v,"ProactiveTriggerManagerV2",null,[1048,113]);var np=e(48),VL=e(140);class NE{constructor(d,n,B,Q,ha=null){this.paragraphFormat=d;this.V5j=n;this.textLength=B;this.ose=Q;this.Mgk=ha}}Object(D.a)(NE,"ParagraphFormattingFullSnapshot",null,[]);class Hs{constructor(d,n,B){this.ru=d;this.cpEnd=n;this.qp=B}}Object(D.a)(Hs,"TextRunFormattingFullSnapshot",null,[]);class OE{constructor(d,n,B,Q,
ha,Aa,bb,Ib,oc,Ac,ad){this.ee=d;this.Daa=n;this.Pe=B;this.Ww=Q;this.nMd=ha;this.z0=Aa;this.RWe=bb;this.NQd=Ib;this.Ge=oc;this.zg=ad}azc(d,n=!0){var B;if(d){this.ee.KOa(d);var Q=new ma.a;for(var ha=0;ha<d.ra.length-1;ha++){var Aa=d.ra.jc(ha);Aa.formatting&&Aa.formatting.qp&&Q.add(new Hs(Aa.cp,d.ra.jc(ha+1).cp,Aa.formatting.qp.clone()))}Aa=d.ra.jc(d.ra.length-1);Aa.formatting&&Aa.formatting.qp&&Q.add(new Hs(Aa.cp,Aa.cp,Aa.formatting.qp.clone()));ha=Aa=null;n&&({Zxa:Aa}=this.NQd.pHe(this.Ge.nTb(d)),
ha=null===(B=this.Ge.Lr(d))||void 0===B?void 0:B.id);this.nMd.put(d.id,new NE(d.GC(),Q,bf.ParagraphReader.textLength(d),Aa,ha))}else F.ULS.shipAssertTag(556410145,3016,!1)}P1a(d,n=!0){if(d){var B=null;if(({e1j:B}=this.nMd.pHe(d.id)).returnValue){const ha=d.A8();try{this.Ww.nZd(d);if(B.paragraphFormat&&B.Mgk&&d.ZR&&d.ZR.id===B.Mgk)for(var Q of d.properties.Ak())B.paragraphFormat.hasProperty(Q)||d.ZR.hasProperty(Q)&&d.properties.fg(Q);this.Ww.yYh(d,B.paragraphFormat);this.Daa.X2();let Aa=Q=null;({Jia:Q,
U5j:Aa}=this.JKm(B));this.W3o(d,Q,B);for(const bb of B.V5j)this.B6o(bb,Aa,B),this.Wel(bb,d);this.ee.KOa(d);d.eo();n&&this.nMd.remove(d.id)}finally{ha&&ha.dispose()}}}else F.ULS.shipAssertTag(556410146,3016,!1)}szf(d){d?this.nMd.remove(d.id):F.ULS.shipAssertTag(556410147,3016,!1)}Wel(d,n){var B=n.ra.jc(n.ra.length-1);if(B.cp===d.ru&&d.ru===d.cpEnd)this.Qwp(B,d,n);else for(B=0;B<n.ra.length-1;B++){const Q=n.ra.jc(B),ha=n.ra.jc(B+1);if(Q.cp>=d.ru&&Q.cp<d.cpEnd){let Aa=!1;ha.cp<=d.cpEnd?Aa=!0:F.ULS.sendTraceTag(540652370,
3016,15,"applyTextRunFormattingOnParagraph: textRunFormatting.cpEnd < next.cp");Aa&&Q.formatting&&(this.Pe.ota(Q.formatting),this.Pe.vja(Q.formatting,d.qp))}}}Qwp(d,n,B){var Q;B=ve.a.Qe?B:this.zg.pha(B);let ha=null;if(ve.a.isListItem(B)&&n.qp&&(ha=n.qp.Ak())&&(this.Pe.ota(d.formatting),this.Pe.vja(d.formatting,n.qp),null===(Q=np.a.getInstance())||void 0===Q||!Q.Gv))for(const Aa of ha)B.setValue(Aa,n.qp.Uf(Aa))}JKm(d){const n=new ma.a,B=new ma.a;let Q=null;if(!d.ose||!(Q=d.ose.Ak()))return{Jia:n,U5j:B};
for(d=0;d<Q.length;d++){const ha=Q[d];Nc.a.any(VL.a.JPi(),Aa=>Aa===ha)?n.add(ha):B.add(ha)}return{Jia:n,U5j:B}}W3o(d,n,B){this.z0.zY(this.RWe(d,0,bf.ParagraphReader.textLength(d)),Q=>{for(const ha of n)this.Pe.qm(Q,ha,B.ose.Uf(ha))})}B6o(d,n,B){for(const Q of n)d.qp.hasProperty(Q)||d.qp.setValue(Q,B.ose.Uf(Q))}}Object(D.a)(OE,"RestoreManager",null,[1123]);class aw{constructor(d,n,B){this.BFb=d;this.Qfa=n;this.vSa=B}accept(d,n=!1){return d?aw.tvb(()=>{this.Qfa.crf(d,2,n)}):(F.ULS.shipAssertTag(590434823,
3016,!1),!1)}acceptAll(){const d=this.BFb.Vc(15,Se.a.kob);try{return d.KB.Eb(this.vSa.Fd),aw.tvb(()=>{this.Qfa.iWf(!1,0)})}finally{d&&d.dispose()}}reject(d,n=!1){if(!d)return F.ULS.shipAssertTag(590434824,3016,!1),!1;const B=this.BFb.Vc(15,dd.a.pxe);try{return B.KB.Eb(d),aw.tvb(()=>{this.Qfa.crf(d,3,n)})}finally{B&&B.dispose()}}rejectAll(){const d=this.BFb.Vc(15,dd.a.Ind);try{return d.KB.Eb(this.vSa.Fd),aw.tvb(()=>{this.Qfa.iWf(!0)})}finally{d&&d.dispose()}}MRg(d){if(!d)return F.ULS.shipAssertTag(529106274,
3016,!1),!1;const n=this.BFb.Vc(15,dd.a.Xzf);try{return n.KB.Eb(d),aw.tvb(()=>{this.Qfa.crf(d,.1,!1)})}finally{n&&n.dispose()}}ktd(){const d=this.BFb.Vc(15,dd.a.Vzf);try{return d.KB.Eb(this.vSa.Fd),aw.tvb(()=>{this.Qfa.iWf(!0);this.Qfa.ktd()})}finally{d&&d.dispose()}return!1}Epb(d){if(null===d||void 0===d||!d.paragraphNode)return F.ULS.shipAssertTag(575484486,3016,!1),!1;const n=this.BFb.Vc(15,dd.a.Epb);try{return n.KB.Eb(d.paragraphNode),aw.tvb(()=>{1===d.Qs&&n.KB.sOa(d.g1,1);this.Qfa.Xtl(d)})}finally{n&&
n.dispose()}}kRa(d){if(!d)return F.ULS.shipAssertTag(573850376,3016,!1),!1;const n=this.BFb.Vc(15,dd.a.kRa);try{return n.KB.Eb(d),aw.tvb(()=>{this.Qfa.kRa(d)})}finally{n&&n.dispose()}}static tvb(d){try{return d(),!0}catch(n){return F.ULS.shipAssertTag(572068186,3016,!1,String.format("{0} {1}",n.message,n.stack)),!1}}}Object(D.a)(aw,"ReviewActions",null,[1122]);var bH=e(1561),Pt=e(1695),bw=e(1703),Gn=e(1589);class Mq{constructor(d,n,B,Q,ha,Aa){this.kcf=d;this._state=n;this._description=B;this.IFk=
Q;this.Mtk=ha;this.Vsk=Aa;this.kcf.F_a(this._state)}get suggestion(){return this.kcf}get state(){return this._state}set state(d){d!==this._state&&(this._state=d,this.suggestion.F_a(this._state))}get description(){return this._description}get cvb(){return this.IFk}get eNb(){return this.Mtk}get s9o(){return 0==this.kcf.Qs}get FS(){var d;return null!==(d=this.Vsk)&&void 0!==d?d:[]}}Object(D.a)(Mq,"ReviewIntent",null,[]);class pn{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf=null,hf,
di,vj,Wk,Tm,Dk){this.Tb=d;this.VN=n;this.u6=B;this.Qha=Q;this.DOn=ha;this.dM=Aa;this.gh=bb;this.a6=Ib;this.Iyc=oc;this.AF=Ac;this.jM=ad;this.Qn=sd;this.Yue=wd;this.wC=yd;this.Rda=be;this.eT=ye;this.kkc=Qe;this.YEl=af;this.PH=Qf;this.oe=hf;this.yXf=di;this.fp=vj;this.Iwa=Wk;this.Vd=Tm;this.Xc=Dk;this.ppd=null;this.g2=!1;this.kHj=new Map;this.K9n=(gi,oi)=>{this.Bhc(oi.data.paragraphNode,5)};this.S9n=(gi,oi)=>{this.ppd?this.ppd(oi.data):this.g2&&F.ULS.shipAssertTag(590434837,3016,!1)};this.I5=()=>{this.fp.ata()||
this.g2||this.qZi()};this.kao=(gi,oi)=>{(this.g2=oi.data)&&this.qZi();!oi.data&&0<this.Qn.r1b&&this.Tb.Zb(Se.a.kob,2,new Gn.a(1))};this.wkg=(gi,oi)=>{if(gi=this.jM.fZ(oi.data.paragraphNode))if(oi.data.paragraphNode.que=oi.data.isVisible){if(0==gi.state||.1==gi.state)gi.s9o?this.Fdl(oi.data.paragraphNode,gi):gi.eNb(),F.ULS.sendTraceTag(540676563,3016,50,"Role: {0};",gi.cvb);this.BYd(oi.data.paragraphNode,1);this.ppd&&this.ppd(this.Qn.r1b)}else.1===gi.state?this.AF.ftg(new Pt.a(oi.data.paragraphNode,
gi.cvb)):1<gi.state&&this.Bhc(oi.data.paragraphNode,gi.state)};this.a2n=(gi,oi)=>{(gi=this.jM.fZ(oi.data.currentNode))&&1<gi.state&&this.Bhc(oi.data.currentNode,gi.state)};this.Qn.d8k(this.S9n);this.AF.$7k(this.K9n);this.AF.wjf(this.wkg);this.AF.b7k(this.a2n);this.u6.gfc(this.kao);this.fp.efc(this.I5)}U4o(d){this.ppd=d}VCe(d){let n=0;if(!d.M_a)return F.ULS.sendTraceTag(521412957,3016,50,"Paragraph node not available."),n;if(!d.fWd)return F.ULS.shipAssertTag(545117584,3016,!1),n;const B=this.Qn.YD(d.M_a);
if(!this.fp.ata())return F.ULS.sendTraceTag(537260062,3016,50,`type: ${d.annotationType} role: ${B.role}`),1;if(0==d.suggestion.Qs&&this.Qn.w4i(d.M_a,B))return F.ULS.sendTraceTag(529105475,3016,50,`type: ${d.annotationType} role: ${B.role}`),1;this.Rda.F_f(d.M_a,d.zpc,d.dad-d.zpc,d.annotationType,Q=>{Q||(n=this.qDe(new $o.b(d.suggestion,d.Ju,d.zpc,d.dad,()=>{d.annotationType!==zp.a.trg&&d.annotationType!==zp.a.OJg||this.Rda.Dwc(d.M_a,d.zpc,d.dad-d.zpc,d.annotationType,60);const ha=d.fWd(B,d.Ju);F.ULS.shipAssertTag(540676565,
3016,ha,`Contextual suggestion failed to apply. annotationType: ${d.annotationType}`);return ha}),0,this.Iyc.Llc(B.role)))});1<n&&(d.annotationType===zp.a.trg||d.annotationType===zp.a.OJg)&&this.PH&&this.PH.execute(Q=>{Q.logActivity(yf.a.v3n,null)});F.ULS.sendTraceTag(540653090,3016,50,"Role: {0}; Status {1};",B.role,n);return n}I4c(d,n=null){if(!n&&(n=Object(Uf.a)(Ed.AParagraphNode,d.parent),!n))return[];d=d.content;if(!d||!d.range||d.range!==$f.FormattingSuggestionsRange.List)return[n];if(15!==
this.Qn.YD(n).role)return[];if(ve.a.Qe){if(!ve.a.isListItem(n))return[n];({listId:d}=ve.a.ut(n))}else{d=this.Vd.pha(n);if(!d||!d.hasProperty(Dd.a.listID))return[n];d=d.getValue(Dd.a.listID)}const B=this.Iwa.KWa(n,!0,!1),Q=[];for(;n;)if(Q.push(n),n=B.Jna()?B.uC:null,ve.a.Qe){if(!ve.a.isListItem(n))break;if(ve.a.ut(n).listId!==d)break}else{const ha=this.Vd.pha(n);if(!ha)break;if(!ha.hasProperty(Dd.a.listID))break;if(ha.getValue(Dd.a.listID)!==d)break}return Q}Zoo(d,n,B=null){if(!d)return F.ULS.shipAssertTag(590434825,
3016,!1),0;if(!n)return F.ULS.shipAssertTag(590434828,3016,!1),0;const Q=d.content;if(!Q)return F.ULS.shipAssertTag(590434826,3016,!1),0;const ha=this.I4c(d);if(!ha||!ha.length)return F.ULS.shipAssertTag(590434827,3016,!1),0;const Aa=this.Qn.YD(ha[0]);if(15===Aa.role&&1!==d.content.range)return 1;let bb=!1;ha.forEach(Ib=>{this.Qn.YD(Ib).Acb||(bb=!0)});return bb?this.nHg(new $o.b(new Ym.c(Jh.a.create(),this.PH,this.oe,!1,B),ha,0,this.gh.textLength(ha[0]),()=>n(Q,ha)),this.Iyc.Llc(Aa.role),!1):1}ppo(d,
n,B){if(!d||0==d.length)return F.ULS.shipAssertTag(512603861,3016,!1),0;if(!n)return F.ULS.shipAssertTag(590434833,3016,!1),0;let Q=!1;d.forEach(Aa=>{this.Qn.YD(Aa).Acb||(Q=!0)});const ha=this.Qn.YD(d[0]);return Q?this.nHg(new $o.b(new Ym.c(Jh.a.create(),this.PH,this.oe,!1,B),d,0,this.gh.textLength(d[0]),()=>n(ha,d)),this.Iyc.Llc(ha.role),!0):n(ha,d)?2:0}zpo(d,n){if(!d)return F.ULS.shipAssertTag(589963425,3016,!1),0;if(!n)return F.ULS.shipAssertTag(512603860,3016,!1),0;const B=this.Qn.YD(d);return B.Acb?
n(B,d)?2:0:this.nHg(new $o.b(new Ym.c(Jh.a.create(),this.PH,this.oe,!1,null),[d],0,this.gh.textLength(d),()=>n(B,d)),this.Iyc.Llc(B.role),!0)}DBj(d,n){if(!d)return F.ULS.shipAssertTag(555055119,3016,!1),0;if(!n)return F.ULS.shipAssertTag(555055120,3016,!1),0;if(!d.paragraphNode)return F.ULS.shipAssertTag(555055121,3016,!1),0;n=n(d);const B=null===n||void 0===n?void 0:n.paragraphNode;if(!B)return F.ULS.shipAssertTag(541446668,3016,!1),0;this.AF.Dxc(n);this.kkc.register(B,d.suggestion);return this.qDe(new $o.b(d.suggestion,
[B],0,1,null),(null===n||void 0===n?0:n.placeholder)?.5:1,this.Iyc.Llc(n.role))}crf(d,n,B=!1){d?this.$$j(d,n,B):F.ULS.shipAssertTag(590434834,3016,!1)}iWf(d,n){const B=[];this.jM.forEach(Q=>{const ha=this.jM.fZ(Q);if(void 0!==n&&ha.suggestion.Qs!==n)return F.ULS.sendTraceTag(537796610,3016,50,`skiped role: ${ha.cvb} type: ${ha.suggestion.Qs}`),!0;d||0!=ha.state&&.1!==ha.state||(F.ULS.sendTraceTag(540676562,3016,50,"Role: {0};",ha.cvb),ha.eNb());B.push(Q);return!0},!d);B.length&&B.forEach(Q=>{this.$$j(Q,
d?3:2,!0)});F.ULS.sendTraceTag(537796611,3016,50,`reject: ${d} count: ${B.length}`)}ktd(){this.fp.ata()&&(F.ULS.sendTraceTag(537260063,3016,50,"snoozeContextualSuggestions"),this.fp.ali())}V6m(d){const n=this.Qn.YD(d);n&&!n.joa&&this.Bhc(d,5)}Xtl(d){if(null!==d&&void 0!==d&&d.paragraphNode){var n=this.jM.fZ(d.paragraphNode),B=this.jM.fZ(d.paragraphNode).suggestion,Q=this.Qn.YD(d.paragraphNode);switch(d.Qs){case 1:case 3:this.kkc.unregister(d.paragraphNode);const ha=Aa=>{this.AF.Dxc({role:27,paragraphNode:d.paragraphNode,
placeholder:Aa})};d.paragraphNode=this.Yue.kul(d.paragraphNode,B,()=>{this.AF.Fmd(fn.a.create(d.paragraphNode));ha(!1)},d.g1);ha(!0);this.kkc.register(d.paragraphNode,B);this.qDe(new $o.b(B,[d.paragraphNode],0,1,null),1,this.Iyc.Llc(d.role));break;case 2:this.kkc.unregister(d.paragraphNode);n=bf.ParagraphReader.Cg(d.paragraphNode,!1);this.eT.Wxc(Q.N9c,d.paragraphNode);this.yXf.instance.nYh(new $o.a(B,n,d.dva));break;default:1===d.role?n&&n.FS&&0<n.FS.length?n.FS.forEach(Aa=>{this.a6.P1a(Aa,!1)}):
this.a6.P1a(d.paragraphNode,!1):0!=d.role&&d.role===Q.TVd?(this.a6.P1a(d.paragraphNode,!1),this.dM.Oob(d.paragraphNode,Q.UVd)):n&&n.FS&&0<n.FS.length?n.FS.forEach(Aa=>{this.dM.$la(Aa,d.role)}):this.dM.$la(d.paragraphNode,d.role)}this.AF.ftg(new Pt.a(d.paragraphNode,d.role));this.BYd(d.paragraphNode,4)}else F.ULS.shipAssertTag(575484485,3016,!1)}kRa(d){if(d){var n=this.jM.fZ(d);n?(this.AF.ftg(new Pt.a(d,n.cvb)),3!==n.state&&.1!==n.state||n.eNb(),4===n.state&&(n&&n.FS&&0<n.FS.length?n.FS.forEach(B=>
{this.a6.P1a(B,!1)}):this.a6.P1a(d,!1),n.eNb()),this.BYd(d,1)):F.ULS.shipAssertTag(573850382,3016,!1)}else F.ULS.shipAssertTag(573850381,3016,!1)}$Om(){let d=null;this.jM.forEach(n=>{d=n;return!1},!1);return d}Kmc(d,n){return d?this.jM.cIm(d,n):(F.ULS.shipAssertTag(590434835,3016,!1),null)}BYd(d,n){const B=this.jM.fZ(d);B?(B.state=n,3===n&&27!=B.cvb&&28!=B.cvb&&1===B.FS.length&&(this.Rda.Dwc(d,0,d.characterData.length,zp.a.Zhi,70),this.kHj.set(d,Date.now()))):F.ULS.sendTraceTag(512239234,3016,50,
"Review intent for given paragraph node is null.")}Bhc(d,n){const B=this.jM.fZ(d);if(!d.que||1<n)this.Qha.MCb(d,1),B&&B.FS&&0<B.FS.length?B.FS.forEach(Q=>{this.a6.szf(Q)}):this.a6.szf(d),this.AF.PDj(new bw.a(d,n)),d=[Object.assign(new Ja.a,{name:yf.a.KDl,int64:n})],this.DOn(yf.a.JDl,!0,void 0,d)}IDl(d){const n=this.jM.fZ(d);let B=0;n?B=n.state:F.ULS.shipAssertTag(573687424,3016,!1);this.Bhc(d,B)}$$j(d,n,B){const Q=this.Qn.YD(d);if(Q.joa){var ha=this.jM.fZ(d),Aa=null===ha||void 0===ha?void 0:ha.state;
this.BYd(d,n);3===n||.1===n?27===Q.role?(1===Aa&&(this.kkc.unregister(d),this.Yue.PHj(d)),B=!1):28===Q.role?(this.kkc.unregister(d),this.eT.Wxc(Q.N9c,d),B=!1):(ha&&ha.FS&&0<ha.FS.length?ha.FS.forEach(bb=>{this.a6.P1a(bb,!1)}):this.a6.P1a(d,!1),this.AF.Euo(new Pt.a(d))):2===n&&this.AF.Cuo(new Pt.a(d));B&&this.IDl(d)}}qDe(d,n,B,Q=!1){const ha=this.Qn.YD(d.M_a);0<d.dad&&!ha.joa&&!this.N$o(d.M_a)?(this.Qha.R_a(d.M_a,new bH.a(1,d.zpc,d.dad,void 0,new Mq(d.suggestion,n,B,ha.role,d.fWd,d.Ju))),0==d.suggestion.Qs&&
this.YEl.register(d.M_a,d.suggestion),this.AF.Duo(new Pt.a(d.M_a,ha.role,Q)),d=3):d=4;F.ULS.sendTraceTag(540653091,3016,50,"Role: {0}; Status {1}; State: {2};",ha.role,d,n);return d}N$o(d){var n=Date.now();return this.g2?!1:(d=this.kHj.get(d))?n-d<this.oe.Yjl():!1}nHg(d,n,B){this.VN.Ae(()=>{d.Ju.forEach(Q=>{this.a6.azc(Q,B)})},"WD:SF");if(d.fWd())return this.qDe(d,1,n,!B);d.Ju.forEach(Q=>{this.a6.szf(Q)});return 0}qZi(){this.jM.forEach(d=>{if(1<this.jM.fZ(d).state)return!0;this.Bhc(d,5);return!0},
!1)}Fdl(d,n){const B=this.wC.Vc(15,Se.a.fYh);try{n&&n.FS&&0<n.FS.length?(B.KB.Eb(this.Xc.Fd),n.FS.forEach(Q=>{this.a6.azc(Q,!0)})):(B.KB.Eb(d),this.a6.azc(d,!0)),n.eNb()}finally{B&&B.dispose()}}}Object(D.a)(pn,"ReviewManager",null,[1121]);class Cy{constructor(d,n,B,Q){this.XUe=new Set;this.xo=d;this.qb=n;this.rUa=B;this.vSa=Q}forEach(d,n=!1){if(d){var B=Object(Uf.a)(Ed.AParagraphNode,n?this.qb.vH(this.vSa.Fd):this.qb.Vn(this.vSa.Fd));n=this.rUa.KWa(B,!0,n);do if(this.Kcd(n.uC)&&!d(n.uC))break;while(n.Jna())}else F.ULS.shipAssertTag(590391060,
3016,!1)}cIm(d,n){if(!d)return F.ULS.shipAssertTag(590391061,3016,!1),null;for(d=this.rUa.KWa(d,!0,n);d.Jna();)if(this.Kcd(d.uC))return d.uC;return null}Kcd(d){return d?0<this.xo.JMa(d,1,()=>!0).count&&!Array.from(this.XUe).some(n=>n(d)):(F.ULS.shipAssertTag(590391062,3016,!1),!1)}fZ(d){if(!d)return F.ULS.sendTraceTag(522301513,3016,50,"Get null paragraphNode while trying to initialize ReviewIntent"),null;d=this.xo.JMa(d,1,()=>!0);if(1===d.count)return d.K(0).intent;F.ULS.sendTraceTag(522301514,3016,
50,"Return null ReviewIntent because of unexpected ranges.count: {0}",d.count);return null}G1k(d){this.XUe.add(d);return()=>this.XUe.delete(d)}}Object(D.a)(Cy,"ReviewTraverser",null,[1119]);var Ew;(function(d){d[d.None=0]="None";d[d.mok=1]="ProactivePaneOpeningDisabled";d[d.$Vp=2]="JumpstartProactivePaneOpeningDisabled"})(Ew||(Ew={}));Object(D.b)("DesignerFlagSetting",Ew);const Qt=d=>{if(!d)return Ew.None;const n=d.split(".");return 2===n.length&&1===parseInt(n[0])?parseInt(n[1]):"0"===d?Ew.mok:Ew.None};
class IC{constructor(){this.FavoriteThemesIDs=this.DesignerFlags=this.CSDisableDate=null}equals(d){return this.CSDisableDate===d.CSDisableDate&&this.DesignerFlags===d.DesignerFlags&&this.FavoriteThemesIDs===d.FavoriteThemesIDs}}Object(D.a)(IC,"WordDesignerSettings",null,[1072]);class Zn{constructor(d,n){this.Kxd=d;this.oe=n;this.roamingSettings=null;this.hmf=!0;this.vd=new dc.a}initialize(){if(this.Kxd){F.ULS.sendTraceTag(523850467,3016,50,"DesignerSettingsManager - initialize with roaming");var d=
Date.now();this.Kxd.ydb().then(n=>{this.roamingSettings=n;this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);!0!==this.ata()&&(n=[Object.assign(new Ja.a,{name:"CSEnabled",bool:this.ata()})],sb.a(yf.a.oJn,!0,Date.now()-d,n));this.oe.mFg()&&(n=new IC,n.CSDisableDate=new Date(0),n.DesignerFlags="",n.FavoriteThemesIDs=[],this.roamingSettings=n)}).catch(n=>{F.ULS.sendTraceTag(509137223,3016,15,`DesignerSettingsManager - failed loading from roaming with error ${JSON.stringify(n,["message","stack"],
2)}`)})}else F.ULS.sendTraceTag(523850466,3016,50,"DesignerSettingsManager - initialize. No roaming")}he(){F.ULS.sendTraceTag(523850497,3016,50,`DesignerSettingsManager - deinitialize. CS_enabled: ${this.ata()}`)}efc(d){this.vd.addHandler("OnSettingsChanged",d)}R0b(d){this.vd.removeHandler("OnSettingsChanged",d)}h4(){return this.oe.sCe()||this.oe.mFg()?!0:!(!this.roamingSettings||!this.Kxd)}j6l(){this.ata()?F.ULS.shipAssertTag(523850498,3016,!1):(this.hmf=!0,this.roamingSettings&&(this.roamingSettings.CSDisableDate=
new Date(0),this.Gwd()),this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs),F.ULS.sendTraceTag(523850499,3016,50,"DesignerSettingsManager - enableContextualSuggestions."))}ata(){if(this.oe.sCe())return!0;if(this.h4())return!1===this.hmf||this.roamingSettings&&this.roamingSettings.CSDisableDate&&this.roamingSettings.CSDisableDate>new Date(0)?!1:!0}EAf(){const d=this.ata();this.hmf=!1;d&&this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);F.ULS.sendTraceTag(523850500,3016,50,`DesignerSettingsManager - disableForSession. Changed:${d}`)}ali(){if(this.roamingSettings){var d=
this.ata();this.roamingSettings.CSDisableDate=new Date;this.Gwd();d&&this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);F.ULS.sendTraceTag(523850502,3016,50,`DesignerSettingsManager - disableUntilUpdate. Changed:${d}`)}else F.ULS.shipAssertTag(523850501,3016,!1),this.EAf()}Xad(d,n){return this.h4()?Qt(this.roamingSettings.DesignerFlags)&d?!0:!1:n}oTj(d){if(this.roamingSettings){var n=this.roamingSettings.DesignerFlags;d|=Qt(n);this.roamingSettings.DesignerFlags=`1.${d}`;n!==this.roamingSettings.DesignerFlags&&
(this.Gwd(),this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else F.ULS.shipAssertTag(508944657,3016,!1)}pak(d){if(this.roamingSettings){var n=this.roamingSettings.DesignerFlags;d=Qt(n)&~d;this.roamingSettings.DesignerFlags=`1.${d}`;n!==this.roamingSettings.DesignerFlags&&(this.Gwd(),this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else F.ULS.shipAssertTag(508944656,3016,!1)}c6i(){return!this.Xad(1,!0)}G_l(){this.oTj(1)}Ioi(){this.pak(1)}wFm(){if(this.roamingSettings)return F.ULS.sendTraceTag(520488718,
3016,50,`DesignerSettingsManager - getListOfFavoriteThemesIDs. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`),this.roamingSettings.FavoriteThemesIDs;F.ULS.shipAssertTag(520488719,3016,!1)}Ctp(d){var n,B;if(this.roamingSettings){var Q=null!==(B=null===(n=this.roamingSettings.FavoriteThemesIDs)||void 0===n?void 0:n.indexOf(d,0))&&void 0!==B?B:-1;-1===Q?(this.roamingSettings.FavoriteThemesIDs||(this.roamingSettings.FavoriteThemesIDs=[]),this.roamingSettings.FavoriteThemesIDs.unshift(d)):
this.roamingSettings.FavoriteThemesIDs.splice(Q,1);this.oe.mFg()||this.Gwd();this.vd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);F.ULS.sendTraceTag(520488716,3016,50,`DesignerSettingsManager - toggleFavoriteTheme. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`)}else F.ULS.shipAssertTag(520488717,3016,!1)}Gwd(){this.Kxd&&(this.Kxd.saveSettings(this.roamingSettings),F.ULS.sendTraceTag(523850503,3016,50,"DesignerSettingsManager - updateRoamingSettings"))}}Object(D.a)(Zn,"DesignerSettingsManager",
null,[1120]);class iv extends jc.a{constructor(d){super("DesignerSettingsReadyConditionId");this.fp=d;this.I5=()=>{this.fp.h4()?(this.ri(!0),this.fp.R0b(this.I5)):F.ULS.sendTraceTag(523850465,3016,15,"DesignerSettingsReadyCondition: settings changed, but not loaded")}}initialize(){super.initialize();this.fp.h4()?this.ri(!0):this.fp.efc(this.I5)}he(){this.fp.R0b(this.I5);super.he()}}Object(D.a)(iv,"DesignerSettingsReadyCondition",jc.a,[]);var op=e(1499),JC=e(1500);class KC{static tvn(d){return String(d).charAt(0)==
String(d)}static B6l(d){return KC.tvn(d)?"*"+d:d.toString()}static WTl(d){const n=[];for(let Q=0;Q<d.length;Q+=2){var B=d.substring(Q,Math.min(d.length,Q+2));B=B.startsWith("*")?Number(B.substring(1)):Number(B);n.push(B)}return n}static Non(d){return d instanceof Date&&!isNaN(d.getTime())}}Object(D.a)(KC,"WordDesignerSettingsUtils",null,[]);var Rt=e(270);const bB=new Date(0);class zn extends op.a{constructor(d,n,B,Q,ha){super(d,n,B,Q,ha);this.qba="Word Designer";this.nIb=["CSDisableDate","DesignerFlags",
"FavoriteThemesIDs"];this.uac=zn.lrk;this.TKc="getWordDesignerSettings";this.qcc="saveWordDesignerSettings";this.Xmb=Rt.a.jKe}jKe(){return this.lj}async dpd(){return!0}Wec(){var d;return["CSDisableDate",this.lj.CSDisableDate,"DesignerFlags",null!==(d=this.lj.DesignerFlags)&&void 0!==d?d:"0","FavoriteThemesIDs",this.lj.FavoriteThemesIDs]}Vec(){var d,n=this.lj.CSDisableDate?this.lj.CSDisableDate.toISOString():"";n=this.lj.CSDisableDate?n.substring(0,n.indexOf("T")):"";const B=this.lj.FavoriteThemesIDs?
this.lj.FavoriteThemesIDs.map(KC.B6l).join(""):"";return{["CSDisableDate"]:this.J0(n),["DesignerFlags"]:this.J0(null!==(d=this.lj.DesignerFlags)&&void 0!==d?d:"0"),["FavoriteThemesIDs"]:this.J0(B)}}K_c(){return new JC.a(this.lj)}get Sic(){return new IC}fkd(d){const n=new IC;if(d.CSDisableDate){const B=this.IEj(d.CSDisableDate);n.CSDisableDate=KC.Non(B)?B:bB}else n.CSDisableDate=null;n.DesignerFlags=d.DesignerFlags?this.lod(d.DesignerFlags):"0";n.FavoriteThemesIDs=d.FavoriteThemesIDs?KC.WTl(this.lod(d.FavoriteThemesIDs)):
[];return n}ydb(){return this.Xed()}saveSettings(d){this.lj=d;return this.aqd()}}zn.lrk="WordDesignerSettingsChangedEvent";Object(D.a)(zn,"WordDesignerSettingsHandler",op.a,[1118]);class Qu{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc=null,Ac){this.oe=d;this.Kwa=n;this.wZd=B;this.vua=Q;this.J4=ha;this.Dh=Aa;this.Qn=Ib;this.PH=oc;this.vjc=Ac;this.Lrc=this.isInitialized=!1;this.Tpa=this.gha=0;this.mte="";this.Lwa=new Map;this.aOb=new Map;this.vXc=0;this.g$a=new ma.a;this.yQa=null;this.bXb=Jh.a.nil;this.$Vb=!1;
this.qFa=[];this.Jvc=(ad,sd)=>{this.yQa&&sd.actionId===Se.a.EFa&&this.yQa.sfd()};this.syb=(ad,sd)=>{if(null==this.qFa||0==this.qFa.length)this.Tpa=2;else if(sd.data.operationType!==kj.a.getTypeName())F.ULS.sendTraceTag(512350099,3016,50,`unexpected operationType: ${sd.data.operationType}`);else if(this.$Vb)if(ad=sd.data.annotation)if(ad.annotationType!==$f.FormattingSuggestionsAnnotation.getTypeName())F.ULS.shipAssertTag(521429915,3016,!1);else if(sd=this.vua.getParent(ad))if(this.qFa.includes(sd)){var wd=
this.qFa.indexOf(sd);-1!==wd&&(this.aOb.set(ad,{WNj:this.Qn.YD(sd),Gng:wd}),this.vXc=this.qFa.length,this.wzf(213),this.yQa||(this.yQa=new Ym.a(this.bXb,this.PH,this.oe,!1,this.Dh.Mma),this.yQa.F_a(0)),1!==this.Tpa&&(this.Tpa=1,this.PDc(this.Tpa)),this.aOb.size===this.vXc&&this.HDc(),this.mwp())}else F.ULS.sendTraceTag(521483348,3016,50,`Skip non-pasted paragraph ${null===sd||void 0===sd?void 0:sd.id}`);else F.ULS.shipAssertTag(521429914,3016,!1);else F.ULS.shipAssertTag(521429916,3016,!1)};this.tyb=
(ad,sd)=>{sd.data.operationType===kj.a.getTypeName()&&(sd.data.annotation?sd.data.annotation.annotationType!==$f.FormattingSuggestionsSummaryAnnotation.getTypeName()?F.ULS.shipAssertTag(521429912,3016,!1):(this.gha&&(ad=[Object.assign(new Ja.a,{name:yf.a.Htg,string:"CCPFloatieSmartPaste"})],sb.a(yf.a.Gtg,!0,Date.now()-this.gha,ad),this.gha=0),(sd=sd.data.annotation.content)?(sd.errorCode||0===sd.numberOfSuggestions)&&this.$Vb&&0===this.Tpa&&this.dxf(213,5E3,!1):F.ULS.shipAssertTag(521429911,3016,
!1)):F.ULS.shipAssertTag(521429913,3016,!1))};this.G5=(ad,sd)=>{var wd;this.oif(sd.node);sd.W3i&&(this.Bvl()?(this.gkn(),this.anp(),this.PDc(0),this.dxf(213,1E4)):(this.OGp(this.qFa),this.HDc(),this.yQa&&1===this.yQa.inp&&this.yQa.sfd()),this.Lxj=!0,sb.a("PasteActionHappened",!0,void 0,[Object.assign(new Ja.a,{name:"IsNewPasteAction",Boolean:this.$Vb}),Object.assign(new Ja.a,{name:"CorrelationId",string:null===(wd=this.bXb)||void 0===wd?void 0:wd.toString()})]))};this.Tpa=0;this.YWi();this.Vjd=bb.Hf(12)}initialize(){this.isInitialized||
(F.ULS.sendTraceTag(521483352,3016,50,"SmartPasteManager - initialize"),this.Dh.ffc(this.Jvc),this.Vjd.DUh(this.G5),this.isInitialized=!0)}he(){this.isInitialized&&(F.ULS.sendTraceTag(521483351,3016,50,"SmartPasteManager - deinitialize"),this.Dh.zwg(this.Jvc),this.HDc(),this.Vjd.DJj(this.G5),this.isInitialized=!1)}anp(){F.ULS.sendTraceTag(521483350,3016,50,`SmartPasteManager - subscribe to AL was called: ${this.Lrc}`);this.Lrc||(this.gha=Date.now(),this.vua.IJ(this.syb),this.J4.IJ(this.tyb),this.J4.register(),
this.vua.register(),this.Lrc=!0,this.dxf(217,3E4))}HDc(){F.ULS.sendTraceTag(521483349,3016,50,`SmartPasteManager - unsub from AL was called: ${this.Lrc}`);this.Lrc&&(this.J4.unregister(),this.vua.unregister(),this.vua.iM(this.syb),this.J4.iM(this.tyb),this.Lrc=!1,this.wzf())}YWi(){switch(this.oe.zBb()){case 1:this.mte="floatie.gbFormatWithDesignerButton-Menu16";this.Kwa.aEg("floatie.gbFormatWithDesignerButton");this.Lwa.set(0,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerAnalyzing,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});
this.Lwa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.Lwa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipUnavailable});break;case 2:this.mte="floatie.gbMatchDocumentFormattingButton-Menu16";this.Kwa.aEg("floatie.gbMatchDocumentFormattingButton");this.Lwa.set(0,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingAnalyzing,
altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Lwa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Lwa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipUnavailable});break;case 3:this.mte="floatie.gbUseSmartPasteButton-Menu16",this.Kwa.aEg("floatie.gbUseSmartPasteButton"),this.Lwa.set(0,
{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPasteAnalyzing,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Lwa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Lwa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipUnavailable})}}PDc(d){if(0!==this.Lwa.size&&this.Lwa.get(d)){this.Tpa=d;var n=this.Lwa.get(d).labelText;d=this.Lwa.get(d).altText;
var B=document.getElementById(this.mte);this.Kwa.PDc(n,d,B?!0:!1)}else this.YWi(),F.ULS.sendTraceTag(521416988,3016,50,`pasteStateStrings initialized in updateSmartPasteButton method. Correlation id:${this.bXb}`)}gkn(){this.yQa=null;this.aOb.clear();this.Tpa=this.vXc=0;this.wzf()}dxf(d,n,B=!0){n=new tb.a(2,1,n,()=>{switch(d){case 213:0===this.Tpa&&(this.PDc(2),B&&this.HDc());break;case 217:this.HDc()}},d);G.AFrameworkApplication.zc.pc(n);this.g$a.add(n)}wzf(d=null){if(0!==this.g$a.count)if(d){let n=
0;for(;n<this.g$a.count;)this.g$a.K(n).jya===d?(G.AFrameworkApplication.zc.Kf(this.g$a.K(n)),this.g$a.removeAt(n)):n++}else{for(d=0;d<this.g$a.count;d++)G.AFrameworkApplication.zc.Kf(this.g$a.K(d));this.g$a.clear()}}Bvl(){if(this.wZd.instance){const d=this.wZd.instance.MLm();if(d!==Jh.a.nil&&d!==this.bXb)return this.bXb=d,this.$Vb=!0}else return F.ULS.sendTraceTag(521483347,307,10,"ClipboardActor future not ready"),this.$Vb=!0;return this.$Vb=0===this.aOb.size}OGp(d){1===this.Tpa&&(this.vXc!==d.length?
F.ULS.sendTraceTag(521483346,3016,50,`Missmatch in number of pasted paragraph. Number of cached pasted paragraphs:${this.vXc}. Number of pasted paragraphs:${d.length}`):this.aOb.forEach((n,B)=>{n.Gng<d.length&&(B.parent=d[n.Gng])}))}j2o(d){this.wZd.instance?this.wZd.instance.R$i=d:F.ULS.sendTraceTag(521483345,307,10,"ClipboardActor future not ready")}oif(d){this.Lxj&&(this.qFa=[],this.Lxj=!1);this.qFa.push(d)}Eel(){this.HDc();if(0===this.aOb.size)return 0;const d=this.vjc.Fel(this.aOb,this.qFa);0<
d?this.yQa.F_a(1):F.ULS.shipAssertTag(520646736,3016,!1);return d}M5i(d){return d?d===Se.a.n1a||d===Se.a.S5||d===Se.a.azb:!1}Mma(){return this.Dh.Mma}mwp(){const d=Wa.a.instance.Za("Common.ISystemInitiatedFeedback");d&&d.execute(n=>{switch(this.oe.zBb()){case 1:n.logActivity(yf.a.ark,null);break;case 2:n.logActivity(yf.a.grk,null);break;case 3:n.logActivity(yf.a.trk,null)}})}}Object(D.a)(Qu,"SmartPasteManager",null,[478,1117]);class Dy{constructor(d){this.SPh=d}get Zf(){return null!=this.I9g?this.I9g:
this.I9g=Wa.a.instance.Wa("Box4.Styles.StyleSettings")}getPropertyValue(d,n,B){if(!d)return F.ULS.shipAssertTag(574407567,3016,!1),B;var Q=new ig.ScriptSharpLegacyMap;for(var ha of d.V5j)if(ha.qp.hasProperty(n)){const Aa=ha.cpEnd-ha.ru,bb=ha.qp.getValue(n);if(Q.Bb(bb)){let Ib;Q.W(Ib=bb,Q.K(Ib)+Aa)}else Q.add(bb,Aa)}ha=d.textLength*yf.a.Tvp;for(const Aa of Q.keys)if(Q.K(Aa)>ha)return Aa;if(d.paragraphFormat.hasProperty(n))return d.paragraphFormat.getValue(n);Q=d.paragraphFormat.ka(Ya.a.styleName,yf.a.Svp);
d=this.SPh.Il();this.Zf.zl?(Q=d.Ev().Ena(Q),d=d.Qg(this.SPh.Je(Q))):d=d.Rua(Q);return d?d.ka(n,B):B}}Object(D.a)(Dy,"ParagraphFormattingSnapshotReader",null,[1116]);class PE{constructor(){this.GAa=new lm.a}put(d,n){this.GAa.add(d,n)}pHe(d){let n;return{returnValue:({value:n}=this.GAa.Nc(d)).returnValue,e1j:n}}remove(d){this.GAa.remove(d)}}Object(D.a)(PE,"ParagraphFormattingStorage",null,[1115]);class wx{constructor(){this.OPc=new vn.a(ja.a.Oh())}put(d,n){this.OPc.Bb(d)?this.OPc.W(d,n):this.OPc.add(d,
n)}pHe(d){let n;return{returnValue:({value:n}=this.OPc.Nc(d,n)).returnValue,Zxa:n}}Bb(d){return this.OPc.Bb(d)}}Object(D.a)(wx,"StyleStorage",null,[]);var LC=e(272);class OJ{constructor(d){this.Eq=d;this.rcb=!1;this.gB=this.dialog=null;this.Zed=this.xN=0;this.vd=new dc.a;this.shg="OnApplyThemeDialogClosed"}showDialog(){this.dialog=new Ea.a(!1,!1,!0);this.dialog.Md=5;this.dialog.ti(WacWordeditorStrings.DesignerApplyThemeDialogTitle,null,this.wSb());this.gB=this.Eq.rg("DialogShown","ApplyThemeBlockingDialog");
this.rcb=!0;F.ULS.sendTraceTag(524121478,3016,50,"Apply theme blocking dialog is shown.");sb.a(yf.a.ifl,!0);this.Zed=this.xN=0;LC.a.delay(6E4).continueWith(()=>{F.ULS.sendTraceTag(509367262,3016,50,"Apply theme blocking dialog started closing after timeout.");this.LBa(!0)})}wbp(d,n){var B,Q;if(null===(B=d.decorators)||void 0===B?0:B.filter(Aa=>Aa.hasImages).length)return!0;const ha=new Set;for(const [Aa,bb]of d.styles)null===(Q=bb.decorators)||void 0===Q?void 0:Q.forEach(Ib=>{Ib.hasImages&&ha.add(Yn.g(Aa))});
if(!ha.size)return!1;d=this.Eq.rg("UserAction","ApplyThemeDialogShouldShow");B=!1;for(const Aa of n.keys())if(ha.has(Aa)){B=!0;break}d.stop();return B}LBa(d=!1){this.rcb&&(d||this.Zed==this.xN)&&(this.dialog.hide(),this.gB.stop(),this.rcb=!1,this.vd.raiseEvent(this.shg),F.ULS.sendTraceTag(524121479,3016,50,`Apply theme blocking dialog has closed, isForced: ${d}`),d=[Object.assign(new Ja.a,{name:yf.a.gfl,boolean:d})],sb.a(yf.a.ffl,!0,void 0,d))}Wif(){this.rcb&&(this.xN+=1)}jgg(){if(this.rcb)return this.Zed+=
1,this.Zed==this.xN?(this.LBa(),!0):!1}ojf(d){this.vd.addHandler(this.shg,d)}JJj(d){this.vd.removeHandler(this.shg,d)}wSb(){return{["id"]:"ApplyThemeDialog",["dialogButtonsOption"]:5,["hideCloseButton"]:!0}}}Object(D.a)(OJ,"ApplyThemeDialogManagerImpl",null,[1113]);class Xr{constructor(){this.sa=new dc.a}initialize(){}he(){}ZUd(d){this.sa.addHandler(Xr.gPa,d)}VJj(d){this.sa.removeHandler(Xr.gPa,d)}}Xr.gPa="OnThemesChanged";Object(D.a)(Xr,"AThemeProvider",null,[1093,478]);class xx{constructor(d=Kg.none,
n=""){this.labelId=d;this.Gja=n}getLabel(){return this.labelId}getStringId(){return this.Gja}equals(d){return this.Gja||d.Gja?this.Gja===d.Gja:this.labelId===d.labelId}static equals(d,n){return d||n?d&&n?d.equals(n):!1:d===n}toString(){return null!==this.Gja?this.Gja:null!==this.labelId?this.labelId.toString():""}}Object(D.a)(xx,"SectionId",null,[]);class MC extends Xr{constructor(d,n,B,Q,ha){super();this.x6=d;this.gX=n;this.c$a=B;this.u6=Q;this.oe=ha;this.ejc=this.Ay=null;this.iyd=new Map([[ij.SectionLabel.Article,
Kg.article],[ij.SectionLabel.CoverLetter,Kg.coverLetter],[ij.SectionLabel.CoverPage,Kg.coverPage],[ij.SectionLabel.GeneralDocument,Kg.generalDocument],[ij.SectionLabel.Invoice,Kg.invoice],[ij.SectionLabel.Journal,Kg.journal],[ij.SectionLabel.Letter,Kg.letter],[ij.SectionLabel.Letterhead,Kg.letterhead],[ij.SectionLabel.Main,Kg.main],[ij.SectionLabel.Notes,Kg.notes],[ij.SectionLabel.Report,Kg.report],[ij.SectionLabel.Resume,Kg.resume],[ij.SectionLabel.Text2Image,Kg.text2Image],[ij.SectionLabel.ToDoList,
Kg.toDoList]]);this.HDb=new Map([[Og.letters,{id:"817f4488-91de-4a44-842e-44670553632b",displayName:"Letters"}],[Og.writing,{id:"e3abc6aa-ea3f-4d0f-887d-e929caf85eaf",displayName:"Writing"}],[Og.lists,{id:"d9d2be59-6d2a-41b7-bd37-74507d741f9c",displayName:"Lists"}],[Og.resumes,{id:"39b64df5-1fb2-4699-b467-028bb20986e3",displayName:"Resumes"}],[Og.business,{id:"f2015b9f-1a5f-4cdf-813a-3cbedcd28768",displayName:"Business"}],[Og.education,{id:"f9f17e14-9f18-4872-ab1d-c4e05a7e3446",displayName:"Education"}],
[Og.newsletters,{id:"dd8a511d-30c7-4019-8cfe-611888ea2450",displayName:"Newsletters"}]]);this.activeSection=null;this.isInitialized=!1;this.KWh=(Aa,bb)=>{var Ib;this.x6.iM(this.KWh);if(bb.data.annotation)if(bb.data.annotation.annotationType!==ij.ThemeGeneratorAnnotation.getTypeName())F.ULS.shipAssertTag(545399813,3016,!1);else if(Aa=bb.data.annotation.content){if(null===(Ib=Aa.sections)||void 0===Ib?0:Ib.length)this.Ay=this.Klm(Aa);this.sa.raiseEvent(Xr.gPa)}else F.ULS.shipAssertTag(545399814,3016,
!1);else F.ULS.shipAssertTag(545399812,3016,!1)};this.Vkg=()=>{var Aa;this.Ay&&(this.vJf(this.Ay)||(this.Ay=null===(Aa=this.Ay)||void 0===Aa?void 0:Aa.map(bb=>{bb.id.getLabel()===Kg.text2Image&&(bb.isLoaded=!0,bb.items=[]);return bb})),this.sa.raiseEvent(Xr.gPa))};this.f2n=()=>{var Aa;const bb=this.yLi(this.Ay,Kg.text2Image);null!==bb&&void 0!==bb&&bb.items&&(this.gX.initialize(),this.gX.rjf(this.Vkg),this.gX.JLj()?this.vJf(this.Ay)||(this.Ay=null===(Aa=this.Ay)||void 0===Aa?void 0:Aa.filter(Ib=>
Ib.id.getLabel()!==Kg.text2Image)):bb.isLoaded=!1,this.sa.raiseEvent(Xr.gPa))}}Sbe(){return this.Ay}I7c(){return this.ejc}Flc(){return this.activeSection}H1(){return!1}mle(){}initialize(){this.isInitialized||(this.x6.IJ(this.KWh),this.x6.GCa(new ij.ThemeGeneratorSignal),this.u6.JUh(this.f2n),this.isInitialized=!0)}he(){}Klm(d){let n=[];this.ejc=new vn.a(ja.a.Oh());this.activeSection=d.activeSection;for(const B of d.sections){if(B.label===ij.SectionLabel.CoverPage&&!xy())continue;d=[];for(const Aa of B.items){const bb=
Aa;Af.a.WT&&["D7ST","D14ST","D25ST"].some(Ib=>Ib===bb.name)||(this.ejc.add(bb.name,bb.id),d.push(this.getTheme(bb,B)))}let Q=null,ha=null;if(this.oe.cwb()){const Aa=this.sBi(this.iyd.get(B.label));Aa&&(Q=Aa.id,ha=Aa.displayName)}n.push({label:this.iyd.get(B.label),labelDisplayName:ha,id:new xx(this.iyd.get(B.label),Q),displayName:ha,items:d,isLoaded:B.label!==ij.SectionLabel.Text2Image,H1:!1});B.label==ij.SectionLabel.Text2Image&&(this.gX.initialize(),this.gX.rjf(this.Vkg),this.gX.JLj()&&(this.vJf(n)||
(n=null===n||void 0===n?void 0:n.filter(Aa=>Aa.id.getLabel()!==Kg.text2Image))))}return n}sBi(d){switch(d){case Kg.letter:case Kg.coverLetter:case Kg.letterhead:return this.HDb.get(Og.letters);case Kg.generalDocument:case Kg.journal:return this.HDb.get(Og.writing);case Kg.toDoList:return this.HDb.get(Og.lists);case Kg.resume:return this.HDb.get(Og.resumes);case Kg.notes:case Kg.invoice:return this.HDb.get(Og.business);case Kg.report:return this.HDb.get(Og.education);case Kg.article:return this.HDb.get(Og.newsletters)}}getTheme(d,
n){const B=new Map;let Q=!1;for(const Aa of d.roles){var ha=Yn.f(Aa.type);B.set(Yn.h(ha),{decorators:this.c$a.dxi(Aa.style.decorators),fontName:sx(Aa.style.fontFamily),fontSize:Aa.style.fontSize,fontColor:Aa.style.fontColor,bold:Aa.style.bold,italic:Aa.style.italic,underline:Aa.style.underline,alignment:Aa.style.alignment,lineSpacing:Aa.style.lineSpacing,beforeSpacing:Aa.style.beforeSpacing,afterSpacing:Aa.style.afterSpacing,specialIndentType:Aa.style.specialIndentType,specialIndentBy:Aa.style.specialIndentBy,
fontKerning:Aa.style.fontKerning,allCaps:Aa.style.allCaps});Aa.style.decorators&&(Q=!0);ha=Aa.style.fontFamily;Wr.a.qMa.isEnabled?Wr.a.qMa.Ita(ha):Wr.a.xLa.isEnabled&&Wr.a.xLa.Ita(ha)}n=this.sBi(this.iyd.get(n.label));return{type:d.type,name:d.name,id:d.id,styles:B,decorators:this.c$a.dxi(d.decorators),layout:d.layout,accentColor:d.accentColor,backgroundColor:d.backgroundColor,isSimpleTheme:!d.decorators&&!Q,collectionId:null===n||void 0===n?void 0:n.id,collectionName:null===n||void 0===n?void 0:
n.displayName,IsL2Template:!1}}yLi(d,n){if(!d)return null;for(const B of d)if(B.id.getLabel()===n)return B;return null}vJf(d){var n;const B=this.gX.QCm();this.gX.OJj(this.Vkg);this.gX.he();if(!B||null===(n=B.jW)||void 0===n||!n.length||B.jW[0].category!==Bk.SuggestionCategory.TextRelatedImage)return!1;d=this.yLi(d,Kg.text2Image);d.isLoaded=!0;null===d||void 0===d?void 0:d.items.forEach(Q=>{var ha;Q.decorators=null===(ha=Q.decorators)||void 0===ha?void 0:ha.map(Aa=>Aa.type===Me.text2Image?{...Aa,imageUrl:B.baseUrl+
B.jW[0].imageId,thumbnailUrl:B.baseUrl+B.jW[0].thumbnailId,altText:B.jW[0].altText}:Aa)});return!0}}Object(D.a)(MC,"AugLoopThemeProvider",Xr,[]);class Cr{constructor(d,n){this.text=d;this.role=n}}Object(D.a)(Cr,"BlankDocSentence",null,[]);class Hz{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){this.A3j=1;this.ee=d;this.gr=n;this.Pe=B;this.td=Q;this.VG=ha;this.ni=Aa;this.pmb=bb;this.qb=Ib;this.z0=oc;this.vSa=Ac}Afe(d){var n=Object(Uf.a)(Ed.AParagraphNode,this.qb.Vn(this.vSa.Fd));n=this.Yhn(n);this.Tmp(n);
d&&this.Egn(n)}u$j(d,n,B,Q){let ha=ge.a.createTextRange(n,d,d+this.A3j);this.ee.lf(ha,B);ha=ge.a.createTextRange(n,d,d+B.length);n.m1(d);n.ra.Vh(d).hyperlink=this.VG.SJ(ha,Q,!0);this.z0.zY(ha,Aa=>{this.Pe.lrd(Aa,!0)})}IHe(d,n,B){let Q=ge.a.createTextRange(n,d,d+this.A3j);this.ee.lf(Q,B);Q=ge.a.createTextRange(n,d,d+B.length);this.z0.zY(Q,ha=>{this.Pe.GP(ha,!0)})}Yhn(d){let n=Object(Uf.a)(vc.a,this.td.Ag(d));n.Wd();const B=new ma.a;for(let Q=0;10>Q;Q++){const ha=Hz.Fnf[Q];bg.a.xe(n);this.ni.mA(n,!1,
!1);this.ni.dN(n);B.add(n.currentNode);const Aa=ge.a.jd(n.currentNode,0);this.ee.lf(Aa,ha.text,!0,!1);this.pmb.$la(n.currentNode,ha.role)}n=Object(Uf.a)(vc.a,this.td.Ag(d));n.Wd();bg.a.xe(n);n.qh();return B}Tmp(d){let n=0;for(const B of d)d=B.characterData.indexOf("$"),-1!==d&&(3===n?this.u$j(d,B,WacWordeditorStrings.Designer_BlankDocumentLearnMoreDesigner,yf.a.Djl):6===n?(this.IHe(d,B,WacWordeditorStrings.Designer_BlankDocumentHomeStylesBold),d=B.characterData.indexOf("$"),this.IHe(d,B,WacWordeditorStrings.Designer_BlankDocumentStylesBold),
d=B.characterData.indexOf("$"),this.u$j(d,B,WacWordeditorStrings.Designer_BlankDocumentLearnMoreStyles,yf.a.Ejl)):7===n?this.IHe(d,B,WacWordeditorStrings.Designer_BlankDocumentHomeDesignerBold):9===n&&this.IHe(d,B,WacWordeditorStrings.Designer_BlankDocumentHomeDesignerBold)),n++}Egn(d){let n=0;for(;n<d.count;){var B=d.K(n);const ha=Hz.Fnf[n].role;for(;n+1<d.count&&Hz.Fnf[n+1].role==ha;)n++;var Q=d.K(n);({id:B,returnValue:Q}=this.gr.Msa(B.id,Q.id));0===Q?(B=this.gr.getById(B),B.title=Yn.i(ha),B.KN=
!0,B.removeWhenEdited=!0):F.ULS.shipAssertTag(528312211,3016,!1);n++}}}Hz.Fnf=[new Cr(WacWordeditorStrings.Designer_BlankDocumentTitle,2),new Cr(WacWordeditorStrings.Designer_BlankDocumentSubtitle,3),new Cr(WacWordeditorStrings.Designer_BlankDocumentFirstHeading,4),new Cr(WacWordeditorStrings.Designer_BlankDocumentFirstParagraph,13),new Cr(WacWordeditorStrings.Designer_BlankDocumentSecondHeading,5),new Cr(WacWordeditorStrings.Designer_BlankDocumentSecondParagraph,13),new Cr(WacWordeditorStrings.Designer_BlankDocumentThirdParagraph,
13),new Cr(WacWordeditorStrings.Designer_BlankDocumentFourthParagraph,13),new Cr(WacWordeditorStrings.Designer_BlankDocumentThirdHeading,5),new Cr(WacWordeditorStrings.Designer_BlankDocumentFifthParagraph,13)];Object(D.a)(Hz,"BlankDocumentEditor",null,[1114]);e(423);class cH extends Uj.a{constructor(){super();cH.resolveInheritance();this.$$ge=this.getEnumerator}}Object(D.a)(cH,"IntSet",Uj.a,[18,17]);e(260);e(320);var PJ=e(1692);const hq=[Te.RoleType.Title,Te.RoleType.Subtitle,Te.RoleType.Heading1,
Te.RoleType.Heading2,Te.RoleType.Heading3,Te.RoleType.Heading4,Te.RoleType.Heading5,Te.RoleType.Heading6,Te.RoleType.Heading7,Te.RoleType.Heading8,Te.RoleType.Heading9,Te.RoleType.BodyText,Te.RoleType.ListItem],QJ=[$f.FormattingSuggestionType.FontSize,$f.FormattingSuggestionType.FontFamily,$f.FormattingSuggestionType.FontColor,$f.FormattingSuggestionType.Alignment,$f.FormattingSuggestionType.Indentation,$f.FormattingSuggestionType.Bold,$f.FormattingSuggestionType.RightIndentation,$f.FormattingSuggestionType.Italic,
$f.FormattingSuggestionType.Underline,$f.FormattingSuggestionType.AllCaps,$f.FormattingSuggestionType.LineSpacing,$f.FormattingSuggestionType.BeforeSpacing,$f.FormattingSuggestionType.AfterSpacing,$f.FormattingSuggestionType.SpecialIndentType,$f.FormattingSuggestionType.SpecialIndentBy];class Ey extends Xr{static tvl(d){const n=d.map(B=>B.roleType);return hq.every(B=>n.includes(B))}static uvl(d){return d.every(n=>{const B=n.suggestions.map(Q=>Q.type);return QJ.every(Q=>B.includes(Q))})}}Object(D.a)(Ey,
"ACurrentThemeProvider",Xr,[]);class dH{constructor(){this.decorators=void 0;this.fontName=null;this.fontColor=this.fontSize=0;this.underline=this.italic=this.bold=!1;this.alignment=Tf.initial;this.allCaps=!1;this.rightIndent=this.leftIndent=this.afterSpacing=this.beforeSpacing=this.lineSpacing=0;this.specialIndentType=fh.initial;this.fontKerning=this.specialIndentBy=0}}Object(D.a)(dH,"DesignerStyle",null,[]);class RJ{constructor(){this.type=uf.theme;this.styles=this.id=this.name=null;this.decorators=
void 0;this.layout=null;this.accentColor=0;this.colorLabel=this.fontLabel=null;this.backgroundColor=void 0;this.isThemeInFavorites=this.isSimpleTheme=!1;this.collectionName=this.collectionId=null;this.IsL2Template=!1}}Object(D.a)(RJ,"DesignerTheme",null,[]);class Fw extends Ey{constructor(d){super();this.cVe=null;this.qNh=0;this.vIc=void 0;this.vi=!1;this.e6j=(n,B)=>{B.data.operationType===Qj.a.getTypeName()&&(B.data.annotation?B.data.annotation.annotationType!==PJ.ThemeExtractorAnnotation.getTypeName()?
F.ULS.shipAssertTag(543745801,3016,!1):(n=B.data.annotation.content)?n.roleCommonProperties?(n=n.roleCommonProperties,this.cVe=Fw.zxi(n,!1),Ey.tvl(n)&&Ey.uvl(n)&&Fw.zxi(n,!0),this.qNh=gc.a.We(),this.EOo(),this.sa.raiseEvent(Xr.gPa),F.ULS.sendTraceTag(524105094,3016,50,"theme provided")):(this.REo(),F.ULS.sendTraceTag(524105093,3016,50,"no roleCommonProperties")):F.ULS.shipAssertTag(543745802,3016,!1):F.ULS.shipAssertTag(543745800,3016,!1))};this.DTc=d}get Uam(){return this.cVe}Sbe(){return[]}Flc(){return null}I7c(){const d=
new vn.a(ja.a.Oh());this.cVe&&d.add(Fw.jhi,255);return d}H1(){return!1}mle(){}initialize(){this.vi||(F.ULS.sendTraceTag(540312158,3016,50,"CurrentThemeProvider - initialize"),this.DTc.register(),this.DTc.IJ(this.e6j),this.DTc.GCa(new PJ.ThemeExtractorSignal),this.vi=!0)}he(){this.vi&&(F.ULS.sendTraceTag(540312159,3016,50,"CurrentThemeProvider - deinitialize"),this.DTc.iM(this.e6j),this.DTc.unregister(),this.vi=!1)}XT(){return 1E3>gc.a.We()-this.qNh}REo(){void 0!==this.vIc&&this.vIc.reject(Error("Theme was not extracted successfully"))}EOo(){void 0!==
this.vIc&&(this.vIc.resolve(this.Uam),this.vIc=void 0)}static zxi(d,n=!0){const B=new vn.a(ja.a.Oh());for(var Q of d)if(n||!Q.isGenerated){d=new dH;for(var ha of Q.suggestions){var Aa=ha.fixedValue;switch(ha.type){case $f.FormattingSuggestionType.FontSize:d.fontSize=parseFloat(Aa)/2;break;case $f.FormattingSuggestionType.FontFamily:d.fontName=Aa;break;case $f.FormattingSuggestionType.FontColor:d.fontColor=parseInt(Aa);break;case $f.FormattingSuggestionType.Alignment:d.alignment=this.PXl(parseInt(Aa));
break;case $f.FormattingSuggestionType.Indentation:d.leftIndent=parseFloat(Aa);break;case $f.FormattingSuggestionType.Bold:d.bold="true"===Aa;break;case $f.FormattingSuggestionType.RightIndentation:d.rightIndent=parseFloat(Aa);break;case $f.FormattingSuggestionType.Italic:d.italic="true"===Aa;break;case $f.FormattingSuggestionType.Underline:d.underline="true"===Aa;break;case $f.FormattingSuggestionType.AllCaps:d.allCaps="true"===Aa;break;case $f.FormattingSuggestionType.LineSpacing:d.lineSpacing=
parseFloat(Aa);break;case $f.FormattingSuggestionType.BeforeSpacing:d.beforeSpacing=parseFloat(Aa);break;case $f.FormattingSuggestionType.AfterSpacing:d.afterSpacing=parseFloat(Aa);break;case $f.FormattingSuggestionType.SpecialIndentType:d.specialIndentType=this.Kip(parseInt(Aa));break;case $f.FormattingSuggestionType.SpecialIndentBy:d.specialIndentBy=parseFloat(Aa)}}Aa=Yn.f(Q.roleType);B.add(Yn.h(Aa),d)}n=Object;Q=n.assign;ha=new RJ;d=Fw.jhi;Aa=new Map;for(const bb of B)Aa.set(bb.key,bb.value);return Q.call(n,
ha,{name:d,styles:Aa})}static PXl(d){switch(d){case 0:return Tf.left;case 1:return Tf.right;case 2:return Tf.center;case 3:return Tf.justify;default:return Tf.left}}static Kip(d){switch(d){case 0:return fh.firstLine;case 1:return fh.hanging;default:return fh.firstLine}}}Fw.jhi="CurrentTheme";Object(D.a)(Fw,"CurrentThemeProvider",Ey,[]);var Fy=e(55);class Nq{static gBl(d){let n;[d,B,n]=Vf.a.Xde(d);d=255*d/Vf.a.L9;n=255*n/Vf.a.L9;var B=255*B/Vf.a.L9;if(240<n)return WacWordeditorStrings.ColorWhite;if(20>
n)return WacWordeditorStrings.ColorBlack;if(20>=B)return 170<n?WacWordeditorStrings.ColorGray25:100<n?WacWordeditorStrings.ColorGray50:WacWordeditorStrings.ColorGray80;B=20<B&&75>=B?Nq.Tlk:75<B&&115>=B?Nq.Ulk:115<B&&150>=B?Nq.Vlk:150<B&&240>=B?Nq.Wlk:Nq.Xlk;let Q=0;for(;Q<B.length&&d>=B[Q];)Q++;if(Q==B.length)F.ULS.sendTraceTag(512570762,3023,10,"Hue index out of bounds");else return n>Nq.mnk[Q]?Nq.fkk[Q]:n<Nq.nnk[Q]?Nq.ekk[Q]:Nq.gkk[Q]}}Nq.fkk=[WacWordeditorStrings.ColorCoral,WacWordeditorStrings.ColorRose,
WacWordeditorStrings.ColorLightOrange,WacWordeditorStrings.ColorTan,WacWordeditorStrings.ColorTan,WacWordeditorStrings.ColorLightYellow,WacWordeditorStrings.ColorLightYellow,WacWordeditorStrings.ColorTan,WacWordeditorStrings.ColorLightGreen,WacWordeditorStrings.ColorLime,WacWordeditorStrings.ColorLightGreen,WacWordeditorStrings.ColorLightGreen,WacWordeditorStrings.ColorAqua,WacWordeditorStrings.ColorSkyBlue,WacWordeditorStrings.ColorLightTurquoise,WacWordeditorStrings.ColorPaleBlue,WacWordeditorStrings.ColorLightBlue,
WacWordeditorStrings.ColorIceBlue,WacWordeditorStrings.ColorPeriwinkle,WacWordeditorStrings.ColorLavender,WacWordeditorStrings.ColorPink,WacWordeditorStrings.ColorTan,WacWordeditorStrings.ColorRose];Nq.gkk=[WacWordeditorStrings.ColorCoral,WacWordeditorStrings.ColorRed,WacWordeditorStrings.ColorOrange,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorTan,WacWordeditorStrings.ColorGold,WacWordeditorStrings.ColorYellow,WacWordeditorStrings.ColorOliveGreen,WacWordeditorStrings.ColorOliveGreen,
WacWordeditorStrings.ColorGreen,WacWordeditorStrings.ColorGreen,WacWordeditorStrings.ColorBrightGreen,WacWordeditorStrings.ColorTeal,WacWordeditorStrings.ColorAqua,WacWordeditorStrings.ColorTurquoise,WacWordeditorStrings.ColorPaleBlue,WacWordeditorStrings.ColorBlue,WacWordeditorStrings.ColorBlueGray,WacWordeditorStrings.ColorIndigo,WacWordeditorStrings.ColorGalleryStandardColor10,WacWordeditorStrings.ColorPink,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorRed];Nq.ekk=[WacWordeditorStrings.ColorBrown,
WacWordeditorStrings.ColorDarkRed,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorDarkYellow,WacWordeditorStrings.ColorDarkYellow,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorDarkGreen,WacWordeditorStrings.ColorDarkGreen,WacWordeditorStrings.ColorDarkGreen,WacWordeditorStrings.ColorDarkGreen,WacWordeditorStrings.ColorDarkTeal,WacWordeditorStrings.ColorDarkTeal,WacWordeditorStrings.ColorDarkTeal,WacWordeditorStrings.ColorDarkBlue,
WacWordeditorStrings.ColorDarkBlue,WacWordeditorStrings.ColorBlueGray,WacWordeditorStrings.ColorIndigo,WacWordeditorStrings.ColorDarkPurple,WacWordeditorStrings.ColorPlum,WacWordeditorStrings.ColorBrown,WacWordeditorStrings.ColorDarkRed];Nq.Tlk=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0];Nq.Ulk=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256];Nq.Vlk=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256];Nq.Wlk=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,
140,0,180,0,0,224,241,0,256];Nq.Xlk=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,0,256];Nq.nnk=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100];Nq.mnk=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165];Object(D.a)(Nq,"ColorNaming",null,[]);const Gw=new Map([[3044790,3044790],[5269211,5269211],[32684,32684],[15362836,8600587],[13977459,11348049],[169590,160089],[1596093,1596093]]),eH=WacWordeditorStrings.DesignerStyleTabularTitleDecoratorAltTextTitle,
NC=WordRibbonStrings.DesignerStyleCoverPageDecoratorAriaLabel,st=new Map([[Rm.a.kh("D10TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD10TIAltTextTitle,width:624,height:193}],[Rm.a.kh("D1TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD1TIAltTextTitle,width:624,height:190}],[Rm.a.kh("D6TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD6TIAltTextTitle,width:624,height:193}],[Rm.a.kh("D7TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD7TIAltTextTitle,width:1575,height:728}],
[Rm.a.kh("D31TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD31TIAltTextTitle,width:1428,height:390}],[Rm.a.kh("D3TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD3TIAltTextTitle,width:2216,height:720}],[Rm.a.kh("D8TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TIAltTextTitle,width:1852,height:694}],[Rm.a.kh("D2TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD2TIAltTextTitle,width:1299,height:471}],[Rm.a.kh("D8TI1.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TI1AltTextTitle,
width:1661,height:785}],[Rm.a.kh("D8TI2.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TI2AltTextTitle,width:1619,height:848}],[Rm.a.kh("D8TI3a.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TI3aAltTextTitle,width:1602,height:473}],[Rm.a.kh("D8TI4a.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TI4aAltTextTitle,width:1613,height:211}],[Rm.a.kh("D8TI5.png"),{altText:WacWordeditorStrings.DesignerStyleImageD8TI5AltTextTitle,width:1595,height:498}],[Rm.a.kh("D10TI2.png"),{altText:WacWordeditorStrings.DesignerStyleImageD10TI2AltTextTitle,
width:1281,height:357}],[Rm.a.kh("D30TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageD30TIAltTextTitle,width:1377,height:315}],[Rm.a.kh("DCL1TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageDCL1TIAltTextTitle,width:2017,height:800}],[Rm.a.kh("DCL3TI.png"),{altText:WacWordeditorStrings.DesignerStyleImageDCL3TIAltTextTitle,width:1246,height:551}],[Rm.a.kh("D1CP1.png"),{altText:WacWordeditorStrings.DesignerStyleImageD1CP1AltTextTitle,width:2112,height:1364}],[Rm.a.kh("D1CP2.png"),{altText:WacWordeditorStrings.DesignerStyleImageD1CP2AltTextTitle,
width:624,height:624}],[Rm.a.kh("D1CP3.png"),{altText:WacWordeditorStrings.DesignerStyleImageD1CP3AltTextTitle,width:624,height:433}],[Rm.a.kh("D1CP4.png"),{altText:WacWordeditorStrings.DesignerStyleImageD1CP4AltTextTitle,width:624,height:416}]]);var Is=e(605),yx=e(1177),Hw=e(286);class Rj{static ZYm(){Rj.Lb||(Rj.Lb=new ig.ScriptSharpLegacyMap,Rj.Lb.add(xd.a.font,qt.a.zL),Rj.Lb.add(Dd.a.tf,-1),Rj.Lb.add(Dd.a.nf,-1),Rj.Lb.add(Dd.a.If,-1),Rj.Lb.add(Dd.a.vf,-1),Rj.Lb.add(Dd.a.mf,-1),Rj.Lb.add(Dd.a.j4,
""),Rj.Lb.add(Dd.a.t8,""),Rj.Lb.add(Dd.a.oH,""),Rj.Lb.add(Dd.a.j9,""),Rj.Lb.add(Dd.a.G4,""),Rj.Lb.add(xd.a.fontSize,qt.a.AL),Rj.Lb.add(xd.a.fontColor,Vf.a.auto),Rj.Lb.add(xd.a.highlight,Vf.a.auto),Rj.Lb.add(Ya.a.shading,Vf.a.auto),Rj.Lb.add(xd.a.bE,0),Rj.Lb.add(xd.a.bold,!1),Rj.Lb.add(xd.a.italic,!1),Rj.Lb.add(xd.a.underline,!1),Rj.Lb.add(xd.a.underlineType,qt.a.oX),Rj.Lb.add(xd.a.strikethrough,!1),Rj.Lb.add(Ya.a.Ew,!1),Rj.Lb.add(xd.a.superscript,!1),Rj.Lb.add(xd.a.subscript,!1),Rj.Lb.add($m.a.kib,
!1),Rj.Lb.add(Dd.a.cA,""),Rj.Lb.add(xd.a.tG,!1),Rj.Lb.add(xd.a.dda,!1),Rj.Lb.add(xd.a.isHidden,!1),Rj.Lb.add(Dd.a.Ivb,!1),Rj.Lb.add(Dd.a.PRb,0),Rj.Lb.add(Dd.a.noProof,!1),Rj.Lb.add(oh.a.zmj,!1),Rj.Lb.add(Ya.a.capitalization,0),Rj.Lb.add(Dd.a.aoa,!1),Rj.Lb.add(Dd.a.d$,0),Rj.Lb.add(Dd.a.vF,0),Rj.Lb.add(Dd.a.Fwa,0),Rj.Lb.add(Dd.a.lv,0),Rj.Lb.add(Dd.a.IW,0),Rj.Lb.add(Dd.a.ve,0),Rj.Lb.add(Dd.a.Ax,0),Rj.Lb.add(Dd.a.lFa,0),Rj.Lb.add(Ya.a.Xse,0),Rj.Lb.add(Ya.a.Wse,0),Rj.Lb.add(Dd.a.vk,Hw.a.UHg),Rj.Lb.add(Dd.a.ua,
Hw.a.p1j),Rj.Lb.add(Dd.a.ya,Hw.a.ya),Rj.Lb.add(Dd.a.xa,Hw.a.lineSpacing),Rj.Lb.add(Dd.a.Lia,Hw.a.Q_f),Rj.Lb.add(Dd.a.Kia,Hw.a.B_f),Rj.Lb.add(Dd.a.P5,Hw.a.q1j),Rj.Lb.add(Dd.a.O5,Hw.a.o1j),Rj.Lb.add(xd.a.Ki,0),Rj.Lb.add(xd.a.au,0),Rj.Lb.add(Ya.a.Rwe,!1),Rj.Lb.add(Dd.a.tA,null),Rj.Lb.add(Dd.a.kE,null),Rj.Lb.add(Dd.a.jE,null),Rj.Lb.add(Dd.a.jk,-1));return Rj.Lb}}Rj.Lb=null;Object(D.a)(Rj,"DefaultStyle",null,[]);class cB{constructor(d,n,B,Q,ha){this.fra=d;this.Ge=n;this.kec=B;this.NQd=Q;this.HTe=ha}x7l(d){return this.tVn(d)}zgb(d){var n=
qj.a.Pp();n=wq.a.instance.wDi(n);d.layout||(d.layout={marginTop:yf.a.l2d,marginBottom:yf.a.l2d,marginLeft:yf.a.l2d,marginRight:yf.a.l2d});n.properties.setValue(Dd.a.marginTop,Mi.a.pF(d.layout.marginTop));n.properties.setValue(Dd.a.marginBottom,Mi.a.pF(d.layout.marginBottom));n.properties.setValue(Dd.a.marginLeft,Mi.a.pF(d.layout.marginLeft));n.properties.setValue(Dd.a.marginRight,Mi.a.pF(d.layout.marginRight))}tVn(d){if(!d)return F.ULS.shipAssertTag(574755655,3016,!1),!1;let n=!0;d.type===uf.templateTheme&&
this.zgb(d);const B=this.Ge.Il();if(d.styles.has("BodyText")){var Q=d.styles.get("BodyText");n=this.ekj(Q,13,B)}else F.ULS.shipAssertTag(543745807,3016,!1);d.styles.forEach((ha,Aa)=>{Aa=Yn.g(Aa);if(13!==Aa&&14!==Aa||14===Aa&&this.fra.vva())n=this.ekj(ha,Aa,B)});if(this.fra.m1i())for(Q=16;25>=Q;Q++){const ha=Yn.h(Q);d.styles.has(ha)||this.gDp(Q,d,B)||(n=!1)}return n}ekj(d,n,B){var Q;let ha=Yn.j(n),Aa=B.Qg(ha);!Aa&&14===n&&this.fra.vva()&&(F.ULS.sendTraceTag(null,3018,15,"No Caption style in the document."),
ha=Yn.j(13),Aa=B.Qg(ha));B=2===(null===(Q=this.HTe)||void 0===Q?void 0:Q.eYa())?cB.Wzf(d,n,!0):this.MSm(n,d,Aa);if(Aa){if(this.NQd.put(ha,Aa.clone().rj()),B&&!this.kec.IEa(Yn.j(n),B,null))return!1}else return F.ULS.shipAssertTag(571999311,3016,!1),!1;return!0}gDp(d,n,B){const Q=Yn.j(d);B=B.Qg(Q);if(!B)return F.ULS.shipAssertTag(571012639,3016,!1),!1;const ha=new ig.ScriptSharpLegacyMap;n=n.accentColor;d=Yn.c(d)?Gw.has(n)?Gw.get(n):0:0;ha.add(xd.a.fontColor,0===d?Vf.a.auto:Vf.a.gja(d));this.NQd.put(Q,
B.clone().rj());return this.kec.IEa(Q,ha,null)}MSm(d,n,B){d=cB.Wzf(n,d);if(B&&(B=B.Ak()))for(n=0;n<B.length;n++){const Q=B[n];if(!d.Bb(Q)){let ha;({value:ha}=Rj.ZYm().Nc(Q,ha)).returnValue&&d.add(Q,ha)}}return d}static Wzf(d,n,B=!1){const Q=new ig.ScriptSharpLegacyMap;if(d.fontName){const ha=HE(d.fontName);Q.add(Dd.a.j4,ha);Q.add(xd.a.font,ha)}void 0!==d.fontColor&&Q.add(xd.a.fontColor,0===d.fontColor?Vf.a.auto:Vf.a.gja(d.fontColor));void 0!==d.bold&&Q.add(xd.a.bold,d.bold);void 0!==d.italic&&Q.add(xd.a.italic,
d.italic);void 0!==d.underline&&Q.add(xd.a.underline,d.underline);void 0!==d.allCaps&&Q.add(Ya.a.capitalization,d.allCaps?2:0);if(B)return Q;void 0!==d.fontSize&&Q.add(xd.a.fontSize,2*d.fontSize);void 0!==d.alignment&&Q.add(xd.a.Ki,cB.QXl(d.alignment));void 0!==d.beforeSpacing&&Q.add(Dd.a.vk,Mi.a.fM(d.beforeSpacing));void 0!==d.afterSpacing&&Q.add(Dd.a.ua,Mi.a.fM(d.afterSpacing));Q.add(Dd.a.eA,15===n);Q.add(Dd.a.jk,Yn.a(n));d.lineSpacing&&(n=Object.assign(new Is.a,{unit:2,value:d.lineSpacing}),({xa:n,
Xhk:B}=yx.a.pGi(n)).returnValue?(Q.add(Dd.a.ya,B),Q.add(Dd.a.xa,n)):F.ULS.shipAssertTag(592454611,3016,!1));switch(d.specialIndentType){case fh.firstLine:Q.add(Dd.a.vF,Mi.a.pF(d.specialIndentBy));break;case fh.hanging:Q.add(Dd.a.lv,Mi.a.pF(d.specialIndentBy))}return Q}static QXl(d){switch(d){case Tf.left:return 1;case Tf.center:return 2;case Tf.right:return 3;case Tf.justify:return 6;default:return F.ULS.shipAssertTag(592720768,3016,!1),null}}}Object(D.a)(cB,"StyleManager",null,[1059]);class fH{constructor(d,
n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk){this.Tb=d;this.fN=n;this.Wn=B;this.Yf=Q;this.ub=ha;this.Kj=Aa;this.s6=bb;this.dM=Ib;this.Ug=oc;this.Un=Ac;this.eT=ad;this.Qn=sd;this.wC=wd;this.Qj=yd;this.Ewa=be;this.kc=ye;this.Rda=Qe;this.g4=af;this.oe=Qf;this.RZb=hf;this.Ir=di;this.wu=vj;this.hN=Wk;this.aii=36;this.Rjj=20}zlf(d,n,B){var Q,ha,Aa,bb,Ib,oc,Ac;if(d)if(n){var ad=!0,sd=null===(Q=this.ub.ob)||void 0===Q?void 0:Q.currentSelection;d=bf.ParagraphReader.Vn(d,!0,!0);null===(ha=
this.Ir)||void 0===ha?void 0:ha.Q2a();ha=this.Zgn(d,n);null===(Aa=this.Ir)||void 0===Aa?void 0:Aa.JVa();ad&&(ad=0<(null===ha||void 0===ha?void 0:ha.length));if(ad){B===uf.templateTheme&&this.TWl(ha);Aa=new Set;ad=new Map;for(const wd of ha)wd.DI&&Aa.add(wd.DI);this.dqo(Aa,n,ad)?this.NGp(ha,n,ad,B)?(this.eqo(Aa,n),this.Fio(ha,n),this.scrollIntoView(ha,B===uf.templateTheme),B!==uf.templateTheme&&(null===(Ib=null===(bb=null===sd||void 0===sd?void 0:sd.Ya)||void 0===bb?void 0:bb.node)||void 0===Ib?0:
Ib.isConnected)&&(null===(oc=this.Ir)||void 0===oc?void 0:oc.Q2a(),this.ub.Uc(sd),null===(Ac=this.Ir)||void 0===Ac?void 0:Ac.JVa())):F.ULS.shipAssertTag(520937801,3016,!1):F.ULS.shipAssertTag(520937802,3016,!1)}else F.ULS.shipAssertTag(520937803,3016,!1)}else F.ULS.shipAssertTag(536941707,3016,!1);else F.ULS.shipAssertTag(536941706,3016,!1)}TWl(d){if(0<(null===d||void 0===d?void 0:d.length)){const n=d[d.length-1];!this.Wn.Ag(n).Ib(14)&&bf.ParagraphReader.isEmpty(this.Wn.Ag(n))&&(this.Yf.hxa(n),d.pop())}}dqo(d,
n,B){let Q=void 0,ha=!0;try{Q=this.wC.Vc(15,Se.a.Zbb,!1);Q.KB.Eb(this.Kh);for(const Aa of d)ha&&(ha=this.vOo(Aa,n,B)),yl(Aa,this.Kj,!1,bb=>bb.eh),Ur(Aa,this.Kj,NC),n.widthOption===Yi.stretchEdgeToEdge&&(this.s6.setCellPadding(Aa,1,this.aii),this.s6.setCellPadding(Aa,3,this.aii))}finally{Q&&Q.dispose()}return ha}Fio(d,n){for(const B of d)B.DI||this.fN.write(B,n)}eqo(d,n){var B;for(const Q of d)n.heightOption===xm.stretchInsideMargins&&this.mgm(Q),d=Oh(Q,[]),this.fN.write(Q,n,d),(null===(B=this.hN)||
void 0===B?0:B.hWd)||this.Aio(d,Q)}Aio(d,n){const B=this.wC.Vc(15,Se.a.P2d);try{B.KB.Eb(this.Kh),VA(d,n,this.Rda,zp.a.Dhc)}finally{B.dispose()}}rHo(d){const n=this.wC.Vc(15,Se.a.Bfb,!1);try{n.KB.Eb(this.Kh);var B=this.Wn,Q=this.Yf;const ha=B.Ag(d);null!==ha&&ha.Wd()&&(ha.qh(),B.XDi(ha).xl()?ha.qh():Q.dN(ha))}finally{n&&n.dispose()}}fwg(d){const n=this.wC.Vc(15,Se.a.Bfb,!1);try{n.KB.Eb(this.Kh);ox(d,this.Wn);if(this.oe.I6i()){let B=void 0,Q=void 0;const ha=bf.ParagraphReader.ox(d,!1,!1,!1);for(let Aa=
ha.count-1;0<=Aa;Aa--){const bb=ha.K(Aa);if(!bf.ParagraphReader.lc(bb))continue;const Ib=this.kc.nTb(bb);B||Ib!==Yn.k(2)||bf.ParagraphReader.U5(bb)===WacWordeditorStrings.Designer_CoverPageTitle||(B=bb,this.lRi(B,2));Q||Ib!==Yn.k(3)||bf.ParagraphReader.U5(bb)===WacWordeditorStrings.Designer_CoverPageSubtitle||(Q=bb,this.lRi(Q,3));if(B&&Q)break}}this.s6.OY(d)}finally{n&&n.dispose()}}uvg(d){this.fN.read(d)&&(!xq(d,12)||null!==d&&void 0!==d&&d.DI?xq(d,14)&&gq(d,this.Wn)&&this.fwg(d):this.rHo(d))}bJf(d){var n,
B,Q,ha;if(!d)return null;const Aa=new Map,bb=atob(null===d||void 0===d?void 0:d.htmlToPaste),Ib=On(bb);if(d.styleOverrides)for(const oc of d.styleOverrides){const Ac=Yn.f(oc.type);Aa.set(Yn.h(Ac),{fontName:oc.style.fontFamily?sx(oc.style.fontFamily):void 0,fontSize:oc.style.fontSize,fontColor:oc.style.fontColor,bold:oc.style.bold,italic:oc.style.italic,underline:oc.style.underline,alignment:oc.style.alignment,lineSpacing:oc.style.lineSpacing,beforeSpacing:oc.style.beforeSpacing,afterSpacing:oc.style.afterSpacing,
specialIndentType:oc.style.specialIndentType,specialIndentBy:oc.style.specialIndentBy,fontKerning:oc.style.fontKerning,allCaps:oc.style.allCaps})}return{htmlToPaste:bb,htmlToPasteDark:Ib,imagePaths:null===(n=null===d||void 0===d?void 0:d.imagePaths)||void 0===n?void 0:n.map(oc=>Rm.a.kh(oc)),imageThumbnailPaths:null===(B=null===d||void 0===d?void 0:d.imagePaths)||void 0===B?void 0:B.map(oc=>Rm.a.kh("Thumbnail_"+oc)),thumbnailImage:Rm.a.kh(null===d||void 0===d?void 0:d.thumbnailImage),widthOption:null===
d||void 0===d?void 0:d.widthOption,heightOption:null===d||void 0===d?void 0:d.heightOption,type:Me.complexDecorator,hasImages:null!==(ha=null===(Q=null===d||void 0===d?void 0:d.imagePaths)||void 0===Q?void 0:Q.length)&&void 0!==ha?ha:!1,styleOverrides:Aa}}Wed(d){return Br(d,this.fN,this.Rda,this.Wn,zp.a.Dhc)}Zgn(d,n){var B=bf.ParagraphReader.Vn(this.Kh,!0,!0);(new vc.a).set(B);B=this.wC.Vc(4,Se.a.nKa);try{B.KB.Eb(this.Kh);const Q=this.Wn.Ag(d);if(!Ap(Q)){F.ULS.shipAssertTag(536941711,3016,!1);return}this.Yf.mA(Q,
!0,!1,null,!1,!1);const ha=new nu.a,Aa=this.kc.Il();ha.Cqa=Aa.Qg(kr.a.wDb);const bb=this.Yf.dN(Q,ha);this.ub.Uc(new Ph.Selection([ge.a.jd(bb,0)],!0))}finally{B&&B.dispose()}return wy(n.htmlToPaste,this.Tb,this.ub)}vOo(d,n,B){const Q=Ws(d);if(!Q)return F.ULS.shipAssertTag(536941712,3016,!1),!1;n.heightOption===xm.stretchInsideMargins&&this.lmp(d,Q);n.widthOption!==Yi.stretchInsideMargins&&n.widthOption!==Yi.stretchEdgeToEdge||this.mmp(d,Q,n.widthOption===Yi.stretchEdgeToEdge);B.set(d,this.LRf(d));
return!0}lmp(d,n){n=qa.a.Zn(qa.a.Zj(n.pageHeight-n.marginTop-n.marginBottom,1),1);const B=oj.TableReader.VJf(d);var Q=new vc.a;Q.set(d);Q=oj.TableReader.gbe(Q);var ha=Q.reduce((Aa,bb)=>Aa+bb);ha=0<ha?n/ha:void 0;if(1!==ha)for(let Aa=0;Aa<B.count;Aa++){let bb;bb=ha?Q[Aa]*ha:n/oj.TableReader.Hg(d);this.Kj.s2b(B.K(Aa),bb-.5/oj.TableReader.Hg(d))}}mmp(d,n,B){var Q=n.pageWidth;B?(d.properties.setValue(Dd.a.ve,-n.marginLeft),d.properties.setValue(Dd.a.Ax,-n.marginRight)):Q=Q-n.marginLeft-n.marginRight;
B=qa.a.Zn(qa.a.Zj(Q,0),0);n=this.LRf(d);Q=n.reduce((ha,Aa)=>ha+Aa);B/=Q;for(Q=0;Q<n.length;Q++)this.Kj.Gxa(d,Q,n[Q]*B)}tOo(d){var n,B,Q,ha,Aa=d.currentNode;if(Aa&&!Aa.eh){var bb=bf.ParagraphReader.ox(Aa,!1,!1,!1);if(d=ef.e(d))if(d=Fy.a.knc(d),0>=d)F.ULS.shipAssertTag(523551523,3016,!1);else if(this.wu.Pd){if(Aa=Aa.Dm(this.wu.Pd.Lc))if(Aa=qa.a.Zn(Aa.y8d(),1)/d,1<Aa)for(const Ib of bb)if(bf.ParagraphReader.lc(Ib)){bb=ge.a.createTextRange(Ib,0,bf.ParagraphReader.textLength(Ib));bb=pt.a.uu(bb);d=null!==
(ha=null===(Q=null===(B=null===(n=null===bb||void 0===bb?void 0:bb.Rb)||void 0===n?void 0:n.formatting)||void 0===B?void 0:B.cache)||void 0===Q?void 0:Q.fontSize)&&void 0!==ha?ha:void 0;if(void 0===d){F.ULS.shipAssertTag(523548884,3016,!1);break}d=Math.floor(d/Aa);d<this.Rjj&&(F.ULS.sendTraceTag(523548885,3016,50,"Font size limit reached"),d=this.Rjj);this.Qj.qm(bb,xd.a.fontSize,d)}}else F.ULS.shipAssertTag(509667290,3016,!1);else F.ULS.shipAssertTag(523551522,3016,!1)}}NGp(d,n,B,Q){var ha=bf.ParagraphReader.ox(this.Kh,
!1,!1,!1);const Aa=new ma.a;for(var bb of ha)d.includes(bb)||Aa.add(bb);ha=this.Qn.$Ii(new Set([2,3]),Aa);for(const Ib of d)if(bf.ParagraphReader.lc(Ib))if(d=bf.ParagraphReader.U5(Ib).trim(),d.startsWith("Image"))this.g4.Wif(),this.ODp(Ib,n,B);else if(Q!==uf.templateTheme)switch(d){case "Title":d=void 0;ha.has(2)&&(d=ha.get(2).K(0));!d&&1<Aa.count&&(bb=Aa.K(1),this.kc.Je(this.kc.Lr(bb))===kr.a.wDb&&(d=bb));this.eRi(Ib,d,2,n);break;case "Subtitle":d=void 0;ha.has(3)&&(d=ha.get(3).K(0));!d&&2<Aa.count&&
(bb=Aa.K(2),this.kc.Je(this.kc.Lr(bb))===kr.a.Sxd&&(d=bb));this.eRi(Ib,d,3,n);break;case "Author":d=this.Un.qA.IsAnonymous?WacWordeditorStrings.Designer_CoverPageAuthorName:this.Un.qA.Name;d.endsWith(" \ud83c\udf0e")&&(d=Array.from(d).slice(0,-2).join(""));this.qIe(Ib,d,13,n);break;case "Company":this.qIe(Ib,WacWordeditorStrings.Designer_CoverPageCompanyName,13,n);break;case "Date":this.qIe(Ib,(new Date).toLocaleDateString(),5,n)}return!0}KKj(d,n){d=ge.a.createTextRange(d,0,bf.ParagraphReader.textLength(d));
this.Ug.lf(d,n)}Kel(d,n,B){if(B.styleOverrides&&B.styleOverrides.has(Yn.h(n))){B=B.styleOverrides.get(Yn.h(n));n=cB.Wzf(B,n);B=ge.a.createTextRange(d,0,bf.ParagraphReader.textLength(d));B=pt.a.uu(B);var Q=new Set;Q.add(xd.a.Ki);Q.add(Dd.a.vk);Q.add(Dd.a.ua);Q.add(Dd.a.ya);Q.add(Dd.a.xa);Q.add(Dd.a.ve);Q.add(Dd.a.Ax);for(const ha of n.keys)Q.has(ha)?d.setValue(ha,n.K(ha)):this.Qj.qm(B,ha,n.K(ha))}}qIe(d,n,B,Q){const ha=this.wC.Vc(15,Se.a.nKa);try{ha.KB.Eb(this.Kh),this.KKj(d,n),this.dM.$la(d,B),this.Kel(d,
B,Q)}finally{ha&&ha.dispose()}}ODp(d,n,B){var Q=bf.ParagraphReader.U5(d).trim().split(" ");if(2!==Q.length)F.ULS.shipAssertTag(536941713,3016,!1);else if(Q=Number(Q[1]),isNaN(Q))F.ULS.shipAssertTag(536941714,3016,!1);else{var ha=this.wC.Vc(15,Se.a.nKa);try{ha.KB.Eb(this.Kh),this.KKj(d,""),this.ALo(d,n.imagePaths[Q],B)}finally{ha&&ha.dispose()}}}lRi(d,n){Nt(d,this.Yf,this.Wn,this.RZb,this.Ug,this.kc,this.dM,this.Qn);this.dM.$la(d,n)}lMm(d){switch(d){case 2:return WacWordeditorStrings.Designer_CoverPageTitle;
case 3:return WacWordeditorStrings.Designer_CoverPageSubtitle;default:F.ULS.shipAssertTag(524115978,3016,!1)}}eRi(d,n,B,Q){n||F.ULS.sendTraceTag(521413784,3016,50,`Using placeholder string for ${Yn.h(B)}`);this.qIe(d,n?bf.ParagraphReader.U5(n):this.lMm(B),B,Q);this.oe.I6i()&&n&&(d=new vc.a,d.set(n),Ap(d),d.qh())}ALo(d,n,B){if(d.UKa&&d.DI){var Q=d.UKa;this.s6.setCellPadding(Q,1,0);this.s6.setCellPadding(Q,3,0);this.s6.setCellPadding(Q,0,0);this.s6.setCellPadding(Q,2,0);var ha=this.s6.fv(Q),Aa=new vc.a;
Aa.set(d.DI);ha=oj.TableReader.gbe(Aa).slice(ha,ha+Q.rowSpan).reduce((bb,Ib)=>bb+Ib,0);Aa=this.s6.A7c(Q);this.eT.fZf(n,d,!1,Se.a.Zbb,Se.a.qfe,{$od:{C3b:2,g1h:Aa,c1h:ha},altText:st.has(n)?st.get(n).altText:void 0,uee:Se.a.O$c},()=>{this.g4.jgg()&&this.oIp(B)});d=d.ka(xd.a.Ki,2);n=this.Wn.Lm();n.set(Q);n.ue();n.qh();n.ue();Q=n.ue();Q.setValue(xd.a.Ki,d);Q.setValue(Dd.a.Ax,0);Q.setValue(Dd.a.ve,0)}}oIp(d){for(const n of d.keys()){const B=this.LRf(n),Q=d.get(n);if(B.length!==Q.length){F.ULS.shipAssertTag(520644507,
3016,!1);break}for(let ha=0;ha<Q.length;ha++)B[ha]!==Q[ha]&&this.Kj.Gxa(n,ha,Q[ha])}}scrollIntoView(d,n){var B;d=n?d.filter(Q=>""!==(null===Q||void 0===Q?void 0:Q.characterData)):d;if(d=d.length?d[0]:void 0)this.ub.Uc(new Ph.Selection([ge.a.jd(d,0)],!0)),null===(B=this.Ir)||void 0===B?void 0:B.c6(0)}mgm(d){const n=this.wC.Vc(15,Se.a.Zbb,!1);try{n.KB.Eb(d);const B=new vc.a;B.set(d);ef.b(B,Q=>{this.tOo(Q);return!0})}finally{n.dispose()}}get Kh(){return this.Ewa.value}LRf(d){const n=new vc.a;n.set(d);
return oj.TableReader.Dca(n)}}Object(D.a)(fH,"ComplexDecoratorEditor",null,[1141]);var qn=e(1883),xo=e(74);class QE{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd){var be;this.Uzg=[xd.a.bold,xd.a.fontColor,xd.a.italic,xd.a.strikethrough,Ya.a.Ew,xd.a.subscript,xd.a.superscript,xd.a.underline,$m.a.kib,...((null===(be=np.a.getInstance())||void 0===be?0:be.Gv)?ve.a.ixb:[])];this.fra=d;this.RWe=n;this.xO=B;this.Pe=Q;this.Ww=ha;this.kEh=Aa;this.Gr=bb;this.z0=Ib;this.zg=oc;this.Hzh=Ac;this.Ge=ad;this.ee=
sd;this.fFd=wd;this.HTe=yd;d=this.Uzg.indexOf(xd.a.fontColor);-1<d&&this.Uzg.splice(d,1)}$la(d,n){var B,Q;if(d){var ha=this.Ge.Il().Qg(Yn.j(n));var Aa=!1;ha||14!==n||(ha=this.Ge.Il().Qg(Yn.j(13)),Aa=!0);this.fra.jun()&&15===n&&!this.Hzh.ZSb(d)&&this.Hzh.ZHl(d);if(this.fra.Lun()){var bb=Yn.b(n)||2===n||3===n||14===n;(14!==n||14===n&&this.fra.vva())&&this.Gr.IP(ha,d,!1,void 0,void 0,void 0,new qn.a(this.Uzg,bb,!0,!0))}else bb=this.kEh.RIi(d),(14!==n||14===n&&this.fra.vva())&&this.Gr.IP(ha,d,!1),this.kEh.hYh(d,
bb);14===n&&this.fra.vva()&&(Aa&&this.ldl(d,ha),this.MCp(d));2===(null===(B=this.HTe)||void 0===B?void 0:B.eYa())&&d.DI&&0!==(null===(Q=d.characterData)||void 0===Q?void 0:Q.trim().length)&&this.ogm(d)}else F.ULS.shipAssertTag(592720725,3016,!1)}ogm(d){var n,B=d.UKa;if(null===B||void 0===B?0:B.hasProperty(xd.a.YE)){var Q=B.getValue(xd.a.YE);B=this.xO.uu(ge.a.create(d));null!==(n=null===B||void 0===B?void 0:B.qp)&&void 0!==n&&n.hasProperty(xd.a.fontColor)||(n=this.Ge.Je(this.Ge.Lr(d)),n=this.Ge.Il().Qg(n),
n=null===n||void 0===n?void 0:n.getValue(xd.a.fontColor),1!==Vf.a.wab(Vf.a.Enf,Vf.a.cpb(n))&&Vf.a.wab(Vf.a.bKe,1!==Vf.a.cpb(n))&&(Q=Vf.a.wab(Vf.a.cpb(n),Vf.a.cpb(Q)),d=this.JGm(d),Q<d&&this.Pe.pma(B)))}}JGm(d){const n=d.ra?d.ra.length:0;let B=3;for(let Aa=0;Aa<n-1;Aa++){var Q=d.ra.jc(Aa);if(Q.formatting){var ha=this.xO.rh(Q.formatting,xd.a.fontSize,0);Q=this.xO.rh(Q.formatting,xd.a.bold,0);ha=18<=ha||14<=ha&&Q?3:4.5;ha>B&&(B=ha)}}return B}Oob(d,n){if(d)if(n){var B=ve.a.Qe?d:this.zg.pha(d),Q=null;
ve.a.isListItem(B)&&(Q=this.zg.P4(B));this.z0.zY(this.RWe(d,0,bf.ParagraphReader.textLength(d)),ha=>{for(const Aa of n)switch(Aa.type){case $f.FormattingSuggestionType.FontSize:this.tE(ha,Aa.fixedValue,B,d);break;case $f.FormattingSuggestionType.FontFamily:this.T0o(ha,Aa.fixedValue,B,Q,d);break;case $f.FormattingSuggestionType.FontColor:this.Uy(ha,Aa.fixedValue,B,d);break;case $f.FormattingSuggestionType.Bold:this.GP(ha,Aa.fixedValue,B,d);break;case $f.FormattingSuggestionType.Italic:this.cC(ha,Aa.fixedValue);
break;case $f.FormattingSuggestionType.Underline:this.z$(ha,Aa.fixedValue);break;case $f.FormattingSuggestionType.Indentation:case $f.FormattingSuggestionType.RightIndentation:this.C1o(d,Aa.type,Aa.fixedValue);break;case $f.FormattingSuggestionType.Alignment:this.SYo(d,Aa.fixedValue);break;case $f.FormattingSuggestionType.BeforeSpacing:this.DAb(d,Aa.fixedValue);break;case $f.FormattingSuggestionType.AfterSpacing:this.CAb(d,Aa.fixedValue);break;case $f.FormattingSuggestionType.LineSpacing:this.HG(d,
Aa.fixedValue)}})}else F.ULS.shipAssertTag(592720730,3016,!1);else F.ULS.shipAssertTag(592720729,3016,!1)}tE(d,n,B,Q){n=Number.parseInvariant(n);isNaN(n)?F.ULS.shipAssertTag(592527906,3016,!1):(this.Pe.tE(d,this.Pe.Hhc(n)),ve.a.isListItem(B)&&this.D2o(Q,n))}Uy(d,n,B,Q){n=Number.parseInvariant(n);isNaN(n)?F.ULS.shipAssertTag(592527907,3016,!1):(n=Ca.a.yL(n,6),this.Pe.Uy(d,n,null),ve.a.isListItem(B)&&this.C2o(Q,n))}T0o(d,n,B,Q,ha){n=n.split(",");if(0<n.length){n=n[0].trim();const Aa=this.xO.rh(d,xd.a.font,
"");Array.contains(yf.a.qvi,Aa)||(this.Pe.rja(d,n),ve.a.isListItem(B)&&Q&&!Q.listType&&this.B2o(ha,n))}}GP(d,n,B,Q){n=Boolean.parse(n);this.Pe.GP(d,n);ve.a.isListItem(B)&&this.A2o(Q,n)}cC(d,n){n=Boolean.parse(n);this.Pe.cC(d,n)}z$(d,n){n=Boolean.parse(n);this.Pe.z$(d,n)}C1o(d,n,B){var Q=parseFloat(B);isNaN(Q)?F.ULS.shipAssertTag(592454612,3016,!1):(B=this.Ww.Hs,Q=Mi.a.fM(Q),n===$f.FormattingSuggestionType.Indentation?B.lQa(d,1,Q):B.LAb(d,1,Q))}static RXl(d){switch(d){case Tf.left:return xo.a.Left;
case Tf.center:return xo.a.Center;case Tf.right:return xo.a.Right;case Tf.justify:return xo.a.Justified;default:return F.ULS.shipAssertTag(538240013,3016,!1),null}}SYo(d,n){n=Number.parseInvariant(n);if(isNaN(n))F.ULS.shipAssertTag(592454613,3016,!1);else{switch(n){case xo.a.Left:n=1;break;case xo.a.Right:n=3;break;case xo.a.Center:n=2;break;case xo.a.Justified:n=6;break;case xo.a.None:n=0;break;default:return}this.Ww.qJ(d,n)}}DAb(d,n){n=Number.parseInvariant(n);isNaN(n)?F.ULS.shipAssertTag(574433370,
3016,!1):this.Ww.DAb(d,new Is.a(4,n))}CAb(d,n){n=Number.parseInvariant(n);isNaN(n)?F.ULS.shipAssertTag(574433371,3016,!1):this.Ww.CAb(d,new Is.a(4,n))}HG(d,n){n=Number.parseInvariant(n);isNaN(n)?F.ULS.shipAssertTag(574433372,3016,!1):this.Ww.HG(d,new Is.a(2,n))}A2o(d,n){d=this.ee.J$a(d);this.Pe.GP(d,n)}C2o(d,n){d=this.ee.J$a(d);this.Pe.Uy(d,n,null)}D2o(d,n){d=this.ee.J$a(d);this.Pe.tE(d,n)}B2o(d,n){d=this.ee.J$a(d);this.Pe.rja(d,n)}ldl(d,n){if(null!=d&&null!=n){if(n.hasProperty(xd.a.fontSize)){var B=
n.getValue(xd.a.fontSize);12<=B/2&&(B-=2)}this.Oob(d,[{type:$f.FormattingSuggestionType.FontSize,fixedValue:B.toString()},{type:$f.FormattingSuggestionType.Italic,fixedValue:"true"}])}}MCp(d){var n=bf.ParagraphReader.Cg(d,!0);null!=n&&this.fFd.Mai(n)?this.Ww.qJ(d,bf.ParagraphReader.VA(n)):(n=bf.ParagraphReader.Cg(d,!1),null!=n&&this.fFd.Mai(n)&&this.Ww.qJ(d,bf.ParagraphReader.VA(n)))}}Object(D.a)(QE,"ParagraphDesigner",null,[1064]);class Iz{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,
Qe,af){this.Tb=d;this.fN=n;this.Wn=B;this.Yf=Q;this.dM=ha;this.ub=Aa;this.s6=bb;this.Kj=Ib;this.wC=oc;this.Xc=Ac;this.Ir=ad;this.Rda=sd;this.g4=wd;this.Ug=yd;this.RZb=be;this.kc=ye;this.Qn=Qe;this.eT=af}zlf(d,n){var B,Q,ha,Aa;if(d)if(n){var bb=null===(B=this.ub.ob)||void 0===B?void 0:B.currentSelection;if(this.insertTable(d,n)){B=this.wC.Vc(15,Se.a.nKa);var Ib=void 0,oc=void 0;try{B.KB.Eb(this.Xc.Fd);Ib=this.LTm(d);if(!Ib)return;oc=Oh(Ib,["ParagraphPlaceholder"]);this.alo(d,Ib,n);Ur(Ib,this.Kj,eH);
this.ACo(Ib);VA(oc,Ib,this.Rda,zp.a.CJg)}finally{B&&B.dispose()}this.ub.Uc(new Ph.Selection([ge.a.jd(d,0)],!0));null===(Q=this.Ir)||void 0===Q?void 0:Q.c6(0);null===(ha=this.Ir)||void 0===ha?void 0:ha.Q2a();this.ub.Uc(bb);null===(Aa=this.Ir)||void 0===Aa?void 0:Aa.JVa();this.fN.write(Ib,n,oc)}}else F.ULS.shipAssertTag(543737922,3016,!1);else F.ULS.shipAssertTag(543737921,3016,!1)}LTm(d){d=this.Wn.Ag(d);if(!Ap(d))return F.ULS.shipAssertTag(527541731,3016,!1),null;if(!d.xl())return F.ULS.shipAssertTag(527541760,
3016,!1),null;const n=d.CYa(0,B=>xq(B,14));return xq(d.currentNode,14)?n:null}uvg(d,n){var B,Q,ha;const Aa=null===(B=this.ub.ob)||void 0===B?void 0:B.currentSelection;this.ub.Uc(null);B=this.wC.Vc(15,Se.a.Bfb);try{B.KB.Eb(this.Xc.Fd),this.fwg(d,n)}finally{B&&B.dispose()}null===(Q=this.Ir)||void 0===Q?void 0:Q.Q2a();this.ub.Uc(Aa);null===(ha=this.Ir)||void 0===ha?void 0:ha.JVa()}fwg(d,n){var B;if(d&&n&&gq(d,this.Wn)){n=bf.ParagraphReader.ox(d,!1,!1);var Q=void 0,ha=this.fN.read(d).iVd;for(let Aa=n.count-
1;0<=Aa;Aa--){const bb=n.K(Aa),Ib=bb;if(0!==(null===(B=null===Ib||void 0===Ib?void 0:Ib.characterData)||void 0===B?void 0:B.trim().length)&&!ha.find(oc=>{var Ac,ad;return(null===(Ac=oc.id)||void 0===Ac?void 0:Ac.toString())===(null===(ad=Ib.id)||void 0===ad?void 0:ad.toString())})){if(!Nt(bb,this.Yf,this.Wn,this.RZb,this.Ug,this.kc,this.dM,this.Qn))return;Q||(Q=bb)}}ox(null!==Q&&void 0!==Q?Q:d,this.Wn);this.s6.OY(d)}}bJf(d){if(!d)return null;const n=Pu.yLo(atob(null===d||void 0===d?void 0:d.htmlTable)),
B=On(n[0]);return{htmlTable:n[0],htmlTableDark:B,hasImages:n[1],fontColor:null===d||void 0===d?void 0:d.fontColor,alignment:null===d||void 0===d?void 0:d.alignment,paragraphRow:null===d||void 0===d?void 0:d.paragraphRow,paragraphCol:null===d||void 0===d?void 0:d.paragraphCol,beforeSpacing:null===d||void 0===d?void 0:d.beforeSpacing,afterSpacing:null===d||void 0===d?void 0:d.afterSpacing,type:null===d||void 0===d?void 0:d.type}}Wed(d){return Br(d,this.fN,this.Rda,this.Wn,zp.a.CJg)}insertTable(d,n){const B=
this.Wn.Ag(d);if(!Ap(B))return F.ULS.shipAssertTag(542766210,3016,!1),!1;const Q=this.wC.Vc(4,Se.a.nKa);let ha;d=bf.ParagraphReader.Cg(d,!1);if(bf.ParagraphReader.lc(d)&&""===bf.ParagraphReader.U5(d))ha=d;else try{Q.KB.Eb(this.Xc.Fd),this.Yf.mA(B,!1,!1),ha=this.Yf.dN(B)}finally{Q&&Q.dispose()}this.ub.Uc(new Ph.Selection([ge.a.jd(ha,0)],!0));wy(n.htmlTable,this.Tb,this.ub);return!0}alo(d,n,B){const Q=this.Wn.Ag(n);Q.Ib(8)&&(ef.h(Q,B.paragraphRow,B.paragraphCol),xq(Q.currentNode,11)?(Q.ue(),Xn(d,Q.currentNode,
this.RZb,this.Ug,this.kc,this.dM,this.Qn,!0),this.cNb(Q.currentNode,n,B),d=this.Wn.Ag(d),d.Ib(8)&&(d.qh(),d.qh())):F.ULS.shipAssertTag(524115975,3016,!1))}ACo(d){const n=new vc.a;n.set(d);ef.b(n,B=>{if(!B.Dbb(11))return!0;B.ue();if(!B.Dbb(12))return B.Ac(),!0;B.ue();const Q=B.currentNode;xq(Q,12)&&this.gZf(Q);B.Ac();B.Ac();return!0})}gZf(d){const n=Pu.f$d(d);n&&(this.g4.Wif(),Pu.fTh(n,B=>{if((null===B||void 0===B?void 0:B.property)===oh.a.Iw)return this.eT.Gni(n,{$od:void 0,altText:eH,uee:Se.a.O$c}),
this.g4.jgg(),!0}))}cNb(d,n,B){this.dM.Oob(d,[{type:$f.FormattingSuggestionType.FontColor,fixedValue:B.fontColor.toString()},{type:$f.FormattingSuggestionType.Alignment,fixedValue:QE.RXl(B.alignment).toString()}]);const Q=null!==B.beforeSpacing&&void 0!==B.beforeSpacing,ha=null!==B.afterSpacing&&void 0!==B.afterSpacing;if(Q||ha){const Aa=[];Q&&Aa.push({type:$f.FormattingSuggestionType.BeforeSpacing,fixedValue:B.beforeSpacing.toString()});ha&&Aa.push({type:$f.FormattingSuggestionType.AfterSpacing,
fixedValue:B.afterSpacing.toString()});for(const bb of bf.ParagraphReader.ox(n,!1,!1))bb!==d&&this.dM.Oob(bb,Aa)}yl(n,this.Kj,!1,Aa=>Aa.eh)}}Object(D.a)(Iz,"TableDecoratorEditor",null,[1141]);class tt{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.fN=d;this.eT=n;this.wC=B;this.Xc=Q;this.Iwa=ha;this.Wn=Aa;this.Rda=bb;this.g4=Ib}zlf(d,n){if(d)if(n){if(d=this.Din(d,n))n.decoratorId=d.properties.id.gv.toString(),this.fN.write(d.Rb.paragraph,n)}else F.ULS.shipAssertTag(541735123,3016,!1,"Invalid decorator");else F.ULS.shipAssertTag(541735122,
3016,!1,"Invalid node")}uvg(d,n){const B=this.wC.Vc(15,Se.a.Bfb);try{B.KB.Eb(this.Xc.Fd),this.KGo(d,n)}finally{B&&B.dispose()}}KGo(d,n){var B,Q;if(d)if(n)if(n=null===n||void 0===n?void 0:n.decoratorId){var ha=Pu.f$d(d),Aa=null===(B=null===ha||void 0===ha?void 0:ha.properties)||void 0===B?void 0:B.id;null!==(Q=null===Aa||void 0===Aa?void 0:Aa.gv)&&void 0!==Q&&Q.toString()&&n===Aa.gv.toString()?this.Cfl(d)?this.eT.Wxc(ha,d):F.ULS.shipAssertTag(541735126,3016,!1,"Non-image and non-empty paragraphs before decorator"):
F.ULS.shipAssertTag(538187611,3016,!1,"Decorator is not in its paragraph")}else F.ULS.shipAssertTag(538501596,3016,!1,"Decorator id null or undefined");else F.ULS.shipAssertTag(541735125,3016,!1,"Invalid decorator");else F.ULS.shipAssertTag(541735124,3016,!1,"Invalid node")}Cfl(d){d=this.Iwa.KWa(d,!0,!0);do if(!this.eT.O3d(d.uC)){const n=this.Wn.Ag(d.uC);if(!bf.ParagraphReader.isEmpty(n))return!1}while(d.Jna());return!0}bJf(d){return d?d.type===ij.DecoratorType.ThemeImage?{imageUrl:Rm.a.kh(null===
d||void 0===d?void 0:d.imageName),thumbnailUrl:Rm.a.kh("Thumbnail_"+(null===d||void 0===d?void 0:d.imageName)),imageType:null===d||void 0===d?void 0:d.imageType,type:null===d||void 0===d?void 0:d.type,hasImages:!0}:{imageUrl:"",thumbnailUrl:"",imageType:null===d||void 0===d?void 0:d.imageType,type:null===d||void 0===d?void 0:d.type,hasImages:!0,altText:""}:null}Wed(d){const n=new yp;this.Rda.F_f(d,0,bf.ParagraphReader.textLength(d),zp.a.g6j,B=>{var Q,ha;60===B&&this.fN.write(d,{decoratorId:null===
(ha=null===(Q=d.id)||void 0===Q?void 0:Q.gv)||void 0===ha?void 0:ha.toString(),type:Me.themeImage});n.resolve()});return n}Din(d,n){var B,Q;if(null===n||void 0===n||!n.imageUrl)return F.ULS.shipAssertTag(541735129,3016,!1,"Image URL is not valid"),null;d=bf.ParagraphReader.Vn(d,!0,!0);if(!d)return F.ULS.shipAssertTag(541735130,3016,!1,"Cannot find paragraph"),null;this.g4.Wif();n=this.eT.fZf(n.imageUrl,d,!0,Se.a.Zbb,Se.a.qfe,{$od:{C3b:this.pl(n.imageType),Axf:this.wCm(n)},altText:this.z1(n),uee:Se.a.O$c},
()=>{this.g4.jgg()});if((d=null===(B=null===n||void 0===n?void 0:n.Rb)||void 0===B?void 0:B.paragraph)&&(null===(Q=n.properties)||void 0===Q?0:Q.id))return this.Hio(d),n;F.ULS.shipAssertTag(541735131,3016,!1,"Problem with image blob object while inserting theme image");this.g4.LBa(!0);return null}Hio(d){const n=this.wC.Vc(15,Se.a.P2d);try{n.KB.Eb(this.Xc.Fd),this.Rda.Dwc(d,0,bf.ParagraphReader.textLength(d),zp.a.g6j,60)}finally{n.dispose()}}pl(d){switch(d){case Li.BetweenLeftAndRightMargin:return 0;
case Li.BetweenLeftAndRightEdge:return 1}}wCm(d){if(d.type===Me.text2Image)return yf.a.qVi}z1(d){let n="";d.type===Me.text2Image?n=d.altText:st.has(d.imageUrl)&&(n=st.get(d.imageUrl).altText);return n?n:WacWordeditorStrings.DesignerDecorativeImage}}Object(D.a)(tt,"ThemeImageDecoratorEditor",null,[1141]);class zx{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk){this.Tb=d;this.fN=n;this.Wn=B;this.Yf=Q;this.dM=ha;this.ub=Aa;this.s6=bb;this.eT=Ib;this.Qn=oc;this.wC=
Ac;this.Xc=ad;this.Kj=sd;this.Ug=wd;this.Un=yd;this.Qj=be;this.Iwa=ye;this.Ewa=Qe;this.Ir=af;this.Rda=Qf;this.g4=hf;this.oe=di;this.RZb=vj;this.kc=Wk;this.wu=Tm;this.hN=Dk}create(d){if(d){var n=Array(d.length);d.forEach((B,Q)=>{switch(B){case Me.table:n[Q]=new Iz(this.Tb,this.fN,this.Wn,this.Yf,this.dM,this.ub,this.s6,this.Kj,this.wC,this.Xc,this.Ir,this.Rda,this.g4,this.Ug,this.RZb,this.kc,this.Qn,this.eT);break;case Me.complexDecorator:n[Q]=new fH(this.Tb,this.fN,this.Wn,this.Yf,this.ub,this.Kj,
this.s6,this.dM,this.Ug,this.Un,this.eT,this.Qn,this.wC,this.Qj,this.Ewa,this.kc,this.Rda,this.g4,this.oe,this.RZb,this.Ir,this.wu,this.hN);break;case Me.themeImage:case Me.text2Image:n[Q]=new tt(this.fN,this.eT,this.wC,this.Xc,this.Iwa,this.Wn,this.Rda,this.g4);break;default:F.ULS.shipAssertTag(542945287,3016,!1)}});return n}F.ULS.shipAssertTag(543737925,3016,!1)}}Object(D.a)(zx,"DecoratorEditorFactoryImpl",null,[1112]);class cw{constructor(d,n,B,Q,ha,Aa,bb,Ib){var oc;this.h2d=d;this.fN=n;this.Dh=
B;this.Wn=Q;this.hN=ha;this.gog=Aa;this.wC=bb;this.Ewa=Ib;this.Cig=(Ac,ad)=>{if(2===ad.data){Ac=void 0;try{Ac=this.wC.Vc(15,Se.a.eki,!1),Ac.KB.Eb(this.Ewa.value),this.fN.map.forEach((sd,wd)=>{sd.iVd.forEach(yd=>{yd&&this.gog.Dwc(yd,0,bf.ParagraphReader.textLength(yd),zp.a.Dhc,70)});void 0!==wd&&VA(sd.iVd,wd,this.gog,zp.a.Dhc,70);wd&&this.gog.Dwc(wd,0,bf.ParagraphReader.textLength(wd),zp.a.Dhc,70)}),this.fN.clear()}finally{Ac.dispose()}}};null===(oc=this.hN)||void 0===oc?void 0:oc.UUh(this.Cig)}eYh(d,
n,B){if(!d)F.ULS.shipAssertTag(543737924,3016,!1);else if(n){var Q=n.map(ha=>ha.type);this.h2d.create(Q).forEach((ha,Aa)=>{ha.zlf(d,n[Aa],B)})}}wFo(){this.fN.map.forEach((d,n)=>{if(null!==n&&void 0!==n&&n.isConnected){var B=this.Dh.Xca(),Q=this.h2d.create([d.Ohi.type]);1===Q.length&&Q[0].uvg(n,d.Ohi);B&&this.fN.remove(n)}})}H3m(){var d;return(null===(d=this.Dh)||void 0===d?void 0:d.Mma)===Se.a.oBa}hHo(){this.hN.freeze();this.Dh.undo();this.hN.kAp()}async cpg(d){if(d){var n=this.h2d.create([Me.themeImage,
Me.table,Me.complexDecorator]),B=n[0],Q=n[1];n=n[2];var ha=[];for(const Aa of d)this.fN.read(Aa)||(this.Wn.Ag(Aa).Ib(14)?ha.push(Q.Wed(Aa)):ha.push(B.Wed(Aa)),ha.push(n.Wed(Aa)));return Promise.all(ha)}}dxi(d){if(!d)return null;const n=d.map(Q=>Q.type),B=[];this.h2d.create(n).forEach((Q,ha)=>{B.push(Q.bJf(d[ha]))});return B}}Object(D.a)(cw,"DecoratorManagerImpl",null,[1110]);class SJ{constructor(d){this.iVd=[];this.Ohi=d}QRh(d){this.iVd.push(d)}}Object(D.a)(SJ,"DecoratorInfoHolder",null,[]);class TJ{constructor(){this.map=
new Map}write(d,n,B){if(this.map.size>=yf.a.YTl){F.ULS.sendTraceTag(526391136,3016,50,"Decorator storage capacity exceeded");const ha=this.map.keys();for(let Aa=0;10>Aa;Aa++)this.map.delete(ha.next().value)}this.map.set(d,new SJ(n));const Q=this.map.get(d);null===B||void 0===B?void 0:B.forEach(ha=>{Q.QRh(ha)})}pSp(d,n){this.map.has(d)&&this.map.get(d).QRh(n)}read(d){return this.map.has(d)?this.map.get(d):null}remove(d){this.map.has(d)&&this.map.delete(d)}clear(){this.map.clear()}G3m(){for(const d of this.map.keys())if(null===
d||void 0===d?0:d.isConnected)return!0;return!1}}Object(D.a)(TJ,"DecoratorStorageImpl",null,[1111]);class OC{constructor(d,n,B,Q,ha,Aa,bb=null,Ib,oc,Ac,ad){this.jab=d;this.wC=n;this.dM=B;this.GR=Q;this.Xc=ha;this.gh=Aa;this.PH=bb;this.oe=Ib;this.Qn=oc;this.kc=Ac;this.I4=ad}mdl(){return this.jab.getAnnotations().then(d=>{let n=0,B=0;const Q=this.wC.Vc(15,dd.a.X6d);try{Q.KB.Eb(this.Xc.Fd);for(const ha of d){const Aa=this.hP(ha),bb=this.Jgb(ha),Ib=this.QMi(ha,bb);if(bb){const oc=this.GR.ppo(this.GR.I4c(ha,
Aa),(Ac,ad)=>{ad.forEach(sd=>{this.dM.$la(sd,Ac.role)});return!0},Ib);oc&&1!==oc&&n++}else{const oc=this.GR.Zoo(ha,(Ac,ad)=>{ad.forEach(sd=>{this.dM.Oob(sd,Ac.suggestions)});return!0},Ib);oc&&1!==oc&&B++}}}finally{Q&&Q.dispose()}F.ULS.sendTraceTag(538190339,3016,50,`style:${n} df:${B} of total: ${d.count}`);return n+B}).catch(d=>{F.ULS.shipAssertTag(538468955,3016,!1,String.format("{0} {1}",d.message,d.stack));return Promise.resolve(0)})}hP(d){if(!d)return F.ULS.shipAssertTag(546137295,3016,!1),null;
if(!d.content)return F.ULS.shipAssertTag(546137296,3016,!1),null;const n=d.parent;return n?n:this.jab.getParent(d)}Jgb(d,n=0){const B=this.GR.I4c(d,this.hP(d));if(!B.length)return!1;const Q=this.Qn.YD(B[0]);if(!Q)return!1;n=0===n?Q.role:n;const ha=this.kc.Il().Qg(Yn.j(n));if(!ha)return F.ULS.sendTraceTag(538190341,3016,50,`No WAC style for role: ${n}`),!1;var Aa=d.content;if(!Aa)return F.ULS.sendTraceTag(538190342,3016,50,`No formattingSuggestionsAnnotation for role: ${n}`),!1;d=new Set;let bb=!1;
for(const Ib of Aa.suggestions){B.forEach(oc=>{this.Szn(Ib,ha,bf.ParagraphReader.Q7c(oc))||(bb=!0)});if(bb)return F.ULS.sendTraceTag(538468956,3016,50,`type: ${Ib.type} role: ${Q.role}`),!1;d.add(Ib.type)}n=this.YSm();for(const Ib of n)if(!d.has(Ib)&&(n=this.$qo(Ib))&&(Aa=ha.getValue(n)))for(const oc of B){const Ac=this.I4.rh(this.I4.uu(ge.a.create(oc)),n,null);if(Aa!==Ac)return F.ULS.sendTraceTag(512522202,3016,50,`type: ${Ib} role: ${Q.role}`),!1}F.ULS.sendTraceTag(538468957,3016,50,`role: ${Q.role}`);
return!0}getPropertyValue(d,n,B,Q){return(n=n.getValue(d))?n:B?(d=B.getValue(d))?d:Q:Q}Szn(d,n,B){switch(d.type){case $f.FormattingSuggestionType.FontSize:return Number.parseInvariant(d.fixedValue)===this.getPropertyValue(xd.a.fontSize,n,B,qt.a.AL);case $f.FormattingSuggestionType.FontFamily:return d.fixedValue===this.getPropertyValue(xd.a.font,n,B,"");case $f.FormattingSuggestionType.FontColor:return Number.parseInvariant(d.fixedValue)===this.getPropertyValue(xd.a.fontColor,n,B,Vf.a.auto);case $f.FormattingSuggestionType.Bold:return Boolean.parse(d.fixedValue)===
this.getPropertyValue(xd.a.bold,n,B,!1);case $f.FormattingSuggestionType.Italic:return Boolean.parse(d.fixedValue)===this.getPropertyValue(xd.a.italic,n,B,!1);case $f.FormattingSuggestionType.Underline:return Boolean.parse(d.fixedValue)===this.getPropertyValue(xd.a.underline,n,B,!1);case $f.FormattingSuggestionType.LineSpacing:return this.Ntn(n,B,d.fixedValue);case $f.FormattingSuggestionType.BeforeSpacing:return this.getPropertyValue(Dd.a.vk,n,B,0)===Mi.a.fM(Number.parseInvariant(d.fixedValue));
case $f.FormattingSuggestionType.AfterSpacing:return this.getPropertyValue(Dd.a.ua,n,B,0)===Mi.a.fM(Number.parseInvariant(d.fixedValue));case $f.FormattingSuggestionType.Indentation:return parseFloat(d.fixedValue)===this.getPropertyValue(Dd.a.ve,n,B,0);case $f.FormattingSuggestionType.RightIndentation:return parseFloat(d.fixedValue)===this.getPropertyValue(Dd.a.Ax,n,B,0);case $f.FormattingSuggestionType.Alignment:return this.vln(n,B,d.fixedValue)}return!1}vln(d,n,B){B=Number.parseInvariant(B);if(isNaN(B))return!0;
d=this.getPropertyValue(xd.a.Ki,d,n,1);switch(B){case xo.a.Left:return 1===d;case xo.a.Right:return 3===d;case xo.a.Center:return 2===d;case xo.a.Justified:return 6===d}return!0}Ntn(d,n,B){const Q=this.getPropertyValue(Dd.a.ya,d,n,void 0);d=this.getPropertyValue(Dd.a.xa,d,n,0)/(0===Q?240:20);return Number.parseFloat(B)===d}YSm(){return[$f.FormattingSuggestionType.FontSize,$f.FormattingSuggestionType.FontFamily,$f.FormattingSuggestionType.FontColor,$f.FormattingSuggestionType.Bold,$f.FormattingSuggestionType.Italic,
$f.FormattingSuggestionType.Underline,$f.FormattingSuggestionType.LineSpacing,$f.FormattingSuggestionType.BeforeSpacing,$f.FormattingSuggestionType.AfterSpacing,$f.FormattingSuggestionType.Indentation,$f.FormattingSuggestionType.RightIndentation,$f.FormattingSuggestionType.Alignment]}$qo(d){switch(d){case $f.FormattingSuggestionType.FontSize:return xd.a.fontSize;case $f.FormattingSuggestionType.FontFamily:return xd.a.font;case $f.FormattingSuggestionType.FontColor:return xd.a.fontColor;case $f.FormattingSuggestionType.Bold:return xd.a.bold;
case $f.FormattingSuggestionType.Italic:return xd.a.italic;case $f.FormattingSuggestionType.Underline:return xd.a.underline;case $f.FormattingSuggestionType.LineSpacing:return Dd.a.xa;case $f.FormattingSuggestionType.BeforeSpacing:return Dd.a.vk;case $f.FormattingSuggestionType.AfterSpacing:return Dd.a.ua;case $f.FormattingSuggestionType.Indentation:return Dd.a.ve;case $f.FormattingSuggestionType.RightIndentation:return Dd.a.Ax;case $f.FormattingSuggestionType.Alignment:return xd.a.Ki;default:F.ULS.shipAssertTag(512522201,
3016,!1,`type: ${d}`)}}Fel(d,n){let B=0,Q=0;const ha=this.wC.Vc(15,Se.a.EFa);try{ha.KB.Eb(this.Xc.Fd),d.forEach((Aa,bb)=>{if(this.Jgb(bb,Aa.WNj.role))this.dM.$la(this.hP(bb),Aa.WNj.role),B++;else{const Ib=bb.content;Ib&&(this.dM.Oob(n?n[Aa.Gng]:this.hP(bb),Ib.suggestions),Q++)}})}finally{ha&&ha.dispose()}F.ULS.sendTraceTag(524170564,3016,50,`style:${B} df:${Q} of total: ${d.size}`);return B+Q}Gam(d){let n=0;for(const B of d.suggestions)n+=Math.pow(2,B.type);return n}QMi(d,n){const B=this.hP(d);if(!B)return[];
const Q=this.Qn.YD(B);return Q?(d=d.content)?[Object.assign(new Ja.a,{name:"formatTypes",int64:this.Gam(d)}),Object.assign(new Ja.a,{name:"role",int64:Q.role}),Object.assign(new Ja.a,{name:"textLength",int64:B.c_.length}),Object.assign(new Ja.a,{name:"useStyles",bool:n})]:[]:[]}K6m(d){this.GR.V6m(d)}Pdp(d,n){const B=this.Jgb(n),Q=this.QMi(n,B);if(B)this.GR.VCe(new $o.b(new Ym.c(Jh.a.create(),this.PH,this.oe,!0,Q),this.GR.I4c(n,d),0,this.gh.textLength(d),(ha,Aa)=>{Aa.forEach(bb=>{this.dM.$la(bb,ha.role)});
return!0}));else{const ha=n.content;ha&&this.GR.VCe(new $o.b(new Ym.c(Jh.a.create(),this.PH,this.oe,!0,Q),this.GR.I4c(n,d),0,this.gh.textLength(d),(Aa,bb)=>{bb.forEach(Ib=>{this.dM.Oob(Ib,ha.suggestions)});return!0}))}}}Object(D.a)(OC,"DocumentConsistencyManager",null,[1109]);var Ax=e(1420);class jv{constructor(d){this.JHd=void 0;this.vi=!1;this.myb=(n,B)=>{n=B.data.operationType;n!==Qj.a.getTypeName()&&n!==Ax.a.getTypeName()||this.update(B.data.annotation)};this.Mkh=d;this.sa=new dc.a}G6k(d){this.sa.addHandler(jv.CBf,
d)}tJj(d){this.sa.removeHandler(jv.CBf,d)}get abd(){return this.JHd}set abd(d){this.JHd!==d&&(this.JHd=d,this.sa.raiseEvent(jv.CBf,new pl.a(this.JHd)))}initialize(){this.vi||(this.Mkh.IJ(this.myb),this.vi=!0)}he(){this.vi&&(this.Mkh.iM(this.myb),this.vi=!1)}update(d){this.abd=d.content.supportedLanguagesCoverage>yf.a.b4j}}jv.CBf="DocumentContentLanguageSupportChangedEventKey";Object(D.a)(jv,"DocumentLanguageManager",null,[1108,478]);var gH=e(338),Yr=e(356);class qh{constructor(d,n,B,Q,ha,Aa){this.Ug=
d;this.om=n;this.Vd=B;this.Qn=Q;this.lE=ha;this.Q5=Aa;this.Q7f=new lm.a}ZHl(d){var n=this.Qn.YD(d);if(null==n.Rfd)F.ULS.shipAssertTag(556323523,3016,!1,"ListId not set in manual list item state!");else{var B=n.Rfd,Q=n.Rfd,ha=n.listItemPrefix,Aa=!1;this.Q7f.Bb(Q)?B=this.Q7f.get(Q):Aa=!0;var bb=this.Qn.fGm(Q);if(bb)if(bb.levelInfos&&bb.levelInfos.length){null==n.Eme&&F.ULS.shipAssertTag(556323526,3016,!1,"Manual List Item level is not set!");bb.fontFamily||F.ULS.shipAssertTag(556323527,3016,!1,"Font family not set for manual list item!");
var Ib=bb.fontFamily||qt.a.zL,oc=n.Eme||0,Ac=qh.nOf(bb,oc);n=qh.BFm(bb,oc);var ad=qh.NEm(bb,oc);if(42===n)F.ULS.shipAssertTag(556323528,3016,!1,"Cannot map ListStyle!");else{B=this.xNl(B,Ib,oc,Ac,n,ad);if(ha)this.VGo(d,ha);else if(bb.listType===xo.e.Numbered){F.ULS.shipAssertTag(556323529,3016,!1,"No list prefix detected!");return}ha=new vc.a;bb=new Yb.DictionaryPropertySet;this.Cmo(d,n,ha,bb);n=this.lE.cZ(d);this.cdl(B,ha,bb,Aa);this.Q5.lQa(d,n.unit,n.value);d=this.ZSb(d);null!=d?this.Q7f.W(Q,d):
F.ULS.shipAssertTag(556323530,3016,!1,"Didn't get list id of converted list!")}}else F.ULS.shipAssertTag(556323525,3016,!1,"No level infos in manual list info!");else F.ULS.shipAssertTag(556323524,3016,!1,"Cannot find manual list info!")}}ZSb(d){if(ve.a.Qe)return ve.a.isListItem(d)?ve.a.ut(d).listId:null;d=this.Vd.pha(d);return(null===d||void 0===d?0:d.hasProperty(Dd.a.listID))?d.getValue(Dd.a.listID):null}cdl(d,n,B,Q){this.om.Vsa(B,n,d,Q)}VGo(d,n){if(n)try{const B=ge.a.createTextRange(d,0,qh.FMm(n,
d.characterData));this.Ug.lf(B,"")}catch(B){F.ULS.shipAssertTag(556074240,3016,!0,`Remove list prefix failed! error ${B}`)}}Cmo(d,n,B,Q){B.set(d);B.Ib(11)&&B.xd(11);B.set(B.currentNode);Lj.a.uw(B);Q.setValue(oh.a.MN,0);Q.setValue(oh.a.dE,6===n?1:0);Q.setValue(Dd.a.Cu,gH.a.aee)}xNl(d,n,B,Q,ha,Aa){d=Yr.a.LY(6===ha?1:0,ha,null,d,B,Q,n);Aa&&(d.zF=Aa);return d}static BFm(d,n){switch(qh.QIm(d,n)){case "decimal":return 1;case "lowerLetter":return 2;case "lowerRoman":return 3;case "upperLetter":return 4;
case "upperRoman":return 5;case "bullet":return 6;default:return 42}}static QIm(d,n){for(let B=0;B<d.levelInfos.length;B++){const Q=d.levelInfos[B];if(Q.level===n)return Q.numberFormat||d.listType!==xo.e.Numbered?d.levelInfos[B].numberFormat:"decimal"}F.ULS.shipAssertTag(556323531,3016,!1,"No number format for given level!");return null}static nOf(d,n){for(let B=0;B<d.levelInfos.length;B++){const Q=d.levelInfos[B];if(Q.level===n)return Q.levelText||d.listType!==xo.e.Numbered?Q.levelText:"%1."}F.ULS.shipAssertTag(556323532,
3016,!1,"No level text for given level!");return null}static NEm(d,n){for(let B=0;B<d.levelInfos.length;B++){const Q=d.levelInfos[B];if(Q.level===n)return Q.startAt}F.ULS.shipAssertTag(556323533,3016,!1,"No StartAt value for given level!");return null}static FMm(d,n){var B=n.indexOf(d);if(-1==B)return F.ULS.shipAssertTag(556074241,3016,!1,"Prefix not found in paragraph text!"),0;d=B+d.length;for(B=0;d+B<=n.length&&" "==n.charAt(d+B);)B++;return d+B}}Object(D.a)(qh,"ManualListConverter",null,[1065]);
class ap extends Xr{constructor(d){super();this.Xnj=d;this.mqd=10;this.activeSection=this.ejc=this.Ay=null;this.isInitialized=!1}Sbe(){return this.Ay}I7c(){return this.ejc}Flc(){return this.activeSection}H1(d){var n;const B=null===(n=this.Ay)||void 0===n?void 0:n.find(Q=>Q.id.equals(d));return B&&B.H1}mle(d,n){const B=d?this.Ay.find(Q=>Q.id.equals(d)):void 0;B&&this.Xnj.Gbj(G.AFrameworkApplication.uiCulture,d.toString(),this.mqd,B.items.length).then(Q=>{var ha;if(Q&&0!==Q.length){for(const Aa of Q)B.items.push({type:uf.officeTemplate,
name:Aa.Id,templateId:Aa.Id,previewImageUrl:Aa.ThumbnailUrl,binaryUrl:Aa.BinaryUrl,isPortraitOriented:null!==(ha=Aa.IsPortraitLayout)&&void 0!==ha?ha:!0,isPremium:Aa.IsPremium,collectionId:B.id.toString(),collectionName:B.displayName,isL2Template:n});B.H1=0===B.items.length%this.mqd;B.H1&&(this.sa.raiseEvent(Xr.gPa),this.mle(B.id))}else B.H1=!1;this.sa.raiseEvent(Xr.gPa)}).catch(()=>{B.H1=!1;this.sa.raiseEvent(Xr.gPa)});Promise.resolve()}Obj(){var d;this.Xnj.Gbj(G.AFrameworkApplication.uiCulture,
null,this.mqd,null===(d=this.Ay)||void 0===d?void 0:d.length).then(n=>{var B;this.ejc=new vn.a(ja.a.Oh());let Q=new Map,ha=new Map;for(let Aa of n)Q.has(Aa.CollectionId)||(Q.set(Aa.CollectionId,[]),ha.set(Aa.CollectionId,Aa.CollectionDisplayName)),Q.get(Aa.CollectionId).push({type:uf.officeTemplate,name:Aa.Id,templateId:Aa.Id,previewImageUrl:Aa.ThumbnailUrl,binaryUrl:Aa.BinaryUrl,isPortraitOriented:null!==(B=Aa.IsPortraitLayout)&&void 0!==B?B:!0,isPremium:Aa.IsPremium,collectionId:Aa.CollectionId,
collectionName:Aa.CollectionDisplayName,isL2Template:Aa.IsL2Template});for(let Aa of Q.keys())this.Ay.push({label:Kg.none,labelDisplayName:ha.get(Aa),id:new xx(Kg.none,Aa),displayName:ha.get(Aa),items:Q.get(Aa),isLoaded:!0,H1:0<Q.get(Aa).length&&0===Q.get(Aa).length%this.mqd});0===this.Ay.length%this.mqd&&(this.sa.raiseEvent(Xr.gPa),this.Obj());this.sa.raiseEvent(Xr.gPa)}).catch(n=>{F.ULS.shipAssertTag(509693954,3016,!1,`Office templates retrieval error: ${n}`)});Promise.resolve()}initialize(){this.isInitialized||
(this.Ay=[],this.Obj(),this.isInitialized=!0)}he(){}}Object(D.a)(ap,"OfficeTemplatesThemeProvider",Xr,[]);var dB=e(933);class Fo{constructor(d=null,n=null){this.cB=d;this.Erp=n}}Object(D.a)(Fo,"ParagraphFormattingSnapshot",null,[]);class Ru{constructor(d,n){this.formatting=d;this.nrg=n}}Object(D.a)(Ru,"FormattingPropertyDefinitionPair",null,[]);class lr{constructor(d,n){this._fontColor=this.$Tc=this._formatting=0;this.Y_=null;this.ru=d;this.lJl=n}azc(d,n){if(!d)return F.ULS.shipAssertTag(592307426,
3016,!1),!1;this._formatting=0;for(const B of lr.ooh)n.rh(d,B.nrg,!1)&&(this.HSh(B.formatting),64===B.formatting&&(this.$Tc=n.rh(d,xd.a.underlineType,qt.a.JCb)),256===B.formatting&&(this._fontColor=n.rh(d,xd.a.fontColor,Vf.a.auto)));d=n.rh(d,xd.a.font,"");Nc.a.contains(yf.a.qvi,d)&&(this.HSh(128),this.Y_=d);return!!this._formatting}P1a(d,n){if(!d)F.ULS.shipAssertTag(592307427,3016,!1);else if(!n)F.ULS.shipAssertTag(592307456,3016,!1);else if(this._formatting){for(const B of lr.ooh)if(this.c_i(B.formatting))switch(B.formatting){case 1:n.GP(d,
!0);break;case 8:n.PAe(d,!0);break;case 256:n.Uy(d,Ca.a.yL(this._fontColor,6),null);break;case 2:n.cC(d,!0);break;case 4:n.Jpa(d,!0);break;case 16:n.oQa(d,!0);break;case 32:n.Mxa(d,!0);break;case 64:n.Lpa(d,this.$Tc)}this.c_i(128)&&n.rja(d,this.Y_)}}HSh(d){this._formatting|=d}c_i(d){return(this._formatting&d)===d}}lr.ooh=[new Ru(1,xd.a.bold),new Ru(256,xd.a.fontColor),new Ru(2,xd.a.italic),new Ru(4,xd.a.strikethrough),new Ru(8,Ya.a.Ew),new Ru(16,xd.a.subscript),new Ru(32,xd.a.superscript),new Ru(64,
xd.a.underline)];Object(D.a)(lr,"TextRunFormattingSnapshot",null,[]);class UJ{get du(){return null!=this.T5g?this.T5g:this.T5g=np.a.getInstance()}constructor(d,n,B,Q,ha,Aa,bb){this.IZm=d;this.I4=n;this.Qj=B;this.Vd=Q;this.Z9=ha;this.DF=Aa;this.kK=bb}hYh(d,n){if(d)if(n){var B=n.cB;if(n=n.Erp){for(const Q of n)this.DF.zY(this.IZm(d,Q.ru,Q.lJl),ha=>{Q.P1a(ha,this.Qj)});if(B){if(!this.du.xu&&(n=new vc.a,n.set(d),n.Wd())){n.Ac();const Q=new dB.a;n.pg(Q,4);n.yk(Q);Q.setValue(Dd.a.listID,B.listId);Q.setValue(Dd.a.listLevel,
B.listLevel)}this.du.Gv&&this.kK.f2b(d,B.listId,B.listLevel)}}else F.ULS.shipAssertTag(590754180,3016,!1)}else F.ULS.shipAssertTag(590754179,3016,!1);else F.ULS.shipAssertTag(590754178,3016,!1)}RIi(d){if(!d)return F.ULS.shipAssertTag(590754181,3016,!1),null;const n=new ma.a;for(var B=0;B<d.ra.length-1;B++){const Q=d.ra.jc(B);if(!Q.formatting)continue;const ha=new lr(Q.cp,d.ra.jc(B+1).cp);ha.azc(Q.formatting,this.I4)&&n.add(ha)}B=null;d=this.Z9.kn(d);ve.a.Wg(d)&&(ve.a.Qe?B=ve.a.wna(d):(B=new vc.a,
B.set(d),this.Vd.xYb(B),B=this.Vd.B1(B.currentNode,!1,!1)));return new Fo(B,n)}}Object(D.a)(UJ,"ParagraphFormattingSnapshotManager",null,[1063]);var PC=e(415),Nv=e(1134),hH=e(1715),VJ=e(1634);class qo{static $Ym(){qo.nAb||(qo.nAb=new ig.ScriptSharpLegacyMap,qo.nAb.add(0,{indent:.3,Wtd:(d,n,B)=>{const Q=d.length+1,ha=qo.Yyc,Aa=qo.Zyc;n=qo.PZc(n);const bb=n+66148;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${bb},"w":${B}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":20,"g":107,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":53734,"w":${B}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":0,"g":0,"r":0}}},"fontFamily":"${ha}","fontSize":${Aa}},"length":${Q}}],"paraFormatRunArray":[{"length":${Q},"paragraphFormat":{"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":164030,"y":82747},"rot":0,"size":{"h":${n},"w":${B-
295364}}}},"wordGc2Type":13000}]}`}}),qo.nAb.add(1,{indent:.9,Wtd:(d,n,B)=>{const Q=d.length+1,ha=qo.Yyc,Aa=qo.Zyc;n=qo.PZc(n);const bb=n+777476,Ib=n+587852,oc=B-119350,Ac=B-1540438,ad=n+59675,sd=B-453325;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${bb},"w":${B}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":249996,"y":143249},"rot":0,"size":{"h":${Ib},"w":${oc}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"fontFamily":"${ha}","fontSize":${Aa}},"length":${Q}}],"paraFormatRunArray":[{"length":${Q},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":837024,"y":430397},"rot":0,"size":{"h":${n},"w":${Ac}}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":1}}},"lineDash":0,"weight":42863},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":112627,"y":0},"rot":0,"size":{"h":${Ib},"w":${oc}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":304366,"y":220893},"rot":0,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":2,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":${sd},"y":${ad}},"rot":10800000,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${bb},"w":${B}}}}`}}),
qo.nAb.add(2,{indent:.7,Wtd:(d,n,B)=>{const Q=d.length+1,ha=qo.Yyc,Aa=qo.Zyc;n=qo.PZc(n);const bb=n+80835,Ib=B-999962,oc=n+444908,Ac=n+66148,ad=n+66148,sd=13350-Math.round(ad/2),wd=142329+Math.round(ad/2),yd=B-1134575,be=B-727217,ye=n+190818,Qe=B-Math.round(ad/2);n-=77606;const af=B-1149386;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":246,"g":239,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":157851},"rot":10800000,"size":{"h":${Ac},"w":${B}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"${ha}","fontSize":${Aa}},"length":${Q}}],"paraFormatRunArray":[{"length":${Q},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":443019,"y":244229},"rot":0,"size":{"h":${bb},"w":${Ib}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":8939,"y":159883},"rot":0,"size":{"h":37400,"w":671031}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${sd},"y":${wd}},"rot":5400000,"size":{"h":34645,"w":${ad}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":25828,"y":${ye}},"rot":0,"size":{"h":34537,"w":${yd}}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${be},"y":${ye}},"rot":0,"size":{"h":34537,"w":729926}}},"wordGc2Type":13000},{"id":9,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Qe},"y":${wd}},"rot":5400000,"size":{"h":34645,"w":${ad}}}},"wordGc2Type":13000},{"id":10,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":1149133,"y":159846},"rot":0,"size":{"h":37400,"w":${yd}}}},"wordGc2Type":13000},{"id":11,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${af},"y":${n}},"rot":0,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000},{"id":12,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":681162,"y":0},"rot":10800000,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${oc},"w":${B}}}}`}}),
qo.nAb.add(3,{indent:1,Wtd:(d,n,B)=>{const Q=d.length+1,ha=qo.Yyc,Aa=qo.Zyc;n=qo.PZc(n);const bb=B-1518499,Ib=n+392522,oc=n,Ac=n-316115,ad=B/2-256447;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":158},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${ad},"y":${Ac}},"rot":2700000,"size":{"h":512895,"w":512895}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":25},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${oc},"w":${B}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":168,"g":101,"r":56}}},"fontFamily":"${ha}","fontSize":${Aa}},"length":${Q}}],"paraFormatRunArray":[{"length":${Q},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":726947,"y":71168},"rot":0,"size":{"h":${n},"w":${bb}}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${Ib},"w":${B}}}}`}}),
qo.nAb.add(4,{indent:.3,Wtd:(d,n,B)=>{const Q=d.length+1,ha=qo.Yyc,Aa=qo.Zyc;n=qo.PZc(n);const bb=n+125516,Ib=B-120310,oc=B-427001,Ac=n;B-=244619;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${bb},"w":${Ib}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fontFamily":"${ha}","fontSize":${Aa}},"length":${Q}}],"paraFormatRunArray":[{"length":${Q},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":101388,"y":81834},"rot":0,"size":{"h":${n},"w":${oc}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":${Ac}},"rot":0,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${B},"y":0},"rot":10800000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":5400000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${B},"y":${Ac}},"rot":16200000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000}]}`}}));
return qo.nAb}static PZc(d){return qa.a.U0a(d,0)*Mi.a.D$a+qo.kSo}}qo.nAb=null;qo.Yyc="Calibri";qo.Zyc=1400;qo.kSo=256E3;Object(D.a)(qo,"PullQuoteStyles",null,[]);class pu{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe){this.OT=d;this.V0=n;this.Dh=B;this.J=Q;this.e_m=ha;this.ian=Aa;this.ub=bb;this.Dc=Ib;this.Ug=oc;this.DF=Ac;this.Qj=ad;this.logger=sd;this.Yf=wd;this.Xc=yd;this.SYa=be;this.Knf=ye;this.kc=Qe;this.range=window.self.document.createRange()}pTh(d,n){var B;if(d)if(({value:Ib}=
qo.$Ym().Nc(d.ifb,Ib)).returnValue){var Q=this.zPl(d);if(Q){var ha=wq.a.instance.zW(Q),Aa=ha?Mi.a.lOg(ag.a.instance.eP(ha)):pu.LOj,bb=ha?Mi.a.lOg(ag.a.instance.fP(ha)):pu.LOj;ha=(ha?Mi.a.lOg(ag.a.instance.nx(ha)):pu.fSo)-Aa-bb;Aa=this.KBm(Q,Ib.indent);bb=Ib.Wtd(d.Jld,Aa,ha);var Ib=new Zh.a(this.Xc);this.ub.Uc(Di.SelectionFactory.ot(Q));Q=new hH.a(Ib,this.SYa,!0,this.OT,this.J,Object($g.a)());Q=new VJ.a(Q,bb,this.V0,this.Dh,n,pe.a.instance,!1,null,this.OT,this.ian,ha/pu.gSo,Aa+pu.iSo,this.J,this.Knf,
this.Dc,!1,[]);Q.g6o(d.callback);Q.p0o(oc=>{F.ULS.shipAssertTag(545271898,3016,!1,"PullQuote failed to create, error message: {0}",oc)});this.e_m.qBg(Q,Ib,!1,n);return null===(B=Ib.Pk)||void 0===B?void 0:B.node}F.ULS.shipAssertTag(555034258,3016,!1,"Unsuccessful node creation")}else F.ULS.shipAssertTag(555034257,3016,!1,String.format("Non existing styleId: {0}",d.ifb));else F.ULS.shipAssertTag(555034256,3016,!1,"No PullQuoteData")}KBm(d,n){this.DF.zY(ge.a.createTextRange(d,0,bf.ParagraphReader.textLength(d)),
Q=>{this.Qj.tE(Q,qo.Zyc/100*2);this.Qj.rja(Q,qo.Yyc)});R.a.dbb.lQa(d,1,Mi.a.pF(n));R.a.dbb.LAb(d,1,Mi.a.pF(n));this.Xc.jib();n=0;try{var B=d.Dm(this.Xc.Lc);const Q=PC.a.gCa(B,void 0,!1,!1),ha=Nv.a.jei(Q.HK,this.logger).RQ;for(B=0;B<ha.hp.count-1;B++){const Aa=ha.Dab(B);this.range.setStart(Aa.htmlElement,0);this.range.setEnd(Aa.htmlElement,Aa.htmlElement.textContent.length);const bb=this.range.getBoundingClientRect();n+=bb.height}}catch(Q){n=pu.hSo,F.ULS.shipAssertTag(555034259,3016,!1,"Couldn't calculate pull quote text height. Exception: {0}",
String.format("{0} {1}",Q.message,Q.stack))}finally{return this.DF.zY(ge.a.createTextRange(d,0,bf.ParagraphReader.textLength(d)),Q=>{this.Qj.tE(Q,22)}),R.a.dbb.lQa(d,1,Mi.a.pF(0)),R.a.dbb.LAb(d,1,Mi.a.pF(0)),n}}zPl(d){var n=new vc.a;n.set(d.paragraphNode);if(!n.Wd())return null;bg.a.xe(n);this.Yf.mA(n,!0,!1,void 0,void 0,!1);var B=new nu.a;const Q=this.kc.pG(d.paragraphNode);Q&&(B.Cqa=Q.Qg(kr.a.L5b));if(n=this.Yf.dN(n,B))B=ge.a.jd(n,0),this.Ug.lf(B,d.Jld,!0,!1);return n}kul(d,n,B,Q){if(d)if(n)if(B){if(d=
this.PHj(d))return n=new $o.c(n,d,n.ifb,n.Jld,B),this.pTh(n,Q);F.ULS.shipAssertTag(554443525,3016,!1,"No next node with pull quote")}else F.ULS.shipAssertTag(554443524,3016,!1,"No PullQuote success callback");else F.ULS.shipAssertTag(554443523,3016,!1,"No PullQuoteSuggestion");else F.ULS.shipAssertTag(554443522,3016,!1,"No PullQuoteNode")}PHj(d){if(d){var n=this.gIm(d);this.Yf.hxa(d);n&&this.ub.Uc(Lj.a.Xk(Di.SelectionFactory.aq(ge.a.create(n)),!1,!1));return n}F.ULS.shipAssertTag(554443526,3016,!1,
"No PullQuoteNode")}gIm(d){if(!d)return null;const n=new vc.a;n.set(d);n.Wd();n.Ac();return n.xl()?n.currentNode:null}}pu.gSo=9509.76;pu.iSo=50;pu.hSo=39;pu.LOj=914400;pu.fSo=7772400;Object(D.a)(pu,"PullQuotesDesignerImpl",null,[1062]);class QC{constructor(d,n,B,Q){this.wC=d;this.Yue=n;this.GR=B;this.Xc=Q}bWd(d){const n=this.wC.Vc(15,dd.a.bWd,!1),B=Ze.a.create();try{n.KB.Eb(this.Xc.Fd);let Q=!0;for(const ha of d)n.KB.sOa(B,1),Q=this.GR.DBj(ha,Aa=>({role:27,paragraphNode:this.Yue.pTh(Aa,B),placeholder:!0}))&&
Q;return Q}catch(Q){return F.ULS.shipAssertTag(555034255,3016,!1,String.format("Applying pull quotes failed. Exception: {0} {1}",Q.message,Q.stack)),!1}finally{n&&n.dispose()}}}Object(D.a)(QC,"PullQuotesManagerImpl",null,[1060]);class Iw{constructor(d,n,B){this.Bq=d;this.Dh=n;this.py=B;this.dialog=null;this.rcb=!1;this.LBa=Q=>{1==Q&&this.aCj(!0);this.rcb=!1}}revertTheme(){return this.Dh.Y4?this.Dh.Xca()?this.aCj():(this.openDialog(),!1):(F.ULS.shipAssertTag(539829795,3016,!1),!1)}aCj(d=!1){var n=
this.py;if(null===n||void 0===n||!n.Fd)return F.ULS.shipAssertTag(539808770,3016,!1),!1;const B=this.Bq.Vc(7,dd.a.$yg);B.Eb(n.Fd);n=!0;try{for(;n&&this.Dh.Y4&&!this.Dh.Xca();)n=this.Dh.undo();n&&this.Dh.Y4&&this.Dh.Xca()?n=this.Dh.undo():(F.ULS.shipAssertTag(539829824,3016,!1,String.format("Has undo entries:{0}",this.Dh.Y4)),n=!1)}finally{return null===B||void 0===B?void 0:B.dispose(),d=Object.assign(new Ja.a,{name:"DialogShown",bool:d}),sb.a(yf.a.nio,n,void 0,[d]),n}}openDialog(){this.rcb||(this.dialog=
new Sa.StandardDialog,this.dialog.Md=1,this.dialog.Ue(1,WacWordeditorStrings.DesignerRevertDialogButtonLabel),this.dialog.$g=yf.a.kQo,this.dialog.Yx(WacWordeditorStrings.DesignerRevertDialogTitle,WacWordeditorStrings.DesignerRevertDialogDescription,0,this.LBa),this.rcb=!0)}}Object(D.a)(Iw,"RevertManager",null,[1061]);class eB{Llc(d){return 27===d?WacWordeditorStrings.DesignerPullQuoteReviewTitle:28===d?WacWordeditorStrings.DesignerImageSuggestionV2ReviewTitle:WacWordeditorStrings.DesignerFormattingFixesReviewTitle}}
Object(D.a)(eB,"ReviewDescriptionBuilder",null,[1058]);class ci{constructor(d,n,B){B?(this.Zud=sx(d),this.RWc=sx(n)):(this.Zud=d,this.RWc=n)}}Object(D.a)(ci,"FontPairing",null,[]);class RE{cP(d){return d?Ca.a.DV(d.Zud)^Ca.a.DV(d.RWc):0}equals(d,n){return d.Zud===n.Zud&&d.RWc===n.RWc}qna(d){return d.Zud+":"+d.RWc}}Object(D.a)(RE,"EqualityComparer",null,[14,15]);class gh{constructor(d,n){this.jX=d;this.VN=n;this.Oud=null;gh.Ydn();gh.efn();gh.B$f=new Xb.a(ja.a.Oh())}Ifj(d){this.VN.Ae(()=>{this.WNn(d)},
"WD:LTCI")}WNn(d){var n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf;if(d.styles&&!gh.B$f.contains(d.name)){gh.B$f.add(d.name);var hf=[Object.assign(new Ja.a,{name:"themeId",int64:this.jX.Fnc(d.name)}),Object.assign(new Ja.a,{name:"formalInformalCategory",int64:gh.KDi(d)}),Object.assign(new Ja.a,{name:"traditionalModernCategory",int64:gh.vOi(d)}),Object.assign(new Ja.a,{name:"titleFontName",string:HE(null===(n=d.styles.get("Title"))||void 0===n?void 0:n.fontName)}),Object.assign(new Ja.a,{name:"bodyFontName",
string:HE(null===(B=d.styles.get("BodyText"))||void 0===B?void 0:B.fontName)}),Object.assign(new Ja.a,{name:"titleFontColor",string:null===(Q=d.styles.get("Title"))||void 0===Q?void 0:Q.fontColor.toString(16)}),Object.assign(new Ja.a,{name:"subtitleFontColor",string:null===(ha=d.styles.get("Subtitle"))||void 0===ha?void 0:ha.fontColor.toString(16)}),Object.assign(new Ja.a,{name:"heading1FontColor",string:null===(Aa=d.styles.get("Heading1"))||void 0===Aa?void 0:Aa.fontColor.toString(16)}),Object.assign(new Ja.a,
{name:"titleAlignment",int64:null===(bb=d.styles.get("Title"))||void 0===bb?void 0:bb.alignment}),Object.assign(new Ja.a,{name:"subtitleAlignment",int64:null===(Ib=d.styles.get("Subtitle"))||void 0===Ib?void 0:Ib.alignment}),Object.assign(new Ja.a,{name:"heading1Alignment",int64:null===(oc=d.styles.get("Heading1"))||void 0===oc?void 0:oc.alignment}),Object.assign(new Ja.a,{name:"bodyAlignment",int64:null===(Ac=d.styles.get("BodyText"))||void 0===Ac?void 0:Ac.alignment}),Object.assign(new Ja.a,{name:"bodyFontSize",
int64:null===(ad=d.styles.get("BodyText"))||void 0===ad?void 0:ad.fontSize}),Object.assign(new Ja.a,{name:"orderInThePane",int64:this.$Um(d.name)}),Object.assign(new Ja.a,{name:"backgroundColor",string:null===(sd=d.backgroundColor)||void 0===sd?void 0:sd.toString(16)}),Object.assign(new Ja.a,{name:"themeImageDecorator",bool:null!==(yd=null===(wd=d.decorators)||void 0===wd?void 0:wd.some(di=>di.type===Me.themeImage))&&void 0!==yd?yd:!1}),Object.assign(new Ja.a,{name:"titleTableDecorator",bool:null!==
(Qe=null===(ye=null===(be=d.styles.get("Title"))||void 0===be?void 0:be.decorators)||void 0===ye?void 0:ye.some(di=>di.type===Me.table))&&void 0!==Qe?Qe:!1}),Object.assign(new Ja.a,{name:"complexThemeDecorator",bool:null!==(Qf=null===(af=d.decorators)||void 0===af?void 0:af.some(di=>di.type===Me.complexDecorator))&&void 0!==Qf?Qf:!1})];sb.a(yf.a.Qrp,!0,void 0,hf)}}static KDi(d){d=gh.XNi(d);return gh.tt.Bb(d)?gh.tt.K(d):3}static vOi(d){d=gh.XNi(d);return gh.Nt.Bb(d)?gh.Nt.K(d):3}static Ydn(){gh.tt=
new vn.a(new RE);gh.tt.add(new ci("Walbaum Display","Walbaum Text",!0),0);gh.tt.add(new ci("Century Gothic","Century Gothic",!0),0);gh.tt.add(new ci("Perpetua","Perpetua",!0),0);gh.tt.add(new ci("Elephant Pro","Walbaum Text",!0),0);gh.tt.add(new ci("Imprint MT Shadow","Sabon Next LT",!0),0);gh.tt.add(new ci("Sitka Banner","Sitka Text",!0),0);gh.tt.add(new ci("Sitka Banner","Franklin Gothic Book",!0),0);gh.tt.add(new ci("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),0);gh.tt.add(new ci("Univers Condensed Light",
"Univers",!0),0);gh.tt.add(new ci("Univers","Univers",!0),0);gh.tt.add(new ci("Walbaum Display Light","Avenir Next",!0),0);gh.tt.add(new ci("Goudy Type","Dante",!0),0);gh.tt.add(new ci("Lucida Calligraphy","Dante",!0),0);gh.tt.add(new ci("Edwardian Script ITC","Sabon Next LT",!0),0);gh.tt.add(new ci("Footlight MT Light","Goudy Old Style",!0),0);gh.tt.add(new ci("Rockwell Nova Light","News Gothic MT",!0),1);gh.tt.add(new ci("Walbaum Display","News Gothic MT",!0),1);gh.tt.add(new ci("Cooper Black",
"Neue Haas Grotesk Text Pro",!0),1);gh.tt.add(new ci("Franklin Gothic Heavy","Franklin Gothic Book",!0),0);gh.tt.add(new ci("Calibri Light","Calibri Body",!0),0);gh.tt.add(new ci("Impact","Neue Haas Grotesk Text Pro",!0),1);gh.tt.add(new ci("Rockwell Nova","Trade Gothic Next",!0),1);gh.tt.add(new ci("Trade Gothic Next Heavy","Georgia",!0),1);gh.tt.add(new ci("Tisa Offc Serif Pro","Avenir Next",!0),1);gh.tt.add(new ci("Quire Sans","Tisa Offc Serif Pro",!0),1);gh.tt.add(new ci("Amasis MT Pro","Trade Gothic Next",
!0),1);gh.tt.add(new ci("Trade Gothic Next Cond","Trade Gothic Next",!0),1);gh.tt.add(new ci("Plantagenet Cherokee","Calibri (Body)",!0),1);gh.tt.add(new ci("Brush Script MT","Corbel",!0),1);gh.tt.add(new ci("Elephant Pro","Amasis MT Pro",!0),2);gh.tt.add(new ci("Rockwell Nova Extra Bold","Amasis MT Pro",!0),2);gh.tt.add(new ci("Cooper Black","Amasis MT Pro",!0),2);gh.tt.add(new ci("Sagona ExtraLight","Quire Sans",!0),2);gh.tt.add(new ci("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),2);gh.tt.add(new ci("Sagona Book",
"Amasis MT Pro",!0),2);gh.tt.add(new ci("Trade Gothic Next Inline","Avenir Next",!0),2);gh.tt.add(new ci("Modern Love","Avenir Next LT Pro",!0),2);gh.tt.add(new ci("The Serif Hand Black","Amasis MT Pro Light",!0),2);gh.tt.add(new ci("The Hand Black","Avenir Next LT Pro",!0),2);gh.tt.add(new ci("Tisa Offc Serif Pro","Selawik",!0),2);gh.tt.add(new ci("Walbaum Display SemiBold","News Gothic MT",!0),2);gh.tt.add(new ci("Baskerville Old Face","Franklin Gothic Book",!0),2);gh.tt.add(new ci("Mistral","Univers",
!0),2);gh.tt.add(new ci("Magneto","Ebrima",!0),2)}static efn(){gh.Nt=new vn.a(new RE);gh.Nt.add(new ci("Walbaum Display","Walbaum Text",!0),0);gh.Nt.add(new ci("Perpetua","Perpetua",!0),0);gh.Nt.add(new ci("Elephant Pro","Walbaum Text",!0),0);gh.Nt.add(new ci("Imprint MT Shadow","Sabon Next LT",!0),0);gh.Nt.add(new ci("Rockwell Nova Light","News Gothic MT",!0),0);gh.Nt.add(new ci("Walbaum Display","News Gothic MT",!0),0);gh.Nt.add(new ci("Cooper Black","Neue Haas Grotesk Text Pro",!0),0);gh.Nt.add(new ci("Elephant Pro",
"Amasis MT Pro",!0),0);gh.Nt.add(new ci("Rockwell Nova Extra Bold","Amasis MT Pro",!0),0);gh.Nt.add(new ci("Cooper Black","Amasis MT Pro",!0),0);gh.Nt.add(new ci("Goudy Type","Dante",!0),0);gh.Nt.add(new ci("Lucida Calligraphy","Dante",!0),0);gh.Nt.add(new ci("Century Gothic","Century Gothic",!0),1);gh.Nt.add(new ci("Sitka Banner","Sitka Text",!0),1);gh.Nt.add(new ci("Sitka Banner","Franklin Gothic Book",!0),1);gh.Nt.add(new ci("Franklin Gothic Heavy","Franklin Gothic Book",!0),1);gh.Nt.add(new ci("Impact",
"Neue Haas Grotesk Text Pro",!0),1);gh.Nt.add(new ci("Rockwell Nova","Trade Gothic Next",!0),1);gh.Nt.add(new ci("Trade Gothic Next Heavy","Georgia",!0),1);gh.Nt.add(new ci("Sagona ExtraLight","Quire Sans",!0),1);gh.Nt.add(new ci("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),1);gh.Nt.add(new ci("Sagona Book","Amasis MT Pro",!0),1);gh.Nt.add(new ci("Trade Gothic Next Inline","Avenir Next",!0),1);gh.Nt.add(new ci("Trade Gothic Next Cond","Trade Gothic Next",!0),1);gh.Nt.add(new ci("Plantagenet Cherokee",
"Calibri (Body)",!0),1);gh.Nt.add(new ci("Baskerville Old Face","Franklin Gothic Book",!0),1);gh.Nt.add(new ci("Mistral","Univers",!0),1);gh.Nt.add(new ci("Brush Script MT","Corbel",!0),1);gh.Nt.add(new ci("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),2);gh.Nt.add(new ci("Univers Condensed Light","Univers",!0),2);gh.Nt.add(new ci("Univers","Univers",!0),2);gh.Nt.add(new ci("Walbaum Display Light","Avenir Next",!0),2);gh.Nt.add(new ci("Tisa Offc Serif Pro","Avenir Next",!0),2);gh.Nt.add(new ci("Quire Sans",
"Tisa Offc Serif Pro",!0),2);gh.Nt.add(new ci("Amasis MT Pro","Trade Gothic Next",!0),2);gh.Nt.add(new ci("Modern Love","Avenir Next LT Pro",!0),2);gh.Nt.add(new ci("The Serif Hand Black","Amasis MT Pro Light",!0),2);gh.Nt.add(new ci("The Hand Black","Avenir Next LT Pro",!0),2);gh.Nt.add(new ci("Tisa Offc Serif Pro","Selawik",!0),2);gh.Nt.add(new ci("Calibri Light","Calibri Body",!0),2);gh.Nt.add(new ci("Walbaum Display SemiBold","News Gothic MT",!0),2);gh.Nt.add(new ci("Footlight MT Light","Goudy Old Style",
!0),2);gh.Nt.add(new ci("Magneto","Ebrima",!0),2);gh.Nt.add(new ci("Edwardian Script ITC","Sabon Next LT",!0),2)}static XNi(d){var n,B;const Q=null===(n=d.styles.get("Title"))||void 0===n?void 0:n.fontName;d=null===(B=d.styles.get("BodyText"))||void 0===B?void 0:B.fontName;return Q&&d?new ci(Q,d,!1):new ci("default","default",!1)}$Um(d){this.Oud||this.cfn(this.jX.gyi());return this.Oud.has(d)?this.Oud.get(d):(F.ULS.shipAssertTag(554995927,3016,!1),-1)}cfn(d){this.Oud=new Map;for(let n=0;n<d.length;n++)this.Oud.set(d[n].name,
n)}}gh.tt=null;gh.Nt=null;gh.B$f=null;Object(D.a)(gh,"ThemeCategorizer",null,[1057]);class RC{constructor(d,n){this.th=d;this.WJe=n}ofm(d){let n=null;const B=gh.KDi(d),Q=gh.vOi(d),ha=this.qnn();ha||F.ULS.sendTraceTag(523257814,3016,50,"applyThemeToTables - default color palette is changed");0===B?ha&&1!==Q?2===Q?n="List Table 3 {0}":0===Q&&(n="Grid Table 3 {0}"):n="Plain Table 3":2===B?ha&&2!==Q?0===Q?n="Grid Table 5 Dark {0}":1===Q&&(n="List Table 5 Dark {0}"):n="Plain Table 5":1===B?ha&&1!==Q?2===
Q?n="Grid Table 3 {0}":0===Q&&(n="List Table 7 Colorful {0}"):n="Plain Table 5":n="Table Grid";d=this.zdm(d.colorLabel);return String.format(n,d)}zdm(d){return d.includes("Blue")?"Accent 1":d.includes("Orange")?"Accent 2":d.includes("Yellow")?"Accent 4":d.includes("Turquoise")?"Accent 5":d.includes("Green")?"Accent 6":"Accent 3"}qnn(){var d=bd.a.instance.X6c();if(!d)return!1;d=d.ka(Dd.a.thb,null);return Vf.a.HVb(d)}Jqn(d){return d.startsWith(RC.qkn)?!1:!0}jfl(d,n){d=this.ofm(d);for(const Q of n){n=
this.th.Q4(Q);var B=this.th.VI(Q);B=this.th.Ibe(B);F.ULS.sendTraceTag(523572700,3016,50,"applyThemeToTables");1696===n&&(this.Jqn(B)||(n=32));this.WJe.FVj(d,n,Q)}}}RC.qkn="Table Grid";Object(D.a)(RC,"TableDesigner",null,[1056]);var iH=e(1693);class dw{constructor(d,n){this.Ykf=d;this.fN=n;this.isInitialized=!1}initialize(){this.isInitialized||(this.isInitialized=!0,this.Ykf.register())}he(){this.isInitialized&&(this.Ykf.unregister(),this.isInitialized=!1)}iUm(d){if(d){var n=null,B=[],Q=[],ha=[],Aa=
[],bb=null;bb=Ie.a.Mp(d);bb.Oq(Ib=>36!==Ib.Jf,null);for(d=null;bb.moveNext();)if(d=bb.currentNode,14===d.type){n||(n=d);break}if(n){n=vc.a.kb(n);do{bb=n.currentNode;if(this.fN.read(bb))ha.push(bb);else if(d=this.gUm(bb))switch(d.type){case iH.TableType.SimpleHeaded:Q.push(bb);break;case iH.TableType.Other:B.push(bb)}else F.ULS.sendTraceTag(524149721,3016,50,"No TableTypeAnnotation for table in document."),Aa.push(bb);n.yt||n.fko()}while(Object(ef.u)(n))}F.ULS.sendTraceTag(523902976,3016,50,`getTables stats: otherTables=${B.length},
      simpleHeadedTables=${Q.length},
      decoratorTables=${ha.length},
      noAnnotationTables=${Aa.length}`);return{other:B,w0j:Q,XTl:ha,vYn:Aa}}F.ULS.shipAssertTag(524113552,3016,!1,"No target node")}gUm(d){d=this.Ykf.tyi(d);for(const n of d)if(n.annotationType===iH.TableTypeAnnotation.getTypeName())return n.content}}Object(D.a)(dw,"TableManager",null,[1055,478]);class SE{constructor(d,n,B){this.GCc=d;this.oe=n;this.fp=B;this.vd=new dc.a;this.fSe=this.Ay=null;this.areUserSettingsLoaded=this.isInitialized=!1;this.Sze=null;this.I5=()=>{if(this.oe.Gmf())if(this.fp.h4()){this.areUserSettingsLoaded=
!0;var Q=this.WMj();0<Q.length&&this.Ay.unshift({label:Kg.favorites,labelDisplayName:null,id:new xx(Kg.favorites),displayName:null,items:Q,isLoaded:!0,H1:!1});this.Ay=null;this.vd.raiseEvent("OnThemesChanged");this.fp.R0b(this.I5)}else this.areUserSettingsLoaded=!1,F.ULS.shipAssertTag(512337434,3016,!1)};this.O8n=()=>{this.Ay=null;this.vd.raiseEvent("OnThemesChanged")};this.SYb=yf.a.Scn}get YSl(){if(!this.fSe){const d=this.GCc.filter(n=>n instanceof Ey);this.fSe=0===d.length?null:d[0]}return this.fSe}initialize(){this.isInitialized||
(this.GCc.forEach(d=>{d.ZUd(this.O8n);d!=this.YSl&&d.initialize()}),this.isInitialized=!0,this.oe.Gmf()&&!this.fp.h4()&&(this.areUserSettingsLoaded=!1,this.fp.efc(this.I5)))}he(){this.oe.Gmf()&&this.fp.R0b(this.I5)}ZUd(d){this.vd.addHandler("OnThemesChanged",d)}VJj(d){this.vd.removeHandler("OnThemesChanged",d)}h8k(d){this.vd.addHandler("OnShowMoreThemes",d)}Flc(){var d;const n=null===(d=this.GCc.find(B=>B instanceof MC))||void 0===d?void 0:d.Flc();return n?new xx(n):void 0}ZSf(){const d=this.gUl(this.Jnm()),
n=this.VGi();d.forEach(B=>{B.id.getLabel()===Kg.main&&(B.items=n.items.slice(0,this.SYb))});return d}Jnm(){var d;if(this.Ay)return this.Ay;this.Ay=[];for(const n of this.GCc)if(!(n instanceof Ey)&&n.Sbe())for(const B of n.Sbe()){let Q;if(this.oe.cwb())if(Q=B.displayName?this.Ay.filter(ha=>{var Aa,bb;return(null===(Aa=ha.displayName)||void 0===Aa?void 0:Aa.toLowerCase())===(null===(bb=B.displayName)||void 0===bb?void 0:bb.toLowerCase())}):null,0<(null===Q||void 0===Q?void 0:Q.length)){for(const ha of B.items){const Aa=
null===(d=Q[0].items)||void 0===d?void 0:d.filter(bb=>bb.name===ha.name);Aa&&0!==Aa.length||Q[0].items.push(ha)}B.H1&&B.H1!==Q[0].H1&&(Q[0].H1=B.H1)}else this.Ay.push(B);else Q=this.Ay.filter(ha=>ha.label===B.label),0<(null===Q||void 0===Q?void 0:Q.length)?Q[0].items.push(...B.items):this.Ay.push(B)}this.oe.m1i()&&this.Ay.forEach(n=>{for(const B of n.items)B.type===uf.theme&&B.styles.forEach(Q=>{var ha=Q.fontColor;const Aa=18<=Q.fontSize||14<=Q.fontSize&&Q.bold?3:4.5;ha=Vf.a.K8d(ha)<Aa?Gw.has(ha)?
Gw.get(ha):0:ha;Q.fontColor=ha})});this.Ay.forEach(n=>{for(const ha of n.items)if(ha.type===uf.theme||ha.type===uf.templateTheme||ha.type===uf.officeTemplate){var B=void 0;n=ha;if(null===(B=n.styles)||void 0===B?0:B.has("Heading1")){B=n;a:{var Q=n.styles.get("Heading1").fontName;Q=HE(Q);for(const Aa of CC)if(void 0!==Aa&&Q.startsWith(Aa)){Q=Aa;break a}F.ULS.shipAssertTag(557672E3,3016,!1);Q=void 0}B.fontLabel=Q}n.colorLabel=Nq.gBl(n.accentColor)}});if(this.oe.K0f()){if(!this.fp.h4())return this.areUserSettingsLoaded=
!1,F.ULS.shipAssertTag(512522208,3016,!1),this.Ay;this.areUserSettingsLoaded=!0;d=this.WMj();0<d.length&&this.Ay.unshift({label:Kg.favorites,labelDisplayName:null,id:new xx(Kg.favorites),displayName:null,items:d,isLoaded:!0,H1:!1})}return this.Ay}WMj(){const d=[];var n=this.fp.wFm();if(0<(null===n||void 0===n?void 0:n.length)){const B=this.gyi();for(const Q of n)if(n=B.find(ha=>ha.id==Q))n.isThemeInFavorites=!0,d.push(n)}return d}gyi(){var d;const n=[];null===(d=this.Ay)||void 0===d?void 0:d.forEach(B=>
{n.push(...B.items)});return n}Fnc(d){for(const n of this.GCc)if(n.I7c()&&n.I7c().Bb(d))return n.I7c().K(d);F.ULS.shipAssertTag(590386456,3016,!1);return 0}toggleFavorite(d){this.fp.Ctp(d.id);d.isThemeInFavorites=!d.isThemeInFavorites;this.Ay=null;this.vd.raiseEvent("OnThemesChanged")}JIn(){var d,n;this.SYb+=yf.a.R_n;const B=null!==(n=null===(d=this.VGi())||void 0===d?void 0:d.items.length)&&void 0!==n?n:0;d=this.SYb<B;this.SYb=Math.min(this.SYb,B);this.vd.raiseEvent("OnShowMoreThemes",new pl.a(d));
return this.SYb}Wbj(){if(null!==this.Sze)for(const d of this.GCc)d.H1(this.Sze)&&d.mle(this.Sze,!0)}setSelectedSection(d){this.Sze=d;this.Wbj()}VGi(){var d;if(null===(d=this.Ay)||void 0===d||!d.length)return null;for(const n of this.Ay)if(n.id.getLabel()===Kg.main)return n;return null}gUl(d){const n=[];null===d||void 0===d?void 0:d.forEach(B=>{n.push({label:B.label,labelDisplayName:B.labelDisplayName,id:B.id,displayName:B.displayName,items:[...B.items],isLoaded:B.isLoaded,H1:B.H1})});return n}}Object(D.a)(SE,
"ThemeGenerator",null,[1054,478]);class jH{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di){this.Fjl=d;this.c$a=n;this.oe=B;this.VN=Q;this.wC=ha;this.Bv=Aa;this.dM=bb;this.Iwa=Ib;this.gh=oc;this.GR=Ac;this.Mmp=ad;this.sAp=sd;this.Xc=wd;this.ZQo=yd;this.Qn=be;this.g4=ye;this.fN=Qe;this.fpp=af;this.Yop=Qf;this.Eq=hf;this.hN=di;this.Goj=()=>{var vj;null===(vj=this.hN)||void 0===vj?void 0:vj.B4d();this.g4.JJj(this.Goj)}}async applyTheme(d,n){var B,Q,ha,Aa;if(!d)return F.ULS.shipAssertTag(593073563,
3016,!1),!1;const bb=this.Eq.rg("UserAction",yf.a.applyTheme),Ib=Date.now();let oc;try{const Ac=this.gh.ama(this.Xc.Fd),ad=this.oe.nmn();this.ZQo.L1n();let sd=this.e7c();await this.cpg(sd);if(d.type===uf.templateTheme||d.type===uf.officeTemplate)null===(B=this.hN)||void 0===B?void 0:B.BIg();2!==(null===(Q=this.hN)||void 0===Q?void 0:Q.eYa())&&(this.fN.G3m()?(this.VN.Ae(()=>this.c$a.wFo(),"WD:RAD"),sd=this.e7c()):this.oe.cwb()&&this.c$a.H3m()&&(this.c$a.hHo(),this.lG(),sd=this.e7c()));const wd=this.pLm(d,
sd);B=!1;let yd=Se.a.y8a;if(this.g4.wbp(d,wd)){if(d.type===uf.templateTheme||d.type===uf.officeTemplate)B=!0,this.g4.ojf(this.Goj);this.g4.showDialog();yd=Se.a.Flf}let be;this.oe.xge()&&(be=this.fpp.iUm(this.Xc.Fd));const ye=null===be||void 0===be?void 0:be.w0j,Qe=this.jqo(d,sd,ye,Ac&&ad,n,yd);this.bqo(d,wd);this.kqo(d);d.type!==uf.templateTheme||B||(null===(ha=this.hN)||void 0===ha?void 0:ha.B4d());F.ULS.sendTraceTag(543481999,3016,50,`applyTheme result=${Qe},
        isDocumentEmpty=${Ac},
        isBootstrappingEnabled=${ad},
        areTablesEnabled=${this.oe.xge()},
        areSimpleHeadedTablesDetected=${0<(null===ye||void 0===ye?void 0:ye.length)}`);oc=[Object.assign(new Ja.a,{name:yf.a.cfl,int64:be.other.length}),Object.assign(new Ja.a,{name:yf.a.efl,int64:be.w0j.length}),Object.assign(new Ja.a,{name:yf.a.Yel,int64:be.XTl.length}),Object.assign(new Ja.a,{name:yf.a.bfl,int64:be.vYn.length}),Object.assign(new Ja.a,{name:yf.a.dfl,int64:Qe}),Object.assign(new Ja.a,{name:yf.a.$el,int64:Ac}),Object.assign(new Ja.a,{name:yf.a.Zel,int64:ad}),Object.assign(new Ja.a,
{name:yf.a.Xel,int64:this.oe.xge()}),Object.assign(new Ja.a,{name:"IsProactivePane",bool:bi.ycd}),Object.assign(new Ja.a,{name:"DesignType",string:null===(Aa=null===bi||void 0===bi?void 0:bi.$E)||void 0===Aa?void 0:Aa.fQb.toString()}),Object.assign(new Ja.a,{name:"IsTemplateApplied",string:bi.$E&&0!=bi.$E.fQb})];return Qe}catch(Ac){return F.ULS.shipAssertTag(592720733,3016,!1,String.format("{0} {1}",Ac.message,Ac.stack)),oc=[Object.assign(new Ja.a,{name:"error",string:Ac.message})],!1}finally{sb.a(yf.a.afl,
!0,Date.now()-Ib,oc),bb.stop()}}jqo(d,n,B=[],Q=!1,ha=!1,Aa=Se.a.y8a){var bb,Ib,oc;let Ac=!0;Aa=this.wC.Vc(15,Aa);try{Aa.KB.Eb(this.Xc.Fd);this.VN.Ae(()=>this.Mmp.x7l(d),"WD:MS");const ad=this.sAp.create(d,ha||2===(null===(bb=this.hN)||void 0===bb?void 0:bb.eYa()),2===(null===(Ib=this.hN)||void 0===Ib?void 0:Ib.eYa()));ad.o9h(n);this.VN.Ae(()=>{for(const sd of n)Ac=!!this.GR.zpo(sd,(wd,yd)=>{ad.axc(yd,wd)||this.VN.Ae(()=>this.dM.$la(yd,wd.role),"WD:ASFR");return!0})&&Ac},"WD:PPFAT");this.VN.Ae(()=>
ad.cNb(),"WD:URPAF");this.VN.Ae(()=>this.Bv.X2(),"WD:ULN");this.VN.Ae(()=>this.wlf(d),"WD:ABC");Q&&this.Fjl.Afe(this.oe.zmn());2!==(null===(oc=this.hN)||void 0===oc?void 0:oc.eYa())&&(null===B||void 0===B?0:B.length)&&this.VN.Ae(()=>this.Yop.jfl(d,B),"WD:ATTT")}finally{Aa&&Aa.dispose()}return Ac}pLm(d,n){var B,Q,ha,Aa,bb=new Set;for(const [Ib,oc]of d.styles)(null===(B=oc.decorators)||void 0===B?0:B.length)&&bb.add(Yn.g(Ib));d=new ma.a(n.filter(Ib=>bf.ParagraphReader.lc(Ib)&&!Ib.UKa));bb=this.Qn.$Ii(bb,
d);if(!bb.has(2))for(const Ib of d)d=null!==(ha=null===(Q=this.Qn.YD(Ib))||void 0===Q?void 0:Q.role)&&void 0!==ha?ha:1,n=null===Ib||void 0===Ib?void 0:Ib.ZR,(null!==(Aa=null===n||void 0===n?void 0:n.ka(Dd.a.na,void 0))&&void 0!==Aa?Aa:void 0)==kr.a.wDb&&1===d&&(this.Qn.prd(Ib,2,!1),bb.set(2,new ma.a([Ib])));return bb}bqo(d,n){this.VN.Ae(()=>{for(const B of n.keys())for(const Q of n.get(B))this.VN.Ae(()=>{var ha;return this.c$a.eYh(Q,null===(ha=d.styles.get(Yn.h(B)))||void 0===ha?void 0:ha.decorators,
d.type)},"WD:ADFS")},"WD:PSD")}kqo(d){d.decorators&&this.VN.Ae(()=>this.c$a.eYh(this.Xc.Fd,d.decorators,d.type),"WD:ADFT")}async cpg(d){d=this.c$a.cpg(d);let n;const B=new Promise(Q=>n=setTimeout(()=>{Q();F.ULS.sendTraceTag(527202188,3016,50,"Reading intelligence timed out")},2E3));await Promise.race([d,B]);clearTimeout(n)}wlf(d){var n;const B=null===(n=this.Xc)||void 0===n?void 0:n.Fd;B?void 0===d.backgroundColor?B.hasProperty(xd.a.hU)&&B.setValue(xd.a.hU,Vf.a.gC):B.setValue(xd.a.hU,Vf.a.gja(d.backgroundColor)):
F.ULS.shipAssertTag(541102279,3016,!1)}e7c(){const d=this.gh.Vn(this.Xc.Fd),n=this.Iwa.KWa(d,!0,!1),B=[];this.VN.Ae(()=>{do B.push(n.uC);while(n.Jna())},"WD:IFAP");return B}lG(){this.gh.Vn(this.Xc.Fd).hk().Jg.lG(null,()=>{F.ULS.sendTraceTag(508937036,3016,50,"forceOutbound failed")},null)}}Object(D.a)(jH,"ThemeManager",null,[1053]);class kH{constructor(d,n,B,Q){this.Eeh=null;this.xO=d;this.pmb=n;this.mzk=Q;this.OOe=new ma.a;this.yOh=new ma.a}o9h(){}axc(d,n){if(!d)return F.ULS.shipAssertTag(590206988,
3016,!1),!1;switch(n.role){case 1:return this.yOh.add(d),!0;case 13:return this.Aoo(d,n.Acb),!1;default:return!1}}cNb(){var d=this.mzk.styles.get(Yn.h(13)),n=1;0<this.OOe.count&&(n=this.xql(this.OOe),n=2*d.fontSize/n);for(const B of this.yOh)if(d=vc.a.kb(B),bf.ParagraphReader.isEmpty(d))this.pmb.$la(B,13);else{d=[];if(1!==n){const Q=Math.ceil(n*this.y3h(B));d.push({type:$f.FormattingSuggestionType.FontSize,fixedValue:Q.toString()})}this.pmb.Oob(B,d)}}Aoo(d,n){this.OOe.add(this.y3h(d));!this.Eeh&&
n&&(this.Eeh=this.Dsi(d,xd.a.font,null))}Dsi(d,n,B){return(d=this.xO.uu(ge.a.create(d)))?this.xO.rh(d,n,B):B}xql(d){d.Sc((B,Q)=>B-Q);const n=d.count>>1;return d.count%2?d.K(n):(d.K(n)+d.K(n-1))/2}y3h(d){const n=this.Dsi(d,xd.a.fontSize,qt.a.AL),B=(d.ra?d.ra.length:0)-1;let Q=0,ha=0;for(let bb=0;bb<B;bb++){var Aa=d.ra.jc(bb);const Ib=d.ra.jc(bb+1);let oc=n;Aa.formatting&&(oc=this.xO.rh(Aa.formatting,xd.a.fontSize,n));Aa=Ib.cp-Aa.cp;Q+=oc*Aa;ha+=Aa}return 0<ha?Q/ha:n}}Object(D.a)(kH,"UnknownRoleProcessor",
null,[1092]);class SC{constructor(d,n,B=!1){this.Uzf=d;this.a6=n;this.z$m=B;this.AOg=new Set}o9h(d){d.forEach(n=>{this.z$m&&(null===n||void 0===n?0:n.UKa)||1!==this.Uzf.YD(n).role||(this.a6.azc(n,!0),this.AOg.add(n))})}axc(d){return this.AOg.has(d)}cNb(){this.AOg.forEach(d=>{this.a6.P1a(d,!0)})}}Object(D.a)(SC,"UnknownRoleProcessorPreserveStyle",null,[1092]);class kv{constructor(d,n,B,Q,ha){this.Uzf=d;this.I4=n;this.dM=B;this.oe=Q;this.a6=ha}create(d,n,B=!1){return n?new SC(this.Uzf,this.a6,B):new kH(this.I4,
this.dM,this.oe,d)}}Object(D.a)(kv,"UnknownRoleProcessorFactory",null,[1052]);class Bx{constructor(){this.initialized=!1;this.map=new Map}initialize(){this.initialized=!0}register(d,n){this.initialized||this.initialize();this.map.has(d)||this.map.set(d,[]);this.map.get(d).push(n)}unregister(d){this.map.delete(d)}}Object(D.a)(Bx,"ASuggestionLifecycleManager",null,[1050]);class Jz extends Bx{constructor(d){super();this.$r=d;this.wyb=(n,B)=>{if(B.property===xd.a.lastModifiedTime&&this.map.has(B.node)){const Q=
B.node.ka(xd.a.lastModifiedTime,void 0);if(Q){let ha=!0;this.map.get(B.node).forEach(Aa=>{Aa.PYh&&Aa.PYh>=Q?Aa.sfd():ha=!1});ha&&this.map.delete(B.node)}}}}initialize(){this.$r.Hf(12).yq(this.wyb);super.initialize()}register(d,n){super.register(d,n);n.PYh=d.ka(xd.a.lastModifiedTime,void 0)}}Object(D.a)(Jz,"ConsistencySuggestionLifecycleManager",Bx,[1050]);class Gy extends Bx{constructor(d){super();this.$r=d;this.vyb=(n,B)=>{this.map.has(B.node)&&(this.map.get(B.node).forEach(Q=>{Q.sfd()}),this.map.delete(B.node))};
this.z5n=(n,B)=>{this.map.has(B.node)&&!Object(Wh.a)(B.node,5)&&(this.map.get(B.node).forEach(Q=>{(Object(Ym.e)(Q)||2===(null===Q||void 0===Q?void 0:Q.Qs))&&Q.sfd()}),this.map.delete(B.node))}}initialize(){const d=this.$r.Hf(12);d.bA(this.vyb);d.yq(this.z5n);super.initialize()}}Object(D.a)(Gy,"EnhancementSuggestionLifecycleManager",Bx,[1050]);class TE{constructor(d){this.Dh=d;this.GAf=this.RAg=null;this.xje=this.isInitialized=!1;this.hJj=(n,B)=>{this.Dh.Xca(B.actionId)&&(this.RAg?this.RAg(null):F.ULS.shipAssertTag(574755666,
3016,!1))};this.S$j=()=>{this.GAf?(this.GAf(),sb.a(yf.a.J_l,!0),F.ULS.sendTraceTag(537794770,3016,50,"Revert button has been disabled")):F.ULS.shipAssertTag(537794769,3016,!1)}}initialize(){this.isInitialized||(this.G3b(),this.isInitialized=!0)}he(){this.isInitialized&&(this.Thb(),this.isInitialized=!1)}setSelectThemeButtonCallback(d){this.RAg=d}setDisableRevertButtonCallback(d){this.GAf=d}G3b(){this.xje||(this.Dh.ffc(this.hJj),this.Dh.v8k(this.S$j),this.xje=!0)}Thb(){this.xje&&(this.Dh.zwg(this.hJj),
this.Dh.lJo(this.S$j),this.xje=!1)}}Object(D.a)(TE,"DesignerUndoTracker",null,[1049,478]);class ew extends Ea.a{constructor(d,n){super(!1,!1,!0);this.By=d;this.av=n;this.VNb=void 0;this.Uwl=B=>{sb.a(yf.a.rqk,!0,void 0,[{name:"chosenOption",string:B},{name:"index",int64:this.VNb.findIndex(Q=>Q.id===B)}]);this.hide();switch(B){case "Template":this.By.show(22);break;case "Upload":window.open("https://onedrive.live.com/");break;case "Learn":window.open("https://support.microsoft.com/en-us/word");break;
case "Other":this.av.invokeUserFeedback("WordUserIntentDialogSurvey")}}}jdn(){this.VNb=[{["id"]:"Explore",["text"]:WacWordeditorStrings.UserIntentDialogExplore,["imageSrc"]:Rm.a.kh("UserIntentExploreIcon.png")},{["id"]:"Template",["text"]:WacWordeditorStrings.UserIntentDialogTemplate,["imageSrc"]:Rm.a.kh("UserIntentTemplateIcon.png")},{["id"]:"Blank",["text"]:WacWordeditorStrings.UserIntentDialogBlank,["imageSrc"]:Rm.a.kh("UserIntentStartBlankIcon.png")},{["id"]:"Upload",["text"]:WacWordeditorStrings.UserIntentDialogUpload,
["imageSrc"]:Rm.a.kh("UserIntentUploadFileIcon.png")},{["id"]:"Learn",["text"]:WacWordeditorStrings.UserIntentDialogLearn,["imageSrc"]:Rm.a.kh("UserIntentHowToIcon.png")}];const d={["id"]:"Other",["text"]:WacWordeditorStrings.UserIntentDialogOther,["imageSrc"]:Rm.a.kh("UserIntentMoreItemsIcon.png")};ew.Bgp(this.VNb);this.VNb.push(d)}agp(){void 0===this.VNb&&this.jdn();localStorage.setItem(ew.yki,"true");this.ti("",void 0,{["id"]:ew.id,["dialogButtonsOption"]:5,["bodyControls"]:{["dialogTitle"]:WacWordeditorStrings.UserIntentDialogTitle,
["dialogSubtitle"]:WacWordeditorStrings.UserIntentDialogSubtitle,["chooseFunction"]:this.Uwl,["rowsInfo"]:[this.VNb.slice(0,3),this.VNb.slice(3,6)]}});sb.a(yf.a.sqk)}static Bgp(d){for(let n=d.length-1;0<n;n--){const B=Math.floor(Math.random()*(n+1));[d[n],d[B]]=[d[B],d[n]]}}}ew.id="UserIntentDialog";ew.yki="UserIntentDialogShown";Object(D.a)(ew,"UserIntentDialog",Ea.a,[]);class $n{constructor(d,n){this.oqa=d;this.ZQg=n;this.isInitialized=!1;this.r8j=(B,Q)=>{Q.zja&&this.ZQg&&this.ZQg.agp()}}initialize(){if(!this.isInitialized){for(const d of this.oqa)d.Qsa(this.r8j),
d.initialize();this.isInitialized=!0}}he(){if(this.isInitialized){for(const d of this.oqa)d.he(),d.NFa(this.r8j);this.isInitialized=!1}}}Object(D.a)($n,"UserIntentDialogTriggerManager",null,[1048]);var Jw=e(111);class Hh{constructor(d,n){this.theme=d;this.callback=n}}Object(D.a)(Hh,"ApplyThemeActionData",null,[]);class AJ{constructor(d){this.callback=d}}Object(D.a)(AJ,"FixInconsistenciesActionData",null,[]);var Ys=e(108);class Hy{constructor(d,n){this.query=d;this.callback=n}}Object(D.a)(Hy,"GenerateDocumentActionData",
null,[]);class OG{constructor(d,n){this.template=d;this.q4n=n}}Object(D.a)(OG,"ApplyOfficeTemplateActionData",null,[]);class oy{constructor(d,n,B,Q,ha,Aa){this.a$a=ha;this.fq=Aa;this.ga=d;this.Qfa=n;this.uOh=B}hfl(d,n){d=new Hh(d,n);this.ga.Zb(Se.a.y8a,2,d)}gel(d,n){d=new OG(d,n);this.ga.Zb(Se.a.oBa,2,d)}generateDocument(d,n){d=new Hy(d,n);this.ga.Zb(Se.a.cYl,2,d)}vgm(d){d=new AJ(d);this.ga.Zb(dd.a.X6d,2,d)}acceptAll(){const d=new Gn.a(0);this.ga.Zb(Se.a.kob,2,d)}rejectAll(){this.ga.Vb(dd.a.Ind,2)}showMoreThemes(){this.ga.Vb(dd.a.bki,
2)}logThemeInfo(d){this.ga.Zb(dd.a.Xji,2,{theme:d})}setReviewingCallback(d){this.Qfa.U4o(d)}setSelectThemeButtonCallback(d){this.uOh.setSelectThemeButtonCallback(d)}setDisableRevertButtonCallback(d){this.uOh.setDisableRevertButtonCallback(d)}reviewChanges(){this.ga.Vb(dd.a.Szf,2)}openGreenroomInNewTab(){this.ga.Vb(dd.a.Yji,2)}invokeUserFeedback(d){this.a$a.P2c(n=>{this.Xfp(n,d)})}Xfp(d,n){d.y2a(n,null)}tryAnyway(){this.ga.Vb(dd.a.dki,2)}revertTheme(){this.ga.Vb(dd.a.$yg,2)}getFontColorCssWithRespectTheming(d){return this.fq.LLf(Vf.a.gja(d),
new Ys.a(Jw.a.YQ()))}getColorCssWithRespectTheming(d){return this.fq.t1(Vf.a.gja(d),new Ys.a(Jw.a.YQ()))}toggleFavorite(d,n){this.ga.Zb(dd.a.ksi,2,{theme:d,Asn:n})}}Object(D.a)(oy,"DesignerPropsActions",null,[1044]);class TC{constructor(){this.type=null;this.isDataLoaded=!1;this.errorState=of.none;this.activeSection=this.sections=null;this.isPaneAutoOpened=!1;this.ns=0;this.applyOfficeTemplate=this.applyTheme=this.reviewChanges=this.fixInconsistencies=null;this.inconsistenciesCount=0;this.rejectAll=
this.acceptAll=null;this.hasMoreThemesToShow=!1;this.tryAnyway=this.logThemeInfo=this.tryAgain=this.showMoreThemes=null;this.errorTimeout=0;this.paneContent=this.revertTheme=this.openGreenroomInNewTab=this.invokeUserFeedback=this.setDisableRevertButtonCallback=this.setSelectThemeButtonCallback=this.setReviewingCallback=null;this.canGetFocus=!0;this.generateDocument=this.toggleFavorite=null;this.areUserSettingsLoaded=!1;this.setSelectedSection=this.showMoreTemplates=null}}Object(D.a)(TC,"DesignerTaskPaneData",
null,[]);class Cx{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.oe=d;this.av=n;this.tca=B;this.nfo=Q;this.jX=ha;this.Qn=Aa;this.UO=bb;this.hN=Ib}aWa(){var d,n;return Object.assign(new TC,{acceptAll:Object(X.a)(this.av,this.av.acceptAll,"acceptAll"),applyTheme:Object(X.a)(this.av,this.av.hfl,"applyThemeHandler"),applyOfficeTemplate:Object(X.a)(this.av,this.av.gel,"applyOfficeTemplateHandler"),generateDocument:Object(X.a)(this.av,this.av.generateDocument,"generateDocument"),isDataLoaded:this.nfo.irc,errorState:this.tca.EPb,
fixInconsistencies:Object(X.a)(this.av,this.av.vgm,"fixInconsistenciesHandler"),inconsistenciesCount:this.Qn.inconsistenciesCount,invokeUserFeedback:void 0,rejectAll:Object(X.a)(this.av,this.av.rejectAll,"rejectAll"),hasMoreThemesToShow:!0,showMoreThemes:Object(X.a)(this.av,this.av.showMoreThemes,"showMoreThemes"),logThemeInfo:Object(X.a)(this.av,this.av.logThemeInfo,"logThemeInfo"),reviewChanges:Object(X.a)(this.av,this.av.reviewChanges,"reviewChanges"),setReviewingCallback:Object(X.a)(this.av,this.av.setReviewingCallback,
"setReviewingCallback"),setSelectThemeButtonCallback:Object(X.a)(this.av,this.av.setSelectThemeButtonCallback,"setSelectThemeButtonCallback"),setDisableRevertButtonCallback:Object(X.a)(this.av,this.av.setDisableRevertButtonCallback,"setDisableRevertButtonCallback"),sections:this.jX.ZSf(),activeSection:this.jX.Flc(),type:yf.a.r5j,tryAnyway:Object(X.a)(this.av,this.av.tryAnyway,"tryAnyway"),openGreenroomInNewTab:this.oe.Won()?Object(X.a)(this.av,this.av.openGreenroomInNewTab,"openGreenroomInNewTab"):
void 0,revertTheme:Object(X.a)(this.av,this.av.revertTheme,"revertTheme"),isCanvasDarkModeOn:!!this.UO&&this.UO.S0,getFontColorCssWithRespectTheming:Object(X.a)(this.av,this.av.getFontColorCssWithRespectTheming,"getFontColorCssWithRespectTheming"),getColorCssWithRespectTheming:Object(X.a)(this.av,this.av.getColorCssWithRespectTheming,"getColorCssWithRespectTheming"),paneContent:null!==(n=null===(d=this.hN)||void 0===d?void 0:d.eCi())&&void 0!==n?n:pf.main,canGetFocus:!0,toggleFavorite:this.oe.K0f()?
Object(X.a)(this.av,this.av.toggleFavorite,"toggleFavorite"):void 0,areUserSettingsLoaded:this.jX.areUserSettingsLoaded,showMoreTemplates:Object(X.a)(this.jX,this.jX.Wbj,"loadMoreTemplates"),setSelectedSection:Object(X.a)(this.jX,this.jX.setSelectedSection,"setSelectedSection")})}Czl(d){return Object.assign(new TC,{acceptAll:d.acceptAll,applyTheme:d.applyTheme,applyOfficeTemplate:d.applyOfficeTemplate,generateDocument:d.generateDocument,isPaneAutoOpened:d.isPaneAutoOpened,errorState:d.errorState,
isDataLoaded:d.isDataLoaded,fixInconsistencies:d.fixInconsistencies,inconsistenciesCount:d.inconsistenciesCount,invokeUserFeedback:d.invokeUserFeedback,rejectAll:d.rejectAll,hasMoreThemesToShow:d.hasMoreThemesToShow,showMoreThemes:d.showMoreThemes,logThemeInfo:d.logThemeInfo,reviewChanges:d.reviewChanges,setReviewingCallback:d.setReviewingCallback,setSelectThemeButtonCallback:d.setSelectThemeButtonCallback,setDisableRevertButtonCallback:d.setDisableRevertButtonCallback,sections:d.sections,activeSection:d.activeSection,
type:d.type,tryAnyway:d.tryAnyway,openGreenroomInNewTab:d.openGreenroomInNewTab,revertTheme:d.revertTheme,isCanvasDarkModeOn:d.isCanvasDarkModeOn,getFontColorCssWithRespectTheming:d.getFontColorCssWithRespectTheming,getColorCssWithRespectTheming:d.getColorCssWithRespectTheming,paneContent:d.paneContent,canGetFocus:d.canGetFocus,toggleFavorite:this.oe.K0f()?d.toggleFavorite:void 0,areUserSettingsLoaded:d.areUserSettingsLoaded,showMoreTemplates:d.showMoreTemplates,setSelectedSection:d.setSelectedSection})}}
Object(D.a)(Cx,"DesignerPropsFactory",null,[1042]);class lH{constructor(d){this.mza=null;this.p8e=d;this.sa=new dc.a}K8k(d){this.sa.addHandler("PropsChangedEvent",d)}Lca(){this.mza||(this.mza=this.p8e.aWa());return this.mza}Wzb(d,n=!1){if(d){this.mza||(F.ULS.shipAssertTag(592496460,3016,!1),this.mza=this.p8e.aWa());var B=this.p8e.Czl(this.mza);d(B);if(n||this.Bcp(B))this.mza=B,d=new pl.a(this.mza),this.sa.Cha&&this.sa.raiseEvent("PropsChangedEvent",d)}else F.ULS.shipAssertTag(592496459,3016,!1)}Bcp(d){return d.inconsistenciesCount!==
this.mza.inconsistenciesCount||d.errorState!==this.mza.errorState||d.isDataLoaded!==this.mza.isDataLoaded||d.invokeUserFeedback!==this.mza.invokeUserFeedback}}Object(D.a)(lH,"DesignerPropsManager",null,[1043]);class lv{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc=0,Ac,ad){this.HLa=d;this.tca=n;this.Qn=B;this.u6=Q;this.jX=ha;this.tSg=Aa;this.av=bb;this.SIf=Ib;this.fro=oc;this.zyf=Ac;this.hN=ad;this.isInitialized=!1;this.prg=0;this.Hld=null;this.Z5n=(sd,wd)=>{this.ZEl(()=>{this.HLa.Wzb(yd=>{yd.inconsistenciesCount=
wd.data;yd.canGetFocus=!0})})};this.Hre=()=>{this.HLa.Wzb(sd=>{sd.sections=this.jX.ZSf();sd.activeSection=this.jX.Flc();sd.canGetFocus=!0;sd.areUserSettingsLoaded=this.jX.areUserSettingsLoaded},!0)};this.G$n=(sd,wd)=>{this.HLa.Wzb(yd=>{yd.sections=this.jX.ZSf();yd.hasMoreThemesToShow=wd.data;yd.canGetFocus=!0;yd.areUserSettingsLoaded=this.jX.areUserSettingsLoaded},!0)};this.Cig=()=>{this.HLa.Wzb(sd=>{if(this.hN){const wd=this.hN.eCi();sd.paneContent!==wd&&(sd.activeSection=void 0,sd.paneContent=wd,
sd.canGetFocus=!1)}},!0)};this.clg=(sd,wd)=>{this.HLa.Wzb(yd=>{yd.isCanvasDarkModeOn=wd.isCanvasDarkModeOn;yd.canGetFocus=!0},!0)};this.KSl=(sd,wd)=>{this.HLa.Wzb(yd=>{yd.errorState=wd.data;yd.canGetFocus=!0})};this.Nse=(sd,wd)=>{this.HLa.Wzb(yd=>{yd.isDataLoaded=wd.data;yd.canGetFocus=!0;yd.isPaneAutoOpened=bi.ycd})}}initialize(){this.isInitialized||(this.Qn.x7k(this.Z5n),this.tca.qUh(this.KSl),this.jX.ZUd(this.Hre),this.jX.h8k(this.G$n),this.u6.ujf(this.Nse),this.zyf.TUd(this.clg),this.SIf.execute(async d=>
{await d.isFeatureEnabled(yf.a.alj,!1)&&this.HLa.Wzb(n=>{n.invokeUserFeedback=B=>this.av.invokeUserFeedback(B);n.canGetFocus=!0},!0)}),this.hN&&this.hN.UUh(this.Cig),this.isInitialized=!0)}he(){}ZEl(d){this.Hld?(this.Hld=d,this.prg||(this.prg=this.tSg.setTimeout(()=>{this.Hld();this.prg=0},this.fro))):(this.Hld=d,this.Hld())}}Object(D.a)(lv,"DesignerPropsUpdater",null,[1041,478]);class Ov{constructor(d,n,B){this.zI=d;this.iYl=n;this.tb=B;this.j_=()=>{this.had();this.tb.z1a(this.j_)};if(!d)throw Ou.a.argument("AppLifecycleManager is null");
if(!B)throw Ou.a.argument("Workspace is null");}get oe(){return null!=this.QYg?this.QYg:this.QYg=(()=>this.container.resolve("WordEditor.Designer.IDesignerControl"))()}get name(){return"WordEditor.Designer"}init(){this.container.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Ec(d){this.container=d;d.ja("WordEditor.Designer.Perf.IPerfLogger",()=>new Mb.a(gc.a.We)).ha();d.ja("WordEditor.Designer.Persistence.IDesignerTransactionFactory",()=>new EC(d.resolve("Box4.Graph.IGraphTransactionFactory"),
d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();d.ja("WordEditor.Designer.AL.IWorkflowManager",()=>{const ha=new ma.a;ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN);ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb);ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab);ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cze);ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").d6j);
ha.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6);return new uq(d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),ha)}).ha();d.ja("WordEditor.Designer.Style.IStyleManager",()=>new cB(d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("WordEditor.Designer.Storage.StyleStorage"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();
d.ja("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager",()=>new UJ(ge.a.createTextRange,d.resolve("Box4.IFormattingReader"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.List.IListReader"),d.resolve("Box4.IOutlineElementNavigator"),d.resolve("Box4.TextFormattingHelper"),d.resolve("Box4.List.ListItemEditor"))).ha();d.ja("WordEditor.Designer.Style.IManualListConverter",()=>new qh(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.List.IListEditor"),d.resolve("Box4.List.IListReader"),
d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.IParagraphIndentationReader"),R.a.dbb)).ha();d.ja("WordEditor.Designer.Style.Decorator.DecoratorStorage",()=>new TJ).ha();d.ja("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory",()=>new zx(G.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),
d.resolve("Box4.ISelectionManager"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Designer.Image.DesignerImageManager"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),this.tb.Xc,d.resolve("Box4.ITableEditor"),d.resolve("Box4.ICharacterPropertiesEditor"),aa.a.Gd(),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.IParagraphIteratorFactory"),new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.Xc.Fd),
this.l9j(),d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),d.resolve("Box4.Styles.IWACStyleReader"),Object(Cg.a)(),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ja("WordEditor.Designer.Style.Decorator.DecoratorManager",()=>new cw(d.resolve("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory"),
d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("Box4.IUndoManager"),d.resolve("Box4.Graph.IGraphIteratorFactory"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null,d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.Xc.Fd))).ha();d.ja("WordEditor.Designer.Style.IParagraphDesigner",()=>new QE(d.resolve("WordEditor.Designer.IDesignerControl"),
ge.a.createTextRange,d.resolve("Box4.IFormattingReader"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.IParagraphEditor"),d.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("Box4.TextFormattingHelper"),d.resolve("Box4.List.IListReader"),d.resolve("WordEditor.Designer.Style.IManualListConverter"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.AugmentationLoop.IFormattingExtractor"),
this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ja("WordEditor.Designer.Style.IUnknownRoleProcessorFactory",()=>new kv(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.IFormattingReader"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Review.IRestoreManager"))).ha();d.ja("WordEditor.Designer.Style.IBlankDocumentEditor",
()=>new Hz(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("WordEditor.ContentControl.IContentControlManager"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.IHyperlinkEditor"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.TextFormattingHelper"),this.tb.Xc)).ha();d.ja("WordEditor.Designer.Style.ITableDesigner",()=>new RC(d.resolve("WordEditor.IWACTableStyleReader"),
rg.a.instance)).ha();d.ja("WordEditor.Designer.Style.ITableManager",()=>new dw(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Qpp,d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"))).ha();d.ja("WordEditor.Designer.Style.IThemeManager",()=>new jH(d.resolve("WordEditor.Designer.Style.IBlankDocumentEditor"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Perf.IPerfLogger"),
d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.IFlatListEditor"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphIteratorFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Designer.Review.IReviewManager"),d.resolve("WordEditor.Designer.Style.IStyleManager"),d.resolve("WordEditor.Designer.Style.IUnknownRoleProcessorFactory"),this.tb.Xc,d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater"),
d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("WordEditor.Designer.Style.ITableManager"),d.resolve("WordEditor.Designer.Style.ITableDesigner"),d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ja("WordEditor.Designer.Image.DesignerImageManagerImpl",
()=>new Pu(d.resolve("Box4.IOutlineElementEditor"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.Images.IImageEditor"),d.resolve("WordEditor.IImageEditor"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),this.tb.Xc,this.l9j())).as("WordEditor.Designer.Image.DesignerImageManager").ha();d.ja("WordEditor.Designer.Image.DesignerTextToImageManagerImpl",()=>new dh(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").f4b,this.tb.Xc,d.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Designer.Image.DesignerTextToImageManager").ha();d.ja("WordEditor.Designer.Style.IDocumentLanguageManager",()=>new jv(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN)).ha();d.ja("WordEditor.Designer.Style.IRevertManager",()=>new Iw(d.resolve("Box4.Graph.IGraphTransactionFactory"),d.resolve("Box4.IUndoManager"),this.tb.py)).ha();
d.ja("WordEditor.Designer.Style.ApplyThemeDialogManager",()=>new OJ(d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"))).ha();this.rBo();this.tDo();this.aEo();this.lBo();d.ja("WordEditor.Designer.FRE.IFirstRunExperienceManager",()=>new Vs(d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
d.Za("Common.ISystemInitiatedFeedback"))).ha();d.ja("WordEditor.Designer.Style.IThemeCategorizer",()=>new gh(d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.Designer.Perf.IPerfLogger"))).ha();d.ja("WordEditor.Designer.Style.CurrentThemeProvider",()=>new Fw(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").d6j)).ha();d.ja("WordEditor.Designer.Style.AugLoopThemeProvider",()=>new MC(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6,
this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();this.oe.cwb()&&d.ja("WordEditor.Designer.Style.OfficeTemplatesThemeProvider",()=>new ap(d.resolve("Box4.OfficeTemplates.OfficeTemplatesDiscoveryService"))).ha();const n=new fa.a(()=>{const ha=[];ha.push(d.resolve("WordEditor.Designer.Style.CurrentThemeProvider"));
ha.push(d.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"));this.oe.cwb()&&ha.push(d.resolve("WordEditor.Designer.Style.OfficeTemplatesThemeProvider"));return ha});d.ja("WordEditor.Designer.Style.IThemeGenerator",()=>new SE(n.value,d.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha();d.ja("WordEditor.Designer.Trackers.IDesignerUndoTracker",()=>new TE(d.resolve("Box4.IUndoManager"))).ha();d.ja("WordEditor.Designer.Wire.IDesignerPropsActions",
()=>new oy(G.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Review.IReviewManager"),d.resolve("WordEditor.Designer.Trackers.IDesignerUndoTracker"),d.Za("Common.ISystemInitiatedFeedback"),ju.a.F5c(),d.resolve("Box4.ICssColorProvider"))).ha();d.ja("WordEditor.Designer.Wire.IDesignerPropsFactory",()=>new Cx(d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),
d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.IDarkModeState"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ja("WordEditor.Designer.BrowserApis.IWindowTimeout",()=>new Ts).ha();d.ja("WordEditor.Designer.Wire.IDesignerPropsUpdater",()=>new lv(d.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),
d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),d.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),d.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.oe.ONm(),d.resolve("Box4.DarkModeEventsManager"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):
null)).ha();d.ja("WordEditor.Designer.Wire.IDesignerPropsManager",()=>new lH(d.resolve("WordEditor.Designer.Wire.IDesignerPropsFactory"))).ha();d.ja("WordEditor.Designer.Logging.IBlankDocumentLogger",()=>new NG(d.resolve("Box4.IParagraphReader"),this.tb.Xc)).ha();d.ja("WordEditor.Designer.Logging.IConsistencyFixActionsLogger",()=>new zJ(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb,d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab,d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha();
d.ja("WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",()=>new sl(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN)).ha();d.ja("WordEditor.Designer.Logging.IProactiveSurveyEventLogger",()=>new px(d.Za("Common.ISystemInitiatedFeedback"),d.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ja("WordEditor.Designer.IDesignerTaskPane",()=>new KE(yg.StaticActiveAppFrame.Aa(),d.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),
d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),df.FocusManager.instance(),ui.a.instance,Vc.UISurfaces.aw,d.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),d.resolve("WordEditor.Designer.License.ILicenseManager"),d.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"))).ha();const B=new fa.a(()=>new DC);d.ja("WordEditor.Designer.IDesignerTaskPaneEvents",()=>B.value).ha();d.ja("WordEditor.Designer.IDesignerTaskPaneEventsInternal",
()=>B.value).ha();d.ja("WordEditor.Designer.License.ILicenseManager",()=>new gx(d.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();d.ja("WordEditor.Designer.Storage.IParagraphFormattingStorage",()=>new PE).ha();d.ja("WordEditor.Designer.Storage.StyleStorage",()=>new wx).ha();d.ja("WordEditor.Designer.Review.IReviewTraverser",()=>new Cy(d.resolve("Box4.Intent.IIntentRangeEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IParagraphIteratorFactory"),this.tb.Xc)).ha();
d.ja("WordEditor.Designer.Review.IRestoreManager",()=>new OE(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("WordEditor.IFlatListEditor"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.IParagraphEditor"),d.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),d.resolve("Box4.TextFormattingHelper"),ge.a.createTextRange,d.resolve("WordEditor.Designer.Storage.StyleStorage"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("Box4.List.IListReader"))).ha();
this.container.ja("WordEditor.Designer.Style.PullQuotesDesigner",()=>new pu(d.resolve("WordEditor.IImageEditor"),d.resolve("Box4.CatchUpActivity.IChangeIdEditor"),d.resolve("Box4.IUndoManager"),G.AFrameworkApplication.J,d.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),d.resolve("Box4.Images.IImageReader"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.IFeatureHelper"),d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.TextFormattingHelper"),d.resolve("Box4.IFormattingEditor"),
d.resolve("WordEditor.ClientPagination.IClientPaginationUlsLogger"),d.resolve("Box4.IOutlineElementEditor"),yg.StaticActiveAppFrame.Aa().tb.Xc,G.AFrameworkApplication.ta.SYa,d.resolve("Box4.IBlobReader"),d.resolve("Box4.Styles.IWACStyleReader"))).ha();this.container.ja("WordEditor.Designer.Style.PullQuotesManager",()=>new QC(d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),d.resolve("WordEditor.Designer.Review.IReviewManager"),
yg.StaticActiveAppFrame.Aa().tb.Xc)).ha();this.container.ja("WordEditor.Designer.Persistence.PersistenceHelper",()=>new zp.a(new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.rd.Hd),d.resolve("Box4.IIntelligenceReader"),d.resolve("Box4.IIntelligenceEditor"),d.resolve("Box4.PersistenceSettingsManager"))).ha();d.ja("WordEditor.Designer.Review.IReviewManager",()=>new pn(G.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Perf.IPerfLogger"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),
d.resolve("Box4.Intent.IIntentRangeEditor"),sb.a,d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Designer.Review.IRestoreManager"),new eB,d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Image.DesignerImageManager"),d.resolve("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager"),d.resolve("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager"),d.Za("Common.ISystemInitiatedFeedback"),d.resolve("WordEditor.Designer.IDesignerControl"),d.Za("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),
d.resolve("Box4.IParagraphIteratorFactory"),d.resolve("Box4.List.IListReader"),this.tb.Xc)).ha();d.ja("WordEditor.Designer.Review.IReviewActions",()=>new aw(d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Review.IReviewManager"),this.tb.py)).ha();d.ja("WordEditor.Designer.OnCanvas.ReviewSelectionManager",()=>new VG(d.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),d.resolve("Box4.ISelectionManager"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();
d.ja("WordEditor.Designer.OnCanvas.HighlightActor",()=>new Vr(d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("Box4.Intent.IIntentRangeEditor"),qd.a.Gg,qd.a.Kz)).ha();d.ja("WordEditor.Designer.OnCanvas.IBlueDotActor",()=>new HJ.a(d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.Highlight.IHighlightManager"),Object(X.a)(Da.a.instance,Da.a.instance.wK,"registerHandlerWithData"),Object(X.a)(Qa.a.instance,Qa.a.instance.Cb,"registerHandler"),d.resolve("Box4.IParagraphReader"),
d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"),this.tb.py)).ha();d.ja("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader",()=>new Dy(d.resolve("Box4.Styles.IWACStyleReader"))).ha();d.ja("WordEditor.Designer.OnCanvas.ITriageOptionFactory",()=>new Ot(d.resolve("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader"),d.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),d.resolve("Box4.Styles.IWACStyleReader"),
d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ja("WordEditor.Designer.OnCanvas.ITriageOptionProvider",()=>new us(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.OnCanvas.ITriageOptionFactory"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();d.ja("WordEditor.Designer.Style.IDocumentConsistencyManager",()=>new OC(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab,
d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("WordEditor.Designer.Review.IReviewManager"),this.tb.Xc,d.resolve("Box4.IParagraphReader"),d.Za("Common.ISystemInitiatedFeedback"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.IFormattingReader"))).ha();const Q=new fa.a(()=>new jr);
d.ja("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition",()=>Q.value).ha();d.ja("Box4.OfficeTemplates.ApplyTemplatesProxy",()=>new Ra(G.AFrameworkApplication.pe));d.ja("WordEditor.Designer.Style.ITemplateAppliedListener",()=>new ym(d.resolve("Box4.IUndoManager")));d.ja("WordEditor.Designer.Actors.DesignerActionActor",()=>new il(G.AFrameworkApplication.va,aa.a.Gd(),d.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),d.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"),
d.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Style.IRevertManager"),d.resolve("WordEditor.Designer.Review.IReviewActions"),d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.resolve("WordEditor.Designer.Review.IReviewManager"),d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),G.AFrameworkApplication.zc,d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.Designer.Style.IThemeManager"),
d.resolve("WordEditor.Designer.Style.IThemeCategorizer"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"),d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),this.oe.loa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null,d.resolve("Box4.OfficeTemplates.ApplyTemplatesProxy"),d.resolve("WordEditor.Designer.Style.ITemplateAppliedListener"),
this.tb.rd,this.container.resolve("Box4.IUndoManager"))).ha();d.ja("WordEditor.Designer.Actors.DesignerActor",()=>new Nn(G.AFrameworkApplication.va,d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.License.ILicenseManager"),appChrome.api,appChrome.actions,d.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),yg.StaticActiveAppFrame.Aa(),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ja("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager",
()=>new Gy(d.resolve("Box4.Graph.IGraphInstance"))).ha();d.ja("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager",()=>new Jz(d.resolve("Box4.Graph.IGraphInstance"))).ha();d.ja("WordEditor.Designer.DocumentTypeEventSource",()=>new Eo).ha();this.oe.ihe()&&d.ja("WordEditor.Designer.DocumentStatsDnmLogger",()=>new Jf(d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("WordEditor.IPageNumberFinder"),d.resolve("WordEditor.Designer.DocumentTypeEventSource"))).ha();this.oe.zBb()&&
d.ja("WordEditor.Designer.Actors.DesignerPasteActor",()=>new Oi(G.AFrameworkApplication.va,d.resolve("WordEditor.Designer.SmartPaste.SmartPasteManager"),d.resolve("Box4.IPasteFloatieEventSource"))).ha();this.oe.zBb()?this.hEo():this.oe.$ge()&&this.WAo();this.oe.UFg()&&this.Nug();this.oe.loa()&&!this.oe.Wvb()&&this.GCo();this.oe.f6i()&&this.BDo();this.oe.k1i()&&this.yCo();this.oe.J0f()&&this.jCo();this.oe.m6i()&&this.DDo();this.oe.r5f()&&this.DEo()}dispose(){}lBo(){this.oe.loa()&&(this.container.ja("WordEditor.Designer.DocumentState.DocumentStateMachine",
()=>new ih).ha(),this.container.ja("WordEditor.Designer.DocumentState.IDocumentStateMonitor",()=>new Eh(this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.container.resolve("WordEditor.Designer.DocumentState.DocumentStateMachine"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha())}tDo(){const d=new fa.a(()=>new Fz(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb)),
n=new fa.a(()=>new YA(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN)),B=new fa.a(()=>new Ay(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6)),Q=new fa.a(()=>{const ha=new ma.a;ha.add(d.value);ha.add(n.value);ha.add(B.value);return ha});this.container.ja("WordEditor.Designer.Pane.PaneLoadingManager",()=>new ZA(this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),Q.value)).as("WordEditor.Designer.Pane.IPaneLoadingManager").ha()}aEo(){this.container.register(zn,
"WordEditor.Designer.WordDesignerSettingsHandler").as("WordEditor.Designer.IWordDesignerSettingsHandler").ha().fe(()=>new zn(this.container.resolve("Box4.IRoamingServiceRequestManager"),this.container.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.container.resolve("Common.IAppSettingsManager"),new dc.a,this.container.resolve("Common.IUlsWrapper")));this.container.ja("WordEditor.Designer.Settings.DesignerSettingsManager",()=>new Zn(this.container.resolve("WordEditor.Designer.WordDesignerSettingsHandler"),
this.container.resolve("WordEditor.Designer.IDesignerControl"))).as("WordEditor.Designer.Settings.IDesignerSettingsManager").ha()}rBo(){const d=new fa.a(()=>new oo(aa.a.Gd(),this.oe.djc())),n=new fa.a(()=>new Qp(this.container.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.container.resolve("Box4.TrackChange.ITrackChangeEventsActor"))),B=new fa.a(()=>new vq(this.container.resolve("WordEditor.Designer.Style.IDocumentLanguageManager"))),Q=new fa.a(()=>new Mt(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb)),
ha=new fa.a(()=>new Us(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN,this.container.resolve("Box4.IParagraphReader"),this.tb.Xc)),Aa=new fa.a(()=>{const bb=new ma.a;this.oe.djc()&&bb.add(d.value);this.oe.Uon()&&bb.add(n.value);bb.add(Q.value);bb.add(B.value);this.oe.gun()&&bb.add(ha.value);return bb});this.container.ja("WordEditor.Designer.Errors.IErrorStateManager",()=>new mu(Aa.value)).ha()}hEo(){this.container.ja("WordEditor.Designer.SmartPaste.SmartPasteManager",
()=>new Qu(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("Box4.UI.PasteFloatieManager"),this.container.Za("Box4.Actors.ClipboardActor"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb,this.container.resolve("Box4.IUndoManager"),Nf.a.wf.Um,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Za("Common.ISystemInitiatedFeedback"),
this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"))).ha()}WAo(){this.container.ja("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext",()=>new Pp(this.container.resolve("Box4.List.IListReader"))).ha();this.container.ja("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider",()=>new Kl(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab,
this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))).ha();const d=new fa.a(()=>new Ar(6,aa.a.Gd(),this.oe.djc())),n=new fa.a(()=>new lu(Nf.a.wf.Um,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))),B=new fa.a(()=>new iv(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),Q=new fa.a(()=>{const ad=
new ma.a;ad.add(n.value);ad.add(B.value);ad.add(d.value);return ad}),ha=new fa.a(()=>new Ki(6,Q.value,null)),Aa=new fa.a(()=>{const ad=[];ad.push(ha.value);return ad}),bb=new fa.a(()=>new Ld(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),Ib=new fa.a(()=>{const ad=new ma.a;ad.add(bb.value);ad.add(B.value);return ad}),oc=new fa.a(()=>new Ki(6,Ib.value,null)),Ac=new fa.a(()=>{const ad=[];ad.push(oc.value);return ad});this.container.ja("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager",
()=>new No(Aa.value,Ac.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider"),!this.oe.R3f())).ha()}BDo(){this.container.ja("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker",()=>new Sp(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb,G.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.container.resolve("WordEditor.Designer.FRE.IFirstRunExperienceManager")));const d=new fa.a(()=>new $G(11)),n=new fa.a(()=>new aH(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),11)),B=new fa.a(()=>new Ld(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.oe.loo(),!1)),Q=new fa.a(()=>{const bb=new ma.a;bb.add(d.value);
bb.add(n.value);bb.add(B.value);return bb}),ha=new fa.a(()=>new ee.a(11,Q.value,null,3016,yf.a.poo)),Aa=new fa.a(()=>{const bb=[];bb.push(ha.value);return bb});this.container.ja("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2",()=>new $v(Aa.value,this.container.resolve("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker"),this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),G.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha()}GCo(){const d=
new fa.a(()=>new hv(this.zI)),n=new fa.a(()=>new GC),B=new fa.a(()=>new mp(15,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),Q=new fa.a(()=>new tc(15,this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,{$yc:!0,U1:!1,e$c:!0,d$c:!0,T1:!0})),ha=new fa.a(()=>{const oc=new ma.a;oc.add(d.value);oc.add(n.value);oc.add(B.value);oc.add(Q.value);return oc}),Aa=new fa.a(()=>new Rp(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.oe.loa()&&!this.oe.Wvb())),bb=new fa.a(()=>new Ki(15,ha.value,Aa.value,null,new By("Jump-start templates loaded",yf.a.N2d,tc.Gnf))),Ib=new fa.a(()=>{const oc=new ma.a;oc.add(bb.value);return oc});this.container.ja("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial",()=>new Gz(Ib.value,Aa.value,null)).ha()}DEo(){const d=new fa.a(()=>new hv(this.zI)),n=new fa.a(()=>new ae(ew.yki,"false","false")),
B=new fa.a(()=>new tc(2,this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,{$yc:!0,U1:!1,e$c:!0,d$c:!0,T1:!0})),Q=new fa.a(()=>new GC),ha=new fa.a(()=>{const bb=new ma.a;bb.add(d.value);bb.add(n.value);bb.add(B.value);bb.add(Q.value);return bb}),Aa=new fa.a(()=>new ee.a(2,ha.value,null,3016,yf.a.N2d));this.container.ja("WordEditor.Designer.UserIntentDialog.UserIntentDialog",()=>new ew(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"))).ha();
this.container.ja("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager",()=>new $n([Aa.value],this.container.resolve("WordEditor.Designer.UserIntentDialog.UserIntentDialog"))).ha()}Nug(){const d=new fa.a(()=>new Ar(1,aa.a.Gd(),this.oe.djc())),n=new fa.a(()=>new YG(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN,yf.a.b4j)),B=[pb.DocumentTypeLabel.ManualsAndGuidelines,pb.DocumentTypeLabel.ContractsAndPolicies,pb.DocumentTypeLabel.ArticlesAndReports,
pb.DocumentTypeLabel.JobDescription],Q=new fa.a(()=>new Cw(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),yf.a.van,B)),ha=new fa.a(()=>new NJ(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),yf.a.Sbg)),Aa=new fa.a(()=>new XG(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),yf.a.xIf,yf.a.Ggd)),bb=new fa.a(()=>new MJ(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").URb,
yf.a.Rbg)),Ib=new fa.a(()=>new mp(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),oc=new fa.a(()=>new tc(2,this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,{$yc:!0,U1:!1,e$c:!0,d$c:!0,T1:!0})),Ac=new fa.a(()=>new Ld(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),ad=new fa.a(()=>new Dw(10,G.AFrameworkApplication.va,
this.container.resolve("WordEditor.Designer.IDesignerControl"))),sd=new fa.a(()=>new Cw(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),yf.a.HBf,[pb.DocumentTypeLabel.Letters])),wd=new fa.a(()=>new mp(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),yd=new fa.a(()=>new hv(this.zI)),
be=new fa.a(()=>new GC),ye=new fa.a(()=>new iv(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),Qe=new fa.a(()=>new ME(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),2,!1)),af=new fa.a(()=>new LE(this.oe.Wvb()?yf.a.qDn:-1)),Qf=new fa.a(()=>new mp(13,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x6,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),hf=new fa.a(()=>new tc(13,
this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,{$yc:!0,U1:!1,e$c:!0,d$c:!0,T1:!0})),di=new fa.a(()=>{const Lg=new ma.a;Lg.add(ha.value);Lg.add(d.value);Lg.add(Aa.value);this.oe.spn()&&Lg.add(Q.value);Lg.add(n.value);Lg.add(bb.value);Lg.add(Ib.value);return Lg}),vj=new fa.a(()=>{const Lg=new ma.a;Lg.add(sd.value);1===this.oe.J3d()?Lg.add(Ac.value):Lg.add(ad.value);Lg.add(wd.value);return Lg}),Wk=new fa.a(()=>{const Lg=new ma.a;Lg.add(yd.value);Lg.add(be.value);this.oe.L4f()&&(Lg.add(ye.value),
Lg.add(Qe.value));Lg.add(af.value);Lg.add(Qf.value);Lg.add(hf.value);return Lg}),Tm=new fa.a(()=>new Rp(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.oe.e6i())),Dk=new fa.a(()=>new Xs(this.container.resolve("WordEditor.Designer.Persistence.PersistenceHelper"))),gi=new fa.a(()=>new Ki(1,di.value,Tm.value)),oi=new fa.a(()=>{let Lg;return new Ki(2,(Lg=new ma.a,Lg.add(oc.value),Lg),Tm.value)}),Ni=new fa.a(()=>
new Ki(10,vj.value,Tm.value,Dk.value)),wh=new fa.a(()=>new Ki(13,Wk.value,Tm.value,null,new By("Jump-start proactive Designer Pane opening",yf.a.N2d,tc.Gnf))),lg=new fa.a(()=>{const Lg=new ma.a;(this.oe.J3d()||this.oe.ihe())&&Lg.add(Ni.value);this.oe.F1f()&&Lg.add(gi.value);this.oe.M_i()&&Lg.add(oi.value);this.oe.Wvb()&&Lg.add(wh.value);return Lg});this.container.ja("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager",()=>{let Lg=new WG(G.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"));
this.oe.Wvb()&&this.oe.V5f()&&(Lg=new Zv(this.container.Za("Common.ISystemInitiatedFeedback"),yf.a.mDn,new FC(yf.a.nDn,Lg,13)));return new Gz(lg.value,Tm.value,Lg)}).ha();this.container.ja("WordEditor.Designer.Proactive.IUserEngagementMonitor",()=>new ZG(G.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha()}jCo(){const d=new qm,n=new fa.a(()=>new zm(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),
d)),B=new fa.a(()=>new mo(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),d,this.container.Za("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),Q=new fa.a(()=>{const bb=new ma.a;bb.add(this.container.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"));bb.add(n.value);bb.add(B.value);return bb}),ha=new fa.a(()=>new ee.a(14,Q.value,null,3016,yf.a.w6m)),Aa=new fa.a(()=>{const bb=new ma.a;
bb.push(ha.value);return bb});this.container.ja("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager",()=>new wo(Aa.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d)).ha()}yCo(){const d=new qm,n=new fa.a(()=>new Ld(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),B=new fa.a(()=>new Op(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("WordEditor.Designer.Review.IReviewTraverser"),d,this.tb.Xc)),Q=new fa.a(()=>new Ar(8,aa.a.Gd(),this.oe.djc())),ha=new fa.a(()=>new Zo(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.tb.Xc)),Aa=new fa.a(()=>new xp(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cze,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
d)),bb=[pb.DocumentTypeLabel.ManualsAndGuidelines,pb.DocumentTypeLabel.ArticlesAndReports,pb.DocumentTypeLabel.DocumentsDesignedForPrinting,pb.DocumentTypeLabel.Forms,pb.DocumentTypeLabel.ListsAndNotes,pb.DocumentTypeLabel.Plans],Ib=new fa.a(()=>new Cw(8,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),yf.a.HBf,bb)),oc=new fa.a(()=>new mo(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
d,this.container.Za("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),Ac=new fa.a(()=>new iv(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),ad=new fa.a(()=>{const be=new ma.a;be.add(n.value);be.add(B.value);be.add(Ac.value);be.add(Q.value);be.add(ha.value);be.add(Aa.value);be.add(oc.value);this.oe.hAn()&&be.add(Ib.value);return be}),sd=new fa.a(()=>new ik(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Image.DesignerImageManagerImpl"),this.tb.Xc)),wd=new fa.a(()=>new aB(8,ad.value,sd.value,yf.a.nhk)),yd=new fa.a(()=>{const be=new ma.a;be.add(wd.value);return be});this.container.ja("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler",()=>new Bi(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();
this.container.ja("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager",()=>new wo(yd.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d)).ha()}DDo(){const d=new fa.a(()=>new jh(this.container.resolve("WordEditor.Designer.License.ILicenseManager"))),n=new fa.a(()=>new Ar(9,aa.a.Gd(),this.oe.djc())),B=new fa.a(()=>new Ld(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),
Q=new fa.a(()=>new tc(9,this.container.resolve("Box4.IParagraphReader"),this.tb.Xc,{$yc:!1,U1:!1,e$c:!0,d$c:!0,T1:!0})),ha=[pb.DocumentTypeLabel.ManualsAndGuidelines,pb.DocumentTypeLabel.ArticlesAndReports,pb.DocumentTypeLabel.DocumentsDesignedForPrinting,pb.DocumentTypeLabel.Forms,pb.DocumentTypeLabel.JobDescription,pb.DocumentTypeLabel.ListsAndNotes,pb.DocumentTypeLabel.Plans],Aa=new fa.a(()=>new Cw(9,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),
yf.a.HBf,ha)),bb=new fa.a(()=>new fk(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").yjc,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").I_b,this.container.resolve("WordEditor.Designer.DocumentInfo"),this.tb.Xc,this.container.resolve("Box4.ISelectionManager"),this.container.resolve("Box4.IParagraphIteratorFactory"))),Ib=new fa.a(()=>new iv(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),oc=new fa.a(()=>
{const wd=new ma.a;wd.add(d.value);wd.add(B.value);wd.add(n.value);wd.add(Ib.value);wd.add(Q.value);wd.add(Aa.value);wd.add(bb.value);return wd}),Ac=new fa.a(()=>new dj(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"))),ad=new fa.a(()=>new Ki(9,oc.value,Ac.value)),sd=new fa.a(()=>{const wd=[];wd.push(ad.value);return wd});this.container.ja("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager",()=>new wk(sd.value,this.container.resolve("WordEditor.Designer.Style.PullQuotesManager"),
this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").I_b,this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Za("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha()}l9j(){const d=yg.StaticActiveAppFrame.Aa().tb.Xc;(null===d||void 0===
d?0:d.Ir)||F.ULS.sendTraceTag(529268809,3016,10,"AutoScroller not defined");return null===d||void 0===d?void 0:d.Ir}Sp(){this.oe.JN()?this.zI.Zk(16,()=>{this.dvb()}):this.dvb()}dvb(){Lh(yf.a.ryj);this.oe.isEnabled()!==Be.a.isc()&&F.ULS.shipAssertTag(541169756,3016,!1,`${this.oe.isEnabled()}, ${Be.a.isc()}`);this.oe.isEnabled()&&(this.tb.uva?this.had():this.tb.gga(this.j_))}lJm(){const d="WordEditor.Designer.License.ILicenseManager WordEditor.Designer.Style.IDocumentLanguageManager WordEditor.Designer.Errors.IErrorStateManager WordEditor.Designer.Pane.IPaneLoadingManager WordEditor.Designer.Settings.IDesignerSettingsManager WordEditor.Designer.AL.IWorkflowManager WordEditor.Designer.OnCanvas.OnCanvasInitializer WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager".split(" ");
this.container.ja("WordEditor.Designer.OnCanvas.OnCanvasInitializer",()=>new WA(this.container.resolve("Box4.Indicator.IIndicatorManager"),this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.Designer.OnCanvas.HighlightActor"),this.container.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),this.container.resolve("WordEditor.Designer.OnCanvas.ReviewSelectionManager"),this.container.Za("Box4.Accessibility.IAccessibilityContextManager"),this.container.resolve("Box4.IParagraphReader"),
this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();this.oe.Von()&&d.push("WordEditor.Designer.FRE.IFirstRunExperienceManager");this.oe.$ge()&&!this.oe.zBb()&&d.push("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager");this.oe.UFg()&&(d.push("WordEditor.Designer.Proactive.ProactiveTriggerInitializer"),this.container.ja("WordEditor.Designer.Proactive.ProactiveTriggerInitializer",()=>new HC(this.container.resolve("WordEditor.Designer.Proactive.IUserEngagementMonitor"),
this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());this.oe.loa()&&!this.oe.Wvb()&&d.push("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial");this.oe.f6i()&&d.push("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2");this.oe.k1i()&&d.push("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager");this.oe.J0f()&&
d.push("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager");this.oe.m6i()&&d.push("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager");this.oe.zBb()&&d.push("WordEditor.Designer.SmartPaste.SmartPasteManager");this.oe.r5f()&&d.push("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager");this.oe.ihe()&&d.push("WordEditor.Designer.DocumentStatsDnmLogger");return d}mJm(){const d=["WordEditor.Designer.Wire.IDesignerPropsUpdater","WordEditor.Designer.Trackers.IDesignerUndoTracker",
"WordEditor.Designer.Logging.IDocumentRoleDetectionLogger","WordEditor.Designer.Logging.IConsistencyFixActionsLogger","WordEditor.Designer.Logging.IBlankDocumentLogger"];this.oe.xge()&&d.push("WordEditor.Designer.Style.ITableManager");return d}kJm(){const d=["WordEditor.Designer.Style.IThemeGenerator"];this.oe.UFg()&&(d.push("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer"),this.container.ja("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer",()=>new vx(this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());
return d}had(){const d=this.container.resolve("WordEditor.Designer.Perf.IPerfLogger");d.Ae(()=>{const n=new Map;n.set(0,this.lJm());n.set(2,this.mJm());n.set(1,this.kJm());n.set(3,[]);const B=[this.container.resolve("WordEditor.Designer.Actors.DesignerActor"),this.container.resolve("WordEditor.Designer.Actors.DesignerActionActor")];this.oe.zBb()&&B.push(this.container.resolve("WordEditor.Designer.Actors.DesignerPasteActor"));this.iYl.jLl(this.container,n,B,d,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal")).Znf()},
"WD:II")}}Object(D.a)(Ov,"DesignerPackageManager",null,[0,1]);var fB=e(990),WJ=e(1845),Iy=e(971),Rh=e(1397);class Bp{}Bp.Rni="https://nleditor.osi.officeppe.net";Bp.Oni="https://nleditor.osi.office.net";Bp.vWh=[Rh.a.IWh,Rh.a.Smf,Rh.a.H4h,Rh.a.g5h,Rh.a.Esf,Rh.a.D$h,Rh.a.qFl,Rh.a.obi,Rh.a.wmi,Rh.a.KFf,Rh.a.Jyi,Rh.a.T6m,Rh.a.Y6m,Rh.a.oUi,Rh.a.TUi,Rh.a.UUi,Rh.a.cXf,Rh.a.NZi,Rh.a.SHn,Rh.a.Jmj,Rh.a.fse,Rh.a.rjd,Rh.a.zvj,Rh.a.Oco,Rh.a.Hmg,Rh.a.s_b,Rh.a.omo,Rh.a.oHj,Rh.a.Uyg,Rh.a.g7o,Rh.a.R3j,Rh.a.Bpp,Rh.a.uCc,
Rh.a.T7j,Rh.a.D8j,Rh.a.v$j,Rh.a.oyd];Object(D.a)(Bp,"MessengerConstants",null,[]);var Zi=e(894),ut=e(403),gB=e(175),UE=e(248),UC=e(52);e(879);var Tp=e(381);class hB{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af){this.faf=()=>{setTimeout(()=>{this.Mvh&&Object(Zi.o)("SelectionPointerUp")},100);return!0};this.rBg=Qf=>{Qf&&Qf.Yb.keyCode===Jq.a.v5b?this.P5a.flag&&(Object(Zi.o)("FocusOnInputNotif"),this.P5a.flag=!1):Qf&&Qf.Yb.keyCode===Jq.a.H6&&Object(Zi.o)("FocusOutOfEditor");return!0};
this.gff=(Qf,hf)=>{Qf=Qf.getByTag(hf);const di=[];for(let vj=0;vj<Qf.length();vj++){const Wk=Qf._GetItem(vj);di.push(Wk.id)}this.zTa.set(hf,di)};this.t3=n;this.VG=B;this.NAa=ad;this.pb=ye;this.$j=Qe;this.nd=Q;this.yd=ha;this.ll=Aa;this.Pe=bb;this.hY=Ib;this.Wfa=oc;this.Ip=Ac;this.Bka=sd;this.N3=[];this.URc=[];this.TZe=this.e9b=this.Ulh=this.iMc=this.Jqh=this.qTa=this.Mvh=!1;this.P5a={flag:!1};this.ycc=[];this.VLh=[];this.zTa=new Map;this.i9b=new Map;this.h9b=new Map;this.uh=wd;this.rUa=yd;this.qb=
be;this.ga=af;this.B8c=this.B8c.bind(this);this.dAe=this.dAe.bind(this);this.gPg=this.gPg.bind(this);this.Bqm();this.RPm();this.EWo();this._frame=G.AFrameworkApplication.ta;this.$j.mode=0;this.Bka.TMb(this.dAe);this.pb.BD(this.B8c);this._frame&&(this._frame.LG.Cb(ia.a.zi,this._frame.get_element(),Zi.s),this._frame.LG.Cb(ia.a.QNb,this._frame.get_element(),this.faf));Object(Zi.k)()&&this.ga.qa(dd.a.fYi,S.a.frame,this.gin.bind(this));G.AFrameworkApplication.$if(this.YRi)}Bqm(){Object(Zi.o)("GetCAAEPlaceholders",
JSON.stringify({["sessionId"]:G.AFrameworkApplication.userSessionId}))}gin(d,n,B){2===B&&Object(Zi.o)("InsertSnippetPanel");return 32}RPm(){Object(Zi.o)("GetSPOReflowFlag")}hDp(d,n,B){(d=d.getByTag(B).getFirst())&&0<=n?(this.qTa=!0,d=d.MKg,0<=n&&UC.a.DAe(d,n,n)):this.qTa=!1}EWo(){Object(Zi.o)("DocumentGenLoaded")}YRi(d,n){Object(Zi.o)("SendWordErrorDetails",JSON.stringify(n))}dAe(){let d=new Iy.a("CAAEMessage");d.SendTime=Date.now();d=Object(Zi.n)(d,JSON.stringify({editHappened:!0}),"EditHappenedInDocument");
window.parent.postMessage(JSON.stringify(d),this.NAa)}RWo(){const d=this.t3.create().body.getHtml();Object(Zi.o)("HtmlForDocument",d)}KXo(){const d=this.t3.create().body.text;Object(Zi.o)("DocTextForSuggestions",d)}kXo(){const d=this.t3.create(),n=[];if(d.body.paragraphs)for(let B=0;B<d.body.paragraphs.length();B++)d.body.paragraphs._GetItem(B).text&&n.push(d.body.paragraphs._GetItem(B).text);Object(Zi.o)("DocTextForRePrompt",JSON.stringify(n))}mXo(){const d=this.t3.create(),n=this.zra(d),B=[];[...this.i9b.values()].forEach(Q=>
{const ha=n.getByTag(Q.tagId),Aa=[];for(let bb=0;bb<ha.length();bb++)Aa.push(ha._GetItem(bb).id);Aa&&Aa.length&&B.push({...Q,S1p:Aa})});Object(Zi.o)("SendPlaceholderSuggestions",JSON.stringify(B))}B8c(){if(!this.iMc){var d=this.t3.create(),n=new Iy.a("CAAEMessage");n.SendTime=Date.now();var B=d.KQm();if("NoSelection"!==B)if("TextBoxSelection"===B)n.Values.payload="TextBoxSelection",n.Values.Action="UnSuccessfulSelectionV2",window.parent.postMessage(JSON.stringify(n),this.NAa);else{B=d.getSelection();
var Q=B.contentControls,ha=this.pb.ob.currentSelection,Aa=ha.length,bb=B.parentTableOrNullObject,Ib=this.pb.hh,oc=ha.pf,Ac;if(!(Ac=w(ha,B,Q.length(),this.P5a,n,this.NAa,void 0,this.e9b))&&(Ac=null!==Ib))a:{var ad=Q.length();Ac=n;var sd=this.NAa,wd=this.pb.ob,yd=this.qTa,be=this.yd,ye=this.P5a,Qe=this.e9b,af,Qf,hf=Object(gB.a)().tT(Ib,14);if(null!==hf&&1===hf.length){Ib=Object(gB.a)().tT(Ib,16);var di=!0;if(bb){var vj=null===(af=null===bb||void 0===bb?void 0:bb.getCell(0,0))||void 0===af?void 0:af.body.contentControls;
for(af=0;af<(null===vj||void 0===vj?void 0:vj.length());af++)if(vj._GetItem(af).tag.endsWith("TableSelection")){di=!1;break}}if(1===Ib.length&&di&&(Qe||0===ad))if(oc=null===(Qf=Ib.getContext(0))||void 0===Qf?void 0:Qf.node,0!==B.text.length&&!yd&&oc&&be.SSf(oc).trim()===B.text.trim()&&Object(Zi.b)(wd.currentSelection)){if(Ac.Values.payload=B.text,Ac.Values.type="TableCellSelection",Ac.Values.Action="SuccessfulSelectionV2",ye.flag=!0,Qe){window.parent.postMessage(JSON.stringify(Ac),sd);Ac=!1;break a}}else{Ac=
!1;break a}else if(Qf=new vc.a,null!==oc&&null!==oc.Ya&&null!==oc.hd){Qf.set(oc.Ya.node);Qf.Ib(14);var Wk=Qf.xd(14);Qf=UE.TableBorderSelectionCache.q$;b:{bb=Wk;UE.TableBorderSelectionCache.B$c(bb);hf=UE.TableBorderSelectionCache.q$;af=hf.leftMostColumnSelected;wd=hf.rightMostColumnSelected;be=hf.topMostRowSelected;hf=hf.bottomMostRowSelected;for(di=0;di<Ib.length;di++){if(Ib.getContext(di).contextId!==ed.a.Vy){bb=!1;break b}vj=Ib.getContext(di).node;if(!vm.TableCellReader.Js(vj)){const Tm=new vc.a;
Tm.set(vj);if(Tm.Ib(14)&&ef.c(Tm)===bb){Tm.xd(14);vj=vm.TableCellReader.Bua(Tm,vj);if(!vj){bb=!1;break b}af=Math.min(af,vj.lo);wd=Math.max(wd,vj.lo);be=Math.min(be,vj.rowIndex);hf=Math.max(hf,vj.rowIndex)}}}bb={leftMostColumnSelected:af,rightMostColumnSelected:wd,topMostRowSelected:be,bottomMostRowSelected:hf}}Qf="boolean"!=typeof bb?bb.bottomMostRowSelected-bb.topMostRowSelected:Qf.bottomMostRowSelected-Qf.topMostRowSelected;"boolean"==typeof bb||0!==ad||null===Wk||0!==bb.leftMostColumnSelected||
bb.rightMostColumnSelected!==oj.TableReader.Nh(Wk)-1||Qf!==oj.TableReader.Hg(Wk)-1||oc.Ya.contextId!==ed.a.rw&&oc.Ya.contextId!==ed.a.Vy||oc.hd.contextId!==ed.a.rw&&oc.hd.contextId!==ed.a.Vy?yd||(Ac.Values.payload="MultipleContext",Ac.Values.Action="UnSuccessfulSelectionV2"):(Ac.Values.payload="TableSelection",Ac.Values.type="TableSelection",Ac.Values.Action="SuccessfulSelectionV2",ye.flag=!0,Qe&&(Ac.Values.payload=JSON.stringify({text:"TableSelection",typeOfField:{regular:!0,conditional:!1}})))}else{if(null!==
hf&&1<hf.length){Ac.Values.payload="MultipleContext";Ac.Values.Action="UnSuccessfulSelectionV2";window.parent.postMessage(JSON.stringify(Ac),sd);Ac=!0;break a}if(bb&&null!==hf&&1===hf.length&&B.text){oc=null===(Wk=null===bb||void 0===bb?void 0:bb.getCell(0,0))||void 0===Wk?void 0:Wk.body.contentControls;for(yd=0;yd<(null===oc||void 0===oc?void 0:oc.length());yd++)if(oc._GetItem(yd).tag.endsWith("TableSelection")){Ac.Values.payload="TableCellSelection";Ac.Values.Action="UnSuccessfulSelectionV2";window.parent.postMessage(JSON.stringify(Ac),
sd);Ac=!0;break a}Ac=!1;break a}}window.parent.postMessage(JSON.stringify(Ac),sd);Ac=!0}else Ac=void 0}if(!Ac)if(Ac=Object(Zi.c)(ha),1<Aa&&!this.e9b)n=Object(Zi.m)(n,"MultipleContext"),window.parent.postMessage(JSON.stringify(n),this.NAa);else if(Aa)if(sd=this.qTa?!0:""!==B.text&&B.$Yf(!0),this.e9b)n=Object(Zi.a)(n,ha,Ac,sd,B.text,Q,this.P5a),(d=this.Roh(B,d,ha))&&"UnSuccessfulSelectionV2"!==n.Values.Action&&(n.Values.payload=d.Values.payload,n.Values.Action=d.Values.Action),window.parent.postMessage(JSON.stringify(n),
this.NAa);else if(1==Aa){n=Object(Zi.e)(n,Ac,sd,B.text,Q.length(),this.P5a);if(d=this.Roh(B,d,ha))n.Values.payload=d.Values.payload,n.Values.Action=d.Values.Action;window.parent.postMessage(JSON.stringify(n),this.NAa)}}}}Roh(d,n,B){const Q=new Iy.a("CAAEMessage");if(0===d.text.length&&B.K(0).contextId===ed.a.kd||1===d.text.length&&("\r"===d.text||"\n"===d.text))return Q.Values.Action="EmptySelection",this.P5a.flag=!1,Q.Values.payload=this.rnh(this.zra(n)),this.qnh(this.zra(n)),Q}aEk(d){const n=new Iy.a("CAAEMessage");
n.Values.Action="EmptySelection";this.P5a.flag=!1;n.Values.payload=this.rnh(this.zra(d));this.qnh(this.zra(d));return n}rnh(d){const n=new Set;this.N3.forEach(B=>{let Q=d.getByTag(B);for(let ha=0;ha<Q.length();ha++){const Aa=Q._GetItem(ha);void 0!==Aa.o2j&&""!==Aa.getRange(0).text||Aa.deleteContentControl(!0)}Q=d.getByTag(B);0===Q.length()&&n.add(B)});0!==n.size&&(this.N3=this.N3.filter(B=>!n.has(B)));return Array.from(n)}qnh(d){const n=new Map;let B=!1;for(const [Q,ha]of this.zTa){const Aa=ha.filter(bb=>
null!==d.getByIdOrNullObject(bb));ha.length!==Aa.length&&(B=!0);n.set(Q,Aa)}B&&(this.zTa=n,Object(Zi.v)(n))}mxd(d){return d&&d.title&&d.tag?!0:(F.ULS.sendTraceTag(541403280,2250,10,"Malformed CaaeMessagePlaceholder"),!1)}Tzj(d){const n=new Iy.a("CAAEMessage");n.Values.payload=d;n.SendTime=Date.now();window.parent.postMessage(JSON.stringify(n),this.NAa)}Gdi(d,n,B,Q,ha){if(this.mxd(n)){var Aa=d.parentTableOrNullObject;{var bb=this.pb;var Ib=bb.hh;bb=bb.ob.currentSelection.pf;Ib=Object(gB.a)().tT(Ib,
14);const oc=new vc.a;null!==bb&&null!==Ib&&1===Ib.length&&null!==bb&&null!==bb.Ya&&null!==bb.hd?(oc.set(bb.Ya.node),oc.Ib(14),bb=oc.xd(14)):bb=void 0}Ib=bb;bb=!1;"Image"===B&&(bb=w(this.pb.ob.currentSelection,d,d.contentControls.length(),this.P5a,void 0,void 0,!0,this.e9b));if(!bb&&Aa&&"Table"===B&&Ib)return B=Aa.getCell(0,0).body.getRange(2).insertContentControl(),B.text=" ",B.RT="Committed",B.title=n.title,B.appearance=2,B.tag=n.tag,this.N3.push(n.tag),!0;Aa=d.parentTableOrNullObject;if(!bb&&Aa&&
"TableCell"===B){B=d.text.trim();Aa=pc.a.lBc(B);d.insertText(" ",4);B=d.getRange(2).insertContentControl();for(bb=0;bb<Aa.length;bb++)0==bb?B.insertText(Aa[bb],4):B.insertText(" "+Aa[bb],3);B.RT=Q?"Committed":"Highlighted";1===Aa.length&&""===Aa[0]?B.insertText(" ",2):B.insertText("",2);d.insertText("",4)}else B=d.insertContentControl(),Q?Object(Zi.w)(B,"Committed"):Object(Zi.w)(B,"Highlighted"),Object(Zi.y)(B,2,"");B.title=n.title;B.appearance=2;B.tag=n.tag;this.N3.push(n.tag);ha&&Q&&(ha.id=B.id);
return!0}}gPg(d){const n=this.t3.create(),B=this.zra(n);d.map(Q=>{Q=B.getByTag(Q);for(let ha=0;ha<Q.length();ha++){const Aa=Q._GetItem(ha);Aa.appearance=2;Aa.insertText("",2);x(this.Pe,Aa,!0,this.TZe);Object(Zi.w)(Aa,"Highlighted")}})}F4l(d,n,B){if(this.mxd(n)&&(d=d.getByTag(n.tag),1<=d.length()))for(let Q=0;Q<d.length();Q++){const ha=d._GetItem(Q);ha.title=n.title;B&&(this.URc=[],Object(Zi.w)(ha,"Highlighted"),ha.insertText("",2))}}q7m(d,n){if(this.Jqh&&("hyperlink"===d.datatype||"email"===d.datatype)){let B=
n.getRange(0).kq.K(0);n.Pg&&(B=ge.a.createTextRange(B.node,0,bf.ParagraphReader.textLength(B.node)));this.VG.SJ(B,"email"===d.datatype?"mailto:"+d.title:d.title,!1)}}$cm(d,n){n.map(B=>{var Q;const ha=d.getByTag(B.tag);if(1<=ha.length())for(let Aa=0;Aa<ha.length();Aa++){const bb=ha._GetItem(Aa);B.title&&(x(this.Pe,bb,"true"===(null===(Q=B.title)||void 0===Q?void 0:Q.toLowerCase())?!1:!0,this.TZe),Object(Zi.w)(bb,"Filled"))}})}Rcm(d,n){n.map(B=>{const Q=d.getByTag(B.tag);if(1<=Q.length()){var ha=!1;
for(let af=0;af<Q.length();af++){const Qf=Q._GetItem(af);if(B.title)if(Qf.tag.endsWith("TableSelection")){if(!ha){var Aa=void 0,bb=void 0,Ib=Qf;ha=this.nd;var oc=this.ll,Ac=this.hY,ad=this.Wfa,sd=this.Ip,wd=this.VG,yd=B.tableValues,be=B.tableValuesDataTypes;bb=Object.keys(yd).length;var ye=Ib.MKg;Aa=oj.TableReader.Hg(ye);if(ye){const hf=oj.TableReader.kA(ye,0,Aa-1);Ib=hf.K(0);Ib=Fy.a.wbd(Ib);const di=oj.TableReader.Hg(ye);if(2<Aa){var Qe=hf.K(2);Qe=new ge.a(Qe,ed.a.rw);G.AFrameworkApplication.va.Sf(Qe,
Se.a.deleteRow,2,!1,new ut.a,di-2)}Ib||1!==bb?(Aa=1===Aa?hf.K(0):hf.K(1),Aa=new ge.a(Aa,ed.a.rw),bb=G.AFrameworkApplication.va.Sf(Aa,Se.a.gcb,2,!1,new ut.a,Ib?bb:bb-1)):bb=32;if(32===bb){bb=oj.TableReader.kA(ye,0,oj.TableReader.Hg(ye)-1);Ib||(ye=bb.K(0),ye=Fy.a.UD(ye),l(ha,oc,Ac,ad,sd,wd,ye,yd[0],be[0]));ye=1===di?1:2;for(ye;ye<bb.count;ye++)Aa=bb.K(ye),Aa=Fy.a.UD(Aa),1===di?l(ha,oc,Ac,ad,sd,wd,Aa,Ib?yd[ye-1]:yd[ye],Ib?be[ye-1]:be[ye]):l(ha,oc,Ac,ad,sd,wd,Aa,Ib?yd[ye-2]:yd[ye-1],Ib?be[ye-2]:be[ye-
1]);1<bb.count&&1<di&&(ha=bb.K(1),ha=new ge.a(ha,ed.a.rw),G.AFrameworkApplication.va.Sf(ha,Se.a.deleteRow,2,!1,new ut.a,1))}}ha=!0;Object(Zi.w)(Qf,"Filled");Qf.insertText("",2);Object(Zi.o)("FilledValueContentControl","Updated value")}}else"string"===typeof B.title&&B.tag===Qf.tag?(Qf.tag.endsWith("ImageSelection")&&B.imageProperties&&B.imageProperties.imageUrl?(B.imageProperties={...B.imageProperties,altText:B.title},z(Qf,B.imageProperties)):"RichMultiText"===B.datatype?(Object(Zi.w)(Qf,"Filled"),
Qf.insertHtml(B.title,4)):B.title!==Qf.text&&(Object(Zi.w)(Qf,"Filled"),Qf.text=B.title,this.q7m(B,Qf)),Object(Zi.o)("FilledValueContentControl","Updated value")):(Object(Zi.w)(Qf,"Filled"),Object(Zi.o)("FilledValueContentControl"));else Object(Zi.w)(Qf,"Highlighted"),Qf.insertText("",2)}}})}deleteContentControl(d,n){if(this.mxd(n)&&(d=d.getByTag(n.tag),1<=d.length())){for(let B=0;B<d.length();B++)d._GetItem(B).deleteContentControl(!0);this.N3=this.N3.filter(B=>B!==n.tag)}}iXl(){if(0<this.ycc.length){const d=
this.t3.create();for(let n=0;n<this.ycc.length;n++){const B=d.contentControls.getByTag(this.ycc[n]);B&&B.length()&&B._GetItem(0).deleteContentControl(!0)}}}qUo(d,n){this.mxd(n)&&(d=d.getByTag(n.tag),1<=d.length()&&(d=d._GetItem(0).o2j,d=Di.SelectionFactory.Ie(d,0),te.a.instance.Uc(d),Object(Zi.o)("FilledValueContentControl","Updated value")))}Rde(d,n,B,Q){if(this.mxd(n))if(d=d.getByTag(n.tag),Q){if(Q=d.getByIdOrNullObject(Q.id))"Hover"===B?m(Q):"Highlight"===B&&f(Q),Q.insertText("",2)}else if(1<=
d.length())for(Q=0;Q<d.length();Q++)n=d._GetItem(Q),"Hover"===B?m(n):"Highlight"===B&&f(n),n.insertText("",2)}Qvp(d){let n=d.textOffset;var B=qj.a.Pp();B=this.qb.Vn(B);B=this.rUa.KWa(B,!1,!1);let Q;do{const ha=B.uC;if(ha){const Aa=bf.ParagraphReader.textLength(ha);n>Aa?0<Aa&&(n=n-Aa-2):bf.ParagraphReader.text(ha).substring(n,n+d.name.length).toLowerCase()===d.name.toLowerCase()&&(Q=ge.a.createTextRange(ha,n,n+d.name.length),this.N2m(Q,d))}}while(B.Jna()&&!Q)}l7m(){this.i9b.forEach(d=>{d.tagId&&(this.h9b.get(d.tagId).forEach(n=>
{const B=new ma.a;B.add(n);this.uh.lkf(B);this.uh.k8a(n,this.hY,void 0,!0)||(n=this.uh.k8a(n,this.hY),Object(Zi.w)(n,"Highlighted"),Object(Zi.y)(n,2,""),n.title=d.name,n.appearance=2,n.tag=d.tagId)}),this.N3.push(d.tagId))})}N2m(d,n){if(this.i9b.has(n.name)){if({tagId:n}=this.i9b.get(n.name),n&&this.h9b.has(n)){var B=this.h9b.get(n);B.push(d);this.h9b.delete(n);this.h9b.set(n,B)}}else B=Math.floor(1E6*Math.random()+1).toString(),this.i9b.set(n.name,{...n,tagId:B}),this.h9b.set(B,[d])}mF(d){const n=
this.t3.create();var B=this.zra(n),Q={id:void 0};switch(d.Values.Action){case "RemoveContentControlAck":B=this.aEk(n);window.parent.postMessage(JSON.stringify(B),this.NAa);break;case "CreateContentControlForTableCell":var ha=n.getSelection();B=d.Values.Placeholder;var Aa="PlaceholderV2"===d.Values.type;d=d.Values.source;this.qTa=!0;this.iMc=Aa;this.Gdi(ha,B,"TableCell",Aa,Q);this.pb.Uc(Lj.a.Xk(this.pb.ob.currentSelection,!1,!0,void 0,!1));this.qTa=this.iMc=!1;Aa&&(ha=this.t3.create(),ha=this.zra(ha),
void 0===d||"Panel"===d?Object(Zi.h)(ha,B,Q.id):"PlaceholderCard"===d&&Object(Zi.q)(ha,B),this.gff(ha,B.tag));break;case "UpdateTableColumnHighlight":Q=d.Values.MessageContent;d=d.Values.Placeholder;d.tag.endsWith("TableSelection")&&this.hDp(B,Q,d.tag);break;case "GetTableColumnDetails":d=d.Values.Placeholder;d.tag.endsWith("TableSelection")&&a(B,d.tag);break;case "FetchSelection":B=d.Values.Placeholder;d=this.t3.create();d=this.zra(d);Object(Zi.h)(d,B,void 0);break;case "CreateContentControl":Aa=
n.getSelection();B=d.Values.Placeholder;ha=d.Values.source;this.iMc=d="PlaceholderV2"===d.Values.type;var bb=Object(Zi.g)(B.tag);Aa=this.Gdi(Aa,B,bb,d,Q);this.qTa=!0;Aa&&this.pb.Uc(Lj.a.Xk(this.pb.ob.currentSelection,!0,!1,void 0,!0));this.qTa=this.iMc=!1;d&&(d=this.t3.create(),d=this.zra(d),void 0===ha||"Panel"===ha?Object(Zi.h)(d,B,Q.id):"PlaceholderCard"===ha&&Object(Zi.q)(d,B),this.gff(d,B.tag));break;case "CancelWACContentControlCreation":this.qTa=!0;this.pb.Uc(Lj.a.Xk(this.pb.ob.currentSelection,
!0,!1,void 0,!0));this.qTa=!1;break;case "EditContentControl":this.F4l(B,d.Values.Placeholder,d.Values.type);break;case "FillConditionalAnswers":this.$cm(B,d.Values.Placeholder);break;case "FillValueForContentControl":this.Rcm(B,d.Values.Placeholder);break;case "DeleteContentControl":d=d.Values.Placeholder;this.deleteContentControl(B,d);this.zTa.delete(d.tag);break;case "RemoveSelections":Q="AllCommited"===d.Values.type;ha="All"===d.Values.type;const Ib=d.Values.Placeholder;if("Single"===d.Values.type&&
d.Values.MessageContent){const oc=Object(Zi.f)(JSON.parse(d.Values.MessageContent));this.N3=Object(Zi.p)(Ib,B,this.N3,this.URc,void 0,oc);0===B.getByTag(Ib.tag).length()?this.N3=this.N3.filter(Ac=>Ac!==Ib.tag):(B=this.zTa.get(oc.tag))&&this.zTa.set(oc.tag,B.filter(Ac=>Ac!=oc.id))}else Q?(this.N3=(d=d.Values.PreviousPlaceholderTag)?Object(Zi.p)(Ib,B,this.N3,this.URc,"Committed",void 0,d):Object(Zi.p)(Ib,B,this.N3,this.URc,"Committed",void 0),B=this.t3.create(),B=this.zra(B),d&&this.zTa.delete(Ib.tag),
this.gff(B,d?d:Ib.tag),Object(Zi.u)(d?d:Ib.tag,this.zTa.get(d?d:Ib.tag))):ha&&(this.N3=Object(Zi.p)(Ib,B,this.N3,this.URc,void 0,void 0),this.zTa.delete(Ib.tag));break;case "GetHTML":this.Tzj(n.getSelection().getHtml());break;case "GetSelectedText":this.Tzj(n.getSelection().text);break;case "ScrollToContentControl":d=d.Values.Placeholder;this.Ulh&&this.qUo(B,d);break;case "HighlightHoveredContentControl":Q=d.Values.Placeholder;(d=d.Values.MessageContent)?(d=Object(Zi.f)(JSON.parse(d)),this.Rde(B,
Q,"Hover",d)):this.Rde(B,Q,"Hover");break;case "UnhighlightHoveredContentControl":Q=d.Values.Placeholder;(d=d.Values.MessageContent)?(d=Object(Zi.f)(JSON.parse(d)),this.Rde(B,Q,"Highlight",d)):this.Rde(B,Q,"Highlight");break;case "PublishSaveTemplate":fg.a.rT(rb.a.phc,!1,oc=>{oc={["data"]:oc,["sessionId"]:G.AFrameworkApplication.userSessionId,["sortedPlaceholderTags"]:this.zra(n).getContentControls().map(Ac=>Ac.tag)};Object(Zi.o)("ReceiveSuccessPublishSaveTemplate",JSON.stringify(oc))},(oc,Ac)=>{Object(Zi.o)("ReceiveFailurePublishSaveTemplate",
JSON.stringify({["data"]:oc,["statusCode"]:Tp.a[Ac],["sessionId"]:G.AFrameworkApplication.userSessionId}))},null);break;case "SendPlaceholderCCDetails":Q=d.Values.MessageContent;this.Ulh=d.Values.isScrollDocEnabled;this.Jqh=d.Values.highlightHyperlinkAndEmail;this.e9b=d.Values.isConditionalFieldsEnabled;this.TZe=d.Values.isDocGenLoaded;this.N3=Q;G.AFrameworkApplication.ud("DeleteStaleCCsTreatment;DeleteStaleCCsControl");G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CADeleteStaleCCsEnabled",
!1)&&this.fzk(n,Q);Q&&0<Q.length&&this.gPg(Q);Object(Zi.o)("EditFlowContentControlsLoaded",JSON.stringify({["sessionId"]:G.AFrameworkApplication.userSessionId}));d=new Map;this._frame&&(this._frame.LG.Gc(ia.a.zi,this._frame.get_element(),Zi.s),this._frame.LG.Cb(ia.a.zi,this._frame.get_element(),this.rBg));for(ha=0;ha<Q.length;ha++){Aa=B.getByTag(Q[ha]);bb=[];for(let oc=0;oc<Aa.length();oc++)bb.push(Aa._GetItem(oc).id);d.set(Q[ha],bb)}this.zTa=new Map(d);Object(Zi.r)(d);break;case "CloseTemplateStudio":this.pb.vpa(this.B8c);
G.AFrameworkApplication.AIo(this.YRi);this._frame&&(this._frame.LG.Gc(ia.a.zi,this._frame.get_element(),this.rBg),this._frame.LG.Gc(ia.a.QNb,this._frame.get_element(),this.faf));break;case "SendAckForDocGenLoaded":this.pb.vpa(this.B8c);this._frame&&(this._frame.LG.Gc(ia.a.zi,this._frame.get_element(),this.rBg),this._frame.LG.Gc(ia.a.QNb,this._frame.get_element(),this.faf),this._frame.LG.Cb(ia.a.zi,this._frame.get_element(),Zi.t));break;case "SPOInReflowMode":this.Mvh=d.Values.MessageContent;break;
case "DisableEditDocCheck":this.Bka.Pxe(this.dAe);break;case "AddContentToDocument":this.t3.create().body.insertHtml(d.Values.Content,4);this.ycc=d.Values.ContentControlIds;this.VLh=d.Values.BreaksCount;Object(Zi.o)("UpdatedContent");break;case "ReceivedUpdatedContent":B=this.t3.create();for(d=0;d<this.ycc.length;d++)for(Q=0;Q<this.VLh[d];Q++)B.body.paragraphs._GetItem(d+Q).text.length&&(ha=B.body.paragraphs._GetItem(d+Q).insertContentControl(),ha.tag=this.ycc[d],ha.appearance=2);break;case "DeleteSectionFromTemplate":B=
this.t3.create().contentControls.getByTag(d.Values.ContentControlId);for(d=0;d<B.length();d++)B._GetItem(d).deleteContentControl(!1);break;case "EditSectionInTemplate":B=this.t3.create();Q=d.Values.ContentControlId;ha=B.contentControls.getByTag(Q);for(Aa=1;Aa<ha.length();Aa++)ha._GetItem(Aa).deleteContentControl(!1);B.contentControls.getByTag(Q)._GetItem(0).text=d.Values.NewSectionText;break;case "GetHtmlForDocument":this.RWo();break;case "GetDocTextForSuggestions":this.iXl();this.KXo();break;case "GetDocTextForRePrompt":this.kXo();
break;case "GetSuggestionsForFields":B=d.Values.MessageContent;this.i9b=new Map;if(B&&0<B.length)for(d=0;d<B.length;d++)this.Qvp(B[d]);this.l7m();this.mXo();break;case "GetDocContentControls":B={["sessionId"]:G.AFrameworkApplication.userSessionId,["placeholderTags"]:B.getContentControls().map(oc=>oc.tag)},Object(Zi.o)("SendDocContentControls",JSON.stringify(B))}}zra(d){G.AFrameworkApplication.ud("ccHeaderFooterTreatment;ccHeaderFooterControl");return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CAHeaderFooterCCEnabled",
!1)?d.contentControls:d.body.contentControls}fzk(d,n){const B=this.zra(d);B.getContentControls().map(Q=>Q.tag).filter(Q=>Q&&Q.startsWith("msca")&&0>n.indexOf(Q)).forEach(Q=>{var ha;Q=B.getByTag(Q);for(let Aa=0;Aa<Q.length();Aa++)null===(ha=Q._GetItem(Aa))||void 0===ha?void 0:ha.deleteContentControl(!0)})}}Object(D.a)(hB,"CaaeMessageHandler",null,[1051]);class VE{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af){this.Jnb=null;this.Tw=d;this.iGd=n;this.Jvk=new hB(this,B,Q,ha,Aa,bb,Ib,oc,
Ac,ad,n,sd,wd,yd,be,ye,Qe,af);this.Tw.Pla(Bp.Rni);this.Tw.Pla(Bp.Oni);this.iGd!==fB.a.Kob&&(this.Tw.Pla(this.iGd),this.Ht("CAAEMessage",this.Jvk))}Ht(d,n){F.ULS.sendTraceTag(541405831,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",d);if(d&&""!==d)if("CAAEMessage"!==d)F.ULS.sendTraceTag(540357400,2250,10,"Attempted to register MessageTypeId other than CAAEMessage");else if(n){var B=!1;this.Tw.isEnabled()&&(this.Tw.$w(d),B=this.Tw.DG(d,n.mF.bind(n)));B||F.ULS.sendTraceTag(541405834,
2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",d)}else F.ULS.sendTraceTag(541405833,2250,10,"Attempted to register null IIncomingMessageHandler.");else F.ULS.sendTraceTag(541405832,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(d,n){if(this.Jnb){var B=this.Jnb.src;this.Tw.i3f(B)?Array.contains(Bp.vWh,d)?this.Tw.lgb(Object.assign(new Iy.a,{MessageId:d,SendTime:Date.now(),Values:{["Payload"]:n}}),this.Jnb.contentWindow,T.a.getOrigin(B))||F.ULS.sendTraceTag(541405838,
2250,10,"Failed to send a message with MessageTypeId [{0}].",d):F.ULS.sendTraceTag(541405837,2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",d):F.ULS.sendTraceTag(541405836,2250,10,"Attempted to send a message to origin that's not allowed.")}else F.ULS.sendTraceTag(541405835,2250,10,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",d)}}Object(D.a)(VE,"DocumentAssemblyMessenger",null,[1017]);var mH=e(1362),XJ=e(1365),nH=e(2103);
class Kz{constructor(d,n,B,Q,ha,Aa){this.Sai=this.Uai=null;this.Ju=d;this.Rai=n;this.WFl=B;this.XFl=Q;this.Uai=ha;this.Sai=Aa}}Object(D.a)(Kz,"ContentAssemblyHighlightContext",null,[]);class iB extends XJ.a{constructor(d,n,B,Q){super();this.Fxk=40;this.vQc="px";this.pGc="aria-label";this.YFl="Field_20";this.qb=d;this.xh=n;this.$_=B;(this.qD=Q)&&this.qD.PUd(this.fJ.bind(this))}JWa(d){const n=[],B=d.Y8a(0,this.Fxk,this.zoom);n.push(this.Jga(d.z2,B,d.nEc[0].y-d.l9[0].y));return n}Jga(d,n,B){const Q=
d.Gh.ownerDocument,ha=Io.a.createElement(Q,Rl.a.div);ha.className=iB.Exk;ha.style.left=n+this.vQc;ha.style.top=B+this.vQc;n=Io.a.createElement(Q,Rl.a.div);Xa.a("renderIcon")&&appChrome.api.renderIcon(this.YFl,n);n.setAttribute("role","img");n.setAttribute("alt","Conditional section");n.title="Conditional section";n.setAttribute(this.pGc,"Conditional section");ha.appendChild(n);d={context:new Kz([],ha,new Set,new Set,null,null),Tgg:d,container:ha};this.xh.wK(ia.a.click,ha,this.xwa.bind(this),d);return ha}s2a(d){d=
this.qb.Vn(d.Jb);return Object(Zi.d)(d,!1,d.DI)}lZd(){const d=Object.assign(new nH.a,{action:1,type:7,ZD:null,XN:this.ska});this.ska=null;this.$_.pJ(d)}fJ(d,n){this.ska&&!n.M$a.Ff.classList.contains(Zi.j)&&this.lZd()}xwa(d){if(!d)return!1;let n=d.er.context;if(iB.Ycb(n,this.ska))return!0;n=this.yNf(d.er.Tgg,n,d.er.container);d=Object.assign(new nH.a,{action:0,type:7,ZD:n,XN:this.ska});this.ska=n;this.$_.pJ(d);return!0}yNf(d,n,B){n={Tai:new Set,PZb:new Set,Vai:null,yuf:null};const Q=this.qb.ox(d.Jb,
!0,!1),ha=[];if(Q)for(const Aa of Q)ha.push(Aa);this.K3k(d,n,ha);return n=new Kz(ha,B,n.Tai,n.PZb,n.Vai,n.yuf)}K3k(d,n,B){if(d.ik){var Q=new Set;for(const Aa of d.lg.Rj)Aa.querySelectorAll("*").forEach(Q.add,Q);d=Array.from(Q.values())}else d=Array.prototype.slice.call(d.htmlElement.querySelectorAll("*"),0);let ha=[];n.PZb.add(B[0].id);n.Vai=B[0].id;n.yuf=B[0].id;d.forEach(Aa=>{const bb=Yv.a.Mb(Aa,"CaaeContentControlStartGuids");if(bb)for(const Ib of bb)ha.push(Ib),n.Tai.add(Ib);if(!ha.length)return!0;
Aa=Yv.a.Mb(Aa,"CaaeContentControlEndGuids");if(!Aa)return!0;ha=mH.a.Uxc(ha,Aa)});for(Q=d=this.qb.Cg(B[B.length-1],!1,!0);ha.length&&d;){n.PZb.add(d.id);n.yuf=d.id;B.push(d);for(const Aa of Q.QK)Aa.htmlElement.querySelectorAll(".CaaeContentControlEnd").forEach(bb=>{(bb=Yv.a.Mb(bb,"CaaeContentControlEndGuids"))&&(ha=mH.a.Uxc(ha,bb))});Q=d=this.qb.Cg(d,!1,!0)}}static Ycb(d,n){return!!n&&!!d&&d.Rai===n.Rai}}iB.Exk="WordBookmarkSvgIndicatorContainer";Object(D.a)(iB,"ContentAssemblyIndicatorActor",XJ.a,
[281]);class oH extends Ez.a{constructor(){super()}get Fha(){return!0}get Cub(){return 7}get Kbb(){if(null!=this.w7)return this.w7;this.w7=[];this.w7.push(new qx.a(Zi.j,Zi.j));return this.w7}$Oa(d,n){var B;if(this.Fha){var Q=this.Yt.pLa,ha=this.Yt.ced,Aa=d.DI;if(Q&&7===Q.type){ha=n.DPa("*");const bb=Q.ZD;if(null===(B=Q.XN)||void 0===B?0:B.Ju.includes(d))for(const Ib of ha)this.Yt.t1a(Ib);Aa&&Object(Zi.d)(d,!0,Aa)&&this.QVj(Aa,Zi.j,!1);bb&&bb.Ju.includes(d)&&this.TAb(n,Q.action,bb,d,ha,Aa)}else Q&&
ha&&7===ha.type&&3===Q.action&&ha.ZD.Ju.includes(d)&&(B=n.DPa("*"),this.TAb(n,0,ha.ZD,d,B,Aa))}}g_a(d){return d instanceof Kz}fbb(d,n){if(d)for(const B of d.Ju)n.add(B)}QVj(d,n,B){d=d.ug(Object(Cg.a)().Pd.Lc).htmlElement.querySelectorAll("table");0!==d.length&&d[0].classList.toggle(n,!!B)}TAb(d,n,B,Q,ha,Aa){if(0===n&&d.htmlElement)if(Aa)this.QVj(Aa,Zi.j,!0);else{d=ha.length;var bb=Q.id===B.Uai,Ib=Q.id===B.Sai;n=Array(d);var oc=[],Ac=0;Aa=!1;for(let sd=0;sd<d;sd++){const wd=ha[sd];var ad=JJ.a(wd);
n[sd]=ad;ad=wd.classList;if(0!=n[sd]){const yd=!ad.contains(po.a.ZJ),be=Yv.a.Mb(wd,"CaaeContentControlEndGuids");be&&oc.push(...be);if(bb){let ye;if(ye=Yv.a.Mb(wd,"CaaeContentControlStartGuids"))Ac+=ye.length,ad.add(Zi.j);if(be)for(const Qe of be)this.Pnn(B,Qe)&&Ac--;0!==Ac&&yd&&ad.add(Zi.j)}bb||Ib||!B.XFl.has(Q.id)||(Yv.a.Mb(wd,"CaaeContentControlEndGuids")&&Aa?ad.add(Zi.j):yd&&ad.add(Zi.j))}Aa=!ad.contains(po.a.C$a)}Aa=!1;if(Ib&&!bb)for(B=0;B<d;B++)Q=ha[B].classList,0!==n[B]&&!Q.contains(po.a.ZJ)&&
Aa&&Q.add(Zi.j),Aa=!Q.contains(po.a.C$a)}}Pnn(d,n){for(const B of d.WFl)if(n.equals(B))return!0;return!1}}Object(D.a)(oH,"ContentAssemblyHighlightActor",Ez.a,[307]);class pH{constructor(){this.Z=null}get name(){return"WordEditor.DocumentAssemblyEditor"}Ec(d){this.Z=d;const n=G.AFrameworkApplication.izb||fB.a.Kob;this.Z.ja("WordEditor.DocumentAssemblyEditor.Messenger",()=>new VE(new fB.a(null,null),n,this.Z.resolve("WordEditor.Extension.DocumentFactory"),this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),
this.Z.resolve("WordEditor.Extension.TableOperations"),this.Z.resolve("WordEditor.IImageEditor"),this.Z.resolve("Box4.IFormattingEditor"),this.Z.resolve("WordEditor.Extension.RequestContext"),this.Z.resolve("WordEditor.Extension.TableCellFactory"),this.Z.resolve("WordEditor.Extension.ParagraphFactory"),this.Z.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Z.resolve("WordEditor.Extension.IContentControlOperations"),this.Z.resolve("Box4.IParagraphIteratorFactory"),this.Z.resolve("Box4.IParagraphReader"),
te.a.instance,WJ.a.instance,G.AFrameworkApplication.va)).ha();this.Z.ja("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor",()=>new iB(d.resolve("Box4.IParagraphReader"),Da.a.instance,this.Z.resolve("Box4.Highlight.IHighlightManager"),d.resolve("Box4.IInteractiveEventHandler"))).ha()}init(){this.Z.resolve("WordEditor.DocumentAssemblyEditor.Messenger");G.AFrameworkApplication.$v&&(this.Z.resolve("Box4.Indicator.IIndicatorManager").LPa(this.Z.resolve("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor")),
this.Z.resolve("Box4.Highlight.IHighlightManager").xfb(new oH))}dispose(){}static main(){if(!G.AFrameworkApplication.BL&&G.AFrameworkApplication.$v){U.a.instance.Rc(new pH);const d=G.AFrameworkApplication.ta;d&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)&&"DocGen"!==G.AFrameworkApplication.$v&&"ContentAssemblyView"!==G.AFrameworkApplication.$v||!d.vxa||d.vxa.classList.add("HideRibbon"),d.$8c&&d.bJg.classList.add("hidePanel"))}}}Object(D.a)(pH,
"DocumentAssemblyPackageManager",null,[0,1]);var Jy=e(1475);class qu extends Sys.EventArgs{constructor(d){super();this.iwb=d}}Object(D.a)(qu,"LicenseStateChangeEventArgs",Sys.EventArgs,[]);class mv{constructor(d,n,B){this.Rw=d;this.za=n;this.H2e=B;this.rXb=new Promise((Q,ha)=>{this.tRk=Q;this.LQk=ha});this.ekm=Q=>{if(Q.featureName===Jy.a.CCf)switch(Q.tierName){case 2:F.ULS.sendTraceTag(541332422,2250,50,"FreemiumCallback for {0} updated state to Premium",Q.featureName);this.H2e.raiseEvent("OnLicenseStateChange",
new qu(!0));this.Rw.execute(ha=>{ha.O0b(Q.featureName,this.RUk)});break;default:F.ULS.sendTraceTag(541332423,2250,10,"FreemiumCallback for {0} received with unexpected value {1}",Q.featureName,Q.tierName)}else F.ULS.sendTraceTag(541332424,2250,10,"FreemiumCallback received with unexpected FeatureName {0}",Q.featureName)}}yUh(d){this.H2e.addHandler("OnLicenseStateChange",d)}Ncn(){this.tQd=(d,n)=>{this.H2e.raiseEvent("OnLicenseStateChange",new qu(2!==d));this.tRk({mode:d,Bdd:2!==d,Edq:n})};this.xzk=
()=>{F.ULS.sendTraceTag(541131153,2250,50,"Disabling feature for reason: Tier name is basic");this.LQk("Tier name is basic")};this.Rw.execute(d=>{d.getFeatureTier(Jy.a.CCf,0).then(n=>{const B=d.isFreemiumUpsellEnabled();if(32===this.O0m(n,B))F.ULS.sendTraceTag(541332419,2250,50,"WordEditor HandleEnableDisable Licensing completed successfully");else return d.isFeatureEnabled(Jy.a.ECf,!0);return null}).then(n=>{null!==n&&(this.h2m(n,d),F.ULS.sendTraceTag(541332420,2250,50,"WordEditor HandlePremium Licensing completed successfully"));
return null}).catch(n=>{F.ULS.sendTraceTag(541332421,2250,10,"Failed to initialize with licensing: Error {0}",n);n=d.isFreemiumUpsellEnabled();this.tQd(1,n);return null})})}O0m(d,n){this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)&&(d=0);switch(d){case 2:return this.tQd(0,n),32;case 1:return this.xzk(),32;default:return 2}}h2m(d,n){const B=n.isFreemiumUpsellEnabled(),Q=this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",
!1);d&&!Q?this.tQd(1,B):(this.RUk=n.dxa(Jy.a.CCf,this.ekm),this.tQd(2,B||Q))}}Object(D.a)(mv,"AddInLicensingManager",null,[1030]);const Ky=(d,n,B,Q,ha)=>{const Aa={state:3,daysRemaining:-1};d=Math.floor((+n-+d)/864E5);0>d?Aa.state=3:d>=B?(Aa.daysRemaining=B-d,Aa.state=d>B+30?2:5):(Aa.daysRemaining=B-d,Aa.state=1);if(2===Aa.state||5===Aa.state)Aa.state=Q&&0<=ha?0:Aa.state;return Aa};class VC{constructor(d,n=null){this.za=d;this.TG=null!==n&&void 0!==n?n:()=>new Date}HWb(){return this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsWomppEnabled",
!1)}JKf(){const d=new Date(this.za.getStringFeatureGate("Microsoft.Office.WordOnline.FA000000029.WomppUntilDate","2021/12/1")),n=this.TG();return Math.floor((+d-+n)/864E5)}npn(){const d=G.AFrameworkApplication.FYb;return d&&d.toLowerCase()===VC.Wqk?!0:!1}}VC.Wqk="tm67341774";Object(D.a)(VC,"UpsellCampaignGate",null,[]);class Lz{constructor(d){this.za=d}isEnabled(){const d=this.za.$("EditorBrowserExtensionPromo"),n=this.n6l();return d||n}n6l(){return"-4"===G.AFrameworkApplication.sessionStartInfoSettings.Ring}}
Object(D.a)(Lz,"BxPromoGate",null,[]);class WE{constructor(){this.isDismissed=this.isInstalled=!1}}Object(D.a)(WE,"BxPromoSettings",null,[1072]);class WC extends op.a{constructor(d,n,B,Q,ha){super(d,n,B,Q,ha);this.TKc="getEditorBxPromoSettings";this.qcc="saveEditorBxPromoSettings";this.uac=WC.Ljk;this.nIb=["IsInstalled","IsDismissed"];this.qba="BX cross-promo";this.Xmb=Rt.a.BCf}async $1o(){this.lj||(this.oh.sendTraceTag(557183135,2250,15,"BX cross-promo settings null when setting isDismissed"),this.lj=
new WE);this.lj.isDismissed=!0;await this.aqd()}get Sic(){return new WE}Wec(){return["IsInstalled",this.lj.isInstalled,"IsDismissed",this.lj.isDismissed]}Vec(){return{["IsInstalled"]:this.J0(this.lj.isInstalled.toString()),["IsDismissed"]:this.J0(this.lj.isDismissed.toString())}}async dpd(d){const n=this.lj.isDismissed&&!d.isDismissed;this.lj.isDismissed=this.lj.isDismissed||d.isDismissed;this.lj.isInstalled=this.lj.isInstalled||d.isInstalled;return n}K_c(){return new JC.a}fkd(d){const n=new WE;n.isInstalled=
this.FEj(d.IsInstalled);n.isDismissed=this.FEj(d.IsDismissed);return n}}WC.Ljk="BxPromoSettingsChangedEvent";Object(D.a)(WC,"BxPromoSettingsHandler",op.a,[1036,1037,947]);const Mz=[["363d7011-83dd-4cc0-bdec-ea4af4df4dbb",!1],["6d1d8c3d-62d5-45d1-b850-d8a98a24964b",!1]],ru=[["cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",!1],["f55d29d6-efd4-4a51-8a01-e0a7bd549073",!0],["c1ed6a31-f439-4115-8272-7bbd2f663a84",!0],["d124712e-74ac-43eb-9bb6-373b2398f448",!0],["ca649e0f-48de-4f54-b687-2bda07e40728",!0],["9e5c572b-ec30-4f6b-b75c-ad9e60efe95e",
!0],["12d7f72e-e53e-4b27-b1ed-4ee115f54994",!0],["f57c12d6-03e4-4f48-9b7b-f95802a6c669",!1],["25714ab1-190b-4ef3-8d3d-e45bfd591c45",!0],["708198dd-ecbf-44fb-a428-ff2bc10e4d17",!0],["0fc5f67a-9d4e-41de-a1c6-ebe9b8b9046c",!0],["6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",!0],["5d411ad2-a965-4c01-b425-ecce2b374dfa",!0],["e006985e-33eb-42e1-9196-1333c4ecad9c",!0],["e3391a10-ee05-41e7-984d-82e72981a099",!0],["520b6db9-9638-4266-aa31-dc2cadd19aa8",!0],["0124af9e-756d-4ab9-8cc6-d99a20c22897",!0],["b85a7205-ba3d-4afb-8187-86f8ea104c75",
!0],["0941dabb-e993-4a10-8a92-70a95ca5389d",!0],["7c2ff4d7-41a9-4310-949b-863a0dfa4257",!1],["0da5de95-d496-4d23-8f93-693ef6592ae6",!1],["04cc32b6-7af4-4778-8ce9-c32698169b6a",!0],["95647447-1670-4af1-868e-7266583f61ff",!0],["a7927082-e6bb-4061-a134-3051e5969222",!0],["c61cb624-820e-454a-b426-cdd4c0a7011b",!0],["26bdc172-02a8-4f0a-8ec0-6049906f1f7c",!0],["79dd443b-0b94-45a1-90ad-02807565324d",!1],["4ee98de6-ea40-48db-ae36-ca82fc8473f7",!0],["2948a1be-32f1-460e-84ef-8b89597af9f1",!0],["67718619-a6b1-43ec-af18-1c48bbc27acd",
!0],["a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",!0],["19c926ad-f32d-42f8-996f-853c3ba00ab5",!0],["5f1ea714-acc6-4b01-84d5-5a7666aa297b",!0],["296f8f65-02fb-45a7-b4ab-5dc137edc563",!0],["766428da-f41f-451d-818d-174eb99d84ba",!0],["8778ba37-ca99-4ab9-a964-55abd18f7eba",!0],["a44ac718-8213-42ff-87a5-1e5d6592c352",!1],["97e25aa1-c0cc-435f-adaa-e2d490553b6d",!0]],jB=[["6d60d9da-9e38-4d1e-bfc5-05a04120eef9",!1],["63e72d3d-62d7-4e73-8d66-c137d8841121",!1],["27783a58-c44f-4778-9856-36d9eab63693",!1],["5cb7fc16-cd78-449c-86d9-5d047be21ac4",
!1],["79405b77-e475-4f04-ba37-a3e6be66d3f2",!0],["7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",!0],["ba48d6ad-df91-4420-b26f-31c07765842d",!0],["d7746119-e7e5-4e97-9979-bcd2114f9fe9",!1],["50d4e435-dd52-4c0d-bb7a-9bb1c154a148",!0],["ef92c613-9224-424f-b391-748476b011cb",!0],["9aabeae7-bda2-44a7-a7f1-9c3d9089191e",!0],["39e466f1-6ebd-4ada-a7db-e0cc74048f1e",!0],["55178e46-8927-4b63-b19e-7c6fb5f8929b",!0],["aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",!1],["8cf6f68e-f693-4e6f-b253-5092cd19b9e2",!0],["4f42f243-8cb5-4f1a-a5a6-58b60d303e02",
!0],["012a7c1a-292a-4e17-b126-00191939cc0d",!0],["6cb8eda6-6cac-443a-8e3a-0df80ba725f6",!0],["6dbfae4c-9818-4dec-a769-2595168927f2",!1],["02c15397-df70-4f00-aa4d-7269e6d4e712",!1],["bd326c9c-0e4a-4ddf-be36-1ef7bee200ca",!0],["49b2a4fe-b569-43fb-bb54-796eddc260b3",!0],["d1572a1d-58d1-443f-997e-2722cfc41afe",!0],["f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",!1],["64213f24-0943-4585-8dd4-ee4f26b47a37",!0],["413425d5-5a64-4ea6-84df-aae06c596439",!0],["a127d2c9-2faf-491b-8d6a-e9b027fec098",!0],["999cc56a-caa5-4889-829e-7e249688e1cf",
!0],["62540ee8-7f12-4c6e-be18-89268fa8a289",!1],["b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",!0],["c4301606-9bc2-4389-bb1a-c08370627172",!0],["75069b86-2fd8-4158-a9ab-2793fd1d6f8b",!0],["03522a58-4044-4bab-b796-0630ae2ad00a",!0],["9feebbfe-9e8d-4b59-8c7a-8b3c462d6697",!0],["e24fd819-cc17-4be9-afec-dd103055198e",!0],["72e604b0-a185-413b-bd45-ad555288c746",!1],["c1056d52-e69d-43a6-926c-662cb2228185",!0],["5b75d94a-856d-461b-9bb4-879f4502b4c3",!1],["6ae03cab-953e-4382-bd27-843c5d553b23",!1],["e8c121e0-1ecd-4e88-8694-2fb17acb519d",
!0],["f4aa4a0a-f81a-41ac-b710-de4a60b99282",!1],["ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",!0],["e805847a-9050-45de-b767-f48ed68ad848",!0],["d96e4e94-041b-4389-861d-3cd4556d55f6",!0],["84275a90-df79-4b9e-a208-9ec8b5e59622",!1],["faa8f367-32d3-44cc-8eda-6e1e9de23efc",!1],["c68edc3b-9340-4b68-9d18-268bb82e2d94",!0],["8caa3b8f-202e-4a32-91a8-320b5272777e",!0],["3f2eda01-e8a5-4ed9-9494-6de566bc5333",!1],["6a0e1c97-430e-4d83-889d-8c4fea315a83",!0],["aa78ec66-2078-42bf-84f5-c241eb53a531",!0],["fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",
!1],["2d08dbe8-c11b-4190-a428-9a2c0a37bd68",!0],["3fd9c226-3925-4855-ba1e-49eb9ee46d24",!0],["1c169b51-d9a5-4b69-9abc-2bcd5e9c5912",!0],["818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",!1],["79d4a5c7-11c0-4be1-8d3c-c322f9941323",!0],["b956d579-6d99-4278-8b7d-e281ab8c576b",!0],["55aa25a5-e28a-4f22-8410-34a4df965e30",!1],["d78a8ad6-bac7-47ff-8016-d75f7fcd8370",!0],["822bb35e-0608-466e-a771-a315fcf95821",!0],["0c576af1-54af-4acb-8065-4616bb73820d",!0],["e3994139-ff36-44da-ae72-500b70d9b80f",!0],["2700d569-bd6f-4806-9bf1-49abd64d9fd3",
!0],["3f2e6b47-fc23-4f99-ad25-1758e7f179b6",!0],["352579fc-6ae6-4eb1-8d3b-895ab239714e",!1],["985091e9-4b33-42f7-b2ff-191b03f2ba74",!0],["9d62fd01-8804-4485-a5f0-257131e4f6aa",!0],["e7c89ada-94b2-426a-b8ea-069712de5d9f",!1]];class Dx{constructor(d,n,B){this.hJa=d;this.D7e=n;this.WDb=B;this.xmb=new Map;this.Vvh=this.jzh=this.QHd=!1;this.Ajf=Q=>{this.D7e.addHandler(Dx.ypg,Q)};this.TIp=(Q,ha)=>{Q=!ha.iwb;Q!==this.QHd&&(this.QHd=Q,this.hJa.g7i()&&this.D7e.raiseEvent(Dx.ypg))};this.z0f=(Q,ha,Aa)=>this.hJa.g7i()?
0===this.xmb.size?(this.jzh||(cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.PremiumPreviewCritiquesFilter.FilteringBeforeInitialization",dataFields:[]})),this.jzh=!0),!0):!this.QHd||"Spelling"===ha||Aa&&-1===Aa.toLowerCase().search("en")||this.Vvh?!0:void 0!==this.xmb.get(Q)?!this.xmb.get(Q):!1:!0;this.isCritiqueTypeUnderPaywall=(Q,ha,Aa)=>Aa&&-1===Aa.toLowerCase().search("en")?!1:void 0!==this.xmb.get(Q)?this.xmb.get(Q):!0}hWi(d,n=!1){this.QHd=!d.Bdd;this.Vvh=n;this.WDb.yUh(this.TIp);
jB.forEach(([B,Q])=>this.xmb.set(B,Q));Mz.forEach(([B,Q])=>this.xmb.set(B,Q));this.hJa.Eyn()||ru.forEach(([B,Q])=>this.xmb.set(B,Q));this.D7e.raiseEvent(Dx.ypg)}}Dx.ypg="PremiumPreviewFilterChangedEvent";Object(D.a)(Dx,"PremiumPreviewCritiquesFilter",null,[1035]);class Up{constructor(){this.startDate=null;this.allPpTypes=this.currentPpType=this.acceptedSimilarityCitations=this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=this.totalDays=
0}}Object(D.a)(Up,"PremiumPreviewSettings",null,[1072]);class Ex extends Up{constructor(){super(...arguments);this.state=this.premiumSuggestionsCount=this.totalDays=this.daysRemaining=0;this.startDate=null;this.cardType=1}}Object(D.a)(Ex,"PremiumPreviewData",Up,[]);class XC extends Sys.EventArgs{constructor(d){super();this.zm=d}}Object(D.a)(XC,"PremiumPreviewDataChangeEventArgs",Sys.EventArgs,[]);var fw;(function(d){d[d.initial=0]="initial";d[d.Gha=1]="inProgress";d[d.Q$l=2]="expired";d[d.error=3]=
"error";d[d.Smj=4]="notInitialized";d[d.v7p=5]="expiredWithMetrics";d[d.dwq=6]="softPaywallInProgress"})(fw||(fw={}));Object(D.b)("PremiumPreviewState",fw);var Po;(function(d){d[d.zXp=1]="Regular";d[d.iZp=2]="Wompp";d[d.jYp=4]="SoftPaywall"})(Po||(Po={}));Object(D.b)("PremiumPreviewType",Po);class gw{constructor(d,n,B,Q,ha,Aa,bb=null){this.zbc=d;this.Ynb=n;this.hJa=B;this.pSe=Q;this.oh=ha;this.$Ia=Aa;this.rSe=!1;this.GPe=this.Ynb.HWb()?2:1;this.D8n=(Ib,oc)=>{this.r$c(oc.settings)};this.TG=bb?bb:()=>
new Date;this.zm=Object.assign(new Ex,{state:4});this.zbc.hjf(this.D8n)}async start(d){const n=await this.kDm(),B=this.MJi(d);if(1===n.state&&2===n.currentPpType)this.oh.sendTraceTag(545293637,2250,15,"User tried to enter WOMPP but already inProgress");else{switch(d){case 1:if(this.JKp(n,d)){this.oh.sendTraceTag(545293638,2250,15,"Trying to start Premium Preview but already in PP.");return}this.zbc.eMj();break;case 2:if(1===n.state&&1===n.currentPpType){if(n.daysRemaining>B){this.oh.sendTraceTag(545293639,
2250,15,"User tried to enter WOMPP but regular PP is longer.");return}}else this.zbc.eMj();break;default:this.oh.sendTraceTag(545116506,2250,10,`Premium Preview started with type; ${Po[d]}`);return}this.setState(1,d);this.$Ia.iwa(dd.a.cOg,!0,null,null,null,null,[{...(new Ja.a),name:"ppType",string:Po[d]},{...(new Ja.a),name:"ppDuration",int64:B}])}}JKp(d,n){const B=d.allPpTypes,Q=d.startDate;d=d.totalDays;return 1===n&&0===B?!!Q&&!!d:0!==(B&n)}MJi(d){switch(d){case 1:return this.hJa.WPf();case 2:return this.Ynb.JKf()}}kDm(){return new Promise(d=>
{if(this.rSe&&4!==this.zm.state)d(this.zm);else{const n=(B,Q)=>{4!==Q.zm.state&&(this.rSe=!0,this.qJo(n),d(Q.zm))};this.UMb(n)}})}r$c(d){this.rSe=!0;d?4===d.currentPpType?this.zm={...(new Ex),cardType:4,state:6}:d.startDate||d.totalDays?(this.zm={...Ky(d.startDate,this.TG(),d.totalDays,this.Ynb.HWb(),this.Ynb.JKf()),...d,premiumSuggestionsCount:0,cardType:this.GPe},3===this.zm.state&&this.oh.sendTraceTag(559256014,2250,10,"Premium preview start date greater than current date"),1!==this.zm.state||
2!==this.zm.currentPpType||this.Ynb.HWb()||(this.oh.sendTraceTag(540674119,2250,15,"Tried to start WOMPP but it is disabled. Defaulting to expired state."),this.zm.state=2)):(this.oh.sendTraceTag(559256013,2250,50,"Premium preview not yet started"),this.zm=Object.assign(new Ex,{daysRemaining:this.hJa.WPf(),state:0,totalDays:this.hJa.WPf(),startDate:null,cardType:this.GPe})):(this.oh.sendTraceTag(559256012,2250,15,"Trying to intialize premium preview data with null settings"),this.zm=Object.assign(new Ex,
{state:3}));this.raiseEvent()}B_o(d){this.oh.sendTraceTag(559256015,2250,50,"Setting premium preview remaining days: {0}",d);this.zm.daysRemaining=d;this.raiseEvent()}async RYo(d){await this.zbc.nop(d,this.zm)}setState(d,n){this.oh.sendTraceTag(559256016,2250,50,"Setting premium preview state: {0}",d);this.zm||(this.oh.sendTraceTag(559256017,2250,15,"Premium preview data null when setting state: {0}",d),this.zm=new Ex,this.zm.cardType=this.GPe);switch(d){case 1:const B=this.TG();this.zbc.T5o(new Date(B.toUTCString()),
this.MJi(n),n);void 0!==n&&(this.zm.allPpTypes|=n,this.zm.currentPpType=n);break;case 0:this.oh.sendTraceTag(559256019,2250,50,"Setting premium preview state to Initial from {0}",this.zm.state),this.zbc.aOo(),this.raiseEvent()}this.zm.state=d;this.raiseEvent()}raiseEvent(){this.$Ia.iwa(dd.a.s_b,!0,null,null,null,null,[{...(new Ja.a),name:"AllPpTypes",int64:this.zm.allPpTypes},{...(new Ja.a),name:"CurrentPpType",string:Po[this.zm.currentPpType]},{...(new Ja.a),name:"PremiumPreviewState",string:fw[this.zm.state]},
{...(new Ja.a),name:"DaysRemaining",int64:this.zm.daysRemaining},{...(new Ja.a),name:"TotalDays",int64:this.zm.totalDays},{...(new Ja.a),name:"PremiumSuggestionsCount",int64:this.zm.premiumSuggestionsCount},{...(new Ja.a),name:"AcceptedRefinements",int64:this.zm.acceptedRefinements},{...(new Ja.a),name:"AcceptedSimilarityCitations",int64:this.zm.acceptedSimilarityCitations},{...(new Ja.a),name:"AcceptedSpellingAndGrammar",int64:this.zm.acceptedSpellingAndGrammar},{...(new Ja.a),name:"AcceptedTextPredictions",
int64:this.zm.acceptedTextPredictions},{...(new Ja.a),name:"AutoCorrectedErrors",int64:this.zm.autoCorrectedErrors}]);this.pSe.raiseEvent(gw.xpg,new XC(this.zm))}UMb(d){this.pSe.addHandler(gw.xpg,d)}qJo(d){this.pSe.removeHandler(gw.xpg,d)}}gw.xpg="PremiumPreviewDataChangedEvent";Object(D.a)(gw,"PremiumPreviewDataHandler",null,[]);class qH{constructor(d,n){this.za=d;this.WDb=n}WPf(){return this.za.getIntFeatureGate("Microsoft.Office.WordOnline.FA000000029.PremiumPreviewDuration",7)}async z3f(){if(!this.za.$("EditorPremiumPreviewEnabled"))return!1;
try{return!(await this.WDb.rXb).Bdd}catch(d){return!1}}Swn(){return this.za.$("EditorPremiumPreviewStateUpdateEnabled")}g7i(){return this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.SelectedCritiquesDuringPremiumPreview",!1)}Eyn(){return this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsSelectedCritiquesDuringPremiumPReviewAcceptRateHigh",!1)}}Object(D.a)(qH,"PremiumPreviewGate",null,[1023]);const YC=new Map([["E_Refinements","acceptedRefinements"],["E_Similarity",
"acceptedSimilarityCitations"],["E_Spelling_Grammar","acceptedSpellingAndGrammar"],["E_TextPrediction","acceptedTextPredictions"],["E_AutoCorrect","autoCorrectedErrors"]]);class St extends op.a{constructor(d,n,B,Q,ha){super(d,n,B,Q,ha);this.TKc="getPremiumPreviewSettings";this.qcc="savePremiumPreviewSettings";this.uac=St.mmo;this.nIb="StartDate TotalDays AcceptedRefinements AcceptedSimilarity AcceptedSpellingAndGrammar AcceptedTextPrediction AutoCorrectErrors CurrentPpType AllPpTypes".split(" ");
this.qba="Premium preview";this.Xmb=Rt.a.FCf}async T5o(d,n,B){this.lj||(this.oh.sendTraceTag(559255966,2250,15,"Premium preview settings null when setting date and total days "),this.lj=new Up);let Q=this.lj.allPpTypes|B;this.lj.startDate&&this.lj.totalDays&&(Q|=1);this.lj={...this.lj,startDate:d,totalDays:n,currentPpType:B,allPpTypes:Q};await this.aqd()}async nop(d,n){var B=await this.ZLi();B=this.Bqj(B);for(const Q of Pn.Pjc)this.YBp(d,n,B,Q);this.lj=B;this.lPj(this.Vec())}eMj(){this.lj||(this.oh.sendTraceTag(545338245,
2250,15,"Premium preview settings null when setting date and total days "),this.lj=new Up);this.lj={...this.lj,acceptedRefinements:0,acceptedSimilarityCitations:0,acceptedSpellingAndGrammar:0,acceptedTextPredictions:0,autoCorrectedErrors:0}}YBp(d,n,B,Q){const ha=YC.get(Q);n[ha]=B[ha]+=void 0==d.get(Q)?0:d.get(Q)}get Sic(){return new Up}Wec(){return["StartDate",this.lj.startDate,"TotalDays",this.lj.totalDays,"AcceptedRefinements",this.lj.acceptedRefinements,"AcceptedSimilarity",this.lj.acceptedSimilarityCitations,
"AcceptedSpellingAndGrammar",this.lj.acceptedSpellingAndGrammar,"AcceptedTextPrediction",this.lj.acceptedTextPredictions,"AutoCorrectErrors",this.lj.autoCorrectedErrors,"CurrentPpType",this.lj.currentPpType,"AllPpTypes",this.lj.allPpTypes]}Vec(){var d=this.lj.startDate.toISOString();d=d.substring(0,d.indexOf("T"));return{["StartDate"]:this.J0(d),["TotalDays"]:this.J0(this.lj.totalDays.toString()),["AcceptedRefinements"]:this.J0(this.lj.acceptedRefinements.toString()),["AcceptedSimilarity"]:this.J0(this.lj.acceptedSimilarityCitations.toString()),
["AcceptedSpellingAndGrammar"]:this.J0(this.lj.acceptedSpellingAndGrammar.toString()),["AcceptedTextPrediction"]:this.J0(this.lj.acceptedTextPredictions.toString()),["AutoCorrectErrors"]:this.J0(this.lj.autoCorrectedErrors.toString()),["CurrentPpType"]:this.J0(this.lj.currentPpType.toString()),["AllPpTypes"]:this.J0(this.lj.allPpTypes.toString())}}async dpd(d){if(d.startDate!==this.lj.startDate||d.currentPpType!==this.lj.currentPpType)return!0;this.lj=d;return!1}K_c(){return new JC.a}fkd(d){let n=
null;d.StartDate&&(n=this.IEj(d.StartDate));const B=this.qfb(d.TotalDays);return{startDate:n,totalDays:B,acceptedRefinements:this.qfb(d.AcceptedRefinements,!0),acceptedSimilarityCitations:this.qfb(d.AcceptedSimilarity,!0),acceptedSpellingAndGrammar:this.qfb(d.AcceptedSpellingAndGrammar,!0),acceptedTextPredictions:this.qfb(d.AcceptedTextPrediction,!0),autoCorrectedErrors:this.qfb(d.AutoCorrectErrors,!0),currentPpType:this.qfb(d.CurrentPpType,!0),allPpTypes:this.qfb(d.AllPpTypes,!0)}}}St.mmo="PremiumPreviewSettingsChangedEvent";
Object(D.a)(St,"PremiumPreviewSettingsHandler",op.a,[1019]);class Ly{constructor(d,n,B,Q,ha,Aa=null){this.ga=d;this.oh=n;this.hJa=B;this.zUa=Q;this.Ynb=ha;this.hgh=!1;this.Rid=(bb,Ib)=>{if(!Ib||!Ib.zm)this.oh.sendTraceTag(559255960,2250,10,"PremiumPreviewStateUpdater: premium preview data is null");else if(Ib.zm.state!==this.zm.state||Ib.zm.currentPpType!==this.zm.currentPpType)this.zm=Ib.zm,this.LRj(this.zm),this.PTo()};this.checkState=()=>{if(1===this.zm.state||5===this.zm.state){const bb=Ky(this.zm.startDate,
this.TG(),this.zm.totalDays,this.Ynb.HWb(),this.Ynb.JKf());this.zm={...this.zm,...bb};switch(this.zm.state){case 2:case 5:this.oh.sendTraceTag(559255963,2250,50,"Premium preview state check: preview expired");this.zUa.setState(this.zm.state);break;case 3:this.oh.sendTraceTag(559255964,2250,10,"Premium preview state check: start date greater than current date");this.zUa.setState(this.zm.state);break;case 1:this.oh.sendTraceTag(559255965,2250,50,"Premium preview state check: days remaining updated",
this.zm.daysRemaining),this.zUa.B_o(this.zm.daysRemaining)}this.LRj(this.zm)}};this.TG=Aa?Aa:()=>new Date;this.zm=this.zUa.zm;this.Ven()}Ven(){this.hJa.Swn()?this.zUa.UMb(this.Rid):this.oh.sendTraceTag(559255959,2250,10,"PremiumPreviewStateUpdater: premium preview update disabled")}LRj(d){this.oh.sendTraceTag(559255961,2250,50,"Premium preview state change message sent");this.ga.Zb(dd.a.s_b,2,d)}PTo(){1!==this.zm.state||this.hgh||(this.hgh=!0,window.setInterval(this.checkState,36E5),this.oh.sendTraceTag(559255962,
2250,50,"Premium preview state check initiated"))}}Object(D.a)(Ly,"PremiumPreviewStateUpdater",null,[]);class Fx{constructor(d){this.za=d}M2i(){return this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)}}Object(D.a)(Fx,"SimulateFreeUserGate",null,[]);var Nz=e(319),Su=e(1754);class YJ{constructor(d,n,B,Q){this.ff=d;this.oh=n;this.BUk=B;this.WE=Q}async initialize(){try{await this.WE.Km(),this.ff.Cb(this,Su.RoamingSettingAnnotation.getTypeName())}catch(d){this.oh.sendTraceTag(507916800,
2250,10,"Soft Paywall annotation registration failed.",d)}}XI(d,n){n!==Qj.a.getTypeName()?this.oh.sendTraceTag(507916771,2250,10,"Handled Soft Paywall Roaming Settings with wrong operation type",n):null!==d&&void 0!==d&&d.content&&Nz.a.getTypeNameFor(d.content)===Su.RoamingSettingAnnotation.getTypeName()?(n=d.content,n.settingValueJson?(d=JSON.parse(n.settingValueJson),this.BUk.updateAndPersistState(d),this.oh.sendTraceTag(507916768,383,50,"SoftPaywall annotation initialized "+JSON.stringify(d))):
this.oh.sendTraceTag(507916769,2250,10,"Handled Soft Paywall Roaming Settings annotation setting is invalid",d)):this.oh.sendTraceTag(507916770,2250,10,"Handled Soft Paywall Roaming Settings annotation is invalid",d)}}Object(D.a)(YJ,"SoftPaywallAnnotationHandler",null,[365]);class ZC{constructor(d,n,B,Q){this.aLh=d;this.bLh=n;this.$Ia=B;this.oh=Q;this.initialCredits=20;this.isEnabled=!1;this.wbf=0}updateAndPersistState(d){this.softPaywallData=this.Vlp(d)}get softPaywallData(){return{credits:this.credits,
receivedCredits:this.receivedCredits,receivedCreditsDate:this.receivedCreditsDate,isEnabled:this.isEnabled}}set softPaywallData(d){this.credits=d.credits;this.receivedCredits=d.receivedCredits;this.receivedCreditsDate=d.receivedCreditsDate}spendCredit(){0>=this.credits?this.oh.sendTraceTag(512234826,2250,10,"Spend credits are called with no credits left",this.softPaywallData):(this.wbf++,this.credits--,this.aLh.CRj(),this.$Ia.iwa(dd.a.$ip,!0,null,null,null,null,[{...(new Ja.a),name:"newData",string:JSON.stringify(this.softPaywallData)}]))}Vlp(d){let n=
{...d},B=!1;this.bLh.Pap(d)&&(n=this.$Ko(d),B=!0);this.wbf&&(0<n.credits&&(n.credits--,B=!0),this.wbf--);B&&this.aLh.ZXo(n);return n}$Ko(d){const n={credits:this.initialCredits,receivedCredits:this.initialCredits,receivedCreditsDate:this.bLh.f1j(),isEnabled:this.isEnabled};this.$Ia.iwa(dd.a.SHp,!0,null,null,null,null,[{...(new Ja.a),name:"oldData",string:JSON.stringify(d)},{...(new Ja.a),name:"newData",int64:JSON.stringify(n)}]);return n}}Object(D.a)(ZC,"SoftPaywallState",null,[]);class ZJ{constructor(d,
n){this.za=d;this.WDb=n}async isEnabled(){if(!this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1))return!1;try{return!(await this.WDb.rXb).Bdd}catch(d){return!1}}}Object(D.a)(ZJ,"SoftPaywallGate",null,[1014]);var nv=e(892),Kw=e(891);class rH{constructor(d,n,B,Q){this.ff=d;this.oh=n;this.WE=B;this.A_=Q;this.vtk="SoftPaywall";this.eIh=10014}ZXo(d){d=new Su.RoamingSettingsWriteSignal({id:this.eIh,valueJson:JSON.stringify(d),settingType:Su.RoamingSettingType.Dictionary});
const n=new nv.a;n.body=d;d=Object.assign(new Qj.a,{parentPath:["Signal",Su.RoamingSettingsWriteSignal.getTypeName()],items:[n]});this.K4d(d)}CRj(){var d=new Su.RoamingSettingsReadSignal({ids:[this.eIh]});const n=new nv.a;n.body=d;d=Object.assign(new Qj.a,{parentPath:["Signal",Su.RoamingSettingsReadSignal.getTypeName()],items:[n]});this.K4d(d)}async K4d(d){try{await this.WE.Km(),this.ahf(d)}catch(n){this.oh.sendTraceTag(507916767,2250,10,"EnsureAugLoopRuntimeManager exception.",n)}}async ahf(d){try{await this.ff.activateAnnotation(Su.RoamingSettingAnnotation.getTypeName(),
this.vtk),this.A_.getAugLoopRuntimeManager().submitOperation(Object.assign(new Kw.a,{operation:d}))}catch(n){this.oh.sendTraceTag(507916766,2250,10,"Activating RoamingSettingAnnotation threw exception.",n)}}}Object(D.a)(rH,"SoftPaywallSignalSender",null,[1015]);class sH{f1j(){var d=new Date;return 100*d.getFullYear()+d.getMonth()+1}Pap(d){return null!==d&&void 0!==d&&d.receivedCreditsDate?Number(d.receivedCreditsDate)<this.f1j():!0}}Object(D.a)(sH,"SoftPaywallUtils",null,[1013]);class su extends ze.a{constructor(){super(...arguments);
this.Z=null}get name(){return"WordEditor.EditorUpsell"}bXa(d){this.Z=d;this.Z.ja("WordEditor.Ideas.AddInLoader.IAddInLicensingManager",()=>new mv(this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),G.AFrameworkApplication.J,new dc.a)).ha();this.Z.ja("WordEditor.EditorUpsell.IPremiumPreviewGate",()=>new qH(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.Z.ja("WordEditor.EditorUpsell.ISimulateFreeUserGate",
()=>new Fx(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ja("WordEditor.EditorUpsell.IUpsellCampaignGate",()=>new VC(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ja("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler",()=>new St(this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.Z.resolve("Common.IAppSettingsManager"),new dc.a,this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.EditorUpsell.PremiumPreviewDataHandler",
()=>new gw(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new dc.a,this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).as("WordEditor.EditorUpsell.IPremiumPreviewDataProvider").as("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").as("WordEditor.EditorUpsell.IPremiumPreviewDataHandler").as("WordEditor.EditorUpsell.IPremiumPreviewAPI").ha();
this.Z.ja("WordEditor.EditorUpsell.PremiumPreviewCritiquesFilter",()=>new Dx(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new dc.a,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").ha();this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter");this.Z.register(Ly,"WordEditor.EditorUpsell.PremiumPreviewStateUpdater").ha().fe(()=>new Ly(G.AFrameworkApplication.va,this.Z.resolve("Common.IUlsWrapper"),
this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha();this.Z.ja("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler",()=>new WC(this.Z.resolve("Box4.IRoamingServiceRequestManager"),d.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.Z.resolve("Common.IAppSettingsManager"),new dc.a,this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsUpdater").as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader").ha();
this.Z.ja("WordEditor.Ideas.EditorUpsell.IBxPromoGate",()=>new Lz(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ja("WordEditor.EditorUpsell.ISoftPaywallGate",()=>new ZJ(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.Z.ja("WordEditor.EditorUpsell.SoftPaywallUtils",()=>new sH).ha();this.Z.ja("WordEditor.EditorUpsell.SoftPaywallSignalSender",()=>new rH(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).ha();this.Z.ja("WordEditor.EditorUpsell.ISoftPaywallData",()=>new ZC(this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender"),this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallUtils"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler",
()=>new YJ(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"))).ha()}async dXa(){var d=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),n=this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallGate"),B=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");B.Ncn();var Q=this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");
d=await d.z3f();n=await n.isEnabled();Uc.a.RVb&&n?(await this.fYf(),this.Dcn(B,n)):Uc.a.RVb&&(d||Q.HWb())?(Q=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.Z.resolve("WordEditor.EditorUpsell.PremiumPreviewStateUpdater"),await this.fYf(),Q=await Q.Xed(),this.r$c(Q),B=await B.rXb,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").hWi(B)):this.fYf()}fYf(){this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate").isEnabled()&&this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler").Xed()}r$c(d){this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").r$c(d)}Dcn(d,
n){this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(async B=>{if(B.isFreemiumUpsellEnabled()){B=this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender");var Q=this.Z.resolve("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler"),ha=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Aa=this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData");Q.initialize();this.r$c({currentPpType:4});Q=await d.rXb;ha.hWi(Q,n);Aa.isEnabled=!0;B.CRj()}})}cXa(){}static main(){U.a.instance.Rc(new su)}}
Object(D.a)(su,"WordEditorEditorUpsellPackage",ze.a,[]);var Oz=e(817);class Pz{constructor(d,n,B){this.ga=d;this.oh=n;this.w6a=B;this.Xi=null;this.Zjh={["id"]:Pz.jUg,["bodyControls"]:{["id"]:Pz.jUg,["isModal"]:!0,["isBlocking"]:!1,["dialogType"]:0}};this.Gco=()=>{try{this.Xi=this.JHm(),this.Xi.Md=5,this.Zjh.bodyControls.dialogType=4,this.Xi.ti("",this.LBa,this.Zjh)}catch(Q){this.oh.sendTraceTag(542749407,2250,10,`Upsell share dialog failed to open. Error message: ${Q.message}, error stack trace ${Q.stack}`);
return}this.w6a.Sy(dd.a.Sbo,!0)};this.LBa=Q=>{this.w6a.iwa(dd.a.Rzl,!0,null,null,null,null,[{...(new Ja.a),name:"ClosedWithDialogButtonType",string:Oz.a[Q]}]);this.ga.Zb(dd.a.Ofb,2,"tell-a-friend-button")};this.ga.qa(dd.a.g3m,ed.a.view,this.Gco)}dispose(){this.Xi&&this.Xi.dispose()}JHm(){return new Ea.a(!1,!1,!0)}}Pz.jUg="GenericDialog";Object(D.a)(Pz,"UpsellCampaignActor",null,[]);class XE extends ze.a{constructor(){super(...arguments);this.TOh=this.Z=null}get name(){return"WordEditor.UpsellCampaign"}bXa(d){this.Z=
d}dXa(){const d=this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"),n=this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");this.TOh=new Pz(G.AFrameworkApplication.va,this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"));n.npn()&&(d.start(2),this.Z.resolve("Wac.Common.Utils.IOtelWrapper").Sy(dd.a.Tbo,!0))}cXa(){this.TOh.dispose()}static main(){(new VC(G.AFrameworkApplication.J)).HWb()&&U.a.instance.Rc(new XE)}}Object(D.a)(XE,"WordEditorUpsellCampaignPackage",
ze.a,[]);class kB{constructor(){this.mz=(new pe.a).Vc(15);const d=yg.StaticActiveAppFrame.Aa().tb.rd;this.mz.Eb(d)}dispose(){this.mz.dispose()}}Object(D.a)(kB,"AutomationTransaction",null,[11]);const ov=()=>Wa.a.instance.resolve("WordEditor.Extension.DocumentFactory").create();var Am=e(2157),My=e(2107),tH=e(2109),bp=e(1857),mf=e(238),YE=e(303),pv=e(553),Tt=e(1474),$C=e(888),Zs=e(2112);class Oq{constructor(d){this.ibl=d;this.hbl=0}syi(){return`${this.ibl}${this.hbl++}`}}Object(D.a)(Oq,"AnnotationItemIdGenerator",
null,[]);class Ih{constructor(d,n,B,Q,ha){this.E3b=d;this.PVo=n;this.ax=B;this.Qha=Q;this.O5b=ha;this.gyk=new Oq("#CP");this.Gsk=new Oq("#AIC");this.Kch="ThirdParty"}PKl(d,n){var B;this.KLp(d,n);const Q=d.node;var ha=this.Lfk(Q,n);const Aa=d.Uj,bb=d.Yp-Aa;if(0>=bb)F.ULS.sendTraceTag(508859913,369,50,"AppId:{0}, range length must be positive.",n.appId);else{var Ib=new ma.a;Ib.add(d);this.PVo.select(Ib,1);Ib=null===(B=Q.characterData)||void 0===B?void 0:B.substring(Aa,Aa+bb);B=gg.a.QI(Q);ha=Object.assign(new Qj.a,
{parentRevId:ha.toString(),parentPath:B.split("\\"),sourceTimestamp:Date.now(),items:[Object.assign(new nv.a,{id:Fi.a.EF?this.gyk.syi():this.XHm(),source:Fi.a.EF?this.Kch:void 0,body:Object.assign(new $C.b,{id:Ze.a.create().toString(),priority:1,context:Ib,startInContext:0,categoryName:Ih.t0d,suggestions:[],range:{start:Aa,length:bb}})})]});this.E3b.submitOperation(ha);ha={};ha.contextId=d.contextId==ed.a.Nd?"textRange":"paragraph";ha.AppId=null===n||void 0===n?void 0:n.appId;F.ULS.sendTraceTag(508863364,
369,50,Rb.c(ha))}}ggn(d,n,B){var Q;const ha=this.Lfk(n,B),Aa=gg.a.QI(n),bb=[],Ib=[];for(const Ac of d){if(0>=Ac.length||0>Ac.start)F.ULS.sendTraceTag(508180510,369,50,`AppId: ${0}, invalid start or length for critique annotation. start: ${Ac.start} length: ${Ac.length}`),pc.a.Cd();const {j$k:ad,h$k:sd,isValid:wd}=this.O9k(n,Ac.start,Ac.length);wd||(F.ULS.sendTraceTag(508126468,369,50,`AppId: ${0},  start or length outside of paragraph. start: ${Ac.start} length: ${Ac.length}`),pc.a.Cd());var oc=null===
(Q=n.characterData)||void 0===Q?void 0:Q.substring(ad,ad+sd);d=Ze.a.create().toString();const yd=B.xk.rK&&Fi.a.TVc?B.xk.rK.$n:B.xk.$n;oc=Object.assign(new nv.a,{id:this.Gsk.syi(),source:this.Kch,body:Object.assign(new $C.a,{id:d,context:oc,priority:3,startInContext:0,categoryName:Ih.v2k,suggestions:[],range:{start:ad,length:sd},addInId:yd,squiggleStyle:Zs.b.Solid,squiggleColor:this.oQn(Ac.colorScheme)})});Ib.push(oc);bb.push(d)}n=Object.assign(new Qj.a,{parentRevId:ha.toString(),parentPath:Aa.split("\\"),
sourceTimestamp:Date.now(),items:Ib});this.E3b.submitOperation(n);return bb}O9k(d,n,B){const {ZVh:Q,isValid:ha}=this.$Ei(d.characterData,0,n+1),{ZVh:Aa,isValid:bb}=this.$Ei(d.characterData,Q,B);return{j$k:Q,h$k:Aa-Q+1,isValid:ha&&bb}}$Ei(d,n,B){let Q=0;for(;Q<B&&n<d.length;)d[n]!==Ed.AParagraphNode.jG&&Q++,n++;return{ZVh:n-1,isValid:Q===B}}Kmm(d){d=gg.a.QI(d);return(d=this.ax.i8d(d))?d.toArray().filter(n=>n.annotationType===$C.a.getTypeName()):[]}KLp(d,n){d.contextId!=ed.a.Nd&&d.contextId!=ed.a.paragraph&&
d.contextId!=ed.a.od&&(F.ULS.sendTraceTag(508863366,369,15,"AppId:{0}, node must be textRange or paragraph.",n.appId),pc.a.Cd())}Lfk(d,n){d=d.ka(Dd.a.kk,0);0===d&&(F.ULS.sendTraceTag(508863365,369,10,"AppId:{0}, cannot read paragraph textId.",n.appId),pc.a.vg());return d}XHm(){const d=Ih.fyk+Ih.cih.toString();Ih.cih++;return d}oQn(d){switch(d){case 0:return Zs.a.Red;case 1:return Zs.a.Green;case 2:return Zs.a.Blue;case 3:return Zs.a.Lavender;case 4:return Zs.a.Berry;default:return Zs.a.None}}CWl(d,
n){if(d)for(const B of d)if(B.contextId!=ed.a.Nd&&B.contextId!=ed.a.paragraph)F.ULS.sendTraceTag(508847651,369,50,"Skipping non-text context {0} for addin {1]",ed.a[B.contextId],n.appId);else if(d=gg.a.QI(B.node),d=this.ax.i8d(d))for(const Q of d)Q.content.categoryName===Ih.t0d&&this.ax.TWa(Q,!1)}aWl(d){this.ax.TWa(d,!1)}y_a(d){d.Zvb||(d=this.ax.y_a(d.id),d.Zvb||pc.a.vg())}QVh(d){this.y_a(d);const n=d.parent;var B=this.Qha.JMa(n,0,Aa=>null!==Aa&&void 0!==Aa&&Aa.intent&&d?Aa.intent.id===d.id:!1);if(1!=
B.count)throw Error("Invalid intent range count, we should get exactly one intent");B=B.K(0);const Q=B.Mc,ha=this.Dnj(n.characterData,0,Q);return{ru:B.Mc-ha,cpEnd:B.end-(ha+this.Dnj(n.characterData,Q,B.end-1))}}Dnj(d,n,B){let Q=0;for(;n<B;)d[n]===Ed.AParagraphNode.jG&&n<d.length&&Q++,n++;return Q}Nea(d,n){this.ax.Nea(d,n);this.O5b.Owe()}}Ih.cih=1;Ih.fyk="#CP";Ih.t0d="CopilotHighlight";Ih.v2k="AddInCritique";Object(D.a)(Ih,"AnnotationOperations",null,[1165]);class Gm{constructor(d,n,B){this.N0l=1;
this.M0l=2;this.Ai=n;this.faa=B;this.Yz=d}getAppRuntimeStartState(){const d=this.faa.QXa(this.Yz);return this.Ai.eKf(d)==am.background?1:0}setAppRuntimeStartState(d){const n=this.faa.QXa(this.Yz);this.Ai.nSj(n,1==d?am.background:am.Jee)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case this.M0l:return this.Aom();case this.N0l:return this.dZo(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Aom(){return this.getAppRuntimeStartState()}dZo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.setAppRuntimeStartState(d);return null}}Object(D.a)(Gm,"AppRuntimePersistenceService",null,[]);class hn{constructor(d,n){this.g3=d;this.faa=n}create(d,n){return new Gm(n,this.g3,this.faa,d)}}Object(D.a)(hn,"AppRuntimePersistenceServiceFactory",null,[]);class ql{constructor(d,n,B){this.Ai=n;this.faa=B;this.Yz=d}getAppRuntimeState(){const d=this.faa.QXa(this.Yz);return this.Ai.g5(d)?2:1}setAppRuntimeState(d){const n=this.faa.QXa(this.Yz);2===d?(d=this.Ai.Lbe(n),d.isForUILessAction=!1,
this.Ai.showTaskPane(n,null,d)):1===d&&this.Ai.qWa(n)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 2:return this.Bom();case 1:return this.eZo(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Bom(){return this.getAppRuntimeState()}eZo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.setAppRuntimeState(d);return null}}Object(D.a)(ql,"AppRuntimeService",null,[]);class $J{constructor(d,n){this.g3=d;this.faa=n}create(d,
n){return new ql(n,this.g3,this.faa,d)}}Object(D.a)($J,"AppRuntimeServiceFactory",null,[]);var ZE=e(1424),Lw=e(325),Ny=e(1840),qv=e(727),rh=e(1381);class uH extends rh.a{constructor(d,n,B,Q){super();this.lD=d;this._context=n;this.Ip=B;this.ff=Q}get content(){return void 0===this.lD.content||null===this.lD.content?{}:this.lD.content}get id(){return this.lD.id}get _ReferenceId(){return this.kp?this.Jp:null}get _State(){return void 0===this.lD.content||null===this.lD.content||void 0===this.lD.content.M_||
null===this.lD.content.M_||void 0===this.lD.content.M_.state||null===this.lD.content.M_.state?0:this.lD.content.M_.state}set _State(d){void 0!==this.lD.content&&null!==this.lD.content&&void 0!==this.lD.content.M_&&null!==this.lD.content.M_||pc.a.vg();this.lD.content.M_.state=d;this.ff.Nea(this.lD,d)}deleteObject(){this.y_a();const d=Object(Uf.a)(qv.a,this.lD.parent);d||pc.a.vg();d.deleteAnnotation(this.lD.content);this._State=70}getParentAsAnnotation(){this.y_a();if(3===this.lD.UZb&&this.lD.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new uH(this.lD.parent,
this._context,this.Ip,this.ff));pc.a.vg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentAsParagraph(){this.y_a();if(2===this.lD.UZb&&this.lD.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Ip.create(this.lD.parent,this._context));pc.a.vg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentType(){this.y_a();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lD.UZb)}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return Fi.a.EF?
"Microsoft.WordServices.AugloopAnnotation":"Microsoft.WordServices.Annotation"}invokePropertyGet(d){switch(d){case 1:return this.content;case 2:return this.id;case 3:return this._ReferenceId;case 4:return this._State}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 4:this._State=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1006:return this.bF(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1005:return this.uLm();case 1004:return this.vLm();case 1003:return this.ELm()}d=
this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}uLm(){return this.getParentAsAnnotation()}vLm(){return this.getParentAsParagraph()}ELm(){return this.getParentType()}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}y_a(){this.lD.Zvb||(this._context.vo.qH(),this._context.vo.ex(),this.lD=this.ff.y_a(this.lD.id),this.lD.Zvb||pc.a.vg())}}Object(D.a)(uH,"Annotation",rh.a,[866]);class iq{constructor(d,
n,B){this.IMe=this.xm=-1;this.jr=B;0<d&&(this.xm+=d);this.IMe=0<n?d+n<this.jr.length()?d+n:this.jr.length():this.jr.length()}get_current(){return this.xm<this.IMe?this.jr._GetItem(this.xm):null}moveNext(){const d=this.iyp();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}iyp(){this.xm++;return this.xm<this.IMe?!0:!1}}Object(D.a)(iq,"ElementEnumerator",null,[910]);class vH extends rh.a{constructor(d,n,B,Q){super();this.C_=this.LPc=null;this.wtk=d;this._context=n;this.ff=B;this.Ip=
Q;B.Cb(this,d)}length(){return this.LPc.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return!this.LPc||0>=this.length()?null:this.getItem(0)}getItem(d){return this._GetItem(d)}refresh(){this._context.vo.qH();this._context.vo.ex();return this.ff.getAnnotationsByType(this.wtk).then(d=>{this.Xkd(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)})}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return Fi.a.EF?"Microsoft.WordServices.AugloopAnnotationCollection":"Microsoft.WordServices.AnnotationCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.A1(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1005:return this.dAo()}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}A1(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}dAo(){return this.refresh()}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}XI(d,n){try{const B=new uH(d,this._context,this.Ip,this.ff);B.$o();this.$o();n===Qj.a.getTypeName()?OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,4,B._ReferenceId):this.C_&&n===Ax.a.getTypeName()?(this.C_.W(d.id,B),OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,
5,B._ReferenceId)):n===ZE.a.getTypeName()&&OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,6,B._ReferenceId);d.annotationType===Lw.a.getTypeName()&&this.nCp(d,n)}catch(B){Ny.a.kfd(B,[d],!1)}}nCp(d,n){n===Qj.a.getTypeName()?Ny.a.QBb(d,32):n===ZE.a.getTypeName()&&Ny.a.QBb(d,64)}_GetItem(d){let n=null;"number"===typeof d?d<this.length()&&(n=this.LPc.K(d)):"string"===typeof d&&(n=d);if(n&&this.C_.Bb(n))return this.C_.K(n);pc.a.Cd();return null}Xkd(d){this.C_=new ff.a;
this.LPc=new ma.a;if(d)for(const n of d)this.LPc.add(n.id),this.C_.add(n.id,new uH(n,this._context,this.Ip,this.ff))}}Object(D.a)(vH,"AnnotationCollection",rh.a,[365,866,893]);class Qz{constructor(d,n){this.ff=d;this.Ip=n}create(d,n){return new vH(d,n,this.ff,this.Ip)}}Object(D.a)(Qz,"AnnotationCollectionFactory",null,[]);var Pq=e(1835);class ao{constructor(){this.Xdh=this.Tib=null;this.Ydh=0;this.SOh=this.zTc=null;this.Wsh=!1}get appId(){return this.Tib}set appId(d){this.Tib=d}get authority(){return this.Xdh}set authority(d){this.Xdh=
d}get authorityType(){return this.Ydh}set authorityType(d){this.Ydh=d}get isAnonymous(){return this.Wsh}set isAnonymous(d){this.Wsh=d}get tenantId(){return this.zTc}set tenantId(d){this.zTc=d}get upn(){return this.SOh}set upn(d){this.SOh=d}getTypeName(){return"Microsoft.Authentication.AuthContext"}invokePropertyGet(d){switch(d){case 4:return this.appId;case 2:return this.authority;case 3:return this.authorityType;case 5:return this.isAnonymous;case 6:return this.tenantId;case 1:return this.upn}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 4:this.appId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.authority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.authorityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 5:this.isAnonymous=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 1:this.upn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}adm(d){this.upn=d.upn;this.authority=d.authority;this.authorityType=d.authorityType;this.tenantId=d.tenantId;this.isAnonymous=d.isAnonymous}}Object(D.a)(ao,"AuthContext",null,[]);var $s=e(1525),$E;(function(d){d[d.unknown=-1]="unknown";d[d.Joq=0]="organizationAccount";d[d.igq=1]="microsoftAccount"})($E||($E={}));Object(D.b)("IdentityType",$E);class Oy{constructor(){this.Ymh=this.Glh=
this.oza=null;this.ELc=0}get displayName(){return this.oza}set displayName(d){this.oza=d}get email(){return this.Glh}set email(d){this.Glh=d}get federationProvider(){return this.Ymh}set federationProvider(d){this.Ymh=d}get identityType(){return this.ELc}set identityType(d){this.ELc=d}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(d){switch(d){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}static nMl(d){const n=new Oy;n.displayName=d.displayName;n.email=d.email;switch(d.authority){case "MicrosoftAccount":n.identityType=
1;break;default:n.identityType=0}n.federationProvider="";return n}}Object(D.a)(Oy,"OfficeIdentityInfo",null,[]);class hw{constructor(d,n,B){this.DJ=null;this._id=d;this._value=n;this.wl=B}get id(){return this._id}get value(){return this._value}set value(d){}getTypeName(){return"Microsoft.Authentication.RoamingSetting"}invokePropertyGet(d){switch(d){case 1:return this.id;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");this.DJ=n[0].toString();return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{if(1===this.wl){let ha,Aa;try{ha=Wa.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager"),
Aa=Wa.a.instance.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),Object(bk.b)()?Object(bk.a)(2,()=>ha.nVc(parseInt(this.DJ)),!1,()=>!0).then(()=>{Aa.aGj();B(null)}).catch(bb=>{F.ULS.sendTraceTag(528859142,3011,10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",bb);Q(bb)}):ha.nVc(parseInt(this.DJ)).then(()=>{Aa.aGj();B(null)}).catch(bb=>{Q(bb)})}catch(bb){Q(bb)}}else 0===this.wl?(Wa.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").nPj(this.DJ),
B(null)):Q(null)})}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(hw,"RoamingSetting",null,[]);class vt{getItem(d){let n,B;if("ridTranscriptionQuotaMinutesUsed"===d)return OfficeExtension.WacRuntime.Utility.createPromise(Q=>{Object(bk.b)()?Object(bk.a)(2,()=>Wa.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").$ab(),
!0,()=>!0).then(ha=>{n=ha.toString();B=1;Q(new hw(d,n,B))}).catch(ha=>{F.ULS.sendTraceTag(528859141,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",ha)}):Wa.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").$ab().then(ha=>{n=ha.toString();B=1;Q(new hw(d,n,B))})});n=Wa.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").i3a;B=0;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new hw(d,n,B))}getItemOrNullObject(){return null}getTypeName(){return"Microsoft.Authentication.RoamingSettingCollection"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1:return this.A1(n);case 2:return this.Uab(n)}d=
this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}Uab(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}}Object(D.a)(vt,"RoamingSettingCollection",null,[]);class Hn{static get yqi(){return Hn.IAk}static nha(d){return d in Hn.yqi?Hn.yqi[d].toString():d}}Hn.map=null;Hn.IAk={["GeneralException"]:WacWordeditorStrings.RichAPIErrorMsg_GeneralException,
["AccessDenied"]:WacWordeditorStrings.RichAPIErrorMsg_AccessDenied,["ApiNotAvailable"]:WacWordeditorStrings.RichAPIErrorMsg_ApiNotAvailable,["UserNotSignedIn"]:WacWordeditorStrings.UserNotSignedIn,["UserAborted"]:WacWordeditorStrings.UserAborted,["UnsupportedUserIdentity"]:WacWordeditorStrings.UnsupoortedUserIdentity,["InvalidResourceUrl"]:WacWordeditorStrings.InvalidResourceUrl,["InvalidGrant"]:WacWordeditorStrings.InvalidGrant,["AddinIsAlreadyRequestingToken"]:WacWordeditorStrings.SSOAddinIsAlreadyRequestingToken,
["ResourceNotAllowed"]:WacWordeditorStrings.SSOResourceNotAllowed,["ClientError"]:WacWordeditorStrings.SSOClientError,["ServerError"]:WacWordeditorStrings.SSOServerError};Object(D.a)(Hn,"SingleSignOnErrorCodeMap",null,[]);class Dr{constructor(d,n){this.tzd=d;this.ELc=n}get accessToken(){return this.tzd}set accessToken(d){this.tzd=d}get tokenIdenityType(){return this.ELc}set tokenIdenityType(d){this.ELc=d}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(d){switch(d){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(Dr,"SingleSignOnToken",null,[]);class Tg{constructor(d,n,B,Q){this.Ai=n;this.Yz=d;this._context=Q}get roamingSettings(){if(!this.Ai.nt.getOsfControl(this.Yz).isFirstParty())throw OfficeExtension.WacRuntime.Utility.createRichApiException($s.a.uMb,
Hn.nha($s.a.uMb));return new vt}getAccessToken(d){const n=this.Ai.nt,B=n.getOsfControl(this.Yz),Q=B.getManifest(),ha=Q.getMarketplaceID(),Aa=Q.getMarketplaceVersion();this.ZL(d,ha,Aa);return OfficeExtension.WacRuntime.Utility.createPromise((bb,Ib)=>{n._enableFirstPartySSO?B.isFirstParty()&&this.$ln(Q,d)?(this._context.vo.qH(),Wa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(d,ha).then(oc=>{this._context.vo.ex();bb(oc)},oc=>{this._context.vo.ex();Ib(oc.toString())})):
Ib($s.a.uMb):Ib($s.a.Zkf)}).then(bb=>{let Ib;switch(bb.authority){case Pq.a.zbo:Ib=1;break;default:Ib=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Dr(bb.accessToken,Ib))},bb=>{this.$Kn(d,ha,bb);return bb?OfficeExtension.WacRuntime.Utility.createPromise((Ib,oc)=>{oc(OfficeExtension.WacRuntime.Utility.createRichApiException(bb,Hn.nha(bb)))}):OfficeExtension.WacRuntime.Utility.createPromise((Ib,oc)=>{oc(OfficeExtension.WacRuntime.Utility.createRichApiException($s.a.nab,Hn.nha($s.a.nab)))})})}getAuthContext(){const d=
this.Ai.nt.getOsfControl(this.Yz).getManifest(),n=d.getMarketplaceID(),B=d.getWebApplicationId();return OfficeExtension.WacRuntime.Utility.createPromise((Q,ha)=>{this._context.vo.qH();Wa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(n).then(Aa=>{this._context.vo.ex();Q(Aa)},Aa=>{this._context.vo.ex();ha(Aa.toString())})}).then(Q=>{const ha=new ao;ha.adm(Q);ha.appId=B;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ha)},Q=>Q?OfficeExtension.WacRuntime.Utility.createPromise((ha,
Aa)=>{Aa(OfficeExtension.WacRuntime.Utility.createRichApiException(Q,Hn.nha(Q)))}):OfficeExtension.WacRuntime.Utility.createPromise((ha,Aa)=>{Aa(OfficeExtension.WacRuntime.Utility.createRichApiException($s.a.nab,Hn.nha($s.a.nab)))}))}getPrimaryIdentityInfo(){const d=this.Ai.nt.getOsfControl(this.Yz).getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{this._context.vo.qH();Wa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(d).then(Q=>
{this._context.vo.ex();n(Q)},Q=>{this._context.vo.ex();B(Q.toString())})}).then(n=>{n=Oy.nMl(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)},n=>n?OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{Q(OfficeExtension.WacRuntime.Utility.createRichApiException(n,Hn.nha(n)))}):OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{Q(OfficeExtension.WacRuntime.Utility.createRichApiException($s.a.nab,Hn.nha($s.a.nab)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(d){switch(d){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1:return this.imm(n);case 3:return this.Nom();
case 2:return this.jNm()}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}imm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,hk);return this.getAccessToken(d)}Nom(){return this.getAuthContext()}jNm(){return this.getPrimaryIdentityInfo()}$ln(d,n){let B=!1;const Q=d.getWebApplicationAuthorizations();d=null;for(const bb of Q)if(bb.getResource().toLowerCase()===n.resource.toLowerCase()){d=bb;B=!0;break}if(!B){var ha="";for(var Aa of Q)ha+=
this.Ngg(Aa.getResource().toLowerCase())+",";ha=ha.substring(0,ha.length-1);F.ULS.sendTraceTag(39362643,369,50,"{0}",Rb.c({["event"]:"AuthenticationService::IsAuthorizationDeclared",["authsLength"]:Q.length,["resources"]:ha}));return!1}Aa=n.scope.split(" ,+");for(ha of Aa)if(""!==ha){Aa=!1;for(const bb of d.getScopes())ha.toLowerCase()===bb.toLowerCase()&&(Aa=!0);if(!Aa)return!1}return!0}ZL(d,n,B){d=this.Ngg(d.resource);F.ULS.sendTraceTag(39102240,369,50,"{0}",Rb.c({["manifestId"]:n,["manifestVersion"]:B,
["resource"]:d}))}$Kn(d,n,B){d=this.Ngg(d.resource);F.ULS.sendTraceTag(39102241,369,10,"{0}",Rb.c({["manifestId"]:n,["resource"]:d,["error"]:B}))}Ngg(d){return(d?d:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(D.a)(Tg,"AuthenticationService",null,[]);class aF{constructor(d,n){this.g3=d;this.Oka=n}create(d,n){return new Tg(n,this.g3,this.Oka,d)}}Object(D.a)(aF,"AuthenticationServiceFactory",null,[]);class Tu extends rh.a{constructor(d){super();pc.a.Pz(d,"FieldCollection");
this.r9b=d}length(){return this.r9b.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return this.r9b&&this.r9b.count?this.r9b.K(0):null}getByTypes(d){const n=new ma.a;for(const B of this.r9b)for(const Q of d)if(B.type===Q){n.add(B);break}return new Tu(n)}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.r9b.K(d);pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.FieldCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg();case 1005:return this.CKf(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}CKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<int>");return this.getByTypes(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(Tu,"FieldCollection",rh.a,[866,893]);class cp extends rh.a{constructor(d){super();pc.a.Pz(d,"InlinePictureCollection");this.XLc=d}length(){return this.XLc.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=
this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){pc.a.yj()||pc.a.Yj();return!this.XLc||0>=this.XLc.count?null:this.XLc.K(0)}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.XLc.K(d);F.ULS.sendTraceTag(16847771,369,10,"The index is out of the paragraph range.");pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.InlinePictureCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(cp,"InlinePictureCollection",rh.a,[866,893]);var yo=e(1450),aD;(function(d){d[d.body=0]="body";d[d.Ata=1]="contentControl";d[d.p4p=
2]="customProperty";d[d.paragraph=3]="paragraph";d[d.range=4]="range";d[d.table=5]="table";d[d.rw=6]="tableRow"})(aD||(aD={}));Object(D.b)("ObjectType",aD);class bD extends rh.a{constructor(d,n,B,Q,ha,Aa,bb){super();this.sac=this.Nlb=null;pc.a.Pz(aD[d],"ListCollection.calledClassName");pc.a.Pz(ha,"ListCollection.requestContext");this.BEb=d;this.Oo=n;this.rf=B;this.jz=Q;this._context=ha;this.So=Aa;this.qb=bb;this.jz&&this._context.jsc&&(this.sac=this.jz.Bpc.create(this.jz.kq))}length(){return this.Nlb.count}_GetItem(d){d=
pc.a.lO(d);if(0<=d&&d<this.length())return this.Nlb.K(d);F.ULS.sendTraceTag(19772865,369,10,"The index is out of the boundary of list in class ListCollection.");pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getById(d){(d=this.getByIdOrNullObject(d))||pc.a.tl();return d}getByIdOrNullObject(d){if(!this.Nlb||!this.length())return null;for(let n=0;n<this.length();n++)if(this.Nlb.K(n).id===d)return this.Nlb.K(n);return null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();
return d}getFirstOrNullObject(){this.Tbk();return this.Nlb&&this.length()?this.Nlb.K(0):null}getItem(d){d=pc.a.lO(d);return this.getById(d)}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){this.Tbk();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.ListCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1002:return this.a5c(n);case 1005:return this.b5c(n);case 1004:return this.JC();case 1006:return this.KC();case 1:return this.A1(n);case 1001:return this.Sg();
case 1003:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}a5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getById(d)}b5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getByIdOrNullObject(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}A1(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Tbk(){let d=null;switch(this.BEb){case 0:d=this.qb.LC(this.Oo,!0,!1);break;case 1:d=this.rf.sH();break;case 4:d=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.jz.qvb?this.jz.qvb.kq:this.sac?this.sac.kq:this.jz.kq:this.jz.kq;break;default:F.ULS.sendTraceTag(19772866,369,15,"AppId:{0}, invalid object type to get the list collection.",
this._context.appId)}this.Nlb=this.So.ayi(d,this._context)}Lnd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.sac&&(this.sac.Jzb(),this.sac=null)}}Object(D.a)(bD,"ListCollection",rh.a,[866,893]);class wt extends rh.a{constructor(d){super();pc.a.Pz(d,"NoteItemCollection");this.XOc=d}length(){return this.XOc.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return this.XOc&&
this.XOc.count?this.XOc.K(0):null}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.XOc.K(d);pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.NoteItemCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(wt,"NoteItemCollection",rh.a,[866,893]);class Zr extends rh.a{constructor(d){super();pc.a.Pz(d,"ParagraphCollection");this.uS=d}length(){return this.uS.count}get _ReferenceId(){return this.kp?
this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){pc.a.yj()||pc.a.Yj();return this.uS&&this.uS.count?this.uS.K(0):null}getLast(){const d=this.getLastOrNullObject();d||pc.a.tl();return d}getLastOrNullObject(){pc.a.yj()||pc.a.Yj();return this.uS&&this.uS.count?this.uS.K(this.uS.count-1):null}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.uS.K(d);F.ULS.sendTraceTag(16795330,369,10,"The index is out of the paragraph range.");pc.a.Cd();return null}getById(d){(d=
this.getByIdOrNullObject(d))||pc.a.tl();return d}getByIdOrNullObject(d){var n;if(!d||!this.uS||!this.uS.count)return null;const B=this.uS.getEnumerator();for(;B.moveNext();){const Q=B.get_current();if((null===(n=Q.Hua())||void 0===n?void 0:n.id.toString())===d)return Q}return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.ParagraphCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1005:return this.KC();case 1004:return this.mEm();case 1006:return this.pEm();case 1007:return this.a5c(n);
case 1008:return this.b5c(n);case 1:return this.wM(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}mEm(){return this.getLast()}pEm(){return this.getLastOrNullObject()}a5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getById(d)}b5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByIdOrNullObject(d)}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(Zr,"ParagraphCollection",rh.a,[866,893]);class Qq extends rh.a{constructor(d,n,B,Q,ha,Aa){super();this.udc=this._tables=null;this.BEb=d;this.rKb=n;this.jz=B;this.rf=
Q;this._context=ha;this.yd=Aa;this.jz&&this._context.jsc&&(this.udc=this.jz.Bpc.create(this.jz.kq))}length(){return this._tables.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){this.gek();return this._tables&&this.length()?this._tables.K(0):null}_GetItem(d){d=pc.a.lO(d);if(d<this._tables.count)return this._tables.K(d);F.ULS.sendTraceTag(19969492,369,10,"The index is out of the table collection range.");
pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){this.gek();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.TableCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}gek(){switch(this.BEb){case 0:case 5:this._tables=this.yd.jUm(this.rKb,this._context);break;case 1:var d=this.rf.sH();this._tables=this.yd.rNi(d.K(0),d.K(d.count-1),this._context);break;case 4:d=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.jz.qvb?this.jz.qvb.kq:this.udc?this.udc.kq:this.jz.kq:this.jz.kq;
this._tables=this.yd.rNi(d.K(0),d.K(d.count-1),this._context);break;default:F.ULS.sendTraceTag(19969493,369,15,"AppId:{0}, invalid object type to get the table collection.",this._context.appId)}}Lnd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.udc&&(this.udc.Jzb(),this.udc=null)}}Object(D.a)(Qq,"TableCollection",rh.a,[866,893]);class Mw extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib){super();this.tef=null;this.BEb=d;this.rKb=n;this.jz=B;this.rf=Q;this._context=ha;
this.lz=Aa;this.qb=bb;this.Am=Ib;this.jz&&this._context.jsc&&(this.tef=this.jz.Bpc.create(this.jz.kq))}length(){return this.lVa.count}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.lVa.K(d);pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}acceptAll(){for(const d of this.lVa)d.accept()}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){this.tek();return this.lVa&&0<this.lVa.count?this.lVa.K(0):null}rejectAll(){for(const d of this.lVa)d.reject()}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){this.tek();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.TrackedChangeCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1006:return this.GZk();case 1004:return this.JC();case 1005:return this.KC();case 1:return this.wM(n);case 1007:return this.QEo();case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}GZk(){this.acceptAll();
return null}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}QEo(){this.rejectAll();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}tek(){switch(this.BEb){case 3:var d=new ma.a,n=ge.a.create(this.rKb);d.add(n);this.lVa=this.lz.sOi(d,this._context);break;case 0:new ma.a;d=this.qb.LC(this.rKb,!0,!1);this.lVa=this.lz.sOi(d,this._context);break;case 1:var B=
this.rf.sH();d=this.Am.mSb(B,5);if(B&&d&&0<B.count&&0<d.count){n=B.K(0);B=B.K(B.count-1);const Q=d.K(0),ha=d.K(d.count-1);Q.Ob=n.Ob+1;ha.nc=B.nc-1}this.lVa=this.lz.tOi(d,this._context);break;case 4:d=G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.jz.qvb?this.jz.qvb.kq:this.tef?this.tef.kq:this.jz.kq:this.jz.kq;this.lVa=this.lz.tOi(d,this._context);break;default:F.ULS.sendTraceTag(508123031,369,15,"AppId:{0}, invalid object type to get the trackedChange collection.",this._context.appId)}}}
Object(D.a)(Mw,"TrackedChangeCollection",rh.a,[866,893]);class Uu extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk){super();pc.a.ARa(d,"Body");this.Oo=d;this._context=n;this.Ip=B;this.Jk=Q;this.ME=ha;this.lQ=Aa;this.xAa=bb;this.td=Ib;this.Uqa=oc;this.qb=Ac;this.Wr=ad;this.yD=sd;this.nd=wd;this.Xz=yd;this.uh=be;this.wD=ye;this.fz=Qe;this.Am=af;this.yd=Qf;this.So=hf;this.qv=di;this.lz=vj;this.Tz=Wk}get s0h(){return this.Oo}get contentControls(){const d=new Ei;
d.types=[31];return this.getContentControls(d)}get endnotes(){var d=new ma.a;switch(this.type){case 4:case 1:case 0:d.addRange(this.nd.omc(this.Oo,1));break;case 2:case 3:case 5:case 6:return null}d=this.nd.fCa(d,this._context);return new wt(d)}get fields(){const d=new ma.a;switch(this.Oo.type){case 8:case 10:case 36:case 16:case 38:case 37:const n=this.qb.ox(this.Oo,!0,!1),B=n.count;for(let Q=0;Q<B;Q++){const ha=this.Tz.lmc(n.K(Q),this._context,!0);d.addRange(ha)}break;default:F.ULS.sendTraceTag(539530944,
369,10,"AppId:{0}, in function Body.Fields, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),pc.a.vg()}return new Tu(d)}get font(){return this.ME.create(0,this.Oo,null,null,this._context)}get footnotes(){var d=new ma.a;switch(this.type){case 4:case 1:case 0:d.addRange(this.nd.omc(this.Oo,0));break;case 2:case 3:case 5:case 6:return null}d=this.nd.fCa(d,this._context);return new wt(d)}get inlinePictures(){var d=this.qb.ox(this.Oo,
!0,!1);let n=0;const B=new ma.a;for(const Q of d){d=new ma.a;this.Xz.UNf(d,Q);for(const ha of d)B.add(this.lQ.create(ha,this._context,n++))}return new cp(B)}get lists(){return pc.a.yj()?new bD(0,this.Oo,null,null,this._context,this.So,this.qb):null}get paragraphs(){const d=this.qb.ox(this.Oo,!0,!1);let n=0;const B=new ma.a;for(const Q of d)B.add(this.Ip.create(Q,this._context,n++));return new Zr(B)}get parentBody(){if(!pc.a.yj())return null;const d=this.parentBodyOrNullObject;d||pc.a.tl();return d}get parentBodyOrNullObject(){return pc.a.yj()?
this.yd.JPf(this.Oo,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||pc.a.tl();return d}get parentContentControlOrNullObject(){const d=ge.a.create(this.Lua(!0)),n=ge.a.create(this.Lua(!1));this.nd.pRa(d,n);return this.uh.xnc(d,n,this._context)}get parentSection(){if(!pc.a.yj())return null;const d=this.parentSectionOrNullObject;d||pc.a.tl();return d}get parentSectionOrNullObject(){if(!pc.a.yj())return null;const d=this.td.Ag(this.Oo);let n=null;switch(this.Oo.type){case 16:case 36:d.Ib(10)&&
(n=d.Gq(10));break;case 10:n=this.Oo;break;case 8:1===d.Bs()&&(n=d.ue())}return n?this.xAa.create(n,this._context):null}get style(){const d=this.qb.LC(this.Oo,!0,!1);return this.yD.b6c(d)}set style(d){const n=this.qb.LC(this.Oo,!0,!1);this.yD.Ozc(n,d)}get styleBuiltIn(){if(!pc.a.yj())return-1;const d=this.qb.LC(this.Oo,!0,!1);return this.yD.U9d(d)}set styleBuiltIn(d){pc.a.yj()||pc.a.Yj();const n=this.qb.LC(this.Oo,!0,!1);this.yD.ZAe(n,d)}get tables(){return pc.a.yj()?new Qq(0,this.Oo,null,null,this._context,
this.yd):null}get text(){let d="";switch(this.Oo.type){case 8:case 10:case 36:case 16:case 38:case 37:const n=this.qb.ox(this.Oo,!0,!1),B=n.count;for(let Q=0;Q<B;Q++)d+=this.qb.e_b(n.K(Q)),Q<B-1&&(d+=pc.a.dtc);break;default:F.ULS.sendTraceTag(16814427,369,10,"AppId:{0}, in function Body.Text, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),pc.a.vg()}return d}get type(){if(!pc.a.yj())return-1;switch(this.Oo.type){case 8:return 0;
case 10:const d=this.td.Ag(this.Oo);d.Ib(8);d.xd(8);return 1===d.Bs()?0:1;case 36:switch(this.Oo.properties.getValue(Dd.a.moc)){case 0:case 2:case 1:return 2;case 3:case 5:case 4:return 3;default:return-1}case 16:return 4;case 38:return 7;case 37:return 1==this.Oo.getValue(Dd.a.Q8)?5:6;default:return-1}}get _ReferenceId(){return this.kp?this.Jp:null}clear(){const d=(new Date).getTime(),n=this.qb.LC(this.Oo,!0,!1);pc.a.hEc(n,"Body.Clear");this.nd.qRa(n.K(0));this.nd.qRa(n.K(n.count-1));if(8===this.Oo.type&&
1<vc.a.kb(this.Oo).Bs())return OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{this.nd.Fxl(n,this._context,B,Q,d)});this.nd.sOb(n);pc.a.gHf()||(5===this.type||6===this.type)&&this.insertText(" ",2);pc.a.lR("Body.Clear",pc.a.WR(d));return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getComments(){if(0===this.type)return this.qv.lnm(this._context);if(1===this.type)return this.qv.Qsm(this.Oo,this._context);const d=this.qb.LC(this.Oo,!0,!1);return this.qv.Q8d(d,this._context)}getContentControls(d){var n;
d=null!==(n=null===d||void 0===d?void 0:d.types)&&void 0!==n?n:[];pc.a.s2c(d);n=this.uh.cTm(this.Oo,this._context);return 0===d.length?n:null===n||void 0===n?void 0:n.getByTypes(d)}getHtml(){const d=this.qb.LC(this.Oo,!0,!1);return this.fz.getHtml(d.toArray(),this._context)}getOoxml(){const d=(new Date).getTime();this._context.vo.qH();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{const Q=this.qb.LC(this.Oo,!0,!1);this.fz.getOoxml(Q,this._context,n,B,d)})}getReviewedText(d){let n=
"";switch(this.Oo.type){case 8:case 10:case 36:case 16:case 38:case 37:const B=this.qb.ox(this.Oo,!0,!1),Q=B.count;for(let ha=0;ha<Q;ha++)n+=this.lz.abe(B.K(ha),d);break;default:F.ULS.sendTraceTag(545005571,369,10,"NodeType:{0} is not supported to get the reviewed text.",this.Oo.type)}return n}getTrackedChanges(){return new Mw(0,this.Oo,null,null,this._context,this.lz,this.qb,this.Am)}getRange(d){pc.a.yj()||pc.a.Yj();let n=new ma.a;d&&5!==d?1===d?n.add(ge.a.create(this.Lua(!0))):2===d||4===d?n.add(ge.a.create(this.Lua(!1))):
(F.ULS.sendTraceTag(18745291,369,15,"AppId:{0}, rangeLocation of Body.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.Cd()):n=this.qb.LC(this.Oo,!0,!1);this.Am.IAe(n);return(d=this.Am.mSb(n,d))?this.Jk.create(d,this._context):null}insertBreak(d,n){const B=(new Date).getTime(),Q=new ma.a;this.nd.k5f(this.Oo)&&6!==d&&pc.a.zE();switch(n){case 2:var ha=!1;d||(ha=!0);ha=this.qb.Vn(this.Oo,!0,ha);Q.add(ge.a.create(ha));break;case 3:ha=this.Lua(!1);Q.add(ge.a.create(ha));break;
default:F.ULS.sendTraceTag(17179034,369,15,"AppId:{0}, insertLocation of Body.InsertBreak must be Start or End.",this._context.appId),pc.a.Cd()}6===d?this.nd.pRa(Q.K(0),Q.K(0)):Q.K(0).contextId!==ed.a.table&&(ha=this.nd.Q9a(Q.K(0).node,2===n),Q.W(0,ha));return OfficeExtension.WacRuntime.Utility.createPromise((Aa,bb)=>{this.nd.insertBreak(Q,d,n,this._context,Aa,bb,B)})}insertContentControl(d){pc.a.XDf(d,"Body");d=pc.a.$ud(d,0);8!==d||pc.a.fka||pc.a.Cd();const n=this.nd.eic(this.Lua(!0),!0),B=this.nd.eic(this.Lua(!1),
!1);return this.uh.Msa(n,B,this._context,d)}insertFileFromBase64(d,n){"<"===d.charAt(0)&&(F.ULS.sendTraceTag(18130831,369,10,"invalid argument for insertFileFromeBase64 API in Body class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!1)}insertHtml(d,n){const B=(new Date).getTime();let Q=new ma.a;var ha=2;switch(n){case 2:case 3:ha=this.Lua(2===n);Q.add(ge.a.create(ha));ha=2===n?0:1;break;case 4:return Q=this.qb.LC(this.Oo,!0,!1),pc.a.hEc(Q,"Body.InsertHtml"),this.clear().then(()=>this.insertHtml(d,
2));default:pc.a.Cd()}this.nd.pRa(Q.K(0),Q.K(Q.count-1),ha);return this.fz.insertHtml(Q,d,n,B,this._context)}insertInlinePictureFromBase64(d,n){const B=(new Date).getTime();2!==n&&3!==n&&(F.ULS.sendTraceTag(17433734,369,50,"AppId:{0}, insert inline picture with none supported location in Body class",this._context.appId),pc.a.Cd());const Q=ge.a.create(this.Lua(2===n));let ha=null;this.nd.pRa(Q,Q);({yN:ha}=this.nd.bP(Q,Q,n));let Aa;this.nd.DY((Aa=new ma.a,Aa.add(ha),Aa),n,0);return this.Xz.WUb(d,ha,
this._context).then(bb=>{this._context.vo.ex(this.Oo);if(!bb)return F.ULS.sendTraceTag(17433736,369,10,"AppId:{0}, something went wrong when insert iamge into Body.",this._context.appId),pc.a.lR("Body.InsertInlinePictureFromBase64",pc.a.WR(B),d.length,!1),pc.a.vg(),null;pc.a.lR("Body.InsertInlinePictureFromBase64",pc.a.WR(B),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lQ.create(this.Xz.t3c(bb),this._context))})}insertOoxml(d,n){"<"!==d.charAt(0)&&(F.ULS.sendTraceTag(18130832,
369,10,"invalid argument for InsertOoxml API in Body class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!0)}insertParagraph(d,n){var B=!1,Q=null;switch(n){case 2:n=0;Q=this.qb.Vn(this.Oo,!0,!0);B=!0;break;case 3:n=1;Q=this.qb.vH(this.Oo,!0,!0);B=!1;break;default:F.ULS.sendTraceTag(17319647,369,15,"AppId:{0}, Invalid insert location for Body.InsertPparagraph method.",this._context.appId),pc.a.Cd()}Q||pc.a.vg();if(14===Q.type){let Aa;var ha=this.yd.q$d((Aa=new ma.a,Aa.add(ge.a.create(Q)),Aa),
B);d=pc.a.MZc(d);let bb;this.nd.insertText((bb=new ma.a,bb.add(ge.a.jd(ha.node,0)),bb),d,n);B=ha.node}else Q=this.nd.Q9a(Q,B),B=this.nd.insertParagraph((ha=new ma.a,ha.add(Q),ha),d,n);return this.Ip.create(B,this._context)}insertTable(d,n,B,Q){pc.a.yj()||pc.a.Yj();const ha=new ma.a;var Aa=!1;let bb=null;switch(B){case 2:B=0;bb=this.qb.Vn(this.Oo,!0,!0);Aa=!0;break;case 3:B=1;bb=this.qb.vH(this.Oo,!0,!0);Aa=!1;break;default:F.ULS.sendTraceTag(19951649,369,15,"AppId:{0}, Invalid insert location for Body.InsertTable method.",
this._context.appId),pc.a.Cd()}bb||pc.a.vg();14===bb.type?ha.add(ge.a.create(bb)):(Aa=this.nd.Q9a(bb,Aa),ha.add(Aa));return this.yd.insertTable(ha,d,n,B,Q,this._context)}insertText(d,n){var B=new ma.a;switch(n){case 2:case 3:const Q=this.Lua(2===n);B.add(ge.a.create(Q));this.nd.pRa(B.K(0),B.K(B.count-1));break;case 4:(B=this.parentContentControlOrNullObject)&&B.clear();B=this.qb.LC(this.Oo,!0,!1);this.nd.Cx(B.K(0));this.nd.Cx(B.K(B.count-1));break;default:F.ULS.sendTraceTag(21284487,369,15,"AppId:{0}, undefined location for Body.InsertText: {1}.",
this._context.appId,yo.a[n]),pc.a.Cd()}this.nd.DY(B,n,0);return this.zin(B,d,n)}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Oo,!0,!1);this.wD.find(Q,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Oo,!0,!1);this.wD.msb(Q,d,n,B,this._context)})}select(d){const n=this.qb.LC(this.Oo,!0,!1);this.Wr.select(n,d)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.Oo,"Body")}getTypeName(){return"Microsoft.WordServices.Body"}invokePropertyGet(d){switch(d){case 3:return this.contentControls;
case 19:return this.endnotes;case 20:return this.fields;case 5:return this.font;case 18:return this.footnotes;case 7:return this.inlinePictures;case 11:return this.lists;case 2:return this.paragraphs;case 10:return this.parentBody;case 16:return this.parentBodyOrNullObject;case 4:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 13:return this.parentSection;case 17:return this.parentSectionOrNullObject;case 6:return this.style;case 14:return this.styleBuiltIn;
case 12:return this.tables;case 8:return this.text;case 9:return this.type;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 6:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 14:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1019:return this.qSb();case 1021:return this.zMa(n);case 1013:return this.GSb();case 1016:return this.rha(n);case 1020:return this.uTb(n);case 1007:return this.tNa(n);case 1006:return this.lva(n);case 1017:return this.hcb(n);case 1003:return this.vNa(n);
case 1015:return this.lja(n);case 1002:return this.Sg();case 1001:return this.Tg();case 1022:return this.ITb()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1011:return this.IKa();case 1014:return this.fTb();case 1009:return this.Ybb(n);case 1008:return this.jva(n);case 1004:return this.acb(n);case 1010:return this.bcb(n);case 1005:return this.fcb(n);case 1012:return this.zxa(n);case 1018:return this.Hqa(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}IKa(){return this.clear()}qSb(){return this.getComments()}zMa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}GSb(){return this.getHtml()}fTb(){return this.getOoxml()}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}uTb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}ITb(){return this.getTrackedChanges()}Ybb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertBreak(n,d)}tNa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.insertContentControl(d)}jva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(n,d)}acb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");
return this.insertHtml(n,d)}bcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(n,d)}fcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(n,d)}lva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}hcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(n,B,Q,d)}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(n,d)}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.select(d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Lua(d){const n=vc.a.kb(this.Oo);var B=null;switch(this.Oo.type){case 8:B=Uu.WMf(n,10,d);n.yk(B);B=Uu.WMf(n,23,d);break;case 10:B=Uu.WMf(n,23,d);break;case 36:case 16:case 38:case 37:B=n.currentNode;break;default:F.ULS.sendTraceTag(16814430,369,10,"AppId:{0}, In function Body.GetLowestLayerOffSpringParagraphNode(). Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",
this._context.appId),pc.a.vg()}return this.bGm(B,d)}bGm(d,n){let B=null;if(d&&(23===d.type||36===d.type||16===d.type||38===d.type||37===d.type)){d=vc.a.kb(d);let Q,ha;do if(Q=d.currentNode,ha=n?d.dw(2)?d.ic(2):d.ue():d.dw(2)?d.vN(2):d.g9(),Q&&ha&&11===Q.type&&12===ha.type){B=ha;break}while(d.currentNode&&d.hasChildren())}return B}zin(d,n,B){if(void 0===n||null===n)return null;var Q=2===B?d.K(0):d.K(d.count-1);const ha=3!==B?!0:!1;n=pc.a.lBc(n);let Aa=null;const bb=this.Lua(ha);if(bb){var Ib=null;
switch(B){case 2:Aa=n.pop();d=0;this.nd.kbd(bb)&&(Ib=this.nd.L9d(bb),-1!==Ib&&(d=Ib+2>this.qb.textLength(bb)?this.qb.textLength(bb):Ib+2));Ib=ge.a.jd(bb,d);Ib.Ob=Ib.nc=Q.rp();this.Uqa.lf(Ib,Aa);Aa.length?(Ib=ge.a.createTextRange(bb,d,d+Aa.length),this.nd.Cx(Ib,2)):(Ib=ge.a.jd(bb,0),Ib.Ob=Ib.nc=Q.rp());break;case 3:Aa=n.shift();Ib=ge.a.uz(bb);Ib.Ob=Ib.nc=Q.vp();this.Uqa.lf(Ib,Aa);Aa.length?(Ib=ge.a.createTextRange(bb,bf.ParagraphReader.textLength(bb)-Aa.length,bf.ParagraphReader.textLength(bb)),this.nd.Cx(Ib,
2)):(Ib=ge.a.uz(bb),Ib.Ob=Ib.nc=Q.vp());break;case 4:Aa=n.pop(),Ib=this.Cin(d,Aa,bb)}Q=this.nd.cH(n,Ib.node,ha);2===B?(0<Aa.length||!Aa.length&&!n.length)&&Q.add(Ib):3===B?(0<Aa.length||!Aa.length&&!n.length)&&Q.insert(0,Ib):Q.add(Ib);return this.Jk.create(Q,this._context)}return null}Cin(d,n,B){8===this.Oo.type&&1<vc.a.kb(this.Oo).Bs()&&(F.ULS.sendTraceTag(18667733,369,15,"AppId:{0}, Body.InsertText cannot replace the content of the document that contains multiple sections.",this._context.appId),
pc.a.zE());B=B.ra;B&&B.length||(F.ULS.sendTraceTag(20030220,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty before replacing the body.",this._context.appId),pc.a.vg());B=B.first.rta(null);this.nd.sOb(d);d=this.Lua(!0);var Q=d.ra;Q&&Q.length||(F.ULS.sendTraceTag(20030221,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty after replacing the body.",this._context.appId),pc.a.vg());Q.jc(0).formatting=B.formatting.og(Q.jc(0));B=0;this.nd.kbd(d)&&(Q=this.nd.L9d(d),-1!==Q&&(pc.a.gHf()?
B=Q+2:(B=Q+1,n=" "+n)));Q=ge.a.jd(d,B);const ha=this.qb.nn(d,0);Q.Ob=Q.nc=0<ha?ha/2:-1;this.Uqa.lf(Q,n);d=n.length?ge.a.createTextRange(d,B,B+n.length):ge.a.jd(d,B);d.Ob=Q.rp();d.nc=n.length?0<ha?0:-1:Q.vp();return d}Wna(d,n,B){const Q=(new Date).getTime();let ha=new ma.a;switch(n){case 2:case 3:const Aa=this.Lua(2===n);ha.add(ge.a.create(Aa));break;case 4:ha=this.qb.LC(this.Oo,!0,!1);break;default:F.ULS.sendTraceTag(18130833,369,15,"AppId:{0}, invalid insert location for body's insert Ooxml or insert Docx method",
this._context.appId),pc.a.Cd()}this.nd.pRa(ha.K(0),ha.K(ha.count-1));return OfficeExtension.WacRuntime.Utility.createPromise((Aa,bb)=>{this.fz.insertOoxml(ha,d,n,this.Oo,this._context,Aa,bb,Q,B?0:1)})}static WMf(d,n,B){let Q=null;if(d)if(B&&d.ue()){do if(d.currentNode.type===n){Q=d.currentNode;break}while(d.xl());d.Ac()}else if(!B&&d.g9()){do if(d.currentNode.type===n){Q=d.currentNode;break}while(d.cR());d.Ac()}return Q}}Object(D.a)(Uu,"Body",rh.a,[866]);class cD{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,
Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf){this.xAa=null;this.Ip=d;this.Jk=n;this.ME=B;this.lQ=Q;this.td=ha;this.Uqa=Aa;this.qb=bb;this.Wr=Ib;this.yD=oc;this.nd=Ac;this.Xz=ad;this.uh=sd;this.wD=wd;this.fz=yd;this.Am=be;this.yd=ye;this.So=Qe;this.qv=af;this.lz=Qf;this.Tz=hf}Vu(d){this.xAa=d}create(d,n){return new Uu(d,n,this.Ip,this.Jk,this.ME,this.lQ,this.xAa,this.td,this.Uqa,this.qb,this.Wr,this.yD,this.nd,this.Xz,this.uh,this.wD,this.fz,this.Am,this.yd,this.So,this.qv,this.lz,this.Tz)}}Object(D.a)(cD,"BodyFactory",
null,[1011]);var tu=e(955);class bF extends rh.a{constructor(d,n){super();this.rf=d;this.uh=n}get isChecked(){return this.rf.isChecked}set isChecked(d){null!==d&&this.rf.isChecked!==d&&(this.uh.evd(this.rf),tu.a.DEa(this.rf.objectId))}getTypeName(){return"Microsoft.WordServices.CheckboxContentControl"}invokePropertyGet(d){switch(d){case 1:return this.isChecked}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
n){switch(d){case 1:this.isChecked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(D.a)(bF,"CheckboxContentControl",rh.a,[866]);class dD{constructor(){this.uh=null}Vu(d){this.uh=d}create(d){return new bF(d,this.uh)}}Object(D.a)(dD,"CheckboxContentControlFactory",null,[1011]);var Py=e(689);class vs extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib){super();pc.a.hEc(d,"CommentContentRange");this.Ud=d;this.hY=n;this.nd=B;this.p4a=Q;this.sra=ha;this.Am=Aa;this.qv=bb;this.Yr=Ib}get bold(){const d=this.v1();return d.SWc?null:1===d.bold}set bold(d){pc.a.Pz(d,"Font.Bold");this.Yr.Wu(this.uma().currentNode)?
d!=this.bold&&(d=d?new Py.a(1):new Py.a(0),this.sra.mGa(this.Ud,Se.a.bold,d),this.HOb()):pc.a.lCb()}get hyperlink(){const d=this.Am.utb(this.Ud).returnValue;return d&&d.length?d[0].hyperlink.url:null}set hyperlink(d){this.Yr.Wu(this.uma().currentNode)?(this.Am.$Tj(this.Ud,d,!1,this.hY),this.HOb()):pc.a.lCb()}get italic(){const d=this.v1();return d.ksc?null:1===d.italic}set italic(d){pc.a.Pz(d,"Font.Italic");this.Yr.Wu(this.uma().currentNode)?d!=this.italic&&(d=d?new Py.a(1):new Py.a(0),this.sra.mGa(this.Ud,
Se.a.cC,d),this.HOb()):pc.a.lCb()}get isEmpty(){return this.text===pc.a.dtc}get text(){return this.Am.EJi(this.Ud,this.hY)}get strikeThrough(){const d=this.v1();return d.xBc?null:1===d.strikethrough}set strikeThrough(d){pc.a.Pz(d,"Font.StrikeThrough");this.Yr.Wu(this.uma().currentNode)?d!=this.strikeThrough&&(d=d?new Py.a(1):new Py.a(0),this.sra.mGa(this.Ud,Se.a.strikethrough,d),this.HOb()):pc.a.lCb()}get underline(){const d=this.v1();return d.oX?-1:[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0][d.underlineType]}set underline(d){this.Yr.Wu(this.uma().currentNode)?
d!==this.underline&&(0===d?(this.sra.mGa(this.Ud,Se.a.Lpa,17),this.HOb()):1===d?(this.sra.mGa(this.Ud,Se.a.Lpa,0),this.HOb()):pc.a.Cd()):pc.a.lCb()}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){return this.$o()}_OnAccess(){pc.a.hEc(this.Ud,"CommentContentRange");for(const d of this.Ud)pc.a.Y2(d.node,"CommentContentRange")}insertText(d,n){if(this.Yr.Wu(this.uma().currentNode)){var B=new vc.a;B.set(this.Ud.K(0).node);B.Ib(40);B.xd(40);d=1<pc.a.lBc(d).length?this.nd.uhn(this.Ud,d,n):
this.nd.insertText(this.Ud,d,n);n=d.count;var Q=d.K(n-1);Q.contextId===ed.a.paragraph&&(Q=ge.a.createTextRange(Q.node,0,bf.ParagraphReader.textLength(Q.node)),d.removeAt(n-1),d.add(Q));d.K(0).contextId===ed.a.od&&d.removeAt(0);d=this.p4a.create(d,this.hY);({startIndex:n,endIndex:Q}=d.ZDi(B));this.HOb();d.WVh(B,n,Q);return d}pc.a.lCb()}getTypeName(){return"Microsoft.WordServices.CommentContentRange"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId;case 3:return this.isEmpty;case 4:return this.hyperlink;
case 2:return this.text;case 5:return this.bold;case 6:return this.italic;case 7:return this.strikeThrough;case 8:return this.underline}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 4:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 7:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1001:return this.Sg();case 1002:return this.Tg();case 1003:return this.vNa(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertText(n,d)}v1(){const d=this.sra.v1(this.Ud);d||pc.a.vg();return d}ZDi(d){let n=-1,B=-1;const Q=d.Bs();if(0<Q){d.ue();for(let ha=0;ha<Q;ha++)d.ue(),d.currentNode.id==this.Ud.K(0).node.id&&(n=ha),d.currentNode.id==this.Ud.K(this.Ud.count-1).node.id&&(B=ha),d.Ac(),d.xl()}d.Ib(40);d.xd(40);return{startIndex:n,endIndex:B}}WVh(d,n,B){const Q=new ma.a;if(0<d.Bs()){d.ue();for(let Aa=0,bb=0;Aa<B+1;Aa++,bb++){d.ue();if(Aa>=n&&Aa<B+1){var ha=this.Ud.K(bb-n);if(ha.contextId===ed.a.od){Aa--;
ha=Q.K(Q.count-1).node;Q.add(ge.a.Pm(ha));continue}else ha.contextId===ed.a.Nd?Q.add(ge.a.createTextRange(d.currentNode,ha.Uj,ha.Yp)):ha.contextId===ed.a.paragraph&&Q.add(ge.a.create(d.currentNode))}d.Ac();d.xl()}d.Ib(40);d.xd(40);this.Ud=Q}}HOb(){const d=this.uma();let n=-1,B=-1;({startIndex:n,endIndex:B}=this.ZDi(d));this.qv.lDl(d.currentNode);this.WVh(d,n,B)}kq(){return this.Ud}uma(){const d=new vc.a;d.set(this.Ud.K(0).node);d.Ib(40);d.xd(40);return d}}Object(D.a)(vs,"CommentContentRange",rh.a,
[866]);class wH{constructor(d,n,B,Q){this.nd=d;this.sra=n;this.Am=B;this.Yr=Q}Vu(d){this.qv=d}create(d,n){return new vs(d,n,this.nd,this,this.sra,this.Am,this.qv,this.Yr)}}Object(D.a)(wH,"CommentContentRangeFactory",null,[1011]);class Rz extends rh.a{constructor(d){super();pc.a.Pz(d,"CommentReplyCollection");this.L7b=d}length(){return this.L7b.count}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.L7b.K(d);pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=
this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return this.L7b&&0<this.L7b.count?this.L7b.K(0):null}getItem(d){d=pc.a.lO(d);return d<this.length()?this.L7b.K(d):null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.CommentReplyCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.A1(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(Rz,"CommentReplyCollection",rh.a,[866,893]);class xH extends rh.a{constructor(d,n,B,Q,ha,Aa,bb){super();pc.a.Pz(d,"Comment GraphNodeContext");
this.dfa=d;this.hY=n;this.qv=B;this.Jk=Q;this.CBd=ha;this.p4a=Aa;this.qb=bb}get authorEmail(){return this.qv.CAi(this.dfa)}get authorName(){return this.dfa.getValue(Dd.a.y9a)}get content(){return this.qv.DAi(this.dfa)}set content(d){this.qv.zCg(d,this.dfa,!0)}get contentRange(){const d=vc.a.kb(this.dfa),n=d.Bs(),B=new ma.a;if(0<n){d.ue();for(let Q=0;Q<n;Q++)d.ue(),Q===n-1?B.add(ge.a.createTextRange(d.currentNode,0,this.qb.textLength(d.currentNode))):B.add(ge.a.create(d.currentNode)),d.Ac(),d.xl()}return this.p4a.create(B,
this.hY)}set contentRange(d){this.qv.SSj(d,this.dfa)}get creationDate(){return this.dfa.getValue(Dd.a.wta)}get id(){return this.dfa.getValue(Dd.a.KI)}get _ReferenceId(){return this.kp?this.Jp:null}get replies(){var d=this.qv.$sm(this.dfa);const n=new ma.a;for(const B of d)d=this.CBd.create(B,this.hY),n.add(d);return new Rz(n)}get resolved(){return this.dfa.ka(Dd.a.zga,!1)}set resolved(d){this.qv.COo(this.dfa,d)}reply(d){if(this.resolved)pc.a.zE();else return d=this.qv.m4k(this.dfa,d),this.CBd.create(d,
this.hY)}deleteObject(){this.qv.deleteComment(this.dfa)}getRange(){const d=this.qv.aDa(this.dfa),n=new ma.a;for(let B=0;B<d.length;B++){const Q=d.K(B);n.add(Q)}return this.Jk.create(n,this.hY)}_KeepReference(){return this.$o()}_OnAccess(){pc.a.Y2(this.dfa,"Comment")}getTypeName(){return"Microsoft.WordServices.Comment"}invokePropertyGet(d){switch(d){case 1:return this.authorEmail;case 2:return this.authorName;case 3:return this.content;case 9:return this.contentRange;case 4:return this.creationDate;
case 7:return this.replies;case 8:return this.resolved;case 5:return this.id;case 6:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 8:this.resolved=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 9:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,vs);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1001:return this.rha(n);case 1002:return this.dMo(n);case 1003:return this.bF(n);case 1005:return this.Sg();case 1004:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}rha(){return this.getRange()}dMo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.reply(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(xH,"Comment",rh.a,[866]);class Qy{constructor(d,n,B){this.qv=this.Jk=null;this.CBd=d;this.p4a=n;this.qb=B}Vu(d,n){this.Jk=d;this.qv=
n}create(d,n){return new xH(d,n,this.qv,this.Jk,this.CBd,this.p4a,this.qb)}}Object(D.a)(Qy,"CommentFactory",null,[1011]);var iw=e(1846),lB=e(1569);class eD extends rh.a{constructor(d){super();pc.a.Pz(d,"CommentCollection");this.Ih=d}length(){return this.Ih.count}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.Ih.K(d);pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return this.Ih&&
0<this.Ih.count?this.Ih.K(0):null}getItem(d){d=pc.a.lO(d);return d<this.length()?this.Ih.K(d):null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.CommentCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.A1(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}A1(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(eD,"CommentCollection",rh.a,[866,893]);var Sz=e(1395);class jw{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.MSa=null;this.Yr=d;n.execute(oc=>{this.MSa=oc});this.q4a=B;this.usk=Q;this.pb=ha;this.qb=Aa;this.Am=bb;this.OEb=Ib}insertComment(d,n,B){this.Yr.Evb(this.usk,!1)||pc.a.zE();var Q=new Ph.Selection(d.toArray(),!0);d&&0<=d.count&&
d.K(0)&&d.K(0).contextId==ed.a.kd&&this.pb.f9j(Q);if(this.qb.lc(d.K(0).node)&&this.qb.lc(d.K(d.count-1).node)){d=this.pb.ob.currentSelection;this.pb.Uc(Q);Q=iw.a.iic(null);const ha=new lB.a;ha.Xna(n+"\n");Q.text=[ha.emc()];this.MSa.Nsa(Q,null);this.MSa.SBa(Q);n=Jh.a.Of(Q.objectId);n=this.Yr.Hd.Mb(n);this.pb.Uc(d);return this.q4a.create(n,B)}pc.a.Cd();return null}DAi(d){d=vc.a.kb(d);d=this.Yr.pSb(d);return this.oMm(d[0])}zCg(d,n,B){this.Yr.Wu(n)?(n=this.Yr.K4(n.id.toString()),this.Yr.N1c(n,null),this.Yr.N1c(n,
null),B?(B=new lB.a,B.Xna(d+"\n"),n.text=[B.emc()]):n.text=[d],this.Yr.eqb(n)):pc.a.lCb()}deleteComment(d){this.MSa.deleteComment(this.Yr.K4(d.id.toString()))}m4k(d,n){d=this.Yr.gdi(this.Yr.K4(d.id.toString()).id,null);const B=new lB.a;B.Xna(n+"\n");d.text=[B.emc()];this.MSa.SBa(d);n=Jh.a.Of(d.objectId);return this.Yr.Hd.Mb(n)}Q8d(d,n){var B=this.etm(d);d=new ma.a;for(const Q of B)B=this.q4a.create(Q,n),d.add(B);return new eD(d)}aDa(d){return this.Yr.VQf(d.id)}$sm(d){var n=this.aDa(d),B=G.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8213734_FixCommentReplyBug")?
n.Ya.Uj:n.Ya.cpBegin;n=n.Ya.node.ra.Vh(B);B=new ma.a;d=d.getValue(Dd.a.uL);if(n.Nf&&0<n.Nf.length)for(let Q=0;Q<n.Nf.length;Q++)if(n.Nf.K(Q).ld){const ha=n.Nf.K(Q).oSb();d===ha.ka(Dd.a.LQ,null)&&B.add(ha)}return B}Zsm(d){return this.Yr.tH(d).objectId}CAi(d){d=d.ka(Dd.a.UYc,"");return!Ca.a.jg(d)&&(d=d.split("::"),!Nc.a.jg(d)&&2<=d.length)?d[1]:null}etm(d){const n=new ma.a,B=d.count;for(let Aa=0;Aa<B;Aa++){var Q=d.K(Aa);if(Q.contextId===ed.a.od)continue;const bb=-1===Q.cpEnd?Q.Yp:Q.cpEnd;Q=Q.node.ra;
for(let Ib=0;Ib<Q.length;Ib++){if(0>Q.jc(Ib).cp)continue;if(Q.jc(Ib).cp>bb)break;const oc=Q.jc(Ib);if(oc.Nf&&0<oc.Nf.length)for(let Ac=0;Ac<oc.Nf.length;Ac++){const ad=oc.Nf.K(Ac).oSb();var ha=this.aDa(ad);Ca.a.jg(ad.ka(Dd.a.LQ,null))&&!n.contains(ad)&&(ha=this.Am.w$h(d.K(0),d.K(B-1),ha.K(0),ha.K(ha.length-1)),10!=ha&&13!=ha&&0!=ha&&11!=ha&&8!=ha&&n.add(ad))}}}return n}oMm(d){if(""==d)return"";let n="";d=lB.a.ktb(d);for(let B=0;B<d.ops.length-1;B++){const Q=d.ops[B];null!=Q.attributes&&null!=Q.attributes.atmention?
(n+="@",n+=Q.attributes.atmention.fullName):n+=Q.insert?Q.insert:"\n"}return n}lnm(d){const n=new ma.a;for(const Q of this.Yr.Dkf)if(!Q.kg&&!Ca.a.jg(Q.objectId)){var B=Jh.a.Of(Q.objectId);B=this.Yr.Hd.Mb(B);B=this.q4a.create(B,d);n.add(B)}return new eD(n)}Qsm(d,n){const B=new ma.a;for(const ha of this.Yr.Dkf)if(!ha.kg&&!Ca.a.jg(ha.objectId)){var Q=Jh.a.Of(ha.objectId);Q=this.Yr.Hd.Mb(Q);if(this.n0i(d,Q,!0)||this.n0i(d,Q,!1))Q=this.q4a.create(Q,n),B.contains(Q)||B.add(Q)}return new eD(B)}COo(d,n){this.MSa.mOb(this.Yr.K4(d.id.toString()),
n)}n0i(d,n,B){n=this.Yr.Hd.Mb(B?Sz.l(n):Sz.i(n));n=vc.a.kb(n);return n.Ib(10)&&(n.xd(10),n.Jr.equals(d))?!0:!1}lDl(d){const n=this.Yr.K4(d.id.toString());this.Yr.N1c(n,null);d=vc.a.kb(d);d=this.Yr.pSb(d);n.text=d;this.Yr.eqb(n)}SSj(d,n){this.Yr.Wu(n)||pc.a.lCb();const B=d.kq().count,Q=Array(B);for(let ha=0;ha<B;ha++){const Aa=d.kq().K(ha).node;Aa.EVb=!0;Q[ha]=Aa}d=this.OEb.yGe(Q)[0];this.zCg(d,n,!1)}}Object(D.a)(jw,"CommentOperations",null,[1164]);class cF extends rh.a{constructor(d,n,B,Q,ha,Aa){super();
pc.a.Pz(d,"CommentReply GraphNodeContext");this.OHa=d;this.hY=n;this.qv=B;this.oj=Q;this.q4a=ha;this.p4a=Aa}get authorEmail(){return this.qv.CAi(this.OHa)}get authorName(){return this.OHa.getValue(Dd.a.y9a)}get content(){return this.qv.DAi(this.OHa)}set content(d){this.qv.zCg(d,this.OHa,!0)}get contentRange(){const d=vc.a.kb(this.OHa),n=d.Bs(),B=new ma.a;if(0<n){d.ue();for(let Q=0;Q<n;Q++)d.ue(),B.add(ge.a.create(d.currentNode)),d.Ac(),d.xl()}return this.p4a.create(B,this.hY)}set contentRange(d){this.qv.SSj(d,
this.OHa)}get creationDate(){return this.OHa.getValue(Dd.a.wta)}get id(){return this.OHa.getValue(Dd.a.KI)}get _ReferenceId(){return this.kp?this.Jp:null}get parentComment(){var d=this.OHa.ka(Dd.a.LQ,null);return Ca.a.jg(d)?null:(d=this.oj.value.Mb(Jh.a.Of(this.qv.Zsm(d))),this.q4a.create(d,this.hY))}deleteObject(){this.qv.deleteComment(this.OHa)}_KeepReference(){return this.$o()}_OnAccess(){pc.a.Y2(this.OHa,"CommentReply")}getTypeName(){return"Microsoft.WordServices.CommentReply"}invokePropertyGet(d){switch(d){case 1:return this.authorEmail;
case 2:return this.authorName;case 3:return this.content;case 4:return this.creationDate;case 5:return this.id;case 6:return this._ReferenceId;case 7:return this.parentComment;case 8:return this.contentRange}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 8:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,vs);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1002:return this.bF(n);case 1001:return this.Sg();case 1003:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(cF,"CommentReply",rh.a,[866]);class yH{constructor(d){this.q4a=this.qv=null;this.oj=d}Vu(d,n,B){this.q4a=d;this.qv=n;this.p4a=B}create(d,n){return new cF(d,n,this.qv,this.oj,this.q4a,this.p4a)}}Object(D.a)(yH,"CommentReplyFactory",null,[1011]);var aK=e(312);class rv extends rh.a{constructor(d){super();
pc.a.Pz(d,"RangeCollection");this.Nfa=d}length(){return this.Nfa.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){pc.a.yj()||pc.a.Yj();return this.Nfa&&this.Nfa.count?this.Nfa.K(0):null}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.Nfa.K(d);F.ULS.sendTraceTag(18745302,369,10,"The index is out of the boundary of range list.");pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.RangeCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(rv,"RangeCollection",rh.a,[866,893]);class fD extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk){super();pc.a.Pz(d,"wacContentControl");this.rf=d;this._context=n;this.gr=B;this.c7=Q;this.Ip=ha;this.Jk=Aa;this.ME=bb;this.lQ=Ib;this.Wr=oc;this.yD=Ac;this.nd=ad;this.uh=sd;this.Xz=wd;this.wD=
yd;this.fz=be;this.Am=ye;this.So=Qe;this.yd=af;this.qb=Qf;this.qv=hf;this.lz=di;this.Tz=vj;this.SPe=Wk}get appearance(){return this.rf.appearance}set appearance(d){this.Ipb("ContentControl.Appearance");this.rf.appearance=d;tu.a.DEa(this.rf.objectId)}get cannotDelete(){return!this.rf.coa}set cannotDelete(d){this.Ipb("ContentControl.CannotDelete");d&&this.removeWhenEdited&&pc.a.Cd();this.rf.coa=!d;tu.a.DEa(this.rf.objectId)}get cannotEdit(){return!this.rf.isEditable}set cannotEdit(d){this.Ipb("ContentControl.CannotEdit");
this.rf.isEditable=!d;tu.a.DEa(this.rf.objectId)}get checkboxContentControl(){if(!pc.a.fka||8!==this.rf.type)return null;this.igh||(this.igh=this.SPe.create(this.rf));return this.igh}get color(){return null==this.rf.color?"#000000":Vf.a.zB(this.rf.color).toUpperCase()}set color(d){this.Ipb("ContentControl.Color");d=pc.a.yya(d,"ContentControl.Color",this._context);d=parseInt(d,16);isNaN(d)?pc.a.Cd():(this.rf.color=d,tu.a.DEa(this.rf.objectId))}get endnotes(){var d=this.rf.sH();d=this.nd.T9d(d,1);d=
this.nd.fCa(d,this._context);return new wt(d)}get fields(){return this.rf.KN?new Tu(new ma.a):new Tu(this.Tz.Jym(this.rf,this._context))}get contentControls(){const d=new Ei;d.types=[31];return this.getContentControls(d)}get font(){null==this._font&&(this._font=this.ME.create(1,null,this.rf,null,this._context));G.AFrameworkApplication.$v&&this._font._OnAccess();return this._font}get footnotes(){var d=this.rf.sH();d=this.nd.T9d(d,0);d=this.nd.fCa(d,this._context);return new wt(d)}get id(){return this.rf.id}get inlinePictures(){const d=
this.rf.sH(),n=new ma.a;for(const B of d)this.XMl(n,B);return new cp(n)}get lists(){return pc.a.yj()?new bD(1,null,this.rf,null,this._context,this.So,null):null}get paragraphs(){const d=this.rf.sH();let n=0;const B=new ma.a;for(const Q of d)B.add(this.Ip.create(Q.node,this._context,n++));return new Zr(B)}get parentBody(){if(!pc.a.yj())return null;const d=this.rf.sH();return this.yd.KPf(d.K(0).node,d.K(d.count-1).node,this._context)}get parentContentControl(){const d=this.parentContentControlOrNullObject;
d||pc.a.tl();return d}get parentContentControlOrNullObject(){var d;for(d=this.rf.parentId;(d=this.gr.getById(d))&&!this.uh.Rad(d);)d=d.parentId;return d?this.c7.create(d,this._context):null}get parentTable(){if(!pc.a.yj())return null;const d=this.parentTableOrNullObject;d||pc.a.tl();return d}get parentTableCell(){if(!pc.a.yj())return null;const d=this.parentTableCellOrNullObject;d||pc.a.tl();return d}get parentTableCellOrNullObject(){return pc.a.yj()?this.yd.$mc(this.rf.start.node,this._context,this.rf.end.node):
null}get parentTableOrNullObject(){return pc.a.yj()?this.yd.Mtb(this.rf.start.node,this._context,this.rf.end.node):null}get placeholderText(){let d=this.rf.placeholderText;d||(d=WacWordeditorStrings.ContentControlPlaceholder);return d}set placeholderText(d){aK.a.gia?(d=pc.a.MZc(d),this.rf.KN&&(this.insertText(d,4),this.rf.KN=!0),this.rf.placeholderText=d):(F.ULS.sendTraceTag(20833952,369,15,"AppId:{0}, set placeholder text for contentcontrol on wac is not allowed.",this._context.appId),pc.a.zE())}get removeWhenEdited(){return this.rf.removeWhenEdited}set removeWhenEdited(d){this.Ipb("ContentControl.RemoveWhenEdited");
d&&this.cannotDelete&&pc.a.Cd();this.rf.removeWhenEdited=d;tu.a.DEa(this.rf.objectId)}get style(){const d=this.rf.sH();return this.yD.b6c(d)}set style(d){this.Ipb("ContentControl.Style");const n=this.rf.sH();this.yD.Ozc(n,d);tu.a.DEa(this.rf.objectId)}get styleBuiltIn(){if(!pc.a.yj())return-1;const d=this.rf.sH();return this.yD.U9d(d)}set styleBuiltIn(d){pc.a.yj()||pc.a.Yj();const n=this.rf.sH();this.yD.ZAe(n,d);tu.a.DEa(this.rf.objectId)}get Pg(){return this.rf.Pg}get MKg(){if(!this.rf.type){const d=
vc.a.kb(this.rf.start.node);if(d.Ib(14))return d.xd(14)}}get o2j(){if(!this.rf.type)return this.rf.start?this.rf.start.node:void 0}get subtype(){return pc.a.yj()?this.USm():0}get tables(){return pc.a.yj()?new Qq(1,null,null,this.rf,this._context,this.yd):null}get tag(){return this.rf.tag}set tag(d){this.Ipb("ContentControl.Tag");pc.a.Pz(d,"Tag");this.rf.tag=d;tu.a.DEa(this.rf.objectId)}get text(){return this.rf.KN?"":this.rf.getText()}getReviewedText(d){return this.rf.KN?"":this.lz.cPm(this.rf,d)}get title(){return this.rf.title}set title(d){this.Ipb("ContentControl.Title");
pc.a.Pz(d,"Title");this.rf.title=d;tu.a.DEa(this.rf.objectId)}get type(){switch(this.rf.type){case 1:return 96;case 8:return pc.a.fka?512:31;default:return 31}}get _ReferenceId(){return this.kp?this.Jp:null}clear(){pc.a.Mxd()?this.Uyl():this.Tyl()}deleteContentControl(d){pc.a.Mxd()?this.BWl(d):this.AWl(d)}getComments(){return this.qv.Q8d(this.rf.sH(),this._context)}getContentControls(d){var n;d=null!==(n=null===d||void 0===d?void 0:d.types)&&void 0!==n?n:[];pc.a.s2c(d);n=this.gr.ZQ(this.rf.start,
this.rf.end,1);for(var B of n)if(B.id===this.rf.id){n.remove(B);break}B=this.uh.CRf(n,this._context);return 0===d.length?B:null===B||void 0===B?void 0:B.getByTypes(d)}getHtml(){const d=this.rf.sH();return this.fz.getHtml(d.toArray(),this._context)}getOoxml(){const d=(new Date).getTime();this._context.vo.qH();const n=this.rf.sH();return OfficeExtension.WacRuntime.Utility.createPromise((B,Q)=>{this.fz.getOoxml(n,this._context,B,Q,d)})}getRange(d){pc.a.yj()||pc.a.Yj();1!==d&&2!==d&&d&&5!==d&&4!==d&&
3!==d&&(F.ULS.sendTraceTag(18745292,369,15,"AppId:{0}, rangeLocation of ContentControl.GetRange must be Start/End/Whole/Content/Before/After.",this._context.appId),pc.a.Cd());var n=d;3===d&&(n=1);var B=this.rf.sH(),Q=B.K(0),ha=B.K(B.count-1);if(ha.contextId===ed.a.paragraph&&4===d){var Aa=(Aa=this.qb.textLength(ha.node))?ge.a.createTextRange(ha.node,0,Aa):ge.a.uz(ha.node);B.removeAt(B.count-1);B.add(Aa);this.Am.Kzc(Q,ha,B,!1)}n=this.Am.mSb(B,n);B&&n&&0<B.count&&0<n.count&&(Q=B.K(0),B=B.K(B.count-
1),ha=n.K(0),Aa=n.K(n.count-1),1===d?ha.Ob=Aa.nc=Q.Ob+1:2===d?ha.Ob=Aa.nc=B.nc-1:5===d&&(ha.Ob=Q.Ob+1,Aa.nc=B.nc-1));return this.Jk.create(n,this._context)}getTextRanges(d,n){pc.a.yj()||pc.a.Yj();var B=this.rf.sH();d=this.Am.cSf(B,d,n);n=new ma.a;for(B=0;B<d.length;B++)n.add(this.Jk.create(d[B],this._context,B));return new rv(n)}getTrackedChanges(){return new Mw(1,null,null,this.rf,this._context,this.lz,this.qb,this.Am)}insertBreak(d,n){const B=(new Date).getTime();2!==n&&3!==n&&n&&1!==n&&(F.ULS.sendTraceTag(19158349,
369,15,"AppId:{0}, invalid insert location for ContentControl.InsertBreak.",this._context.appId),pc.a.Cd());pc.a.fka?this.TQb(n):this.Trb(n);let Q=!1;if(6===d||(pc.a.kKe()||this.rf.Pg)&&!d)Q=this.eqc(n);const ha=new ma.a;ha.add(this.ASb(n));Q&&this.uh.WLa();return OfficeExtension.WacRuntime.Utility.createPromise((Aa,bb)=>{this.nd.insertBreak(ha,d,n,this._context,Aa,bb,B)})}insertFileFromBase64(d,n){"<"===d.charAt(0)&&(F.ULS.sendTraceTag(18130834,369,10,"invalid argument for insertFileFromBase64 API in ContentControl class.",
this._context.appId),pc.a.Cd());this.rf.isEditable||pc.a.HCc(this._context.appId,"ContentControl.InsertFileFromBase64",void 0,yo.a[n]);pc.a.fka?this.TQb(n):this.Trb(n);return this.Wna(d,n,!1)}insertHtml(d,n){pc.a.fka?this.TQb(n):this.Trb(n);return pc.a.Mxd()?this.ahn(d,n):this.$gn(d,n)}insertInlinePictureFromBase64(d,n){pc.a.fka?this.TQb(n):this.Trb(n);return this.Q$c(d,n)}insertOoxml(d,n){"<"!==d.charAt(0)&&(F.ULS.sendTraceTag(18130835,369,10,"invalid argument for InsertOoxml API in ContentControl class.",
this._context.appId),pc.a.Cd());pc.a.fka?this.TQb(n):this.Trb(n);return this.Wna(d,n,!0)}insertParagraph(d,n){2!==n&&3!==n&&n&&1!==n&&(F.ULS.sendTraceTag(21070048,369,15,"AppId:{0}, Invalid insert location for ContentControl.InsertPparagraph method.",this._context.appId),pc.a.Cd());pc.a.kKe()||2!==n&&3!==n||this.rf.Pg||pc.a.HCc(this._context.appId,"ContentControl.InsertParagraph",void 0,yo.a[n]);pc.a.fka?this.TQb(n):this.Trb(n);const B=this.eqc(n),Q=new ma.a;Q.add(this.ASb(n));2===n?n=0:3===n&&(n=
1);B&&this.uh.WLa();return this.Ip.create(this.nd.insertParagraph(Q,d,n),this._context)}insertTable(d,n,B,Q){pc.a.yj()||pc.a.Yj();2!==B&&3!==B&&B&&1!==B&&(F.ULS.sendTraceTag(20971524,369,15,"Invalid argument for InsertTable API in ContentControl class.",this._context.appId),pc.a.Cd());pc.a.kKe()||2!==B&&3!==B||this.rf.Pg||pc.a.HCc(this._context.appId,"ContentControl.InsertParagraph",void 0,yo.a[B]);pc.a.fka?this.TQb(B):this.Trb(B);const ha=this.eqc(B),Aa=new ma.a;Aa.add(this.ASb(B));2===B?B=0:3===
B&&(B=1);ha&&this.uh.WLa();return this.yd.insertTable(Aa,d,n,B,Q,this._context)}insertText(d,n){2!==n&&3!==n&&4!==n&&(F.ULS.sendTraceTag(21284488,369,15,"AppId:{0}, invalid location for ContentControl.InsertText: {1}.",this._context.appId,yo.a[n]),pc.a.Cd());pc.a.fka&&this.zpi(n);var B=pc.a.lBc(d);!pc.a.kKe()&&1<B.length&&!this.rf.Pg&&pc.a.HCc(this._context.appId,"ContentControl.InsertText","Attempt to insert multi-line text into an inline content control",yo.a[n]);if(this.rf.KN&&1===B.length&&""===
B[0])return this.Jk.create(this.smc(),this._context);if(!pc.a.Mxd()&&(this.rf.KN||4===n))return this.rf.RBe(d)&&pc.a.vg(),this.Jk.create(this.smc(),this._context);B=this.eqc(n);let Q=new ma.a;switch(n){case 2:case 3:Q.add(this.ASb(n));break;case 4:Q=this.smc()}B&&this.uh.WLa();return this.Jk.create(this.nd.insertText(Q,d,n),this._context)}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.rf.sH();this.wD.find(Q,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>
{const Q=this.rf.sH();this.wD.msb(Q,d,n,B,this._context)})}select(d){switch(d){case 0:this.uh.select(this.rf);break;case 1:case 2:if(this.rf.KN)this.uh.select(this.rf);else{const n=1===d?this.rf.start:this.rf.end;let B;this.Wr.select((B=new ma.a,B.add(n),B),d)}}}split(d,n,B,Q){pc.a.yj()||pc.a.Yj();const ha=this.rf.sH();if(ha&&0<ha.count){let Aa;(Aa=ha.K(0)).Ob=Aa.Ob+1;let bb;(bb=ha.K(ha.count-1)).nc=bb.nc-1}d=this.Am.kBc(ha,d,n,B,Q);n=new ma.a;for(B=0;B<d.length;B++)n.add(this.Jk.create(d[B],this._context,
B));return new rv(n)}_KeepReference(){this.$o()}_OnAccess(){this.rf.isValid()||(F.ULS.sendTraceTag(17155413,369,15,"AppId:{0}, Should not access invalid contentcontrol object.",this._context.appId),pc.a.vg())}getTypeName(){return"Microsoft.WordServices.ContentControl"}invokePropertyGet(d){switch(d){case 7:return this.appearance;case 10:return this.cannotDelete;case 11:return this.cannotEdit;case 32:return this.checkboxContentControl;case 8:return this.color;case 15:return this.contentControls;case 30:return this.endnotes;
case 31:return this.fields;case 12:return this.font;case 29:return this.footnotes;case 1:return this.id;case 17:return this.inlinePictures;case 19:return this.lists;case 14:return this.paragraphs;case 25:return this.parentBody;case 16:return this.parentContentControl;case 26:return this.parentContentControlOrNullObject;case 22:return this.parentTable;case 21:return this.parentTableCell;case 27:return this.parentTableCellOrNullObject;case 28:return this.parentTableOrNullObject;case 5:return this.placeholderText;
case 9:return this.removeWhenEdited;case 13:return this.style;case 24:return this.styleBuiltIn;case 23:return this.subtype;case 20:return this.tables;case 4:return this.tag;case 18:return this.text;case 3:return this.title;case 6:return this.type;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 7:this.appearance=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 10:this.cannotDelete=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 11:this.cannotEdit=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.placeholderText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 9:this.removeWhenEdited=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 24:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.tag=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1010:return this.IKa();case 1011:return this.bF(n);case 1021:return this.qSb();case 1023:return this.zMa(n);case 1013:return this.GSb();case 1016:return this.rha(n);case 1019:return this.G7c(n);case 1024:return this.ITb();case 1007:return this.lva(n);case 1018:return this.hcb(n);case 1003:return this.vNa(n);case 1012:return this.lja(n);case 1017:return this.t3b(n);
case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1014:return this.fTb();case 1008:return this.Ybb(n);case 1006:return this.jva(n);case 1004:return this.acb(n);case 1009:return this.bcb(n);case 1005:return this.fcb(n);case 1015:return this.zxa(n);case 1020:return this.Hqa(n);case 1022:return this.uTb(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}IKa(){this.clear();
return null}bF(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");this.deleteContentControl(d);return null}qSb(){return this.getComments()}zMa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}GSb(){return this.getHtml()}fTb(){return this.getOoxml()}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}G7c(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(n,d)}ITb(){return this.getTrackedChanges()}uTb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}Ybb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(n,d)}jva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(n,d)}acb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(n,d)}bcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(n,
d)}fcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(n,d)}lva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}hcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(n,B,Q,d)}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(n,d)}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}t3b(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
2,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.split(n,B,Q,d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}isValid(){return this.rf.isValid()}XMl(d,n){const B=new ma.a;this.Xz.o$d(B,n);if(!(0>=B.count))for(const Q of B)d.add(this.lQ.create(Q,this._context))}Wna(d,n,B){const Q=(new Date).getTime();if(2===n||3===n||4===n){const ha=this.rf.sH();return OfficeExtension.WacRuntime.Utility.createPromise((Aa,bb)=>{const Ib=B?
0:1;this.fz.insertOoxml(ha,d,n,ha.K(0).node,this._context,Aa,bb,Q,Ib,this.rf.id)})}F.ULS.sendTraceTag(18130836,369,15,"AppId:{0}, ContentControl.InsertOoxmlOrDocx: undefined location!",this._context.appId);pc.a.Cd();return null}Ipb(d){this.rf.isSupported||(F.ULS.sendTraceTag(19417247,369,15,"AppId:{0}, {1}: currently is not supported as the contentcontrol is no-supported on WAC!",this._context.appId,d),pc.a.zE())}ASb(d){var n=null;switch(d){case 0:case 2:var B=this.rf.start;n=this.rf.Pg?0:B.cpBegin;
n=ge.a.jd(B.node,n);n.Ob=d?n.nc=B.rp():n.nc=B.rp()-1;break;case 1:case 3:B=this.rf.end,n=this.rf.Pg?B.node.characterData.length:B.cpEnd,n=ge.a.jd(B.node,n),n.Ob=1===d?n.nc=B.vp()+1:n.nc=B.vp()}return n}smc(){if(pc.a.jPp()&&!this.rf.Pg&&!this.rf.start)return new ma.a;const d=this.rf.sH();let n;(n=d.K(0)).Ob=n.Ob+1;let B;(B=d.K(d.count-1)).nc=B.nc-1;return d}eqc(d){let n=!1;!this.rf.KN||2!==d&&3!==d&&4!==d||(n=!0,this.uh.hQb(),this.clear(),this.rf.KN=!1);return n}$gn(d,n){pc.a.iEc(d,"ContentControl.InsertHtml");
if(!this.rf.isEditable)return pc.a.HCc(this._context.appId,"ContentControl.InsertHtml",void 0,yo.a[n]),null;const B=(new Date).getTime();if(this.rf.zie||this.rf.frc)return F.ULS.sendTraceTag(19482261,369,15,"AppId:{0}, content control with Binding is not allowed for insertHtml API in ContentControl class.",this._context.appId),pc.a.zE(),null;if(2===n||3===n||4===n){const Q=this.rf.sH(),ha=this.rf.je;let Aa=this.rf.id;return this.gr.J0b(Aa)?(F.ULS.sendTraceTag(19482262,369,15,"AppId:{0}, failed to release content control for insertHtml API in ContentControl class.",
this._context.appId),pc.a.vg(),null):this.fz.insertHtml(Q,d,n,B,this._context,!0).then(()=>{let bb=!1;if(1===Q.count&&Q.K(0).contextId===ed.a.kd){bb=!0;let Ib=new ma.a;Ib.add(Q.K(0));Ib=this.nd.insertText(Ib," ",3);Q.W(0,Ib.K(0))}if(({id:Aa}=this.gr.W0k(Q,ha)).returnValue)return F.ULS.sendTraceTag(19482263,369,10,"AppId:{0}, failed to restore the content control for insertHtml API in ContentControl class.",this._context.appId),pc.a.vg(),null;this.rf=this.gr.getById(Aa);bb&&this.rf.RBe("");return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Jk.create(Q,
this._context))})}F.ULS.sendTraceTag(19482264,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId);pc.a.Cd();return null}ahn(d,n){const B=(new Date).getTime();pc.a.iEc(d,"ContentControl.InsertHtml");const Q=this.eqc(n);let ha=new ma.a;switch(n){case 2:case 3:ha.add(this.ASb(n));break;case 4:ha=this.smc();break;default:F.ULS.sendTraceTag(22062857,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId),pc.a.Cd()}Q&&
this.uh.WLa();return this.fz.insertHtml(ha,d,n,B,this._context)}Tyl(){this.rf.clear()&&pc.a.vg()}Uyl(){this.nd.sOb(this.smc())}AWl(d){(d?this.gr.J0b(this.id):this.gr.nWl(this.id))&&pc.a.vg()}BWl(d){d?(d=!1,this.rf.KN&&(d=!0,this.uh.hQb(),this.clear()),this.gr.J0b(this.id)&&pc.a.vg(),d&&this.uh.WLa()):this.nd.Yic(this.rf.sH())}get je(){return this.rf.je}get RT(){return this.rf.je.RT}set RT(d){this.rf.je.RT=d}set text(d){G.AFrameworkApplication.$v&&this.rf.RBe(d)}Q$c(d,n,B){const Q=(new Date).getTime();
let ha=null,Aa=!1;switch(n){case 4:Aa=!0;this.uh.hQb();this.clear();ha=this.ASb(2);break;case 3:case 2:Aa=this.eqc(n);ha=this.ASb(n);break;default:F.ULS.sendTraceTag(20047956,369,15,"AppId:{0}, invalid argument for insertInlinePictureFromBase64 API in ContentControl class.",this._context.appId),pc.a.Cd()}ha||(F.ULS.sendTraceTag(20047957,369,50,"AppId:{0}, user wants to insert an image into content control but a wrong place or something wrong.",this._context.appId),pc.a.vg());Aa&&this.uh.WLa();let bb;
this.nd.DY((bb=new ma.a,bb.add(ha),bb),n,0);G.AFrameworkApplication.$v&&B?(this._context.vo.ex(),n=this.Xz.WUb(d,ha,this._context,B)):n=this.Xz.WUb(d,ha,this._context);return n.then(Ib=>{G.AFrameworkApplication.$v||this._context.vo.ex();if(!Ib)return F.ULS.sendTraceTag(20047958,369,10,"AppId:{0}, something went wrong when insert iamge into ContentControl.",this._context.appId),pc.a.lR("ContentControl.InsertInlinePictureFromBase64",pc.a.WR(Q),d.length,!1),pc.a.vg(),null;pc.a.lR("ContentControl.InsertInlinePictureFromBase64",
pc.a.WR(Q),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lQ.create(this.Xz.t3c(Ib),this._context))})}vSb(){if(G.AFrameworkApplication.$v)return this.rf.sH()}USm(){return this.uh.Rad(this.rf)?0===this.rf.type?this.rf.Pg?this.Wfl()?16:2:1:1===this.rf.type?this.rf.Pg?64:32:8===this.rf.type?512:0:0}Wfl(){var d,n;const B=null===(d=this.rf.start)||void 0===d?void 0:d.node;d=null===(n=this.rf.end)||void 0===n?void 0:n.node;if(!B||!d)return!1;n=vc.a.kb(B);if(n.Ib(14)){var Q=
n.xd(14);n=this.qb.Vn(Q);Q=this.qb.vH(Q);if(n&&Q&&B.id===n.id&&d.id===Q.id)return!0}return!1}Trb(d){96===this.type&&0!==d&&1!==d&&pc.a.zE()}zpi(d){512===this.type&&0!==d&&1!==d&&pc.a.zE()}TQb(d){this.Trb(d);this.zpi(d)}}Object(D.a)(fD,"ContentControl",rh.a,[866]);class zH{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd){this.yd=this.uh=this.lQ=this.Jk=this.Ip=null;this.ME=d;this.gr=n;this.Wr=B;this.yD=Q;this.nd=ha;this.Xz=Aa;this.wD=bb;this.fz=Ib;this.Am=oc;this.So=Ac;this.qb=ad;this.bxk=sd;this.SPe=
wd}Vu(d,n,B,Q,ha,Aa,bb){this.Ip=d;this.Jk=n;this.lQ=B;this.uh=Q;this.yd=ha;this.lz=Aa;this.Tz=bb}create(d,n){return new fD(d,n,this.gr,this,this.Ip,this.Jk,this.ME,this.lQ,this.Wr,this.yD,this.nd,this.uh,this.Xz,this.wD,this.fz,this.Am,this.So,this.yd,this.qb,this.bxk,this.lz,this.Tz,this.SPe)}}Object(D.a)(zH,"ContentControlFactory",null,[1011]);class mB extends rh.a{constructor(d){super();pc.a.Pz(d,"ContentCollection");this.aza=d}length(){return this.aza.count}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<
this.length())return this.aza.K(d);F.ULS.sendTraceTag(17093347,369,10,"The index is out of the ContentControlCollection range.");pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getByChangeTrackingStates(d){pc.a.kPp()||pc.a.Yj();if(null===d||void 0===d||!d.length)return null;let n=0;for(const B of d)0<=B&&4>=B?n|=B:pc.a.Cd();d=new ma.a;for(const B of this.aza)B.isValid()&&(null!=B.je.Xy?this.$_f(n,4)&&d.add(B):null!=B.je.DA?this.$_f(n,2)&&d.add(B):this.$_f(n,1)&&d.add(B));return new mB(d)}getById(d){(d=
this.getByIdOrNullObject(d))||pc.a.tl();return d}getByIdOrNullObject(d){let n=null;for(const B of this.aza)if(B.id===d&&B.isValid()){n=B;break}return n}getByTag(d){return this.tzi(n=>n.tag===d)}getByTitle(d){return this.tzi(n=>n.title===d)}getByTypes(d){pc.a.yj()||pc.a.Yj();const n=new ma.a;for(const B of this.aza)if(B.isValid())for(const Q of d)if(0<(B.subtype&Q)){n.add(B);break}return new mB(n)}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){pc.a.yj()||
pc.a.Yj();return this.aza&&0<this.aza.count?this.aza.K(0):null}getItem(d){d=pc.a.lO(d);return this.getById(d)}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.ContentControlCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1010:return this.tqm(n);case 1002:return this.a5c(n);case 1008:return this.b5c(n);case 1004:return this.yqm(n);case 1003:return this.zqm(n);case 1006:return this.CKf(n);case 1007:return this.JC();
case 1009:return this.KC();case 1:return this.A1(n);case 1001:return this.Sg();case 1005:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}getContentControls(){return this.aza&&0<this.aza.count?Array.from(this.aza):[]}tqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<int>");return this.getByChangeTrackingStates(d)}a5c(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getById(d)}b5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getByIdOrNullObject(d)}yqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByTag(d)}zqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByTitle(d)}CKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<int>");
return this.getByTypes(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}$_f(d,n){return 0!==(d&n)}tzi(d){if(!d)return null;const n=new ma.a;for(const B of this.aza)d(B)&&B.isValid()&&n.add(B);return new mB(n)}}Object(D.a)(mB,"ContentControlCollection",rh.a,[866,893]);class bK{constructor(d,n,B,Q,ha,Aa,bb,
Ib,oc,Ac,ad){this.gr=d;this.BM=n;this.c7=B;this.nd=Q;this.cI=ha;this.wn=Aa;this.sWe=bb;this.Iq=Ib;this.qb=oc;this.Hp=Ac;this.Wr=ad}get jH(){return null!=this.XXg?this.XXg:this.XXg=(()=>this.sWe())()}Rad(d){switch(d.type){case 0:case 1:return!0;case 8:return pc.a.fka;default:return!1}}Lnm(d=null){const n=this.gr.mnm();return this.CRf(n,d)}DRf(d,n,B=null){d=this.gr.ZQ(d,n,1);return this.CRf(d,B)}CRf(d,n=null){if(!d||!this.c7)return null;const B=new ma.a;for(const Q of d)this.Rad(Q)&&B.add(this.c7.create(Q,
n));return new mB(B)}cTm(d,n=null){d=this.qb.LC(d,!0,!1);return 0>=d.count?null:this.DRf(d.K(0),d.K(d.count-1),n)}fJi(d,n){return this.gr.ZQ(d,n,3,!0)}xnc(d,n,B=null){n=this.gr.ZQ(d,n,3,!0);d=null;if(0<n.count)if(this.Rad(n.K(0)))d=n.K(0);else for(n=n.K(0),n=n.parentId;n=this.gr.getById(n);){if(this.Rad(n)){d=n;break}n=n.parentId}return d?this.c7.create(d,B):null}lkf(d){if(d.count){var n=d.K(0),B=d.K(d.count-1);if(n.contextId===ed.a.od){var Q=this.qb.textLength(n.node)?ge.a.uz(n.node):ge.a.create(n.node);
Q.Ob=n.rp();Q.nc=n.vp();n===B&&(B=Q);n=Q}B.contextId!==ed.a.od||this.qb.textLength(B.node)||(Q=ge.a.create(B.node),Q.nc=B.vp(),B=Q);if((Lj.a.Ny(n)&&Lj.a.Mvb(n)||this.qb.Xn(n))&&Lj.a.Ny(B)&&Lj.a.Mvb(B)){Q=this.Iq.yab(n.node,n.Uj,n.Ob,!0);const ha=this.Iq.yab(B.node,B.Yp,B.nc,!1);if(!Q&&!ha||Q&&ha&&Q.Fe.equals(ha.Fe)&&Q.Pg)Q=ge.a.create(B.node),Q.Ob=B.Ob,Q.nc=B.nc,B=Q}d.W(0,n);d.W(d.count-1,B)}}Msa(d,n,B,Q=0,ha=!1){let Aa=0;if(d=({id:Aa}=this.gr.f0k(d,n,Q,ha)).returnValue){if(ha)return d;F.ULS.sendTraceTag(17148101,
369,15,"AppId:{0}, failed to create a new block content control.",B.appId);pc.a.vg();return null}if(ha)return d;ha=this.gr.getById(Aa);tu.a.Hle(ha.objectId);ha.type=Q;return this.c7.create(ha,B)}k8a(d,n,B=0,Q=!1){let ha=0;if(d=({id:ha}=this.gr.k8a(d,null,B,Q)).returnValue){if(Q)return d;F.ULS.sendTraceTag(17148102,369,15,"AppId:{0}, failed to create a new inline content control.",n.appId);pc.a.vg();return null}if(Q)return d;Q=this.gr.getById(ha);if(G.AFrameworkApplication.$v&&Q&&null===Q.start)return 2;
tu.a.Hle(Q.objectId);Q.type=B;return this.c7.create(Q,n)}aZ(d,n){return this.gr.aZ(d,n)}Hcb(d){return this.cI.Hcb(d)}hQb(){this.BM&&this.BM.hQb("RelateToSelection")}WLa(){this.BM&&this.BM.WLa("RelateToSelection")}select(d){this.wn.select(d.objectId,!0)}evd(d){this.wn.evd(d.objectId)}Tvd(d){this.jH&&Lj.a.Df(d)&&this.jH.Tvd(d)}fRa(d,n){if(!this.jH||!Lj.a.Df(d))return d;var B=n.K(0),Q=ge.a.jd(B.node,B.Uj);Q.nc=Q.Ob=B.Ob;B=n.K(n.count-1);var ha=ge.a.jd(B.node,B.Yp);ha.nc=ha.Ob=B.nc;B=Lj.a.em(B)||B.contextId===
ed.a.paragraph;const Aa=new ma.a;Aa.add(Q);Aa.add(ha);for(Q=this.mFi(d.node,d.cpBegin,d.Ob);Q;){ha=d.node.id;d=this.v7l(Q,d,Aa);if(!d.node.id.equals(ha)&&(Q=this.Iq.TAi(d.node,Q.Fe),!Q)){F.ULS.sendTraceTag(36459329,369,15,"Failed to find content control start boundary after split.");pc.a.vg();break}this.u7l(Q,Aa);Q=this.Iq.TAi(Q.Rb.paragraph,Q.Fe);ha=Q.Rb.Qb.qN(Q.Fe,!0);Q=ge.a.jd(Q.Rb.paragraph,Q.Rb.cp);Q.nc=Q.Ob=ha+1;if(!this.jH.fRa(Q)){F.ULS.sendTraceTag(36459330,369,15,"Failed to Convert inline content control to block.");
pc.a.vg();break}Q=this.mFi(d.node,d.cpBegin,d.Ob)}B=this.KHm(Aa,B);!n.count||B&&B.count||(F.ULS.sendTraceTag(36459332,369,15,"GncList is empty after conversion"),pc.a.vg());n.clear();n.addRange(B);return d}v7l(d,n,B){if(!d.Rb.cp)return n;B.add(n);this.F1j(d,!0,B);n=B.K(B.count-1);B.removeAt(B.count-1);return n}u7l(d,n){(d=this.Iq.Atm(d))?d.Rb.cp!==this.qb.textLength(d.Rb.paragraph)&&this.F1j(d,!1,n):(F.ULS.sendTraceTag(36459333,369,15,"Failed to find content control end boundary."),pc.a.vg())}F1j(d,
n,B){var Q=d.Rb;d=Q.Qb.qN(d.Fe,d.ld);Q=ge.a.jd(Q.paragraph,Q.cp);Q.nc=Q.Ob=d+(n?0:1);n=new ma.a;for(var ha of B)n.add(this.Yfc(ha,Q));({SPb:ha}=this.nd.npc(Q,!1));ha=this.Hp.Ze(ha);for(d=0;d<B.count;d++)B.W(d,this.KDm(B.K(d),Q,ha,n.K(d)))}q0f(d,n){return d.node.id.equals(n.node.id)&&(d.cpBegin>n.cpBegin||d.cpBegin===n.cpBegin&&d.rp()>n.rp())}til(d,n){return this.Yfc(d,n)}Yfc(d,n=null,B=!1){return n&&!this.q0f(d,n)?null:this.Iq.yab(d.node,d.cpBegin,d.Ob,B)}dPo(d,n,B,Q){this.Fye(d,n,B,Q)}Fye(d,n,B=
null,Q=null,ha=!1){B&&Q&&!this.q0f(B,Q)||(B=d.node.ra.Vh(ha?d.Uj:d.Yp))&&B.Qb&&B.Qb.length&&(n=n?B.Qb.qN(n.Fe,n.ld):-1,n=ha?0<=n?n+1:0:0<=n?n:B.Qb.length,d.contextId===ed.a.kd?d.nc=d.Ob=n:ha?d.Ob=n:d.nc=n)}KDm(d,n,B,Q){if(!this.q0f(d,n))return d;B=ge.a.jd(B,d.cpBegin-n.cpBegin);this.Fye(B,Q,d,n);return B}mFi(d,n,B){d=this.Iq.Eca(d,n,B);for(const Q of d)if(!Q.Pg)return Q;return null}KHm(d,n){const B=d.K(0);d=d.K(d.count-1);return this.Wr.TDi(B,d,n)}}Object(D.a)(bK,"ContentControlOperations",null,[1163]);
class dF extends rh.a{constructor(d,n,B){super();this._context=d;this.rm=n;this.g7=B}get id(){return this.g7.id}get namespaceUri(){return this.g7.namespace}get _ReferenceId(){return this.kp?this.Jp:null}deleteObject(){this.Kpb();this.rm.jji(this.id)!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.Cd()}deleteAttribute(d,n,B){this.Kpb();d=this.$Tb(n,d);d=this.xAb(d);1!==d.length&&pc.a.Cd();d[0].removeAttribute(B);this.g7.save()}deleteElement(d,n){this.Kpb();d=this.$Tb(n,d);d=this.xAb(d);1!==
d.length&&pc.a.Cd();d[0].parentNode.removeChild(d[0]);this.g7.save()}getXml(){return this.g7.Q3a}insertAttribute(d,n,B,Q){this.Kpb();d=this.$Tb(n,d);d=this.xAb(d);1!=d.length&&pc.a.Cd();d[0].setAttribute(B,Q);this.g7.save()}insertElement(d,n,B,Q){this.Kpb();d=this.$Tb(B,d);d=this.xAb(d);1!==d.length&&pc.a.Cd();Q||0===Q?Q>d[0].childNodes.length&&pc.a.Cd():Q=d[0].childNodes.length;n=new OSF.XmlProcessor(n,"");d[0].insertBefore(n.getDocumentElement(),Q===d[0].childNodes.length?null:d[0].childNodes[Q])||
pc.a.Cd();this.g7.save()}query(d,n){d=this.$Tb(n,d);d=this.xAb(d,!1);n=[];if(d)for(let B=0;B<d.length;B++){const Q=this.g7.getNodeXml(d[B]);n.push(Q)}return n}setXml(d){this.Kpb();const n=this.xAb("/",!1);n&&(this.g7.setNodeXml(n[0].firstChild,d)||pc.a.Cd())}updateAttribute(d,n,B,Q){this.Kpb();d=this.$Tb(n,d);d=this.xAb(d);1!==d.length&&pc.a.Cd();d[0].hasAttribute(B)?d[0].setAttribute(B,Q):pc.a.Cd();this.g7.save()}updateElement(d,n,B){this.Kpb();d=this.$Tb(B,d);d=this.xAb(d);1!==d.length&&pc.a.Cd();
this.g7.setNodeXml(d[0],n)||pc.a.Cd()}$Tb(d,n){const B=Object.keys(d);for(let Q=0;Q<B.length;Q++){const ha=B[Q],Aa=this.g7.J6c(d[ha]);Aa&&(n=n.replace("/"+ha+":","/"+Aa+":"))}return n}xAb(d,n=!0){let B;try{B=this.g7.selectNodes(d,null)}catch(Q){n&&pc.a.Cd()}n&&!B&&pc.a.Cd();return B}Kpb(){this.g7.builtIn&&pc.a.Cd()}_KeepReference(){this.$o()}_OnAccess(){this._context.vo.dhc(this.rm.Pma.currentNode);this.g7.v2f()||this.g7.pQg();pc.a.Y2(this.g7.bT,"CustomXmlPart")}getTypeName(){return"Microsoft.WordServices.CustomXmlPart"}invokePropertyGet(d){switch(d){case 2:return this.id;
case 3:return this.namespaceUri;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);
case 1012:return this.jWl(n);case 1009:return this.GWl(n);case 1004:return this.EYm();case 1010:return this.mgn(n);case 1007:return this.Kgn(n);case 1006:return this.eso(n);case 1005:return this.z7o(n);case 1011:return this.tCp(n);case 1008:return this.dEp(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();
return null}jWl(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");this.deleteAttribute(n,B,d);return null}GWl(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.deleteElement(n,d);return null}EYm(){return this.getXml()}mgn(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");this.insertAttribute(n,B,Q,d);return null}Kgn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
2,"any");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"int?");this.insertElement(n,B,Q,d);return null}eso(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");return this.query(n,d)}z7o(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.setXml(d);return null}tCp(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"any"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");this.updateAttribute(n,B,Q,d);return null}dEp(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"any");this.updateElement(n,B,d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();
return null}}Object(D.a)(dF,"CustomXmlPart",rh.a,[866]);class AH{constructor(d){this.rm=d}Vu(){}create(d,n){return new dF(n,this.rm,d)}}Object(D.a)(AH,"CustomXmlPartFactory",null,[1011]);class Js extends rh.a{constructor(d){super();this.Ozk=d}get body(){pc.a.zE();return null}get contentControls(){pc.a.zE();return null}get customXmlParts(){pc.a.zE();return null}get properties(){pc.a.zE();return null}get saved(){return!1}get sections(){pc.a.zE();return null}get settings(){pc.a.zE();return null}get _ReferenceId(){return this.kp?
this.Jp:null}addStyle(){pc.a.zE();return null}deleteBookmark(){pc.a.zE()}getBookmarkRange(){pc.a.zE();return null}getBookmarkRangeOrNullObject(){pc.a.zE();return null}getContentControls(){pc.a.zE();return null}insertFileFromBase64(){pc.a.zE();return null}getStyles(){pc.a.zE();return null}open(){return OfficeExtension.WacRuntime.Utility.createPromise(d=>{const n=new Sa.StandardDialog;n.Md=4;n.Yx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,B=>{1===B&&
gc.a.Zm(this.Ozk,void 0,void 0,"ExtensionPackage.OpenDialog");d(null)})})}save(){pc.a.zE()}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.DocumentCreated"}invokePropertyGet(d){switch(d){case 3:return this.body;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1028:return this.Gif(n);case 1011:return this.mzf(n);case 1010:return this.tKf(n);case 1012:return this.uKf(n);case 1013:return this.zMa(n);
case 1029:return this.wRf();case 1005:return this.dAg(n);case 1008:return this.Sg();case 1007:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1009:return this.sco();case 1014:return this.jva(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Gif(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.addStyle(n,d)}mzf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.deleteBookmark(d);return null}tKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRange(d)}uKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRangeOrNullObject(d)}zMa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}jva(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,ok);return this.insertFileFromBase64(n,B,d)}wRf(){return this.getStyles()}sco(){return this.open()}dAg(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.save(n,d);return null}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}}Object(D.a)(Js,"DocumentCreated",rh.a,[866]);class cK{create(d){return new Js(d)}}Object(D.a)(cK,"DocumentCreatedFactory",null,[]);var SM=e(314),XL=e(227),Bm=e(230),nB=e(1886);class BH extends rh.a{constructor(d,n,B,Q,ha){super();this._context=d;this.rm=n;this.lfa=B;this.qLk=Q;this.M4a=ha}length(){return this.getCount()}_GetItem(d){if(pc.a.lO(d)<this.length())return this.lfa.K(d);pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getCount(){this.Whb();
return this.lfa.count}getItem(d){(d=this.getItemOrNullObject(d))||pc.a.tl();return d}getItemOrNullObject(d){this.Whb();for(let n=0;n<this.lfa.count;n++)if(this.lfa.K(n).id==d)return this.lfa.K(n);return null}getOnlyItem(){const d=this.getOnlyItemOrNullObject();d||pc.a.tl();return d}getOnlyItemOrNullObject(){this.Whb();return 1==this.getCount()?this.lfa.K(0):null}Whb(){const d=this.rm.K4c(),n=new ma.a;for(let B=0;B<d.length;B++)if(d[B].namespace===this.qLk){const Q=this.M4a.create(d[B],this._context);
d[B].builtIn&&0!=n.count?n.insert(0,Q):n.add(Q)}this.lfa=n}_KeepReference(){this.$o()}_OnAccess(){this._context.vo.dhc(this.rm.Pma.currentNode)}getAsyncEnumerator(d,n){this.Whb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartScopedCollection"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.Aab();case 2:return this.A1(n);case 1004:return this.Uab(n);case 1005:return this.rJm();case 1006:return this.sJm();case 1002:return this.Sg();
case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Aab(){return this.getCount()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}Uab(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}rJm(){return this.getOnlyItem()}sJm(){return this.getOnlyItemOrNullObject()}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}}Object(D.a)(BH,"CustomXmlPartScopedCollection",rh.a,[866,893]);class Tz extends rh.a{constructor(d,n,B,Q,ha){super();this._context=d;this.rm=n;this.lfa=B;this.M4a=Q;this.Zc=ha}length(){return this.getCount()}_GetItem(d){if(pc.a.lO(d)<this.length())return this.lfa.K(d);pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}add(d){let n=null;({lhd:n}=this.rm.Ghf(d)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.Cd();d=
new ts(n,this.Zc);return this.M4a.create(d,this._context)}getByNamespace(d){this.Whb();const n=this.lfa,B=new ma.a;for(let Q=0;Q<n.count;Q++)n[Q].namespace===d&&B.add(this.M4a.create(n[Q],this._context));return 0==B.count?null:new BH(this._context,this.rm,B,d,this.M4a)}getCount(){this.Whb();return this.lfa.count}getItem(d){(d=this.getItemOrNullObject(d))||pc.a.tl();return d}getItemOrNullObject(d){this.Whb();for(let n=0;n<this.lfa.count;n++)if(this.lfa.K(n).id==d)return this.lfa.K(n);return null}Whb(){const d=
this.rm.K4c(),n=new ma.a;for(let B=0;B<d.length;B++){const Q=this.M4a.create(d[B],this._context);d[B].builtIn&&0!=n.count?n.insert(0,Q):n.add(Q)}this.lfa=n}_KeepReference(){this.$o()}_OnAccess(){this._context.vo.dhc(this.rm.Pma.currentNode)}getAsyncEnumerator(d,n){this.Whb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartCollection"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1004:return this.mVc(n);case 1005:return this.xqm(n);case 1003:return this.Aab();case 2:return this.A1(n);case 1006:return this.Uab(n);
case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}mVc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.add(d)}xqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByNamespace(d)}Aab(){return this.getCount()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getItem(d)}Uab(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(Tz,"CustomXmlPartCollection",rh.a,[866,893]);var oB=e(1539);class Ry extends rh.a{constructor(d){super();pc.a.Pz(d,"SectionCollection");this.cSc=d}length(){return this.cSc.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();
d||pc.a.tl();return d}getFirstOrNullObject(){pc.a.yj()||pc.a.Yj();return this.cSc&&this.cSc.count?this.cSc.K(0):null}_GetItem(d){d=pc.a.lO(d);if(0<=d&&d<this.length())return this.cSc.K(d);F.ULS.sendTraceTag(16814432,369,10,"The index is out of the section range.");pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.SectionCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(Ry,"SectionCollection",rh.a,[866,893]);class CH extends rh.a{constructor(d,n,B){super();this.R5a=d;this.kka=n;this.R3=B}get key(){return this.R5a}get value(){return this.R3.get(this.R5a).getValue(Dd.a.Afc)}set value(d){this.R3.get(this.R5a).setValue(Dd.a.Afc,
d)}get _Id(){return null}get _ReferenceId(){return this.kp?this.Jp:null}deleteObject(){const d=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled"),n=new vc.a;n.set(this.kka);let B=n.ic(21);for(;B;){if(B.getValue(Dd.a.aWc)===this.R5a){n.p$a(!d);break}B=n.gg(21)}d&&this.kka.gE(21);this.kka.setValue(xd.a.qW,new Date);this.R3.delete(this.R5a)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.R3.get(this.R5a),"Setting")}getTypeName(){return"Microsoft.WordServices.Setting"}invokePropertyGet(d){switch(d){case 2:return this.key;
case 3:return this.value;case 4:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(CH,"Setting",
rh.a,[866]);class pB extends rh.a{constructor(d,n){super();this.kka=d;this.Mcc=n;this.R3=new Map}get _ReferenceId(){return this.kp?this.Jp:null}add(d,n){d||pc.a.Cd();this.xRa();if(this.R3.has(d))this.R3.get(d).setValue(Dd.a.Afc,n),this.kka.setValue(xd.a.qW,new Date);else{const B=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled");n=this.Mcc.bxf(d,n);const Q=Ze.a.create(),ha=new vc.a;ha.set(this.kka);ha.a8(n,21,new Jh.a(Q,1),!B);B&&this.kka.gE(21);this.kka.setValue(xd.a.qW,
new Date);this.R3.set(d,n)}return new CH(d,this.kka,this.R3)}deleteAll(){this.R3.clear();const d=!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSettingsChangedEventIsEnabled"),n=new vc.a;for(n.set(this.kka);n.ic(21);)n.p$a(!d);d&&this.kka.gE(21);this.kka.setValue(xd.a.qW,new Date)}getCount(){this.xRa();return this.R3.size}getItem(d){this.xRa();(d=this.ZNf(d))||pc.a.tl();return d}getItemOrNullObject(d){this.xRa();return this.ZNf(d)}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){this.xRa();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.SettingCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.mVc(n);case 1005:return this.jzf();case 1004:return this.Aab();case 1:return this.A1(n);case 1006:return this.Uab(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}length(){return this.R3.size}_GetItem(d){d=
pc.a.lO(d);if(0>d||d>=this.R3.size)return pc.a.Cd(),null;const n=this.R3.keys();let B="";for(let Q=0;Q<=d;Q++)B=n.next().value;return this.ZNf(B)}mVc(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");return this.add(n,d)}jzf(){this.deleteAll();return null}Aab(){return this.getCount()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}Uab(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}xRa(){this.R3.clear();const d=new vc.a;d.set(this.kka);let n=d.ic(21);for(;n;){const B=n.getValue(Dd.a.aWc);this.R3.set(B,n);n=d.gg(21)}}ZNf(d){return this.R3.has(d)?new CH(d,this.kka,this.R3):null}}Object(D.a)(pB,"SettingCollection",rh.a,[866,893]);class gD extends rh.a{constructor(d,n,B){super();this.jh=d;this.Gr=n;this.Vk=
B}get alignment(){const d=this.Nq(this.jh);if(d.hasProperty(xd.a.Ki))switch(d.getValue(xd.a.Ki)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(d){let n=0;switch(d){case 0:n=1;break;case 2:n=3;break;case 1:n=2;break;case 3:n=6;break;default:F.ULS.sendTraceTag(509097629,369,15,"set ParagraphFormat.Alignment with not supported value: {0}.",d),pc.a.Cd()}d=new Map;d.set(xd.a.Ki,n);this.Du(d)}get firstLineIndent(){var d=
this.Nq(this.jh);if(d.hasProperty(Dd.a.vF))return d=d.getValue(Dd.a.vF),Mi.a.Xja(d)}set firstLineIndent(d){d=Mi.a.fM(d);const n=new Map;0<=d?n.set(Dd.a.vF,d):n.set(Dd.a.lv,d);this.Du(n)}get keepTogether(){const d=this.Nq(this.jh);if(d.hasProperty($m.a.keepTogether))return d.getValue($m.a.keepTogether)}set keepTogether(d){pc.a.Pz(d,"ParagraphFormat.KeepTogether");const n=new Map;n.set($m.a.keepTogether,d);this.Du(n)}get keepWithNext(){const d=this.Nq(this.jh);if(d.hasProperty($m.a.keepWithNext))return d.getValue($m.a.keepWithNext)}set keepWithNext(d){pc.a.Pz(d,
"ParagraphFormat.KeepWithNext");const n=new Map;n.set($m.a.keepWithNext,d);this.Du(n)}get leftIndent(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.ve))return d=d.getValue(Dd.a.ve),Mi.a.Xja(d)}set leftIndent(d){const n=new Map;n.set(Dd.a.ve,Mi.a.fM(d));this.Du(n)}get lineSpacing(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.xa))return d=d.getValue(Dd.a.xa),Mi.a.Xja(d)}set lineSpacing(d){pc.a.D3a(d,"ParagraphFormat.LineSpacing");const n=new Map;n.set(Dd.a.xa,Mi.a.fM(d));this.Du(n)}get lineUnitAfter(){var d=
this.Nq(this.jh);if(d.hasProperty(Dd.a.O5))return d.getValue(Dd.a.O5)/100;if(d.hasProperty(Dd.a.ua))return d=d.getValue(Dd.a.ua),Mi.a.Xja(d)/12}set lineUnitAfter(d){pc.a.C3a(d,"ParagraphFormat.LineUnitAfter");const n=new Map;n.set(Dd.a.O5,100*d);n.set(Dd.a.Kia,!1);this.Du(n)}get lineUnitBefore(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.P5))return d.getValue(Dd.a.P5)/100;if(d.hasProperty(Dd.a.vk))return d=d.getValue(Dd.a.vk),Mi.a.Xja(d)/12}set lineUnitBefore(d){pc.a.C3a(d,"ParagraphFormat.LineUnitBefore");
const n=new Map;n.set(Dd.a.P5,100*d);n.set(Dd.a.Lia,!1);this.Du(n)}get mirrorIndents(){}set mirrorIndents(d){}get outlineLevel(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.jk))return d.getValue(Dd.a.jk)}set outlineLevel(d){if(0>d||9<d)F.ULS.sendTraceTag(509097628,369,10,"Set OutlineLevel with not supported value: {0}.",d),pc.a.Cd();const n=new Map;n.set(Dd.a.jk,d);this.Du(n)}get rightIndent(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Ax))return d=d.getValue(Dd.a.Ax),Mi.a.Xja(d)}set rightIndent(d){const n=
new Map;n.set(Dd.a.Ax,Mi.a.fM(d));this.Du(n)}get spaceAfter(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.O5))return d.getValue(Dd.a.O5)/100*12;if(d.hasProperty(Dd.a.ua))return d=d.getValue(Dd.a.ua),Mi.a.Xja(d)}set spaceAfter(d){pc.a.C3a(d,"ParagraphFormat.SpaceAfter");const n=this.Nq(this.jh),B=new Map;B.set(Dd.a.ua,Mi.a.fM(d));B.set(Dd.a.Kia,!1);n.fg(Dd.a.O5);this.Du(B)}get spaceBefore(){var d=this.Nq(this.jh);if(d.hasProperty(Dd.a.P5))return d.getValue(Dd.a.P5)/100*12;if(d.hasProperty(Dd.a.vk))return d=
d.getValue(Dd.a.vk),Mi.a.Xja(d)}set spaceBefore(d){pc.a.C3a(d,"ParagraphFormat.SpaceBefore");const n=this.Nq(this.jh),B=new Map;B.set(Dd.a.vk,Mi.a.fM(d));B.set(Dd.a.Lia,!1);n.fg(Dd.a.P5);this.Du(B)}get widowControl(){const d=this.Nq(this.jh);if(d.hasProperty($m.a.widowControl))return d.getValue($m.a.widowControl)}set widowControl(d){pc.a.Pz(d,"ParagraphFormat.WidowControl");const n=new Map;n.set($m.a.widowControl,d);this.Du(n)}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){return this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.ParagraphFormat"}invokePropertyGet(d){switch(d){case 2:return this.alignment;
case 3:return this.firstLineIndent;case 4:return this.keepTogether;case 5:return this.keepWithNext;case 6:return this.leftIndent;case 7:return this.lineSpacing;case 8:return this.lineUnitAfter;case 9:return this.lineUnitBefore;case 10:return this.mirrorIndents;case 11:return this.outlineLevel;case 12:return this.rightIndent;case 13:return this.spaceAfter;case 14:return this.spaceBefore;case 15:return this.widowControl;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 3:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 4:this.keepTogether=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 5:this.keepWithNext=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 6:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 7:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 8:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 9:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 10:this.mirrorIndents=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 11:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 12:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 13:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 14:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 15:this.widowControl=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}Du(d){const n=new ig.ScriptSharpLegacyMap;for(const B of d)n.W(B[0],B[1]);this.Gr.IEa(this.jh,n,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),d=n.Qg(d));return d}}Object(D.a)(gD,"ParagraphFormat",rh.a,[866]);var at;(function(d){d[d.character=0]="character";d[d.list=1]="list";d[d.paragraph=2]="paragraph";d[d.table=3]="table"})(at||(at={}));Object(D.b)("StyleType",at);class DH extends rh.a{constructor(d,n,B,Q){super();this._context=
d;this.jh=n;this.Gr=B;this.Vk=Q}get backgroundPatternColor(){var d=this.Nq(this.jh);const n=d.getValue(Ya.a.ma);if(3===at[nB.a[n]])if(d.hasProperty(xd.a.YE))d=d.getValue(xd.a.YE);else return;else if(d.hasProperty(Ya.a.shading))d=d.getValue(Ya.a.shading);else return;return 16777215<d?null:Vf.a.zB(d).toUpperCase()}set backgroundPatternColor(d){d=pc.a.yya(d,"Font.Color",this._context);const n=this.Nq(this.jh).getValue(Ya.a.ma);3===at[nB.a[n]]?this.Du(xd.a.YE,Number("0x"+d)):this.Du(Ya.a.shading,Number("0x"+
d))}get foregroundPatternColor(){}set foregroundPatternColor(d){}get texture(){}set texture(d){}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Shading"}invokePropertyGet(d){switch(d){case 3:return this.backgroundPatternColor;case 4:return this.foregroundPatternColor;case 5:return this.texture;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.backgroundPatternColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.foregroundPatternColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 5:this.texture=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Du(d,n){const B=new ig.ScriptSharpLegacyMap;
B.W(d,n);this.Gr.IEa(this.jh,B,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),d=n.Qg(d));return d}}Object(D.a)(DH,"Shading",rh.a,[866]);const EH=new Map([[0,[Dd.a.cqa,Dd.a.jb,Dd.a.ib]],[1,[Dd.a.$pa,Dd.a.wb,Dd.a.vb]],[2,[Dd.a.Ypa,Dd.a.hb,Dd.a.gb]],[3,[Dd.a.bqa,Dd.a.yb,Dd.a.xb]],[4,[Dd.a.dya,Dd.a.Ab,Dd.a.zb]],[5,[Dd.a.BGa,Dd.a.Xb,Dd.a.Wb]]]),dK=new Map([["mixed",-1],["none",0],["single",1],["double",3],["dotted",6],["dashed",7],["dotDash",8],["dotDotDash",9],["triple",
10],["thinThickSmallGap",11],["thickThinSmallGap",12],["thinThickThinSmallGap",13],["thinThickMediumGap",14],["thickThinMediumGap",15],["thinThickThinMediumGap",16],["thinThickLargeGap",17],["thickThinLargeGap",18],["thinThickThinLargeGap",19],["wave",20],["doubleWave",21],["dashSmallGap",22],["dashDotStroked",23],["threeDEmboss",24],["threeDEngrave",25]]);class eF extends rh.a{constructor(d,n,B,Q,ha){super();this._context=d;this.jh=n;this.Gr=B;this.Vk=Q;this.pQ=ha;this.mla=EH.get(ha)}get color(){var d=
this.Nq(this.jh);if(d.hasProperty(this.mla[0]))return d=d.getValue(this.mla[0]),16777215<d?"#000000":Vf.a.zB(d).toUpperCase()}set color(d){d=pc.a.yya(d,"Shading.BackgroundPatternColor",this._context);this.Du(this.mla[0],Number("0x"+d))}get type(){var d=this.Nq(this.jh);if(d.hasProperty(this.mla[1]))return d=d.getValue(this.mla[1]),dK.get(d)}set type(d){let n,B;for([n,B]of dK.entries())if(B===d)break;this.Du(this.mla[1],n)}get width(){const d=this.Nq(this.jh);if(d.hasProperty(this.mla[2]))return d.getValue(this.mla[2])}set width(d){this.Du(this.mla[2],
d)}get location(){return this.pQ}get visible(){}set visible(d){}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Border"}invokePropertyGet(d){switch(d){case 2:return this.color;case 3:return this.type;case 4:return this.width;case 6:return this.location;case 5:return this.visible;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 5:this.visible=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Du(d,n){const B=new ig.ScriptSharpLegacyMap;
B.W(d,n);this.Gr.IEa(this.jh,B,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),d=n.Qg(d));return d}}Object(D.a)(eF,"Border",rh.a,[866]);class qB extends rh.a{constructor(d,n,B,Q){super();this.Y6b=new ma.a;this._context=d;this.jh=n;this.Gr=B;this.Vk=Q;for(d=0;6>d;++d)this.Y6b.push(new eF(this._context,this.jh,this.Gr,this.Vk,d))}length(){return 6}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.Y6b.K(d);F.ULS.sendTraceTag(508052546,369,10,"The index is out of the border range.");
pc.a.Cd();return null}get insideBorderColor(){}set insideBorderColor(d){}get insideBorderType(){}set insideBorderType(d){}get insideBorderWidth(){}set insideBorderWidth(d){}get outsideBorderColor(){}set outsideBorderColor(d){}get outsideBorderType(){}set outsideBorderType(d){}get outsideBorderWidth(){}set outsideBorderWidth(d){}get _ReferenceId(){return this.kp?this.Jp:null}getByLocation(d){return this.Y6b.K(d)}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){return this.Y6b.K(0)}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,
n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.BorderCollection"}invokePropertyGet(d){switch(d){case 2:return this.insideBorderColor;case 3:return this.insideBorderType;case 4:return this.insideBorderWidth;case 5:return this.outsideBorderColor;case 6:return this.outsideBorderType;case 7:return this.outsideBorderWidth;case 8:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.insideBorderColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.insideBorderType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.insideBorderWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 5:this.outsideBorderColor=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.outsideBorderType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 7:this.outsideBorderWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1001:return this.uqm(n);case 1004:return this.JC();case 1005:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1003:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}uqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getByLocation(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(qB,"BorderCollection",rh.a,[866,893]);class rB extends rh.a{constructor(d,n,B){super();this.jh=d;this.Gr=n;this.Vk=B}get alignment(){}set alignment(d){}get allowBreakAcrossPage(){}set allowBreakAcrossPage(d){}get bottomCellMargin(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Ga))return Mi.a.GCb(d.getValue(Dd.a.Ga))/2}set bottomCellMargin(d){this.Du(Dd.a.Ga,
Math.round(Mi.a.b2c(Mi.a.yuc(2*d))))}get cellSpacing(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.dCc))return Mi.a.GCb(d.getValue(Dd.a.dCc))}set cellSpacing(d){this.Du(Dd.a.dCc,Math.round(Mi.a.b2c(Mi.a.yuc(d))))}get leftCellMargin(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Ba))return Mi.a.GCb(d.getValue(Dd.a.Ba))/2}set leftCellMargin(d){this.Du(Dd.a.Ba,Math.round(Mi.a.b2c(Mi.a.yuc(2*d))))}get rightCellMargin(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Ea))return Mi.a.GCb(d.getValue(Dd.a.Ea))/
2}set rightCellMargin(d){this.Du(Dd.a.Ea,Math.round(Mi.a.b2c(Mi.a.yuc(2*d))))}get topCellMargin(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Ha))return Mi.a.GCb(d.getValue(Dd.a.Ha))/2}set topCellMargin(d){this.Du(Dd.a.Ha,Math.round(Mi.a.b2c(Mi.a.yuc(2*d))))}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.TableStyle"}invokePropertyGet(d){switch(d){case 3:return this.alignment;case 2:return this.allowBreakAcrossPage;
case 4:return this.bottomCellMargin;case 8:return this.cellSpacing;case 5:return this.leftCellMargin;case 6:return this.rightCellMargin;case 7:return this.topCellMargin;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return;case 2:this.allowBreakAcrossPage=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 4:this.bottomCellMargin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 8:this.cellSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 5:this.leftCellMargin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 6:this.rightCellMargin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return;case 7:this.topCellMargin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=
this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Du(d,n){const B=new ig.ScriptSharpLegacyMap;B.W(d,n);this.Gr.IEa(this.jh,B,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),d=n.Qg(d));return d}}Object(D.a)(rB,"TableStyle",rh.a,[866]);class Sy extends rh.a{constructor(d,n,B,Q,ha){super();this._context=d;this.ME=n;this.jh=B;this.Gr=Q;this.Vk=ha;if(2===this.type||
3===this.type)this.FOk=new gD(this.jh,this.Gr,this.Vk);3===this.type&&(this.KVk=new rB(this.jh,this.Gr,this.Vk),this.Y6b=new qB(this._context,this.jh,this.Gr,this.Vk));this._font=this.ME.create(null,null,null,null,null,this.jh);this.GPd=new DH(this._context,this.jh,this.Gr,this.Vk)}get baseStyle(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.pa))return d.getValue(Dd.a.pa)}set baseStyle(d){let n;n=qj.a.Zf.zl?this.Vk.Sua().Ena(d):this.Vk.Il().Rua(d);var B=n.getValue(Ya.a.ma);B=at[nB.a[B]];n&&this.type===
B&&d!==this.nameLocal&&"Normal"!==this.nameLocal||pc.a.Cd();this.Du(Dd.a.pa,d)}get borders(){return this.Y6b}get builtIn(){}get description(){}get font(){return this._font}get inUse(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.N7i))return d.getValue(Dd.a.N7i)}get linked(){return this.Nq(this.jh).hasProperty(Dd.a.linkedStyle)?!0:!1}get listTemplate(){return null}get nameLocal(){const d=this.Nq(this.jh);return this.Vk.ML(d)}get nextParagraphStyle(){const d=this.Nq(this.jh);if(d.hasProperty(Ya.a.se))return d.getValue(Ya.a.se)}set nextParagraphStyle(d){0===
this.type&&pc.a.Yj();let n;n=qj.a.Zf.zl?this.Vk.Sua().Ena(d):this.Vk.Il().Rua(d);var B=n.getValue(Ya.a.ma);B=at[nB.a[B]];n&&this.type===B||pc.a.Cd();this.Du(Ya.a.se,d)}get paragraphFormat(){return this.FOk}get priority(){const d=this.Nq(this.jh);if(d.hasProperty($m.a.oa))return d.getValue($m.a.oa)}set priority(d){pc.a.C3a(d,"Style.Priority");this.Du($m.a.oa,d)}get quickStyle(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Rd))return d.getValue(Dd.a.Rd)}set quickStyle(d){pc.a.Pz(d,"Style.QuickStyle");
this.Du(Dd.a.Rd,d)}get shading(){return this.GPd}get tableStyle(){return this.KVk}get type(){const d=this.Nq(this.jh).getValue(Ya.a.ma);return at[nB.a[d]]}get unhideWhenUsed(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.unhideWhenUsed))return d.getValue(Dd.a.unhideWhenUsed)}set unhideWhenUsed(d){pc.a.Pz(d,"Style.UnhideWhenUsed");this.Du(Dd.a.unhideWhenUsed,d)}get visibility(){const d=this.Nq(this.jh);if(d.hasProperty(Dd.a.Mob))return d.getValue(Dd.a.Mob)}set visibility(d){pc.a.Pz(d,"Style.Visibility");
this.Du(Dd.a.Mob,d)}get _ReferenceId(){return this.kp?this.Jp:null}deleteObject(){const d=new ma.a;d.add(this.jh);this.Gr.iji(d)}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Style"}invokePropertyGet(d){switch(d){case 2:return this.baseStyle;case 19:return this.borders;case 3:return this.builtIn;case 4:return this.description;case 5:return this.font;case 6:return this.inUse;case 7:return this.linked;case 16:return this.listTemplate;case 8:return this.nameLocal;
case 9:return this.nextParagraphStyle;case 15:return this.paragraphFormat;case 10:return this.priority;case 11:return this.quickStyle;case 17:return this.shading;case 18:return this.tableStyle;case 12:return this.type;case 13:return this.unhideWhenUsed;case 14:return this.visibility;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
n){switch(d){case 2:this.baseStyle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 9:this.nextParagraphStyle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 10:this.priority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 11:this.quickStyle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.unhideWhenUsed=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 14:this.visibility=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Du(d,n){const B=new ig.ScriptSharpLegacyMap;B.W(d,n);this.Gr.IEa(this.jh,B,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),d=n.Qg(d));return d}}Object(D.a)(Sy,"Style",rh.a,[866]);class sB extends rh.a{constructor(d,n,B,Q){super();this.k4e=new Map;
this.$rh=new Map;this._context=d;this.ME=n;this.Gr=B;this.Vk=Q;this.odc=qj.a.Zf.zl?this.Vk.Sua():this.Vk.Il()}length(){return this.odc.ix}_GetItem(d){if(pc.a.lO(d)<this.length())return this.$rh.get(d);F.ULS.sendTraceTag(508941208,369,10,"The index is out of the style collection range.");pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}getByName(d){(d=this.getByNameOrNullObject(d))||pc.a.tl();return d}getByNameOrNullObject(d){if(this.k4e.has(d))return this.k4e.get(d);var n;return(n=
qj.a.Zf.zl?this.odc.Ena(d):this.odc.Rua(d))?(n=new Sy(this._context,this.ME,this.Vk.Je(n),this.Gr,this.Vk),this.k4e.set(d,n),n):null}getCount(){return this.odc.ix}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){this.nQg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}nQg(){for(let d=0;d<this.length();d++){const n=new Sy(this._context,this.ME,this.RXm(d),this.Gr,this.Vk);this.$rh.set(d,n)}}RXm(d){return qj.a.Zf.zl?(d=this.odc.uha(d),qj.a.kc.Je(d)):
this.odc.nDa(d).getValue(Ya.a.la)}getTypeName(){return"Microsoft.WordServices.StyleCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.vqm(n);case 1004:return this.wqm(n);case 1005:return this.Aab();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}vqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getByName(d)}wqm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByNameOrNullObject(d)}Aab(){return this.getCount()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(sB,"StyleCollection",rh.a,[866,893]);class FH extends rh.a{constructor(d,n,B,Q,ha){super();this.context=d;this.annotation=n;this.IMb=
B;this.lKa=Q;this.Pmd=ha}get critique(){if(!Fi.a.EF)return null;let d=new qq;d.colorScheme=this.nQn(this.IMb.squiggleColor);const {ru:n,cpEnd:B}=this.lKa.QVh(this.annotation);d.start=n;d.length=B-n;return d}nQn(d){switch(d){case Zs.a.Red:return 0;case Zs.a.Blue:return 2;case Zs.a.Green:return 1;case Zs.a.Lavender:return 3;case Zs.a.Berry:return 4;default:throw Error("Invalid squiggle color");}}get range(){if(!Fi.a.EF)return null;const {ru:d,cpEnd:n}=this.lKa.QVh(this.annotation);this.annotation.Zvb||
pc.a.vg();var B=ge.a.createTextRange(this.annotation.parent,d,n);B=new ma.a([B]);return this.Pmd.create(B,this.context)}get _ReferenceId(){return this.kp?this.Jp:null}accept(){Fi.a.EF||pc.a.Yj();this.lKa.Nea(this.annotation,60)}reject(){Fi.a.EF||pc.a.Yj();this.lKa.Nea(this.annotation,70)}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.CritiqueAnnotation"}invokePropertyGet(d){switch(d){case 2:return this.critique;case 3:return this.range;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1003:return this.Lgf();case 1004:return this.$ug();case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Lgf(){this.accept();return null}$ug(){this.reject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(FH,"CritiqueAnnotation",rh.a,[866]);var fF=e(1447),gF=e(1115);class eK extends rh.a{constructor(d,n,B,Q){super();this.annotation=d;this.context=n;this.lKa=B;this.Pmd=Q;fF.a.Jpc(d.content)?this.IMb=d.content:pc.a.vg()}get critiqueAnnotation(){return Fi.a.EF?
this.IMb?new FH(this.context,this.annotation,this.IMb,this.lKa,this.Pmd):null:null}get id(){var d;return Fi.a.EF&&null!==(d=this.IMb)&&void 0!==d&&d.id?this.IMb.id:null}get state(){var d;if(!Fi.a.EF)return null;const n=null===(d=this.IMb)||void 0===d?void 0:d.M_.state;if(!n)return 0;switch(n){case gF.a.Kept:return 1;case gF.a.Rejected:return 2;case gF.a.Created:return 0;default:return F.ULS.sendTraceTag(508126469,369,10,"Unexpected annotation state: "+gF.a[n],this.context.appId),0}}get _ReferenceId(){return this.kp?
this.Jp:null}deleteObject(){Fi.a.EF||pc.a.Yj();this.lKa.aWl(this.annotation)}_KeepReference(){this.$o()}_OnAccess(){}getTypeName(){return Fi.a.EF?"Microsoft.WordServices.Annotation":"Microsoft.WordServices.AddInCritiqueAnnotation"}invokePropertyGet(d){switch(d){case 3:return this.critiqueAnnotation;case 1:return this.id;case 4:return this.state;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(eK,"Annotation",rh.a,[866]);const hD=new Map([["baseStyle",2],["builtIn",3],["description",4],["font",5],["inUse",6],["linked",7],["nameLocal",8],["nextParagraphStyle",9],["priority",10],["quickStyle",11],["type",12],["unhideWhenUsed",13],["visibility",14],["paragraphFormat",15],["listTemplate",16],["shading",
17],["tableStyle",18],["borders",19]]),tB=new Map([["name",2],["size",3],["bold",4],["italic",5],["color",6],["underline",7],["subscript",8],["superscript",9],["strikeThrough",10],["doubleStrikeThrough",11],["highlightColor",12],["hidden",13]]),fK=new Map([["alignment",2],["firstLineIndent",3],["keepTogether",4],["keepWithNext",5],["leftIndent",6],["lineSpacing",7],["lineUnitAfter",8],["lineUnitBefore",9],["mirrorIndents",10],["outlineLevel",11],["rightIndent",12],["spaceAfter",13],["spaceBefore",
14],["widowControl",15]]),hF=new Map([["allowBreakAcrossPage",2],["alignment",3],["bottomCellMargin",4],["leftCellMargin",5],["rightCellMargin",6],["topCellMargin",7],["cellSpacing",8]]),gK=new Map([["color",2],["type",3],["width",4],["visible",5],["location",6]]),hK=new Map([["backgroundPatternColor",3],["foregroundPatternColor",4],["texture",5]]),uB=new Set("builtIn description inUse linked nameLocal type listTemplate location".split(" ")),GH=new Map([["type",new Map([["Character",0],["List",1],
["Paragraph",2],["Table",3]])],["alignment",new Map([["Mixed",-2],["Unknown",-1],["Left",0],["Centered",1],["Right",2],["Justified",3]])],["outlineLevel",new Map([["OutlineLevel1",0],["OutlineLevel2",1],["OutlineLevel3",2],["OutlineLevel4",3],["OutlineLevel5",4],["OutlineLevel6",5],["OutlineLevel7",6],["OutlineLevel8",7],["OutlineLevel9",8],["OutlineLevelBodyText",9]])],["underline",new Map([["Mixed",-1],["None",0],["Hidden",5],["DotLine",8],["Single",1],["Word",2],["Double",3],["Thick",6],["Dotted",
4],["DottedHeavy",20],["DashLine",7],["DashLineHeavy",23],["DashLineLong",39],["DashLineLongHeavy",55],["DotDashLine",9],["DotDashLineHeavy",25],["TwoDotDashLine",10],["TwoDotDashLineHeavy",26],["Wave",11],["WaveHeavy",27],["WaveDouble",43]])],["trailingCharacter",new Map([["TrailingTab",0],["TrailingSpace",1],["TrailingNone",2]])],["numberStyle",new Map([["None",-1],["Arabic",0],["UpperRoman",1],["LowerRoman",2],["UpperLetter",3],["LowerLetter",4],["Ordinal",5],["CardinalText",6],["OrdinalText",
7],["Kanji",10],["KanjiDigit",11],["AiueoHalfWidth",12],["IrohaHalfWidth",13],["ArabicFullWidth",14],["KanjiTraditional",16],["KanjiTraditional2",17],["NumberInCircle",18],["Aiueo",20],["Iroha",21],["ArabicLZ",22],["Bullet",23],["Ganada",24],["Chosung",25],["GBNum1",26],["GBNum2",27],["GBNum3",28],["GBNum4",29],["Zodiac1",30],["Zodiac2",31],["Zodiac3",32],["TradChinNum1",33],["TradChinNum2",34],["TradChinNum3",35],["TradChinNum4",36],["SimpChinNum1",37],["SimpChinNum2",38],["SimpChinNum3",39],["SimpChinNum4",
40],["HanjaRead",41],["HanjaReadDigit",42],["Hangul",43],["Hanja",44],["Hebrew1",45],["Arabic1",46],["Hebrew2",47],["Arabic2",48],["HindiLetter1",49],["HindiLetter2",50],["HindiArabic",51],["HindiCardinalText",52],["ThaiLetter",53],["ThaiArabic",54],["ThaiCardinalText",55],["VietCardinalText",56],["LowercaseRussian",58],["UppercaseRussian",59],["LowercaseGreek",60],["UppercaseGreek",61],["ArabicLZ2",62],["ArabicLZ3",63],["ArabicLZ4",64],["LowercaseTurkish",65],["UppercaseTurkish",66],["LowercaseBulgarian",
67],["UppercaseBulgarian",68],["PictureBullet",249],["Legal",253],["LegalLZ",254]])],["texture",new Map([["DarkDiagonalDown",-3],["DarkDiagonalUp",-4],["DarkGrid",-5],["DarkHorizontal",-1],["DarkTrellis",-6],["DarkVertical",-2],["LightDiagonalDown",-9],["LightDiagonalUp",-10],["LightGrid",-11],["LightHorizontal",-7],["LightTrellis",-12],["LightVertical",-8],["None",0],["Percent10",100],["Percent12Pt5",125],["Percent15",150],["Percent20",200],["Percent25",250],["Percent30",300],["Percent35",350],["Percent37Pt5",
375],["Percent40",400],["Percent45",450],["Percent5",50],["Percent50",500],["Percent55",550],["Percent60",600],["Percent62Pt5",625],["Percent65",650],["Percent70",700],["Percent75",750],["Percent80",800],["Percent85",850],["Percent87Pt5",875],["Percent90",900],["Percent95",950],["Solid",1E3]])],["borderType",new Map([["Mixed",-1],["None",0],["Single",1],["Double",3],["Dotted",6],["Dashed",7],["DotDashed",8],["Dot2Dashed",9],["Triple",10],["ThinThickSmall",11],["ThickThinSmall",12],["ThinThickThinSmall",
13],["ThinThickMed",14],["ThickThinMed",15],["ThinThickThinMed",16],["ThinThickLarge",17],["ThickThinLarge",18],["ThinThickThinLarge",19],["Wave",20],["DoubleWave",21],["DashedSmall",22],["DashDotStroked",23],["ThreeDEmboss",24],["ThreeDEngrave",25]])],["width",new Map([["None",0],["Pt025",2],["Pt050",4],["Pt075",6],["Pt100",8],["Pt150",12],["Pt225",18],["Pt300",24],["Pt450",36],["Pt600",48],["Undefined",9999999]])],["location",new Map([["Top",0],["Left",1],["Bottom",2],["Right",3],["InsideHorizontal",
4],["InsideVertical",5]])]]),Ty=new Map([["Mixed",-1],["None",0],["Single",1],["Double",3],["Dotted",6],["Dashed",7],["DotDash",8],["DotDotDash",9],["Triple",10],["ThinThickSmallGap",11],["ThickThinSmallGap",12],["ThinThickThinSmallGap",13],["ThinThickMediumGap",14],["ThickThinMediumGap",15],["ThinThickThinMediumGap",16],["ThinThickLargeGap",17],["ThickThinLargeGap",18],["ThinThickThinLargeGap",19],["Wave",20],["DoubleWave",21],["DashSmallGap",22],["DashDotStroked",23],["ThreeDEmboss",24],["ThreeDEngrave",
25]]),HH=new Set("type alignment outlineLevel underline trailingCharacter numberStyle texture insideBorderType outsideBorderType insideBorderWidth outsideBorderWidth borderType width location".split(" "));class uu{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi,oi,Ni,wh,lg,Lg){this.QRb=oi;this.Wmg=Ni;this.nwc=wh;this.ax=lg;this.lKa=Lg;this.PNe=new ff.a;this.ZEo=()=>{this._RemoveAllReferences()};this.Ngl=()=>{this._context.vo.ex()};pc.a.Pz(d,"Document");this.Bw=
d;this._context=n;this.eS=B;this.xAa=Q;this.Jk=ha;this.ga=Aa;this.pb=bb;this.nI=Ib;this.km=oc;Ac.ljf(this.ZEo);this.gEk=ad;this.uh=sd;this.LFb=wd;this.stk=yd;this.Tp=be;this.qb=ye;this.wD=Qe;this.fz=af;this.lz=Qf;this.rm=hf;this.M4a=di;this.Zc=vj;this.Mcc=Wk;this.Vk=Tm;this.Gr=Dk;this.ME=gi}get context(){return this._context}get allowCloseOnUntitled(){return!1}set allowCloseOnUntitled(d){pc.a.Yj()}get body(){return this.eS.create(this.nI.DT(this.Bw.value),this._context)}get changeTrackingMode(){return this.lz.srm()}set changeTrackingMode(d){this.lz.OZo(this.ga,
d)}get contentControls(){const d=new Ei;d.types=[31];return this.getContentControls(d)}get customXmlParts(){const d=this.rm.K4c(),n=new ma.a;for(let B=0;B<d.length;B++){const Q=this.M4a.create(d[B],this._context);d[B].builtIn&&0!=n.count?n.insert(0,Q):n.add(Q)}return new Tz(this._context,this.rm,n,this.M4a,this.Zc)}get properties(){pc.a.yj()||pc.a.Yj("Getter");return this.LFb}get saved(){return!this.gEk()}get sections(){const d=vc.a.kb(this.nI.DT(this.Bw.value)),n=new ma.a;let B=0;this.km.HXa(d,Q=>
{n.add(this.xAa.create(Q,this._context,B++));return!0});return new Ry(n)}get settings(){this.context.xk||pc.a.vg();const d=this.Mcc.Usb(this.Bw,this.nI);d||pc.a.vg();let n=this.Mcc.WCa(this.context.xk,d.currentNode);n||(n=this.Mcc.fvb(this.context.xk,d.currentNode));n||pc.a.vg();return new pB(n,this.Mcc)}get _ReferenceId(){return null}addStyle(d,n){pc.a.D3j()||pc.a.Yj();var B=this.Vk.Il();d=Ca.a.N1(d);const Q=Ca.a.LFa(d);B.Qg(d)&&pc.a.Cd();B=qj.a.Pp();const ha=new Mc.GraphTransaction(15);ha.Eb(B);
ha.Bh=Se.a.qPb;let Aa;Aa=qj.a.Zf.zl?new SM.a(new XL.a):new Bm.a(new XL.a);try{Aa.setValue(Dd.a.na,Q),Aa.setValue(Ya.a.la,d),Aa.setValue(Ya.a.styleName,d),Aa.setValue(Ya.a.L0a,d),Aa.setValue(Ya.a.ma,nB.a[at[n]]),Aa.setValue(xd.a.highlight,Vf.a.auto),Aa.setValue(Ya.a.shading,Vf.a.auto),Aa.setValue(Dd.a.Rd,!0),Aa.setValue(Dd.a.ye,!0),Aa.setValue(Dd.a.pa,kr.a.wordStyleIdNormal),Aa.fg(Dd.a.cG),n=[],n.push(Aa),qj.a.fVc(n,B)}finally{ha.dispose()}return new Sy(this._context,this.ME,d,this.Gr,this.Vk)}deleteBookmark(d){(d=
this.Tp.XCa(d))&&this.Tp.EHj(d.id)}getAnnotationById(d){Fi.a.ryi||pc.a.Yj();return d?(d=this.ax.Qxi(d))&&d.content.addInId===(this.context.xk.rK&&Fi.a.TVc?this.context.xk.rK.$n:this.context.xk.$n)?new eK(d,this._context,this.lKa,this.Jk):null:null}getAnnotationsByType(d){this._context.vo.qH();this._context.vo.ex();let n;this.PNe.Bb(d)?n=this.PNe.K(d):(n=this.stk.create(d,this._context),this.PNe.add(d,n));return n.refresh().then(()=>OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n))}getBookmarkRange(d){(d=
this.getBookmarkRangeOrNullObject(d))||pc.a.tl();return d}getBookmarkRangeOrNullObject(d){const n=this.Tp.BPf(d);if(!n||n&&0==n.count)return null;const B=new ma.a;d=this.Tp.XCa(d);var Q=this.Tp.YCa(d,!0);var ha=n.K(0);if(1==n.count){var Aa=this.Tp.YCa(d,!1);Aa=Aa.oga.Rb.cp;Q=Q.oga.Rb.cp;ha=this.qb.textLength(ha)===Aa-Q?ge.a.create(ha):ge.a.createTextRange(ha,Q,Aa)}else Aa=Q.oga.Rb.cp,ha=0===Aa?ge.a.create(ha):ge.a.createTextRange(ha,Aa,this.qb.textLength(ha));B.add(ha);for(ha=1;ha<n.count;ha++)ha!=
n.count-1?B.add(ge.a.create(n.K(ha))):ha==n.count-1&&(Aa=this.Tp.YCa(d,!1))&&(Q=n.K(ha),Aa=Aa.oga.Rb.cp,Aa=this.qb.textLength(Q)===Aa?ge.a.create(Q):ge.a.createTextRange(n.K(ha),0,Aa),B.add(Aa));return this.Jk.create(B,this._context)}getContentControls(d){var n;d=null!==(n=null===d||void 0===d?void 0:d.types)&&void 0!==n?n:[];pc.a.s2c(d);n=this.uh.Lnm(this._context);return 0===d.length?n:null===n||void 0===n?void 0:n.getByTypes(d)}getEndnoteBody(){pc.a.r4c()||pc.a.Yj();return this.eS.create(this.JDi(0),
this._context)}getFootnoteBody(){pc.a.r4c()||pc.a.Yj();return this.eS.create(this.JDi(1),this._context)}getMetadata(){pc.a.Yj();return null}getNeighborhoodTextAroundSelection(){pc.a.Yj();return null}KQm(){var d=this.pb.ob.currentSelection;if(!d)return"NoSelection";d=d.toArray();for(let n=0;n<d.length;n++){const B=d[n];if(B.contextId===ed.a.Fba&&19===B.node.type)return"TextBoxSelection"}return"ValidSelection"}getSelection(){var d=this.pb.ob.currentSelection;d||pc.a.vg();d=d.toArray();const n=new ma.a;
for(let B=0;B<d.length;B++){const Q=d[B];Q.contextId===ed.a.Fba&&19===Q.node.type&&pc.a.zE();n.add(Q)}return this.Jk.create(n,this._context)}insertFileFromBase64(d,n,B){"<"===d.charAt(0)&&(F.ULS.sendTraceTag(509110469,369,10,"invalid argument for insertFileFromBase64 API in Document class.",this._context.appId),pc.a.Cd());null===B&&(B=new ok);return this.Jgn(d,n,B)}getStyles(){pc.a.D3j()||pc.a.Yj();return new sB(this._context,this.ME,this.Gr,this.Vk)}importStylesFromJson(d){d=JSON.parse(d).styles;
const n=[];for(let Q=0;Q<d.length;Q++){const ha=d[Q],Aa=ha.nameLocal;var B=this.j0d("type",ha.type);let bb,Ib=!0;try{bb=this.addStyle(Aa,B);for(const oc in ha)if("font"!==oc&&"paragraphFormat"!==oc&&"tableStyle"!==oc&&"borders"!==oc&&"shading"!==oc){if(!hD.has(oc))throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(oc);if(!uB.has(oc)){let Ac=ha[oc];HH.has(oc)&&(Ac=this.j0d(oc,ha[oc]));bb.invokePropertySet(hD.get(oc),[Ac])}}else{const Ac=bb.invokePropertyGet(hD.get(oc));if(Ac)if("font"===
oc)this.erd(Ac,ha[oc],tB);else if("paragraphFormat"===oc)this.erd(Ac,ha[oc],fK);else if("tableStyle"===oc)this.erd(Ac,ha[oc],hF);else if("shading"===oc)this.erd(Ac,ha[oc],hK);else if("borders"===oc){const ad=ha[oc].items;for(B=0;B<ad.length;++B){const sd=Ac.getByLocation(this.j0d("location",ad[B].location)),wd=ad[B].type;Ty.has(wd)||pc.a.Cd();sd.invokePropertySet(3,[Ty.get(wd)]);this.erd(sd,ad[B],gK)}}}}catch(oc){bb&&bb.deleteObject(),Ib=!1}Ib&&(n[n.length]=Aa)}return n}launchTapPane(){pc.a.Yj()}save(){this._context.vo.qH();
this.ga.soo(Se.a.E1b,this.Ngl)}close(){}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Bw.value,!0,!0,!0);this.wD.find(Q,d,n,B,this._context)})}getParagraphByUniqueLocalId(d){pc.a.Vmg||pc.a.Yj();(d=this.nwc.BIm(d))||pc.a.tl();const n=this.qb.ox(this.Bw.value,!0,!0,!0);let B=null;for(const Q of n)if(Q.id.toString()==d){B=this.Wmg.create(Q,this._context);break}B||pc.a.tl();return B}setMetadata(){pc.a.Yj()}setMetadataOnTile(){pc.a.Yj()}setNavigationPaneVisibility(d){this.ga.Vb(d?
dd.a.NAc:dd.a.GYc,2)}_GetObjectByReferenceId(d){return oB.a.instance.B6d(d)}_GetObjectTypeNameByReferenceId(d){return oB.a.instance.B6d(d).getTypeName()}_KeepReference(){}_OnAccess(){}_RegisterEvent(d,n){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,d,n)}_RemoveAllReferences(){oB.a.instance.pyl()}_RemoveReference(d){oB.a.instance.yGo(d)}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Bw.value,!0,!0,!0);this.wD.msb(Q,
d,n,B,this._context)})}_UnregisterEvent(d,n){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,d,n)}getTypeName(){return"Microsoft.WordServices.Document"}invokePropertyGet(d){switch(d){case 9:return this.allowCloseOnUntitled;case 3:return this.body;case 10:return this.changeTrackingMode;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;
case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 9:this.allowCloseOnUntitled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 10:this.changeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1028:return this.Gif(n);case 1011:return this.mzf(n);case 1031:return this.fom(n);case 1010:return this.tKf(n);case 1012:return this.uKf(n);case 1026:return this.zMa(n);case 1013:return this.SOf(n);case 1017:return this.CHm(n);case 1006:return this.PQm();case 1029:return this.wRf();case 1032:return this.Dan(n);case 1016:return this.IFn(n);
case 1005:return this.dAg(n);case 1027:return this.dAl(n);case 1014:return this.xDg(n);case 1015:return this.b3o(n);case 1021:return this.k3o(n);case 1001:return this.Crk(n);case 1002:return this.Drk(n);case 1008:return this.Sg();case 1007:return this.Tg();case 1018:return this.Frk(n);case 1004:return this.Mrk();case 1003:return this.Nrk(n);case 1019:return this.Rrk(n);case 1033:return this.NKm(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1020:return this.mom(n);
case 1022:return this.zxa(n);case 1023:return this.Hqa(n);case 1025:return this.Qxm();case 1024:return this.hAm();case 1030:return this.jva(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Gif(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.addStyle(n,d)}mzf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
this.deleteBookmark(d);return null}fom(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getAnnotationById(d)}Jgn(d,n,B){const Q=(new Date).getTime();let ha=new ma.a;const Aa=this.nI.DT(this.Bw.value);switch(n){case 2:var bb=this.qb.Vn(Aa);ha.add(ge.a.create(bb));break;case 3:bb=this.qb.vH(Aa);ha.add(ge.a.create(bb));break;case 4:ha=this.qb.LC(Aa,!0,!1);break;default:F.ULS.sendTraceTag(509110468,369,15,`AppId:${this._context.appId}, invalid insert location for document's insert Docx method`,
this._context.appId),pc.a.Cd()}return OfficeExtension.WacRuntime.Utility.createPromise((Ib,oc)=>{this.fz.insertOoxml(ha,d,n,Aa,this._context,Ib,oc,Q,1,0,!1,null,B)})}mom(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getAnnotationsByType(d)}tKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRange(d)}uKf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRangeOrNullObject(d)}zMa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}Qxm(){return this.getEndnoteBody()}hAm(){return this.getFootnoteBody()}SOf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMetadata(d)}CHm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.getNeighborhoodTextAroundSelection(d)}PQm(){return this.getSelection()}jva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,ok);return this.insertFileFromBase64(n,B,d)}wRf(){return this.getStyles()}Dan(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.importStylesFromJson(d)}IFn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.launchTapPane(d);return null}dAg(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.save(n,d);return null}dAl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.close(d);return null}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this._Search2(n,d)}xDg(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.setMetadata(n,d);return null}b3o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"any");this.setMetadataOnTile(n,B,d);return null}k3o(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");this.setNavigationPaneVisibility(d);return null}Crk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this._GetObjectByReferenceId(d)}Drk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this._GetObjectTypeNameByReferenceId(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Frk(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this._RegisterEvent(n,d);return null}Mrk(){this._RemoveAllReferences();return null}Nrk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this._RemoveReference(d);return null}Rrk(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this._UnregisterEvent(n,d);return null}NKm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getParagraphByUniqueLocalId(d)}JDi(d){const n=this.nI.DT(this.Bw.value);(d=this.QRb.Y5c(n,d))||pc.a.tl();return d}erd(d,n,B){for(const Q in n){if(!B.has(Q))throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);if(!uB.has(Q)){let ha=n[Q];HH.has(Q)&&(ha=this.j0d(Q,n[Q]));d.invokePropertySet(B.get(Q),[ha])}}}j0d(d,n){d=GH.get(d);d.has(n)||pc.a.Cd();return d.get(n)}}Object(D.a)(uu,"Document",null,[]);class iK{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,
ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi,oi,Ni,wh,lg,Lg){this.Kw=d;this.context=n;this.ckl=B;this.SUo=Q;this.Pmd=ha;this.Tb=Aa;this.ub=bb;this.A0a=Ib;this.wg=oc;this.Mfc=Ac;this.fR=ad;this.Duf=sd;this.xjc=wd;this.dbl=yd;this.wkm=be;this.gh=ye;this.BUo=Qe;this.wcm=af;this.Tup=Qf;this.Z9a=hf;this.qTl=di;this.Bq=vj;this.T7o=Wk;this.KBb=Tm;this.Q2=Dk;this.cim=gi;this.QRb=oi;this.Wmg=Ni;this.nwc=wh;this.ax=lg;this.lKa=Lg}create(){return new uu(this.Kw,this.context,this.ckl,this.SUo,this.Pmd,this.Tb,this.ub,this.A0a,
this.wg,this.Mfc,this.fR,this.Duf,this.xjc,this.dbl,this.wkm,this.gh,this.BUo,this.wcm,this.Tup,this.Z9a,this.qTl,this.Bq,this.T7o,this.KBb,this.Q2,this.cim,this.QRb,this.Wmg,this.nwc,this.ax,this.lKa)}}Object(D.a)(iK,"DocumentFactory",null,[]);class jK{constructor(d,n){this.iLh=this.WSc=null;this.Dbf=d;this.Zc=n;this.MK()}get EK(){return this.iLh}MK(){const d=this.Dbf.getValue(Dd.a.whi);this.WSc!==d&&(this.WSc=d,this.iLh=Rb.b(this.WSc))}$fb(){const d=this.Zc.Vc(4);d.Eb(this.Dbf);this.WSc=Rb.c(this.EK);
this.Dbf.setValue(Dd.a.whi,this.WSc);d.dispose()}}Object(D.a)(jK,"StandardPropertyDocument",null,[1180]);class dl extends ts{constructor(d,n){super(d,n)}mKi(){return this.selectNodes("//ns0:property",null).length}lKi(d){const n=this.selectNodes("//ns0:property",null);for(const B of n)if(this.getKey(B).toLowerCase()===d.toLowerCase())return B;return null}HNm(d){const n=this.selectNodes("//ns0:property",null);return 0<=d&&d<n.length?n[d]:null}e4k(d,n){if(void 0!==d&&null!==d&&void 0!==n&&null!==n){const B=
this.selectSingleNode("//ns0:Properties",null);if((d=this.INm(d,n))&&this.appendChild(B,d))return this.WNo(),!0}return!1}fWl(){if(this.mKi()){for(var d=this.selectSingleNode("//ns0:Properties",null);d.hasChildNodes();)d.removeChild(d.firstChild);this.save()}}getKey(d){if(void 0===d||null===d)return null;d=this.selectSingleNode("@name",d);return void 0!==d&&null!==d?this.getNodeText(d):null}iBe(d,n){if(void 0===d||null===d||void 0===n||null===n)return!1;d=this.selectSingleNode("@name",d);return void 0!==
d&&null!==d?this.setNodeText(d,n):!1}getType(d){return void 0!==d&&null!==d?this.getNodeBaseName(d.firstChild):null}getValue(d){return void 0!==d&&null!==d?this.getNodeText(d.firstChild):null}setValue(d,n){return void 0!==d&&null!==d&&void 0!==n&&null!==n?(n=this.HOi(n),!!n&&!!this.setNodeXml(d.firstChild,n)):!1}bXl(d){void 0!==d&&null!==d&&void 0!==d.parentNode&&null!==d.parentNode&&(d.parentNode.removeChild(d),this.save())}INm(d,n){return(n=this.HOi(n))?'<property xmlns="'+dl.W1d+'" fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="2" name="'+
Ca.a.Mf(d)+'">'+n+"</property>":null}HOi(d){var n=Object.getType(d);let B=null;n===Number?B=parseInt(String(d))===d?dl.Hfk:dl.Gfk:n===String?(n=RegExp("[0-9]{4}(-[0-9]{2}){2}T[0-9]{2}(:[0-9]{2}){2}\\.[0-9]{3}Z","g").exec(d),B=void 0!==n&&null!==n&&0<n.length&&n[0]===d?dl.Ffk:dl.Ifk,d=Ca.a.Mf(d)):n===Boolean&&(B=dl.Efk);return B?"<vt:"+B+' xmlns:vt="'+dl.rLp+'">'+d+"</vt:"+B+">":null}WNo(){const d=this.selectNodes("//@pid",null);for(let n=0;n<d.length;n++)this.setNodeText(d[n],(n+2).toString())}selectSingleNode(d,
n){d=this.selectNodes(d,n);return void 0!==d&&null!==d&&0<d.length?d[0]:null}}dl.W1d="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";dl.rLp="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes";dl.Hfk="i4";dl.Gfk="r8";dl.Ifk="lpwstr";dl.Efk="bool";dl.Ffk="filetime";Object(D.a)(dl,"CustomPropertyDocument",ts,[1203,1045]);class Uz extends rh.a{constructor(d,n,B,Q){super();this._context=d;this.jS=B;this.rm=n;this.L4a=Q}get key(){return this.jS.getKey(this.L4a)}get type(){let d=
0;switch(this.jS.getType(this.L4a)){case dl.Hfk:case dl.Gfk:d=1;break;case dl.Ifk:d=0;break;case dl.Efk:d=3;break;case dl.Ffk:d=2}return d}get value(){const d=this.jS.getValue(this.L4a);return 1===this.type?Number.parseInvariant(d):3===this.type?Boolean.parse(d):2===this.type?new Date(d):d}set value(d){this.jS.setValue(this.L4a,d)||pc.a.Cd()}get _Id(){return this.key}get _ReferenceId(){return this.kp?this.Jp:null}deleteObject(){this.jS.bXl(this.L4a);this.L4a=null}_KeepReference(){this.$o()}_OnAccess(){this._context.vo.dhc(this.rm.Pma.currentNode);
this.L4a||pc.a.tl();if(!this.jS.v2f()){this.jS.pQg();const d=this.jS.lKi(this.key);d?this.L4a=d:pc.a.tl()}}getTypeName(){return"Microsoft.WordServices.CustomProperty"}invokePropertyGet(d){switch(d){case 2:return this.key;case 4:return this.type;case 3:return this.value;case 5:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
n){switch(d){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}LNo(d){this.jS.iBe(this.L4a,d)}}Object(D.a)(Uz,"CustomProperty",rh.a,[866]);class IH extends rh.a{constructor(d,n,B,Q){super();this._context=d;this.rm=n;this.CIc=Q;this.Zc=B;d=this.rm.j9d(dl.W1d,!0);d=0<d.length?d[0]:this.eOl();this.jS=new dl(d,this.Zc)}length(){return this.getCount()}_GetItem(d){d=
pc.a.lO(d);if(d=this.jS.HNm(d))return new Uz(this._context,this.rm,this.jS,d);F.ULS.sendTraceTag(21016673,369,10,"The index is out of the CustomPropertyCollection range.");pc.a.Cd();return null}get _ReferenceId(){return this.kp?this.Jp:null}add(d,n){void 0!==d&&null!==d&&void 0!==n&&null!==n||pc.a.Cd();var B=this.jS.bT;if(!B.isConnected){const Q=this.rm.Pma,ha=B.getValue(Dd.a.QPb);Q.a8(B,24,Jh.a.Of(ha+"{1}"))}(B=this.getItemOrNullObject(d))?(B.key!==d&&B.LNo(d),B.value=n):this.jS.e4k(d,n)?B=this.getItemOrNullObject(d):
pc.a.Cd();return B}deleteAll(){this.jS.fWl()}getCount(){return this.jS.mKi()}getItem(d){(d=this.getItemOrNullObject(d))||pc.a.tl();return d}getItemOrNullObject(d){return(d=this.jS.lKi(d))?new Uz(this._context,this.rm,this.jS,d):null}_KeepReference(){this.$o()}_OnAccess(){this._context.vo.dhc(this.rm.Pma.currentNode);if(!this.jS.bT.isConnected){const d=this.rm.j9d(dl.W1d,!0);0<d.length&&(this.jS=new dl(d[0],this.Zc))}this.jS.v2f()||this.jS.pQg()}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,
n,this))}getTypeName(){return"Microsoft.WordServices.CustomPropertyCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1003:return this.mVc(n);case 1005:return this.jzf();case 1004:return this.Aab();case 1:return this.A1(n);case 1006:return this.Uab(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}mVc(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"any");return this.add(n,d)}jzf(){this.deleteAll();return null}Aab(){return this.getCount()}A1(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}Uab(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}eOl(){const d=this.CIc.create(Fc.a.bT),n=new Jh.a(Ze.a.create(),1);d.setValue(Dd.a.QPb,"{"+Cb.e(n.gv.toString())+"}");
d.setValue(Dd.a.$9a,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"></Properties>');d.setValue(Dd.a.X1d,dl.W1d);d.setValue(Dd.a.Kic,!0);return d}}Object(D.a)(IH,"CustomPropertyCollection",rh.a,[866,893]);class Uy extends rh.a{constructor(d,n,B,Q,ha){super();this.vO=this.rv=null;this._context=d;this.rm=n;this.Zc=B;this.CIc=
Q;this.bHk=ha}get applicationName(){this.vO.MK();return this.vO.EK.application}get author(){this.rv.MK();return this.rv.EK.Creator}set author(d){this.rv.MK();this.rv.EK.Creator=d;this.rv.$fb()}get category(){this.rv.MK();return this.rv.EK.Category}set category(d){this.rv.MK();this.rv.EK.Category=d;this.rv.$fb()}get comments(){this.rv.MK();return this.rv.EK.Description}set comments(d){this.rv.MK();this.rv.EK.Description=d;this.rv.$fb()}get company(){this.vO.MK();return this.vO.EK.company}set company(d){this.vO.MK();
this.vO.EK.company=d;this.vO.$fb()}get creationDate(){this.rv.MK();const d=this.rv.EK.CreatedDate;return void 0!==d&&null!==d?new Date(d):null}get customProperties(){return new IH(this._context,this.rm,this.Zc,this.CIc)}get format(){this.vO.MK();return this.vO.EK.format}set format(d){this.vO.MK();this.vO.EK.format=d;this.vO.$fb()}get keywords(){this.rv.MK();return this.rv.EK.Keywords}set keywords(d){this.rv.MK();this.rv.EK.Keywords=d;this.rv.$fb()}get lastAuthor(){this.rv.MK();return this.rv.EK.LastModifiedBy}get lastPrintDate(){this.rv.MK();
const d=this.rv.EK.LastPrinted;return void 0!==d&&null!==d?new Date(d):null}get lastSaveTime(){this.rv.MK();const d=this.rv.EK.Modified;return void 0!==d&&null!==d?new Date(d):null}get manager(){this.vO.MK();return this.vO.EK.manager}set manager(d){this.vO.MK();this.vO.EK.manager=d;this.vO.$fb()}get revisionNumber(){this.rv.MK();return this.rv.EK.Revision}get security(){this.vO.MK();return this.vO.EK.docSecurity}get subject(){this.rv.MK();return this.rv.EK.Subject}set subject(d){this.rv.MK();this.rv.EK.Subject=
d;this.rv.$fb()}get template(){this.vO.MK();return this.vO.EK.template}get title(){this.rv.MK();return this.rv.EK.Title}set title(d){this.rv.MK();this.rv.EK.Title=d;this.rv.$fb()}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){this.bHk||pc.a.Yj();this._context.vo.dhc(this.rm.Pma.currentNode);this.loadDocumentProperty()}getTypeName(){return"Microsoft.WordServices.DocumentProperties"}invokePropertyGet(d){switch(d){case 11:return this.applicationName;case 5:return this.author;
case 20:return this.category;case 7:return this.comments;case 23:return this.company;case 13:return this.creationDate;case 2:return this.customProperties;case 21:return this.format;case 6:return this.keywords;case 9:return this.lastAuthor;case 12:return this.lastPrintDate;case 14:return this.lastSaveTime;case 22:return this.manager;case 10:return this.revisionNumber;case 19:return this.security;case 4:return this.subject;case 8:return this.template;case 3:return this.title;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 5:this.author=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 20:this.category=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.comments=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 23:this.company=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 21:this.format=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 6:this.keywords=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 22:this.manager=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.subject=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}loadDocumentProperty(){if(void 0===this.rv||null===this.rv)this.rv=this.uMi(Uy.OIl);if(void 0===this.vO||null===this.vO)this.vO=this.uMi(Uy.aam)}uMi(d){d=this.rm.j9d(d,!0);return new jK(d[0],this.Zc)}}Uy.OIl="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";Uy.aam="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";Object(D.a)(Uy,"DocumentProperties",rh.a,[866]);var Vp;(function(d){d[d.left=0]="left";d[d.right=
1]="right";d[d.firstLine=2]="firstLine"})(Vp||(Vp={}));Object(D.b)("ExtensionParagraphIndent",Vp);var iD;(function(d){d[d.lineSpacing=0]="lineSpacing";d[d.before=1]="before";d[d.after=2]="after";d[d.Keq=3]="lineBefore";d[d.Jeq=4]="lineAfter"})(iD||(iD={}));Object(D.b)("ExtensionParagraphSpacing",iD);class vB extends rh.a{constructor(d){super();this.annotations=d;pc.a.Pz(d,"AnnotationCollection")}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();
return d}getFirstOrNullObject(){Fi.a.EF||pc.a.Yj();return this.annotations&&0<this.annotations.length?this.annotations[0]:null}_GetItem(d){Fi.a.EF||pc.a.Yj();d=pc.a.lO(d);if(0<=d&&d<this.length())return this.annotations[d];pc.a.Cd()}_KeepReference(){this.$o()}_OnAccess(){}length(){return Fi.a.EF?this.annotations.length:null}getAsyncEnumerator(d,n){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return Fi.a.EF?"Microsoft.WordServices.AnnotationCollection":
"Microsoft.WordServices.AddInCritiqueAnnotationCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}}Object(D.a)(vB,"AnnotationCollection",rh.a,[866,893]);class wB extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi){super();this.XRa=gi;pc.a.ARa(d,"Paragraph");this.Xd=d;this._context=n;this._id=B;this.ME=Q;this.lQ=ha;this.Ip=Aa;this.Jk=bb;this.M2e=Ib;this.qb=oc;this.Ww=Ac;this.MM=ad;this.Wr=sd;this.yD=wd;this.nd=yd;this.Xz=be;this.uh=ye;this.wD=Qe;this.fz=af;this.Am=Qf;this.yd=hf;this.So=di;this.qv=vj;this.lz=
Wk;this.Tz=Tm;this.C6e=Dk}get alignment(){switch(this.qb.VA(this.Xd)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(d){let n=0;switch(d){case 0:n=1;break;case 2:n=3;break;case 1:n=2;break;case 3:n=6;break;default:F.ULS.sendTraceTag(16871628,369,15,"AppId:{0}, set Paragraph.Alignment with not supported value: {1}.",this._context.appId,d),pc.a.Cd()}this.Ww.qJ(this.Xd,n)}get contentControls(){const d=new Ei;d.types=
[31];return this.getContentControls(d)}get fields(){return new Tu(this.Tz.lmc(this.Xd,this._context,!1))}get endnotes(){var d=this.nd.hNf(this.Xd,1);d=this.nd.fCa(d,this._context);return new wt(d)}get firstLineIndent(){return this.EPf(2)}set firstLineIndent(d){const n=this.Ww.Hs;d=Mi.a.fM(d);0<=d?n.pja(this.Xd,d):n.JAb(this.Xd,0-d)}get font(){return this.ME.create(3,this.Xd,null,null,this._context)}get footnotes(){var d=this.nd.hNf(this.Xd,0);d=this.nd.fCa(d,this._context);return new wt(d)}get inlinePictures(){const d=
new ma.a,n=new ma.a;let B=0;this.Xz.UNf(n,this.Xd);for(const Q of n)d.add(this.lQ.create(Q,this._context,B++));return new cp(d)}get isLastParagraph(){if(!pc.a.yj())return!1;var d=this.yd.vae(this.Xd);return d?(d=this.qb.vH(d))?d.id.equals(this.Xd.id)?!0:!1:!1:!1}get isListItem(){return pc.a.yj()?this.qb.zZ(this.Xd):!1}get leftIndent(){return this.EPf(0)}set leftIndent(d){this.Ww.Hs.lQa(this.Xd,1,Mi.a.fM(d))}get lineSpacing(){return this.d7c(0)}set lineSpacing(d){pc.a.D3a(d,"Paragraph.LineSpacing");
this.Ww.HG(this.Xd,new Is.a(2,d/12))}get lineUnitAfter(){return this.d7c(4)}set lineUnitAfter(d){pc.a.C3a(d,"Paragraph.LineUnitAfter");this.Ww.CAb(this.Xd,new Is.a(2,d))}get lineUnitBefore(){return this.d7c(3)}set lineUnitBefore(d){pc.a.C3a(d,"Paragraph.LineUnitBefore");this.Ww.DAb(this.Xd,new Is.a(2,d))}get list(){if(!pc.a.yj())return null;const d=this.listOrNullObject;d||pc.a.tl();return d}get listItem(){if(!pc.a.yj())return null;const d=this.listItemOrNullObject;d||pc.a.tl();return d}get listItemOrNullObject(){if(!pc.a.yj())return null;
let d;if(ve.a.Qe){if(!ve.a.isListItem(this.Xd))return null;d=bf.ParagraphReader.Zmc(this.Xd)}else if(!({TZb:d}=this.So.ocd(this.Xd)).returnValue)return null;return this.M2e.create(d,this._context)}get listOrNullObject(){if(!pc.a.yj())return null;var d=new ma.a;d.add(ge.a.create(this.Xd));d=this.So.ayi(d,this._context);return d.count?d.K(0):null}get outlineLevel(){return this.qb.yna(this.Xd)+1}set outlineLevel(d){if(1>d||10<d)F.ULS.sendTraceTag(19674595,369,10,"Set OutlineLevel with not supported value: {0}.",
d),pc.a.Cd();this.Ww.K3o(this.Xd,d-1)}get parentBody(){return pc.a.yj()?this.yd.JPf(this.Xd,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||pc.a.tl();return d}get parentContentControlOrNullObject(){const d=ge.a.create(this.Xd);this.nd.pRa(d,d);return this.uh.xnc(d,d,this._context)}get parentTable(){if(!pc.a.yj())return null;const d=this.parentTableOrNullObject;d||pc.a.tl();return d}get parentTableCell(){if(!pc.a.yj())return null;const d=this.parentTableCellOrNullObject;
d||pc.a.tl();return d}get parentTableCellOrNullObject(){return pc.a.yj()?this.yd.$mc(this.Xd,this._context):null}get parentTableOrNullObject(){return pc.a.yj()?this.yd.Mtb(this.Xd,this._context):null}get rightIndent(){return this.EPf(1)}set rightIndent(d){this.Ww.Hs.LAb(this.Xd,1,Mi.a.fM(d))}get spaceAfter(){return this.d7c(2)}set spaceAfter(d){pc.a.C3a(d,"Paragraph.SpaceAfter");this.Ww.CAb(this.Xd,new Is.a(4,d))}get spaceBefore(){return this.d7c(1)}set spaceBefore(d){pc.a.C3a(d,"Paragraph.SpaceBefore");
this.Ww.DAb(this.Xd,new Is.a(4,d))}get style(){let d;return this.yD.b6c((d=new ma.a,d.add(ge.a.create(this.Xd)),d))}set style(d){let n;this.yD.Ozc((n=new ma.a,n.add(ge.a.create(this.Xd)),n),d)}get styleBuiltIn(){if(!pc.a.yj())return-1;let d;return this.yD.U9d((d=new ma.a,d.add(ge.a.create(this.Xd)),d))}set styleBuiltIn(d){pc.a.yj()||pc.a.Yj();let n;this.yD.ZAe((n=new ma.a,n.add(ge.a.create(this.Xd)),n),d)}get tableNestingLevel(){return pc.a.yj()?this.yd.fNi(this.Xd):0}get text(){return this.qb.e_b(this.Xd)}get _Id(){return this._id}get _ReferenceId(){return this.kp?
this.Jp:null}get uniqueLocalId(){return pc.a.Vmg?this.C6e.TIi(this.Xd.id.toString()):null}attachToList(d,n){pc.a.yj()||pc.a.Yj();return this.So.attachToList(this.Xd,d,n,this._context)}clear(){const d=ge.a.create(this.Xd);this.ebk(d);let n;this.nd.sOb((n=new ma.a,n.add(d),n))}deleteParagraph(){const d=ge.a.create(this.Xd);this.ebk(d);let n;this.nd.Yic((n=new ma.a,n.add(d),n))}detachFromList(){pc.a.yj()||pc.a.Yj();this.So.detachFromList(this.Xd)}getAnnotations(){Fi.a.EF||pc.a.Yj();const d=this.XRa.Kmm(this.Xd);
return new vB(d.map(n=>new eK(n,this._context,this.XRa,this.Jk)))}getComments(){const d=new ma.a;d.add(ge.a.create(this.Xd));return this.qv.Q8d(d,this._context)}getContentControls(d){var n;d=null!==(n=null===d||void 0===d?void 0:d.types)&&void 0!==n?n:[];pc.a.s2c(d);n=ge.a.create(this.Xd);n=this.uh.DRf(n,n,this._context);return 0===d.length?n:null===n||void 0===n?void 0:n.getByTypes(d)}getHtml(){const d=[ge.a.create(this.Xd)];return this.fz.getHtml(d,this._context)}getMetadata(){pc.a.Yj();return null}getNext(){const d=
this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){pc.a.yj()||pc.a.Yj();const d=this.qb.Cg(this.Xd,!1,!0);return d?this.Ip.create(d,this._context):null}getOoxml(){const d=(new Date).getTime();this._context.vo.qH();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{const Q=new ma.a;Q.add(ge.a.create(this.Xd));this.fz.getOoxml(Q,this._context,n,B,d)})}getPrevious(){const d=this.getPreviousOrNullObject();d||pc.a.tl();return d}getPreviousOrNullObject(){pc.a.yj()||pc.a.Yj();
const d=this.qb.Cg(this.Xd,!0,!0);return d?this.Ip.create(d,this._context):null}getRange(d){pc.a.yj()||pc.a.Yj();1!==d&&2!==d&&d&&5!==d&&4!==d&&(F.ULS.sendTraceTag(18745294,369,15,"AppId:{0}, rangeLocation of Paragraph.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.Cd());const n=new ma.a;n.add(ge.a.create(this.Xd));this.Am.IAe(n);return(d=this.Am.mSb(n,d))?this.Jk.create(d,this._context):null}getSubrange(d,n){pc.a.yj()||pc.a.Yj();(0>d||d+n>this.qb.textLength(this.Xd)||
0>n)&&pc.a.Cd();d=n?ge.a.createTextRange(this.Xd,d,d+n):ge.a.jd(this.Xd,d);let B;return this.Jk.create((B=new ma.a,B.add(d),B),this._context,0)}getText(d){var n,B;pc.a.EUm||pc.a.Yj();const Q=null!==(n=null===d||void 0===d?void 0:d.includeTextMarkedAsDeleted)&&void 0!==n?n:!1;d=null!==(B=null===d||void 0===d?void 0:d.includeHiddenText)&&void 0!==B?B:!1;B=0;Q||(B|=1);d||(B|=8);return this.qb.xog(this.Xd,B)}getTextRanges(d,n){pc.a.yj()||pc.a.Yj();var B=new ma.a;B.add(ge.a.create(this.Xd));this.Am.IAe(B);
d=this.Am.cSf(B,d,n);n=new ma.a;for(B=0;B<d.length;B++)n.add(this.Jk.create(d[B],this._context,B));return new rv(n)}getTrackedChanges(){return new Mw(3,this.Xd,null,null,this._context,this.lz,this.qb,this.Am)}getReviewedText(d){return this.lz.abe(this.Xd,d)}insertAnnotations(d){Fi.a.EF||pc.a.Yj();return this.XRa.ggn(d.critiques,this.Xd,this._context)}insertBreak(d,n){n&&1!==n&&(F.ULS.sendTraceTag(17179038,369,15,"AppId:{0}, insertLocation of Paragraph.InsertBreak must be Before or After.",this._context.appId),
pc.a.Cd());const B=(new Date).getTime(),Q=new ma.a;Q.add(ge.a.create(this.Xd));if(6===d)this.nd.pRa(Q.K(0),Q.K(0));else{const ha=this.nd.Q9a(this.Xd,!n);Q.W(0,ha)}return OfficeExtension.WacRuntime.Utility.createPromise((ha,Aa)=>{this.nd.insertBreak(Q,d,n,this._context,ha,Aa,B)})}insertContentControl(d){pc.a.XDf(d,"Paragraph");d=pc.a.$ud(d,0);8!==d||pc.a.fka||pc.a.Cd();const n=this.nd.eic(this.Xd,!0),B=this.nd.eic(this.Xd,!1);return this.uh.Msa(n,B,this._context,d)}insertFileFromBase64(d,n){"<"===
d.charAt(0)&&(F.ULS.sendTraceTag(18130840,369,10,"invalid argument for insertFileFromeBase64 API in Paragraph class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!1)}insertHtml(d,n){const B=(new Date).getTime();if(2===n||3===n||4===n){const Q=new ma.a,ha=ge.a.OV(0,this.qb.textLength(this.Xd),!1,this.Xd);Q.add(ha);return this.fz.insertHtml(Q,d,n,B,this._context)}pc.a.Cd();return null}insertInlinePictureFromBase64(d,n){return this.Q$c(d,n)}insertOoxml(d,n){"<"!==d.charAt(0)&&(F.ULS.sendTraceTag(18130841,
369,10,"invalid argument for InsertOoxml API in Paragraph class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!0)}insertParagraph(d,n){let B=null;switch(n){case 0:B=this.nd.Q9a(this.Xd,!0);break;case 1:B=this.nd.Q9a(this.Xd,!1);break;default:F.ULS.sendTraceTag(21070050,369,15,"AppId:{0}, Invalid insert location for Paragraph.InsertParagraph method.",this._context.appId),pc.a.Cd()}let Q;return this.Ip.create(this.nd.insertParagraph((Q=new ma.a,Q.add(B),Q),d,n),this._context)}insertTable(d,
n,B,Q){pc.a.yj()||pc.a.Yj();const ha=this.nd.Q9a(this.Xd,!B);let Aa;return this.yd.insertTable((Aa=new ma.a,Aa.add(ha),Aa),d,n,B,Q,this._context)}insertText(d,n){2!==n&&3!==n&&4!==n&&(F.ULS.sendTraceTag(21284492,369,15,"AppId:{0}, invalid location for Paragraph.InsertText: {1}.",this._context.appId,yo.a[n]),pc.a.Cd());const B=ge.a.create(this.Xd);this.nd.pRa(B,B);let Q;return this.Jk.create(this.nd.insertText((Q=new ma.a,Q.add(B),Q),d,n),this._context)}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>
{const Q=new ma.a;Q.add(ge.a.create(this.Xd));this.wD.find(Q,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=new ma.a;Q.add(ge.a.create(this.Xd));this.wD.msb(Q,d,n,B,this._context)})}select(d){const n=new ma.a;n.add(ge.a.create(this.Xd));this.Wr.select(n,d)}setMetadata(){pc.a.Yj()}split(d,n,B){pc.a.yj()||pc.a.Yj();const Q=new ma.a;Q.add(ge.a.create(this.Xd));this.Am.IAe(Q);d=this.Am.kBc(Q,d,!1,n,B);n=new ma.a;for(B=0;B<d.length;B++)n.add(this.Jk.create(d[B],
this._context,B));return new rv(n)}startNewList(){pc.a.yj()||pc.a.Yj();return this.So.startNewList(this.Xd,this._context)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.Xd,"Paragraph")}getTypeName(){return"Microsoft.WordServices.Paragraph"}invokePropertyGet(d){switch(d){case 7:return this.alignment;case 5:return this.contentControls;case 36:return this.endnotes;case 8:return this.firstLineIndent;case 37:return this.fields;case 3:return this.font;case 35:return this.footnotes;case 17:return this.inlinePictures;
case 28:return this.isLastParagraph;case 19:return this.isListItem;case 9:return this.leftIndent;case 11:return this.lineSpacing;case 16:return this.lineUnitAfter;case 15:return this.lineUnitBefore;case 24:return this.list;case 27:return this.listItem;case 34:return this.listItemOrNullObject;case 33:return this.listOrNullObject;case 12:return this.outlineLevel;case 23:return this.parentBody;case 6:return this.parentContentControl;case 30:return this.parentContentControlOrNullObject;case 26:return this.parentTable;
case 25:return this.parentTableCell;case 31:return this.parentTableCellOrNullObject;case 32:return this.parentTableOrNullObject;case 10:return this.rightIndent;case 14:return this.spaceAfter;case 13:return this.spaceBefore;case 4:return this.style;case 29:return this.styleBuiltIn;case 22:return this.tableNestingLevel;case 18:return this.text;case 1:return this._Id;case 2:return this._ReferenceId;case 38:return this.uniqueLocalId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 7:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 8:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 9:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 11:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return;case 16:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 15:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 12:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 10:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 14:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return;case 13:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 29:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1022:return this.Zgl(n);case 1011:return this.IKa();case 1012:return this.bF(n);case 1023:return this.FYl();case 1036:return this.oom();case 1014:return this.GSb();case 1032:return this.qSb();case 1034:return this.zMa(n);case 1028:return this.SOf(n);case 1024:return this.b9();case 1026:return this.c9();case 1025:return this.$Mm();case 1027:return this.cNm();case 1017:return this.rha(n);case 1030:return this.OSm(n);case 1020:return this.G7c(n);case 1035:return this.ITb();case 1033:return this.uTb(n);
case 1037:return this.lgn(n);case 1004:return this.tNa(n);case 1009:return this.lva(n);case 1019:return this.hcb(n);case 1005:return this.vNa(n);case 1013:return this.lja(n);case 1029:return this.xDg(n);case 1018:return this.t3b(n);case 1021:return this.Dkp();case 1038:return this.LUm(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1015:return this.fTb();case 1010:return this.Ybb(n);
case 1008:return this.jva(n);case 1006:return this.acb(n);case 1003:return this.bcb(n);case 1007:return this.fcb(n);case 1016:return this.zxa(n);case 1031:return this.Hqa(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Zgl(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.attachToList(n,d)}IKa(){this.clear();return null}bF(){this.deleteParagraph();
return null}FYl(){this.detachFromList();return null}oom(){return this.getAnnotations()}qSb(){return this.getComments()}zMa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}GSb(){return this.getHtml()}SOf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMetadata(d)}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}fTb(){return this.getOoxml()}$Mm(){return this.getPrevious()}cNm(){return this.getPreviousOrNullObject()}rha(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}OSm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getSubrange(n,d)}G7c(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(n,d)}uTb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getReviewedText(d)}ITb(){return this.getTrackedChanges()}lgn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,dr);return this.insertAnnotations(d)}Ybb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(n,d)}tNa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.insertContentControl(d)}jva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(n,d)}acb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(n,d)}bcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(n,
d)}fcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(n,d)}lva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}hcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(n,B,Q,d)}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(n,d)}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}xDg(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.setMetadata(n,d);
return null}t3b(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"boolean");return this.split(n,B,d)}Dkp(){return this.startNewList()}LUm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Yh);return this.getText(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Q$c(d,n,B){const Q=
(new Date).getTime();if(!n||1===n)return F.ULS.sendTraceTag(17433743,369,50,"AppId:{0}, insert inline picture with none supported location in Paragraph class.",this._context.appId),pc.a.Cd(),null;var ha=null;if(4===n)ha=ge.a.jd(this.Xd,0),this.clear();else{ha=ge.a.create(this.Xd);({yN:ha}=this.nd.bP(ha,ha,n));let Aa;this.nd.DY((Aa=new ma.a,Aa.add(ha),Aa),n,0)}G.AFrameworkApplication.$v?(this._context.vo.ex(this.Xd),n=this.Xz.WUb(d,ha,this._context,B)):n=this.Xz.WUb(d,ha,this._context);return n.then(Aa=>
{G.AFrameworkApplication.$v||this._context.vo.ex(this.Xd);if(Aa)return pc.a.lR("Paragraph.InsertInlinePictureFromBase64",pc.a.WR(Q),d.length),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lQ.create(this.Xz.t3c(Aa),this._context));F.ULS.sendTraceTag(17433744,369,10,"AppId:{0}, something went wrong when insert iamge into Paragraph.",this._context.appId);pc.a.lR("Paragraph.InsertInlinePictureFromBase64",pc.a.WR(Q),d.length,!1);pc.a.vg();return null})}EPf(d){var n=this.qb.ebb(this.Xd);
if(n&&(n=n.fw))switch(d){case 2:switch(d=this.SPf(1,n.Bja),n.specialIndentType){case 1:return d;case 2:return-d;default:return 0}case 0:return this.SPf(n.Xub,n.NC);case 1:return this.SPf(n.Yub,n.Kha);default:return 0}F.ULS.sendTraceTag(16832386,369,10,"AppId:{0}, error happened when reading paragraph {1} indent.",this._context.appId,Vp[d]);pc.a.vg();return 0}d7c(d){var n=this.qb.ebb(this.Xd);if(n&&(n=n.TR))switch(d){case 0:return this.TPf(n.lineSpacing.unit,n.lineSpacing.value);case 1:return this.TPf(n.beforeSpacing.unit,
n.beforeSpacing.value);case 2:return this.TPf(n.afterSpacing.unit,n.afterSpacing.value);case 3:return this.qGi(n.beforeSpacing.unit,n.beforeSpacing.value);case 4:return this.qGi(n.afterSpacing.unit,n.afterSpacing.value);default:return 0}F.ULS.sendTraceTag(16832387,369,10,"AppId:{0}, error happened when reading paragraph {1} spacing.",this._context.appId,iD[d]);pc.a.vg();return 0}SPf(d,n){switch(d){case 2:return d=qa.a.oOb(n),Mi.a.Xja(d);case 1:return Mi.a.Xja(n);default:return 0}}TPf(d,n){switch(d){case 2:return 12*
n;case 3:return Mi.a.Xja(n);case 4:return n;default:return 0}}qGi(d,n){switch(d){case 4:return n/12;case 3:return Mi.a.Xja(n)/12;case 2:return n;default:return 0}}ebk(d){const n=this.qb.nn(this.Xd,0),B=this.qb.nn(this.Xd,this.qb.textLength(this.Xd)),Q=this.qb.jA(this.Xd),ha=this.qb.xz(this.Xd),Aa=B-ha;d.Ob=0<n?Q+(Q<Aa?Aa-Q:0):-1;d.nc=0<B?ha+(Q<Aa?0:Aa-Q):-1}Wna(d,n,B){const Q=(new Date).getTime(),ha=new ma.a;switch(n){case 2:case 3:case 4:const Aa=ge.a.create(this.Xd);this.nd.pRa(Aa,Aa);ha.add(Aa);
break;default:return F.ULS.sendTraceTag(18130842,369,15,"AppId:{0}, Paragraph.InsertOoxmlOrDocx: undefined location!",this._context.appId),pc.a.Cd(),null}return OfficeExtension.WacRuntime.Utility.createPromise((Aa,bb)=>{this.fz.insertOoxml(ha,d,n,this.Xd,this._context,Aa,bb,Q,B?0:1)})}language(){return this.MM.gOf(this.Xd)}Hua(){return this.Xd}}Object(D.a)(wB,"Paragraph",rh.a,[866]);var bt=e(88),Hm=e(110);class Ut extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,
vj,Wk,Tm,Dk,gi){super();this.C7=null;this.Lka="_";this.vEk="OLE_LINK";this.$uk=40;pc.a.hEc(d,"Range");this.Ud=d;this._context=n;this._id=B;this.Ip=Q;this.lQ=ha;this.ME=Aa;this.Jk=bb;this.Bpc=Ib;this.qb=oc;this.Wr=Ac;this.yD=ad;this.nd=sd;this.Xz=wd;this.uh=yd;this.wD=be;this.fz=ye;this.Am=Qe;this.VG=af;this.yd=Qf;this.So=hf;this.Tp=di;this.cmb=vj;this.qv=Wk;this.lz=Tm;this.Tz=Dk;this.XRa=gi;this.q9b=-1;this.vEd=this.wEd=null;this._context.jsc&&(this.C7=this.Bpc.create(d))}get l6d(){return this.q9b}set l6d(d){this.q9b=
d}get isb(){return this.wEd}set isb(d){this.wEd=d}get g6d(){return this.vEd}set g6d(d){this.vEd=d}get qvb(){return this.C7}get kq(){return this.Ud}get contentControls(){const d=new Ei;d.types=[31];return this.getContentControls(d)}get endnotes(){var d=this.nd.T9d(this.Ud,1);d=this.nd.fCa(d,this._context);return new wt(d)}get fields(){const d=new ma.a;var n=!1;for(let B=0;B<this.Ud.count;B++){const Q=this.Ud.K(B);switch(Q.contextId){case ed.a.paragraph:n=this.Tz.lmc(Q.node,this._context,n);d.addRange(n);
n=!0;break;case ed.a.Nd:n=this.Tz.I9d(Q.node,Q.cpBegin,Q.cpEnd,this._context,n);d.addRange(n);n=!0;break;case ed.a.od:break;case ed.a.kd:break;default:F.ULS.sendTraceTag(539530914,369,10,"AppId:{0}, the contextId {1} is not supported to get the fields.",this._context.appId,Q.contextId),pc.a.vg()}}return new Tu(d)}get font(){return this.ME.create(4,null,null,this,this._context)}get footnotes(){var d=this.nd.T9d(this.Ud,0);d=this.nd.fCa(d,this._context);return new wt(d)}get hyperlink(){if(!pc.a.yj())return null;
const d=(pc.a.dug()?this.Am.utb(this.Ud):this.utb()).returnValue;return d&&d.length?d[0].hyperlink.url:null}set hyperlink(d){pc.a.yj()||pc.a.Yj();if(pc.a.dug())this.Am.$Tj(this.kq,d,!0,this._context);else{this.K3f()||pc.a.vg();if(this.Ud.K(0).contextId===ed.a.kd||this.Ud.K(0).contextId===ed.a.od)F.ULS.sendTraceTag(18989185,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",this._context.appId),pc.a.vg();var n,B=({zfg:n}=this.utb()).returnValue;if(B)for(let Q=0;Q<
B.length;Q++)this.VG.YZ(B[Q].paragraph,B[Q].hyperlink);d&&""!==d&&n&&0<n.count&&(this.Am.i4h(n.K(0))?(B=!1,0===d.indexOf("#")&&(d=d.substr(1),B=!0),this.VG.SJ(n.K(0),d,!1,!1,!1,B)):pc.a.zE())}}get inlinePictures(){const d=new ma.a;let n=0;for(const B of this.Ud){const Q=new ma.a;this.Xz.o$d(Q,B);for(const ha of Q)d.add(this.lQ.create(ha,this._context,n++))}return new cp(d)}get isEmpty(){return this.Am.QVb(this.Ud)}get lists(){return pc.a.yj()?new bD(4,null,null,this,this._context,this.So,null):null}get paragraphs(){let d=
0;const n=new ma.a,B=new Uj.a;for(const Q of this.Ud)B.contains(Q.node.id.toString())||(B.add(Q.node.id.toString()),n.add(this.Ip.create(Q.node,this._context,d++)));return new Zr(n)}get parentBody(){return pc.a.yj()?this.yd.KPf(this.Ud.K(0).node,this.Ud.K(this.Ud.count-1).node,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||pc.a.tl();return d}get parentContentControlOrNullObject(){return this.uh.xnc(this.Ud.K(0),this.Ud.K(this.Ud.count-1),this._context)}get parentTable(){if(!pc.a.yj())return null;
const d=this.parentTableOrNullObject;d||pc.a.tl();return d}get parentTableCell(){if(!pc.a.yj())return null;const d=this.parentTableCellOrNullObject;d||pc.a.tl();return d}get parentTableCellOrNullObject(){if(!pc.a.yj())return null;const d=this.Ud.K(0),n=this.Ud.K(this.Ud.count-1);return this.yd.$mc(d.node,this._context,n.node)}get parentTableOrNullObject(){if(!pc.a.yj())return null;const d=this.Ud.K(0),n=this.Ud.K(this.Ud.count-1);return this.yd.Mtb(d.node,this._context,n.node)}get style(){return this.yD.b6c(this.Ud)}set style(d){this.yD.Ozc(this.Ud,
d)}get styleBuiltIn(){return pc.a.yj()?this.yD.U9d(this.Ud):-1}set styleBuiltIn(d){pc.a.yj()||pc.a.Yj();this.yD.ZAe(this.Ud,d)}get tables(){return pc.a.yj()?new Qq(4,null,this,null,this._context,this.yd):null}get text(){return this.Am.EJi(this.Ud,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}clear(){this.oCc();this.nd.sOb(this.Ud);this.kPb()}compareLocationWith(d){pc.a.yj()||pc.a.Yj();d&&d.kq.count||pc.a.vg();return this.Am.w$h(this.kq.K(0),this.kq.K(this.kq.count-
1),d.kq.K(0),d.kq.K(d.kq.count-1))}deleteRange(){this.oCc();this.nd.Yic(this.Ud);this.kPb()}endPreview(){}expandTo(d){(d=this.expandToOrNullObject(d))||pc.a.tl();return d}expandToOrNullObject(d){pc.a.yj()||pc.a.Yj();if(!d||!d.kq.count)return null;if(this.u3i(d)){var n=this.Am.rN(this.Ud.K(0),!0),B=this.Am.rN(this.Ud.K(this.Ud.count-1),!1,!0),Q=this.Am.rN(d.kq.K(0),!0);d=this.Am.rN(d.kq.K(d.kq.count-1),!1,!0);const ha=this.wma(n,Q),Aa=this.wma(B,d);2===ha&&(n=Q);Aa||(B=d);Q=this.RDi(n,B);return this.Jk.create(Q,
this._context)}return null}getBookmarks(d,n){var B;const Q=[],ha=new ma.a;var Aa=new ma.a;const bb=null===(B=G.AFrameworkApplication.J)||void 0===B?void 0:B.$("HideBookMarkStartingWithOleLink");for(const Ib of this.kq)if(B=Ib.node,B.ra)for(let oc=0;oc<B.ra.length;oc++){const Ac=B.ra.jc(oc);if(Ac.Oi)for(let ad=0;ad<Ac.Oi.length;ad++){const sd=Ac.Oi.K(ad).Ap.toString();Aa.contains(sd)||Aa.add(sd);n||(ha.contains(sd)?ha.remove(sd):ha.add(sd))}}else F.ULS.sendTraceTag(545396882,369,15,"Paragraph characterProperties is null");
for(const Ib of Aa)if(n||!n&&!ha.contains(Ib))Aa=this.Tp.fSb(Jh.a.Of(Ib)).ka(Dd.a.Wv,""),!d&&(d||Aa.startsWith(this.Lka)||bb&&Aa.startsWith(this.vEk))||Q.push(Aa);return Q}getComments(){return this.qv.Q8d(this.Ud,this._context)}getContentControls(d){var n;d=null!==(n=null===d||void 0===d?void 0:d.types)&&void 0!==n?n:[];pc.a.s2c(d);n=this.Ud.K(0);const B=this.Ud.K(this.Ud.count-1);n=this.uh.DRf(n,B,this._context);return 0===d.length?n:null===n||void 0===n?void 0:n.getByTypes(d)}getHtml(){return this.fz.getHtml(this.Ud.toArray(),
this._context)}getHyperlinkRanges(){pc.a.yj()||pc.a.Yj();let d;const n=new ma.a;({returnValue:d}=pc.a.dug()?this.Am.utb(this.Ud):this.utb());if(!d)return new rv(n);for(let B=0;B<d.length;B++){const Q=new ma.a;Q.add(ge.a.createTextRange(d[B].paragraph,d[B].cpBegin,d[B].cpEnd));n.add(this.Jk.create(Q,this._context,B))}return new rv(n)}getNextTextRange(d,n){(d=this.getNextTextRangeOrNullObject(d,n))||pc.a.tl();return d}getNextTextRangeOrNullObject(d,n){pc.a.yj()||pc.a.Yj();return(d=this.Am.getNextTextRange(this.Ud,
d,n))?this.Jk.create(d,this._context):null}getOoxml(){const d=(new Date).getTime();this._context.vo.qH();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{this.fz.getOoxml(this.Ud,this._context,n,B,d)})}getReviewedText(d){return this.dPm(d)}getRange(d){pc.a.yj()||pc.a.Yj();1!==d&&2!==d&&d&&5!==d&&4!==d&&(F.ULS.sendTraceTag(18745295,369,15,"AppId:{0}, rangeLocation of Range.GetRange must be Start/End/Whole/Content/After.",this._context.appId),pc.a.Cd());return(d=this.Am.mSb(this.Ud,d))?
this.Jk.create(d,this._context):null}getTextRanges(d,n){pc.a.yj()||pc.a.Yj();d=this.Am.cSf(this.Ud,d,n);n=new ma.a;for(let B=0;B<d.length;B++)n.add(this.Jk.create(d[B],this._context,B));return new rv(n)}getTrackedChanges(){return new Mw(4,null,this,null,this._context,this.lz,this.qb,this.Am)}highlight(){const d=this.Ud.K(0);this.XRa.PKl(d,this._context)}insertBookmark(d){var n=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu");if(Ca.a.jg(d)||d.length>this.$uk||d.includes(" ")||!n.test(d))pc.a.Cd();
else{n=this.kq.K(0);var B=this.kq.K(this.kq.count-1);this.Tp.Eec(d,n.Uj,B.Yp,n.node,B.node,!0)}}insertBreak(d,n){n&&1!==n&&(F.ULS.sendTraceTag(17179039,369,15,"AppId:{0}, insertLocation of Range.InsertBreak must be Before, After.",this._context.appId),pc.a.Cd());const B=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((Q,ha)=>{this.nd.insertBreak(this.Ud,d,n,this._context,Q,ha,B,this.C7,!0)})}insertComment(d){return void 0===d||null===d?(pc.a.Cd(),null):this.qv.insertComment(this.kq,
d,this._context)}insertContentControl(d){pc.a.XDf(d,"Range");d=pc.a.$ud(d,0);8!==d||pc.a.fka||pc.a.Cd();return this.$Yf(!1,d)}insertFileFromBase64(d,n){"<"===d.charAt(0)&&(F.ULS.sendTraceTag(18130843,369,10,"invalid argument for insertFileFromeBase64 API in Range class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!1)}insertEndnote(d){d=this.nd.RXi(this.Ud,d,1);return this.cmb.create(d,this._context)}insertFootnote(d){d=this.nd.RXi(this.Ud,d,0);return this.cmb.create(d,this._context)}insertHtml(d,
n){const B=(new Date).getTime();return this.fz.insertHtml(this.Ud,d,n,B,this._context,!0,this.C7)}insertInlinePictureFromBase64(d,n){const B=(new Date).getTime();this.nd.DY(this.Ud,n,0);4===n&&this.clear();const Q=this.nd.aie(this.Ud,n);let ha=null;const Aa=this.Ud.K(0),bb=this.Ud.K(this.Ud.count-1),Ib=({yN:ha}=this.nd.bP(Aa,bb,n)).returnValue,oc=ha.node.characterData.length;this.oCc();return this.Xz.WUb(d,ha,this._context).then(Ac=>{this._context.vo.ex(Aa.node);if(!Ac)return this.kPb(),F.ULS.sendTraceTag(17433748,
369,10,"AppId:{0}, something went wrong when insert image into Range.",this._context.appId),pc.a.lR("Range.InsertInlinePictureFromBase64",pc.a.WR(B),d.length,!1),pc.a.vg(),null;pc.a.lR("Range.InsertInlinePictureFromBase64",pc.a.WR(B),d.length);Ac=this.Xz.t3c(Ac);this.nd.xIe(this.Ud,ha,Ib,1,oc);Q&&this.nd.axe(this.Ud,n);this.kPb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lQ.create(Ac,this._context))})}insertOoxml(d,n){"<"!==d.charAt(0)&&(F.ULS.sendTraceTag(18130844,369,
10,"invalid argument for InsertOoxml API in Range class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!0)}insertParagraph(d,n){n&&1!==n&&(F.ULS.sendTraceTag(21070051,369,15,"AppId:{0}, Invalid insert location for Range.InsertParagraph method.",this._context.appId),pc.a.Cd());this.oCc();var B=!n,Q=B?this.Ud.K(0):this.Ud.K(this.Ud.count-1);Q=this.qb.Cg(Q.node,B);if(B=this.yd.q$d(this.Ud,!n))if(Q){n?1===n&&(n=0):n=1;var ha;var Aa=this.nd.insertParagraph((ha=new ma.a,ha.add(B),ha),d,n)}else d=
pc.a.MZc(d),ha=ge.a.jd(B.node,0),0<this.qb.nn(ha.node,ha.cpBegin)?ha.Ob=ha.nc=this.qb.nn(ha.node,ha.cpBegin)/2:ha.Ob=ha.nc=-1,this.nd.insertText((Aa=new ma.a,Aa.add(ha),Aa),d,n),Aa=B.node;else Aa=this.nd.insertParagraph(this.Ud,d,n);this.kPb();return this.Ip.create(Aa,this._context)}insertTable(d,n,B,Q){pc.a.yj()||pc.a.Yj();B&&1!==B&&pc.a.Cd();this.oCc();d=this.yd.insertTable(this.Ud,d,n,B,Q,this._context,!0);this.kPb();return d}insertTapObjectFromFileContent(){return null}insertText(d,n){0===this.q9b&&
pc.a.zE();1===this.q9b&&2!==n&&3!==n&&4!==n&&(F.ULS.sendTraceTag(508703453,369,15,"AppId:{0}, invalid location for ADDIN FieldRange.InsertText: {1}.",this._context.appId,yo.a[n]),pc.a.Cd());this.oCc();d=this.Jk.create(this.nd.insertText(this.Ud,d,n,this.l6d,this.isb,this.g6d),this._context);1===this.q9b&&(d.q9b=1,d.wEd=this.wEd,d.vEd=this.vEd);this.kPb();return d}intersectWith(d){(d=this.intersectWithOrNullObject(d))||pc.a.tl();return d}intersectWithOrNullObject(d){pc.a.yj()||pc.a.Yj();if(!d||!d.kq.count)return null;
if(this.u3i(d)){var n=this.Am.rN(this.Ud.K(0),!0),B=this.Am.rN(this.Ud.K(this.Ud.count-1),!1,!0),Q=this.Am.rN(d.kq.K(0),!0);d=this.Am.rN(d.kq.K(d.kq.count-1),!1,!0);const ha=this.wma(n,Q),Aa=this.wma(B,d),bb=this.wma(n,d),Ib=this.wma(B,Q);if(!ha||1===ha)if(2===Ib||1===Ib)n=Q;else return null;else if(2===bb)return null;if(Aa){if(bb&&1!==bb)return null;B=d}else if(!Ib)return null;Q=this.RDi(n,B);return this.Jk.create(Q,this._context)}return null}previewTextReplacement(){}removeHighlight(){this.XRa.CWl(this.Ud,
this._context)}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{this.wD.find(this.Ud,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{this.wD.msb(this.Ud,d,n,B,this._context)})}select(d){this.Wr.select(this.Ud,d)}split(d,n,B,Q){pc.a.yj()||pc.a.Yj();d=this.Am.kBc(this.Ud,d,n,B,Q);n=new ma.a;for(B=0;B<d.length;B++)n.add(this.Jk.create(d[B],this._context,B));return new rv(n)}_KeepReference(){this.$o()}_OnAccess(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&
this.C7&&((this.Ud=this.C7.kq)||F.ULS.sendTraceTag(21824033,369,10,"AppId:{0}, the range is lost for unknown reason using the new range model.",this._context.appId));pc.a.hEc(this.Ud,"InternalRange");for(const d of this.Ud)pc.a.Y2(d.node,"Range")}insertField(d,n,B,Q){bt.a.vca||pc.a.Yj();return this.Tz.insertField(this.Ud,this._context,d,n,B,Q)}getTypeName(){return"Microsoft.WordServices.Range"}invokePropertyGet(d){switch(d){case 6:return this.contentControls;case 22:return this.endnotes;case 23:return this.fields;
case 3:return this.font;case 21:return this.footnotes;case 11:return this.hyperlink;case 8:return this.inlinePictures;case 10:return this.isEmpty;case 12:return this.lists;case 5:return this.paragraphs;case 16:return this.parentBody;case 7:return this.parentContentControl;case 18:return this.parentContentControlOrNullObject;case 15:return this.parentTable;case 14:return this.parentTableCell;case 19:return this.parentTableCellOrNullObject;case 20:return this.parentTableOrNullObject;case 4:return this.style;
case 17:return this.styleBuiltIn;case 13:return this.tables;case 9:return this.text;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 11:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 17:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1011:return this.IKa();case 1019:return this.zDl(n);case 1012:return this.bF(n);case 1035:return this.Q6l();case 1020:return this.L$l(n);case 1028:return this.M$l(n);
case 1026:return this.Hpm(n);case 1014:return this.GSb();case 1023:return this.lCm();case 1022:return this.qIm(n);case 1030:return this.rIm(n);case 1040:return this.qSb();case 1042:return this.zMa(n);case 1017:return this.rha(n);case 1041:return this.uTb(n);case 1025:return this.G7c(n);case 1044:return this.ITb();case 1032:return this.p7m(n);case 1027:return this.qgn(n);case 1039:return this.Bgn(n);case 1003:return this.tNa(n);case 1038:return this.Mgn(n);case 1037:return this.Ugn(n);case 1008:return this.lva(n);
case 1024:return this.hcb(n);case 1031:return this.vin(n);case 1004:return this.vNa(n);case 1021:return this.xjn(n);case 1029:return this.yjn(n);case 1034:return this.Kno(n);case 1033:return this.FGo();case 1013:return this.lja(n);case 1018:return this.t3b(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1015:return this.fTb();case 1009:return this.Ybb(n);case 1007:return this.jva(n);
case 1005:return this.acb(n);case 1010:return this.bcb(n);case 1006:return this.fcb(n);case 1016:return this.zxa(n);case 1036:return this.Hqa(n);case 1043:return this.Ngn(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}IKa(){this.clear();return null}zDl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ut);return this.compareLocationWith(d)}bF(){this.deleteRange();return null}Q6l(){this.endPreview();return null}L$l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,Ut);return this.expandTo(d)}M$l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ut);return this.expandToOrNullObject(d)}Hpm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getBookmarks(n,d)}GSb(){return this.getHtml()}lCm(){return this.getHyperlinkRanges()}qIm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"boolean");return this.getNextTextRange(n,d)}rIm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getNextTextRangeOrNullObject(n,d)}fTb(){return this.getOoxml()}qSb(){return this.getComments()}zMa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ei);return this.getContentControls(d)}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getRange(d)}uTb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}G7c(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(n,d)}ITb(){return this.getTrackedChanges()}p7m(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.highlight(d);return null}qgn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");this.insertBookmark(d);return null}Bgn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.insertComment(d)}Ybb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(n,d)}tNa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.insertContentControl(d)}Mgn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.insertEndnote(d)}Ngn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.insertField(n,B,Q,d)}Ugn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.insertFootnote(d)}jva(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(n,d)}acb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(n,d)}bcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertInlinePictureFromBase64(n,d)}fcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(n,d)}lva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}hcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(n,B,Q,d)}vin(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");
return this.insertTapObjectFromFileContent(n,B,d)}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(n,d)}xjn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ut);return this.intersectWith(d)}yjn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ut);return this.intersectWithOrNullObject(d)}Kno(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");this.previewTextReplacement(d);return null}FGo(){this.removeHighlight();return null}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.select(d);return null}t3b(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.split(n,B,Q,d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}Lnd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&
this.C7&&(this.C7.Jzb(),this.C7=null)}oCc(){this.C7&&this.C7.Jzb()}kPb(){this.C7?this.C7.hCa(this.Ud):this.C7=this.Bpc.create(this.Ud)}dPm(d){let n="";for(let Q=0;Q<this.Ud.count;Q++){var B=this.Ud.K(Q);switch(B.contextId){case ed.a.paragraph:B=this.lz.abe(B.node,d);n+=B;break;case ed.a.Nd:B=this.lz.vQf(B.node,d,B.cpBegin,B.cpEnd);n+=B;break;case ed.a.od:B.node.ra.last.Gi&&1==d||B.node.ra.last.Dj&&0==d||(n+=pc.a.dtc);break;case ed.a.kd:break;default:F.ULS.sendTraceTag(545005570,369,10,"The contextId {0} is not supported to get the reviewed text.",
B.contextId)}}return n}yqc(d){return d.contextId===ed.a.paragraph?!1:!0}Wna(d,n,B){const Q=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((ha,Aa)=>{const bb=B?0:1;this.fz.insertOoxml(this.Ud,d,n,this.Ud.K(0).node,this._context,ha,Aa,Q,bb,0,!0,this.C7)})}u3i(d){return this.Am.t3i(this.kq.K(0),d.kq.K(0))}wma(d,n){return this.Am.wma(d,n)}RDi(d,n){this.wma(d,n);const B=new ma.a;for(const Q of this.uh.aZ(d,n))B.add(ge.a.create(Q));1===B.count?d.cpBegin!==n.cpEnd?n.cpEnd>this.qb.textLength(n.node)?
(d.cpBegin<this.qb.textLength(n.node)&&0<d.cpBegin?B.W(0,ge.a.createTextRange(d.node,d.cpBegin,this.qb.textLength(n.node))):d.cpBegin?B.removeAt(0):B.W(0,ge.a.create(d.node)),d.cpBegin<=this.qb.textLength(n.node)&&0<d.cpBegin&&B.add(ge.a.Pm(n.node))):B.W(0,ge.a.createTextRange(d.node,d.cpBegin,n.cpEnd)):d.cpEnd<=this.qb.textLength(n.node)?B.W(0,d):B.removeAt(0):(d.cpBegin&&(d.cpBegin===this.qb.textLength(d.node)?B.W(0,ge.a.Pm(d.node)):d.cpBegin<this.qb.textLength(d.node)?(B.W(0,ge.a.createTextRange(d.node,
d.cpBegin,this.qb.textLength(d.node))),B.insert(1,ge.a.Pm(d.node))):B.removeAt(0)),0<n.cpEnd&&n.cpEnd<=this.qb.textLength(n.node)?B.W(B.count-1,ge.a.createTextRange(n.node,0,n.cpEnd)):n.cpEnd?B.W(B.count-1,ge.a.create(n.node)):B.removeAt(B.count-1));this.Am.Kzc(d,n,B,!0);return B}utb(){let d=[];const n=new ma.a;var B=this.Ud.K(0).node.id;let Q=this.Ud.K(0).node;var ha=this.Ud.K(0);let Aa=this.Ud.K(0);for(let bb=0;bb<this.Ud.count;bb++){const Ib=this.Ud.K(bb).node,oc=Ib.id;if(!B.equals(oc)){B=ha.cpBegin;
ha.contextId===ed.a.paragraph?B=0:ha.contextId===ed.a.od&&(B=ha.node.characterData.length);ha=Aa.cpEnd;if(Aa.contextId===ed.a.paragraph||Aa.contextId===ed.a.od)ha=Aa.node.characterData.length;B===ha?n.add(ge.a.jd(Q,B)):n.add(ge.a.createTextRange(Q,B,ha));Q=Ib;B=oc;ha=this.Ud.K(bb)}Aa=this.Ud.K(bb)}B=ha.cpBegin;ha.contextId===ed.a.paragraph?B=0:ha.contextId===ed.a.od&&(B=ha.node.characterData.length);ha=Aa.cpEnd;if(Aa.contextId===ed.a.paragraph||Aa.contextId===ed.a.od)ha=Aa.node.characterData.length;
B===ha?n.add(ge.a.jd(Q,B)):n.add(ge.a.createTextRange(Q,B,ha));for(const bb of n)bb.contextId===ed.a.kd&&(d=d.concat.apply(d,this.PXf(bb))),d=d.concat.apply(d,Hm.a.VD(bb,!1));return{returnValue:d,zfg:n}}K3f(){const d=this.Ud.K(0).node.id;for(let n=0;n<this.Ud.count;n++){const B=this.Ud.K(n).node.id;if(!d.equals(B))return!1}return!0}PXf(d){const n=[],B=Hm.a.VD(d,!0);for(const Q of B)Q.cpBegin===d.cpBegin&&n.push(Q);return n}$Yf(d=!1,n=0){this.uh.lkf(this.Ud);this.Ud.count||(F.ULS.sendTraceTag(37777541,
369,10,"GncList's length is incorrect after adjustment.",this._context.appId),pc.a.vg());var B=this.Ud.K(0),Q=this.Ud.K(this.Ud.count-1);if(B===Q&&B.contextId===ed.a.kd&&this.uh.Hcb(B)){let Aa;Q=B.node.ra.Vh(B.cpBegin);Aa=B.rp()<Q.hD?0:1;var ha;Q=this.nd.insertParagraph((ha=new ma.a,ha.add(B),ha),"",Aa);B=ge.a.create(Q);0<this.qb.nn(Q,0)?B.Ob=B.nc=this.qb.nn(Q,0)/2:B.Ob=B.nc=-1;return this.uh.Msa(B,B,this._context,n,d)}return B===Q&&B.contextId===ed.a.od?(ha=ge.a.uz(B.node),ha.Ob=ha.nc=B.rp(),this.uh.Hcb(ha)&&
pc.a.zE(),this.uh.k8a(ha,this._context,n,d)):this.yqc(B)?this.uh.k8a(B,this._context,n,d):this.yqc(Q)?this.uh.Msa(B,this.Ud.K(this.Ud.count-2),this._context,n,d):this.uh.Msa(B,Q,this._context,n,d)}QPf(d){if(G.AFrameworkApplication.$v){const n=new ma.a;this.Xz.o$d(n,d);return n}}PEp(){this.C7&&(this.Ud=this.C7.kq)}}Object(D.a)(Ut,"Range",rh.a,[866]);class Ks{constructor(d){this.cuf=new Map;d.execute(n=>{this.lY=n;this.woc()})}U8i(){return!1}YJf(){return null}W8i(){return!1}woc(){}V8i(d,n){if(!d)return!0;
if(d instanceof Uu)return this.aBn(d,n);if(this.W8i(d,n))return!0;d=this.NAm(d);return 0===d.count?!1:this.$An(d,n)}$An(d,n){for(const B of d)if(this.U8i(n,B))return!0;return!1}aBn(d,n){var B=!1;switch(d.type){case 0:B=!0;break;case 1:case 4:B=this.YJf(n,!0),n=this.YJf(n,!1),B=this.H5i(B,d.s0h)?!0:this.H5i(n,d.s0h)}return B}H5i(d,n){if(!d)return!1;d=vc.a.kb(d);return d.Ib(n.type)&&(d.xd(n.type),d.currentNode.equals(n))?!0:!1}NAm(d){return d instanceof wB?(d=d.Hua(),d=new ma.a([ge.a.create(d)])):d instanceof
Ut?(d.PEp(),d=d.kq):d instanceof fD&&d.isValid()?d=d.smc():new ma.a}qdb(d,n=0){!0!==this.cuf.get(d)&&(n=new tb.a(5,1,n,()=>{this.cuf.set(d,!1);this.wwe(d)}),this.cuf.set(d,!0),G.AFrameworkApplication.zc.pc(n))}wwe(){}}Object(D.a)(Ks,"AEventMessageManager",null,[1162]);class vu extends Ks{constructor(d,n,B){super(d);this.ax=n;this.q_h=B;this.fqb=400;this.UVc=new Map;this.Foj=(Q,ha)=>{if(null!==ha&&void 0!==ha&&ha.annotation&&(Q=ha.annotation,Q.content&&$C.a.typeGuard(Q.content)&&Q.content.id))switch(Q=
Q.content.id,ha.opType){case kj.d.getTypeName():this.lY.fireEvent(18,{id:Q});break;case "HoverOperation":this.lY.fireEvent(19,{id:Q});break;case Qj.a.getTypeName():this.VRh(20,Q);this.qdb(20,this.fqb);break;case ZE.a.getTypeName():this.VRh(21,Q),this.qdb(21,this.fqb)}}}hic(d,n,B){let Q=null;switch(d){case 18:case 19:Q=n.id;break;case 20:case 21:Q=n.ids}return{eventType:d,eventData:Q,dCb:B}}FVc(){return!1}woc(){Fi.a.Wkf&&(this.ax&&this.q_h?(this.ax.GUh(this.Foj),this.q_h.execute(d=>d.R6k(this.Foj))):
F.ULS.sendTraceTag(508129623,2250,10,"AnnotationEventMessageManager.hookupToRichApiEvtManager: AnnotationStorage or AugLoopProofingIntentProvider is not initialized yet!"))}VRh(d,n){this.UVc.get(d)||this.UVc.set(d,new Set);this.UVc.get(d).add(n)}wwe(d){const n=this.UVc.get(d);n&&(this.lY.fireEvent(d,{ids:Array.from(n)}),this.UVc.set(d,new Set))}}Object(D.a)(vu,"AnnotationEventMessageManager",Ks,[1162]);var kK=e(622),kw=e(1773);class xB{constructor(){this.replyIds=[]}lSh(d){d.kg?this.vob(d):this.Nsa(d)}vob(d){this.replyIds.push(d.x$a);
this.id||(this.id=kw.a.getInstance().fxm(d.kg))}Nsa(d){this.id=d.x$a}}Object(D.a)(xB,"CommentDetailInternal",null,[]);var lK=e(1412);class JH extends Ks{constructor(d,n){super(d);this.V$e=new Map;this.WJd=new Map;this.lra=n}hic(d,n,B){const Q=n.comment,ha=oB.a.instance.B6d(B);if(ha){var Aa=this.Wsm(Q);if(this.V8i(ha,Aa)&&(8!==d||!this.r5m(B))&&(n=this.trm(d,n)))return this.IOl(Q,B,d,n)}}FVc(d,n){if(d.changeType!==n.changeType)return!1;n.commentDetails=d.commentDetails.concat(n.commentDetails);return!0}woc(){this.lY.W6k(this.lGp.bind(this));
this.lY.IUh(this.Byl.bind(this))}U8i(d,n){switch(n.contextId){case ed.a.Nd:return this.Ann(d,n);case ed.a.paragraph:return this.znn(d,n)}return!1}YJf(d,n){return this.lra.Hd.Mb(n?Sz.l(d):Sz.i(d))}lGp(){for(const d of this.WJd.values())this.YHl(d.eventData);this.WJd.clear()}IOl(d,n,B,Q){var ha,Aa=null!==(ha=d.kg)&&void 0!==ha?ha:d.id;ha=n+"_"+B+"_"+Q+"_"+Aa;if(Aa=this.WJd.get(ha))return Aa=Aa.eventData.commentDetails[0],Aa.lSh(d),null;Aa=new xB;Aa.lSh(d);Aa={dCb:n,eventType:B,eventData:{source:this.lY.vd,
commentDetails:[Aa],changeType:Q}};this.WJd.set(ha,Aa);return Aa}Byl(d,n){n.eventType&&9===n.eventType&&(this.V$e=new Map)}r5m(d){return this.V$e.get(d)?!0:(this.V$e.set(d,!0),!1)}Wsm(d){return this.lra.Hd.Mb(d.objectId)}trm(d,n){if(10!==d)return"none";if(n.changeType)return n.changeType;d=n.comment;n=n.eoj;return d.done!==n.done?d.done?"resolved":"reopened":this.qyn(d.text[0],n.text[0])?null:d.kg?"replyEdited":"edited"}YHl(d){const n=d.commentDetails[0];d.commentDetails[0]={id:n.id,replyIds:n.replyIds}}qyn(d,
n){return this.hci(d)===this.hci(n)}hci(d){d=lB.a.ktb(d).ops;let n="";for(const B of d)n+=this.PLi(B);return n}PLi(d){let n="";const B=["insert","attributes","optional"];for(const Q of Object.keys(d)){const ha=d[Q];B.includes(Q)||(n+=Q);n=ha instanceof Object?n+this.PLi(ha):n+ha}return n}Ann(d,n){var B=new kK.a;B.add(d.id.toString());d=lK.a.m5c(n.node,n.cpBegin,!0,B);B=(B=lK.a.m5c(n.node,n.cpBegin,!1,B))&&B.Rb.cp<=n.cpEnd;return d&&d.Rb.cp<=n.cpEnd||B}znn(d,n){const B=Sz.l(d);d=Sz.i(d);n=n.node;return B===
n.id||d===n.id}}Object(D.a)(JH,"CommentEventMessageManager",Ks,[1162]);class dp extends Ks{constructor(d,n,B,Q,ha,Aa){super(d);this.E9a=n;this.ROb=B;this.ub=Q;this.v8=ha;this.Duf=Aa;this.fqb=400;this.Vpg=[];this.Ghc=new Map}woc(){if(pc.a.bbi()){this.E9a.addHandler(os.a.Xai,this.onContentChanged.bind(this));this.ub.BD(this.sR.bind(this));var d=Nf.a.wf.Um;d&&(d.Hf(12).yq(this.FW.bind(this)),d.Hf(55).wv((n,B)=>{this.Mhd(B.node,!1)}),d.Hf(55).wY((n,B)=>{this.Mhd(B.node,!0)}))}}FVc(d,n){n.ids=d.ids.concat(n.ids);
return!0}hic(d,n,B){n=n.nodeId?this.ROb.Hw(n.nodeId):n.node;const Q=this.sLf(n),ha=oB.a.instance.B6d(B);if(this.V8i(ha,n))if(0===d&&this.rFl(n.id))this.lY.fireEvent(0,{node:n});else return{eventType:d,eventData:{source:this.lY.vd,ids:[Q]},dCb:B}}W8i(d,n){return d instanceof fD?this.sLf(n)===d.id:!1}sR(d,n){if(d=n.Pn.currentSelection){d=this.v8.$Ai(d);for(const B of d)this.Mif(1,B),this.Vpg.includes(B)||this.lY.fireEvent(12,{nodeId:B});for(const B of this.Vpg)d.includes(B)||(this.lY.fireEvent(13,{nodeId:B}),
this.Mif(1,B));this.Vpg=d}}onContentChanged(d,n){this.Mif(2,n.Fe)}Mif(d,n){this.Ghc.get(d)||this.Ghc.set(d,new Set);this.Ghc.get(d).add(n);this.qdb(d,this.fqb)}wwe(d){const n=this.Ghc.get(d);if(n){for(const B of n)this.lY.fireEvent(d,{nodeId:B});this.Ghc.set(d,new Set)}}rFl(d){let n=!1;for(const [B,Q]of this.Ghc)Q.has(d)&&(this.lY.fireEvent(B,{nodeId:d}),Q.delete(d),n=!0);return n}FW(d,n){if(n.property===xd.a.so&&"Remote"===this.lY.vd){d=ge.a.create(n.node);d=this.Duf.fJi(d,d);for(const B of d)this.lY.fireEvent(2,
{node:B.je})}}Mhd(d,n){var B,Q;null!==(B=this.lY.Kw)&&void 0!==B&&B.Hd.id.equals(d.ed.id)&&d&&0!==this.sLf(d)&&(null===(Q=this.lY)||void 0===Q?void 0:Q.fireEvent(n?0:3,{node:d}))}sLf(d){return d.ka(Dd.a.yy,0)}}Object(D.a)(dp,"ContentControlEventMessageManager",Ks,[1162]);class mr extends Ks{constructor(d,n){super(d);this.K5b=n;this.Fia=(B,Q)=>{this.lY.fireEvent(14,{wordCount:Q.state.wordCount})}}hic(d,n,B){return{eventType:d,eventData:{source:this.lY.vd,wordCount:n.wordCount},dCb:B}}FVc(){return!0}woc(){this.K5b?
this.K5b.Dob(this.Fia):F.ULS.sendTraceTag(508826838,2250,10,"DocumentEventMessageManager.hookupToRichApiEvtManager: WordCountManager is not initialized yet!")}}Object(D.a)(mr,"DocumentEventMessageManager",Ks,[1162]);class KH{constructor(d,n,B,Q,ha){this.nCl=d;this.ktl=n;this.u2l=B;this.Pfo=Q;this.fbl=ha}WGi(d){let n=null;switch(d){case 11:case 10:case 7:case 8:case 9:n=this.nCl;break;case 3:case 1:case 2:case 0:case 12:case 13:n=this.ktl;break;case 14:n=this.u2l;break;case 15:case 16:case 17:n=this.Pfo;
break;case 18:case 19:case 20:case 21:n=this.fbl}return n}}Object(D.a)(KH,"EventMessageManagerMapper",null,[]);class iF extends Ks{constructor(d,n){super(d);this.nwc=n;this.fqb=pc.a.IWn;this.aRb=new Map;this.Sse=new Map;this.FW=(B,Q)=>{B=Q.node;Q.property===xd.a.so&&B&&this.buf(16,B.id)};this.Z7n=(B,Q)=>{B=Q.node;Q.hhe||!B||B.xZa||this.buf(15,B.id)};this.b8n=(B,Q)=>{(B=Q.node)&&!B.xZa&&this.buf(17,B.id)}}woc(){if(pc.a.Vmg){var d=Nf.a.wf.Um;d&&(d=d.Hf(12),d.yq(this.FW),d.wv(this.Z7n),d.bA(this.b8n))}}FVc(d,
n){if(d.source!==n.source)return!1;n.uniqueLocalIds=[...(new Set(d.uniqueLocalIds.concat(n.uniqueLocalIds)))];return!0}hic(d,n,B){n=n.Xyb;const Q=this.nwc.TIi(n);17==d&&this.nwc.eHo(n);return{eventType:d,eventData:{source:this.lY.vd,uniqueLocalIds:[Q]},dCb:B}}mif(d,n){this.aRb.get(d)||this.aRb.set(d,new Set);this.aRb.get(d).add(n.toString());this.Sse.set(n.toString(),d)}IIj(d,n){this.aRb.get(d)&&this.aRb.get(d).delete(n.toString());this.Sse.delete(n.toString())}buf(d,n){const B=this.Sse.get(n.toString());
if(B)switch(d){case 17:this.IIj(B,n);15!=B&&(this.mif(d,n),this.qdb(d,this.fqb));break;case 16:17==B&&F.ULS.sendTraceTag(508404E3,369,15,"Trying to modify a deleted paragraph object: {0}",n.toString());break;case 15:17==B?(this.IIj(B,n),this.mif(16,n),this.qdb(16,this.fqb)):F.ULS.sendTraceTag(508403999,369,15,"Trying to add a new paragraph object: {0} when one already exists",n.toString())}else this.mif(d,n),this.qdb(d,this.fqb)}wwe(d){const n=this.aRb.get(d);if(n){for(const B of n)this.lY.fireEvent(d,
{Xyb:B}),this.Sse.delete(B);this.aRb.set(d,new Set)}}}Object(D.a)(iF,"ParagraphEventMessageManager",Ks,[1162]);var yB=e(1276);class Er{constructor(d,n,B){this.sLc=new dc.a;this.tKd=[];this.yOc=[];this.BNd=new Map;this.xMe=null;this.nmh=d;this.p7=n;this.Z9e=B;this.V8m()}get OG(){!this.xMe&&Nf.a&&yg.StaticActiveAppFrame.Aa()&&yg.StaticActiveAppFrame.Aa().tb&&yg.StaticActiveAppFrame.Aa().tb.rd&&yg.StaticActiveAppFrame.Aa().tb.rd.Jg&&(this.xMe=yg.StaticActiveAppFrame.Aa().tb.rd.Jg);return this.xMe}get Kw(){var d,
n;return null===(n=null===(d=yg.StaticActiveAppFrame.Aa())||void 0===d?void 0:d.tb)||void 0===n?void 0:n.rd}get vd(){return this.OG&&2===this.OG.enabled?"Remote":"Local"}W6k(d){this.sLc.addHandler(Er.Noj,d)}IUh(d){this.sLc.addHandler(Er.Dhg,d)}HIo(d){this.sLc.removeHandler(Er.Dhg,d)}fireEvent(d,n){try{const B=this.nmh.WGi(d);if(!B)return null;const Q=this.mUm(d);if(0!==Q.length){this.sLc.raiseEvent(Er.Dhg,{eventType:d});for(const ha of Q){const Aa=B.hic(d,n,ha);Aa&&this.zro(ha,Aa)}this.Z9e.G4n()}}catch(B){throw this.aLn(B,
{eventType:d}),B;}}zro(d,n){let B=this.BNd.get(d);B||(B=[],this.BNd.set(d,B));B.push(n)}V8m(){this.Z9e.bD(this.z$k.bind(this));this.Z9e.tEo();this.Ude=this.Ude.bind(this);this.IUh(this.Ude)}Ude(){this.OG&&(this.OG.RUd(this.HWo.bind(this)),yB.a.instance.VUd(this.b7l.bind(this)),this.HIo(this.Ude))}b7l(){0!==this.tKd.length&&(this.yOc=this.yOc.concat(this.tKd),this.tKd=[])}HWo(){if(0!==this.yOc.length){for(const d of this.yOc)this.tRj(d);this.yOc=[]}}z$k(){this.sLc.raiseEvent(Er.Noj);for(const d of this.BNd.values()){for(let n=
1;n<d.length;n++){const B=d[n-1],Q=d[n];this.NXn(B,Q)?this.nmh.WGi(Q.eventType).FVc(B.eventData,Q.eventData)||this.tBg(B):this.tBg(B)}this.tBg(d[d.length-1])}this.BNd.clear()}NXn(d,n){return d.eventType===n.eventType}tBg(d){d&&(this.OG&&!this.OG.rG()?this.tRj(d):this.tKd.push(d))}tRj(d){this.p7.fireEvent(d.dCb,d.eventType,d.eventData)}aLn(d,n=null){d={["ErrMsg"]:d.message,["ErrStack"]:d.stack};n&&(d.ExtendMsg=n);F.ULS.sendTraceTag(523072988,369,50,"Exception in event: {0}",d)}mUm(d){var n;const B=
[],Q=null!==(n=this.p7.m_eventIdControlMapByTarget)&&void 0!==n?n:{};for(const ha of Object.keys(Q))Q[ha][d]&&B.push(ha);return B}}Er.Noj="BAE";Er.Dhg="BFE";Object(D.a)(Er,"RichApiEventManager",null,[1161]);var $r=e(1287),YL=e(292);class LH extends $r.a{constructor(){super()}get index(){return 5}run(){this.Xsk()}tEo(){YL.a.instance.Cxa(this,3)}bD(d){this.Xsk=d}G4n(){this.t2()}}Object(D.a)(LH,"RichApiEventTransactionCompletedProcessor",$r.a,[]);var MH=e(1892);class Yl extends MH.a{constructor(d,n,
B,Q,ha,Aa,bb){super(ha,d,null,n,B,null,null,Q,Aa);this.GEd=bb}Chg(){this._state=0;this.bob=this.gV.Ome||this.gV.ignoreSpace||this.gV.ignorePunct?this.nla.zAj(this.gV):this.nla.ald(this.gV.text)}yqf(){return this.GEd.K(this.fQ)?!1:(this.wpb(),this._state=2,this.eBb(!0),!0)}slg(){this.FTf(this.GEd.K(this.fQ).node,0);this.fQ++}wpb(){this.fQ=0;this.bob=""}EUd(d,n){this.il.JUd(n)}Otf(){return this.fQ<this.GEd.count}mhg(){this.fQ>=this.GEd.count&&(this.fQ=0,this._state=2,this.eBb(!0))}Ayg(){const d=this.nla.VZb(this.bob);
try{this.v9b=this.w9b.gnc(d.join("|"),this.gV)}catch(n){F.ULS.sendTraceTag(17339148,313,10,"ExtensionFindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.gV.matchCase,this.gV.matchWholeWord),this.v9b=null,this._state=2,this.eBb(!0)}return!1}}Object(D.a)(Yl,"ExtensionFindManager",MH.a,[]);class jD{constructor(d,n,B,Q){this.nla=d;this.Cr=n;this.w9b=B;this.A2e=Q}create(d,n,B){return new Yl(this.nla,this.Cr,this.A2e,this.w9b,d,n,B)}}Object(D.a)(jD,
"ExtensionFindManagerFactory",null,[]);var Nw=e(2122);class Vz extends Nw.a{constructor(d,n,B,Q){super();this.Nfa=this.mV=this.SKd=null;n&&0<n.count&&(this.SKd=this.zIm(n),this.mV=B,this.Nfa=new ma.a);this.Jk=d;this.hY=Q}DXa(d,n){if(!d&&0<n.length)for(d=0;d<n.length;d++){const B=new ma.a,Q=n[d].nodeId;if(this.SKd.Bb(Q)){const ha=this.SKd.K(Q);(ha.contextId===ed.a.paragraph||ha.contextId===ed.a.Nd&&n[d].Mc>=ha.cpBegin&&n[d].end<=ha.cpEnd)&&this.PPl(B,Q,n[d])}}}PPl(d,n,B){d.add(ge.a.createTextRange(this.SKd.K(n).node,
B.Mc,B.end));this.Nfa.add(this.Jk.create(d,this.hY,this.Nfa.count))}Nkc(){this.mV(this.Bol())}Bol(){return new rv(this.Nfa)}zIm(d){const n=new lm.a;for(const B of d)n.add(B.node.id,B);return n}}Object(D.a)(Vz,"ExtensionFindStatusManager",Nw.a,[]);class kD{constructor(){this.Jk=null}Vu(d){this.Jk=d}create(d,n,B){return new Vz(this.Jk,d,n,B)}}Object(D.a)(kD,"ExtensionFindStatusManagerFactory",null,[]);var yq=e(1067);class Ow extends yq.a{constructor(d,n,B,Q,ha,Aa,bb){super(d,n,B,Q,ha);this.mV=Aa;this.gsa=
bb}P3h(){this.gsa(null)}Q3h(){this.mV(this.uQ.K(0))}R3h(){this.gsa(null)}}Object(D.a)(Ow,"ExtensionImageSteward",yq.a,[]);class sv{constructor(d,n,B,Q){this.ll=d;this.Sb=n;this.yo=B;this.Qd=Q}create(d,n,B){return new Ow(d,this.ll,this.Sb,this.yo,this.Qd,n,B)}}Object(D.a)(sv,"ExtensionImageStewardFactory",null,[]);var ZL=e(1932);class Pw{constructor(){}Vu(d,n,B,Q,ha,Aa){this.Jk=d;this.Tz=n;this.yd=B;this.uh=Q;this.nd=ha;this.Wr=Aa}create(d,n,B=0,Q=null){return new ZL.a(d,n,B,Q,this.Jk,this.Tz,this.yd,
this.uh,this.nd,this.Wr)}}Object(D.a)(Pw,"FieldFactory",null,[1011]);var mK=e(345),NH=e(956),OH=e(1170);class zB{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd){this.jGb=d;this.qb=n;this.uh=B;this.pi=Q;this.YF=ha;this.Q7=Aa;this.td=bb;this.iGb=Ib;this.VG=oc;this.IVk=Ac;this.nd=ad;this.Lh=sd;this.anh=wd;this.ga=yd}jOm(d,n,B){if(!d.ra||!d.Rca)return{yea:null,startCp:0,endCp:0};for(;0<=n;n--){const Q=d.ra.Vh(n);if(Q&&Q.Fc)for(let ha=0;ha<Q.Fc.length;ha++){const Aa=Q.Fc.K(ha);if(!Aa.ze&&1===Aa.Iu)return{yea:d,
startCp:n,endCp:B}}}d=this.qb.Cg(d,!0,!0);return this.vKi(d)}Lym(d,n,B,Q){if(!d.ra)return{yea:null,startCp:0,endCp:0};for(let ha=n;ha<=d.characterData.length;ha++){const Aa=d.ra.Vh(ha);if(Aa&&Aa.Fc)for(let bb=0;bb<Aa.Fc.length;bb++){const Ib=Aa.Fc.K(bb);if(!Ib.ze&&1===Ib.Iu)return ha>=B?{yea:null,startCp:0,endCp:0}:{yea:d,startCp:ha,endCp:B};if(ha!==n&&!Q)return this.jOm(d,n,B)}}return{yea:null,startCp:0,endCp:0}}I9d(d,n,B,Q,ha,Aa=!1){const bb=new ma.a;let Ib=d,oc=Ib.ra;if(oc&&Ib.Rca){let {yea:yd,
startCp:be,endCp:ye}=this.Lym(d,n,B,ha);if(yd){Ib=yd;oc=Ib.ra;var Ac=0;let Qe=null;ha=!0;Aa&&B===Ib.characterData.length&&ye++;for(Aa=be;Aa<ye;Aa++){var ad=oc.Vh(Aa);if(ad&&ad.Fc)for(var sd=0;sd<ad.Fc.length;sd++){var wd=ad.Fc.K(sd);3===wd.ze&&1===wd.Iu?(ha=!0,Qe&&Ac!==ad.cp&&(Qe.Ud.add(ge.a.createTextRange(yd,Ac,ad.cp)),bb.add(Qe))):wd.ze||1!==wd.Iu?5===wd.ze&&(Qe.Ud.add(ge.a.createTextRange(yd,Ac,ad.cp)),Qe.Ud.add(ge.a.Pm(yd)),wd=this.qb.Cg(yd,!1,!0),bb.add(this.RGf(wd,Qe))):(ha=!1,Ac=new ma.a,
Qe=this.jGb.create(Ac,Q),Ac=ad.cp)}}for(Aa=ye;!ha&&Aa<=Ib.characterData.length;Aa++)if((ad=oc.Vh(Aa))&&ad.Fc)for(sd=0;sd<ad.Fc.length;sd++)wd=ad.Fc.K(sd),3===wd.ze&&1===wd.Iu?(ha=!0,Qe.Ud.add(ge.a.createTextRange(yd,Ac,ad.cp)),bb.add(Qe)):5===wd.ze&&(Qe.Ud.add(ge.a.createTextRange(yd,Ac,ad.cp)),Qe.Ud.add(ge.a.Pm(yd)),wd=this.qb.Cg(yd,!1,!0),bb.add(this.RGf(wd,Qe)))}}if(bt.a.vca){d=this.HIm(ge.a.createTextRange(d,n,B),Q);for(const yd of d)bb.add(yd)}return bb}HIm(d,n){const B=d.node;let Q=0,ha=-1,
Aa=null;const bb=[],Ib=B.ra;for(;Ib&&Q<Ib.length;){const Ac=Ib.jc(Q++);if(Ac.Qp&&Aa){if(ha<d.cpEnd&&d.cpBegin<Ac.cp&&Aa){var oc=new ma.a;oc.add(ge.a.createTextRange(B,ha,Ac.cp));bb.push(this.jGb.create(oc,n,0,Aa));Aa=null}else ha!==d.cpEnd&&d.cpBegin!==Ac.cp||!Aa||(oc=new ma.a,oc.add(ge.a.createTextRange(B,ha,Ac.cp)),bb.push(this.jGb.create(oc,n,0,Aa)),Aa=null);if(Ac.cp>=d.cpEnd)break}if(Ac.hyperlink&&!Ac.Fc||Ac.hyperlink&&!this.R3m(Ac.Fc))ha=Ac.cp,Aa=Ac.hyperlink}return bb}R3m(d){for(let n=0;n<d.length;n++)if(1===
d.K(n).ze){const B=d.K(n).rZ;if(B&&B.startsWith(Hm.a.Lkc)&&Hm.a.i_a(Hm.a.Qua(B)))return!0}return!1}vKi(d){if(!d.ra||!d.Rca)return{yea:null,startCp:0,endCp:0};for(let n=d.characterData.length;0<=n;n--){const B=d.ra.Vh(n);if(B&&B.Fc)for(let Q=B.Fc.length-1;0<=Q;Q--){const ha=B.Fc.K(Q);if(!ha.ze&&1===ha.Iu)return{yea:d,startCp:n,endCp:d.characterData.length}}}d=this.qb.Cg(d,!0,!0);return this.vKi(d)}lmc(d,n,B){return this.I9d(d,0,d.characterData.length,n,B,!0)}RGf(d,n){const B=d.ra;if(!B||!d.Rca)return n;
let Q=0;for(let ha=0;ha<B.length;ha++){const Aa=B.jc(ha);if(Aa.Fc)for(let bb=0;bb<Aa.Fc.length;bb++){const Ib=Aa.Fc.K(bb);if(!(1<Ib.Iu))if(4===Ib.ze)Q=Aa.cp;else{if(3===Ib.ze)return n.Ud.add(ge.a.createTextRange(d,Q,Aa.cp)),n;if(5===Ib.ze)return n.Ud.add(ge.a.createTextRange(d,Q,Aa.cp)),n.Ud.add(ge.a.Pm(d)),d=this.qb.Cg(d,!1,!0),this.RGf(d,n)}}}return n}Jym(d,n){const B=d.start,Q=d.end;if(B&&Q)return d.Pg?this.Iym(B,Q,n):this.I9d(B.node,B.cpBegin,Q.cpEnd,n,!1)}Iym(d,n,B){n=this.uh.aZ(d,n);d=new ma.a;
for(const Q of n)n=this.lmc(Q,B,!0),d.addRange(n);return d}getNextOrNullObject(d,n){if(!d.Ud||0===d.Ud.count)return null;d=d.Ud.K(d.Ud.count-1);if(d.cpEnd!==d.node.characterData.length){var B=this.I9d(d.node,d.cpEnd,d.node.characterData.length,n,!0);if(0<B.count)return B.K(0)}for(d=this.qb.Cg(d.node,!1,!0);d;){B=this.lmc(d,n,!0);if(0<B.count)return B.K(0);d=this.qb.Cg(d,!1,!0)}return null}Gym(d){var n;if(null===d.Ud||0===d.Ud.count)return"";if(bt.a.vca&&d.ZWf)return"HYPERLINK "+(null===(n=d.ZWf)||
void 0===n?void 0:n.url);d=d.Ud.K(0);(d=d.node.ra.Vh(-1==d.cpBegin?0:d.cpBegin))&&d.Fc||pc.a.vg();const B=[];for(n=0;n<d.Fc.length;++n)if(0===d.Fc.K(n).ze){const Q=new mK.a(d.Fc,n);for(const ha of NH.a.N9a(Q,!1))1===ha.Qm.ze&&B.push(ha.Qm.rZ)}return 0===B.length?"":1===B.length?B[0]:B.every(Q=>Q===B[0])?(F.ULS.sendTraceTag(508347467,324,15,"Found duplicate field instruction in {0} markers",B.length),B[0]):B.join("")}r0o(d,n){if(null!==d.Ud&&0!==d.Ud.count){d=d.Ud.K(0);var B=d.node.ra.Vh(d.cpBegin);
if(B&&B.Fc)for(let Q of NH.a.x8(d.node,d.cpBegin))1===Q.Qm.ze&&(Q.Qm.rZ=n);else pc.a.vg()}}cDi(d,n,B){const Q=new ma.a;for(const ha of this.pi.kA(d,0,this.pi.Hg(d)-1))Q.addRange(this.dDi(ha,n,B));return Q}dDi(d,n,B){const Q=new ma.a;for(const ha of this.YF.UD(d))Q.addRange(this.Kym(ha,n,B));return Q}Kym(d,n,B){if(this.Q7.Js(d))return null;const Q=this.td.Lm();Q.set(d);var ha=Q.ue();for(d=new ma.a;ha;)ha=Q.ue(),12===ha.type?d.addRange(this.lmc(ha,n,B)):14===ha.type&&d.addRange(this.cDi(ha,n,B)),Q.Ac(),
ha=Q.xl();return d}insertField(d,n,B,Q=31,ha,Aa=!1){Q=0==Q?31:Q;this.nd.DY(d,B,0);const bb=d.K(0),Ib=d.K(d.count-1);let oc=null;({yN:oc}=this.nd.bP(bb,Ib,B));4==B&&this.nd.Yic(d);switch(!0){case 31==Q||81==Q:return this.Vgn(n,B,Q,ha,Aa,oc,bb,Ib);case 88==Q:return this.dhn(d,n,B,ha);case 13==Q:return this.oin(oc).then(()=>{var Ac=this.qb.Cg(oc.node,!1,!0);Ac=this.lTm(Ac);return this.jGb.create(Ac,n)});default:pc.a.Cd()}}vcm(d){switch(d){case 31:return" DATE ";case 81:return" ADDIN ";default:return""}}Vgn(d,
n,B=31,Q,ha=!1,Aa,bb,Ib){return OfficeExtension.WacRuntime.Utility.createPromise(oc=>{var Ac=this.vcm(B);null!=Q&&(Ac+=Q);ha||(Ac+=" \\* MERGEFORMAT ");var ad=this.iGb.insertField(Aa,Ac,""),sd=ge.a.OV(ad.cpBegin,ad.cpEnd,!1,0==n||2==n||4==n?bb.node:Ib.node);if(31==B){if(sd=this.anh.N7c(OH.a.Ckc(Ac)))ad=this.iGb.pGf(ad),sd.fPg(Ac,ad);Ac=this.iGb.pGf(Aa);Ac=this.jGb.create(Ac,d)}else Ac=new ma.a([sd]),Ac=this.jGb.create(Ac,d);oc(Ac)})}dhn(d,n,B,Q){return OfficeExtension.WacRuntime.Utility.createPromise(ha=>
{var Aa=this.nd.insertText(d,Q,B),bb=Aa.K(0);bb=this.VG.SJ(bb,Q,!1,!1,!0,!1);Aa=this.jGb.create(Aa,n,0,bb);ha(Aa)})}oin(d){return OfficeExtension.WacRuntime.Utility.createPromise(n=>{if(32!==this.IVk.kYi(0,d,2,null,{resolve:n}))throw pc.a.vg();})}lTm(d){var n,B=null===(n=null===d||void 0===d?void 0:d.ra)||void 0===n?void 0:n.first.Qb;(!B||0>=B.length)&&pc.a.vg();n=d.ra.first.Qb.K(0);n.Pg||(F.ULS.sendTraceTag(508949568,3019,15,"Content control is not block type"),pc.a.vg());n=this.Lh.Ds(n.je.id,!1);
B=new ma.a;for(B.add(ge.a.create(d));d&&(d=bf.ParagraphReader.Cg(d,!1),B.add(ge.a.create(d)),d.id!=n););return B}H9d(d){if(null===d.Ud||0===d.Ud.count)return null;d=d.Ud.K(0);if((d=d.node.ra.Vh(d.cpBegin))&&d.Fc){for(let n=0;n<d.Fc.length;n++){const B=d.Fc.K(n);if(0===B.ze)return B}return null}pc.a.vg()}updateResult(d){const n=this.anh.N7c(OH.a.Ckc(d.code));if(n)if(bt.a.vca){const B=this.iGb.pGf(d.Ud.K(0));n.fPg(d.code,B)}else n.fPg(d.code,d.Ud);else 13===d.type&&this.ga.Sf(d.Ud.K(0),Se.a.Z4b,2,!1,
null,null)}}Object(D.a)(zB,"FieldOperations",null,[1158]);class Wz{[Symbol.iterator](){return this}constructor(d,n=!1){this.emn=n;d=this.DXn(d);this.yce=vc.a.kb(d);this.currentNode=this.Jwb(d)?d:n?this.ZJi():this.NHi()}next(){const d=this.currentNode;return null!=d?(this.currentNode=this.emn?this.ZJi():this.NHi(),{value:d}):{value:void 0,done:!0}}NHi(){for(;this.yce.Di(1);){const d=this.yce.currentNode;if(this.Jwb(d))return d}}ZJi(){for(;this.yce.dR(1);){const d=this.yce.currentNode;if(this.Jwb(d))return d}}DXn(d){d=
vc.a.kb(d);return d.Ib(10)?d.Gq(10):null}Jwb(d){return!!d&&10===d.type&&d.yc===Fc.a.gka}static create(d,n=!1){return new Wz(d,n)}}Object(D.a)(Wz,"WordSectionNodeIterator",null,[]);var lD=e(1749);class Gx{constructor(d,n,B,Q,ha,Aa,bb){this.jj=bb;this.gsa=this.mV=this._context=this.NIh=this.xAa=this.uh=this.Jk=null;this.YLc=this.ZEb=this.pQh=this.W6=0;this.HOh=!1;this.XIa=d;this.nd=n;this.qb=B;this.Xz=Q;this.sTa=Aa}Vu(d,n,B){this.Jk=d;this.uh=n;this.xAa=B}getHtml(d,n){pc.a.r4c()&&this.nd.k5f(d[0].node)&&
pc.a.fMg();n.vo.qH();let B="";d=({UYa:B}=this.sTa.mMf(d,!0)).returnValue;n.vo.ex();d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pc.a.vg();return B}qAn(d){if((new RegExp(Gx.FGh)).test(d))return!0;const n=new RegExp(Gx.EGh,"g");let B=0;for(;n.exec(d)&&1>=B;)B++;return 1<B}wvn(d){return(new RegExp(Gx.EGh)).test(d)||(new RegExp(Gx.FGh)).test(d)}insertHtml(d,n,B,Q,ha,Aa=!1,bb=null){this._context=ha;ha=this.wvn(n)?1:0;this.nd.DY(d,B,ha);let Ib=new ma.a,oc=!1,Ac=null,ad=13;if(pc.a.Mxd())4===B&&(this.uh.hQb(),
this.nd.sOb(d),this.uh.WLa(),B=2),ha=new ma.a,ha.addRange(d),oc=this.nd.aie(ha,B),{yN:Ac,returnValue:ad}=this.nd.bP(ha.K(0),ha.K(ha.count-1),B),this.qAn(n)&&(Ac=this.uh.fRa(Ac,d)),Ib.add(Ac),oc&&({yN:Ac,returnValue:ad}=this.nd.bP(d.K(0),d.K(d.count-1),B));else{ha=d.K(0);const sd=d.K(d.count-1);({yN:Ac,returnValue:ad}=this.nd.bP(ha,sd,B));13===ad?Ib=d:Ib.add(Ac)}bb&&bb.Jzb();return OfficeExtension.WacRuntime.Utility.createPromise(sd=>{const wd=this.sTa.OAe(Ib.toArray(),!0,n,(yd,be)=>{yd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
be||(bb&&bb.hCa(d),pc.a.vg());yd=new ma.a;for(const ye of be.toArray())yd.add(ye);yd.K(0).contextId===ed.a.kd?(yd.clear(),yd.add(Ac)):(this.nd.Cx(yd.K(0)),this.nd.Cx(yd.K(yd.count-1)));be=this.Jk.create(yd,this._context);sd(be);if(Aa){if(oc&&(be=yd.K(yd.count-1),be.contextId===ed.a.paragraph)){let ye;this.nd.E2d((ye=new ma.a,ye.add(ge.a.create(this.qb.Cg(be.node,!1))),ye))}this.LEp(d,yd,ad,oc)}bb&&bb.hCa(d);pc.a.lR("FileApiOperations.InsertHtml",pc.a.WR(Q),n.length)});wd!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(bb&&bb.hCa(d),wd===OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection&&pc.a.zE(),pc.a.vg())})}LEp(d,n,B,Q=!1){if(n.count&&(1!==n.count||n.K(0).contextId!==ed.a.kd)){var ha=d.K(0),Aa=d.K(d.count-1),bb=n.K(n.count-1),Ib=this.qb.Cg(bb.node,!1);switch(B){case 0:bb.contextId!==ed.a.Nd||Q?d.W(0,ge.a.create(Ib)):(d.W(0,ge.a.create(bb.node)),this.nd.Cx(d.K(0),0),n.removeAt(n.count-1));d.K(0).nc=ha.vp();d.PC(0,n);break;case 1:case 2:bb.contextId===ed.a.Nd?(d.W(0,ge.a.Pm(bb.node)),d.K(0).nc=ha.vp()):
bb.contextId===ed.a.paragraph?d.removeAt(0):bb.contextId===ed.a.od&&n.remove(bb);d.PC(0,n);break;case 3:if(B=ha.cpEnd-ha.cpBegin){if(bb.contextId===ed.a.Nd)Q?(d.W(0,ge.a.createTextRange(Ib,0,B)),n.add(ge.a.Pm(bb.node))):(d.W(0,ge.a.createTextRange(bb.node,bb.cpBegin,bb.cpEnd+B)),n.removeAt(n.count-1),n.count||(d.K(0).Ob=bb.rp())),1<d.count&&d.K(1).contextId===ed.a.od&&d.W(1,ge.a.Pm(d.K(0).node));else if(bb.contextId===ed.a.paragraph||bb.contextId===ed.a.od)d.W(0,ge.a.createTextRange(Ib,0,B)),1<d.count&&
d.K(1).contextId===ed.a.od&&d.W(1,ge.a.Pm(Ib));d.K(0).nc=ha.vp()}else d.removeAt(0);d.PC(0,n);break;case 5:case 6:d.W(0,ge.a.Pm(bb.node));this.nd.TGa(d.K(0));d.K(0).nc=this.qb.xz(d.K(0).node);break;case 7:if(B=ha.cpEnd-ha.cpBegin){if(bb.contextId===ed.a.Nd)Q?(d.W(0,ge.a.createTextRange(Ib,0,B)),d.K(0).Ob=this.qb.jA(Ib)):(d.W(0,ge.a.createTextRange(bb.node,bb.cpEnd,bb.cpEnd+B)),this.nd.TGa(d.K(0))),1<d.count&&d.K(1).contextId===ed.a.od&&d.W(1,ge.a.Pm(d.K(0).node));else if(bb.contextId===ed.a.paragraph||
bb.contextId===ed.a.od)d.W(0,ge.a.createTextRange(Ib,0,B)),d.K(0).Ob=this.qb.jA(Ib),1<d.count&&d.K(1).contextId===ed.a.od&&d.W(1,ge.a.Pm(Ib));d.K(0).nc=ha.vp()}else{if(bb.contextId===ed.a.Nd)d.W(0,ge.a.jd(bb.node,bb.cpEnd)),this.nd.TGa(d.K(0));else if(bb.contextId===ed.a.paragraph||bb.contextId===ed.a.od)d.W(0,ge.a.uz(bb.node)),this.nd.TGa(d.K(0));d.K(0).nc=d.K(0).rp()+ha.vp()-ha.rp()}break;case 4:bb.contextId!==ed.a.Nd||Q?(d.W(0,ge.a.create(Ib)),d.K(0).Ob=ha.rp(),d.K(0).nc=ha.vp()):(d.W(0,ge.a.createTextRange(bb.node,
bb.cpEnd,this.qb.textLength(bb.node))),this.nd.TGa(d.K(0)),d.K(0).nc=ha.vp(),d.insert(1,ge.a.Pm(bb.node)));break;case 9:Aa.contextId===ed.a.od?Q||(d.removeAt(d.count-1),n.K(0).contextId===ed.a.Nd&&0<d.count&&d.K(d.count-1).contextId===ed.a.Nd&&(n.W(0,ge.a.createTextRange(n.K(0).node,d.K(d.count-1).cpBegin,n.K(0).cpEnd)),n.K(0).Ob=d.K(d.count-1).rp(),d.removeAt(d.count-1))):Aa.contextId!==ed.a.paragraph||Q||n.K(0).contextId!==ed.a.Nd||(d.W(d.count-1,ge.a.createTextRange(n.K(0).node,0,n.K(0).cpEnd)),
d.K(d.count-1).Ob=Aa.rp(),n.removeAt(0));bb.contextId===ed.a.Nd&&(Q=ge.a.Pm(bb.node),Q.nc=this.qb.xz(bb.node),n.add(Q));d.addRange(n);break;case 10:Aa.contextId===ed.a.kd?d.removeAt(d.count-1):Aa.contextId===ed.a.Nd&&(n.K(0).contextId===ed.a.Nd?(d.W(d.count-1,ge.a.createTextRange(n.K(0).node,Aa.cpBegin,n.K(0).cpEnd)),this.nd.Cx(d.K(d.count-1),1),n.removeAt(0)):n.K(0).contextId===ed.a.od&&d.W(d.count-1,ge.a.createTextRange(n.K(0).node,Aa.cpBegin,Aa.cpEnd)),d.K(d.count-1).Ob=Aa.rp());d.addRange(n);
break;case 12:Q||(Aa.contextId===ed.a.kd?d.W(d.count-1,ge.a.jd(n.K(0).node,Aa.cpBegin)):Aa.contextId===ed.a.Nd&&d.W(d.count-1,ge.a.createTextRange(n.K(0).node,Aa.cpBegin,Aa.cpEnd)),d.K(d.count-1).Ob=Aa.rp(),d.K(d.count-1).nc=Aa.vp());break;case 13:d.clear(),d.addRange(n)}}}getOoxml(d,n,B,Q,ha){this.A$c(null,n,B,Q,ha);this.XIa.getOoxml(d.toArray(),Aa=>{this.mV(Aa);this._context.vo.ex();pc.a.lR("FileApiOperations.GetOoxml",pc.a.WR(this.W6),Aa.length)},Aa=>{F.ULS.sendTraceTag(17568003,369,10,"AppId:{0}, {1}",
this._context.appId,lD.a[Aa]);this.gsa(lD.a[Aa]);this._context.vo.ex();pc.a.lR("FileApiOperations.GetOoxml",pc.a.WR(this.W6),void 0,!1)})}insertOoxml(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac=0,ad=!1,sd=null,wd=null){this.nd.DY(d,B,0);sd&&sd.Jzb();this.A$c(Q,ha,Aa,bb,Ib,oc,Ac,B,ad);this._context.vo.qH();this.Ghn(d,n,sd,wd)}A$c(d,n,B,Q,ha,Aa=0,bb=0,Ib=0,oc=!1){this.NIh=d?8===d.type||10===d.type?d:this.tPf(d):null;this._context=n;this.mV=B;this.gsa=Q;this.W6=ha;this.pQh=Aa;this.ZEb=bb;this.YLc=Ib;this.HOh=oc}Ghn(d,
n,B,Q){let ha=new ma.a;var Aa=d.K(0);const bb=d.K(d.count-1);var Ib=null;const oc=({yN:Ib}=this.nd.bP(Aa,bb,this.YLc)).returnValue;let Ac=null,ad=null;13===oc?(ha=d,this.ZEb||(this.ZEb=this.Dtm(d)),Ib=ge.a.jd(Aa.node,Aa.Uj),Ib.nc=Ib.Ob=Aa.Ob,Aa=ge.a.jd(bb.node,bb.Yp),Aa.nc=Aa.Ob=bb.nc,Ac=this.uh.Yfc(Ib,void 0,!0),ad=this.uh.Yfc(Aa,void 0,!1)):(ha.add(Ib),this.ZEb||-1===Ib.rp()||(this.YLc=({yy:this.ZEb}=this.Ctm(Ib,this.ZEb)).returnValue),Ac=this.uh.Yfc(Ib,void 0,!0),ad=this.uh.Yfc(Ib,void 0,!1));
let sd=-1,wd=-1;9===oc&&(sd=bb.rp(),wd=bb.vp());this.XIa.xBe(ha.toArray(),n,this.ZEb,this.YLc,this.pQh,Q,async yd=>{yd=pc.a.Ogn()?await this.xDm(yd):this.sFi(yd);this._context.vo.ex();if(0===yd.count)return this.gsa("Can't find the inserted content. Please refresh the page for the result.");this.uh.Fye(yd.K(0),Ac,void 0,void 0,!0);this.uh.Fye(yd.K(yd.count-1),ad,void 0,void 0,!1);var be=new ma.a;be.addRange(yd);isNull(Q)?(be=this.Jk.create(be,this._context),this.mV(be)):this.mV(new Ry(this.iQm(be,
this.YLc)));this.HOh&&this.xIe(d,yd,oc,sd,wd);B&&B.hCa(d);pc.a.lR("FileApiOperations.SetOoxml",pc.a.WR(this.W6),n.length)},yd=>{this._context.vo.ex();F.ULS.sendTraceTag(17585566,369,10,"AppId:{0}, {1}",this._context.appId,lD.a[yd]);this.gsa(lD.a[yd]);B&&B.hCa(d);pc.a.lR("FileApiOperations.SetOoxml",pc.a.WR(this.W6),n.length,!1)})}xDm(d){return OfficeExtension.WacRuntime.Utility.createPromise(n=>{const B=(new nt.a).create();B.message="Waiting...";B.nM(CommonUIStrings.l_DefaultDialogTitle,()=>{n(new ma.a)},
null);var Q=pc.a.Pgn();const ha=pc.a.Qgn();let Aa=0;Q=new tb.a(2,2,1E3*Q,bb=>{const Ib=this.sFi(d,Aa);if(Ib.count)return this.jj.Kf(bb),B.close(),n(Ib);Aa++;if(Aa>ha)return this.jj.Kf(bb),B.close(),n(new ma.a)});this.jj.pc(Q)})}sFi(d,n=0){var B=new ma.a;d&&(B=this.qb.ox(this.NIh,!0,!0),B=this.XIa.ymc(d,B),B.count||(B=this.Xz.dEi(),B=this.XIa.ymc(d,B)));B.count||F.ULS.sendTraceTag(18354846,369,10,"AppId:{0}, Can't find the inserted content when setting ooxml, retryTime:{1}",this._context.appId,n);
return B}KPo(d,n,B){this.XIa.Qyg(d,6,Q=>{Q?n(Q):B("retrieved styles string is empty or null")},Q=>{B(lD.a[Q])})}iQm(d,n){const B=new ma.a;let Q=0;switch(n){case 2:var ha=d.K(d.count-1);for(var Aa of Wz.create(ha.node,!0))B.add(this.xAa.create(Aa,this._context,Q++));break;case 4:case 3:Aa=d.K(0);for(ha of Wz.create(Aa.node))B.add(this.xAa.create(ha,this._context,Q++))}return B}Ctm(d,n){n=null;var B=d.node;let Q=4;if(!B.ra)return{returnValue:0,yy:0};B=B.ra.Vh(d.cpBegin);d=d.rp();if(B&&B.Qb&&0<B.Qb.length){B=
B.Qb;const ha=B.length;!d&&B.K(0).ld&&B.K(0).qr?(n=B.K(0).je,Q=0):d||B.K(0).ld||!B.K(0).qr?d<=ha&&0<d&&B.K(d-1).ld&&B.K(d-1).qr?(n=B.K(d-1).je,Q=2):d<ha&&0<d&&B.K(d-1).ld&&!B.K(d-1).qr&&B.K(d).ld?(n=B.K(d).je,Q=0):d<=ha&&0<d&&!B.K(d-1).ld&&(n=B.K(d-1).je,Q=1):(n=B.K(0).je,Q=3)}n=n?n.ka(Dd.a.yy,0):0;return{returnValue:Q,yy:n}}Dtm(d){let n=null;var B=null;({yN:n}=this.nd.bP(d.K(0),d.K(d.count-1),2));({yN:B}=this.nd.bP(d.K(0),d.K(d.count-1),3));d=this.WAi(n,!0);B=this.WAi(B,!1);return d===B?d:0}WAi(d,
n){let B=null;var Q=d.node;if(!Q.ra)return 0;Q=Q.ra.Vh(d.cpBegin);d=d.rp();if(Q&&Q.Qb&&0<Q.Qb.length){Q=Q.Qb;const ha=Q.length;n&&0<d&&Q.K(d-1).ld&&Q.K(d-1).qr?B=Q.K(d-1).je:!n&&d<ha&&!Q.K(d).ld&&Q.K(d).qr&&(B=Q.K(d).je)}return B?B.ka(Dd.a.yy,0):0}xIe(d,n,B,Q=-1,ha=-1){if(!(0>=n.count||1===n.count&&n.K(0).contextId===ed.a.kd)){var Aa=d.K(0),bb=d.K(d.count-1),Ib=n.K(0),oc=n.K(n.count-1);switch(B){case 0:oc.contextId===ed.a.Nd&&(d.W(0,ge.a.create(oc.node)),d.K(0).nc=Aa.vp(),this.nd.Cx(d.K(0),0),n.removeAt(n.count-
1));d.PC(0,n);break;case 1:case 2:oc.contextId===ed.a.od&&d.removeAt(0);d.PC(0,n);break;case 3:(B=Aa.cpEnd-Aa.cpBegin)?(oc.contextId===ed.a.Nd?(d.W(0,ge.a.createTextRange(oc.node,oc.cpBegin,oc.cpEnd+B)),n.removeAt(n.count-1)):d.W(0,ge.a.createTextRange(Aa.node,0,B)),d.K(0).nc=Aa.vp(),this.nd.Cx(d.K(0),0)):d.removeAt(0);d.PC(0,n);break;case 5:case 6:oc.contextId===ed.a.Nd?(d.W(0,ge.a.Pm(oc.node)),d.K(0).Ob=d.K(0).nc=this.qb.xz(oc.node)):d.W(0,n.K(n.count-1));break;case 7:B=Aa.cpEnd-Aa.cpBegin;oc.contextId===
ed.a.Nd?Aa.contextId===ed.a.Nd?(d.W(0,ge.a.createTextRange(Aa.node,oc.cpEnd,oc.cpEnd+B)),this.nd.TGa(d.K(0)),d.K(0).nc=Aa.vp()):(d.W(0,ge.a.jd(Aa.node,oc.cpEnd)),this.nd.TGa(d.K(0)),d.K(0).nc=d.K(0).Ob+Aa.vp()-Aa.rp()):(Aa.contextId===ed.a.Nd?d.W(0,ge.a.createTextRange(Aa.node,0,B)):d.W(0,ge.a.jd(Aa.node,0)),this.nd.qRa(d.K(0),Aa));break;case 4:oc.contextId===ed.a.Nd&&(d.W(0,ge.a.createTextRange(oc.node,oc.cpEnd,oc.node.characterData.length)),d.K(0).nc=Aa.vp(),this.nd.TGa(d.K(0)),d.insert(1,ge.a.Pm(oc.node)));
break;case 9:bb.contextId===ed.a.paragraph?(d.W(d.count-1,ge.a.create(Ib.node)),d.K(d.count-1).Ob=Q,d.K(d.count-1).nc=ha,n.removeAt(0)):d.removeAt(d.count-1);d.addRange(n);break;case 10:Aa.contextId===ed.a.kd?d.clear():n.K(0).contextId!==ed.a.od?(d.W(d.count-1,ge.a.createTextRange(n.K(0).node,bb.cpBegin,n.K(0).cpEnd)),n.removeAt(0),d.K(d.count-1).Ob=bb.rp(),this.nd.Cx(d.K(d.count-1),1)):(d.W(d.count-1,ge.a.createTextRange(n.K(0).node,bb.cpBegin,bb.cpEnd)),d.K(d.count-1).Ob=bb.rp());d.addRange(n);
break;case 12:B=bb.cpEnd-bb.cpBegin;d.W(d.count-1,B?ge.a.createTextRange(Ib.node,bb.cpBegin,bb.cpEnd):ge.a.jd(Ib.node,bb.cpBegin));d.K(d.count-1).Ob=bb.rp();d.K(d.count-1).nc=bb.vp();break;case 13:d.clear(),d.addRange(n)}}}tPf(d){const n=new vc.a;n.set(d);d=null;n.Ib(10)&&(d=n.Gq(10));return d}}Gx.EGh="<(?:p|li)(?:\\s|>|/)";Gx.FGh="<table(?:\\s|>|/)";Object(D.a)(Gx,"FileApiOperations",null,[1157]);var jF=e(739),nK=e(406);class Vu{constructor(){this.SHg=this.formatting=null}}Object(D.a)(Vu,"TextFormattingActionData",
null,[]);var mD=e(810),oK=e(1355),Xz;(function(d){d[d.ogq=-1]="mixed";d[d.none=0]="none";d[d.hidden=5]="hidden";d[d.a6p=8]="dotLine";d[d.z2a=1]="single";d[d.word=2]="word";d[d.double=3]="double";d[d.Oxq=6]="thick";d[d.Zmi=4]="dotted";d[d.b6p=20]="dottedHeavy";d[d.x4p=7]="dashLine";d[d.y4p=23]="dashLineHeavy";d[d.z4p=39]="dashLineLong";d[d.A4p=55]="dashLineLongHeavy";d[d.Z5p=9]="dotDashLine";d[d.$5p=25]="dotDashLineHeavy";d[d.xyq=10]="twoDotDashLine";d[d.yyq=26]="twoDotDashLineHeavy";d[d.gAq=11]="wave";
d[d.iAq=27]="waveHeavy";d[d.hAq=43]="waveDouble"})(Xz||(Xz={}));Object(D.b)("UnderlineType",Xz);class Yz extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd){super();this.B9b=this.Ud=null;this.BEb=d;this.rKb=n;this.Gxk=B;this.jz=Q;this._context=ha;this.jh=Aa;this.Gr=bb;this.Vk=Ib;this.qb=oc;this.ga=Ac;this.Lqa=ad;this.eFd=null;this.sra=sd;this.jz&&this._context.jsc&&(this.B9b=this.jz.Bpc.create(this.jz.kq))}get bold(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.bold))return d.getValue(xd.a.bold)}else return d=
this.v1(),d.SWc?null:1===d.bold}set bold(d){pc.a.Pz(d,"Font.Bold");if(null!==this.jh){const n=new Map;n.set(xd.a.bold,d);this.Du(n)}else this.Nzc(Se.a.bold,d)}get color(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.fontColor))return d=d.getValue(xd.a.fontColor),16777215<d?"#000000":Vf.a.zB(d).toUpperCase()}else return d=this.v1(),d.NRb?"":16777215<d.fontColor?"#000000":Vf.a.zB(d.fontColor).toUpperCase()}set color(d){d=pc.a.yya(d,"Font.Color",this._context);if(null!==this.jh){const n=
new Map;n.set(xd.a.fontColor,Number("0x"+d));this.Du(n)}else this.VCg(Se.a.Uy,d)}get doubleStrikeThrough(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(Ya.a.Ew))return d.getValue(Ya.a.Ew)}else return d=this.v1(),d.B1c?null:1===d.Ew}set doubleStrikeThrough(d){pc.a.Pz(d,"Font.DoubleStrikeThrough");if(null!==this.jh){const n=new Map;n.set(Ya.a.Ew,d);this.Du(n)}else this.Nzc(Se.a.Ew,d)}get hidden(){}set hidden(d){}get highlightColor(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.highlight))return d=
d.getValue(xd.a.highlight),16777215<d?null:Vf.a.zB(d).toUpperCase()}else return d=this.v1(),d.n9c?"":16777215<d.highlight?null:Vf.a.zB(d.highlight).toUpperCase()}set highlightColor(d){if(d&&""!==d)if(d=pc.a.yya(d,"Font.HighlightColor",this._context),null!==this.jh){const n=new Map;n.set(xd.a.highlight,Number("0x"+d));this.Du(n)}else this.VCg(Se.a.O2,d);else null!==this.jh?this.Nq(this.jh).fg(xd.a.highlight):this.VCg(Se.a.GBa,"")}get italic(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.italic))return d.getValue(xd.a.italic)}else return d=
this.v1(),d.ksc?null:1===d.italic}set italic(d){pc.a.Pz(d,"Font.Italic");if(null!==this.jh){const n=new Map;n.set(xd.a.italic,d);this.Du(n)}else this.Nzc(Se.a.cC,d)}get name(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.font))return d.getValue(xd.a.font)}else return d=this.v1(),d.a4c?"":d.fontName}set name(d){pc.a.iEc(d,"Font.Name");if(null!==this.jh){const n=new Map;n.set(xd.a.font,d);this.Du(n)}else this.mGa(Se.a.font,new jF.a(d))}get size(){if(null!==this.jh){var d=this.Nq(this.jh);
if(d.hasProperty(xd.a.fontSize))return d.getValue(xd.a.fontSize)/2}else return d=this.v1(),d.b4c?null:d.fontSize/2}set size(d){if(d>Yz.$Rn||d<Yz.KUn)F.ULS.sendTraceTag(36312091,369,50,"Invalid font size: {0}.",d),pc.a.Cd();if(null!==this.jh){const n=new Map;n.set(xd.a.fontSize,Math.round(2*d));this.Du(n)}else this.mGa(Se.a.tE,new jF.a(Math.round(2*d)))}get strikeThrough(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.strikethrough))return d.getValue(xd.a.strikethrough)}else return d=
this.v1(),d.xBc?null:1===d.strikethrough}set strikeThrough(d){pc.a.Pz(d,"Font.StrikeThrough");if(null!==this.jh){const n=new Map;n.set(xd.a.strikethrough,d);this.Du(n)}else this.Nzc(Se.a.strikethrough,d)}get subscript(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.subscript))return d.getValue(xd.a.subscript)}else return d=this.v1(),d.Ztd?null:1===d.subscript}set subscript(d){pc.a.Pz(d,"Font.Subscript");if(null!==this.jh){const n=new Map;n.set(xd.a.subscript,d);this.Du(n)}else this.Nzc(Se.a.subscript,
d)}get superscript(){if(null!==this.jh){var d=this.Nq(this.jh);if(d.hasProperty(xd.a.superscript))return d.getValue(xd.a.superscript)}else return d=this.v1(),d.$td?null:1===d.superscript}set superscript(d){pc.a.Pz(d,"Font.SuperScript");if(null!==this.jh){const n=new Map;n.set(xd.a.superscript,d);this.Du(n)}else this.Nzc(Se.a.superscript,d)}get underline(){const d=[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0];if(null!==this.jh){var n=this.Nq(this.jh);if(n.hasProperty(xd.a.underlineType)){n=n.getValue(xd.a.underlineType);
const B=this.LOi();return d[B.K(Xz[n])]}}else return n=this.v1(),n.oX?-1:d[n.underlineType]}set underline(d){var n=this.LOi();n.Bb(Xz[d])||pc.a.Cd();null!==this.jh?0===d?(d=this.Nq(this.jh),d.fg(xd.a.underline),d.fg(xd.a.underlineType)):(n=new Map,n.set(xd.a.underlineType,d),n.set(xd.a.underline,!0),this.Du(n)):this.mGa(Se.a.Lpa,n.K(Xz[d]))}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){if(null===this.jh)switch(this.BEb){case 0:case 5:case 6:this.Ud=this.qb.LC(this.rKb,
!0,!1);break;case 3:this.Ud=new ma.a;this.Ud.add(ge.a.create(this.rKb));break;case 1:this.Ud=this.Gxk.sH();break;case 4:G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.Ud=this.jz.qvb?this.jz.qvb.kq:this.B9b?this.B9b.kq:this.jz.kq:this.Ud=this.jz.kq;break;default:F.ULS.sendTraceTag(21824032,369,15,"AppId:{0}, invalid object type to set font on.",this._context.appId)}}getTypeName(){return"Microsoft.WordServices.Font"}invokePropertyGet(d){switch(d){case 4:return this.bold;
case 6:return this.color;case 11:return this.doubleStrikeThrough;case 13:return this.hidden;case 12:return this.highlightColor;case 5:return this.italic;case 2:return this.name;case 3:return this.size;case 10:return this.strikeThrough;case 8:return this.subscript;case 9:return this.superscript;case 7:return this.underline;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
n){switch(d){case 4:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 6:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 11:this.doubleStrikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 13:this.hidden=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 12:this.highlightColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 5:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 2:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.size=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number?");return;case 10:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 8:this.subscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean?");return;case 9:this.superscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean?");return;case 7:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}LOi(){const d=new ff.a;d.add("single",0);d.add("word",1);d.add("double",2);d.add("thick",3);d.add("dotted",4);d.add("dottedHeavy",5);d.add("dashLine",6);d.add("dashLineHeavy",7);d.add("dashLineLong",8);d.add("dashLineLongHeavy",9);d.add("dotDashLine",10);d.add("dotDashLineHeavy",11);d.add("twoDotDashLine",12);
d.add("twoDotDashLineHeavy",13);d.add("wave",14);d.add("waveHeavy",15);d.add("waveDouble",16);d.add("none",17);return d}Nzc(d,n){n=n?new Py.a(1):new Py.a(0);pc.a.QFj()?this.sra.mGa(this.Ud,d,n):this.mGa(d,n)}VCg(d,n){this.mGa(d,n)}mGa(d,n){if(this.Lqa.cYc(this.Ud,0)){var B=new nK.a;for(let Q=0;Q<this.Ud.count;Q++)this.Ud.K(Q).contextId!==ed.a.kd&&B.addContext(this.Ud.K(Q));this.ga.xqg(B,d,2,!0,new ut.a,n)}}v1(){this._OnAccess();if(!this.eFd)if(pc.a.QFj()){var d=this.sra.v1(this.Ud);d&&(this.eFd=d)}else{d=
[new Ph.Selection(this.Ud.toArray(),!0)];d=new ic.SelectionCollection(d,0);const n=new Vu;n.formatting=new mD.a;n.SHg=d;32===this.ga.Sf(new Zh.a(null),Se.a.Uld,2,!0,new ut.a,n)&&(this.eFd=n.formatting)}return this.eFd}Lnd(){G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.B9b&&(this.B9b.Jzb(),this.B9b=null)}Du(d){const n=new ig.ScriptSharpLegacyMap;for(const B of d)n.W(B[0],B[1]);this.Gr.IEa(this.jh,n,qj.a.Pp())}Nq(d){let n;qj.a.Zf.zl?(n=this.Vk.Sua(),d=n.Nca(d)):(n=this.Vk.Il(),
d=n.Qg(d));return d}}Yz.$Rn=oK.a.pij/2;Yz.KUn=1;Object(D.a)(Yz,"Font",rh.a,[866]);class Zz{constructor(d,n,B,Q,ha,Aa){this.qb=d;this.ga=n;this.Lqa=B;this.sra=Q;this.Gr=ha;this.Vk=Aa}create(d,n,B,Q,ha,Aa=null){return new Yz(d,n,B,Q,ha,Aa,this.Gr,this.Vk,this.qb,this.ga,this.Lqa,this.sra)}}Object(D.a)(Zz,"FontFactory",null,[]);class pK{constructor(d,n){this.ga=d;this.Lqa=n}v1(d){d=[new Ph.Selection(d.toArray(),!0)];d=new ic.SelectionCollection(d,0);const n=new Vu;n.formatting=new mD.a;n.SHg=d;return 32===
this.ga.Sf(new Zh.a(null),Se.a.Uld,2,!0,new ut.a,n)?n.formatting:null}mGa(d,n,B){if(this.Lqa.cYc(d,0)){var Q=new nK.a;for(let ha=0;ha<d.count;ha++)d.K(ha).contextId!==ed.a.kd&&Q.addContext(d.K(ha));this.ga.xqg(Q,n,2,!0,new ut.a,B)}}}Object(D.a)(pK,"FontOperaions",null,[1156]);class $z{constructor(d,n){this.Yy=d;this.uef=n;this.VNh=[]}ex(d=null,n=15){d||(d=this.Yy.value);n=this.uef.Vc(n);n.Eb(d);this.VNh.push(n)}qH(){this.VNh.pop().dispose()}dhc(d){this.qH();this.ex(d,4)}}Object(D.a)($z,"GraphTransactionWrapper",
null,[1155]);var kF=e(1882);class lF{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc){this.E_=d;this.ir=n;this.qb=B;this.Bw=Q;this.nI=ha;this.$Ak=Aa;this.$f=bb;this.za=Ib;this.St=oc}UNf(d,n){pc.a.ARa(n,"GraphNode");const B=this.E_.V4c(n,5);this.nFi(B,n,d)}o$d(d,n){pc.a.Pz(n,"GraphNodeContext");const B=this.E_.Zyi(n);this.nFi(B,n.node,d)}nFi(d,n,B){for(const Q of d){d=!1;const ha=Wa.a.instance.Wa("Box4.IFeatureHelper");if(this.ir.Upc(Q)||this.ir.Spc(Q)||this.ir.Tpc(Q)||this.ir.Vpc(Q)||ha&&ha.isFeatureEnabled(43)&&
this.ir.Wpc(Q))d=!0;d&&(d=Q.Rb.cp,B.add(ge.a.createTextRange(n,d,d+1)))}}WUb(d,n,B,Q){pc.a.iEc(d,"imgBase64Str");d=d.trim();return OfficeExtension.WacRuntime.Utility.createPromise((ha,Aa)=>{var bb=n.node,Ib=new vc.a;Ib.set(bb);const oc=this.$Ak.create(Ib,ha,Aa),Ac=document.createElement("img");ha=()=>{const ad=new kF.a(Ac.src,Ac.alt,Ac.width,Ac.height);this.UEf(oc,ad,n,B)};bb=()=>{Aa("")};G.AFrameworkApplication.$v&&Q?(Q.useSourceImageProps&&(Q.height=0,Q.width=0),this.UEf(oc,this.LCm(d,Q),n,B)):
(Ib=!1,(Ib=void 0!==Ac.onload&&void 0!==Ac.onerror)?(Ac.onload=ha,Ac.onerror=bb,Ac.src=String.format("data:image/png;base64,{0}",d)):this.UEf(oc,this.KCm(d),n,B))})}KCm(d){const n=document.createElement("img");n.src=String.format("data:image/{0};base64,{1}","png",d);return new kF.a(n.src,n.alt,n.width,n.height)}LCm(d,n){return new kF.a(d,n.altText?n.altText:"",n.width,n.height)}sti(d,n){if(n&&5===n.xi){n=n.id;d=this.E_.V4c(d,5);for(const B of d)if(B.id.equals(n))return B.Rb.cp}return-1}Odm(d,n){let B=
this.sti(d,n);return 0>B&&({node:d,returnValue:B}=this.Pdm(n),0>B)?{returnValue:-1,MRh:d}:{returnValue:B,MRh:d}}Pdm(d){var n=this.dEi();for(const B of n)if(n=this.sti(B,d),-1!==n)return d=B,{returnValue:n,node:d};return{returnValue:-1,node:null}}t3c(d){const n=(new Date).getTime();let B=null;d=({MRh:B}=this.Odm(d.node,d.blob)).returnValue;pc.a.lR("ImageApiOperations.FindImageContextFromResult",pc.a.WR(n));return 0>d?(F.ULS.sendTraceTag(17433739,369,10,"the inserted inline picture can't be found"),
pc.a.vg(),null):ge.a.createTextRange(B,d,d+1)}getBase64ImageSrc(d,n,B,Q,ha,Aa){const bb=this.ir.R$(d.properties,oh.a.Iw,null);bb?this.ir.l5(bb)?(this.RKi(d,bb,Q),B.vo.ex(n.node)):(F.ULS.sendTraceTag(23594887,369,15,"AppId:{0}, Not valid ImageDataUrl.",B.appId),pc.a.vg()):this.CCm(n,d,B,Q,ha,Aa)}CCm(d,n,B,Q,ha,Aa){const bb=n.properties,Ib=this.ir.xMa(bb,d.node.hk().Hd,this.za,this.St);this.ir.BWb(Ib)?this.ir.Oab(this.$f,Ib,oc=>{let Ac=!0;const ad=oc.data.responseData;2===oc.data.status&&this.ir.l5(ad)?
(this.RKi(n,ad,Q),bb.setValue(oh.a.Iw,ad)):(ha(""),Ac=!1);B.vo.ex(d.node);pc.a.lR("ImageApiOperations.GetImageSrcFromServer",pc.a.WR(Aa),void 0,Ac)},()=>{ha("");B.vo.ex(d.node);pc.a.lR("ImageApiOperations.GetImageSrcFromServer",pc.a.WR(Aa),void 0,!1)}):(F.ULS.sendTraceTag(23594888,369,15,"AppId:{0}, ImageDataUrl null, but not supported data url request.",B.appId),pc.a.vg())}RKi(d,n,B){let Q=null;const ha=document.createElement("img");ha.src=n;ha.onload=()=>{var Aa=new Dq.a;const bb=Aa.Rf(this.ir.uH(d.properties),
0);Aa=Aa.Rf(this.ir.pN(d.properties),1);const Ib=document.createElement("canvas");Ib.width=bb;Ib.height=Aa;Ib.getContext("2d").drawImage(ha,0,0,bb,Aa);Q=Ib.toDataURL();B(Q.substr(Q.indexOf(";base64,")+8))}}dEi(){const d=new vc.a;d.set(this.Bw.value);this.nI.bU(d);return this.qb.ox(this.nI.xPf(d.currentNode),!0,!0)}UEf(d,n,B,Q){d.i6n(n,B);Q.vo.qH();d.bkg()}}Object(D.a)(lF,"ImageApiOperations",null,[1154]);class fj extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye){super();pc.a.Pz(d,
"GraphNodeContext");this.vs=d;this._context=n;this._id=B;this.Ip=Q;this.Jk=ha;this.lQ=Aa;this.ir=bb;this.ll=Ib;this.ufa=this.e$d(this.vs);this.Xz=oc;this.uh=Ac;this.Wr=ad;this.nd=sd;this.fz=wd;this.Am=yd;this.qb=be;this.yd=ye}get altTextDescription(){return this.ir.nYa(this.ufa.properties)}set altTextDescription(d){this.ll.d2b(this.ufa.properties,d)}get altTextTitle(){return this.ir.z1(this.ufa.properties)}set altTextTitle(d){this.ll.d2a(this.ufa.properties,d)}get height(){const d=this.ir.pN(this.ufa.properties);
return Mi.a.Ydb(d)}set height(d){pc.a.D3a(d,"InlinePicture.Height");d=Mi.a.Rwa(d);this.lockAspectRatio&&this.ll.kQa(this.ufa.properties,this.width/this.height*d);this.ll.jQa(this.ufa.properties,d)}get hyperlink(){return this.ir.wmc(this.ufa.properties)}set hyperlink(d){this.ll.N1o(this.ufa.properties,d)}get imageFormat(){return 0}get lockAspectRatio(){return this.ir.Jcb(this.ufa.properties)}set lockAspectRatio(d){this.ll.bUj(this.ufa.properties,d)}get paragraph(){return this.Ip.create(this.vs.node,
this._context)}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||pc.a.tl();return d}get parentContentControlOrNullObject(){this.Vhb();return this.uh.xnc(this.vs,this.vs,this._context)}get parentTable(){if(!pc.a.yj())return null;const d=this.parentTableOrNullObject;d||pc.a.tl();return d}get parentTableCell(){if(!pc.a.yj())return null;const d=this.parentTableCellOrNullObject;d||pc.a.tl();return d}get parentTableCellOrNullObject(){return pc.a.yj()?this.yd.$mc(this.vs.node,this._context):
null}get parentTableOrNullObject(){return pc.a.yj()?this.yd.Mtb(this.vs.node,this._context):null}get width(){const d=this.ir.uH(this.ufa.properties);return Mi.a.Ydb(d)}set width(d){pc.a.D3a(d,"InlinePicture.Width");d=Mi.a.Rwa(d);this.lockAspectRatio&&this.ll.jQa(this.ufa.properties,this.height/this.width*d);this.ll.kQa(this.ufa.properties,d)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}deleteInlinePicture(){this.Vhb();const d=this.vs.node;for(let n=0;n<d.ra.length;n++)if(d.ra.jc(n).cp===
this.vs.cpBegin){this.nd.SWl(this.vs);break}}getBase64ImageSrc(){const d=(new Date).getTime();this._context.vo.qH();return OfficeExtension.WacRuntime.Utility.createPromise((n,B)=>{this.Xz.getBase64ImageSrc(this.ufa,this.vs,this._context,n,B,d)})}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){pc.a.yj()||pc.a.Yj();const d=this.$Hm();return d?this.lQ.create(d,this._context):null}getRange(d){pc.a.yj()||pc.a.Yj();1!==d&&2!==d&&d&&(F.ULS.sendTraceTag(18745293,369,
15,"AppId:{0}, rangeLocation of InlinePicture.GetRange must be Start/End/Whole.",this._context.appId),pc.a.Cd());const n=new ma.a;n.add(this.vs);this.Vhb();return this.Jk.create(this.Am.mSb(n,d),this._context)}insertBreak(d,n){n&&1!==n&&(F.ULS.sendTraceTag(17339015,369,15,"AppId:{0}, insertLocation of InlinePicture.InsertBreak must be Before or After.",this._context.appId),pc.a.Cd());const B=(new Date).getTime(),Q=new ma.a;Q.add(this.vs);this.Vhb();return OfficeExtension.WacRuntime.Utility.createPromise((ha,
Aa)=>{this.nd.insertBreak(Q,d,n,this._context,ha,Aa,B)})}insertContentControl(){this.Vhb();const d=new ma.a;d.add(this.vs);this.uh.lkf(d);1!==d.count&&(F.ULS.sendTraceTag(37777540,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),pc.a.vg());return d.K(0)!==this.vs?this.uh.Msa(d.K(0),d.K(0),this._context):this.uh.k8a(this.vs,this._context)}insertFileFromBase64(d,n){"<"===d.charAt(0)&&(F.ULS.sendTraceTag(18130837,369,10,"invalid argument for insertFileFromeBase64 API in InlinePicture class.",
this._context.appId),pc.a.Cd());return this.Wna(d,n,!1)}insertHtml(d,n){const B=(new Date).getTime();if(!n||1===n){const Q=new ma.a;Q.add(this.vs);return this.fz.insertHtml(Q,d,n,B,this._context)}pc.a.Cd();return null}insertInlinePictureFromBase64(d,n){if(2===n||3===n)return F.ULS.sendTraceTag(17319648,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this._context.appId),pc.a.Cd(),null;const B=(new Date).getTime();let Q=null;this.Vhb();if(4===n){let ha;
this.nd.DY((ha=new ma.a,ha.add(this.vs),ha),n,0);Q=ge.a.jd(this.vs.node,this.vs.cpBegin);Q.Ob=Q.nc=this.vs.rp();this.deleteInlinePicture()}else{({yN:Q}=this.nd.bP(this.vs,this.vs,n));let ha;this.nd.DY((ha=new ma.a,ha.add(Q),ha),n,0)}return this.Xz.WUb(d,Q,this._context).then(ha=>{this._context.vo.ex(this.vs.node);if(!ha)return F.ULS.sendTraceTag(17433740,369,10,"AppId:{0}, something went wrong when insert iamge into InlinePicture.",this._context.appId),pc.a.lR("InlinePicture.InsertInlinePictureFromBase64",
pc.a.WR(B),d.length,!1),pc.a.vg(),null;pc.a.lR("InlinePicture.InsertInlinePictureFromBase64",pc.a.WR(B),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.lQ.create(this.Xz.t3c(ha),this._context))})}insertOoxml(d,n){"<"!==d.charAt(0)&&(F.ULS.sendTraceTag(18130838,369,10,"invalid argument for InsertOoxml API in InlinePicture class.",this._context.appId),pc.a.Cd());return this.Wna(d,n,!0)}insertParagraph(d,n){n&&1!==n&&(F.ULS.sendTraceTag(21070049,369,15,"AppId:{0}, Invalid insert location for InlinePicture.InsertPparagraph method.",
this._context.appId),pc.a.Cd());this.Vhb();let B;return this.Ip.create(this.nd.insertParagraph((B=new ma.a,B.add(this.vs),B),d,n),this._context)}insertText(d,n){n&&1!==n&&(F.ULS.sendTraceTag(17339328,369,15,"AppId:{0}, invalid location for InlinePicture.InsertText:{1}.",this._context.appId,yo.a[n]),pc.a.Cd());this.Vhb();let B;return this.Jk.create(this.nd.insertText((B=new ma.a,B.add(this.vs),B),d,n),this._context)}select(d){const n=new ma.a;n.add(this.vs);this.Wr.select(n,d)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.vs.node,
"InlinePicture")}getTypeName(){return"Microsoft.WordServices.InlinePicture"}invokePropertyGet(d){switch(d){case 3:return this.altTextDescription;case 4:return this.altTextTitle;case 5:return this.height;case 6:return this.hyperlink;case 11:return this.imageFormat;case 7:return this.lockAspectRatio;case 10:return this.paragraph;case 9:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 14:return this.parentTable;case 13:return this.parentTableCell;case 16:return this.parentTableCellOrNullObject;
case 17:return this.parentTableOrNullObject;case 8:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 3:this.altTextDescription=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 4:this.altTextTitle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return;case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 6:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.lockAspectRatio=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 8:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1012:return this.bF(n);case 1015:return this.b9();case 1016:return this.c9();case 1014:return this.rha(n);case 1004:return this.tNa(n);case 1010:return this.lva(n);case 1007:return this.vNa(n);case 1013:return this.lja(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
n){switch(d){case 1003:return this.apm();case 1006:return this.Ybb(n);case 1011:return this.jva(n);case 1008:return this.acb(n);case 1005:return this.bcb(n);case 1009:return this.fcb(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteInlinePicture();return null}apm(){return this.getBase64ImageSrc()}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");
return this.getRange(d)}Ybb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(n,d)}tNa(){return this.insertContentControl()}jva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(n,d)}acb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(n,d)}bcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(n,d)}fcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(n,d)}lva(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}vNa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();
return null}e$d(d){return this.ir.HMa(d)}$Hm(){if(!this.vs)return null;const d=new ma.a;if(this.vs.cpEnd!==this.vs.node.characterData.length){var n=ge.a.createTextRange(this.vs.node,this.vs.cpEnd,this.vs.node.characterData.length);this.Xz.o$d(d,n);if(d.count)return d.K(0)}for(n=this.qb.Cg(this.vs.node,!1,!0);n;){this.Xz.UNf(d,n);if(d.count)return d.K(0);n=this.qb.Cg(n,!1,!0)}return null}Wna(d,n,B){const Q=(new Date).getTime();if(!n||1===n){this.Vhb();const ha=new ma.a;ha.add(this.vs);return OfficeExtension.WacRuntime.Utility.createPromise((Aa,
bb)=>{this.fz.insertOoxml(ha,d,n,this.vs.node,this._context,Aa,bb,Q,B?0:1)})}F.ULS.sendTraceTag(18130839,369,15,"AppId:{0}, InlinePicture.InsertOoxmlOrDocx: undefined location!",this._context.appId);pc.a.Cd();return null}Vhb(){const d=this.qb.nn(this.vs.node,this.vs.cpBegin),n=this.qb.nn(this.vs.node,this.vs.cpEnd);this.vs.Ob=0<d?d:-1;this.vs.nc=0<n?0:-1}}Object(D.a)(fj,"InlinePicture",rh.a,[866]);class AB{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){this.Jk=this.Ip=null;this.ir=d;this.ll=n;this.Xz=B;this.uh=
Q;this.Wr=ha;this.nd=Aa;this.fz=bb;this.Am=Ib;this.qb=oc;this.yd=Ac}Vu(d,n){this.Ip=d;this.Jk=n}create(d,n,B=0){return new fj(d,n,B,this.Ip,this.Jk,this,this.ir,this.ll,this.Xz,this.uh,this.Wr,this.nd,this.fz,this.Am,this.qb,this.yd)}}Object(D.a)(AB,"InlinePictureFactory",null,[1011]);var qK=e(1929),nD=e(942);class pp{constructor(d,n,B,Q,ha,Aa){this.nCf=Aa;this.qjb=this.i4a=-1;this.AUe=this.Ibf=null;this.xUe=!1;this.kvh=!0;this.iGh=null;this.ee=n;this.oj=B;this.$4a=Q;this.Wr=ha;this.hCa(d)}get g1a(){return this.iGh||
(this.iGh=Jh.a.create())}get x3b(){const d=this.$4a.Mb(this.g1a);return d?this.Ibf=this.oj.value.Mb(d.J2a):null}set x3b(d){this.Ibf=d}get ZLa(){const d=this.$4a.Mb(this.g1a);return d?this.AUe=this.oj.value.Mb(d.ICa):null}set ZLa(d){this.AUe=d}get kq(){var d=this.wMi(!0).returnValue;const n=this.wMi(!1).returnValue;if(!d||!n)return null;const B=ge.a.jd(d.paragraph,d.cp),Q=ge.a.jd(n.paragraph,n.cp);if(!d.Qb||!d.Qb.length)this.i4a=-1;else if(d.Qb&&0<d.Qb.length&&-1===this.i4a||this.i4a>d.Qb.length)this.i4a=
d.Qb.length;if(!n.Qb||!n.Qb.length)this.qjb=-1;else if(n.Qb&&0<n.Qb.length&&-1===this.qjb||this.qjb>n.Qb.length)this.qjb=0;this.xUe&&this.P9k(n);B.Ob=this.i4a;Q.nc=this.qjb;d=this.Wr.TDi(B,Q,this.xUe);if(!d||!d.count)return null;1===d.count&&(d.K(0).contextId===ed.a.od||d.K(0).contextId===ed.a.kd&&(this.kvh||this.qjb<this.i4a))&&(d.K(0).Ob=d.K(0).nc=this.i4a);return d}P9k(d){if(!d.Ui){const n=this.I8(d.paragraph,d.paragraph.characterData.length);for(let B=0;B<d.$l.length;B++){const Q=d.$l.K(B);if(Q.Ap.equals(this.g1a)){n.$l||
n.epc();n.$l.add(Q.og(n));d.$l.remove(Q);d.$l.length||d.oYc();break}}}}hCa(d){if(G.AFrameworkApplication.J.$("WordEditorAgaveRangeEnhancementIsEnabled")&&d&&d.count){var n=d.K(0),B=d.K(d.count-1);this.$4a.s3k(this.g1a,n.node.id,B.node.id);if(1===d.count)this.n1m(d.K(0));else{switch(n.contextId){case ed.a.paragraph:d=this.I8(n.node,0);break;case ed.a.od:d=this.I8(n.node,n.node.characterData.length);break;case ed.a.Nd:d=this.I8(n.node,n.cpBegin);break;case ed.a.kd:d=this.I8(n.node,n.cpBegin);break;
default:return}var Q=!1;switch(B.contextId){case ed.a.paragraph:var ha=this.I8(B.node,B.node.characterData.length);Q=!0;break;case ed.a.Nd:ha=this.I8(B.node,B.cpEnd);break;case ed.a.od:ha=this.I8(B.node,B.node.characterData.length);Q=!0;break;case ed.a.kd:ha=this.I8(B.node,B.cpEnd);break;default:return}this.i4a=n.Ob;this.qjb=B.nc;d.$l.add(new nD.a(d,null,this.g1a,this.$4a,!0));ha.$l.add(new nD.a(ha,null,this.g1a,this.$4a,!1,Q))}}}n1m(d){let n=!1,B,Q;switch(d.contextId){case ed.a.kd:B=Q=this.I8(d.node,
d.cpBegin);this.kvh=d.Ob===d.nc;break;case ed.a.od:B=Q=this.I8(d.node,d.node.characterData.length);n=!0;break;case ed.a.Nd:B=this.I8(d.node,d.cpBegin);Q=this.I8(d.node,d.cpEnd);break;case ed.a.paragraph:B=this.I8(d.node,0);Q=this.I8(d.node,d.node.characterData.length);n=!0;break;default:return}this.i4a=d.Ob;this.qjb=d.nc;B.$l.add(new nD.a(B,null,this.g1a,this.$4a,!0));Q.$l.add(new nD.a(Q,null,this.g1a,this.$4a,!1,n))}Jzb(){const d=this.dLm();this.nCf.XEo(d,this.g1a)}dLm(){const d=this.x3b,n=this.ZLa;
if(d&&n&&d.id.equals(n.id))return[d];const B=[];d&&B.push(d);n&&B.push(n);return B}wMi(d){let n=null;const B=d?this.x3b:this.ZLa;if(!B||!B.ra||!B.ra.length)return{returnValue:null,xPa:n};for(let Q=0;Q<B.ra.length;Q++){const ha=B.ra.jc(Q);if(ha.$l)for(let Aa=0;Aa<ha.$l.length;Aa++)if(ha.$l.K(Aa).Ap.equals(this.g1a)&&ha.$l.K(Aa).ld===d)return d||(this.xUe=ha.$l.K(Aa).iei),1<=Q&&(n=B.ra.jc(Q-1).formatting),{returnValue:ha,xPa:n}}return{returnValue:null,xPa:n}}I8(d,n){this.ee.ahb(ge.a.jd(d,n));d=d.m1(n);
d.$l||d.epc();return d}}Object(D.a)(pp,"InternalRange",null,[]);class BB{constructor(d,n,B,Q,ha,Aa,bb){this.sZb=(Ib,oc)=>{this.CDd.jkf(oc)};this.ee=d;this.oj=B;this.$4a=Q;this.CDd=ha;this.Wr=Aa;bb.vjf(this.sZb)}create(d){return new pp(d,this.ee,this.oj,this.$4a,this.Wr,this.CDd)}}Object(D.a)(BB,"InternalRangeFactory",null,[]);class mF{constructor(d,n,B){this.rfh="";this.sEd=0;this.yM=d;this._id=n;this.Yz=B}get id(){return this._id}_RegisterStateChange(){this.sEd||(OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.Yz,
this._id,1),this.rfh=this.yM.dxa(this._id,d=>{OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(d.featureName,1,d)}));this.sEd++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.sEd--;this.sEd||this.yM.O0b(this._id,this.rfh);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(d){switch(d){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 6:return this.Irk();case 7:return this.Urk()}d=
this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Irk(){return this._RegisterStateChange()}Urk(){return this._UnregisterStateChange()}}Object(D.a)(mF,"LicenseFeature",null,[]);class Wu{get scopes(){return null}set scopes(d){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(d){switch(d){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(D.a)(Wu,"MsaDeviceTicketOptions",null,[]);class nF{constructor(d,n,B){this.yM=d;this.g3=n;this.Yz=B}getFeatureTier(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{this.yM.getFeatureTier(d,1===n?1:2===n?2:0).then(Q=>{B(this.QEm(Q))},()=>{B(n)})})}getLicenseFeature(d){d=new mF(this.yM,d,this.Yz);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}getMsaDeviceTicket(){pc.a.Yj();
return null}isFeatureEnabled(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{this.yM.isFeatureEnabled(d,n).then(Q=>{B(Q)},()=>{B(n)})})}isFreemiumUpsellEnabled(){const d=this.yM.isFreemiumUpsellEnabled();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}launchUpsellExperience(d){if(this.g3.nt.getOsfControl(this.Yz).isFirstParty())return this.yM.launchUpsellExperience(d),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null);throw OfficeExtension.WacRuntime.Utility.createRichApiException($s.a.uMb,
"Access Denied");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 7:return this.rHm(n);case 6:return this.Qrk(n)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 2:return this.Eym(n);case 5:return this.PEm(n);case 1:return this.wqn(n);case 3:return this.rrn();case 4:return this.JFn(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Eym(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.getFeatureTier(n,d)}PEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getLicenseFeature(d)}rHm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,Wu);return this.getMsaDeviceTicket(n,B,d)}wqn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.isFeatureEnabled(n,d)}rrn(){return this.isFreemiumUpsellEnabled()}JFn(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchUpsellExperience(d)}Qrk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this._TestFireStateChangedEvent(d);return null}QEm(d){switch(d){case 1:return 1;case 2:return 2;default:return 0}}}Object(D.a)(nF,"License",null,[]);
class xt{constructor(d,n){this.g3=d;this.Ltk=n}create(d){return new nF(this.Ltk,this.g3,d)}}Object(D.a)(xt,"LicenseFactory",null,[]);class wu extends rh.a{constructor(d,n,B,Q,ha,Aa,bb){super();pc.a.ARa(d,"List");this.v4a=d;this.a6a=n;this._context=B;this.So=Q;this.Ip=ha;this.nd=Aa;this.qb=bb;this.Efa=this.So.fDa(this.a6a,this.v4a)}get id(){return this.a6a}get levelExistences(){if(!this.Efa)return null;const d=Array(pc.a.Noa);for(var n=0;n<d.length;n++)d[n]=!1;for(n=0;n<this.Efa.count;n++){const B=
this.So.eW(this.Efa.K(n));-1!==B&&(d[B]=!0)}return d}get levelTypes(){return this.So.HFm(this.Efa.K(0))}get paragraphs(){const d=new ma.a;for(let n=0;n<this.Efa.count;n++)d.add(this.Ip.create(this.So.iDa(this.Efa.K(n)),this._context));return new Zr(d)}get _ReferenceId(){return this.kp?this.Jp:null}getLevelFont(){return null}getLevelParagraphs(d){(0>d||d>=pc.a.Noa)&&pc.a.Cd();const n=new ma.a;for(let B=0;B<this.Efa.count;B++)d===this.So.eW(this.Efa.K(B))&&n.add(this.Ip.create(this.So.iDa(this.Efa.K(B)),
this._context));return new Zr(n)}getLevelPicture(){return null}getLevelString(d){return this.So.getLevelString(this.a6a,this.v4a,d)}insertParagraph(d,n){var B=null;let Q=n,ha=null;2!==n&&n?3===n||1===n?(Q=1,B=this.So.iDa(this.Efa.K(this.Efa.count-1)),ha=this.nd.Q9a(B,!1)):pc.a.Cd():(Q=0,B=this.So.iDa(this.Efa.K(0)),ha=this.nd.Q9a(B,!0));var Aa=null,bb=!1;n&&1!==n||(bb=n?!1:!0,Aa=this.qb.Cg(B,bb,!0));let Ib;B=this.nd.insertParagraph((Ib=new ma.a,Ib.add(ha),Ib),d,Q);if(!B)return null;d=this.Ip.create(B,
this._context);n&&1!==n||(this.So.detachFromList(B),Aa&&(n=this.Ip.create(Aa,this._context),d.style=n.style,Aa=Aa.ra,bb&&0<Aa.length?(bb=Aa.jc(Aa.length-1).rta(null))&&!bb.formatting&&1<Aa.length&&(bb=Aa.jc(Aa.length-2).rta(null)):bb=Aa.first.rta(null),B=B.ra,B.jc(0).formatting=bb.formatting.og(B.jc(0)),d.leftIndent=n.leftIndent,d.firstLineIndent=n.firstLineIndent));return d}resetLevelFont(){}setLevelAlignment(d,n){this.So.setLevelAlignment(this.a6a,this.v4a,d,this.lFm(n))}setLevelBullet(d,n,B,Q){(0>
d||d>=pc.a.Noa)&&pc.a.Cd();0===n&&0>=B&&pc.a.Cd();this.So.setLevelBullet(this.v4a,this.a6a,d,n,B,Q)}setLevelIndents(d,n,B){this.So.F2o(this.a6a,this.v4a,d,n,B)}setLevelNumbering(d,n,B){(0>d||d>=pc.a.Noa)&&pc.a.Cd();-1!==n||B||pc.a.Cd();this.So.setLevelNumbering(this.v4a,this.Efa.K(0),this.a6a,d,n,B)}setLevelPicture(){}setLevelStartingNumber(d,n){this.So.setLevelStartingNumber(this.a6a,this.v4a,d,n)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.v4a,"List");this.Efa=this.So.fDa(this.a6a,this.v4a);
pc.a.Pz(this.Efa,"List")}getTypeName(){return"Microsoft.WordServices.List"}invokePropertyGet(d){switch(d){case 1:return this.id;case 5:return this.levelExistences;case 4:return this.levelTypes;case 3:return this.paragraphs;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1010:return this.JEm(n);case 1004:return this.LEm(n);case 1009:return this.MEm(n);case 1007:return this.OEm(n);case 1003:return this.lva(n);case 1011:return this.NNo(n);case 1012:return this.p2o(n);case 1005:return this.q2o(n);case 1013:return this.r2o(n);case 1006:return this.s2o(n);case 1008:return this.t2o(n);case 1014:return this.u2o(n);
case 1001:return this.Sg();case 1002:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelFont(d)}LEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelParagraphs(d)}MEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getLevelPicture(d)}OEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelString(d)}lva(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}NNo(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");this.resetLevelFont(n,
d);return null}p2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.setLevelAlignment(n,d);return null}q2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");
this.setLevelBullet(n,B,Q,d);return null}r2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"number");this.setLevelIndents(n,B,d);return null}s2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
2,"Array<any>");this.setLevelNumbering(n,B,d);return null}t2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.setLevelPicture(n,d);return null}u2o(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.setLevelStartingNumber(n,d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();
return null}lFm(d){let n="";switch(d){case 0:n="left";break;case 2:n="right";break;case 1:n="center";break;default:F.ULS.sendTraceTag(21067539,369,10,"AppId:{0}, in function List.SetLevelAlignment, the alignment parameter should be Left/Right/Centered.",this._context.appId),pc.a.Cd()}return n}}Object(D.a)(wu,"List",rh.a,[866]);class oF{constructor(d,n){this.Ip=this.So=null;this.nd=d;this.qb=n}Vu(d,n){this.So=d;this.Ip=n}create(d,n,B){return new wu(d,n,B,this.So,this.Ip,this.nd,this.qb)}}Object(D.a)(oF,
"ListFactory",null,[]);class rK extends rh.a{constructor(d,n,B,Q,ha){super();pc.a.ARa(d,"ListItem");this.dla=d;this._context=n;this.So=B;this.Ip=Q;this.ENc=ha}get level(){return this.So.eW(this.dla)}set level(d){(d>=pc.a.Noa||0>d)&&pc.a.Cd();this.So.eW(this.dla)!==d&&this.So.qDg(this.dla,d)}get listString(){const d=this.So.$Sb(this.dla);return this.ENc.A_a(d).tW}get siblingIndex(){const d=this.So.eW(this.dla),n=this.RLf();let B=0;for(let Q=0;Q<n.count;Q++)if(this.So.eW(n.K(Q))===d){if(this.dla.id.equals(n.K(Q).id))return B;
B++}return-1}get _ReferenceId(){return this.kp?this.Jp:null}getAncestor(d){(d=this.getAncestorOrNullObject(d))||pc.a.tl();return d}getAncestorOrNullObject(d){const n=this.So.eW(this.dla),B=this.RLf();var Q=0;for(var ha=0;ha<B.count;ha++)this.dla.id.equals(B.K(ha).id)&&(Q=ha);for(--Q;0<=Q;Q--)if(ha=this.So.eW(B.K(Q)),ha<n&&(d&&ha===n-1||!d))return this.Ip.create(this.So.iDa(B.K(Q)),this._context);return null}getDescendants(d){const n=this.So.eW(this.dla),B=this.RLf();var Q=0;for(var ha=0;ha<B.count;ha++)this.dla.id.equals(B.K(ha).id)&&
(Q=ha);ha=new ma.a;for(Q+=1;Q<B.count;Q++){const Aa=this.So.eW(B.K(Q));if(Aa>n)(d&&Aa===n+1||!d)&&ha.add(this.Ip.create(this.So.iDa(B.K(Q)),this._context));else break}return new Zr(ha)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.dla,"ListItem");const d=this.So.$Sb(this.dla);pc.a.Y2(d,"ListItem")}getTypeName(){return"Microsoft.WordServices.ListItem"}invokePropertyGet(d){switch(d){case 4:return this.level;case 3:return this.listString;case 2:return this.siblingIndex;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 4:this.level=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.Xnm(n);
case 1005:return this.Ynm(n);case 1004:return this.hwm(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Xnm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getAncestor(d)}Ynm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getAncestorOrNullObject(d)}hwm(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getDescendants(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}RLf(){let d;d=ve.a.wna(this.dla,{Qta:-1}).listId;const n=new vc.a;n.set(this.dla);n.ku();let B=n.Mu(36);B||(B=n.Mu(8));return this.So.fDa(d,B)}}Object(D.a)(rK,"ListItem",rh.a,[866]);class Hx{constructor(d,n){this.Ip=null;this.So=d;this.ENc=n}Vu(d){this.Ip=d}create(d,n){return new rK(d,n,this.So,this.Ip,this.ENc)}}Object(D.a)(Hx,
"ListItemFactory",null,[]);var Ix=e(58);class aA{constructor(d,n,B,Q,ha,Aa){this.kK=Aa;this.qb=d;this.L2e=n;this.zg=B;this.AO=Q;this.ENc=ha}getLevelString(d,n,B){(0>B||B>=pc.a.Noa)&&pc.a.Cd();(n=this.fDa(d,n))&&n.count||pc.a.vg();for(var Q=0;Q<n.count;Q++)if(this.eW(n.K(Q))===B)return d=this.$Sb(n.K(Q)),this.ENc.A_a(d).tW;Q="";var ha=this.zg.XA(n.K(0),d,B),Aa=Yr.a.hca(ha,null);if(1===Aa.listType)Q=Aa.levelText;else if(Aa.listType)pc.a.vg();else if(Q=Aa.levelText,ha=ha.ka(xd.a.uW,1),B+=1,Q=Ca.a.replaceAll(Q,
"%"+B,this.bci(Aa,ha)),0<=Q.indexOf("%"))for(Aa=0;Aa<B;Aa++)0<=Q.indexOf("%"+(Aa+1))&&(ha=this.iSm(n.K(0),d,Aa),Q=Ca.a.replaceAll(Q,"%"+(Aa+1),ha));return Q}setLevelAlignment(d,n,B,Q){(0>B||B>=pc.a.Noa||!Q||""===Q)&&pc.a.Cd();(n=this.fDa(d,n))||pc.a.vg();this.zg.XA(n.K(0),d,B).setValue(Dd.a.oia,Q);if(!np.a.getInstance().Gv){for(d=0;d<n.count;d++)if(this.eW(n.K(d))===B){const ha=this.$Sb(n.K(d));ha&&ha.setValue(Dd.a.oia,Q)}this.u_(this.iDa(n.K(0)))}}setLevelStartingNumber(d,n,B,Q){(0>B||B>=pc.a.Noa||
0>Q)&&pc.a.Cd();(n=this.fDa(d,n))&&n.count||pc.a.vg();var ha=this.zg.XA(n.K(0),d,B);ha.setValue(xd.a.uW,Q);if(!np.a.yu){var Aa=-1;d=Q;var bb=pc.a.Noa;let oc=!1;ha=Yr.a.hca(ha,null);for(let Ac=0;Ac<n.count;Ac++){bb<B&&(oc=!0);bb=this.eW(n.K(Ac));if(bb===B&&!ha.listType){var Ib=Ac;1!==Ib-Aa&&oc&&(d=Q,oc=!1);Aa=this.Dmc(n.K(Ac));this.kK.oIe(Aa,d,d);Aa=Ac;d++}np.a.getInstance().Gv||(Ib=this.iDa(n.K(Ac)),this.u_(Ib))}}}F2o(d,n,B,Q,ha){(0>B||B>=pc.a.Noa)&&pc.a.Cd();(n=this.fDa(d,n))||pc.a.vg();d=this.zg.XA(n.K(0),
d,B);d.setValue(Dd.a.ve,Mi.a.fM(Q));ha=Mi.a.fM(ha);0<=ha?(d.setValue(Dd.a.vF,ha),d.removeProperty(Dd.a.lv)):(d.setValue(Dd.a.lv,0-ha),d.removeProperty(Dd.a.vF));for(d=0;d<n.count;d++)if(this.eW(n.K(d))===B){var Aa=this.iDa(n.K(d));Aa.fg(Dd.a.ve);Aa.fg(Dd.a.vF);Aa.fg(Dd.a.lv);!np.a.getInstance().Gv&&(Aa=this.$Sb(n.K(d)))&&(Aa.setValue(Dd.a.ve,Mi.a.fM(Q)),0<=ha?(Aa.setValue(Dd.a.vF,ha),Aa.removeProperty(Dd.a.lv)):(Aa.setValue(Dd.a.lv,0-ha),Aa.removeProperty(Dd.a.vF)))}np.a.getInstance().Gv||this.u_(this.iDa(n.K(0)))}HFm(d){const n=
this.Vab(d),B=Array(pc.a.Noa);for(let ha=0;ha<pc.a.Noa;ha++){var Q=this.zg.XA(d,n,ha);Q=Yr.a.hca(Q,null);Q.listType?1===Q.listType&&(B[ha]=Q.ucd?2:0):B[ha]=1}return B}fDa(d,n){n=this.qb.ox(n,!0,!1);const B=new ma.a;for(const Q of n)this.$vn(Q,d)&&B.add(bf.ParagraphReader.Zmc(Q));return B.count?B:null}$Sb(d){return ve.a.a9(d)}Dmc(d){const n=new vc.a;n.set(d);d=null;ve.a.Wg(n)&&(this.zg.s2(n),d=n.currentNode);return d}eW(d){let n=-1;ve.a.Wg(d)&&(n=ve.a.wna(d,{SWa:-1}).listLevel);return n}iDa(d){const n=
new vc.a;n.set(d);d=null;ve.a.Wg(n)&&(d=n.ic(2));return d}ayi(d,n){if(!d||!d.count)return null;const B=new ma.a,Q=new ma.a;var ha=null;for(let bb=0;bb<d.count;bb++){const Ib=d.K(bb).node;if(!(ha&&Ib&&ha.id.equals(Ib.id))){ha=Ib;var Aa=void 0;ve.a.Qe?ve.a.isListItem(Ib)&&(Aa=bf.ParagraphReader.Zmc(Ib),Aa=this.Vab(Aa),Q.contains(Aa)||(Q.add(Aa),B.add(this.Ftb(Ib)))):({TZb:Aa}=this.ocd(Ib)).returnValue&&(Aa=this.Vab(Aa),Q.contains(Aa)||(Q.add(Aa),B.add(this.Ftb(Ib))))}}d=new ma.a;for(ha=0;ha<Q.count;ha++)d.add(this.L2e.create(B.K(ha),
Q.K(ha),n));return d}Vab(d){let n=-1;d=vc.a.kb(d);ve.a.Wg(d)&&(n=ve.a.wna(d,{Qta:-1}).listId);return n}ocd(d){if(!d)return{returnValue:!1,TZb:null};d=vc.a.kb(d);if(d.Ib(11)){const n=d.Gq(11);if((d=n)&&ve.a.Wg(n))return{returnValue:!0,TZb:d}}else d=null;return{returnValue:!1,TZb:d}}attachToList(d,n,B,Q){if(B>=pc.a.Noa||0>B)return pc.a.Cd(),null;let ha=null;if(ve.a.Qe){if(ve.a.isListItem(d)||!(ha=bf.ParagraphReader.Zmc(d)))return pc.a.vg(),null}else if(({TZb:ha}=this.ocd(d)).returnValue||!ha)return pc.a.vg(),
null;var Aa=new vc.a;Aa.set(ha);Aa.Wd();let bb=new Yb.DictionaryPropertySet;var Ib=this.zg.Stn(d,n);var oc=this.Ftb(d);oc=this.fDa(n,oc);Ib&&oc?(Ib=Se.a.KP,oc=this.$Sb(oc.K(oc.count-1)),oc=this.zg.P4(oc),1===oc.listType?Ib=Se.a.FF:oc.listType||(Ib=Se.a.KP),bb=this.AO.A2c(Ib,bb),{Tna:oc}=this.AO.Vsa(bb,Aa,oc,!1)):Ib&&!oc?pc.a.vg():pc.a.Cd();if(!np.a.getInstance().xu)if(Aa=this.Dmc(ha))this.kK.WCb(Aa,n),this.qDg(ha,B);else return F.ULS.sendTraceTag(20473551,369,10,"AppId:{0}, Something went wrong in native code and failed to create a list node.",
Q.appId),null;np.a.getInstance().Gv&&(this.kK.WCb(d,n),this.qDg(ha,B));d=this.Ftb(d);return this.L2e.create(d,n,Q)}startNewList(d,n){if(ve.a.Qe){if(ve.a.isListItem(d))return pc.a.vg(),null;var B=bf.ParagraphReader.Zmc(d)}else if(({TZb:B}=this.ocd(d)).returnValue)return pc.a.vg(),null;const Q=new vc.a;Q.set(B);Q.Wd();let ha=Yr.a.LY(1,1),Aa=new Yb.DictionaryPropertySet;Aa=this.AO.A2c(Se.a.FF,Aa);({Tna:ha}=this.AO.Vsa(Aa,Q,ha,!0));d=this.Ftb(d);B=this.Vab(B);return this.L2e.create(d,B,n)}detachFromList(d){ve.a.Ztn(d)||
pc.a.vg();this.AO.rYc(d)}qDg(d,n){var B=this.eW(d);if(-1!==B&&n<pc.a.Noa&&-1<n){var Q=this.Dmc(d),ha=this.$Sb(d);if(Q&&ha){var Aa=this.Vab(d),bb=this.zg.XA(ha,Aa,B),Ib=Yr.a.hca(bb,null);bb=this.mIi(d);np.a.getInstance().xu||Q.setValue(Dd.a.listLevel,n);if(np.a.getInstance().Gv){var oc=this.iDa(d);this.kK.f2b(oc,Aa,n)}if(!this.zg.P4(ha).listType)for({startAt:ha,Rga:Aa}=this.XCm(d),np.a.getInstance().xu||this.kK.oIe(Q,ha,Aa),Q=this.mIi(d),oc=0;oc<Q.count;oc++)if(!np.a.getInstance().xu){const Ac=this.Dmc(Q.K(oc));
this.kK.oIe(Ac,ha+1+oc,Aa+1+oc)}if(!Ib.listType&&!this.MAn(d)&&n!==B)for(d=0;d<bb.count;d++)np.a.getInstance().xu||(n=this.Dmc(bb.K(d)),B=ve.a.lce(n),Ib=ve.a.cTf(n),this.kK.oIe(n,B-1,Ib-1))}}}setLevelNumbering(d,n,B,Q,ha,Aa){let bb=0,Ib="right";switch(ha){case 0:bb=1;break;case 4:bb=2;break;case 2:bb=3;Ib="left";break;case 3:bb=4;break;case 1:bb=5;Ib="left";break;case -1:bb=1;break;default:pc.a.Cd()}let oc="";if(Aa&&Aa.length){let Ac=!1;for(let ad=0;ad<Aa.length;ad++)if(Number===Object.getType(Aa[ad])){const sd=
Aa[ad];Ac=sd===Q||Ac;sd>Q?pc.a.Cd():-1===ha&&sd===Q?pc.a.Cd():sd<Q&&this.zg.XA(n,B,sd).ka(oh.a.dE,14)&&pc.a.Cd();oc=oc+"%"+(sd+1).toString()}else oc+=Aa[ad];-1===ha||Ac||pc.a.Cd()}else oc=null;n="%"+(Q+1).toString();oc||(oc=n);this.vUj(0,bb,d,B,Q,oc,"Calibri",Ib)}setLevelBullet(d,n,B,Q,ha,Aa){Aa=Aa?Aa:Ix.a.s0c;switch(Q){case 258231:ha=61623;Aa="Symbol";break;case 131183:ha=111;Aa="Courier New";break;case 716967:ha=61607;Aa="Wingdings";break;case 716918:ha=61558;Aa="Wingdings";break;case 717016:ha=
61656;Aa="Wingdings";break;case 717052:ha=61692,Aa="Wingdings"}this.vUj(1,1,d,n,B,String.fromCharCode(ha),Aa,"left")}mIi(d){var n=this.Vab(d);const B=this.eW(d),Q=new ma.a;n=this.fDa(n,this.Ftb(d));let ha=!1;for(let Aa=0;Aa<n.count;Aa++){const bb=this.eW(n.K(Aa));if(ha&&bb<B)break;bb===B&&(ha&&Q.add(n.K(Aa)),d.id.equals(n.K(Aa).id)&&(ha=!0))}return Q}MAn(d){var n=this.Vab(d);ve.a.Qe||this.eW(d);n=this.fDa(n,this.Ftb(d));return d.id.equals(n.K(0).id)?!0:!1}XCm(d){var n=this.Vab(d),B=this.eW(d);const Q=
this.fDa(n,this.Ftb(d));n=null;for(let ha=0;ha<Q.count;ha++)if(this.eW(Q.K(ha))===B){if(d.id.equals(Q.K(ha).id))break;n=Q.K(ha)}B=d=1;n&&!np.a.getInstance().xu&&(n=this.Dmc(n))&&(d=ve.a.lce(n)+1,B=ve.a.cTf(n)+1);return{startAt:d,Rga:B}}$vn(d,n){if(ve.a.Qe)return d?ve.a.ut(d,{Qta:-1}).listId===n:!1;let B=!1,Q=null;d&&({TZb:Q}=this.ocd(d)).returnValue&&this.Vab(Q)===n&&(B=!0);return B}Ftb(d){d=vc.a.kb(d);return d.Ib(36)?d.Gq(36):d.Ib(38)?d.Gq(38):d.Ib(8)?d.Gq(8):null}vUj(d,n,B,Q,ha,Aa,bb,Ib){var oc=
null;const Ac=this.fDa(Q,B);Ac||pc.a.vg();for(var ad=0;ad<Ac.count;ad++)if(this.eW(Ac.K(ad))===ha){oc=Ac.K(ad);break}ad=new Yb.DictionaryPropertySet;const sd=new vc.a;if(oc){var wd=d?Se.a.FF:Se.a.KP;sd.set(oc);sd.Wd();ad=this.AO.A2c(wd,ad);wd=Yr.a.LY(d,n)}else wd=this.zg.XA(Ac.K(0),Q,ha),wd=Yr.a.hca(wd,new Yb.DictionaryPropertySet),wd.iea(d,n);wd.levelText=Aa;wd.font=bb;wd.tad=!0;wd.Dz=Ib;d=this.zg.XA(Ac.K(0),Q,ha).ka(xd.a.uW,Ix.a.sl);oc&&({Tna:wd}=this.AO.Vsa(ad,sd,wd,!1));if(!np.a.getInstance().Gv)for(oc=
0;oc<Ac.count;oc++)n=this.iDa(Ac.K(oc)),this.u_(n);d!==Ix.a.sl&&this.setLevelStartingNumber(Q,B,ha,d)}u_(d){d&&d.setValue(xd.a.qW,new Date)}iSm(d,n,B){n=this.zg.XA(d,n,B);d=Yr.a.hca(n,null);if(d.listType)return"";n=n.ka(xd.a.uW,1);return this.bci(d,n)}bci(d,n){switch(d.Nua()){case 0:return n+"";case 4:return Ca.a.n0d(n-1,!0);case 2:return Ca.a.SZc(n,!0);case 3:return Ca.a.n0d(n-1,!1);case 1:return Ca.a.SZc(n,!1);default:return n+""}}}Object(D.a)(aA,"ListOperations",null,[1152]);class pF extends rh.a{constructor(d,
n,B,Q,ha,Aa,bb){super();pc.a.ARa(d,"NoteItem");this.JM=d;this._context=n;this._id=B;this.nd=bb;this.eS=Q;this.Jk=ha;this.cmb=Aa}get type(){return this.nd.Ica(this.JM)}get body(){return this.eS.create(this.JM,this._context)}get reference(){const d=new ma.a;var n=this.JM.tua;n&&(n=n.Rb,d.add(ge.a.createTextRange(n.paragraph,n.cp,n.cp+1)));return this.Jk.create(d,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}deleteObject(){this.nd.WWl(this.JM)}getNext(){const d=
this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){const d=this.nd.aIm(this.JM,this.type);return d?this.cmb.create(d,this._context):null}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.JM,"NoteItem")}getTypeName(){return"Microsoft.WordServices.NoteItem"}invokePropertyGet(d){switch(d){case 4:return this.body;case 5:return this.reference;case 3:return this.type;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.bF(n);case 1004:return this.b9();case 1005:return this.c9();case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bF(){this.deleteObject();return null}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(pF,"NoteItem",rh.a,[866]);class oD{constructor(){}Vu(d,n,B){this.eS=d;this.Jk=n;this.nd=B}create(d,n,B=0){return new pF(d,n,B,this.eS,this.Jk,this,this.nd)}}Object(D.a)(oD,"NoteItemFactory",null,
[1011]);class Qw{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di){this.XRa=di;this.Jk=null;this.ME=d;this.lQ=n;this.M2e=B;this.qb=Q;this.Ww=ha;this.MM=Aa;this.Wr=bb;this.hVk=Ib;this.nd=oc;this.Xz=Ac;this.uh=ad;this.wD=sd;this.fz=wd;this.Am=yd;this.yd=be;this.So=ye;this.qv=Qe;this.lz=af;this.Tz=Qf;this.C6e=hf}Vu(d){this.Jk=d}create(d,n,B=0){return new wB(d,n,B,this.ME,this.lQ,this,this.Jk,this.M2e,this.qb,this.Ww,this.MM,this.Wr,this.hVk,this.nd,this.Xz,this.uh,this.wD,this.fz,
this.Am,this.yd,this.So,this.qv,this.lz,this.Tz,this.C6e,this.XRa)}}Object(D.a)(Qw,"ParagraphFactory",null,[1011]);class qF{constructor(){this.ohd=new Map;this.r9f=new Map}TIi(d){if(!this.ohd.has(d)){const n=Ze.a.create();this.ohd.set(d,n.toString());this.r9f.set(n.toString(),d)}return this.ohd.get(d)}BIm(d){return this.r9f.get(d)}eHo(d){const n=this.ohd.get(d);n&&(this.ohd.delete(d),this.r9f.delete(n))}}Object(D.a)(qF,"ParagraphLocalIdMapping",null,[]);class Vy{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,
Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj){this.Ip=d;this.lQ=n;this.ME=B;this.cGk=Q;this.qb=ha;this.Wr=Aa;this.yD=bb;this.nd=Ib;this.Xz=oc;this.uh=Ac;this.wD=ad;this.fz=sd;this.Am=wd;this.VG=yd;this.yd=be;this.So=ye;this.Tp=Qe;this.cmb=af;this.qv=Qf;this.lz=hf;this.Tz=di;this.XRa=vj}create(d,n,B=0){return new Ut(d,n,B,this.Ip,this.lQ,this.ME,this,this.cGk,this.qb,this.Wr,this.yD,this.nd,this.Xz,this.uh,this.wD,this.fz,this.Am,this.VG,this.yd,this.So,this.Tp,this.cmb,this.qv,this.lz,this.Tz,this.XRa)}}
Object(D.a)(Vy,"RangeFactory",null,[1011]);class rF{constructor(){this.Pjh=this._value=""}get value(){return this._value}set value(d){this._value=d}get Tta(){return this.Pjh}set Tta(d){this.Pjh=d}}Object(D.a)(rF,"StringAndDelimiter",null,[]);class sK{constructor(){this.tkb=this.Ufa=-1;this.Uth=!1}get start(){return this.Ufa}set start(d){this.Ufa=d}get end(){return this.tkb}set end(d){this.tkb=d}get e1f(){return this.Uth}set e1f(d){this.Uth=d}}Object(D.a)(sK,"SubRangeGncLocation",null,[]);class tK{constructor(d,
n,B){this.qb=d;this.ga=n;this.VG=B}mSb(d,n){if(!d||0>=d.count)return null;var B=d.count;const Q=new ma.a;if(n)if(1===n)Q.add(this.rN(d.K(0),!0));else if(2===n)Q.add(this.rN(d.K(B-1),!1));else if(5===n){for(n=0;n<B-1;n++)Q.add(d.K(n).clone());n=d.K(B-1).clone();const ha=this.qb.textLength(n.node);switch(n.contextId){case ed.a.paragraph:if(n=ha?ge.a.createTextRange(n.node,0,ha):1===B?ge.a.jd(n.node,0):null)n.Ob=this.qb.jA(n.node),n.nc=this.qb.xz(n.node);break;case ed.a.od:1===B?(n=ge.a.uz(n.node),n.Ob=
d.K(B-1).Ob,n.nc=this.qb.xz(n.node)):n=null}n&&Q.add(n)}else if(4===n){B=d.K(B-1).clone();d=null;switch(B.contextId){case ed.a.paragraph:case ed.a.od:if(B=this.KHi(B.node))d=ge.a.jd(B.node,0),d.Ob=d.nc=this.qb.jA(B.node);break;case ed.a.kd:case ed.a.Nd:d=this.rN(B,!1)}if(d)Q.add(d);else return null}else F.ULS.sendTraceTag(18745303,369,15,"rangeLocation of GetChildRange must be Start/End/Whole/Content/After."),pc.a.Cd();else for(n=0;n<B;n++)Q.add(d.K(n).clone());return Q}kBc(d,n,B,Q,ha,Aa=!0,bb=!0,
Ib=!1){if(!d||0>=d.count)return F.ULS.sendTraceTag(18745304,369,10,"the Gnc List should contain at least one graph node context."),null;Ib&&(Q||B||Aa)&&pc.a.vg();var oc=new ma.a;oc.add(d.K(0).node);var Ac=[""],ad=0,sd=d.K(0).node.id;for(var wd=0;wd<d.count;wd++){var yd=d.K(wd).node,be=yd.id;sd.equals(be)||(sd=be,ad++,oc.add(yd),Ac[ad]="");switch(d.K(wd).contextId){case ed.a.paragraph:yd=this.qb.text(yd);break;case ed.a.Nd:case ed.a.kd:yd=this.qb.text(yd).substring(d.K(wd).cpBegin,d.K(wd).cpEnd);break;
default:continue}Ac[ad]+=yd}Aa||(sd=d.K(0).node,wd=d.K(d.count-1).node,Ac[0]=this.qb.text(sd),Ac[Ac.length-1]=this.qb.text(wd));sd=Array(ad+1);for(wd=0;wd<ad+1;wd++)sd[wd]=[],yd=new rF,yd.value=Ac[wd],sd[wd][0]=yd;for(Ac=0;Ac<n.length;Ac++)for(wd=n[Ac],yd=0;yd<ad+1;yd++){be=sd[yd];var ye=[];for(var Qe=0;Qe<be.length;Qe++)ye=ye.concat.apply(ye,this.Jjp(wd,be[Qe]));sd[yd]=ye}n=Array(ad+1);for(Ac=0;Ac<ad+1;Ac++)for(n[Ac]=[],wd=sd[Ac],yd=0,Aa&&!Ac&&(yd=this.lRf(d.K(0),!0)),be=this.qb.textLength(oc.K(Ac)),
Aa&&Ac===ad&&(be=this.lRf(d.K(d.count-1),!1)),ye=0;ye<wd.length;ye++){Qe=new sK;var af=wd[ye];if(af=af.value.length+af.Tta.length){var Qf=yd+af<be?yd+af:be;Qe.start=yd;Qe.end=Qf;yd+=af}else Qe.start=yd,Qe.end=yd;if(Ib&&0<=ye&&ye<wd.length-1){af=wd[ye+1];Qf=af.value.trimStart();const hf=af.value.length-Qf.length;Qe.end+=hf;yd+=hf;af.value=Qf}n[Ac][ye]=Qe}if(Q)for(Ac=0;Ac<ad+1;Ac++)for(wd=sd[Ac],yd=0;yd<wd.length;yd++)n[Ac][yd].end-=wd[yd].Tta.length;for(sd=0;sd<ad+1;sd++)if(wd=oc.K(sd),Ac=n[sd][n[sd].length-
1],this.qb.textLength(wd),sd===ad&&(!Aa||d.K(d.count-1).contextId===ed.a.paragraph||d.K(d.count-1).contextId===ed.a.od)||!sd&&(0<ad||!Aa||d.K(d.count-1).contextId===ed.a.paragraph||d.K(d.count-1).contextId===ed.a.od)||0<sd&&sd<ad)wd=new sK,wd.start=Ac.end,wd.end=Ac.end,wd.e1f=!0,n[sd][n[sd].length]=wd;sd=Array(ad+1);for(Ac=0;Ac<ad+1;Ac++)for(sd[Ac]=[],wd=oc.K(Ac),yd=n[Ac],be=0;be<yd.length;be++)ye=new ma.a,Qe=yd[be],Qe=Qe.e1f?ge.a.Pm(wd):Qe.start||Qe.end!==this.qb.textLength(wd)?Qe.start===Qe.end?
ge.a.jd(wd,Qe.start):ge.a.createTextRange(wd,Qe.start,Qe.end):ge.a.create(wd),ye.add(Qe),sd[Ac][be]=ye;oc=[];ad=0;for(n=0;n<sd.length;n++)for(Ac=sd[n],wd=0;wd<Ac.length;wd++){if(B&&wd+1<Ac.length&&Ac[wd+1].K(0).contextId===ed.a.od)if(yd=new ma.a,n<sd.length-1){yd.addRange(Ac[wd]);this.Arn(Ac[wd])||yd.K(yd.count-1).contextId===ed.a.paragraph||(yd.K(yd.count-1).contextId===ed.a.kd&&yd.removeAt(yd.count-1),yd.add(Ac[wd+1].K(0)));yd.addRange(sd[n+1][0]);sd[n+1][0]=yd;break}else yd=Ac[wd],yd.K(yd.count-
1).contextId===ed.a.paragraph?Ac.pop():yd.K(yd.count-1).contextId===ed.a.kd?(be=Ac.pop(),yd.W(yd.count-1,be.K(0))):yd.K(yd.count-1).contextId===ed.a.Nd&&(be=Ac.pop(),yd.add(be.K(0)));if(!B){if(wd+1<Ac.length&&Ac[wd+1].K(0).contextId===ed.a.od)if(yd=Ac[wd],yd.K(yd.count-1).contextId===ed.a.paragraph)Ac.pop();else if(yd.K(yd.count-1).contextId===ed.a.kd){if(be=Ac.pop(),yd.W(yd.count-1,be.K(0)),Ib&&0<wd){Ac[wd-1].add(be.K(0));Ac.pop();continue}}else yd.K(yd.count-1).contextId===ed.a.Nd&&(be=Ac.pop(),
yd.add(be.K(0)));Q&&this.iHe(sd[n][wd])}ha&&(sd[n][wd]=this.jHe(sd[n][wd],B));!Ib&&Aa&&(yd=sd[n][wd],be=d.K(0),ye=d.K(d.count-1),this.Kzc(be,ye,yd,Q));bb&&this.QVb(sd[n][wd])||(oc[ad++]=sd[n][wd])}return oc}cSf(d,n,B){if(!d||!d.count)return null;n=this.kBc(d,n,!1,!1,!1,!1,!1,!0);for(var Q=0;Q<n.length&&!this.L1f(n[Q],d.K(0),!0);)n.shift();for(Q=n.length-1;0<=Q&&!this.L1f(n[Q],d.K(d.count-1),!1);Q--)n.pop();if(B){d=[];B=0;for(Q=0;Q<n.length;Q++)n[Q]=this.jHe(n[Q]),this.QVb(n[Q])||(d[B++]=n[Q]);n=d}for(d=
0;d<n.length;d++)this.Kzc(null,null,n[d],!1);return n}getNextTextRange(d,n,B){if(!d||0>=d.count)return null;var Q=new ma.a;Q.add(d.K(d.count-1));var ha=this.kBc(Q,n,!1,!1,!1,!1,!1,!0);Q=new ma.a;var Aa=-1;for(let bb=ha.length-1;0<=bb&&!this.L1f(ha[bb],d.K(d.count-1),!1);bb--)Aa=bb;if(-1!==Aa){for(;Aa<ha.length&&this.QVb(Q);Aa++)Q=ha[Aa],B&&(Q=this.jHe(Q));this.Kzc(null,null,Q,!1);if(!this.QVb(Q))return Q}d=d.K(d.count-1);do{if(d=this.KHi(d.node))for(ha=new ma.a,ha.add(d),ha=this.kBc(ha,n,!1,!1,!1,
!1,!0,!0),Aa=0;Aa<ha.length&&this.QVb(Q);Aa++)Q=ha[Aa],B&&(Q=this.jHe(Q));else return null;this.Kzc(null,null,Q,!1)}while(this.QVb(Q));return Q}QVb(d){for(let n=0;n<d.count;n++)switch(d.K(n).contextId){case ed.a.paragraph:case ed.a.od:return!1;case ed.a.Nd:if(d.K(n).cpBegin<d.K(n).cpEnd)return!1;break;case ed.a.kd:if(d.K(n).Ob<d.K(n).nc)return!1}return!0}rN(d,n=!0,B=!1){if(!d)return null;let Q=null;switch(d.contextId){case ed.a.paragraph:Q=n?ge.a.jd(d.node,0):B?ge.a.jd(d.node,this.qb.textLength(d.node)+
1):ge.a.uz(d.node);break;case ed.a.od:Q=!n&&B?ge.a.jd(d.node,this.qb.textLength(d.node)+1):ge.a.uz(d.node);break;case ed.a.Nd:case ed.a.kd:Q=n?ge.a.jd(d.node,d.cpBegin):ge.a.jd(d.node,d.cpEnd)}Q&&n&&-1!==d.Ob?Q.Ob=Q.nc=d.Ob:Q&&!n&&-1!==d.nc&&(Q.cpEnd===this.qb.textLength(d.node)+1?Q.Ob=Q.nc=-1:Q.Ob=Q.nc=d.nc);return Q}IAe(d){if(d&&d.count){var n=d.K(0);d=d.K(d.count-1);n.Ob=this.qb.jA(n.node);d.nc=this.qb.xz(d.node)}}Kzc(d,n,B,Q){if(B&&B.count){var ha=B.K(0);B=B.K(B.count-1);var Aa=this.rN(ha),bb=
this.rN(B,!1),Ib=null,oc=null;d&&(Ib=this.rN(d));n&&(oc=this.rN(n,!1));d&&Ib&&Ib.cpBegin===Aa.cpBegin?-1!==d.Ob&&(ha.Ob=d.Ob):(0<this.qb.nn(ha.node,Aa.cpBegin)?ha.Ob=0:ha.Ob=-1,Aa.cpBegin||(ha.Ob=this.qb.jA(ha.node)));n&&oc&&oc.cpEnd===bb.cpEnd?-1!==n.nc&&(B.nc=n.nc):(d=this.qb.nn(B.node,bb.cpEnd),0<d?Q?(B.nc=d,bb.cpEnd===this.qb.textLength(bb.node)&&(B.nc=this.qb.xz(bb.node))):B.nc=0:B.nc=-1)}}i4h(d){return 32!==this.ga.Sf(d,Se.a.PT,1,!1,null,null)?!1:!0}KHi(d){return(d=this.qb.Cg(d,!1,!0))?ge.a.create(d):
null}iHe(d){let n=!1;if(d&&0<d.count)for(var B=0;B<d.count;){d.K(B).contextId===ed.a.od&&(d.removeAt(B),n=!0);break}if(d&&0<d.count)for(B=d.count-1;0<=B;B--){const Q=d.K(B);if(Q.contextId===ed.a.od)d.removeAt(B),n=!0;else if(Q.contextId===ed.a.paragraph)if(n=!0,this.qb.textLength(Q.node)){d.W(B,ge.a.createTextRange(Q.node,0,this.qb.textLength(Q.node)));break}else d.removeAt(B);else break}return n}jHe(d,n=!0){const B=new ma.a;n&&this.iHe(d);if(d&&0<d.count)for(var Q=0;Q<d.count;){var ha=this.K8j(d.K(Q),
!0);if(ha.contextId===ed.a.kd)d.removeAt(Q);else if(d.W(Q,ha),!n)break;if(n&&!this.iHe(d))break}if(d&&0<d.count){do if(Q=d.count-1,ha=this.K8j(d.K(Q),!1),ha.contextId===ed.a.kd)d.removeAt(Q);else if(d.W(Q,ha),!n)break;while((!n||n&&this.iHe(d))&&0<d.count)}B.addRange(d);return B}K8j(d,n){if(!d)return null;var B=null;switch(d.contextId){case ed.a.Nd:case ed.a.paragraph:B=this.rN(d,!0);var Q=this.rN(d,!1);const ha=this.qb.text(B.node),Aa=ha.substring(B.cpBegin,Q.cpBegin);let bb=B.cpBegin;Q=Q.cpEnd;
n?bb+=Aa.length-Aa.trimStart().length:Q=bb+Aa.trimEnd().length;B=Q-bb?bb||Q!==ha.length?ge.a.createTextRange(B.node,bb,Q):d:ge.a.jd(B.node,bb);break;case ed.a.od:case ed.a.kd:B=d}return B}L1f(d,n,B){if(0<d.count){const Aa=this.rN(d.K(0),!0);var Q=this.rN(d.K(d.count-1),!1);if(!Aa.node.id.equals(n.node.id))return!1;var ha=this.lRf(n,B);let bb=d=-1;switch(n.contextId){case ed.a.Nd:case ed.a.paragraph:this.qb.text(n.node).length?(d=2*ha+1,bb=2*ha-1):bb=d=0;break;case ed.a.od:case ed.a.kd:d=2*ha,bb=2*
ha}ha=Aa.cpBegin;n=Q.cpEnd;0<n-ha?(Q=2*ha,ha=2*n-1,n===this.qb.text(Aa.node).length&&(ha+=1)):(Q=2*ha,ha=2*n);if(B&&d>=Q&&d<=ha||!B&&bb>=Q&&bb<=ha)return!0}return!1}lRf(d,n){let B=0,Q=0;if(d)switch(d.contextId){case ed.a.paragraph:B=0;Q=this.qb.textLength(d.node);break;case ed.a.od:B=this.qb.textLength(d.node);Q=this.qb.textLength(d.node);break;case ed.a.Nd:case ed.a.kd:B=d.cpBegin,Q=d.cpEnd}return n?B:Q}Jjp(d,n){const B=n.value.split(d),Q=[];for(let ha=0;ha<B.length;ha++){const Aa=new rF;Aa.value=
B[ha];Aa.Tta=ha!==B.length-1?d:n.Tta;Q[ha]=Aa}return Q}Arn(d){for(let n=0;n<d.count;n++)if(d.K(n).contextId===ed.a.od)return!0;return!1}w$h(d,n,B,Q){if(this.t3i(d,B)){d=this.rN(d,!0);n=this.rN(n,!1,!0);B=this.rN(B,!0);const ha=this.rN(Q,!1,!0);Q=this.wma(d,B);const Aa=this.wma(n,ha);d=this.wma(d,ha);n=this.wma(n,B);d=Q?2===Q?2===d?13:1===d?11:Aa?1===Aa?6:12:7:Aa?1===Aa?1:2:5:n?1===n?8:Aa?1===Aa?3:4:9:10}else d=0;return d}t3i(d,n){d=this.rN(d,!0);n=this.rN(n,!0);return 3!==this.wma(d,n)}wma(d,n){if(d.node.id.equals(n.node.id)){var B=
d.cpBegin-n.cpBegin;return B?0<B?2:0:(B=d.rp()-n.rp())?0<B?2:0:1}B=this.WNi(d.node);const Q=this.WNi(n.node);B.insert(0,d.node);Q.insert(0,n.node);d=B.count;for(n=Q.count;0<d&&0<n&&B.K(--d).id.equals(Q.K(--n).id););var ha=B.K(d+1);switch(ha.type){case 7:case 35:case 39:return 3;case 8:case 10:const Aa=this.Lai(B),bb=this.Lai(Q);if(Aa||bb)return 3;ha=vc.a.kb(ha);return 0<ha.$Ca(B.K(d))-ha.$Ca(Q.K(n))?2:0;default:return ha=vc.a.kb(ha),0<ha.$Ca(B.K(d))-ha.$Ca(Q.K(n))?2:0}}utb(d){let n=[];const B=new ma.a;
var Q=d.K(0).node.id;let ha=d.K(0).node;var Aa=d.K(0);let bb=d.K(0);for(let Ib=0;Ib<d.count;Ib++){const oc=d.K(Ib).node,Ac=oc.id;if(!Q.equals(Ac)){Q=Aa.cpBegin;Aa.contextId===ed.a.paragraph?Q=0:Aa.contextId===ed.a.od&&(Q=Aa.node.characterData.length);Aa=bb.cpEnd;if(bb.contextId===ed.a.paragraph||bb.contextId===ed.a.od)Aa=bb.node.characterData.length;Q===Aa?B.add(ge.a.jd(ha,Q)):B.add(ge.a.createTextRange(ha,Q,Aa));ha=oc;Q=Ac;Aa=d.K(Ib)}bb=d.K(Ib)}Q=Aa.cpBegin;Aa.contextId===ed.a.paragraph?Q=0:Aa.contextId===
ed.a.od&&(Q=Aa.node.characterData.length);Aa=bb.cpEnd;if(bb.contextId===ed.a.paragraph||bb.contextId===ed.a.od)Aa=bb.node.characterData.length;Q===Aa?B.add(ge.a.jd(ha,Q)):B.add(ge.a.createTextRange(ha,Q,Aa));for(const Ib of B)Ib.contextId===ed.a.kd&&(n=n.concat.apply(n,this.PXf(Ib))),n=n.concat.apply(n,Hm.a.VD(Ib,!1));return{returnValue:n,zfg:B}}EJi(d,n){let B="";for(let Q=0;Q<d.count;Q++){const ha=d.K(Q);switch(ha.contextId){case ed.a.paragraph:B+=this.qb.e_b(ha.node)+pc.a.dtc;break;case ed.a.Nd:const Aa=
{Kd:ha.cpBegin,endCp:ha.cpEnd};B+=this.qb.e_b(ha.node,void 0,Aa).substring(Aa.Kd,Aa.endCp);break;case ed.a.od:B+=pc.a.dtc;break;case ed.a.kd:break;default:F.ULS.sendTraceTag(539848968,369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",n.appId,ha.contextId),pc.a.vg()}}return B}$Tj(d,n,B,Q){this.K3f(d)||pc.a.vg();if(d.K(0).contextId===ed.a.kd||d.K(0).contextId===ed.a.od)F.ULS.sendTraceTag(540377293,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",
Q.appId),pc.a.vg();if(Q=({zfg:d}=this.utb(d)).returnValue)for(let ha=0;ha<Q.length;ha++)this.VG.YZ(Q[ha].paragraph,Q[ha].hyperlink);n&&""!==n&&d&&0<d.count&&(this.i4h(d.K(0))?(Q=!1,B&&0===n.indexOf("#")&&(n=n.substr(1),Q=!0),this.VG.SJ(d.K(0),n,!1,!1,!1,Q)):pc.a.zE())}WNi(d){const n=new ma.a;d=vc.a.kb(d);for(d.Ib(7);d.Ac();)n.add(d.currentNode);return n}Lai(d){for(let n=0;n<d.count;n++)if(35===d.K(n).type)return!0;return!1}PXf(d){const n=[],B=Hm.a.VD(d,!0);for(const Q of B)Q.cpBegin===d.cpBegin&&
n.push(Q);return n}K3f(d){const n=d.K(0).node.id;for(let B=0;B<d.count;B++){const Q=d.K(B).node.id;if(!n.equals(Q))return!1}return!0}}Object(D.a)(tK,"RangeOperations",null,[1039]);class sF{constructor(d){this.controlId=this.appId=null;this.jsc=!1;this.xk=null;this.vo=d}}Object(D.a)(sF,"RequestContext",null,[]);var Jx=e(2110);class tF{constructor(){this.Iqa=null;this.Mdc=this.KLb=this.w6b=0;this.Jxh=this.QBk=this.tIc=this.$Sc=null;this.Uwb=[]}get wI(){return this.Iqa}set wI(d){this.Iqa=d}get jhf(){return this.w6b}cCe(d){this.w6b=
d}get lqa(){return this.KLb}eAc(d){this.KLb=d}get Ahb(){return this.Mdc}get zea(){return this.$Sc}set zea(d){this.$Sc=d}get z8(){return this.tIc}set z8(d){this.tIc=d}get kMa(){return this.QBk}get Uwb(){return this.Jxh}set Uwb(d){this.Jxh=d}abb(){throw Error.notImplemented();}Pae(){throw Error.notImplemented();}nmc(){throw Error.notImplemented();}$Fi(){throw Error.notImplemented();}JUd(){throw Error.notImplemented();}RRh(){throw Error.notImplemented();}cod(){throw Error.notImplemented();}kye(){throw Error.notImplemented();
}$7h(){throw Error.notImplemented();}Khj(){throw Error.notImplemented();}jnc(){throw Error.notImplemented();}F1(){throw Error.notImplemented();}vDi(){throw Error.notImplemented();}PCb(){throw Error.notImplemented();}cMj(){throw Error.notImplemented();}}Object(D.a)(tF,"FindResultManagerStub",null,[1563]);class uK extends tF{constructor(d){super();this.Ekb=d}JUd(d){this.Ekb&&this.Ekb.DXa(0,d)}}Object(D.a)(uK,"ExtensionFindResultManager",tF,[]);class pD{constructor(d,n,B,Q){this.Aih=d;this.IBk=n;this.OBk=
B;this.rQh=Q}find(d,n,B,Q,ha){if(this.RBn(B)&&this.TBn(n,B)){var Aa=0;B&&(Aa|=B.matchCase?1:0,Aa|=B.matchPrefix?8:0,Aa|=B.matchSuffix?16:0,Aa|=B.matchWildcards?4:0,Aa|=B.matchWholeWord?2:0,Aa|=B.ignorePunct?32:0,Aa|=B.ignoreSpace?64:0);this.msb(d,n,Aa,Q,ha)}else F.ULS.sendTraceTag(18629911,344,10,"user have input a invalid search text."),pc.a.Cd()}msb(d,n,B,Q,ha){this.SBn(B)&&this.UBn(n,B)?(d=this.fzm(d),0>=d.count?Q(new rv(new ma.a)):(Q=this.OBk.create(d,Q,ha),ha=new uK(Q),this.IBk.create(Q,ha,d).find(this.VNm(n,
B)))):(F.ULS.sendTraceTag(545814685,344,10,"user have input an invalid search text."),pc.a.Cd())}VNm(d,n){let B=Jx.a.none;if(!n)return this.Aih(d,B);n&4&&(B|=Jx.a.jOp);n&1&&(B|=Jx.a.matchCase);n&2&&(B|=Jx.a.rSg);n&8&&(B|=Jx.a.prefix);n&16&&(B|=Jx.a.suffix);n&64&&(B|=Jx.a.ignoreSpace);n&32&&(B|=Jx.a.ignorePunct);return this.Aih(d,B)}fzm(d){const n=new ma.a;for(const B of d)B.contextId!==ed.a.paragraph&&B.contextId!==ed.a.Nd||n.add(B);return n}TBn(d,n){return null===d||""===d||n&&n.matchWildcards&&
!this.rQh.Yje(d)?!1:!0}RBn(d){return d&&d.matchCase&&d.matchWildcards?!1:!0}UBn(d,n){return null===d||""===d||4===n&&!this.rQh.Yje(d)?!1:!0}SBn(d){return 5===d?!1:!0}}Object(D.a)(pD,"SearchExecutor",null,[1038]);var Fr;(function(d){d[d.primary=0]="primary";d[d.Y8p=1]="firstPage";d[d.m7p=2]="evenPages"})(Fr||(Fr={}));Object(D.b)("HeaderFooterType",Fr);class CB extends rh.a{constructor(d,n,B,Q,ha,Aa,bb){super();pc.a.ARa(d,"Section");this.hCd=d;this._context=n;this._id=B;this.xAa=Q;this.eS=ha;this.rTa=
Aa;this.tq=bb}get body(){return this.eS.create(this.hCd,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}getFooter(d){return this.eS.create(this.FSb(!1,d),this._context)}getHeader(d){return this.eS.create(this.FSb(!0,d),this._context)}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){pc.a.yj()||pc.a.Yj();var d=vc.a.kb(this.hCd);return d.Ib(8)?(d=d.Lmc(1))?this.xAa.create(d,this._context):null:null}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.hCd,
"Section")}getTypeName(){return"Microsoft.WordServices.Section"}invokePropertyGet(d){switch(d){case 3:return this.body;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1004:return this.eAm(n);case 1003:return this.tBm(n);case 1005:return this.b9();case 1006:return this.c9();case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}eAm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getFooter(d)}tBm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getHeader(d)}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}FSb(d,n){const B=new vc.a;B.set(this.hCd);let Q=1,ha=-1;switch(n){case 0:ha=d?0:3;break;case 1:ha=d?2:5;Q=2;break;case 2:ha=d?1:4;Q=3;break;default:F.ULS.sendTraceTag(16831117,369,15,"AppId:{0}, the type of header footer is undefined: {1}.",
this._context.appId,Fr[n]),pc.a.Cd()}this.rTa.Npi(B,Q);d=this.tq.vYb(B);n=null;d&&(n=this.tq.FSb(d,ha));return n}}Object(D.a)(CB,"Section",rh.a,[866]);class bA{constructor(d,n,B){this.eS=d;this.rTa=n;this.tq=B}create(d,n,B=0){return new CB(d,n,B,this,this.eS,this.rTa,this.tq)}}Object(D.a)(bA,"SectionFactory",null,[1011]);var Kx=e(868);class uF{constructor(d,n,B,Q,ha){this.yd=null;this.pb=d;this.gf=n;this.rI=B;this.qb=Q;this.ga=ha}Vu(d){this.yd=d}fGa(d,n){this.GQj(d,n)}zVo(d,n){this.GQj(d,n)}GQj(d,
n){const B=14===d.type,Q=B?"Table":"Row";d=1===n?this.qb.Vn(d):this.qb.vH(d);const ha=1===n?0:this.qb.textLength(d);d=new Ph.Selection([ge.a.jd(d,ha)],!0);this.pb.Uc(d);n||32===this.ga.Vb(B?Se.a.fGa:Se.a.M1b,2)||(F.ULS.sendTraceTag(20306081,369,10,"Commands.Select{0} failed",Q),pc.a.vg())}select(d,n){d.count||(F.ULS.sendTraceTag(17094667,369,10,"The gncList is empty when try to select the list."),pc.a.Cd());const B=d.K(0);d=d.K(d.count-1);switch(n){case 0:var Q=new Ph.Selection([B],!0);Q=this.gf.Xk(Q,
!0,!1);var ha=new ic.SelectionCollection([Q],0),Aa=new Ph.Selection([d],!0);Aa=this.gf.Xk(Aa,!1,!0);if(({Pn:ha}=this.rI.D4b(ha,Aa.Ya)).returnValue){if(1<ha.length&&(Q=this.yd.S4(B.node))){Aa=this.qb.Vn(Q);const bb=this.qb.vH(Q);if(Aa===B.node&&bb===d.node){this.fGa(Q,n);break}}this.pb.$W(ha)}else Q=this.rI.SA(Q,Aa.Ya),this.pb.Uc(Q);break;case 1:n=ge.a.jd(B.node,B.Uj);n.nc=n.Ob=B.rp();Q=new Ph.Selection([n],!0);this.pb.Uc(Q);break;case 2:n=ge.a.jd(d.node,d.Yp);n.nc=n.Ob=d.vp();Q=new Ph.Selection([n],
!0);this.pb.Uc(Q);break;default:F.ULS.sendTraceTag(17094670,369,10,"The type of selectionMode is undefined!"),pc.a.Cd()}}w6c(d){return new Kx.a(this.gf.Xk(this.rI.aq(d),!0,!1))}Hwd(d){this.pb.B6h()||this.pb.Uc(d.restore())}TDi(d,n,B){var Q,ha=this.jSm(d,n,B);B=this.Mxm(d,n,B);if(!ha||!B)return null;ha.Ob=d.Ob;B.nc=n.nc;const Aa=new ma.a;if(ha.equals(B))return ha.nc=B.nc,Aa.add(ha),Aa;Aa.add(ha);const bb=this.qb.xz(ha.node);if(ha.node.id.equals(B.node.id))return ha.contextId===ed.a.Nd&&ha.cpEnd===
this.qb.textLength(ha.node)&&B.contextId===ed.a.od&&(ha.nc=Math.min(bb,B.nc),B.nc=B.Ob=B.nc),Aa.add(B),Aa;ha.nc=bb;B.Ob=this.qb.jA(B.node);ha.contextId===ed.a.Nd&&(ha=ge.a.Pm(ha.node),ha.nc=ha.Ob=bb,Aa.add(ha));d=d.node;n=n.node;do d=null!==(Q=this.qb.Cg(d,!1,!0))&&void 0!==Q?Q:this.dIm(d),d.id.equals(n.id)||(ha=ge.a.create(d),ha.Ob=this.qb.jA(ha.node),ha.nc=this.qb.xz(ha.node),Aa.add(ha));while(!d.id.equals(n.id));Aa.add(B);return Aa}jSm(d,n,B){if(!d||!n)return null;if(d.node.id.equals(n.node.id)){if(n.cpBegin===
this.qb.textLength(n.node)&&B){if(d.cpBegin===n.cpBegin)return ge.a.Pm(d.node);if(!d.cpBegin)return ge.a.create(d.node)}return d.cpBegin===n.cpBegin?ge.a.jd(d.node,d.cpBegin):ge.a.createTextRange(d.node,d.cpBegin,n.cpBegin)}return d.cpBegin?d.cpBegin===this.qb.textLength(d.node)?ge.a.Pm(d.node):ge.a.createTextRange(d.node,d.cpBegin,this.qb.textLength(d.node)):ge.a.create(d.node)}Mxm(d,n,B){return d&&n?d.node.id.equals(n.node.id)?n.cpBegin===this.qb.textLength(n.node)&&B?d.cpBegin||d.cpBegin===n.cpBegin?
ge.a.Pm(d.node):ge.a.create(d.node):d.cpBegin===n.cpBegin?ge.a.jd(d.node,d.cpBegin):ge.a.createTextRange(d.node,d.cpBegin,n.cpBegin):B?ge.a.create(n.node):n.cpBegin?ge.a.createTextRange(n.node,0,n.cpBegin):ge.a.jd(n.node,0):null}dIm(d){if(!pc.a.Hgi())return null;d=vc.a.kb(d);if(!d.Ib(37))return null;d.xd(38);return(d=d.xl())?this.qb.Vn(d):null}}Object(D.a)(uF,"SelectionApiHelper",null,[1032]);class Lx{constructor(){this.aAd=new bm;this.YNe=new Pd}WCa(d,n){if(!d)return null;if(d.rK)return this.WCa(d.rK,
n);if(!d.qoa)return null;const B=new vc.a;B.set(n);for(n=B.ic(19);n;){const Q=this.i_c(n);if(Q&&Q.nZh(d))return n;n=B.gg(19)}return null}fvb(d,n){d||pc.a.vg();if(d.rK)return this.fvb(d.rK,n);if(d.qoa){const B=this.Nwf(d);this.uhf(B,d,n);return B}return null}bxf(d,n){const B=this.YNe.create(Fc.a.ZMb);B.setValue(Dd.a.aWc,d);B.setValue(Dd.a.Afc,n);return B}Usb(d,n){const B=new vc.a;B.set(d.value);return n.bU(B)&&B.ic(18)?B:null}i_c(d){const n=d.getValue(Dd.a.PVa),B=d.getValue(Dd.a.bWc),Q=d.getValue(Dd.a.Lob),
ha=d.getValue(Dd.a.$Mb),Aa=d.getValue(Dd.a.$Vc),bb=d.getValue(Dd.a.Mob),Ib=d.ka($m.a.inf,null),oc=d.ka($m.a.jnf,0);d=d.id.toString();let Ac=null;Aa||(Ac=new Fb(d,d,n,B,Q,ha,bb,!0,Ib,oc));return Ac}Nwf(d){const n=this.aAd.create(Fc.a.mKa);n.setValue(Dd.a.PVa,d.$n);n.setValue(Dd.a.bWc,d.version);n.setValue(Dd.a.Lob,d.store);n.setValue(Dd.a.$Mb,d.storeType);n.setValue(Dd.a.Mob,d.cWc);n.setValue(Dd.a.$Vc,!1);n.setValue(Dd.a.YWh,!1);n.setValue(Dd.a.dXh,"");n.setValue(Dd.a.iXh,"right");n.setValue(Dd.a.lXh,
350);n.setValue(Dd.a.kXh,1);n.setValue(Dd.a.jXh,!1);return n}uhf(d,n,B){const Q=new vc.a;Q.set(B);d.anchor?pc.a.Cd():(n=Jh.a.Of(n.cXh),Ze.a.compare(n.gv,Ze.a.nil)&&(n=new Jh.a(Ze.a.create(),1)),Q.a8(d,19,n))}}Object(D.a)(Lx,"SettingOperations",null,[1034]);var TM=e(912);class Mx{constructor(d,n,B,Q,ha,Aa){this.yd=null;this.Vk=d;this.ga=n;this.qb=B;this.Lqa=Q;this.vB=ha;this.Asa=Aa;this.H7a=new fa.a(()=>this.vB.pNi());this.qEh=new fa.a(()=>{const bb=new ff.a,Ib=this.Vk.HPf(),oc=this.Vk.tae();for(const Ac of Ib.keys)bb.add(Ac,
Ib.K(Ac));for(const Ac of oc.keys)bb.add(Ac,oc.K(Ac));return bb})}get Zf(){return null!=this.M9g?this.M9g:this.M9g=Wa.a.instance.Wa("Box4.Styles.StyleSettings")}Vu(d){this.yd=d}b6c(d){let n="";for(let B=0;B<d.count;B++){if(!this.J4f(d.K(B).contextId))continue;const Q=this.$Di(d.K(B));""===n&&""!==Q&&(n=Q);if(Q!==n)return""}return n}$Di(d){if(!this.J4f(d.contextId))return"";const n=new TM.a;return 2===this.ga.Sf(d,Se.a.Zwa,2,!1,new ut.a,n)?this.$Di(ge.a.create(d.node)):n.Zxa.getValue(Ya.a.la)}U9d(d){d=
this.b6c(d).toLowerCase();return d in Mx.lLb?Mx.lLb[d]:-1}hNi(d){d=this.vB.VI(d);return this.vB.Ibe(d)}NTm(d){d=this.hNi(d).toLowerCase();return d in Mx.lLb?Mx.lLb[d]:-1}RVj(d,n){pc.a.iEc(n,"Table.Style/Table.StyleBuiltIn");n=this.DAj(n);const B=this.vB.cUm(n);B?(n=this.vB.xbe(d,B),this.Asa.z2b(n,d)):this.Ozc(this.qb.LC(d,!0,!1),n)}t6o(d,n){n=this.LGi(n);this.RVj(d,n)}Ozc(d,n){if(this.Lqa.cYc(d,0)){n=this.DAj(n);var B=this.Vk.Il();this.Zf.zl?(n=B.Ev().Ena(n),B=B.Qg(qj.a.kc.Je(n))):B=B.Rua(n);B||(F.ULS.sendTraceTag(17334858,
369,15,"The style is not supported on word wac."),pc.a.Cd());if(3===this.Vk.wH(B)){var Q=this.yd.PAi(d.K(0).node);d=this.yd.PAi(d.K(d.count-1).node);Q&&d&&Q.id===d.id?this.Asa.z2b(B,Q):(F.ULS.sendTraceTag(20841048,369,15,"The style only can be applied to table on word wac."),pc.a.Cd())}else for(Q of d)this.ZCg(Q,B)}}ZAe(d,n){n=this.LGi(n);this.Ozc(d,n)}LGi(d){let n="";for(const B of Object.keys(Mx.lLb))if(Mx.lLb[B]===d){n=B;break}d=n.split("-");1<d.length&&(n=d[0]+d[1].substr(1));for(const B of this.qEh.value.keys)if(B.toLowerCase()===
n)return this.qEh.value.K(B);for(const B of this.H7a.value.keys)if(B.toLowerCase()===n)return this.H7a.value.K(B);return""}ZCg(d,n){if(this.J4f(d.contextId)){var B=this.Vk.wH(n);if(2===B){if(d.contextId===ed.a.kd||d.contextId===ed.a.Nd){this.ZCg(ge.a.create(d.node),n);return}}else if(1===B){if(d.contextId===ed.a.paragraph){this.ZCg(ge.a.createTextRange(d.node,0,this.qb.textLength(d.node)),n);return}}else{F.ULS.sendTraceTag(17334859,369,10,"Table or other style is not supported on word wac.");return}n=
this.Vk.Je(n);this.ga.Sf(d,Se.a.FQ,2,!1,new ut.a,n)}}DAj(d){if(!(d.trim().toLowerCase()in Mx.lLb))return d.trim();let n="";d=d.trim().toLowerCase().split(" ");for(const B of d){for(d=0;d<B.length;d++)n=d?n+B.charAt(d):n+B.charAt(0).toUpperCase();n+=" "}return n.trimEnd()}J4f(d){switch(d){case ed.a.paragraph:case ed.a.Nd:case ed.a.kd:case ed.a.view:return!0;default:return!1}}}Mx.lLb=Zj.a.M$("other",-1,"normal",0,"heading 1",1,"heading 2",2,"heading 3",3,"heading 4",4,"heading 5",5,"heading 6",6,"heading 7",
7,"heading 8",8,"heading 9",9,"toc 1",19,"toc 2",20,"toc 3",21,"toc 4",22,"toc 5",23,"toc 6",24,"toc 7",25,"toc 8",26,"toc 9",27,"footnote text",29,"header",31,"footer",32,"caption",34,"footnote reference",38,"endnote reference",42,"endnote text",43,"title",62,"subtitle",74,"hyperlink",85,"strong",87,"emphasis",88,"no spacing",157,"list paragraph",179,"quote",180,"intense quote",181,"subtle emphasis",260,"intense emphasis",261,"subtle reference",262,"intense reference",263,"book title",264,"bibliography",
265,"toc heading",266,"table grid",154,"plain table 1",267,"plain table 2",268,"plain table 3",269,"plain table 4",270,"plain table 5",271,"table grid light",272,"grid table 1 light",111,"grid table 1 light - accent 1",280,"grid table 1 light - accent 2",287,"grid table 1 light - accent 3",294,"grid table 1 light - accent 4",301,"grid table 1 light - accent 5",308,"grid table 1 light - accent 6",315,"grid table 2",274,"grid table 2 - accent 1",281,"grid table 2 - accent 2",288,"grid table 2 - accent 3",
295,"grid table 2 - accent 4",302,"grid table 2 - accent 5",309,"grid table 2 - accent 6",316,"grid table 3",275,"grid table 3 - accent 1",282,"grid table 3 - accent 2",289,"grid table 3 - accent 3",296,"grid table 3 - accent 4",303,"grid table 3 - accent 5",310,"grid table 3 - accent 6",317,"grid table 4",276,"grid table 4 - accent 1",283,"grid table 4 - accent 2",290,"grid table 4 - accent 3",297,"grid table 4 - accent 4",304,"grid table 4 - accent 5",311,"grid table 4 - accent 6",318,"grid table 5 dark",
277,"grid table 5 dark - accent 1",284,"grid table 5 dark - accent 2",291,"grid table 5 dark - accent 3",298,"grid table 5 dark - accent 4",305,"grid table 5 dark - accent 5",312,"grid table 5 dark - accent 6",319,"grid table 6 colorful",278,"grid table 6 colorful - accent 1",285,"grid table 6 colorful - accent 2",292,"grid table 6 colorful - accent 3",299,"grid table 6 colorful - accent 4",306,"grid table 6 colorful - accent 5",313,"grid table 6 colorful - accent 6",320,"grid table 7 colorful",279,
"grid table 7 colorful - accent 1",286,"grid table 7 colorful - accent 2",293,"grid table 7 colorful - accent 3",300,"grid table 7 colorful - accent 4",307,"grid table 7 colorful - accent 5",314,"grid table 7 colorful - accent 6",321,"list table 1 Light",322,"list table 1 light - accent 1",329,"list table 1 light - accent 2",336,"list table 1 light - accent 3",343,"list table 1 light - accent 4",350,"list table 1 light - accent 5",357,"list table 1 light - accent 6",364,"list table 2",323,"list table 2 - accent 1",
330,"list table 2 - accent 2",337,"list table 2 - accent 3",344,"list table 2 - accent 4",351,"list table 2 - accent 5",358,"list table 2 - accent 6",365,"list table 3",324,"list table 3 - accent 1",331,"list table 3 - accent 2",338,"list table 3 - accent 3",345,"list table 3 - accent 4",352,"list table 3 - accent 5",359,"list table 3 - accent 6",366,"list table 4",325,"list table 4 - accent 1",332,"list table 4 - accent 2",339,"list table 4 - accent 3",346,"list table 4 - accent 4",353,"list table 4 - accent 5",
360,"list table 4 - accent 6",367,"list table 5 dark",326,"list table 5 dark - accent 1",333,"list table 5 dark - accent 2",340,"list table 5 dark - accent 3",347,"list table 5 dark - accent 4",354,"list table 5 Dark - accent 5",361,"list table 5 Dark - accent 6",368,"list table 6 colorful",327,"list table 6 colorful - accent 1",334,"list table 6 colorful - accent 2",341,"list table 6 colorful - accent 3",348,"list table 6 colorful - accent 4",355,"list table 6 colorful - accent 5",362,"list table 6 colorful - accent 6",
369,"list table 7 colorful",328,"list table 7 colorful - accent 1",335,"list table 7 colorful - accent 2",342,"list table 7 colorful - accent 3",349,"list table 7 colorful - accent 4",356,"list table 7 colorful - accent 5",363,"list table 7 colorful - accent 6",370);Object(D.a)(Mx,"StyleApiHelper",null,[1033]);var Rw;(function(d){d[d.top=0]="top";d[d.left=1]="left";d[d.bottom=2]="bottom";d[d.right=3]="right";d[d.qYi=4]="insideHorizontal";d[d.rYi=5]="insideVertical";d[d.Icq=6]="inside";d[d.Yvj=7]=
"outside";d[d.all=8]="all"})(Rw||(Rw={}));Object(D.b)("BorderLocation",Rw);class Nx extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad){super();this.eY=[0,2,1,3];this.ng=d;this.gjb=n;this._context=B;this.td=Q;this.pi=ha;this.YF=Aa;this.vB=bb;this.Im=Ib;this.Q7=oc;this.T6=Ac;this.Asa=ad;this.TOe=new fa.a(()=>this.Spm());this.SOe=new fa.a(()=>this.Qpm())}get color(){return this.JRf(3).toUpperCase()}set color(d){d=pc.a.yya(d,"TableBorder.Color",this._context);this.iEg(3,d)}get type(){let d=this.JRf(2);
d||(d="mixed");return this.TOe.value.K(d)}set type(d){-1===d&&pc.a.Cd();this.iEg(2,this.Rpm(d))}get width(){let d=this.JRf(1);d||(d="0");return parseFloat(d)}set width(d){pc.a.D3a(d,"TableBorder.Width");12<d&&pc.a.Cd();this.iEg(1,d.toString())}get _ReferenceId(){return this.kp?this.Jp:null}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.ng,"TableBorder")}getTypeName(){return"Microsoft.WordServices.TableBorder"}invokePropertyGet(d){switch(d){case 2:return this.color;case 3:return this.type;case 4:return this.width;
case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 2:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 3:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}JRf(d){switch(this.ng.type){case 16:return this.vha(this.ng,this.gjb,d);case 15:return this.pDa(this.ng,this.gjb,d);case 14:return this.ng.hasProperty(Dd.a.eqa)?this.Tua(this.ng,this.gjb,d):this.mbb(this.ng,this.gjb,d);default:return F.ULS.sendTraceTag(20828692,369,10,"AppId:{0}, The node type is invalid when get table border",this._context.appId),pc.a.vg(),null}}vha(d,n,B){let Q=null;switch(n){case 8:case 7:Q=this.XJm(d,B);break;case 1:case 3:case 0:case 2:Q=
this.vB.pxm(Jw.a.dIf(),d,this.SOe.value.K(Rw[n]),B);3===B&&Q===Gi.a.l4&&(Q="#000000");break;default:F.ULS.sendTraceTag(20828693,369,15,"AppId:{0}, The border location is invalid when get table cell border",this._context.appId),pc.a.Cd()}return Q}pDa(d,n,B){var Q=null;switch(n){case 1:case 3:Q=this.td.Ag(d);1===n?this.Im.Rne(Q):this.Im.Bcg(Q);Q=this.vha(Q.currentNode,n,B);break;case 0:case 2:var ha=this.YF.UD(d);Q=this.vha(ha.K(0),n,B);for(d=1;d<ha.count;d++)if(Q!==this.vha(ha.K(d),n,B))return this.qha(B);
break;case 6:case 5:ha=this.YF.UD(d);1===ha.count&&(F.ULS.sendTraceTag(20828694,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),pc.a.Cd());Q=this.vha(ha.K(0),3,B);if(this.ng.hasProperty(Dd.a.eqa))for(n=1;n<ha.count;n++)if(Q!==this.vha(ha.K(n),1,B))return this.qha(B);for(n=1;n<ha.count-1;n++)if(Q!==this.vha(ha.K(n),3,B))return this.qha(B);break;case 7:Q=this.pDa(d,this.eY[0],B);for(ha=1;ha<this.eY.length;ha++)if(Q!==this.pDa(d,this.eY[ha],B))return this.qha(B);
break;case 8:Q=this.pDa(d,7,B);ha=this.YF.UD(d);if(1<ha.count&&Q!==this.pDa(d,6,B))return this.qha(B);break;default:F.ULS.sendTraceTag(20828695,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),pc.a.Cd()}return Q}mbb(d,n,B){var Q=null,ha;let Aa;switch(n){case 1:case 3:d=this.pi.kA(d,0,this.pi.Hg(d)-1);Q=this.pDa(d.K(0),n,B);if(this.YVb(Q))break;for(ha=1;ha<d.count;ha++)if(Q!==this.pDa(d.K(ha),n,B))return this.qha(B);break;case 0:case 2:Q=this.td.Ag(d);
n?this.Im.Dcg(Q):this.Im.tYb(Q);Q=this.pDa(Q.currentNode,n,B);break;case 4:ha=this.pi.Hg(d);1>=ha&&(F.ULS.sendTraceTag(20828696,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),pc.a.Cd());d=this.pi.kA(d,0,ha-1);Q=this.pDa(d.K(0),2,B);if(this.YVb(Q))break;for(n=1;n<ha-1;n++)if(Q!==this.pDa(d.K(n),2,B))return this.qha(B);break;case 5:Aa=this.pi.Nh(d);1>=Aa&&(F.ULS.sendTraceTag(20828697,369,15,"AppId:{0}, The border location is invalid when get table border",
this._context.appId),pc.a.Cd());ha=this.pi.Hg(d);d=this.pi.kA(d,0,ha-1);Q=this.pDa(d.K(0),n,B);if(this.YVb(Q))break;for(ha=1;ha<d.count;ha++)if(Q!==this.pDa(d.K(ha),n,B))return this.qha(B);break;case 6:ha=this.pi.Hg(d);Aa=this.pi.Nh(d);if(1===Aa&&1===ha)F.ULS.sendTraceTag(20828698,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),pc.a.Cd();else if(1===Aa)Q=this.mbb(d,4,B);else if(1===ha)Q=this.mbb(d,5,B);else if(Q=this.mbb(d,4,B),!this.YVb(Q)&&Q!==this.mbb(d,
5,B))return this.qha(B);break;case 7:Q=this.mbb(d,this.eY[0],B);if(this.YVb(Q))break;for(n=1;n<this.eY.length;n++)if(Q!==this.mbb(d,this.eY[n],B))return this.qha(B);break;case 8:if(Q=this.mbb(d,7,B),!this.YVb(Q)&&(1<this.pi.Nh(d)||1<this.pi.Hg(d))&&Q!==this.mbb(d,6,B))return this.qha(B)}return Q}Tua(d,n,B){let Q=null;switch(n){case 1:case 3:case 0:case 2:case 4:case 5:Q=this.vB.u9d(Jw.a.dIf(),d,this.SOe.value.K(Rw[n]),B);3===B&&Q===Gi.a.l4&&(Q="#000000");break;case 6:Q=this.Tua(d,4,B);if(Q!==this.Tua(d,
5,B))return this.qha(B);break;case 7:Q=this.Tua(d,this.eY[0],B);for(n=1;n<this.eY.length;n++)if(Q!==this.Tua(d,this.eY[n],B))return this.qha(B);break;case 8:if(Q=this.Tua(d,7,B),!this.YVb(Q)&&Q!==this.Tua(d,6,B))return this.qha(B)}return Q}XJm(d,n){const B=this.vha(d,this.eY[0],n);for(let Q=1;Q<this.eY.length;Q++)if(B!==this.vha(d,this.eY[Q],n))return this.qha(n);return B}qha(d){switch(d){case 2:return"mixed";case 1:return"0";case 3:return""}return null}YVb(d){return"0"===d||"mixed"===d||""===d}iEg(d,
n){switch(this.ng.type){case 16:var B=this.td.Ag(this.ng);B.Ib(14);B=this.Im.yMa(B);this.OBe(this.ng,this.gjb,d,n,!B.hasProperty(Dd.a.eqa));break;case 15:this.$Ab(this.ng,this.gjb,d,n,!this.ng.hasProperty(Dd.a.eqa));break;case 14:this.ng.hasProperty(Dd.a.eqa)?this.$zc(this.ng,this.gjb,d,n):this.A2b(this.ng,this.gjb,d,n);break;default:F.ULS.sendTraceTag(20841049,369,10,"AppId:{0}, The node type is invalid when setting table border",this._context.appId),pc.a.vg()}}OBe(d,n,B,Q,ha=!0){switch(n){case 0:case 2:case 1:case 3:this.MVj(d,
n,B,Q,ha);break;case 8:case 7:this.M3o(d,B,Q,ha);break;default:F.ULS.sendTraceTag(20841050,369,15,"AppId:{0}, The border location is invalid when setting table cell border",this._context.appId),pc.a.Cd()}}$Ab(d,n,B,Q,ha=!0){switch(n){case 1:case 3:ha=this.td.Ag(d);1===n?this.Im.Rne(ha):this.Im.Bcg(ha);this.Q7.Js(ha.currentNode)||this.OBe(ha.currentNode,n,B,Q);break;case 0:case 2:d=this.YF.UD(d);for(let Aa=0;Aa<d.count;Aa++)this.OBe(d.K(Aa),n,B,Q,ha);break;case 6:case 5:d=this.YF.UD(d);1===d.count&&
(F.ULS.sendTraceTag(20841051,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),pc.a.Cd());for(n=0;n<d.count-1;n++)this.OBe(d.K(n),3,B,Q);break;case 7:for(n=0;n<this.eY.length;n++)this.$Ab(d,this.eY[n],B,Q,ha);break;case 8:this.$Ab(d,7,B,Q,ha);this.$Ab(d,6,B,Q,ha);break;default:F.ULS.sendTraceTag(20841052,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),pc.a.Cd()}}A2b(d,n,B,Q){var ha;switch(n){case 1:case 3:d=
this.pi.kA(d,0,this.pi.Hg(d)-1);for(ha=0;ha<d.count;ha++)this.$Ab(d.K(ha),n,B,Q);break;case 0:case 2:ha=this.td.Ag(d);n?this.Im.Dcg(ha):this.Im.tYb(ha);this.$Ab(ha.currentNode,n,B,Q);break;case 4:ha=this.pi.Hg(d);1>=ha&&(F.ULS.sendTraceTag(20841053,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),pc.a.Cd());d=this.pi.kA(d,0,ha-1);for(n=0;n<ha-1;n++)this.$Ab(d.K(n),2,B,Q);break;case 5:var Aa=this.pi.Nh(d);1>=Aa&&(F.ULS.sendTraceTag(20841054,369,15,"AppId:{0}, The border location is invalid when setting table border",
this._context.appId),pc.a.Cd());ha=this.pi.Hg(d);d=this.pi.kA(d,0,ha-1);for(Aa=0;Aa<ha;Aa++)this.$Ab(d.K(Aa),n,B,Q);break;case 6:ha=this.pi.Hg(d);Aa=this.pi.Nh(d);1===Aa&&1===ha?(F.ULS.sendTraceTag(20841055,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),pc.a.Cd()):1===Aa?this.A2b(d,4,B,Q):(1!==ha&&this.A2b(d,4,B,Q),this.A2b(d,5,B,Q));break;case 7:for(n=0;n<this.eY.length;n++)this.A2b(d,this.eY[n],B,Q);break;case 8:this.A2b(d,7,B,Q),(1<this.pi.Nh(d)||
1<this.pi.Hg(d))&&this.A2b(d,6,B,Q)}}$zc(d,n,B,Q){switch(n){case 1:case 3:case 0:case 2:case 4:case 5:this.o6o(d,n,B,Q);break;case 6:this.$zc(d,4,B,Q);this.$zc(d,5,B,Q);break;case 7:for(n=0;n<this.eY.length;n++)this.$zc(d,this.eY[n],B,Q);break;case 8:this.$zc(d,6,B,Q),this.$zc(d,7,B,Q)}}MVj(d,n,B,Q,ha=!0){let Aa=null,bb=null;var Ib=null;switch(B){case 3:Aa=this.vha(d,n,2);bb=Q;Ib=this.vha(d,n,1);break;case 1:Aa=this.vha(d,n,2);bb=pc.a.yya(this.vha(d,n,3),"TableBorder.Color",this._context);Ib=Q;break;
case 2:Aa=Q,bb=pc.a.yya(this.vha(d,n,3),"TableBorder.Color",this._context),Ib=this.vha(d,n,1)}B=parseInt(bb,16);Ib=parseFloat(Ib);this.jEg(d,n,Aa,Ib,B);ha&&(n=({E9k:d}=this.Ymm(d,n)).returnValue)&&this.jEg(n,d,Aa,Ib,B)}jEg(d,n,B,Q,ha,Aa=!0){n=this.SOe.value.K(Rw[n]);Aa=Aa?this.T6.wT(n):this.T6.$Q(n);Aa||(F.ULS.sendTraceTag(20841056,369,10,"AppId:{0}, The border property definition is invalid when setting table border",this._context.appId),pc.a.vg());this.Asa.zZo(d,Aa,B,Q,ha)}Ymm(d,n){d=this.td.Ag(d);
d.Ib(14);let B=null,Q=0;switch(n){case 0:B=this.Im.Lkj(d);Q=2;break;case 2:B=this.Im.Gcg(d);Q=0;break;case 1:this.Q7.goa(d)||(B=this.Im.Ecg(d,!0),Q=3);break;case 3:this.Q7.cia(d)||(B=this.Im.Ecg(d,!1),Q=1)}return{returnValue:B,E9k:Q}}M3o(d,n,B,Q=!0){for(let ha=0;ha<this.eY.length;ha++)this.MVj(d,this.eY[ha],n,B,Q)}Rpm(d){for(const n of this.TOe.value.keys)if(this.TOe.value.K(n)===d)return n;return""}o6o(d,n,B,Q){let ha=null,Aa=null,bb=null;switch(B){case 3:ha=this.Tua(d,n,2);Aa=Q;bb=this.Tua(d,n,
1);break;case 1:ha=this.Tua(d,n,2);Aa=pc.a.yya(this.Tua(d,n,3),"TableBorder.Color",this._context);bb=Q;break;case 2:ha=Q,Aa=pc.a.yya(this.Tua(d,n,3),"TableBorder.Color",this._context),bb=this.Tua(d,n,1)}this.jEg(d,n,ha,parseFloat(bb),parseInt(Aa,16),!1)}Qpm(){const d=new ff.a;d.W("top",5);d.W("left",3);d.W("bottom",0);d.W("right",4);d.W("insideHorizontal",1);d.W("insideVertical",2);return d}Spm(){const d=new ff.a;d.W("mixed",-1);d.W("none",0);d.W("single",1);d.W("double",3);d.W("dotted",6);d.W("dashed",
7);d.W("dotDash",8);d.W("dotDotDash",9);d.W("triple",10);d.W("thinThickSmallGap",11);d.W("thickThinSmallGap",12);d.W("thinThickThinSmallGap",13);d.W("thinThickMediumGap",14);d.W("thickThinMediumGap",15);d.W("thinThickThinMediumGap",16);d.W("thinThickLargeGap",17);d.W("thickThinLargeGap",18);d.W("thinThickThinLargeGap",19);d.W("wave",20);d.W("doubleWave",21);d.W("dashSmallGap",22);d.W("dashDotStroked",23);d.W("threeDEmboss",24);d.W("threeDEngrave",25);return d}}Object(D.a)(Nx,"TableBorder",rh.a,[866]);
class tv{constructor(d,n,B,Q,ha,Aa,bb,Ib){this.td=d;this.pi=n;this.YF=B;this.vB=Q;this.Im=ha;this.T6=bb;this.Asa=Ib;Aa&&Aa.execute(oc=>{null==oc?F.ULS.sendTraceTag(523580866,324,10,"ITableCellReader is null after future execution"):this.Q7=oc})}create(d,n,B){return new Nx(d,n,B,this.td,this.pi,this.YF,this.vB,this.Im,this.Q7,this.T6,this.Asa)}}Object(D.a)(tv,"TableBorderFactory",null,[]);class ws extends rh.a{constructor(d,n,B,Q,ha,Aa){super();this.tLb=null;this.Jh=d;this.G7a=n;this.Rvk=B;this._context=
Q;this.yd=ha;this.pi=Aa}length(){return this.tLb.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){this.fek();return this.tLb&&this.length()?this.tLb.K(0):null}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.tLb.K(d);F.ULS.sendTraceTag(19969494,369,10,"The index is out of the table row range.");pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){this.fek();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,
n,this))}getTypeName(){return"Microsoft.WordServices.TableRowCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}fek(){switch(this.Rvk){case 1:let n=null,B=null;for(var d=0;d<this.G7a.count;d++)if(this.G7a.K(d).isConnected){n=this.G7a.K(d);break}for(d=this.G7a.count-1;0<=d;d--)if(this.G7a.K(d).isConnected){B=this.G7a.K(d);break}if(!n&&!B){this.G7a.clear();this.tLb.clear();break}this.G7a=this.pi.FQf(this.Jh,n,B);this.tLb=this.yd.mNi(this.G7a,this._context);break;case 0:this.tLb=this.yd.mNi(this.pi.kA(this.Jh,0,this.pi.Hg(this.Jh)-1),this._context);break;default:F.ULS.sendTraceTag(20756162,
369,10,"AppId:{0}, something went wrong when refresh the table row collection.",this._context.appId)}}}Object(D.a)(ws,"TableRowCollection",rh.a,[866,893]);class PH extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd){super();pc.a.ARa(d,"TableCell");this.nC=d;this._context=n;this._id=B;this.Wfa=Q;this.eS=ha;this.td=Aa;this.BJa=bb;this.Im=Ib;this.Q7=oc;this.yd=Ac;this.pi=ad;this.ysa=sd;this.tI=wd}get body(){return this.eS.create(this.nC,this._context)}get cellIndex(){return this.yd.crm(this.nC)}get columnWidth(){var d=
this.yd.S4(this.nC);if(this.pi.sF(d))return null;var n=this.td.Ag(this.nC);n.Ib(14);n=this.ysa.j5c(n);d=this.ysa.N8d(d);return-1===d[n]?0:Mi.a.Ydb(d[n])}set columnWidth(d){pc.a.D3a(d,"TableCell.ColumnWidth");const n=this.yd.S4(this.nC);this.pi.sF(n)&&pc.a.vg();var B=this.td.Ag(this.nC);B.Ib(14);B=this.ysa.j5c(B);var Q=this.td.Ag(n);let ha=0;if(Q.Ib(14)){let Aa;const bb=({ovd:Aa}=this.yd.B7c(n)).returnValue;Aa&&!this.yd.kSi(bb)||pc.a.vg();Q=this.yd.oLf(Q)-Aa+bb[B];0<Q?ha=Math.min(Mi.a.Rwa(d),Q):pc.a.vg()}else ha=
Mi.a.Rwa(d);this.tI.Gxa(n,B,ha)}get horizontalAlignment(){return this.yd.BNf(this.nC)}set horizontalAlignment(d){this.yd.bDg(this.nC,d)}get parentRow(){return this.yd.DLm(this.nC,this._context)}get parentTable(){return this.yd.Mtb(this.nC,this._context)}get rowIndex(){return this.yd.fv(this.nC)}get shadingColor(){let d=this.yd.bRf(this.nC);return null!=d?d:""}set shadingColor(d){d=pc.a.yya(d,"TableCell.ShadingColor",this._context);this.yd.YDg(this.nC,d)}get value(){return this.yd.SSf(this.nC)}set value(d){this.yd.AEg(this.nC,
d)}get verticalAlignment(){return this.yd.TSf(this.nC)}set verticalAlignment(d){this.yd.CEg(this.nC,d)}get width(){return Mi.a.Ydb(this.yd.A7c(this.nC))}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}deleteColumn(){const d=this.yd.S4(this.nC);this.pi.sF(d)&&pc.a.vg();this.yd.Dji(this.nC)}deleteRow(){var d=this.td.Ag(this.nC);d.Ib(15);d=this.Im.Vyg(d);this.yd.Azf(d)}getBorder(d){return this.BJa.create(this.nC,d,this._context)}getCellPadding(d){switch(d){case 1:return this.yd.E$d(this.nC);
case 3:return this.yd.cbe(this.nC);case 0:return this.yd.tSf(this.nC);case 2:return this.yd.xKf(this.nC);default:return pc.a.Cd(),null}}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){let d=null;const n=this.td.Ag(this.nC);n.Ib(14);this.Q7.cia(n)||(d=this.Im.Ecg(n,!1));return d?this.Wfa.create(d,this._context):null}insertColumns(d,n,B){const Q=this.td.Ag(this.nC);Q.Ib(14);const ha=this.yd.S4(this.nC);this.pi.sF(ha)&&(F.ULS.sendTraceTag(20758723,369,15,"The table is complex table when insert columns"),
pc.a.vg());this.Im.tYb(Q);this.yd.insertColumns(n,Q,d,B,this._context)}insertRows(d,n,B){pc.a.D3a(n,"TableCell.InsertRows()");const Q=this.td.Ag(this.nC);Q.Ib(14);this.Im.Vyg(Q);d=this.yd.insertRows(n,Q,d,B,this._context);this.Im.Sye(Q);return new ws(Q.currentNode,d,1,this._context,this.yd,this.pi)}setCellPadding(d,n){this.yd.setCellPadding(this.nC,d,n)}split(d,n){if(0>=d||32767<d||0>=n||63<n)F.ULS.sendTraceTag(521483540,369,15,"The row/column count exceeds the maxium column size"),pc.a.Cd();const B=
{};B.rows=d;B.columns=n;this.yd.CQa(this.nC,B)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.nC,"TableCell")}getTypeName(){return"Microsoft.WordServices.TableCell"}invokePropertyGet(d){switch(d){case 8:return this.body;case 6:return this.cellIndex;case 15:return this.columnWidth;case 12:return this.horizontalAlignment;case 4:return this.parentRow;case 3:return this.parentTable;case 5:return this.rowIndex;case 9:return this.shadingColor;case 7:return this.value;case 14:return this.verticalAlignment;
case 16:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 15:this.columnWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number?");return;case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return;case 9:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 14:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1007:return this.rWl();case 1006:return this.dXl();case 1008:return this.X4c(n);case 1023:return this.d5c(n);case 1011:return this.b9();case 1012:return this.c9();case 1004:return this.zgn(n);case 1003:return this.vZf(n);case 1024:return this.Tqd(n);case 1005:return this.t3b(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}rWl(){this.deleteColumn();
return null}dXl(){this.deleteRow();return null}X4c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}d5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getCellPadding(d)}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}zgn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
2,"Array<Array<string>>");this.insertColumns(n,B,d);return null}vZf(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");return this.insertRows(n,B,d)}Tqd(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");this.setCellPadding(n,
d);return null}t3b(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.split(n,d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(PH,"TableCell",rh.a,[866]);class qD{constructor(d,n,B,Q,ha,Aa,bb){this.yd=this.eS=null;this.td=d;this.BJa=n;this.Im=B;this.pi=ha;this.ysa=Aa;this.tI=bb;Q&&Q.execute(Ib=>{null==Ib?F.ULS.sendTraceTag(523580865,324,10,"ITableCellReader is null after future execution"):
this.Q7=Ib})}Vu(d,n){this.yd=d;this.eS=n}create(d,n,B=0){return new PH(d,n,B,this,this.eS,this.td,this.BJa,this.Im,this.Q7,this.yd,this.pi,this.ysa,this.tI)}}Object(D.a)(qD,"TableCellFactory",null,[1011]);var Cp=e(903);class vF extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi,oi,Ni){super();pc.a.ARa(d,"Table");this.Jh=d;this._context=n;this._id=B;this.ME=Aa;this.vdc=Q;this.Wfa=ha;this.td=bb;this.Ip=Ib;this.Jk=oc;this.BJa=Ac;this.Am=ad;this.tI=sd;this.pi=
wd;this.yd=yd;this.YF=be;this.wD=Qf;this.vB=ye;this.Asa=Qe;this.qb=af;this.Im=vj;this.nd=hf;this.uh=di;this.Wr=Wk;this.CHa=Tm;this.km=Dk;this.gJa=gi;this.yD=oi;this.Tz=Ni}oGa(d){this.Asa.oGa(d,this.Jh)}get alignment(){return this.yd.dnm(this.Jh)}set alignment(d){this.yd.TYo(this.Jh,d)}get endnotes(){var d=this.nd.omc(this.Jh,1);d=this.nd.fCa(d,this._context);return new wt(d)}get fields(){return new Tu(this.Tz.cDi(this.Jh,this._context,!1))}get font(){return this.ME.create(5,this.Jh,null,null,this._context)}get footnotes(){var d=
this.nd.omc(this.Jh,0);d=this.nd.fCa(d,this._context);return new wt(d)}get headerRowCount(){return this.tI.Nab(this.Jh)}set headerRowCount(d){var n=this.pi.Hg(this.Jh);if(0>d||d>n)F.ULS.sendTraceTag(20833941,369,15,"Invalid HeaderRowCount when set Table.HeaderRowCount."),pc.a.Cd();var B=d;n=this.pi.kA(this.Jh,0,n-1);for(const Q of n)n=Q.ka(Dd.a.Awb,!1),0<B?n||Q.setValue(Dd.a.Awb,!0):n&&Q.setValue(Dd.a.Awb,!1),B--;B=this.vB.Q4(this.Jh);this.oGa(d?B|32:B&-33)}get horizontalAlignment(){return this.yd.ETb(this.Jh,
Object(X.a)(this.yd,this.yd.BNf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(d){this.yd.bDg(this.Jh,d)}get isUniform(){return!this.pi.sF(this.Jh)}get nestingLevel(){return this.yd.fNi(this.Jh)}get parentBody(){return this.yd.JPf(this.Jh,this._context)}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||pc.a.tl();return d}get parentContentControlOrNullObject(){const d=ge.a.create(this.qb.Vn(this.Jh)),n=ge.a.create(this.qb.vH(this.Jh));this.nd.pRa(d,n);
return this.uh.xnc(d,n,this._context)}get parentTable(){const d=this.parentTableOrNullObject;d||pc.a.tl();return d}get parentTableCell(){const d=this.parentTableCellOrNullObject;d||pc.a.tl();return d}get parentTableCellOrNullObject(){return this.yd.$mc(this.Jh,this._context)}get parentTableOrNullObject(){return this.yd.Mtb(this.Jh,this._context)}get rowCount(){return this.pi.Hg(this.Jh)}get rows(){return new ws(this.Jh,null,0,this._context,this.yd,this.pi)}get shadingColor(){return this.yd.ETb(this.Jh,
Object(X.a)(this.yd,this.yd.bRf,"getShadingColorOfTableCellNode"),"")}set shadingColor(d){d=pc.a.yya(d,"Table.ShadingColor",this._context);this.yd.YDg(this.Jh,d)}get style(){return this.yD.hNi(this.Jh)}set style(d){this.yD.RVj(this.Jh,d)}get styleBandedColumns(){return this.vB.Q4(this.Jh)&1024?!1:!0}set styleBandedColumns(d){let n=this.vB.Q4(this.Jh);this.oGa(d?n&-1025:n|1024)}get styleBandedRows(){return this.vB.Q4(this.Jh)&512?!1:!0}set styleBandedRows(d){let n=this.vB.Q4(this.Jh);this.oGa(d?n&
-513:n|512)}get styleBuiltIn(){return this.yD.NTm(this.Jh)}set styleBuiltIn(d){this.yD.t6o(this.Jh,d)}get styleFirstColumn(){return this.vB.Q4(this.Jh)&128?!0:!1}set styleFirstColumn(d){let n=this.vB.Q4(this.Jh);this.oGa(d?n|128:n&-129)}get styleLastColumn(){return this.vB.Q4(this.Jh)&256?!0:!1}set styleLastColumn(d){let n=this.vB.Q4(this.Jh);this.oGa(d?n|256:n&-257)}get styleTotalRow(){return this.vB.Q4(this.Jh)&64?!0:!1}set styleTotalRow(d){let n=this.vB.Q4(this.Jh);this.oGa(d?n|64:n&-65)}get tables(){return new Qq(5,
this.Jh,null,null,this._context,this.yd)}get values(){return this.yd.ZOi(this.Jh)}set values(d){this.yd.qWj(this.Jh,d)}get verticalAlignment(){return this.yd.ETb(this.Jh,Object(X.a)(this.yd,this.yd.TSf,"getVerticalAlignmentOfTableCellNode"),-1)}set verticalAlignment(d){this.yd.CEg(this.Jh,d)}get width(){let d=0;({ovd:d}=this.yd.B7c(this.Jh));return Mi.a.Ydb(d)}set width(d){pc.a.D3a(d,"Table.Width");var n;const B=({ovd:n}=this.yd.B7c(this.Jh)).returnValue;var Q=this.td.Ag(this.Jh);d=Q.Ib(14)?Math.min(Mi.a.Rwa(d),
this.yd.oLf(Q)):Mi.a.Rwa(d);if(n)for(Q=0;Q<B.length;Q++)this.CHa.Gxa(this.Jh,Q,B[Q]/n*d);else for(n=0;n<B.length;n++)this.CHa.Gxa(this.Jh,n,d/B.length)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}addColumns(d,n,B){this.pi.sF(this.Jh)&&(F.ULS.sendTraceTag(20758721,369,15,"The table is complext table when add columns"),pc.a.vg());const Q=this.td.Ag(this.Jh);this.Im.tYb(Q);switch(d){case 2:d=0;this.Im.Rne(Q);break;case 3:d=1;this.Im.Bcg(Q);break;default:F.ULS.sendTraceTag(20758722,
369,15,"AppId:{0}, Invalid insert location for Table.AddColumns method.",this._context.appId),pc.a.Cd()}this.yd.insertColumns(n,Q,d,B,this._context)}addRows(d,n,B){pc.a.D3a(n,"Table.AddRows()");const Q=this.td.Ag(this.Jh);switch(d){case 2:d=0;this.Im.tYb(Q);break;case 3:d=1;this.Im.Dcg(Q);break;default:F.ULS.sendTraceTag(20756128,369,15,"AppId:{0}, Invalid insert location for Table.Addrows method.",this._context.appId),pc.a.Cd()}d=this.yd.insertRows(n,Q,d,B,this._context);return new ws(this.Jh,d,
1,this._context,this.yd,this.pi)}autoFitWindow(){var d=this.td.Ag(this.Jh),n=0;d.Ib(14)?n=this.yd.oLf(d):d.Ib(10)?(n=d.Gq(10),n=Mi.a.GCb(this.km.nx(n)-this.km.eP(n)-this.km.fP(n))):d.Ib(38)&&(n=d.Gq(38),n=this.gJa.rnc(n),n=Mi.a.Iha(n.DZc/96));var B;d=({ovd:B}=this.yd.B7c(this.Jh)).returnValue;if(B)for(let Q=0;Q<d.length;Q++)this.CHa.Gxa(this.Jh,Q,d[Q]/B*n);else for(B=0;B<d.length;B++)this.CHa.Gxa(this.Jh,B,n/d.length)}clear(){this.yd.f8h(this.Jh)}deleteObject(){this.yd.OY(this.Jh)}deleteColumns(d,
n){null===n&&(n=1);var B=this.pi.Nh(this.Jh);(0>d||0>=n||d+n>B)&&pc.a.Cd();this.pi.sF(this.Jh)&&pc.a.vg();if(n===B)this.yd.OY(this.Jh);else{B=this.td.Ag(this.Jh);this.Im.tYb(B);B=this.YF.UD(B.currentNode);for(let Q=d;Q<d+n;Q++)this.yd.Dji(B.K(Q))}}deleteRows(d,n){null===n&&(n=1);const B=this.pi.Hg(this.Jh);(0>d||0>=n||d+n>B)&&pc.a.Cd();if(n===B)this.yd.OY(this.Jh);else{d=this.pi.kA(this.Jh,d,d+n-1);for(const Q of d)this.yd.Azf(Q)}}distributeColumns(){this.pi.sF(this.Jh)&&pc.a.vg();let d;const n=({ovd:d}=
this.yd.B7c(this.Jh)).returnValue;n.length&&d||pc.a.vg();for(let B=0;B<n.length;B++)this.CHa.Gxa(this.Jh,B,d/n.length)}getBorder(d){return this.BJa.create(this.Jh,d,this._context)}getCell(d,n){(d=this.getCellOrNullObject(d,n))||pc.a.tl();return d}getCellOrNullObject(d,n){if(0>d||0>n||d>=this.pi.Hg(this.Jh)||n>=this.pi.Nh(this.Jh))return null;const B=this.td.Ag(this.Jh);return(d=this.Im.Kkj(B,d,n))?this.Wfa.create(d,this._context):null}getCellPadding(d){switch(d){case 1:d=this.yd.ETb(this.Jh,Object(X.a)(this.yd,
this.yd.E$d,"getLeftMarginOfTableCellNode"),-1);break;case 3:d=this.yd.ETb(this.Jh,Object(X.a)(this.yd,this.yd.cbe,"getRighttMarginOfTableCellNode"),-1);break;case 0:d=this.yd.ETb(this.Jh,Object(X.a)(this.yd,this.yd.tSf,"getTopMarginOfTableCellNode"),-1);break;case 2:d=this.yd.ETb(this.Jh,Object(X.a)(this.yd,this.yd.xKf,"getBottomMarginOfTableCellNode"),-1);break;default:return pc.a.Cd(),null}return-1===d?null:d}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){var d=
this.td.Ag(this.Jh);return(d=this.Im.rWn(d))?this.vdc.create(d,this._context):null}getParagraphAfter(){const d=this.getParagraphAfterOrNullObject();d||pc.a.tl();return d}getParagraphAfterOrNullObject(){const d=this.qb.Cg(this.Jh,!1,!0,!1);return d?this.Ip.create(d,this._context):null}getParagraphBefore(){const d=this.getParagraphBeforeOrNullObject();d||pc.a.tl();return d}getParagraphBeforeOrNullObject(){const d=this.qb.Cg(this.Jh,!0,!0,!0);return d?this.Ip.create(d,this._context):null}getRange(d){1!==
d&&2!==d&&d&&4!==d&&(F.ULS.sendTraceTag(20506275,369,15,"AppId:{0}, rangeLocation of Table.GetRange must be Start/End/Whole/After.",this._context.appId),pc.a.Cd());const n=this.qb.LC(this.Jh,!0,!1);return(d=this.Am.mSb(n,d))?this.Jk.create(d,this._context):null}insertContentControl(){return this.uh.Msa(this.nd.eic(this.qb.Vn(this.Jh),!0),this.nd.eic(this.qb.vH(this.Jh),!1),this._context)}insertParagraph(d,n){var B=!0;switch(n){case 0:n=1;break;case 1:n=0;B=!1;break;default:F.ULS.sendTraceTag(20509196,
369,15,"The type of insert location is not supported in Table.InsertParagraph: {0}.",yo.a[n]),pc.a.Cd()}var Q=this.qb.Cg(this.Jh,B,!1,!1),ha=new ma.a;ha.add(ge.a.create(this.Jh));ha=this.yd.q$d(ha,B);B=ha.node;if(Q){let Aa;B=this.nd.insertParagraph((Aa=new ma.a,Aa.add(ha),Aa),d,n)}else Q=new ma.a,Q.add(ge.a.jd(B,0)),this.nd.insertText(Q,d,n);return this.Ip.create(B,this._context)}insertTable(d,n,B,Q){const ha=new ma.a;ha.add(ge.a.create(this.Jh));return this.yd.insertTable(ha,d,n,B,Q,this._context)}mergeCells(d,
n,B,Q){var ha=this.td.Ag(this.Jh),Aa=this.td.Ag(this.Jh);const bb=this.pi.Hg(this.Jh),Ib=this.pi.Nh(this.Jh);if(d>=bb||0>d||0>n||n>=Ib||0>B||B>=bb||0>Q||Q>=Ib||B<d||Q<n)F.ULS.sendTraceTag(521483542,369,15,"Invalid Index for {0} {1} {2} {3}",d,n,B,Q),pc.a.Cd();this.Im.xcg(ha,d,n);this.Im.xcg(Aa,B,Q);B=this.Im.yMa(ha);Aa=this.pi.sF(B)?Di.SelectionFactory.agi(ha,Aa):Di.SelectionFactory.$fi(ha,Aa);Aa=te.a.zgc(Aa);Aa=Cp.a.OOf(Aa);32!==Aa.response&&(F.ULS.sendTraceTag(521483541,369,15,"get mergeCell context data fail"),
pc.a.Cd());this.yd.mergeCells(ha.currentNode,Aa);ha=this.td.Ag(this.Jh);this.Im.xcg(ha,d,n);return ha.currentNode?this.Wfa.create(ha.currentNode,this._context):null}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Jh,!0,!1);this.wD.find(Q,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Jh,!0,!1);this.wD.msb(Q,d,n,B,this._context)})}select(d){this.Wr.fGa(this.Jh,d)}setCellPadding(d,
n){this.yd.setCellPadding(this.Jh,d,n)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.Jh,"Table")}getTypeName(){return"Microsoft.WordServices.Table"}invokePropertyGet(d){switch(d){case 33:return this.alignment;case 38:return this.endnotes;case 39:return this.fields;case 24:return this.font;case 37:return this.footnotes;case 12:return this.headerRowCount;case 22:return this.horizontalAlignment;case 4:return this.isUniform;case 6:return this.nestingLevel;case 32:return this.parentBody;case 25:return this.parentContentControl;
case 36:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 7:return this.parentTableCell;case 34:return this.parentTableCellOrNullObject;case 35:return this.parentTableOrNullObject;case 11:return this.rowCount;case 3:return this.rows;case 18:return this.shadingColor;case 10:return this.style;case 17:return this.styleBandedColumns;case 16:return this.styleBandedRows;case 31:return this.styleBuiltIn;case 14:return this.styleFirstColumn;case 15:return this.styleLastColumn;
case 13:return this.styleTotalRow;case 5:return this.tables;case 9:return this.values;case 23:return this.verticalAlignment;case 27:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 33:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"int");return;case 12:this.headerRowCount=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 22:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 18:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 10:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 17:this.styleBandedColumns=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 16:this.styleBandedRows=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 31:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 14:this.styleFirstColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 15:this.styleLastColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return;case 13:this.styleTotalRow=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"boolean");return;case 9:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<Array<string>>");return;case 23:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 27:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
n){switch(d){case 1004:return this.G0k(n);case 1003:return this.B4k(n);case 1012:return this.Phl();case 1008:return this.IKa();case 1007:return this.bF(n);case 1010:return this.uWl(n);case 1009:return this.fXl(n);case 1014:return this.s1l();case 1015:return this.X4c(n);case 1005:return this.erm(n);case 1028:return this.hrm(n);case 1023:return this.d5c(n);case 1025:return this.b9();case 1029:return this.c9();case 1027:return this.HKm();case 1031:return this.IKm();case 1026:return this.KKm();case 1030:return this.LKm();
case 1019:return this.rha(n);case 1020:return this.tNa(n);case 1022:return this.lva(n);case 1021:return this.hcb(n);case 1006:return this.iTn(n);case 1017:return this.lja(n);case 1024:return this.Tqd(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){switch(d){case 1018:return this.zxa(n);case 1032:return this.Hqa(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}G0k(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");this.addColumns(n,B,d);return null}B4k(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");
return this.addRows(n,B,d)}Phl(){this.autoFitWindow();return null}IKa(){this.clear();return null}bF(){this.deleteObject();return null}uWl(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int?");this.deleteColumns(n,d);return null}fXl(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int?");this.deleteRows(n,d);
return null}s1l(){this.distributeColumns();return null}X4c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}erm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getCell(n,d)}hrm(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getCellOrNullObject(n,
d)}d5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getCellPadding(d)}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}HKm(){return this.getParagraphAfter()}IKm(){return this.getParagraphAfterOrNullObject()}KKm(){return this.getParagraphBefore()}LKm(){return this.getParagraphBeforeOrNullObject()}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}tNa(){return this.insertContentControl()}lva(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(n,d)}hcb(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(n,
B,Q,d)}iTn(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"int");return this.mergeCells(n,B,Q,d)}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,ji.a);return this.search(n,
d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}Tqd(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");this.setCellPadding(n,d);return null}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}Hua(){return G.AFrameworkApplication.$v?this.Jh:null}}Object(D.a)(vF,"Table",rh.a,[866]);class QH{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di){this.yd=this.Jk=this.Ip=null;this.Wfa=n;this.ME=d;this.td=B;this.BJa=Q;this.tI=ha;this.pi=Aa;this.YF=bb;this.vB=Ib;this.Asa=oc;this.qb=Ac;this.wD=ad;this.Im=be;this.nd=sd;this.uh=wd;this.Am=yd;this.Wr=ye;this.CHa=Qe;this.km=af;this.gJa=Qf;this.yD=hf;this.Tz=di}Vu(d,n,B){this.yd=d;this.Ip=
n;this.Jk=B}create(d,n,B=0){return new vF(d,n,B,this,this.Wfa,this.ME,this.td,this.Ip,this.Jk,this.BJa,this.Am,this.tI,this.pi,this.yd,this.YF,this.vB,this.Asa,this.qb,this.wD,this.nd,this.uh,this.Im,this.Wr,this.CHa,this.km,this.gJa,this.yD,this.Tz)}}Object(D.a)(QH,"TableFactory",null,[1011]);var DB=e(195),vK=e(911),Ls;(function(d){d[d.top=0]="top";d[d.left=1]="left";d[d.bottom=2]="bottom";d[d.right=3]="right"})(Ls||(Ls={}));Object(D.b)("CellPaddingLocation",Ls);class Wy{constructor(d,n,B,Q,ha,Aa,
bb,Ib,oc,Ac,ad,sd,wd,yd,be){this.eS=null;this.idm=(ye,Qe)=>{const af=ye.parentNode;return 35===ye.currentNode.type||af&&14===af.type||Qe&&ye.Bbb(Qe)?!1:!0};this.qb=d;this.nd=n;this.Im=B;this.ga=Q;this.td=ha;this.Wr=Aa;this.ysa=bb;this.Q7=Ib;this.vdc=oc;this.nRd=Ac;this.Wfa=ad;this.pi=sd;this.YF=wd;this.ni=yd;this.uh=be}Vu(d){this.eS=d}insertTable(d,n,B,Q,ha,Aa,bb=!1){let Ib;Ib=this.hgk(ha,n,B,Q);let oc=this.q$d(d,Ib);oc||({yN:oc}=this.nd.bP(d.K(0),d.K(d.count-1),Q,!0));oc=this.uh.fRa(oc,d);let Ac;
this.nd.DY((Ac=new ma.a,Ac.add(oc),Ac),Q,1);n=this.qin(oc,n,B,Ib,d,Aa,bb);bb&&this.Wr.select(d,0);ha&&this.qWj(n,ha,!0);return n?this.vdc.create(n,Aa):null}YXi(d,n){d=this.td.Ag(d);d.Ib(7);d.Ac();this.ni.mA(d,n,!0,null,!1,!1);d.ic(2);return d.currentNode}q$d(d,n){var B=n?d.K(0):d.K(d.count-1);if(B.contextId!==ed.a.paragraph&&B.contextId!==ed.a.table)return null;B=B.node;const Q=this.td.Ag(B);Q.Ib(7);if(14!==B.type){let ha=null;if(!this.pi.Cz(Q))return null;for(;this.pi.Cz(Q);){this.Im.Sye(Q);const Aa=
this.qb.Vn(Q.currentNode),bb=this.qb.vH(Q.currentNode);if(n?B.id.equals(Aa.id):B.id.equals(bb.id))for(const Ib of d){const oc=n?bb.id:Aa.id;if(Ib.contextId===ed.a.paragraph&&Ib.node.id.equals(oc)){ha=Q.currentNode;break}}else break}ha&&(B=ha)}return 14===B.type?this.JUf(B,n,!0):null}JUf(d,n,B){let Q=this.qb.Cg(d,n,!1,!1);if(!Q&&B||Q&&14===Q.type)Q=this.YXi(d,n);d=null;Q&&(n?(d=ge.a.uz(Q),0<this.qb.nn(Q,this.qb.textLength(Q))?d.Ob=d.nc=this.qb.xz(Q):d.Ob=d.nc=-1):(d=ge.a.jd(Q,0),0<this.qb.nn(Q,0)?
d.Ob=d.nc=this.qb.jA(Q):d.Ob=d.nc=-1));return d}jUm(d,n){const B=new ma.a;d=this.pi.sSf(d);for(let Q=0;Q<d.count;Q++)B.add(this.vdc.create(d.K(Q),n,Q));return B}rNi(d,n,B){const Q=new ma.a;d=this.vVm(d,n);for(n=0;n<d.count;n++)Q.add(this.vdc.create(d.K(n),B,n));return Q}mNi(d,n){const B=new ma.a;for(let Q=0;Q<d.count;Q++)B.add(this.nRd.create(d.K(Q),n,Q));return B}CTm(d,n){const B=new ma.a;d=this.YF.UD(d);for(let Q=0;Q<d.count;Q++)B.add(this.Wfa.create(d.K(Q),n,Q));return B}Mtb(d,n,B=null){if(!d)return null;
!B||d.id.equals(B.id)?B=this.Ana(d,!0):(d=this.td.Ag(d),d.Ib(14),B=this.td.Ag(B),B.Ib(14),B=this.Im.dQo(d,B));return B?this.vdc.create(B,n):null}DLm(d,n){d=this.td.Ag(d);d.Ib(15);return(d=d.xd(15))?this.nRd.create(d,n):null}$mc(d,n,B=null){if(!d)return null;!B||d.id.equals(B.id)?B=this.Ana(d,!1):(d=this.td.Ag(d),d.Ib(14),B=this.td.Ag(B),B.Ib(14),B=this.Im.eQo(d,B));return B?this.Wfa.create(B,n):null}fv(d){const n=this.td.Lm();n.set(d);n.Ib(14);return this.YF.fv(n)}crm(d){const n=this.td.Lm();n.set(d);
n.Ib(14);return this.ysa.j5c(n,!0)}SSf(d){if(this.Q7.Js(d))return null;const n=this.td.Lm();n.set(d);var B=n.ue();for(d="";B;){B=n.XNa;var Q=n.ue();if(12===Q.type)d+=this.qb.U5(Q),B||(d+="\r");else if(14===Q.type){B=this.ZOi(Q);Q="";for(let ha=0;ha<B.length;ha++){const Aa=B[ha].length;for(let bb=0;bb<Aa;bb++)Q+=B[ha][bb],Q=bb===Aa-1?Q+"\r":Q+"\t"}d+=Q}n.Ac();B=n.xl()}return d}$Oi(d){const n=new ma.a;for(const B of this.YF.UD(d))n.add(this.SSf(B));return[n.toArray()]}ZOi(d){const n=new ma.a;for(const B of this.pi.kA(d,
0,this.pi.Hg(d)-1))n.add(this.$Oi(B)[0]);return n.toArray()}AEg(d,n,B=!1){this.Q7.Js(d)||(B||this.asf(d),B=this.td.Lm(),B.set(d),B.ic(1),B=B.ue(),d=new ma.a,B=ge.a.OV(0,this.qb.textLength(B),!1,B),d.add(B),this.nd.insertText(d,n,2))}BEg(d,n,B=!1){d=this.YF.UD(d);(!n||!n.length||d.count<n[0].length)&&pc.a.Cd();let Q=0;for(const ha of d)Q<n[0].length?this.AEg(ha,n[0][Q++],B):B||this.asf(ha)}qWj(d,n,B=!1){const Q=this.pi.Hg(d);Q<n.length&&pc.a.Cd();let ha=0;for(const Aa of this.pi.kA(d,0,Q-1))ha<n.length?
this.BEg(Aa,[n[ha++]],B):B||this.csf(Aa)}asf(d){if(!this.Q7.Js(d)){d=this.qb.LC(d,!0,!1);this.nd.qRa(d.K(0));this.nd.qRa(d.K(d.count-1));this.nd.DY(d,4,2);var n=d.K(d.count-1);d.W(d.count-1,ge.a.OV(0,this.qb.textLength(n.node),!1,n.node));d.K(d.count-1).nc=n.vp();1===d.count&&(d.K(d.count-1).Ob=n.rp());this.nd.E2d(d)}}csf(d){for(const n of this.YF.UD(d))this.asf(n)}f8h(d){const n=this.pi.Hg(d);for(const B of this.pi.kA(d,0,n-1))this.csf(B)}Azf(d){var n=this.S4(d);if(1===this.pi.Hg(n))this.OY(n);else{var B=
DB.TableNodeContext.create(d);d=this.Wr.w6c(B);32!==this.ga.Sf(B,Se.a.deleteRow,2,!0,null,null)&&(n=this.pi.sF(n),F.ULS.sendTraceTag(20304155,369,10,"Commands.DeleteRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",n,!0),pc.a.vg());this.Wr.Hwd(d)}}mergeCells(d,n){const B=this.S4(d),Q=DB.TableNodeContext.create(d);d=this.Wr.w6c(Q);32!==this.ga.Sf(Q,Se.a.mergeCells,2,!0,null,n)&&(n=this.pi.sF(B),F.ULS.sendTraceTag(523319324,369,10,"Commands.mergeCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",
n,!0),pc.a.vg());this.Wr.Hwd(d)}CQa(d,n){const B=this.S4(d),Q=DB.TableNodeContext.create(d);d=this.Wr.w6c(Q);32!==this.ga.Sf(Q,Se.a.CQa,2,!0,null,n)&&(n=this.pi.sF(B),F.ULS.sendTraceTag(523319326,369,10,"Commands.splitCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",n,!0),pc.a.vg());this.Wr.Hwd(d)}Dji(d){var n=this.S4(d);1===this.pi.Nh(n)?this.OY(n):(d=DB.TableNodeContext.create(d),n=this.Wr.w6c(d),32!==this.ga.Sf(d,Se.a.deleteColumn,2,!0,null,null)&&(F.ULS.sendTraceTag(20304157,
369,10,"Commands.DeleteColumn Error."),pc.a.vg()),this.Wr.Hwd(n))}OY(d){d=ge.a.create(d);const n=this.Wr.w6c(d);32!==this.ga.Sf(d,Se.a.OY,2,!0,null,null)&&(F.ULS.sendTraceTag(20304159,369,10,"Commands.DeleteTable Error."),pc.a.vg());this.Wr.Hwd(n)}vVm(d,n){const B=new ma.a;var Q=d.node,ha=n.node;if(Q.id.equals(ha.id)){if(this.yqc(d))return B;n=vc.a.kb(Q);n.Ib(14)&&(Q=this.Im.Vyg(n),ha=this.Im.W8d(n),this.Zaj(d,d,ha,Q)&&(d=this.Im.yMa(n),B.add(d)));return B}let Aa,bb;const Ib=({yed:Aa,szg:bb}=this.e8d(Q,
ha)).returnValue,oc=Aa[Ib];switch(oc.type){case 14:return B.add(oc),B;case 15:return B.add(Aa[Ib-1]),B;case 16:if(this.Zaj(d,n,oc,Aa[Ib-1]))return B.add(Aa[Ib-2]),B}this.OTm(Q,ha,Aa,bb,Ib,B);return B}PAi(d){let n=null;d=vc.a.kb(d);d.Ib(14)&&(n=ef.c(d));return n}e8d(d,n){d=this.Qsb(d);n=this.Qsb(n);for(let B=0;B<d.length&&B<n.length;++B)if(d[B]!==n[B])return{returnValue:B-1,yed:d,szg:n};return{returnValue:0,yed:d,szg:n}}Zaj(d,n,B,Q){const ha=d.node,Aa=n.node,bb=this.qb.Vn(B);B=this.qb.vH(B);return 1!==
this.YF.UD(Q).count||this.yqc(d)||this.yqc(n)||bb!==ha||B!==Aa?!1:!0}OTm(d,n,B,Q,ha,Aa){const bb=this.gNi(B,ha+1);Q=this.gNi(Q,ha+1);bb&&Aa.add(bb);d=vc.a.kb(d);d.Ib(7);B=Ie.a.$u(d,B[ha]);for(B.Oq(this.idm,bb);B.moveNext()&&!(14===B.currentNode.type&&Aa.add(B.currentNode),Q&&B.currentNode===Q||B.currentNode.id.equals(n.id)););}gNi(d,n){for(;n<d.length;++n)if(14===d[n].type)return d[n];return null}yqc(d){return-1===d.cpBegin&&-1===d.cpEnd&&d.contextId===ed.a.paragraph?!1:d.contextId===ed.a.Nd||d.contextId===
ed.a.od||d.contextId===ed.a.kd}Qsb(d){const n=[],B=new vc.a;B.set(d);for(B.Ib(7);B.Ac();)n.push(B.currentNode);n.reverse();return n}qin(d,n,B,Q,ha,Aa,bb=!0){const Ib=Q?ha.K(0):ha.K(ha.count-1);let oc=0,Ac=!1;if(bb){const ad=Ib.node;oc=this.qb.textLength(ad);ad.id.equals(d.node.id)&&(Ac=!0)}F.ULS.sendTraceTag(21263694,369,50,"AppId:{0}, Insert table with row number: {1}, column number : {2}",Aa.appId,n,B);n=Object.assign(new vK.a,{rows:n,columns:B,vrc:!0});32!==this.ga.Sf(d,Se.a.insertTable,2,!1,new ut.a,
n)&&(F.ULS.sendTraceTag(19951683,369,10,"Commands.InsertTable failed"),pc.a.vg());d=n.Fq;this.JUf(d,Q,!1);this.JUf(d,!Q,!1);n=this.qb.Cg(d,!1,!1,!1);if(!bb)return d;switch(Ib.contextId){case ed.a.paragraph:Q&&(Ac&&1<ha.count&&!oc?ha.removeAt(0):Ac&&(ha.W(0,ge.a.create(n)),this.nd.qRa(ha.K(0))));break;case ed.a.od:Q&&(1<ha.count?ha.removeAt(0):(ha.W(0,ge.a.jd(n,0)),this.nd.qRa(ha.K(0))));break;default:Q?(ha.W(0,Ib.contextId===ed.a.kd?ge.a.jd(n,0):ge.a.createTextRange(n,0,Ib.cpEnd-Ib.cpBegin)),1<ha.count&&
ha.K(1).contextId===ed.a.od&&(ha.W(1,ge.a.Pm(n)),ha.K(1).Ob=ha.K(1).nc=Ib.vp()),this.nd.qRa(ha.K(0),Ib)):1!==ha.count||ha.K(0).contextId!==ed.a.kd||ha.K(0).cpBegin||(ha.W(0,ge.a.jd(this.qb.Vn(d),0)),this.nd.qRa(ha.K(0)))}return d}fNi(d){let n=this.pi.pP(d)?1:0;d=this.td.Ag(d);for(d.Ib(7);d.xd(14);)n++;return n}bRf(d){return d.hasProperty(xd.a.YE)?(d=Vf.a.zB(d.getValue(xd.a.YE)),null!=d?d.toUpperCase():d):""}YDg(d,n){this.ga.Sf(ge.a.create(d),Se.a.t$,2,!0,new ut.a,n)}TSf(d){switch(d.ka(Dd.a.MQa,"top")){case "top":return 0;
case "center":return 1;case "bottom":return 2;default:return-1}}CEg(d,n){switch(n){case 0:n=Se.a.c6f;break;case 1:n=Se.a.a6f;break;case 2:n=Se.a.X5f;break;default:F.ULS.sendTraceTag(20492683,369,15,"The argument for VerticalAlignment must be Top/Center/Bottom.");pc.a.Cd();return}this.ga.Sf(ge.a.create(d),n,2,!0,new ut.a,{})}BNf(d){d=this.qb.ox(d,!0,!1);const n=this.qb.VA(d.K(0));for(let B=1;B<d.count;B++)if(!n||n!==this.qb.VA(d.K(B)))return-2;return this.i$i(n)}bDg(d,n){switch(n){case 0:n=Se.a.$5f;
break;case 1:n=Se.a.Y5f;break;case 2:n=Se.a.b6f;break;case 3:n=Se.a.Z5f;break;default:F.ULS.sendTraceTag(20492684,369,15,"The argument for HorizontalAlignment must be Left/Centered/Right/Justified.");pc.a.Cd();return}this.ga.Sf(ge.a.create(d),n,2,!0,new ut.a,{})}dnm(d){d=this.pi.VA(d);return this.i$i(d)}TYo(d,n){switch(n){case 0:n=Se.a.G9;break;case 1:n=Se.a.Rba;break;case 2:n=Se.a.p$;break;default:F.ULS.sendTraceTag(20807900,369,15,"The argument for Alignment must be Left/Centered/Right.");pc.a.Cd();
return}this.ga.Sf(ge.a.create(d),n,2,!0,new ut.a,{})}E$d(d){const n=this.S4(d).ka(Dd.a.xU,.15);return Mi.a.Ydb(d.ka(Dd.a.xU,n))}cbe(d){const n=this.S4(d).ka(Dd.a.fX,.15);return Mi.a.Ydb(d.ka(Dd.a.fX,n))}tSf(d){const n=this.S4(d).ka(Dd.a.LQa,0);return Mi.a.Ydb(d.ka(Dd.a.LQa,n))}xKf(d){const n=this.S4(d).ka(Dd.a.JQa,0);return Mi.a.Ydb(d.ka(Dd.a.JQa,n))}setCellPadding(d,n,B){if(0>B||1584<B)F.ULS.sendTraceTag(20772256,369,15,"The cell padding value should be between 0 and 1584 in points."),pc.a.Cd();
B=Mi.a.Rwa(B);switch(d.type){case 14:this.JZo(d,Wy.KPe[Ls[n]],B);break;case 15:this.ISj(d,Wy.KPe[Ls[n]],B);break;case 16:this.HSj(d,Wy.KPe[Ls[n]],B);break;default:F.ULS.sendTraceTag(20772257,369,10,"The graph node should be is table, table row or table cell."),pc.a.Cd()}}JZo(d,n,B){d=this.pi.kA(d,0,this.pi.Hg(d)-1);for(const Q of d)this.ISj(Q,n,B)}ISj(d,n,B){d=this.YF.UD(d);for(const Q of d)this.HSj(Q,n,B)}HSj(d,n,B){const Q=this.A7c(d);n===Dd.a.xU?B=Math.min(Q-Mi.a.Rwa(this.cbe(d)),B):n===Dd.a.fX&&
(B=Math.min(Q-Mi.a.Rwa(this.E$d(d)),B));d.setValue(n,B)}FTb(d,n,B){d=this.YF.UD(d);const Q=n(d.K(0));for(let ha=1;ha<d.count;ha++)if(Q==B||Q!=n(d.K(ha)))return B;return Q}ETb(d,n,B){d=this.pi.kA(d,0,this.pi.Hg(d)-1);let Q="number"===typeof B?0:"boolean"===typeof B?!1:null;for(let ha=0;ha<d.count;ha++){const Aa=this.YF.UD(d.K(ha));for(let bb=0;bb<Aa.count;bb++){const Ib=n(Aa.K(bb));ha+bb||(Q=Ib);if(Q==B||Q!=Ib)return B}}return Q}S4(d){return this.Ana(d,!0)}Ana(d,n){if(!d)return null;d=this.td.Ag(d);
return d.Ib(14)?n?this.Im.yMa(d):this.Im.W8d(d):null}KPf(d,n,B){return(d=this.bJi(d,n))?this.eS.create(d,B):null}JPf(d,n){return(d=this.vae(d))?this.eS.create(d,n):null}bJi(d,n){if(!d||!n)return null;if(d.id.equals(n.id))return this.vae(d);n=({yed:d}=this.e8d(d,n)).returnValue;d=d[n];switch(d.type){case 16:case 36:case 8:case 10:case 37:return d;default:return this.vae(d)}}vae(d){let n=null;d=vc.a.kb(d);d.Ib(16)?n=d.Gq(16):d.Ib(36)?n=d.Gq(36):d.Ib(10)?n=d.Gq(10):d.Ib(8)?(d.xd(8),1!==d.Bs()&&(n=d.currentNode)):
pc.a.Hgi()&&d.Ib(38)&&(n=d.Gq(38));return n}oLf(d){d.Ib(14);var n=this.Im.W8d(d);this.td.Ag(n).Ib(14);const B=this.Im.yMa(d);d=this.A7c(n);const Q=n.ka(Dd.a.xU,B.ka(Dd.a.xU,.15));n=n.ka(Dd.a.fX,B.ka(Dd.a.fX,.15));n=d-Q-n;0>=n&&(F.ULS.sendTraceTag(20730644,369,15,"Cell content width is not valid"),pc.a.vg());return n}B7c(d){d=this.ysa.N8d(d);let n=0;if(this.kSi(d))var B=0;else{for(B of d)n+=B;B=n}return{returnValue:d,ovd:B}}A7c(d){var n=this.td.Ag(d);n.Ib(14);n=this.ysa.j5c(n);var B=this.S4(d);B=this.ysa.N8d(B);
d=d.ka(Dd.a.colSpan,1);let Q=0;for(;d;d--,n++)if(-1===B[n]){Q=0;break}else Q+=B[n];return Q}i$i(d){switch(d){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 9:case 11:case 10:case 7:case 13:return 3;default:return-1}}insertColumns(d,n,B,Q,ha){var Aa=!1;switch(B){case 0:Aa=!0;break;case 1:Aa=!1;break;default:F.ULS.sendTraceTag(20758724,369,15,"The type of insert location is undefined: {0}.",yo.a[B]),pc.a.Cd()}B=this.Im.yMa(n);var bb=this.pi.Hg(B);const Ib=this.pi.Nh(B);if(0>=d||d>63-Ib)F.ULS.sendTraceTag(20758725,
369,15,"The insert column count plus original column count exceeds the maxium column size"),pc.a.Cd();if(Q)for(Q.length>bb&&(F.ULS.sendTraceTag(20758726,369,15,"The values size is larger than table row size"),pc.a.Cd()),bb=0;bb<Q.length;bb++)Q[bb].length>d&&(F.ULS.sendTraceTag(20758727,369,15,"The values size is larger than table size"),pc.a.Cd());this.ygn(d,n,Aa,ha);d=this.ysa.j5c(n);if(Q)for(n=0;n<Q.length;n++)for(ha=d;ha<d+Q[n].length;ha++)Aa=this.td.Ag(B),Aa=this.Im.Kkj(Aa,n,ha),this.AEg(Aa,Q[n][ha-
d])}ygn(d,n,B,Q){const ha=B?Se.a.jpc:Se.a.YUb,Aa=ge.a.create(n.currentNode);for(let bb=0;bb<d;bb++)32!==this.ga.Sf(Aa,ha,2,!1,new ut.a,null)&&pc.a.vg(),1<d&&(Q.vo.qH(),Q.vo.ex(n.currentNode));if(B)for(B=0;B<d;B++)n.cR();else n.xl()}kSi(d){for(const n of d)if(-1===n)return!0;return!1}insertRows(d,n,B,Q){const ha=n.Gq(14);B=this.hgk(Q,d+this.pi.Hg(ha),this.YF.UD(n.currentNode).count,B);d=this.bin(d,n,B);if(Q)for(n=0;n<Q.length;n++)this.BEg(d.K(n),[Q[n]]);return d}bin(d,n,B){const Q=B?Se.a.ivb:Se.a.gcb,
ha=new ma.a;for(let bb=0;bb<d;bb++){var Aa=ge.a.create(n.currentNode);Aa=this.ga.Sf(Aa,Q,2,!1,new ut.a,null);32!==Aa&&(Aa=this.pi.sF(this.Im.yMa(n)),F.ULS.sendTraceTag(20756129,369,10,"Commands.InsertRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",Aa,!0),pc.a.vg());B?(n.cR(),ha.insert(0,n.currentNode)):(n.xl(),ha.add(n.currentNode))}return ha}hgk(d,n,B,Q){if(32767<n||0>=n||0>=B||63<B)F.ULS.sendTraceTag(20756130,369,15,"Invalid Size for {0}","inserted row"),pc.a.Cd();
if(d)if(d.length>n)F.ULS.sendTraceTag(20756131,369,15,"The values size is larger than {0}'s size","inserted row"),pc.a.Cd();else for(n=0;n<d.length;n++)d[n].length>B&&(F.ULS.sendTraceTag(20756160,369,15,"The values size is larger than {0}'s sizeinserted row"),pc.a.Cd());d=!1;switch(Q){case 0:d=!0;break;case 1:d=!1;break;default:F.ULS.sendTraceTag(20756161,369,15,"The type of insert location is undefined: {0}.",yo.a[Q]),pc.a.Cd()}return d}}Wy.KPe=Zj.a.M$("left",Dd.a.xU,"right",Dd.a.fX,"top",Dd.a.LQa,
"bottom",Dd.a.JQa);Object(D.a)(Wy,"TableOperations",null,[1012]);class RH extends rh.a{constructor(d,n,B){super();this.qTc=null;this.Ix=d;this._context=n;this.yd=B}length(){return this.qTc.count}get _ReferenceId(){return this.kp?this.Jp:null}getFirst(){const d=this.getFirstOrNullObject();d||pc.a.tl();return d}getFirstOrNullObject(){this.hbk();return this.qTc&&this.length()?this.qTc.K(0):null}_GetItem(d){d=pc.a.lO(d);if(d<this.length())return this.qTc.K(d);F.ULS.sendTraceTag(19969491,369,10,"The index is out of the table cell collection range.");
pc.a.Cd();return null}_KeepReference(){this.$o()}_OnAccess(){}getAsyncEnumerator(d,n){this.hbk();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new iq(d,n,this))}getTypeName(){return"Microsoft.WordServices.TableCellCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.JC();case 1004:return this.KC();case 1:return this.wM(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}JC(){return this.getFirst()}KC(){return this.getFirstOrNullObject()}wM(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}hbk(){this.qTc=this.yd.CTm(this.Ix,this._context)}}Object(D.a)(RH,"TableCellCollection",rh.a,[866,893]);class EB extends rh.a{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af){super();pc.a.ARa(d,"TableRow");this.Ix=d;this._context=n;this._id=B;this.ME=ha;this.nRd=Q;this.td=Aa;this.BJa=bb;this.qb=Ib;this.Im=ad;this.yd=Ac;
this.nd=oc;this.YF=sd;this.wD=wd;this.Wr=yd;this.CHa=be;this.pi=ye;this.Tz=Qe;this.Wfa=af}get cellCount(){return this.YF.UD(this.Ix).count}get cells(){return new RH(this.Ix,this._context,this.yd)}get endnotes(){var d=this.nd.omc(this.Ix,1);d=this.nd.fCa(d,this._context);return new wt(d)}get font(){return this.ME.create(6,this.Ix,null,null,this._context)}get fields(){return new Tu(this.Tz.dDi(this.Ix,this._context,!1))}get footnotes(){var d=this.nd.omc(this.Ix,0);d=this.nd.fCa(d,this._context);return new wt(d)}get horizontalAlignment(){return this.yd.FTb(this.Ix,
Object(X.a)(this.yd,this.yd.BNf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(d){this.yd.bDg(this.Ix,d)}get isHeader(){return this.YF.wbd(this.Ix)}get parentTable(){return this.yd.Mtb(this.Ix,this._context)}get preferredHeight(){return this.YF.knc(this.Ix)}set preferredHeight(d){pc.a.C3a(d,"TableRow.PreferredHeight");this.CHa.s2b(this.Ix,Mi.a.Rwa(d))}get rowIndex(){return this.yd.fv(this.Ix)}get shadingColor(){return this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.bRf,"getShadingColorOfTableCellNode"),
"")}set shadingColor(d){d=pc.a.yya(d,"TableRow.ShadingColor",this._context);this.yd.YDg(this.Ix,d)}get values(){return this.yd.$Oi(this.Ix)}set values(d){this.yd.BEg(this.Ix,d)}get verticalAlignment(){return this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.TSf,"getVerticalAlignmentOfTableCellNode"),-1)}set verticalAlignment(d){this.yd.CEg(this.Ix,d)}get _Id(){return this._id}get _ReferenceId(){return this.kp?this.Jp:null}clear(){this.yd.csf(this.Ix)}deleteObject(){this.yd.Azf(this.Ix)}getBorder(d){return this.BJa.create(this.Ix,
d,this._context)}getCellPadding(d){switch(d){case 1:d=this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.E$d,"getLeftMarginOfTableCellNode"),-1);break;case 3:d=this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.cbe,"getRighttMarginOfTableCellNode"),-1);break;case 0:d=this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.tSf,"getTopMarginOfTableCellNode"),-1);break;case 2:d=this.yd.FTb(this.Ix,Object(X.a)(this.yd,this.yd.xKf,"getBottomMarginOfTableCellNode"),-1);break;default:return pc.a.Cd(),null}return-1===
d?null:d}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){var d=this.td.Ag(this.Ix);d.Ib(14);return(d=this.Im.Gcg(d))?this.nRd.create(d,this._context):null}insertContentControl(){return null}insertRows(d,n,B){pc.a.D3a(n,"TableRow.InsertRows()");const Q=this.td.Ag(this.Ix);Q.Ib(14);d=this.yd.insertRows(n,Q,d,B,this._context);this.Im.Sye(Q);return new ws(Q.currentNode,d,1,this._context,this.yd,this.pi)}merge(){const d=this.td.Ag(this.Ix);this.Im.Rne(d);var n=
Di.SelectionFactory.fgi(this.Ix);n=te.a.zgc(n);n=Cp.a.OOf(n);32!==n.response&&(F.ULS.sendTraceTag(521483539,369,15,"get mergeCell context data fail"),pc.a.Cd());this.yd.mergeCells(d.currentNode,n);return this.Ix?this.Wfa.create(this.Ix,this._context):null}search(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Ix,!0,!1);this.wD.find(Q,d,n,B,this._context)})}_Search2(d,n){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{const Q=this.qb.LC(this.Ix,
!0,!1);this.wD.msb(Q,d,n,B,this._context)})}select(d){this.Wr.zVo(this.Ix,d)}setCellPadding(d,n){this.yd.setCellPadding(this.Ix,d,n)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.Ix,"TableRow")}getTypeName(){return"Microsoft.WordServices.TableRow"}invokePropertyGet(d){switch(d){case 4:return this.cellCount;case 3:return this.cells;case 20:return this.endnotes;case 21:return this.fields;case 14:return this.font;case 19:return this.footnotes;case 12:return this.horizontalAlignment;case 16:return this.isHeader;
case 5:return this.parentTable;case 17:return this.preferredHeight;case 6:return this.rowIndex;case 8:return this.shadingColor;case 7:return this.values;case 13:return this.verticalAlignment;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,n){switch(d){case 12:this.horizontalAlignment=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return;case 17:this.preferredHeight=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"number");return;case 8:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return;case 7:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<Array<string>>");return;case 13:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1006:return this.IKa();case 1005:return this.bF(n);case 1009:return this.X4c(n);case 1023:return this.d5c(n);case 1012:return this.b9();case 1013:return this.c9();case 1025:return this.tNa(n);case 1003:return this.vZf(n);case 1004:return this.BTn();case 1007:return this.lja(n);case 1024:return this.Tqd(n);case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,n){switch(d){case 1008:return this.zxa(n);case 1026:return this.Hqa(n)}d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}IKa(){this.clear();return null}bF(){this.deleteObject();return null}X4c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}d5c(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getCellPadding(d)}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}tNa(){return this.insertContentControl()}vZf(d){const n=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");return this.insertRows(n,B,d)}BTn(){return this.merge()}zxa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,ji.a);return this.search(n,d)}Hqa(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(n,d)}lja(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}Tqd(d){const n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");this.setCellPadding(n,d);return null}Sg(){this._KeepReference();return null}Tg(){this._OnAccess();return null}}Object(D.a)(EB,"TableRow",
rh.a,[866]);class wF{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd){this.yd=null;this.ME=d;this.td=n;this.BJa=B;this.qb=Q;this.nd=ha;this.Im=Aa;this.YF=bb;this.wD=Ib;this.Wr=oc;this.CHa=Ac;this.pi=ad;this.Tz=sd;this.Wfa=wd}Vu(d){this.yd=d}create(d,n,B=0){return new EB(d,n,B,this,this.ME,this.td,this.BJa,this.qb,this.nd,this.yd,this.Im,this.YF,this.wD,this.Wr,this.CHa,this.pi,this.Tz,this.Wfa)}}Object(D.a)(wF,"TableRowFactory",null,[1011]);var wK=e(1131),jj=e(121);class Rq{constructor(d,n,B,Q,ha,
Aa){this.uh=d;this.qb=n;this.me=B;this.VE=Q;this.jSd=ha;this.ZWk=Aa}srm(){return this.me.q_?1:this.me.$Qa?2:0}OZo(d,n){const B=wK.a.menuItemId,Q={};switch(n){case 0:Q[B]=jj.a.gFc;break;case 1:Q[B]=jj.a.fFc;break;case 2:Q[B]=jj.a.X5b}32!==d.Zb(dd.a.$ja,2,Q)&&(F.ULS.sendTraceTag(545043662,369,10,"BuildspkgCommands.updateTrackChangeStatus Error."),pc.a.vg())}vQf(d,n,B,Q){if(12!=d.type)return"";if(!this.VE.K_d(d,B,Q))return this.g7c(d,B,Q);const ha=this.VE.sDa(d,B,Q);let Aa="";for(const bb of ha)2==bb.Sd.changeType?
1==n&&(B<bb.Kd&&(Aa+=this.g7c(d,B,bb.Kd)),B=bb.endCp):1==bb.Sd.changeType&&0==n&&(B<bb.Kd&&(Aa+=this.g7c(d,B,bb.Kd)),B=bb.endCp);B<Q&&(Aa+=this.g7c(d,B,Q));return Aa}abe(d,n){let B=this.vQf(d,n,0,this.qb.textLength(d));d.ra.last.Gi&&1==n||d.ra.last.Dj&&0==n||(B+=pc.a.dtc);return B}cPm(d,n){let B="";const Q=d.start,ha=d.end;return Q&&ha?B=d.Pg?this.Inm(Q,ha,n):B+this.vQf(Q.node,n,Q.cpBegin,ha.cpEnd):B}tOi(d,n){const B=new ma.a;for(let ha=0;ha<d.count;ha++){const Aa=d.K(ha);var Q=this.VE.sDa(Aa.node,
Aa.cpBegin,Aa.cpEnd);for(const bb of Q)Q=this.jSd.create(Aa,n,bb,0),B.add(Q)}return B}sOi(d,n){const B=new ma.a;for(let ha=0;ha<d.count;ha++){const Aa=d.K(ha);var Q=Aa.node;Q=this.VE.sDa(Q,0,this.qb.textLength(Q));for(const bb of Q)Q=this.jSd.create(Aa,n,bb,0),B.add(Q)}return B}LVm(d){return 2==d.Sd.changeType?2:1==d.Sd.changeType?1:3==d.Sd.changeType?3:0}getNextOrNullObject(d,n,B){const Q=this.VE.uT(d.node);for(const ha of Q)if(!(ha.Kd<n.Kd)){if(ha.Kd===n.Kd){if(ha.Sd.changeType===n.Sd.changeType)continue;
if(!this.VE.Sbd(n.Sd.changeType,ha.Sd.changeType))continue}return this.jSd.create(ge.a.createTextRange(d.node,ha.Kd,ha.endCp),B,ha,0)}for(d=this.qb.Cg(d.node,!1,!0);d;){if(this.VE.K_d(d,0,this.qb.textLength(d)))return n=this.VE.sDa(d,0,this.qb.textLength(d)),this.jSd.create(ge.a.createTextRange(d,0,this.qb.textLength(d)),B,n.K(0),0);d=this.qb.Cg(d,!1,!0)}return null}cRh(d,n,B){this.ZWk.uec(d.node,n,B)}Inm(d,n,B){let Q="";d=this.uh.aZ(d,n);for(const ha of d)Q+=this.abe(ha,B);return Q}g7c(d,n,B){n=
{Kd:n,endCp:B};return""+this.qb.e_b(d,void 0,n).substring(n.Kd,n.endCp)}}Object(D.a)(Rq,"TrackChangesOperations",null,[1010]);class SH extends rh.a{constructor(d,n,B,Q,ha,Aa){super();this.lz=this.$fa=this.aga=null;pc.a.Pz(d.node,"trackChange GraphNodeContext");this.$fa=d;this.aga=B;this.lz=ha;this.Jk=Aa;this.hY=n}get author(){return this.aga.Sd.authorName}get date(){return this.aga.Ck}get text(){return this.lz.g7c(this.$fa.node,-1==this.$fa.cpBegin?this.aga.Kd:Math.max(this.aga.Kd,this.$fa.cpBegin),
-1==this.$fa.cpEnd?this.aga.endCp:Math.min(this.aga.endCp,this.$fa.cpEnd))}get type(){return this.lz.LVm(this.aga)}get _ReferenceId(){return this.kp?this.Jp:null}accept(){this.lz.cRh(this.$fa,this.aga,!0)}getNext(){const d=this.getNextOrNullObject();d||pc.a.tl();return d}getNextOrNullObject(){return this.lz.getNextOrNullObject(this.$fa,this.aga,this.hY)}getRange(){let d=new ma.a,n=ge.a.createTextRange(this.$fa.node,-1==this.$fa.cpBegin?this.aga.Kd:Math.max(this.aga.Kd,this.$fa.cpBegin),-1==this.$fa.cpEnd?
this.aga.endCp:Math.min(this.aga.endCp,this.$fa.cpEnd));d.add(n);return this.Jk.create(d,this.hY)}reject(){this.lz.cRh(this.$fa,this.aga,!1)}_KeepReference(){this.$o()}_OnAccess(){pc.a.Y2(this.$fa.node,"TrackedChange")}getTypeName(){return"Microsoft.WordServices.TrackedChange"}invokePropertyGet(d){switch(d){case 2:return this.author;case 3:return this.date;case 4:return this.text;case 5:return this.type;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,n){this.invokePropertySet(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,n){switch(d){case 1003:return this.Lgf();case 1006:return this.b9();case 1007:return this.c9();case 1005:return this.rha(n);case 1004:return this.$ug();
case 1002:return this.Sg();case 1001:return this.Tg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,n){d=this.invokeMethod(d,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Lgf(){this.accept();return null}b9(){return this.getNext()}c9(){return this.getNextOrNullObject()}rha(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}$ug(){this.reject();return null}Sg(){this._KeepReference();
return null}Tg(){this._OnAccess();return null}}Object(D.a)(SH,"TrackedChange",rh.a,[866]);class rD{constructor(){}Vu(d,n){this.lz=d;this.Jk=n}create(d,n,B,Q=0){return new SH(d,n,B,Q,this.lz,this.Jk)}}Object(D.a)(rD,"TrackedChangeFactory",null,[]);class Sq{constructor(){this.Z=null}get name(){return"WordEditor.Extension"}init(){if(Bf.a.Lxd){this.Z.resolve("WordEditor.Extension.RichApiEventManager");var d=this.Z.resolve("WordEditor.Extension.ContentControlFactory"),n=this.Z.resolve("WordEditor.Extension.ContentControlOperations"),
B=this.Z.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),Q=this.Z.resolve("WordEditor.Extension.InlinePictureFactory"),ha=this.Z.resolve("WordEditor.Extension.ParagraphFactory"),Aa=this.Z.resolve("WordEditor.Extension.RangeFactory"),bb=this.Z.resolve("WordEditor.Extension.SelectionApiHelper"),Ib=this.Z.resolve("WordEditor.Extension.TableFactory"),oc=this.Z.resolve("WordEditor.Extension.TableRowFactory"),Ac=this.Z.resolve("WordEditor.Extension.TableCellFactory"),ad=this.Z.resolve("WordEditor.Extension.FileApiOperations"),
sd=this.Z.resolve("WordEditor.Extension.InsertApiOperations"),wd=this.Z.resolve("WordEditor.Extension.TableOperations"),yd=this.Z.resolve("WordEditor.Extension.TrackChangesOperations"),be=this.Z.resolve("WordEditor.Extension.ListOperations"),ye=this.Z.resolve("WordEditor.Extension.ListFactory"),Qe=this.Z.resolve("WordEditor.Extension.ListItemFactory"),af=this.Z.resolve("WordEditor.Extension.FieldFactory"),Qf=this.Z.resolve("WordEditor.Extension.NoteItemFactory"),hf=this.Z.resolve("WordEditor.Extension.BodyFactory"),
di=this.Z.resolve("WordEditor.Extension.SectionFactory"),vj=this.Z.resolve("WordEditor.Extension.StyleApiHelper"),Wk=this.Z.resolve("WordEditor.Extension.CommentOperations"),Tm=this.Z.resolve("WordEditor.Extension.CommentFactory"),Dk=this.Z.resolve("WordEditor.Extension.CommentReplyFactory"),gi=this.Z.resolve("WordEditor.Extension.CommentContentRangeFactory"),oi=this.Z.resolve("WordEditor.Extension.FieldOperations"),Ni=this.Z.resolve("WordEditor.Extension.TrackedChangeFactory"),wh=this.Z.resolve("WordEditor.Extension.CheckboxContentControlFactory");
d.Vu(ha,Aa,Q,n,wd,yd,oi);Q.Vu(ha,Aa);bb.Vu(wd);B.Vu(Aa);af.Vu(Aa,oi,wd,n,sd,bb);ha.Vu(Aa);ad.Vu(Aa,n,di);sd.Vu(n,wd);Ib.Vu(wd,ha,Aa);ye.Vu(be,ha);oc.Vu(wd);Ac.Vu(wd,hf);Qe.Vu(ha);Qf.Vu(hf,Aa,sd);wd.Vu(hf);hf.Vu(di);vj.Vu(wd);Tm.Vu(Aa,Wk);Dk.Vu(Tm,Wk,gi);gi.Vu(Wk);Ni.Vu(yd,Aa);wh.Vu(n)}}dispose(){}Ec(d){this.Z=d;d.ja("WordEditor.Extension.ExtensionFindManagerFactory",()=>new jD(new Am.a,new bp.a,My.a.instance,new fa.a(()=>G.AFrameworkApplication.zc))).ha();d.ja("WordEditor.Extension.ExtensionFindStatusManagerFactory",
()=>new kD).ha();d.ja("WordEditor.Extension.ParagraphLocalIdMapping",()=>new qF).ha();d.ja("WordEditor.Extension.SearchExecutor",()=>new pD(tH.a.createQuery,d.resolve("WordEditor.Extension.ExtensionFindManagerFactory"),d.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),new Am.a)).ha().as("WordEditor.Extension.ISearchExecutor");d.ja("WordEditor.Extension.ContentControlOperations",()=>new bK(d.resolve("WordEditor.ContentControl.IContentControlManager"),d.Wa("Box4.IContentControlDataChangedManager"),
d.resolve("WordEditor.Extension.ContentControlFactory"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IContentControlCharacterPropertiesEditor"),d.resolve("Box4.ContentControl.IContentControlOperator"),()=>d.Wa("Box4.IContentControlConverter"),d.resolve("Box4.IContentControlChpHelper"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IOutlineElementNavigator"),d.resolve("WordEditor.Extension.ISelectionApiHelper"))).ha().as("WordEditor.Extension.IContentControlOperations");
d.ja("WordEditor.Extension.ListOperations",()=>new aA(d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ListFactory"),d.resolve("Box4.List.IListReader"),d.resolve("Box4.List.IListEditor"),d.resolve("Box4.IListMarkerUtility"),d.resolve("Box4.List.ListItemEditor"))).ha().as("WordEditor.Extension.IListOperations");d.ja("WordEditor.Extension.RangeOperations",()=>new tK(d.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va,d.resolve("Box4.HyperlinkEditor"))).ha().as("WordEditor.Extension.IRangeOperations");
d.ja("WordEditor.Extension.ExtensionImageStewardFactory",()=>new sv(d.resolve("WordEditor.IImageEditor"),G.AFrameworkApplication.zc,d.resolve("Box4.IUndoManager"),d.Wa("Box4.IFeatureHelper"))).ha();d.ja("WordEditor.Extension.ImageApiOperations",()=>new lF(d.resolve("Box4.BlobReaderProxy"),d.resolve("Box4.Images.ImageReaderProxy"),d.resolve("Box4.IParagraphReader"),new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.rd),Object($g.a)(),d.resolve("WordEditor.Extension.ExtensionImageStewardFactory"),G.AFrameworkApplication.pe,
G.AFrameworkApplication.J,G.AFrameworkApplication.ta.SYa)).as("WordEditor.Extension.IImageApiOperations").ha();d.ja("WordEditor.Extension.SelectionApiHelper",()=>new uF(te.a.instance,mf.a.instance,d.resolve("Box4.ISelectionFactory"),d.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va)).ha().as("WordEditor.Extension.ISelectionApiHelper");d.ja("WordEditor.Extension.StyleApiHelper",()=>new Mx(d.resolve("Box4.Styles.IWACStyleReader"),G.AFrameworkApplication.va,d.resolve("Box4.IParagraphReader"),
d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),d.resolve("WordEditor.IWACTableStyleReader"),rg.a.instance)).ha().as("WordEditor.Extension.IStyleApiHelper");d.ja("WordEditor.Extension.InsertApiOperations",()=>new qK.a(G.AFrameworkApplication.va,d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),Ch.a.instance,
d.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,d.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,pv.a.instance,Tt.a.instance,d.resolve("Box4.BlobReaderProxy"),d.resolve("WordEditor.Extension.NoteItemFactory"),te.a.instance,d.resolve("Box4.IFieldEditor"),d.resolve("Box4.FieldCopyPasteHelper"))).ha().as("WordEditor.Extension.IInsertApiOperations");d.register(zB,"WordEditor.Extension.FieldOperations").ha().as("WordEditor.Extension.IFieldOperations").fe(()=>new zB(d.resolve("WordEditor.Extension.FieldFactory"),
d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.ITableCellReader"),new rd.a,d.resolve("Box4.IFieldEditor"),d.resolve("Box4.IHyperlinkEditor"),d.resolve("WordEditor.TableOfContents.ITableOfContentsActor"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.ContentControlParagraphMapping"),d.resolve("Box4.IFieldUpdaterFactory"),G.AFrameworkApplication.va));
d.ja("WordEditor.Extension.FileApiOperations",()=>new Gx(d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ImageApiOperations"),d.Wa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),G.AFrameworkApplication.zc)).ha().as("WordEditor.Extension.IFileApiOperations");d.register(Rq,"WordEditor.Extension.TrackChangesOperations").ha().as("WordEditor.Extension.ITrackChangesOperations").fe(()=>
new Rq(d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,d.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,d.resolve("WordEditor.Extension.TrackedChangeFactory"),d.resolve("WordEditor.TrackChange.ITrackChangeAcceptRejectManager")));d.ja("WordEditor.Extension.TableOperations",()=>new Wy(d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.InsertApiOperations"),
d.resolve("Box4.ITableNavigator"),G.AFrameworkApplication.va,new rd.a,d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableColumnReader"),d.resolve("Box4.ITableCellReader"),d.resolve("WordEditor.Extension.TableFactory"),d.resolve("WordEditor.Extension.TableRowFactory"),d.resolve("WordEditor.Extension.TableCellFactory"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("WordEditor.Extension.ContentControlOperations"))).ha().as("WordEditor.Extension.ITableOperations");
d.ja("WordEditor.Extension.CommentOperations",()=>new jw(d.resolve("WordEditor.Comments.IWordEditorCommentModel"),d.Za("WordEditor.Comments.IEditorCommentManager"),d.resolve("WordEditor.Extension.CommentFactory"),G.AFrameworkApplication.va,te.a.instance,d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Comments.ICommentFormatTranslator"))).ha().as("WordEditor.Extension.ICommentOperations");d.ja("WordEditor.Extension.FontOperations",()=>new pK(G.AFrameworkApplication.va,
d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))).ha().as("WordEditor.Extension.IFontOperations");d.ja("WordEditor.Extension.SettingOperations",()=>new Lx).ha().as("WordEditor.Extension.ISettingOperations");d.ja("WordEditor.Extension.InlinePictureFactory",()=>new AB(d.resolve("Box4.Images.IImageReader"),d.resolve("WordEditor.IImageEditor"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),
d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ITableOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.InlinePicture,Box4.GraphNodeContext>").ha();d.ja("WordEditor.Extension.FontFactory",()=>new Zz(d.resolve("Box4.IParagraphReader"),G.AFrameworkApplication.va,d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),
d.resolve("WordEditor.Extension.IFontOperations"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("Box4.Styles.IWACStyleReader"))).ha();d.ja("WordEditor.Extension.TableBorderFactory",()=>new tv(new rd.a,d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("WordEditor.IWACTableStyleReader"),d.resolve("Box4.TableNavigatorProxy"),d.Za("Box4.TableCellReaderProxy"),Gi.a.instance,d.resolve("Box4.TableEditors.IWACTableStyleEditor"))).ha();d.ja("WordEditor.Extension.ParagraphFactory",
()=>new Qw(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InlinePictureFactory"),d.resolve("WordEditor.Extension.ListItemFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IParagraphEditor"),d.resolve("Box4.ILanguageReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),
d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.FileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Extension.ListOperations"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"),d.resolve("WordEditor.Extension.ParagraphLocalIdMapping"),d.resolve("WordEditor.Extension.IAnnotationOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Paragraph,Box4.Graph.GraphNode>").ha();
d.ja("WordEditor.Extension.ContentControlFactory",()=>new zH(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.ContentControl.IContentControlManager"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),
d.resolve("WordEditor.Extension.ListOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.CheckboxContentControlFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.ContentControl,WordEditor.ContentControl.IContentControl>").ha();d.ja("WordEditor.Extension.CheckboxContentControlFactory",()=>new dD).ha();d.ja("WordEditor.Extension.InternalRangeFactory",()=>new BB(d.resolve("Box4.ICharacterPropertiesEditor"),
d.resolve("Box4.IParagraphReader"),new fa.a(()=>yg.StaticActiveAppFrame.Aa()?yg.StaticActiveAppFrame.Aa().tb.rd.Hd:null),d.resolve("Box4.IDynamicRangeObjectSpace"),d.resolve("Box4.IDynamicRangeEditor"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.ITableEditor"))).ha();d.ja("WordEditor.Extension.AnnotationOperations",()=>new Ih(d.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
d.resolve("Box4.Intent.IIntentRangeEditor"),d.resolve("WordEditor.AppsForOffice.WritingAssistanceAddInHelper"))).ha().as("WordEditor.Extension.IAnnotationOperations");d.ja("WordEditor.Extension.RangeFactory",()=>new Vy(d.resolve("WordEditor.Extension.ParagraphFactory"),d.resolve("WordEditor.Extension.InlinePictureFactory"),d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InternalRangeFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),
d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.FileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("Box4.HyperlinkEditor"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Extension.ListOperations"),
d.resolve("WordEditor.Bookmark.IBookmarkManager"),d.resolve("WordEditor.Extension.NoteItemFactory"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"),d.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();d.ja("WordEditor.Extension.ListFactory",()=>new oF(d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IParagraphReader"))).ha();d.ja("WordEditor.Extension.ListItemFactory",
()=>new Hx(d.resolve("WordEditor.Extension.ListOperations"),d.resolve("Box4.IListMarkerUtility"))).ha();d.ja("WordEditor.Extension.NoteItemFactory",()=>new oD).ha();d.ja("WordEditor.Extension.FieldFactory",()=>new Pw).ha();d.ja("WordEditor.Extension.BodyFactory",()=>new cD(d.resolve("WordEditor.Extension.ParagraphFactory"),d.resolve("WordEditor.Extension.RangeFactory"),d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InlinePictureFactory"),new rd.a,d.resolve("Box4.ICharacterPropertiesEditor"),
d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Extension.TableOperations"),
d.resolve("WordEditor.Extension.ListOperations"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Body,Box4.Graph.GraphNode>").ha();d.ja("WordEditor.Extension.SectionFactory",()=>new bA(d.resolve("WordEditor.Extension.BodyFactory"),d.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),d.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Section,Box4.Graph.GraphNode>").ha();
d.ja("WordEditor.Extension.TableCellFactory",()=>new qD(new rd.a,d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("Box4.TableNavigatorProxy"),d.Za("Box4.TableCellReaderProxy"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.ITableColumnReader"),d.resolve("Box4.ITableEditor"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableCell,Box4.Graph.GraphNode>").ha();d.ja("WordEditor.Extension.TableRowFactory",()=>new wF(d.resolve("WordEditor.Extension.FontFactory"),new rd.a,
d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.TableNavigatorProxy"),d.resolve("Box4.ITableRowReader"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableEditor"),d.resolve("Box4.TableReaderProxy"),d.resolve("WordEditor.Extension.FieldOperations"),d.resolve("WordEditor.Extension.TableCellFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableRow,Box4.Graph.GraphNode>").ha();
d.ja("WordEditor.Extension.TableFactory",()=>new QH(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.TableCellFactory"),new rd.a,d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("WordEditor.ITableEditor"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.Styles.IWACTableStyleReader"),d.resolve("Box4.TableEditors.IWACTableStyleEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.SearchExecutor"),
d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("Box4.TableNavigatorProxy"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableEditor"),ag.a.instance,d.resolve("Box4.SectionAlignedViewPositionProvider"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Table,Box4.Graph.GraphNode>").ha();
d.ja("WordEditor.Extension.GraphTransactionWrapper",()=>new $z(new fa.a(()=>yg.StaticActiveAppFrame.Aa()?yg.StaticActiveAppFrame.Aa().tb.rd:null),new pe.a)).as("WordEditor.Extension.IGraphTransactionWrapper");d.ja("WordEditor.Extension.RequestContext",()=>new sF(d.resolve("WordEditor.Extension.GraphTransactionWrapper"))).ha();d.ja("WordEditor.Extension.DocumentProperties",()=>new Uy(d.resolve("WordEditor.Extension.RequestContext"),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),new pe.a,
new ty,G.AFrameworkApplication.J.$("WordEditorAppsForOfficeDocPropertiesIsEnabled"))).ha();d.ja("WordEditor.Extension.AnnotationCollectionFactory",()=>new Qz(d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),d.resolve("WordEditor.Extension.ParagraphFactory"))).ha();d.ja("WordEditor.Extension.DocumentFactory",()=>new iK(new fa.a(()=>yg.StaticActiveAppFrame.Aa()?yg.StaticActiveAppFrame.Aa().tb.rd:null),d.resolve("WordEditor.Extension.RequestContext"),d.resolve("WordEditor.Extension.BodyFactory"),
d.resolve("WordEditor.Extension.SectionFactory"),d.resolve("WordEditor.Extension.RangeFactory"),G.AFrameworkApplication.va,te.a.instance,Object($g.a)(),ag.a.instance,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),YE.a.fR,d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.DocumentProperties"),d.resolve("WordEditor.Extension.AnnotationCollectionFactory"),d.resolve("WordEditor.Bookmark.IBookmarkManager"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.SearchExecutor"),
d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.Extension.CustomXmlPartFactory"),new pe.a,d.resolve("WordEditor.Extension.SettingOperations"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("WordEditor.Extension.FontFactory"),pv.a.instance,d.resolve("WordEditor.Extension.ParagraphFactory"),d.resolve("WordEditor.Extension.ParagraphLocalIdMapping"),
d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),d.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();d.ja("WordEditor.Extension.DocumentCreatedFactory",()=>new cK).ha();d.ja("WordEditor.Extension.AuthenticationServiceFactory",()=>new aF(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Postmessage.IHostPostmessenger"))).ha();d.ja("WordEditor.Extension.LicenseFactory",()=>new xt(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();
d.ja("WordEditor.Extension.AppRuntimeServiceFactory",()=>new $J(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();d.ja("WordEditor.Extension.CommentContentRangeFactory",()=>new wH(d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IFontOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Comments.IWordEditorCommentModel"))).ha();d.ja("WordEditor.Extension.CommentFactory",
()=>new Qy(d.resolve("WordEditor.Extension.CommentReplyFactory"),d.resolve("WordEditor.Extension.CommentContentRangeFactory"),d.resolve("Box4.IParagraphReader"))).ha();d.ja("WordEditor.Extension.CommentReplyFactory",()=>new yH(new fa.a(()=>yg.StaticActiveAppFrame.Aa()?yg.StaticActiveAppFrame.Aa().tb.rd.Hd:null))).ha();d.ja("WordEditor.Extension.AppRuntimePersistenceServiceFactory",()=>new hn(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();
d.ja("WordEditor.Extension.RichApiEventManager",()=>new Er(d.resolve("WordEditor.Extension.EventMessageManagerMapper"),OfficeExtension.WacRuntime.RichApi.getEventManager(),new LH)).ha();d.ja("WordEditor.Extension.EventMessageManagerMapper",()=>new KH(d.resolve("WordEditor.Extension.CommentEventMessageManager"),d.resolve("WordEditor.Extension.ContentControlEventMessageManager"),d.resolve("WordEditor.Extension.DocumentEventMessageManager"),d.resolve("WordEditor.Extension.ParagraphEventMessageManager"),
d.resolve("WordEditor.Extension.AnnotationEventMessageManager"))).ha();d.ja("WordEditor.Extension.CommentEventMessageManager",()=>new JH(d.Za("WordEditor.Extension.RichApiEventManager"),d.resolve("WordEditor.Comments.EditorCommentModel"))).ha();d.ja("WordEditor.Extension.ParagraphEventMessageManager",()=>new iF(d.Za("WordEditor.Extension.RichApiEventManager"),d.resolve("WordEditor.Extension.ParagraphLocalIdMapping"))).ha();d.ja("WordEditor.Extension.ContentControlEventMessageManager",()=>new dp(d.Za("WordEditor.Extension.RichApiEventManager"),
d.resolve("Box4.IContentControlDataChangedManager"),d.resolve("WordEditor.ContentControl.IContentControlGraphManager"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.IContentControlChpHelper"),d.resolve("WordEditor.Extension.ContentControlOperations"))).ha();d.ja("WordEditor.Extension.DocumentEventMessageManager",()=>new mr(d.Za("WordEditor.Extension.RichApiEventManager"),this.Xtb())).ha();d.ja("WordEditor.Extension.AnnotationEventMessageManager",()=>new vu(d.Za("WordEditor.Extension.RichApiEventManager"),
d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),d.Za("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"))).ha();d.ja("WordEditor.Extension.CustomXmlPartFactory",()=>new AH(d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).ha();d.ja("WordEditor.Extension.TrackedChangeFactory",()=>new rD).ha()}Xtb(){const d=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return d?d.getInstance(0):(F.ULS.sendTraceTag(508827729,2250,10,"Could not resolve wordCountManagerFactory"),
null)}static main(){G.AFrameworkApplication.BL||U.a.instance.Rc(new Sq)}}Object(D.a)(Sq,"ExtensionPackage",null,[0,1]);var TH=e(1270),xF=e(1755),$L=e(1608),uv=e(1540),yF=e(1527);class Ag{}Ag.$g="StatsDialog";Ag.id="id";Ag.zki="dialogState";Ag.eda="isModal";Ag.N_i="isBlocking";Ag.H3d="DocumentStatsReceivedEvent";Ag.WOg="UnsubscribedFromDocumentStatsEvent";Ag.characterCount="characterCount";Ag.characterWithoutSpacesCount="characterWithoutSpacesCount";Ag.L5h="characterCountSelection";Ag.P5h="characterWithoutSpacesCountSelection";
Ag.sul="characterCountIsSupported";Ag.gDf="emptyDocument";Ag.KW="paragraphCount";Ag.dxj="paragraphCountSelection";Ag.Ifo="paragraphCountIsSupported";Ag.Wmd="readabilityScore";Ag.nwo="readabilityIsSupported";Ag.owo="readabilityTooltipLanguageSupport";Ag.LKo="renderUpsellFooter";Ag.timeToRead="timeToRead";Ag.Dsp="timeToReadIsSupported";Ag.Esp="timeToReadTooltipLanguageSupport";Ag.timeToSpeak="timeToSpeak";Ag.Hsp="timeToSpeakIsSupported";Ag.Isp="timeToSpeakTooltipLanguageSupport";Ag.K4b="uniqueWordCount";
Ag.wordCount="wordCount";Ag.Jhk="wordCountSelection";Ag.ZOp="wordCountIsSupported";Ag.aPp="wordCountTooltipLanguageSupport";Ag.editorScore="editorScore";Ag.nvd="totalSuggestions";Ag.isSelected="isSelected";Ag.isPremium="isPremium";Ag.isPaneOpen="isPaneOpen";Ag.ZUo="seeSuggestionsAction";Ag.XPi="goPremiumLink";Object(D.a)(Ag,"StatsDialogProps",null,[]);class Ms{}Ms.kjk="AppLinkProps";Ms.type="type";Ms.id="id";Ms.text="text";Ms.handler="handler";Ms.onExecute="onExecute";Object(D.a)(Ms,"StatsDialogAppLinkProps",
null,[]);const sD=new Map;class xK{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac){this.Uv=d;this.qV=n;this.hdc=B;this.SFb=Q;this.ga=ha;this.Rw=Aa;this.qe=bb;this.io=Ib;this.Snb=oc;this.w6a=Ac;this.Xi=null;this.J_e=this.mMc=!1;this.Sn=null;this.KNc=0;this.x5n=()=>{this.Rw.execute(ad=>{this.w6a.iwa(dd.a.mFn,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"LaunchEditorUpsellFromStatsDialog command executed successfully."},{name:"StatsDialogCaller",string:this.ZIc}]);this.Xi.hide();this.Gsf();
ad.launchUpsellExperience("editorinword")})};this.cco=()=>{this.Xi.hide();this.Gsf();const ad=this.ga.Vb(dd.a.XCe,2);this.w6a.iwa(dd.a.XCe,32===ad,void 0,void 0,void 0,void 0,[{name:"StatsDialogCaller",string:this.ZIc}])};this.Cmi=(ad,sd)=>{this.aIp(sd)};this.vak=()=>{this.oMj()};this.Nco=(ad,sd,wd)=>{this.ZIc="StatusBar";return this.rjd(wd,dd.a.Zre)};this.Mco=(ad,sd,wd)=>{this.ZIc="EditorPane";return this.rjd(wd,dd.a.Yre)};this.rjd=(ad,sd)=>{if(2!==ad)return this.Snb.sendTraceTag(589105153,2253,
50,"OpenStatsDialog command failed to execute, wrong behavior:",ad),16;if(this.mMc)return 32;this.hdc.H6k(this.Cmi);this.hdc.$8k(this.vak);this.hdc.EG();this.Xi=new Ea.a(!1,!1,!0);this.Xi.Md=0;this.Uv.Itd();this.qV.Itd();this.J_e||this.Xi.ti(WacWordeditorStrings.StatsDialogTitle,this.Hsf,this.Eqb(0));this.mMc=!0;this.Sn=this.qe.rg("UserAction","OpenStatsDialog");this.KNc=0;this.w6a.iwa(sd,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"OpenStatsDialog command executed successfully."}]);
return 32};this.Hsf=()=>{this.aQo();this.Gsf()};this.Gsf=()=>{let ad=0;this.Sn&&(this.Sn.stop(),this.DFb||(this.KNc=this.Sn.qj),ad=this.Sn.qj-this.KNc);this.hdc.s_();this.oMj();this.hdc.xIo(this.Cmi);this.hdc.AJo(this.vak);this.w6a.iwa(dd.a.J8h,!0,void 0,void 0,void 0,void 0,[{name:"StatsDialogActor",string:"CloseStatsDialog command executed successfully."},{name:"StatsDialogLoadingStateDuration",int64:this.KNc},{name:"StatsDialogShowStateDuration",int64:ad},{name:"StatsDialogCaller",string:this.ZIc}])};
this.DFb=2;this.Po={["id"]:Ag.$g,["dialogState"]:this.DFb,["isModal"]:!0,["isBlocking"]:!1,["emptyDocument"]:null,["characterCount"]:null,["characterWithoutSpacesCount"]:null,["uniqueWordCount"]:null,["wordCount"]:null,["paragraphCount"]:null,["readabilityScore"]:null,["timeToRead"]:null,["timeToSpeak"]:null,["totalSuggestions"]:null,["characterCountIsSupported"]:null,["characterCountTooltipLanguageSupport"]:null,["wordCountIsSupported"]:null,["wordCountTooltipLanguageSupport"]:null,["timeToReadIsSupported"]:null,
["timeToReadTooltipLanguageSupport"]:null,["timeToSpeakIsSupported"]:null,["timeToSpeakTooltipLanguageSupport"]:null,["readabilityIsSupported"]:null,["readabilityTooltipLanguageSupport"]:null};this.Po.isSelected=!1;this.Po.wordCountSelection=null;this.Po.characterCountSelection=null;this.Po.characterWithoutSpacesCountSelection=null;this.Po.paragraphCountSelection=null;this.Po.editorScore=null;this.ga.Vb(dd.a.Eoi,2)}Jvl(){this.Po[Ag.wordCount]?v(Ag.wordCount):u(Ag.wordCount);this.Po[Ag.K4b]?v(Ag.K4b):
u(Ag.K4b)}Eqb(d,n=null){var B,Q;this.DFb=d;this.Po[Ag.zki]=d;n&&(this.p8a(n,Ag.characterCount),this.p8a(n,Ag.characterWithoutSpacesCount),this.p8a(n,Ag.gDf),this.p8a(n,Ag.KW),this.p8a(n,Ag.Wmd),this.p8a(n,Ag.timeToRead),this.p8a(n,Ag.timeToSpeak),this.p8a(n,Ag.K4b),this.p8a(n,Ag.wordCount),this.Jvl(),this.GUd(n,Ag.Wmd,Ag.nwo,Ag.owo),this.GUd(n,Ag.wordCount,Ag.ZOp,Ag.aPp),this.GUd(n,Ag.timeToSpeak,Ag.Hsp,Ag.Isp),this.GUd(n,Ag.timeToRead,Ag.Dsp,Ag.Esp),this.Po[Ag.sul]=!0,this.Po[Ag.Ifo]=!0,this.Po[Ag.nvd]=
Ag.nvd in n?n[Ag.nvd].count:0);this.Po[Ag.isPaneOpen]=this.io.isPaneOpen;this.Po[Ag.isPremium]=this.io.iwb;this.Po[Ag.LKo]=this.lBn;this.nLl();this.Po[Ag.ZUo]=this.cco;this.Po[Ag.isSelected]=!1;this.Po[Ag.wordCount]=this.Uv.vC;this.Po[Ag.characterCount]=this.Uv.Y_c;this.Po[Ag.characterWithoutSpacesCount]=this.Uv.X_c;this.Po[Ag.KW]=this.Uv.Z_c;this.Po[Ag.editorScore]=(null===(Q=null===(B=this.SFb)||void 0===B?void 0:B.fYa())||void 0===Q?NaN:Q.percentage)|0;0<this.qV.vC&&(this.Po[Ag.isSelected]=!0);
this.Po[Ag.Jhk]=this.qV.vC;this.Po[Ag.P5h]=this.qV.X_c;this.Po[Ag.L5h]=this.qV.Y_c;this.Po[Ag.dxj]=this.qV.Z_c;return{["id"]:Ag.$g,["bodyControls"]:this.Po}}p8a(d,n){var B,Q;this.Po[n]=null!==(Q=null===(B=d[n])||void 0===B?void 0:B.count)&&void 0!==Q?Q:null}GUd(d,n,B,Q){if(n in d){d=d[n];n=1===d.supportType||!!d.supportedLanguages&&0<d.supportedLanguages.length;if(1!==d.supportType&&n){let ha="",Aa="";for(let bb=0;bb<d.supportedLanguages.length;bb++){const Ib=rf.a.Vg(d.supportedLanguages[bb].language).displayName;
bb===d.supportedLanguages.length-1?ha=Ib:Aa=bb?Aa+(", "+Ib):Ib}this.Po[Q]=1===d.supportedLanguages.length?String.format(WacWordeditorStrings.StatsDialogSupportsHelpTextOneDocumentLanguage,ha):String.format(WacWordeditorStrings.StatsDialogSupportsHelpTextMultipleDocumentLanguage,Aa,ha)}this.Po[B]=n}else this.Po[Q]=null,this.Po[B]=!0}nLl(){this.Po[Ag.XPi]={[Ms.type]:Ms.kjk,[Ms.id]:Ag.XPi,[Ms.onExecute]:this.x5n}}mc(){this.ga.qa(dd.a.Yre,ed.a.view,this.Mco);this.ga.qa(dd.a.Zre,ed.a.view,this.Nco)}aIp(d){this.TQn();
0===this.DFb?(this.Xi.hide(),this.mMc=!1,this.Xi=new Ea.a(!1,!1,!0),this.Xi.Md=0,this.J_e||this.Xi.ti(WacWordeditorStrings.StatsDialogTitle,this.Hsf,this.Eqb(1,d.stats)),this.mMc=!0):this.J_e||this.Xi.U$(WacWordeditorStrings.StatsDialogTitle,this.Hsf,this.Eqb(1,d.stats))}TQn(){!this.DFb&&this.Sn&&(this.KNc=this.Sn.qj)}aQo(){switch(this.ZIc){case "EditorPane":this.ga.Zb(dd.a.Ofb,2,"StatsId")}}oMj(){this.mMc=!1;this.DFb=2;this.Po[Ag.zki]=this.DFb;this.Po[Ag.characterCount]=null;this.Po[Ag.characterWithoutSpacesCount]=
null;this.Po[Ag.gDf]=null;this.Po[Ag.KW]=null;this.Po[Ag.Wmd]=null;this.Po[Ag.timeToRead]=null;this.Po[Ag.timeToSpeak]=null;this.Po[Ag.K4b]=null;this.Po[Ag.wordCount]=null;this.Po[Ag.nvd]=null;this.Po[Ag.L5h]=null;this.Po[Ag.P5h]=null;this.Po[Ag.dxj]=null;this.Po[Ag.Jhk]=null}get lBn(){const d=this.Rw.instance;return(null===d||void 0===d?void 0:d.isFreemiumUpsellEnabled())&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatsDialogUpsell",!1)}}Object(D.a)(xK,"StatsDialogActor",
null,[960]);var zF=e(1705),Tq=e(533),Vt=e(241);class tD extends Tq.a{constructor(){super();this.allCharacterCount=0;this.H_=Object.assign(new Vt.a,{T_:tD.getTypeName(),B_:tD.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_CharacterCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(tD,"CharacterCount",Tq.a,[]);class AF extends Tq.a{constructor(){super();this.allCharacterWithoutSpacesCount=0;this.H_=Object.assign(new Vt.a,{T_:AF.getTypeName(),B_:AF.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_CharacterWithoutSpacesCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(AF,"CharacterWithoutSpacesCount",Tq.a,[]);class uD extends Tq.a{constructor(){super();this.allParagraphCount=0;this.H_=Object.assign(new Vt.a,{T_:uD.getTypeName(),B_:uD.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_ParagraphCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(uD,"ParagraphCount",Tq.a,[]);class cA extends Tq.a{constructor(){super();this.fleschReadingEase=null;this.H_=Object.assign(new Vt.a,{T_:cA.getTypeName(),B_:cA.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_ReadabilityScore"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(cA,"ReadabilityScore",Tq.a,[]);class vD extends Tq.a{constructor(){super();this.timeToRead=0;this.H_=Object.assign(new Vt.a,{T_:vD.getTypeName(),B_:vD.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_TimeToRead"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(vD,"TimeToRead",Tq.a,[]);class wD extends Tq.a{constructor(){super();this.timeToSpeak=0;this.H_=Object.assign(new Vt.a,{T_:wD.getTypeName(),B_:wD.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_TimeToSpeak"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(wD,"TimeToSpeak",Tq.a,[]);class lw extends Tq.a{constructor(){super();this.wordNumber=0;this.H_=Object.assign(new Vt.a,{T_:lw.getTypeName(),B_:lw.getBaseTypes()})}static getTypeName(){return"AugLoop_Insights_WordCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(lw,"WordCount",Tq.a,[]);var mw=e(1441);class Xy extends Tq.a{constructor(){super();this.isEmpty=!1;this.H_=Object.assign(new Vt.a,{T_:Xy.getTypeName(),B_:Xy.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(Xy,"EmptyDocumentAnnotation",Tq.a,[]);class Yy extends Tq.a{constructor(){super();this.count=0;this.H_=Object.assign(new Vt.a,{T_:Yy.getTypeName(),B_:Yy.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(Yy,"UniqueWordsCountAnnotation",Tq.a,[]);class BF extends Sys.EventArgs{constructor(d){super();this.stats=d}}Object(D.a)(BF,"DocumentStatsReceivedEventArgs",Sys.EventArgs,[]);class dA{constructor(){this.supportType=
this.count=0;this.supportedLanguages=null}}Object(D.a)(dA,"Stat",null,[]);class yK{constructor(d,n,B,Q){this.EJ=null;this.ySa={};this.ff=d;this.W7=B;this.Snb=Q;this.sa=n;this.U3=!1;this.Jka=new ma.a;this.Jka.add(Xy.getTypeName());this.Jka.add(lw.getTypeName());this.Jka.add(tD.getTypeName());this.Jka.add(AF.getTypeName());this.Jka.add(uD.getTypeName());this.Jka.add(vD.getTypeName());this.Jka.add(wD.getTypeName());this.Jka.add(Yy.getTypeName());this.Jka.add(cA.getTypeName());this.Jka.add(mw.a.getTypeName())}EG(){return this.U3?
Promise.resolve(null):this.W7.Km().then(()=>{this.EJ={};for(const d of this.Jka)this.ff.Cb(this,d),this.Fzj(d);this.ff.addHandler(this,zF.a.getTypeName());this.Fzj(zF.a.getTypeName());this.U3=!0}).catch(d=>{this.Snb.sendTraceTag(589692994,2253,10,"Unable to register stats dialog annotation handlers.",d)})}s_(){return this.U3?this.W7.Km().then(()=>{this.EJ=null;this.U3=!1;this.luo()}).catch(d=>{this.Snb.sendTraceTag(589692995,2253,10,"Unable to unregister stats dialog annotation handlers.",d)}):Promise.resolve(null)}H6k(d){this.sa.addHandler(Ag.H3d,
d)}xIo(d){this.sa.removeHandler(Ag.H3d,d)}$8k(d){this.sa.addHandler(Ag.WOg,d)}AJo(d){this.sa.removeHandler(Ag.WOg,d)}XI(d,n){this.U3&&(n===Qj.a.getTypeName()||n===Ax.a.getTypeName())&&this.kub(d)}kub(d){if(d){d.annotationType===Xy.getTypeName()&&this.JYa(Ag.gDf,d.content.isEmpty?1:0);if(d.annotationType===lw.getTypeName()){var n=d.content;if(!n)return;this.JYa(Ag.wordCount,n.wordNumber)}d.annotationType===tD.getTypeName()&&this.JYa(Ag.characterCount,d.content.allCharacterCount);d.annotationType===
AF.getTypeName()&&this.JYa(Ag.characterWithoutSpacesCount,d.content.allCharacterWithoutSpacesCount);d.annotationType===uD.getTypeName()&&this.JYa(Ag.KW,d.content.allParagraphCount);d.annotationType===vD.getTypeName()&&this.JYa(Ag.timeToRead,d.content.timeToRead);d.annotationType===wD.getTypeName()&&this.JYa(Ag.timeToSpeak,d.content.timeToSpeak);d.annotationType===Yy.getTypeName()&&this.JYa(Ag.K4b,d.content.count);d.annotationType===cA.getTypeName()&&(n=d.content,this.JYa(Ag.Wmd,n.fleschReadingEase?
n.fleschReadingEase:-1));if(d.annotationType===mw.a.getTypeName()){n=d.content;this.ySa[n.categoryName]=n.count;n=0;const B=this.ySa;for(const Q in B)n+=B[Q];this.JYa(Ag.nvd,n)}d.annotationType===zF.a.getTypeName()&&this.L2m(d.content)}else this.Snb.sendTraceTag(589692996,2253,15,"Annotation is null.")}Fzj(d){this.W7.Km().then(()=>{this.ff.getAnnotationsByType(d).then(n=>{for(const B of n)this.kub(B)})});Promise.resolve(null)}luo(){this.U3||(this.sa.raiseEvent(Ag.WOg),this.Snb.sendTraceTag(589692999,
2253,50,"UnsubscribedFromDocumentStats event raised."))}JYa(d,n){let B=new dA;if(d in this.EJ&&(B=this.EJ[d],B.count===n))return;B.count=n;this.EJ[d]=B;this.Snb.sendTraceTag(589693E3,2253,50,d+" document stat added/updated.");this.sa.raiseEvent(Ag.H3d,new BF(this.EJ))}lQn(d){return"DistinctWords"===d?Ag.K4b:"WordCount"===d?Ag.wordCount:"Readability"===d?Ag.Wmd:"TimeToRead"===d?Ag.timeToRead:"TimeToSpeak"===d?Ag.timeToSpeak:""}L2m(d){for(const n of d.features)if(d=this.lQn(n.featureName),""!==d){let B=
new dA;d in this.EJ&&(B=this.EJ[d]);B.supportType=n.supportType;B.supportedLanguages=n.supportedLanguages;this.EJ[d]=B}this.Snb.sendTraceTag(578065630,2253,50,"Document stats support updated.");this.sa.raiseEvent(Ag.H3d,new BF(this.EJ))}}Object(D.a)(yK,"StatsDialogAnnotationHandler",null,[959,365]);var CF;(function(d){d[d.cqq=0]="premium";d[d.lmo=1]="premiumPreview";d[d.M9p=2]="freemium"})(CF||(CF={}));Object(D.b)("AddInLicensingMode",CF);var zK=e(1550);class FB{constructor(d){this.AUa=d}rXh(d,n){n[d]=
Rb.c(this.AUa.zm)}}FB.I2h="PremiumPreviewData";Object(D.a)(FB,"PremiumPreviewDataAppender",null,[935]);var eA;(function(d){d[d.y8j=0]="triggerModel";d[d.wA=1]="ribbon";d[d.callout=2]="callout";d[d.oAq=3]="windowModeChanged";d[d.contextualCard=4]="contextualCard";d[d.i0p=5]="appLaunch";d[d.wvq=7]="skittle";d[d.twq=8]="statsDialog";d[d.Azq=9]="upsellCampaignDialog";d[d.J_p=9]="aiFeedbackSkittle"})(eA||(eA={}));Object(D.b)("HowLaunched",eA);class nw{constructor(d,n,B,Q){this.BackgroundLaunchTime=Q;this.IsBackgroundLoad=
B;this.HowLaunched=eA[d];this.PaneLaunchTime=n}}Object(D.a)(nw,"OpenPanePayload",null,[]);class xl{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd=!1,yd=!0,be=!1,ye=!1,Qe=!1,af=!1){this.Ai=d;this.Xp=n;this.pY=B;this.pBk=Q;this.lQd=ha;this.io=Aa;this.qUc=bb;this.OWe=Ib;this.aQc=oc;this.C7e=Ac;this.uIa=ad;this.jPe=sd;this.rzk=wd;this.nGk=yd;this.FRk=be;this.WUk=ye;this.XVk=Qe;this.XOk=af;this.onTaskPaneClose=()=>{this.Xp.sendMessage(Rh.a.UUi,null);this.io.isPaneOpen=!1}}init(d){this.THk=d}get sourceLocationOverrideResourceId(){return this.lQd}load(d){F.ULS.sendTraceTag(40957968,
2250,50,"Loading Ideas.");if(this.pY){var n={};n[Jy.a.ECf]=this.io.mWb.toString();this.OWe.pXh(n);this.C7e.rXh(FB.I2h,n);Object.assign(n,this.aQc.settings);n=new Kk.a((new Jh.a(Ze.a.create(),1)).toString(),xl.appId,"","",OSF.StoreType.Sdx,n);n.isModernPane=!0;G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb&&G.AFrameworkApplication.ta.Pb.vhe&&(n.isResizable=!0,n.resizeMaxWidth=920);n.featureGates=this.pBk;n.featureGates.WACIdeasDictationCorrectionsIsEnabled=this.rzk;n.featureGates.WACIdeasLicensingIsEnabled=
!0;n.featureGates.WACIdeasPremiumIsEnabled=this.io.mWb;n.featureGates.WACIdeasKeypointsIsEnabled=this.nGk;n.featureGates.WACIdeasStatsDialogIsEnabled=this.WUk;n.featureGates.WACTaskPaneBackgroundRefreshIsEnabled=this.XVk;n.featureGates.WACGoalsIsEnabled=this.uIa.PVb();n.featureGates.WACPremiumPreviewIsEnabled=this.THk;n.featureGates.WACBxPromoIsEnabled=this.jPe.isEnabled();n.featureGates.WACResumeCritiqueIsEnabled=this.FRk;n.featureGates[xl.TFh]=xl.Ywn();n.featureGates.WordEditorPerspectivesIsEnabled=
this.XOk;n.featureGates[xl.eih]=xl.ion();n.featureGates[xl.eMh]=xl.ddd();n.onTaskPaneClose=this.onTaskPaneClose;n.sharedRuntimeId=this.sourceLocationOverrideResourceId;n.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;this.Ai.createUILessSandbox(xl.appId,d,n)}else F.ULS.sendTraceTag(40957969,2250,10,"TaskPaneManager has not initialized before loading the Ideas.")}static ion(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate(xl.eih,!1)}static ddd(){return!!G.AFrameworkApplication.J&&
G.AFrameworkApplication.J.getBooleanFeatureGate(xl.eMh,!1)}static Ywn(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate(xl.TFh,!1)}}xl.appId="FA000000029";xl.TFh="Microsoft.Office.WordOnline.ProofingALV2Migration";xl.eih="Microsoft.Office.WordOnline.CopilotRibbon";xl.eMh="Microsoft.Office.WordOnline.IsSummarizationCopilotBranded";Object(D.a)(xl,"IdeasAddIn",null,[948]);class ct{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd){var be,ye;this.ga=d;this.io=n;this.Ai=
B;this.za=Q;this.hYe=ha;this.Xp=Aa;this.pKb=bb;this.Rw=oc;this.OWe=Ac;this.Sb=ad;this.C7e=sd;this.aQc=wd;this.L7=yd;this.oXe=this.vHa=!1;this.Aep=(Qe,af,Qf,hf,di)=>2!==Qf?32:this.Ai.g5(xl.appId)?this.S6m():this.n_j(Qe,af,Qf,hf,di);this.n_j=(Qe,af,Qf,hf,di)=>{if(2!==Qf)return 32;if(!this.Ai.g5(xl.appId))return this.i_(Qe,af,Qf,hf,di);this.Ai.a5b(xl.appId,this.LIi(di));return 32};this.i_=(Qe,af,Qf,hf,di)=>{if(1===Qf)return 32;cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.IdeasPaneWasLaunched"}));
af=!!di&&1===di.ShowPaneBackgroundLoad;Qf=!1;hf=1;let vj=!1;switch(Qe){case dd.a.Osd:hf=0;vj=!0;break;case dd.a.TGg:hf=2;break;case dd.a.LGg:hf=7;break;case dd.a.JGg:hf=9;break;case dd.a.ail:hf=3;break;case dd.a.w2a:hf=4;break;case dd.a.KGg:hf=5;vj=!0;break;case dd.a.XCe:hf=8;break;case dd.a.RZj:hf=9}Qe=this.LIi(di);this.za.$("WordEditorSessionLifetimeForIdeasIsEnabled")||this.oXe||(Qf=this.oXe=!0,this.hYe.load(Qe));const Wk=Object.assign(new Xc.a,{isModernPane:!0,isPaneAutoOpened:vj,sharedRuntimeId:this.hYe.sourceLocationOverrideResourceId,
sourceLocationOverrideResourceId:this.hYe.sourceLocationOverrideResourceId});di={};di[Jy.a.ECf]=this.io.mWb.toString();ct.a2o(di);this.OWe.pXh(di);this.C7e.rXh(FB.I2h,di);Object.assign(di,this.aQc.settings);Wk.DW=di;G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb&&G.AFrameworkApplication.ta.Pb.vhe&&(Wk.isResizable=!0,Wk.resizeMaxWidth=920);af?(Wk.isPreload=!0,this.io.zad=!0,this.io.HWd=Date.now(),this.Sb.pc(new tb.a(2,1,4E3,()=>{this.io.zad&&!this.Ai.g5(xl.appId)&&(F.ULS.sendTraceTag(575952149,
2250,50,"Background-loaded pane hasn't presented itself within timeout window ({0}ms); opening",4E3),Wk.isPreload=!1,this.Ai.l6(xl.appId,Wk,!0))}))):(this.io.HWd=null,this.io.zad=!1);di=this.Ai.l6(xl.appId,Wk,!0);this.Ai.a5b(xl.appId,Qe);if(!di)return F.ULS.sendTraceTag(41238555,2250,10,"Failed to show Ideas (isBackgroundLoad: {0}).",af),16;this.Ctc();this.io.v9c=hf;this.io.isPaneOpen=!0;this.io.Gmg=(new Date).getTime();Qf||this.Xp.sendMessage(Rh.a.cXf,new nw(hf,this.io.Gmg,this.io.zad,this.io.HWd));
return 32};this.launchUpsellExperience=()=>{this.Rw.execute(Qe=>{Qe.launchUpsellExperience("editorinword")});return 32};this.wmd=(Qe,af,Qf,hf,di)=>{if(1===Qf)return 32;di&&(di[Gf.a.On]=this.io.isPaneOpen,di[Gf.a.Visible]=!0);return 32};this.kvj=()=>{Object(sb.a)("ContinueReviewingEditorSuggestions",!0);this.io.isPaneOpen||G.AFrameworkApplication.va.Vb(dd.a.Qgb,2);window.removeEventListener(ct.Cbi,this.kvj)};this.jvj=()=>{Object(sb.a)("ReviewSuggestionsToOpenEditorPaneAfterShare",!0);this.io.isPaneOpen||
G.AFrameworkApplication.va.Vb(dd.a.Qgb,2);window.removeEventListener(ct.rNj,this.jvj)};((null===(be=G.AFrameworkApplication.J)||void 0===be?0:be.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1))||(null===(ye=G.AFrameworkApplication.J)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1)))&&this.addEventListener()}register(d=!1){if(this.vHa)F.ULS.sendTraceTag(50422103,2250,15,"Attempted to register Ideas add-in commands more than once.");
else{this.vHa=!0;F.ULS.sendTraceTag(40957965,2250,50,"Registering Ideas commands.");var n={},B=new ma.a;n.Editor="ButtonModel";B.add("btnWordEditor");this.ga.nb(dd.a.Qgb,S.a.frame,this.Aep,1028);this.ga.nb(dd.a.wmd,ed.a.view,this.wmd,1124);this.ga.nb(dd.a.i_,S.a.frame,this.n_j,1028);this.ga.nb(dd.a.Osd,S.a.frame,this.i_,1028);this.ga.nb(dd.a.TGg,S.a.frame,this.i_,1028);this.ga.nb(dd.a.LGg,S.a.frame,this.i_,1028);this.ga.nb(dd.a.JGg,S.a.frame,this.i_,1028);this.ga.nb(dd.a.RZj,S.a.frame,this.i_,1028);
this.ga.nb(dd.a.XCe,S.a.frame,this.i_,1028);this.ga.nb(dd.a.w2a,S.a.frame,this.i_,1028);this.za.$("GoPremiumInContextualCardIsEnabled")&&this.ga.nb(dd.a.xaj,S.a.frame,this.launchUpsellExperience,1028);(this.za.$("EditorAutoOpenIsEnabled")||this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorProactiveFromTemplateIsEnabled",!1))&&this.ga.nb(dd.a.KGg,S.a.frame,this.i_,1028);d&&this.pKb.rRa(n);zK.a.vd.addHandler(zK.a.Iqe,this.jjd.bind(this))}}static a2o(d){G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SendEduUserStateToEditorPane",
!0)&&G.AFrameworkApplication.sessionStartInfoSettings&&(d.isEduUser=G.AFrameworkApplication.sessionStartInfoSettings.IsEduUser)}S6m(){this.Ai.yOb(xl.appId);this.io.isPaneOpen=!1;return 32}LIi(d){let n=this.io.uii;d&&(d=d.PaneTitle)&&(n=d);return n}Ctc(){this.L7&&this.L7.execute(d=>{d.logActivity("WordWebEditorSeen",null)})}jjd(d,n){"View"==n.documentMode&&this.io.isPaneOpen&&G.AFrameworkApplication.va.Vb(dd.a.Qgb,2)}addEventListener(){window.addEventListener(ct.rNj,this.jvj,!0);window.addEventListener(ct.Cbi,
this.kvj,!0)}}ct.rNj="ReviewSuggestionsToOpenEditorPaneAction";ct.Cbi="ContinueReviewingSuggestionsByOpeningEditorPane";Object(D.a)(ct,"AddInCommands",null,[939]);var xu=e(153);class AK{constructor(d){this.HostSessionId=d}}Object(D.a)(AK,"HostSessionInitializedPayload",null,[]);class vv{constructor(){this.isVisible=this.isEnabled=!1;this.isEnabled=xu.a.settings.WordPredIsEnabled;this.isVisible=xu.a.J5f()}}Object(D.a)(vv,"TextPredictionPayload",null,[]);class ep{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,
Ac,ad,sd){this.Xp=d;this.GWk=n;this.wWk=B;this.Fsk=Q;this.io=ha;this.za=Aa;this.Ai=bb;this.VMh=Ib;this.kWe=oc;this.lVe=Ac;this.ebf=ad;this.aQc=sd;this.Tsh=!1}get rva(){return this.Tsh}W0n(){this.Tsh=!0;this.io.rva=!0;this.aQc.Skp()}mF(){F.ULS.sendTraceTag(41437253,2250,50,"AddInLoaded message received from Ideas SDX.");this.rva&&F.ULS.sendTraceTag(41437254,2250,15,"AddInLoaded message received more than once.");var d=this.Ai.Z$a(xl.appId);d&&""!==d?(d=window.document.getElementById(d))?(this.W0n(),
this.Xp.TEl(d),this.za.$("WordEditorSessionLifetimeForIdeasIsEnabled")&&this.Fsk.register(!0),this.wWk.execute(()=>{this.GWk.initialize();this.VMh.sEo();this.VMh.KEo();this.SWo();this.lVe.Ndn()})):F.ULS.sendTraceTag(40957967,2250,10,"Ideas loaded but the iframe couldn't be reached."):F.ULS.sendTraceTag(40957966,2250,10,"Ideas loaded but the OSF control ID is invalid. {0}",d)}SWo(){this.Xp.sendMessage(Rh.a.oUi,new AK(this.io.sessionId));xu.a.J5f()&&this.Xp.sendMessage(Rh.a.uCc,new vv);if(this.io.isPaneOpen){const d=
new nw(this.io.v9c,this.io.Gmg,this.io.zad,this.io.HWd);this.Xp.sendMessage(Rh.a.cXf,d)}this.kWe.execute(async d=>{const n=await d.isFeatureEnabled("mso_sendASmile",!0)&&G.AFrameworkApplication.uE;d=d.isFreemiumUpsellEnabled()||this.ebf.M2i();this.Xp.sendMessage(Rh.a.D$h,{enableFeedback:n,enableUpsell:d});F.ULS.sendTraceTag(556290514,2250,50,`Compliance requirement state shared with add-in; enableFeedback:${n} enableUpsell:${d}`)})}}Object(D.a)(ep,"AddInLoadedMessageHandler",null,[926]);class DF extends Sys.EventArgs{constructor(d,
n){super();this.isPaneOpen=d;this.Z5i=n}}Object(D.a)(DF,"PaneToggleEventArgs",Sys.EventArgs,[]);class Ox{constructor(d,n,B,Q,ha,Aa){this.xJa=d;this.AUa=n;this.x6e=B;this.mFh=Q;this.ebf=ha;this.WDb=Aa;this.EMc=this.tlb=this.UF=!1;this.Gmg=this.v9c=0;this.rva=!1;this.uii=null;this.zad=!1;this.HWd=null;this.xjg=(bb,Ib)=>{this.EMc!==Ib.iwb&&(this.iwb=Ib.iwb)};this.Rid=()=>{const bb=this.xcd();this.Y_e!==bb&&(this.Y_e=bb,this.xdk())};this.AUa.UMb(this.Rid);this.Y_e=this.xcd();this.WDb.yUh(this.xjg)}init(d){this.iwb=
d}get isPaneOpen(){return this.UF}set isPaneOpen(d){this.UF!==d&&(this.UF=d,this.x6e.raiseEvent("OnPaneToggle",new DF(this.UF,this.tlb,null)))}get sessionId(){return this.xJa}get iwb(){return this.EMc}set iwb(d){this.EMc!==d&&(this.EMc=d,this.xdk())}get mWb(){return this.tlb}set mWb(d){throw Error.create("Don't explicitly set this - use IsPremiumUser");}u8a(d){this.x6e.addHandler("OnPaneToggle",d)}pod(d){this.x6e.removeHandler("OnPaneToggle",d)}G8k(d){this.mFh.addHandler("OnPremiumStateChange",d)}xcd(){const d=
this.AUa.zm.state;return 1===d||6===d}xdk(){const d=this.EMc&&!this.ebf.M2i()||this.Y_e;this.tlb!==d&&(this.tlb=d,this.mFh.raiseEvent("OnPremiumStateChange",new DF(this.UF,this.tlb,null)))}}Object(D.a)(Ox,"AddInState",null,[955]);class xD{constructor(d){this.sQk=d}zKm(d){return 1===d?WacWordeditorStrings.EditorPaneTitlePreview:WacWordeditorStrings.EditorPaneTitle}$ak(d){const n=[],B={btnWordIdeas:!0},Q=String.format("btnWord{0}","Editor");B[Q]=!d;B.grpEditorProofing=!d;B.sbEditorProofing=!d;B.btnEditorProofingSubmenu=
!d;B.grpProofing=d;B.sbProofing=d;B.fseaNextSpellingError=d;n.push.apply(n,this.sQk.Z7d(B));n.push(appChrome.actions.updateGroupHiddenState("Editor",!d));appChrome.api.dispatch(n)}}Object(D.a)(xD,"AddInUtils",null,[953]);class GB{constructor(d,n,B=null){this.p2k=d;this.Qni=n;this.$s=B}FNg(){let d=!this.p2k.oXe;d&&this.Qni&&this.Qni.execute(n=>{d=d&&(null===n||void 0===n?void 0:n.b5i())});d&&this.$s&&this.$s.execute(n=>{n.logActivity(GB.g5l,null)})}}GB.g5l="EditorSuggestionsReviewedAndSuggestionsRemaining";
Object(D.a)(GB,"OpenEditorTeachingCallout",null,[]);class UH{constructor(d,n,B,Q){this.jPe=d;this.Gvk=n;this.Xp=B;this.BJc=Q;this.w4n=(ha,Aa)=>{null!==Aa.score&&this.Xp.sendMessage(Rh.a.Hmg,{editorScore:Aa.score.percentage})};this.CXo=()=>{this.Xp.sendMessage(Rh.a.Hmg,this.settings)}}get settings(){var d,n;const B={};this.jPe.isEnabled()&&(B.BxPromoData=this.Gvk.lj);B.isDarkMode=!1;Xa.a("isSharedUXDarkModeOn")&&(B.isDarkMode=appChrome.api.isSharedUXDarkModeOn());B.editorScore=null===(n=null===(d=
this.BJc.instance)||void 0===d?void 0:d.fYa())||void 0===n?void 0:n.percentage;return B}Skp(){Xa.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.CXo);this.BJc.execute(d=>d.Zif(this.w4n))}}Object(D.a)(UH,"PaneSettingsProvider",null,[]);class BK{constructor(d){this.Xp=d}mF(){F.ULS.sendTraceTag(593282780,2250,50,"GetAuthMessage message received");gg.a.Km().then(()=>{gg.a.BWd.SLf.then(d=>{this.Xp.sendMessage(Rh.a.Smf,{IsSuccess:d.isSuccess,ErrorCode:d.errorCode,ErrorMessage:d.errorMessage})}).catch(d=>
{F.ULS.sendTraceTag(593282779,2250,10,"Failed to get authenticationCompletionResult",d);this.Xp.sendMessage(Rh.a.Smf,{IsSuccess:!1,ErrorCode:"AuthenticationResultReject",ErrorMessage:"Authentication result promise rejection. Not retriable"})})})}}Object(D.a)(BK,"GetAuthResultMessageHandler",null,[926]);class CK{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad=!1){this.Lao=(sd,wd)=>{this.g3.g5(xl.appId)||this.FPk.Qmf(2,()=>{if(this.OHk){const yd={};yd.ShowPaneBackgroundLoad=wd.launchMode;this.daa.Zb(dd.a.Osd,
2,yd,null);F.ULS.sendTraceTag(594060358,2250,50,"Editor pane Auto triggered (type: {0})",wd.launchMode);this.$Ia.iwa(dd.a.Osd,!0,void 0,void 0,void 0,void 0,[Object.assign(new Ja.a,{name:"EditorPaneAutoTriggerModel",string:wd.y8j})])}this.iYe&&!this.iYe.isVisible&&(this.iYe.showCallout(wd.bSl,()=>{this.xsa.w2(2,new Date)}),this.Gpa("UserTriggeredCallout"),F.ULS.sendTraceTag(594060357,2250,50,"Editor callout was triggered"))})};this.w2=()=>{this.xsa.w2(4,new Date)};this.Zoa=(sd,wd)=>{this.xsa.w2(wd.isPaneOpen?
0:1,new Date)};this.daa=d;this.iYe=n;this.ysk=B;this.xsa=Q;this.qUc=ha;this.Xp=Aa;this.io=bb;this.g3=Ib;this.FPk=oc;this.$Ia=Ac;this.OHk=ad}initialize(){this.ysk.z3k(this.Lao);this.xsa.initialize();this.h$()}mF(d){d.MessageId===Rh.a.j4j&&this.xsa.w2(3,new Date)}h$(){this.Xp.Ht(Rh.a.j4j,this);this.qUc.e9k(this.w2);this.io.u8a(this.Zoa)}Gpa(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas."+d}))}}Object(D.a)(CK,"IdeasAutoTrigger",null,[954,926]);class VH{constructor(d,
n){this.$Ia=d;this.Hvk=n}mF(){this.$Ia.iwa(dd.a.k0l,!0);this.Hvk.$1o()}}Object(D.a)(VH,"BxPromoDismissedMessageHandler",null,[926]);var Px=e(702),Zy=e(1609);class EF extends Zy.a{constructor(d,n){super("IdeasCallout");this.numberOfWritingIssuesFound=0;this.buttonPropsList=null;this.numberOfWritingIssuesFound=d;this.buttonPropsList=n}}Object(D.a)(EF,"IdeasCalloutCustomContentProps",Zy.a,[]);class HB{constructor(d,n){this.dY=null;this.Vw=!1;this.ga=d;this.dVk=n}get isVisible(){return this.Vw}showCallout(d,
n){0>d?F.ULS.sendTraceTag(51204740,2250,10,"Number of writing issues cannot be less than zero."):G.AFrameworkApplication.ta.Pb&&G.AFrameworkApplication.ta.Pb.ZZa?this.dVk.JE.loadScript(HB.$Yk).then(()=>{Vc.UISurfaces.tN().then(B=>{var Q=new Px.a(WacWordeditorStrings.EditorCalloutOpenEditorButtonLabel,()=>{this.ga.Vb(dd.a.TGg,2);this.dismiss()});Q=new EF(d,[Q]);Q=Object.assign(new se.a,{target:HB.Xl,content:Q,showCloseIcon:!0,hasFocusableControls:!0,calloutProps:Object.assign(new Ub.a,{onDismiss:()=>
{n()},isBeakVisible:!1,directionalHint:6})});Q=B.callout(Q);const ha=Object.assign(new Md.a,{telemetryId:"IdeasCallout",onShow:()=>{this.Vw=!0}});this.dY=B.addNotification(Q,ha);return null}).catch(B=>{F.ULS.sendTraceTag(51204742,2250,10,"Notifications API failed. Error: {0}",B.toString())})}).catch(B=>{F.ULS.sendTraceTag(51401047,2250,10,"Failed to load Ideas callout strings. Error: {0}",B.toString())}):F.ULS.sendTraceTag(51204741,2250,15,"React Notifications API disabled. Cannot show the callout.")}dismiss(){Vc.UISurfaces.tN().then(d=>
{d.removeNotification(this.dY);this.Vw=!1;return this.dY=null},d=>{F.ULS.sendTraceTag(593352338,2250,10,"Failed to GetNotificationsAPIAsync: {0}",d);return null})}}HB.Xl=".WACNotificationBar";HB.$Yk="word-ideas-strings";Object(D.a)(HB,"IdeasCallout",null,[952]);var DK=e(1757);class FF extends jc.a{constructor(d,n){super("DocumentLengthConditionId");this.vba=d;this.qAh=n;this.Jxd=(B,Q)=>{this.ri(Q.wordCount>=this.qAh)}}initialize(){super.initialize();this.vba.Yif(this.Jxd);this.ri(this.vba.vC>=this.qAh)}he(){this.vba.mwg(this.Jxd);
super.he()}}Object(D.a)(FF,"DocumentLengthCondition",jc.a,[]);class WH extends jc.a{constructor(d){super("EditorPaneOpenedConditionId");this.a5a=d;this.Zoa=(n,B)=>{B.isPaneOpen?(F.ULS.sendTraceTag(546063902,2250,50,"Editor pane opened condition satisfied"),this.ri(!0)):(F.ULS.sendTraceTag(546063903,2250,50,"Editor pane opened condition unsatisfied"),this.ri(!1))}}initialize(){super.initialize();this.a5a.u8a(this.Zoa);this.ri(this.a5a.isPaneOpen)}he(){this.a5a.pod(this.Zoa);super.he()}}Object(D.a)(WH,
"EditorPaneOpenedCondition",jc.a,[]);var EK=e(1759),FK=e(1756);class GF extends jc.a{constructor(d){super("ProofingDisabledId");this.Hqo=d;this.initialized=!1;this.r0a=()=>{this.initialized&&this.ri(!this.Hqo.E3f)};d.GJg(this.r0a)}initialize(){super.initialize();this.initialized=!0;this.r0a()}he(){super.he();this.initialized=!1}}Object(D.a)(GF,"ProofingDisabledCondition",jc.a,[]);var Ql;(function(d){d.vLe="ppExpired";d.wLe="ppExpiredMetrics";d.pMe="womppShare";d.hFc="paneOpenAfterPP";d.oFc="skittle";
d.KKe="aiFeedbackFRE";d.LKe="aiFeedbackSkittle"})(Ql||(Ql={}));const aM={[Ql.vLe]:3,[Ql.wLe]:3,[Ql.pMe]:3,[Ql.hFc]:1,[Ql.oFc]:1,[Ql.KKe]:3,[Ql.LKe]:1},$y={[Ql.vLe]:0,[Ql.wLe]:0,[Ql.pMe]:0,[Ql.hFc]:0,[Ql.oFc]:0,[Ql.KKe]:0,[Ql.LKe]:0};let IB={[Ql.vLe]:!1,[Ql.wLe]:!1,[Ql.pMe]:!1,[Ql.hFc]:!1,[Ql.oFc]:!1,[Ql.KKe]:!1,[Ql.LKe]:!1};class XH extends jc.a{constructor(d){super("SkittleSuppressionId");this.osi=d}initialize(){super.initialize();this.Vvl()}async Vvl(){const d=!await this.osi.j2i(Ql.oFc);this.ri(d)}Hnp(){this.osi.Jnp(Ql.oFc);
this.ri(!1)}}Object(D.a)(XH,"SkittleSuppressedCondition",jc.a,[]);var GK=e(1758);class HF{constructor(d,n,B,Q){this.uTa=Q;this.bid=(ha,Aa)=>{for(const bb of Aa.yl)ha=bb.intent,9==ha.type&&(Aa=ha.PQ.intent,this.Lvg(Aa.id,ha.Rb.paragraph),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)?this.uTa.sendMessage(Rh.a.oyd,{payload:{annotationId:Aa.id,X3j:!0}}):this.ff.r8c(Aa,!1,"AugLoop_Core_DeleteOperation",!1))};this.ZYb=(ha,Aa)=>
{for(const bb of Aa.contents)this.VMa(bb.element,bb.intents)};this.xo=d;this.Vnh=null;n.FVa(this.ZYb);Wa.a.instance.resolve("Box4.ICharacterPropertiesEditor").pjf(this.bid);this.ff=B}VMa(d,n){if(n){var B=!1,Q=!1,ha=new ma.a;for(const Aa of n)9===Aa.type&&(B=!0,this.Vnh===Aa.id&&(Q=!0),ha.add(Aa.id));B&&(d.classList.remove(po.a.hWh,po.a.iWh,po.a.jWh),n=Q?po.a.hWh:this.XNf()?po.a.jWh:po.a.iWh,d.classList.add(n));Yv.a.un(d,"AIFeedbackIntentManager_CustomDataIntentIds",ha)}}clear(d,n){n?this.xo.fwd(B=>
n.equals(B.id),d,9):this.xo.MCb(d,9)}GEa(d,n,B,Q,ha){0>B&&(B=0);Q>d.characterData.length&&(Q=d.characterData.length);if(!(B>=Q)){var Aa=Jh.a.create();ha&&(this.Vnh=Aa);this.xo.R_a(d,new bH.a(9,B,Q,Aa,n))}}nGm(d,n){return this.xo.JMa(n,9,B=>B.PQ.intent.id===d)}Lvg(d,n){this.xo.fwd(B=>B.PQ.intent.id===d,n,9)}XNf(){return Xa.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}}Object(D.a)(HF,"AIFeedbackIntentManager",null,[]);class YH{constructor(d){this.Yqa=d}mF(){F.ULS.sendTraceTag(509380298,
2250,50,"AIFeedBack PaneClosed handleMessage");this.Yqa.Gbm()}}Object(D.a)(YH,"AIFeedbackPaneClosedMessageHandler",null,[926]);class ZH{constructor(d){this.Yqa=d}mF(){F.ULS.sendTraceTag(508838287,2250,50,"AIFeedBack PaneOpened handleMessage");this.Yqa.Hbm()}}Object(D.a)(ZH,"AIFeedbackPaneOpenedMessageHandler",null,[926]);class HK{constructor(d){this.Yqa=d}mF(d){F.ULS.sendTraceTag(508928006,2250,50,"AIFeedback report Feedback card in pane");this.Yqa.eMo(d.Values.Payload)}}Object(D.a)(HK,"AIFeedbackReportFeedbackCardHandler",
null,[926]);class $H{constructor(d){this.Yqa=d}mF(d){F.ULS.sendTraceTag(509723598,2250,50,"AIFeedBack GenerateFeedbacks handleMessage");this.Yqa.eJf(d)}}Object(D.a)($H,"AIGenerateFeedbacksMessageHandler",null,[926]);class Ck{constructor(d){this.Yqa=d}mF(d){F.ULS.sendTraceTag(509723597,2250,50,"AIFeedBack navigate feeedback handleMessage");this.Yqa.Veg(d)}}Object(D.a)(Ck,"AINavigateFeedbackMessageHandler",null,[926]);class Ah{constructor(d){this.Yqa=d}mF(d){F.ULS.sendTraceTag(509723596,2250,50,"AIFeedBack rewrite feeedback handleMessage");
this.Yqa.izg(d)}}Object(D.a)(Ah,"AIRewriteFeedbackMessageHandler",null,[926]);var yu=e(781),IF=e(370),aI=e(2125),JF;(function(d){d.Beginner="Beginner";d.Expert="Expert"})(JF||(JF={}));var bI;(function(d){d.Advertisement="Advertisement";d.Blog="Blog";d.Contract="Contract";d.Essay="Essay";d.FAQ="FAQ";d.Letter="Letter";d.Memo="Memo";d.News="News";d.Poem="Poem";d.Proposal="Proposal";d.Report="Report";d.Resume="Resume";d.Story="Story";d.UserManual="User Manual"})(bI||(bI={}));var ow;(function(d){d.Success=
"Success";d.BlockedByPostfilter="BlockedByPostfilter";d.BlockedByPrefilter="BlockedByPrefilter";d.UnexpectedError="UnexpectedError"})(ow||(ow={}));var pw;(function(d){d.OK="OK";d.BlockedByContentSafety="BlockedByContentSafety";d.BlockedByFilter="BlockedByFilter";d.BlockedByLanguage="BlockedByLanguage";d.BlockedByNPlusFiltering="BlockedByNPlusFiltering";d.BlockedByPromptInjectionCheck="BlockedByPromptInjectionCheck";d.CopilotLicenseNotAvailable="CopilotLicenseNotAvailable";d.OutputTruncated="OutputTruncated";
d.Timeout="Timeout";d.Suppressed="Suppressed";d.UnexpectedError="UnexpectedError";d.UserInputTooSmall="UserInputTooSmall";d.UserInputTruncated="UserInputTruncated"})(pw||(pw={}));var xs=e(2094),yt=e(1945),KF=e(1950),JB=e(963),qw=e(51);class LF{constructor(d){this.critiqueSource=null;this.critiqueSource=d}}Object(D.a)(LF,"ContentGenerationAppSurveyData",null,[]);class az{constructor(d){this.comment=null;this.comment=d}}Object(D.a)(az,"ContentGenerationSurveyData",null,[]);var cI=e(1402);class IK{constructor(d,
n,B,Q,ha){this.uTa=ha;this.ff=d;this.D6b=n;this.gL=B;this.pb=Q;this.xNe=!1;this.DFh=""}rAe(d){this.xNe=d}t4o(d){this.DFh=d}initialize(){const d=gg.a.Km();d&&d.then(()=>{this.ff.Cb(this,xs.b.getTypeName());this.ff.Cb(this,xs.d.getTypeName())})}XI(d=null,n=null){F.ULS.sendTraceTag(509219727,2250,50,"AIFeedBack HandleAnnotationEvent");!d||d.annotationType!==xs.b.getTypeName()&&d.annotationType!==xs.d.getTypeName()?F.ULS.sendTraceTag(509219726,2250,15,"AIFeedBack HandleAnnotationEvent - unsupported annotation"):
n===Qj.a.getTypeName()?this.E_m(d):n===ZE.a.getTypeName()&&this.w0m(d)}E_m(d){this.nmk(d)?this.Kme(d.id,!1):this.ff.r8c(d,!1,"AugLoop_Core_DeleteOperation",!1)}w0m(d){this.J$j(d)}nmk(d){const n=this.hP(d);return n?0>bf.ParagraphReader.text(n).indexOf(d.content.originalText)?(F.ULS.sendTraceTag(509203465,2250,50,"AIFeedBack IsRangeAndContentValid: Text changed before we could apply highlight {0}",d.id),!1):!0:(F.ULS.sendTraceTag(509203468,2250,50,"AIFeedBack IsRangeAndContentValid: paragraphNode could not be retrieved using annotation with Id {0}",
d.id),!1)}hP(d){d=gg.a.qbb(d.parentPath);return gg.a.cTb(this.gL.value,d)}xHm(d){let n=null;d.annotationType===xs.b.getTypeName()?n=d.content:d.annotationType===xs.d.getTypeName()?n=d.content:F.ULS.sendTraceTag(509219725,2250,50,"AIFeedBack navigateFeedback annotation are not navigational");return n}$rn(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackHighlightEnabled",!0)&&this.xNe?!0:!1}Kme(d,n){if(this.xNe&&this.$rn()){var B=this.ff.getAnnotationById(d);
if(!B)F.ULS.sendTraceTag(509219724,2250,50,"AIFeedBack navigateFeedback annotation could not be retrieved");else if(this.xHm(B)){var Q=this.hP(B);if(Q){var ha=bf.ParagraphReader.text(Q),Aa=B.content.originalText;ha=ha.indexOf(Aa);0>ha?(F.ULS.sendTraceTag(508838286,2250,50,"AIFeedBack MarkFeedback: Text changed before we could apply highlight {0}",B.id),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)?this.uTa.sendMessage(Rh.a.oyd,
{payload:{annotationId:d,X3j:!0}}):this.ff.r8c(B,!1,"AugLoop_Core_DeleteOperation",!1)):(Aa=ha+Aa.length,this.D6b.Lvg(d,Q),n&&this.pb.Uc(Di.SelectionFactory.Ie(Q,Aa)),this.D6b.GEa(Q,B,ha,Aa,n))}else F.ULS.sendTraceTag(509219723,2250,50,"AIFeedBack navigateFeedback paragraphNode could not be retrieved from tileId")}}}J$j(d){const n=this.hP(d);n?this.D6b.Lvg(d.id,n):F.ULS.sendTraceTag(509219721,2250,50,"AIFeedBack navigateFeedback paragraphNode could not be retrieved from tileId")}gzf(){this.ff.y2d(xs.a.getTypeName());
this.ff.y2d(xs.e.getTypeName());this.ff.y2d(xs.d.getTypeName());this.ff.y2d(xs.b.getTypeName())}u7h(){[xs.d.getTypeName(),xs.b.getTypeName()].forEach(async d=>{(await this.ff.getAnnotationsByType(d)).toArray().forEach(n=>{this.J$j(n)})})}KJo(){[xs.d.getTypeName(),xs.b.getTypeName()].forEach(async d=>{(await this.ff.getAnnotationsByType(d)).toArray().forEach(n=>{this.Kme(n.id,!1)})})}}Object(D.a)(IK,"AIFeedbackAnnotationHandler",null,[365]);var zt=e(1040),MF;(function(d){d.mlk="EditorPane";d.oTp="AiInsert";
d.Ribbon="Ribbon"})(MF||(MF={}));Object(D.b)("Entrypoint",MF);class JK{}Object(D.a)(JK,"ContentGenerationFeatureStateChanged",null,[]);class Qn{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi,oi){this.ga=d;this.w6a=n;this.nd=B;this.uTa=Q;this.Sb=ha;this.Sra=Aa;this.io=bb;this.Uv=Ib;this.pmb=oc;this.$s=Ac;this.Ge=ad;this.Wra=sd;this.yHa=wd;this.gfa=yd;this.fMh=be;this.yo=ye;this.ff=Qe;this.Tc=af;this.rzd=Qf;this.D6b=hf;this.gL=di;this.pb=vj;this.U6b=Wk;this.ee=
Tm;this.ni=Dk;this.Hp=gi;this.yM=oi;this.eRc=[];this.Xi=null;this.Vpj=()=>{this.CTe=Date.now()};this.Zoa=(Ni,wh)=>{!wh.isPaneOpen&&Qn.mge&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackSessionCachingEnabled",!1)?Qn.gaa.u7h():Qn.gaa.gzf(),Qn.gaa.rAe(!1))};F.ULS.sendTraceTag(528762823,2250,100,"ctor");this.CTe=Date.now();this.zgf=0;this.u$b=!1;this.Po={["type"]:"CustomControlsProps",["id"]:"WritersUnblockV2Dialog",["onGenerateContent"]:this.k5n.bind(this),
["onAddToDocument"]:this.X0n.bind(this),["reportFeedback"]:this.pMo.bind(this),["openInputFeedback"]:this.oep.bind(this,"WordEditorContentGenerationWritersUnblockSurveyCopilotBranded"),["isToneChoiceEnabled"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockToneChoiceEnabled",!0),["isModal"]:!0,["isBlocking"]:!1,["showDebugUI"]:G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockDebugUI",!1)};this.Sra.execute(Ni=>{Ni.eVh(this.Vpj)});
this.io.u8a(this.Zoa);Xg.a.instance.removeItem("summaryTuiInteractedByUser");Xg.a.instance.removeItem("writersUnblockTuiInteractedByUser");oi.execute(Ni=>{Ni.isFeatureEnabled("Copilot",!1).then(wh=>{Qn.bhe=wh;this.mkp();Qn.mge&&(Qn.gaa=new IK(Qe,this.D6b,this.gL,this.pb,this.uTa),Qn.gaa.initialize())})})}static X0f(){return Nf.a.Wu||Nf.a.Yn||!!G.AFrameworkApplication.ta&&2===G.AFrameworkApplication.ta.mode}sJf(){return Object.assign(new kj.m,{parentPath:["Signal",KF.GenerateTextAbstractiveSummarySignal.getTypeName()],
items:[Object.assign(new nv.a,{body:new KF.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]})}static get t0f(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)||Qn.bhe}static get I4f(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationSummaryEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.X0f()}static get M5f(){return this.t0f&&
G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationWritersUnblockEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.X0f()}static get mge(){return this.t0f&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1)&&G.AFrameworkApplication.J.$("WordEditorIdeasIsEnabled")&&this.X0f()}static get Xkn(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackStreamingEnabled",
!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.AiFeedbackStreaming",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackOnDemandRewriteEnabled",!1)&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.AiFeedbackUsePromptWithoutRewrite",!1)}static get ddd(){return this.t0f&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsSummarizationCopilotBranded",
!1)}dispose(){var d;F.ULS.sendTraceTag(528762824,2250,100,"disposed");null===(d=this.Xi)||void 0===d?void 0:d.dispose();for(this.Flp();0<this.eRc.length;)d=this.eRc.pop(),this.ga.Jz(d.actionId,d.contextId,d.handler);this.Sra.execute(n=>{n.$Io(this.Vpj)});this.io.pod(this.Zoa)}mc(){F.ULS.sendTraceTag(528762825,2250,100,"registering actions");0===this.eRc.length&&(this.eRc.push({actionId:dd.a.Nlg,contextId:ed.a.view,handler:this.Olg.bind(this)},{actionId:dd.a.V7d,contextId:ed.a.view,handler:this.V7d.bind(this)}),
this.eRc.forEach(d=>{this.ga.qa(d.actionId,d.contextId,d.handler);this.ga.Oc(d.actionId,1028)}))}async qpi(){F.ULS.sendTraceTag(528762826,2250,100,"ensure annotation activation");this.ldh||(this.ldh=(async()=>{F.ULS.sendTraceTag(528762827,2250,50,"activating annotations");await gg.a.Km();const d=yu.a.IB();await Promise.all([d.activateAnnotation(Object.assign(new JB.a,{annotationType:yt.WritersUnblockAnnotation.getTypeName(),handler:this.l5n.bind(this)})),d.activateAnnotation(Object.assign(new JB.a,
{annotationType:KF.TextAbstractiveSummaryAnnotation.getTypeName(),handler:this.Qkg.bind(this)}))])})());return this.ldh}async k5n(d,n,B,Q){F.ULS.sendTraceTag(528762828,2250,50,"requesting content generation");await this.qpi();this.zgf++;d=Object.assign(new Qj.a,{parentPath:["Signal",yt.WritersUnblockRequest.getTypeName()],items:[Object.assign(new nv.a,{body:new yt.WritersUnblockRequest({input:d+"\n"+n,outputLength:B||yt.OutputLength.Medium,tone:Q||yt.DocumentTone.Neutral,contextId:this.zgf.toString()})})]});
yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:d}))}async V7d(){F.ULS.sendTraceTag(528762829,2250,50,"requesting summary");await this.qpi();const d=this.sJf();yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:d}));this.ncf=!0;this.nzc({summaryState:"Busy"});this.ga.Zb(dd.a.Ofb,2,"ContentGenerationElementId-Summary");Qn.ddd?this.O9f("EditorContentGenerationSummarySurveyCopilotBranded"):this.O9f("EditorContentGenerationSummarySurvey")}X0n(d){F.ULS.sendTraceTag(528762830,2250,
50,"adding generated content");yF.a.tGg?this.nYi("WritersUnblock",d,2):this.mYi("WritersUnblock",d,2);this.u$b=!1;this.Xi.hide();this.Xi.U$("",this.rhc.bind(this),this.Eqb());this.rhc(1);this.O9f("EditorContentGenerationWritersUnblockSurveyCopilotBranded")}O9f(d){const n=this.$s;n&&n.execute(B=>{B.logActivity(d,null)})}oep(d){const n=this.$s;n&&(this.u$b&&this.Sb.pc(new tb.a(2,1,0,()=>{this.Xi.hide();this.rhc(1)})),n.execute(B=>{B.y2a(d,null)}))}Olg(d,n,B,Q,ha){F.ULS.sendTraceTag(528762831,2250,50,
"displaying dialog");if(!Object(zt.c)(n))return 2;if(1===B)return Qn.M5f?32:8;if(2!==B)return 16;if(this.u$b)return 32;try{32===this.ga.Vb(dd.a.f1c,1)&&this.ga.Vb(dd.a.f1c,2),this.Xi=new Ea.a(!1,!1,!0),this.Xi.Md=5,ha&&(this.Po.topic=ha.QDa?ha.QDa:void 0,this.Po.entryPoint=ha.entryPoint?ha.entryPoint:MF.mlk),this.Xi.ti("",this.rhc.bind(this),this.Eqb()),this.u$b=!0}catch(Aa){return 16}this.w6a.iwa(dd.a.Nlg,!0,void 0,void 0,void 0,void 0,[Object.assign(new Ja.a,{name:"ContentGenerationActor",string:"OpenWritersUnblockDialog command executed successfully."})]);
return 32}rhc(){F.ULS.sendTraceTag(528762832,2250,50,"closing content generation dialog");this.u$b=!1;this.Po.content=void 0;this.Po.u3p=0;this.Po.F4p=void 0;this.Xi.U$("",this.rhc.bind(this),this.Eqb());this.ga.Zb(dd.a.Ofb,2,"ContentGenerationElementId-WritersUnblock")}Qkg(d){F.ULS.sendTraceTag(528762833,2250,100,"summary received");if(this.ncf){var n=d.items[0];if(!kj.b.typeGuard(d))if(KF.TextAbstractiveSummaryAnnotation.typeGuard(n.body)){this.ncf=void 0;const B=n.body;"Success"!==B.status?(F.ULS.sendTraceTag(528762835,
2250,10,`Summary failed: ${B.status}, ${B.error}`),this.Tc.logActivity({name:"Summary_Failed"}),this.nzc({summaryState:"DisabledDueToError"}),this.ga.Zb(dd.a.Ofb,2,"ContentGenerationElementId-Summary"),this.TQd=Date.now()):(F.ULS.sendTraceTag(528762836,2250,50,"inserting summary"),this.Sb.pc(new tb.a(2,1,0,()=>this.lnp(B))))}else F.ULS.sendTraceTag(528762834,2250,10,`unexpected annotation: ${qw.a.getTypeNameFor(n.body)}`),this.nzc({summaryState:"DisabledDueToError"}),this.TQd=Date.now(),this.ga.Zb(dd.a.Ofb,
2,"ContentGenerationElementId-Summary")}}lnp(d){d=d.summary.split("\n");yF.a.tGg?this.nYi("Summary",["Summary"].concat(d),0):this.mYi("Summary",["Summary"].concat(d),0);this.mcf=Date.now();this.Tc.logActivity({name:"Summary_Inserted"});this.yo.ffc((n,B)=>{B.actionId===dd.a.VYf&&(F.ULS.sendTraceTag(512311951,2250,50,"Summarization: Reject via undo."),this.Tc.logActivity({name:"Summarization_Reject_via_Undo"}),this.nzc({summaryState:"Reactivated"}))});this.Sb.pc(new tb.a(2,1,0,()=>this.Wfp()));te.a.instance.Yfe();
this.nzc({summaryState:"DisabledAfterInsertion"});this.ga.Zb(dd.a.Ofb,2,"ContentGenerationElementId-Summary")}Wfp(){if(!G.AFrameworkApplication.ta.Pb.s9(0)){let d;d=new ka.a("Summary inserted","Content generated by AI might contain inaccuracies or sensitive material. Be sure to verify information.",null);d.Zfc=4;d.closeable=!0;G.AFrameworkApplication.ta.Pb.dBa(d,!0)||F.ULS.sendTraceTag(512349278,306,10,"Failed to add entry to business bar. Summarization message bar could not be shown to user.")}}zVn(d){return d.contextId?
d.contextId==this.zgf.toString():!0}l5n(d){F.ULS.sendTraceTag(528762837,2250,100,"generated content received");d=d.items[0].body;if(this.zVn(d)){var n=[];switch(d.status){case yt.Status.Success:n=d.tiles;var B=0;break;case yt.Status.BlockedByPostfilter:case yt.Status.BlockedByPrefilter:B=2;break;case yt.Status.UnexpectedError:B=1}var Q=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WritersUnblockDebugUI",!1);this.Po={...this.Po,["content"]:n.map(ha=>ha.content),["contentError"]:B,
["showDebugUI"]:Q,["debugMetadata"]:Q?btoa(JSON.stringify({status:d.status,quality:d.statusDetails,sessionId:G.AFrameworkApplication.userSessionId,Wga:G.AFrameworkApplication.Wga})):void 0};this.Xi.U$("",this.rhc.bind(this),this.Eqb())}}Eqb(){return{["hidden"]:!this.u$b,["bodyControls"]:this.Po,["uiLanguage"]:G.AFrameworkApplication.uiCulture,["id"]:"WritersUnblockV2Dialog"}}mYi(d,n,B){var Q;F.ULS.sendTraceTag(528762838,2250,50,"inserting text ({0})",B);const ha=new Mc.GraphTransaction(15);ha.Bh=
"Summary"===d?dd.a.VYf:dd.a.oYi;try{const Aa=yg.StaticActiveAppFrame.Aa().tb.Xc.Fd;let bb=Aa,Ib;this.isDocumentEmpty()&&2===B&&(B=0);switch(B){case 0:case 1:for(Ib=0===B?Ie.a.Mp(Aa):IF.a.Mp(Aa);Ib.moveNext();){const wd=Ib.currentNode;if(bf.ParagraphReader.Fcb(wd)&&bf.ParagraphReader.lc(wd)&&!bf.ParagraphReader.AZ(wd)&&("Summary"!==d||"Title"!==this.Ge.nTb(wd)&&"Subtitle"!==this.Ge.nTb(wd))){bb=wd;break}}break;case 2:bb=null!==(Q=bf.ParagraphReader.vH(te.a.instance.ob.currentSelection.Ya.node,!0,!0))&&
void 0!==Q?Q:bb}ha.Eb(bb);if("Summary"!==d&&this.C5i()){const wd=vc.a.kb(bb),yd=new vc.a;yd.Ad(wd);yd.Wd();this.Hp.xe(yd);this.ni.mA(yd,!1,!1);bb=this.ni.dN(yd)}else n=n.concat(["\n"]);const oc=ge.a.createTextRange(bb,0,0);this.ee.lf(oc,n.join("\n"),!0,!1);if("Summary"===d){const wd=ge.a.createTextRange(oc.node,0,n.join("\n").length-1);setTimeout(()=>{this.Sb.pc(new tb.a(2,1,0,()=>this.fMh.udp(wd)))},1E3)}const Ac="Summary"===d||!this.C5i(),ad=Ac?oc.Uj:0,sd=Ac?n.join("\n").length-1:n.join("\n").length;
this.gfa.GEa(oc.node,ad,sd,!0)}finally{ha.dispose()}}nYi(d,n,B){var Q;F.ULS.sendTraceTag(509155358,2250,50,"inserting text ({0})",B);const ha=new Mc.GraphTransaction(15);ha.Bh="Summary"===d?dd.a.VYf:dd.a.oYi;try{const Aa=yg.StaticActiveAppFrame.Aa().tb.Xc.Fd;let bb=Aa,Ib;this.isDocumentEmpty()&&2===B&&(B=0);switch(B){case 0:case 1:for(Ib=0===B?Ie.a.Mp(Aa):IF.a.Mp(Aa);Ib.moveNext();){const ad=Ib.currentNode;if(bf.ParagraphReader.Fcb(ad)&&bf.ParagraphReader.lc(ad)&&!bf.ParagraphReader.AZ(ad)&&("Summary"!==
d||"Title"!==this.Ge.nTb(ad)&&"Subtitle"!==this.Ge.nTb(ad))){bb=ad;break}}break;case 2:bb=null!==(Q=bf.ParagraphReader.vH(te.a.instance.ob.currentSelection.Ya.node,!0,!0))&&void 0!==Q?Q:bb}ha.Eb(bb);const oc=this.nd.cH(n,bb,0===B).toArray().slice(0,n.length),Ac=new ma.a;for(const ad of oc)Ac.add(ad);"Summary"===d?(this.ujm(oc),setTimeout(()=>{this.Sb.pc(new tb.a(2,1,0,()=>this.fMh.J0n(oc,Ac)))},1E3)):"WritersUnblock"===d&&this.wjm(oc)}finally{ha.dispose()}}ujm(d){this.pmb.$la(d[0].node,4);for(const n of d.slice(1))this.pmb.$la(n.node,
13);for(const n of d)this.gfa.GEa(n.node,n.Uj,n.Yp)}wjm(d){for(const n of d)this.pmb.$la(n.node,13);for(const n of d)this.gfa.GEa(n.node,n.Uj,n.Yp)}Vul(){F.ULS.sendTraceTag(528762839,2250,100,"checking document state");if(this.io.isPaneOpen){const d={};this.ncf?d.summaryState="Busy":300>this.jce()?d.summaryState="DisabledDueToLength":this.mcf?this.CTe>this.mcf&&(d.summaryState="Reactivated",this.mcf=void 0):this.TQd?this.CTe>this.TQd&&(d.summaryState="Reactivated",this.TQd=void 0):d.summaryState=
"Ready";this.nzc(d)}}isDocumentEmpty(){return 0===this.jce()}nzc(d){this.uTa.sendMessage(Rh.a.obi,d)}Flp(){this.rDd&&(this.Sb.Kf(this.rDd),this.rDd=void 0)}mkp(){!Qn.I4f&&!Qn.M5f||this.rDd||this.Sb.pc(this.rDd=new tb.a(3,2,3333,()=>this.Vul()))}jce(){return this.Uv.vC}pMo(d){const n=new LF("Writer's Unblock"),B=d.payload.comment.slice(0,4);this.Wra.Jja(JSON.stringify(n),JSON.stringify(new az(B)),"01b65630-d949-4b8c-9b12-dc0414a90898",uv.b);d.option===cI.a.rRb&&this.yHa.F3b(d.payload.comment[2],d.payload.comment[3],
{start:0,length:d.payload.comment[3].length},"Writer's Unblock",!0)}eMo(d){const n=new LF("AI Feedback Card"),B=d.payload.comment.slice(0,4);this.Wra.Jja(JSON.stringify(n),JSON.stringify(new az(B)),"1a762bc9-d52c-41ab-9104-fd73ad49d108",uv.b);d.option===cI.a.rRb&&this.yHa.F3b(d.payload.comment[2],d.payload.comment[3],{start:0,length:d.payload.comment[3].length},"AI Feedback Card",!0)}nRj(d,n,B){this.uTa.sendMessage(Rh.a.oyd,{payload:{annotationId:d,sec:n,X3j:B}})}async eJf(d){F.ULS.sendTraceTag(509723595,
2250,50,"AIFeedBack generateFeedbacks");this.U6b&&this.U6b.execute(B=>{B.VLa=!1});Qn.gaa.rAe(!0);Qn.gaa.gzf();var n=d.Values.Payload.documentType;d=d.Values.Payload.targetAudience;n=Object.assign(new Qj.a,{parentPath:["Signal",aI.a.getTypeName()],items:[Object.assign(new nv.a,{body:new aI.a({documentType:bI[n],targetAudience:JF[d]})})]});await augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new Kw.a,{operation:n}));F.ULS.sendTraceTag(509723594,2250,50,"AIFeedBack FeedbackRequest signal submitted")}async Veg(d){F.ULS.sendTraceTag(509723593,
2250,50,"AIFeedBack navigateFeedback");this.rzd&&this.rzd.execute(n=>{n.dismiss()});d=d.Values.Payload.annotationId;Qn.gaa.Kme(Qn.gaa.DFh,!1);Qn.gaa.Kme(d,!0);Qn.gaa.t4o(d)}async izg(d){F.ULS.sendTraceTag(509723592,2250,50,"AIFeedBack rewriteFeedback");const n=d.Values.Payload;if(d=n.annotationId){var B=this.ff.getAnnotationById(d);if(B)if(B.annotationType!==xs.d.getTypeName()&&B.annotationType!==xs.b.getTypeName())F.ULS.sendTraceTag(509195930,2250,50,"AIFeedBackRewrite received incorrect annotation, expected rewriteAnnotation");
else{var Q=Qn.gaa.hP(B);if(Q)if((d=this.D6b.nGm(d,Q))&&0!==d.count){d=d.K(0);var ha=d.Mc,Aa=d.end;this.rzd&&this.rzd.execute(bb=>{Qn.Xkn?bb.QZi(B,ha,Aa,n.sec,this.nRj.bind(this)):bb.invoke(B,ha,Aa,n.sec,this.nRj.bind(this))})}else F.ULS.sendTraceTag(509195928,2250,50,"AIFeedBackRewrite no existing Intent range found for rewrite annotation");else F.ULS.sendTraceTag(509195929,2250,50,"AIFeedBackRewrite paragraphNode could not be retrieved for rewrite annotation")}else F.ULS.sendTraceTag(509195931,2250,
50,"AIFeedBackRewrite annotation could not be retrieved with Id: {0}",d)}else F.ULS.sendTraceTag(509195932,2250,50,"AIFeedBackRewrite received empty or null annotationId from AIFeedbackPane")}async Gbm(){F.ULS.sendTraceTag(509380297,2250,50,"AIFeedBack feedbackPaneClosed");G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackSessionCachingEnabled",!1)?Qn.gaa.u7h():Qn.gaa.gzf();Qn.gaa.rAe(!1);this.U6b&&this.U6b.execute(d=>{d.VLa=!0})}async Hbm(){F.ULS.sendTraceTag(508838285,
2250,50,"AIFeedBack feedbackPaneOpened");Qn.gaa.rAe(!0);this.U6b&&this.U6b.execute(d=>{d.VLa=!1});Qn.gaa.KJo()}C5i(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphInsertion",!0)}}Qn.bhe=!1;Object(D.a)(Qn,"ContentGenerationActor",null,[11]);var dI=e(1641);class KK extends dI.a{constructor(d){super(d,"ContentGeneration")}}Object(D.a)(KK,"ContentGenerationTelemetryLoggerImpl",dI.a,[]);class LK{constructor(d){this.Yqa=d}mF(){F.ULS.sendTraceTag(538183240,
2250,50,"TriggerSummarization message received");this.Yqa.V7d()}}Object(D.a)(LK,"SummarizationMessageHandler",null,[926]);class bM{constructor(d){this.ga=d}mF(){F.ULS.sendTraceTag(537450209,2250,50,"OpenWritersUnblockDialog message received");this.ga.Vb(dd.a.Nlg,2)}}Object(D.a)(bM,"WritersUnblockMessageHandler",null,[926]);class Xj{constructor(d){this.vE=d}cdp(d){let n="";switch(d){case pb.DocumentTypeLabel.ArticlesAndReports:n="EditorContextualMessagingArticle";break;case pb.DocumentTypeLabel.ContractsAndPolicies:n=
"EditorContextualMessagingContract";break;case pb.DocumentTypeLabel.DocumentsDesignedForPrinting:n="EditorContextualMessagingDocument";break;case pb.DocumentTypeLabel.Forms:n="EditorContextualMessagingForm";break;case pb.DocumentTypeLabel.JobDescription:n="EditorContextualMessagingJobDescription";break;case pb.DocumentTypeLabel.Letters:n="EditorContextualMessagingLetter";break;case pb.DocumentTypeLabel.ListsAndNotes:n="EditorContextualMessagingList";break;case pb.DocumentTypeLabel.ManualsAndGuidelines:n=
"EditorContextualMessagingManual";break;case pb.DocumentTypeLabel.Resumes:n="EditorContextualMessagingCV";break;default:cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.UnsupportedDocumentType"}));return}null!=this.vE&&(cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.IrisCalloutTriggered"})),this.vE.execute(B=>B.logActivity(n,null)))}}Object(D.a)(Xj,"ContextualMessagingHandler",null,[946]);class Dg{constructor(){this.zKh=
!1}initialize(){}vea(){return this.zKh}w2(d){0===d&&(this.zKh=!0)}}Object(D.a)(Dg,"ContextualMessagingSuppressionModel",null,[922]);class eI{constructor(d,n,B,Q){this.Rhh=d;this.Qhh=n;this.R8b=B;this.Yxk=Q;this.umh=!1;this.n8j=(ha,Aa)=>{Aa?Aa.zja&&(this.Qhh.w2(0,new Date),this.cnp()):F.ULS.shipAssertTag(541877534,2250,!1)};this.ryb=(ha,Aa)=>{Aa.data.operationType!==kj.a.getTypeName()?F.ULS.shipAssertTag(541877535,2250,!1):Aa.data.annotation?Aa.data.annotation.annotationType!==pb.DocumentTypeClassifierAnnotation.getTypeName()?
F.ULS.shipAssertTag(541877537,2250,!1):(ha=Aa.data.annotation.content)?ha.documentTypeConfidences.length?(ha=ha.documentTypeConfidences,.7<=ha[0].confidence&&this.Yxk.cdp(ha[0].documentTypeLabel),cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.DocumentTypeReceivedFromClassifier",dataFields:[Object.assign(new Ja.a,{name:"FirstConfidence",double:ha[0].confidence}),Object.assign(new Ja.a,{name:"SecondConfidence",double:1<ha.length?ha[1].confidence:0})]})),
this.R8b.unregister()):F.ULS.shipAssertTag(541877539,2250,!1):F.ULS.shipAssertTag(541877538,2250,!1):F.ULS.shipAssertTag(541877536,2250,!1)}}initialize(){this.Qhh.initialize();this.Rhh.forEach(d=>{d.Qsa(this.n8j);d.initialize()})}he(){this.Rhh.forEach(d=>{d.NFa(this.n8j);d.he()})}cnp(){this.R8b.IJ(this.ryb);this.R8b.register();this.umh||(cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.ContextualMessaging.DocumentTypeClassifierTriggered"})),this.R8b.GCa(new KJ.a),this.umh=
!0)}}Object(D.a)(eI,"ContextualMessagingTriggerManager",null,[945,478]);class fI extends ee.a{constructor(d,n,B,Q){super(d,n,B,2250,"OnTriggerContextualMessaging");this.ywh=!1;this.lcn(Q)}async lcn(d){const n=G.AFrameworkApplication.J.$("IsO365ConsumerHost");this.ywh=(await d.rXb).Bdd&&n}$Fa(d=!0){this.ywh&&!this.xsa.vea()&&super.$Fa(d)}}Object(D.a)(fI,"ContextualMessagingSequentialTriggerModel",ee.a,[]);class gI{constructor(d,n,B){this.hIc=d;this.zd=n;this.OSk=B}mF(d){F.ULS.sendTraceTag(41682307,
2250,50,"Handling CritiqueUpsell message.");var n=d.Values.Payload;this.zRa(n)&&((d=this.OSk.sVn(n.locale,n.critiqueTypeValues))&&d.GVf?void 0!==n.idsOfUpsellCritiqueAnnotations&&null!==n.idsOfUpsellCritiqueAnnotations?(d=this.hIc.bLm(n.idsOfUpsellCritiqueAnnotations),d.length?this.hIc.BNa(d):F.ULS.sendTraceTag(41682310,2250,15,"No paragraph nodes found based on the given annotation IDs.")):void 0!==n.idsOfParagraphsWithUpsellCritiques&&null!==n.idsOfParagraphsWithUpsellCritiques?(n=this.pym(n.idsOfParagraphsWithUpsellCritiques),
n=this.hIc.cLm(n),n.length?(this.hIc.BNa(n),d.k1h&&this.zd.xja(yg.StaticActiveAppFrame.Aa().tb.py,new Ph.Selection([ge.a.jd(this.hIc.dem(n),0)],!1))):F.ULS.sendTraceTag(41682311,2250,15,"No paragraph nodes found based on the given paragraph IDs.")):F.ULS.sendTraceTag(41682312,2250,10,"Critique Upsell payload can't have both paragraph and annotation IDs undefined."):F.ULS.sendTraceTag(41682309,2250,15,"No critique type upsell settings changed"))}pym(d){const n=[];for(const B of d)try{n.push(Jh.a.Of(B))}catch(Q){F.ULS.sendTraceTag(41682313,
2250,15,"Malformed ExtendedGuid string.")}return n}zRa(d){return d&&d.locale&&d.critiqueTypeValues&&(d.idsOfParagraphsWithUpsellCritiques||d.idsOfUpsellCritiqueAnnotations)?!0:(F.ULS.sendTraceTag(41682314,2250,10,"Malformed CritiqueTypeUpsellPayload"),!1)}}Object(D.a)(gI,"CritiqueUpsellMessageHandler",null,[926]);var yD=e(347);class Go{constructor(d,n,B,Q,ha,Aa){this.ff=d;this.Zc=n;this.AJ=B;this.z7e=Q;this.DUa=ha;this.GBk=Aa}dem(d){if(1!==d.length){const n=Date.now(),B=this.z7e(yg.StaticActiveAppFrame.Aa().tb.Xc.Fd);
for(;Date.now()-n<this.GBk&&B.moveNext();)if(bf.ParagraphReader.Wh(B.iterator))for(const Q of d)if(B.iterator===Q)return Q;F.ULS.sendTraceTag(41682316,2250,50,"First paragraph not found in time, reverting to arbitrary choice.")}return d[0]}bLm(d){const n=[];for(const B of d)(d=this.ff.y_a(B))?(d=d.parent,this.cgk(d)&&n.push(d)):F.ULS.sendTraceTag(41682318,2250,15,"Couldn't find the annotation object for the given annotation ID.");return n}cLm(d){const n=[];for(const B of d)d=this.AJ.Mb(B),this.cgk(d)&&
n.push(d);return n}BNa(d){const n=this.Zc.Vc(2);try{n.set(d[0].ml);for(const B of d)this.DUa.BNa(B);this.DUa.BUd(()=>{for(const B of d)F.ULS.sendTraceTag(50434703,324,50,String.format("Paragraphnode {0} is proofed. Proofing completed task will be set to true",B.Jl)),B.zld=new yD.a,B.zld.mX(!0)})}finally{n&&n.dispose()}}cgk(d){return d&&bf.ParagraphReader.lc(d)?!0:(F.ULS.sendTraceTag(41682321,2250,15,"Node undefined or not a paragraph node."),!1)}}Object(D.a)(Go,"CritiqueUpsellParagraphNodeHelpers",
null,[943]);class hI{constructor(){this.k1h=this.GVf=!1}}Object(D.a)(hI,"SessionUpsellSettingsModificationResult",null,[]);class iI{constructor(d){this.Kjb=d}sVn(d,n){var B=rf.a.Vg(d);if(!B)return F.ULS.sendTraceTag(41682324,2250,10,"Malformed locale string."),null;d=new hI;B=B.LCID.toString();const Q=this.Kjb.fCg;let ha=Q[B];ha||(ha={},Q[B]=ha);for(const Aa of n)Aa.Id&&null!==Aa.Value?Aa.Id in ha&&ha[Aa.Id]===Aa.Value||(ha[Aa.Id]=Aa.Value,d.GVf=!0,1===parseInt(Aa.Value)&&(d.k1h=!0)):F.ULS.sendTraceTag(41682325,
2250,10,"Malformed CritiqueTypeOption.");d.GVf&&(this.Kjb.fCg=Q);return d}}Object(D.a)(iI,"SessionUpsellSettingsModifier",null,[941]);class fA{mF(){G.AFrameworkApplication.va.Vb(Se.a.Nyb,2)}}Object(D.a)(fA,"EditorSettingsDialogHandler",null,[926]);class dt{}dt.mne=100;dt.GCf="OnEditorScoreChanged";dt.ICf="OnEditorSkittleVisibilityChanged";dt.hKe="onWordCountChanged";dt.bbg=1;Object(D.a)(dt,"EditorScoreConstants",null,[]);var KB=e(1593);class qp{}qp.acronyms="Acronyms";qp.mYc="Clarity";qp.iZc="Conciseness";
qp.formality="Formality";qp.e8c="Grammar";qp.f$c="Inclusiveness";qp.perspectives="Perspectives";qp.vro="Punctuation Conventions";qp.resume="Resume";qp.$Xo="Sensitive Geopolitical References";qp.$gb="Spelling";qp.zxd="Vocabulary";Object(D.a)(qp,"CritiqueCategory",null,[]);class MK{constructor(d,n){this.percentage=d;this.Cgg=n}}Object(D.a)(MK,"EditorScore",null,[]);class NK{constructor(){this.oTf=this.wordCount=this.zxd=this.BJf=this.J_b=this.perspectives=this.f$c=this.formality=this.iZc=this.mYc=this.acronyms=
this.e8c=this.$gb=0}}Object(D.a)(NK,"EditorScoreArgs",null,[]);class jI{fYa(d,n,B,Q=!1){d=Object.assign(new NK,{mYc:this.UXa(qp.mYc,d),iZc:this.UXa(qp.iZc,d),formality:this.UXa(qp.formality,d),BJf:this.UXa(qp.$Xo,d),e8c:this.UXa(qp.e8c,d),f$c:this.UXa(qp.f$c,d),perspectives:this.UXa(qp.perspectives,d),J_b:this.UXa(qp.vro,d),$gb:this.UXa(qp.$gb,d),zxd:this.UXa(qp.zxd,d),wordCount:B,oTf:n});return this.hql(d,Q)}UXa(d,n){({value:d}=n.Nc(d,0));return d}hql(d,n=!1){if(d.wordCount<dt.mne&&!n)return null;
n=100*(2*d.$gb+1*d.e8c+(d.oTf?1===d.oTf?2:1:4)*(.25*(d.mYc+d.formality+d.f$c+d.J_b+d.zxd)+.2*(d.iZc+d.perspectives+d.BJf)))/d.wordCount;return new MK(40>=n?Math.floor(105/Math.pow(2,n/10)-5):0,d.$gb+d.e8c+d.mYc+d.iZc+d.formality+d.f$c+d.perspectives+d.J_b+d.BJf+d.zxd)}}Object(D.a)(jI,"EditorScoreCalculator",null,[]);class zD extends Sys.EventArgs{constructor(d,n=!1){super();this.score=d;this.isThinking=n}}Object(D.a)(zD,"EditorScoreChangedEventArg",Sys.EventArgs,[]);var Qx=e(2158);class gA{b5i(){var d;
return 1<=(null===(d=this.tcc.fYa(this.ySa,this.KGb,this.vba.vC,!0))||void 0===d?void 0:d.Cgg)}FNg(){if(this.b5i()){const d=Wa.a.instance.Za("Common.ISystemInitiatedFeedback");d&&d.execute(n=>{n.logActivity(gA.ezp,null)})}}constructor(d,n,B,Q,ha,Aa){var bb;this.ff=d;this.A_=n;this.vba=B;this.W7=Q;this.sa=ha;this.ewk=Aa;this.tcc=new jI;this.ySa=new ff.a;this.KGb=0;this.U3=!1;this.Fia=()=>{this.ywe(new zD(this.tcc.fYa(this.ySa,this.KGb,this.vba.vC)))};this.A8c=(Ib,oc,Ac)=>{oc!=Ac&&this.ywe(new zD(this.tcc.fYa(this.ySa,
this.KGb,this.vba.vC),1==Ac))};G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)?this.wch=[]:this.wch=[mw.a.getTypeName()];this.Jka=[mw.a.getTypeName(),KB.a.getTypeName()];(null===(bb=G.AFrameworkApplication.J)||void 0===bb?0:bb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1))&&Qx.a.i6k(this.FNg.bind(this))}initialize(){this.vba.Yif(this.Fia);return this.EG()}he(){this.vba.mwg(this.Fia);return this.s_()}EG(){if(!this.U3)return this.W7.Km().then(()=>
{for(const d of this.Jka)-1<this.wch.indexOf(d)&&this.activateAnnotation(d),this.ff.Cb(this,d),this.Qog(d),this.Are(d,!0);this.U3=!0}).catch(d=>{F.ULS.sendTraceTag(561534340,2250,10,"Unable to register skittle annotation handlers.",d)})}s_(){if(this.U3)return this.W7.Km().then(()=>{for(const d of this.Jka)this.ff.Gc(this,d),this.Are(d,!1);this.U3=!1}).catch(d=>{F.ULS.sendTraceTag(555810840,2250,10,"Unable to unregister skittle annotation handlers.",d)})}activateAnnotation(d){this.A_.getAugLoopRuntimeManager().activateAnnotation({annotationType:d,
handler:n=>{var B;if(0<(null===(B=null===n||void 0===n?void 0:n.items)||void 0===B?void 0:B.length)){for(const Q of n.items)n=Q.body,Nz.a.getTypeNameFor(n)===d&&this.D_m(n);this.ywe(new zD(this.tcc.fYa(this.ySa,this.KGb,this.vba.vC)))}}})}Qog(d){this.W7.Km().then(()=>{this.ff.getAnnotationsByType(d).then(n=>{for(const B of n)this.kub(B)})})}D_m(d){Nz.a.getTypeNameFor(d)===mw.a.getTypeName()&&this.dRi(d)}kub(d){d?(d.annotationType===mw.a.getTypeName()&&this.dRi(d.content),d.annotationType===KB.a.getTypeName()&&
(this.KGb=d.content.critiqueConfiguration.formalityGoal),this.ywe(new zD(this.tcc.fYa(this.ySa,this.KGb,this.vba.vC)))):F.ULS.sendTraceTag(561534341,2250,15,"Annotation is null.")}dRi(d){if(d){var n=this.ewk.N6j(d.categoryName);this.ySa.W(n,d.count)}else F.ULS.sendTraceTag(554567616,2250,15,"CritiqueCategoryCountAnnotation is null.")}Are(d,n){n?this.ff.WRh(this.A8c,d):this.ff.CHj(this.A8c,d)}ywe(d){this.lLk=d;this.qeh||(this.qeh=setTimeout(()=>{this.sa.raiseEvent(dt.GCf,this.lLk);this.qeh=null},gA.lqk))}XI(d,
n){!this.U3||n!==Qj.a.getTypeName()&&n!==Ax.a.getTypeName()||(d&&d.content?this.kub(d):F.ULS.sendTraceTag(545527900,2250,10,"Handled annotation is invalid"))}Zif(d){this.sa.addHandler(dt.GCf,d)}yIo(d){this.sa.removeHandler(dt.GCf,d)}fYa(){return this.tcc.fYa(this.ySa,this.KGb,this.vba.vC)}}gA.ezp="PostShareDialogClosedEditorSuggestion";gA.lqk=1E3;Object(D.a)(gA,"EditorScoreHandler",null,[938,365,478]);var NF=e(1042);class Gr extends Sys.EventArgs{constructor(d){super();this.isVisible=d}}Object(D.a)(Gr,
"EditorSkittleVisibilityChangedEventArg",Sys.EventArgs,[]);class LB{constructor(d,n,B){this.ga=d;this.SFb=n;this.Wcc=B;this.sa=new dc.a;this.ynb=this.Vw=!1;this.mjc=(Q,ha,Aa=!1)=>{this.awg();Q?this.Wcc.hide():(this.Wcc.dispose(),this.ynb=!1,F.ULS.sendTraceTag(558400652,2250,50,"Skittle closed"));ha&&(Aa?this.qVk():this.xcf(),F.ULS.sendTraceTag(543504209,2250,50,`Skittle suppressed. Forever: ${Aa}`));this.Vw=!1;this.HDj(new Gr(!1))};this.Pni=(Q,ha)=>{this.ynb&&((Q=ha.score)?this.$xe(Q,ha.isThinking,
!0):this.Wcc.hide())};this.onClick=()=>{this.ga.Vb(dd.a.LGg,2)};this.onClose=()=>{this.mjc(!1,!0)};this.onClosePermanently=()=>{this.mjc(!1,!0,!0)}}initialize(){this.SFb.Zif(this.Pni)}he(){this.SFb.yIo(this.Pni)}get isVisible(){return this.Vw}tUh(d){this.sa.addHandler(dt.ICf,d)}zIo(d){this.sa.removeHandler(dt.ICf,d)}showSkittle(d,n){this.xcf=d;this.qVk=n;d=this.SFb.fYa();this.ynb?this.Wcc.show():(this.$xe(d,!1),this.ynb=!0);this.Cif();this.Vw=!0;this.HDj(new Gr(!0))}HDj(d){this.sa.raiseEvent(dt.ICf,
d)}Cif(){var d=Ef.a.instance;const n=df.FocusManager.instance();d.Dba(ho.a.Wgb);d=n.te(ho.a.Wgb);const B=document.getElementById("ProgressCardWrapper"),Q=new fo.DOMFocusListing(()=>B);Q.$ia=!0;Q.jo(8);Q.jo(2);n.rpb(B,d,Q).nR=!0}awg(){const d=Ef.a.instance,n=df.FocusManager.instance();n.currentScope.name===ho.a.Wgb&&n.Rg(NF.a.Co);d.wz(ho.a.Wgb)}$xe(d,n,B=!1){d?(d={documentScore:d.percentage,critiqueNumber:d.Cgg,isThinking:n,onClick:this.onClick,onClose:this.onClose,onClosePermanently:this.onClosePermanently},
B?this.Wcc.update(d):this.Wcc.render(d)):F.ULS.sendTraceTag(558400653,2250,10,"Score cannot be null.")}}Object(D.a)(LB,"EditorSkittleComponent",null,[937,478]);class OF{constructor(d,n,B){this.zlh=d;this.cLb=n;this.Xcc=B;this.onClose=()=>this.Xcc.w2(5,new Date);this.onClosePermanently=()=>this.Xcc.w2(6,new Date);this.Vvd=(Q,ha)=>{ha?ha.zja?this.kGg&&this.zlh.showSkittle(this.onClose,this.onClosePermanently):this.zlh.mjc(7!==ha.id,!1):F.ULS.shipAssertTag(561071444,2250,!1)}}initialize(){this.Xcc.initialize();
this.cLb.forEach(d=>{d.Qsa(this.Vvd);d.initialize()})}he(){this.cLb.forEach(d=>{d.NFa(this.Vvd);d.he()})}get kGg(){return this.cLb.every(d=>d.Ekf())}}Object(D.a)(OF,"EditorSkittleTriggerManager",null,[919,478]);class nr extends ee.a{constructor(d,n,B){super(d,n,B,2250,"OnTriggerSkittle")}$Fa(d=!0){this.xsa.vea()||super.$Fa(d)}}Object(D.a)(nr,"SkittleSequentialTriggerModel",ee.a,[]);class AD{constructor(d,n){this.vUk=n;this.jih=0;this.KKk=d}initialize(){}vea(){return this.jih>=this.KKk?(F.ULS.sendTraceTag(558401298,
2250,50,"Trigger launch was suppressed. Reason: Reached max skittle closed this session."),!0):!1}w2(d){switch(d){case 5:this.N$n();break;case 6:this.O$n()}}O$n(){var d,n;null===(n=null===(d=this.vUk)||void 0===d?void 0:d.Hnp)||void 0===n?void 0:n.call(d);this.Gpa("UserClosedSkittlePermanently")}N$n(){this.jih++;this.Gpa("UserClosedSkittle")}Gpa(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas."+d}))}}Object(D.a)(AD,"SkittleSuppressionModel",null,[922]);class bz{constructor(){this.actionText=
this.labelText=null}}Object(D.a)(bz,"AddOnFooterData",null,[]);class MB{constructor(d){this.io=d}Mmm(d){if(!(this.io.mWb||1!==d&&2!==d&&3!==d||this.io.isPaneOpen)){if(G.AFrameworkApplication.J.$("GoPremiumInContextualCardIsEnabled"))return Object.assign(new bz,{labelText:WacWordeditorStrings.ContextualCardEditorUpsellGoPremiumLabelText,actionText:WacWordeditorStrings.ContextualCardEditorUpsellGoPremiumActionText});if(G.AFrameworkApplication.J.$("OpenEditorPaneFromContextualCardIsEnabled"))return Object.assign(new bz,
{labelText:WacWordeditorStrings.ContextualCardOpenEditorLabelText,actionText:WacWordeditorStrings.ContextualCardOpenEditorActionText})}return null}qmm(d){return d===WacWordeditorStrings.ContextualCardEditorUpsellGoPremiumActionText?(d=dd.a.xaj,{returnValue:!0,actionId:d}):d===WacWordeditorStrings.ContextualCardOpenEditorActionText?(d=dd.a.w2a,{returnValue:!0,actionId:d}):{returnValue:!1,actionId:0}}}Object(D.a)(MB,"EditorUpsellExperiment",null,[936]);class At{constructor(){this.acceptedSimilarityCitations=
this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=0}}Object(D.a)(At,"EditorUsageMetrics",null,[]);class rp{constructor(d,n,B,Q){this.M7=d;this.wPk=n;this.AUa=B;this.oh=Q;this.lpl=3E5;this.xCd=new Map;this.A8n=(ha,Aa)=>{ha=1==Aa.zm.state;!this.icf&&ha&&(this.M7.gVh(this.Jkg),this.Uen());this.icf&&!ha&&this.M7.eJo(this.Jkg);this.icf=ha};this.Jkg=(ha,Aa)=>{this.lPk||4!==Aa.g$c||(this.oh.sendTraceTag(557060744,2250,50,"Starting polling for sending metrics"),
this.lPk=!0,this.vRj())};this.Uen=()=>{const ha=this.M7.TLi();if(null===ha)this.oh.sendTraceTag(556323489,2250,15,"Session summary is null!");else{var Aa=ha.toArray().find(bb=>4==bb.NR);Aa&&Pn.Pjc.forEach(bb=>{var Ib;this.xCd.set(bb,null!==(Ib=Aa.values[bb])&&void 0!==Ib?Ib:0)})}};this.vRj=()=>{this.oh.sendTraceTag(557060745,2250,50,"Starting metric diff sending");if(this.ZYj()){var ha=this.M7.TLi();if(null!==ha){var Aa=ha.toArray().find(Ib=>4==Ib.NR),bb=new Map;Pn.Pjc.forEach(Ib=>{this.n3o(bb,Aa,
Ib)});Array.from(bb.keys()).some(Ib=>0<bb.get(Ib))&&this.wPk.RYo(bb)}setTimeout(this.vRj,this.lpl)}};this.n3o=(ha,Aa,bb)=>{Aa&&Aa.values[bb]&&(ha.set(bb,Aa.values[bb]-this.xCd.get(bb)),this.xCd.set(bb,Aa.values[bb]))}}initialize(){this.AUa.UMb(this.A8n);this.xCd=new Map([["E_Spelling_Grammar",0],["E_Refinements",0],["E_TextPrediction",0],["E_AutoCorrect",0],["E_Similarity",0]]);this.ZYj()&&(this.icf=!0,this.M7.gVh(this.Jkg))}ZYj(){return 1==this.AUa.zm.state}}Object(D.a)(rp,"ExpiryCardMetricAggregator",
null,[]);class kI{constructor(d,n,B){this.jul=(Q,ha,Aa,bb,Ib)=>{Q={data:Ib};this.io.rva&&this.Xp.sendMessage(Rh.a.s_b,Q);return 32};this.Xp=d;this.io=n;B.nb(dd.a.s_b,ed.a.view,this.jul,96)}}Object(D.a)(kI,"PremiumPreviewStateChangedMessageSender",null,[]);class PF{constructor(d){this.vPk=d}mF(d){var n;let B=1;if(null===(n=null===d||void 0===d?void 0:d.Values)||void 0===n?0:n.Payload)B=d.Values.Payload;this.vPk.start(B)}}Object(D.a)(PF,"TryPremiumPreviewMessageHandler",null,[926]);class bo{constructor(d){this.mKk=
d}Bdb(d){if(this.mKk.p$f){var n=console,B=n.log;d=d instanceof Error?JSON.stringify(d,["name","message","stack"]):JSON.stringify(d);B.call(n,d)}}}e(2124);(function(){function d(n){this.value=n;this.mYn=0}d.prototype.getNext=function(){return new d("".concat(this.value,".").concat(++this.mYn))};return d})();const BD=(d=!0)=>({jfq:"ESDK",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"mockAriaTenantToken",nexusTenantToken:1733},H4p:"Diagnostic",p$f:!0,lfq:d});class CD{constructor(d=!1){this.Sek=
d;this.Bhh=new bo(BD())}lK(d,n,B,Q){this.Sek&&this.Bhh.Bdb({message:`${B}.${n}`,data:Q})}cfj(d,n,B){this.Sek&&this.Bhh.Bdb({Tdq:`${`KPIs.${d}`}.${n}`,engagement:B,data:void 0})}}const ys=new CD;var Xu;(function(d){d.Host="Host";d.Authentication="Authentication";d.dVp="ExceptionHandling";d.Navigation="Navigation";d.SYp="UiRendering";d.T3a="FeatureSuppression";d.Acronyms="Acronyms";d.AtAGlance="AtAGlance";d.ITp="BxPromo";d.ContentCreation="ContentCreation";d.pUp="CritiqueUpsell";d.FZp="WritingAnalytics";
d.TableStyles="TableStyles";d.nFc="Similarity";d.BVp="Goals";d.Feedback="Feedback";d.OYp="TopProofingIssues";d.jXp="PremiumSquigglesPreview";d.pXp="Proofing";d.UUp="EditorScore";d.iXp="PremiumPreview";d.oVp="FirstRunExperience";d.MYp="TonalRewriteFre";d.EZp="WritersUnblock";d.XSp="AIFeedback"})(Xu||(Xu={}));var lI;(function(d){d[d.Info=0]="Info";d[d.gZp=1]="Warn";d[d.Error=2]="Error";d[d.Debug=3]="Debug"})(lI||(lI={}));var OK=e(1941);let DD;const as=()=>{DD||ys.lK(540582740,"RoamingSettingsUpdatedIsNotSet",
Xu.T3a);return DD};Object(OK.debounce)(()=>{ys.lK(542500293,"IncrementSettingCountBatchedRequest",Xu.T3a);const d=as();null===d||void 0===d?void 0:d()},1E3);let Sw=(d,n)=>{d?(Object.keys(d).forEach(B=>{$y[B]=d[B]||0}),n?(Object.keys(IB).forEach(B=>{const Q=0<=$y[B]&&$y[B]<aM[B];ys.lK(541676549,"ShouldShowFeatureInternal",Xu.T3a,{feature:B,result:Q});IB[B]=Q}),ys.lK(538969749,"SuppressionSettingsInitialized",Xu.T3a)):ys.lK(538969750,"SuppressionSettingsUpdated",Xu.T3a)):ys.lK(538969748,"SuppressionSettingsUndefined",
Xu.T3a)};class ED{constructor(d,n){this.gGb=d;this.oh=n;this.dek=async(B,Q,ha=!1)=>{try{const Aa=await this.gGb.ydb()||{};Sw(Aa,ha);this.oh.sendTraceTag(536975169,2253,50,"Editor Feature Suppression settings have changed in messenger.")}catch(Aa){ha&&Sw({},ha),this.oh.sendTraceTag(536975170,2253,10,`Editor Feature Suppression settings failed to send to pane in messenger. Error: ${Aa.message}. Stack: ${Aa.stack}`)}};DD=this.rEp=()=>{this.gGb.saveSettings($y)};this.gGb.hjf(this.dek);this.Ycn=this.dek(null,
null,!0)}async j2i(d){await this.Ycn;return this.zqn(d)}zqn(d){return!IB[d]}Knp(d){ys.lK(541636E3,"FeatureSuppressedOnce",Xu.T3a,{feature:d});IB[d]=!1;$y[d]++;999<$y[d]&&($y[d]=999,ys.lK(542199968,"IncrementSettingCountError",Xu.T3a,{feature:d}));d=as();null===d||void 0===d?void 0:d()}Jnp(d){ys.lK(542500291,"FeatureSuppressedForever",Xu.T3a,{feature:d});IB[d]=!1;$y[d]=-1;d=as();null===d||void 0===d?void 0:d()}}Object(D.a)(ED,"EditorFeatureSuppression",null,[]);class Tw{constructor(d,n,B){this.Xp=
d;this.gGb=n;this.oh=B;this.Ndn=async()=>{this.MRi(null,null,!0)};this.MRi=async(Q,ha,Aa=!1)=>{try{const bb=await this.gGb.ydb()||{};this.Xp.sendMessage(Rh.a.KFf,{settings:bb,initialize:Aa});this.oh.sendTraceTag(542745565,2253,50,"Editor Feature Suppression settings have changed in messenger.")}catch(bb){this.oh.sendTraceTag(542745566,2253,10,`Editor Feature Suppression settings failed to send to pane in messenger. Error: ${bb.message}. Stack: ${bb.stack}`)}};this.gGb.hjf(this.MRi)}async mF(d){var n,
B;try{const Q=null===(B=null===(n=null===d||void 0===d?void 0:d.Values)||void 0===n?void 0:n.Payload)||void 0===B?void 0:B.settings;Q?(await this.gGb.saveSettings(Q),this.oh.sendTraceTag(542745563,2253,50,"Editor Feature Suppression settings saved in messenger.")):this.oh.sendTraceTag(542745562,2253,15,"Editor Feature Suppression settings undefined in messenger.")}catch(Q){this.oh.sendTraceTag(542745564,2253,10,`Editor Feature Suppression settings failed to save in messenger. Error: ${Q.message}. Stack: ${Q.stack}`)}}}
Object(D.a)(Tw,"FeatureSuppressionMessenger",null,[]);class rw extends op.a{constructor(){super(...arguments);this.qba="Editor Feature Suppression";this.nIb=void 0;this.uac="FeatureSuppressionSettingsChangedEvent";this.TKc="getEditorFeatureSuppressionSettings";this.qcc="saveEditorFeatureSuppressionSettings";this.Xmb=Rt.a.DCf;this.Sic={}}ydb(){return this.Xed()}saveSettings(d){this.lj=d;return this.aqd()}async dpd(d){if(Object.keys(d).length!==Object.keys(this.lj).length||Object.keys(d).some(n=>this.lj[n]!==
d[n]))return!0;this.oh.sendTraceTag(542749394,2250,50,`Resolving conflics for ${this.qba} failed - should not save settings.`);return!1}Wec(){return Object.keys(this.lj).reduce((d,n)=>{this.lj[n]&&(d.push(n),d.push(this.lj[n]));return d},[])}Vec(){return Object.keys(this.lj).reduce((d,n)=>{this.lj[n]&&(d[n]=this.J0(this.lj[n].toString()));return d},{})}K_c(){return new JC.a(this.lj)}fkd(d){return Object.keys(d).reduce((n,B)=>{d[B]&&(n[B]=this.qfb(d[B],!0));return n},{})}}Object(D.a)(rw,"FeatureSuppressionSettingsHandler",
op.a,[]);class zu{}zu.pfo="PaneOpened";zu.nmo="PremiumPreviewSurveyNomination";zu.$4l="EditorInterceptNomination";zu.oPp="WordEditorSurvey";zu.uPp="WordIdeasSurvey";Object(D.a)(zu,"IdeasFloodgateActionId",null,[]);class mI{constructor(d,n){this.a$a=n}mF(d){this.a$a.P2c(n=>{this.G1m(n,d)})}G1m(d,n){n=n.Values.Payload;if(this.zRa(n))switch(n.actionId){case zu.pfo:case zu.nmo:case zu.$4l:d.logActivity(n.actionId,null);break;case zu.uPp:case zu.oPp:n=this.rcl(n.actionId,(G.AFrameworkApplication.uiCulture||
"en-us").toLowerCase());d.y2a(n,null);break;default:F.ULS.sendTraceTag(41448147,2250,10,"Invalid IdeasFloodgateActionId")}}zRa(d){return d&&d.actionId&&d.actionId.length?!0:(F.ULS.sendTraceTag(41448148,2250,10,"Malformed FloodgateMessagePayload"),!1)}rcl(d,n){return this.Zxf(n)?d+"-"+n:d+"-en-us"}Zxf(d){let n=!1;switch(d){case "en-us":case "en-gb":case "en-au":case "en-ca":case "en-in":case "fr-fr":case "fr-ca":case "de-de":case "es-es":case "es-mx":n=!0}return n}}Object(D.a)(mI,"FloodgateMessageHandler",
null,[926]);var FD=e(1530),wv=e(1592);class QF{constructor(d,n,B,Q,ha,Aa){this.MWe=d;this.oh=n;this.NDk=B;this.$Ia=Q;this.Sra=ha;this.io=Aa}mF(d){this.s_l();this.oh.sendTraceTag(591683598,2250,50,"GoalSelected message received");var n=d.Values.Payload;if(n&&n.formalityGoal)d=this.MHl(n.formalityGoal);else if(n)d=n.formality;else{this.oh.sendTraceTag(591683600,2250,10,"GoalSelectedMessagePayload should contain formalityGoal");return}if(n&&n.version){n=n.version;var B=[];B.push(Object.assign(new Ja.a,
{name:"FormalityGoal",string:d.toString()}));B.push(Object.assign(new Ja.a,{name:"Version",string:n}));this.$Ia.iwa(dd.a.xZm,!0,void 0,void 0,void 0,void 0,B);B=Object.assign(new FD.a,{formality:d,version:n});d=Object.assign(new wv.a,{formality:d,version:n});this.NDk.p5o(d);this.MWe.HRj(B)}else this.oh.sendTraceTag(591683601,2250,10,"GoalSelectedMessagePayload should contain version")}MHl(d){switch(d){case "Formal":return 0;case "Polished":return 1;case "Casual":return 2;default:throw Error.create("Unsupported goal!");
}}s_l(){this.Sra.instance&&this.Sra.instance.ooj(null,new ma.a,this.io.mWb)}}Object(D.a)(QF,"GoalSelectedMessageHandler",null,[926]);class et{constructor(){this.selectedGoals=null}}Object(D.a)(et,"GoalSdxSetting",null,[]);class nI{constructor(d){this.version=this.formality=null;this.formality=this.mjm(d.formality);this.version=d.version}mjm(d){switch(d){case 0:return"Formal";case 1:return"Polished";case 2:return"Casual";default:return"Formal"}}}Object(D.a)(nI,"GoalSelectedOld",null,[]);class PK{constructor(d){this.selectedGoals=
null;this.selectedGoals=new nI(d.selectedGoals)}}Object(D.a)(PK,"GoalSdxSettingOld",null,[]);class NB{constructor(d,n){this.uIa=d;this.EFd=n}pXh(d){if(this.uIa.PVb()){var n=this.EFd.QQf();n=Object.assign(new FD.a,{formality:n.formality,version:n.version});n=Object.assign(new et,{selectedGoals:n});d[NB.npl]=Rb.c(new PK(n));d[NB.mpl]=Rb.c(n)}}}NB.npl="PersistedGoals";NB.mpl="Goals";Object(D.a)(NB,"GoalsSettingsAppender",null,[934]);class GD{constructor(d,n,B){this.Sra=d;this.io=n;this._isEnabled=B}zRa(d){return d?
d.isSelected&&!d.categoryName?(F.ULS.sendTraceTag(50914531,2250,10,"Malformed CategorySelectionChangedPayload -- IsSelected without CategoryName"),!1):!d.isSelected&&d.MWh?(F.ULS.sendTraceTag(51127880,2250,10,"Malformed CategorySelectionChangedPayload -- !IsSelected with AnnotationsIdsToIgnore"),!1):!0:(F.ULS.sendTraceTag(50914530,2250,10,"Malformed CategorySelectionChangedPayload"),!1)}mF(d){if(this._isEnabled&&this.io.isPaneOpen&&(F.ULS.sendTraceTag(50914560,2250,50,"Handling CategorySelectionChanged message."),
d=d.Values.Payload,this.zRa(d))){var n=null,B=null;if(d.isSelected&&(n=d.categoryName,B=new ma.a,d.MWh))for(const Q of d.MWh)Q&&B.add(Q);this.Sra.execute(Q=>{Q.ooj(n,B,this.io.mWb)})}}}Object(D.a)(GD,"CategorySelectionChangedMessageHandler",null,[926]);class Au{constructor(d,n,B,Q){Q&&B.execute(ha=>{ha.eVh(()=>{n.rva&&d.sendMessage(Rh.a.wmi,null)})})}}Object(D.a)(Au,"EditsMadeMessageSender",null,[]);class RF{constructor(d,n,B){this.Zoa=(Q,ha)=>{ha.isPaneOpen?this.Sra.execute(Aa=>{Aa.I7n(ha.Z5i)}):
this.Sra.execute(Aa=>{Aa.U2n()})};this.jkg=(Q,ha)=>{this.Sra.execute(Aa=>{Aa.jkg(ha.Z5i)})};this.Sra=n;B&&(d.u8a(this.Zoa),d.G8k(this.jkg))}}Object(D.a)(RF,"PaneToggleHandler",null,[]);class hA{constructor(d,n,B,Q){Q&&B.execute(ha=>{ha.f7k((Aa,bb)=>{n.rva&&d.sendMessage(Rh.a.oHj,{CategoryName:bb.categoryName})})})}}Object(D.a)(hA,"ReleaseCategoryMessageSender",null,[]);class OB{constructor(d,n,B,Q){this.bQo=(ha,Aa,bb,Ib,oc)=>{this.io.rva&&this.Xp.sendMessage(Rh.a.Uyg,{cardId:oc});return 32};this.Xp=
d;this.io=n;Q&&B.nb(dd.a.Ofb,ed.a.view,this.bQo,96)}}Object(D.a)(OB,"ReturnFocusMessageSender",null,[]);var HD=e(1955);class oI{constructor(){this.Wyh=new Map;this.jLh=new Map;this.mcn(HD)}mcn(d){for(const [n,B]of Object.entries(d))this.Wyh[n]=new Set(B)}N6j(d){const n=this.jLh.get(d);if(n)return n;for(const [B,Q]of Object.entries(this.Wyh))if(Q.has(d))return this.jLh.set(d,B),B;F.ULS.sendTraceTag(524931465,2250,15,"Category name is not in loccatlist_compressed.json.");return d}}Object(D.a)(oI,"CategoryStandardization",
null,[]);class Bu{constructor(d,n,B){this.AnnotationType=d;this.OldState=n;this.NewState=B}}Object(D.a)(Bu,"AnnotationResultStatePayload",null,[]);class Dp{constructor(d,n,B,Q){Q&&B.execute(ha=>{ha.Z7k((Aa,bb)=>{n.rva&&d.sendMessage(Rh.a.IWh,new Bu(bb.annotationType,bb.oldState,bb.newState))})})}}Object(D.a)(Dp,"AnnotationResultStateMessageSender",null,[]);class QK{constructor(d,n){this.Sra=d;this._isEnabled=n}zRa(d){return d?d.annotationType?!0:(F.ULS.sendTraceTag(571786329,2250,10,"Malformed AnnotationResultStateSubscriptionPayload -- No AnnotationType"),
!1):(F.ULS.sendTraceTag(571786328,2250,10,"Malformed AnnotationResultStateSubscriptionPayload"),!1)}mF(d){if(this._isEnabled){F.ULS.sendTraceTag(571786330,2250,50,"Handling CategorySelectionChanged message.");var n=d.Values.Payload;this.zRa(n)&&this.Sra.execute(B=>{B.Are(n.annotationType,n.subscribe)})}}}Object(D.a)(QK,"AnnotationResultStateSubscriptionMessageHandler",null,[926]);class pI{constructor(d,n){this.Tb=d;this.MHe=n}mF(d){try{if(null!==d&&void 0!==d&&d.Values){var n=d.Values.Payload;if(n&&
n.actionId){const B=this.Tb.Zb(n.actionId,1,n.additionalData);2===B?this.MHe.sendTraceTag(542749405,2250,15,"Attempting to call an unregistered action from Editor Pane"):this.MHe.sendTraceTag(542737885,2250,50,`Calling action ${n.actionId} from Ideas returned response ${B}`)}}else this.MHe.sendTraceTag(542737884,2250,15,"Attempting to IdeasCallActionMessageHandler without a payload")}catch(B){this.MHe.sendTraceTag(542749406,2250,10,"Error while attempting to call an action in IdeasCallActionMessageHandler")}}}
Object(D.a)(pI,"IdeasCallActionMessageHandler",null,[926]);class RK{constructor(d){this.suh=!1;this.Jnb=null;this.Tw=d;this.Tw.Pla(Bp.Rni);this.Tw.Pla(Bp.Oni)}TEl(d){F.ULS.sendTraceTag(41437255,2250,50,"Attempting to connect the Ideas Messenger to Ideas SDX iframe.");d?this.suh?F.ULS.sendTraceTag(40957973,2250,10,"Attempted to connect the Ideas Messenger to add-in more than once."):(this.Jnb=d,this.suh=!0):F.ULS.sendTraceTag(40957972,2250,10,"Attempted to connect the Ideas Messenger to undefined add-in iframe.")}Ht(d,
n){F.ULS.sendTraceTag(41437256,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",d);if(d&&""!==d)if(n){var B=!1;this.Tw.isEnabled()&&(this.Tw.$w(d),B=this.Tw.DG(d,Object(X.a)(n,n.mF,"handleMessage")));B||F.ULS.sendTraceTag(40957976,2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",d)}else F.ULS.sendTraceTag(41448149,2250,10,"Attempted to register null IIncomingMessageHandler.");else F.ULS.sendTraceTag(40957974,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(d,
n){if(this.Jnb){var B=this.Jnb.src;this.Tw.i3f(B)?Array.contains(Bp.vWh,d)?this.Tw.lgb(Object.assign(new Iy.a,{MessageId:d,SendTime:Date.now(),Values:{["Payload"]:n}}),this.Jnb.contentWindow,T.a.getOrigin(B))||F.ULS.sendTraceTag(41437258,2250,10,"Failed to send a message with MessageTypeId [{0}].",d):F.ULS.sendTraceTag(40957979,2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",d):F.ULS.sendTraceTag(41206103,2250,10,"Attempted to send a message to origin that's not allowed.")}else F.ULS.sendTraceTag(40957978,
2250,15,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",d)}}Object(D.a)(RK,"IdeasMessenger",null,[931]);class cz{constructor(d){this.Rw=d}zRa(d){return d?d.experienceId?!0:(F.ULS.sendTraceTag(594106403,2250,10,"Malformed InvokeLicensingUpsellPayload using fallback value. Error: ExperienceId is null"),!1):(F.ULS.sendTraceTag(594106432,2250,10,"Malformed InvokeLicensingUpsellPayload using fallback value. Error: payload is null"),!1)}mF(d){F.ULS.sendTraceTag(594106402,
2250,50,"Handling InvokeLicensingUpsell message.");d=d.Values.Payload;const n=this.zRa(d)?d.experienceId:"editorinword";this.Rw.execute(B=>{B.launchUpsellExperience(n)})}}Object(D.a)(cz,"InvokeLicensingUpsellMessageHandler",null,[926]);class SK{constructor(d){this.ga=d}mF(){this.ga.Vb(dd.a.i_,2)}}Object(D.a)(SK,"OpenPaneMessageHandler",null,[926]);class SF{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf,hf,di,vj,Wk,Tm,Dk,gi,oi,Ni){this.Xp=d;this.Isk=n;this.syk=B;this.$Bk=Q;this.PNk=
ha;this.dwk=Aa;this.jUk=bb;this.kGk=Ib;this.iUk=oc;this.VUk=Ac;this.FCk=ad;this.tWk=sd;this.QNk=wd;this.MNk=yd;this.MDk=be;this.pXk=ye;this.utk=Qe;this.Ivk=af;this.YEk=Qf;this.lVe=hf;this.Yrk=di;this.vWk=vj;this.ctk=Wk;this.dtk=Tm;this.etk=Dk;this.$sk=gi;this.btk=oi;this.atk=Ni}register(){this.Xp.Ht(Rh.a.TUi,this.Isk);this.Xp.Ht(Rh.a.v$j,this.syk);this.Xp.Ht(Rh.a.T7j,this.$Bk);this.Xp.Ht(Rh.a.fse,this.PNk);this.Xp.Ht(Rh.a.g5h,this.dwk);this.Xp.Ht(Rh.a.D8j,this.jUk);this.Xp.Ht(Rh.a.NZi,this.kGk);this.Xp.Ht(Rh.a.H4h,
this.iUk);this.Xp.Ht(Rh.a.rjd,this.VUk);this.Xp.Ht(Rh.a.Olg,this.Yrk);this.Xp.Ht(Rh.a.uJf,this.vWk);this.Xp.Ht(Rh.a.Jyi,this.FCk);this.Xp.Ht(Rh.a.uCc,this.tWk);this.Xp.Ht(Rh.a.zvj,this.QNk);this.Xp.Ht(Rh.a.eco,this.MNk);this.Xp.Ht(Rh.a.EVo,this.MDk);this.Xp.Ht(Rh.a.cOg,this.pXk);this.Xp.Ht(Rh.a.R3j,this.utk);this.Xp.Ht(Rh.a.i0l,this.Ivk);this.Xp.Ht(Rh.a.Ujk,this.YEk);this.Xp.Ht(Rh.a.KFf,this.lVe);this.Xp.Ht(Rh.a.eJf,this.ctk);this.Xp.Ht(Rh.a.Veg,this.dtk);this.Xp.Ht(Rh.a.izg,this.etk);this.Xp.Ht(Rh.a.H$k,
this.$sk);this.Xp.Ht(Rh.a.J$k,this.btk);this.Xp.Ht(Rh.a.I$k,this.atk)}}Object(D.a)(SF,"PostMessageHandlers",null,[932]);var ID=e(1418);class uj extends ID.a{constructor(){super();this.category=0;this.documentContext=null;this.userInteracted=this.platform=this.howLaunched=0;this.H_=Object.assign(new Vt.a,{T_:uj.getTypeName(),B_:uj.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_IdeasEngagementSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(D.a)(uj,"IdeasEngagementSignal",
ID.a,[]);var In;(function(d){d[d.scroll=0]="scroll";d[d.click=1]="click";d[d.jzc=2]="seen";d[d.wsc=3]="kept"})(In||(In={}));Object(D.b)("Engagement",In);class Wt extends Sys.EventArgs{constructor(d=null){super();this.PAk=d}get eventType(){return this.PAk||""}}Object(D.a)(Wt,"UserEngagementEventArgs",Sys.EventArgs,[]);class iA{constructor(d,n,B){this.sa=new dc.a;this.F2e=this.iec=this.UF=this.nUe=!1;this.v2e=new ff.a;this.ZFb=this.gJb=null;this.Zoa=(Q,ha)=>{this.UF!==ha.isPaneOpen&&((this.UF=ha.isPaneOpen)?
this.gJb=new Date:(this.gJb=null,this.$1c()),this.GNo())};this.io=d;this.Tuk=n;d.u8a(this.Zoa);B.Ht(Rh.a.mfk,this)}get id(){return 2}get Qvc(){return this.gJb}get n2c(){return this.ZFb}e9k(d){this.sa.addHandler("UserEngagement",d)}mF(d){d&&d.MessageId===Rh.a.mfk&&(d=(d="object"===typeof d.Values.Payload?d.Values.Payload:null)?"string"===typeof d.eventType?d.eventType:null:"scroll",!this.iec&&this.C0f(d)&&this.Wug())}nhg(d,n){d=n.annotation;n=60===n.annotationState?"kept":null;!this.iec&&!gg.a.jg(n)&&
d&&Nz.a.getTypeNameFor(d.content)===Lw.a.getTypeName()&&this.C0f(n)&&this.Wug()}H6n(d){ja.a.Oh().equals(d,"seen")&&(this.F2e=!0);const n=ja.a.Oh().equals(d,"kept")?this.F2e:!0;!this.iec&&n&&this.C0f(d)&&this.Wug()}tQn(){this.v2e.add(eA[0],3)}C0f(d){if(!this.io.isPaneOpen)return!1;const n=eA[this.io.v9c];return this.v2e.Bb(n)?ja.a.Oh().equals(In[this.v2e.K(n)],d):ja.a.Oh().equals("scroll",d)||ja.a.Oh().equals("click",d)}Wug(){this.ZFb=new Date;this.iec=!0;this.sa.raiseEvent("UserEngagement",new Wt);
this.$1c()}$1c(){this.nUe||(this.Tuk.emit(Object.assign(new uj,{category:0,howLaunched:this.yKm(),platform:0,userInteracted:this.iec?2:1})),this.nUe=!0)}yKm(){return this.io.v9c&&5!==this.io.v9c?1:0}GNo(){this.nUe=this.iec=this.F2e=!1;this.ZFb=null}}Object(D.a)(iA,"UserEngagementMonitor",null,[926,928,929]);class Mg{emit(d){return gg.a.Km().then(()=>{yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:Object.assign(new Qj.a,{items:[Object.assign(new nv.a,{body:d})],parentPath:["Signal",uj.getTypeName()]})}))})}}
Object(D.a)(Mg,"UserEngagementSignalBeacon",null,[930]);var qI=e(1468),rI=e(1560);class jA{}jA.vfc="SimilarityCheck";Object(D.a)(jA,"SimilarityConstants",null,[]);class TK{constructor(d){this.ff=d}mF(){F.ULS.sendTraceTag(593761943,2250,50,"CancelSimilarityCheck message received");this.ff.releaseAnnotation(qI.a.getTypeName(),jA.vfc);this.ff.releaseAnnotation(rI.a.getTypeName(),jA.vfc)}}Object(D.a)(TK,"SimilarityCancelMessageHandler",null,[926]);var Rd=e(1785);class dz extends ID.a{constructor(){super();
this.runId=null;this.H_=Object.assign(new Vt.a,{T_:dz.getTypeName(),B_:dz.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SimilarityCheckSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(D.a)(dz,"SimilarityCheckSignal",ID.a,[]);class sI{constructor(d,n){this.ff=d;this.Hfa=n}mF(d){F.ULS.sendTraceTag(593761942,2250,50,"TriggerSimilarityCheck message received");(d=d.Values.Payload)&&d.runId?d=d.runId:(F.ULS.sendTraceTag(593761941,2250,15,"SimilarityCheckMessagePayload should contain runId"),
d=Date.now());const n=Object.assign(new Qj.a,{parentPath:["Signal",dz.getTypeName()],items:[Object.assign(new nv.a,{body:Object.assign(new dz,{runId:d})})]});gg.a.Km().then(()=>{this.ff.activateAnnotation(qI.a.getTypeName(),jA.vfc).then(()=>{this.ff.activateAnnotation(rI.a.getTypeName(),jA.vfc).then(()=>{yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:n}));this.Hfa.d4o(Rd.a.IDe)})})})}}Object(D.a)(sI,"SimilarityCheckerMessageHandler",null,[926]);class PB{constructor(d){this.Tb=d}mF(){F.ULS.sendTraceTag(592255044,
2250,50,"OpenStatsDialog message received");this.Tb.Vb(dd.a.Yre,2)}}Object(D.a)(PB,"StatsDialogMessageHandler",null,[926]);class cM{constructor(d,n,B,Q=null){this.AUa=d;this.Xp=n;this.io=B;this.Jak=()=>{this.io.rva&&this.Xp.sendMessage(Rh.a.uCc,new vv);this.JXk()};this.AIp=()=>{xu.a.Wje=this.xcd();this.Jak()};this.xcd=()=>1===this.AUa.zm.state;this.JXk=null!==Q&&void 0!==Q?Q:()=>{this.zIp()};xu.a.Wje=this.xcd();this.AUa.UMb(this.AIp);this.Jak()}zIp(){const d=xu.a.eke();yg.StaticActiveAppFrame.Aa().Ne();
const n=Array(2);n[0]="ShowWordPredictionDialog";n[1]=d;G.AFrameworkApplication.va.Zb(Se.a.wEe,2,n);appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("WordPredictionOptions",!d)])}}Object(D.a)(cM,"PremiumPreviewTextPredictionHandler",null,[]);var tI=e(1173);class uI{constructor(d,n){this.uTa=d;this.io=n}mF(d){d&&d.MessageId===Rh.a.uCc&&(d=d.Values.Payload,this.zRa(d)&&(xu.a.wdk(d.isEnabled,23),yg.StaticActiveAppFrame.Aa().Ne()))}KEo(){tI.a.z8k(()=>{this.uTa.sendMessage(Rh.a.Uyg,{cardId:"shellTextPredictionSettingCard"})})}sEo(){tI.a.A8k(()=>
{this.io.rva&&this.uTa.sendMessage(Rh.a.uCc,new vv)})}zRa(d){return d?!0:(F.ULS.sendTraceTag(591987233,2250,10,"Malformed TextPredictionPayload"),!1)}}Object(D.a)(uI,"TextPredictionComponent",null,[927,926]);var JD=e(1186);class vI{mF(){const d=Wa.a.instance.resolve("Box4.WordPredictionActor"),n={};n[JD.a.Ohb]=23;d.tBb(parseInt(Se.a.tBb),null,2,null,n)}}Object(D.a)(vI,"TextPredictionDialogHandler",null,[926]);class UK{initialize(){return gg.a.Km()}}Object(D.a)(UK,"TileEventsHandler",null,[925]);class wI{constructor(d){this.yCk=
d}execute(d){this.yCk.execute(()=>{d(this)})}}Object(D.a)(wI,"TileViewAdapter",null,[924]);var ez=e(485);class kA{constructor(d,n,B){this.hLb=d;this.DBc=B;this.UF=this.zHb=!1;this.Y7n=(Q,ha)=>{this.UF=ha.isPaneOpen;this.mnj()};this.YLh=[];this.$6j=(Q,ha,Aa)=>{if(1===Aa)return 32;this.zHb=!this.zHb;this.mnj();Q={["ToggleProofingRibbon"]:appChrome.selectors.getModelType("ToggleProofingRibbon")};this.rJ.OW(ez.a.a7j);yg.StaticActiveAppFrame.Aa().UH(Q);return 32};this.LHp=(Q,ha,Aa,bb,Ib)=>{if(!Ib)return 16;
if(1===Aa)return 32;Q=this.wbe();Q=this.zHb?Q.HQo:Q.IQo;Ib[Qk.a.Visible]=!this.UF;Ib[Qk.a.LabelText]=Q;Ib=[appChrome.actions.setControlIconSet("ToggleProofingRibbon",{["default"]:this.zHb?"SpellingIssue_20":"HideProofingErrors_20"})];appChrome.api.dispatch(Ib);return 32};this.MHp=(Q,ha,Aa,bb,Ib)=>{if(!Ib)return 16;if(1===Aa)return 32;ha=this.wbe();Q=this.zHb?ha.slp:ha.tlp;ha=this.zHb?ha.$tp:ha.aup;Ib[Qk.a.Visible]=!this.UF;Ib[Qk.a.LabelText]=Q;Ib[V.a.customTooltip]=ha;return 32};n.u8a(this.Y7n)}get E3f(){return this.zHb&&
!this.UF}get rJ(){return this.xla=this.xla||this.hLb()}GJg(d){this.YLh.push(d)}mnj(){this.YLh.forEach(d=>d());this.DBc.wye()}mc(){const d=G.AFrameworkApplication.va;d.qa(dd.a.b7j,ed.a.view,this.$6j);d.nb(dd.a.pDj,ed.a.application,this.LHp,96);d.qa(dd.a.Z6j,ed.a.view,this.$6j);d.nb(dd.a.oDj,ed.a.application,this.MHp,96)}wbe(){return{tlp:WordRibbonStrings.ToggleProofingOn,slp:WordRibbonStrings.ToggleProofingOff,aup:WordRibbonStrings.ToggleProofingTooltipOn,$tp:WordRibbonStrings.ToggleProofingTooltipOff,
IQo:WordRibbonStrings.ToggleProofingInRibbonDisable,HQo:WordRibbonStrings.ToggleProofingInRibbonEnable}}}Object(D.a)(kA,"ToggleProofingActor",null,[]);class fz{constructor(d,n,B,Q,ha,Aa,bb){this.a8e=ha;this.Ach=[];if(0!==this.a8e)switch((bb.HWb()||Aa)&&this.bUd(B),this.bUd(Q),this.a8e){case 3:case 5:case 4:this.bUd(d);break;case 1:case 6:case 2:this.bUd(n)}}bUd(d){d?(this.Ach.push(d),d.initialize()):F.ULS.sendTraceTag(539784090,2250,10,"Trying to initialize undefined Ideas trigger model for proactive experiment {0}",
this.a8e)}z3k(d){this.Ach.forEach(n=>{n.Qsa(d)})}}Object(D.a)(fz,"ActiveIdeasTriggerModels",null,[]);class Xt extends Sys.EventArgs{constructor(d,n,B=""){super();this.bSl=d;this.launchMode=n;this.y8j=B}}Object(D.a)(Xt,"TriggerEventArgs",Sys.EventArgs,[]);class xv{constructor(d,n,B,Q,ha,Aa){this.sa=new dc.a;this.z1d={};this.ff=d;this.xsa=n;this.daa=B;this.launchMode=Q;this.mXk=ha;this.CUk=Aa}initialize(){this.daa.WZ(this);this.EBo()}he(){}XI(d){d.content&&d.annotationType===mw.a.getTypeName()&&(d=
d.content,this.z1d[d.categoryName]=d.count)}Qsa(d){this.sa.addHandler("OnTriggerIdeas",d)}NFa(d){this.sa.removeHandler("OnTriggerIdeas",d)}H5(){}F5(d){2===d.behavior&&this.q8c(d)}q8c(){}EBo(){gg.a.Km().then(()=>{yu.a.IB().activateAnnotation(Object.assign(new JB.a,{annotationType:mw.a.getTypeName(),handler:d=>{if(d&&d.items&&0<d.items.length)for(const n of d.items)d=n.body,Nz.a.getTypeNameFor(d)===mw.a.getTypeName()&&(this.z1d[d.categoryName]=d.count)}}));this.ff.Cb(this,mw.a.getTypeName())})}kAb(){const d=
this.YJm();(0<d||!this.CUk)&&this.xsa&&!this.xsa.vea()&&this.sa.Cha&&this.sa.raiseEvent("OnTriggerIdeas",new Xt(d,this.launchMode,this.mXk))}YJm(){let d=0;for(const n in this.z1d)d+=this.z1d[n];return d-1}}Object(D.a)(xv,"TriggerModelBase",null,[880,365,113]);class yv extends xv{constructor(d,n,B,Q,ha,Aa=0){super(d,n,B,Aa,"CritiqueAcceptNoTypingTriggerModel",!0);this.RFb=new Uj.a;this.ACf=new ma.a;this.Oxk=ha;this.hUe=Q}initialize(){this.vYf();super.initialize()}q8c(d){this.RFb.contains(d.actionId)&&
(this.ACf.add(d),this.kAb())}kAb(){this.B0f()&&super.kAb()}B0f(){let d=0;const n=Date.now();if(3E4>n-this.Oxk.yke)return!1;for(let B=this.ACf.count-1;0<=B&&!(3E4<n-this.ACf.K(B).startTime.getTime());B--)if(d++,d>=this.hUe)return!0;return!1}vYf(){this.RFb.add(Se.a.iya);this.RFb.add(Se.a.CLa)}}Object(D.a)(yv,"CritiqueAcceptNoTypingTriggerModel",xv,[]);class Fh extends xv{constructor(d,n,B,Q,ha=0){super(d,n,B,ha,"CritiqueAcceptTriggerModel",!0);this.gUe=0;this.RFb=new Uj.a;this.hUe=Q}initialize(){this.vYf();
super.initialize()}q8c(d){this.RFb.contains(d.actionId)&&(this.gUe++,this.kAb())}kAb(){this.B0f()&&super.kAb()}B0f(){return this.gUe>=this.hUe?(this.gUe=0,!0):!1}vYf(){this.RFb.add(Se.a.iya);this.RFb.add(Se.a.CLa)}}Object(D.a)(Fh,"CritiqueAcceptTriggerModel",xv,[]);class Uw extends Tq.a{constructor(){super();this.isIdeasPaneTriggerLaunchSuppressed=!1;this.H_=Object.assign(new Vt.a,{T_:Uw.getTypeName(),B_:Uw.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(Uw,"IdeasPersonalizationSettingsAnnotation",Tq.a,[]);class QB{constructor(d){this.yvh=!1;this.ff=d}get d6i(){return this.yvh}initialize(){gg.a.Km().then(()=>{this.ff.Cb(this,Uw.getTypeName())})}XI(d){d.content&&d.annotationType===Uw.getTypeName()&&(this.yvh=d.content.isIdeasPaneTriggerLaunchSuppressed,F.ULS.sendTraceTag(575193412,2250,50,String.format("Received cross session suppression settings value of {0}",this.d6i)))}}Object(D.a)(QB,"CrossSessionSuppressionHandler",null,[923,365]);
class KD{constructor(){this.cIc=0}vea(){return 1<=this.cIc?(F.ULS.sendTraceTag(593843599,2250,50,String.format("Trigger launch suppressed. Reason: Max number of callout ({0}) per session reached for freemium user",1)),!0):!1}initialize(){}w2(d){2===d&&this.LUf()}LUf(){this.cIc++;this.Gpa("UserClosedCallout")}Gpa(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas."+d}))}}Object(D.a)(KD,"FreemiumSuppressionModel",null,[922]);class VK{constructor(d,n,B,Q){this.s_e=this.sPh=
!1;this.cIc=this.kih=0;this.K1e=this.L1e=null;this.agf=this.PFd=this.aQh=!1;this.daa=d;this.C1d=n;this.Bmj=B;this.wij=Q}initialize(){this.daa.WZ(this);this.C1d&&this.C1d.initialize()}vea(){return this.kih>=this.wij||this.cIc>=this.wij?(F.ULS.sendTraceTag(594060355,2250,50,"Proactive launch was suppressed. Reason: Reached max pane closed reached this session."),!0):this.L1e&&(new Date).getTime()-this.L1e.getTime()<this.Bmj||this.K1e&&(new Date).getTime()-this.K1e.getTime()<this.Bmj?(F.ULS.sendTraceTag(594060354,
2250,50,"Proactive launch was suppressed. Reason: Last proactive launch is within the NoTriggerWindow."),!0):this.aQh?(F.ULS.sendTraceTag(594060353,2250,50,"Proactive launch was suppressed. Reason: No user engagement."),!0):this.sPh?(F.ULS.sendTraceTag(594060352,2250,50,"Proactive launch was suppressed.Reason:User suppressed further proactive launches this session."),!0):this.C1d&&this.C1d.d6i?(F.ULS.sendTraceTag(575193413,2250,50,"Proactive launch was suppressed.Reason:Proactive launch is suppressed across session."),
!0):!1}w2(d,n){switch(d){case 0:this.s_e=!0;break;case 1:this.h1m(n);break;case 2:this.LUf(n);break;case 4:this.p3m();break;case 3:this.O2m()}}H5(){}F5(d){2===d.behavior&&this.s_e&&(d.actionId===dd.a.i_||d.actionId===dd.a.Qgb?this.agf=!1:d.actionId===dd.a.Osd&&(this.agf=!0))}h1m(d){this.agf?(this.kih++,this.L1e=d,this.PFd?this.Gpa("TriggerLaunchedIdeasPaneClosedAfterEngagement"):(this.aQh=!0,this.Gpa("TriggerLaunchedIdeasPaneClosedWithoutEngagement"))):this.PFd?this.Gpa("UserLaunchedIdeasPaneClosedAfterEngagement"):
this.Gpa("UserLaunchedIdeasPaneClosedWithoutEngagement");this.PFd=this.s_e=!1}LUf(d){this.cIc++;this.K1e=d;this.Gpa("UserClosedCallout")}p3m(){this.PFd=!0;this.Gpa("UserEngagedWithPaneFirstTimeInPaneSession")}O2m(){this.sPh=!0;this.Gpa("UserClickedToSuppressTheAutoLaunch")}Gpa(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas."+d}))}}Object(D.a)(VK,"HeuristicSuppressionModel",null,[922,113]);class LD extends xv{constructor(d,n,B,Q,ha,Aa=0){super(d,n,B,Aa,"PremiumPreviewExpiredTriggerModel",
!1);this.zUa=Q;this.wlh=ha;this.fse=()=>{super.kAb();this.wlh.Knp(Ql.hFc)};this.xvj=async(bb,Ib)=>{bb=2===Ib.zm.state||5===Ib.zm.state;Ib=await this.wlh.j2i(Ql.hFc);bb&&!Ib&&this.fse()}}initialize(){super.initialize();const d=this.zUa.zm;d&&4!=d.state?this.xvj(void 0,new XC(d)):this.zUa.UMb(this.xvj)}q8c(){}}Object(D.a)(LD,"PremiumPreviewExpiredTriggerModel",xv,[]);class xI extends xv{constructor(d,n,B,Q,ha=0){super(d,n,B,ha,"PremiumPreviewInProgressTriggerModel",!1);this.Dco=(Aa,bb)=>{1===bb.zm.state&&
super.kAb()};this.zUa=Q}initialize(){super.initialize();this.zUa.UMb(this.Dco)}q8c(){}}Object(D.a)(xI,"PremiumPreviewInProgressTriggerModel",xv,[]);class zl{constructor(d){this.fdh=!1;this.yaf=d}vea(){if(this.fdh)return!0;this.yaf.vea()||(this.fdh=!0);return this.yaf.vea()}initialize(){}w2(d,n){this.yaf.w2(d,n)}}Object(D.a)(zl,"PremiumPreviewSuppressionModel",null,[922]);class Rx extends Sys.EventArgs{constructor(d){super();this.wordCount=d}}Object(D.a)(Rx,"WordCountAggregationEventArg",Sys.EventArgs,
[]);class RB{}RB.wkf="awccek";Object(D.a)(RB,"WordCountConstants",null,[]);class or{constructor(d,n,B,Q,ha){this.ff=d;this.QM=n;this.a5a=B;this.W7=Q;this.sa=ha;this.U3=!1;this.vC=0;this.Fia=()=>{this.a5a.rva||this.Vsg(this.QM.vC)};this.lqj=(Aa,bb)=>{if(bb.isPaneOpen)return this.hGj()}}initialize(){this.QM.Dob(this.Fia);this.a5a.u8a(this.lqj);this.a5a.rva?this.hGj():this.Vsg(this.QM.vC)}he(){this.QM.Txe(this.Fia);this.a5a.pod(this.lqj);this.a5a.rva&&this.EAp()}hGj(){if(!this.U3)return this.W7.Km().then(()=>
{this.ff.Cb(this,lw.getTypeName());this.Qog();this.U3=!0}).catch(d=>{F.ULS.sendTraceTag(541193813,2250,10,"Unable to register word count annotation handler.",d)})}EAp(){this.U3&&this.W7.Km().then(()=>{this.ff.Gc(this,lw.getTypeName());this.U3=!1}).catch(d=>{F.ULS.sendTraceTag(541193814,2250,10,"Unable to unregister word count annotation handler.",d)})}Qog(){this.W7.Km().then(()=>{this.ff.getAnnotationsByType(lw.getTypeName()).then(d=>{for(const n of d)this.kub(n)})})}XI(d,n){!this.U3||n!==Qj.a.getTypeName()&&
n!==Ax.a.getTypeName()||(d&&d.content?this.kub(d):F.ULS.sendTraceTag(541193815,2250,10,"Handled annotation is invalid"))}kub(d){d?d.annotationType===lw.getTypeName()&&(d=d.content)&&this.Vsg(d.wordNumber):F.ULS.sendTraceTag(541193816,2250,15,"Annotation is null.")}Vsg(d){this.vC=d;this.sa.raiseEvent(RB.wkf,new Rx(d))}Yif(d){this.sa.addHandler(RB.wkf,d)}mwg(d){this.sa.removeHandler(RB.wkf,d)}}Object(D.a)(or,"WordCountOverseer",null,[921,365,478]);class Sx{constructor(d,n){this.ga=d;this.cGc=n;this.ynb=
this.Vw=!1;this.mjc=(B,Q)=>{this.awg();B?this.cGc.hide():(this.cGc.dispose(),this.ynb=!1,F.ULS.sendTraceTag(509366928,2250,50,"AI Feedback Skittle closed"));Q&&(this.xcf(),F.ULS.sendTraceTag(509366927,2250,50,"AI Feedback Skittle suppressed."));this.Vw=!1};this.onClick=()=>{const B={};B.PaneTitle=WacWordeditorStrings.AIFeedbackPaneTitle;this.ga.Zb(dd.a.JGg,2,B)};this.onClose=()=>{this.mjc(!1,!0)}}get isVisible(){return this.Vw}showSkittle(d){this.xcf=d;this.ynb?this.cGc.show():(this.$xe(!1),this.ynb=
!0);this.Cif();this.Vw=!0}Cif(){var d=Ef.a.instance;const n=df.FocusManager.instance();d.Dba(ho.a.sVd);d=n.te(ho.a.sVd);const B=document.getElementById("AIFeedbackSkittleContainer"),Q=new fo.DOMFocusListing(()=>B);Q.$ia=!0;Q.jo(8);Q.jo(2);n.rpb(B,d,Q).nR=!0}awg(){const d=Ef.a.instance,n=df.FocusManager.instance();n.currentScope.name===ho.a.sVd&&n.Rg(NF.a.Co);d.wz(ho.a.sVd)}$xe(d=!1){const n={onClick:this.onClick,onClose:this.onClose};d?this.cGc.update(n):this.cGc.render(n)}}Object(D.a)(Sx,"AIFeedbackSkittleComponent",
null,[920]);class Bt{}Bt.mne=1E3;Bt.VRn=4E3;Bt.bbg=1;Object(D.a)(Bt,"AIFeedbackSkittleConstants",null,[]);class Hr{constructor(d,n,B){this.Xch=d;this.cLb=n;this.Xcc=B;this.onClose=()=>this.Xcc.w2(7,new Date);this.Vvd=(Q,ha)=>{ha?ha.zja?this.kGg&&this.Xch.showSkittle(this.onClose):this.Xch.mjc(21!==ha.id,!1):F.ULS.shipAssertTag(509366926,2250,!1)}}initialize(){this.Xcc.initialize();this.cLb.forEach(d=>{d.Qsa(this.Vvd);d.initialize()})}he(){this.cLb.forEach(d=>{d.NFa(this.Vvd);d.he()})}get kGg(){return this.cLb.every(d=>
d.Ekf())}}Object(D.a)(Hr,"AIFeedbackSkittleTriggerManager",null,[919,478]);class tr extends jc.a{constructor(d,n){super("DocumentLengthUpperBoundConditionId");this.vba=d;this.Qzh=n;this.Jxd=(B,Q)=>{this.ri(Q.wordCount<=this.Qzh)}}initialize(){super.initialize();this.vba.Yif(this.Jxd);this.ri(this.vba.vC<=this.Qzh)}he(){this.vba.mwg(this.Jxd);super.he()}}Object(D.a)(tr,"DocumentLengthUpperBoundCondition",jc.a,[]);var gz=e(1128);class Tx extends ze.a{constructor(){super(...arguments);this.j_=()=>{yg.StaticActiveAppFrame.Aa().tb.z1a(this.j_);
this.initInternal()}}get name(){return"WordEditor.Ideas"}dXa(){if(Object(gz.a)()){const d=yg.StaticActiveAppFrame.Aa().tb;d.uva?this.initInternal():d.gga(this.j_)}}async initInternal(){var d;try{this.Z.resolve("WordEditor.Ideas.TextPrediction.PremiumPreviewTextPredictionHandler");const n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");try{const B=await n.rXb;this.xea(B.mode)}catch(B){this.B_l()}}catch(n){console.error(null!==(d=n.message)&&void 0!==d?d:n),F.ULS.sendTraceTag(528561500,
2250,10,"Initializing WordEditorIdeasPackage failed.",n)}}cXa(){}bXa(d){var n;this.Z=d;if(Object(gz.a)()){const B=Uc.a.VNa;this.Z.ja("WordEditor.Ideas.AddInLoader.IAddInUtils",()=>new xD(new TH.a(this.Z.resolve("Common.IExternalUICommandDefinitionMapping")))).ha();this.Z.ja("WordEditor.Ideas.TextPrediction.PremiumPreviewTextPredictionHandler",()=>new cM(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();
this.Z.ja("WordEditor.Ideas.Messenger.IMessenger",()=>new RK(new fB.a(null,null))).ha();this.Z.ja("WordEditor.Ideas.Tiling.ITileEventsHandler",()=>new UK).ha();this.Z.ja("WordEditor.Ideas.Tiling.ITileViewAdapter",()=>new wI(this.Z.Za("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).ha();this.Z.ja("WordEditor.Ideas.TextPrediction.ITextPredictionComponent",()=>new uI(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();
this.Z.register(vI,"WordEditor.Ideas.TextPrediction.TextPredictionDialogHandler").ha();this.Z.register(fA,"WordEditor.Ideas.EditorSettings.EditorSettingsDialogHandler").ha();this.Z.ja("WordEditor.Ideas.IFeatureSuppressionSettingsHandler",()=>new rw(this.Z.resolve("Box4.IRoamingServiceRequestManager"),d.resolve("Box4.RoamingSetting.IRoamingSettingCache"),G.AFrameworkApplication.J,new dc.a,this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression",
()=>new ED(this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionSettingsHandler"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.Ideas.IFeatureSuppressionMessenger",()=>new Tw(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionSettingsHandler"),this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.Ideas.AddInLoader.AddInLoadedMessageHandler",()=>new ep(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.Tiling.ITileEventsHandler"),
this.Z.resolve("WordEditor.Ideas.Tiling.ITileViewAdapter"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.J,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Ideas.TextPrediction.ITextPredictionComponent"),this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionMessenger"),this.Z.resolve("WordEditor.EditorUpsell.ISimulateFreeUserGate"),
this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"))).ha();this.Z.ja("WordEditor.Ideas.FloodgateMessageHandler",()=>new mI(this.Z.Za("Common.ISystemInitiatedFeedback"),ju.a.F5c())).ha();this.Z.ja("WordEditor.Ideas.Messenger.OpenPaneMessageHandler",()=>new SK(G.AFrameworkApplication.va)).ha();this.Z.ja("WordEditor.Ideas.Messenger.IdeasCallActionMessageHandler",()=>new pI(G.AFrameworkApplication.va,this.Z.resolve("Common.IUlsWrapper"))).ha();this.Z.ja("WordEditor.Ideas.Cards.CategorySelectionChangedMessageHandler",
()=>new GD(this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),B)).ha();this.Z.ja("WordEditor.Ideas.StatsDialog.StatsDialogMessageHandler",()=>new PB(G.AFrameworkApplication.va)).ha();this.Z.ja("WordEditor.Ideas.SimilarityChecker.SimilarityCheckerMessageHandler",()=>new sI(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.Z.resolve("Common.ICpuMeter"))).ha();this.Z.ja("WordEditor.Ideas.SimilarityChecker.SimilarityCancelMessageHandler",
()=>new TK(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ja("WordEditor.Ideas.Messenger.InvokeLicensingUpsellMessageHandler",()=>new cz(this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();this.Z.ja("WordEditor.Ideas.Auth.GetAuthResultMessageHandler",()=>new BK(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();this.Z.ja("WordEditor.Ideas.Goals.GoalSelectedMessageHandler",()=>new QF(this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"),
this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.IGoalUpdater"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.ja("WordEditor.Ideas.EditorUpsell.TryPremiumPreviewMessageHandler",()=>new PF(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"))).ha();this.Z.ja("WordEditor.Ideas.EditorUpsell.BxPromoDismissedMessageHandler",()=>new VH(this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),
this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler"))).ha();this.Z.ja("WordEditor.Ideas.AddInLoader.AddInState",()=>new Ox(G.AFrameworkApplication.userSessionId,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),new dc.a,new dc.a,this.Z.resolve("WordEditor.EditorUpsell.ISimulateFreeUserGate"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.Ideas.AddInLoader.IAddInState").ha();this.Z.ja("WordEditor.Ideas.Cards.ReleaseCategoryMessageSender",
()=>new hA(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),B)).ha();this.Z.ja("WordEditor.Ideas.Cards.ReturnFocusMessageSender",()=>new OB(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.va,B)).ha();this.Z.ja("WordEditor.Ideas.Cards.EditsMadeMessageSender",()=>new Au(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),
this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),B)).ha();this.Z.ja("WordEditor.Ideas.Cards.AnnotationResultStateSubscriptionMessageHandler",()=>new QK(this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),B)).ha();this.Z.ja("WordEditor.Ideas.Cards.AnnotationResultStateMessageSender",()=>new Dp(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),
B)).ha();this.Z.ja("WordEditor.CanvasContextual.OCVFeedbackManager",()=>new uv.a(G.AFrameworkApplication.pe,G.AFrameworkApplication.zc,G.AFrameworkApplication.J)).ha();this.Z.ja("WordEditor.CanvasContextual.AugLoopAvertHandler",()=>new xF.a(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ja("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager",()=>new $L.a(G.AFrameworkApplication.zc,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ParagraphRenderEvents"))).ha();
this.Z.ja("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl",()=>new KK(this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).ha();this.Z.ja("WordEditor.CanvasContextual.SummarizationIntentProvider",()=>new yF.a(this.Z.Za("WordEditor.CanvasContextualProvider.UxManager"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.Za("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl")));
this.Z.ja("WordEditor.Ideas.AIFeedbackIntentManager",()=>new HF(this.Z.resolve("Box4.Intent.IIntentRangeEditor"),this.Z.resolve("Box4.ParagraphRenderEvents"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();this.Z.ja("WordEditor.Ideas.ContentGenerationActor",()=>new Qn(G.AFrameworkApplication.va,this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),this.Z.resolve("WordEditor.Extension.IInsertApiOperations"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),
G.AFrameworkApplication.zc,this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Xtb(),this.Z.resolve("WordEditor.Designer.Style.IParagraphDesigner"),this.Z.Za("Common.ISystemInitiatedFeedback"),this.Z.resolve("Box4.Styles.IWACStyleReader"),this.Z.Wa("WordEditor.CanvasContextual.OCVFeedbackManager"),this.Z.Wa("WordEditor.CanvasContextual.AugLoopAvertHandler"),this.Z.resolve("WordEditor.CanvasContextual.IdeasSuggestionConfirmationManager"),
this.Z.resolve("WordEditor.CanvasContextual.SummarizationIntentProvider"),this.Z.resolve("Box4.IUndoManager"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.ContentGenerationTelemetryLoggerImpl"),this.Z.Za("WordEditor.CanvasContextual.AIFeedbackIntentProvider"),this.Z.resolve("WordEditor.Ideas.AIFeedbackIntentManager"),new fa.a(()=>yg.StaticActiveAppFrame.Aa().tb.rd.Hd),this.Z.resolve("Box4.ISelectionManager"),this.Z.Za("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),
this.Z.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("Box4.IOutlineElementNavigator"),this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>{Q.isFeatureEnabled("Copilot",!1).then(ha=>{Qn.bhe=ha;if(Qn.I4f||Qn.M5f||Qn.mge)try{this.Z.resolve("WordEditor.Ideas.ContentGenerationActor").mc()}catch(Aa){F.ULS.sendTraceTag(537408325,2250,10,"Failed to register ContentGenerationActor",
origin)}})});this.Z.ja("WordEditor.Ideas.Messenger.IPostMessageHandlers",()=>new SF(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.AddInLoadedMessageHandler"),this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.CritiqueUpsellMessageHandler"),this.Z.resolve("WordEditor.Ideas.FloodgateMessageHandler"),this.Z.resolve("WordEditor.Ideas.Messenger.OpenPaneMessageHandler"),this.Z.resolve("WordEditor.Ideas.Cards.CategorySelectionChangedMessageHandler"),this.Z.resolve("WordEditor.Ideas.SimilarityChecker.SimilarityCheckerMessageHandler"),
this.Z.resolve("WordEditor.Ideas.Messenger.InvokeLicensingUpsellMessageHandler"),this.Z.resolve("WordEditor.Ideas.SimilarityChecker.SimilarityCancelMessageHandler"),this.Z.resolve("WordEditor.Ideas.StatsDialog.StatsDialogMessageHandler"),this.Z.resolve("WordEditor.Ideas.Auth.GetAuthResultMessageHandler"),this.Z.resolve("WordEditor.Ideas.TextPrediction.ITextPredictionComponent"),this.Z.resolve("WordEditor.Ideas.TextPrediction.TextPredictionDialogHandler"),this.Z.resolve("WordEditor.Ideas.EditorSettings.EditorSettingsDialogHandler"),
this.Z.resolve("WordEditor.Ideas.Goals.GoalSelectedMessageHandler"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.TryPremiumPreviewMessageHandler"),this.Z.resolve("WordEditor.Ideas.Cards.AnnotationResultStateSubscriptionMessageHandler"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.BxPromoDismissedMessageHandler"),this.Z.resolve("WordEditor.Ideas.Messenger.IdeasCallActionMessageHandler"),this.Z.resolve("WordEditor.Ideas.IFeatureSuppressionMessenger"),this.Z.resolve("WordEditor.Ideas.WritersUnblockMessageHandler"),
this.Z.resolve("WordEditor.Ideas.SummarizationMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIGenerateFeedbacksMessageHandler"),this.Z.resolve("WordEditor.Ideas.AINavigateFeedbackMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIRewriteFeedbackMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackPaneClosedMessageHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackReportFeedbackCardHandler"),this.Z.resolve("WordEditor.Ideas.AIFeedbackPaneOpenedMessageHandler"))).ha();this.Z.ja("WordEditor.Ideas.Signals.ISignalBeacon<Microsoft.Office.AugLoop.Signals.IdeasEngagementSignal>",
()=>new Mg).ha();this.Z.ja("WordEditor.Ideas.Signals.IUserEngagementMonitor",()=>new iA(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("WordEditor.Ideas.Signals.ISignalBeacon<Microsoft.Office.AugLoop.Signals.IdeasEngagementSignal>"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"))).ha();this.Z.ja("WordEditor.ICanvasContextualFooterData",()=>new MB(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"))).ha();this.Z.ja("WordEditor.Ideas.Cards.PaneToggleHandler",
()=>new RF(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),B)).ha();this.Z.ja("WordEditor.Ideas.AddInLoader.IIdeasAddIn",()=>new xl(this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),yg.StaticActiveAppFrame.Aa().qhb,G.AFrameworkApplication.J.ZMf(xl.appId),G.AFrameworkApplication.J.rb("WordEditorIdeasSourceLocationOverrideResourceId"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),
this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"),this.Z.resolve("WordEditor.Ideas.Goals.IGoalsSettingsAppender"),this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate"),G.AFrameworkApplication.J.$("DictationCorrectionsInEditorPaneIsEnabled"),G.AFrameworkApplication.J.$("KeypointsEnabledForHost"),!1,G.AFrameworkApplication.J.$("StatsDialogIsEnabled"),
G.AFrameworkApplication.J.$("TaskPaneBackgroundRefreshIsEnabled"),this.xwn())).ha();(null===(n=G.AFrameworkApplication.J)||void 0===n?0:n.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIToContinueReviewSuggestionsEnabled",!1))&&this.Z.ja("WordEditor.Ideas.AddInLoader.OpenEditorTeachingCallout",()=>new GB(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands"),this.Z.Za("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),this.Z.Za("Common.ISystemInitiatedFeedback"))).ha();this.Z.ja("WordEditor.Ideas.AddInLoader.IAddInCommands",
()=>new ct(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),G.AFrameworkApplication.J,this.Z.resolve("WordEditor.Ideas.AddInLoader.IIdeasAddIn"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("Common.IRibbonButtonUpdater"),this.Z.Za("WordEditor.IIdeasCardsMessageHandler"),this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("WordEditor.Ideas.Goals.IGoalsSettingsAppender"),
G.AFrameworkApplication.zc,this.Z.resolve("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender"),this.Z.resolve("WordEditor.Ideas.PaneSettingsProvider"),this.Z.Za("Common.ISystemInitiatedFeedback"))).ha();this.Z.ja("WordEditor.Ideas.CritiqueUpsell.ICritiqueUpsellParagraphNodeHelpers",()=>new Go(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),yg.StaticActiveAppFrame.Aa().tb.rd.Hd,Ie.a.createInstance,this.Z.resolve("Box4.IProofingManager"),
G.AFrameworkApplication.J.sc("CritiqueTypeUpsellFindFirstParagraphTimeoutMs",30))).ha();this.Z.ja("WordEditor.Ideas.CritiqueUpsell.ISessionUpsellSettingsModifier",()=>new iI(this.Z.resolve("Box4.Proofing.ICritiqueTypeSettings"))).ha();this.Z.ja("WordEditor.Ideas.CritiqueUpsell.CritiqueUpsellMessageHandler",()=>new gI(this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.ICritiqueUpsellParagraphNodeHelpers"),Object(Cg.a)(),this.Z.resolve("WordEditor.Ideas.CritiqueUpsell.ISessionUpsellSettingsModifier"))).ha();
this.Z.ja("WordEditor.Ideas.WritersUnblockMessageHandler",()=>new bM(G.AFrameworkApplication.va));this.Z.ja("WordEditor.Ideas.SummarizationMessageHandler",()=>new LK(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AIGenerateFeedbacksMessageHandler",()=>new $H(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AINavigateFeedbackMessageHandler",()=>new Ck(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AIRewriteFeedbackMessageHandler",
()=>new Ah(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AIFeedbackPaneClosedMessageHandler",()=>new YH(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AIFeedbackReportFeedbackCardHandler",()=>new HK(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.AIFeedbackPaneOpenedMessageHandler",()=>new ZH(d.resolve("WordEditor.Ideas.ContentGenerationActor")));this.Z.ja("WordEditor.Ideas.Goals.IGoalsSettingsAppender",
()=>new NB(this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Goals.IGoalReader"),this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).ha();this.Z.ja("WordEditor.Ideas.EditorUpsell.PremiumPreviewDataAppender",()=>new FB(this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"))).ha();this.Z.ja("WordEditor.Ideas.PaneSettingsProvider",()=>new UH(this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate"),this.Z.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader"),
this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.Za("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"))).ha();this.Z.ja("WordEditor.Ideas.Cards.PremiumPreviewStateChangedMessageSender",()=>new kI(this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),G.AFrameworkApplication.va)).ha();this.Z.ja("WordEditor.EditorUpsell.ExpiryCardMetricAggregator",()=>new rp(this.Z.resolve("WordEditor.SignalAggregator.ISignalAggregator"),this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater"),
this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataProvider"),this.Z.resolve("Common.IUlsWrapper"))).ha()}}B_l(){F.ULS.sendTraceTag(594597057,2250,50,"Disabling Editor in Word: {0}","Licensing defines Feature as disabled for Subscription type");this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInUtils").$ak(!1)}async xea(d){F.ULS.sendTraceTag(40957964,2250,50,"Editor package initialized: {0}",CF[d]);var n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInUtils"),B=2!==d;d=n.zKm(d);n.$ak(!0);
n=this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState");n.uii=d;n.init(B);const Q=this.Z.resolve("WordEditor.Ideas.AddInLoader.IIdeasAddIn");n=await this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate").z3f();Q.init(n);G.AFrameworkApplication.J.$("WordEditorSessionLifetimeForIdeasIsEnabled")?Q.load(d):this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInCommands").register(!0);this.qvl();this.Z.resolve("WordEditor.Ideas.Messenger.IPostMessageHandlers").register();this.Z.resolve("WordEditor.Ideas.Cards.PaneToggleHandler");
this.Z.resolve("WordEditor.Ideas.Cards.ReleaseCategoryMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.ReturnFocusMessageSender");n&&this.Z.resolve("WordEditor.Ideas.Cards.PremiumPreviewStateChangedMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.EditsMadeMessageSender");this.Z.resolve("WordEditor.Ideas.Cards.AnnotationResultStateMessageSender");d=this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor");this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").FUh(Object(X.a)(d,
d.nhg,"onAnnotationLocalStateChangedEventHandler"));if(B=this.pNm(B))this.Nug(B),this.CEo(B);this.Z.ja("Office.Word.Online.Ideas.ToggleProofingActor",()=>new kA(()=>this.Z.resolve("WordEditor.IStatusBarUser"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Box4.Proofing.SuggestionRerenderer"))).ha();this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor").mc();this.WCo();this.mBo();this.VAo();n&&this.Z.resolve("WordEditor.EditorUpsell.ExpiryCardMetricAggregator").initialize()}qvl(){if(this.LAn())this.Faj(),
cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:"Office.Word.Online.Ideas.ProactivePaneOpenFromResumeTemplate"}));else if(G.AFrameworkApplication.J.$("EditorAutoOpenIsEnabled")){const d=this.xKm();d?F.ULS.sendTraceTag(574099531,2250,50,"Default launch of Editor is disabled. Status: {0}",d):this.Faj()}}LAn(){let d=!1;if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorProactiveFromTemplateIsEnabled",!1)){const n=G.AFrameworkApplication.FYb;!gg.a.jg(n)&&ja.a.Oh().equals(n,
"tm55635225")&&(d=!0)}return d}Faj(){Fe.a.get_instance().Zk(7,()=>{G.AFrameworkApplication.va.Zb(dd.a.KGg,2,{ShowPaneBackgroundLoad:0},null)})}xKm(){return G.AFrameworkApplication.J.appSettings.BootActivityNavigationId?1:G.AFrameworkApplication.VL?2:G.AFrameworkApplication.J.$("IsDocumentOwner")?this.vSi()?this.y1f()?Tx.tmn()?6:0:5:4:3}Xtb(){const d=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return d?d.getInstance(0):(F.ULS.sendTraceTag(574099532,2250,10,"Could not resolve wordCountManagerFactory"),
null)}XQm(){const d=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return d?d.getInstance(1):(F.ULS.sendTraceTag(556323991,2250,10,"Could not resolve wordCountManagerFactory"),null)}vSi(){const d=this.Xtb();if(d&&-1!==d.vC){const n=G.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.EditorAutoOpenMinWordCount",100);return d.vC>=n}F.ULS.sendTraceTag(574198867,2250,50,"WordCountManager is not fully initialized: {0}",!d);return!0}y1f(){const d=df.FocusManager.instance();
return!!d&&!(void 0===d.currentScope||null===d.currentScope)&&!(void 0===d.currentScope.name||null===d.currentScope.name)&&ux.AFrame.Co===d.currentScope.name}Nug(d){this.jEo(d);this.yEo(d);const n=2===d;n&&this.Z.ja("WordEditor.Ideas.Callout.IIdeasCallout",()=>new HB(G.AFrameworkApplication.va,this.Z.resolve("Common.IDynamicScriptLoaderProvider"))).ha();this.Z.ja("WordEditor.Ideas.AutoTrigger.IIdeasAutoTrigger",()=>new CK(G.AFrameworkApplication.va,n?this.Z.resolve("WordEditor.Ideas.Callout.IIdeasCallout"):
null,this.Z.resolve("WordEditor.Ideas.TriggerModels.IActiveIdeasTriggerModels"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"),this.Z.resolve("WordEditor.Ideas.Messenger.IMessenger"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"),
this.Vwn(d))).ha();this.Z.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager").CGj(this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor"));this.Z.resolve("WordEditor.Ideas.AutoTrigger.IIdeasAutoTrigger").initialize()}WCo(){const d=G.AFrameworkApplication.J.$("EditorGoalsEnabled"),n=this.Xtb(),B=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocOwnerOmniPresentScoreExperimentEnabled",!1),Q=G.AFrameworkApplication.J.$("IsDocumentOwner");Q||G.AFrameworkApplication.ud("c02a6503;b1bh3863");
const ha=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isSkittleAutomation",!1);if(n){if(this.Z.ja("WordEditor.Ideas.WordCount.IWordCountOverseer",()=>new or(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),n,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),new dc.a)).ha(),this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer").initialize(),this.Z.ja("WordEditor.Ideas.Localization.ICategoryStandardization",
()=>new oI).ha(),this.Z.ja("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler",()=>new gA(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),new dc.a,this.Z.resolve("WordEditor.Ideas.Localization.ICategoryStandardization"))).ha(),this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler").initialize(),(B||
Q||ha)&&d){this.Z.Za("CanvasContextual.ISkittleControllerV2").execute(bb=>{this.Z.Za("Common.IZoomManager").execute(Qe=>{Qe.UW(bb.reposition)});var Ib=new XH(this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"));this.Z.ja("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent",()=>new LB(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),bb)).ha();const oc=new AD(dt.bbg,Ib),Ac=new FF(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),
dt.mne),ad=new FK.a(yg.StaticActiveAppFrame.Aa().qhb),sd=new DK.a(this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Sidetrack.SidetrackEventsActor")),wd=new GK.a(G.AFrameworkApplication.va.mode);var yd=new EK.a(this.Z.resolve("WordEditor.IMainViewModeManager")),be=new ma.a;be.add(Ac);be.add(ad);be.add(sd);be.add(wd);be.add(Ib);Ib=new ma.a;Ib.add(yd);yd=this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor");be.add(new GF(yd));be=new nr(3,be,oc);yd=new nr(7,
Ib,oc);const ye=[be,yd];this.Z.ja("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager",()=>new OF(this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent"),ye,oc)).ha();this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent").initialize();this.Z.resolve("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager").initialize()});let Aa=G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0);this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(bb=>
{bb.isFeatureEnabled("Copilot",!1).then(Ib=>{Qn.bhe=Ib;(Aa=Aa&&Qn.mge)&&this.CAo()})})}}else F.ULS.sendTraceTag(558401300,2250,10,"WordEditorIdeasPackage - Failed to get word count manager so omnipresent editor score is not initialized")}CAo(){this.Z.Za("CanvasContextual.IAIFeedbackSkittleController").execute(d=>{this.Z.Za("Common.IZoomManager").execute(sd=>{sd.UW(d.reposition)});this.Z.Za("WordEditor.Ideas.EditorSkittle.IEditorSkittleComponent").execute(sd=>{sd.tUh(d.reposition)});this.Z.ja("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent",
()=>new Sx(G.AFrameworkApplication.va,d)).ha();var n=new XH(this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"));const B=new FF(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),Bt.mne),Q=new tr(this.Z.resolve("WordEditor.Ideas.WordCount.IWordCountOverseer"),Bt.VRn),ha=new FK.a(yg.StaticActiveAppFrame.Aa().qhb),Aa=new DK.a(this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("WordEditor.Sidetrack.SidetrackEventsActor")),bb=new GK.a(G.AFrameworkApplication.va.mode);
var Ib=new EK.a(this.Z.resolve("WordEditor.IMainViewModeManager"));const oc=new AD(Bt.bbg,n);var Ac=new ma.a;Ac.add(B);Ac.add(Q);Ac.add(ha);Ac.add(Aa);Ac.add(bb);Ac.add(n);n=new ma.a;n.add(Ib);Ib=this.Z.resolve("Office.Word.Online.Ideas.ToggleProofingActor");Ac.add(new GF(Ib));Ac=new nr(3,Ac,oc);Ib=new nr(7,n,oc);const ad=[Ac,Ib];this.Z.ja("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager",()=>new Hr(this.Z.resolve("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent"),ad,oc)).ha();
this.Z.resolve("WordEditor.Ideas.AIFeedbackSkittle.IAIFeedbackSkittleComponent");this.Z.resolve("WordEditor.Ideas.TriggerModels.IEditorSkittleTriggerManager").initialize()})}VAo(){if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextualMessagingShadowTrafic",!1)){const d=new WH(this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState")),n=new ma.a;n.add(d);const B=new Dg,Q=[new fI(5,n,B,this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))];this.Z.ja("WordEditor.Ideas.TriggerModels.IContextualMessagingHandler",
()=>new Xj(this.Z.Za("Common.ISystemInitiatedFeedback"))).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.IContextualMessagingTriggerManager",()=>new eI(Q,B,this.Z.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,this.Z.resolve("WordEditor.Ideas.TriggerModels.IContextualMessagingHandler"))).ha();this.Z.resolve("WordEditor.Ideas.TriggerModels.IContextualMessagingTriggerManager").initialize()}}yEo(d){const n=3===d||5===d?1:2;this.Z.ja("WordEditor.Ideas.TriggerModels.CritiqueAcceptTriggerModel",
()=>new Fh(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),G.AFrameworkApplication.va,n,1)).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.CritiqueAcceptNoTypingTriggerModel",()=>new yv(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"),G.AFrameworkApplication.va,2,this.Z.resolve("Box4.ContentEditableViewTypingState"),1)).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel",
()=>new zl(this.Z.resolve("WordEditor.Ideas.TriggerModels.ISuppressionModel"))).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.PremiumPreviewInProgressTriggerModel",()=>new xI(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel"),G.AFrameworkApplication.va,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),1)).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.PremiumPreviewExpiredTriggerModel",()=>
new LD(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewSuppressionModel"),G.AFrameworkApplication.va,this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.Z.resolve("WordEditor.Ideas.AutoTrigger.IEditorFeatureSuppression"),1)).ha();this.Z.ja("WordEditor.Ideas.TriggerModels.IActiveIdeasTriggerModels",()=>new fz(this.Z.resolve("WordEditor.Ideas.TriggerModels.CritiqueAcceptTriggerModel"),this.Z.resolve("WordEditor.Ideas.TriggerModels.CritiqueAcceptNoTypingTriggerModel"),
this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewInProgressTriggerModel"),this.Z.resolve("WordEditor.Ideas.TriggerModels.PremiumPreviewExpiredTriggerModel"),d,this.vSi(),this.Z.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha()}jEo(d){if(d)if(2===d)this.Z.ja("WordEditor.Ideas.TriggerModels.ISuppressionModel",()=>new KD).ha();else{this.Z.ja("WordEditor.Ideas.TriggerModels.ICrossSessionSuppressionHandler",()=>new QB(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();
const n=6===d?!1:!0;this.Z.ja("WordEditor.Ideas.TriggerModels.ISuppressionModel",()=>new VK(G.AFrameworkApplication.va,n?this.Z.resolve("WordEditor.Ideas.TriggerModels.ICrossSessionSuppressionHandler"):null,18E5,2)).ha()}}pNm(d){return G.AFrameworkApplication.uiCulture.toLowerCase().startsWith("en")?4:d?0:9}xwn(){return G.AFrameworkApplication.uiCulture.toLowerCase().startsWith("en-us")&&G.AFrameworkApplication.J.$("WordEditorPerspectivesIsEnabled")}CEo(d){const n=this.Z.resolve("WordEditor.Ideas.Signals.IUserEngagementMonitor");
6!==d&&4!==d||n.tQn()}Vwn(d){return!!d&&2!==d}mBo(){if(G.AFrameworkApplication.J.$("StatsDialogIsEnabled")){this.Z.ja("WordEditor.DocumentDialog.IStatsDialogAnnotationHandler",()=>new yK(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),new dc.a,this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Common.IUlsWrapper"))).ha();var d=this.Xtb(),n=this.XQm();this.Z.ja("WordEditor.DocumentDialog.IStatsDialogActor",()=>new xK(d,n,this.Z.resolve("WordEditor.DocumentDialog.IStatsDialogAnnotationHandler"),
this.Z.resolve("WordEditor.Ideas.EditorSkittle.IEditorScoreHandler"),G.AFrameworkApplication.va,this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Z.resolve("WordEditor.Ideas.AddInLoader.IAddInState"),this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("Wac.Common.Utils.IOtelWrapper"))).ha();this.Z.Wa("WordEditor.DocumentDialog.IStatsDialogActor").mc()}}static main(){G.AFrameworkApplication.BL||Object(gz.a)()&&
U.a.instance.Rc(new Tx)}static tmn(){const d=G.AFrameworkApplication.J.rb("UserPrincipalName");return d?d.toLowerCase().endsWith("linkedin.biz"):!1}}Object(D.a)(Tx,"WordEditorIdeasPackage",ze.a,[]);class TF extends Sa.StandardDialog{constructor(d){super();this.KUe=d;this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose)}fT(d){this.zA(d,CommonUIStrings.l_DefaultDialogTitle,this.KUe,null,!1,!0)}}Object(D.a)(TF,"ErrorDialog",Sa.StandardDialog,[905]);class yI{}Object(D.a)(yI,"LearningToolsExtraInfoContext",
null,[1960]);class Cu{static requestFullscreen(d){d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.requestFullscreen?d.requestFullscreen():F.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():
document.exitFullscreen?document.exitFullscreen():F.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}}Object(D.a)(Cu,"FullscreenUtils",null,[]);var lA=e(97),lj=e(1114),MD=e(25);class zv{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye,Qe,af,Qf){this.ALh=this.qTe=0;this.gmh=this.jm=this._iframe=this.Z=this.YTa=null;this.mUn=hf=>{if(hf.data===lA.a.wri)return F.ULS.sendTraceTag(20490002,306,50,"Postmessage sent with param: {0}",hf.data),this.L8h(),!0;if(hf.data===
lA.a.uwo)return this.$vh=!0,this.T0l(),this.A8j(),!0;if(hf.data===lA.a.RMo)Cu.requestFullscreen(this.Z);else if(hf.data===lA.a.u$l)Cu.exitFullscreen();else{let di=null;try{di=JSON.parse(hf.data)}catch(vj){return F.ULS.sendTraceTag(21320706,306,100,"Postmessage generated exception: "+vj),!1}if(di&&(hf=di.storageIdReceivedToContentLoadedDurationInMs))return this.yth=!0,this.nRe=hf,F.ULS.sendTraceTag(22905240,306,50,"contentLoadedDuration:{0}",this.nRe),!0}F.ULS.sendTraceTag(20490003,306,100,"Postmessage fired with irrelevant param");
return!1};this._title=d;this.Oac=n;this.$f=B;this.Gla=Q;this.Sn=ha;this.FEb=Aa;this.Edc=bb;this.nWk=Ib;this.MGc=oc;this.BLc=Ac;this.KUe=ad;this.yth=!1;this.nRe=0;this.oc=wd;this.ANc=Ze.a.create().toString();this.E2e=yd;this.Tib=Qe;this.UUk=sd+"?appId="+Qe;this.wYk=be;this.dBh=ye;this.hec=af;this.Gcc=Qf;this.$vh=!1;this.svk=rf.a.Vg(this.MGc).name;this.z3=!1}Rgb(){this.jm=(new nt.a).create();this.jm.Md=5;this.jm.hv=!1;this.jm.nM(null,null,null)}qhc(){this.jm&&(this.jm.close(),this.jm=null)}nFn(){this.gmh=
new TF(this.KUe);this.gmh.fT(fe.a.Xaj)}launch(d){F.ULS.sendTraceTag(2049E4,306,50,"Learning Tools service launched");this.Sn.start();this.qTe=(new Date).getTime();this.Rgb();var n={};n.title=this._title;n.chunks=this.nWk;n.StartingChunkIndex=this.E2e.SelectionChunkIndex;n.StartingCharIndex=this.E2e.SelectionCharIndex;var B="",Q="",ha="";this.hec?(B={},B.data=n,n=Rb.c(B),B="&useV2Endpoint=1",this.Gcc&&(Q="&sendDocxFile=1",ha="&startIndex="+this.E2e.SelectionCharIndex)):n=Rb.c(n);Q=this.Gla+"OneNoteS2SHandler.ashx?action="+
d+"&appId="+this.Tib+"&enabledConfig=WordEditorLearningToolsIsEnabled&"+G.AFrameworkApplication.lm+B+Q+ha;ha={"Content-Type":"application/json; charset=utf-8"};ha.LearningToolsSessionId=this.ANc;this.$f.addRequest(Q,2,n,ha,!1,2,Aa=>{this.aPa(Aa)},Aa=>{this.rR(Aa)},d,void 0,void 0,void 0,this.Edc);d=this.UUk+"&exitCallback="+lA.a.wri+"&omkt="+this.svk+"&sessionId="+this.ANc+"&showFeedback="+G.AFrameworkApplication.uE.toString();this.wYk&&(d+="&v=2");this.zFn(d)}aPa(d){var n=zv.RDm(d.data.responseData);
this.YTa={};this.z3=!1;if(this.dBh)this.YTa.readerModel=n;else{d=Object(Uf.a)(String,n.url);const B=Object(Uf.a)(String,n.storageId),Q=Object(Uf.a)(String,n.version);n=Object(Uf.a)(String,n.processingHost);if(!d){MD.b(20259850,200,10,"{0}",{["Desc"]:"NoUrl"});return}this.YTa.storageId=B;this.YTa.apiVersion=Q;this.YTa.processingHost=n}this.A8j()}zFn(d){G.AFrameworkApplication.The=!0;this.Z=document.createElement("div");this._iframe=document.createElement("iframe");this.Z.appendChild(this._iframe);
document.body.appendChild(this.Z);zv.eUj(this.Z);zv.eUj(this._iframe);this._iframe.id="ImmersiveReader-iframe";this._iframe.title=this.BLc;this._iframe.tabIndex=0;this._iframe.src=d;this._iframe.setAttribute("allowfullscreen","true");this._iframe.setAttribute("aria-modal","true");this.VHn()}rR(d){this.$2j(!1);F.ULS.sendTraceTag(20259852,201,10,"{0}",this.xym(d));this.qhc();5!==d.data.status||this.z3?this.nFn():(this.z3=!0,this.L8h(),this.launch(Object(Uf.a)(String,d.data.state)))}xym(d){let n=-1;
d&&d.data&&(n=d.data.Xe);500===n?F.ULS.sendTraceTag(37065042,201,10,"Failed to load the immersive reader for app {0} due to a 500 internal server error response from the LT service with LearningToolsSessionId {1}",this.Tib,this.ANc):408===n&&F.ULS.sendTraceTag(37065043,201,10,"Failed to load the immersive reader for app {0} due to a 408 request timeout from the LT service with LearningToolsSessionId {1}",this.Tib,this.ANc);return{["desc"]:"LT failure",["status"]:n,["LearningToolsSessionId"]:this.ANc}}VHn(){this.Oac.e_h(this.mUn)}A8j(){if(this.YTa&&
this.$vh){this.oc.PW("LearningToolsStaticReader");this.$2j(!0);this.YTa.launchToPostMessageSentDurationInMs=this.Sn.qj;var d={};let n="";if(this.dBh)if(this.hec){const B=this.YTa.readerModel;B.launchToPostMessageSentDurationInMs=this.Sn.qj;n="LinguisticModel";d.messageValue=B}else n="ReaderModel2",d.messageValue=this.YTa;else n="Data",d.messageValue=this.YTa;d.messageType=n;this.ARj(d);this._iframe&&(d=this.oc.te("LearningTools"),d.parent=ux.AFrame.UM,d.Eba(()=>{this._iframe.focus()}),this.oc.zP("LearningTools",
!1));this.ARj({messageType:"SetFocus"})}}ARj(d){if(this._iframe&&this._iframe.contentWindow){const n=T.a.getOrigin(this._iframe.src);this._iframe.contentWindow.postMessage(JSON.stringify(d),n)}}T0l(){this.qhc();const d=this.oc.te("LearningToolsStaticReader");d.parent=ux.AFrame.UM;d.Eba(()=>{this._iframe.focus()});this.Z.style.visibility="visible";this._iframe.style.visibility="visible";this.oc.zP("LearningToolsStaticReader",!1);F.ULS.sendTraceTag(20490001,306,50,"Learning Tools iFrame loaded");this.ALh=
(new Date).getTime()-this.qTe}$2j(d){const n=new lj.a,B=new yI;d?(B.RequestSucceeded=!0,B.DocumentCharCount=this.FEb,B.StartToDisplayIFrameDuration=this.ALh):B.RequestSucceeded=!1;n.ExtraInfoContext=B;this.Sn.Hlp(n)}L8h(){qd.a.yF(this._iframe);qd.a.yF(this.Z);this.Oac.hki();const d={};d.learningToolsSessionDurationInMs=(new Date).getTime()-this.qTe;d.isContentLoaded=this.yth;d.contentLoadedDuration=this.nRe;this.oc.PW("LearningTools");G.AFrameworkApplication.The=!1;F.ULS.sendTraceTag(21320707,306,
50,JSON.stringify(d))}static eUj(d){d.style.position="absolute";d.style.width="100%";d.style.height="100%";d.style.left="0";d.style.top="0";d.style.borderWidth="0";d.style.visibility="hidden";d.style.zIndex="1000";d.style.background="white"}static RDm(d){var n=null;d=({Zv:n}=Rb.d(d)).returnValue;n=Object(Uf.a)(Object,n);return n?n:(MD.b(20259851,200,10,"{0}",{["desc"]:"CouldntParse",["serialized"]:d}),null)}}Object(D.a)(zv,"LearningToolsLauncher",null,[]);class Rn{constructor(){this.LanguageRunsList=
null;this.SelectionCharIndex=this.SelectionChunkIndex=0;this.LanguageRunsList=new ma.a;this.SelectionCharIndex=this.SelectionChunkIndex=0}}Object(D.a)(Rn,"LearningToolsDocumentData",null,[]);var UF=e(951);class pr{}Object(D.a)(pr,"LearningToolsLanguageRun",null,[]);class WK{static tml(d){let n=null;var B=vc.a.kb(d);if(!B.Ib(8))throw Error("Could not locate page content node for given paragraph");for(B=Ie.a.$u(B,B.origin);B.moveNext();)bf.ParagraphReader.Wh(B.iterator)&&(d=B.currentNode,d=this.Dnl(d),
n=this.A1k(d,n));return n}static A1k(d,n){null!=d&&(null==n&&(n=document.createElement("div")),n.appendChild(d));return n}static CFm(d){var n=new vc.a;n.set(d);n.Ib(11);n.xd(11);var B="";n=d.Vd.Fy(n);if(null!=n){({listLevel:d}=ve.a.ut(ve.a.Qe?d:d.eG));const Q=n.Ez;switch(n.listType){case 0:switch(n.listStyle){case 1:B="decimal";break;case 2:B="loweralpha";break;case 3:B="lowerroman";break;case 4:B="upperalpha";break;case 5:B="upperroman";break;default:B="decimal"}B=`lt:${B};in:${d};li:${Q}`;break;
case 1:switch(n.listStyle){case 1:B="disc";break;case 2:B="circle";break;case 3:B="square";break;default:B="disc"}B=`lt:${B};in:${d}`}}return B}static SNi(d){let n=d.isBold?"b:1;":"";n+=d.isItalic?"i:1;":"";n+=d.isUnderline?"u:1;":"";n+=d.isStrikethrough?"s:1;":"";n+=d.isSuperscript?"sup:1;":"";return n+=d.isSubscript?"sub:1;":""}static Dnl(d){let n=null;const B=bf.ParagraphReader.text(d);let Q=0;for(;null!=d.ra&&Q<d.ra.length;){var ha=d.ra.jc(Q);var Aa=ha.cp;var bb=Q<d.ra.length-1?d.ra.jc(Q+1).cp:
bf.ParagraphReader.textLength(d);let Ib="";null!=ha.formatting?Ib=this.SNi(ha.formatting.cache):({formatting:ha}=d.ra.ptb(ha.cp),null!=ha&&(Ib=this.SNi(ha.cache)));bb=B.substring(Aa,bb);0<bb.length&&(Aa=document.createElement("span"),Aa.setAttribute("style",Ib),Aa.innerText=bb,null==n&&(n=document.createElement("p")),n.appendChild(Aa));Q++}null!=n&&bf.ParagraphReader.zZ(d)&&n.setAttribute("style",this.CFm(d));return n}}Object(D.a)(WK,"ImmersiveReaderUtility",null,[]);class dM{get Can(){return`${Nf.a.webServiceBase}OneNoteS2SHandler.ashx?action=${this.wVi}&appId=${this.g8}&enabledConfig=WordEditorLearningToolsIsEnabled&${G.AFrameworkApplication.lm}`}constructor(d,
n,B){this.o2l=d;this.HV=n;this.timeoutMs=B;this.g8="Word WAC";this.wVi="immersivereader"}launch(){const d=this.Rgb(WacWordeditorStrings.LearningToolsLoadingMessage);this.Qbm().then(n=>{d.close();return this.LFn(n)}).catch(n=>{F.ULS.sendTraceTag(509661463,209,10,"Immersive Reader failed to launch. Error msg: "+this.nha(n));d.close();(new TF(WacWordeditorStrings.LearningToolsErrorMessage)).fT(fe.a.Xaj)})}Qbm(){return new Promise((d,n)=>{this.HV.addRequest(this.Can,1,null,null,!1,2,B=>d(B.data.responseData),
n,this.wVi,void 0,void 0,void 0,this.timeoutMs)})}async VIn(){if(window.immersiveReader)return window.immersiveReader;G.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?await appResourceLoader.loadChunk("immersiveReader"):await Wa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("immersiveReader");return window.immersiveReader}async LFn(d){var n,B,Q;const {["v0_7_0"]:{["launchAsync"]:ha,["CookiePolicy"]:Aa}}=await this.VIn(),bb=null===(n=this.o2l.body.paragraphs.getFirstOrNullObject())||
void 0===n?void 0:n.Hua();n={["title"]:(null===WordRibbonStrings||void 0===WordRibbonStrings?void 0:WordRibbonStrings.ImmersiveView)||"Immersive Reader",["chunks"]:[{["content"]:null===(B=WK.tml(bb))||void 0===B?void 0:B.innerHTML,["mimeType"]:"text/html"}]};B={["uiLang"]:null===(Q=G.AFrameworkApplication.J)||void 0===Q?void 0:Q.appSettings.UICulture,["cookiePolicy"]:Aa.Enable,["allowFullscreen"]:!0};await ha(d,n,B)}Rgb(d){const n=(new nt.a).create();n.Md=5;n.hv=!1;n.message=d;n.nM(null,null,null);
return n}nha(d){if("object"!==typeof d)return""+d;if("message"in d)return""+d.message;try{return JSON.stringify(d)}catch(n){return"'Could not JSON serialize the error'"}}}Object(D.a)(dM,"ImmersiveReaderSDKLauncher",null,[]);class SB{constructor(){this.Sn=this.Gla=this.$f=this.Oac=this.sJc=null;this.MGc=this.Edc=this.FEb=0;this.oc=this.Qbf=this.BLc=null;this.Gcc=this.hec=this.s4e=this.Eff=!1;this.Sam=(d,n,B)=>{if(1===B)return bn.SessionStatusManager.instance.zk?8:32;if(!te.a.instance||!te.a.instance.ob||
!te.a.instance.ob.currentSelection)return 8;if(this.qKp)return this.gYn.launch(),32;d=this.sJc.getSelection();this.Gcc?fg.a.rT(rb.a.yRa,!0,this.jXb,this.mZb,d):(n=this.e7c(),B=this.yMi(d),d=this.Jwm(n,B,d),n=this.GUm(d.LanguageRunsList),B=Ca.a.oN(G.AFrameworkApplication.dv.sC),(new zv(B,this.Oac,this.$f,this.Gla,this.Sn,this.FEb,this.Edc,n,this.MGc,this.BLc,WacWordeditorStrings.LearningToolsErrorMessage,this.Qbf,this.oc,d,this.Eff,this.s4e,"Word WAC",this.hec,this.Gcc)).launch("learningtools"));return 32};
this.jXb=d=>{const n=new Rn;d=this.emm(Object(Uf.a)(Ut,d));n.SelectionCharIndex=d;d=Ca.a.oN(G.AFrameworkApplication.dv.sC);(new zv(d,this.Oac,this.$f,this.Gla,this.Sn,this.FEb,this.Edc,[],this.MGc,this.BLc,WacWordeditorStrings.LearningToolsErrorMessage,this.Qbf,this.oc,n,this.Eff,this.s4e,"Word WAC",this.hec,this.Gcc)).launch("learningtools")};this.mZb=(d,n)=>{F.ULS.sendTraceTag(41418846,209,10,"Error saving the docx file, status code: "+n);this.jXb(d)}}get qKp(){return null!=this.Uah?this.Uah:this.Uah=
G.AFrameworkApplication.J.$("LearningToolsNewImmersiveReaderSDKIsEnabled")}get gYn(){return null!=this.g6g?this.g6g:this.g6g=(()=>new dM(this.sJc,this.$f,this.Edc))()}get name(){return"WordEditor.LearningToolsContentExtractor"}Ec(){}init(){Bf.a.r7f&&(this.mc(),this.sJc=Wa.a.instance.zf("WordEditor.Extension.DocumentFactory").value.create(),this.Oac=UF.a.instance,this.$f=G.AFrameworkApplication.pe,this.Gla=Nf.a.webServiceBase,this.Sn=G.AFrameworkApplication.ta.Kt.O_a("LoadResource","ImmersiveReader"),
this.Edc=G.AFrameworkApplication.J.sc("LearningToolsTimeoutMs",3E4),this.MGc=G.AFrameworkApplication.lcid,this.BLc=WoncaIntl.WoncaStrings.L_ImmersiveView,this.Qbf=G.AFrameworkApplication.J.rb("LearningToolsStaticUrl"),this.oc=df.FocusManager.instance(),this.s4e=G.AFrameworkApplication.J.$("WordEditorLearningToolsNewDataFlowIsEnabled"),this.hec=G.AFrameworkApplication.J.$("LearningToolsV2EndpointIsEnabled"),this.Gcc=G.AFrameworkApplication.J.$("LearningToolsSendDocxFileIsEnabled"));this.Eff=G.AFrameworkApplication.J.$("WordEditorLearningToolsReactUIIsEnabled")}e7c(){this.FEb=
0;const d=this.sJc.body.paragraphs,n=d.length(),B=Array(n);for(let Q=0;Q<n;Q++)B[Q]=d._GetItem(Q),this.FEb+=B[Q].text.length;return B}emm(d){const n=d.paragraphs.getFirst();if(n){let B=0,Q=0;const ha=this.sJc.body.paragraphs,Aa=ha.length();for(let bb=0;bb<Aa;bb++){const Ib=ha._GetItem(bb);if(n.Hua().equals(Ib.Hua()))return B+=this.yMi(d),B+=Ib.text.length?Q:0;Ib.text.length?(B+=Ib.text.length+Q,Q=0):Q++}}return 0}Jwm(d,n,B){const Q=new Rn;if(1===d.length&&!d[0].text.length)return n=new pr,n.Run="",
Q.LanguageRunsList.add(n),Q;let ha=-1;B=B.paragraphs.getFirst();let Aa=0;for(const Ib of d){d=Ib.language();for(let oc=0;oc<d.length;oc++){const Ac=d[oc],ad=Ac.Mc,sd=Ac.end;var bb=Ac.lcid;let wd=0;const yd=new pr;let be="und";try{be=rf.a.Vg(bb).name}catch(ye){F.ULS.sendTraceTag(25557076,209,10,"error "+ye+" while reading lcid: "+bb)}yd.Lang=be;bb=Ib.text.substring(ad,sd);bb.length||Ib.isListItem?Aa=0:Aa++;2>=Aa&&(sd===Ib.text.length||oc===d.length-1)&&(bb+="\n");!ad&&Ib.isListItem?wd=SB.BZo(Ib,yd,
bb):yd.Run=bb;Q.LanguageRunsList.add(yd);ha++;B.Hua().equals(Ib.Hua())&&n>=ad&&n<=sd&&(Q.SelectionChunkIndex=ha,Q.SelectionCharIndex=n-Ac.Mc+wd)}}return Q}dispose(){}mc(){G.AFrameworkApplication.va.qa(Se.a.jXb,ed.a.application,this.Sam)}yMi(d){let n=0;(d=d.kq)&&0<d.count&&(n=d.K(0).Uj);return n}GUm(d){const n=[];for(const B of d)n.push({["content"]:B.Run,["lang"]:B.Lang});return n}static BZo(d,n,B){const Q=d.list,ha=d.listItem;let Aa="";Q&&ha&&(Aa=Q.levelTypes[ha.level]?d.listItem.listString+" ":
"\u2022 ");n.Run=Aa+B;return Aa.length}static main(){G.AFrameworkApplication.BL||U.a.instance.Rc(new SB)}}Object(D.a)(SB,"LearningToolsContentExtractorPackage",null,[0,1]);class mA{constructor(d,n){this.Sdd=d;this.ub=n;this.Z=null;this.zKo=(B,Q,ha)=>{if(1===ha)return this.bYo(this.ub.ob.currentSelection)?32:16;2===ha&&this.Z.Za("WordEditor.INeuralRewriteMessageHandler").execute(Aa=>{Aa.p6n()});return 32}}bYo(d){if(!this.csc(d)||d.AZa)return!1;d=d.Ya;if(bf.ParagraphReader.Xn(d)||Lj.a.Df(d)||Lj.a.Rm(d)){switch((this.Sdd.KMa(d)||
G.AFrameworkApplication.lcid)&1023){case 9:return!0;case 10:if(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}csc(d){return d.GN||2<d.length||!d.length||2===d.length&&!Lj.a.em(d.hd)||1===d.length&&Lj.a.em(d.hd)?!1:this.w5f(d.Ya)}w5f(d){return bf.ParagraphReader.lc(d.node)?""!==bf.ParagraphReader.text(d.node).trim():!1}get name(){return"WordEditor.NeuralRewrite"}Ec(d){this.Z=d}init(){const d=G.AFrameworkApplication.J;
(d.$("RewriteIsEnabled")||d.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled(Jy.a.Slj,!1).then(B=>{B&&G.AFrameworkApplication.va.nb(dd.a.rewrite,S.a.frame,this.zKo,1028);return null})})}dispose(){}static main(){U.a.instance.Rc(new mA(Wa.a.instance.resolve("Box4.ILanguageReader"),Wa.a.instance.resolve("Box4.ISelectionManager")))}}Object(D.a)(mA,"NeuralRewritePackage",
null,[0,1]);class ND{constructor(d,n){this.Wqa=this.wi=null;this.Eid=(B,Q)=>{if(10===Q.type&&(B="boolean"===typeof Q.fC?Q.fC?1:0:Q.fC,this.Wqa!==B)){Q="";switch(B){case null:case 0:Q="Session not connected to OCS.";break;case 1:Q="Session connected to OCS.";break;case 2:Q="Session connected to OCS (WPM).";break;default:F.ULS.shipAssertTag(523120715,337,!1,"Unexpected hint value {0}",B)}F.ULS.sendTraceTag(523120716,337,50,Q);this.Wqa=B;this.xla.OW(ez.a.Qgg)}};this.bPa=(B,Q)=>{Q.newState||(F.ULS.sendTraceTag(36806805,
337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Wqa=null,this.xla.OW(ez.a.Qgg))};this.BGp=(B,Q,ha,Aa,bb)=>{if(1===ha)return 32;bb[N.a.Visible]=null!=this.Wqa;switch(this.Wqa){case null:case 0:bb[N.a.Value]=WacWordeditorStrings.OcsNotConnected;break;case 1:bb[N.a.Value]=WacWordeditorStrings.OcsConnected;break;case 2:bb[N.a.Value]=WacWordeditorStrings.OcsFluidConnected;break;default:bb[N.a.Value]=WacWordeditorStrings.OcsNotConnected,F.ULS.shipAssertTag(523120717,337,
!1,"Unexpected hint value {0}",this.Wqa)}bb[V.a.labelText]=bb[N.a.Value];return 32};this.ga=d;this.xla=n}init(d){d?(this.wi=d,this.wi.CQ(this.Eid),this.wi.K0(this.bPa),this.ga.nb(dd.a.fDj,ed.a.application,this.BGp,96)):F.ULS.sendTraceTag(36282374,306,10,"Null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.wi&&this.wi.OFa(this.Eid)}}Object(D.a)(ND,"OcsConnectionStatusManager",null,[11]);class Yt{constructor(){this.Wqa=this.wi=null;this.Eid=(d,n)=>{10===n.type&&("boolean"===
typeof n.fC?this.Wqa=d=n.fC?1:0:d=n.fC,this.Wqa=d,F.ULS.sendTraceTag(508826904,337,50,"Ocs connection status:"+this.Wqa))};this.bPa=(d,n)=>{n.newState||(F.ULS.sendTraceTag(508826903,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Wqa=null)}}init(d){d?(this.wi=d,this.wi.CQ(this.Eid),this.wi.K0(this.bPa)):F.ULS.sendTraceTag(508826905,306,10,"Ocs State Manager null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.wi&&this.wi.OFa(this.Eid)}}Object(D.a)(Yt,
"OcsStateManager",null,[11]);class XK{constructor(){this.Z=null}get name(){return"WordEditor.OcsConnectionStatusPackage"}Ec(d){this.Z=d;this.Z.ja("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager",()=>new ND(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.IStatusBarUser"))).ha();this.Z.ja("WordEditor.OcsConnectionStatus.OcsStateManager",()=>new Yt).ha()}init(){const d=this.Z.resolve("Common.IAppSettingsManager");this.qfn();d.$("WordEditorShowOcsConnectionStatus")&&this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>
{this.Sp()})}qfn(){const d=this.Z.resolve("WordEditor.OcsConnectionStatus.OcsStateManager");this.Z.Za("Box4.Presence.IRtcProxyProvider").execute(n=>{n.jF().continueWith(()=>{const B=n.jF().result;d.init(B)})})}Sp(){const d=this.Z.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager");this.Z.Za("Box4.Presence.IRtcProxyProvider").execute(n=>{n.jF().continueWith(()=>{const B=n.jF().result;d.init(B)})})}dispose(){}static main(){U.a.instance.Rc(new XK)}}Object(D.a)(XK,"OcsConnectionStatusPackage",
null,[0,1]);var ft=e(1110);class nA{constructor(d,n){this.clientId=d;this.Z2=n}}Object(D.a)(nA,"VectorClockInfo",null,[]);class zs{constructor(d,n,B){this.Fcc=d;this.td=n;this.nDk=B}lbn(){let d=this.YQm();return d||(d=this.mQl(),d)?this.mbn(d):(F.ULS.sendTraceTag(25723860,381,10,"Cannot create client vector clock graph node."),!1)}KLi(){return this.iAi(this.Fcc)}iAi(d){const n=this.V9d();if(n&&n.ic(1)){do{const B=n.currentNode,Q=B.getValue(Dd.a.CJe);if(Q==d)return d=B.getValue(Dd.a.Z2),new nA(Q,d)}while(n.gg(1))
}return null}Qnm(){const d=this.V9d();if(!d)return null;if(!d.ic(1))return nl.empty();const n=new ma.a;do{var B=d.currentNode;const Q=B.getValue(Dd.a.CJe);B=B.getValue(Dd.a.Z2);Q?n.add(new nA(Q,B)):F.ULS.sendTraceTag(25723861,381,15,"A vector clock node with null client id is present in the graph.")}while(d.gg(1));return n}mQl(){const d=this.V9d();if(!d)return null;const n=new ft.a;n.setValue(Dd.a.CJe,this.Fcc);n.setValue(Dd.a.Z2,0);d.pg(n,1);return n}YQm(){const d=this.V9d();if(d&&d.ic(1)){do{const n=
d.currentNode;if(n.getValue(Dd.a.CJe)==this.Fcc)return n}while(d.gg(1))}return null}mbn(d){if(!d)return F.ULS.sendTraceTag(25723862,381,10,"Client vector clock node is null."),!1;const n=d.getValue(Dd.a.Z2)+1;d.setValue(Dd.a.Z2,n);return!0}V9d(){var d=this.nDk();if(!d)return F.ULS.sendTraceTag(25723864,381,10,"Cannot get an iterator since page content node is null."),null;d=this.td.Gua(d,7,7);return d.ic(33)?d:(F.ULS.sendTraceTag(25723865,381,10,"Ocs Vector clock container node doesn't exist."),null)}}
Object(D.a)(zs,"ClientGraphOcsVectorClockHandler",null,[988]);class Gl{constructor(d,n,B,Q){this.zqa=d;this.kCf=n;this.p4l=B;this.sSo=Q}}Object(D.a)(Gl,"VectorClockBroadcastData",null,[]);class VF{Xwm(d){if(!d)return F.ULS.sendTraceTag(25557077,381,15,"Unable to parse vector clock update message {0}",d),null;if(!d.SL1&&!d.SL2)return F.ULS.sendTraceTag(42243083,381,50,"Save Latency Message is null. [Message: {0}]",d),null;if(d.SL2)return this.aPi(d.SL2);F.ULS.sendTraceTag(508833934,381,50,"Found save latency message with older SL1 format.");
return this.aPi(d.SL1)}aPi(d){return new Gl(new nA(d.VCE.I.toUpperCase(),d.VCE.V),d.E,d.ER,d.SAG)}FPm(d){return d?{SL2:{E:d.kCf,ER:d.p4l,SAG:d.sSo,VCE:{I:d.zqa.clientId,V:d.zqa.Z2}}}:null}}Object(D.a)(VF,"OcsVectorClockRtcMessageConverter",null,[987]);class zI extends Sys.EventArgs{constructor(d){super();this.ull=d}}Object(D.a)(zI,"OcsVectorClockRtcEventArgs",Sys.EventArgs,[]);class Vw{constructor(d){this.sa=new dc.a;this.wi=null;this.bgf=this.vi=!1;this.pIh=d}w8k(d){this.sa.addHandler("OnVectorClockRtcReceivedEventKey",
d)}mJo(d){this.sa.removeHandler("OnVectorClockRtcReceivedEventKey",d)}l8k(d){this.sa.addHandler("OnSuccessfulSaveToOcsEventKey",d)}gJo(d){this.sa.removeHandler("OnSuccessfulSaveToOcsEventKey",d)}s8k(d){this.sa.addHandler("OnTransitionInToOcsEventKey",d)}jJo(d){this.sa.removeHandler("OnTransitionInToOcsEventKey",d)}t8k(d){this.sa.addHandler("OnTransitionOutOfOcsEventKey",d)}kJo(d){this.sa.removeHandler("OnTransitionOutOfOcsEventKey",d)}init(d){this.vi?F.ULS.sendTraceTag(25557078,381,10,"Trying to initialize OcsVectorClock Rtc Notification Handler again after it's already initialized."):
d?(this.vi=!0,this.wi=d,this.wi.CQ((n,B)=>{this.X9n(B)})):F.ULS.sendTraceTag(25557079,381,10,"Null rtcProxy. Cannot initialize OcsVectorClock Rtc Notification Handler.")}szc(d){this.wi&&d&&this.wi.sE(8,this.pIh.FPm(d))}X9n(d){8===d.type?(d=this.pIh.Xwm(d.fC))&&this.sa.raiseEvent("OnVectorClockRtcReceivedEventKey",new zI(d)):10===d.type?((d="boolean"===typeof d.fC?d.fC:0!==d.fC)?this.bgf||this.sa.raiseEvent("OnTransitionInToOcsEventKey"):this.bgf&&this.sa.raiseEvent("OnTransitionOutOfOcsEventKey"),
this.bgf=d):11===d.type&&this.sa.raiseEvent("OnSuccessfulSaveToOcsEventKey")}}Object(D.a)(Vw,"OcsVectorClockRtcNotificationHandler",null,[986]);class WF{constructor(d,n,B,Q,ha){this.rJa=B;this.iI=Q;this.L_=ha;this.Urh=(Aa,bb)=>{n.ebo(bb.ull)};this.Trh=()=>{n.Y5n()};this.KDh=()=>{d.$$n()};this.eDh=()=>{d.elg();n.elg()};this.fDh=()=>{d.flg();n.flg()};this.oCh=()=>{d.Fpe()}}Hjm(){this.rJa.w8k(this.Urh);this.iI.YUd(this.Trh);this.rJa.l8k(this.KDh);this.rJa.s8k(this.eDh);this.rJa.t8k(this.fDh);this.L_.UUd(this.oCh)}Mea(){this.rJa&&
(this.rJa.mJo(this.Urh),this.rJa.gJo(this.KDh),this.rJa.jJo(this.eDh),this.rJa.kJo(this.fDh));this.iI&&this.iI.UJj(this.Trh);this.L_&&this.L_.vwg(this.oCh)}}Object(D.a)(WF,"OcsVectorClockTelemetryEventForwarder",null,[]);class Du{constructor(d,n){this.jDb=d;this.LZn=n}}Object(D.a)(Du,"JournalEntry",null,[]);class Ux{constructor(d,n,B,Q,ha,Aa,bb){this.zka=!0;this.Fcc=d;this.Rk=n;this.z7b=B;this.Cff=Q;this.Rgg=Aa;this.TG=bb}ebo(d){if(!this.zka){var n=this.TG(),B=d.zqa.clientId;if(B===this.Fcc)F.ULS.sendTraceTag(25723870,
381,100,"Receiving own broadcast. Ignoring!");else if(this.hCn(B))F.ULS.sendTraceTag(25723871,381,100,"Receiving vector clock broadcast from a WAC client {0}. Ignoring!",B);else{var Q=this.z7b.iAi(B);Q&&Q.Z2>=d.zqa.Z2?F.ULS.sendTraceTag(25723872,381,100,"Receiving late vector clock broadcast for client {0} with vector clock value {1}. Ignoring!",B,d.zqa.Z2):this.Cff.yB(new Du(d,n))}}}Y5n(){if(!this.zka){var d=this.TG(),n=this.z7b.Qnm();if(n)for(const B of n){if(n=this.Cff.iko(B.clientId,B.Z2))for(const Q of n)this.cMn(Q,
d)}else F.ULS.sendTraceTag(25798300,381,10,"Cannot fetch vector clocks from graph. Disabling OcsVectorClockTelemetryInboundManager."),this.zka=!0}}elg(){F.ULS.sendTraceTag(36712913,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryInboundManager.");this.zka=!1}flg(){F.ULS.sendTraceTag(36712914,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryInboundManager.");this.zka=!0;this.Cff.Bxl()}cMn(d,n){var B;n=n.getTime()-d.LZn.getTime();if(0>n)F.ULS.sendTraceTag(25723873,381,
100,"Received content before broadcast for VC {0} of client {1}. Ignoring!",d.jDb.zqa.Z2,d.jDb.zqa.clientId);else{var Q=Math.round(d.jDb.kCf/1E3),ha=Q+n,Aa=null;Aa=this.Rgg.Wqa;var bb=null===(B=G.AFrameworkApplication.J)||void 0===B?void 0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);G.AFrameworkApplication.ud("7d2eh734;0egbh454");bb&&2==Aa&&(B=Wa.a.instance.Za("Common.ISystemInitiatedFeedback"))&&B.execute(Ib=>{Ib.logActivity("FluidOnWebCoauthSentimentSurvey",
null)});F.ULS.sendTraceTag(25723874,381,20,"Ocs Replication: {0}",Ux.Cwf(d.jDb.zqa.clientId,this.Fcc,d.jDb.zqa.Z2,Q,n,ha,Aa))}}hCn(d){return(d=this.Rk.Wy.Vlc(Ux.bsm(d)))&&d.Capabilities?d.Capabilities.SupportsAppInnerLoop:!1}static bsm(d){return"{"+d.toLowerCase()+"}"}static Cwf(d,n,B,Q,ha,Aa,bb){return{["S"]:d,["R"]:n,["V"]:B,["OT"]:bb,["ST"]:Q,["RT"]:ha,["T"]:Aa}}}Object(D.a)(Ux,"OcsVectorClockTelemetryInboundManager",null,[]);var TB=e(1147);class AI extends $r.a{constructor(d){super();this.xFk=
d}get index(){return 0}run(){this.xFk()}BK(){this.t2()}}Object(D.a)(AI,"OcsVectorClockUpdateProcessor",$r.a,[]);class BI{constructor(d,n,B,Q,ha,Aa){this.vi=!1;this.zka=!0;this.x9b=this.S4e=null;this.Dff=!0;this.VIp=()=>{this.zka||this.Dff||(this.z7b.lbn()?this.Dff=!0:(F.ULS.sendTraceTag(25557084,381,10,"Cannot update vector clock graph node. Disabling OcsVectorClockTelemetryOutboundManager."),this.zka=!0))};this.Iaa=d;this.z7b=n;this.rJa=B;this.Rgg=ha;this.TG=Aa}init(){this.vi?F.ULS.sendTraceTag(25557082,
381,10,"Trying to initialize OcsVectorClockTelemetryOutboundManager again after it's already initialized."):(this.X8m(),this.vi=!0)}HSo(){const d=this.z7b.KLi();d?(TB.a.StaticVarVectorClockClientId=d.clientId,TB.a.StaticVarVectorClockValue=d.Z2):(TB.a.StaticVarVectorClockClientId=null,TB.a.StaticVarVectorClockValue=null);TB.a.StaticVarFirstEditTime=new Date}X8m(){this.S4e=new AI(this.VIp);this.Iaa.Cxa(this.S4e,7)}Fpe(){this.HSo();this.zka||this.x9b||(this.x9b=this.TG(),this.Dff=!1,this.S4e.BK())}$$n(){!this.zka&&
this.x9b&&(this.vll(),this.x9b=null)}elg(){F.ULS.sendTraceTag(36712918,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryOutboundManager.");this.x9b=null;this.zka=!1}flg(){F.ULS.sendTraceTag(36712919,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryOutboundManager.");this.zka=!0}vll(){var d;if(!this.zka){var n=this.z7b.KLi();if(n){var B=1E3*(this.TG().getTime()-this.x9b.getTime());n=new Gl(n,B,0,"{CCCCCCCC-CCCC-CCCC-CCCC-FFFFFFFFFFFF}");this.rJa.szc(n);B=null===(d=G.AFrameworkApplication.J)||
void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);G.AFrameworkApplication.ud("7d2eh734;0egbh454");d=null;d=this.Rgg.Wqa;B&&2==d&&(B=Wa.a.instance.Za("Common.ISystemInitiatedFeedback"))&&B.execute(Q=>{Q.logActivity("FluidOnWebCoauthSentimentSurvey",null)});F.ULS.sendTraceTag(36712920,381,50,"Vector clock broadcast: {0}",BI.Cwf(n.zqa.clientId,n.zqa.Z2,n.kCf,d))}else F.ULS.sendTraceTag(25557086,381,10,"Unable to get self vector clock from graph. Disabling OcsVectorClockTelemetryOutboundManager."),
this.zka=!0}}static Cwf(d,n,B,Q){return{["S"]:d,["V"]:n,["OT"]:Q,["ST"]:B}}}Object(D.a)(BI,"OcsVectorClockTelemetryOutboundManager",null,[]);var XF=e(1928);class UB{constructor(){this.XMc=new ff.a;this.jKd=new ff.a}yB(d){const n=d.jDb.zqa.clientId,B=d.jDb.zqa.Z2;let Q;({value:Q}=this.XMc.Nc(n,Q)).returnValue||(Q=new XF.a,this.XMc.W(n,Q));if(30<=Q.count)F.ULS.sendTraceTag(25723905,381,50,"Already {0} pending entries in the journal for client {1}. Ignoring the new entry with vector clock value {2}!",
Q.count,n,B);else{var ha;({value:ha}=this.jKd.Nc(n,0)).returnValue&&ha>=B||(Q.enqueue(d),this.jKd.W(n,B))}}iko(d,n){let B;if(!({value:B}=this.XMc.Nc(d,B)).returnValue||!B||!B.count)return null;for(d=new ma.a;!B.isEmpty;){const Q=B.MW();if(Q.jDb.zqa.Z2>n)break;d.add(Q);B.dequeue()}return d}Bxl(){for(const d of this.XMc.keys)this.XMc.remove(d);for(const d of this.jKd.keys)this.jKd.remove(d)}}Object(D.a)(UB,"VectorClockJournal",null,[843]);class Vx{constructor(){this.Z=null;this.Pp=()=>{const d=yg.StaticActiveAppFrame.Aa().tb.Xc;
return d?d.Fd:null}}get name(){return"WordEditor.OcsVectorClockTelemetry"}get clientId(){return G.AFrameworkApplication.userSessionId.toUpperCase()}Ec(d){this.Z=d;d.ja("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler",()=>new zs(this.clientId,d.resolve("Box4.Graph.IGraphIteratorFactory"),this.Pp)).ha();d.ja("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter",()=>new VF).ha();d.ja("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler",()=>
new Vw(d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter"))).ha();d.ja("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal",()=>new UB);d.ja("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager",()=>new BI(d.resolve("Box4.Graph.IGraphTransactionManager"),d.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),d.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),
d.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();d.ja("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager",()=>new Ux(this.clientId,aa.a.Gd(),d.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),d.resolve("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal"),d.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),d.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();d.ja("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder",
()=>new WF(d.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager"),d.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager"),d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),yB.a.instance,d.resolve("Box4.ContentEditableViewEventSource"))).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){this.Icn();const d=this.Z.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler");
this.Z.Za("Box4.Presence.IRtcProxyProvider").execute(n=>{n.jF().continueWith(()=>{const B=n.jF().result;d.init(B)})});this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder").Hjm()}Icn(){this.Z.resolve("Common.IAppSettingsManager");this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager").init();this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager")}dispose(){if(this.Z){var d=this.Z.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder");
d&&d.Mea()}}static main(){U.a.instance.Rc(new Vx)}}Object(D.a)(Vx,"OcsVectorClockTelemetryPackage",null,[0,1]);var VB=e(1934),YK=e(1701);class CI{constructor(d,n){this.ff=d;this.Jfa=n}initialize(){const d=gg.a.Km();d&&d.then(()=>{this.yad()?this.ff.Cb(this,"AugLoop_SecurityClp_LabellingAnnotation"):this.ff.Cb(this,"AugLoop_Automatic_Clp_LabellingAnnotation")})}XI(d=null,n=null){F.ULS.sendTraceTag(575963811,337,50,"HandleAnnotationEvent");if(eo.WoncaApp.Aba.zOp.$2f()){if(this.yad()){if(!d||"AugLoop_SecurityClp_LabellingAnnotation"!==
d.annotationType){F.ULS.sendTraceTag(538845259,337,15,"HandleAnnotationEvent - unsupported annotation");return}}else if(!d||"AugLoop_Automatic_Clp_LabellingAnnotation"!==d.annotationType){F.ULS.sendTraceTag(575972804,337,15,"HandleAnnotationEvent - unsupported annotation");return}if(!n||n!==Qj.a.getTypeName()&&n!==Ax.a.getTypeName())F.ULS.sendTraceTag(575972805,337,15,"HandleAnnotationEvent - unsupported opType");else{n=d.content||{};d=n.automatic||{};var B=d.sensitivityLabel||{};d=this.yad()?d.id:
B.id;B=n.recommended||{};var Q=B.sensitivityLabel||{};n=this.yad()?B.id:Q.id;B=this.yad()?B.policyTip:Q.policyTip;this.Jfa.Xcl(d,n,B,this.xtn())}}else F.ULS.sendTraceTag(575972803,337,15,"HandleAnnotationEvent - not IsNotRead")}xtn(){const d=yg.StaticActiveAppFrame.Aa().tb.rd.Pba;return!d.Zla||""===d.Zla||d.xWb}yad(){return G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(D.a)(CI,"AutoClpAnnotationEventHandler",null,[365]);class ZK{I$h(d,
n,B,Q,ha,Aa,bb,Ib){const oc=n.Cog;let Ac="",ad="";const sd=d.DefaultLabelId;let wd;d.SensitivityLabels.forEach(ye=>{ye.Id==Ib&&(Ac=ye.ParentId);ye.Id==oc&&(ad=ye.ParentId);ye.Id==sd&&ye.ParentId&&(wd=ye.ParentId)});const yd=[];d.SensitivityLabels.forEach(ye=>{ye.Id!=Ib&&ye.Id!=Ac&&ye.Id!=oc&&ye.Id!=ad&&ye.Id!=d.DefaultLabelId||yd.push(ye);wd&&ye.Id==wd&&yd.push(ye)});d.SensitivityLabels=yd;const be={};be.clpLabelId=n.Cog||"";be.clpTenantId=Q;be.clpApplyLabelFlags=n.oKa;be.clpSupportsOfficeClientCoauthoring=
B;be.clpUserName=ha;be.clpUserPrincipalName=Aa;be.clpDocLocation=bb;be.clpActions=Rb.c(d);n=Rb.c(be);B=[];B.push(n);return B}}Object(D.a)(ZK,"AutoSaveParameterComposer",null,[840]);class Ct{}Ct.V8h="WordClpReadPolicy";Ct.shc="WordClpSetPolicy";Ct.GZd="wordclpfc";Object(D.a)(Ct,"Constants",null,[]);class Si{constructor(d){this.GGh=!0;this.gph=this.DFd=this.fph=0;this.lBd=this.BWe=!1;this.Erd=this.Sb=null;this.iga=()=>aa.a.Gd().Yq||aa.a.Gd().iga&&aa.a.Gd().Wy.gOa;this.o1n=()=>{G.AFrameworkApplication.va.nb(Se.a.tdk,
S.a.frame,this.WGp,96);pq.a.xr(Si.Z.Za("Common.App.Policy.Contracts.IPolicyManager")).continueWith(n=>{var B=0;Ua.Health.instance.recordKpiUsage(Ct.V8h,1,Ct.GZd,this.Hab());B=(new Date).getTime();Si.oi=n.result;this.unb&&(Si.oi.ccn(aa.a.uDa().CWR(()=>aa.a.uDa().result.Wy)),Si.oi.xcn(Si.Z.Za("Common.Interface.IRtcBasicProvider")),Si.oi.J6k(this.sMm));Si.oi.xvb=Si.oi.xvb&&G.AFrameworkApplication.J.$("WordApplyManualPolicyLabelIsEnabled");this.lBd&&Si.oi.S8k(this.B$n);Si.oi.s7i=!0;Si.oi.$Uj=G.AFrameworkApplication.J.sc("WordClpSetPolicyLabelZeroByteFailureRetryIntervalMs",
3E4);Si.oi.aVd(this.A$n);Si.oi.Kjf(this.z$n);G.AFrameworkApplication.J.$("AutoClpIsEnabled")&&G.AFrameworkApplication.J.$("AugLoopAnnotationsIsEnabled")&&(Si.oi.I6k(this.FAo),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(Si.oi.F6k(this.Q0d),Si.oi.a9k(this.uCp),Si.oi.b9k(this.vCp)));Si.oi.zUh(this.Wdl);Si.oi.Z8k(this.qzp);n=G.AFrameworkApplication.J.rb("AppliedPolicyId");""===n&&(n=this.lae().Zla);Si.hFb=n;Si.oi.W5i()?Si.oi.Wko(this.iga):
G.AFrameworkApplication.$v||Si.oi.mtb(n,yc.Znf,this.iga,!1);B=Object.assign(new jd.a,{durationMs:(new Date).getTime()-B});Ua.Health.instance.recordKpiSuccess(Ct.V8h,B)});pq.a.xr(Si.Z.Za("Common.App.Policy.Contracts.IPolicyActor")).continueWith(n=>{Si.Jfa=n.result;Si.Jfa.xvb=Si.Jfa.xvb&&G.AFrameworkApplication.J.$("WordApplyManualPolicyLabelIsEnabled")})};this.sMm=(n,B)=>{F.ULS.sendTraceTag(579203664,337,100,"GetPolicyLabelHandler");this.BWe&&(Si.hFb=Si.oi.nu.AppliedPolicyId,Si.bSe=Si.oi.nu.PolicyLabelVersionToken);
n=this.lae();this.y$i(n.Zla,Si.oi.nu.AppliedPolicyId)||!(0<this.DFd)||this.BWe&&B.tMm===yc.eWo||(this.DFd--,F.ULS.sendTraceTag(579737543,337,15,"LabelId from host did not match content stream."),B=new tb.a(2,1,this.gph,()=>{F.ULS.sendTraceTag(579715490,337,15,"Retrying GetDocumentPolicyLabelsRequestAsync after labelId mismatch. getPolicyRetryRemainingCount : {0}",this.DFd);const Q=this.lae();Si.oi.mtb(Q.Zla,yc.refresh,this.iga,!0)}),this.Sb.pc(B))};this.WGp=(n,B,Q)=>{F.ULS.sendTraceTag(579203665,
337,100,"UpdatePolicyLabelFromBox4 - Begin.");if(1===Q)return 32;n=this.lae();const ha=n.Zla;n=this.unb?n.g_b:null;if(this.unb?Si.bSe===n:this.y$i(Si.hFb,ha))return F.ULS.sendTraceTag(579203666,337,100,"UpdatePolicyLabelFromBox4 - Label Change not detected."),32;F.ULS.sendTraceTag(579203667,337,100,"UpdatePolicyLabelFromBox4 - Label Change detected.");this.DFd=this.fph;Si.oi?Si.oi.mtb(ha,yc.refresh,this.iga,!0):pq.a.xr(Si.Z.Za("Common.App.Policy.Contracts.IPolicyManager")).continueWith(Aa=>{Si.oi=
Aa.result;Si.oi.mtb(ha,yc.refresh,this.iga,!0)});Si.hFb&&(Si.N7e=Si.hFb);Si.hFb=ha;this.unb&&(Si.bSe=n);F.ULS.sendTraceTag(579203668,337,100,"UpdatePolicyLabelFromBox4 - End.");return 32};this.B$n=(n,B)=>{n=this.Hab(B.Llf);Ua.Health.instance.recordKpiUsage(Ct.shc,1,Ct.GZd,n);this.Erd=this.Zq()};this.z$n=(n,B)=>{this.lBd||Ua.Health.instance.recordKpiUsage(Ct.shc,1,Ct.GZd,this.Hab());n=this.Psb(B.Llf,this.Erd);n.extendedProperties.set("ErrorType",ln[B.errorType]);Ua.Health.instance.recordKpiFailure(Ct.shc,
"Shared or Host SetPolicyLabel failure.",!1,!1,n)};this.A$n=(n,B)=>{this.lBd||(Ua.Health.instance.recordKpiUsage(Ct.shc,1,Ct.GZd,this.Hab()),this.Erd=this.Zq());n=yg.StaticActiveAppFrame.Aa().tb.rd;if(!this.unb){var Q=new Mc.GraphTransaction(0);try{Q.Eb(n),n.Pba.Zla=B.Cog}finally{Q&&Q.dispose()}}Si.tAd=Si.Z.resolve("WordEditor.AutoSaveParamsUpdateService");Q=new vc.a;Q.set(n);if(Si.nI.bU(Q)){n=Q.ic(35);Q=Si.oi.nu;var ha=Dd.a.KDg,Aa=G.AFrameworkApplication.J,bb=null;bb=Aa.rb("EditDocInClientUrl");
bb||(F.ULS.sendTraceTag(523567771,337,50,"EditDocInClientUrl setting was empty. Falling back to WopiSrc"),bb=Aa.rb("WopiSrc"));bb||F.ULS.sendTraceTag(523567772,337,10,"WopiSrc setting was empty.");var Ib=null;Ib=Si.N7e?this.geh.I$h(Q,B,this.unb,Aa.rb("TenantId"),Aa.rb("UserName"),Aa.rb("UserPrincipalName"),bb,Si.N7e):this.geh.I$h(Q,B,this.unb,Aa.rb("TenantId"),Aa.rb("UserName"),Aa.rb("UserPrincipalName"),bb,Si.hFb);Si.tAd.FRj(n,ha,Ib,()=>{const oc=this.Psb(B.oKa,this.Erd);Ua.Health.instance.recordKpiSuccess(Ct.shc,
oc)},(oc,Ac)=>{oc=this.Psb(B.oKa,this.Erd);oc.extendedProperties.set("statusCode",Tp.a[Ac]);Ua.Health.instance.recordKpiFailure(Ct.shc,"Word Save Failed",!1,!1,oc);F.ULS.sendTraceTag(592311969,337,10,"SetPolicyLabel Save failed with {0}.",Tp.a[Ac])})}};this.FAo=()=>{this.GGh&&(Si.Zdh=new CI(Si.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),Si.Z.resolve("Common.App.Policy.Contracts.IPolicyActor"),Si.oi),Si.Zdh.initialize());this.GGh=!1};this.Q0d=(n,B)=>{const Q=Object.assign(new Qj.a,{parentPath:["session",
"doc","security"],items:[Object.assign(new nv.a,{id:"clp",body:Object.assign(new VB.CLP,{existingLabelPriority:B.existingLabelPriority,partialDocSITs:B.U8h,fullDocSITs:B.T8h})})]});gg.a.Km().then(()=>{yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:Q}))})};this.uCp=(n,B)=>{const Q=Object.assign(new Ax.a,{parentPath:["session","doc","security"],items:[Object.assign(new nv.a,{id:"clp",body:Object.assign(new VB.CLP,{existingLabelPriority:B.existingLabelPriority})})]});gg.a.Km().then(()=>
{yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:Q}))})};this.vCp=(n,B)=>{const Q=Object.assign(new Ax.a,{parentPath:["session","doc","security"],items:[Object.assign(new nv.a,{id:"clp",body:Object.assign(new VB.CLP,{partialDocSITs:B.U8h,fullDocSITs:B.T8h})})]});gg.a.Km().then(()=>{yu.a.IB().submitOperation(Object.assign(new Kw.a,{operation:Q}))})};this.Wdl=(n,B)=>{B&&B.appMode?(n=1===B.appMode,G.AFrameworkApplication.va.Zb(n?dd.a.NBc:dd.a.mhb,2,{IsFromMandatoryLabeling:!0}),n||""===B.Fhj||
Si.Jfa.Xdl(B.Fhj),B=n?1:3,n=G.AFrameworkApplication.va.mode,B!==n&&F.ULS.sendTraceTag(545818049,337,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",B,n)):F.ULS.sendTraceTag(572302786,337,15,"ApplyMandatoryLabeling is called with invalid inputs.")};this.qzp=(n,B)=>{B.rap&&G.AFrameworkApplication.va.Zb(Se.a.KZ,2,!1)};this.geh=d}get unb(){return G.AFrameworkApplication.J.$("SupportsOfficeClientCoauthoring")&&G.AFrameworkApplication.J.$("CoAuthForProtectedFilesIsEnabled")}get name(){return"WordEditor.Policy"}init(){Si.nI=
Object($g.a)();this.Sb=ib.TaskManager.instance;Si.Dc.Fs.continueWith(()=>{this.Sp()});this.fph=G.AFrameworkApplication.J.sc("WordClpGetPolicyRetryCount",10);this.gph=G.AFrameworkApplication.J.sc("WordClpGetPolicyRetryTimeoutMs",3E4);this.BWe=G.AFrameworkApplication.J.$("WordClpGetPolicyUpdateLocal");this.lBd=G.AFrameworkApplication.J.$("ClpKpiIsEnabled")}dispose(){}Ec(d){Si.Z=d;Si.Z.ja("WordEditor.AutoSaveParamsUpdateService",()=>new YK.a(Si.Z.resolve("Box4.Graph.IGraphIteratorFactory"),fg.a.rT)).ha()}Zq(){return(new Date).getTime()}Sp(){Si.Dc.isFeatureEnabled(57)&&
G.AFrameworkApplication.J.$("SupportsPolicies")&&Fe.a.get_instance().Zk(10,this.o1n)}Hab(d=null){const n=new Map;n.set("ClpCoauth",this.unb.toString());null!=d&&n.set("ApplyLabelFlags",cd[d]);return n}lae(){return yg.StaticActiveAppFrame.Aa().tb.rd.Pba}y$i(d,n){return(d||"")===(n||"")}Psb(d,n){const B=new jd.a;B.extendedProperties=this.Hab(d);null!=n&&(B.durationMs=this.Zq()-n);return B}static get Dc(){return null!=Si.XZg?Si.XZg:Si.XZg=Si.Z.resolve("Box4.IFeatureHelper")}static main(){U.a.instance.Rc(new Si(new ZK))}}
Si.Z=null;Si.oi=null;Si.Jfa=null;Si.tAd=null;Si.nI=null;Si.Zdh=null;Si.hFb="";Si.bSe="";Si.N7e="";Object(D.a)(Si,"WordEditorPolicyPackage",null,[0,1]);class hz{}hz.ooo="Microsoft.Office.WordOnline.ProactiveUxOpenedCooldownMilliseconds";hz.noo="Microsoft.Office.WordOnline.ProactiveUxEngagedCooldownMilliseconds";Object(D.a)(hz,"Constants",null,[]);class oA{constructor(d,n=null){this.fRc=new ma.a;this.za=d;this.TG=n?n:()=>new Date;this.rYk=this.za.getIntFeatureGate(hz.ooo,24E4);this.pYk=this.za.getIntFeatureGate(hz.noo,
6E4)}CGj(d){this.fRc.contains(d)||this.fRc.add(d)}Qmf(d,n){if(1===this.fRc.count&&this.fRc.K(0).id===d)n();else{F.ULS.sendTraceTag(572339906,3025,50,"{0} attempted to trigger proactively",d);var B=this.TG(),Q=null,ha=null,Aa=null;for(const bb of this.fRc){if(bb.id===d&&bb.Qvc){F.ULS.shipAssertTag(572592797,3025,!1,"{0} is already open",d);return}this.r2i(bb.Qvc,Q?Q.Qvc:null)&&(Q=bb);this.r2i(bb.n2c,ha?ha.n2c:null)&&(ha=bb)}Q&&this.TXj(B,Q.Qvc,this.rYk)?Aa=Q:ha&&this.TXj(B,ha.n2c,this.pYk)&&(Aa=ha);
Aa?F.ULS.sendTraceTag(572838542,3025,50,JSON.stringify({QYp:d,DTp:Aa.id,ETp:Aa.Qvc,CTp:Aa.n2c})):n()}}r2i(d,n){return!!d&&(!n||d>n)}TXj(d,n,B){return!!n&&+d-+n<B}}Object(D.a)(oA,"ProactiveUxManager",null,[877]);class DI{get name(){return"WordEditor.ProactiveUxGovernance"}init(){}Ec(d){d?d.ja("WordEditor.ProactiveUxGovernance.IProactiveUxManager",()=>new oA(G.AFrameworkApplication.J)).ha():F.ULS.shipAssertTag(572838541,3025,!1)}dispose(){}}Object(D.a)(DI,"PackageManager",null,[0,1]);class YF{constructor(d){this.name=
d;this.Ani=1;this._lcidMap=[]}A3k(d,n){if(!n)throw Error.argumentNull(n.toLocaleString());this._lcidMap[d]=n}g9d(d){return this._lcidMap[d&1023]}isValid(){return this.name&&this._lcidMap?!0:!1}}Object(D.a)(YF,"LanguageModel",null,[1168,1009]);class Yu{constructor(){this.FAg=this.kuc=this.e1c=this.gzc=this.RSg=0}isValid(){return 0>=this.RSg||0>=this.gzc||0>=this.FAg||this.kuc>this.gzc?!1:!0}}Object(D.a)(Yu,"ObjectCountParameterSet",null,[1009]);class ZF{constructor(){this.Pyk=this.Myk=this.Vyk=this.Uyk=
0}create(d){switch(d){case 1:return this.bLl();default:throw Error.notImplemented("algorithmType");}}bLl(){const d=new YF("Default language model based on word, image and table count");this.Bc(d,0,0);this.Bc(d,1,138);this.Bc(d,2,184);this.Bc(d,3,218);this.Bc(d,4,158);this.Bc(d,5,166);this.Bc(d,6,199);this.Bc(d,7,179);this.Bc(d,8,184);this.Bc(d,9,228);this.Bc(d,10,218);this.Bc(d,11,161);this.Bc(d,12,195);this.Bc(d,13,187);this.Bc(d,14,161);this.Bc(d,15,179);this.Bc(d,16,188);this.Bc(d,17,193);this.Bc(d,
18,193);this.Bc(d,19,202);this.Bc(d,20,199);this.Bc(d,21,166);this.Bc(d,22,181);this.Bc(d,23,228);this.Bc(d,24,188);this.Bc(d,25,184);this.Bc(d,26,180);this.Bc(d,27,180);this.Bc(d,28,180);this.Bc(d,29,199);this.Bc(d,30,193);this.Bc(d,31,166);this.Bc(d,32,138);this.Bc(d,33,228);this.Bc(d,34,184);this.Bc(d,35,184);this.Bc(d,36,180);this.Bc(d,37,161);this.Bc(d,38,180);this.Bc(d,39,180);this.Bc(d,40,228);this.Bc(d,41,138);this.Bc(d,42,193);this.Bc(d,43,138);this.Bc(d,44,138);this.Bc(d,45,166);this.Bc(d,
46,228);this.Bc(d,47,180);this.Bc(d,48,228);this.Bc(d,49,228);this.Bc(d,50,228);this.Bc(d,51,228);this.Bc(d,52,228);this.Bc(d,53,228);this.Bc(d,54,202);this.Bc(d,55,184);this.Bc(d,56,199);this.Bc(d,57,228);this.Bc(d,58,228);this.Bc(d,59,228);this.Bc(d,60,228);this.Bc(d,61,179);this.Bc(d,62,228);this.Bc(d,63,184);this.Bc(d,64,184);this.Bc(d,65,228);this.Bc(d,66,228);this.Bc(d,67,184);this.Bc(d,68,184);this.Bc(d,69,228);this.Bc(d,70,228);this.Bc(d,71,228);this.Bc(d,72,228);this.Bc(d,73,228);this.Bc(d,
74,228);this.Bc(d,75,228);this.Bc(d,76,228);this.Bc(d,77,228);this.Bc(d,78,228);this.Bc(d,79,228);this.Bc(d,80,166);this.Bc(d,81,228);this.Bc(d,82,228);this.Bc(d,83,228);this.Bc(d,84,228);this.Bc(d,85,193);this.Bc(d,86,218);this.Bc(d,87,228);this.Bc(d,88,228);this.Bc(d,89,228);this.Bc(d,90,228);this.Bc(d,91,228);this.Bc(d,92,228);this.Bc(d,93,228);this.Bc(d,94,228);this.Bc(d,95,228);this.Bc(d,96,228);this.Bc(d,97,228);this.Bc(d,98,228);this.Bc(d,99,228);this.Bc(d,100,228);this.Bc(d,101,228);this.Bc(d,
102,228);this.Bc(d,103,228);this.Bc(d,104,228);this.Bc(d,105,228);this.Bc(d,106,228);this.Bc(d,107,228);this.Bc(d,108,228);this.Bc(d,109,228);this.Bc(d,110,228);this.Bc(d,111,228);this.Bc(d,112,228);this.Bc(d,113,228);this.Bc(d,114,228);this.Bc(d,115,228);this.Bc(d,116,228);this.Bc(d,117,228);this.Bc(d,118,228);this.Bc(d,119,228);this.Bc(d,120,228);this.Bc(d,121,228);this.Bc(d,122,228);this.Bc(d,124,228);this.Bc(d,126,228);this.Bc(d,127,228);this.Bc(d,128,228);this.Bc(d,129,228);this.Bc(d,130,228);
this.Bc(d,131,228);this.Bc(d,132,228);this.Bc(d,133,228);this.Bc(d,134,228);this.Bc(d,135,228);this.Bc(d,136,228);this.Bc(d,140,228);this.Bc(d,145,228);this.Bc(d,146,228);this.Bc(d,147,228);return d}Bc(d,n,B){d.A3k(n,Object.assign(new Yu,{RSg:B,gzc:this.Uyk,FAg:this.Vyk,e1c:this.Myk,kuc:this.Pyk}))}}Object(D.a)(ZF,"LanguageModelFactory",null,[990]);class OD{constructor(){this.MEj=this.HZf=this.VPb=0}}Object(D.a)(OD,"ReadingTimeValue",null,[]);class Av{constructor(){this.Ani=this.ykf=1;this.JKg=this.pXf=
this.wSg=this.ZMg=-1}}Object(D.a)(Av,"ReadingTimeOutput",null,[]);class EI{constructor(){this.ABh=!1;this.vDl=(d,n)=>n.VPb>d.VPb?1:d.VPb>n.VPb?-1:0}get ykf(){return 1}hQf(d,n,B){if(!d)throw Error.argumentNull("ReadingTimeInput");if(!n)throw Error.argumentNull("ObjectCountParameterSet");if(!B)throw Error.argumentNull("Language model is null");var Q=new ma.a,ha=0;for(var Aa=0;Aa<d.ldb.count;Aa++){var bb=B.g9d(d.ldb.K(Aa));void 0!==bb&&null!==bb?ha+=d.ADb.K(Aa)/B.g9d(d.ldb.K(Aa)).RSg:this.ABh||(this.ABh=
!0,F.ULS.sendTraceTag(41554646,338,50,"Language in paragraph is not supported in language model and is holding {0} words",d.ADb.K(Aa)))}this.tif(Q,ha,0);ha=B=0;Aa=n.gzc;0<n.e1c&&(B=Math.floor((n.gzc-n.kuc)/n.e1c),ha=(n.gzc-n.kuc)%n.e1c,Aa=n.kuc);Aa=Math.max(0,(d.xN-B)*Aa);for(bb=B;bb>=Math.max(0,B-d.xN+1);--bb)Aa+=n.kuc+ha+bb*n.e1c;this.tif(Q,Aa/60,1);this.tif(Q,d.Cea*n.FAg/60,2);d=this.Rql(Q);Q.Sc(this.vDl);n=this.Sql(Q);d=Object.assign(new Av,{ykf:this.ykf,Ani:1,ZMg:d});n=Math.round(n);for(const Ib of Q){Q=
Ib.HZf+(0<n?1:0);switch(Ib.MEj){case 0:d.wSg=Q;break;case 1:d.pXf=Q;break;case 2:d.JKg=Q}0<n&&n--}return d}tif(d,n,B){d.add(Object.assign(new OD,{MEj:B,HZf:this.LJi(n,Math.floor),VPb:n%1}))}Rql(d){let n=0;for(const B of d)n+=B.HZf+B.VPb;return this.LJi(n,Math.ceil)}Sql(d){let n=0;for(const B of d)n+=B.VPb;return n}LJi(d,n){d=n(d);if(!this.isSafeInteger(d)||0>d)throw Error.argumentOutOfRange("result is not a positive safe integer");return d}isSafeInteger(d){return isFinite(d)&&Math.floor(d)===d&&Math.abs(d)<=
this.MAX_SAFE_INTEGER}get MAX_SAFE_INTEGER(){return 9007199254740991}}Object(D.a)(EI,"ObjectCountReadingTimeStrategy",null,[1166]);class eM{constructor(d,n){if(!d)throw Error.argumentNull("IReadingTimeStrategy");if(!n)throw Error.argumentNull("ILanguageModel");if(!n.isValid())throw Error.argument("ILanguageModel");this.xQk=d;this.G1e=n}hQf(d){if(this.isValid(d)){if(this.Ksn(d))return new Av;if(!this.Ofl(d))throw Error.argument("Input fields are in invalid state");}else throw Error.argument("ReadingTimeInput is null");
let n=this.G1e.g9d(d.LCID);if(void 0===n||null===n)n=this.G1e.g9d(0);return this.xQk.hQf(d,n,this.G1e)}isValid(d){return d?!0:!1}Ksn(d){return 0>d.xN&&0>d.Cea&&!d.ldb&&!d.ADb}Ofl(d){return 0<=d.xN&&0<=d.Cea&&!!d.LCID}}Object(D.a)(eM,"ReadingTimeAlgorithm",null,[1008]);class FI{constructor(d){this.Vwh=d}create(d){if(!this.Vwh)throw Error.argumentNull("ILanguageModelFactory");switch(d){case 1:return this.createInstance(new EI,this.Vwh.create(d));default:throw Error.notImplemented("WordCount");}}createInstance(d,
n){if(!d)throw Error.argumentNull("IReadingTimeStrategy");if(!n)throw Error.argumentNull("LanguageModel");return new eM(d,n)}}Object(D.a)(FI,"ReadingTimeFactory",null,[989]);var fM=e(382);class WB{constructor(){this.hyb=this.fyb=this.numWords=this.Upp=this.wan=this.cSp=this.h1a=-1}}Object(D.a)(WB,"ReadingTimeStats",null,[898]);class $F{constructor(){this.P$=new WB;this.r$=new WB;this.bgk=this.agk=!1}get Bnj(){return this.Gmc(this.r$.numWords,this.P$.numWords,"WC",this.Wcd())}get two(){return this.iQf(this.r$.h1a,
this.P$.h1a,this.r$.numWords+this.r$.fyb+this.r$.hyb,this.P$.numWords+this.P$.fyb+this.P$.hyb,"RTSB")}get qwo(){return this.iQf(this.r$.h1a,this.P$.h1a,this.r$.numWords+this.r$.fyb+this.r$.hyb,this.P$.numWords+this.P$.fyb+this.P$.hyb,"RTDB",!0)}get rwo(){return this.iOm(this.r$.h1a,this.P$.h1a,this.r$.numWords+this.r$.fyb+this.r$.hyb,this.P$.numWords+this.P$.fyb+this.P$.hyb)}get pwo(){return this.Wcd()?WacWordeditorStrings.ReadingTimeStatsDialogSelectionDescription:WacWordeditorStrings.ReadingTimeStatsDialogDescription}Uxi(d,
n,B,Q){return Q?this.sRg(d,n,B):this.oxd(n,B)}Gmc(d,n,B,Q){return this.Uxi(d,n,B,Q).toLocaleString()}jQf(d,n,B,Q,ha,Aa,bb=!1){d=this.Uxi(d,n,ha,Aa);B=Aa?B:Q;Q=Math.floor(d/1440);ha=d%1440;d=Math.floor(ha/60);ha%=60;if(0<Q)return d?String.format(WacWordeditorStrings.ReadingTimeResultComposite,String.format(WacWordeditorStrings.ReadingTimeResultDay,Q),String.format(WacWordeditorStrings.ReadingTimeResultHour,d)):String.format(WacWordeditorStrings.ReadingTimeResultDay,Q);if(0<d)return ha?String.format(WacWordeditorStrings.ReadingTimeResultComposite,
String.format(WacWordeditorStrings.ReadingTimeResultHour,d),String.format(WacWordeditorStrings.ReadingTimeResultMin,ha)):String.format(WacWordeditorStrings.ReadingTimeResultHour,d);n=Aa&&60>n&&!bb?WacWordeditorStrings.ReadingTimeResultMinWithoutAbbreviation:WacWordeditorStrings.ReadingTimeResultMin;return!ha&&0<B?WacWordeditorStrings.ReadingTimeLessThanOneMin:String.format(n,ha)}iQf(d,n,B,Q,ha,Aa=!1){const bb=this.Wcd(),Ib=this.jQf(d,n,B,Q,ha,bb);d=bb?this.jQf(d,n,B,Q,ha,!1):Ib;n=Aa?WacWordeditorStrings.ReadingTimeSelectionDialogBox:
WacWordeditorStrings.ReadingTimeSelectionStatusBar;Aa=Aa?d:WacWordeditorStrings.ReadingTimeStatusBar;Aa=bb?n:Aa;return bb?String.format(Aa,Ib,d):String.format(Aa,Ib)}iOm(d,n,B,Q){const ha=this.jQf(d,n,B,Q,"RTDT",this.Wcd(),!0);return this.Wcd()?String.format(WacWordeditorStrings.ReadingTimeSelectionDialogBoxTitle,ha):this.iQf(d,n,B,Q,"RTDT")}sRg(d,n,B){d=this.oxd(d,B);return d>n?(this.bgk||(this.bgk=!0,F.ULS.sendTraceTag(40916112,338,15,"Sel>Total for {0}",B)),n):d}oxd(d,n){0>d&&!this.agk&&(this.agk=
!0,F.ULS.sendTraceTag(40916113,338,15,"{0}<0",n));return Math.max(d,0)}Wcd(){return 0<this.r$.numWords+this.r$.fyb+this.r$.hyb}}Object(D.a)($F,"ReadingTimeStatsFacade",null,[]);class XB{}XB.swo="ReadingTimeButton";Object(D.a)(XB,"ReadingTimeConstants",null,[]);class Zu{constructor(d,n,B,Q,ha,Aa){this.eLc=this.x$b=!1;this.f0e=!0;this.INd="";this.pDe=(bb,Ib,oc)=>{if(1===oc)return this.qrc?32:8;bb=this.qe.rg("UserAction","Show Reading Time Dialog.");bb.start();Ib=this.Dzj();if(!Ib||0>Ib.P$.h1a)return 8;
this.X3.kEa&&F.ULS.sendTraceTag(40916104,338,50,"Open reading time dialog with total reading time of {0}.",Ib.P$.h1a);oc=new Sa.StandardDialog;oc.Md=0;oc.Rxa(Ib.rwo,String.format(Ib.pwo,Ib.qwo),null);bb.stop();return 32};this.GGe=(bb,Ib,oc)=>{if(1===oc)return this.kEa?32:8;this.qrc?this.H_l():this.s6l();yg.StaticActiveAppFrame.Aa().UH({ShowReadingTime:"CheckboxModel"});return 32};this.Ove=(bb,Ib,oc,Ac,ad)=>{if(1===oc)return this.kEa?32:8;ad[Gf.a.On]=this.qrc;return 32};this.Nve=(bb,Ib,oc,Ac,ad)=>
{if(1===oc)return 32;ad[Qk.a.Visible]=this.INd!==WacWordeditorStrings.ReadingTimeHidden;ad[Qk.a.LabelText]=this.INd;return 32};this.V8n=()=>{this.Dwd()};this.Osj=()=>{this.Dwd()};this.X3=d;this.hSc=n;this.ARe=Q;this.BRe=B;this.hLb=ha;this.qe=Aa;this.X3.L8k(this.V8n);this.hSc.kEa&&this.hSc.nVh(this.Osj);this.X3.nVh(this.Osj);this.Dwd()}get Syf(){return!Af.a.x9}mc(){const d=G.AFrameworkApplication.va;d.qa(dd.a.pDe,ed.a.view,this.pDe);d.nb(dd.a.Nve,ed.a.application,this.Nve,96);d.qa(dd.a.GGe,ed.a.application,
this.GGe);d.nb(dd.a.Ove,ed.a.application,this.Ove,96)}s6l(){this.kEa&&(this.LWj(!0),this.RAe(!0),this.Dwd())}H_l(){this.LWj(!1);this.RAe(!1);this.Dwd()}get qrc(){this.x$b||(this.f0e=this.ARe("WACReadingTimeEnabled",this.Syf),this.x$b=!0);return this.f0e}LWj(d){this.f0e=d}get kEa(){return this.X3.kEa}get rJ(){return null!=this.r9g?this.r9g:this.r9g=(()=>this.hLb())()}Dzj(){const d=new $F;this.aek(d.P$,this.X3);this.hSc.kEa&&this.aek(d.r$,this.hSc);return d}aek(d,n){d.h1a=n.pCa.ZMg;d.cSp=n.pCa.wSg;
d.wan=n.pCa.pXf;d.Upp=n.pCa.JKg;d.numWords=n.vC;d.fyb=n.FPb;d.hyb=n.JPb}tjm(){this.X3.LIe();this.hSc.LIe();const d=this.Dzj();return this.qrc&&this.kEa?0>d.P$.h1a?WacWordeditorStrings.ReadingTimeCalculating:d.two:WacWordeditorStrings.ReadingTimeHidden}Dwd(){Zu.Om.Ae(()=>{this.gap(this.X3)&&(F.ULS.sendTraceTag(40916106,338,50,"Reading time document stats: {0}",{["totalReadingTime"]:this.X3.pCa?this.X3.pCa.ZMg:-1,["wordReadingTime"]:this.X3.pCa?this.X3.pCa.wSg:-1,["imageReadingTime"]:this.X3.pCa?this.X3.pCa.pXf:
-1,["tableReadingTime"]:this.X3.pCa?this.X3.pCa.JKg:-1,["words"]:this.X3.vC,["images"]:this.X3.FPb,["tables"]:this.X3.JPb}),this.eLc=!0);const d=this.tjm();this.rJ&&d!==this.INd&&(this.INd=d,this.rJ.OW(XB.swo))},"RIA:URTD")}RAe(d){this.BRe("WACReadingTimeEnabled",d?"true":"false",Wl.a.U_a)}gap(d){return!this.eLc&&-1!==d.FPb&&-1!==d.vC&&-1!==d.JPb}static get Om(){return fM.a.instance}}Object(D.a)(Zu,"ReadingTimeActor",null,[]);class GI{constructor(){this.LCID=1033;this.Cea=this.xN=-1;this.ADb=new ma.a;
this.ldb=new ma.a}}Object(D.a)(GI,"ReadingTimeInput",null,[]);class PD extends Sys.EventArgs{constructor(d){super();this.isEnabled=d}}Object(D.a)(PD,"ReadingTimeAvailabilityChangedEventArg",Sys.EventArgs,[]);class HI extends Sys.EventArgs{constructor(d){super();this.state=d}}Object(D.a)(HI,"ReadingTimeChangedEventArg",Sys.EventArgs,[]);class II{constructor(d,n,B,Q,ha,Aa){this.HNd=null;this.mFb=new Av;this.QM=null;this.iEd=!1;this.sa=new dc.a;this.Mvc=()=>{this.kEa?this.bD():this.Mea();this.LIe();
this.Puo(this.kEa)};this.Fia=()=>{this.LIe();this.Quo(this.mFb)};this.MM=d;this.pb=n;try{this.HNd=B.create(1)}catch(bb){this.HNd=null,F.ULS.sendTraceTag(40916107,338,15,"Error when retrieving the reading time algorithm: [message: {0}] [callstack: {1}].",bb.message,bb.stack)}this.A5a=Aa.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.uSk=Aa.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.mQh=ha;Q.execute(bb=>{this.QM=bb.getInstance(this.mQh);this.Mvc(this,null)})}bD(){this.iEd||
(this.QM.Qjf(this.Mvc),this.QM.Dob(this.Fia),this.iEd=!0)}Mea(){this.iEd&&(this.QM.BJo(this.Mvc),this.QM.Txe(this.Fia),this.iEd=!1)}gEm(){return this.MM.KMa(this.pb.hh)}LIe(){if(this.kEa){var d=new GI;d.xN=this.FPb;d.Cea=this.JPb;d.LCID=this.gEm();d.ADb=this.dTl;d.ldb=this.$xf;try{if(this.mFb=this.HNd.hQf(d),void 0===this.mFb||null===this.mFb)this.mFb=new Av}catch(n){this.mFb=new Av,F.ULS.sendTraceTag(40916108,338,15,"Error when retrieving reading time: [message: {0}] [callstack: {1}].",n.message,
n.stack)}}}Quo(d){this.sa.raiseEvent("rttek",new HI(d))}Puo(d){this.sa.raiseEvent("rtac",new PD(d))}nVh(d){this.sa.addHandler("rttek",d)}L8k(d){this.sa.addHandler("rtac",d)}get pCa(){return this.mFb}get vC(){return this.QM?this.QM.vC:-1}get $xf(){return this.QM?this.QM.$xf:null}get dTl(){return this.QM?this.QM.eTl:null}get FPb(){return this.QM?this.QM.FPb:-1}get JPb(){return this.QM?this.QM.JPb:-1}get kEa(){return!!this.HNd&&this.k_a&&!(1===this.mQh&&!this.uSk)}get k_a(){return this.A5a&&!!this.QM&&
this.QM.k_a}}Object(D.a)(II,"ReadingTimeManager",null,[839]);class aG{constructor(){this.H8e=this.Z=null;this.j_=()=>{this.xea()}}get name(){return"WordEditor.ReadingTime"}init(){if(this.qrc()){const d=yg.StaticActiveAppFrame.Aa().tb;d.uva?(d.z1a(this.j_),this.xea()):d.gga(this.j_);F.ULS.sendTraceTag(40916109,338,50,"Reading time package initialized.")}}qrc(){return G.AFrameworkApplication.J.$("ReadingTimeIsEnabled")&&G.AFrameworkApplication.J.$("EnableTimeToReadAsPremiumFeature")}dispose(){}Ec(d){this.Z=
d;this.Z.ja("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory",()=>new ZF).ha();this.Z.ja("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory",()=>new FI(this.Z.resolve("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory"))).ha();this.Z.ja("WordEditor.ReadingTime.IReadingTimeManager",()=>new II(Wa.a.instance.resolve("Box4.ILanguageReader"),te.a.instance,this.Z.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.Z.Za("WordEditor.WordCount.IWordCountManagerFactory"),0,Wa.a.instance.resolve("Common.IAppSettingsManager"))).ha()}xea(){Nf.a.wf?
this.H8e?F.ULS.sendTraceTag(40916111,306,15,"ReadingTimeActor is alreadyd initialized. Skipping feature bootstrapping."):(this.H8e=new Zu(Wa.a.instance.resolve("WordEditor.ReadingTime.IReadingTimeManager"),new II(Wa.a.instance.resolve("Box4.ILanguageReader"),te.a.instance,this.Z.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.Z.Za("WordEditor.WordCount.IWordCountManagerFactory"),1,Wa.a.instance.resolve("Common.IAppSettingsManager")),Wl.a.p2a,Wl.a.ZCa,()=>Wa.a.instance.Wa("WordEditor.IStatusBarUser"),
Wa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")),this.H8e.mc()):F.ULS.sendTraceTag(40916110,306,15,"TheNotebookManager is null. Reading Time will not be available.")}static main(){U.a.instance.Rc(new aG)}}Object(D.a)(aG,"ReadingTimePackage",null,[0,1]);class QD{constructor(){this.hp=null}hKa(d,n){this.hp||(this.hp={});this.hp[n]||(this.hp[n]=0);this.hp[n]+=d}getData(){return this.hp}reset(){this.hp=null}}Object(D.a)(QD,"MultiSumDataAggregator",null,[873]);class $K extends Sys.EventArgs{constructor(){super();
this.wE=null}}Object(D.a)($K,"DocumentSignalReadyEventArgs",Sys.EventArgs,[]);class RD extends Sys.EventArgs{constructor(){super()}}Object(D.a)(RD,"SignalAddedToBatchWindowEventArgs",Sys.EventArgs,[]);var pA;(function(d){d[d.psq=0]="rest";d[d.add=1]="add";d[d.trb=2]="edit";d[d.document=3]="document";d[d.x6p=4]="editorAccept"})(pA||(pA={}));Object(D.b)("SignalCategory",pA);class Dt extends Sys.EventArgs{constructor(){super();this.g$c=this.NR=0}}Object(D.a)(Dt,"SignalReadyEventArgs",Sys.EventArgs,[]);
class Bv{constructor(){this.startTime=null;this.NR=this.lCf=0;this.values=null;this.g$c=0}get endTime(){return this.startTime.getTime()+this.lCf}}Object(D.a)(Bv,"SignalSummary",null,[]);class JI{constructor(d,n,B,Q,ha=null){this.Hdf=null;this.Njb=0;this.$Hb=this.lIc=null;this.sa=new dc.a;this.Mvl=()=>{const Aa=this.TG(),bb=this.tMf(this.$Hb,Aa);bb>this.$Oe&&(this.Njb&&this.RMi(0,Aa,bb),this.$Hb=Aa)};this.Sb=d;this.$Oe=n;this.Ruk=B;this.kPk=Q;this.KGh={};this.GTe={};this.zPd=new Eg.a;this.DAd=new QD;
this.IOe=new ma.a;this.OFd=!1;ha||(ha=()=>new Date);this.TG=ha}Gzb(d){3===d.NR&&1!==d.kBa?F.ULS.sendTraceTag(590401570,389,10,"Signal Aggregator: Signals at the document level should be of aggregation type Last. SignalId{0}",d.wE):(F.ULS.sendTraceTag(590401571,389,50,"Signal Aggregator: Registered a signal type: SignalId: {0}, SignalCategory: {1}, SignalDescription: {2}, AggregationType: {3}",d.wE,d.NR,d.Tgb,d.kBa),this.KGh[d.wE]=d)}init(d=null){d||(d=this.TG());this.Njb=0;this.$Hb=this.lIc=d;this.OFd=
!0}TLi(){if(!this.OFd)return F.ULS.sendTraceTag(590401601,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),null;const d=new ma.a;d.add(Object.assign(new Bv,{NR:3,values:this.GTe}));for(const n of this.zPd){const B=Object.assign(new Bv,{NR:n.key,values:n.value.getData()});d.add(B)}return d}qCi(){return this.OFd?Object.assign(new Bv,{NR:3,values:this.GTe}):(F.ULS.sendTraceTag(574419076,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),
null)}track(d){if(this.OFd){var n=this.KGh[d.wE];if(!n)F.ULS.sendTraceTag(590401603,389,10,"Signal Aggregator: Recieved a signal that was never registered: {0}",d.wE);else if(1===n.kBa)this.GTe[d.wE]=d.value,this.sa.raiseEvent("DocumentSignalReadyEventKey",Object.assign(new $K,{wE:d.wE}));else if(!n.kBa){this.T4k(d,n.NR);const B=this.tMf(this.$Hb,d.timestamp);(n.NR!==this.Njb||B>this.$Oe)&&this.RMi(n.NR,d.timestamp,B);this.$Hb=d.timestamp;this.DAd.hKa(d.value,d.wE);this.r8l()}}else F.ULS.sendTraceTag(590401602,
389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first.")}T4k(d,n){this.zPd.Bb(n)||this.zPd.W(n,new QD);this.zPd.K(n).hKa(d.value,d.wE)}tMf(d,n){return+n-+d}r8l(){this.Hdf||(this.Hdf=new tb.a(4,2,this.kPk,this.Mvl,193),this.Sb.pc(this.Hdf))}RMi(d,n,B){B>this.$Oe&&d&&(this.OZd(0,n),this.DAd.reset(),this.lIc=this.$Hb,this.Njb=0);B=Object.assign(new Dt,{NR:this.Njb,g$c:d});this.MAl(d,n);this.DAd.reset();this.lIc=n;this.Njb=d;this.sa.raiseEvent("SignalReadyEventKey",B)}OZd(d,
n){this.Njb&&(n=this.$Hb);d=Object.assign(new Bv,{NR:this.Njb,values:this.DAd.getData(),startTime:this.lIc,lCf:this.tMf(this.lIc,n),g$c:d});this.IOe.add(d);n=new RD(d);this.sa.raiseEvent("SignalAddedToBatchWindowEventKey",n);F.ULS.sendTraceTag(590401605,389,50,"New Signal Bucket Added. SignalCategory: {0}, Values: {1}, StartTime: {2}, Duration (ms): {3}, IncomingCategory: {4}",pA[d.NR],d.values,d.startTime,d.lCf,pA[d.g$c]);return d.endTime}MAl(d,n){for(d=this.OZd(d,n)-this.Ruk;this.IOe.K(0).endTime<
d;)this.IOe.removeAt(0)}gVh(d){this.sa.addHandler("SignalReadyEventKey",d)}eJo(d){this.sa.removeHandler("SignalReadyEventKey",d)}TUh(d){this.sa.addHandler("DocumentSignalReadyEventKey",d)}xwg(d){this.sa.removeHandler("DocumentSignalReadyEventKey",d)}}Object(D.a)(JI,"SignalAggregator",null,[993]);var Zl=e(480),bG=e(222),qA=e(1753);class bs{constructor(d,n=1){this.wE=d;this.timestamp=new Date;this.value=n}}Object(D.a)(bs,"SignalEntry",null,[]);class YB{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd){this.KJk=
Ib;this.suk=oc;this.P0=Ac;this.eil=ad;this.hJa=sd;this.oe=wd;this.oS=new Uj.a;this.Ynh=0;this.qK=()=>{const yd=new bs(Pn.O5h);this.M7.track(yd)};this.ZOa=()=>{const yd=new bs(Pn.Ywj);this.M7.track(yd)};this.Hid=()=>{const yd=new bs(Pn.exj);this.M7.track(yd)};this.Fia=(yd,be)=>{yd=new bs(Pn.wordCount,be.state.wordCount);this.M7.track(yd);yd=new bs(Pn.KW,be.state.KW);this.M7.track(yd)};this.O1n=(yd,be)=>{be.action==Zl.b.Apply&&(yd=new bs(this.Hhj(be.category),1),this.M7.track(yd))};this.I6n=(yd,be)=>
{be.action==qA.a.wsc&&(yd=new bs(this.Hhj(be.category),1),this.M7.track(yd))};this.oao=()=>{const yd=new bs("E_TextPrediction",1);this.M7.track(yd)};this.Moj=()=>{const yd=new bs("E_AutoCorrect",1);this.M7.track(yd)};this.M7=d;this.yn=n;this.Uv=B;this.Ys=Q;this.ga=ha;this.ff=Aa;this.za=bb;this.bD()}async bD(){var d;const n=this.yn.Hf(12);n.wv(this.ZOa);n.bA(this.Hid);this.Uv.Dob(this.Fia);this.Ys.addHandler(bG.a.KHe,this.qK);this.oe.F1f()&&(this.$cn(),this.ga.WZ(this));this.za.$("SignalAggregatorCritiqueCountIsEnabled")&&
gg.a.Km().then(()=>{this.ff.Cb(this,mw.a.getTypeName())});await (null===(d=this.hJa)||void 0===d?void 0:d.z3f())&&(this.suk.execute(B=>B.T6k(this.O1n)),this.KJk.execute(B=>B.B7k(this.I6n)),xu.a.y8k(this.oao),this.P0.kjf(this.Moj),this.eil.kjf(this.Moj))}H5(){}F5(d){2===d.behavior&&this.oS.contains(d.actionId)&&(this.Ynh++,d=new bs(Pn.p7d,this.Ynh),this.M7.track(d))}XI(d){d&&d.content&&d.annotationType===mw.a.getTypeName()&&(d=d.content,d=new bs(d.categoryName,d.count),this.M7.track(d))}Hhj(d){switch(d){case "Spelling":case "Grammar":return"E_Spelling_Grammar";
case "Similarity":return"E_Similarity";default:return"E_Refinements"}}$cn(){this.oS.add(Se.a.font);this.oS.add(Se.a.tE);this.oS.add(Se.a.V4);this.oS.add(Se.a.m6);this.oS.add(Se.a.dG);this.oS.add(Se.a.bold);this.oS.add(Se.a.cC);this.oS.add(Se.a.underline);this.oS.add(Se.a.strikethrough);this.oS.add(Se.a.subscript);this.oS.add(Se.a.superscript);this.oS.add(Se.a.i9a);this.oS.add(Se.a.DKa);this.oS.add(Se.a.EKa);this.oS.add(Se.a.EBa);this.oS.add(Se.a.j9a);this.oS.add(Se.a.O2);this.oS.add(Se.a.hea);this.oS.add(Se.a.Uy);
this.oS.add(Se.a.Ixa);this.oS.add(Se.a.FQ)}}Object(D.a)(YB,"SignalAggregatorEventCoordinator",null,[113,992]);class Zt{constructor(){this.wE=null;this.NR=0;this.Tgb=null;this.kBa=0}}Object(D.a)(Zt,"SignalDef",null,[]);class SD{constructor(){this.Z=null}get name(){return"WordEditor.SignalAggregator"}Ec(d){this.Z=d;d=this.Z.resolve("Common.IAppSettingsManager");const n=d.sc("SignalAggregatorBucketThresholdMilliseconds",1E4),B=d.sc("SignalAggregatorBatchWindowMilliseconds",12E4),Q=d.sc("SignalAggregatorPollingIntervalMilliseconds",
6E3);this.Z.ja("WordEditor.SignalAggregator.SignalAggregator",()=>new JI(G.AFrameworkApplication.zc,n,B,Q)).as("WordEditor.SignalAggregator.ISignalAggregator").ha()}init(){if(Nf.a.wf){var d=Nf.a.wf.Um;if(d){var n=this.Z.resolve("WordEditor.SignalAggregator.SignalAggregator");this.eEo(n);n.init();var B=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0);new YB(n,d,B,this.Z.resolve("Box4.EditStateEventManager"),G.AFrameworkApplication.va,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
G.AFrameworkApplication.J,this.Z.Za("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.Z.Za("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.Z.resolve("Box4.IAutoCorrectScheduler"),this.Z.resolve("Box4.AutocorrectActionExecutor"),this.Z.Wa("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.Z.resolve("WordEditor.Designer.IDesignerControl"))}else F.ULS.sendTraceTag(590401569,306,15,"Graph is null. Signal Aggregator will not be available")}else F.ULS.sendTraceTag(590401568,
306,15,"TheNotebookManager is null. Signal Aggregator will not be available")}eEo(d){let n=Object.assign(new Zt,{wE:Pn.O5h,NR:2,Tgb:"The number of characters that have been typed",kBa:0});d.Gzb(n);n=Object.assign(new Zt,{wE:Pn.Ywj,NR:2,Tgb:"The number of paragraphs that have been added",kBa:0});d.Gzb(n);n=Object.assign(new Zt,{wE:Pn.exj,NR:2,Tgb:"The number of paragraphs that have been deleted",kBa:0});d.Gzb(n);n=Object.assign(new Zt,{wE:Pn.p7d,NR:3,Tgb:"The total count of font formatting changes that have been applied",
kBa:1});d.Gzb(n);n=Object.assign(new Zt,{wE:Pn.wordCount,NR:3,Tgb:"The latest word count of the document",kBa:1});d.Gzb(n);n=Object.assign(new Zt,{wE:Pn.KW,NR:3,Tgb:"The latest paragraph count of the document",kBa:1});d.Gzb(n);if(G.AFrameworkApplication.J.$("SignalAggregatorCritiqueCountIsEnabled"))for(var B=0;B<Pn.zxf.length;B++)n=Object.assign(new Zt,{wE:Pn.zxf[B],NR:3,Tgb:String.format("The latest {0} critique count of the document",Pn.zxf[B]),kBa:1}),d.Gzb(n);for(B=0;B<Pn.Pjc.length;B++)n=Object.assign(new Zt,
{wE:Pn.Pjc[B],NR:4,Tgb:String.format("Accepted {0} count",Pn.Pjc[B]),kBa:0}),d.Gzb(n)}dispose(){}static main(){U.a.instance.Rc(new SD)}}Object(D.a)(SD,"SignalAggregatorPackage",null,[0,1]);class KI{}Object(D.a)(KI,"ApplicationProperties",null,[]);class sw{}Object(D.a)(sw,"EnterpriseUserInfo",null,[]);class LI{}Object(D.a)(LI,"FeatureGates",null,[]);class gM{constructor(d,n,B=!0){this.JMg=9E5;this.LMg=3E5;this.Y$f=null;this.Egj="";this.W$f=0;this.Xqb=Date.now;this.vda=d;this.K_a=n;B&&this.ZJf()}xRm(){const d=
this.Xqb();if(d<this.W$f+this.JMg)return d>this.W$f+this.LMg&&this.ZJf(),this.Egj;this.ZJf();return""}ZJf(){this.Y$f=this.Y$f||new Promise(d=>{this.yRm().then(n=>{this.Egj=n;this.W$f=this.Xqb();this.Y$f=null;d(n)})})}yRm(){return this.K_a&&this.K_a.length?new Promise(d=>{this.vda.kX("SmartLookup",this.K_a).then(n=>{n.IsSuccess?n.Token||(d(""),F.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(F.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
n.ErrorCode+": "+n.ErrorMessage),d(""));d(n.Token)}).catch(n=>{n=Rb.c(n);F.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+n);d("")})}):(F.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(D.a)(gM,"SmartLookupAuthenticationManager",null,[1977]);class ZB{static ORm(){switch(G.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":G.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")?
"PROD":G.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")?"INT":ZB.HCi()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static HCi(){switch(Object(Uf.a)(String,G.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(G.AFrameworkApplication.J){let d=G.AFrameworkApplication.J.rb("UserPrincipalName");d=Ca.a.Ph(d);const n=G.AFrameworkApplication.J.RA("SmartLookupINTEnabledForSKITeam")?G.AFrameworkApplication.J.kF("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(n,d)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static eRm(){switch(G.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":G.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")?"PROD":G.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")?"INT":ZB.HCi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(D.a)(ZB,"Utils",null,[]);class iz{constructor(d){F.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.txb=G.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");this.cPn=G.AFrameworkApplication.J.rb("SmartLookupApprovedOriginPattern");this.K_a=G.AFrameworkApplication.J.rb("SmartLookupShredderServiceEndpoint");this.pag=T.a.dW(G.AFrameworkApplication.J.rb("AppCatalogUrl")||"");
this.Ij=new LI;this.Ij.EnableAllTabV2=!0;this.Ij.EnableIntentService=!0;this.Ij.EnableInDocumentSearch=G.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch");this.Ij.EnableLocalSearch=G.AFrameworkApplication.J.$("SmartLookupEnableLocalSearch");this.Ij.IntentServiceEndpoint=ZB.eRm();this.vPn=new gM(d,this.K_a)}get approvedOriginPattern(){return this.cPn}zom(){const d=new KI;d.anid="";d.applicationVersion=G.AFrameworkApplication.buildVersion;d.appCorrelationId=Ze.a.create().toString();d.themePlatform=
iz.rNp;d.lcid=G.AFrameworkApplication.lcid;d.launchUtcTime=(new Date).toUTCString();d.featureGates=this.Ij;var n=rf.a.Vg(G.AFrameworkApplication.lcid);n=n?n.name:null;d.market=this.uBi(n);d.uiLanguage=n;d.sessionId=G.AFrameworkApplication.userSessionId;d.themeId=0;d.parentalControl=iz.lng;const B=new sw;B.CountryCode=this.uBi(n);B.ServiceEndpoint=this.K_a;B.IsGoLocal=!1;B.IsEnabled=this.txb;B.IsEnterpriseEnabled=this.txb;B.TenantRoot=this.pag;d.enterpriseUserInfo=B;d.accessToken=this.vPn.xRm();return d}uBi(d){d=
d.split("-");return d[d.length-1]}}iz.rNp="web";iz.lng="yes";Object(D.a)(iz,"SmartLookupManager",null,[1942]);class cG{constructor(){this.Z=null}get name(){return"Common.App.SmartLookup"}Ec(d){this.Z=d;F.ULS.sendTraceTag(41521356,1313,50,"SmartLookupPackage - Initialize");this.Z.register(1942,"Common.App.SmartLookup.ISmartLookupManager").ha().fe(()=>new iz(this.Z.resolve("Common.App.OAuth.IOAuthManager")))}dispose(){}}Object(D.a)(cG,"SmartLookupPackage",null,[0,1]);class jz{}Object(D.a)(jz,"Selection",
null,[]);class dG{}Object(D.a)(dG,"ConfigurationProvider",null,[]);var UM=e(306);class kz{static qzc(d){const n=new UM.a;n.name="Office.Insights.SmartLookup.LaunchPane";n.samplingPolicy=2;const B=[];(d=zf.a.Fca("AppCorrelationId",d,2))&&Array.add(B,d);n.dataFields=B;cg.a.sendActivityEvent(n)}}Object(D.a)(kz,"LoggingUtils",null,[]);var eG=e(1716),Cv=e(1878);class Et{constructor(d,n,B,Q,ha,Aa){this.l9c=(bb,Ib,oc)=>{if(2!==oc)return 32;this.fWb()&&this.Ai.yOb(Et.appId);return 32};this.WAc=(bb,Ib,oc)=>
{if(2!==oc)return 32;bb=(new Cv.a).getSelectedText();bb=Object.assign(new jz,{neighborhood:bb.neighborhood,mentionStart:bb.mentionStart,mentionLength:bb.mentionLength});this.K1b=Object.assign(new eG.a,{selection:bb,entryPoint:0});return this.oed()};this.FNa=(bb,Ib,oc)=>{if(2!==oc)return 32;bb=(new Cv.a).getSelectedText();bb=Object.assign(new jz,{neighborhood:bb.neighborhood,mentionStart:bb.mentionStart,mentionLength:bb.mentionLength});this.K1b=Object.assign(new eG.a,{selection:bb,entryPoint:10});
return this.oed()};this.Uca=(bb,Ib,oc,Ac,ad)=>{if(1===oc)return bn.SessionStatusManager.instance.zk?8:32;bb=ad.CommandValueId;try{this.K1b=Rb.a(bb)}catch(sd){return F.ULS.sendTraceTag(41521359,1313,15,"SmartLookup application interface [{0}] is not in proper format",bb),8}return this.oed()};this.Wsd=(bb,Ib,oc,Ac,ad)=>{if(1===oc)return 32;try{this.K1b=ad}catch(sd){return F.ULS.sendTraceTag(41694411,1313,15,sd.message),8}return this.oed()};this.Vsd=(bb,Ib,oc,Ac,ad)=>{if(1===oc)return 32;if(!ad)return 8;
bb=ad.query?ad.query:"";bb=Object.assign(new jz,{neighborhood:bb,mentionStart:0,mentionLength:bb.length});this.K1b=Object.assign(new eG.a,{selection:bb,entryPoint:0});return this.oed()};this.ga=d;this.Ai=n;this.phj=B;this.K1b=null;this.Jfd=new Xc.a;this.sourceLocationOverrideResourceId=ZB.ORm();this.Jfd.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;this.Jfd.AU=CommonUIStrings.L_SmartLookupPaneTitle;this.Jfd.taskPaneWidth=400;this.ngj=ha;this.isFirstLaunch=!0;d=Object.assign(new dG,
{channelId:"SmartLookup",approvedOriginPattern:this.phj.approvedOriginPattern});this.nUi=SmartLookupHostRuntime.setup(d,[Aa])}SDo(){F.ULS.sendTraceTag(41521357,1303,50,"Registering SmartLookup ribbon button.");this.ga.qa(dd.a.WAc,S.a.frame,this.WAc);this.ga.qa(dd.a.l9c,S.a.frame,this.l9c);this.ga.qa(Z.a.Uca,S.a.frame,this.Uca);this.ga.qa(Z.a.FNa,S.a.frame,this.FNa);this.ga.qa(Z.a.Wsd,S.a.frame,this.Wsd);this.ga.qa(Z.a.Vsd,S.a.frame,this.Vsd);this.PHo()}PHo(){this.ga.Y5("mso_smartLookup",!0,dd.a.WAc,
S.a.frame,this.WAc,d=>{yg.StaticActiveAppFrame.Aa().W4b(d,Object(X.a)(this.ngj,this.ngj.etb,"getCommandById"))});this.ga.Y5("mso_smartLookup",!0,dd.a.l9c,S.a.frame,this.l9c,()=>{});this.ga.Y5("mso_smartLookup",!0,Z.a.Uca,S.a.frame,this.Uca,()=>{});this.ga.Y5("mso_smartLookup",!0,Z.a.FNa,S.a.frame,this.FNa,()=>{});this.ga.Y5("mso_smartLookup",!0,Z.a.Wsd,S.a.frame,this.Wsd,()=>{});this.ga.Y5("mso_smartLookup",!0,Z.a.Vsd,S.a.frame,this.Vsd,()=>{})}SAc(){if(!this.fWb()){const n=this.phj.zom();var d={};
n.applicationName=Et.Klo;n.isFirstLaunch=this.isFirstLaunch;n.themeId=5;d[Et.Whp]=this.K1b;d[Et.Xbl]=n;this.Jfd.DW=d;d=G.AFrameworkApplication.J.$("SmartLookupSdxFlowIsEnabled");this.Ai.l6(Et.appId,this.Jfd,d);this.isFirstLaunch=!1;kz.qzc(n.appCorrelationId)}this.nUi.onPaneStateChanged(!0)}fWb(){return this.Ai.g5(Et.appId+"."+this.sourceLocationOverrideResourceId)}oed(){this.fWb()?this.nUi.search(this.K1b):this.SAc();return 32}}Et.Xbl="AppProperties";Et.Klo="Word";Et.Whp="SmartLookupApplicationInterface";
Et.appId="FA000000006";Object(D.a)(Et,"SmartLookupAddIn",null,[991]);class Ir{getId(){return"SerpletExecutor"}}Ir.DTi="FA000000012";Ir.queryPrefix="AssetID=";Object(D.a)(Ir,"BaseSerpletExecutor",null,[875,876]);class Wx extends Ir{constructor(d){super();this.Y3=d}openHelpTaskPane(d){const n={};n.query=Ir.queryPrefix+d;d=new Xc.a;d.DW=n;this.Y3.l6(Ir.DTi,d)}}Object(D.a)(Wx,"WordSerpletExecutor",Ir,[]);class rA extends cG{constructor(){super();this.pSa=null}get name(){return"WordEditor.SmartLookup"}init(){rA.isFeatureEnabled()&&
this.xea()}Ec(d){super.Ec(d);this.pSa=d;rA.isFeatureEnabled()&&(this.pSa.ja("WordEditor.SmartLookup.WordSerpletExecutor",()=>new Wx(this.pSa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"))).as("Common.App.SmartLookup.ISerpletExecutor").ha(),this.pSa.ja("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn",()=>new Et(G.AFrameworkApplication.va,this.pSa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.pSa.resolve("Common.App.SmartLookup.ISmartLookupManager"),
this.pSa.resolve("Common.IAppSettingsManager"),this.pSa.resolve("Common.IExternalUICommandDefinitionMapping"),this.pSa.resolve("Common.App.SmartLookup.ISerpletExecutor"),yg.StaticActiveAppFrame.Aa().qhb)).ha())}xea(){F.ULS.sendTraceTag(41497102,1303,50,"SmartLookup package initialized.");this.pSa.resolve("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn").SDo()}static main(){rA.isFeatureEnabled()&&U.a.instance.Rc(new rA)}static isFeatureEnabled(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")}}
Object(D.a)(rA,"WordEditorSmartLookupPackage",cG,[]);class Xx{constructor(d,n,B,Q,ha,Aa){this.vHa=!1;this.bDe=(bb,Ib,oc)=>2!==oc?32:this.UTc&&this.T7a?this.T7a.fWb?this.UTc.c7m(oc):this.UTc.kgp(oc):16;this.zxc=(bb,Ib,oc,Ac,ad)=>this.UTc?this.UTc.zxc(bb,Ib,oc,Ac,ad):16;this.ga=d;this.UTc=n;this.pKb=B;this.T7a=Q;this.Rdc=ha;this.aHk=Aa}register(d=!1){if(this.vHa)F.ULS.sendTraceTag(51667738,3011,15,"Attempted to register Transcription add-in commands more than once.");else{this.vHa=!0;F.ULS.sendTraceTag(51667739,
3011,50,"Registering Transcription add-in commands.");this.Rdc&&(this.aHk?this.Rdc.igp():this.Rdc.jgp());var n={},B=new ma.a;n.Transcription="ButtonModel";B.add("btnWordTranscription");this.ga&&(this.ga.qa(dd.a.bDe,S.a.frame,this.bDe),this.ga.nb(dd.a.zxc,ed.a.view,this.zxc,96));d&&this.pKb&&this.pKb.rRa(n)}}}Object(D.a)(Xx,"TranscriptionAddInCommands",null,[984]);class Ep{constructor(d,n){this.ZJb=d;this.Hx=n}cHm(d,n){Object(bk.a)(2,()=>this.Hx.$ab(),!0,()=>!0).then(B=>{d[Ep.yne]=B;n(d)}).catch(B=>
{F.ULS.sendTraceTag(528859138,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",B)})}bHm(d,n){this.ZJb.$ab().then(B=>{d[Ep.yne]=B;n(d)})}f3k(d,n,B){Object(bk.a)(2,()=>this.Hx.nVc(d[Ep.Poe]),!1,()=>!0).then(()=>{Object(bk.a)(2,()=>this.Hx.$ab(),!0,()=>!0).then(Q=>{this.Hx.sRb();n[Ep.yne]=Q;B(n)}).catch(Q=>{F.ULS.sendTraceTag(528859139,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",Q)})}).catch(Q=>{F.ULS.sendTraceTag(528859140,3011,
10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",Q)})}e3k(d,n,B){this.ZJb.nVc(d[Ep.Poe]).then(()=>{this.ZJb.$ab().then(Q=>{this.ZJb.sRb();n[Ep.yne]=Q;B(n)})})}m3m(d,n){return new Promise((B,Q)=>{const ha={};switch(d){case Ep.aHm:Object(bk.b)()?this.cHm(ha,B):this.bHm(ha,B);break;case Ep.d3k:if(void 0===n[Ep.Poe]||null===n[Ep.Poe]){Q(Ep.eZi);break}Object(bk.b)()?this.f3k(n,ha,B):this.e3k(n,ha,B);break;case Ep.wIp:if(void 0===n[Ep.nLg]||null===n[Ep.nLg]){Q(Ep.eZi);break}B=
n[Ep.nLg];!isNaN(B)&&isFinite(B)&&Wl.a.set("TeachingUIShowCount",B.toString());break;default:Q(Ep.SBp)}})}}Ep.aHm="GetMonthlyMinutesUsed";Ep.yne="monthlyMinutesUsed";Ep.d3k="AddMinutesUsed";Ep.Poe="numMinutesUsed";Ep.wIp="UpdateTeachingUIShowCount";Ep.nLg="teachingUIShowCountNew";Ep.eZi="invalidArgs";Ep.SBp="unsupportedRequestType";Object(D.a)(Ep,"TranscriptionAddInRequestHandler",null,[983]);class MI{constructor(d,n,B){this.sessionId=d;this.locale=B;this.Ai=n;this.yHb=this.S4m=!1}get irc(){return this.yHb}set irc(d){this.yHb=
d}get fWb(){return this.Ai?this.Ai.g5(ng.fzc):!1}}Object(D.a)(MI,"TranscriptionAddInState",null,[]);class Ft{igp(){appChrome.showTranscribeAsSplitButton()}jgp(){appChrome.showTranscribeAsStandaloneGroup()}mWf(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShowHideTranscriptionPane",!0))}}Object(D.a)(Ft,"TranscriptionButtonEnabler",null,[982]);class NI{constructor(d){this.qRb=n=>{this.B_e=n.isEnabled};this.B_e=this.A$b=!1;this.initialized=d?new Promise((n,B)=>{d.execute(Q=>{this.A$b=
Q.isFreemiumUpsellEnabled();const ha=Q.isFeatureEnabled(Jy.a.Y7j,!1);Q.dxa(Jy.a.Y7j,this.qRb);this.jen(ha).then(()=>{n(!0)}).catch(Aa=>{F.ULS.sendTraceTag(555054277,3011,10,"Failed to initialize transcription licensed user using isFeatureEnabled "+Aa.toString());B("Failed to initialize transcription licensed user")})})}):Promise.resolve(!0)}get isFreemiumUpsellEnabled(){return this.A$b}get y2f(){return this.B_e}jen(d){return new Promise(n=>{d.then(B=>{this.B_e=B?!0:!1;n(!0)})})}}Object(D.a)(NI,"TranscriptionLicenseState",
null,[]);class sA{constructor(d){this.u$c=0;this.Hx=d}sRb(){return this.$ab().then(d=>{this.u$c=d}).catch(d=>{F.ULS.sendTraceTag(587310852,3011,10,"Failed to get initial monthly minutes used: "+d.toString())})}$ab(){return new Promise((d,n)=>{this.Hx?this.Hx.KTb(sA.zSf,0).continueWith(B=>{B.wj?n(B.Yk):d(parseInt(B.result))},8):d(0)})}nVc(d){return new Promise((n,B)=>{this.Hx?this.Hx.Mpa(sA.hAg,d.toString()).continueWith(Q=>{Q.wj?(F.ULS.sendTraceTag(540375233,3011,10,"SaveTranscriptionMinutes: TaskFaulted. ExceptionDetails:{0} Stack:{1}",
Q.Yk,Q.Yk.stack),B(Q.Yk)):n(null)},8):n(null)})}}sA.zSf="getTranscriptionQuota";sA.hAg="saveTranscriptionQuota";Object(D.a)(sA,"TranscriptionMonthlyQuotaManager",null,[]);class OI{constructor(){this.vef="";this.VTc="Office.Voice.Transcription."}iXo(d){this.vef=Ze.a.create().toString();d=[this.w1d(),this.rfi(!1)].concat(this.Vei(d));cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:this.VTc+"PaneOpened",dataFields:d}))}JWo(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:this.VTc+"PaneOpened",
dataFields:[this.w1d(),this.rfi(!0),this.WOl(d)]}))}jXo(d){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:this.VTc+"PaneOpened",dataFields:[this.w1d(),this.XOl(d)]}))}gXo(d){this.WXo(d)}pXo(d,n,B){cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:this.VTc+"Preinitialization",dataFields:[Object.assign(new Ja.a,{name:"DurationMs",int64:d}),Object.assign(new Ja.a,{name:"IsRibbonButtonDisabled",bool:n}),Object.assign(new Ja.a,{name:"DisabledReason",string:B})]}))}WXo(d){const n=this.Vei(d);n.push(this.VOl(d),
this.w1d());cg.a.sendTelemetryEvent(Object.assign(new $h.a,{name:this.VTc+"PaneClosed",dataFields:n}))}VOl(d){return Object.assign(new Ja.a,{name:"PaneOpenDurationInSecs",string:d.PaneOpenDurationInSecs})}w1d(){return Object.assign(new Ja.a,{name:"TranscriptionSessionId",string:this.vef})}rfi(d){return Object.assign(new Ja.a,{name:"PaneOpenedFinalEvent",bool:d})}XOl(d){return Object.assign(new Ja.a,{name:"PaneOpenSucceeded",bool:d})}WOl(d){return Object.assign(new Ja.a,{name:"IsLicensedUser",bool:d})}Vei(d){return[Object.assign(new Ja.a,
{name:"DeviceNetDownLinkInMbPerSec",double:d.DeviceNetDownLink}),Object.assign(new Ja.a,{name:"EffectiveNetworkType",string:d.EffectiveNetworkType}),Object.assign(new Ja.a,{name:"IsOnline",bool:d.IsOnline})]}}Object(D.a)(OI,"TranscriptionTelemetryHelper",null,[854]);var tA=e(1125);class PI{constructor(){this.fob=this.LLb=this.Rdc=this.RAa=this.K7a=this.EKd=this.Z=null;this.j_=()=>{yg.StaticActiveAppFrame.Aa().tb.z1a(this.j_);this.bAj()};this.Rdc=new Ft}get name(){return"WordEditor.Transcription"}init(){if(Nf.a.sdd()){const d=
yg.StaticActiveAppFrame.Aa().tb;d.uva?this.bAj():d.gga(this.j_);F.ULS.sendTraceTag(51667727,3011,50,"Transcription package initialized.")}}dispose(){}aLi(){const d=G.AFrameworkApplication.J.$("IsAnonymousUser"),n=G.AFrameworkApplication.J.$("IsRoamingServiceEnabled");return d||!n?null:this.Z.resolve("Box4.IRoamingServiceRequestManager")}Ec(d){this.Z=d;if(Nf.a.sdd()){const n=this.Z.resolve("Box4.ILanguageReader").KMa(this.Z.resolve("Box4.ISelectionManager").hh);this.Z.ja("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState",
()=>new MI(G.AFrameworkApplication.userSessionId,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),rf.a.Vg(n).O7d)).as("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState").ha();this.EKd=new sA(this.aLi());this.LLb=new tA.a(this.aLi());let B;B=new Ep(this.EKd,this.LLb);this.K7a=new OI;this.RAa=new NI(this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"));this.fob=d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager");this.Z.ja("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn",
()=>new ng(this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.Z.resolve("WordEditor.Extension.DocumentProperties"),this.K7a,G.AFrameworkApplication.J,this.EKd,B,this.RAa,this.LLb,this.fob)).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").ha();this.Z.ja("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands",()=>{var Q;return new Xx(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),
this.Z.resolve("Common.IRibbonButtonUpdater"),this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),null!==(Q=this.Rdc)&&void 0!==Q?Q:new Ft,Bf.a.n1i()&&Bf.a.o1i())}).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").ha();F.ULS.sendTraceTag(51667730,3011,50,"Transcription package configured.")}}bAj(){if(Nf.a.sdd()){var d=Date.now();this.Z0b(!0);var n=[];var B=Object(bk.b)()?this.LLb.sRb().then(()=>({name:"QuotaCheck",succeeded:!0})):this.EKd.sRb().then(()=>
({name:"QuotaCheck",succeeded:!0}));n.push(B);B=G.AFrameworkApplication.J.$("IsO365ConsumerHost");var Q=G.AFrameworkApplication.J.$("IsAnonymousUser");B&&!Q&&n.push(this.Wbm());Promise.all(n).then(ha=>{ha=ha.filter(bb=>!bb.succeeded).map(bb=>bb.name);const Aa=Date.now()-d;this.K7a.pXo(Aa,0<ha.length,ha.join(","));0===ha.length?this.xea():(new Ft).mWf();this.Z0b(!1)}).catch(ha=>{F.ULS.sendTraceTag(555055175,3011,10,"Failed to initialize transcription feature "+ha.toString());(new Ft).mWf();this.Z0b(!1)})}}async Wbm(){try{return await this.RAa.initialized,
{name:"UpsellLicenseCheck",succeeded:this.RAa.isFreemiumUpsellEnabled||this.RAa.y2f}}catch(d){return F.ULS.sendTraceTag(555054278,3011,10,"Failed to get/initialize transcription license state "+d.toString()),Promise.reject("Failed to get/initialize transcription license state")}}xea(){this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").load();this.Z.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").register()}Z0b(d){appChrome.api.setAsyncRequestStatus("transcribe",
d)}static main(){Nf.a.sdd()?(U.a.instance.Rc(new PI),F.ULS.sendTraceTag(51667728,3011,50,"Transcription package registered with PackageLifecycleManager.")):(F.ULS.sendTraceTag(51667729,3011,50,"Skip Transcription package registration, because the feature is disabled."),(new Ft).mWf())}}Object(D.a)(PI,"WordEditorTranscriptionPackage",null,[0,1]);class aL{constructor(d,n){this.text=n}}Object(D.a)(aL,"ListTransformationContent",null,[]);class Gt{constructor(d,n,B,Q,ha,Aa){this.ni=n;this.tI=B;this.Asa=
Q;this.ee=ha;this.Ww=Aa;this.hV=d}}Object(D.a)(Gt,"TableConstructor",null,[841]);class uA{constructor(){this.Z=null}get name(){return"WordEditor.Transformation"}Ec(d){this.Z=d;this.Z.ja("WordEditor.Transformation.ITableConstructor",()=>new Gt(this.Z.resolve("Box4.IOutlineEditor"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.ITableEditor"),this.Z.resolve("Box4.TableEditors.IWACTableStyleEditor"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("Box4.IParagraphEditor"))).ha()}init(){}dispose(){this.Z=
null}static main(){U.a.instance.Rc(new uA)}}Object(D.a)(uA,"TransformationPackage",null,[0,1]);class TD extends Tq.a{constructor(){super();this.language=null;this.percentage=this.characterCount=0;this.H_=Object.assign(new Vt.a,{T_:TD.getTypeName(),B_:TD.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(TD,"LanguageCountAnnotation",Tq.a,[]);const fG=(d,n)=>-1===d.indexOf("-")&&-1===n.indexOf("-")?
d===n:d.startsWith(n)||n.startsWith(d)?!0:!1;class bL{constructor(){this.jkb=new lm.a}S2k(d){void 0===d||null===d||void 0===d.language||null===d.language||void 0===d.percentage||null===d.percentage||void 0===d.characterCount||null===d.characterCount?F.ULS.sendTraceTag(42500685,399,10,"AddNewLanguage: Null or undefined languageCountAnnotation parameter."):this.jkb.W(d.language.toLowerCase(),d)}Qwm(){let d=0;for(let n=0;n<this.jkb.count;n++)d+=this.jkb.values.K(n).percentage;return d}Rwm(d){if(!d)return F.ULS.sendTraceTag(42500686,
399,10,"GetDocumentLanguageCompositionPercentageForKnownLanguages: Null or undefined knownLanguageTags parameter."),0;let n=0;for(const B of d)for(d=0;d<this.jkb.count;d++)if(fG(this.jkb.keys.K(d),B)){const Q=this.jkb.values.K(d);Q&&(n+=Q.percentage)}return n}nom(){let d=0;for(let n=0;n<this.jkb.count;n++)d+=this.jkb.values.K(n).characterCount;return d}}Object(D.a)(bL,"IntelligentSuggestionsDocumentLanguageComposition",null,[]);var cL=e(1877);class dL extends Sa.StandardDialog{constructor(){super()}ti(d,
n,B,Q,ha){if(void 0===d||null===d)return F.ULS.sendTraceTag(42500737,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined standardDialogHandler parameter."),!1;if(void 0===n||null===n)return F.ULS.sendTraceTag(42823903,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined reactDialogHandler parameter."),!1;if(void 0===B||null===B||!B.length)return F.ULS.sendTraceTag(42500738,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined fromLanguage parameter."),
!1;if(void 0===Q||null===Q||!Q.length)return F.ULS.sendTraceTag(42500739,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined toLanguage parameter."),!1;F.ULS.sendTraceTag(42500740,399,50,"TranslatorIntelligentSuggestionsReactDialog: Trying to display the translation suggestion dialog.");ha?(ha={["messageText"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage},ha.pathText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,ha.sentenceEndText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod,
d=new Ea.a(!1,!1,!0),d.Md=4,d.Ue(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,B)),d.Ue(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),B={["id"]:"TranslatorIntelligentSuggestionsDialog",["icon"]:{["iconName"]:"Translator_32",["ariaLabel"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText},["bodyControls"]:ha},d.ti(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,Q),n,B)):(this.Md=
4,this.Ue(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,B)),this.Ue(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),this.Gxb(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,Q),String.format("{0} {1}{2}",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod),
"Translator_32x32x32",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText,d,null));return!0}}Object(D.a)(dL,"TranslatorIntelligentSuggestionsReactDialog",Sa.StandardDialog,[]);var $B;(function(d){d[d.ok=0]="ok";d[d.Zlq=1]="neverFrom";d[d.cancel=2]="cancel"})($B||($B={}));Object(D.b)("UserAction",$B);class jq{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc,Ac,ad,sd,wd,yd,be,ye){this.eqh=!1;this.CSa=this.DJ=null;this.oPm=Qe=>{try{if(6===Qe.status){const af=Qe.result;af&&af.length?this.DJ=
Rb.b(af):F.ULS.sendTraceTag(42500693,399,15,"GetRoamingSettingsFrom: Roaming settings are null or empty which might mean that the user cannot access the Roaming Service due to the type of the account they have.")}else F.ULS.sendTraceTag(42500694,399,10,"GetRoamingSettingsFrom: Could not retrieve the Roaming Settings as the task run status is: {0}",Qe.status);this.DJ?this.Ili():(F.ULS.sendTraceTag(42783172,399,10,"RoamingSettings are null so quiting: {0}",{["ProcessingTime"]:this.v0.qj}),this.Rhb())}catch(af){F.ULS.sendTraceTag(42500695,
399,10,"GetRoamingSettingsFrom: Failed to deserialize the Roaming Settings. Exception: {0}. ProcessingTime: {1}",af,this.v0.qj),this.Rhb()}};this.ljn=Qe=>{this.LYi(Qe,null)};this.LYi=Qe=>{this.Ybf.stop();Qe=1===Qe?0:2===Qe?1:2;this.MYi(Qe,"DialogBox");F.ULS.sendTraceTag(42500705,399,50,"IntelligentSuggestionsHandleDialog: Pressed {0}",$B[Qe])};this.ff=d;this.nLc=B;this.mSd=n;this.ZNh=Q;this.v0=Aa.O_a("Task","TranslatorIntelligentSuggestionsAugLoop");this.Ybf=Aa.O_a("DialogShown","TranslatorIntelligentSuggestionsDialogBox");
this.Mg=ha;this.Ozh=bb;this.AKd=Ib;this.eLk=oc;this.pAh=Ac;this.fIk=ad;this.ITa=sd;this.XHk=yd;this.BIk=be;this.Pzh=ye;({value:this.CSa}=jq.o3a.Nc(wd.toLocaleLowerCase())).returnValue||(this.CSa=wd,-1!==this.CSa.lastIndexOf("-")&&(this.CSa=this.CSa.substring(0,this.CSa.lastIndexOf("-"))))}initialize(){var d=this.ZNh.SVm();if(!d)return F.ULS.sendTraceTag(42500687,399,10,"Initialize: Not able to get the roaming settings (check user type)."),null;d.continueWith(this.oPm,8);d=new tb.a(2,1,500,()=>{Vk.Avd.cNo()});
G.AFrameworkApplication.zc.pc(d);return gg.a.Km().then(()=>{this.ff.Cb(this,"AugLoop_Text_LanguageCountAnnotation");this.v0.start();F.ULS.sendTraceTag(42500688,399,50,"TranslatorAugLoopRuntimeManager: Registerd Handler for AL runtime manager at {0}.",Date.now())})}XI(d,n){try{if(n===Qj.a.getTypeName()){var B=d.content;void 0===B||null===B||void 0===B.language||null===B.language||void 0===B.percentage||null===B.percentage||void 0===B.characterCount||null===B.characterCount?F.ULS.sendTraceTag(42500689,
399,10,"HandleAnnotationEvent: Null or undefined languageCountAnnotation parameter."):(F.ULS.sendTraceTag(42500690,399,50,"HandleAnnotationEvent: Annotation received: {0}",B),B.language=B.language.toLocaleLowerCase(),B.percentage>this.nLc.percentage&&(this.nLc=B),fG(this.CSa,B.language)&&B.percentage>this.AKd?(F.ULS.sendTraceTag(42500691,399,50,"HandleAnnotationEvent: {0}.",{["MinKnownLangPer"]:this.AKd,["ActualUILangPer"]:B.percentage,["ProcessingTime"]:this.v0.qj}),this.Rhb()):(this.mSd.S2k(B),
this.Ili()))}}catch(Q){F.ULS.sendTraceTag(42500692,399,10,"HandleAnnotationEvent: Exception: {0}",Q)}}Ili(){if(this.agl()&&this.acp()){const B=this.fOf(this.nLc.language);if(B&&B.displayName&&B.displayName.length){var d=this.fOf(this.BOi());if(d&&d.displayName&&d.displayName.length)if(F.ULS.sendTraceTag(42783173,399,50,"DisplayIntelligentSuggestionsIfReady: Ready to show callout or dialog if flight is enabled. ProcessingTime:{0}",this.v0.qj),this.XHk&&this.BIk)this.v0.qj>this.Pzh?F.ULS.sendTraceTag(51512477,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the teaching callout as it took too long to process the document {0}",{["MaxWaitTime"]:this.Pzh,["ActualWaitTime"]:this.v0.qj}):this.lgp(B.displayName,d.displayName);else if(void 0!==this.Mg&&null!==this.Mg&&this.Mg.sbi)F.ULS.sendTraceTag(50644368,399,50,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog as the user has already started editing the document. ProcessingTime:{0}",this.v0.qj);else{if(this.fIk)if(this.v0.qj>this.Ozh)F.ULS.sendTraceTag(42823902,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog box as it took too long to process the document {0}",{["MaxWaitTime"]:this.Ozh,["ActualWaitTime"]:this.v0.qj});else{this.Ybf.start();var n=new dL;n.ti(this.ljn,this.LYi,B.displayName,d.displayName,this.ITa)||(this.Ybf.stop(),n.dispose())}}else F.ULS.sendTraceTag(42500697,399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for the language we want to translate to.")}else F.ULS.sendTraceTag(42500696,
399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for document main language.")}}agl(){return this.DJ?void 0===this.DJ.NeverShowCallout||null===this.DJ.NeverShowCallout||this.DJ.NeverShowCallout?(F.ULS.sendTraceTag(42500698,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as 'never show callout' setting is set to true. ProcessingTime:{0}",this.v0.qj),this.Rhb(),!1):this.eqh?(F.ULS.sendTraceTag(42500699,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as translation suggestion has already been attempted. ProcessingTime:{0}",
this.v0.qj),this.Rhb(),!1):"1"===T.a.LL(window.self.location.href,"translatorRedirect")?(F.ULS.sendTraceTag(42783174,399,50,"Translated document - pressed show Original: {0}",{["ProcessingTime"]:this.v0.qj}),this.Rhb(),!1):12E4<this.v0.qj?(F.ULS.sendTraceTag(42500700,399,15,"AreTranslationSuggestionsPrerequisitesSatisfied: Stopping from listening to annotations as it took too long to process the document {0}",{["MaxWaitTime"]:12E4,["ActualWaitTime"]:this.v0.qj}),this.Rhb(),!1):!0:!1}acp(){const d=
this.mSd.Qwm();F.ULS.sendTraceTag(42500701,399,50,"ShouldSuggestTranslation: DocProcessedPer {0}.",d);if(d>this.eLk){var n=this.unm();n=this.mSd.Rwm(n);const B=100*Math.trunc((this.mSd.nom()+50)/100);F.ULS.sendTraceTag(42500702,399,50,"ShouldSuggestTranslation: {0}.",{["MinKnownLangPer"]:this.AKd,["ActualKnownLangPer"]:n,["NoChars"]:B,["DocProcessedPer"]:d});if(n<this.AKd)return this.eqh=!0,F.ULS.sendTraceTag(42783175,399,50,"Known languages composition less than default bar, one final check pending: {0}",
{["ProcessingTime"]:this.v0.qj}),this.Rhb(),B<this.pAh?(F.ULS.sendTraceTag(42500703,399,15,"ShouldSuggestTranslation: The number of characters of the annotations are less than the minimum required: {0}",{["MinNoChars"]:this.pAh,["ActualNoChars"]:B}),!1):!0;F.ULS.sendTraceTag(42783176,399,50,"Known languages composition greater than default bar, : {0}",{["ProcessingTime"]:this.v0.qj});this.Rhb()}return!1}MYi(d,n){try{if(!d){const B=new tb.a(2,1,100,()=>{Vk.f8j(this.BOi())});G.AFrameworkApplication.zc.pc(B)}else if(1===
d){const B=this.fOf(this.nLc.language);if(B&&B.name&&B.name.length){let Q=B.name.toLocaleLowerCase();"no"===Q&&(Q="nb");this.ZNh.nPj(Q)}else F.ULS.sendTraceTag(42500704,399,10,"IntelligentSuggestionsUserAction: Could not retrieve/match language information from Translator for document main language.")}F.ULS.sendTraceTag(51512478,399,50,"IntelligentSuggestionsUserAction: UserSelected:{0}, SourcePrompt:{1}, Language:{2}",$B[d],n,this.nLc.language)}catch(B){F.ULS.sendTraceTag(51512479,399,10,"IntelligentSuggestionsUserAction: Exception: {0}",
B)}}Rhb(){this.ff.Gc(this,"AugLoop_Text_LanguageCountAnnotation");F.ULS.sendTraceTag(42500706,399,50,"UnregisterAugmentationLoopHandler: Unregisterd Handler for AL runtime manager at {0}",Date.now())}unm(){const d=new ma.a;if(void 0!==this.DJ.LanguageTagsExcluded&&null!==this.DJ.LanguageTagsExcluded)for(var n=0;n<this.DJ.LanguageTagsExcluded.length;n++)d.add(this.DJ.LanguageTagsExcluded[n].toLowerCase());d.contains(this.CSa)||d.add(this.CSa);void 0!==this.DJ.AlwaysTranslatePreference&&null!==this.DJ.AlwaysTranslatePreference&&
this.DJ.AlwaysTranslatePreference&&void 0!==this.DJ.DocumentTargetLanguage&&null!==this.DJ.DocumentTargetLanguage&&(n=this.DJ.DocumentTargetLanguage.toLocaleLowerCase(),jq.P_a.Bb(n)&&(n=jq.P_a.K(n)),d.contains(n)||d.add(n));return d}BOi(){if(void 0!==this.DJ.AlwaysTranslatePreference&&null!==this.DJ.AlwaysTranslatePreference&&this.DJ.AlwaysTranslatePreference&&void 0!==this.DJ.DocumentTargetLanguage&&null!==this.DJ.DocumentTargetLanguage){let d=this.DJ.DocumentTargetLanguage.toLocaleLowerCase();jq.P_a.Bb(d)&&
(d=jq.P_a.K(d));return d}return this.CSa}fOf(d){if(!d||!d.length)return F.ULS.sendTraceTag(42500707,399,10,"GetLanguageInfoFromTranslator: Provided null or empty parameter."),null;d=d.toLocaleLowerCase();const n=Vk.Avd.jEm();if(!n)return F.ULS.sendTraceTag(42500736,399,10,"GetLanguageInfoFromTranslator: Could not retrieve the language names from Ogma/BRS"),null;for(let B=0;B<n.length;B++){let Q=n[B].name.toLowerCase();jq.P_a.Bb(Q)&&(Q=jq.P_a.K(Q),n[B].name=Q);if(fG(Q,d))return n[B]}return null}lgp(d,
n){Vc.UISurfaces.tN().then(B=>{let Q=null;const ha=()=>{Q?B.removeNotification(Q):F.ULS.sendTraceTag(51512480,399,15,"ShowTranslatorTeachingCallout: Attempting to close callout but id is null.")};var Aa=this.DOi(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate,0,ha);const bb=this.DOi(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutSecondaryButton,d),1,ha);Aa=Object.assign(new se.a,{target:"button[data-unique-id=Review]",content:CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutMessage,
title:String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutTitle,n),primaryButtonProps:Aa,secondaryButtonProps:bb,useTeachingStyles:!0,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new Ub.a,{preventDismissOnScroll:!0,directionalHint:5,onDismiss:()=>{this.yqp(ha)}})});Aa=B.callout(Aa);Q=B.addNotification(Aa);return null}).catch(B=>{F.ULS.sendTraceTag(51512481,399,10,"ShowTranslatorTeachingCallout: Error while showing the teaching callout. ErrorMessage:{0}",
B);return!1});F.ULS.sendTraceTag(51512482,399,50,"ShowTranslatorTeachingCallout: Teaching Callout Shown. ProcessingTime:{0}",this.v0.qj)}DOi(d,n,B){return Object.assign(new cL.a,{label:d,onExecute:()=>{this.MYi(n,"TeachingCallout");B()}})}yqp(d){F.ULS.sendTraceTag(51512483,399,50,"TeachingCalloutDismiss: Action:{0}, ProcessingTime:{1}","CalloutClosed",this.v0.qj);d()}static NG(){jq.P_a=new lm.a;jq.P_a.add("zh-cht","zh-hant");jq.P_a.add("zh-chs","zh-hans");jq.P_a.add("nb","no");jq.o3a=new lm.a;jq.o3a.add("zh-tw",
"zh-hant");jq.o3a.add("zh-cn","zh-hans");jq.o3a.add("zh-sg","zh-hans");jq.o3a.add("zh-mo","zh-hant");jq.o3a.add("zh-hk","zh-hant");jq.o3a.add("nb-no","no");jq.o3a.add("nn-no","no");jq.o3a.add("pt-br","pt")}}jq.P_a=null;jq.o3a=null;Object(D.a)(jq,"TranslatorAugLoopRuntimeManager",null,[842,365]);jq.NG();class aC{constructor(){this.YNh=this.Z=null}get name(){return"WordEditor.Translator"}init(){G.AFrameworkApplication.J.lq(()=>{if(aC.j2f())try{this.YNh=this.Z.resolve("WordEditor.Translator.TranslatorAugLoopRuntimeManager"),
this.YNh.initialize()}catch(d){F.ULS.sendTraceTag(42500741,399,10,"TranslatorPackage: Failed to initialize AL runtime manager. Exception: {0}",d)}})}dispose(){}Ec(d){this.Z=d;aC.j2f()&&(this.Z.ja("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition",()=>new bL).ha(),this.Z.ja("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation",()=>new TD).ha(),this.Z.ja("WordEditor.Translator.TranslatorAugLoopRuntimeManager",()=>new jq(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.Z.resolve("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition"),this.Z.resolve("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation"),this.Z.resolve("WordEditor.TranslatorRoamingServiceManager"),this.Z.resolve("Box4.IEditViewStateManager"),G.AFrameworkApplication.ta.Kt,G.AFrameworkApplication.J.sc("LanguageIntelligentSuggestionMaxWaitTimeAnnotationsMs",5E3),G.AFrameworkApplication.J.sc("LanguageIntelligentSuggestionMinKnownLangCompositionPercentage",10)/100,G.AFrameworkApplication.J.sc("LanguageIntelligentSuggestionMinProcessedDocLangCompositionPercentage",
95)/100,G.AFrameworkApplication.J.sc("LanguageIntelligentSuggestionMinDocumentCharCountFromAnnotations",1E3),!0,!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Pb.$I,G.AFrameworkApplication.uiCulture,G.AFrameworkApplication.ta.Pb.ZZa,!0,G.AFrameworkApplication.J.sc("LanguageIntelligentSuggestionMaxWaitTimeTeachingCalloutMs",1E4))).as("WordEditor.Translator.ITranslatorAugLoopRuntimeManager").ha())}static main(){aC.j2f()&&U.a.instance.Rc(new aC)}static j2f(){return!G.AFrameworkApplication.BL&&
!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.$("LanguageIntelligentSuggestionIsEnabled")&&G.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&G.AFrameworkApplication.J.$("AugLoopServerSideSeedingIsEnabled")}}Object(D.a)(aC,"WordEditorTranslatorPackage",null,[0,1]);var hM=e(1852);class Dv{constructor(d,n){this.Yka=d;this.WYk=n;this.nZb=this.nZb.bind(this);this.oZb=this.oZb.bind(this);this.uZb=this.uZb.bind(this)}jxe(){this.Yka.Fug(this.nZb);this.Yka.Gug(this.oZb);this.Yka.Qug(this.uZb)}Lie(){return!1}nZb(d,
n,B){1<d.length&&"!"===d.trimEnd()?this.Yka.reset():"."===d.charAt(d.length-1)&&this.WYk.dXo(d,B)}oZb(){}uZb(){}}Object(D.a)(Dv,"WordAiAssistantInitHandler",null,[457]);var Uq=e(1956);class vA{constructor(d){qw.a.assign(vA,this,d)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(d){return qw.a.matchesTypesFor(d,[vA.getTypeName()])}}vA.H_={T_:vA.getTypeName(),B_:vA.getBaseTypes()};class bC{constructor(d){qw.a.assign(bC,
this,d)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiMultiModalityModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(d){return qw.a.matchesTypesFor(d,[bC.getTypeName()])}}bC.H_={T_:bC.getTypeName(),B_:bC.getBaseTypes()};class Ev{constructor(d){qw.a.assign(Ev,this,d)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiTextModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(d){return qw.a.matchesTypesFor(d,
[Ev.getTypeName()])}}Ev.H_={T_:Ev.getTypeName(),B_:Ev.getBaseTypes()};class Nd{constructor(d){qw.a.assign(Nd,this,d)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiEmbeddingsModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_OpenAiModelConfig","AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(d){return qw.a.matchesTypesFor(d,[Nd.getTypeName()])}}Nd.H_={T_:Nd.getTypeName(),B_:Nd.getBaseTypes()};class Eu{constructor(d){qw.a.assign(Eu,this,d)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiChatModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(d){return qw.a.matchesTypesFor(d,
[Eu.getTypeName()])}}Eu.H_={T_:Eu.getTypeName(),B_:Eu.getBaseTypes()};var sj;(function(d){d[d.TextChatDavinci002=0]="TextChatDavinci002";d[d.TextDavinci001=1]="TextDavinci001";d[d.TextDavinci002=2]="TextDavinci002";d[d.TextDavinci003=3]="TextDavinci003";d[d.TextCurie001=4]="TextCurie001";d[d.TextBabbage001=5]="TextBabbage001";d[d.TextAda001=6]="TextAda001";d[d.CodeDavinci002=7]="CodeDavinci002";d[d.CodeCushman001=8]="CodeCushman001";d[d.Custom=9]="Custom";d[d.TextSimilarityAda001=10]="TextSimilarityAda001";
d[d.TextSimilarityBabbage001=11]="TextSimilarityBabbage001";d[d.TextSimilarityCurie001=12]="TextSimilarityCurie001";d[d.TextSimilarityDavinci001=13]="TextSimilarityDavinci001";d[d.TextSearchAdaDoc001=14]="TextSearchAdaDoc001";d[d.TextSearchAdaQuery001=15]="TextSearchAdaQuery001";d[d.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001";d[d.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001";d[d.TextSearchCurieDoc001=18]="TextSearchCurieDoc001";d[d.TextSearchCurieQuery001=19]="TextSearchCurieQuery001";
d[d.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001";d[d.TextSearchDavinciQuery001=21]="TextSearchDavinciQuery001";d[d.CodeSearchAdaCode001=22]="CodeSearchAdaCode001";d[d.CodeSearchAdaText001=23]="CodeSearchAdaText001";d[d.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001";d[d.CodeSearchBabbageText001=25]="CodeSearchBabbageText001";d[d.TextEmbeddingAda002=26]="TextEmbeddingAda002";d[d.Gpt35Turbo=27]="Gpt35Turbo";d[d.Gpt4_32k=28]="Gpt4_32k";d[d.Gpt4_0203=29]="Gpt4_0203";d[d.Gpt4_0314_4k=
30]="Gpt4_0314_4k";d[d.Gpt4_0314_32k=31]="Gpt4_0314_32k";d[d.Gpt4_DV3_FP_Variant=32]="Gpt4_DV3_FP_Variant";d[d.Gpt4_DV3_FP=33]="Gpt4_DV3_FP";d[d.Gpt4_PPO_FP_Variant=34]="Gpt4_PPO_FP_Variant";d[d.Gpt4_PPO_FP=35]="Gpt4_PPO_FP";d[d.GptV=36]="GptV";d[d.Gpt35Turbo16k=37]="Gpt35Turbo16k";d[d.Gpt35TurboInstruct=38]="Gpt35TurboInstruct"})(sj||(sj={}));var eL=e(2120);class cC{static create(d){const n=new cC(d);return n.activateAnnotation(d.responseType).then(()=>n)}constructor(d){this.config=d;this.nextMessageId=
0;this.responseCallbacks=new Map;const n=["session","chats"],B=Jh.a.create().toString(),Q=[...n,B];this.messagesPath=[...Q,"messages"];this.config.session.submitOperations([new kj.a({parentPath:n,items:[{id:B,body:d.chat}]}),new kj.a({parentPath:Q,items:[{id:"messages",body:new eL.a}]})])}send(d,n){const B=`${this.nextMessageId++}`;this.responseCallbacks.set(B,n);this.config.session.submitOperations([new kj.a({parentPath:this.messagesPath,items:[{id:B,body:d}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(d){return this.config.session.activateAnnotation(d,
{callback:n=>{if(kj.a.typeGuard(n)&&this.isUnderSubtree(n.parentPath,this.messagesPath))for(const B of n.items){const Q=n.parentPath[n.parentPath.length-1],ha=this.responseCallbacks.get(Q);ha&&(ha(B.body),this.responseCallbacks.delete(Q))}}}).then(({token:n})=>{this.activatedAnnotationToken=n})}isUnderSubtree(d,n){if(d.length<n.length)return!1;for(let B=0;B<n.length;B++)if(d[B]!==n[B])return!1;return!0}}Object(D.a)(cC,"ChatHelper",null,[]);class QI{constructor(d,n){this.pb=d;this.sTa=n}dXo(d,n){var B,
Q;const ha=null===(Q=null===(B=this.pb.ob)||void 0===B?void 0:B.currentSelection)||void 0===Q?void 0:Q.hd;ha&&(B=ha.node,bf.ParagraphReader.lc(B)&&(B=bf.ParagraphReader.text(B),0>n||n>B.length||(B=B.substring(0,n),this.createChatHelper({chat:new Uq.BasicChat({modelConfig:new Ev({model:sj.TextDavinci003,parameters:{temperature:.9}}),context:B,prefixText:"\u00acHuman\u00ac",suffixText:"\u00acAI\u00ac",historyDepth:0}),responseType:Uq.BasicChatResponse.getTypeName()}).then(Aa=>{Aa.send(new eL.b({message:"Give response to this query as a HTML element to be put inside a paragraph- "+
d}),bb=>{bb=bb.text.replace(/^\n/,"");bb=bb.replace(/\n$/,"");const Ib=ge.a.createTextRange(ha.node,0,n+d.length);this.sTa.OAe([Ib],!0,bb,()=>{})})}).catch(()=>{F.ULS.sendTraceTag(508944669,389,15,"WordAiAssistantTextHandler::sendMsg - could not process the request.")}))))}createChatHelper(d){return yu.a.IB().getSession().then(n=>cC.create({session:n,...d}))}}Object(D.a)(QI,"WordAiAssistantTextHandler",null,[]);class UD extends ze.a{get name(){return"WordEditor.WordAiAssistantPackage"}bXa(d){const n=
new hM.a(d.resolve("Box4.IEditingDomManager"),d.resolve("Box4.ICaretPositionManager"),d.resolve("Box4.BackspaceDeleteEventSource"),Object(Cg.a)(),"!",["!"]);n.bgc(yg.StaticActiveAppFrame.Aa().tb,gm.KeyInputManager.instance);d.ja("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler",()=>new Dv(n,d.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler"))).ha();d.ja("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler",()=>new QI(d.resolve("Box4.ISelectionManager"),
d.resolve("WordEditor.AppsForOffice.HtmlDataGetSetProvider")));d.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler").jxe()}dXa(){}cXa(){}static main(){G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordAiAssistantPackage",!1)&&U.a.instance.Rc(new UD)}}Object(D.a)(UD,"WordAiAssistantPackage",ze.a,[]);class $t{constructor(d,n,B,Q,ha,Aa,bb,Ib,oc=null,Ac){this.ga=d;this.Ai=n;this.za=B;this.Rw=Q;this.Sb=ha;this.ax=Aa;this.Nwk=
bb;this.fCd=Ib;this.QM=oc;this.dih=Ac;this.vHa=!1;this.KZe=void 0;this.Htp=(ad,sd,wd,yd,be)=>2!==wd?32:this.Ai.g5($t.Xhc)?this.I6m():this.HZj(ad,sd,wd,yd,be);this.qto=(ad,sd,wd,yd,be)=>{if(1===wd)return 32;be&&(be[Gf.a.On]=this.Ai.g5($t.Xhc),be[Gf.a.Visible]=!0);return 32};this.sum=(ad,sd)=>{const wd={};this.Y2i()?wd.HandoffMessageId=G.AFrameworkApplication.GUf:wd.HandoffMessageId="";wd.AugLoopCloudALServiceUrl=this.za.rb("AugLoopCloudALServiceUrl");wd.IsProductionEnvironment=(2===G.AFrameworkApplication.Wga).toString();
G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)?wd.triggerSummary=ad===dd.a.Xre:(wd.triggerSummary=ad===dd.a.Xre&&!!sd.summary,wd.summary=sd.summary);wd.wacSessionId=G.AFrameworkApplication.sessionStartInfoSettings.WACSessionID;wd.canonicalUserId=G.AFrameworkApplication.J.rb("LoggableUserId");wd.serverDocID=G.AFrameworkApplication.sessionStartInfoSettings.ServerDocId;this.QM&&(wd.initialWordCount=this.QM.vC);
wd.isCopilotContentGenerationDisabledbyAdminControl=this.KZe;wd.copilotPaneStartTimestamp=$t.HYd;return wd};this.HZj=(ad,sd,wd,yd,be)=>{if(1===wd)return 32;$t.HYd=Date.now();Ua.Health.instance.addQosPillar("Copilot:Chat Pane:Chat Pane");F.ULS.sendTraceTag(508347790,3050,50,`Opening Copilot Chat pane. Timestamp: ${$t.HYd}`);ad=Object.assign(new Xc.a,{taskPaneWidth:400,isResizable:!0,resizeMinWidth:320,resizeMaxWidth:920,isModernPane:!0,AU:WordRibbonStrings.Copilot,DW:this.sum(ad,be),onTaskPaneClose:this.Aul,
showResizeChatButton:!0});gg.a.Km().then(()=>{yu.a.IB().activateAnnotation(Object.assign(new JB.a,{annotationType:lw.getTypeName()}))});this.Ai.l6($t.Xhc,ad,!0);this.Sb.pc(new tb.a(2,1,5E3,()=>{if(this.Ai.g5($t.Xhc)){var ye=this.Drm();ye&&this.oKn(ye)}}));return 32};this.oKn=ad=>{ad.onload=()=>{const sd=Date.now();F.ULS.sendTraceTag(508347789,3050,50,"User Load time of the Copilot Chat pane is: {0} ms",sd-$t.HYd)}};this.Drm=()=>{const ad=this.Ai.Z$a($t.Xhc);return ad&&""!==ad?window.document.getElementById(ad):
null};this.Aul=()=>{this.cWl();this.fCd.endCopilotOperation("")};this.cWl=async()=>{const ad=await this.ax.getAnnotationsByType($C.b.getTypeName());for(const sd of ad)sd.content.categoryName===$t.t0d&&this.ax.TWa(sd,!1)};this.Y2i=()=>{G.AFrameworkApplication.ud("ec206969;47ja1358");return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HandoffEnabled",!1)&&G.AFrameworkApplication.GUf}}register(){this.vHa?F.ULS.sendTraceTag(508347795,3050,
15,"Attempted to register Copilot Chat add-in commands more than once."):(this.vHa=!0,F.ULS.sendTraceTag(508347794,3050,50,"Registering Copilot Chat commands."),this.ga.nb(dd.a.Hrg,ed.a.view,this.qto,1124),E()&&(G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)?this.dih.t$j():this.Akn(),G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)?this.ydn():(this.KZe=!1,this.qGj(),this.p8j())))}p8j(){if(this.Y2i()){const d=
G.AFrameworkApplication.va.Zb(dd.a.Wre,2,{});F.ULS.sendTraceTag(508303002,3050,50,"Launched Copilot with response "+JSON.stringify(d))}}qGj(){this.ga.nb(dd.a.Wre,S.a.frame,this.Htp,1028);this.ga.nb(dd.a.Xre,S.a.frame,this.HZj,1028)}ydn(){this.Nwk.execute(async d=>{try{const n=Date.now(),B=await d.nN("CopilotContentGeneration",!0),Q=Date.now()-n;F.ULS.sendTraceTag(508347793,3050,50,"[Copilot Chat] Copilot OCPS setting check latency: "+Q.toString());this.KZe=B}finally{this.qGj(),this.p8j()}})}Akn(){this.za.lq(()=>
{!this.za.$("IsAnonymousUser")&&this.Rw&&this.Rw.execute(async d=>{var n=Date.now();d=await d.isFeatureEnabled("Copilot",!1);n=Date.now()-n;F.ULS.sendTraceTag(508347792,3050,50,"[Copilot Chat] Copilot license check latency: "+n);this.Otp(d);d&&this.dih.t$j()})})}Otp(d){Object(Xa.c)()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ChatPane",!d)):F.ULS.sendTraceTag(508347791,3050,10,"[Copilot Chat] App chrome is not loaded yet. Cannot update the visibility of the copilot pane button in the ribbon.")}I6m(){this.Ai.yOb($t.Xhc);
return 32}}$t.Xhc="FA000000125";$t.t0d="CopilotHighlight";$t.HYd=0;Object(D.a)($t,"CopilotChatAddInCommands",null,[995]);class RI{constructor(d,n){this.iMg=d;this.Dh=n}startCopilotOperation(){if(this.Dh.awb())return F.ULS.sendTraceTag(508347799,3050,10,"Multi Step operation already running."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);this.iMg.VKj();this.Dh.Ckp();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}endCopilotOperation(){if(!this.Dh.awb())return F.ULS.sendTraceTag(508347798,
3050,10,"Multi Step operation must be running before attempting to end it."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);this.Dh.M6l();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}}Object(D.a)(RI,"CopilotOperationLifecycleHandler",null,[994]);class Ww{constructor(d){this.za=d;this.nci="CopilotFREDialog"}t$j(){try{const d=this.PAm();F.ULS.sendTraceTag(508302215,3050,50,"Copilot FRE governance status {0}.",d);if("OkToDisplay"===d||"OkToDisplayForDebug"===
d)(new Ea.a(!1,!1,!0)).ti("",this.jpd,{["id"]:this.nci,["bodyControls"]:{["id"]:this.nci,["uiLanguage"]:G.AFrameworkApplication.uiCulture}}),Object(sb.a)("ShowCopilotFREDialog",!0),Xg.a.instance.setItem(Ww.oci,Ww.pci)}catch(d){F.ULS.sendTraceTag(508302216,3050,15,"Failed to trigger Copilot FRE.",d)}}jpd(d){1===d?sb.a("CopilotFREDialogGotItButtonClicked"):0===d&&sb.a("CopilotFREDialogCloseButtonClicked")}PAm(){return this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotFREDialogDebugIsEnabled",
!1)?"OkToDisplayForDebug":this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotFREDialogIsEnabled",!1)?G.AFrameworkApplication.HN?"MeetingLiveSession":G.AFrameworkApplication.sessionStartInfoSettings?"Automation"===G.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup?"Automation":Xg.a.instance.localStorage?Xg.a.instance.getItem(Ww.oci)===Ww.pci?"FREShownBefore":"OkToDisplay":"NoAccessToLocalStorage":"SessionStartInfoNotAvailable":"FeatureNotEnabled"}}Ww.oci="IsCopilotFREAlreadyShown";
Ww.pci="V1";Object(D.a)(Ww,"CopilotFREManager",null,[]);class fC extends ze.a{constructor(){super(...arguments);this.j_=()=>{yg.StaticActiveAppFrame.Aa().tb.z1a(this.j_);this.initInternal()}}get name(){return"Copilot.Chat"}dXa(){if(E()){var d=yg.StaticActiveAppFrame.Aa().tb;d.uva?this.initInternal():d.gga(this.j_)}}initInternal(){try{this.xea()}catch(d){F.ULS.sendTraceTag(508347797,3050,10,"Initializing CopilotChatPackage failed.",d)}}cXa(){}bXa(d){this.Z=d;E()&&(this.Z.ja("WordEditor.CopilotOperationLifecycleHandler",
()=>new RI(this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),this.Z.resolve("Box4.IUndoManager"))).ha(),this.Z.ja("WordEditor.Copilot.CopilotFREManager",()=>new Ww(G.AFrameworkApplication.J)).ha(),this.Z.ja("WordEditor.CopilotOperationLifecycleHandler",()=>new RI(this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),this.Z.resolve("Box4.IUndoManager"))).ha(),this.Z.ja("WordEditor.Copilot.ICopilotChatAddInCommands",
()=>new $t(G.AFrameworkApplication.va,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),G.AFrameworkApplication.J,this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),G.AFrameworkApplication.zc,d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.Za("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.resolve("WordEditor.CopilotOperationLifecycleHandler"),this.Xtb(),this.Z.Wa("WordEditor.Copilot.CopilotFREManager"))).ha())}xea(){this.Z.resolve("WordEditor.Copilot.ICopilotChatAddInCommands").register()}Xtb(){const d=
this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory");return d?d.getInstance(0):(F.ULS.sendTraceTag(508347796,3050,10,"Could not resolve wordCountManagerFactory"),null)}static main(){!G.AFrameworkApplication.BL&&E()&&U.a.instance.Rc(new fC)}}Object(D.a)(fC,"CopilotChatPackage",ze.a,[]);class YD{constructor(d,n){this.ga=d;this.Ai=n;this.vHa=!1;this.tHg=(B,Q,ha)=>{if(1===ha)return 32;B=Object.assign(new Xc.a,{taskPaneWidth:400,isResizable:!0,resizeMinWidth:320,resizeMaxWidth:920,isModernPane:!0,
AU:this.jTm(B),onTaskPaneClose:this.bao,sourceLocationOverrideResourceId:this.iTm(B)});this.Ai.l6(YD.Aop,B,!0);return 32};this.bao=()=>{};this.jTm=B=>{if(B===dd.a.Dme)return WordRibbonStrings.SyntexManageTemplates;if(B===dd.a.Cme)return WordRibbonStrings.SyntexManageSnippets;if(B===dd.a.A3d)return WordRibbonStrings.SyntexDocumentGeneration};this.iTm=B=>{if(B===dd.a.Dme)return"Templatization.Url";if(B===dd.a.Cme)return"Snippets.Url";if(B===dd.a.A3d)return"DocGen.Url"}}register(){this.vHa?F.ULS.sendTraceTag(507905814,
3051,15,"Attempted to register Syntex add-in commands more than once."):(this.vHa=!0,F.ULS.sendTraceTag(507905813,3051,50,"Registering Syntex commands."),this.ga.nb(dd.a.Dme,ed.a.view,this.tHg,1028),this.ga.nb(dd.a.Cme,ed.a.view,this.tHg,1028),this.ga.nb(dd.a.A3d,ed.a.view,this.tHg,1028))}}YD.Aop="FA000000145";Object(D.a)(YD,"SyntexAddInCommands",null,[62]);var WI=e(1121);class gG{constructor(d,n){this.zI=d;this.tb=n;this.j_=()=>{this.tb.z1a(this.j_);this.xea()};if(!d)throw Ou.a.argument("AppLifecycleManager is null");
if(!n)throw Ou.a.argument("Workspace is null");}get name(){return"Syntex.Contracts"}dispose(){}init(){Object(WI.a)()&&this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Ec(d){this.Z=d;Object(WI.a)()&&this.Z.ja("WordEditor.Syntex.ISyntexAddInCommands",()=>new YD(G.AFrameworkApplication.va,this.Z.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"))).ha()}Sp(){G.AFrameworkApplication.ta.Pb.JN?this.zI.Zk(16,()=>{this.dvb()}):this.dvb()}dvb(){this.tb.uva?this.xea():this.tb.gga(this.j_)}xea(){this.Z.resolve("WordEditor.Syntex.ISyntexAddInCommands").register()}static main(){!G.AFrameworkApplication.BL&&
Object(WI.a)()&&U.a.instance.Rc(new gG(Fe.a.get_instance(),yg.StaticActiveAppFrame.Aa().tb))}}Object(D.a)(gG,"SyntexPackage",null,[0,1]);var hG=e(1876);class ZD{}Object(D.a)(ZD,"ItemPreviewTaskPaneProps",null,[]);class XI{constructor(d,n,B){this.yRd="ItemPreviewTaskPane";this.KMh=400;this.fLk=330;this.GKk=920;this.Vw=this.vi=!1;this.W3=null;this.mi=d;this.oc=n;this.qY=B;this.kC=new hG.a}get isVisible(){return this.Vw}Pxa(d){d!==this.Vw&&(this.Vw=d)}initialize(){this.vi||(this.CY(),this.qea(),this.vi=
!0)}AB(d){this.kC.Dgb(d);let n=this.KMh;window.innerWidth<this.KMh&&window.innerWidth>window.innerHeight&&(n=window.innerWidth);return Object.assign(new pk.a,{title:"Preview doc",hideHeader:!1,width:n,location:2,contentProps:d,onOpen:this.Tmd.bind(this),onClose:this.Smd.bind(this),enableResize:!0,isModernPane:!0,isPaneAutoOpened:!1,minResizeWidth:this.fLk,maxResizeWidth:this.GKk})}Tmd(){this.Pxa(!0);this.ZW();this.mi.Ne()}Smd(){this.Pxa(!1);this.mi.Ne()}Tsd(d){const n=this.Lca(d);Vc.UISurfaces.aw().then(B=>
{B.showTaskPane(this.yRd,this.AB(n));return null})}Lca(d){this.W3||(this.W3=this.aWa(d));return this.W3}aWa(d){const n=new ZD;return Object.assign(n,{type:"ItemPreviewTaskPaneProps",title:d.title,errorType:d.error,errorMessage:d.L$a,src:d.url,refreshPane:!0,onLoad:this.onLoad,onError:this.onError,onFocus:this.onFocus})}onLoad(){F.ULS.sendTraceTag(507892826,383,50,"onLoad called for ItemPreview TaskPane")}onError(){F.ULS.sendTraceTag(507892825,383,15,"There is an issue while loading ItemPreviewTaskPane iFrame")}onFocus(){F.ULS.sendTraceTag(507892824,
321,50,"Setting the focus to ItemPreviewTaskPane")}qea(){this.oc.te(this.yRd).parent=ux.AFrame.rr}ZW(){this.oc.Rg(this.yRd)}CY(){this.qY.iLa();this.qY.zPb(this.oc)}show(d){this.isVisible?this.ZW():(this.initialize(),this.Tsd(d))}hide(){Vc.UISurfaces.aw().then(d=>{d.hideTaskPane(this.yRd,2);return null})}dispose(){}}Object(D.a)(XI,"ItemPreviewTaskPane",null,[63]);var kL=e(1760);class $D{constructor(){this.Z=null}get name(){return"WordEditor.ItemPreview"}Ec(d){this.Z=d}init(){this.Z.ja("WordEditor.ItemPreview.ItemPreviewTaskPane",
()=>new XI(this.Z.resolve("Box4.IAppFrame"),df.FocusManager.instance(),ui.a.instance)).ha();this.Z.ja("WordEditor.ItemPreview.ItemPreviewActionHandler",()=>new kL.a(G.AFrameworkApplication.va,this.Z.resolve("WordEditor.ItemPreview.ItemPreviewTaskPane"))).ha();this.Z.resolve("WordEditor.ItemPreview.ItemPreviewActionHandler").mc();sb.a("InitializeItemPreviewPackage",!0)}dispose(){this.Z&&(this.Z.resolve("WordEditor.ItemPreview.ItemPreviewActionHandler").lRa(),this.Z.resolve("WordEditor.ItemPreview.ItemPreviewTaskPane").dispose(),
this.Z.resolve("WordEditor.ItemPreview.ItemPreviewActionHandler").dispose());this.Z=null}static M_f(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AugloopPreviewAndThumbnail",!1)}static main(){$D.M_f()&&U.a.instance.Rc(new $D)}}Object(D.a)($D,"ItemPreviewPackageManager",null,[0,1]);Type.registerNamespace("B4Apps");Type.registerNamespace("ResumeAssistant.AppForOffice");Type.registerNamespace("WEAFO");Type.registerNamespace("WECX");
Type.registerNamespace("WELT");Type.registerNamespace("Wonca.AddInCommands");Type.registerNamespace("Wonca.AppsForOffice");Type.registerNamespace("WordEditor.AcronymsWeb");Type.registerNamespace("WordEditor.AddInCommands");Type.registerNamespace("WordEditor.Assistance");Type.registerNamespace("WordEditor.ConditionalTriggering");Type.registerNamespace("WordEditor.Designer");Type.registerNamespace("WordEditor.EditorUpsell");Type.registerNamespace("WordEditor.Extension");Type.registerNamespace("WordEditor.Ideas");
Type.registerNamespace("WordEditor.Ideas.TriggerModels");Type.registerNamespace("WordEditor.ListTransformationSuggestion");Type.registerNamespace("WordEditor.NeuralRewrite");Type.registerNamespace("WordEditor.OcsConnectionStatus");Type.registerNamespace("WordEditor.OcsVectorClockTelemetry");Type.registerNamespace("WordEditor.Policy");Type.registerNamespace("WordEditor.ProactiveUxGovernance");Type.registerNamespace("WordEditor.ReadingTime");Type.registerNamespace("WordEditor.ResumeAssistant");Type.registerNamespace("WordEditor.SmartLookup");
Type.registerNamespace("WordEditor.SmartLookup.SmartLookupManager");Type.registerNamespace("WordEditor.UpsellCampaign");Type.registerNamespace("WordEditor.Syntex");Type.registerNamespace("WordEditor.Transcription");Type.registerNamespace("WordEditor.Transcription.SDXAddInLoader");Type.registerNamespace("WordEditor.Transformation");Type.registerNamespace("WordEditor.Translator");Type.registerNamespace("WordEditor.DocumentAssemblyEditor");Type.registerNamespace("Common.App.ContentSecurityPolicy");P.main();
Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.DisplayEnvironmentName");W.main();Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("CommandUI.AddInCommands");kg.main();uy.main();"undefined"==typeof OfficeExtension&&Type.registerNamespace("OfficeExtension");"undefined"==typeof OfficeExtension.WacRuntime&&(OfficeExtension.WacRuntime={},Type.registerNamespace("OfficeExtension.WacRuntime"));
"undefined"==typeof OfficeExtension.WacRuntime.IAsyncEnumerator&&(OfficeExtension.WacRuntime.IAsyncEnumerator=function(){},OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null},OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator"));Sq.main();pH.main();window.WordEditor.Extension.Range=Ut;window.WordEditor.Extension.AutomationUtility=y;window.WordEditor.Extension.SearchOptions=ji.a;window.WordEditor.Extension.AutomationTransaction=
kB;G.AFrameworkApplication.BL||U.a.instance.Rc(new ry);XK.main();Vx.main();Type.registerNamespace("Common.App.LearningTools");U.a.instance.Rc(new fq);SB.main();Type.registerNamespace("Common.App.Policy");Fd.main();Si.main();aG.main();try{U.a.instance.Rc(new DI)}catch(d){F.ULS.shipAssertTag(572838543,3025,!1,d.message)}qf.main();if(!G.AFrameworkApplication.BL)if(yg.StaticActiveAppFrame.Aa())try{U.a.instance.Rc(new Ov(Fe.a.get_instance(),new vy,yg.StaticActiveAppFrame.Aa().tb))}catch(d){F.ULS.shipAssertTag(592720736,
3016,!1,String.format("{0} {1}",d.message,d.stack))}else F.ULS.shipAssertTag(592558211,3016,!1);PI.main();aC.main();rA.main();uA.main();mA.main();SD.main();su.main();Tx.main();jf.main();XE.main();fC.main();gG.main();Type.registerNamespace("Common.App.AppLoadStateTracker");window.Common.App.AppLoadStateTracker.AppLoadStateTracker=H.a;U.a.instance.Rc(new J,7);UD.main();$D.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23790900/wdjs/WordEditorDS.box4.dll3.js.map