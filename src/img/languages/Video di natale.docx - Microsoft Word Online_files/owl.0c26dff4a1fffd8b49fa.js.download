/*! For license information please see owl.0c26dff4a1fffd8b49fa.js.LICENSE.txt */
var Microsoft;!function(){var t,e,n,i,o={9379:function(t,e,n){t.exports=n(2428)},7885:function(t,e,n){"use strict";var i=n(1366),o=n(3002),r=n(3513),s=n(4055),a=n(3655),c=n(3769),u=n(1658),l=n(3835),h=n(7062),d=n(697);t.exports=function(t){return new Promise((function(e,n){var f,p=t.data,v=t.headers,m=t.responseType;function g(){t.cancelToken&&t.cancelToken.unsubscribe(f),t.signal&&t.signal.removeEventListener("abort",f)}i.isFormData(p)&&delete v["Content-Type"];var w=new XMLHttpRequest;if(t.auth){var y=t.auth.username||"",_=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";v.Authorization="Basic "+btoa(y+":"+_)}var C=a(t.baseURL,t.url);function S(){if(w){var i="getAllResponseHeaders"in w?c(w.getAllResponseHeaders()):null,r={data:m&&"text"!==m&&"json"!==m?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:i,config:t,request:w};o((function(t){e(t),g()}),(function(t){n(t),g()}),r),w=null}}if(w.open(t.method.toUpperCase(),s(C,t.params,t.paramsSerializer),!0),w.timeout=t.timeout,"onloadend"in w?w.onloadend=S:w.onreadystatechange=function(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(S)},w.onabort=function(){w&&(n(l("Request aborted",t,"ECONNABORTED",w)),w=null)},w.onerror=function(){n(l("Network Error",t,null,w)),w=null},w.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",i=t.transitional||h;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(l(e,t,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null},i.isStandardBrowserEnv()){var k=(t.withCredentials||u(C))&&t.xsrfCookieName?r.read(t.xsrfCookieName):void 0;k&&(v[t.xsrfHeaderName]=k)}"setRequestHeader"in w&&i.forEach(v,(function(t,e){void 0===p&&"content-type"===e.toLowerCase()?delete v[e]:w.setRequestHeader(e,t)})),i.isUndefined(t.withCredentials)||(w.withCredentials=!!t.withCredentials),m&&"json"!==m&&(w.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&w.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(f=function(t){w&&(n(!t||t&&t.type?new d("canceled"):t),w.abort(),w=null)},t.cancelToken&&t.cancelToken.subscribe(f),t.signal&&(t.signal.aborted?f():t.signal.addEventListener("abort",f))),p||(p=null),w.send(p)}))}},2428:function(t,e,n){"use strict";var i=n(1366),o=n(9018),r=n(3035),s=n(5289),a=function t(e){var n=new r(e),a=o(r.prototype.request,n);return i.extend(a,r.prototype,n),i.extend(a,n),a.create=function(n){return t(s(e,n))},a}(n(299));a.Axios=r,a.Cancel=n(697),a.CancelToken=n(6913),a.isCancel=n(285),a.VERSION=n(7843).version,a.all=function(t){return Promise.all(t)},a.spread=n(8615),a.isAxiosError=n(1350),t.exports=a,t.exports.default=a},697:function(t){"use strict";function e(t){this.message=t}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,t.exports=e},6913:function(t,e,n){"use strict";var i=n(697);function o(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._){var e,i=n._.length;for(e=0;e<i;e++)n._[e](t);n._=null}})),this.promise.then=function(t){var e,i=new Promise((function(t){n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t){n.reason||(n.reason=new i(t),e(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.prototype.subscribe=function(t){this.reason?t(this.reason):this._?this._.push(t):this._=[t]},o.prototype.unsubscribe=function(t){if(this._){var e=this._.indexOf(t);-1!==e&&this._.splice(e,1)}},o.source=function(){var t;return{token:new o((function(e){t=e})),cancel:t}},t.exports=o},285:function(t){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},3035:function(t,e,n){"use strict";var i=n(1366),o=n(4055),r=n(9267),s=n(360),a=n(5289),c=n(7596),u=c.validators;function l(t){this.defaults=t,this.interceptors={request:new r,response:new r}}l.prototype.request=function(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;void 0!==n&&c.assertOptions(n,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var i=[],o=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,i.unshift(t.fulfilled,t.rejected))}));var r,l=[];if(this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)})),!o){var h=[s,void 0];for(Array.prototype.unshift.apply(h,i),h=h.concat(l),r=Promise.resolve(e);h.length;)r=r.then(h.shift(),h.shift());return r}for(var d=e;i.length;){var f=i.shift(),p=i.shift();try{d=f(d)}catch(t){p(t);break}}try{r=s(d)}catch(t){return Promise.reject(t)}for(;l.length;)r=r.then(l.shift(),l.shift());return r},l.prototype.getUri=function(t){return t=a(this.defaults,t),o(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,n,i){return this.request(a(i||{},{method:t,url:e,data:n}))}})),t.exports=l},9267:function(t,e,n){"use strict";var i=n(1366);function o(){this.handlers=[]}o.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){i.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=o},3655:function(t,e,n){"use strict";var i=n(5558),o=n(1575);t.exports=function(t,e){return t&&!i(e)?o(t,e):e}},3835:function(t,e,n){"use strict";var i=n(4045);t.exports=function(t,e,n,o,r){var s=new Error(t);return i(s,e,n,o,r)}},360:function(t,e,n){"use strict";var i=n(1366),o=n(4788),r=n(285),s=n(299),a=n(697);function c(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new a("canceled")}t.exports=function(t){return c(t),t.headers=t.headers||{},t.data=o.call(t,t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return c(t),e.data=o.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return r(e)||(c(t),e&&e.response&&(e.response.data=o.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},4045:function(t){"use strict";t.exports=function(t,e,n,i,o){return t.config=e,n&&(t.code=n),t.request=i,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t}},5289:function(t,e,n){"use strict";var i=n(1366);t.exports=function(t,e){e=e||{};var n={};function o(t,e){return i.isPlainObject(t)&&i.isPlainObject(e)?i.merge(t,e):i.isPlainObject(e)?i.merge({},e):i.isArray(e)?e.slice():e}function r(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:o(void 0,t[n]):o(t[n],e[n])}function s(t){if(!i.isUndefined(e[t]))return o(void 0,e[t])}function a(n){return i.isUndefined(e[n])?i.isUndefined(t[n])?void 0:o(void 0,t[n]):o(void 0,e[n])}function c(n){return n in e?o(t[n],e[n]):n in t?o(void 0,t[n]):void 0}var u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return i.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=u[t]||r,o=e(t);i.isUndefined(o)&&e!==c||(n[t]=o)})),n}},3002:function(t,e,n){"use strict";var i=n(3835);t.exports=function(t,e,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?e(i("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},4788:function(t,e,n){"use strict";var i=n(1366),o=n(299);t.exports=function(t,e,n){var r=this||o;return i.forEach(n,(function(n){t=n.call(r,t,e)})),t}},299:function(t,e,n){"use strict";var i=n(1366),o=n(855),r=n(4045),s=n(7062),a={"Content-Type":"application/x-www-form-urlencoded"};function c(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u,l={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=n(7885)),u),transformRequest:[function(t,e){return o(e,"Accept"),o(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(c(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)||e&&"application/json"===e["Content-Type"]?(c(e,"application/json"),function(t,e,n){if(i.isString(t))try{return(0,JSON.parse)(t),i.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||l.transitional,n=e&&e.silentJSONParsing,o=e&&e.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||o&&i.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(s){if("SyntaxError"===t.name)throw r(t,this,"E_JSON_PARSE");throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){l.headers[t]=i.merge(a)})),t.exports=l},7062:function(t){"use strict";t.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},7843:function(t){t.exports={version:"0.26.1"}},9018:function(t){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}}},4055:function(t,e,n){"use strict";var i=n(1366);function o(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(i.isURLSearchParams(e))r=e.toString();else{var s=[];i.forEach(e,(function(t,e){null!=t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,(function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),s.push(o(e)+"="+o(t))})))})),r=s.join("&")}if(r){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}},1575:function(t){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},3513:function(t,e,n){"use strict";var i=n(1366);t.exports=i.isStandardBrowserEnv()?{write:function(t,e,n,o,r,s){var a=[];a.push(t+"="+encodeURIComponent(e)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(o)&&a.push("path="+o),i.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5558:function(t){"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},1350:function(t,e,n){"use strict";var i=n(1366);t.exports=function(t){return i.isObject(t)&&!0===t.isAxiosError}},1658:function(t,e,n){"use strict";var i=n(1366);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=o(window.location.href),function(e){var n=i.isString(e)?o(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},855:function(t,e,n){"use strict";var i=n(1366);t.exports=function(t,e){i.forEach(t,(function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])}))}},3769:function(t,e,n){"use strict";var i=n(1366),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,r,s={};return t?(i.forEach(t.split("\n"),(function(t){if(r=t.indexOf(":"),e=i.trim(t.substr(0,r)).toLowerCase(),n=i.trim(t.substr(r+1)),e){if(s[e]&&o.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},8615:function(t){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},7596:function(t,e,n){"use strict";var i=n(7843).version,o={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){o[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var r={};o.transitional=function(t,e,n){return function(o,s,a){if(!1===t)throw new Error(function(t,e){return"[Axios v"+i+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}(s," has been removed"+(e?" in "+e:"")));return e&&!r[s]&&(r[s]=!0),!t||t(o,s,a)}},t.exports={assertOptions:function(t,e,n){if("object"!=typeof t)throw new TypeError("options must be an object");for(var i=Object.keys(t),o=i.length;o-- >0;){var r=i[o],s=e[r];if(s){var a=t[r],c=void 0===a||s(a,r,t);if(!0!==c)throw new TypeError("option "+r+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+r)}},validators:o}},1366:function(t,e,n){"use strict";var i=n(9018),o=Object.prototype.toString;function r(t){return Array.isArray(t)}function s(t){return void 0===t}function a(t){return"[object ArrayBuffer]"===o.call(t)}function c(t){return null!==t&&"object"==typeof t}function u(t){if("[object Object]"!==o.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function l(t){return"[object Function]"===o.call(t)}function h(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),r(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:r,isArrayBuffer:a,isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"[object FormData]"===o.call(t)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&a(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:c,isPlainObject:u,isUndefined:s,isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:l,isStream:function(t){return c(t)&&l(t.pipe)},isURLSearchParams:function(t){return"[object URLSearchParams]"===o.call(t)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:h,merge:function t(){var e={};function n(n,i){u(e[i])&&u(n)?e[i]=t(e[i],n):u(n)?e[i]=t({},n):r(n)?e[i]=n.slice():e[i]=n}for(var i=0,o=arguments.length;i<o;i++)h(arguments[i],n);return e},extend:function(t,e,n){return h(e,(function(e,o){t[o]=n&&"function"==typeof e?i(e,n):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},6403:function(t,e,n){"use strict";n.d(e,{y:function(){return u}});var i=n(983),o=n(7922),r=n(5567),s=n(59);function a(t){return t}var c=n(4665),u=function(){function t(t){this.P=!1,t&&(this.O=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var s=this.operator,a=function(t,e,n){if(t){if(t instanceof i.L)return t;if(t[o.b])return t[o.b]()}return t||e||n?new i.L(t,e,n):new i.L(r.c)}(t,e,n);if(s?a.add(s.call(a,this.source)):a.add(this.source||c.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this.O(a):this.F(a)),c.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},t.prototype.F=function(t){try{return this.O(t)}catch(e){c.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){var e=t,n=e.closed,o=e.destination,r=e.isStopped;if(n||r)return!1;t=o&&o instanceof i.L?o:null}return!0}(t)&&t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=l(e))((function(e,i){var o;o=n.subscribe((function(e){try{t(e)}catch(t){i(t),o&&o.unsubscribe()}}),i,e)}))},t.prototype.O=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[s.L]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0===(n=t).length?a:1===n.length?n[0]:function(t){return n.reduce((function(t,e){return e(t)}),t)})(this);var n},t.prototype.toPromise=function(t){var e=this;return new(t=l(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function l(t){if(t||(t=c.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},5567:function(t,e,n){"use strict";n.d(e,{c:function(){return r}});var i=n(4665),o=n(5514),r={closed:!0,next:function(t){},error:function(t){if(i.v.useDeprecatedSynchronousErrorHandling)throw t;(0,o.z)(t)},complete:function(){}}},7218:function(t,e,n){"use strict";n.d(e,{xQ:function(){return h}});var i=n(4141),o=n(6403),r=n(983),s=n(1934),a=n(2913),c=function(t){function e(e,n){var i=t.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return i.ZT(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(s.w),u=n(7922),l=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return i.ZT(e,t),e}(r.L),h=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i.ZT(e,t),e.prototype[u.b]=function(){return new l(this)},e.prototype.lift=function(t){var e=new d(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.N;if(!this.isStopped)for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),i=0;i<e;i++)n[i].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype.F=function(e){if(this.closed)throw new a.N;return t.prototype.F.call(this,e)},e.prototype.O=function(t){if(this.closed)throw new a.N;return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.isStopped?(t.complete(),s.w.EMPTY):(this.observers.push(t),new c(this,t))},e.prototype.asObservable=function(){var t=new o.y;return t.source=this,t},e.create=function(t,e){return new d(t,e)},e}(o.y),d=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return i.ZT(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype.O=function(t){return this.source?this.source.subscribe(t):s.w.EMPTY},e}(h)},983:function(t,e,n){"use strict";n.d(e,{L:function(){return l}});var i=n(4141),o=n(3115),r=n(5567),s=n(1934),a=n(7922),c=n(4665),u=n(5514),l=function(t){function e(n,i,o){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=r.c;break;case 1:if(!n){s.destination=r.c;break}if("object"==typeof n){n instanceof e?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new h(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new h(s,n,i,o)}return s}return i.ZT(e,t),e.prototype[a.b]=function(){return this},e.create=function(t,n,i){var o=new e(t,n,i);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this.$(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this.X(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.Z())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype.$=function(t){this.destination.next(t)},e.prototype.X=function(t){this.destination.error(t),this.unsubscribe()},e.prototype.Z=function(){this.destination.complete(),this.unsubscribe()},e.prototype.tt=function(){var t=this.et;return this.et=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.et=t,this},e}(s.w),h=function(t){function e(e,n,i,s){var a,c=t.call(this)||this;c.nt=e;var u=c;return(0,o.m)(n)?a=n:n&&(a=n.next,i=n.error,s=n.complete,n!==r.c&&(u=Object.create(n),(0,o.m)(u.unsubscribe)&&c.add(u.unsubscribe.bind(u)),u.unsubscribe=c.unsubscribe.bind(c))),c.it=u,c.$=a,c.X=i,c.Z=s,c}return i.ZT(e,t),e.prototype.next=function(t){if(!this.isStopped&&this.$){var e=this.nt;c.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this.$,t)&&this.unsubscribe():this.__tryOrUnsub(this.$,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this.nt,n=c.v.useDeprecatedSynchronousErrorHandling;if(this.X)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this.X,t),this.unsubscribe()):(this.__tryOrUnsub(this.X,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,u.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,u.z)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this.nt;if(this.Z){var n=function(){return t.Z.call(t.it)};c.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this.it,e)}catch(t){if(this.unsubscribe(),c.v.useDeprecatedSynchronousErrorHandling)throw t;(0,u.z)(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!c.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this.it,n)}catch(e){return c.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):((0,u.z)(e),!0)}return!1},e.prototype.ot=function(){var t=this.nt;this.it=null,this.nt=null,t.unsubscribe()},e}(l)},1934:function(t,e,n){"use strict";n.d(e,{w:function(){return a}});var i=n(3953),o=n(4572),r=n(3115),s=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),a=function(){function t(t){this.closed=!1,this.et=null,this.rt=null,t&&(this.st=!0,this.ot=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,a=n.et,u=n.st,l=n.ot,h=n.rt;if(this.closed=!0,this.et=null,this.rt=null,a instanceof t)a.remove(this);else if(null!==a)for(var d=0;d<a.length;++d)a[d].remove(this);if((0,r.m)(l)){u&&(this.ot=void 0);try{l.call(this)}catch(t){e=t instanceof s?c(t.errors):[t]}}if((0,i.k)(h)){d=-1;for(var f=h.length;++d<f;){var p=h[d];if((0,o.K)(p))try{p.unsubscribe()}catch(t){e=e||[],t instanceof s?e=e.concat(c(t.errors)):e.push(t)}}}if(e)throw new s(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var i=n;(n=new t).rt=[i]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=n.et;if(null===o)n.et=this;else if(o instanceof t){if(o===this)return n;n.et=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var r=this.rt;return null===r?this.rt=[n]:r.push(n),n},t.prototype.remove=function(t){var e=this.rt;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function c(t){return t.reduce((function(t,e){return t.concat(e instanceof s?e.errors:e)}),[])}},4665:function(t,e,n){"use strict";n.d(e,{v:function(){return o}});var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){i=t},get useDeprecatedSynchronousErrorHandling(){return i}}},59:function(t,e,n){"use strict";n.d(e,{L:function(){return i}});var i=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},7922:function(t,e,n){"use strict";n.d(e,{b:function(){return i}});var i=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},2913:function(t,e,n){"use strict";n.d(e,{N:function(){return i}});var i=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},5514:function(t,e,n){"use strict";function i(t){setTimeout((function(){throw t}),0)}n.d(e,{z:function(){return i}})},3953:function(t,e,n){"use strict";n.d(e,{k:function(){return i}});var i=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}()},3115:function(t,e,n){"use strict";function i(t){return"function"==typeof t}n.d(e,{m:function(){return i}})},4572:function(t,e,n){"use strict";function i(t){return null!==t&&"object"==typeof t}n.d(e,{K:function(){return i}})},4141:function(t,e,n){"use strict";n.d(e,{ZT:function(){return o}});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},i(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}},9891:function(t,e,n){"use strict";n.d(e,{CR:function(){return a},Jh:function(){return r},XA:function(){return s},ev:function(){return c},mG:function(){return o},pi:function(){return i}});var i=function(){return i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};function o(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}function r(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function c(t,e,n){if(n||2===arguments.length)for(var i,o=0,r=e.length;o<r;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}Object.create,Object.create},7937:function(t,e,n){"use strict";var i;n.d(e,{L8:function(){return h}}),function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(i||(i={}));var o,r,s=n(6322),a=n(7814),c=function(){function t(t){var e=this;this.ct=3e4,this.ut=30,this.lt=0,this.ht=[],this.ft=(0,a.Ks)(),this.vt=[],this.gt="",this.wt=0,this.flushOnClose=function(){e.yt(!1,!1)},this.flush=function(){e._t()},this.flushAndSetNewEndpoint=function(t,n){var i,o=e.Ct(t);o.localeCompare(null!==(i=e.St)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(e.vt.push((function(){e.St=o,n&&n()})),e.yt(!0,!0))},this.Ct=function(t){return t+"?usid="+e.gt+"&officeserverversion="+function(){try{return __VERSION_PLACEHOLDER__}catch(t){return"###VERSION###"}}()},this._t=function(){window.setTimeout((function(){return e.yt(!0,!0)}),0)},this.yt=function(t,n){var i,o,r,s,c,u,l,h=(0,a.u3)();window.clearTimeout(e.kt),e.St&&(e.ht.length>0&&(e.lt+=1,function(t,e,n){if(e){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(e,t)}catch(t){}!function(t,e,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",e,n),i.send(t))}(t,e,n)}}((i=e.ht.splice(0,t?e.ut:e.ht.length),o=e.gt,r=e.lt,s=e.ft,c=[],u=i.map((function(t){return function(t,e,n){var i={};if(i.G=t.tag,i.T=t.timestamp-e,i.M=t.message,i.C=t.category,t.correlationId){var o=n.findIndex((function(e){return e===t.correlationId}));o<0&&(o=n.push(t.correlationId)-1),i.I=o}var r=1e3*t.type+t.level;return i.D=r,i}(t,s,c)})),l=function(t,e,n,i,o){var r={};return r.T=t,r.L=e,r.S=n,r.I=i,o&&o.length>0&&(r.W=o),r.V=1,r}(s,u,o,r,c),JSON.stringify(l)),e.St,n),e.ft=(0,a.Ks)()),0===e.ht.length&&e.vt.length>0&&(e.vt.forEach((function(t){"requestIdleCallback"in window?window.requestIdleCallback(t):window.setTimeout(t,0)})),e.vt=[]),t&&(e.kt=window.setTimeout((function(){e._t()}),e.ht.length>e.ut||e.vt.length>0?1e3:e.ct)),e.wt+=(0,a.u3)()-h)},t&&this.configure(t)}return t.prototype.getTimeSpentLogging=function(){return this.wt},t.prototype.addLoggingTime=function(t){this.wt+=t},t.prototype.configure=function(t){var e=this,n=(0,a.u3)();if(t.uploadCadenceInMs&&(this.ct=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.ut=t.uploadTriggerSize),t.sessionId&&(this.gt=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.St)throw new Error("Remote ULS endpoint is already set");this.St=this.Ct(t.remoteUlsEndpoint),this.ft=(0,a.Ks)(),window.setTimeout((function(){return e.yt(!0,!0)}),0)}this.wt+=(0,a.u3)()-n},t.prototype.handleTrace=function(t){var e=(0,a.u3)();t.message.length>3072&&(t.message=t.message.substring(0,3059)+"... [Trimmed]"),this.ht.push(t),(this.ht.length>this.ut||t.level===s.G.Error)&&this._t(),this.wt+=(0,a.u3)()-e},t.prototype.getUserSessionId=function(){return this.gt},t}(),u=[];!function(t){t.Tt="BootstrapperMaxUlsHeartbeatTime",t.bt="BootstrapperNoCompleteWarning1Time",t.At="BootstrapperNoCompleteWarning2Time",t.It="RemoteUlsETag",t.Rt="RemoteUlsSuppressions",t.Et="BootstrapperSettingsFetchPeriod",t.Nt="timestamp",t.Pt="BootstrapperUlsHeartbeatIntervalMs",t.Ht="BootstrapperUlsHeartBeatIsEnabled",t.Ot="BootstrapperUlsUploadCadenceMs",t.Mt="WordConsumptionViewToEditRedirectIsEnabled",t.Dt="RequestedCallThrottlingDefaultToViewMinimumValue",t.Ft="BulsEndpointUrl",t.xt="EnableCommonHostDiagnosticsParams",t.qt="EnableOnSubmitCallbackForWacFrame",t.Bt="EnableICNForWord"}(r||(r={}));var l=6e4;function h(t){var e=new c(t);function n(t,n,o,r){var s=(0,a.u3)();if(!function(t){return 1===u[t]}(t)){var c={timestamp:(0,a.Ks)(),category:n,tag:t,level:o,type:i.Trace,message:r,correlationId:""};e.addLoggingTime((0,a.u3)()-s),e.handleTrace(c)}}return{ULS:{sendTraceTag:function(t,e,i,o){n(t,e,i,o)},shipAssertTag:function(t,e,i,o){i&&n(t,e,s.G.Error,o)},debugAssertTag:function(t,e,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:function(){}},configure:function(t){e.configure(t)},settingsChangeHandler:function(t){var n,i;n=t.Lt.getValue(r.Rt,""),i=t.Lt.getValue(r.It,""),o&&i===o||(u=[],o=i,n&&n.split(",").forEach((function(t){var e=parseInt(t,10);e&&(u[e]=1)}))),e.configure({uploadCadenceInMs:t.Lt.getValue(r.Ot,l)});var s=t.Lt.getValue(r.Ft,"").toString();""!==s&&e.flushAndSetNewEndpoint(s)},getTimeSpentLogging:function(){return e.getTimeSpentLogging()},getUserSessionId:function(){return e.getUserSessionId()},flushAndSetNewEndpoint:function(t,n){e.flushAndSetNewEndpoint(t,n)}}}},9243:function(t,e,n){"use strict";function i(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}n.d(e,{n:function(){return r}});var o=n(7814);function r(){var t=new Uint8Array(31),e=function(t){var e={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){e.crypto=!0;try{return n.getRandomValues(t),e}catch(t){e.exceptions.push("crypto: ".concat(i(t)))}}e.perfNow=o.Xm;for(var r=0;r<t.length;r+=1){try{if(o.Xm){var s=Math.floor(100*window.performance.now())%10;(s<0||s>9)&&(s=0);for(var a=0;a<s;a+=1)Math.random()}}catch(t){e.exceptions.push("Math.random: ".concat(i(t)))}t[r]=Math.floor(16*Math.random())}return e}(t),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var i=15&t[n];return n+=1,("x"===e?i:3&i|8).toString(16)})),e]}},7814:function(t,e,n){"use strict";n.d(e,{Ks:function(){return s},Xm:function(){return o},u3:function(){return r}});var i,o=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function r(){return o?window.performance.now():Date.now()}function s(){if(!i){var t=window.performance;i=o&&t.timing&&t.timing.navigationStart?function(){return Math.round(t.now()+t.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return i()}},960:function(t,e,n){"use strict";n.d(e,{o:function(){return i}});var i,o=n(3731),r=n(9891),s=function(){function t(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return t.prototype.isEventBlocked=function(t){var e=this.blockedEvents.get(t);return!!e&&(Date.now()>=e?(this.unblockEvent(t),!1):(this.aggregateEventCount(t),!0))},t.prototype.blockEvent=function(t,e){var n=Date.now()+e;this.blockedEvents.set(t,n),this.updateEventHitCount(t,0),this.eventDurations.delete(t),this.eventDurationsTotal.delete(t)},t.prototype.unblockEvent=function(t){this.blockedEvents.delete(t)},t.prototype.getEventHitCount=function(t){return this.eventHitCounts.get(t)},t.prototype.updateEventHitCount=function(t,e){this.eventHitCounts.set(t,e)},t.prototype.aggregateEventCount=function(t){var e=this.getEventHitCount(t);"number"==typeof e&&this.updateEventHitCount(t,++e)},t.prototype.getEventDurations=function(t){return this.eventDurations.get(t)},t.prototype.aggregateEventDuration=function(t,e){var n,i=(null!==(n=this.getEventHitCount(t))&&void 0!==n?n:0)+1,o=this.eventDurationsTotal.get(t),s=this.eventDurations.get(t);if(void 0!==s){var a=(0,r.ev)([],s,!0);s[0]>e&&(a[0]=e),s[1]<e&&(a[1]=e);var c=void 0;void 0!==o&&o.length<10?(o.push(e),c=o.reduce((function(t,e){return t+e}),0)/i):(c=s[2]+(e-s[2])/i,this.eventDurationsTotal.delete(t)),a[2]=c,this.eventDurations.set(t,a)}else this.eventDurations.set(t,[e,e,e]),this.eventDurationsTotal.set(t,[e])},t}(),a=function(){function t(t,e,n,i,o){this.healthLogger=t,this.featureConfig=e,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=i,this.kpiSuccessEventBlocker=o}return t.prototype.logKpiUsage=function(e,n,i,o){var r=this.getKpiKey(e+t.USAGE_KPI,null==i?void 0:i.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(i),this.recordKpiUsage(e,n,i,r),0!==o){var s=null!=o?o:3e5;this.kpiUsageEventBlocker.blockEvent(r,s)}return!0},t.prototype.logKpiFailure=function(e,n,i,o,r){var s,a,c,u=this.getKpiKey(e+t.FAILURE_KPI+n,null===(s=null==i?void 0:i.additionalValues)||void 0===s?void 0:s.extendedProperties);if("number"==typeof(null===(a=null==i?void 0:i.additionalValues)||void 0===a?void 0:a.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(u,i.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(e,n,i,u),o&&this.recordQosError(null!==(c=o.errorNameOverride)&&void 0!==c?c:n,o.name,o),0!==r){var l=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(u,l)}return!0},t.prototype.logKpiSuccess=function(e,n,i){var o,r,s=this.getKpiKey(e+t.SUCCESS_KPI,null===(o=null==n?void 0:n.additionalValues)||void 0===o?void 0:o.extendedProperties);if("number"==typeof(null===(r=null==n?void 0:n.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(s,n.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(s))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(e,n,s),0!==i){var a=null!=i?i:3e5;this.kpiSuccessEventBlocker.blockEvent(s,a)}return!0},t.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(e){var n,o=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==e?void 0:e.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(o,i.FailureBased,e);var s=null!==(n=this.featureConfig.vetoPillar)&&void 0!==n?n:this.featureConfig.areaName;s&&t.QOS_PILLARS_LIST.includes(s)&&this.healthLogger.addQosPillar(s),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},t.prototype.recordKpiUsage=function(t,e,n,i){var o;void 0===n&&(n={});var r=(o=n||{}).extendedProperties,s=o.isForAlertableKpi,a=this.createExtendedPropertiesWithMoreFields(r,i);s?this.healthLogger.recordKpiUsageForAlertableKpi(t,this.featureConfig.crewAlias,a):this.healthLogger.recordKpiUsage(t,e,this.featureConfig.crewAlias,a)},t.prototype.getKpiKey=function(t,e){var n=this.getKpiAreaName(e),i=this.getKpiFeatureName(e),o=this.getKpiPivot(e);return"".concat(n,".").concat(i,".").concat(null!=t?t:"").concat(o&&0===o.length?"."+o:"")},t.prototype.getKpiAreaName=function(e){var n,i,o;return null!==(o=null!==(i=null!==(n=null==e?void 0:e.get(t.AREA_NAME_COLUMN_KEY))&&void 0!==n?n:this.featureConfig.areaName)&&void 0!==i?i:this.featureConfig.vetoPillar)&&void 0!==o?o:""},t.prototype.getKpiFeatureName=function(e){var n,i;return null!==(i=null!==(n=null==e?void 0:e.get(t.FEATURE_NAME_COLUMN_KEY))&&void 0!==n?n:this.featureConfig.featureName)&&void 0!==i?i:""},t.prototype.getKpiPivot=function(e){var n=null==e?void 0:e.get(t.PIVOT_TYPE_COLUMN_KEY),i=null==e?void 0:e.get(t.PIVOT_VALUE_COLUMN_KEY);return n&&0!==n.length&&i&&0!==i.length?"".concat(n,"=").concat(i):""},t.prototype.recordKpiFailure=function(t,e,n,i){var o;void 0===n&&(n={});var r=(o=n||{}).isIntentional,s=o.isInternal,a=o.additionalValues,c=o.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(a,i);!1===c?this.healthLogger.recordKpiFailure(t,e,r,s,u):this.healthLogger.recordKpiImpliedFailure(t,e,r,s,this.featureConfig.crewAlias,u)},t.prototype.recordKpiSuccess=function(t,e,n){var i;void 0===e&&(e={});var o=(i=e||{}).additionalValues,r=i.hasImpliedUsage,s=this.createAdditionalValuesWithMoreFields(o,n);!1===r?this.healthLogger.recordKpiSuccess(t,s):this.healthLogger.recordKpiImpliedSuccess(t,this.featureConfig.crewAlias,s)},t.prototype.recordQosError=function(t,e,n){void 0===n&&(n={});var i=n.isIntentional,o=n.isInternal,r=n.alertOnPillar,s=n.isSessionEndingError,a=n.additionalValues,c=this.createAdditionalValuesWithMoreFields(a);this.healthLogger.recordQosError(t,[e],i,o,r,s,c)},t.prototype.createExtendedPropertiesWithMoreFields=function(e,n){var i=new Map(e||new Map);if(i.get(t.FEATURE_NAME_COLUMN_KEY)||i.set(t.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(e)),i.set(t.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(i)),i.has(t.SKIP_ARIA_COLUMN_KEY)||i.has("skipAria")||i.set(t.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&n){var o=this.getEventBlocker(n);if(o){var r=o.getEventHitCount(n);if(r){i.set(t.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var s=o.getEventDurations(n);r>1&&s&&i.set(t.AGGREGATED_DURATION_COLUMN_KEY,s.map((function(t){return Math.round(100*t)/100})).toString())}}}return i},t.prototype.createAdditionalValuesWithMoreFields=function(t,e){var n={};return(n=(0,r.pi)({},t)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==t?void 0:t.extendedProperties,e),n},t.prototype.getEventBlocker=function(e){return e.endsWith(t.USAGE_KPI)?this.kpiUsageEventBlocker:e.includes(t.FAILURE_KPI)?this.kpiFailureEventBlocker:e.endsWith(t.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},t.FEATURE_NAME_COLUMN_KEY="FeatureName",t.AREA_NAME_COLUMN_KEY="AreaName",t.AGGREGATED_COUNT_COLUMN_KEY="AggCount",t.AGGREGATED_DURATION_COLUMN_KEY="AggMs",t.SKIP_ARIA_COLUMN_KEY="SkipAria",t.PIVOT_TYPE_COLUMN_KEY="PivotType",t.PIVOT_VALUE_COLUMN_KEY="PivotValue",t.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],t.USAGE_KPI=".Usage",t.SUCCESS_KPI=".Success",t.FAILURE_KPI=".Failure.",t}(),c=function(){function t(e,n,o,s,c){var u,l,h,d=this;this.healthLogger=e,this.featureConfig=n,this.kpiUsageEventBlocker=o,this.kpiFailureEventBlocker=s,this.kpiSuccessEventBlocker=c,this.featureUsageAndHealthLogger=new a(this.healthLogger,this.featureConfig,null!==(u=this.kpiUsageEventBlocker)&&void 0!==u?u:t.kpiUsageBlocker,null!==(l=this.kpiSuccessEventBlocker)&&void 0!==l?l:t.kpiFailureBlocker,null!==(h=this.kpiFailureEventBlocker)&&void 0!==h?h:t.kpiSuccessBlocker),this.executeCallbackWithLogging=function(t,e){var n,o,s,a=function(t){return"VetoFailureLoggingParams".includes(t)};(null==e?void 0:e.kpiUsageLoggingParams)?(o="Usage",s=null==e?void 0:e.kpiUsageLoggingParams):(null==e?void 0:e.kpiSuccessLoggingParams)?(o="UsageWithSuccess",s=null==e?void 0:e.kpiSuccessLoggingParams):(null==e?void 0:e.kpiFailureLoggingParams)?(o="UsageWithFailure",s=null==e?void 0:e.kpiFailureLoggingParams):(o="UsageWithVetoFailure",s=null==e?void 0:e.vetoFailureLoggingParams);var c=null==s?void 0:s.usageName,u=null==s?void 0:s.usageKpiType;d.logKpiUsage({kpiName:c,kpiType:null!=u?u:i.FailureBased});try{null==t||t(),"UsageWithSuccess"===o&&"KpiSuccessLoggingParams".includes(s)&&d.logKpiSuccess({kpiName:c,optionalProperties:s.successOptionalProperties})}catch(t){if("UsageWithFailure"===o&&"KpiFailureLoggingParams".includes(s)||"UsageWithVetoFailure"===o&&a(s)){var l=void 0;a(s)&&(l=(0,r.pi)({name:null!==(n=s.vetoName)&&void 0!==n?n:""},s.vetoOptionalProperties)),d.logKpiFailure({kpiName:s.usageName,errorName:s.failureErrorName,optionalProperties:s.failureOptionalProperties,optionalVeto:l})}throw t}}}return t.getInstance=function(e,n,i,o,r){return new t(e,n,i,o,r)},t.prototype.logKpiUsage=function(t){var e;return!(!t||!t.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(t.kpiName,null!==(e=t.kpiType)&&void 0!==e?e:i.FailureBased,t.optionalProperties,t.blockFutureEmissionDurationInMs)},t.prototype.logKpiFailure=function(t){return!!(t&&t.kpiName&&t.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(t.kpiName,t.errorName,t.optionalProperties,t.optionalVeto,t.blockFutureEmissionDurationInMs)},t.prototype.logKpiSuccess=function(t){return!(!t||!t.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(t.kpiName,t.optionalProperties,t.blockFutureEmissionDurationInMs)},t.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(t){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(t)},t.kpiUsageBlocker=new s,t.kpiFailureBlocker=new s,t.kpiSuccessBlocker=new s,t}(),u=function(){function t(){}return t.prototype.getHealthInstance=function(t){if(t)return o.S9.getInstance().initialize(t),o.S9.getInstance()},t.prototype.getExtendedHealthInstance=function(t,e){if(t&&e)return c.getInstance(t,e)},t}();!function(t){t[t.FailureBased=0]="FailureBased",t[t.SuccessBased=1]="SuccessBased"}(i||(i={})),new u},3731:function(t,e,n){"use strict";n.d(e,{S9:function(){return h}});var i,o=n(9891);function r(t){if(t){var e={};return t.forEach((function(t,n){n&&(e[n]=t)})),e}}function s(t,e){var n=[],i=new Set;return t.concat(e).forEach((function(t){return i.add(t)})),i.forEach((function(t){return n.push(t)})),n}!function(t){t[t.Failure=0]="Failure",t[t.ImpliedUsageFailure=1]="ImpliedUsageFailure",t[t.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",t[t.Success=3]="Success",t[t.Usage=4]="Usage"}(i||(i={}));var a,c,u,l=n(960);!function(t){t[t.BSqmError=0]="BSqmError",t[t.Kpi=1]="Kpi",t[t.QosError=2]="QosError",t[t.QosPillar=3]="QosPillar",t[t.DiagnosticLog=4]="DiagnosticLog",t[t.OfflineWorkerInit=5]="OfflineWorkerInit",t[t.OfflineWorkerFlush=6]="OfflineWorkerFlush",t[t.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(a||(a={})),function(t){t[t.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",t[t.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",t[t.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",t[t.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",t[t.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(c||(c={})),function(t){t[t.SendSucceeded=0]="SendSucceeded",t[t.SendFailed=1]="SendFailed",t[t.DidNotAttempt=2]="DidNotAttempt"}(u||(u={}));var h=function(){function t(){var t=this;this.Wt={},this.jt={},this.Gt=[],this.Kt={},this.zt=0,this.$t={Vt:3e5,Jt:!1,Qt:!1,Xt:!1,Yt:3e4,Zt:25,te:"",ee:864e5,ne:"",ie:"",oe:3,re:3,se:15e3,ae:new Set},this.ce=!1,this.ue=-1,this.le=!1,this.he=0,this.de=!0,this.fe=function(){return!1},this.pe={},this.ve=[],this.me=0,this.ge=0,this.we=void 0,this.ye=[],this._e=[],this.Se=[],this.ke=[],this.Te=0,this.be=0,this.Ae=0,this.Ie=[],this.Re=!1,this.Ee=0,this.Ne=!1,this.Pe=function(){t.Te&&(window.clearTimeout(t.Te),t.Te=0)},this.He=function(){t.ve=[],t.ye=[],t._e=[],t.we=void 0,t.Se=[],t.ke=[],t.me=0,t.ge=0},this.Oe=function(){try{if(t.me<=0)return;var e=t.Ue();t.Me(e,t.zt,t.$t.re),t.He()}catch(t){}},this.Ue=function(){return{d:t.Kt,a:t.De(),b:t.ve,e:t._e,h:t.we,q:t.Se,k:t.ye,l:t.ke,type:"h_v2"}},this.De=function(){return t.$t.Xt&&(t.ve&&t.ve.length>0||t._e&&t._e.length>0)&&Object.keys(t.jt).length>0?(0,o.pi)((0,o.pi)({},t.Wt),t.jt):t.Wt},this.Fe=function(e,n,i,o){var r;if(void 0===o&&(o=!1),n&&!t.$t.ae.has(i))if(t.de){switch(e){case a.BSqmError:t.ve.push(n);break;case a.Kpi:t.ye.push(n);break;case a.QosError:t._e.push(n);break;case a.QosPillar:-1===t.Se.map((function(t){return t.n})).indexOf(n.n)&&t.Se.push(n);break;case a.DiagnosticLog:t.ke.push(n)}if(t.me+=1,e!==a.DiagnosticLog&&e!==a.QosPillar&&(t.ge+=1),t.fe()&&!o)return void t.Oe();t.me>=t.$t.Zt&&(t.Pe(),t.xe())}else n.o=(new Date).toJSON(),null===(r=t.qe)||void 0===r||r.postMessage({t:e,k:"".concat(t.Kt.w,".").concat(t.zt),m:t.Kt,c:t.De(),v:n})},this.Be=function(){t.Pe(),t.Te=window.setTimeout((function(){t.xe()}),t.$t.Yt)},this.xe=function(e){void 0===e&&(e=!1),e&&t.ge<=0||(t.Oe(),t.Be())},this.Le=function(){if(t.Ie||t.pe){t.we&&-1!==t.ue||(t.ue=(t.ue+1)%1e3),t.we||(t.me+=1);var e={p:t.we?s(t.we.p,t.Ie):t.Ie,k:t.we?s(t.we.k,t.Gt):t.Gt,i:t.$t.Vt,o:t.ue};t.we=e}},this.We=function(e,n,i,o,s,c,u,l,h,d){if(e&&(!n||t.pe[e])){n||t.je(e,l,h,d);var f=t.pe[e],p={n:f.k,e:i,t:f.t,a:f.a,f:f.o,d:null==o?void 0:o.durationMs,p:r(null==o?void 0:o.extendedProperties)};if(s){var v={n:s,x:u,z:c};p.k=v}t.Fe(a.Kpi,p,e)}},this.Ke=function(){var e,n,i,o,r,s,a,c,u,l,h,d,f,p,v,m,g,w,y,_,C,S,k,T,b,A,I,R,E,N,P,H,O,U,M,D,F,x=t.$t.Kt;x&&(t.Kt={a:null!==(e=x.application)&&void 0!==e?e:void 0,b:null!==(n=x.applicationLcid)&&void 0!==n?n:void 0,c:null!==(i=x.applicationMode)&&void 0!==i?i:void 0,d:null!==(o=x.applicationModeExtended)&&void 0!==o?o:void 0,e:null!==(r=x.arrVersion)&&void 0!==r?r:void 0,f:null!==(s=x.browser)&&void 0!==s?s:void 0,g:null!==(a=x.browserLcid)&&void 0!==a?a:void 0,h:null!==(c=x.browserMajorVersion)&&void 0!==c?c:void 0,i:null!==(u=x.browserVersion)&&void 0!==u?u:void 0,j:null!==(l=x.clientVersion)&&void 0!==l?l:void 0,k:null!==(h=x.datacenter)&&void 0!==h?h:void 0,l:null!==(d=x.dataCulture)&&void 0!==d?d:void 0,m:null!==(f=x.flightsImpressionId)&&void 0!==f?f:void 0,n:null!==(p=x.host)&&void 0!==p?p:void 0,o:null!==(v=x.isAnonymousUser)&&void 0!==v?v:void 0,p:null!==(m=x.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(g=x.isEduUser)&&void 0!==g?g:void 0,r:null!==(w=x.isSynthetic)&&void 0!==w?w:void 0,s:null!==(y=x.loggableUserId)&&void 0!==y?y:void 0,t:null!==(_=x.loggableUserIdSpace)&&void 0!==_?_:void 0,u:null!==(C=x.ring)&&void 0!==C?C:void 0,v:null!==(S=x.serverDocId)&&void 0!==S?S:void 0,w:null!==(k=x.session_id)&&void 0!==k?k:void 0,x:null!==(T=x.sessionOrigin)&&void 0!==T?T:void 0,y:null!==(b=x.tenantId)&&void 0!==b?b:void 0,z:null!==(A=x.uiHost)&&void 0!==A?A:void 0,aa:null!==(I=x.wfeVersion)&&void 0!==I?I:void 0,ab:null!==(R=x.fileExtension)&&void 0!==R?R:void 0,ac:null!==(E=x.uiHostIntegrationType)&&void 0!==E?E:void 0,ad:null!==(N=x.osVersion)&&void 0!==N?N:void 0,af:null!==(P=x.networkDownlink)&&void 0!==P?P:void 0,ag:null!==(H=x.networkDownlinkMax)&&void 0!==H?H:void 0,ah:null!==(O=x.networkEffectiveType)&&void 0!==O?O:void 0,ai:null!==(U=x.networkRTT)&&void 0!==U?U:void 0,aj:null!==(M=x.networkSaveData)&&void 0!==M?M:void 0,ak:null!==(D=x.networkType)&&void 0!==D?D:void 0,al:null!==(F=x.userLicenseType)&&void 0!==F?F:void 0})},this.ze=function(){t.Le(),t.he=window.setTimeout((function(){t.ze()}),t.$t.Vt)},this.$e=function(){t.Ie&&t.Ie.forEach((function(e){e&&t.Ve(e,!0)}))},this.Ve=function(e,n){var i={};i.n=e,t.Fe(a.QosPillar,i,e,n)},this.Je=function(){t.Ie&&(t.be=Date.now(),t.$e()),t.Qe()},this.Qe=function(e){void 0===e&&(e=t.$t.ee),t.Ae=window.setTimeout((function(){t.Je()}),e)},this.Xe=function(){t.ce||(t.ce=!0,t.le=!0,t.ze())},this.Ye=function(){0!==t.Ae&&(window.clearTimeout(t.Ae),t.Ae=0)},this.Ze=function(){if(t.$t.Jt&&t.$t.Qt&&t.$t.ie&&""!==t.$t.ie&&t.$t.te&&""!==t.$t.te)try{if("undefined"==typeof Worker)return void t.tn(1);if(!t.$t.te)return void t.tn(2);t.tn(3);var e=new Blob(["try{importScripts('".concat(encodeURI(t.$t.te),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});t.qe=new Worker(URL.createObjectURL(e)),t.qe.onmessage=function(e){try{var n=e.data;t.tn(n.i,n.r)}catch(e){t.tn(5,e.toString())}},t.qe.postMessage({t:a.OfflineWorkerInit,v:t.$t.ie}),t.qe.postMessage({t:a.OfflineWorkerFlush})}catch(e){t.tn(6,e.toString())}},this.en=function(e,n){var i;if(e.b.length>0||e.e.length>0||e.q.length>0||e.k.length>0||e.l.length>0)try{return null===(i=t.qe)||void 0===i||i.postMessage({t:a.OfflineWorkerFailedUpload,k:"".concat(e.d.w,".").concat(n),v:e}),u.SendSucceeded}catch(e){var o=t.nn(e);return t.tn(15,o),u.SendFailed}return u.DidNotAttempt},this.je=function(e,n,i,o){e&&void 0!==n&&(t.pe[e]||(t.pe[e]={k:e,t:n,a:!0===i,o:null!=o?o:void 0},i&&(t.Gt.push(e),t.Le())))},this.rn=function(e){t.ue=-1,e?(t.be=Date.now(),t.Qe(),t.Xe()):t.Le()},this.sn=function(e){return!!t.Ne||(t.tn(0,null==e?void 0:e.toString()),!1)},this.Me=function(e,n,i){if(e){var r=t.$t.ne;if(t.Re&&(i<=0||!t.de)&&t.en(e,n)!==u.SendFailed)return;if(!(i<=0)){var s=t.an(e,!1);if(null!==s){if(t.fe())try{if(void 0!==navigator.sendBeacon){if(s.length>=65536&&t.$t.Xt){var a=(0,o.pi)((0,o.pi)({},e),{a:t.Wt}),c=t.an(a,!0);if(null===c)return;navigator.sendBeacon(r,c)}else navigator.sendBeacon(r,s);return}}catch(t){}var l=new XMLHttpRequest;l.open("POST",r,!0),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?t.Re||(t.Re=!0):t.Ee<t.$t.oe?(t.Ee+=1,window.setTimeout((function(){t.Ee-=1,t.Me(e,n,i-1)}),t.$t.se)):t.Re&&t.en(e,n))},l.send(s)}}}},this.tn=function(e,n){var i={i:e,r:n};t.Fe(a.DiagnosticLog,i,e.toString())},this.nn=function(t){var e=void 0;return"string"==typeof t?e=t:t instanceof Error&&(e=t.name+" "+t.message,t.stack&&(e+=" "+t.stack)),e},this.an=function(e,n){try{return o=e,JSON.stringify(o)}catch(e){var i=t.nn(e);return i="ModifiedPayload: "+n+" | "+i,t.tn(16,i),null}var o}}return t.getInstance=function(){return t.cn||(t.cn=new t),this.cn},t.prototype.initialize=function(t){if(t)try{return this.$t=function(t){var e,n,i,o,r,s,a,c,u,l,h,d,f,p,v;return{Kt:null!==(e=t.dimensions)&&void 0!==e?e:void 0,Vt:null!==(n=t.heartbeatIntervalMs)&&void 0!==n?n:3e5,Jt:null!==(i=t.isHealthEnabled)&&void 0!==i&&i,Qt:null!==(o=t.isOfflineEnabled)&&void 0!==o&&o,Xt:null!==(r=t.isErrorPartCEnabled)&&void 0!==r&&r,Yt:null!==(s=t.loggerMaxIntervalMs)&&void 0!==s?s:3e4,Zt:null!==(a=t.loggerMaxQueueSize)&&void 0!==a?a:25,te:null!==(c=t.offlineWorkerUrl)&&void 0!==c?c:"",ie:null!==(u=t.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==u?u:"",ee:null!==(l=t.recordPillarToWarmPipelineIntervalMs)&&void 0!==l?l:864e5,ne:null!==(h=t.remoteTelemetryUrl)&&void 0!==h?h:"",oe:null!==(d=t.maxConcurrentRetries)&&void 0!==d?d:3,re:null!==(f=t.retryMaxAttempts)&&void 0!==f?f:3,se:null!==(p=t.retryDelayMs)&&void 0!==p?p:15e3,ae:null!==(v=t.disabledHealthEvents)&&void 0!==v?v:new Set}}(t),this.Ke(),this.Be(),this.Ze(),this.Ne=!0,void this.tn(7)}catch(t){}this.Ne=!1},t.prototype.addOrUpdatePartCDimension=function(t,e){this.sn(c.AttemptedToAddOrUpdatePartCDimension)&&t&&(this.Wt.hasOwnProperty(t)&&this.Wt[t]===e||(this.xe(!0),this.Wt[t]=e,this.zt+=1,this.Le(),this.$e()))},t.prototype.addOrUpdateErrorPartCDimension=function(t,e){this.$t.Xt&&t&&(this.jt[t]=e)},t.prototype.addQosPillar=function(t){if(t){var e=0===this.Ie.length;-1===this.Ie.indexOf(t)&&(this.Ie.push(t),this.Ve(t,!1),this.rn(e))}},t.prototype.recordBsqmQosError=function(t,e,n){if(this.sn(c.AttemptedToRecordBSqmQosError)&&(this.un(!1),this.$e(),t)){var i={b:t,v:e,d:null==n?void 0:n.durationMs,p:r(null==n?void 0:n.extendedProperties),s:this.Ie,i:null==n?void 0:n.inStaging};this.Fe(a.BSqmError,i,t),this.shutdown(!0)}},t.prototype.recordKpiFailure=function(t,e,n,o,r){this.We(t,!0,i.Failure,r,e,o,n)},t.prototype.recordKpiImpliedFailure=function(t,e,n,o,r,s){this.We(t,!1,i.ImpliedUsageFailure,s,e,o,n,l.o.FailureBased,!1,r)},t.prototype.recordKpiImpliedSuccess=function(t,e,n){this.We(t,!1,i.ImpliedUsageSuccess,n,void 0,void 0,void 0,l.o.FailureBased,!1,e)},t.prototype.recordKpiSuccess=function(t,e){this.We(t,!0,i.Success,e)},t.prototype.recordKpiUsage=function(t,e,n,o){this.We(t,!1,i.Usage,{extendedProperties:o},void 0,void 0,void 0,e,!1,n)},t.prototype.recordKpiUsageForAlertableKpi=function(t,e,n){if(t){var o=!0,r=this.pe[t];r&&(o=r.t===l.o.FailureBased),this.We(t,!1,i.Usage,{extendedProperties:n},void 0,void 0,void 0,l.o.FailureBased,!0,e),o&&this.Xe()}},t.prototype.recordQosError=function(t,e,n,i,o,s,u){if((!s||this.sn(c.AttemptedToRecordSessionEndingQosError))&&t&&e){var l={n:t,x:n,z:i,l:o,v:e,e:s,d:null==u?void 0:u.durationMs,p:r(null==u?void 0:u.extendedProperties),s:this.Ie,i:null==u?void 0:u.inStaging};this.Fe(a.QosError,l,t),s&&(this.un(!1),this.$e(),this.shutdown(!0))}},t.prototype.removeQosPillar=function(t){if(t){var e=this.Ie.indexOf(t);e>-1&&(this.Ie.splice(e,1),this.rn(!1)),0===this.Ie.length&&this.Ye()}},t.prototype.resumeAllHealthTimers=function(){if(this.ce&&!this.le&&this.ze(),0===this.Ae&&0!==this.be){var t=Date.now()-this.be;t>=this.$t.ee||t<=0?this.Je():this.Qe(this.$t.ee-t)}},t.prototype.setHandlerForIsAppShuttingDown=function(t){t&&(this.fe=t)},t.prototype.setIsAppOnline=function(t){var e;this.sn(c.AttemptedToSetAppOnlineStatus)&&(!this.de&&t&&(null===(e=this.qe)||void 0===e||e.postMessage({t:a.OfflineWorkerFlush,v:this.fe()})),this.de=t)},t.prototype.shutdown=function(t){var e;void 0===t&&(t=!1),this.$t.Jt&&(this.Pe(),this.un(!1),this.fe=function(){return!0},this.Oe(),(!t||t&&this.de)&&(null===(e=this.qe)||void 0===e||e.terminate()))},t.prototype.stopAllHealthTimers=function(){this.un(!0)},t.prototype.un=function(t){this.le=!1,this.ue=-1,0!==this.he&&(window.clearTimeout(this.he),this.he=0),this.Ye(),t&&this.Oe()},t.prototype.updatePartADimensions=function(t){var e=this;if(t&&this.sn(c.AttemptedToUpdatePartADimensions)){var n=!1;Object.keys(t).forEach((function(i){void 0!==t[i]&&null!==t[i]&&""!==t[i]&&e.$t.Kt[i]!==t[i]&&(e.$t.Kt[i]=t[i],n=!0)})),n&&(this.xe(),this.Ke(),this.zt+=1,this.Le(),this.$e())}},t.prototype.flushAndSetNewEndpoint=function(t,e){var n;t.localeCompare(null!==(n=this.$t.ne)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(this.xe(!1),this.$t.ne=t,e&&e())},t}()},7804:function(t,e,n){"use strict";var i;n.d(e,{W:function(){return i}}),function(t){t[t.ln=0]="msoulscat_ES_EWAJS",t[t.hn=1]="msoulscat_ES_EWAJSGrid",t[t.dn=6]="msoulscat_ES_EWAJSChart",t[t.pn=202]="msoulscat_MSOSP_FileMenuCommands",t[t.vn=225]="msoulscat_MSOSP_OTelJS",t[t.mn=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.gn=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.wn=301]="msoulscat_Wac_WordViewer",t[t.yn=306]="msoulscat_Wac_BrowserGeneral",t[t._n=320]="msoulscat_Wac_TaskPane",t[t.Cn=339]="msoulscat_Wac_OneNoteGeneral",t[t.Sn=340]="msoulscat_Wac_Ribbon",t[t.kn=356]="msoulscat_Wac_WacFeedback",t[t.Tn=379]="msoulscat_Wac_WopiPendingApplication",t[t.bn=383]="msoulscat_Wac_Telemetry",t[t.An=391]="msoulscat_Wac_WacCatchUpActivities",t[t.In=394]="msoulscat_Wac_Dictation",t[t.Rn=395]="msoulscat_Wac_OneNoteSync",t[t.En=700]="msoulscat_Wac_VisioApp",t[t.Nn=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.Pn=800]="msoulscat_Wac_PptAnimation",t[t.Hn=833]="msoulscat_Wac_PptLive",t[t.On=834]="msoulscat_Wac_PptMWeb",t[t.Un=844]="msoulscat_Wac_PptDataSync",t[t.Mn=848]="msoulscat_Wac_PptFluidRuntime",t[t.Dn=815]="msoulscat_Wac_PptShape",t[t.Fn=817]="msoulscat_Wac_PptSession",t[t.xn=830]="msoulscat_Wac_PptSlideshow",t[t.qn=822]="msoulscat_Wac_PptView",t[t.Ln=846]="msoulscat_Wac_PptVideos",t[t.Wn=1303]="msoulscat_Uci_Insights",t[t.jn=2300]="msoulscat_Wac_VersionHistory",t[t.Gn=302]="msoulscat_Wac_WordPresence",t[t.Kn=3e3]="msoulscat_Wac_OAuth",t[t.zn=3005]="msoulscat_Wac_WordVersionHistory",t[t.$n=3006]="msoulscat_Wac_LivePersonaCard",t[t.Vn=3012]="msoulscat_Wac_CatchUpFlyout",t[t.Jn=3016]="msoulscat_Wac_WordDesigner",t[t.Qn=3021]="msoulscat_Wac_ModernFontPicker",t[t.Xn=3027]="msoulscat_Wac_UnifiedUiHost",t[t.Yn=3033]="msoulscat_Wac_EquationTools",t[t.Zn=1401]="msoulscat_Osf_Latency",t[t.ti=1402]="msoulscat_Osf_Notification",t[t.ni=1403]="msoulscat_Osf_Runtime",t[t.ii=3041]="msoulscat_Wac_AiMaker",t[t.oi=3043]="msoulscat_Wac_AiRewrite",t[t.ri=3044]="msoulscat_Wac_AiInsert",t[t.si=3047]="msoulscat_Wac_AiSummarize",t[t.ci=3048]="msoulscat_Wac_CopilotCompose",t[t.li=3049]="msoulscat_Wac_Skittles"}(i||(i={}))},6322:function(t,e,n){"use strict";var i;n.d(e,{G:function(){return i}}),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Important=20]="Important",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(i||(i={}))},2504:function(t,e,n){"use strict";n.d(e,{o:function(){return a}});var i=n(7804),o=n(6322),r=n(7450),s=n(5623);function a(t,e,n,c,u,l,h){void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===l&&(l=1),void 0===h&&(h=!1);var d=(0,s.a)();return(0,s.l)("wopiDataStartTime"),e(t,c,u,n).then((function(e){var a,c,u,l;if(!e){var h="Graph call failed";return null==n||n.ULS.sendTraceTag(553726284,i.W.Xn,o.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(h,"]")),Promise.reject(h)}var f={docUrl:null!==(a=e.webDavUrl)&&void 0!==a?a:t.docUrl,driveId:null!==(u=null===(c=null==e?void 0:e.parentReference)||void 0===c?void 0:c.driveId)&&void 0!==u?u:t.driveId,docId:null!==(l=null==e?void 0:e.id)&&void 0!==l?l:t.docId,fileName:e.name};null==n||n.ULS.sendTraceTag(553726285,i.W.Xn,o.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!f,"]"));var p=Promise.resolve(f);null==n||n.ULS.sendTraceTag(553726286,i.W.Xn,o.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!p,"]"));var v=(0,r.YI)(e,n);null==n||n.ULS.sendTraceTag(553726287,i.W.Xn,o.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!v,"]"));var m={startTime:d,endTime:(0,s.a)()};return(0,s.l)("wopiDataEndTime"),{fetchedDocumentIdentifier:p,wopiHostData:v,fetchDiagnostics:m}})).catch((function(r){var s;return null==n||n.ULS.sendTraceTag(520729472,i.W.Xn,o.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),l>0&&(null==r?void 0:r.retry)?(null==n||n.ULS.sendTraceTag(544306772,i.W.Xn,o.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),new Promise((function(t){var e=function(t){if(0===t)throw new Error("Retry count should not be 0");return 1===t?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(l);setTimeout(t,e),null==n||n.ULS.sendTraceTag(508035599,i.W.Xn,o.G.Warning,"GetWopiData: Retrying getWopiData with ".concat(l," retries left. Delaying retry for ").concat(e,"ms."))})).then((function(){return a(t,e,n,c,u,l-1)})).catch((function(t){return null==n||n.ULS.sendTraceTag(508035598,i.W.Xn,o.G.Error,"GetWopiData: Failed to delay retry getWopiData. [Error: ".concat(t.message,"]")),Promise.reject(t)}))):l>0&&h&&"accessDenied"===(null==r?void 0:r.errorCode)?new Promise((function(t){setTimeout(t,3e3),null==n||n.ULS.sendTraceTag(523269073,i.W.Xn,o.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]"))})).then((function(){return a(t,e,n,c,u,0)})):(null==n||n.ULS.sendTraceTag(544306773,i.W.Xn,o.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][ShouldRetry: ").concat(l>0,"][FailureReason: ").concat(null!==(s=null==r?void 0:r.failure)&&void 0!==s?s:null==r?void 0:r.message,"]")),Promise.reject(r))}))}},7450:function(t,e,n){"use strict";n.d(e,{YI:function(){return c},q_:function(){return a}});var i=n(9891),o=n(7804),r=n(6322),s=n(6640);function a(t){return t.shareUrl?t.shareUrl:t.docId&&t.driveId?"".concat(t.driveId,"_").concat(t.docId):t.docUrl?t.docUrl:t.isNewFile&&t.fileName?"".concat(t.fileName,"_").concat(s.T[t.fileType]):t.baseUrl&&t.fileId?"".concat(t.baseUrl,"_").concat(t.fileId):void 0}function c(t,e){var n,s,a,c,u,l,h,d,f,p=!!(null==t?void 0:t.openWith),v=!!(null===(n=null==t?void 0:t.openWith)||void 0===n?void 0:n.wac);return null==e||e.ULS.sendTraceTag(553916429,o.W.Xn,r.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(p,"][ValidWac: ").concat(v,"]")),{bundleStaleness:t.officeBundle?t.officeBundle.bundleStaleness:0,bundleUrl:t.officeBundle?t.officeBundle.url:"",bundleVersion:t.officeBundle?t.officeBundle.version:"",sharepointSiteUrl:t.sharepointIds?t.sharepointIds.siteUrl:"",downloadUrl:t["@content.downloadUrl"]||t["@microsoft.graph.downloadUrl"],eTag:t.eTag,fileName:t.name,fileSize:t.size,irmEnabled:(null===(s=t.file)||void 0===s?void 0:s.contentSensitivityLabelProtected)||(null===(a=t.file)||void 0===a?void 0:a.irmEffectivelyEnabled)||(null===(c=t.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(u=t.file)||void 0===u?void 0:u.irmEnabled),protectionEnabled:(null===(l=t.sensitivityLabel)||void 0===l?void 0:l.protectionEnabled)||(null===(h=t.file)||void 0===h?void 0:h.contentSensitivityLabelProtected),isNewFile:!1,readOnly:t.currentUserRole&&t.currentUserRole.readOnly,blocksDownload:t.currentUserRole&&t.currentUserRole.blocksDownload,wac:t.openWith.wac,sharePointInfo:(0,i.pi)({},t.sharepointIds),webUrl:t.webUrl,preSeededSessionKey:null===(d=null==t?void 0:t.wacSession)||void 0===d?void 0:d.preSeededSessionKey,preSeededWacSessionId:null===(f=null==t?void 0:t.wacSession)||void 0===f?void 0:f.preSeededWacSessionId,webDavUrl:t.webDavUrl}}},9804:function(t,e,n){"use strict";n.d(e,{R:function(){return a}});var i,o=n(7804),r=n(6322),s=n(7040);function a(t,e,n,a,c){if(a){var u=function(t){switch(t){case s.KX.PostMessage_RefreshSessionInfo:return i.sendSessionInfo;case s.KX.PostMessage_GrantPermissions:return i.sendUserAccessAndPermissions;case s.KX.PostMessage_SetAuthToken:return i.sendAuthToken;case s.KX.PostMessage_HostAccessibilityLoopComplete:return i.continueAccessibilityLoop;case s.KX.PostMessage_SetHostWopiInfoFromUrl:return i.sendWopiInfo;case s.KX.PostMessage_MoveToFolderCompleted:return i.moveToFolder;case s.KX.PostMessage_CompleteFilePicker:return i.completeSharedFilePicker;case s.KX.PostMessage_SendCustomAuthConfig:return i.sendCustomAuthConfig;case s.KX.PostMessage_SetDavUrlFromIds:return i.sendDavUrl;case s.KX.PostMessage_BlurFocus:return i.blurFocus;case s.KX.PostMessage_PopState:return i.popState;case s.KX.PostMessage_GrabFocus:return i.grabFocus;case s.KX.PostMessage_HostGetClientUrl:return i.getClientUrl;case s.KX.PostMessage_HostGetWebUrl:return i.getWebUrl;case s.KX.PostMessage_OwlFrameDiagnostics:return i.sendOwlFrameDiagnostics;case s.KX.PostMessage_HostBackButtonPressed:return i.backButtonPressed;case s.KX.PostMessage_HostSendChannelId:return i.sendChannelId;case s.KX.PostMessage_HostSendConversationId:return i.sendConvId;default:return}}(t);if(u){var l=u;a.run(l,e).catch((function(t){return null==c?void 0:c.ULS.sendTraceTag(512337544,o.W.Xn,r.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(t))}))}}else n?n.then((function(n){n?function(t,e,n,i){var s,a=null;try{a=new URL(t)}catch(e){return void(null==i||i.ULS.sendTraceTag(541180047,o.W.Xn,r.G.Warning,"Failed to send post message. could not create url from ".concat(t," with error: ").concat(e)))}var c=a.origin,u={MessageId:e,SendTime:(new Date).getTime(),Values:n},l=JSON.stringify(u),h=document.getElementById("WebApplicationFrame");h?null===(s=null==h?void 0:h.contentWindow)||void 0===s||s.postMessage(l,c):null==i||i.ULS.sendTraceTag(541180048,o.W.Xn,r.G.Warning,"Failed to send post message. Could not find iframe")}(n,t,e,c):null==c||c.ULS.sendTraceTag(541180045,o.W.Xn,r.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(t){return null==c?void 0:c.ULS.sendTraceTag(512337543,o.W.Xn,r.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(t))})):null==c||c.ULS.sendTraceTag(541180046,o.W.Xn,r.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}!function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.moveToFolder="moveToFolder",t.popState="popState",t.sendChannelId="sendChannelId",t.sendConvId="sendConvId",t.teamsUsersReply="teamsUsersReply",t.teamsUserMentionReply="teamsUserMentionReply",t.backButtonPressed="backButtonPressed",t.getClientUrl="getClientUrl",t.getWebUrl="getWebUrl",t.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",t.rename="rename",t.completeSharedFilePicker="completeSharedFilePicker",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendFrameTrustResult="sendFrameTrustResult",t.sendHWRTelemetry="sendHWRTelemetry",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.sendDavUrl="sendDavUrl",t.switchMode="switchMode",t.signalShared="signalShared"}(i||(i={}))},8980:function(t,e,n){"use strict";var i;function o(t){var e=t.toUpperCase();return"CHC"===e||"DEC"===e||"EUC"===e||"EURPPC"===e||"FRC"===e||"SEC"===e||"NOC"===e?i.EuropeanUnion:i.RestOfWorld}n.d(e,{U:function(){return i},g:function(){return o}}),function(t){t[t.RestOfWorld=0]="RestOfWorld",t[t.EuropeanUnion=1]="EuropeanUnion"}(i||(i={}))},501:function(t,e,n){"use strict";n.d(e,{A8:function(){return c},PO:function(){return u},S$:function(){return s},XQ:function(){return a},Y6:function(){return h},fy:function(){return r},tf:function(){return d},w8:function(){return l},wl:function(){return o}});var i=n(8980);function o(t,e){switch(t){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return e===i.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(t,e){return o(t,e)+"RemoteUls.ashx"}function s(t,e,n){var i=o(t,n)+"RemoteTelemetry.ashx";return e&&(i+="?usid="+e),i}function a(t,e){return"".concat(o(t),"OpenDocument.ashx").concat(e?"?corrid=".concat(e,"&usid=").concat(e):"")}function c(t){switch(t){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function u(t){switch(t){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud";default:return"https://www.odwebp.svc.ms/share"}}function l(){return"res.cdn.office.net/officehub"}function h(){return"https://microsoft-my.sharepoint.com"}function d(){return"https://microsoft.sharepoint.com"}},269:function(t,e,n){"use strict";var i;n.d(e,{W:function(){return i}}),function(t){t[t.Unknown=0]="Unknown",t[t.OK=200]="OK",t[t.Created=201]="Created",t[t.NoContent=204]="NoContent",t[t.Unauthorized=401]="Unauthorized",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.RequestTimeout=408]="RequestTimeout",t[t.RequestEntityTooLarge=413]="RequestEntityTooLarge",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.Locked=423]="Locked",t[t.Throttled=429]="Throttled",t[t.InternalServiceError=500]="InternalServiceError",t[t.NotImplemented=501]="NotImplemented",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.UnexpectedResponse=700]="UnexpectedResponse",t[t.TokenRefreshFailed=701]="TokenRefreshFailed",t[t.TokenUnavailable=702]="TokenUnavailable",t[t.RetryFailed=703]="RetryFailed",t[t.AlternateResponse=704]="AlternateResponse",t[t.Cancelled=705]="Cancelled",t[t.Offline=706]="Offline",t[t.Timeout=707]="Timeout",t[t.DecryptionError=708]="DecryptionError",t[t.CacheMiss=709]="CacheMiss"}(i||(i={}))},7040:function(t,e,n){"use strict";var i,o,r,s,a,c;n.d(e,{Bn:function(){return a},Dm:function(){return o},E_:function(){return i},KX:function(){return s}}),function(t){t.Event_DocumentReboot="DocReboot",t.Event_SetOverlayContent="SetOverlayContent",t.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",t.Event_Unloaded="Unloaded",t.Event_MoveToFolder="MoveToFolder",t.Event_SharedFilePicker="FilePicker",t.Event_GetCustomAuthConfig="GetCustomAuthConfig",t.Event_GetDavUrlFromIds="DavUrlFromIds"}(i||(i={})),function(t){t.PostMessage_FileRenamed="File_Rename",t.PostMessage_Close="UI_Close",t.PostMessage_EditModeSwitch="UI_Edit",t.PostMessage_FileVersion="UI_FileVersions",t.PostMessage_SaveStatus="UI_SaveStatus",t.PostMessage_Share="UI_Sharing",t.PostMessage_Workflow="UI_Workflow",t.PostMessage_UserActivity="User_Activity",t.PostMessage_EditNotification="Edit_Notification",t.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",t.PostMessage_PostMessageDocReboot="App_DocReboot",t.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",t.PostMessage_AppCreateNewDocument="App_CreateNewDocument",t.PostMessage_GetAuthToken="App_GetAuthToken",t.PostMessage_NavigateBackToHost="NavigateBackToHost",t.PostMessage_SendConversationId="App_SendConversationId",t.PostMessage_CloseTeamsConversation="CloseTeamsConversation",t.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",t.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",t.PostMessage_LoadingStatus="App_LoadingStatus",t.PostMessage_ActionComplete="Wac_ActionComplete",t.PostMessage_OpenInBrowser="UI_OpenInBrowser",t.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",t.PostMessage_AppPushState="App_PushState",t.PostMessage_CAAEMessage="CAAEMessage",t.PostMessage_FileEmbed="UI_FileEmbed"}(o||(o={})),function(t){t.Nav="actnavid"}(r||(r={})),function(t){t.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",t.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",t.PostMessage_SetOverlayContent="SetOverlayContent",t.PostMessage_SetAuthToken="Host_SetAuthToken",t.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",t.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",t.PostMessage_HostGetClientUrl="Host_GetClientUrl",t.PostMessage_HostGetWebUrl="Host_GetWebUrl",t.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",t.PostMessage_CompleteFilePicker="Host_FilePicker",t.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",t.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",t.PostMessage_BlurFocus="Blur_Focus",t.PostMessage_PopState="App_PopState",t.PostMessage_GrabFocus="Grab_Focus",t.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics",t.PostMessage_HostSendChannelId="Host_SendChannelId",t.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",t.PostMessage_HostSendConversationId="Host_SendConversationId"}(s||(s={})),function(t){t.SameDocument="0",t.NewDocument="1"}(a||(a={})),function(t){t.AccessToken="AccessToken",t.FileGetUrl="FileGetUrl"}(c||(c={}))},3727:function(t,e,n){"use strict";n.d(e,{G2:function(){return a},pb:function(){return u},vb:function(){return l},zP:function(){return c}});var i=n(9891),o=n(7937),r=n(3731),s=n(501),a=function(){function t(t,e){var n;"string"==typeof t?this.sessionId=t:(n=(0,i.CR)(t,1),this.sessionId=n[0]),this.environment=e,this.logger=this.setUlsLogger(this.sessionId)}return t.prototype.setUlsLogger=function(t){var e=(0,s.fy)(this.environment);return(0,o.L8)({remoteUlsEndpoint:e,sessionId:t})},t}(),c=function(t,e,n,i,o,a){var c,u=(0,s.S$)(n,t),l={application:e.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:t,clientVersion:null!=i?i:"n/a",isSynthetic:a};this.health=r.S9.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:u,dimensions:l}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",e.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",n.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(c=null==o?void 0:o.toString())&&void 0!==c?c:"n/a")};function u(){var t,e=null===(t=performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();return{connectEnd:e.connectEnd,connectStart:e.connectStart,decodedBodySize:e.decodedBodySize,domainLookupEnd:e.domainLookupEnd,domainLookupStart:e.domainLookupStart,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,duration:e.duration,encodedBodySize:e.encodedBodySize,entryType:e.entryType,fetchStart:e.fetchStart,initiatorType:e.initiatorType,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,nextHopProtocol:e.nextHopProtocol,redirectCount:e.redirectCount,redirectEnd:e.redirectEnd,redirectStart:e.redirectStart,requestStart:e.requestStart,responseEnd:e.responseEnd,responseStart:e.responseStart,secureConnectionStart:e.secureConnectionStart,serverTiming:e.serverTiming,startTime:e.startTime,transferSize:e.transferSize,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart,workerStart:e.workerStart}}function l(){var t=window.performance.timing,e=window.performance.navigation,n={};return t&&(n.timing={navigationStart:t.navigationStart,redirectStart:t.redirectStart,redirectEnd:t.redirectEnd,fetchStart:t.fetchStart,domainLookupStart:t.domainLookupStart,domainLookupEnd:t.domainLookupEnd,connectStart:t.connectStart,connectEnd:t.connectEnd,secureConnectionStart:t.secureConnectionStart,requestStart:t.requestStart,responseStart:t.responseStart,responseEnd:t.responseEnd,domLoading:t.domLoading,domInteractive:t.domInteractive,domContentLoadedEventStart:t.domContentLoadedEventStart,domContentLoadedEventEnd:t.domContentLoadedEventEnd,domComplete:t.domComplete,loadEventStart:t.loadEventStart,loadEventEnd:t.loadEventEnd}),e&&(n.navigation={type:e.type,redirectCount:e.redirectCount}),n}},4883:function(t,e,n){"use strict";var i,o,r,s,a,c;n.d(e,{$c:function(){return i},AU:function(){return a},DG:function(){return s},I$:function(){return c},J4:function(){return u},NF:function(){return l},c:function(){return h},cS:function(){return r},yv:function(){return o}}),function(t){t.DriveId="drive",t.ItemId="item",t.DocUrl="file",t.ContentUri="contenturi",t.Nav="nav"}(i||(i={})),function(t){t.hi="DavUrlFromIds",t.di="WopiAuthRefresh",t.fi="WopiAuthFetch",t.vi="WopiInfoFromUrl"}(o||(o={})),function(t){t.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",t.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",t.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",t.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",t.QosVeto_FilePickerFailed="FilePickerFailed",t.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",t.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(r||(r={})),function(t){t.QosError_VroomWopiFailure="VroomWopiFailure",t.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",t.QosError_EncounteredJsApiError="EncounteredJsApiError",t.QosError_FailedToLoadDocument="FailedToLoadDocument",t.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",t.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",t.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",t.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",t.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",t.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",t.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",t.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",t.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",t.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",t.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",t.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",t.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",t.QosError_FilePickerBootFailed="FilePickerBootFailed",t.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",t.QosError_SelectedItemNotReturned="SelectedItemNotReturned",t.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",t.QosError_UrlNotProvided="UrlNotProvided",t.QosError_CallbackNotDefined="CallbackNotDefined",t.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(s||(s={})),function(t){t.mi="Bootstrapfile_WacDocumentVroomError",t.gi="LoadDocument_WacDocumentVroomError",t.wi="WacDocumentBootstrapperLoadError",t.yi="WacInitializeWopiPendingError",t._i="WacDocumentGenericBootError",t.Ci="WacDocumentJsApiV1Error",t.Si="WacDocumentJsApiV2Error"}(a||(a={})),function(t){t.PermissionError="PermissionError",t.NotFound="NotFound",t.Throttling="Throttling",t.Offline="Offline",t.Other="Other"}(c||(c={}));var u,l,h={};!function(t){t.New="NEW",t.BackstageMru="BACKSTAGE-MRU",t.Reboot="REBOOT"}(u||(u={})),function(t){t.SharePointOnline="sharepoint",t.OneDriveConsumer="onedrive",t.Graph="graph"}(l||(l={}))},8001:function(t,e,n){"use strict";n.d(e,{Fh:function(){return f},vJ:function(){return g},i0:function(){return w},dt:function(){return m}});var i=n(7804),o=n(6322),r=function(){function t(){}return t.toFeatureGateConfig=function(t,e){if(null==t||""===t||"null"===t)return[];try{return function(t,e,n){return u(t,e,a,n)}(JSON.parse(t),l(h("FeatureGateConfig")),e)}catch(n){return null==e||e.ULS.sendTraceTag(521413921,i.W.Xn,o.G.Error,'Unable to parse JSON string: "'.concat(t,'", due to expection: ').concat(n)),[]}},t.featureGateConfigToJson=function(t,e){return JSON.stringify(function(t,e,n){return u(t,e,c,n)}(t,l(h("FeatureGateConfig")),e),null,2)},t}();function s(t,e,n,r){if(void 0===r&&(r=""),r?null==n||n.ULS.sendTraceTag(521414033,i.W.Xn,o.G.Error,'Invalid value for key "'.concat(r,'". Expected type ').concat(JSON.stringify(t)," but got ").concat(JSON.stringify(e))):null==n||n.ULS.sendTraceTag(521414034,i.W.Xn,o.G.Error,"Invalid value ".concat(JSON.stringify(e)," for type ").concat(JSON.stringify(t))),"boolean"==typeof t){if("string"==typeof e){var s=function(t){try{var e=JSON.parse(t.toLowerCase());return"boolean"==typeof e&&e}catch(t){return!1}}(e);if("boolean"==typeof s)return s}return!1}return"string"==typeof t?"":"number"==typeof t?0:typeof t==typeof[]?[]:"Date"===t?new Date:"array"===t?[]:"object"===t?{}:void 0}function a(t){if(void 0===t.jsonToJS){var e={};t.props.forEach((function(t){return e[t.json]={key:t.js,typ:t.typ}})),t.jsonToJS=e}return t.jsonToJS}function c(t){if(void 0===t.jsToJSON){var e={};t.props.forEach((function(t){return e[t.js]={key:t.json,typ:t.typ}})),t.jsToJSON=e}return t.jsToJSON}function u(t,e,n,i,o){void 0===o&&(o="");var r=e;if("any"===r)return t;if(null===r)return null===t?t:s(r,t,i);if(!1===r)return s(r,t,i);for(;"object"==typeof r&&void 0!==r.ref;)r=p[r.ref];return Array.isArray(r)?function(t,e){return-1!==t.indexOf(e)?e:s(t,e,i)}(r,t):"object"==typeof r?r.hasOwnProperty("unionMembers")?function(t,e){for(var o=t.length,r=0;r<o;r++){var a=t[r];try{return u(e,a,n,i)}catch(t){}}return s(t,e,i)}(r.unionMembers,t):r.hasOwnProperty("arrayItems")?function(t,e){return Array.isArray(e)?e.map((function(e){return u(e,t,n,i)})):s("array",e,i)}(r.arrayItems,t):r.hasOwnProperty("props")?function(t,e,o){if(null===o||"object"!=typeof o||Array.isArray(o))return s("object",o,i);var r={};return Object.getOwnPropertyNames(t).forEach((function(e){var s=t[e],a=Object.prototype.hasOwnProperty.call(o,e)?o[e]:void 0;r[s.key]=u(a,s.typ,n,i,s.key)})),Object.getOwnPropertyNames(o).forEach((function(s){Object.prototype.hasOwnProperty.call(t,s)||(r[s]=u(o[s],e,n,i,s))})),r}(n(r),r.additional,t):s(r,t,i):r===Date&&"number"!=typeof t?function(t){if(null===t)return null;var e=new Date(t);return isNaN(e.valueOf())?s("Date",t,i):e}(t):function(t,e){return typeof t==typeof e?e:s(t,e,i,o)}(r,t)}function l(t){return{arrayItems:t}}function h(t){return{ref:t}}var d,f,p={FeatureGateConfig:(d=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],{props:d,additional:!1})},v=n(8562);function m(t,e,n){null==n||n.ULS.sendTraceTag(521164238,i.W.Xn,o.G.Info,"".concat(t,": ").concat(e?"Enabled":"Disabled"))}function g(t,e){if(!e)return!1;if(!e.has(t))return!1;var n=e.get(t);return null!=n&&"boolean"==typeof n&&n}function w(t,e,n){var s,a=[];null==e||e.ULS.sendTraceTag(522299220,i.W.Xn,o.G.Verbose,'Attempting to parse Feature Gate Config String: "'.concat(t,'"'));try{a=null!==(s=r.toFeatureGateConfig(t,e))&&void 0!==s?s:[]}catch(n){return null==e||e.ULS.sendTraceTag(524814532,i.W.Xn,o.G.Error,'Unable to parse Feature Gate Config string: "'.concat(t,'", due to Exception: ').concat(n)),new Map}null==e||e.ULS.sendTraceTag(522299221,i.W.Xn,o.G.Verbose,"Successfully parsed Feature Gate Config String to JSON: ".concat(JSON.stringify(a)));var c=new Map,u=n;return u=u?null==n?void 0:n.toLocaleLowerCase():"",a.forEach((function(t){var e,n=(null!==(e=t.SettingsRings)&&void 0!==e?e:"").replace(/\s+/g,"").toLocaleLowerCase().split(",");u&&n.includes(u)&&c.set(t.ConfigId,t.IsEnabled)})),null==e||e.ULS.sendTraceTag(522299222,i.W.Xn,o.G.Info,"Successfully filtered Feature Gate Config JSON: ".concat(JSON.stringify(a),", to ring id: ").concat(u,", with result map: ").concat((0,v.z)(c))),c}!function(t){t.FeatureGate_EcsHootGate="EcsHootGate",t.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",t.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",t.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",t.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",t.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",t.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",t.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",t.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",t.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",t.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",t.FeatureGate_ESSForXLGate="ESSForXL",t.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",t.FeatureGate_Locale1JSGate="Locale1JSGate",t.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",t.FeatureGate_EnableOwlFrameExperiment="IsOwlIFrameExperimentEnabled",t.FeatureGate_EnableOwlFrameExperimentTreatment="IsOwlIFrameExperimentTreatment",t.FeatureGate_EnableOwlFrameBoot="IsOwlIFrameBootEnabled",t.FeatureGate_EnableOwlFrameBootTreatment="IsOwlIFrameBootTreatment",t.FeatureGate_Vroom21ForWord="Vroom21ForWord",t.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",t.FeatureGate_ManifestCachingGate="ManifestCachingGate",t.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",t.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled="IsOwlWacOAuthExperimentTreatment"}(f||(f={}))},3159:function(t,e,n){"use strict";n.d(e,{c:function(){return o}});var i=n(5623);function o(){var t=(0,i.a)();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}},8562:function(t,e,n){"use strict";n.d(e,{d:function(){return r},z:function(){return o}});var i=n(9891);function o(t){var e,n,o="{ ";try{for(var r=(0,i.XA)(t.entries()),s=r.next();!s.done;s=r.next()){var a=s.value;o+="{ key: ".concat(a[0],", value: ").concat(a[1]," },")}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return o.substring(0,o.length-1)+" }"}function r(t){var e,n,o={};try{for(var r=(0,i.XA)(t.entries()),s=r.next();!s.done;s=r.next()){var a=(0,i.CR)(s.value,2),c=a[0],u=a[1];o[String(c)]=u}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return JSON.stringify(o)}},7822:function(t,e,n){"use strict";n.d(e,{J:function(){return c}});var i,o,r,s=n(501),a=function(t){var e=document.getElementById("unified-ui-host-config"),n=e&&e.textContent;if(n)return JSON.parse(n)}(),c={version:"v1",officeHomeCdnDomain:null!==(i=null==a?void 0:a.officeHomeCdnDomain)&&void 0!==i?i:(0,s.w8)(),genericFeatureGates:null!==(o=null==a?void 0:a.genericFeatureGates)&&void 0!==o?o:null,deploymentEnvironment:null!==(r=null==a?void 0:a.deploymentEnvironment)&&void 0!==r?r:"Not_specified"}},2560:function(t,e,n){"use strict";n.d(e,{JK:function(){return c},Th:function(){return g},VJ:function(){return r},XU:function(){return a},Y$:function(){return v},aE:function(){return m},bM:function(){return h},gG:function(){return p},k$:function(){return f},o4:function(){return i},pK:function(){return s},sj:function(){return d}});var i,o=n(9891),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,s=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,a=/http[s]?:\/\/d\.docs\.live\.net/,c=/https:\/\/[\S]*?graph\.[\S]/,u="https://graph.microsoft.com",l=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function h(t){if(!t)return"";try{return decodeURIComponent(t)}catch(t){return""}}function d(t){return t?t.substring(0,t.lastIndexOf("/")):""}function f(t){if(t&&t.length){var e=t.match(l);if(e)return{href:t,protocol:e[1],host:e[2],hostname:e[3],port:e[4],path:e[5],search:e[6],hash:e[7]}}}function p(t){if(t&&t.length){if(t.match(s)||t.match(a))return"OneDrive";if(t.match(r))return"SharePoint";if(t.startsWith(u))return"Graph"}}function v(t,e,n){var i=t,r="",s=!0;for(var a in e&&(i=(0,o.pi)((0,o.pi)({},e),i)),i){var c,u=i[a];if(!n||"object"!=typeof u&&u||"object"==typeof u&&u&&u.uriValue||"number"==typeof u||"boolean"==typeof u)s?s=!1:r+="&",c="object"==typeof u&&u&&u.uriValue?u.uriValue:encodeURIComponent("".concat(u)),r+="".concat(a,"=").concat(c)}return r}function m(t){if(t&&t.length){if(t.match(s)||t.match(a))return i.OneDrive;if(t.match(r))return i.SharePoint}}function g(t,e){var n=t.toLowerCase(),i=function(t){var e=f(t);return e&&e.hostname||""}(e),o=function(t){var e=t.toLowerCase();return!e||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e}(i),r=d(e);return 0===n.indexOf("https://")||0===n.indexOf("http://")?n:"/"===n.charAt(0)?"".concat(o).concat(n):"".concat(r,"/").concat(n)}!function(t){t.OneDrive="Documents",t.SharePoint="Sites"}(i||(i={}))},4994:function(t,e,n){"use strict";var i,o,r,s,a;n.d(e,{J7:function(){return i},L5:function(){return r},hx:function(){return o},iz:function(){return s}}),function(t){t.CacheOnly="cache-only",t.NetworkFirst="network-first",t.NetworkOnly="network-only"}(i||(i={})),function(t){t.Delete="DELETE",t.Get="GET",t.Head="HEAD",t.Options="OPTIONS",t.Post="POST",t.Put="PUT",t.Patch="PATCH"}(o||(o={})),function(t){t.CorrelationId="X-OfficeHome-CorrelationId",t.Mock="ohp-mock",t.TestTraffic="X-OfficeHome-TestTraffic"}(r||(r={})),function(t){t.TestTraffic="testtraffic"}(s||(s={})),function(t){t.Json="json",t.Text="text",t.ArrayBuffer="arraybuffer",t.Blob="blob"}(a||(a={}))},9895:function(t,e,n){"use strict";n.d(e,{Ko:function(){return p},sm:function(){return v}});var i=n(9891),o=n(7804),r=n(6322),s=n(9379),a=n.n(s),c=n(269),u=n(4994),l=3e5,h=-1,d=a().create(),f=function(t,e){return e===u.J7.CacheOnly?Promise.reject("Cache unsupported"):Promise.resolve(t)};function p(t,e,n,s,p,v,y,_,C,S,k){void 0===C&&(C={});var T=_;return S===u.J7.CacheOnly&&(T="None"),function(t,e,n,i,s,a,l,h,d,f,p,v){return new Promise((function(g,y){var _=s||"None",C="None"===_||"OfficeHome"===_&&!n,S=d||new Set;S.add(401);var k=function(t){var e=t.status,n=Number.NaN;!C&&S.has(e)?n=c.W.TokenRefreshFailed:f&&f(e)&&(n=c.W.RetryFailed),n!==Number.NaN&&(null==v||v.ULS.sendTraceTag(509723938,o.W.Xn,r.G.Error,"requestWithAuthAndRetry failed with status ".concat(e," and customErrorCode ").concat(n))),y({httpResponse:t})};if(a){var T=w(a);T&&(e.headers||(e.headers={}),e.headers[u.L5.Mock]=T)}(C?Promise.resolve(void 0):i(_,!1,l)).then((function(n){if(!C){if(!n||!n.success){var s=n?n.error:"";return null==v||v.ULS.sendTraceTag(509723937,o.W.Xn,r.G.Error,"requestWithAuthAndRetry failed on get token with error ".concat(s)),void y({httpResponse:{data:"CAP_Error"===s?s:null,status:c.W.TokenUnavailable,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}m(e,n,h,p)}t(e).then(g,(function(n){var s,a;!C&&S.has(n.status)?i(_,!0,l).then((function(i){i.success?(m(e,i,h,p),t(e).then(g,k)):k(n)})).catch((function(t){null==v||v.ULS.sendTraceTag(509723936,o.W.Xn,r.G.Error,"getAccessToken failed with error ".concat(t))})):f&&f(n.status)?(s=e,setTimeout((function(){t(s).then(g,k)}),(a=[0,11,22,33])[Math.floor(1e3*Math.random())%a.length])):y({httpResponse:n})}))})).catch((function(t){null==v||v.ULS.sendTraceTag(509723935,o.W.Xn,r.G.Error,"getAccessToken failed with error ".concat(t))}))}))}((function(t){return function(t,e,n,s,p,v,m,y,_){var C="".concat(e,"/");return t.url.startsWith("http")&&!C.startsWith("http")&&(C="".concat(window.location.origin,"/").concat(C)),0===t.url.lastIndexOf(C,0)&&function(t,e){t.headers||(t.headers={}),t.headers[u.L5.CorrelationId]=e;var n=w(u.iz.TestTraffic);n&&(t.headers[u.L5.TestTraffic]=n)}(t,n),function(t,e,n,s,p,v,m){var w=e===u.J7.CacheOnly,y=function(t,e,n,s,l,p,v){var m=this;return new Promise((function(w,y){return(0,i.mG)(m,void 0,void 0,(function(){var m,_,C,S,k;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(m=n===u.J7.CacheOnly,_={url:t.url,method:t.method,headers:t.headers,params:t.params,data:t.body,timeout:e,responseType:t.responseType,onUploadProgress:s,onDownloadProgress:l},p&&(C=a().CancelToken,S=C.source(),_.cancelToken=S.token,p.onCancel((function(){return S.cancel()})).catch((function(t){null==v||v.ULS.sendTraceTag(509723933,o.W.Xn,r.G.Error,"getResponse failed with error ".concat(t))}))),!f)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f(_,n||u.J7.NetworkOnly)];case 2:return i.sent(),[3,4];case 3:return k=i.sent(),y(g(c.W.NotImplemented,m,k)),[2];case 4:return d.request(_).then((function(t){w({data:t.data,status:t.status,headers:t.headers,ok:!0,statusText:t.statusText,fromCache:m})}),(function(t){a().isCancel(t)?y(g(c.W.Cancelled,m)):"ECONNABORTED"===t.code?y(g(c.W.Timeout,m)):t.response?y({data:t.response.data,status:t.response.status,headers:t.response.headers,ok:!1,statusText:t.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine?y(g(c.W.Offline,m)):y(g(h,m))})),[2]}}))}))}))}(t,v||l,e,n,s,p,m),_=p?p.onCancel((function(){return Promise.resolve(g(c.W.Cancelled,w))})):new Promise((function(){}));return Promise.race([y,_]).catch((function(t){null==m||m.ULS.sendTraceTag(509723934,o.W.Xn,r.G.Error,"requestWithInstrumentation failed with error ".concat(t))})),y}(t,s,p,v,m,y,_)}(t,v,y,S,C.onUploadProgress,C.onDownloadProgress,C.cancellationToken,C.timeoutInMs,k)}),(0,i.pi)((0,i.pi)({},n),{url:t,method:u.hx.Post,body:e}),s,p,T,C.mockParam,C.resourceUrl,C.rpsHeaderPrefix,C.additionalAuthErrors,C.isRetriableError,C.updateRequestWithAuth,k)}function v(t,e,n){var i=e;if(!t||!t.success)return null!=i?i:{};i||(i={});var o="RPSCompact"===t.format?n||"":"Bearer ";return i.Authorization="".concat(o).concat(t.token).trim(),i}function m(t,e,n,i){t&&(t.headers=v(e,t.headers,n),i&&i(t,e))}function g(t,e,n){return{data:void 0,status:t,headers:{},ok:!1,statusText:n&&"string"==typeof n?n:t.toString(),fromCache:e}}function w(t){return new URLSearchParams(window.location.search).get(t)}},6640:function(t,e,n){"use strict";var i;n.d(e,{T:function(){return i}}),function(t){t.Excel="Excel",t.None="None",t.OneNote="OneNote",t.PowerPoint="PowerPoint",t.Visio="Visio",t.Word="Word"}(i||(i={}))},5623:function(t,e,n){"use strict";function i(t){window.performance&&window.performance.mark&&(Array.isArray(t)?t.forEach((function(t){window.performance.mark(t)})):window.performance.mark(t))}function o(){var t,e,n;return(null===(e=null===(t=window.performance)||void 0===t?void 0:t.now)||void 0===e?void 0:e.call(t))+(null===(n=window.performance)||void 0===n?void 0:n.timeOrigin)||Date.now()}n.d(e,{a:function(){return o},l:function(){return i}})},2685:function(t,e,n){"use strict";n.d(e,{Is:function(){return S},_7:function(){return b}});var i=n(1899),o=n(8940),r=n(1120),s=n(3079),a=n(6148),c=n(4508),u=n(6788);const l={sendGetRequestAsync:()=>Promise.reject((0,c.zP)(u.M2)),sendPostRequestAsync:()=>Promise.reject((0,c.zP)(u.M2))};var h=n(8230);class d{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class f{generateId(){return"callback-id"}startMeasurement(t,e){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{Ti:this.generateId(),status:h.$L.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:t,startTimeMs:Date.now(),correlationId:e||""},measurement:new d}}startPerformanceMeasurement(){return new d}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var p=n(150),v=n(5382),m=n(8198);class g{navigateInternal(t,e){return g.defaultNavigateWindow(t,e)}navigateExternal(t,e){return g.defaultNavigateWindow(t,e)}static defaultNavigateWindow(t,e){return e.noHistory?window.location.replace(t):window.location.assign(t),new Promise((t=>{setTimeout((()=>{t(!0)}),e.timeout)}))}}var w=n(5483),y=n(2656);class _{async sendGetRequestAsync(t,e){let n;try{n=await fetch(t,{method:m.EC.GET,headers:this.getFetchHeaders(e)})}catch(t){throw window.navigator.onLine?(0,w.Z_)(y.C8):(0,w.Z_)(y.Mq)}try{return{headers:this.getHeaderDict(n.headers),body:await n.json(),status:n.status}}catch(t){throw(0,w.Z_)(y.w6)}}async sendPostRequestAsync(t,e){const n=e&&e.body||i.gT.EMPTY_STRING;let o;try{o=await fetch(t,{method:m.EC.POST,headers:this.getFetchHeaders(e),body:n})}catch(t){throw window.navigator.onLine?(0,w.Z_)(y.Dc):(0,w.Z_)(y.Mq)}try{return{headers:this.getHeaderDict(o.headers),body:await o.json(),status:o.status}}catch(t){throw(0,w.Z_)(y.w6)}}getFetchHeaders(t){const e=new Headers;if(!t||!t.headers)return e;const n=t.headers;return Object.keys(n).forEach((t=>{e.append(t,n[t])})),e}getHeaderDict(t){const e={};return t.forEach(((t,n)=>{e[n]=t})),e}}const C=6e4,S=6e3,k=3e4,T=2e3;function b({auth:t,cache:e,system:n,telemetry:c},u){const h={clientId:i.gT.EMPTY_STRING,authority:`${i.gT.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:i.gT.EMPTY_STRING,authorityMetadata:i.gT.EMPTY_STRING,redirectUri:i.gT.EMPTY_STRING,postLogoutRedirectUri:i.gT.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:o.A.AAD,OIDCOptions:{serverResponseType:i.rg.FRAGMENT,defaultScopes:[i.gT.OPENID_SCOPE,i.gT.PROFILE_SCOPE,i.gT.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:r.z.None,tenant:i.gT.EMPTY_STRING},skipAuthorityMetadataCache:!1},d={cacheLocation:m.Ix.SessionStorage,temporaryCacheLocation:m.Ix.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!e||e.cacheLocation!==m.Ix.LocalStorage),claimsBasedCachingEnabled:!1},w={loggerCallback:()=>{},logLevel:s.i.Info,piiLoggingEnabled:!1},y={...{...a.z,loggerOptions:w,networkClient:u?new _:l,navigationClient:new g,loadFrameTimeout:0,windowHashTimeout:n?.loadFrameTimeout||C,iframeHashTimeout:n?.loadFrameTimeout||S,navigateFrameWait:0,redirectNavigationTimeout:k,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:n?.nativeBrokerHandshakeTimeout||T,pollIntervalMilliseconds:m.qx.DEFAULT_POLL_INTERVAL_MS},...n,loggerOptions:n?.loggerOptions||w},b={application:{appName:i.gT.EMPTY_STRING,appVersion:i.gT.EMPTY_STRING},client:new f};if(t?.protocolMode!==o.A.OIDC&&t?.OIDCOptions&&new s.Y(y.loggerOptions).warning(JSON.stringify((0,p.ei)(v.qz))),t?.protocolMode&&t.protocolMode!==o.A.AAD&&y?.allowNativeBroker)throw(0,p.ei)(v.Ol);return{auth:{...h,...t,OIDCOptions:{...h.OIDCOptions,...t?.OIDCOptions}},cache:{...d,...e},system:y,telemetry:{...b,...c}}}},9140:function(t,e,n){"use strict";n.r(e),n.d(e,{StandardController:function(){return Ne}});var i=n(8230),o=n(8299);const r="missing_kid_error",s="missing_alg_error",a={[r]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[s]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class c extends o.l4{constructor(t,e){super(t,e),this.name="JoseHeaderError",Object.setPrototypeOf(this,c.prototype)}}function u(t){return new c(t,a[t])}var l=n(1899);class h{constructor(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}static getShrHeaderString(t){if(!t.kid)throw u(r);if(!t.alg)throw u(s);const e=new h({typ:t.typ||l.L.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(e)}}function d(t){return encodeURIComponent(p(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function f(t){return v(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p(t){return v((new TextEncoder).encode(t))}function v(t){const e=Array.from(t,(t=>String.fromCodePoint(t))).join("");return btoa(e)}var m=n(5483),g=n(2656);function w(t){return(new TextDecoder).decode(function(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw(0,m.Z_)(g.lZ)}const n=atob(e);return Uint8Array.from(n,(t=>t.codePointAt(0)||0))}(t))}class y{static stringToUtf8Arr(t){let e,n=0;const i=t.length;for(let o=0;o<i;o++)e=t.charCodeAt(o),n+=e<128?1:e<2048?2:e<65536?3:e<2097152?4:e<67108864?5:6;const o=new Uint8Array(n);for(let i=0,r=0;i<n;r++)e=t.charCodeAt(r),e<128?o[i++]=e:e<2048?(o[i++]=192+(e>>>6),o[i++]=128+(63&e)):e<65536?(o[i++]=224+(e>>>12),o[i++]=128+(e>>>6&63),o[i++]=128+(63&e)):e<2097152?(o[i++]=240+(e>>>18),o[i++]=128+(e>>>12&63),o[i++]=128+(e>>>6&63),o[i++]=128+(63&e)):e<67108864?(o[i++]=248+(e>>>24),o[i++]=128+(e>>>18&63),o[i++]=128+(e>>>12&63),o[i++]=128+(e>>>6&63),o[i++]=128+(63&e)):(o[i++]=252+(e>>>30),o[i++]=128+(e>>>24&63),o[i++]=128+(e>>>18&63),o[i++]=128+(e>>>12&63),o[i++]=128+(e>>>6&63),o[i++]=128+(63&e));return o}static utf8ArrToString(t){let e=l.gT.EMPTY_STRING;for(let n,i=t.length,o=0;o<i;o++)n=t[o],e+=String.fromCharCode(n>251&&n<254&&o+5<i?1073741824*(n-252)+(t[++o]-128<<24)+(t[++o]-128<<18)+(t[++o]-128<<12)+(t[++o]-128<<6)+t[++o]-128:n>247&&n<252&&o+4<i?(n-248<<24)+(t[++o]-128<<18)+(t[++o]-128<<12)+(t[++o]-128<<6)+t[++o]-128:n>239&&n<248&&o+3<i?(n-240<<18)+(t[++o]-128<<12)+(t[++o]-128<<6)+t[++o]-128:n>223&&n<240&&o+2<i?(n-224<<12)+(t[++o]-128<<6)+t[++o]-128:n>191&&n<224&&o+1<i?(n-192<<6)+t[++o]-128:n);return e}static getSortedObjectString(t){return JSON.stringify(t,Object.keys(t).sort())}}var _=n(8198);const C="SHA-256",S=new Uint8Array([1,0,1]),k={name:"RSASSA-PKCS1-v1_5",hash:C,modulusLength:2048,publicExponent:S};async function T(t,e,n){e?.addQueueMeasurement(i.Ak.Sha256Digest,n);const o=y.stringToUtf8Arr(t);return window.crypto.subtle.digest(C,o)}function b(t){return window.crypto.getRandomValues(t)}function A(){return window.crypto.randomUUID()}async function I(t){return window.crypto.subtle.exportKey(_.Mm,t)}class R{constructor(){this.dbName=_.H4,this.version=_.kd,this.tableName=_.Gv,this.dbOpen=!1}async open(){return new Promise(((t,e)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",(t=>{t.target.result.createObjectStore(this.tableName)})),n.addEventListener("success",(e=>{const n=e;this.db=n.target.result,this.dbOpen=!0,t()})),n.addEventListener("error",(()=>e((0,m.Z_)(g.Pi))))}))}closeConnection(){const t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return await this.open()}async getItem(t){return await this.validateDbIsOpen(),new Promise(((e,n)=>{if(!this.db)return n((0,m.Z_)(g.IL));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(t);i.addEventListener("success",(t=>{const n=t;this.closeConnection(),e(n.target.result)})),i.addEventListener("error",(t=>{this.closeConnection(),n(t)}))}))}async setItem(t,e){return await this.validateDbIsOpen(),new Promise(((n,i)=>{if(!this.db)return i((0,m.Z_)(g.IL));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(e,t);o.addEventListener("success",(()=>{this.closeConnection(),n()})),o.addEventListener("error",(t=>{this.closeConnection(),i(t)}))}))}async removeItem(t){return await this.validateDbIsOpen(),new Promise(((e,n)=>{if(!this.db)return n((0,m.Z_)(g.IL));const i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(t);i.addEventListener("success",(()=>{this.closeConnection(),e()})),i.addEventListener("error",(t=>{this.closeConnection(),n(t)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((t,e)=>{if(!this.db)return e((0,m.Z_)(g.IL));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",(e=>{const n=e;this.closeConnection(),t(n.target.result)})),n.addEventListener("error",(t=>{this.closeConnection(),e(t)}))}))}async containsKey(t){return await this.validateDbIsOpen(),new Promise(((e,n)=>{if(!this.db)return n((0,m.Z_)(g.IL));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(t);i.addEventListener("success",(t=>{const n=t;this.closeConnection(),e(1===n.target.result)})),i.addEventListener("error",(t=>{this.closeConnection(),n(t)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((t,e)=>{const n=window.indexedDB.deleteDatabase(_.H4);n.addEventListener("success",(()=>t(!0))),n.addEventListener("blocked",(()=>t(!0))),n.addEventListener("error",(()=>e(!1)))}))}}class E{constructor(){this.cache=new Map}getItem(t){return this.cache.get(t)||null}setItem(t,e){this.cache.set(t,e)}removeItem(t){this.cache.delete(t)}getKeys(){const t=[];return this.cache.forEach(((e,n)=>{t.push(n)})),t}containsKey(t){return this.cache.has(t)}clear(){this.cache.clear()}}class N{constructor(t,e){this.inMemoryCache=new E,this.indexedDBCache=new R,this.logger=t,this.storeName=e}handleDatabaseAccessError(t){if(!(t instanceof m.Ut&&t.errorCode===g.Pi))throw t;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(t){const e=this.inMemoryCache.getItem(t);if(!e)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(t)}catch(t){this.handleDatabaseAccessError(t)}return e}async setItem(t,e){this.inMemoryCache.setItem(t,e);try{await this.indexedDBCache.setItem(t,e)}catch(t){this.handleDatabaseAccessError(t)}}async removeItem(t){this.inMemoryCache.removeItem(t);try{await this.indexedDBCache.removeItem(t)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const t=this.inMemoryCache.getKeys();if(0===t.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return t}async containsKey(t){const e=this.inMemoryCache.containsKey(t);if(!e)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(t)}catch(t){this.handleDatabaseAccessError(t)}return e}clearInMemory(){this.logger.verbose(`Deleting in-memory keystore ${this.storeName}`),this.inMemoryCache.clear(),this.logger.verbose(`In-memory keystore ${this.storeName} deleted`)}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const t=await this.indexedDBCache.deleteDatabase();return t&&this.logger.verbose("Persistent keystore deleted"),t}catch(t){return this.handleDatabaseAccessError(t),!1}}}class P{constructor(t){this.logger=t,this.asymmetricKeys=new N(this.logger,"asymmetricKeys"),this.symmetricKeys=new N(this.logger,"symmetricKeys")}async clear(){this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory();try{return await this.asymmetricKeys.clearPersistent(),!0}catch(t){return t instanceof Error?this.logger.error(`Clearing keystore failed with error: ${t.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}}class H{constructor(t,e){this.logger=t,function(t){if(!("crypto"in window))throw t.error("BrowserCrypto: crypto interface is unavailable"),(0,m.Z_)(g.TR);t.verbose("BrowserCrypto: modern crypto interface available")}(t),this.cache=new P(this.logger),this.performanceClient=e}createNewGuid(){return A()}base64Encode(t){return p(t)}base64Decode(t){return w(t)}async getPublicKeyThumbprint(t){const e=this.performanceClient?.startMeasurement(i.Ak.CryptoOptsGetPublicKeyThumbprint,t.correlationId),n=await async function(t,e){return window.crypto.subtle.generateKey(k,t,e)}(H.EXTRACTABLE,H.POP_KEY_USAGES),o=await I(n.publicKey),r={e:o.e,kty:o.kty,n:o.n},s=y.getSortedObjectString(r),a=await this.hashString(s),c=await I(n.privateKey),u=await async function(t,e,n){return window.crypto.subtle.importKey(_.Mm,t,k,!1,["sign"])}(c);return await this.cache.asymmetricKeys.setItem(a,{privateKey:u,publicKey:n.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),e&&e.end({success:!0}),a}async removeTokenBindingKey(t){return await this.cache.asymmetricKeys.removeItem(t),!await this.cache.asymmetricKeys.containsKey(t)}async clearKeystore(){return await this.cache.clear()}async signJwt(t,e,n){const o=this.performanceClient?.startMeasurement(i.Ak.CryptoOptsSignJwt,n),r=await this.cache.asymmetricKeys.getItem(e);if(!r)throw(0,m.Z_)(g.XM);const s=await I(r.publicKey),a=y.getSortedObjectString(s),c=d(JSON.stringify({kid:e})),u=d(h.getShrHeaderString({kid:c,alg:s.alg}));t.cnf={jwk:JSON.parse(a)};const l=`${u}.${d(JSON.stringify(t))}`,p=y.stringToUtf8Arr(l),v=await async function(t,e){return window.crypto.subtle.sign(k,t,e)}(r.privateKey,p),w=`${l}.${f(new Uint8Array(v))}`;return o&&o.end({success:!0}),w}async hashString(t){const e=await T(t);return f(new Uint8Array(e))}}H.POP_KEY_USAGES=["sign","verify"],H.EXTRACTABLE=!0;var O=n(1510);const U=(t,e,n,i,o)=>(...r)=>{n.trace(`Executing function ${e}`);const s=i?.startMeasurement(e,o);try{const i=t(...r);return s?.end({success:!0}),n.trace(`Returning result from ${e}`),i}catch(t){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(t))}catch(t){n.trace("Unable to print error message.")}throw s?.end({success:!1}),t}},M=(t,e,n,i,o)=>(...r)=>{n.trace(`Executing function ${e}`);const s=i?.startMeasurement(e,o);return i?.setPreQueueTime(e,o),t(...r).then((t=>(n.trace(`Returning result from ${e}`),s?.end({success:!0}),t))).catch((t=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(t))}catch(t){n.trace("Unable to print error message.")}throw s?.end({success:!1}),t}))};var D=n(150),F=n(4508),x=n(9e3),q=n(5382),B=n(6788);class L{get urlString(){return this.bi}constructor(t){if(this.bi=t,!this.bi)throw(0,D.ei)(q.To);this.getHash()||(this.bi=L.canonicalizeUri(t))}static canonicalizeUri(t){if(t){let e=t.toLowerCase();return x.x.endsWith(e,"?")?e=e.slice(0,-1):x.x.endsWith(e,"?/")&&(e=e.slice(0,-2)),x.x.endsWith(e,"/")||(e+="/"),e}return t}validateAsUri(){let t;try{t=this.getUrlComponents()}catch(t){throw(0,D.ei)(q.yH)}if(!t.HostNameAndPort||!t.PathSegments)throw(0,D.ei)(q.yH);if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw(0,D.ei)(q.Oz)}static appendQueryString(t,e){return e?t.indexOf("?")<0?`${t}?${e}`:`${t}&${e}`:t}static removeHashFromUrl(t){return L.canonicalizeUri(t.split("#")[0])}replaceTenantPath(t){const e=this.getUrlComponents(),n=e.PathSegments;return!t||0===n.length||n[0]!==l.Nb.COMMON&&n[0]!==l.Nb.ORGANIZATIONS||(n[0]=t),L.constructAuthorityUriFromObject(e)}getHash(){return L.parseHash(this.urlString)}getUrlComponents(){const t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),e=this.urlString.match(t);if(!e)throw(0,D.ei)(q.yH);const n={Protocol:e[1],HostNameAndPort:e[4],AbsolutePath:e[5],QueryString:e[7]};let i=n.AbsolutePath.split("/");return i=i.filter((t=>t&&t.length>0)),n.PathSegments=i,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(t){const e=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=t.match(e);if(!n)throw(0,D.ei)(q.yH);return n[2]}static getAbsoluteUrl(t,e){if(t[0]===l.gT.FORWARD_SLASH){const n=new L(e).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t}static parseHash(t){const e=t.indexOf("#"),n=t.indexOf("#/");return n>-1?t.substring(n+2):e>-1?t.substring(e+1):l.gT.EMPTY_STRING}static parseQueryString(t){const e=t.indexOf("?"),n=t.indexOf("/?");return n>-1?t.substring(n+2):e>-1?t.substring(e+1):l.gT.EMPTY_STRING}static parseQueryServerResponse(t){const e=t.indexOf("?code"),n=t.indexOf("/?code"),i=t.indexOf("#");return n>-1&&i>-1?t.substring(n+2,i):n>-1?t.substring(n+2):e>-1&&i>-1?t.substring(e+1,i):e>-1?t.substring(e+1):l.gT.EMPTY_STRING}static constructAuthorityUriFromObject(t){return new L(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))}static getDeserializedHash(t){if(!t)return{};const e=L.parseHash(t),n=x.x.queryStringToObject(e||t);if(!n)throw(0,F.zP)(B.b4);return n}static getDeserializedQueryString(t){if(!t)return{};const e=L.parseQueryString(t),n=x.x.queryStringToObject(e||t);if(!n)throw(0,F.zP)(B.b4);return n}static getDeserializedCodeResponse(t,e){const n=new L(e);let i;return i=t===l.rg.QUERY?L.getDeserializedQueryString(e):L.getDeserializedHash(n.getHash()),i}static hashContainsKnownProperties(t){if(!t||t.indexOf("=")<0)return!1;const e=L.getDeserializedHash(t);return!!(e.code||e.error_description||e.error||e.state)}}var W=n(9435),j=n(764);class G extends o.l4{constructor(t,e,n){super(t,e,n),this.name="ServerError",Object.setPrototypeOf(this,G.prototype)}}var K=n(2817);class z{generateAccountId(){return z.generateAccountIdForCacheKey(this.homeAccountId,this.environment)}generateCredentialId(){return z.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)}generateTarget(){return z.generateTargetForCacheKey(this.target)}generateCredentialKey(){return z.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)}generateType(){switch(this.credentialType){case l.d3.ID_TOKEN:return l.LL.ID_TOKEN;case l.d3.ACCESS_TOKEN:case l.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:return l.LL.ACCESS_TOKEN;case l.d3.REFRESH_TOKEN:return l.LL.REFRESH_TOKEN;default:throw(0,F.zP)(B.cy)}}static generateCredentialCacheKey(t,e,n,i,o,r,s,a,c){return[this.generateAccountIdForCacheKey(t,e),this.generateCredentialIdForCacheKey(n,i,o,s),this.generateTargetForCacheKey(r),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(a)].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateAccountIdForCacheKey(t,e){return[t,e].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateCredentialIdForCacheKey(t,e,n,i){return[t,t===l.d3.REFRESH_TOKEN&&i||e,n||l.gT.EMPTY_STRING].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static generateTargetForCacheKey(t){return(t||l.gT.EMPTY_STRING).toLowerCase()}static generateClaimsHashForCacheKey(t){return(t||l.gT.EMPTY_STRING).toLowerCase()}static generateSchemeForCacheKey(t){return t&&t.toLowerCase()!==l.hO.BEARER.toLowerCase()?t.toLowerCase():l.gT.EMPTY_STRING}}class $ extends z{static createIdTokenEntity(t,e,n,i,o){const r=new $;return r.credentialType=l.d3.ID_TOKEN,r.homeAccountId=t,r.environment=e,r.clientId=i,r.secret=n,r.realm=o,r}static isIdTokenEntity(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===l.d3.ID_TOKEN}}class V{static nowSeconds(){return Math.round((new Date).getTime()/1e3)}static isTokenExpired(t,e){const n=Number(t)||0;return V.nowSeconds()+e>n}static wasClockTurnedBack(t){return Number(t)>V.nowSeconds()}static delay(t,e){return new Promise((n=>setTimeout((()=>n(e)),t)))}}var J=n(6380);class Q extends z{static createAccessTokenEntity(t,e,n,i,o,r,s,a,c,u,h,d,f,p,v){const m=new Q;m.homeAccountId=t,m.credentialType=l.d3.ACCESS_TOKEN,m.secret=n;const g=V.nowSeconds();if(m.cachedAt=g.toString(),m.expiresOn=s.toString(),m.extendedExpiresOn=a.toString(),u&&(m.refreshOn=u.toString()),m.environment=e,m.clientId=i,m.realm=o,m.target=r,m.userAssertionHash=d,m.tokenType=h||l.hO.BEARER,p&&(m.requestedClaims=p,m.requestedClaimsHash=v),m.tokenType?.toLowerCase()!==l.hO.BEARER.toLowerCase())switch(m.credentialType=l.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case l.hO.POP:const t=(0,J.Z_)(n,c.base64Decode);if(!t?.cnf?.kid)throw(0,F.zP)(B.P_);m.keyId=t.cnf.kid;break;case l.hO.SSH:m.keyId=f}return m}static isAccessTokenEntity(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===l.d3.ACCESS_TOKEN||t.credentialType===l.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME)}}class X extends z{static createRefreshTokenEntity(t,e,n,i,o,r){const s=new X;return s.clientId=i,s.credentialType=l.d3.REFRESH_TOKEN,s.environment=e,s.homeAccountId=t,s.secret=n,s.userAssertionHash=r,o&&(s.familyId=o),s}static isRefreshTokenEntity(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===l.d3.REFRESH_TOKEN}}class Y{generateAppMetadataKey(){return Y.generateAppMetadataCacheKey(this.environment,this.clientId)}static generateAppMetadataCacheKey(t,e){return[l.dg,t,e].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAppMetadataEntity(t,e,n){const i=new Y;return i.clientId=t,i.environment=e,n&&(i.familyId=n),i}static isAppMetadataEntity(t,e){return!!e&&0===t.indexOf(l.dg)&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment")}}class Z{constructor(){this.failedRequests=[],this.errors=[],this.cacheHits=0}static isServerTelemetryEntity(t,e){const n=0===t.indexOf(l.HN.CACHE_KEY);let i=!0;return e&&(i=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&i}}class tt{constructor(){this.expiresAt=V.nowSeconds()+l.QU.REFRESH_TIME_SECONDS}updateCloudDiscoveryMetadata(t,e){this.aliases=t.aliases,this.preferred_cache=t.preferred_cache,this.preferred_network=t.preferred_network,this.aliasesFromNetwork=e}updateEndpointMetadata(t,e){this.authorization_endpoint=t.authorization_endpoint,this.token_endpoint=t.token_endpoint,this.end_session_endpoint=t.end_session_endpoint,this.issuer=t.issuer,this.endpointsFromNetwork=e,this.jwks_uri=t.jwks_uri}updateCanonicalAuthority(t){this.canonical_authority=t}resetExpiresAt(){this.expiresAt=V.nowSeconds()+l.QU.REFRESH_TIME_SECONDS}isExpired(){return this.expiresAt<=V.nowSeconds()}static isAuthorityMetadataEntity(t,e){return!!e&&0===t.indexOf(l.QU.CACHE_KEY)&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri")}}class et{static isThrottlingEntity(t,e){let n=!1;t&&(n=0===t.indexOf(l.bb.THROTTLING_PREFIX));let i=!0;return e&&(i=e.hasOwnProperty("throttleTime")),n&&i}}class nt{static setRequestState(t,e,n){const i=nt.generateLibraryState(t,n);return e?`${i}${l.gT.RESOURCE_DELIM}${e}`:i}static generateLibraryState(t,e){if(!t)throw(0,F.zP)(B.QL);const n={id:t.createNewGuid()};e&&(n.meta=e);const i=JSON.stringify(n);return t.base64Encode(i)}static parseRequestState(t,e){if(!t)throw(0,F.zP)(B.QL);if(!e)throw(0,F.zP)(B.r8);try{const n=e.split(l.gT.RESOURCE_DELIM),i=n[0],o=n.length>1?n.slice(1).join(l.gT.RESOURCE_DELIM):l.gT.EMPTY_STRING,r=t.base64Decode(i),s=JSON.parse(r);return{userRequestState:o||l.gT.EMPTY_STRING,libraryState:s}}catch(t){throw(0,F.zP)(B.r8)}}}const it="home_account_id",ot="UPN";class rt{constructor(t,e,n,i,o){this.account=t||null,this.idToken=e||null,this.accessToken=n||null,this.refreshToken=i||null,this.appMetadata=o||null}}const st="storage_not_supported",at="in_mem_redirect_unavailable",ct={[st]:"Given storage configuration option was not supported.",stubbed_public_client_application_called:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[at]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class ut extends o.l4{constructor(t,e){super(t,e),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,ut.prototype)}}function lt(t){return new ut(t,ct[t])}class ht{constructor(t){this.validateWindowStorage(t),this.windowStorage=window[t]}validateWindowStorage(t){if(t!==_.Ix.LocalStorage&&t!==_.Ix.SessionStorage||!window[t])throw lt(st)}getItem(t){return this.windowStorage.getItem(t)}setItem(t,e){this.windowStorage.setItem(t,e)}removeItem(t){this.windowStorage.removeItem(t)}getKeys(){return Object.keys(this.windowStorage)}containsKey(t){return this.windowStorage.hasOwnProperty(t)}}class dt{static extractBrowserRequestState(t,e){if(!e)return null;try{return nt.parseRequestState(t,e).libraryState.meta}catch(t){throw(0,F.zP)(B.r8)}}static parseServerResponseFromHash(t){if(!t)return{};const e=new L(t);return L.getDeserializedHash(e.getHash())}}class ft extends K.L{constructor(t,e,n,i){super(t,n,i),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=e,this.logger=i,this.internalStorage=new E,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),e.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps())}setupBrowserStorage(t){switch(t){case _.Ix.LocalStorage:case _.Ix.SessionStorage:try{return new ht(t)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=_.Ix.MemoryStorage,new E}setupTemporaryCacheStorage(t,e){switch(e){case _.Ix.LocalStorage:case _.Ix.SessionStorage:try{return new ht(t||_.Ix.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case _.Ix.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const t=`${l.gT.CACHE_PREFIX}.${l.Vi.ID_TOKEN}`,e=`${l.gT.CACHE_PREFIX}.${l.Vi.CLIENT_INFO}`,n=`${l.gT.CACHE_PREFIX}.${l.Vi.ERROR}`,i=`${l.gT.CACHE_PREFIX}.${l.Vi.ERROR_DESC}`,o=[this.browserStorage.getItem(t),this.browserStorage.getItem(e),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[l.Vi.ID_TOKEN,l.Vi.CLIENT_INFO,l.Vi.ERROR,l.Vi.ERROR_DESC].forEach(((t,e)=>this.migrateCacheEntry(t,o[e])))}migrateCacheEntry(t,e){e&&this.setTemporaryCache(t,e,!0)}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const t=this.getItem(_.Oq.ACCOUNT_KEYS),e=this.getItem(`${_.Oq.TOKEN_KEYS}.${this.clientId}`);t&&e?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((t=>{if(this.isCredentialKey(t)){const e=this.getItem(t);if(e){const n=this.validateAndParseJson(e);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case l.d3.ID_TOKEN:if($.isIdTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${t} found, saving key to token key map`);const e=K.L.toObject(new $,n),i=this.updateCredentialCacheKey(t,e);return void this.addTokenKey(i,l.d3.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${t}`);break;case l.d3.ACCESS_TOKEN:case l.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Q.isAccessTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${t} found, saving key to token key map`);const e=K.L.toObject(new Q,n),i=this.updateCredentialCacheKey(t,e);return void this.addTokenKey(i,l.d3.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${t}`);break;case l.d3.REFRESH_TOKEN:if(X.isRefreshTokenEntity(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${t} found, saving key to token key map`);const e=K.L.toObject(new X,n),i=this.updateCredentialCacheKey(t,e);return void this.addTokenKey(i,l.d3.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${t}`)}}}if(this.isAccountKey(t)){const e=this.getItem(t);if(e){const n=this.validateAndParseJson(e);n&&j.r.isAccountEntity(n)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${t} found, saving key to account key map`),this.addAccountKeyToMap(t))}}}))}validateAndParseJson(t){try{const e=JSON.parse(t);return e&&"object"==typeof e?e:null}catch(t){return null}}getItem(t){return this.browserStorage.getItem(t)}setItem(t,e){this.browserStorage.setItem(t,e)}getAccount(t){this.logger.trace("BrowserCacheManager.getAccount called");const e=this.getItem(t);if(!e)return this.removeAccountKeyFromMap(t),null;const n=this.validateAndParseJson(e);return n&&j.r.isAccountEntity(n)?K.L.toObject(new j.r,n):(this.removeAccountKeyFromMap(t),null)}setAccount(t){this.logger.trace("BrowserCacheManager.setAccount called");const e=t.generateAccountKey();this.setItem(e,JSON.stringify(t)),this.addAccountKeyToMap(e)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const t=this.getItem(_.Oq.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${t}`);const e=this.getAccountKeys();-1===e.indexOf(t)?(e.push(t),this.setItem(_.Oq.ACCOUNT_KEYS,JSON.stringify(e)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${t}`);const e=this.getAccountKeys(),n=e.indexOf(t);n>-1?(e.splice(n,1),this.setItem(_.Oq.ACCOUNT_KEYS,JSON.stringify(e)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(t){super.removeAccount(t),this.removeAccountKeyFromMap(t)}removeIdToken(t){super.removeIdToken(t),this.removeTokenKey(t,l.d3.ID_TOKEN)}async removeAccessToken(t){super.removeAccessToken(t),this.removeTokenKey(t,l.d3.ACCESS_TOKEN)}removeRefreshToken(t){super.removeRefreshToken(t),this.removeTokenKey(t,l.d3.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const t=this.getItem(`${_.Oq.TOKEN_KEYS}.${this.clientId}`);if(t){const e=this.validateAndParseJson(t);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(t,e){this.logger.trace("BrowserCacheManager addTokenKey called");const n=this.getTokenKeys();switch(e){case l.d3.ID_TOKEN:-1===n.idToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(t));break;case l.d3.ACCESS_TOKEN:-1===n.accessToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(t));break;case l.d3.REFRESH_TOKEN:-1===n.refreshToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(t));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${e}`),(0,F.zP)(B.cy)}this.setItem(`${_.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(t,e){this.logger.trace("BrowserCacheManager removeTokenKey called");const n=this.getTokenKeys();switch(e){case l.d3.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${t} from map`);const i=n.idToken.indexOf(t);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case l.d3.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${t} from map`);const o=n.accessToken.indexOf(t);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case l.d3.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${t} from map`);const r=n.refreshToken.indexOf(t);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${e}`),(0,F.zP)(B.cy)}this.setItem(`${_.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.ID_TOKEN),null;const n=this.validateAndParseJson(e);return n&&$.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),K.L.toObject(new $,n)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.ID_TOKEN),null)}setIdTokenCredential(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const e=t.generateCredentialKey();this.setItem(e,JSON.stringify(t)),this.addTokenKey(e,l.d3.ID_TOKEN)}getAccessTokenCredential(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.ACCESS_TOKEN),null;const n=this.validateAndParseJson(e);return n&&Q.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),K.L.toObject(new Q,n)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.ACCESS_TOKEN),null)}setAccessTokenCredential(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const e=t.generateCredentialKey();this.setItem(e,JSON.stringify(t)),this.addTokenKey(e,l.d3.ACCESS_TOKEN)}getRefreshTokenCredential(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.REFRESH_TOKEN),null;const n=this.validateAndParseJson(e);return n&&X.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),K.L.toObject(new X,n)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,l.d3.REFRESH_TOKEN),null)}setRefreshTokenCredential(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const e=t.generateCredentialKey();this.setItem(e,JSON.stringify(t)),this.addTokenKey(e,l.d3.REFRESH_TOKEN)}getAppMetadata(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(e);return n&&Y.isAppMetadataEntity(t,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),K.L.toObject(new Y,n)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const e=t.generateAppMetadataKey();this.setItem(e,JSON.stringify(t))}getServerTelemetry(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(e);return n&&Z.isServerTelemetryEntity(t,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),K.L.toObject(new Z,n)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(t,e){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(e))}getAuthorityMetadata(t){const e=this.internalStorage.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(e);return n&&tt.isAuthorityMetadataEntity(t,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),K.L.toObject(new tt,n)):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((t=>this.isAuthorityMetadata(t)))}setWrapperMetadata(t,e){this.internalStorage.setItem(_.Bs.WRAPPER_SKU,t),this.internalStorage.setItem(_.Bs.WRAPPER_VER,e)}getWrapperMetadata(){return[this.internalStorage.getItem(_.Bs.WRAPPER_SKU)||l.gT.EMPTY_STRING,this.internalStorage.getItem(_.Bs.WRAPPER_VER)||l.gT.EMPTY_STRING]}setAuthorityMetadata(t,e){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(e))}getActiveAccount(){const t=this.generateCacheKey(l.Vi.ACTIVE_ACCOUNT_FILTERS),e=this.getItem(t);if(!e){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const t=this.generateCacheKey(l.Vi.ACTIVE_ACCOUNT),e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const n=this.getAccountInfoByFilter({localAccountId:e})[0]||null;return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(n),n):null}const n=this.validateAndParseJson(e);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(t){const e=this.generateCacheKey(l.Vi.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(l.Vi.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(e,JSON.stringify(i)),this.browserStorage.setItem(n,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(e),this.browserStorage.removeItem(n)}getAccountInfoByFilter(t){const e=this.getAllAccounts();return this.logger.trace(`BrowserCacheManager.getAccountInfoByFilter: total ${e.length} accounts found`),e.filter((e=>!(t.username&&t.username.toLowerCase()!==e.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==e.homeAccountId||t.localAccountId&&t.localAccountId!==e.localAccountId||t.tenantId&&t.tenantId!==e.tenantId||t.environment&&t.environment!==e.environment)))}getAccountInfoByHints(t,e){const n=this.getAllAccounts().filter((n=>{if(e){const t=n.idTokenClaims&&n.idTokenClaims.sid;return e===t}return!!t&&t===n.username}));if(1===n.length)return n[0];if(n.length>1)throw(0,F.zP)(B.RH);return null}getThrottlingCache(t){const e=this.getItem(t);if(!e)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(e);return n&&et.isThrottlingEntity(t,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),K.L.toObject(new et,n)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(t,e){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(e))}getTemporaryCache(t,e){const n=e?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){const t=this.getItemCookie(n);if(t)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),t}const i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===_.Ix.LocalStorage){const t=this.browserStorage.getItem(n);if(t)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),t}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(t,e,n){const i=n?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(i,e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,e))}removeItem(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))}containsKey(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)}getKeys(){return[...this.browserStorage.getKeys(),...this.temporaryCacheStorage.getKeys()]}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((t=>{!this.browserStorage.containsKey(t)&&!this.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(l.gT.CACHE_PREFIX)&&-1===t.indexOf(this.clientId)||this.removeItem(t)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(t){t.addQueueMeasurement(i.Ak.ClearTokensAndKeysWithClaims);const e=this.getTokenKeys(),n=[];e.accessToken.forEach((t=>{const e=this.getAccessTokenCredential(t);e?.requestedClaimsHash&&t.includes(e.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(t))})),await Promise.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(t,e,n){let i=`${encodeURIComponent(t)}=${encodeURIComponent(e)};path=/;SameSite=Lax;`;n&&(i+=`expires=${this.getCookieExpirationTime(n)};`),this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i}getItemCookie(t){const e=`${encodeURIComponent(t)}=`,n=document.cookie.split(";");for(let t=0;t<n.length;t++){let i=n[t];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return decodeURIComponent(i.substring(e.length,i.length))}return l.gT.EMPTY_STRING}clearMsalCookies(){const t=`${l.gT.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach((e=>{for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t)){const t=e.split("=")[0];this.clearItemCookie(t)}}))}clearItemCookie(t){this.setItemCookie(t,l.gT.EMPTY_STRING,-1)}getCookieExpirationTime(t){const e=new Date;return new Date(e.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}getCache(){return this.browserStorage}setCache(){}generateCacheKey(t){return this.validateAndParseJson(t)?JSON.stringify(t):x.x.startsWith(t,l.gT.CACHE_PREFIX)||x.x.startsWith(t,l.Vi.ADAL_ID_TOKEN)?t:`${l.gT.CACHE_PREFIX}.${this.clientId}.${t}`}generateAuthorityKey(t){const{libraryState:{id:e}}=nt.parseRequestState(this.cryptoImpl,t);return this.generateCacheKey(`${_.c4.AUTHORITY}.${e}`)}generateNonceKey(t){const{libraryState:{id:e}}=nt.parseRequestState(this.cryptoImpl,t);return this.generateCacheKey(`${_.c4.NONCE_IDTOKEN}.${e}`)}generateStateKey(t){const{libraryState:{id:e}}=nt.parseRequestState(this.cryptoImpl,t);return this.generateCacheKey(`${_.c4.REQUEST_STATE}.${e}`)}getCachedAuthority(t){const e=this.generateStateKey(t),n=this.getTemporaryCache(e);if(!n)return null;const i=this.generateAuthorityKey(n);return this.getTemporaryCache(i)}updateCacheEntries(t,e,n,i,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const r=this.generateStateKey(t);this.setTemporaryCache(r,t,!1);const s=this.generateNonceKey(t);this.setTemporaryCache(s,e,!1);const a=this.generateAuthorityKey(t);if(this.setTemporaryCache(a,n,!1),o){const t={credential:o.homeAccountId,type:it};this.setTemporaryCache(_.c4.CCS_CREDENTIAL,JSON.stringify(t),!0)}else if(i){const t={credential:i,type:ot};this.setTemporaryCache(_.c4.CCS_CREDENTIAL,JSON.stringify(t),!0)}}resetRequestCache(t){this.logger.trace("BrowserCacheManager.resetRequestCache called"),t&&(this.getKeys().forEach((e=>{-1!==e.indexOf(t)&&this.removeItem(e)})),this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(_.c4.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(_.c4.ORIGIN_URI)),this.removeItem(this.generateCacheKey(_.c4.URL_HASH)),this.removeItem(this.generateCacheKey(_.c4.CORRELATION_ID)),this.removeItem(this.generateCacheKey(_.c4.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(_.c4.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){const e=this.generateStateKey(t),n=this.temporaryCacheStorage.getItem(e);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||l.gT.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(t){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((e=>{if(-1===e.indexOf(_.c4.REQUEST_STATE))return;const n=this.temporaryCacheStorage.getItem(e);if(!n)return;const i=dt.extractBrowserRequestState(this.cryptoImpl,n);i&&i.interactionType===t&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const e=p(JSON.stringify(t));this.setTemporaryCache(_.c4.REQUEST_PARAMS,e,!0)}getCachedRequest(t){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(_.c4.REQUEST_PARAMS,!0);if(!e)throw(0,m.Z_)(g.QO);let n;try{n=JSON.parse(w(e))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),(0,m.Z_)(g.e$)}if(this.removeItem(this.generateCacheKey(_.c4.REQUEST_PARAMS)),!n.authority){const e=this.generateAuthorityKey(t),i=this.getTemporaryCache(e);if(!i)throw(0,m.Z_)(g.dT);n.authority=i}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const t=this.getTemporaryCache(_.c4.NATIVE_REQUEST,!0);return t?this.validateAndParseJson(t)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(t){const e=this.getInteractionInProgress();return t?e===this.clientId:!!e}getInteractionInProgress(){const t=`${l.gT.CACHE_PREFIX}.${_.c4.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(t,!1)}setInteractionInProgress(t){const e=`${l.gT.CACHE_PREFIX}.${_.c4.INTERACTION_STATUS_KEY}`;if(t){if(this.getInteractionInProgress())throw(0,m.Z_)(g.Ck);this.setTemporaryCache(e,this.clientId,!1)}else t||this.getInteractionInProgress()!==this.clientId||this.removeItem(e)}getLegacyLoginHint(){const t=this.getTemporaryCache(l.Vi.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(l.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const e=this.getTemporaryCache(l.Vi.ID_TOKEN,!0);e&&(this.removeItem(this.generateCacheKey(l.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=e||t;if(n){const t=J.Z_(n,w);if(t.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),t.preferred_username;if(t.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),t.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(t,e){const n=e.generateCredentialKey();if(t!==n){const i=this.getItem(t);if(i)return this.removeItem(t),this.setItem(n,i),this.logger.verbose(`Updated an outdated ${e.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${e.credentialType} cache key but no item matching the outdated key was found in storage`)}return t}getRedirectRequestContext(){return this.getTemporaryCache(_.c4.REDIRECT_CONTEXT,!0)}setRedirectRequestContext(t){this.setTemporaryCache(_.c4.REDIRECT_CONTEXT,t,!0)}async hydrateCache(t,e){const n=$.createIdTokenEntity(t.account?.homeAccountId,t.account?.environment,t.idToken,this.clientId,t.tenantId);let i;e.claims&&(i=await this.cryptoImpl.hashString(e.claims));const o=Q.createAccessTokenEntity(t.account?.homeAccountId,t.account.environment,t.accessToken,this.clientId,t.tenantId,t.scopes.join(" "),t.expiresOn?.getTime()||0,t.extExpiresOn?.getTime()||0,this.cryptoImpl,void 0,t.tokenType,void 0,e.sshKid,e.claims,i),r=new rt(void 0,n,o);return this.saveCacheRecord(r)}}class pt{static clearHash(t){t.location.hash=l.gT.EMPTY_STRING,"function"==typeof t.history.replaceState&&t.history.replaceState(null,l.gT.EMPTY_STRING,`${t.location.origin}${t.location.pathname}${t.location.search}`)}static replaceHash(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):l.gT.EMPTY_STRING}static isInIframe(){return window.parent!==window}static isInPopup(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${_.qx.POPUP_NAME_PREFIX}.`)}static getCurrentUri(){return window.location.href.split("?")[0].split("#")[0]}static getHomepage(){const t=new L(window.location.href).getUrlComponents();return`${t.Protocol}//${t.HostNameAndPort}/`}static blockReloadInHiddenIframes(){if(L.hashContainsKnownProperties(window.location.hash)&&pt.isInIframe())throw(0,m.Z_)(g.xO)}static blockRedirectInIframe(t,e){const n=pt.isInIframe();if(t===_.s_.Redirect&&n&&!e)throw(0,m.Z_)(g.b_)}static blockAcquireTokenInPopups(){if(pt.isInPopup())throw(0,m.Z_)(g.bj)}static blockNonBrowserEnvironment(t){if(!t)throw(0,m.Z_)(g.Dx)}static blockAPICallsBeforeInitialize(t){if(!t)throw(0,m.Z_)(g.al)}}const vt="msal:loginStart",mt="msal:loginSuccess",gt="msal:loginFailure",wt="msal:acquireTokenStart",yt="msal:acquireTokenSuccess",_t="msal:acquireTokenFailure",Ct="msal:acquireTokenByCodeFailure",St="msal:handleRedirectEnd",kt="msal:popupOpened",Tt="msal:logoutStart",bt="msal:logoutSuccess",At="msal:logoutFailure",It="msal:logoutEnd";class Rt{constructor(t,e){this.eventCallbacks=new Map,this.logger=t,this.browserCrypto=e,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(t){if("undefined"!=typeof window){const e=A();return this.eventCallbacks.set(e,t),this.logger.verbose(`Event callback registered with id: ${e}`),e}return null}removeEventCallback(t){this.eventCallbacks.delete(t),this.logger.verbose(`Event callback ${t} removed.`)}enableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(t,e,n,i){if("undefined"!=typeof window){const o={eventType:t,interactionType:e||null,payload:n||null,error:i||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${t}`),this.eventCallbacks.forEach(((e,n)=>{this.logger.verbose(`Emitting event to callback ${n}: ${t}`),e.apply(null,[o])}))}}handleAccountCacheChange(t){try{const e=t.newValue||t.oldValue;if(!e)return;const n=JSON.parse(e);if("object"!=typeof n||!j.r.isAccountEntity(n))return;const i=K.L.toObject(new j.r,n).getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent("msal:accountAdded",void 0,i)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent("msal:accountRemoved",void 0,i))}catch(t){return}}}class Et{static generateThrottlingStorageKey(t){return`${l.bb.THROTTLING_PREFIX}.${JSON.stringify(t)}`}static preProcess(t,e){const n=Et.generateThrottlingStorageKey(e),i=t.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now())return void t.removeItem(n);throw new G(i.errorCodes?.join(" ")||l.gT.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(t,e,n){if(Et.checkResponseStatus(n)||Et.checkResponseForRetryAfter(n)){const i={throttleTime:Et.calculateThrottleTime(parseInt(n.headers[l.SZ.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(Et.generateThrottlingStorageKey(e),i)}}static checkResponseStatus(t){return 429===t.status||t.status>=500&&t.status<600}static checkResponseForRetryAfter(t){return!!t.headers&&t.headers.hasOwnProperty(l.SZ.RETRY_AFTER)&&(t.status<200||t.status>=300)}static calculateThrottleTime(t){const e=t<=0?0:t,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(e||l.bb.DEFAULT_THROTTLE_TIME_SECONDS),n+l.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(t,e,n,i){const o={clientId:e,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:i,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},r=this.generateThrottlingStorageKey(o);t.removeItem(r)}}var Nt=n(8940),Pt=n(6148);class Ht{constructor(t,e){this.networkClient=t,this.cacheManager=e}async sendPostRequest(t,e,n){let i;Et.preProcess(this.cacheManager,t);try{i=await this.networkClient.sendPostRequestAsync(e,n)}catch(t){throw t instanceof o.l4?t:(0,F.zP)(B.EF)}return Et.postProcess(this.cacheManager,t,i),i}}var Ot=n(3079),Ut=n(2521),Mt=n(2400),Dt=n(2581);class Ft{static validateRedirectUri(t){if(!t)throw(0,D.ei)(q.RV)}static validatePrompt(t){const e=[];for(const t in l.NJ)e.push(l.NJ[t]);if(e.indexOf(t)<0)throw(0,D.ei)(q.z_)}static validateClaims(t){try{JSON.parse(t)}catch(t){throw(0,D.ei)(q.nm)}}static validateCodeChallengeParams(t,e){if(!t||!e)throw(0,D.ei)(q.TU);this.validateCodeChallengeMethod(e)}static validateCodeChallengeMethod(t){if([l.VX.PLAIN,l.VX.S256].indexOf(t)<0)throw(0,D.ei)(q.d6)}static sanitizeEQParams(t,e){return t?(e.forEach(((e,n)=>{t[n]&&delete t[n]})),Object.fromEntries(Object.entries(t).filter((t=>""!==t[1])))):{}}}class xt{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(l.Fo.RESPONSE_TYPE,encodeURIComponent(l.gT.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(l.Fo.RESPONSE_TYPE,encodeURIComponent(`${l.gT.TOKEN_RESPONSE_TYPE} ${l.gT.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(t){this.parameters.set(l.Fo.RESPONSE_MODE,encodeURIComponent(t||l.vw.QUERY))}addNativeBroker(){this.parameters.set(l.Fo.NATIVE_BROKER,encodeURIComponent("1"))}addScopes(t,e=!0,n=l.f_){!e||n.includes("openid")||t.includes("openid")||n.push("openid");const i=e?[...t||[],...n]:t||[],o=new Dt.i(i);this.parameters.set(l.Fo.SCOPE,encodeURIComponent(o.printScopes()))}addClientId(t){this.parameters.set(l.Fo.CLIENT_ID,encodeURIComponent(t))}addRedirectUri(t){Ft.validateRedirectUri(t),this.parameters.set(l.Fo.REDIRECT_URI,encodeURIComponent(t))}addPostLogoutRedirectUri(t){Ft.validateRedirectUri(t),this.parameters.set(l.Fo.POST_LOGOUT_URI,encodeURIComponent(t))}addIdTokenHint(t){this.parameters.set(l.Fo.ID_TOKEN_HINT,encodeURIComponent(t))}addDomainHint(t){this.parameters.set(l.VO.DOMAIN_HINT,encodeURIComponent(t))}addLoginHint(t){this.parameters.set(l.VO.LOGIN_HINT,encodeURIComponent(t))}addCcsUpn(t){this.parameters.set(l.SZ.CCS_HEADER,encodeURIComponent(`UPN:${t}`))}addCcsOid(t){this.parameters.set(l.SZ.CCS_HEADER,encodeURIComponent(`Oid:${t.uid}@${t.utid}`))}addSid(t){this.parameters.set(l.VO.SID,encodeURIComponent(t))}addClaims(t,e){const n=this.addClientCapabilitiesToClaims(t,e);Ft.validateClaims(n),this.parameters.set(l.Fo.CLAIMS,encodeURIComponent(n))}addCorrelationId(t){this.parameters.set(l.Fo.CLIENT_REQUEST_ID,encodeURIComponent(t))}addLibraryInfo(t){this.parameters.set(l.Fo.X_CLIENT_SKU,t.sku),this.parameters.set(l.Fo.X_CLIENT_VER,t.version),t.os&&this.parameters.set(l.Fo.X_CLIENT_OS,t.os),t.cpu&&this.parameters.set(l.Fo.X_CLIENT_CPU,t.cpu)}addApplicationTelemetry(t){t?.appName&&this.parameters.set(l.Fo.X_APP_NAME,t.appName),t?.appVersion&&this.parameters.set(l.Fo.X_APP_VER,t.appVersion)}addPrompt(t){Ft.validatePrompt(t),this.parameters.set(`${l.Fo.PROMPT}`,encodeURIComponent(t))}addState(t){t&&this.parameters.set(l.Fo.STATE,encodeURIComponent(t))}addNonce(t){this.parameters.set(l.Fo.NONCE,encodeURIComponent(t))}addCodeChallengeParams(t,e){if(Ft.validateCodeChallengeParams(t,e),!t||!e)throw(0,D.ei)(q.TU);this.parameters.set(l.Fo.CODE_CHALLENGE,encodeURIComponent(t)),this.parameters.set(l.Fo.CODE_CHALLENGE_METHOD,encodeURIComponent(e))}addAuthorizationCode(t){this.parameters.set(l.Fo.CODE,encodeURIComponent(t))}addDeviceCode(t){this.parameters.set(l.Fo.DEVICE_CODE,encodeURIComponent(t))}addRefreshToken(t){this.parameters.set(l.Fo.REFRESH_TOKEN,encodeURIComponent(t))}addCodeVerifier(t){this.parameters.set(l.Fo.CODE_VERIFIER,encodeURIComponent(t))}addClientSecret(t){this.parameters.set(l.Fo.CLIENT_SECRET,encodeURIComponent(t))}addClientAssertion(t){t&&this.parameters.set(l.Fo.CLIENT_ASSERTION,encodeURIComponent(t))}addClientAssertionType(t){t&&this.parameters.set(l.Fo.CLIENT_ASSERTION_TYPE,encodeURIComponent(t))}addOboAssertion(t){this.parameters.set(l.Fo.OBO_ASSERTION,encodeURIComponent(t))}addRequestTokenUse(t){this.parameters.set(l.Fo.REQUESTED_TOKEN_USE,encodeURIComponent(t))}addGrantType(t){this.parameters.set(l.Fo.GRANT_TYPE,encodeURIComponent(t))}addClientInfo(){this.parameters.set(l.sR,"1")}addExtraQueryParameters(t){const e=Ft.sanitizeEQParams(t,this.parameters);Object.keys(e).forEach((e=>{this.parameters.set(e,t[e])}))}addClientCapabilitiesToClaims(t,e){let n;if(t)try{n=JSON.parse(t)}catch(t){throw(0,D.ei)(q.nm)}else n={};return e&&e.length>0&&(n.hasOwnProperty(l.As.ACCESS_TOKEN)||(n[l.As.ACCESS_TOKEN]={}),n[l.As.ACCESS_TOKEN][l.As.XMS_CC]={values:e}),JSON.stringify(n)}addUsername(t){this.parameters.set(l.Ge.username,encodeURIComponent(t))}addPassword(t){this.parameters.set(l.Ge.password,encodeURIComponent(t))}addPopToken(t){t&&(this.parameters.set(l.Fo.TOKEN_TYPE,l.hO.POP),this.parameters.set(l.Fo.REQ_CNF,encodeURIComponent(t)))}addSshJwk(t){t&&(this.parameters.set(l.Fo.TOKEN_TYPE,l.hO.SSH),this.parameters.set(l.Fo.REQ_CNF,encodeURIComponent(t)))}addServerTelemetry(t){this.parameters.set(l.Fo.X_CLIENT_CURR_TELEM,t.generateCurrentRequestHeaderValue()),this.parameters.set(l.Fo.X_CLIENT_LAST_TELEM,t.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(l.Fo.X_MS_LIB_CAPABILITY,l.bb.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(t){this.parameters.set(l.Fo.LOGOUT_HINT,encodeURIComponent(t))}createQueryString(){const t=new Array;return this.parameters.forEach(((e,n)=>{t.push(`${n}=${e}`)})),t.join("&")}}class qt{constructor(t,e){this.config=(0,Pt.j6)(t),this.logger=new Ot.Y(this.config.loggerOptions,Ut.u,Ut.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Ht(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=e}createTokenRequestHeaders(t){const e={};if(e[l.SZ.CONTENT_TYPE]=l.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case it:try{const n=(0,Mt.j)(t.credential);e[l.SZ.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case ot:e[l.SZ.CCS_HEADER]=`UPN: ${t.credential}`}return e}async executePostToTokenEndpoint(t,e,n,o,r){this.performanceClient?.addQueueMeasurement(i.Ak.BaseClientExecutePostToTokenEndpoint,r);const s=await this.networkManager.sendPostRequest(o,t,{body:e,headers:n});return this.performanceClient?.addFields({refreshTokenSize:s.body.refresh_token?.length||0,httpVerToken:s.headers?.[l.SZ.X_MS_HTTP_VERSION]||""},r),this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}updateAuthority(t){if(!t.discoveryComplete())throw(0,F.zP)(B.HO);this.authority=t}createTokenQueryParameters(t){const e=new xt;return t.tokenQueryParameters&&e.addExtraQueryParameters(t.tokenQueryParameters),e.createQueryString()}}class Bt{constructor(t,e){this.cryptoUtils=t,this.performanceClient=e}async generateCnf(t,e){this.performanceClient?.addQueueMeasurement(i.Ak.PopTokenGenerateCnf,t.correlationId);const n=await M(this.generateKid.bind(this),i.Ak.PopTokenGenerateCnf,e,this.performanceClient,t.correlationId)(t),o=this.cryptoUtils.base64Encode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o,reqCnfHash:await this.cryptoUtils.hashString(o)}}async generateKid(t){return this.performanceClient?.addQueueMeasurement(i.Ak.PopTokenGenerateKid,t.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(t),xms_ksl:"sw"}}async signPopToken(t,e,n){return this.signPayload(t,e,n)}async signPayload(t,e,n,i){const{resourceRequestMethod:o,resourceRequestUri:r,shrClaims:s,shrNonce:a}=n,c=r?new L(r):void 0,u=c?.getUrlComponents();return await this.cryptoUtils.signJwt({at:t,ts:V.nowSeconds(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0,...i},e,n.correlationId)}}class Lt{constructor(t,e){this.cache=t,this.hasChanged=e}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Wt{constructor(t,e,n,i,o,r,s){this.clientId=t,this.cacheStorage=e,this.cryptoObj=n,this.logger=i,this.serializableCache=o,this.persistencePlugin=r,this.performanceClient=s}validateServerAuthorizationCodeResponse(t,e,n){if(!t.state||!e)throw t.state?(0,F.zP)(B.LV,"Cached State"):(0,F.zP)(B.LV,"Server State");let i,o;try{i=decodeURIComponent(t.state)}catch(e){throw(0,F.zP)(B.r8,t.state)}try{o=decodeURIComponent(e)}catch(e){throw(0,F.zP)(B.r8,t.state)}if(i!==o)throw(0,F.zP)(B.Tu);if(t.error||t.error_description||t.suberror){if((0,W.Cf)(t.error,t.error_description,t.suberror))throw new W.Yo(t.error||l.gT.EMPTY_STRING,t.error_description,t.suberror,t.timestamp||l.gT.EMPTY_STRING,t.trace_id||l.gT.EMPTY_STRING,t.correlation_id||l.gT.EMPTY_STRING,t.claims||l.gT.EMPTY_STRING);throw new G(t.error||l.gT.EMPTY_STRING,t.error_description,t.suberror)}t.client_info&&(0,Mt.B)(t.client_info,n)}validateTokenResponse(t,e){if(t.error||t.error_description||t.suberror){const n=`${t.error_codes} - [${t.timestamp}]: ${t.error_description} - Correlation ID: ${t.correlation_id} - Trace ID: ${t.trace_id}`,i=new G(t.error,n,t.suberror);if(e&&t.status&&t.status>=l.oj.SERVER_ERROR_RANGE_START&&t.status<=l.oj.SERVER_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(e&&t.status&&t.status>=l.oj.CLIENT_ERROR_RANGE_START&&t.status<=l.oj.CLIENT_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);if((0,W.Cf)(t.error,t.error_description,t.suberror))throw new W.Yo(t.error,t.error_description,t.suberror,t.timestamp||l.gT.EMPTY_STRING,t.trace_id||l.gT.EMPTY_STRING,t.correlation_id||l.gT.EMPTY_STRING,t.claims||l.gT.EMPTY_STRING);throw i}}async handleServerTokenResponse(t,e,n,o,r,s,a,c,u){let h,d;if(this.performanceClient?.addQueueMeasurement(i.Ak.HandleServerTokenResponse,t.correlation_id),t.id_token){if(h=(0,J.Z_)(t.id_token||l.gT.EMPTY_STRING,this.cryptoObj.base64Decode),r&&r.nonce&&h.nonce!==r.nonce)throw(0,F.zP)(B.vR);if(o.maxAge||0===o.maxAge){const t=h.auth_time;if(!t)throw(0,F.zP)(B.w7);(0,J.ky)(t,o.maxAge)}}this.homeAccountIdentifier=j.r.generateHomeAccountId(t.client_info||l.gT.EMPTY_STRING,e.authorityType,this.logger,this.cryptoObj,h),r&&r.state&&(d=nt.parseRequestState(this.cryptoObj,r.state)),t.key_id=t.key_id||o.sshKid||void 0;const f=this.generateCacheRecord(t,e,n,o,h,s,r);let p;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Lt(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(p)),a&&!c&&f.account){const t=f.account.generateAccountKey();if(!this.cacheStorage.getAccount(t))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),Wt.generateAuthenticationResult(this.cryptoObj,e,f,!1,o,h,d,void 0,u)}await this.cacheStorage.saveCacheRecord(f,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&p&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(p))}return Wt.generateAuthenticationResult(this.cryptoObj,e,f,!1,o,h,d,t,u)}generateCacheRecord(t,e,n,i,o,r,s){const a=e.getPreferredCache();if(!a)throw(0,F.zP)(B.Q9);let c,u;t.id_token&&o&&(c=$.createIdTokenEntity(this.homeAccountIdentifier,a,t.id_token,this.clientId,o.tid||""),u=j.r.createAccount({homeAccountId:this.homeAccountIdentifier,idTokenClaims:o,clientInfo:t.client_info,cloudGraphHostName:s?.cloud_graph_host_name,msGraphHost:s?.msgraph_host},e));let h=null;if(t.access_token){const s=t.scope?Dt.i.fromString(t.scope):new Dt.i(i.scopes||[]),c=("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,u=("string"==typeof t.ext_expires_in?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,d=("string"==typeof t.refresh_in?parseInt(t.refresh_in,10):t.refresh_in)||void 0,f=n+c,p=f+u,v=d&&d>0?n+d:void 0;h=Q.createAccessTokenEntity(this.homeAccountIdentifier,a,t.access_token||l.gT.EMPTY_STRING,this.clientId,o?.tid||e.tenant,s.printScopes(),f,p,this.cryptoObj,v,t.token_type,r,t.key_id,i.claims,i.requestedClaimsHash)}let d=null;t.refresh_token&&(d=X.createRefreshTokenEntity(this.homeAccountIdentifier,a,t.refresh_token||l.gT.EMPTY_STRING,this.clientId,t.foci,r));let f=null;return t.foci&&(f=Y.createAppMetadataEntity(this.clientId,a,t.foci)),new rt(u,c,h,d,f)}static async generateAuthenticationResult(t,e,n,i,o,r,s,a,c){let u,h,d=l.gT.EMPTY_STRING,f=[],p=null,v=l.gT.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===l.hO.POP){const e=new Bt(t),{secret:i,keyId:r}=n.accessToken;if(!r)throw(0,F.zP)(B.Of);d=await e.signPopToken(i,r,o)}else d=n.accessToken.secret;f=Dt.i.fromString(n.accessToken.target).asArray(),p=new Date(1e3*Number(n.accessToken.expiresOn)),u=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&(h=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(v=n.appMetadata.familyId===l.ch?l.ch:"");const m=r?.oid||r?.sub||"",g=r?.tid||"";return a?.spa_accountid&&n.account&&(n.account.nativeAccountId=a?.spa_accountid),{authority:e.canonicalAuthority,uniqueId:m,tenantId:g,scopes:f,account:n.account?n.account.getAccountInfo():null,idToken:n?.idToken?.secret||"",idTokenClaims:r||{},accessToken:d,fromCache:i,expiresOn:p,extExpiresOn:u,refreshOn:h,correlationId:o.correlationId,requestId:c||l.gT.EMPTY_STRING,familyId:v,tokenType:n.accessToken?.tokenType||l.gT.EMPTY_STRING,state:s?s.userRequestState:l.gT.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||l.gT.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||l.gT.EMPTY_STRING,code:a?.spa_code,fromNativeBroker:!1}}}class jt extends qt{constructor(t,e){super(t,e),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(t){this.performanceClient?.addQueueMeasurement(i.Ak.GetAuthCodeUrl,t.correlationId);const e=await M(this.createAuthCodeUrlQueryString.bind(this),i.Ak.AuthClientCreateQueryString,this.logger,this.performanceClient,t.correlationId)(t);return L.appendQueryString(this.authority.authorizationEndpoint,e)}async acquireToken(t,e){if(this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientAcquireToken,t.correlationId),!t.code)throw(0,F.zP)(B.FU);const n=V.nowSeconds(),o=await M(this.executeTokenRequest.bind(this),i.Ak.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(this.authority,t),r=o.headers?.[l.SZ.X_MS_REQUEST_ID],s=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),M(s.handleServerTokenResponse.bind(s),i.Ak.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(o.body,this.authority,n,t,e,void 0,void 0,void 0,r)}handleFragmentResponse(t,e){const n=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),i=L.getDeserializedCodeResponse(this.config.authOptions.authority.options.OIDCOptions?.serverResponseType,t);if(n.validateServerAuthorizationCodeResponse(i,e,this.cryptoUtils),!i.code)throw(0,F.zP)(B.Zv);return{...i,code:i.code}}getLogoutUri(t){if(!t)throw(0,D.ei)(q.$h);const e=this.createLogoutUrlQueryString(t);return L.appendQueryString(this.authority.endSessionEndpoint,e)}async executeTokenRequest(t,e){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientExecuteTokenRequest,e.correlationId);const n=this.createTokenQueryParameters(e),o=L.appendQueryString(t.tokenEndpoint,n),r=await M(this.createTokenRequestBody.bind(this),i.Ak.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e);let s;if(e.clientInfo)try{const t=(0,Mt.B)(e.clientInfo,this.cryptoUtils);s={credential:`${t.uid}${l.Bv.CLIENT_INFO_SEPARATOR}${t.utid}`,type:it}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}const a=this.createTokenRequestHeaders(s||e.ccsCredential),c={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return M(this.executePostToTokenEndpoint.bind(this),i.Ak.BaseClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,r,a,c,e.correlationId)}async createTokenRequestBody(t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientCreateTokenRequestBody,t.correlationId);const e=new xt;if(e.addClientId(t.tokenBodyParameters?.[l.Fo.CLIENT_ID]||this.config.authOptions.clientId),this.includeRedirectUri?e.addRedirectUri(t.redirectUri):Ft.validateRedirectUri(t.redirectUri),e.addScopes(t.scopes,!0,this.oidcDefaultScopes),e.addAuthorizationCode(t.code),e.addLibraryInfo(this.config.libraryInfo),e.addApplicationTelemetry(this.config.telemetry.application),e.addThrottling(),this.serverTelemetryManager&&!(0,Pt.lh)(this.config)&&e.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&e.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&e.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;e.addClientAssertion(t.assertion),e.addClientAssertionType(t.assertionType)}if(e.addGrantType(l.qJ.AUTHORIZATION_CODE_GRANT),e.addClientInfo(),t.authenticationScheme===l.hO.POP){const n=new Bt(this.cryptoUtils,this.performanceClient),o=await M(n.generateCnf.bind(n),i.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);e.addPopToken(o.reqCnfString)}else if(t.authenticationScheme===l.hO.SSH){if(!t.sshJwk)throw(0,D.ei)(q.dK);e.addSshJwk(t.sshJwk)}const n=t.correlationId||this.config.cryptoInterface.createNewGuid();let o;if(e.addCorrelationId(n),(!x.x.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&e.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.clientInfo)try{const e=(0,Mt.B)(t.clientInfo,this.cryptoUtils);o={credential:`${e.uid}${l.Bv.CLIENT_INFO_SEPARATOR}${e.utid}`,type:it}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}else o=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case it:try{const t=(0,Mt.j)(o.credential);e.addCcsOid(t)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case ot:e.addCcsUpn(o.credential)}return t.tokenBodyParameters&&e.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[l.Fo.RETURN_SPA_CODE]||e.addExtraQueryParameters({[l.Fo.RETURN_SPA_CODE]:"1"}),e.createQueryString()}async createAuthCodeUrlQueryString(t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthClientCreateQueryString,t.correlationId);const e=new xt;e.addClientId(t.extraQueryParameters?.[l.Fo.CLIENT_ID]||this.config.authOptions.clientId);const n=[...t.scopes||[],...t.extraScopesToConsent||[]];e.addScopes(n,!0,this.oidcDefaultScopes),e.addRedirectUri(t.redirectUri);const o=t.correlationId||this.config.cryptoInterface.createNewGuid();if(e.addCorrelationId(o),e.addResponseMode(t.responseMode),e.addResponseTypeCode(),e.addLibraryInfo(this.config.libraryInfo),(0,Pt.lh)(this.config)||e.addApplicationTelemetry(this.config.telemetry.application),e.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&e.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&e.addPrompt(t.prompt),t.domainHint&&e.addDomainHint(t.domainHint),t.prompt!==l.NJ.SELECT_ACCOUNT)if(t.sid&&t.prompt===l.NJ.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),e.addSid(t.sid);else if(t.account){const n=this.extractAccountSid(t.account),i=this.extractLoginHint(t.account);if(i){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),e.addLoginHint(i);try{const n=(0,Mt.j)(t.account.homeAccountId);e.addCcsOid(n)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(n&&t.prompt===l.NJ.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),e.addSid(n);try{const n=(0,Mt.j)(t.account.homeAccountId);e.addCcsOid(n)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),e.addLoginHint(t.loginHint),e.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),e.addLoginHint(t.account.username);try{const n=(0,Mt.j)(t.account.homeAccountId);e.addCcsOid(n)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),e.addLoginHint(t.loginHint),e.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(t.nonce&&e.addNonce(t.nonce),t.state&&e.addState(t.state),(t.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&e.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&e.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker&&(e.addNativeBroker(),t.authenticationScheme===l.hO.POP)){const n=new Bt(this.cryptoUtils),o=await M(n.generateCnf.bind(n),i.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);e.addPopToken(o.reqCnfHash)}return e.createQueryString()}createLogoutUrlQueryString(t){const e=new xt;return t.postLogoutRedirectUri&&e.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&e.addCorrelationId(t.correlationId),t.idTokenHint&&e.addIdTokenHint(t.idTokenHint),t.state&&e.addState(t.state),t.logoutHint&&e.addLogoutHint(t.logoutHint),t.extraQueryParameters&&e.addExtraQueryParameters(t.extraQueryParameters),e.createQueryString()}extractAccountSid(t){return t.idTokenClaims?.sid||null}extractLoginHint(t){return t.idTokenClaims?.login_hint||null}}var Gt=n(9641);const Kt={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},zt={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},$t=new Set;for(const t in zt)for(const e of zt[t].metadata)for(const t of e.aliases)$t.add(t);var Vt=n(1120);class Jt{constructor(t,e,n,i){this.networkInterface=t,this.logger=e,this.performanceClient=n,this.correlationId=i}async detectRegion(t,e){this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryDetectRegion,this.correlationId);let n=t;if(n)e.region_source=l.W.ENVIRONMENT_VARIABLE;else{const t=Jt.IMDS_OPTIONS;try{const o=await M(this.getRegionFromIMDS.bind(this),i.Ak.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(l.gT.IMDS_VERSION,t);if(o.status===l.YY.httpSuccess&&(n=o.body,e.region_source=l.W.IMDS),o.status===l.YY.httpBadRequest){const o=await M(this.getCurrentVersion.bind(this),i.Ak.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(t);if(!o)return e.region_source=l.W.FAILED_AUTO_DETECTION,null;const r=await M(this.getRegionFromIMDS.bind(this),i.Ak.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(o,t);r.status===l.YY.httpSuccess&&(n=r.body,e.region_source=l.W.IMDS)}}catch(t){return e.region_source=l.W.FAILED_AUTO_DETECTION,null}}return n||(e.region_source=l.W.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(t,e){return this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${l.gT.IMDS_ENDPOINT}?api-version=${t}&format=text`,e,l.gT.IMDS_TIMEOUT)}async getCurrentVersion(t){this.performanceClient?.addQueueMeasurement(i.Ak.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const e=await this.networkInterface.sendGetRequestAsync(`${l.gT.IMDS_ENDPOINT}?format=json`,t);return e.status===l.YY.httpBadRequest&&e.body&&e.body["newest-versions"]&&e.body["newest-versions"].length>0?e.body["newest-versions"][0]:null}catch(t){return null}}}Jt.IMDS_OPTIONS={headers:{Metadata:"true"}};class Qt{constructor(t,e,n,i,o,r,s){this.canonicalAuthority=t,this.Ai.validateAsUri(),this.networkInterface=e,this.cacheManager=n,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=r,this.correlationId=s,this.regionDiscovery=new Jt(e,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(t){if(t.HostNameAndPort.endsWith(l.gT.CIAM_AUTH_URL))return Gt.a.Ciam;const e=t.PathSegments;if(e.length)switch(e[0].toLowerCase()){case l.gT.ADFS:return Gt.a.Adfs;case l.gT.DSTS:return Gt.a.Dsts}return Gt.a.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this.Ai.urlString}set canonicalAuthority(t){this.Ai=new L(t),this.Ai.validateAsUri(),this.Ii=null}get canonicalAuthorityUrlComponents(){return this.Ii||(this.Ii=this.Ai.getUrlComponents()),this.Ii}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw(0,F.zP)(B.HO)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw(0,F.zP)(B.HO)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw(0,F.zP)(B.HO)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw(0,F.zP)(B.ig);return this.replacePath(this.metadata.end_session_endpoint)}throw(0,F.zP)(B.HO)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw(0,F.zP)(B.HO)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw(0,F.zP)(B.HO)}canReplaceTenant(t){return 1===t.PathSegments.length&&!Qt.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===Gt.a.Default&&this.protocolMode===Nt.A.AAD}replaceTenant(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(t){let e=t;const n=new L(this.metadata.canonical_authority).getUrlComponents(),i=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((t,o)=>{let r=i[o];if(0===o&&this.canReplaceTenant(n)){const t=new L(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];r!==t&&(this.logger.verbose(`Replacing tenant domain name ${r} with id ${t}`),r=t)}t!==r&&(e=e.replace(`/${r}/`,`/${t}/`))})),this.replaceTenant(e)}get defaultOpenIdConfigurationEndpoint(){const t=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Gt.a.Adfs||this.protocolMode!==Nt.A.AAD&&!this.isAliasOfKnownMicrosoftAuthority(t)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityResolveEndpointsAsync,this.correlationId);let t=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);t||(t=new tt,t.updateCanonicalAuthority(this.canonicalAuthority));const e=await M(this.updateCloudDiscoveryMetadata.bind(this),i.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(t);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,t.preferred_network);const n=await M(this.updateEndpointMetadata.bind(this),i.Ak.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(t);e!==l.pQ.CACHE&&n!==l.pQ.CACHE&&(t.resetExpiresAt(),t.updateCanonicalAuthority(this.canonicalAuthority));const o=this.cacheManager.generateAuthorityMetadataCacheKey(t.preferred_cache);this.cacheManager.setAuthorityMetadata(o,t),this.metadata=t}async updateEndpointMetadata(t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateEndpointMetadata,this.correlationId),this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let e=this.getEndpointMetadataFromConfig();if(e)return this.logger.verbose("Found endpoint metadata in authority configuration"),t.updateEndpointMetadata(e,!1),l.pQ.CONFIG;if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let e=this.getEndpointMetadataFromHardcodedValues();if(e)return this.logger.verbose("Found endpoint metadata from hardcoded values."),this.authorityOptions.azureRegionConfiguration?.azureRegion&&(e=await M(this.updateMetadataWithRegionalInformation.bind(this),i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(e)),t.updateEndpointMetadata(e,!1),l.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=t.isExpired();if(this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!n)return this.logger.verbose("Found endpoint metadata in the cache."),l.pQ.CACHE;if(n&&this.logger.verbose("The metadata entity is expired."),e=await M(this.getEndpointMetadataFromNetwork.bind(this),i.Ak.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)(),e)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(e=await M(this.updateMetadataWithRegionalInformation.bind(this),i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(e)),t.updateEndpointMetadata(e,!0),l.pQ.NETWORK;throw(0,F.zP)(B.Ce,this.defaultOpenIdConfigurationEndpoint)}isAuthoritySameType(t){return new L(t.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(t){throw(0,D.ei)(q.zx)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const t={},e=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${e}`);try{const n=await this.networkInterface.sendGetRequestAsync(e,t),i=function(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}(n.body);return i?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(t){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${t}`),null}}getEndpointMetadataFromHardcodedValues(){return this.canonicalAuthority in Kt?Kt[this.canonicalAuthority]:null}async updateMetadataWithRegionalInformation(t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const e=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(e){if(e!==l.gT.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=l.ki.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=e,Qt.replaceWithRegionalInformation(t,e);const n=await M(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),i.Ak.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=l.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,Qt.replaceWithRegionalInformation(t,n);this.regionDiscoveryMetadata.region_outcome=l.ki.AUTO_DETECTION_REQUESTED_FAILED}return t}async updateCloudDiscoveryMetadata(t){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||l.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||l.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${t.canonical_authority||l.gT.NOT_APPLICABLE}`);let e=this.getCloudDiscoveryMetadataFromConfig();if(e)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),t.updateCloudDiscoveryMetadata(e,!1),l.pQ.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const e=this.getCloudDiscoveryMetadataFromHardcodedValues();if(e)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),t.updateCloudDiscoveryMetadata(e,!1),l.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const n=t.isExpired();if(this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!n)return this.logger.verbose("Found cloud discovery metadata in the cache."),l.pQ.CACHE;if(n&&this.logger.verbose("The metadata entity is expired."),e=await M(this.getCloudDiscoveryMetadataFromNetwork.bind(this),i.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)(),e)return t.updateCloudDiscoveryMetadata(e,!0),l.pQ.NETWORK;throw(0,D.ei)(q.o_)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Gt.a.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Qt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),e=Qt.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(t){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),(0,D.ei)(q.E)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Qt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(i.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const t=`${l.gT.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,e={};let n=null;try{const i=await this.networkInterface.sendGetRequestAsync(t,e);let o,r;if(function(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}(i.body))o=i.body,r=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),o=i.body,o.error===l.gT.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),r=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Qt.getCloudDiscoveryMetadataFromNetworkResponse(r,this.hostnameAndPort)}catch(t){if(t instanceof o.l4)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${t.errorCode}\nError Description: ${t.errorMessage}`);else{const e=t;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${e.name}\nError Description: ${e.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=Qt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}getCloudDiscoveryMetadataFromHardcodedValues(){if(this.canonicalAuthority in zt){const t=zt[this.canonicalAuthority];return Qt.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort)}return null}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((t=>L.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(t,e){let n;if(e&&e.azureCloudInstance!==Vt.z.None){const t=e.tenant?e.tenant:l.gT.DEFAULT_COMMON_TENANT;n=`${e.azureCloudInstance}/${t}/`}return n||t}static createCloudDiscoveryMetadataFromHost(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}}static getCloudDiscoveryMetadataFromNetworkResponse(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i.aliases.indexOf(e)>-1)return i}return null}getPreferredCache(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw(0,F.zP)(B.HO)}isAlias(t){return this.metadata.aliases.indexOf(t)>-1}isAliasOfKnownMicrosoftAuthority(t){return $t.has(t)}static isPublicCloudAuthority(t){return l.gT.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0}static buildRegionalAuthorityString(t,e,n){const i=new L(t);i.validateAsUri();const o=i.getUrlComponents();let r=`${e}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(r=`${e}.${l.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=L.constructAuthorityUriFromObject({...i.getUrlComponents(),HostNameAndPort:r}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(t,e){const n={...t};return n.authorization_endpoint=Qt.buildRegionalAuthorityString(n.authorization_endpoint,e),n.token_endpoint=Qt.buildRegionalAuthorityString(n.token_endpoint,e,l.gT.REGIONAL_AUTH_NON_MSI_QUERY_STRING),n.end_session_endpoint&&(n.end_session_endpoint=Qt.buildRegionalAuthorityString(n.end_session_endpoint,e)),n}static transformCIAMAuthority(t){let e=t.endsWith(l.gT.FORWARD_SLASH)?t:`${t}${l.gT.FORWARD_SLASH}`;const n=new L(t).getUrlComponents();return 0===n.PathSegments.length&&n.HostNameAndPort.endsWith(l.gT.CIAM_AUTH_URL)&&(e=`${e}${n.HostNameAndPort.split(".")[0]}${l.gT.AAD_TENANT_DOMAIN_SUFFIX}`),e}}Qt.reservedTenantDomains=new Set(["{tenant}","{tenantid}",l.Nb.COMMON,l.Nb.CONSUMERS,l.Nb.ORGANIZATIONS]);class Xt{static async createDiscoveredInstance(t,e,n,o,r,s,a){s?.addQueueMeasurement(i.Ak.AuthorityFactoryCreateDiscoveredInstance,a);const c=Qt.transformCIAMAuthority(t),u=Xt.createInstance(c,e,n,o,r,s,a);try{return await M(u.resolveEndpointsAsync.bind(u),i.Ak.AuthorityResolveEndpointsAsync,r,s,a)(),u}catch(t){throw(0,F.zP)(B.HO)}}static createInstance(t,e,n,i,o,r,s){if(!t)throw(0,D.ei)(q.To);return new Qt(t,e,n,i,o,r,s)}}class Yt{constructor(t,e){this.cacheOutcome=l.To.NOT_APPLICABLE,this.cacheManager=e,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||l.gT.EMPTY_STRING,this.wrapperVer=t.wrapperVer||l.gT.EMPTY_STRING,this.telemetryCacheKey=l.HN.CACHE_KEY+l.Bv.CACHE_KEY_SEPARATOR+t.clientId}generateCurrentRequestHeaderValue(){const t=`${this.apiId}${l.HN.VALUE_SEPARATOR}${this.cacheOutcome}`,e=[this.wrapperSKU,this.wrapperVer].join(l.HN.VALUE_SEPARATOR),n=[t,this.getRegionDiscoveryFields()].join(l.HN.VALUE_SEPARATOR);return[l.HN.SCHEMA_VERSION,n,e].join(l.HN.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const t=this.getLastRequests(),e=Yt.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*e).join(l.HN.VALUE_SEPARATOR),i=t.errors.slice(0,e).join(l.HN.VALUE_SEPARATOR),o=t.errors.length,r=[o,e<o?l.HN.OVERFLOW_TRUE:l.HN.OVERFLOW_FALSE].join(l.HN.VALUE_SEPARATOR);return[l.HN.SCHEMA_VERSION,t.cacheHits,n,i,r].join(l.HN.CATEGORY_SEPARATOR)}cacheFailedRequest(t){const e=this.getLastRequests();e.errors.length>=l.HN.MAX_CACHED_ERRORS&&(e.failedRequests.shift(),e.failedRequests.shift(),e.errors.shift()),e.failedRequests.push(this.apiId,this.correlationId),t instanceof Error&&t&&t.toString()?t instanceof o.l4?t.subError?e.errors.push(t.subError):t.errorCode?e.errors.push(t.errorCode):e.errors.push(t.toString()):e.errors.push(t.toString()):e.errors.push(l.HN.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}incrementCacheHits(){const t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t),t.cacheHits}getLastRequests(){const t=new Z;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||t}clearTelemetryCache(){const t=this.getLastRequests(),e=Yt.maxErrorsToSend(t);if(e===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const n=new Z;n.failedRequests=t.failedRequests.slice(2*e),n.errors=t.errors.slice(e),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}}static maxErrorsToSend(t){let e,n=0,i=0;const o=t.errors.length;for(e=0;e<o;e++){const o=t.failedRequests[2*e]||l.gT.EMPTY_STRING,r=t.failedRequests[2*e+1]||l.gT.EMPTY_STRING,s=t.errors[e]||l.gT.EMPTY_STRING;if(i+=o.toString().length+r.toString().length+s.length+3,!(i<l.HN.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const t=[];return t.push(this.regionUsed||l.gT.EMPTY_STRING),t.push(this.regionSource||l.gT.EMPTY_STRING),t.push(this.regionOutcome||l.gT.EMPTY_STRING),t.join(",")}updateRegionDiscoveryMetadata(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome}setCacheOutcome(t){this.cacheOutcome=t}}var Zt=n(79);class te{constructor(t,e,n,i,o,r,s,a,c){this.config=t,this.browserStorage=e,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=r,this.nativeMessageHandler=a,this.correlationId=c||A(),this.logger=i.clone(_.qx.MSAL_SKU,Zt.i,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(t){if(t){j.r.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(j.r.generateAccountCacheKey(t)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(t){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}async initializeBaseRequest(t,e){this.performanceClient.addQueueMeasurement(i.Ak.InitializeBaseRequest,t.correlationId);const n=t.authority||this.config.auth.authority;e&&await this.validateRequestAuthority(n,e);const o=[...t&&t.scopes||[]],r={...t,correlationId:this.correlationId,authority:n,scopes:o};if(r.authenticationScheme){if(r.authenticationScheme===l.hO.SSH){if(!t.sshJwk)throw(0,D.ei)(q.dK);if(!t.sshKid)throw(0,D.ei)(q.hI)}this.logger.verbose(`Authentication Scheme set to "${r.authenticationScheme}" as configured in Auth request`)}else r.authenticationScheme=l.hO.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&t.claims&&!x.x.isEmptyObj(t.claims)&&(r.requestedClaimsHash=await this.browserCrypto.hashString(t.claims)),r}getRedirectUri(t){this.logger.verbose("getRedirectUri called");const e=t||this.config.auth.redirectUri||pt.getCurrentUri();return L.getAbsoluteUrl(e,pt.getCurrentUri())}async validateRequestAuthority(t,e){if(!(await this.getDiscoveredAuthority(t)).isAlias(e.environment))throw(0,D.ei)(q.Hv)}initializeServerTelemetryManager(t,e){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:e||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Yt(n,this.browserStorage)}async getDiscoveredAuthority(t){this.logger.verbose("getDiscoveredAuthority called");const e={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata};return t?(this.logger.verbose("Creating discovered authority with request authority"),await Xt.createDiscoveredInstance(t,this.config.system.networkClient,this.browserStorage,e,this.logger)):(this.logger.verbose("Creating discovered authority with configured authority"),await Xt.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,e,this.logger))}}const ee=32;async function ne(t,e,n){t.addQueueMeasurement(i.Ak.GeneratePkceCodes,n);const o=U(ie,i.Ak.GenerateCodeVerifier,e,t,n)(t,e,n);return{verifier:o,challenge:await M(oe,i.Ak.GenerateCodeChallengeFromVerifier,e,t,n)(o,t,e,n)}}function ie(t,e,n){try{const o=new Uint8Array(ee);return U(b,i.Ak.GetRandomValues,e,t,n)(o),f(o)}catch(t){throw(0,m.Z_)(g.vD)}}async function oe(t,e,n,o){e.addQueueMeasurement(i.Ak.GenerateCodeChallengeFromVerifier,o);try{const r=await M(T,i.Ak.Sha256Digest,n,e,o)(t,e,o);return f(new Uint8Array(r))}catch(t){throw(0,m.Z_)(g.vD)}}class re extends te{async initializeAuthorizationCodeRequest(t){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId);const e=await M(ne,i.Ak.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n={...t,redirectUri:t.redirectUri,code:l.gT.EMPTY_STRING,codeVerifier:e.verifier};return t.codeChallenge=e.challenge,t.codeChallengeMethod=l.gT.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);const e={correlationId:this.correlationId||A(),...t};if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){const n=this.getLogoutHintFromIdTokenClaims(t.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),e.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",e.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",e.correlationId),e.postLogoutRedirectUri=L.getAbsoluteUrl(t.postLogoutRedirectUri,pt.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",e.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",e.correlationId),e.postLogoutRedirectUri=L.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,pt.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",e.correlationId),e.postLogoutRedirectUri=L.getAbsoluteUrl(pt.getCurrentUri(),pt.getCurrentUri())),e}getLogoutHintFromIdTokenClaims(t){const e=t.idTokenClaims;if(e){if(e.login_hint)return e.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(t,e,n){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const o=await M(this.getClientConfiguration.bind(this),i.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t,e,n);return new jt(o,this.performanceClient)}async getClientConfiguration(t,e,n){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId);const o=await M(this.getDiscoveredAuthority.bind(this),i.Ak.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(e,n),r=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:r.loggerCallback,piiLoggingEnabled:r.piiLoggingEnabled,logLevel:r.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:_.qx.MSAL_SKU,version:Zt.i,cpu:l.gT.EMPTY_STRING,os:l.gT.EMPTY_STRING},telemetry:this.config.telemetry}}validateAndExtractStateFromHash(t,e,n){if(this.logger.verbose("validateAndExtractStateFromHash called",n),!t.state)throw(0,m.Z_)(g.Xk);const i=dt.extractBrowserRequestState(this.browserCrypto,t.state);if(!i)throw(0,m.Z_)(g.$P);if(i.interactionType!==e)throw(0,m.Z_)(g.yK);return this.logger.verbose("Returning state from hash",n),t.state}async getDiscoveredAuthority(t,e){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=t||this.config.auth.authority,r=Qt.generateAuthority(o,e||this.config.auth.azureCloudOptions);return await M(Xt.createDiscoveredInstance.bind(Xt),i.Ak.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(r,this.config.system.networkClient,this.browserStorage,n,this.logger,this.performanceClient,this.correlationId)}async initializeAuthorizationRequest(t,e){this.performanceClient.addQueueMeasurement(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const n=this.getRedirectUri(t.redirectUri),o={interactionType:e},r=nt.setRequestState(this.browserCrypto,t&&t.state||l.gT.EMPTY_STRING,o),s={...await M(this.initializeBaseRequest.bind(this),i.Ak.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(t),redirectUri:n,state:r,nonce:t.nonce||A(),responseMode:this.config.auth.OIDCOptions.serverResponseType},a=t.account||this.browserStorage.getActiveAccount();if(a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),s.account=a),!s.loginHint&&!a){const t=this.browserStorage.getLegacyLoginHint();t&&(s.loginHint=t)}return s}}var se=n(6108),ae=n(4180);const ce="user_switch",ue={[ce]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class le extends o.l4{constructor(t,e,n){super(t,e),Object.setPrototypeOf(this,le.prototype),this.name="NativeAuthError",this.ext=n}}function he(t){return!(!t.ext||!t.ext.status||"PERSISTENT_ERROR"!==t.ext.status&&"DISABLED"!==t.ext.status)||!(!t.ext||!t.ext.error||-2147186943!==t.ext.error)||"ContentError"===t.errorCode}function de(t,e,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return(0,W.ip)(ae.QP);case"USER_INTERACTION_REQUIRED":return new W.Yo(t,e);case"USER_CANCEL":return(0,m.Z_)(g.h7);case"NO_NETWORK":return(0,m.Z_)(g.Mq)}return new le(t,ue[t]||e,n)}class fe extends qt{constructor(t,e){super(t,e)}async acquireToken(t){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireToken,t.correlationId);const e=V.nowSeconds(),n=await M(this.executeTokenRequest.bind(this),i.Ak.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(t,this.authority),o=n.headers?.[l.SZ.X_MS_REQUEST_ID],r=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return r.validateTokenResponse(n.body),M(r.handleServerTokenResponse.bind(r),i.Ak.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(n.body,this.authority,e,t,void 0,void 0,!0,t.forceCache,o)}async acquireTokenByRefreshToken(t){if(!t)throw(0,D.ei)(q.dL);if(this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw(0,F.zP)(B.D7);if(this.cacheManager.isAppMetadataFOCI(t.account.environment))try{return M(this.acquireTokenWithCachedRefreshToken.bind(this),i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!0)}catch(e){const n=e instanceof W.Yo&&e.errorCode===ae.I2,o=e instanceof G&&e.errorCode===l.D1.INVALID_GRANT_ERROR&&e.subError===l.D1.CLIENT_MISMATCH_ERROR;if(n||o)return M(this.acquireTokenWithCachedRefreshToken.bind(this),i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1);throw e}return M(this.acquireTokenWithCachedRefreshToken.bind(this),i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1)}async acquireTokenWithCachedRefreshToken(t,e){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId);const n=this.cacheManager.getRefreshToken(t.account,e);if(!n)throw(0,W.ip)(ae.I2);const o={...t,refreshToken:n.secret,authenticationScheme:t.authenticationScheme||l.hO.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:it}};return M(this.acquireToken.bind(this),i.Ak.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(o)}async executeTokenRequest(t,e){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientExecuteTokenRequest,t.correlationId);const n=this.createTokenQueryParameters(t),o=L.appendQueryString(e.tokenEndpoint,n),r=await M(this.createTokenRequestBody.bind(this),i.Ak.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),s=this.createTokenRequestHeaders(t.ccsCredential),a={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return M(this.executePostToTokenEndpoint.bind(this),i.Ak.BaseClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,r,s,a,t.correlationId)}async createTokenRequestBody(t){this.performanceClient?.addQueueMeasurement(i.Ak.RefreshTokenClientCreateTokenRequestBody,t.correlationId);const e=t.correlationId,n=new xt;if(n.addClientId(t.tokenBodyParameters?.[l.Fo.CLIENT_ID]||this.config.authOptions.clientId),t.redirectUri&&n.addRedirectUri(t.redirectUri),n.addScopes(t.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),n.addGrantType(l.qJ.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!(0,Pt.lh)(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(e),n.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;n.addClientAssertion(t.assertion),n.addClientAssertionType(t.assertionType)}if(t.authenticationScheme===l.hO.POP){const e=new Bt(this.cryptoUtils,this.performanceClient),o=await M(e.generateCnf.bind(e),i.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);n.addPopToken(o.reqCnfString)}else if(t.authenticationScheme===l.hO.SSH){if(!t.sshJwk)throw(0,D.ei)(q.dK);n.addSshJwk(t.sshJwk)}if((!x.x.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case it:try{const e=(0,Mt.j)(t.ccsCredential.credential);n.addCcsOid(e)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case ot:n.addCcsUpn(t.ccsCredential.credential)}return t.tokenBodyParameters&&n.addExtraQueryParameters(t.tokenBodyParameters),n.createQueryString()}}class pe extends qt{constructor(t,e){super(t,e)}async acquireToken(t){try{const[e,n]=await this.acquireCachedToken(t);return n===l.To.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new fe(this.config,this.performanceClient).acquireTokenByRefreshToken(t).catch((()=>{}))),e}catch(e){if(e instanceof F.er&&e.errorCode===B.s$)return new fe(this.config,this.performanceClient).acquireTokenByRefreshToken(t);throw e}}async acquireCachedToken(t){let e=l.To.NOT_APPLICABLE;if(!t)throw(0,D.ei)(q.dL);if(t.forceRefresh)throw e=l.To.FORCE_REFRESH_OR_CLAIMS,this.serverTelemetryManager?.setCacheOutcome(l.To.FORCE_REFRESH_OR_CLAIMS),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),(0,F.zP)(B.s$);if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!x.x.isEmptyObj(t.claims))throw e=l.To.FORCE_REFRESH_OR_CLAIMS,this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),(0,F.zP)(B.s$);if(!t.account)throw(0,F.zP)(B.D7);const n=t.authority||this.authority.getPreferredCache(),i=this.cacheManager.readCacheRecord(t.account,t,n);if(!i.accessToken)throw e=l.To.NO_CACHED_ACCESS_TOKEN,this.serverTelemetryManager?.setCacheOutcome(l.To.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),(0,F.zP)(B.s$);if(V.wasClockTurnedBack(i.accessToken.cachedAt)||V.isTokenExpired(i.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw e=l.To.CACHED_ACCESS_TOKEN_EXPIRED,this.serverTelemetryManager?.setCacheOutcome(l.To.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),(0,F.zP)(B.s$);return i.accessToken.refreshOn&&V.isTokenExpired(i.accessToken.refreshOn,0)&&(e=l.To.PROACTIVELY_REFRESHED,this.serverTelemetryManager?.setCacheOutcome(l.To.PROACTIVELY_REFRESHED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'.")),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await this.generateResultFromCacheRecord(i,t),e]}async generateResultFromCacheRecord(t,e){let n;if(t.idToken&&(n=(0,J.Z_)(t.idToken.secret,this.config.cryptoInterface.base64Decode)),e.maxAge||0===e.maxAge){const t=n?.auth_time;if(!t)throw(0,F.zP)(B.w7);(0,J.ky)(t,e.maxAge)}return await Wt.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,e,n)}}class ve extends re{async acquireToken(t){const e=this.initializeServerTelemetryManager(_.WN.acquireTokenSilent_silentFlow),n=await this.createSilentFlowClient(e,t.authority,t.azureCloudOptions);this.logger.verbose("Silent auth client created");try{const e=(await n.acquireCachedToken(t))[0];return this.performanceClient.addFields({fromCache:!0},t.correlationId),e}catch(t){throw t instanceof m.Ut&&t.errorCode===g.XM&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t}}logout(t){this.logger.verbose("logoutRedirect called");const e=this.initializeLogoutRequest(t);return this.clearCacheOnLogout(e?.account)}async createSilentFlowClient(t,e,n){const o=await M(this.getClientConfiguration.bind(this),i.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t,e,n);return new pe(o,this.performanceClient)}async initializeSilentRequest(t,e){this.performanceClient.addQueueMeasurement(i.Ak.InitializeSilentRequest,this.correlationId);const n=await M(this.initializeBaseRequest.bind(this),i.Ak.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(t,e);return{...t,...n,account:e,forceRefresh:t.forceRefresh||!1}}}const me="brk_redirect_uri";class ge extends te{constructor(t,e,n,i,o,r,s,a,c,u,l,h){super(t,e,n,i,o,r,a,c,h),this.apiId=s,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=l,this.silentCacheClient=new ve(t,this.nativeStorageManager,n,i,o,r,a,c,h)}async acquireToken(t){this.performanceClient.addQueueMeasurement(i.Ak.NativeInteractionClientAcquireToken,t.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const e=this.performanceClient.startMeasurement(i.Ak.NativeInteractionClientAcquireToken,t.correlationId),n=V.nowSeconds(),o=await this.initializeNativeRequest(t);try{const t=await this.acquireTokensFromCache(this.accountId,o);return e.end({success:!0,isNativeBroker:!1,fromCache:!0}),t}catch(t){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const r={method:_.Ky.GetToken,request:o},s=await this.nativeMessageHandler.sendMessage(r),a=this.validateNativeResponse(s);return this.handleNativeResponse(a,o,n).then((t=>(e.end({success:!0,isNativeBroker:!0,requestId:t.requestId}),t))).catch((t=>{throw e.end({success:!1,errorCode:t.errorCode,subErrorCode:t.subError,isNativeBroker:!0}),t}))}createSilentCacheRequest(t,e){return{authority:t.authority,correlationId:this.correlationId,scopes:Dt.i.fromString(t.scope).asArray(),account:e,forceRefresh:!1}}async acquireTokensFromCache(t,e){if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),(0,F.zP)(B.cX);const n=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t});if(!n)throw(0,F.zP)(B.cX);try{const t=this.createSilentCacheRequest(e,n);return{...await this.silentCacheClient.acquireToken(t),account:n}}catch(t){throw t}}async acquireTokenRedirect(t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const e=await this.initializeNativeRequest(t),n={method:_.Ky.GetToken,request:e};try{const t=await this.nativeMessageHandler.sendMessage(n);this.validateNativeResponse(t)}catch(t){if(t instanceof le&&he(t))throw t}this.browserStorage.setTemporaryCache(_.c4.NATIVE_REQUEST,JSON.stringify(e),!0);const i={apiId:_.WN.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri);await this.navigationClient.navigateExternal(o,i)}async handleRedirectPromise(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getCachedNativeRequest();if(!t)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),null;const{prompt:e,...n}=t;e&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(_.c4.NATIVE_REQUEST));const i={method:_.Ky.GetToken,request:n},o=V.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const t=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(t);const e=this.handleNativeResponse(t,n,o);return this.browserStorage.setInteractionInProgress(!1),e}catch(t){throw this.browserStorage.setInteractionInProgress(!1),t}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(t,e,n){if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==e.accountId)throw de(ce);const i=await this.getDiscoveredAuthority(e.authority),o=J.Z_(t.id_token,w),r=this.createHomeAccountIdentifier(t,o),s=j.r.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:t.client_info,nativeAccountId:t.account.id},i),a=await this.generateAuthenticationResult(t,e,o,s,i.canonicalAuthority,n);return this.cacheAccount(s),this.cacheNativeTokens(t,e,r,o,a.accessToken,a.tenantId,n),a}createHomeAccountIdentifier(t,e){return j.r.generateHomeAccountId(t.client_info||l.gT.EMPTY_STRING,Gt.a.Default,this.logger,this.browserCrypto,e)}generateScopes(t,e){return t.scope?Dt.i.fromString(t.scope):Dt.i.fromString(e.scope)}async generatePopAccessToken(t,e){if(e.tokenType===l.hO.POP){if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),t.shr;const n=new Bt(this.browserCrypto),i={resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,shrNonce:e.shrNonce};if(!e.keyId)throw(0,F.zP)(B.Of);return await n.signPopToken(t.access_token,e.keyId,i)}return t.access_token}async generateAuthenticationResult(t,e,n,i,o,r){const s=this.addTelemetryFromNativeResponse(t),a=t.scope?Dt.i.fromString(t.scope):Dt.i.fromString(e.scope),c=t.account.properties||{},u=c.UID||n.oid||n.sub||l.gT.EMPTY_STRING,h=c.TenantId||n.tid||l.gT.EMPTY_STRING,d=await this.generatePopAccessToken(t,e),f=e.tokenType===l.hO.POP?l.hO.POP:l.hO.BEARER;return{authority:o,uniqueId:u,tenantId:h,scopes:a.asArray(),account:i.getAccountInfo(),idToken:t.id_token,idTokenClaims:n,accessToken:d,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(r+t.expires_in)),tokenType:f,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0}}cacheAccount(t){this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch((t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)}))}cacheNativeTokens(t,e,n,i,o,r,s){const a=$.createIdTokenEntity(n,e.authority,t.id_token||"",e.clientId,i.tid||""),c=s+(e.tokenType===l.hO.POP?l.gT.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0),u=this.generateScopes(t,e),h=Q.createAccessTokenEntity(n,e.authority,o,e.clientId,i.tid||r,u.printScopes(),c,0,this.browserCrypto),d=new rt(void 0,a,h);this.nativeStorageManager.saveCacheRecord(d,e.storeInCache)}addTelemetryFromNativeResponse(t){const e=this.getMATSFromResponse(t);return e?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:e.broker_version,matsAccountJoinOnStart:e.account_join_on_start,matsAccountJoinOnEnd:e.account_join_on_end,matsDeviceJoin:e.device_join,matsPromptBehavior:e.prompt_behavior,matsApiErrorCode:e.api_error_code,matsUiVisible:e.ui_visible,matsSilentCode:e.silent_code,matsSilentBiSubCode:e.silent_bi_sub_code,matsSilentMessage:e.silent_message,matsSilentStatus:e.silent_status,matsHttpStatus:e.http_status,matsHttpEventCount:e.http_event_count},this.correlationId),e):null}validateNativeResponse(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw(0,o.MD)(se.g,"Response missing expected properties.")}getMATSFromResponse(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(t){return void 0===t.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached}async initializeNativeRequest(t){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const e=t.authority||this.config.auth.authority;t.account&&await this.validateRequestAuthority(e,t.account);const n=new L(e);n.validateAsUri();const{scopes:o,...r}=t,s=new Dt.i(o||[]);s.appendScopes(l.f_);const a={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:(()=>{switch(this.apiId){case _.WN.ssoSilent:case _.WN.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),l.NJ.NONE}if(t.prompt)switch(t.prompt){case l.NJ.NONE:case l.NJ.CONSENT:case l.NJ.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${t.prompt} is not compatible with native flow`),(0,m.Z_)(g.o9)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...t.extraQueryParameters,...t.tokenQueryParameters},extendedExpiryToken:!1};if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry=_.BD.MATS_TELEMETRY,t.authenticationScheme===l.hO.POP){const e={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},n=new Bt(this.browserCrypto),o=await M(n.generateCnf.bind(n),i.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(e,this.logger);a.reqCnf=o.reqCnfHash,a.keyId=o.kid}return a}handleExtraBrokerParams(t){if(t.extraParameters&&t.extraParameters.hasOwnProperty("brk_client_id")&&t.extraParameters.hasOwnProperty(me)&&t.extraParameters.hasOwnProperty(l.Fo.CLIENT_ID)){const e=t.extraParameters[l.Fo.CLIENT_ID],n=t.redirectUri,i=t.extraParameters[me];t.extraParameters={child_client_id:e,child_redirect_uri:n},t.redirectUri=i}}}class we{constructor(t,e,n,o){this.logger=t,this.handshakeTimeoutMs=e,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(i.Ak.NativeMessageHandlerHandshake)}async sendMessage(t){this.logger.trace("NativeMessageHandler - sendMessage called.");const e={channel:_.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:A(),body:t};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(e)}`),this.messageChannel.port1.postMessage(e),new Promise(((t,n)=>{this.resolvers.set(e.responseId,{resolve:t,reject:n})}))}static async createProvider(t,e,n){t.trace("NativeMessageHandler - createProvider called.");try{const i=new we(t,e,n,_.BD.PREFERRED_EXTENSION_ID);return await i.sendHandshakeRequest(),i}catch(i){const o=new we(t,e,n);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const t={channel:_.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:A(),body:{method:_.Ky.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(t,window.origin,[this.messageChannel.port2]),new Promise(((e,n)=>{this.handshakeResolvers.set(t.responseId,{resolve:e,reject:n}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n((0,m.Z_)(g.hR)),this.handshakeResolvers.delete(t.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(t){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),t.source!==window)return;const e=t.data;if(e.channel&&e.channel===_.BD.CHANNEL_ID&&(!e.extensionId||e.extensionId===this.extensionId)&&e.body.method===_.Ky.HandshakeRequest){const t=this.handshakeResolvers.get(e.responseId);if(!t)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${e.responseId}`);this.logger.verbose(e.extensionId?`Extension with id: ${e.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),t.reject((0,m.Z_)(g.Wb))}}onChannelMessage(t){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const e=t.data,n=this.resolvers.get(e.responseId),i=this.handshakeResolvers.get(e.responseId);try{const t=e.body.method;if(t===_.Ky.Response){if(!n)return;const t=e.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(t)}`),"Success"!==t.status)n.reject(de(t.code,t.description,t.ext));else{if(!t.result)throw(0,o.MD)(se.g,"Event does not contain result.");t.result.code&&t.result.description?n.reject(de(t.result.code,t.result.description,t.result.ext)):n.resolve(t.result)}this.resolvers.delete(e.responseId)}else if(t===_.Ky.HandshakeResponse){if(!i)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${e.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=e.extensionId,this.extensionVersion=e.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(e.responseId)}}catch(e){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${e}`),this.logger.errorPii(`Unable to parse ${t}`),n?n.reject(e):i&&i.reject(e)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(t,e,n,i){if(e.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return e.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return e.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case l.hO.BEARER:case l.hO.POP:return e.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return e.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class ye{constructor(t,e,n,i,o){this.authModule=t,this.browserStorage=e,this.authCodeRequest=n,this.logger=i,this.performanceClient=o}async handleCodeResponseFromHash(t,e,n,o){if(this.performanceClient.addQueueMeasurement(i.Ak.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),!t)throw(0,m.Z_)(g.nF);const r=this.browserStorage.generateStateKey(e),s=this.browserStorage.getTemporaryCache(r);if(!s)throw(0,F.zP)(B.LV,"Cached State");let a;try{a=this.authModule.handleFragmentResponse(t,s)}catch(t){throw t instanceof G&&t.subError===g.h7?(0,m.Z_)(g.h7):t}return M(this.handleCodeResponseFromServer.bind(this),i.Ak.HandleCodeResponseFromServer,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(a,e,n,o)}async handleCodeResponseFromServer(t,e,n,o,r=!0){this.performanceClient.addQueueMeasurement(i.Ak.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called");const s=this.browserStorage.generateStateKey(e),a=this.browserStorage.getTemporaryCache(s);if(!a)throw(0,F.zP)(B.LV,"Cached State");const c=this.browserStorage.generateNonceKey(a),u=this.browserStorage.getTemporaryCache(c);if(this.authCodeRequest.code=t.code,t.cloud_instance_host_name&&await M(this.updateTokenEndpointAuthority.bind(this),i.Ak.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(t.cloud_instance_host_name,n,o),r&&(t.nonce=u||void 0),t.state=a,t.client_info)this.authCodeRequest.clientInfo=t.client_info;else{const t=this.checkCcsCredentials();t&&(this.authCodeRequest.ccsCredential=t)}const l=await M(this.authModule.acquireToken.bind(this.authModule),i.Ak.AuthClientAcquireToken,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(this.authCodeRequest,t);return this.browserStorage.cleanRequestByState(e),l}async updateTokenEndpointAuthority(t,e,n){this.performanceClient.addQueueMeasurement(i.Ak.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId);const o=`https://${t}/${e.tenant}/`,r=await Xt.createDiscoveredInstance(o,n,this.browserStorage,e.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId);this.authModule.updateAuthority(r)}checkCcsCredentials(){const t=this.browserStorage.getTemporaryCache(_.c4.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch(e){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${t}`)}return null}}class _e extends re{constructor(t,e,n,i,o,r,s,a,c,u){super(t,e,n,i,o,r,s,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a}acquireToken(t){try{const e=this.generatePopupName(t.scopes||l.f_,t.authority||this.config.auth.authority),n=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,e,n);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const i=this.openSizedPopup("about:blank",e,n);return this.acquireTokenPopupAsync(t,e,n,i)}}catch(t){return Promise.reject(t)}}logout(t){try{this.logger.verbose("logoutPopup called");const e=this.initializeLogoutRequest(t),n=this.generateLogoutPopupName(e),i=t&&t.authority,o=t&&t.mainWindowRedirectUri,r=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(e,n,r,i,void 0,o);{this.logger.verbose("asyncPopup set to false, opening popup");const t=this.openSizedPopup("about:blank",n,r);return this.logoutPopupAsync(e,n,r,i,t,o)}}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(t,e,n,r){this.logger.verbose("acquireTokenPopupAsync called");const s=this.initializeServerTelemetryManager(_.WN.acquireTokenPopup);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId);const a=await this.initializeAuthorizationRequest(t,_.s_.Popup);this.browserStorage.updateCacheEntries(a.state,a.nonce,a.authority,a.loginHint||l.gT.EMPTY_STRING,a.account||null);try{this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId);const o=await this.initializeAuthorizationCodeRequest(a);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,t.correlationId);const c=await this.createAuthCodeClient(s,a.authority,a.azureCloudOptions);this.logger.verbose("Auth code client created");const u=we.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme);let l;u&&(l=this.performanceClient.startMeasurement(i.Ak.FetchAccountIdWithNativeBroker,t.correlationId));const h=await c.getAuthCodeUrl({...a,nativeBroker:u}),d=new ye(c,this.browserStorage,o,this.logger,this.performanceClient),f={popup:r,popupName:e,popupWindowAttributes:n},p=this.initiateAuthRequest(h,f);this.eventHandler.emitEvent(kt,_.s_.Popup,{popupWindow:p},null);const v=await this.monitorPopupForHash(p),w=L.getDeserializedHash(v),y=this.validateAndExtractStateFromHash(w,_.s_.Popup,a.correlationId);if(Et.removeThrottle(this.browserStorage,this.config.auth.clientId,o),w.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw(0,m.Z_)(g.V7);const t=new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,w.accountId,this.nativeStorage,a.correlationId),{userRequestState:e}=nt.parseRequestState(this.browserCrypto,y);return t.acquireToken({...a,state:e,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(y)}))}return await d.handleCodeResponseFromHash(v,y,c.authority,this.networkClient)}catch(t){throw r&&r.close(),t instanceof o.l4&&(t.setCorrelationId(this.correlationId),s.cacheFailedRequest(t)),this.browserStorage.cleanRequestByState(a.state),t}}async logoutPopupAsync(t,e,n,r,s,a){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Tt,_.s_.Popup,t);const c=this.initializeServerTelemetryManager(_.WN.logoutPopup);try{await this.clearCacheOnLogout(t.account),this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,t.correlationId);const o=await this.createAuthCodeClient(c,r);this.logger.verbose("Auth code client created");try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId&&t.postLogoutRedirectUri&&o.authority.protocolMode===Nt.A.OIDC){if(this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(bt,_.s_.Popup,t),a){const t={apiId:_.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},e=L.getAbsoluteUrl(a,pt.getCurrentUri());await this.navigationClient.navigateInternal(e,t)}return void(s&&s.close())}}const u=o.getLogoutUri(t);this.eventHandler.emitEvent(bt,_.s_.Popup,t);const l=this.openPopup(u,{popupName:e,popupWindowAttributes:n,popup:s});if(this.eventHandler.emitEvent(kt,_.s_.Popup,{popupWindow:l},null),await this.waitForLogoutPopup(l),a){const t={apiId:_.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},e=L.getAbsoluteUrl(a,pt.getCurrentUri());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${e}`),await this.navigationClient.navigateInternal(e,t)}else this.logger.verbose("No main window navigation requested")}catch(t){throw s&&s.close(),t instanceof o.l4&&(t.setCorrelationId(this.correlationId),c.cacheFailedRequest(t)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(At,_.s_.Popup,null,t),this.eventHandler.emitEvent(It,_.s_.Popup),t}this.eventHandler.emitEvent(It,_.s_.Popup)}initiateAuthRequest(t,e){if(t)return this.logger.infoPii(`Navigate to: ${t}`),this.openPopup(t,e);throw this.logger.error("Navigate url is empty"),(0,m.Z_)(g.Ri)}monitorPopupForHash(t){return new Promise(((e,n)=>{const i=this.config.system.windowHashTimeout/this.config.system.pollIntervalMilliseconds;let o=0;this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval((()=>{if(t.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),this.cleanPopup(),clearInterval(r),void n((0,m.Z_)(g.h7));let s=l.gT.EMPTY_STRING,a=l.gT.EMPTY_STRING;try{s=t.location.href,a=this.extractServerResponseStringFromPopup(t,s)}catch(t){}s&&"about:blank"!==s&&(this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),o++,a?(this.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(r),this.cleanPopup(t),L.hashContainsKnownProperties(a)?(this.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),e(a)):(this.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),this.logger.errorPii(`PopupHandler.monitorPopupForHash - hash found: ${a}`),n((0,m.Z_)(g.S_)))):o>i&&(this.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(r),n((0,m.Z_)(g.ZT))))}),this.config.system.pollIntervalMilliseconds)}))}waitForLogoutPopup(t){return new Promise((e=>{this.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");const n=setInterval((()=>{t.closed&&(this.logger.error("PopupHandler.waitForLogoutPopup - window closed"),this.cleanPopup(),clearInterval(n),e());let i=l.gT.EMPTY_STRING;try{i=t.location.href}catch(t){}i&&"about:blank"!==i&&(this.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),this.cleanPopup(t),e())}),this.config.system.pollIntervalMilliseconds)}))}openPopup(t,e){try{let n;if(e.popup?(n=e.popup,this.logger.verbosePii(`Navigating popup window to: ${t}`),n.location.assign(t)):void 0===e.popup&&(this.logger.verbosePii(`Opening popup window to: ${t}`),n=this.openSizedPopup(t,e.popupName,e.popupWindowAttributes)),!n)throw(0,m.Z_)(g.H);return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(t){throw this.logger.error("error opening popup "+t.message),this.browserStorage.setInteractionInProgress(!1),(0,m.Z_)(g.E)}}openSizedPopup(t,e,n){const i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let a=n.popupSize?.width,c=n.popupSize?.height,u=n.popupPosition?.top,l=n.popupPosition?.left;return(!a||a<0||a>r)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),a=_.qx.POPUP_WIDTH),(!c||c<0||c>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),c=_.qx.POPUP_HEIGHT),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-_.qx.POPUP_HEIGHT/2+o)),(!l||l<0||l>r)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),l=Math.max(0,r/2-_.qx.POPUP_WIDTH/2+i)),window.open(t,e,`width=${a}, height=${c}, top=${u}, left=${l}, scrollbars=yes`)}unloadWindow(t){this.browserStorage.cleanRequestByInteractionType(_.s_.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()}cleanPopup(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(t,e){return`${_.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t.join("-")}.${e}.${this.correlationId}`}generateLogoutPopupName(t){const e=t.account&&t.account.homeAccountId;return`${_.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e}.${this.correlationId}`}extractServerResponseStringFromPopup(t,e){let n;return n=this.config.auth.OIDCOptions?.serverResponseType===l.rg.QUERY?L.parseQueryServerResponse(e):t.location.hash,n}}class Ce extends ye{constructor(t,e,n,i,o,r){super(t,e,n,i,r),this.browserCrypto=o}async initiateAuthRequest(t,e){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),t){e.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(_.c4.ORIGIN_URI,e.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(_.c4.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${t}`);const n={apiId:_.WN.acquireTokenRedirect,timeout:e.redirectTimeout,noHistory:!1};return"function"==typeof e.onRedirectNavigate?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==e.onRedirectNavigate(t)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await e.navigationClient.navigateExternal(t,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await e.navigationClient.navigateExternal(t,n))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),(0,m.Z_)(g.Ri)}async handleCodeResponseFromHash(t,e,n,i){if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),!t)throw(0,m.Z_)(g.nF);this.browserStorage.setInteractionInProgress(!1);const o=this.browserStorage.generateStateKey(e),r=this.browserStorage.getTemporaryCache(o);if(!r)throw(0,F.zP)(B.LV,"Cached State");let s;try{s=this.authModule.handleFragmentResponse(t,r)}catch(t){throw t instanceof G&&t.subError===g.h7?(0,m.Z_)(g.h7):t}const a=this.browserStorage.generateNonceKey(r),c=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=s.code,s.cloud_instance_host_name&&await this.updateTokenEndpointAuthority(s.cloud_instance_host_name,n,i),s.nonce=c||void 0,s.state=r,s.client_info)this.authCodeRequest.clientInfo=s.client_info;else{const t=this.checkCcsCredentials();t&&(this.authCodeRequest.ccsCredential=t)}const u=await this.authModule.acquireToken(this.authCodeRequest,s);return this.browserStorage.cleanRequestByState(e),u}}class Se extends re{constructor(t,e,n,i,o,r,s,a,c,u){super(t,e,n,i,o,r,s,c,u),this.nativeStorage=a}async acquireToken(t){this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId);const e=await this.initializeAuthorizationRequest(t,_.s_.Redirect);this.browserStorage.updateCacheEntries(e.state,e.nonce,e.authority,e.loginHint||l.gT.EMPTY_STRING,e.account||null);const n=this.initializeServerTelemetryManager(_.WN.acquireTokenRedirect),r=t=>{t.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(e.state),this.eventHandler.emitEvent("msal:restoreFromBFCache",_.s_.Redirect))};try{this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId);const o=await this.initializeAuthorizationCodeRequest(e);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,t.correlationId);const s=await this.createAuthCodeClient(n,e.authority,e.azureCloudOptions);this.logger.verbose("Auth code client created");const a=new Ce(s,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),c=await s.getAuthCodeUrl({...e,nativeBroker:we.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),u=this.getRedirectStartPage(t.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",r),await a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:t.onRedirectNavigate})}catch(t){throw t instanceof o.l4&&(t.setCorrelationId(this.correlationId),n.cacheFailedRequest(t)),window.removeEventListener("pageshow",r),this.browserStorage.cleanRequestByState(e.state),t}}async handleRedirectPromise(t){const e=this.initializeServerTelemetryManager(_.WN.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.getRedirectResponseHash(t||window.location.hash);if(!n)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(_.s_.Redirect),null;let i;try{const t=L.getDeserializedHash(n);i=this.validateAndExtractStateFromHash(t,_.s_.Redirect),this.logger.verbose("State extracted from hash")}catch(t){return this.logger.info(`handleRedirectPromise was unable to extract state due to: ${t}`),this.browserStorage.cleanRequestByInteractionType(_.s_.Redirect),null}const o=this.browserStorage.getTemporaryCache(_.c4.ORIGIN_URI,!0)||l.gT.EMPTY_STRING;if(L.removeHashFromUrl(o)===L.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling hash");const t=await this.handleHash(n,i,e);return o.indexOf("#")>-1&&pt.replaceHash(o),t}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),this.handleHash(n,i,e);if(!pt.isInIframe()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(_.c4.URL_HASH,n,!0);const t={apiId:_.WN.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let r=!0;if(o&&"null"!==o)this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),r=await this.navigationClient.navigateInternal(o,t);else{const e=pt.getHomepage();this.browserStorage.setTemporaryCache(_.c4.ORIGIN_URI,e,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),r=await this.navigationClient.navigateInternal(e,t)}if(!r)return this.handleHash(n,i,e)}return null}catch(t){throw t instanceof o.l4&&(t.setCorrelationId(this.correlationId),e.cacheFailedRequest(t)),this.browserStorage.cleanRequestByInteractionType(_.s_.Redirect),t}}getRedirectResponseHash(t){if(this.logger.verbose("getRedirectResponseHash called"),L.hashContainsKnownProperties(t))return pt.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;const e=this.browserStorage.getTemporaryCache(_.c4.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(_.c4.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),e}async handleHash(t,e,n){const o=this.browserStorage.getCachedRequest(e);this.logger.verbose("handleHash called, retrieved cached request");const r=L.getDeserializedHash(t);if(r.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,m.Z_)(g.V7);const t=new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,r.accountId,this.nativeStorage,o.correlationId),{userRequestState:n}=nt.parseRequestState(this.browserCrypto,e);return t.acquireToken({...o,state:n,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(e)}))}const s=this.browserStorage.getCachedAuthority(e);if(!s)throw(0,m.Z_)(g.dT);this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,o.correlationId);const a=await this.createAuthCodeClient(n,s);this.logger.verbose("Auth code client created"),Et.removeThrottle(this.browserStorage,this.config.auth.clientId,o);const c=new Ce(a,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient);return await c.handleCodeResponseFromHash(t,e,a.authority,this.networkClient)}async logout(t){this.logger.verbose("logoutRedirect called");const e=this.initializeLogoutRequest(t),n=this.initializeServerTelemetryManager(_.WN.logout);try{this.eventHandler.emitEvent(Tt,_.s_.Redirect,t),await this.clearCacheOnLogout(e.account);const o={apiId:_.WN.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1};this.performanceClient.setPreQueueTime(i.Ak.StandardInteractionClientCreateAuthCodeClient,e.correlationId);const r=await this.createAuthCodeClient(n,t&&t.authority);if(this.logger.verbose("Auth code client created"),r.authority.protocolMode===Nt.A.OIDC)try{r.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId)return this.browserStorage.removeAccount(e.account?.homeAccountId),void this.eventHandler.emitEvent(bt,_.s_.Redirect,e)}const s=r.getLogoutUri(e);if(this.eventHandler.emitEvent(bt,_.s_.Redirect,e),!t||"function"!=typeof t.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,o);if(!1!==t.onRedirectNavigate(s))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,o);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(t){throw t instanceof o.l4&&(t.setCorrelationId(this.correlationId),n.cacheFailedRequest(t)),this.eventHandler.emitEvent(At,_.s_.Redirect,null,t),this.eventHandler.emitEvent(It,_.s_.Redirect),t}this.eventHandler.emitEvent(It,_.s_.Redirect)}getRedirectStartPage(t){const e=t||window.location.href;return L.getAbsoluteUrl(e,pt.getCurrentUri())}}var ke=n(2685);class Te extends ye{constructor(t,e,n,i,o,r){super(t,e,n,i,r),this.navigateFrameWait=o.navigateFrameWait,this.pollIntervalMilliseconds=o.pollIntervalMilliseconds}async initiateAuthRequest(t){if(this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),!t)throw this.logger.info("Navigate url is empty"),(0,m.Z_)(g.Ri);return this.navigateFrameWait?await M(this.loadFrame.bind(this),i.Ak.SilentHandlerLoadFrame,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(t):this.loadFrameSync(t)}monitorIframeForHash(t,e){return this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(((n,i)=>{e<ke.Is&&this.logger.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${ke.Is}ms). This may result in timeouts.`);const o=window.performance.now()+e,r=setInterval((()=>{if(window.performance.now()>o)return this.removeHiddenIframe(t),clearInterval(r),void i((0,m.Z_)(g.JA));let e=l.gT.EMPTY_STRING;const s=t.contentWindow;try{e=s?s.location.href:l.gT.EMPTY_STRING}catch(t){}if(!e||"about:blank"===e)return;const a=s?s.location.hash:l.gT.EMPTY_STRING;return a?L.hashContainsKnownProperties(a)?(this.removeHiddenIframe(t),clearInterval(r),void n(a)):(this.logger.error("SilentHandler:monitorIFrameForHash - a hash is present in the iframe but it does not contain known properties. It's likely that the hash has been replaced by code running on the redirectUri page."),this.logger.errorPii(`SilentHandler:monitorIFrameForHash - the url detected in the iframe is: ${e}`),this.removeHiddenIframe(t),clearInterval(r),void i((0,m.Z_)(g.S_))):(this.logger.error("SilentHandler:monitorIFrameForHash - the request has returned to the redirectUri but a hash is not present in the iframe. It's likely that the hash has been removed or the page has been redirected by code running on the redirectUri page."),this.logger.errorPii(`SilentHandler:monitorIFrameForHash - the url detected in the iframe is: ${e}`),this.removeHiddenIframe(t),clearInterval(r),void i((0,m.Z_)(g.nF)))}),this.pollIntervalMilliseconds)}))}loadFrame(t){return this.performanceClient.addQueueMeasurement(i.Ak.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(((e,n)=>{const i=this.createHiddenIframe();setTimeout((()=>{i?(i.src=t,e(i)):n("Unable to load iframe")}),this.navigateFrameWait)}))}loadFrameSync(t){const e=this.createHiddenIframe();return e.src=t,e}createHiddenIframe(){const t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t}removeHiddenIframe(t){document.body===t.parentNode&&document.body.removeChild(t)}}class be extends re{constructor(t,e,n,i,o,r,s,a,c,u,l){super(t,e,n,i,o,r,a,u,l),this.apiId=s,this.nativeStorage=c}async acquireToken(t){if(this.performanceClient.addQueueMeasurement(i.Ak.SilentIframeClientAcquireToken,t.correlationId),t.loginHint||t.sid||t.account&&t.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==l.NJ.NONE&&t.prompt!==l.NJ.NO_SESSION)throw(0,m.Z_)(g.WQ);const e=await M(this.initializeAuthorizationRequest.bind(this),i.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)({...t,prompt:t.prompt||l.NJ.NONE},_.s_.Silent);this.browserStorage.updateCacheEntries(e.state,e.nonce,e.authority,e.loginHint||l.gT.EMPTY_STRING,e.account||null);const n=this.initializeServerTelemetryManager(this.apiId);try{const o=await M(this.createAuthCodeClient.bind(this),i.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,t.correlationId)(n,e.authority,e.azureCloudOptions);return await M(this.silentTokenHelper.bind(this),i.Ak.SilentIframeClientTokenHelper,this.logger,this.performanceClient,t.correlationId)(o,e)}catch(t){throw t instanceof o.l4&&(t.setCorrelationId(this.correlationId),n.cacheFailedRequest(t)),this.browserStorage.cleanRequestByState(e.state),t}}logout(){return Promise.reject((0,m.Z_)(g.I9))}async silentTokenHelper(t,e){this.performanceClient.addQueueMeasurement(i.Ak.SilentIframeClientTokenHelper,e.correlationId);const n=await M(this.initializeAuthorizationCodeRequest.bind(this),i.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,e.correlationId)(e),o=await M(t.getAuthCodeUrl.bind(t),i.Ak.GetAuthCodeUrl,this.logger,this.performanceClient,e.correlationId)({...e,nativeBroker:we.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),r=new Te(t,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),s=await M(r.initiateAuthRequest.bind(r),i.Ak.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,e.correlationId)(o),a=await M(r.monitorIframeForHash.bind(r),i.Ak.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,e.correlationId)(s,this.config.system.iframeHashTimeout),c=L.getDeserializedHash(a),u=this.validateAndExtractStateFromHash(c,_.s_.Silent,n.correlationId);if(c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,m.Z_)(g.V7);const t=new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,this.correlationId),{userRequestState:n}=nt.parseRequestState(this.browserCrypto,u);return M(t.acquireToken.bind(t),i.Ak.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,e.correlationId)({...e,state:n,prompt:e.prompt||l.NJ.NONE}).finally((()=>{this.browserStorage.cleanRequestByState(u)}))}return M(r.handleCodeResponseFromHash.bind(r),i.Ak.HandleCodeResponseFromHash,this.logger,this.performanceClient,e.correlationId)(a,u,t.authority,this.networkClient)}}class Ae extends re{async acquireToken(t){this.performanceClient.addQueueMeasurement(i.Ak.SilentRefreshClientAcquireToken,t.correlationId);const e=await M(this.initializeBaseRequest.bind(this),i.Ak.InitializeBaseRequest,this.logger,this.performanceClient,t.correlationId)(t,t.account),n={...t,...e},o=this.initializeServerTelemetryManager(_.WN.acquireTokenSilent_silentFlow),r=await this.createRefreshTokenClient(o,n.authority,n.azureCloudOptions);return this.logger.verbose("Refresh token client created"),M(r.acquireTokenByRefreshToken.bind(r),i.Ak.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(n).then((t=>t)).then((e=>(this.performanceClient.addFields({fromCache:e.fromCache,requestId:e.requestId},t.correlationId),e))).catch((t=>{throw t.setCorrelationId(this.correlationId),o.cacheFailedRequest(t),t}))}logout(){return Promise.reject((0,m.Z_)(g.I9))}async createRefreshTokenClient(t,e,n){const o=await M(this.getClientConfiguration.bind(this),i.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t,e,n);return new fe(o,this.performanceClient)}}class Ie{constructor(t,e,n,i){this.isBrowserEnvironment="undefined"!=typeof window,this.config=t,this.storage=e,this.logger=n,this.cryptoObj=i}loadExternalTokens(t,e,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!e.id_token)throw(0,m.Z_)(g.Jd);const i=J.Z_(e.id_token,w);let o,r,s;if(t.account)s=j.r.createFromAccountInfo(t.account),o=new rt(s,this.loadIdToken(e.id_token,s.homeAccountId,t.account.environment,t.account.tenantId),this.loadAccessToken(t,e,s.homeAccountId,t.account.environment,t.account.tenantId,n),this.loadRefreshToken(t,e,s.homeAccountId,t.account.environment));else{if(!t.authority)throw(0,m.Z_)(g.Jd);{const a=Qt.generateAuthority(t.authority,t.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(r=new Qt(a,this.config.system.networkClient,this.storage,c,this.logger),n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),s=this.loadAccount(i,r,n.clientInfo),o=new rt(s,this.loadIdToken(e.id_token,s.homeAccountId,r.hostnameAndPort,r.tenant),this.loadAccessToken(t,e,s.homeAccountId,r.hostnameAndPort,r.tenant,n),this.loadRefreshToken(t,e,s.homeAccountId,r.hostnameAndPort));else{if(!e.client_info)throw(0,m.Z_)(g.Jd);this.logger.trace("TokenCache - homeAccountId from response"),s=this.loadAccount(i,r,e.client_info),o=new rt(s,this.loadIdToken(e.id_token,s.homeAccountId,r.hostnameAndPort,r.tenant),this.loadAccessToken(t,e,s.homeAccountId,r.hostnameAndPort,r.tenant,n),this.loadRefreshToken(t,e,s.homeAccountId,r.hostnameAndPort))}}}return this.generateAuthenticationResult(t,i,o,s,r)}loadAccount(t,e,n,i){let o;if(i?o=i:void 0!==e.authorityType&&n&&(o=j.r.generateHomeAccountId(n,e.authorityType,this.logger,this.cryptoObj,t)),!o)throw(0,m.Z_)(g.Jd);const r=j.r.createAccount({homeAccountId:o,idTokenClaims:t,clientInfo:n,environment:e.hostnameAndPort},e);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(r),r;throw(0,m.Z_)(g.Jd)}loadIdToken(t,e,n,i){const o=$.createIdTokenEntity(e,n,t,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw(0,m.Z_)(g.Jd)}loadAccessToken(t,e,n,i,o,r){if(!e.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!e.expires_in)throw(0,m.Z_)(g.Jd);if(!r.extendedExpiresOn)throw(0,m.Z_)(g.Jd);const s=new Dt.i(t.scopes).printScopes(),a=r.expiresOn||e.expires_in+(new Date).getTime()/1e3,c=r.extendedExpiresOn,u=Q.createAccessTokenEntity(n,i,e.access_token,this.config.auth.clientId,o,s,a,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw(0,m.Z_)(g.Jd)}loadRefreshToken(t,e,n,i){if(!e.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;const o=X.createRefreshTokenEntity(n,i,e.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw(0,m.Z_)(g.Jd)}generateAuthenticationResult(t,e,n,i,o){let r,s=l.gT.EMPTY_STRING,a=[],c=null;n?.accessToken&&(s=n.accessToken.secret,a=Dt.i.fromString(n.accessToken.target).asArray(),c=new Date(1e3*Number(n.accessToken.expiresOn)),r=new Date(1e3*Number(n.accessToken.extendedExpiresOn)));const u=e.oid||e.sub||l.gT.EMPTY_STRING,h=e.tid||l.gT.EMPTY_STRING;return{authority:o?o.canonicalAuthority:l.gT.EMPTY_STRING,uniqueId:u,tenantId:h,scopes:a,account:i.getAccountInfo(),idToken:n.idToken?.secret||"",idTokenClaims:e||{},accessToken:s,fromCache:!0,expiresOn:c,correlationId:t.correlationId||l.gT.EMPTY_STRING,requestId:l.gT.EMPTY_STRING,extExpiresOn:r,familyId:l.gT.EMPTY_STRING,tokenType:n?.accessToken?.tokenType||l.gT.EMPTY_STRING,state:l.gT.EMPTY_STRING,cloudGraphHostName:i.cloudGraphHostName||l.gT.EMPTY_STRING,msGraphHost:i.msGraphHost||l.gT.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}}class Re extends jt{constructor(t){super(t),this.includeRedirectUri=!1}}class Ee extends re{constructor(t,e,n,i,o,r,s,a,c,u){super(t,e,n,i,o,r,a,c,u),this.apiId=s}async acquireToken(t){if(!t.code)throw(0,m.Z_)(g.Aj);const e=await M(this.initializeAuthorizationRequest.bind(this),i.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(t,_.s_.Silent);this.browserStorage.updateCacheEntries(e.state,e.nonce,e.authority,e.loginHint||l.gT.EMPTY_STRING,e.account||null);const n=this.initializeServerTelemetryManager(this.apiId);try{const o={...e,code:t.code},r=await M(this.getClientConfiguration.bind(this),i.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,t.correlationId)(n,e.authority),s=new Re(r);this.logger.verbose("Auth code client created");const a=new Te(s,this.browserStorage,o,this.logger,this.config.system,this.performanceClient);return M(a.handleCodeResponseFromServer.bind(a),i.Ak.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},e.state,s.authority,this.networkClient,!1)}catch(t){throw t instanceof o.l4&&(t.setCorrelationId(this.correlationId),n.cacheFailedRequest(t)),this.browserStorage.cleanRequestByState(e.state),t}}logout(){return Promise.reject((0,m.Z_)(g.I9))}}class Ne{constructor(t){this.atsAsyncMeasurement=void 0,this.operatingContext=t,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=t.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new H(this.logger,this.performanceClient):O.d,this.eventHandler=new Rt(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ft(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):((t,e)=>{const n={cacheLocation:_.Ix.MemoryStorage,temporaryCacheLocation:_.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new ft(t,n,O.d,e)})(this.config.auth.clientId,this.logger);const e={cacheLocation:_.Ix.MemoryStorage,temporaryCacheLocation:_.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new ft(this.config.auth.clientId,e,this.browserCrypto,this.logger),this.tokenCache=new Ie(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(t){const e=new Ne(t);return await e.initialize(),e}trackPageVisibility(){this.atsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.atsAsyncMeasurement.increment({visibilityChangeCount:1}))}async initialize(){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");const t=this.config.system.allowNativeBroker,e=this.performanceClient.startMeasurement(i.Ak.InitializeClientApplication);if(this.eventHandler.emitEvent("msal:initializeStart"),t)try{this.nativeExtensionProvider=await we.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(t){this.logger.verbose(t)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await M(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),i.Ak.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient)(this.performanceClient)),this.initialized=!0,this.eventHandler.emitEvent("msal:initializeEnd"),e.end({allowNativeBroker:t,success:!0})}async handleRedirectPromise(t){this.logger.verbose("handleRedirectPromise called"),pt.blockAPICallsBeforeInitialize(this.initialized);let e=t;if(this.config.auth.OIDCOptions?.serverResponseType===l.rg.QUERY){const t=window.location.href;e=L.parseQueryServerResponse(t)}const n=this.getAllAccounts();if(this.isBrowserEnvironment){const t=e||l.gT.EMPTY_STRING;let i=this.redirectResponse.get(t);if(void 0===i){this.eventHandler.emitEvent("msal:handleRedirectStart",_.s_.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise");const o=this.browserStorage.getCachedNativeRequest();let r;if(o&&we.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e)this.logger.trace("handleRedirectPromise - acquiring token from native platform"),r=new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId).handleRedirectPromise();else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.browserStorage.getTemporaryCache(_.c4.CORRELATION_ID,!0)||l.gT.EMPTY_STRING;r=this.createRedirectClient(t).handleRedirectPromise(e)}i=r.then((t=>(t&&(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(mt,_.s_.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(yt,_.s_.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, acquire token success"))),this.eventHandler.emitEvent(St,_.s_.Redirect),t))).catch((t=>{throw n.length>0?this.eventHandler.emitEvent(_t,_.s_.Redirect,null,t):this.eventHandler.emitEvent(gt,_.s_.Redirect,null,t),this.eventHandler.emitEvent(St,_.s_.Redirect),t})),this.redirectResponse.set(t,i)}else this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call");return i}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async acquireTokenRedirect(t){const e=this.getRequestCorrelationId(t);this.logger.verbose("acquireTokenRedirect called",e),this.preflightBrowserEnvironmentCheck(_.s_.Redirect);const n=this.getAllAccounts().length>0;let i;return n?this.eventHandler.emitEvent(wt,_.s_.Redirect,t):this.eventHandler.emitEvent(vt,_.s_.Redirect,t),i=this.nativeExtensionProvider&&this.canUseNative(t)?new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireTokenRedirect(t).catch((e=>{if(e instanceof le&&he(e))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t.correlationId).acquireToken(t);if(e instanceof W.Yo)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t.correlationId).acquireToken(t);throw this.getBrowserStorage().setInteractionInProgress(!1),e})):this.createRedirectClient(t.correlationId).acquireToken(t),i.catch((t=>{throw n?this.eventHandler.emitEvent(_t,_.s_.Redirect,null,t):this.eventHandler.emitEvent(gt,_.s_.Redirect,null,t),t}))}acquireTokenPopup(t){const e=this.getRequestCorrelationId(t),n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenPopup,e);try{this.logger.verbose("acquireTokenPopup called",e),this.preflightBrowserEnvironmentCheck(_.s_.Popup)}catch(t){return Promise.reject(t)}const o=this.getAllAccounts();let r;return o.length>0?this.eventHandler.emitEvent(wt,_.s_.Popup,t):this.eventHandler.emitEvent(vt,_.s_.Popup,t),r=this.canUseNative(t)?this.acquireTokenNative(t,_.WN.acquireTokenPopup).then((t=>(this.getBrowserStorage().setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:t.requestId}),t))).catch((e=>{if(e instanceof le&&he(e))return this.nativeExtensionProvider=void 0,this.createPopupClient(t.correlationId).acquireToken(t);if(e instanceof W.Yo)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t.correlationId).acquireToken(t);throw this.getBrowserStorage().setInteractionInProgress(!1),e})):this.createPopupClient(t.correlationId).acquireToken(t),r.then((t=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(mt,_.s_.Popup,t):this.eventHandler.emitEvent(yt,_.s_.Popup,t),n.add({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),n.end({success:!0,requestId:t.requestId}),t))).catch((t=>(o.length>0?this.eventHandler.emitEvent(_t,_.s_.Popup,null,t):this.eventHandler.emitEvent(gt,_.s_.Popup,null,t),n.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),Promise.reject(t))))}trackPageVisibilityWithMeasurement(){const t=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;t&&(this.logger.info("Perf: Visibility change detected in ",t.event.name),t.increment({visibilityChangeCount:1}))}async ssoSilent(t){const e=this.getRequestCorrelationId(t),n={...t,prompt:t.prompt,correlationId:e};let o;return this.preflightBrowserEnvironmentCheck(_.s_.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(i.Ak.SsoSilent,e),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",e),this.eventHandler.emitEvent("msal:ssoSilentStart",_.s_.Silent,n),o=this.canUseNative(n)?this.acquireTokenNative(n,_.WN.ssoSilent).catch((t=>{if(t instanceof le&&he(t))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw t})):this.createSilentIframeClient(n.correlationId).acquireToken(n),o.then((t=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",_.s_.Silent,t),this.ssoSilentMeasurement?.add({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t))).catch((t=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",_.s_.Silent,null,t),this.ssoSilentMeasurement?.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(t){const e=this.getRequestCorrelationId(t);this.preflightBrowserEnvironmentCheck(_.s_.Silent),this.logger.trace("acquireTokenByCode called",e),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",_.s_.Silent,t);const n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenByCode,t.correlationId);try{if(t.code&&t.nativeAccountId)throw(0,m.Z_)(g.LL);if(t.code){const i=t.code;let o=this.hybridAuthCodeResponses.get(i);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",e),o=this.acquireTokenByCodeAsync({...t,correlationId:e}).then((t=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",_.s_.Silent,t),this.hybridAuthCodeResponses.delete(i),n.add({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),n.end({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t))).catch((t=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(Ct,_.s_.Silent,null,t),n.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.hybridAuthCodeResponses.set(i,o)),o}if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return this.acquireTokenNative(t,_.WN.acquireTokenByCode,t.nativeAccountId).catch((t=>{throw t instanceof le&&he(t)&&(this.nativeExtensionProvider=void 0),t}));throw(0,m.Z_)(g.KA)}throw(0,m.Z_)(g.Dy)}catch(t){throw this.eventHandler.emitEvent(Ct,_.s_.Silent,null,t),n.end({errorCode:t instanceof o.l4&&t.errorCode||void 0,subErrorCode:t instanceof o.l4&&t.subError||void 0,success:!1}),t}}async acquireTokenByCodeAsync(t){this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(i.Ak.AcquireTokenByCodeAsync,t.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const e=this.createSilentAuthCodeClient(t.correlationId);return await e.acquireToken(t).then((t=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t))).catch((t=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(t,e,n){switch(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenFromCache,e.correlationId),n.cacheLookupPolicy){case _.lu.Default:case _.lu.AccessToken:case _.lu.AccessTokenAndRefreshToken:return M(t.acquireToken.bind(t),i.Ak.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw(0,F.zP)(B.s$)}}async acquireTokenByRefreshToken(t,e){switch(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenByRefreshToken,t.correlationId),e.cacheLookupPolicy){case _.lu.Default:case _.lu.AccessTokenAndRefreshToken:case _.lu.RefreshToken:case _.lu.RefreshTokenAndNetwork:const e=this.createSilentRefreshClient(t.correlationId);return M(e.acquireToken.bind(e),i.Ak.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t);default:throw(0,F.zP)(B.s$)}}async acquireTokenBySilentIframe(t){this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenBySilentIframe,t.correlationId);const e=this.createSilentIframeClient(t.correlationId);return M(e.acquireToken.bind(e),i.Ak.SilentIframeClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t)}async logout(t){const e=this.getRequestCorrelationId(t);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",e),this.logoutRedirect({correlationId:e,...t})}async logoutRedirect(t){const e=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(_.s_.Redirect),this.createRedirectClient(e).logout(t)}logoutPopup(t){try{const e=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(_.s_.Popup),this.createPopupClient(e).logout(t)}catch(t){return Promise.reject(t)}}async clearCache(t){const e=this.getRequestCorrelationId(t);return this.createSilentCacheClient(e).logout(t)}getAllAccounts(t){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts(t):[]}getAccount(t){if(this.logger.trace("getAccount called"),0===Object.keys(t).length)return this.logger.warning("getAccount: No accountFilter provided"),null;const e=this.browserStorage.getAccountInfoFilteredBy(t);return e?(this.logger.verbose("getAccount: Account matching provided filter found, returning"),e):(this.logger.verbose("getAccount: No matching account found, returning null"),null)}getAccountByUsername(t){if(this.logger.trace("getAccountByUsername called"),!t)return this.logger.warning("getAccountByUsername: No username provided"),null;const e=this.browserStorage.getAccountInfoFilteredBy({username:t});return e?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),e):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)}getAccountByHomeId(t){if(this.logger.trace("getAccountByHomeId called"),!t)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;const e=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:t});return e?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),e):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)}getAccountByLocalId(t){if(this.logger.trace("getAccountByLocalId called"),!t)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;const e=this.browserStorage.getAccountInfoFilteredBy({localAccountId:t});return e?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),e):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)}setActiveAccount(t){this.browserStorage.setActiveAccount(t)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(t,e){this.logger.verbose("hydrateCache called");const n=j.r.createFromAccountInfo(t.account,t.cloudGraphHostName,t.msGraphHost);return this.browserStorage.setAccount(n),t.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(t,e)):this.browserStorage.hydrateCache(t,e)}preflightBrowserEnvironmentCheck(t,e=!1){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),pt.blockNonBrowserEnvironment(this.isBrowserEnvironment),pt.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),pt.blockReloadInHiddenIframes(),pt.blockAcquireTokenInPopups(),pt.blockAPICallsBeforeInitialize(this.initialized),t===_.s_.Redirect&&this.config.cache.cacheLocation===_.Ix.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw lt(at);t!==_.s_.Redirect&&t!==_.s_.Popup||this.preflightInteractiveRequest(!e)}preflightInteractiveRequest(t){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),pt.blockReloadInHiddenIframes(),t&&this.getBrowserStorage().setInteractionInProgress(!0)}async acquireTokenNative(t,e,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw(0,m.Z_)(g.V7);return new ge(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireToken(t)}canUseNative(t,e){if(this.logger.trace("canUseNative called"),!we.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case l.NJ.NONE:case l.NJ.CONSENT:case l.NJ.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${t.prompt} is not compatible with native flow, returning false`),!1}return!(!e&&!this.getNativeAccountId(t)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))}getNativeAccountId(t){const e=t.account||this.browserStorage.getAccountInfoByHints(t.loginHint,t.sid)||this.getActiveAccount();return e&&e.nativeAccountId||""}createPopupClient(t){return new _e(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)}createRedirectClient(t){return new Se(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)}createSilentIframeClient(t){return new be(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)}createSilentCacheClient(t){return new ve(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)}createSilentRefreshClient(t){return new Ae(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)}createSilentAuthCodeClient(t){return new Ee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_.WN.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)}addEventCallback(t){return this.eventHandler.addEventCallback(t)}removeEventCallback(t){this.eventHandler.removeEventCallback(t)}addPerformanceCallback(t){return this.performanceClient.addPerformanceCallback(t)}removePerformanceCallback(t){return this.performanceClient.removePerformanceCallback(t)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(t){this.logger=t}initializeWrapperLibrary(t,e){this.browserStorage.setWrapperMetadata(t,e)}setNavigationClient(t){this.navigationClient=t}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}getBrowserStorage(){return this.browserStorage}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(t){return t?.correlationId?t.correlationId:this.isBrowserEnvironment?A():l.gT.EMPTY_STRING}async loginRedirect(t){const e=this.getRequestCorrelationId(t);return this.logger.verbose("loginRedirect called",e),this.acquireTokenRedirect({correlationId:e,...t||_.yo})}loginPopup(t){const e=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",e),this.acquireTokenPopup({correlationId:e,...t||_.yo})}async acquireTokenSilent(t){const e=this.getRequestCorrelationId(t),n=this.performanceClient.startMeasurement(i.Ak.AcquireTokenSilent,e);n.add({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(_.s_.Silent),this.logger.verbose("acquireTokenSilent called",e);const o=t.account||this.getActiveAccount();if(!o)throw(0,m.Z_)(g.wH);const r={clientId:this.config.auth.clientId,authority:t.authority||l.gT.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:o.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},s=JSON.stringify(r),a=this.activeSilentTokenRequests.get(s);if(void 0===a){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e);const r=M(this.acquireTokenSilentAsync.bind(this),i.Ak.AcquireTokenSilentAsync,this.logger,this.performanceClient,e)({...t,correlationId:e},o).then((e=>(this.activeSilentTokenRequests.delete(s),n.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:e.requestId}),e))).catch((t=>{throw this.activeSilentTokenRequests.delete(s),n.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}));return this.activeSilentTokenRequests.set(s,r),r}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e),n.discard(),a}async acquireTokenSilentAsync(t,e){let n;if(this.performanceClient.addQueueMeasurement(i.Ak.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(wt,_.s_.Silent,t),this.atsAsyncMeasurement=this.performanceClient.startMeasurement(i.Ak.AcquireTokenSilentAsync,t.correlationId),this.atsAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),we.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&e.nativeAccountId){this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform");const i={...t,account:e};n=this.acquireTokenNative(i,_.WN.acquireTokenSilent_silentFlow).catch((async e=>{if(e instanceof le&&he(e))return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,this.createSilentIframeClient(t.correlationId).acquireToken(t);throw e}))}else{this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow");const o=this.createSilentCacheClient(t.correlationId),r=await M(o.initializeSilentRequest.bind(o),i.Ak.InitializeSilentRequest,this.logger,this.performanceClient,t.correlationId)(t,e),s={...t,cacheLookupPolicy:t.cacheLookupPolicy||_.lu.Default};n=M(this.acquireTokenFromCache.bind(this),i.Ak.AcquireTokenFromCache,this.logger,this.performanceClient,r.correlationId)(o,r,s).catch((e=>{if(s.cacheLookupPolicy===_.lu.AccessToken)throw e;return pt.blockReloadInHiddenIframes(),this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",_.s_.Silent,r),M(this.acquireTokenByRefreshToken.bind(this),i.Ak.AcquireTokenByRefreshToken,this.logger,this.performanceClient,r.correlationId)(r,s).catch((e=>{const n=e instanceof G,o=e instanceof W.Yo,a=e.errorCode===_.qx.INVALID_GRANT_ERROR;if((!n||!a||o||s.cacheLookupPolicy===_.lu.AccessTokenAndRefreshToken||s.cacheLookupPolicy===_.lu.RefreshToken)&&s.cacheLookupPolicy!==_.lu.Skip)throw e;return this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),M(this.acquireTokenBySilentIframe.bind(this),i.Ak.AcquireTokenBySilentIframe,this.logger,this.performanceClient,r.correlationId)(r)}))}))}return n.then((t=>(this.eventHandler.emitEvent(yt,_.s_.Silent,t),this.atsAsyncMeasurement?.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t))).catch((t=>{throw this.eventHandler.emitEvent(_t,_.s_.Silent,null,t),this.atsAsyncMeasurement?.end({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibility)}))}}},5483:function(t,e,n){"use strict";n.d(e,{Ut:function(){return a},Z_:function(){return c}});var i=n(8299),o=n(2656);const r="For more visit: aka.ms/msaljs/browser-errors",s={[o.vD]:"The PKCE code challenge and verifier could not be generated.",[o.TR]:"The crypto object or function is not available.",[o.Ri]:"Navigation URI is empty. Please check stack trace for more info.",[o.nF]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${r}`,[o.Xk]:"Hash does not contain state. Please verify that the request originated from msal.",[o.S_]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${r}`,[o.$P]:"Unable to parse state. Please verify that the request originated from msal.",[o.yK]:"Hash contains state but the interaction type does not match the caller.",[o.Ck]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${r}`,[o.E]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[o.H]:"window.open returned null or undefined window object.",[o.h7]:"User cancelled the flow.",[o.ZT]:`Token acquisition in popup failed due to timeout.  ${r}`,[o.JA]:`Token acquisition in iframe failed due to timeout.  ${r}`,[o.b_]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[o.xO]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${r}`,[o.bj]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[o.h8]:"The iframe being monitored was closed prematurely.",[o.I9]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[o.wH]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[o.WQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[o.QO]:"No token request found in cache.",[o.e$]:"The cached token request could not be parsed.",[o.dT]:"No cached authority found.",[o.BO]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[o.Ut]:"Invalid cache type",[o.Dx]:"Login and token requests are not supported in non-browser environments.",[o.IL]:"Database is not open!",[o.Mq]:"No network connectivity. Check your internet connection.",[o.Dc]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[o.C8]:"Network request failed. Please check the network trace to determine root cause.",[o.w6]:"Failed to parse network response. Check network trace.",[o.Jd]:"Error loading token to cache.",[o.XM]:"Cryptographic Key or Keypair not found in browser storage.",[o.Aj]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[o.Dy]:"An authorization code or nativeAccountId must be provided to this flow.",[o.LL]:"Request cannot contain both spa code and native account id.",[o.Pi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[o.KA]:`Unable to acquire token from native platform.  ${r}`,[o.hR]:"Timed out while attempting to establish connection to browser extension",[o.Wb]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[o.V7]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${r}`,[o.al]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${r}`,[o.o9]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[o.lZ]:"Invalid base64 encoded string."};o.vD,o.vD,o.TR,o.TR,o.Ri,o.Ri,o.nF,o.nF,o.Xk,o.Xk,o.S_,o.S_,o.$P,o.$P,o.yK,o.yK,o.Ck,o.Ck,o.E,o.E,o.H,o.H,o.h7,o.h7,o.ZT,o.ZT,o.JA,o.JA,o.b_,o.b_,o.xO,o.xO,o.bj,o.bj,o.h8,o.h8,o.I9,o.I9,o.wH,o.wH,o.WQ,o.WQ,o.QO,o.QO,o.e$,o.e$,o.dT,o.dT,o.BO,o.BO,o.Ut,o.Ut,o.Dx,o.Dx,o.IL,o.IL,o.Mq,o.Mq,o.Dc,o.Dc,o.C8,o.C8,o.w6,o.w6,o.Jd,o.Jd,o.XM,o.XM,o.Aj,o.Aj,o.Dy,o.Dy,o.LL,o.LL,o.Pi,o.Pi,o.KA,o.KA,o.hR,o.hR,o.Wb,o.Wb,o.V7,o.V7,o.al,o.al,o.o9,o.o9,o.lZ,o.lZ;class a extends i.l4{constructor(t){super(t,s[t]),Object.setPrototypeOf(this,a.prototype),this.name="BrowserAuthError"}}function c(t){return new a(t)}},2656:function(t,e,n){"use strict";n.d(e,{$P:function(){return u},Aj:function(){return F},BO:function(){return I},C8:function(){return O},Ck:function(){return h},Dc:function(){return H},Dx:function(){return E},Dy:function(){return x},E:function(){return d},H:function(){return f},I9:function(){return C},IL:function(){return N},JA:function(){return m},Jd:function(){return M},KA:function(){return L},LL:function(){return q},Mq:function(){return P},Pi:function(){return B},QO:function(){return T},S_:function(){return c},TR:function(){return o},Ut:function(){return R},V7:function(){return G},WQ:function(){return k},Wb:function(){return j},XM:function(){return D},Xk:function(){return a},ZT:function(){return v},Ri:function(){return r},al:function(){return K},b_:function(){return g},bj:function(){return y},dT:function(){return A},e$:function(){return b},h7:function(){return p},h8:function(){return _},hR:function(){return W},lZ:function(){return $},nF:function(){return s},o9:function(){return z},vD:function(){return i},w6:function(){return U},wH:function(){return S},xO:function(){return w},yK:function(){return l}});const i="pkce_not_created",o="crypto_nonexistent",r="empty_navigate_uri",s="hash_empty_error",a="no_state_in_hash",c="hash_does_not_contain_known_properties",u="unable_to_parse_state",l="state_interaction_type_mismatch",h="interaction_in_progress",d="popup_window_error",f="empty_window_error",p="user_cancelled",v="monitor_popup_timeout",m="monitor_window_timeout",g="redirect_in_iframe",w="block_iframe_reload",y="block_nested_popups",_="iframe_closed_prematurely",C="silent_logout_unsupported",S="no_account_error",k="silent_prompt_value_error",T="no_token_request_cache_error",b="unable_to_parse_token_request_cache_error",A="no_cached_authority_error",I="auth_request_not_set_error",R="invalid_cache_type",E="non_browser_environment",N="database_not_open",P="no_network_connectivity",H="post_request_failed",O="get_request_failed",U="failed_to_parse_response",M="unable_to_load_token",D="crypto_key_not_found",F="auth_code_required",x="auth_code_or_nativeAccountId_required",q="spa_code_and_nativeAccountId_present",B="database_unavailable",L="unable_to_acquire_token_from_native_platform",W="native_handshake_timeout",j="native_extension_not_installed",G="native_connection_not_established",K="uninitialized_public_client_application",z="native_prompt_not_supported",$="invalid_base64_string"},79:function(t,e,n){"use strict";n.d(e,{i:function(){return o},u:function(){return i}});const i="@azure/msal-browser",o="3.2.0"},8198:function(t,e,n){"use strict";n.d(e,{BD:function(){return r},Bs:function(){return h},EC:function(){return c},Gv:function(){return w},H4:function(){return m},Ix:function(){return a},Ky:function(){return s},Mm:function(){return v},Oq:function(){return l},WN:function(){return d},c4:function(){return u},kd:function(){return g},lu:function(){return y},qx:function(){return o},s_:function(){return f},yo:function(){return p}});var i=n(1899);const o={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},r={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},s={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},a={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},c={GET:"GET",POST:"POST"},u={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},l={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},h={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},d={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var f;!function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"}(f||(f={}));const p={scopes:i.f_},v="jwk",m="msal.db",g=1,w=`${m}.keys`,y={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5}},6380:function(t,e,n){"use strict";n.d(e,{Z_:function(){return r},ky:function(){return s}});var i=n(4508),o=n(6788);function r(t,e){const n=function(t){if(!t)throw(0,i.zP)(o.PM);const e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!e||e.length<4)throw(0,i.zP)(o.GH);return e[2]}(t);try{const t=e(n);return JSON.parse(t)}catch(t){throw(0,i.zP)(o.GH)}}function s(t,e){if(0===e||Date.now()-3e5>t+e)throw(0,i.zP)(o.Ao)}},2400:function(t,e,n){"use strict";n.d(e,{B:function(){return s},j:function(){return a}});var i=n(4508),o=n(1899),r=n(6788);function s(t,e){if(!t)throw(0,i.zP)(r.S7);try{const n=e.base64Decode(t);return JSON.parse(n)}catch(t){throw(0,i.zP)(r.ZE)}}function a(t){if(!t)throw(0,i.zP)(r.ZE);const e=t.split(o.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?o.gT.EMPTY_STRING:e[1]}}},1120:function(t,e,n){"use strict";n.d(e,{z:function(){return i}});const i={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"}},9641:function(t,e,n){"use strict";n.d(e,{a:function(){return i}});const i={Default:0,Adfs:1,Dsts:2,Ciam:3}},8940:function(t,e,n){"use strict";n.d(e,{A:function(){return i}});const i={AAD:"AAD",OIDC:"OIDC"}},2817:function(t,e,n){"use strict";n.d(e,{L:function(){return l},w:function(){return h}});var i=n(1899),o=n(2581),r=n(764),s=n(4508),a=n(6380),c=n(2521),u=n(6788);class l{constructor(t,e,n){this.clientId=t,this.cryptoImpl=e,this.commonLogger=n.clone(c.u,c.i)}getAllAccounts(t){if(t)return this.getAccountsFilteredBy(t).map((t=>t.getAccountInfo()));const e=this.getAccountKeys();return e.length<1?[]:e.reduce(((t,e)=>{const n=this.getAccount(e);return n?(t.push(n),t):t}),[]).map((t=>this.getAccountInfoFromEntity(t)))}getAccountInfoFilteredBy(t){const e=this.getAccountsFilteredBy(t);return e.length>0?this.getAccountInfoFromEntity(e[0]):null}getAccountInfoFromEntity(t){const e=t.getAccountInfo(),n=this.getIdToken(e);return n&&(e.idToken=n.secret,e.idTokenClaims=(0,a.Z_)(n.secret,this.cryptoImpl.base64Decode)),e}async saveCacheRecord(t,e){if(!t)throw(0,s.zP)(u.mj);t.account&&this.setAccount(t.account),t.idToken&&!1!==e?.idToken&&this.setIdTokenCredential(t.idToken),t.accessToken&&!1!==e?.accessToken&&await this.saveAccessToken(t.accessToken),t.refreshToken&&!1!==e?.refreshToken&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata)}async saveAccessToken(t){const e={clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash},n=this.getTokenKeys(),i=o.i.fromString(t.target),r=[];n.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!1))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&o.i.fromString(n.target).intersectingScopeSets(i)&&r.push(this.removeAccessToken(t))})),await Promise.all(r),this.setAccessTokenCredential(t)}getAccountsFilteredBy(t){const e=this.getAccountKeys(),n=[];return e.forEach((e=>{if(!this.isAccountKey(e,t.homeAccountId,t.tenantId))return;const i=this.getAccount(e);i&&(t.homeAccountId&&!this.matchHomeAccountId(i,t.homeAccountId)||t.localAccountId&&!this.matchLocalAccountId(i,t.localAccountId)||t.username&&!this.matchUsername(i,t.username)||t.environment&&!this.matchEnvironment(i,t.environment)||t.realm&&!this.matchRealm(i,t.realm)||t.tenantId&&!this.matchRealm(i,t.tenantId)||t.nativeAccountId&&!this.matchNativeAccountId(i,t.nativeAccountId)||t.loginHint&&!this.matchLoginHint(i,t.loginHint)||t.authorityType&&!this.matchAuthorityType(i,t.authorityType)||t.name&&!this.matchName(i,t.name)||n.push(i))})),n}isAccountKey(t,e,n){return!(t.split(i.Bv.CACHE_KEY_SEPARATOR).length<3||e&&!t.toLowerCase().includes(e.toLowerCase())||n&&!t.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(t){if(t.split(i.Bv.CACHE_KEY_SEPARATOR).length<6)return!1;const e=t.toLowerCase();if(-1===e.indexOf(i.d3.ID_TOKEN.toLowerCase())&&-1===e.indexOf(i.d3.ACCESS_TOKEN.toLowerCase())&&-1===e.indexOf(i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===e.indexOf(i.d3.REFRESH_TOKEN.toLowerCase()))return!1;if(e.indexOf(i.d3.REFRESH_TOKEN.toLowerCase())>-1){const t=`${i.d3.REFRESH_TOKEN}${i.Bv.CACHE_KEY_SEPARATOR}${this.clientId}${i.Bv.CACHE_KEY_SEPARATOR}`,n=`${i.d3.REFRESH_TOKEN}${i.Bv.CACHE_KEY_SEPARATOR}${i.ch}${i.Bv.CACHE_KEY_SEPARATOR}`;if(-1===e.indexOf(t.toLowerCase())&&-1===e.indexOf(n.toLowerCase()))return!1}else if(-1===e.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(t,e){if(e.clientId&&!this.matchClientId(t,e.clientId))return!1;if(e.userAssertionHash&&!this.matchUserAssertionHash(t,e.userAssertionHash))return!1;if("string"==typeof e.homeAccountId&&!this.matchHomeAccountId(t,e.homeAccountId))return!1;if(e.environment&&!this.matchEnvironment(t,e.environment))return!1;if(e.realm&&!this.matchRealm(t,e.realm))return!1;if(e.credentialType&&!this.matchCredentialType(t,e.credentialType))return!1;if(e.familyId&&!this.matchFamilyId(t,e.familyId))return!1;if(e.target&&!this.matchTarget(t,e.target))return!1;if((e.requestedClaimsHash||t.requestedClaimsHash)&&t.requestedClaimsHash!==e.requestedClaimsHash)return!1;if(t.credentialType===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(e.tokenType&&!this.matchTokenType(t,e.tokenType))return!1;if(e.tokenType===i.hO.SSH&&e.keyId&&!this.matchKeyId(t,e.keyId))return!1}return!0}getAppMetadataFilteredBy(t){return this.getAppMetadataFilteredByInternal(t.environment,t.clientId)}getAppMetadataFilteredByInternal(t,e){const n=this.getKeys(),i={};return n.forEach((n=>{if(!this.isAppMetadata(n))return;const o=this.getAppMetadata(n);o&&(t&&!this.matchEnvironment(o,t)||e&&!this.matchClientId(o,e)||(i[n]=o))})),i}getAuthorityMetadataByAlias(t){const e=this.getAuthorityMetadataKeys();let n=null;return e.forEach((e=>{if(!this.isAuthorityMetadata(e)||-1===e.indexOf(this.clientId))return;const i=this.getAuthorityMetadata(e);i&&-1!==i.aliases.indexOf(t)&&(n=i)})),n}async removeAllAccounts(){const t=this.getAccountKeys(),e=[];t.forEach((t=>{e.push(this.removeAccount(t))})),await Promise.all(e)}async removeAccount(t){const e=this.getAccount(t);e&&(await this.removeAccountContext(e),this.removeItem(t))}async removeAccountContext(t){const e=this.getTokenKeys(),n=t.generateAccountId(),i=[];e.idToken.forEach((t=>{0===t.indexOf(n)&&this.removeIdToken(t)})),e.accessToken.forEach((t=>{0===t.indexOf(n)&&i.push(this.removeAccessToken(t))})),e.refreshToken.forEach((t=>{0===t.indexOf(n)&&this.removeRefreshToken(t)})),await Promise.all(i)}async removeAccessToken(t){const e=this.getAccessTokenCredential(t);if(e){if(e.credentialType.toLowerCase()===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&e.tokenType===i.hO.POP){const t=e.keyId;if(t)try{await this.cryptoImpl.removeTokenBindingKey(t)}catch(t){throw(0,s.zP)(u.ol)}}return this.removeItem(t)}}removeAppMetadata(){return this.getKeys().forEach((t=>{this.isAppMetadata(t)&&this.removeItem(t)})),!0}readCacheRecord(t,e,n){const i=this.getTokenKeys(),o=this.readAccountFromCache(t),r=this.getIdToken(t,i),s=this.getAccessToken(t,e,i),c=this.getRefreshToken(t,!1,i),u=this.readAppMetadataFromCache(n);return o&&r&&(o.idTokenClaims=(0,a.Z_)(r.secret,this.cryptoImpl.base64Decode)),{account:o,idToken:r,accessToken:s,refreshToken:c,appMetadata:u}}readAccountFromCache(t){const e=r.r.generateAccountCacheKey(t);return this.getAccount(e)}getIdToken(t,e){this.commonLogger.trace("CacheManager - getIdToken called");const n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:i.d3.ID_TOKEN,clientId:this.clientId,realm:t.tenantId},o=this.getIdTokensByFilter(n,e),r=o.length;return r<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):r>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),o.forEach((t=>{this.removeIdToken(t.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),o[0])}getIdTokensByFilter(t,e){const n=e&&e.idToken||this.getTokenKeys().idToken,i=[];return n.forEach((e=>{if(!this.idTokenKeyMatchesFilter(e,{clientId:this.clientId,...t}))return;const n=this.getIdTokenCredential(e);n&&this.credentialMatchesFilter(n,t)&&i.push(n)})),i}idTokenKeyMatchesFilter(t,e){const n=t.toLowerCase();return!(e.clientId&&-1===n.indexOf(e.clientId.toLowerCase())||e.homeAccountId&&-1===n.indexOf(e.homeAccountId.toLowerCase()))}removeIdToken(t){this.removeItem(t)}removeRefreshToken(t){this.removeItem(t)}getAccessToken(t,e,n){this.commonLogger.trace("CacheManager - getAccessToken called");const r=o.i.createSearchScopes(e.scopes),s=e.authenticationScheme||i.hO.BEARER,a=s&&s.toLowerCase()!==i.hO.BEARER.toLowerCase()?i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:i.d3.ACCESS_TOKEN,c={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:a,clientId:this.clientId,realm:t.tenantId,target:r,tokenType:s,keyId:e.sshKid,requestedClaimsHash:e.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,l=[];u.forEach((t=>{if(this.accessTokenKeyMatchesFilter(t,c,!0)){const e=this.getAccessTokenCredential(t);e&&this.credentialMatchesFilter(e,c)&&l.push(e)}}));const h=l.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),l.forEach((t=>{this.removeAccessToken(t.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),l[0])}accessTokenKeyMatchesFilter(t,e,n){const i=t.toLowerCase();if(e.clientId&&-1===i.indexOf(e.clientId.toLowerCase()))return!1;if(e.homeAccountId&&-1===i.indexOf(e.homeAccountId.toLowerCase()))return!1;if(e.realm&&-1===i.indexOf(e.realm.toLowerCase()))return!1;if(e.requestedClaimsHash&&-1===i.indexOf(e.requestedClaimsHash.toLowerCase()))return!1;if(e.target){const t=e.target.asArray();for(let e=0;e<t.length;e++){if(n&&!i.includes(t[e].toLowerCase()))return!1;if(!n&&i.includes(t[e].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(t){const e=this.getTokenKeys(),n=[];return e.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!0))return;const i=this.getAccessTokenCredential(e);i&&this.credentialMatchesFilter(i,t)&&n.push(i)})),n}getRefreshToken(t,e,n){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=e?i.ch:void 0,r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:i.d3.REFRESH_TOKEN,clientId:this.clientId,familyId:o},s=n&&n.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((t=>{if(this.refreshTokenKeyMatchesFilter(t,r)){const e=this.getRefreshTokenCredential(t);e&&this.credentialMatchesFilter(e,r)&&a.push(e)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])}refreshTokenKeyMatchesFilter(t,e){const n=t.toLowerCase();return!(e.familyId&&-1===n.indexOf(e.familyId.toLowerCase())||!e.familyId&&e.clientId&&-1===n.indexOf(e.clientId.toLowerCase())||e.homeAccountId&&-1===n.indexOf(e.homeAccountId.toLowerCase()))}readAppMetadataFromCache(t){const e={environment:t,clientId:this.clientId},n=this.getAppMetadataFilteredBy(e),i=Object.keys(n).map((t=>n[t])),o=i.length;if(o<1)return null;if(o>1)throw(0,s.zP)(u.EC);return i[0]}isAppMetadataFOCI(t){const e=this.readAppMetadataFromCache(t);return!(!e||e.familyId!==i.ch)}matchHomeAccountId(t,e){return!("string"!=typeof t.homeAccountId||e!==t.homeAccountId)}matchLocalAccountId(t,e){return!("string"!=typeof t.localAccountId||e!==t.localAccountId)}matchUsername(t,e){return!("string"!=typeof t.username||e.toLowerCase()!==t.username.toLowerCase())}matchName(t,e){return!(e.toLowerCase()!==t.name?.toLowerCase())}matchUserAssertionHash(t,e){return!(!t.userAssertionHash||e!==t.userAssertionHash)}matchEnvironment(t,e){const n=this.getAuthorityMetadataByAlias(e);return!!(n&&n.aliases.indexOf(t.environment)>-1)}matchCredentialType(t,e){return t.credentialType&&e.toLowerCase()===t.credentialType.toLowerCase()}matchClientId(t,e){return!(!t.clientId||e!==t.clientId)}matchFamilyId(t,e){return!(!t.familyId||e!==t.familyId)}matchRealm(t,e){return!(!t.realm||e!==t.realm)}matchNativeAccountId(t,e){return!(!t.nativeAccountId||e!==t.nativeAccountId)}matchLoginHint(t,e){return t.idTokenClaims?.login_hint===e||t.username===e||t.idTokenClaims?.upn===e}matchAuthorityType(t,e){return!(!t.authorityType||e.toLowerCase()!==t.authorityType.toLowerCase())}matchTarget(t,e){return!(t.credentialType!==i.d3.ACCESS_TOKEN&&t.credentialType!==i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!t.target)&&o.i.fromString(t.target).containsScopeSet(e)}matchTokenType(t,e){return!(!t.tokenType||t.tokenType!==e)}matchKeyId(t,e){return!(!t.keyId||t.keyId!==e)}isAppMetadata(t){return-1!==t.indexOf(i.dg)}isAuthorityMetadata(t){return-1!==t.indexOf(i.QU.CACHE_KEY)}generateAuthorityMetadataCacheKey(t){return`${i.QU.CACHE_KEY}-${this.clientId}-${t}`}static toObject(t,e){for(const n in e)t[n]=e[n];return t}}class h extends l{setAccount(){throw(0,s.zP)(u.M2)}getAccount(){throw(0,s.zP)(u.M2)}setIdTokenCredential(){throw(0,s.zP)(u.M2)}getIdTokenCredential(){throw(0,s.zP)(u.M2)}setAccessTokenCredential(){throw(0,s.zP)(u.M2)}getAccessTokenCredential(){throw(0,s.zP)(u.M2)}setRefreshTokenCredential(){throw(0,s.zP)(u.M2)}getRefreshTokenCredential(){throw(0,s.zP)(u.M2)}setAppMetadata(){throw(0,s.zP)(u.M2)}getAppMetadata(){throw(0,s.zP)(u.M2)}setServerTelemetry(){throw(0,s.zP)(u.M2)}getServerTelemetry(){throw(0,s.zP)(u.M2)}setAuthorityMetadata(){throw(0,s.zP)(u.M2)}getAuthorityMetadata(){throw(0,s.zP)(u.M2)}getAuthorityMetadataKeys(){throw(0,s.zP)(u.M2)}setThrottlingCache(){throw(0,s.zP)(u.M2)}getThrottlingCache(){throw(0,s.zP)(u.M2)}removeItem(){throw(0,s.zP)(u.M2)}containsKey(){throw(0,s.zP)(u.M2)}getKeys(){throw(0,s.zP)(u.M2)}getAccountKeys(){throw(0,s.zP)(u.M2)}getTokenKeys(){throw(0,s.zP)(u.M2)}async clear(){throw(0,s.zP)(u.M2)}updateCredentialCacheKey(){throw(0,s.zP)(u.M2)}}},764:function(t,e,n){"use strict";n.d(e,{r:function(){return u}});var i=n(1899),o=n(2400),r=n(4508),s=n(9641),a=n(8940),c=n(6788);class u{generateAccountId(){return[this.homeAccountId,this.environment].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return u.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType}}static generateAccountCacheKey(t){return[t.homeAccountId,t.environment||i.gT.EMPTY_STRING,t.tenantId||i.gT.EMPTY_STRING].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(t,e){const n=new u;e.authorityType===s.a.Adfs?n.authorityType=i.iR.ADFS_ACCOUNT_TYPE:e.protocolMode===a.A.AAD?n.authorityType=i.iR.MSSTS_ACCOUNT_TYPE:n.authorityType=i.iR.GENERIC_ACCOUNT_TYPE,n.clientInfo=t.clientInfo,n.homeAccountId=t.homeAccountId,n.nativeAccountId=t.nativeAccountId;const o=t.environment||e&&e.getPreferredCache();if(!o)throw(0,r.zP)(c.Q9);n.environment=o,n.realm=t.idTokenClaims.tid||i.gT.EMPTY_STRING,n.idTokenClaims=t.idTokenClaims,n.localAccountId=t.idTokenClaims.oid||t.idTokenClaims.sub||i.gT.EMPTY_STRING;const l=t.idTokenClaims.preferred_username||t.idTokenClaims.upn,h=t.idTokenClaims.emails?t.idTokenClaims.emails[0]:null;return n.username=l||h||i.gT.EMPTY_STRING,n.name=t.idTokenClaims.name,n.cloudGraphHostName=t.cloudGraphHostName,n.msGraphHost=t.msGraphHost,n}static createFromAccountInfo(t,e,n){const o=new u;return o.authorityType=t.authorityType||i.iR.GENERIC_ACCOUNT_TYPE,o.homeAccountId=t.homeAccountId,o.localAccountId=t.localAccountId,o.nativeAccountId=t.nativeAccountId,o.realm=t.tenantId,o.environment=t.environment,o.username=t.username,o.name=t.name,o.idTokenClaims=t.idTokenClaims,o.cloudGraphHostName=e,o.msGraphHost=n,o}static generateHomeAccountId(t,e,n,r,a){const c=a?.sub?a.sub:i.gT.EMPTY_STRING;if(e===s.a.Adfs||e===s.a.Dsts)return c;if(t)try{const e=(0,o.B)(t,r);if(e.uid&&e.utid)return`${e.uid}${i.Bv.CLIENT_INFO_SEPARATOR}${e.utid}`}catch(t){}return n.verbose("No client info in response"),c}static isAccountEntity(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType")}static accountInfoIsEqual(t,e,n){if(!t||!e)return!1;let i=!0;if(n){const n=t.idTokenClaims||{},o=e.idTokenClaims||{};i=n.iat===o.iat&&n.nonce===o.nonce}return t.homeAccountId===e.homeAccountId&&t.localAccountId===e.localAccountId&&t.username===e.username&&t.tenantId===e.tenantId&&t.environment===e.environment&&t.nativeAccountId===e.nativeAccountId&&i}}},6148:function(t,e,n){"use strict";n.d(e,{j6:function(){return _},lh:function(){return C},z:function(){return d}});var i=n(1510),o=n(3079),r=n(1899),s=n(2521),a=n(1120),c=n(2817),u=n(8940),l=n(4508),h=n(6788);const d={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},f={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:o.i.Info,correlationId:r.gT.EMPTY_STRING},p={claimsBasedCachingEnabled:!1},v={async sendGetRequestAsync(){throw(0,l.zP)(h.M2)},async sendPostRequestAsync(){throw(0,l.zP)(h.M2)}},m={sku:r.gT.SKU,version:s.i,cpu:r.gT.EMPTY_STRING,os:r.gT.EMPTY_STRING},g={clientSecret:r.gT.EMPTY_STRING,clientAssertion:void 0},w={azureCloudInstance:a.z.None,tenant:`${r.gT.DEFAULT_COMMON_TENANT}`},y={application:{appName:"",appVersion:""}};function _({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:r,storageInterface:s,networkInterface:a,cryptoInterface:u,clientCredentials:l,libraryInfo:h,telemetry:_,serverTelemetryManager:C,persistencePlugin:S,serializableCache:k}){const T={...f,...n};return{authOptions:(b=t,{clientCapabilities:[],azureCloudOptions:w,skipAuthorityMetadataCache:!1,...b}),systemOptions:{...d,...e},loggerOptions:T,cacheOptions:{...p,...r},storageInterface:s||new c.w(t.clientId,i.d,new o.Y(T)),networkInterface:a||v,cryptoInterface:u||i.d,clientCredentials:l||g,libraryInfo:{...m,...h},telemetry:{...y,..._},serverTelemetryManager:C||null,persistencePlugin:S||null,serializableCache:k||null};var b}function C(t){return t.authOptions.authority.options.protocolMode===u.A.OIDC}},1510:function(t,e,n){"use strict";n.d(e,{d:function(){return r}});var i=n(4508),o=n(6788);const r={createNewGuid:()=>{throw(0,i.zP)(o.M2)},base64Decode:()=>{throw(0,i.zP)(o.M2)},base64Encode:()=>{throw(0,i.zP)(o.M2)},async getPublicKeyThumbprint(){throw(0,i.zP)(o.M2)},async removeTokenBindingKey(){throw(0,i.zP)(o.M2)},async clearKeystore(){throw(0,i.zP)(o.M2)},async signJwt(){throw(0,i.zP)(o.M2)},async hashString(){throw(0,i.zP)(o.M2)}}},8299:function(t,e,n){"use strict";n.d(e,{MD:function(){return a},l4:function(){return s}});var i=n(1899),o=n(6108);const r={[o.g]:"Unexpected error in authentication.",[o.D]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};o.g,r[o.g],o.D,r[o.D];class s extends Error{constructor(t,e,n){super(e?`${t}: ${e}`:t),Object.setPrototypeOf(this,s.prototype),this.errorCode=t||i.gT.EMPTY_STRING,this.errorMessage=e||i.gT.EMPTY_STRING,this.subError=n||i.gT.EMPTY_STRING,this.name="AuthError"}setCorrelationId(t){this.correlationId=t}}function a(t,e){return new s(t,e?`${r[t]} ${e}`:r[t])}},6108:function(t,e,n){"use strict";n.d(e,{D:function(){return o},g:function(){return i}});const i="unexpected_error",o="post_request_failed"},4508:function(t,e,n){"use strict";n.d(e,{er:function(){return s},zP:function(){return a}});var i=n(8299),o=n(6788);const r={[o.ZE]:"The client info could not be parsed/decoded correctly",[o.S7]:"The client info was empty",[o.GH]:"Token cannot be parsed",[o.PM]:"The token is null or empty",[o.HO]:"Endpoints cannot be resolved",[o.EF]:"Network request failed",[o.Ce]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[o.b4]:"The hash parameters could not be deserialized",[o.r8]:"State was not the expected format",[o.Tu]:"State mismatch error",[o.LV]:"State not found",[o.vR]:"Nonce mismatch error",[o.w7]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[o.Ao]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[o.MU]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[o.RH]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[o.EC]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[o.FU]:"Token request cannot be made without authorization code or refresh token.",[o.v1]:"Cannot remove null or empty scope from ScopeSet",[o.f4]:"Cannot append ScopeSet",[o.S]:"Empty input ScopeSet cannot be processed",[o.Jk]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[o.tS]:"Device code is expired.",[o.ZT]:"Device code stopped polling for unknown reasons.",[o.D7]:"Please pass an account object, silent flow is not supported without account information",[o.mj]:"Cache record object was null or undefined.",[o.Q9]:"Invalid environment when attempting to create cache entry",[o.cX]:"No account found in cache for given key.",[o.QL]:"No crypto object detected.",[o.cy]:"Unexpected credential type.",[o.aE]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[o.SX]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[o.s$]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[o.nQ]:"User defined timeout for device code polling reached",[o.P_]:"Cannot generate a POP jwt if the token_claims are not populated",[o.Zv]:"Server response does not contain an authorization code to proceed",[o.ol]:"Could not remove the credential's binding key from storage.",[o.ig]:"The provided authority does not support logout",[o.Of]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[o.Mq]:"No network connectivity. Check your internet connection.",[o.$R]:"User cancelled the flow.",[o.k7]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[o.M2]:"This method has not been implemented"};o.ZE,o.ZE,o.S7,o.S7,o.GH,o.GH,o.PM,o.PM,o.HO,o.HO,o.EF,o.EF,o.Ce,o.Ce,o.b4,o.b4,o.r8,o.r8,o.Tu,o.Tu,o.LV,o.LV,o.vR,o.vR,o.w7,o.w7,o.Ao,o.Ao,o.MU,o.MU,o.RH,o.RH,o.EC,o.EC,o.FU,o.FU,o.v1,o.v1,o.f4,o.f4,o.S,o.S,o.Jk,o.Jk,o.tS,o.tS,o.ZT,o.ZT,o.D7,o.D7,o.mj,o.mj,o.Q9,o.Q9,o.cX,o.cX,o.QL,o.QL,o.cy,o.cy,o.aE,o.aE,o.SX,o.SX,o.s$,o.s$,o.nQ,o.nQ,o.P_,o.P_,o.Zv,o.Zv,o.ol,o.ol,o.ig,o.ig,o.Of,o.Of,o.Mq,o.Mq,o.$R,o.$R,o.k7,o.k7;class s extends i.l4{constructor(t,e){super(t,e?`${r[t]}: ${e}`:r[t]),this.name="ClientAuthError",Object.setPrototypeOf(this,s.prototype)}}function a(t,e){return new s(t,e)}},6788:function(t,e,n){"use strict";n.d(e,{$R:function(){return j},Ao:function(){return m},Ce:function(){return u},D7:function(){return I},EC:function(){return y},EF:function(){return c},FU:function(){return _},GH:function(){return r},HO:function(){return a},Jk:function(){return T},LV:function(){return f},M2:function(){return K},MU:function(){return g},Mq:function(){return W},Of:function(){return L},PM:function(){return s},P_:function(){return F},Q9:function(){return E},QL:function(){return P},RH:function(){return w},S:function(){return k},S7:function(){return o},SX:function(){return U},Tu:function(){return d},ZE:function(){return i},ZT:function(){return A},Zv:function(){return x},aE:function(){return O},b4:function(){return l},cX:function(){return N},cy:function(){return H},f4:function(){return S},ig:function(){return B},k7:function(){return G},mj:function(){return R},nQ:function(){return D},ol:function(){return q},r8:function(){return h},s$:function(){return M},tS:function(){return b},v1:function(){return C},vR:function(){return p},w7:function(){return v}});const i="client_info_decoding_error",o="client_info_empty_error",r="token_parsing_error",s="null_or_empty_token",a="endpoints_resolution_error",c="network_error",u="openid_config_error",l="hash_not_deserialized",h="invalid_state",d="state_mismatch",f="state_not_found",p="nonce_mismatch",v="auth_time_not_found",m="max_age_transpired",g="multiple_matching_tokens",w="multiple_matching_accounts",y="multiple_matching_appMetadata",_="request_cannot_be_made",C="cannot_remove_empty_scope",S="cannot_append_scopeset",k="empty_input_scopeset",T="device_code_polling_cancelled",b="device_code_expired",A="device_code_unknown_error",I="no_account_in_silent_request",R="invalid_cache_record",E="invalid_cache_environment",N="no_account_found",P="no_crypto_object",H="unexpected_credential_type",O="invalid_assertion",U="invalid_client_credential",M="token_refresh_required",D="user_timeout_reached",F="token_claims_cnf_required_for_signedjwt",x="authorization_code_missing_from_server_response",q="binding_key_not_removed",B="end_session_endpoint_not_supported",L="key_id_missing",W="no_network_connectivity",j="user_canceled",G="missing_tenant_id_error",K="method_not_implemented"},150:function(t,e,n){"use strict";n.d(e,{ei:function(){return a}});var i=n(8299),o=n(5382);const r={[o.RV]:"A redirect URI is required for all calls, and none has been set.",[o.LB]:"Could not parse the given claims request object.",[o.Oz]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[o.yH]:"URL could not be parsed into appropriate segments.",[o.To]:"URL was empty or null.",[o.vE]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[o.z_]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[o.nm]:"Given claims parameter must be a stringified JSON object.",[o.dL]:"Token request was empty and not found in cache.",[o.$h]:"The logout request was null or undefined.",[o.d6]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[o.TU]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[o.E]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[o.zx]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[o.o_]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[o.dK]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[o.hI]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[o.U9]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[o.i1]:"Invalid authentication header provided",[o.qz]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[o.Ol]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[o.Hv]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};o.RV,o.RV,o.LB,o.LB,o.Oz,o.Oz,o.yH,o.yH,o.To,o.To,o.vE,o.vE,o.z_,o.z_,o.nm,o.nm,o.dL,o.dL,o.$h,o.$h,o.d6,o.d6,o.TU,o.TU,o.E,o.E,o.zx,o.zx,o.o_,o.o_,o.dK,o.dK,o.hI,o.hI,o.U9,o.U9,o.i1,o.i1,o.qz,o.qz,o.Ol,o.Ol,o.Hv,o.Hv;class s extends i.l4{constructor(t){super(t,r[t]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,s.prototype)}}function a(t){return new s(t)}},5382:function(t,e,n){"use strict";n.d(e,{$h:function(){return d},E:function(){return v},Hv:function(){return T},LB:function(){return o},Ol:function(){return k},Oz:function(){return r},RV:function(){return i},TU:function(){return p},To:function(){return a},U9:function(){return _},d6:function(){return f},dK:function(){return w},dL:function(){return h},hI:function(){return y},i1:function(){return C},nm:function(){return l},o_:function(){return g},qz:function(){return S},vE:function(){return c},yH:function(){return s},z_:function(){return u},zx:function(){return m}});const i="redirect_uri_empty",o="claims_request_parsing_error",r="authority_uri_insecure",s="url_parse_error",a="empty_url_error",c="empty_input_scopes_error",u="invalid_prompt_value",l="invalid_claims",h="token_request_empty",d="logout_request_empty",f="invalid_code_challenge_method",p="pkce_params_missing",v="invalid_cloud_discovery_metadata",m="invalid_authority_metadata",g="untrusted_authority",w="missing_ssh_jwk",y="missing_ssh_kid",_="missing_nonce_authentication_header",C="invalid_authentication_header",S="cannot_set_OIDCOptions",k="cannot_allow_native_broker",T="authority_mismatch"},9435:function(t,e,n){"use strict";n.d(e,{Cf:function(){return l},Yo:function(){return u},ip:function(){return h}});var i=n(1899),o=n(8299),r=n(4180);const s=[r.tZ,r.Mo,r.kk],a=["message_only","additional_action","basic_action","user_password_expired","consent_required"],c={[r.I2]:"No refresh token found in the cache. Please sign-in.",[r.QP]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."};r.I2,c[r.I2],r.QP,c[r.QP];class u extends o.l4{constructor(t,e,n,o,r,s,a){super(t,e,n),Object.setPrototypeOf(this,u.prototype),this.timestamp=o||i.gT.EMPTY_STRING,this.traceId=r||i.gT.EMPTY_STRING,this.correlationId=s||i.gT.EMPTY_STRING,this.claims=a||i.gT.EMPTY_STRING,this.name="InteractionRequiredAuthError"}}function l(t,e,n){const i=!!t&&s.indexOf(t)>-1,o=!!n&&a.indexOf(n)>-1,r=!!e&&s.some((t=>e.indexOf(t)>-1));return i||r||o}function h(t){return new u(t,c[t])}},4180:function(t,e,n){"use strict";n.d(e,{I2:function(){return i},Mo:function(){return s},QP:function(){return o},kk:function(){return a},tZ:function(){return r}});const i="no_tokens_found",o="native_account_unavailable",r="interaction_required",s="consent_required",a="login_required"},3079:function(t,e,n){"use strict";n.d(e,{Y:function(){return r},i:function(){return i}});var i,o=n(1899);!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"}(i||(i={}));class r{constructor(t,e,n){this.level=i.Info;const s=t||r.createDefaultLoggerOptions();this.localCallback=s.loggerCallback||(()=>{}),this.piiLoggingEnabled=s.piiLoggingEnabled||!1,this.level="number"==typeof s.logLevel?s.logLevel:i.Info,this.correlationId=s.correlationId||o.gT.EMPTY_STRING,this.packageName=e||o.gT.EMPTY_STRING,this.packageVersion=n||o.gT.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:i.Info}}clone(t,e,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,e)}logMessage(t,e){if(e.logLevel>this.level||!this.piiLoggingEnabled&&e.containsPii)return;const n=`[${(new Date).toUTCString()}] : [${e.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${i[e.logLevel]} - ${t}`;this.executeCallback(e.logLevel,n,e.containsPii||!1)}executeCallback(t,e,n){this.localCallback&&this.localCallback(t,e,n)}error(t,e){this.logMessage(t,{logLevel:i.Error,containsPii:!1,correlationId:e||o.gT.EMPTY_STRING})}errorPii(t,e){this.logMessage(t,{logLevel:i.Error,containsPii:!0,correlationId:e||o.gT.EMPTY_STRING})}warning(t,e){this.logMessage(t,{logLevel:i.Warning,containsPii:!1,correlationId:e||o.gT.EMPTY_STRING})}warningPii(t,e){this.logMessage(t,{logLevel:i.Warning,containsPii:!0,correlationId:e||o.gT.EMPTY_STRING})}info(t,e){this.logMessage(t,{logLevel:i.Info,containsPii:!1,correlationId:e||o.gT.EMPTY_STRING})}infoPii(t,e){this.logMessage(t,{logLevel:i.Info,containsPii:!0,correlationId:e||o.gT.EMPTY_STRING})}verbose(t,e){this.logMessage(t,{logLevel:i.Verbose,containsPii:!1,correlationId:e||o.gT.EMPTY_STRING})}verbosePii(t,e){this.logMessage(t,{logLevel:i.Verbose,containsPii:!0,correlationId:e||o.gT.EMPTY_STRING})}trace(t,e){this.logMessage(t,{logLevel:i.Trace,containsPii:!1,correlationId:e||o.gT.EMPTY_STRING})}tracePii(t,e){this.logMessage(t,{logLevel:i.Trace,containsPii:!0,correlationId:e||o.gT.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},2521:function(t,e,n){"use strict";n.d(e,{i:function(){return o},u:function(){return i}});const i="@azure/msal-common",o="14.1.0"},2581:function(t,e,n){"use strict";n.d(e,{i:function(){return u}});var i=n(150),o=n(9e3),r=n(4508),s=n(1899),a=n(5382),c=n(6788);class u{constructor(t){const e=t?o.x.trimArrayEntries([...t]):[],n=e?o.x.removeEmptyStringsFromArray(e):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((t=>this.scopes.add(t)))}static fromString(t){const e=(t||s.gT.EMPTY_STRING).split(" ");return new u(e)}static createSearchScopes(t){const e=new u(t);return e.containsOnlyOIDCScopes()?e.removeScope(s.gT.OFFLINE_ACCESS_SCOPE):e.removeOIDCScopes(),e}validateInputScopes(t){if(!t||t.length<1)throw(0,i.ei)(a.vE)}containsScope(t){const e=this.printScopesLowerCase().split(" "),n=new u(e);return!!t&&n.scopes.has(t.toLowerCase())}containsScopeSet(t){return!(!t||t.scopes.size<=0)&&this.scopes.size>=t.scopes.size&&t.asArray().every((t=>this.containsScope(t)))}containsOnlyOIDCScopes(){let t=0;return s.$f.forEach((e=>{this.containsScope(e)&&(t+=1)})),this.scopes.size===t}appendScope(t){t&&this.scopes.add(t.trim())}appendScopes(t){try{t.forEach((t=>this.appendScope(t)))}catch(t){throw(0,r.zP)(c.f4)}}removeScope(t){if(!t)throw(0,r.zP)(c.v1);this.scopes.delete(t.trim())}removeOIDCScopes(){s.$f.forEach((t=>{this.scopes.delete(t)}))}unionScopeSets(t){if(!t)throw(0,r.zP)(c.S);const e=new Set;return t.scopes.forEach((t=>e.add(t.toLowerCase()))),this.scopes.forEach((t=>e.add(t.toLowerCase()))),e}intersectingScopeSets(t){if(!t)throw(0,r.zP)(c.S);t.containsOnlyOIDCScopes()||t.removeOIDCScopes();const e=this.unionScopeSets(t),n=t.getScopeCount(),i=this.getScopeCount();return e.size<i+n}getScopeCount(){return this.scopes.size}asArray(){const t=[];return this.scopes.forEach((e=>t.push(e))),t}printScopes(){return this.scopes?this.asArray().join(" "):s.gT.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}},8230:function(t,e,n){"use strict";n.d(e,{$L:function(){return o},Ak:function(){return i},x0:function(){return r}});const i={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",BaseClientExecutePostToTokenEndpoint:"baseClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponseFromHash:"handleCodeResponseFromHash",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromiseMeasurement",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},o={NotStarted:0,InProgress:1,Completed:2},r=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"])},1899:function(t,e,n){"use strict";n.d(e,{$f:function(){return s},As:function(){return h},Bv:function(){return y},D1:function(){return N},Fo:function(){return l},Ge:function(){return P},HN:function(){return I},L:function(){return D},LL:function(){return C},NJ:function(){return d},Nb:function(){return u},QU:function(){return b},SZ:function(){return a},To:function(){return M},VO:function(){return f},VX:function(){return p},Vi:function(){return c},W:function(){return O},YY:function(){return H},bb:function(){return E},ch:function(){return T},d3:function(){return _},dg:function(){return S},f_:function(){return r},gT:function(){return i},hO:function(){return R},iR:function(){return w},ki:function(){return U},oj:function(){return o},pQ:function(){return A},qJ:function(){return g},rg:function(){return v},sR:function(){return k},vw:function(){return m}});const i={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},o={SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},r=[i.OPENID_SCOPE,i.PROFILE_SCOPE,i.OFFLINE_ACCESS_SCOPE],s=[...r,i.EMAIL_SCOPE],a={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},c={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},u={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},l={CLIENT_ID:"client_id",REDIRECT_URI:"redirect_uri",RESPONSE_TYPE:"response_type",RESPONSE_MODE:"response_mode",GRANT_TYPE:"grant_type",CLAIMS:"claims",SCOPE:"scope",ERROR:"error",ERROR_DESCRIPTION:"error_description",ACCESS_TOKEN:"access_token",ID_TOKEN:"id_token",REFRESH_TOKEN:"refresh_token",EXPIRES_IN:"expires_in",STATE:"state",NONCE:"nonce",PROMPT:"prompt",SESSION_STATE:"session_state",CLIENT_INFO:"client_info",CODE:"code",CODE_CHALLENGE:"code_challenge",CODE_CHALLENGE_METHOD:"code_challenge_method",CODE_VERIFIER:"code_verifier",CLIENT_REQUEST_ID:"client-request-id",X_CLIENT_SKU:"x-client-SKU",X_CLIENT_VER:"x-client-VER",X_CLIENT_OS:"x-client-OS",X_CLIENT_CPU:"x-client-CPU",X_CLIENT_CURR_TELEM:"x-client-current-telemetry",X_CLIENT_LAST_TELEM:"x-client-last-telemetry",X_MS_LIB_CAPABILITY:"x-ms-lib-capability",X_APP_NAME:"x-app-name",X_APP_VER:"x-app-ver",POST_LOGOUT_URI:"post_logout_redirect_uri",ID_TOKEN_HINT:"id_token_hint",DEVICE_CODE:"device_code",CLIENT_SECRET:"client_secret",CLIENT_ASSERTION:"client_assertion",CLIENT_ASSERTION_TYPE:"client_assertion_type",TOKEN_TYPE:"token_type",REQ_CNF:"req_cnf",OBO_ASSERTION:"assertion",REQUESTED_TOKEN_USE:"requested_token_use",ON_BEHALF_OF:"on_behalf_of",FOCI:"foci",CCS_HEADER:"X-AnchorMailbox",RETURN_SPA_CODE:"return_spa_code",NATIVE_BROKER:"nativebroker",LOGOUT_HINT:"logout_hint"},h={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},d={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},f={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier"},p={PLAIN:"plain",S256:"S256"},v={QUERY:"query",FRAGMENT:"fragment"},m={...v,FORM_POST:"form_post"},g={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},w={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},y={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},_={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},C={ADFS:1001,MSA:1002,MSSTS:1003,GENERIC:1004,ACCESS_TOKEN:2001,REFRESH_TOKEN:2002,ID_TOKEN:2003,APP_METADATA:3001,UNDEFINED:9999},S="appmetadata",k="client_info",T="1",b={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},A={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},I={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},R={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},E={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},N={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},P={username:"username",password:"password"},H={httpSuccess:200,httpBadRequest:400},O={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},U={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},M={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},D={Jwt:"JWT",Jwk:"JWK",Pop:"pop"}},9e3:function(t,e,n){"use strict";n.d(e,{x:function(){return i}});class i{static isEmptyObj(t){if(t)try{const e=JSON.parse(t);return 0===Object.keys(e).length}catch(t){}return!0}static startsWith(t,e){return 0===t.indexOf(e)}static endsWith(t,e){return t.length>=e.length&&t.lastIndexOf(e)===t.length-e.length}static queryStringToObject(t){const e={},n=t.split("&"),i=t=>decodeURIComponent(t.replace(/\+/g," "));return n.forEach((t=>{if(t.trim()){const[n,o]=t.split(/=(.+)/g,2);n&&o&&(e[i(n)]=i(o))}})),e}static trimArrayEntries(t){return t.map((t=>t.trim()))}static removeEmptyStringsFromArray(t){return t.filter((t=>!!t))}static jsonParseHelper(t){try{return JSON.parse(t)}catch(t){return null}}static matchPattern(t,e){return new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(e)}}}},r={};function s(t){var e=r[t];if(void 0!==e)return e.exports;var n=r[t]={id:t,exports:{}};return o[t](n,n.exports,s),n.exports}s.m=o,s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},s.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var r={};t=t||[null,e({}),e([]),e(e)];for(var a=2&i&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((function(t){r[t]=function(){return n[t]}}));return r.default=function(){return n},s.d(o,r),o},s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.f={},s.e=function(t){return Promise.all(Object.keys(s.f).reduce((function(e,n){return s.f[n](t,e),e}),[]))},s.u=function(t){return{36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4630:"owl.handlers",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[t]+"."+{36:"08015b9d7f44c1be93fc",98:"d0b93bea6a8eb17fbd8b",399:"d212938cacf4f576c30f",666:"cb4dbd481a4cbb987514",712:"44bb4588b563a46c1eda",856:"1503371adb35fd81b50c",921:"67a09fd49c5b99d67dfd",1e3:"199bf8e44937f585bf1c",1029:"86433ec45bdaf889e19e",1102:"be1c5c1a4adefb27f10d",1105:"8b39233745df58383158",1133:"428efd42b709ef29c676",1350:"e2fc5c021337dbfdb099",1406:"a4850d2c3155701d2034",1489:"560261b92d83bc0ae702",1532:"47449b80079f0b4404eb",1608:"4134a840fd435fd34e02",1635:"d262eaed8ac980ce7434",1771:"793fa1b22ec0ad76d915",1791:"c02f202fc344d20f31c5",1825:"6169dfcc9f17040ab4f2",1993:"bee7e57e4e45096691b9",2046:"1543fb82b2c5fc1e8011",2129:"e9d8fea6379518c2f0a4",2281:"923f4280168eb2602550",2289:"4242de05354517bcf62a",2394:"bc6e2550ae04e7977b79",2772:"f3a0162eced55cf4f89b",2792:"dfde60888bb68e420067",2811:"0f2ba27f011079e78e7f",2855:"ddf5d92f2402823c1037",2902:"24f3cb678548f376eaba",3041:"33d6454d96402c1f9813",3075:"9c61073d8fb53737ea7f",3102:"2b6c402d6bf619fa61cb",3247:"2cb48e460c2344218cc9",3268:"37ae6f1e73d51ba44230",3395:"a90ec0965f1e008a73c6",3622:"fdbe5579bb07d819ac15",3787:"582722f8917ba2b78ef9",3872:"71a658b43a2593fd0ecf",4051:"430b237acfd06f0747e9",4144:"0c26c67b68418b37db31",4335:"d49e799346a931037751",4525:"ebd08896ddcc5bad6411",4628:"7737188a1bb62a0275b0",4630:"f2290b774141135b9d8b",4654:"6362e6e34af21d5bd113",4809:"bd187472756827a87c16",5167:"e6a7c5d8c8088009060b",5383:"2308c97046b2063f82e0",5467:"a3a1f888855abfc0c2a0",5760:"0cb2c123d32008c09131",5848:"9545fad683f1074f8604",5874:"e8b3f13180fb1b31d1be",6099:"80acc693991e953851b2",6233:"b69a4cac13ee0576ecf1",6251:"1a4ff5e48af69f848b98",6338:"3c29c3612a3175383492",6664:"67dd01e5ac16f9d18cd2",6727:"65dbebd7b04b318a1f1d",6774:"b0011ca7e6cecab630e2",6795:"6b57fb8c6dd6a77fbc08",6798:"ff9fd6787aa68a0e89ed",6832:"bcc9f8ef2080be8d16c8",6974:"40dae672e0c157fd3d6d",7e3:"bfa049a6f97e0e3ae034",7027:"0d119198d7ea531d0d58",7332:"fc41f3cdfb2a6a28217e",7335:"3bbb362f9a55a60601e6",7447:"b96634c440cddb51190e",7610:"2994eea54657f0493099",7681:"645ccfc5c76f930a67f3",7805:"18462b30bfac58b71c95",7986:"d5fae7f0076ed073adb5",8102:"73129d2f67f14c335f85",8217:"4e75c299f19ab8c32a44",8225:"0abff3acc5812b257c95",8253:"6137dbd913df212f0976",8294:"0ab112e12780893b836d",8342:"332cde542bac01e533af",8361:"e3c33d8e93482ac985cd",8438:"461814452c05e3c97926",8507:"440d5eb78bafca0b6481",8530:"735336668185330e7bf5",8660:"1e98dead4a2f92d040a7",8692:"71650365ba8b969d2c6a",8793:"733447c36e36b1eca85d",8904:"f792f9cfcb0d9a267db0",9054:"b9a2be87b92f217c6cc6",9173:"25fa950b93edbe0d7f4e",9264:"904dc006039c6313e064",9275:"d40783546a3e580c6e44",9355:"9e1089daf90ce15ea94e",9545:"4b454b29d3e0e5ae1a42",9660:"102fe2e09c7ce1512dfa",9729:"5d8e21b3bb672ed0cb57",9743:"a49bd6ec8428a6d440fa",9754:"a3e0fb99f67e0dbf3867",9779:"438f85ccddd0158e4777",9894:"f05387399bca7bb09148"}[t]+".js"},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n={},i="Microsoft.Office.OWL:",s.l=function(t,e,o,r){if(n[t])n[t].push(e);else{var a,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==i+o){a=h;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+o),a.src=t,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),a.integrity=s.sriHashes[r],a.crossOrigin="anonymous"),n[t]=[e];var d=function(e,i){a.onerror=a.onload=null,clearTimeout(f);var o=n[t];if(delete n[t],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((function(t){return t(i)})),e)return e(i)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&!t;)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t}(),s.sriHashes={36:"sha384-AkpUJvJCOd2vByq1HU40gFA0BTEc06bh28PhZH9rDQ2UILdLNbDafnUnoHLPRfZq",98:"sha384-qYGotODNWImNHfo9DDU7Tz9OKfJajxPD/bwDD1I1snWUkYRnb8o1XfxQ2B77wHE3",399:"sha384-DiKOhlWh67ZoiG25qEzF+T1GurQwAJxvuw5vZ0vG6Wy5XTO7K1RNFJocc3HXAblt",666:"sha384-SmqMUavtZfgeh/bxZDZHaKq1Y5gkO26spXR+oUTRPPkowwHmhR0WrSWQrP0zLnCp",712:"sha384-N9InZN4WuJbU+ekpiPr7jWwse7IPf2uB7U+vYPDg2AK6/SdlDBAfidqDKH1if/e/",856:"sha384-PtMvQVdsR3mp26Gu/+N+Xfa69knjeGGeMau4S/JRZVbNOZ2pQf6XLrYI54TpV/zm",921:"sha384-6K1hINAK34TjCD3om3QtEZoOLTLalwKf+FacHI4N3YlVpJS8pla7o+fkrKitLjy+",1e3:"sha384-xk7uP2Mxy9PDAWzOuiWshsavdiLykZHof449lUbVk7wQ6PG5cYZ7vXgN+canzeDE",1029:"sha384-IEWalH+pfv99rBO3EotMMYG/2eGsn99ZvBjOQKQ5Zi6cslsov+M7+P2Pdkcvb8B5",1102:"sha384-bxUri3l0J3FWcUZtG5p7xS2LfpJ0mzidHrLz0hhkjPyDSGSa4vBq4whCkofj+8nZ",1105:"sha384-vn3wXMlwh62KyUGLQ4G2FYKUevCTlkaxbcJfJmyfmQ6jTn6OvWYZIBMda2g7wXZW",1133:"sha384-cuMKZKzg4aJ4/TEI3uE4N6hqcXNz32lUfCS6PXdMuqEr/9rpSmWNXl8WZVt89zb2",1350:"sha384-siBOb8w8EhzMsXw139h5HBgI1/nnrjDKEMUWOJMJeE1qd7M699aMG1g7e6Zqrt5E",1406:"sha384-jSPtO42PS1E7m6aMMYNYd0nwLDjEJ9U54CKiwpQYyKjbNJ+10YJJXBXDTBCS9cqZ",1489:"sha384-3xucxwampAhhWbYdHG1xdzuYzUYVtlNSA6uhakC9tp7Np3ntpJOukGpCeMUDMzYX",1532:"sha384-y/01sCtAMLMvlePN1brHCobKnOIxQndIGC23W+CVudcNRLMRkPRbIiNunF4djhci",1608:"sha384-I8RbPhWQbU/7jxAmDHjEJGps8DxfIzGt2PsJ389zCggOiQbGqblFYfMj8hvfEvXc",1635:"sha384-4yDVKeKcoWXiCdYs5UJviNjpOeYtAOj9GhlxIdSo90HEUaDq7oWlphRDd07VdJvX",1771:"sha384-Gg9CM3A4Hl+00IrBN4ZqQOeZkqIJtokrMnooaeVnPfDn9/qHJJMbne6gykFFNcPM",1791:"sha384-9H1GI0OHpso5MoaxcaO+/MmRlgGAkyAP1JEf/4mRAq63Ut4Mzo4pbvILt+vTJqwY",1825:"sha384-faAlBNbif7V0FVsQmoKUxOdjCLbxOK6lafuEBD2sEdKISuPLLJGFjv2PHxRKO/Bv",1993:"sha384-BXEnIp3URoWcIA2GVBss9h/FzOYaKxRH+0CpUERoPetmPNyputEe8w3AgNcjGc3J",2046:"sha384-zi7whRpqgEPKBzC5A9gp46qPTot1Ynms6ecmTXBh0QvFvVv+RpaGp8/PQ+ssXc0r",2129:"sha384-MkIjYR7v2d6s1Lzs5yknQS1X0Jixq2MCBvEr+O+ALnjyucDZk+Ek8cEZpPodtAF6",2281:"sha384-nw0KNs+kgcuLG/c89iTaOVt+2mKV1k+OooELGGQdKH766LgZBwtfWWIet8kH/e4I",2289:"sha384-oms2kO1HePM+PTLM7iHvMpO1EJLmEqGl6M9yjfaVmFiqjRMHmQv9SrtFTOSgQTvM",2394:"sha384-E5YtPTv2qhQO8HAjBjmWAcMEgojSppyR0JsYACFK4YO8Tya1OHmfQeSRAJraEmWJ",2772:"sha384-ZAcvPolsywRK5RZ1VIZ4KqHETc2HzPqxLA/tYzD7PUoHMDm+iBAnqN2C5A12b3v/",2792:"sha384-DKDKCJKrdS5dxDkQ0r5JEot0p4k+Jn21xZHo03gpP4MEbhweIhtjSytFG89Rr4fX",2811:"sha384-r8qFT6VKXeF7c3fuVrwZhIV1qmPJxeF9q2h5hgwL/G7v1+vhjYvra9hbPfQ7+l1Y",2855:"sha384-ev1Zf8pmosOO3NklYv+lq2eBOc3k3P0PjgtmrJgXD3XB49ivqZlYIbLYciXWWI7B",2902:"sha384-2SVZhhb/Hjwp+wK0u3KdovNviTcIdAZipIaNA4IdoGE5TA0nuMpkdaYrTjF9BDRt",3041:"sha384-Umqw59aC8s81wZUmjhuRZeE1pTgS2eR4u1PGFN3IvkdcXFo0mJ2xkRPn910y00iJ",3075:"sha384-ZoPOG6QDh3vwGWurHX/4QvBYAtNm2O3vYf58W+cT25H0/mPkSC5+7xLTAFxYNUza",3102:"sha384-bhIxGbPfYPS7H/lzrQ3f8ncM/Yc0Y70y4Vb4PmmdH9mrWCGsPBpejmgmlfYUlGVK",3247:"sha384-NsXLvIZ7w6xtpXCriCnA4km8HHQ4RmHdkT+WBnypDy7GIEFxyfa/NxLs0jj+9urM",3268:"sha384-M2i9oTbHxUAtIiWpwRdTe3izVyAR8nX6j/7uZqDlRiCuFmkQC4L4DwWx54z1n5EU",3395:"sha384-6ZuoXQ+XqFCbGwtDcLMmdjPVYuL5OXb6H4KEKp1SomwZIrsE7v/HacdzFHnWKvci",3622:"sha384-dn2N1P+4rEbfrRNeiAqOB3SJKOH/nWh39z/6CAgSi78pMhJDS+hHpV4y88njNqez",3787:"sha384-86C9OcOE3ivI633lPY2jhvRmv7RaMWHCRRUtH4VTRvQ21mx5sa4/BEM3n+P1f4Qi",3872:"sha384-l9rsphJxfyFGPJNFbG/vXRE64MIXpwF7FWKNM3UZVEb/jipob+PPuoojShW1s4Q0",4051:"sha384-T7WWzdKMteSaIYLDxJt2VpAxLbgY1dP65Gc5KQuFdWKqVY0U1UPafy9T1DddhAsC",4144:"sha384-MTEV5C/OrcjKB104BMyDPCwS5QwmPaRNCKhosQRTUx1U8RmTufXLWxOSE0jxFwza",4335:"sha384-w5JfAWzJwfzkqZrP8vyuhF53YuQylvpVvPWnN6Nc9HzwFPQ3A+7mpCSRDyQm7ni8",4525:"sha384-4KAVvUDjNf2E2oD1rgXSEEYMzJ7bFud9drRXyNT7zJMNXtH0p3/mbQGh+R6G3hus",4628:"sha384-UmfyeuXGVv8yQ/XNnuQwO88gHbh7ax6XZ8JPrNoF6F7xhwkSDD1gm+SEePN97NZk",4630:"sha384-HFCNLozkLbFCzclcav5zF22zdkclZAcEuc6bNKwZzJBWNaPC0FvL8Ok8Olj/tcSM",4654:"sha384-RQ2Alp663KSWN8eyWiFBHvsO6PGKOvJKWlelLwYriYpViSG7ZZattmRNcSJaGAjg",4809:"sha384-mEIEdX4/W84kO66eCieg/SBL+AGE31BkIwxy0AE3lZV8wbPpohR8z24iaz0D6x2b",5167:"sha384-7/4xK8Ipib+nnezLLBed2XVanMESFIt5akGEdty+8KyG2DNGKjDkCC+tj3AIIAns",5383:"sha384-6PhEEaAG5Jfrx3KC/nizXLQFlbE+e3uas6rZnrvlRvTM7XTBYVRWNIe5UdYof1eP",5467:"sha384-0HsKhiwCWTG1f1uRs7yT24XIQMZnPyxju4Oisqxl2sCh65HDh8rOAd31H3u7elLc",5760:"sha384-xBtP6jk0qR3LPxz2lIwa/zmm9iWqyjAiHwONDTJY/y3nDseSVtj1ucI0WxDWkQa1",5848:"sha384-OKHGyx1twxV1A7isNehnXID5TjLMUwSwQ7xDQjQ1uruVFkffBUVCylrrENZhQOpt",5874:"sha384-SVOz9rljFWq66ZqnBTOJzJeO181+dGMt98KwS+kxlswwnXVHrSKZyFQX37/kqK8x",6099:"sha384-JLdXOmALO6VWnrVTqNYtq8G0yD8k0wo8f7aOKkv1uWB+/oWg1WcVCYvkG8uqCAtN",6233:"sha384-cmPoRK9m2BBlb1rp/3chkvuXjJtyRdjHqilK0ZYfGbBFdG2f+ORcRxCrGV64zdup",6251:"sha384-aYF9uX0KzSl7cgZ5F8voZYYIONiDFJnTLMPlgO+WvvQNDFl+GppdlJuNJjyQ652p",6338:"sha384-VyobKxh6ii2+5h2as1+Zw6xLFCO+Na5r6FIk46xgq+ZgainFxiZG6mBtu4a5V0x0",6664:"sha384-c+U3e+FSn5Vfx2EQSLH8Ddovq857rJwW/4fJdPdupQIRQdPDEoTUED/fgCss1bXi",6727:"sha384-5bVHw+dM3esMCfS6U6idBSucAeVqoBgGVQx2eGJ2HNd1jPFK4wLAC6RjginCMqdq",6774:"sha384-B4NCNrfOrwZXOHMifS8YaREheH6e7OD9VhDl/UrUaR67LWk7sRbL+n+rAvFqTbnS",6795:"sha384-39ZCsRJwiZbAQ9VdCVcXXiRlfgN0mQcFJ8oqcW6dMox1R20LTM9z+iTgeSrAnxGv",6798:"sha384-o88JAnCoMMqJDoITSwt5rZspnWXc8piCev0VDWvCo5Be6IyHY7cqqN0QQyOHB8Hs",6832:"sha384-/dVahuZ5II582hH/ii6RvsV/MxQ/0mJk/Oi5eUMC+aSPhjcQO/mZGnnM78bznScs",6974:"sha384-yL3XfpS9rykRwsJypeXGKG0K8YH8WEWpffSUYs2COF9b9RDnoj8t1zCwXXsvInTe",7e3:"sha384-b+JHbzGrb2P/AQhP667o8rCExPcXJ50oJyiWLKC4HTYYnLyT4odRLMUWEAira5Bw",7027:"sha384-RvqGitxinuXyguMpnskdqNbL1u8SmeqXzHY3uyVWSLt3DQKDIPsh3Nvj8kCqMYcH",7332:"sha384-sgYYCKtcMSKaWCfpw2Preu+kxOhIuR0BRMTib71D1zLoyPYncTDp+fbVbxjgbrHO",7335:"sha384-9r1AgOXdHEkW8cMSJMcL8C9n74mO0dipLI3rRBHW9jaZFxlPS92Ede3Xgz8uuM5a",7447:"sha384-TegfJc/cTV1fM3lhiIX501cO1XcFmT8b9u2MjxREcfPZeTrqdEn9Xfptfr8IOqdu",7610:"sha384-ow9Qp+hQng3sD6awqFsJTlwtfOHo4/vz/9qiyE+lp6QyhVxoOGwjjYp8bCMbth52",7681:"sha384-H2mDdteN0+uS9RlNx8ckfV/RfxR1/y6bR72DHxEq5lje46tAnFlz8im1/tW/6poF",7805:"sha384-JX9xoy39V5HXC2jp1mc6wv2aUnni5uCmSUX1YW5K0+jCohW6nBZ2z22as6HzNeZ5",7986:"sha384-O6xBy9Gp/Dt0BydUR1W9F8+JIlqaIleIzwpeOLJrwBWeig/iobo9NZXigFQHIGSV",8102:"sha384-ggsg/idEvhegx0lXDzYwvvAJMlTUqKNr4tFBV+1ukTpdjQKjyRM/t/JiKyjx6Imw",8217:"sha384-mprAq7iizmv4bC74jqkR+42wNAja83SyZixuCXjHTDz+0jjuDLkmsHZmUdd23puV",8225:"sha384-ya7K7g7pIbCgcjSxLA+FOzc22mWfDbXafJRmzNKeBjAsile/ocBG0L0FWrQJfI3g",8253:"sha384-fogANTUdq79m5FtzmWGE3QylRZpZ+B2HzvTdy/wDLuSWX6K4EAtFq328blmZveeq",8294:"sha384-Ynup7uXCGgFWy36hFBbD60ArtuTqyZ/qaS9+NzgrEe3mnUrTtWSuoKmmwO5RtR7I",8342:"sha384-5cSRatX2EiNqlNiTgApcAewlCjAV0NIqTbacdhT6r5FjUFbmenXHmSxUzVWq0Coe",8361:"sha384-+AcBxJzSrpxcqqLpU7st5n/gqGViA2/X98wH9JmQYP9G/wW0ucP3i/6pXZtlCTfz",8438:"sha384-Z4qT4hMNKkObzLXqtNf8W/e2NBLxku8ynDqGLEI1ocW/TjudP0YKBShCp/cxpesj",8507:"sha384-3bxyyutB7DmVfznIA/2erllnPVf4J8Q0KTXKJXl48j8+glmB/s65R2x/wj9ouMhC",8530:"sha384-3gwsr/vYJMlMc9B5C6CbnYs423WprRmVbVqzEVg+z5FbukeBxKzccptEYg9H8D2e",8660:"sha384-aY2pBw1DhqCi+nW9aSTLMFWZOCI59/raxs1u0CHUA2+Y7/CQb4FiF2ywNXmTFOFW",8692:"sha384-50tyC1o9j5mheCVK39YoRrohcHEHx2ckPxZ5YMwhVC2cz+6Dvg4K3Rk087jdPNQc",8793:"sha384-pgCDeWpiUdXQW5L9srxjv7pz0SXdpMLm7asyX1aO0MI2CZLC00xQKRhSbbOVJyiY",8904:"sha384-XAeGQ3n113BiJLqVSCHsU8s00cdFCm2pEJls9BOV4Sl5CcMYtQ3yfuAns+85S+oE",9054:"sha384-HEUb+Y4EZab8JY88WcgE+uf6Z50Ik5ttJJ89jiFGV28E1vL55xpwAEX8KHqU4KjK",9173:"sha384-QKp39RjM51kEJiQrPczbBzTHbiRvi8w1Q2vcgC4m5zFqEqKGDRQncg2M7k6mzjFq",9264:"sha384-HZh8doWPeDvoahT7ESilejLEqPQ9GeiupkLA0hdmFghlNN3YmSKPXiGBxCNKDB+1",9275:"sha384-0WqIYX7kofzdZz65mtgk/jBhwiHJx/8XVQXpZyD7F2jrHhmziy5l/LrS8+7L/V/V",9355:"sha384-HOa3k+prwS9oODIforoUinZgRZNGCX1OgF09WHGQ0Nd36Je3LR+0FRzM6rIx+oY6",9545:"sha384-V4GNWh9Meu94G7OGu7GNu5SdetB2t+hntzHLezzl7jns4qZ3iZXKspCBp2hRZqn3",9660:"sha384-DuU4GTc4fDwcYWCG64FtYh31sIeYb4Toy29PSF+QY66UdlSDEuIJvD0FelucPFzJ",9729:"sha384-vU+837Ecq9pCTqTQmik9CXTT9w6FWnR1e4HUbDn6OlhTNtO7koKyLhXcl9YWijb7",9743:"sha384-ppf9z/DUa7o3Cze1DpM7vxcbiqfNEh29ZFnHgHchMTW5dcsOCwfWPVloNIsR7XhU",9754:"sha384-8SsnWHyFPk9cgJE7vyScRM9dnL7/UGOLheTOnzrXmSiPUwsSm8DsBMEErVfGrrcv",9779:"sha384-tdAzkkRHlHHIJ+cg3WKELQVWQU9/KXCcVVZNfqsSOGWvy+7BTYAmauVdyL8rOQmc",9894:"sha384-/vP3HEdgcHjD7saE2UYcZlT/WgcwxHR7gOh68OG3TAvGQ+ts6VQu3HEWsFSGun6r"},function(){if(void 0!==s){var t=s.u,e=s.e,n={},i={};s.u=function(e){return t(e)+(n.hasOwnProperty(e)?"?"+n[e]:"")},s.e=function(o){return e(o).catch((function(e){var r=i.hasOwnProperty(o)?i[o]:5;if(r<1){var a=t(o);throw e.message="Loading chunk "+o+" failed after 5 retries.\n("+a+")",e.request=a,e}return new Promise((function(t){var e=5-r+1;setTimeout((function(){var a="cache-bust=true&retry-attempt="+e;n[o]=a,i[o]=r-1,t(s.e(o))}),0)}))}))}}}(),function(){var t={9520:0};s.f.j=function(e,n){var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise((function(n,o){i=t[e]=[n,o]}));n.push(i[2]=o);var r=s.p+s.u(e),a=new Error;s.l(r,(function(n){if(s.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,i[1](a)}}),"chunk-"+e,e)}};var e=function(e,n){var i,o,r=n[0],a=n[1],c=n[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);c&&c(s)}for(e&&e(n);u<r.length;u++)o=r[u],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}(),s.nc=void 0;var a={};!function(){"use strict";s.r(a),s.d(a,{DocRebootSupportMode:function(){return Af},ExpectedFailureReason:function(){return m.I$},FeatureGateConstants:function(){return A.Fh},FileType:function(){return T.T},Health:function(){return Ef.S9},HealthLogger:function(){return b.zP},KpiType:function(){return k.o},LogCategory:function(){return f.W},QosErrorName:function(){return m.DG},TraceLevel:function(){return p.G},UlsLogger:function(){return b.G2},WacErrorName:function(){return m.AU},bootDiagnostics:function(){return m.c},bootDocument:function(){return rf},bootDocumentWithCustomFunctions:function(){return sf},createNewGuid:function(){return w.n},forceEndSession:function(){return Zd},getClientUrlForOpenInMobileApp:function(){return nf},getDefaultResourceString:function(){return Qd},getDocumentInfoFromWindow:function(){return Nf},getExpectedFailureReason:function(){return _e},getFeatureGateConfigByName:function(){return A.vJ},getFeatureGatesFromString:function(){return A.i0},getFetchAccessToken:function(){return af},getFetchItemFromNetwork:function(){return cf},getFileTypeFromExtension:function(){return Pf},getFileTypeFromPath:function(){return Hf},getHootEndpoint:function(){return g.XQ},getOwlVersion:function(){return Jd},getPrebootSessionId:function(){return xt},getShareEndpoint:function(){return g.PO},getWebUrlForCopyLinkToPage:function(){return of},getWiseEnvironmentFromTeamsRing:function(){return Ot},initPackage:function(){return $d},isExpectedError:function(){return ye},isMobilePhone:function(){return bf},isNetworkError:function(){return we},localStorage:function(){return Ct},logFeatureGateUsage:function(){return A.dt},notifyHostAccessibilityLoopComplete:function(){return tf},notifyHostBackButtonPressed:function(){return ef},prebootApplication:function(){return Dt},prebootDocument:function(){return Ft},removePrebootSessionId:function(){return qt},setWacDataCenterValueToCache:function(){return Fh},unifiedUiHostConfigs:function(){return Oh.J}});var t,e,n=s(9891);!function(t){t.Ei="App_AccessibilityLoopComplete",t.Ni="Wac_ActionComplete",t.Hi="WacInitialize_Ready",t.Oi="Wac_AppFailed",t.Ui="Wac_AppBootState",t.Mi="Wac_AppCompleted",t.Di="BrowserEvent",t.Fi="UI_Close",t.xi="App_CloseTab",t.qi="UI_Conversation",t.Bi="UI_CopyAndEdit",t.Li="App_CreateNewDocument",t.Wi="Wac_AppDataSavedStatus",t.ji="UI_Download",t.Gi="UI_Edit",t.Ki="Error",t.zi="UI_FileEmbed",t.$i="UI_FileProperties",t.Ji="File_Rename",t.Qi="File_RenameFailed",t.Xi="UI_FileVersions",t.Yi="StateChanged",t.Zi="App_IsFrameTrusted",t.eo="GetAccessToken",t.no="App_GetAuthToken",t.io="App_GetCustomAuthConfig",t.oo="App_GetHostKeyValue",t.ro="App_WopiInfoFromUrl",t.so="App_DavUrlFromIds",t.ao="App_LoadingStatus",t.co="App_SwitchMode",t.uo="App_MoveToFolder",t.lo="UI_OpenInMobileApp",t.ho="UI_OpenInBrowser",t.do="UI_OpenInClient",t.fo="PageChanged",t.po="App_PushCommentContext",t.vo="App_PushState",t.mo="App_DocReboot",t.wo="UI_RedeemForCommenting",t._o="App_RefreshSessionInfo",t.Co="UI_ReplyWithChanges",t.So="UI_ReportAbuse",t.ko="App_FilePicker",t.bo="UI_SaveStatus",t.Io="WopiSession_Complete_Ack",t.Ro="SetOverlayContent",t.Eo="UI_Sharing",t.No="UI_ShareForm",t.Po="UI_SignIn",t.Ho="App_StoreHostKeyValue",t.Oo="App_Unloaded",t.Uo="App_UlsLog",t.Do="Wac_UnloadingApp",t.xo="App_UpdateBootComplete",t.qo="PageCount",t.Bo="UI_CheckUserAccessAndGrantPermissions",t.Lo="User_Activity",t.Wo="Edit_Notification",t.jo="UI_Workflow",t.Go="ZoomChanged",t.zo="CAAEMessage",t.$o="Excel_HostFrameCacheSave",t.Vo="Excel_HostFrameCacheEvict",t.Jo="Excel_RegenerateFileBundle",t.Qo="App_SwitchToWacFrame",t.Xo="App_SaveSSRData",t.Zo="App_PurgeDataInHostCache",t.tr="App_SaveHostRenderingV2Data",t.nr="App_SaveHostUtilsData",t.ir="AcquireOAuthTokenTeams",t.rr="App_SwitchNotebook",t.sr="FailedBoot_CheckFileInfo",t.ar="GetTeamsUsers",t.cr="SendTeamsUserMention",t.ur="NavigateBackToHost",t.lr="App_GetClientUrlComplete",t.hr="App_GetWebUrlComplete",t.dr="App_CopyLinkComplete",t.pr="App_SendConversationId",t.vr="CloseTeamsConversation",t.mr="PageLoaded",t.gr="Visio_BRS",t.wr="Visio_SendLicenseInfo",t.yr="Visio_Consumption_CLTComplete",t._r="Visio_SwitchMode_FromViewFrame",t.Cr="Visio_ModeSwitch_ToHost_Ack",t.Sr="Visio_UpdateEditUrl",t.kr="Visio_PageViewLoaded",t.Tr="Visio_ActiveAppFrameLoadFailed",t.Ar="Visio_DisposeBkgFrame",t.Ir="Visio_ReadyToReceiveDocData",t.Rr="Visio_DocReboot_HostNav",t.Er="Visio_SwitchToVisioFrame",t.Nr="WacAppPerfMetric",t.Pr="App_ModifyURLState"}(t||(t={})),function(t){t.Hr="Ack",t.Or="WacInitialize_Ready_Ack",t.Ur="Wac_BeforeUnloadApp",t.Mr="Blur_Focus",t.Dr="Wac_AppFailed_Ack",t.Fr="Wac_AppCompleted_Ack",t.qr="WopiStartSession_Complete",t.Br="WopiPendingSession_Complete",t.Lr="Host_AccessibilityLoopComplete",t.Zi="Host_IsFrameTrusted",t.Wr="Grab_Focus",t.jr="HostCacheDiagnostic",t.Gr="Host_KeyValue",t.Kr="JsApiDiagnostics",t.uo="Host_MoveToFolder",t.zr="PageChanged_Ack",t.$r="App_PopState",t.Vr="Host_SendChannelId",t.Jr="Host_SendConversationId",t.Qr="GetTeamsUsers_Reply",t.Xr="SendTeamsUserMention_Reply",t.Yr="Host_BackButtonPressed",t.Zr="Host_GetClientUrl",t.es="Host_GetWebUrl",t.rs="OwlFrameDiagnostics",t.ss="File_Rename",t.ko="Host_FilePicker",t.cs="PostAccessToken",t.us="Host_SetAuthToken",t.ls="Host_SetCustomAuthConfig",t.hs="App_PushCommentContext",t.ds="CanEmbed",t.fs="Host_RefreshSessionInfo",t.ps="CheckUserAccessAndGrantPermissions_Result",t.vs="Host_WopiInfoFromUrl",t.gs="Host_DavUrlFromIds",t.ws="SetCurrentPage",t.ys="SetZoomLevel",t._s="WopiPendingSession_Fail",t.Cs="SetOverlayContent",t.Ss="WopiPendingApplicationComplete_Received",t.ks="Host_SwitchMode",t.Ts="Host_Unload",t.bs="PageCount_Ack",t.Rs="ZoomChanged_Ack",t.Es="Host_ShareUI",t.Ns="Host_Telemetry",t.Ps="Visio_ConsumptionCLTComplete_Ack",t.Hs="Visio_SwitchMode_FromHF_Ack",t.Os="Visio_SwitchMode_FromHostFrame",t.Us="Visio_FallbackToLegacySwitch",t.Ms="Visio_DocumentData"}(e||(e={}));var i,o,r,c,u,l,h=function(){function i(i,o,r,s){void 0===s&&(s=!1),this.Ds=new Map,this.Fs=i,this.xs=o,this.qs=new Set(this.enumValues(t)),this.Ls=new Set(this.enumValues(e)),this.Ws=s,this.Gs="",r?"string"==typeof r?this.zs=new Set([o,r]):Array.isArray(r)?this.zs=new Set((0,n.ev)([o],r,!0)):"function"==typeof r?(this.zs=new Set([this.xs]),this.$s=r):("string"==typeof r.validOrigins?this.zs=new Set([o,r.validOrigins]):this.zs=new Set((0,n.ev)([o],r.validOrigins,!0)),this.$s=r.validateOrigin):this.zs=new Set([o]),this.Vs=this.receiveMessage.bind(this),window.addEventListener("message",this.Vs)}return i.prototype.registerHandler=function(t,e){var n=this.Ds.get(t);n?n.push(e):this.Ds.set(t,[e])},i.prototype.sendMessage=function(t,e){var i,o,r=null!==(i=null==e?void 0:e.window)&&void 0!==i?i:this.Fs,s=null!==(o=null==e?void 0:e.origin)&&void 0!==o?o:this.xs;if(this.validateOrigin(s)){var a=void 0;try{a=crypto.randomUUID()}catch(t){a=crypto.getRandomValues(new Uint8Array(16)).join("")}var c=(0,n.pi)((0,n.pi)({},t),{correlationId:a,sendTime:Date.now()});return r.postMessage(JSON.stringify(c),s),a}return!1},i.prototype.dispose=function(){window.removeEventListener("message",this.Vs)},i.prototype.receiveMessage=function(t){if(t.data&&"string"==typeof t.data&&this.validateOrigin(t.origin))try{var e=JSON.parse(t.data);if("MessageId"in e&&"SendTime"in e&&"CorrelationId"in e&&"Values"in e)this.Ws&&this.handleCrossDocumentMessage(t.data,e,t.origin);else if(e.id){var n=this.Ds.get(e.id);null==n||n.forEach((function(t){return t(e)}))}}catch(t){}},i.prototype.validateOrigin=function(t){var e,n=!1;return this.zs.has(t)?n=!0:(null===(e=this.$s)||void 0===e?void 0:e.call(this,t))&&(this.zs.add(t),n=!0),n},i.prototype.handleCrossDocumentMessage=function(t,e,n){if(e.MessageId){if(n===this.xs&&this.Ls.has(e.MessageId))return window.parent.postMessage(t,this.Gs),!0;if(n.endsWith("officeapps.live.com")&&this.qs.has(e.MessageId))return this.Gs||(this.Gs=n),this.Fs.postMessage(t,this.xs),!0}return!1},i.prototype.enumValues=function(t){return Object.keys(t).map((function(e){return t[e]}))},i}(),d=s(7937),f=s(7804),p=s(6322),v=s(5623),m=s(4883),g=s(501),w=s(9243);!function(t){t[t.external=0]="external",t[t.msa=1]="msa",t[t.aad=2]="aad"}(i||(i={})),function(t){t.init="SharedAuth_Init",t.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",t.tryGetToken="SharedAuth_TryGetToken",t.tryLogin="SharedAuth_TryLogin"}(o||(o={})),function(t){t.closeDialog="SharedAuth_CloseDialog",t.getTokenResponse="SharedAuth_GetTokenResponse",t.hideDialog="SharedAuth_HideDialog",t.interactiveFlowReady="SharedAuth_InteractiveFlowReady",t.loginResponse="SharedAuth_LoginResponse",t.scriptInitialized="SharedAuth_ScriptInitialized",t.scriptLoaded="SharedAuth_ScriptLoaded"}(r||(r={})),function(t){t.registerPrimary="SharedAuthWorker_RegisterPrimary",t.unregisterPrimary="SharedAuthWorker_UnregisterPrimary",t.getToken="SharedAuthWorker_GetToken",t.postToken="SharedAuthWorker_PostToken"}(c||(c={})),function(t){t.registrationResponse="SharedAuthWorker_RegistrationResponse",t.brokerToken="SharedAuthWorker_BrokerToken",t.tokenReady="SharedAuthWorker_TokenReady",t.noPrimaryReady="SharedAuthWorker_NoPrimaryReady"}(u||(u={})),function(t){t.timeout="Timeout",t.general="Token Renewal Failed",t.renewal="token_renewal_error"}(l||(l={}));var y=new URL(window.location.href),_=function(){function t(){var t=this;this.startTime=0,this.Js=function(){},this.Qs=function(){},this.promise=new Promise((function(e,n){t.Js=e,t.Qs=n}))}return t.prototype.resolve=function(t){this.Js(t)},t.prototype.reject=function(t){this.Qs(t)},t}();!function(){function t(t,e){var i=this;this.Xs=0,this.Ys=0,this.initAuthLibrary=function(t){return(0,n.mG)(i,void 0,void 0,(function(){var e,i;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:e=this.storePromiseWrapper("initAuthLibrary"),n.label=1;case 1:return n.trys.push([1,3,,4]),this.Zs=t,[4,this.ta];case 2:return n.sent(),this.ea.contentWindow&&this.ea.contentWindow.postMessage(JSON.stringify({MessageId:o.init,Values:{upn:this.Zs.upn,authority:this.Zs.authority,interactive:this.Zs.interactive,authorityType:this.Zs.authorityType,appIds:this.Zs.appIds,enableConsoleLogging:this.Zs.enableConsoleLogging,enablePopupFlash:this.Zs.enablePopupFlash,skipUpnCheck:this.Zs.skipUpnCheck,correlationId:this.na.getUserSessionId()}}),"*"),[3,4];case 3:throw i=n.sent(),this.na.ULS.sendTraceTag(508929187,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] Error when initializing authLibrary: ".concat(i)),i;case 4:return[2,e]}}))}))},this.tryGetToken=function(t){return(0,n.mG)(i,void 0,void 0,(function(){var e;return(0,n.Jh)(this,(function(n){e=this.storePromiseWrapper("tryGetToken");try{this.ia=t,this.ea.contentWindow&&this.ea.contentWindow.postMessage(JSON.stringify({MessageId:o.tryGetToken,Values:{appId:this.ia.appId,target:this.ia.target,claims:this.ia.claims,withPopup:this.ia.withPopup,messageCorrelationId:this.ia.messageCorrelationId}}),"*")}catch(t){this.na.ULS.sendTraceTag(508929186,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] Error when trying to get token")}return[2,e]}))}))},this.receiveMessage=function(t){return(0,n.mG)(i,void 0,void 0,(function(){var e,i,o,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(t.origin!==this.oa)return[2];e=JSON.parse(t.data),n.label=1;case 1:switch(n.trys.push([1,9,,10]),e.MessageId){case r.scriptLoaded:return[3,2];case r.scriptInitialized:return[3,3];case r.getTokenResponse:return[3,5]}return[3,7];case 2:return i=e.Values,o=performance.now()-this.ra,this.sa.scriptLoaded.resolve(),this.na.ULS.sendTraceTag(508934364,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] WacOAuth.aspx loaded in ".concat(o," [success: ").concat(i.Success,"] [authLibrary: ").concat(i.AuthLibrary,"]")),[3,8];case 3:return[4,this.libraryInit(e.Values)];case 4:return n.sent(),this.na.ULS.sendTraceTag(508859403,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] Script initialized"),[3,8];case 5:return[4,this.handleTokenResponse(e.Values)];case 6:return n.sent(),this.na.ULS.sendTraceTag(508859402,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] getToken response received"),[3,8];case 7:this.na.ULS.sendTraceTag(508934362,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] Unsupported Message ID, ".concat(e.MessageId)),n.label=8;case 8:return[3,10];case 9:return s=n.sent(),this.na.ULS.sendTraceTag(508934361,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] Caught error trying to process PostMessage, ".concat(e.MessageId,": ").concat((a=s)instanceof Error?"".concat(a.name,": ").concat(a.message):"string"==typeof a?a:JSON.stringify(a))),[3,10];case 10:return[2]}var a}))}))},this.na=null!=e?e:this.createLogger(t),this.sa={},this.ta=this.storePromiseWrapper("scriptLoaded");var s="".concat(this.getAuthUrlForEnvironment(t),"?replyUrl=&webworker=1&standalone=1&usid=").concat(this.na.getUserSessionId());if(this.ea=document.createElement("iframe"),this.oa=new URL(s).origin,this.ea.src=s,this.ea.style.cssText="height:0; width:0; display:none;",window.addEventListener("message",this.receiveMessage),this.ra=performance.now(),document.body.appendChild(this.ea),!this.ea.contentWindow)throw this.na.ULS.sendTraceTag(508934363,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] The shared auth iframe has no contentWindow"),new Error("iframe has no contentWindow")}t.prototype.createLogger=function(t){var e,n={remoteUlsEndpoint:this.getLogUrlForEnvironment(t),sessionId:null!==(e=y.searchParams.get("usid"))&&void 0!==e?e:void 0};return(0,d.L8)(n)},t.prototype.libraryInit=function(t){return(0,n.mG)(this,void 0,void 0,(function(){var e;return(0,n.Jh)(this,(function(n){return e=this.sa.initAuthLibrary,t.isSuccess?(e.resolve(!0),this.Xs=performance.now()-e.startTime,this.na.ULS.sendTraceTag(508569551,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] Auth library init succeeded, ".concat(this.Xs)),[2,t.response]):(e.reject(!1),this.na.ULS.sendTraceTag(508934360,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] Auth library init failed"),[2])}))}))},t.prototype.handleTokenResponse=function(t){return(0,n.mG)(this,void 0,void 0,(function(){var e;return(0,n.Jh)(this,(function(n){if(e=this.sa.tryGetToken,t.isSuccess){if(e.resolve(!0),this.Ys=performance.now()-e.startTime,this.na.ULS.sendTraceTag(508569550,f.W.Kn,p.G.Info,"[AUTH-BOOTSTRAPPER] Get token time, ".concat(this.Ys)),i=window.location.href,new Array("https://www.office.com").includes(i))return[2,t.response];this.na.ULS.sendTraceTag(508934359,f.W.Kn,p.G.Warning,"[AUTH-BOOTSTRAPPER] Untrusted frame, cannot send token back")}else e.reject(!1),this.na.ULS.sendTraceTag(508934358,f.W.Kn,p.G.Error,"[AUTH-BOOTSTRAPPER] Get token failed");var i;return[2]}))}))},t.prototype.storePromiseWrapper=function(t){var e=new _;return e.startTime=performance.now(),this.sa[t]=e,e.promise},t.prototype.getAuthUrlForEnvironment=function(t){switch(t){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/WacOAuth.aspx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/WacOAuth.aspx";case"PRODUCTION":return"https://oauth.online.office.com/oa/WacOAuth.aspx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/WacOAuth.aspx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/WacOauth.aspx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/WacOauth.aspx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/WacOAuth.aspx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/WacOAuth.aspx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/WacOAuth.aspx"}},t.prototype.getLogUrlForEnvironment=function(t){switch(t){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/RemoteUls.ashx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/RemoteUls.ashx";case"PRODUCTION":return"https://oauth.online.office.com/oa/RemoteUls.ashx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/RemoteUls.ashx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/RemoteUls.ashx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/RemoteUls.ashx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/RemoteUls.ashx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/RemoteUls.ashx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/RemoteUls.ashx"}}}();var C,S,k=s(960),T=s(6640),b=s(3727),A=s(8001),I=s(8562),R=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),E="/suite/WebLoader.aspx",N="",P=function(){function t(){}return Object.defineProperty(t,"isOwlFrame",{get:function(){return"boolean"==typeof t.ca?t.ca:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&location.pathname===E},enumerable:!1,configurable:!0}),t.isOwlFrameExperimentEnabled=function(e,n){return"boolean"==typeof t.la?t.la:e?(t.la=!t.isOwlFrame&&(0,A.vJ)(A.Fh.FeatureGate_EnableOwlFrameExperiment,e),(0,A.dt)(A.Fh.FeatureGate_EnableOwlFrameExperiment,t.la,n),t.la):(t.la=!1,t.la)},t.isOwlFrameBootEnabled=function(e,n){return void 0!==t.ha?t.ha:e?(t.ha=!t.isOwlFrame&&(0,A.vJ)(A.Fh.FeatureGate_EnableOwlFrameBootTreatment,e),(0,A.dt)(A.Fh.FeatureGate_EnableOwlFrameBootTreatment,t.ha,n),t.ha):(t.ha=!1,t.ha)},t.showOwlFrame=function(e,n){return t.isOwlFrameExperimentEnabled(e,n)&&t.isOwlFrameBootEnabled(e,n)},t.checkOwlFrameCookie=function(t,e){if(e&&"FASTFOOD"===t){var n=document.cookie.match(R);if(n){var i=n[2];"0"===i?(e.delete(A.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(A.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(A.Fh.FeatureGate_EnableOwlFrameBoot),e.delete(A.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"1"===i?(e.delete(A.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(A.Fh.FeatureGate_EnableOwlFrameBoot),e.delete(A.Fh.FeatureGate_EnableOwlFrameBootTreatment),e.set(A.Fh.FeatureGate_EnableOwlFrameExperiment,!0)):"2"===i?(e.delete(A.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(A.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(A.Fh.FeatureGate_EnableOwlFrameBoot),e.set(A.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0)):"3"===i&&(e.delete(A.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(A.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(A.Fh.FeatureGate_EnableOwlFrameBoot),e.set(A.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0),e.set(A.Fh.FeatureGate_EcsHootGate,!0),N="https://login.microsoftonline.com/")}}},t}();function H(t,e,n,i,o,r){return"Frame Experiment Status: ".concat(P.isOwlFrameExperimentEnabled(n,r)?"TREATMENT":"CONTROL",", Boot Experiment Status: ").concat(P.isOwlFrameBootEnabled(n,r)?"TREATMENT":"CONTROL",", FileType: ").concat(t,", Environment: ").concat(e,", Feature Gates: ").concat(n?(0,I.d)(n):"{}",", UiHost: ").concat(i,", Integration Type: ").concat(o)}!function(t){t.OwlBootAppMessageSend="owlBootAppMessageSend",t.OwlBootAppMessageReceive="owlBootAppMessageReceive",t.OwlLoadedMessageSend="owlLoadedMessageSend",t.OwlLoadedMessageReceive="owlLoadedMessageReceive",t.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",t.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",t.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",t.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",t.OwlStart="owlStart",t.OwlEnd="owlEnd",t.OwlHostTimeOrigin="owlHostTimeOrigin",t.OwlFrameTimeOrigin="owlFrameTimeOrigin",t.OwlWacBootStart="owlWacBootStart",t.OwlOnBootComplete="owlOnBootComplete",t.OwlCreateFrameStart="owlCreateFrameStart",t.OwlCreateFrameEnd="owlCreateFrameEnd",t.OwlTokenFetchingExperimentMessageSend="owlTokenFetchingExperimentMessageSend",t.OwlTokenFetchingExperimentMessageReceived="owlTokenFetchingExperimentMessageReceived",t.OwlMsalInitStart="owlMsalInitStart",t.OwlMsalInitEnd="owlMsalInitEnd",t.OwlMsalSsoSilentStart="owlMsalSsoSilentStart",t.OwlMsalSsoSilentEnd="owlMsalSsoSilentEnd",t.OwlMsalLoginPopupStart="owlMsalLoginPopupStart",t.OwlMsalLoginPopupEnd="owlMsalLoginPopupEnd",t.OwlGetDriveItemWithMsalStart="owlGetDriveItemWithMsalStart",t.OwlGetDriveItemWithMsalEnd="owlGetDriveItemWithMsalEnd",t.OwlTryGetWacTokenStart="owlTryGetWacTokenStart",t.OwlTryGetWacTokenEnd="owlTryGetWacTokenEnd",t.OwlTryGetWacTokenPopupStart="owlTryGetWacTokenPopupStart",t.OwlTryGetWacTokenPopupEnd="owlTryGetWacTokenPopupEnd",t.OwlTryGetWacTokenFromCacheEnd="owlTryGetWacTokenFromCacheEnd",t.OwlGetDriveItemStart="owlGetDriveItemStart",t.OwlGetDriveItemEnd="owlGetDriveItemEnd",t.OwlAddFrameToDOM="owlAddFrameToDOM",t.OwlFrameScriptExecutionStart="owlFrameScriptExecutionStart",t.OwlGetAccountByUsernameStart="owlGetAccountByUsernameStart",t.OwlGetAccountByUsernameEnd="owlGetAccountByUsernameEnd",t.OwlTryGetWacTokenWithClaimsFromCacheEnd="owlTryGetWacTokenWithClaimsFromCacheEnd",t.OwlTryGetWacTokenWithClaimsEnd="owlTryGetWacTokenWithClaimsEnd",t.OwlMsalGetAccessTokenStart="owlMsalGetAccessTokenStart",t.OwlMsalGetAccessTokenEnd="owlMsalGetAccessTokenEnd"}(C||(C={})),function(t){t.OwlCreateFrame="OwlCreateFrame",t.OwlTokenFetchingExperimentMessage="OwlTokenFetchingExperimentMessage",t.OwlMsalInit="OwlMsalInit",t.OwlMsalSsoSilent="OwlMsalSsoSilent",t.OwlGetDriveItemWithMsal="OwlGetDriveItemWithMsal",t.OwlTryGetWacToken="OwlTryGetWacToken",t.OwlTryGetWacTokenFromCache="OwlTryGetWacTokenFromCache",t.OwlGetDriveItem="OwlGetDriveItem",t.OwlGetAccountByUsername="OwlGetAccountByUsername",t.OwlTryGetWacTokenWithClaims="OwlTryGetWacTokenWithClaims",t.OwlTryGetWacTokenWithClaimsFromCache="OwlTryGetWacTokenWithClaimsFromCache",t.OwlMsalGetAccessToken="OwlMsalGetAccessToken"}(S||(S={}));var O,U,M=[{measureName:S.OwlCreateFrame,measureStart:C.OwlCreateFrameStart,measureEnd:C.OwlCreateFrameEnd}],D=[{measureName:S.OwlTokenFetchingExperimentMessage,measureStart:C.OwlTokenFetchingExperimentMessageSend,measureEnd:C.OwlTokenFetchingExperimentMessageReceived},{measureName:S.OwlMsalInit,measureStart:C.OwlMsalInitStart,measureEnd:C.OwlMsalInitEnd},{measureName:S.OwlMsalSsoSilent,measureStart:C.OwlMsalSsoSilentStart,measureEnd:C.OwlMsalSsoSilentEnd},{measureName:S.OwlGetDriveItemWithMsal,measureStart:C.OwlGetDriveItemWithMsalStart,measureEnd:C.OwlGetDriveItemWithMsalEnd},{measureName:S.OwlTryGetWacToken,measureStart:C.OwlTryGetWacTokenStart,measureEnd:C.OwlTryGetWacTokenEnd},{measureName:S.OwlGetDriveItem,measureStart:C.OwlGetDriveItemStart,measureEnd:C.OwlGetDriveItemEnd},{measureName:S.OwlTryGetWacTokenFromCache,measureStart:C.OwlTryGetWacTokenStart,measureEnd:C.OwlTryGetWacTokenFromCacheEnd},{measureName:S.OwlGetAccountByUsername,measureStart:C.OwlGetAccountByUsernameStart,measureEnd:C.OwlGetAccountByUsernameEnd},{measureName:S.OwlTryGetWacTokenWithClaims,measureStart:C.OwlTryGetWacTokenStart,measureEnd:C.OwlTryGetWacTokenWithClaimsEnd},{measureName:S.OwlTryGetWacTokenWithClaimsFromCache,measureStart:C.OwlTryGetWacTokenStart,measureEnd:C.OwlTryGetWacTokenWithClaimsFromCacheEnd},{measureName:S.OwlMsalGetAccessToken,measureStart:C.OwlMsalGetAccessTokenStart,measureEnd:C.OwlMsalGetAccessTokenEnd}];function F(){var t,e,i=P.isOwlFrame?D:M;try{for(var o=(0,n.XA)(i),r=o.next();!r.done;r=o.next()){var s=r.value;x(s.measureName,s.measureStart,s.measureEnd)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}function x(t,e,n){var i,o,r;(null===(i=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===i?void 0:i.call(performance,e).length)>0&&(null===(o=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===o?void 0:o.call(performance,n).length)>0&&(null===(r=performance.measure)||void 0===r||r.call(performance,t,e,n))}function q(t){var e,n,i,o,r,s,a,c;void 0===t&&(t="");var u=P.isOwlFrame?null===(i=null===(n=null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.getEntriesByName)||void 0===n?void 0:n.call(e,C.OwlFrameTimeOrigin)[0])||void 0===i?void 0:i.detail:null===(s=null===(r=null===(o=null===window||void 0===window?void 0:window.performance)||void 0===o?void 0:o.getEntriesByName)||void 0===r?void 0:r.call(o,C.OwlHostTimeOrigin)[0])||void 0===s?void 0:s.detail;return null===(c=null===(a=null===window||void 0===window?void 0:window.performance)||void 0===a?void 0:a.getEntriesByType)||void 0===c?void 0:c.call(a,"mark").filter((function(e){return e.name.startsWith(t)})).reduce((function(t,e){return e.name!==C.OwlFrameTimeOrigin&&e.name!==C.OwlHostTimeOrigin?t[e.name]=u+e.startTime:t[e.name]=u,t}),{})}function B(t){var e;try{e=JSON.stringify((0,b.pb)())}catch(t){e="[]"}var i=(0,n.pi)({},q("owl"));return t&&(t.owlVersion&&(i.version=t.owlVersion),t.wiseEnvironment&&(i.environment=t.wiseEnvironment),t.exposure&&(i.exposure=t.exposure)),{bootTelemetryData:e,owlTelemetryData:JSON.stringify(i)}}function L(){var t,e;window.performance&&!((null===(t=window.performance.getEntriesByName(C.OwlHostTimeOrigin))||void 0===t?void 0:t.length)>0||(null===(e=window.performance.getEntriesByName(C.OwlFrameTimeOrigin))||void 0===e?void 0:e.length)>0)&&window.performance.mark("".concat(P.isOwlFrame?C.OwlFrameTimeOrigin:C.OwlHostTimeOrigin),{startTime:0,detail:window.performance.timeOrigin})}function W(t){var e,i,o,r,s,a,c,u,l,h,d,f,p,v,m,g,w,y,_,C,S,k,T,A,I,R,E,N,P,H,O,U,M,D,F,x,q;return{documentIdentifier:t.documentIdentifier,sessionConfig:{hostCorrelationId:t.sessionConfig.hostCorrelationId,isMsa:t.sessionConfig.isMsa,tenantId:t.sessionConfig.tenantId,organizationName:t.sessionConfig.organizationName,sessionId:t.sessionConfig.sessionId,isESSEnabled:t.sessionConfig.isESSEnabled,experiments:t.sessionConfig.experiments,highContrastMode:t.sessionConfig.highContrastMode,additionalApplicationParameters:t.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=t.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(i=t.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(o=t.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isTestMode,isManifestCachingEnabled:null===(r=t.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(s=t.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isOwlBootstrapperEnabled,isPrebooted:null===(a=t.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(c=t.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.isVroom21,ringId:null===(u=t.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.ringId,teamsContextStartTime:null===(l=t.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(h=t.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.teamsContextEndTime,wopiDataStartTime:null===(d=t.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.wopiDataStartTime,wopiDataEndTime:null===(f=t.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataEndTime,bootStrapStartTime:null===(p=t.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapStartTime,bootStrapEndTime:null===(v=t.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.bootStrapEndTime,driveItemStartTime:null===(m=t.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(g=t.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemEndTime,driveItemFromWacStartTime:null===(w=t.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(y=t.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.driveItemFromWacEndTime,accessTokenStartTime:null===(_=t.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.accessTokenStartTime,accessTokenEndTime:null===(C=t.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.accessTokenEndTime,isCookieBlocked:null===(S=t.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.isCookieBlocked,meetingLiveDiagnostics:null===(k=t.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.meetingLiveDiagnostics,spRequestGuid:null===(T=t.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.spRequestGuid,createNewStartTime:null===(A=t.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.createNewStartTime,createNewEndTime:null===(I=t.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.createNewEndTime,loadManifestStartTime:null===(R=t.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadManifestStartTime,loadManifestEndTime:null===(E=t.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestEndTime,loadOwlStartTime:null===(N=t.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadOwlStartTime,loadOwlEndTime:null===(P=t.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadOwlEndTime,owlBootstrapperStartTime:null===(H=t.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(O=t.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperEndTime,isOdcMigrated:null===(U=t.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.isOdcMigrated,perfNavigationTiming:(null===(M=t.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.perfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:(null===(F=null===(D=t.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.legacyPerformanceData)||void 0===F?void 0:F.host)||(0,b.vb)()}},uiHostTabId:t.sessionConfig.uiHostTabId,upn:t.sessionConfig.upn,meeting:t.sessionConfig.meeting,customAuthConfigValue:t.sessionConfig.customAuthConfigValue,wiseEnvironment:t.sessionConfig.wiseEnvironment,isSynthetic:t.sessionConfig.isSynthetic,hostUrl:t.sessionConfig.hostUrl,owlVersion:t.sessionConfig.owlVersion,owlRollout:t.sessionConfig.owlRollout,fileType:t.sessionConfig.fileType,clickTime:t.sessionConfig.clickTime,uiCulture:t.sessionConfig.uiCulture,dataCulture:t.sessionConfig.dataCulture,puid:t.sessionConfig.puid,isNewFile:t.sessionConfig.isNewFile,wdValue:t.sessionConfig.wdValue,sessionOrigin:t.sessionConfig.sessionOrigin,intent:t.sessionConfig.intent,hostClientType:t.sessionConfig.hostClientType,isPopOut:t.sessionConfig.isPopOut,teamType:t.sessionConfig.teamType,initPackageParams:t.sessionConfig.initPackageParams&&(0,n.pi)((0,n.pi)({},t.sessionConfig.initPackageParams),{jsApiUrlInfos:(null===(x=t.sessionConfig.initPackageParams)||void 0===x?void 0:x.jsApiUrlInfos)&&ft(null===(q=t.sessionConfig.initPackageParams)||void 0===q?void 0:q.jsApiUrlInfos)}),origin:t.sessionConfig.origin},uiHostConfig:(0,n.pi)((0,n.pi)({},t.uiHostConfig),{featureGates:t.uiHostConfig.featureGates&&ft(t.uiHostConfig.featureGates)})}}function j(t){var e,i,o,r,s,a,c,u;return(0,n.mG)(this,void 0,void 0,(function(){var l,h,d,f,p,v,m;return(0,n.Jh)(this,(function(g){switch(g.label){case 0:return null===(o=null===(i=null===(e=t.sharingLinkTokenProvider)||void 0===e?void 0:e.TokenPromise)||void 0===i?void 0:i.then)||void 0===o||o.call(i,(function(t){l=t})).catch((function(t){h=t})).finally((function(){return null==df?void 0:df.sendMessage({id:U.SharingLinkTokenProvider,data:{token:l,error:h}})})),v={documentBootInfo:t.documentBootInfo},d=[(0,n.pi)({},t.sessionConfig)],m={},"string"!=typeof t.sessionConfig.customAuthConfigValue?[3,1]:(f=t.sessionConfig.customAuthConfigValue,[3,3]);case 1:return[4,t.sessionConfig.customAuthConfigValue];case 2:f=g.sent(),g.label=3;case 3:return m.customAuthConfigValue=f,"string"!=typeof t.sessionConfig.hostUrl?[3,4]:(p=t.sessionConfig.hostUrl,[3,6]);case 4:return[4,t.sessionConfig.hostUrl];case 5:p=g.sent(),g.label=6;case 6:return[2,(v.sessionConfig=n.pi.apply(void 0,d.concat([(m.hostUrl=p,m.bootDiagnostics=(0,n.pi)((0,n.pi)({},t.sessionConfig.bootDiagnostics),{perfNavigationTiming:(null===(r=t.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.perfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:(null===(s=t.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.legacyPerformanceData)||{host:(0,b.vb)()}}),m.logger=void 0,m.health=void 0,m)])),v.uiHostConfig=(0,n.pi)((0,n.pi)({},t.uiHostConfig),{featureGates:(null===(a=t.uiHostConfig)||void 0===a?void 0:a.featureGates)&&ft(t.uiHostConfig.featureGates)}),v.additionalApplicationParameters=t.additionalApplicationParameters,v.sharingLinkTokenProvider=!!t.sharingLinkTokenProvider,v.initPackageParams=t.initPackageParams&&(0,n.pi)((0,n.pi)({},t.initPackageParams),{jsApiUrlInfos:(null===(c=t.initPackageParams)||void 0===c?void 0:c.jsApiUrlInfos)&&ft(null===(u=t.initPackageParams)||void 0===u?void 0:u.jsApiUrlInfos)}),v)]}}))}))}function G(t,e){(0,v.l)(C.OwlOnBootComplete),null==ff||ff.sendMessage({id:O.BootComplete,data:{docInfo:t,wacBootDiagnostics:e}}),function(){var t=B(),e=t.bootTelemetryData,n=t.owlTelemetryData;null==ff||ff.sendMessage({id:O.TelemetryData,data:{bootTelemetryData:e,owlTelemetryData:n}})}()}function K(t,e){null==ff||ff.sendMessage({id:O.BootFailure,data:{errorInfo:t,docInfo:e}})}function z(t){null==ff||ff.sendMessage({id:O.ReturnFocus,data:{navigateForward:t}})}function $(){null==ff||ff.sendMessage({id:O.ConversationClose,data:{}})}function V(){null==ff||ff.sendMessage({id:O.NavigateBack,data:{}})}function J(t,e,n){null==ff||ff.sendMessage({id:O.OpenPageLevelConversation,data:{conversationId:t,pageUrl:e,hostSendConversationId:n}})}function Q(){null==ff||ff.sendMessage({id:O.DocumentClose,data:{}})}function X(){null==ff||ff.sendMessage({id:O.SuccessNotification,data:{}})}function Y(t,e){null==ff||ff.sendMessage({id:O.OpenInMobileApp,data:{openInAppUrl:t,storeUrl:e}})}function Z(t,e,i,o){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,pf.getMessagePromise(U.FetchItemFromNetworkResponse,{id:O.FetchItemFromNetwork,data:{docBootInfo:t,forceRefresh:e,zeroByte:i}})]}))}))}function tt(t,e,i,o,r,s,a){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,pf.getMessagePromise(U.FetchAccessTokenResponse,{id:O.FetchAccessToken,data:{tokenConsumer:t,forceFetch:e,resourceUrl:i,scope:o,isBoot:r,claims:s,silent:a}})]}))}))}function et(t,e){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,pf.getMessagePromise(U.OpenShareControlResponse,{id:O.OpenShareControl,data:{shareProps:t,isShareDialogueZoomEnabled:e}})]}))}))}function nt(t,e){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return[2,pf.getMessagePromise(U.CreateDocumentResponse,{id:O.CreateDocument,data:{createNewInfo:t,template:e}})]}))}))}function it(t){null==ff||ff.sendMessage({id:O.SetTitle,data:{title:t}})}function ot(){null==ff||ff.sendMessage({id:O.UserActivity,data:{}})}function rt(){var t=document.createElement("div");return t.id="owl-container",t}function st(t){null==ff||ff.sendMessage({id:O.UserActivity,data:t})}function at(t){null==ff||ff.sendMessage({id:O.UserAccess,data:t})}function ct(t){null==ff||ff.sendMessage({id:O.MoveToFolder,data:t})}function ut(t){null==ff||ff.sendMessage({id:O.SharedFilePicker,data:t})}function lt(t){null==ff||ff.sendMessage({id:O.Rename,data:{newName:t}})}function ht(t){null==ff||ff.sendMessage({id:O.FrameChange,data:t})}function dt(){null==ff||ff.sendMessage({id:O.FileEmbed,data:{}})}function ft(t){return JSON.stringify(Array.from(t.entries()))}function pt(t){if(t)try{return new Map(JSON.parse(t))}catch(t){return}}!function(t){t.FrameLoaded="Frame_FrameLoaded",t.GetAuthToken="Frame_GetAuthToken",t.BootComplete="Frame_BootComplete",t.SuccessNotification="Frame_OnSuccessNotification",t.BootFailure="Frame_BootFailure",t.ReturnFocus="Frame_ReturnFocus",t.ConversationClose="Frame_ConversationClose",t.NavigateBack="Frame_BackButtonPressed",t.OpenPageLevelConversation="Frame_OpenPageLevelConversation",t.DocumentClose="Frame_DocumentClose",t.OpenInMobileApp="Frame_OpenInMobileApp",t.FetchItemFromNetwork="Frame_FetchItemFromNetwork",t.FetchAccessToken="Frame_FetchAccessToken",t.OpenShareControl="Frame_OpenShareControl",t.CreateDocument="Frame_CreateDocument",t.SetTitle="Frame_SetTitle",t.UserActivity="Frame_UserActivity",t.CAAEMessage="Frame_CAAEMessage",t.UserAccess="Frame_UserAccess",t.MoveToFolder="Frame_MoveToFolder",t.SharedFilePicker="Frame_SharedFilePicker",t.Rename="Frame_Rename",t.FrameChange="Frame_FrameChange",t.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",t.FileEmbed="Frame_FileEmbed",t.EndSessionResponse="Frame_EndSessionResponse",t.EndSessionObservable="Frame_EndSessionObservable",t.TelemetryData="Frame_TelemetryData"}(O||(O={})),function(t){t.BootApplication="Host_BootApplication",t.BootApplicationWithCustomFunctions="Host_BootApplicationWithCustomFunctions",t.GetAuthTokenResponse="Host_GetAuthTokenResponse",t.EndSession="Host_EndSession",t.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",t.GetClientUrl="Host_GetClientUrl",t.GetWebUrl="Host_GetWebUrl",t.BackButtonPressed="Host_BackButtonPressed",t.SendConversationId="Host_SendConversationId",t.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",t.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",t.OpenShareControlResponse="Host_OpenShareControlResponse",t.CreateDocumentResponse="Host_CreateDocumentResponse",t.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",t.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",t.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",t.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",t.TelemetryData="Host_TelemetryData",t.TokenFetchingExperiment="Host_TokenFetchingExperiment"}(U||(U={}));var vt,mt=s(7218);function gt(t,e,n,i,o){var r=t.onBootComplete,s=t.onBootFailure,a=t.onSuccessNotification,c=t.onReturnFocus,u=t.onConversationClose,l=t.onNavigateBack,h=t.onOpenPageLevelConversation,d=t.onDocumentClose,f=t.onOpenInMobileApp,p=new mt.xQ;return null==df||df.registerHandler(O.EndSessionObservable,(function(t){p.next(t.data.rebootInfo),p.complete()})),null==df||df.registerHandler(O.BootComplete,(function(t){var e=t.data,n=e.docInfo,i=e.wacBootDiagnostics;null==r||r(n,i)})),null==df||df.registerHandler(O.BootFailure,(function(t){return null==s?void 0:s(t.data.errorInfo,t.data.docInfo)})),null==df||df.registerHandler(O.ReturnFocus,(function(t){return null==c?void 0:c(t.data.navigateForward)})),null==df||df.registerHandler(O.ConversationClose,(function(t){return null==u?void 0:u()})),null==df||df.registerHandler(O.NavigateBack,(function(t){return null==l?void 0:l()})),null==df||df.registerHandler(O.OpenPageLevelConversation,(function(t){return null==h?void 0:h(t.data.conversationId,t.data.pageUrl,t.data.hostSendConversationId)})),null==df||df.registerHandler(O.SuccessNotification,(function(t){return null==a?void 0:a()})),null==df||df.registerHandler(O.DocumentClose,(function(t){return null==d?void 0:d()})),null==df||df.registerHandler(O.OpenInMobileApp,(function(t){var e;return null==f?void 0:f(t.data.openInAppUrl,null!==(e=t.data.storeUrl)&&void 0!==e?e:"")})),null==df||df.registerHandler(O.EndSessionResponse,(function(t){vf.getHandler(O.EndSessionResponse,vt.Result)(t),Sf()})),null==df||df.registerHandler(O.TelemetryData,(function(t){!function(t,e,n,i,o){var r=B(),s=r.bootTelemetryData,a=r.owlTelemetryData;null==df||df.sendMessage({id:U.TelemetryData,data:{context:H(e,n,null==i?void 0:i.featureGates,null==i?void 0:i.uiHostName,null==i?void 0:i.uiHostIntegrationType,o),hostData:{bootTelemetryData:s,owlTelemetryData:a},frameData:t}})}(t.data,e.fileType,n,i,o)})),p.asObservable()}!function(t){t.Item="item",t.Response="response",t.Result="result",t.Token="token",t.URL="url"}(vt||(vt={}));var wt=s(7450),yt=s(2504),_t=s(2560),Ct=function(){var t=void 0;try{t=window.localStorage}catch(t){}return t}(),St="officecom";function kt(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function Tt(t){switch((0,_t.aE)(t)){case _t.o4.OneDrive:return"OneDrive";case _t.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function bt(t,e,i,o,r,s,a){void 0===o&&(o={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var c=window.performance.timing,u=window.performance.navigation,l=u.redirectCount||0,h=c.navigationStart||0,d=c.fetchStart||0,f=c.responseEnd||0,p=c.requestStart||0,v=c.responseStart||0,m=c.responseEnd||0,g=c.domComplete||0,w="UNKNOWN";switch(u.type){case 0:w="NAVIGATE";break;case 1:w="RELOAD";break;case 2:w="BACK_FORWARD";break;case 255:w="RESERVED"}return(0,n.pi)((0,n.pi)({},At(t,e,i,o,r,s,a)),{hostPageNavigationStartTime:h,hostPageFetchStartTime:d,hostPageFetchEndTime:f,hostPageRequestStartTime:p,hostPageResponseStartTime:v,hostPageResponseEndTime:m,hostPageDomCompleteTime:g,hostPageRedirectCount:l,hostPageNavigationType:w})}function At(t,e,i,o,r,s,a){void 0===o&&(o={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var c=r.startTime||0,u=r.endTime||0,l=(0,v.a)();(0,v.l)("officeInitializationTime");var h,d,g=null==s?void 0:s.logger,w=(null==s?void 0:s.bootDiagnostics)||{},y=w.tabsCacheHit,_=w.packageEntryTime,C=w.isTestMode,S=w.ringId;t&&(h=l-t),_&&(d=l-_);var k=(0,n.pi)((0,n.pi)((0,n.pi)({},w),m.c),{bootStrapStartTime:(null==r?void 0:r.startTime)||0,bootStrapEndTime:(null==r?void 0:r.endTime)||0,wopiDataStartTime:(null==o?void 0:o.startTime)||0,wopiDataEndTime:(null==o?void 0:o.endTime)||0,isCookieBlocked:!Ct,createNewEndTime:w.createNewStartTime?(0,v.a)():void 0,owlFeatureGates:a?(0,I.d)(a):void 0});return m.c.accessTokenStartTime=void 0,m.c.accessTokenEndTime=void 0,m.c.driveItemStartTime=void 0,m.c.driveItemEndTime=void 0,m.c.driveItemFromWacStartTime=void 0,m.c.driveItemFromWacEndTime=void 0,m.c.spRequestGuid=void 0,m.c.createNewStartTime=void 0,m.c.createNewEndTime=void 0,m.c.loadManifestStartTime=void 0,m.c.loadManifestEndTime=void 0,m.c.loadOwlStartTime=void 0,m.c.loadOwlEndTime=void 0,m.c.isVroom21=!1,null==g||g.ULS.sendTraceTag(556613895,f.W.Xn,p.G.Info,"getDiagnostics: [SessionOrigin: ".concat(i,"][TabsCacheHit: ").concat(y,"][IsTestMode: ").concat(C,"][RingId: ").concat(S,"][TimeElapsedSinceUserClick:").concat(h,"][TimeElapsedSincePackageEntry: ").concat(d,"]")),{entryPoint:i,hostPageFirstFlushTime:e,userClickTime:t,officeBootstrapperStartTime:c,officeBootstrapperEndTime:u,officeInitializationTime:l,unifiedUiHostDiagnostics:k}}function It(t,e){var n="UNKNOWN";switch(null==t?void 0:t.navigation.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}var i="UNKNOWN";switch(null==e?void 0:e.navigation.type){case 0:i="NAVIGATE";break;case 1:i="RELOAD";break;case 2:i="BACK_FORWARD";break;case 255:i="RESERVED"}return{hostPageNavigationStartTime:(null==t?void 0:t.timing.navigationStart)||0,hostPageFetchStartTime:(null==t?void 0:t.timing.fetchStart)||0,hostPageFetchEndTime:(null==t?void 0:t.timing.responseEnd)||0,hostPageRequestStartTime:(null==t?void 0:t.timing.responseEnd)||0,hostPageResponseStartTime:(null==t?void 0:t.timing.responseStart)||0,hostPageResponseEndTime:(null==t?void 0:t.timing.responseEnd)||0,hostPageDomCompleteTime:(null==t?void 0:t.timing.domComplete)||0,hostPageRedirectCount:(null==t?void 0:t.navigation.redirectCount)||0,hostPageNavigationType:n,owlFramePageNavigationStartTime:(null==e?void 0:e.timing.navigationStart)||0,owlFramePageFetchStartTime:(null==e?void 0:e.timing.fetchStart)||0,owlFramePageFetchEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageRequestStartTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageResponseStartTime:(null==e?void 0:e.timing.responseStart)||0,owlFramePageResponseEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageDomCompleteTime:(null==e?void 0:e.timing.domComplete)||0,owlFramePageRedirectCount:(null==e?void 0:e.navigation.redirectCount)||0,owlFramePageNavigationType:i}}var Rt=function(t){var e=new URL(t);return e.searchParams.delete("wopisrc"),e.href};function Et(t){return function(e){var n=e;switch(e){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":n="unifiedUiHostInTeams"}if((null==t?void 0:t.experiments)&&n in(null==t?void 0:t.experiments))return function(t){switch(t){case 0:return!1;case 1:return!0;default:return}}(null==t?void 0:t.experiments[n])}}function Nt(t,e,n){switch(t){case T.T.Word:case T.T.PowerPoint:case T.T.Excel:return!0;case T.T.OneNote:var i=(0,A.vJ)(A.Fh.FeatureGate_OneNoteJsApiV2Gate,e);return(0,A.dt)(A.Fh.FeatureGate_OneNoteJsApiV2Gate,i,n),i;case T.T.Visio:var o=(0,A.vJ)(A.Fh.FeatureGate_VisioJsApiV2Gate,e);return(0,A.dt)(A.Fh.FeatureGate_VisioJsApiV2Gate,o,n),o;default:return!1}}function Pt(t,e,n,i,o){var r,s,a=t?(null===(r=t.wac)||void 0===r?void 0:r.applicationUrl)||(null===(s=t.wac)||void 0===s?void 0:s.editUrl):Rt(e);return a?function(t,e,n,i,o,r){var s="".concat(t,"&uih=").concat(e);return(null==r||r)&&(s="".concat(s,"&uiEmbed=1")),i&&(s="".concat(s,"&wdTpl=").concat(i)),o&&(s="".concat(s,"&wdlcid=").concat(o)),n&&(s="".concat(s,"&actNavId=").concat(n)),s}(a,n,i.navId,i.templateId,i.rebootOverrideData?i.rebootOverrideData.lcid:i.uiCulture,o):""}function Ht(t){var e;return t?((e={}).wd=encodeURIComponent(t),e):{}}function Ot(t){switch(t){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}var Ut="PrebootDocument",Mt="owlfc";function Dt(t,e,n){var i=(0,v.a)(),o=(0,d.L8)(),r=(0,wt.q_)(t);if(r)if(Ct){var s=Ct.getItem(r);if(s)null==o||o.ULS.sendTraceTag(545036514,f.W.Xn,p.G.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+s);else{var a=(0,w.n)()[0];Ct.setItem(r,a);var c=new b.zP(a,t.fileType,n).health;null==c||c.updatePartADimensions({applicationLcid:t.uiCulture,loggableUserId:t.puid,sessionOrigin:t.wdOrigin}),null==c||c.addOrUpdatePartCDimension("IsNewFile",(!!t.isNewFile).toString());var u=new Map;u.set("StartTime",(new Date).toUTCString()),null==c||c.recordKpiUsage(Ut,k.o.FailureBased,Mt,u),u.delete("StartTime"),(0,yt.o)(t,e,o).then((function(t){null==o||o.ULS.sendTraceTag(558158863,f.W.Xn,p.G.Info,"prebootDocument: Attempting to preboot document with sessionid: "+a),function(t,e){var n;if(!t||!e)return!1;var i="access_token="+encodeURIComponent(e.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(e.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(null!==(n=e.bundleUrl)&&void 0!==n?n:"")+"&user_id="+encodeURIComponent(e.wac.userId),o=function(t){if(!t)return null;var e=(0,_t.k$)(t);if(!e)return null;var n=e.path.substring(0,e.path.lastIndexOf("/"))+"/preboot.ashx";return e.protocol+"//"+e.hostname+n}(e.wac.applicationUrl);if(!o)return!1;var r=encodeURIComponent(e.wac.wopiSrc),s=kt(),a=new XMLHttpRequest;return a.open("POST",o+"?op=preboot&usid="+encodeURI(t)+"&wopisrc="+r+"&sc="+s),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(i),!0}(a,t.wopiHostData)?o.ULS.sendTraceTag(558158864,f.W.Xn,p.G.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+a):(null==Ct||Ct.removeItem(r),o.ULS.sendTraceTag(545036515,f.W.Xn,p.G.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+a),u.set("FailureTime",(new Date).toUTCString()),null==c||c.recordKpiFailure(Ut,"PrebootRequestFailed",!1,!0,{durationMs:(0,v.a)()-i,extendedProperties:u}))})).catch((function(t){o.ULS.sendTraceTag(558158865,f.W.Xn,p.G.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(t)),u.set("DriveItemError",JSON.stringify(t)),u.set("FailureTime",(new Date).toUTCString()),null==c||c.recordKpiFailure(Ut,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:(0,v.a)()-i,extendedProperties:u}),null==Ct||Ct.removeItem(r)}))}}else null==o||o.ULS.sendTraceTag(527471828,f.W.Xn,p.G.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");else null==o||o.ULS.sendTraceTag(558158862,f.W.Xn,p.G.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.")}function Ft(t,e,n){Dt(t,e,Ot(n))}function xt(t){var e=(0,wt.q_)(t);return e&&Ct?Ct.getItem(e):null}function qt(t,e){if(e){var n=(0,wt.q_)(t);if(n)return null==Ct||Ct.removeItem(n),!0}return!1}var Bt=function(){function t(t){var e=this;this.da=!1,this.fa="",this.pa=[],this.va=function(t){e.da||(e.da=!0,e.fa=t?"timeout":"cancelled",e.pa.map((function(t){return t()})),e.pa=[])},this.ma=t,window.setTimeout((function(){return e.va(!0)}),t)}return Object.defineProperty(t.prototype,"isCancelled",{get:function(){return this.da},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeoutInMs",{get:function(){return this.ma},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reason",{get:function(){return this.fa},enumerable:!1,configurable:!0}),t.prototype.cancel=function(){this.va(!1)},t.prototype.subscribe=function(t){this.da?t():this.pa.push(t)},t}(),Lt=s(4141),Wt=s(2913),jt=function(t){function e(e){var n=t.call(this)||this;return n.ga=e,n}return Lt.ZT(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype.O=function(e){var n=t.prototype.O.call(this,e);return n&&!n.closed&&e.next(this.ga),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Wt.N;return this.ga},e.prototype.next=function(e){t.prototype.next.call(this,this.ga=e)},e}(mt.xQ),Gt=s(6403),Kt=s(3953),zt=s(3115),$t=s(983);function Vt(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Jt(t,e))}}var Jt=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Qt(t,this.project,this.thisArg))},t}(),Qt=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.project=n,o.count=0,o.thisArg=i||o,o}return Lt.ZT(e,t),e.prototype.$=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}($t.L);function Xt(t,e,n,i){return(0,zt.m)(n)&&(i=n,n=void 0),i?Xt(t,e,n).pipe(Vt((function(t){return(0,Kt.k)(t)?i.apply(void 0,t):i(t)}))):new Gt.y((function(i){Yt(t,e,(function(t){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(t)}),i,n)}))}function Yt(t,e,n,i,o){var r;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,o),r=function(){return s.removeEventListener(e,n,o)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var a=t;t.on(e,n),r=function(){return a.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var c=t;t.addListener(e,n),r=function(){return c.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var u=0,l=t.length;u<l;u++)Yt(t[u],e,n,i,o)}i.add(r)}var Zt=s(5514);function te(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var ee=te(),ne=s(59);var ie=s(4572),oe=function(t){if(t&&"function"==typeof t[ne.L])return r=t,function(t){var e=r[ne.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if((e=t)&&"number"==typeof e.length&&"function"!=typeof e)return o=t,function(t){for(var e=0,n=o.length;e<n&&!t.closed;e++)t.next(o[e]);t.complete()};var e;if(function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}(t))return i=t,function(t){return i.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Zt.z),t};if(t&&"function"==typeof t[ee])return n=t,function(t){for(var e=n[ee]();;){var i=void 0;try{i=e.next()}catch(e){return t.error(e),t}if(i.done){t.complete();break}if(t.next(i.value),t.closed)break}return"function"==typeof e.return&&t.add((function(){e.return&&e.return()})),t};var n,i,o,r,s=(0,ie.K)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+s+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},re=s(1934),se=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return Lt.ZT(e,t),e.prototype.$=function(t){this.parent.notifyNext(t)},e.prototype.X=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype.Z=function(){this.parent.notifyComplete(),this.unsubscribe()},e}($t.L),ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lt.ZT(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}($t.L);function ce(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(i){return i.pipe(ce((function(n,i){return(o=t(n,i),o instanceof Gt.y?o:new Gt.y(oe(o))).pipe(Vt((function(t,o){return e(n,t,i,o)})));var o}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new ue(t,n))})}var ue=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new le(t,this.project,this.concurrent))},t}(),le=function(t){function e(e,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=n,o.concurrent=i,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return Lt.ZT(e,t),e.prototype.$=function(t){this.active<this.concurrent?this.wa(t):this.buffer.push(t)},e.prototype.wa=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this.ya(e)},e.prototype.ya=function(t){var e=new se(this),n=this.destination;n.add(e);var i=function(t,e){if(!e.closed){if(t instanceof Gt.y)return t.subscribe(e);var n;try{n=oe(t)(e)}catch(t){e.error(t)}return n}}(t,e);i!==e&&n.add(i)},e.prototype.Z=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this.$(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(ae),he=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),de=function(){function t(t){if(this.total=t,this.total<0)throw new he}return t.prototype.call=function(t,e){return e.subscribe(new fe(t,this.total))},t}(),fe=function(t){function e(e,n){var i=t.call(this,e)||this;return i.total=n,i.count=0,i}return Lt.ZT(e,t),e.prototype.$=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}($t.L);function pe(t,e){return function(n){return n.lift(new ve(t,e))}}var ve=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new me(t,this.predicate,this.thisArg))},t}(),me=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=i,o.count=0,o}return Lt.ZT(e,t),e.prototype.$=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}($t.L),ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return Lt.ZT(e,t),e.prototype.O=function(e){return this.hasError?(e.error(this.thrownError),re.w.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),re.w.EMPTY):t.prototype.O.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(mt.xQ);function we(t){return!(!t||!t.failure)&&"TypeError: Failed to fetch"===t.failure}function ye(t,e){if(e)return!0;if(!t)return!1;switch(t){case 401:case 403:case 404:case 429:return!0;default:return!1}}function _e(t,e){if(e)return m.I$.Offline;switch(t){case 401:case 403:return m.I$.PermissionError;case 404:return m.I$.NotFound;case 429:return m.I$.Throttling;default:return m.I$.Other}}var Ce,Se,ke=s(8980);function Te(t){var e=function(t){var e=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return e&&e[1]?e[1]:"public"}(t);return{region:e,dataBoundary:(0,ke.g)(e)}}function be(t){return new Map([["ErrorName","".concat(t.wacErrorName)+(t.errorName?"_".concat(t.errorName):"")],["ErrorMessage",t.errorMessage?t.errorMessage:""],["HttpErrorCode","".concat(t.httpErrorCode)],["NetworkError","".concat(t.networkError)],["error",t.error?Ae(t.error):""]])}function Ae(t){if("string"==typeof t)try{return JSON.parse(t),t}catch(t){}return JSON.stringify(t,Object.getOwnPropertyNames(t))}function Ie(t,e,n){return Re(t,e,n,!1)}function Re(t,e,i,o){return void 0===o&&(o=!0),(0,n.mG)(this,void 0,void 0,(function(){var r,s,a=this;return(0,n.Jh)(this,(function(c){return Ce||(Ce=new Map),(r=Ce.get(i))?[2,r]:(s=new Promise((function(r,s){var c=(0,v.a)();!function(t,e,n,i,o,r,s){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===s&&(s=!1),!document)return null;if(o){var a=document.getElementById(o);if(null!=a)return e&&e(),a}var c=document.createElement("script");if(c.src=t,o&&(c.id=o),e&&(c.onload=e),n&&(c.onerror=function(){var t;n(),s&&(null===(t=c.parentNode)||void 0===t||t.removeChild(c))}),r&&(c.crossOrigin="anonymous"),i){var u=document.getElementsByTagName("script")[0];if(u&&u.parentNode)return u.parentNode.insertBefore(c,u)}document.body.appendChild(c)}(t,(function(){var n=(0,v.a)();r({bootstrapperUrl:t,applicationUrl:e,performance:{startTime:c,endTime:n}})}),(function(){return(0,n.mG)(a,void 0,void 0,(function(){var a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(!o)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Ie(t,e,i)];case 2:return n.sent(),a=(0,v.a)(),r({bootstrapperUrl:t,applicationUrl:e,performance:{startTime:c,endTime:a}}),[3,4];case 3:return n.sent(),s("Load bootstrapper script failed"),[3,4];case 4:return[3,6];case 5:s("Load bootstrapper script failed"),n.label=6;case 6:return[2]}}))}))}),!1,"".concat(T.T[i],"_bootstrapper"))})),Ce.set(i,s),[2,s])}))}))}var Ee,Ne=function(t){return Se?"".concat(t,".").concat(Se.size):t},Pe=s(7040);!function(t){t.Unavailable="Service Unavailable",t.UnableToConnect="Unable to connect to service",t.NoData="No data retrieved",t.ManyRequest="Too many requests",t.FailToFetchToken="Failed to fetch access token",t.UrlIsNull="Url is null",t.ItemIdOrDriveIdIsNull="ItemId or DriveId is null"}(Ee||(Ee={}));var He=s(269);function Oe(t){var e={Id:"",Details:""},n=He.W.InternalServiceError,i=He.W.ServiceUnavailable,o=He.W.Unknown,r=t.status,s=t.errorCode,a=t.message;switch(r){case He.W.OK:e="MissingProperty"===s?{Id:n.toString(),Details:Ee.NoData}:"ParsingResponseFailed"===s?{Id:n.toString(),Details:a.toString()}:{Id:null!=s?s:n.toString(),Details:a.toString()};break;case He.W.Unknown:e={Id:o.toString(),Details:Ee.UnableToConnect};break;case He.W.ServiceUnavailable:e={Id:i.toString(),Details:Ee.Unavailable};break;default:e={Id:r.toString(),Details:a.toString()}}return e}var Ue,Me=s(9804);!function(t){t[t.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",t[t.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(Ue||(Ue={}));var De=[],Fe=!1;function xe(t){switch(t){case Ue.GetWopiInfoFromUrl:return Pe.KX.PostMessage_SetHostWopiInfoFromUrl;case Ue.GetDavUrlFromIds:return Pe.KX.PostMessage_SetDavUrlFromIds}}function qe(t){switch(t){case Ue.GetWopiInfoFromUrl:return m.yv.vi;case Ue.GetDavUrlFromIds:return m.yv.hi}}function Be(t){switch(t){case Ue.GetWopiInfoFromUrl:return m.DG.QosError_WopiInfoFromUrlFailure;case Ue.GetDavUrlFromIds:return m.DG.QosError_DavUrlFromIdsFailure}}function Le(t,e,n,i,o,r,s){var a,c,u,l,h,d=qe(t),f=Be(t),p=xe(t),v={Url:e.Url,ItemId:e.ItemId,DriveId:e.DriveId,Error:n};try{h=JSON.parse(n.Details)}catch(t){h=void 0}null==s||s.recordKpiFailure(d),null==s||s.recordQosError(f,[m.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",null!==(c=null===(a=null==h?void 0:h.error)||void 0===a?void 0:a.code)&&void 0!==c?c:n.Id],["ErrorMessage",null!==(l=null===(u=null==h?void 0:h.error)||void 0===u?void 0:u.message)&&void 0!==l?l:n.Details],["HttpErrorCode",n.Id]])}),(0,Me.R)(p,v,o,i,r)}function We(t,e,n,i,o,r){var s;Fe=!0;var a=De.shift();if(a){var c={docUrl:(0,_t.Th)(null!==(s=a.eventArgs.Url)&&void 0!==s?s:"",t.docUrl),docId:a.eventArgs.ItemId,driveId:a.eventArgs.DriveId,fileType:t.fileType,wdOrigin:t.wdOrigin,wdValue:t.wdValue,uiCulture:t.uiCulture,dataCulture:t.dataCulture,puid:t.puid,clickTime:t.clickTime};(0,yt.o)(c,e).then((function(t){!function(t,e,n,i,o,r,s){var a=qe(t),c=Be(t),u=xe(t);n.fetchedDocumentIdentifier.then((function(c){var l,h,d,f,p,v,m,g,w,y={DriveId:null!==(l=e.DriveId)&&void 0!==l?l:c.driveId,ItemId:null!==(h=e.ItemId)&&void 0!==h?h:c.docId,Url:t===Ue.GetWopiInfoFromUrl?e.Url:null===(d=n.wopiHostData)||void 0===d?void 0:d.webDavUrl,WopiSrc:null===(p=null===(f=n.wopiHostData)||void 0===f?void 0:f.wac)||void 0===p?void 0:p.wopiSrc,AccessToken:null===(m=null===(v=n.wopiHostData)||void 0===v?void 0:v.wac)||void 0===m?void 0:m.accessToken,AccessTokenExpiry:null===(w=null===(g=n.wopiHostData)||void 0===g?void 0:g.wac)||void 0===w?void 0:w.accessTokenExpiry};null==s||s.recordKpiSuccess(a),(0,Me.R)(u,y,o,i,r)})).catch((function(t){var e;null==s||s.recordKpiFailure(a),null==s||s.recordQosError(c,[m.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName","Failed to fetch document identifier"],["ErrorMessage",t instanceof Error?"".concat(t.name,": ").concat(t.message):"string"==typeof t?t:JSON.stringify(t)],["HttpErrorCode",null!==(e=t.errorCode)&&void 0!==e?e:"0"]])}),null==r||r.ULS.sendTraceTag(512337542,f.W.Xn,p.G.Warning,"Failed to fetch document identifier with error: ".concat(t))}))}(a.eventType,a.eventArgs,t,n,i,o,r)})).catch((function(t){var e={status:(null==t?void 0:t.status)||0,errorCode:(null==t?void 0:t.errorCode)||"",message:(null==t?void 0:t.message)||""};Le(a.eventType,a.eventArgs,Oe(e),n,i,o,r)})).finally((function(){Fe=!1,De.length>0&&We(t,e,n)}))}}function je(t,e,i,o,r,s,a,c){return(0,n.mG)(this,void 0,void 0,(function(){var u,l,h,d,f,p;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:null==c||c.addQosPillar("ContentConsumption"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i()];case 2:return u=n.sent(),[3,4];case 3:return l=n.sent(),h={Id:"Failed to get current document info",Details:l instanceof Error?"".concat(l.name,": ").concat(l.message):"string"==typeof l?l:JSON.stringify(l)},[2,Le(t,e,h,s,r,a,c)];case 4:return t===Ue.GetWopiInfoFromUrl?e.Url||(d={Id:"Url is null",Details:Ee.UrlIsNull.toString()}):t===Ue.GetDavUrlFromIds&&(e.ItemId&&e.DriveId||(d={Id:"ItemId or DriveId is null",Details:Ee.ItemIdOrDriveIdIsNull.toString()})),d?[2,Le(t,e,d,s,r,a,c)]:De.length>=100?(f=He.W.Throttled,d={Id:f.toString(),Details:Ee.ManyRequest.toString()},[2,Le(t,e,d,s,r,a,c)]):(p={eventType:t,eventArgs:e},De.push(p),Fe||We(u,o,s,r,a,c),[2])}}))}))}var Ge,Ke,ze=700,$e=525,Ve=2;function Je(t,e,n){var i,o,r=Oe({status:e,errorCode:null!==(i=n.errorCode)&&void 0!==i?i:"",message:null!==(o=n.message)&&void 0!==o?o:""});return t.map((function(t){return{Name:t,Errors:[{Id:r.Id.toString(),Details:r.Details}],SPCorrelationId:n.SPRequestGuid}}))}function Qe(t){var e;e=t?"MobileViewer.Label.LinkCopied":"MobileViewer.Label.ErrorCopyingLink";var n=document.createElement("div");n.style.visibility="visible",n.style.position="fixed",n.style.bottom="5px",n.style.backgroundColor="#000000",n.style.color="#fff",n.style.padding="16px",n.style.borderRadius="4px",n.style.height="16px",n.style.left="6px",n.style.right="6px",n.style.fontSize="14px",n.style.fontFamily="-apple-system, Roboto",n.style.display="flex",n.style.alignItems="center",n.textContent=e,document.body.appendChild(n),setTimeout((function(){n.style.visibility="hidden"}),3e3)}!function(t){t[t.Unattempted=0]="Unattempted",t[t.InProgress=1]="InProgress",t[t.NotHandled=2]="NotHandled",t[t.HandleExternally=4]="HandleExternally",t[t.Failed=8]="Failed",t[t.Error=16]="Error",t[t.Succeeded=32]="Succeeded",t[t.Delayed=64]="Delayed"}(Ge||(Ge={})),function(t){t.android="android",t.ios="ios",t.ipados="ipados"}(Ke||(Ke={}));var Xe,Ye="PushStateHandler";function Ze(t){window.history.pushState(t.State,window.document.title,t.Url)}!function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.ActionCompleted="ActionCompleted",t.BrowserEvent="BrowserEvent",t.CAAEMessage="CAAEMessage",t.Close="Close",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.CreateNewDocument="CreateNewDocument",t.Download="Download",t.Edit="Edit",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.FrameTrust="FrameTrust",t.GetAccessToken="GetAccessToken",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.GetDavUrlFromIds="GetDavUrlFromIds",t.ModeSwitched="ModeSwitched",t.MoveToFolder="MoveToFolder",t.OpenInMobileApp="OpenInMobileApp",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.PushState="PushState",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SharedFilePicker="SharedFilePicker",t.SaveStatus="SaveStatus",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.DismissSplashScreen="DismissSplashScreen",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged",t.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",t.LoadingStatus="LoadingStatus",t.SwitchNotebook="SwitchNotebook",t.FailedBootCheckFileInfo="FailedBootCheckFileInfo",t.GetTeamsUsers="GetTeamsUsers",t.SendTeamsUserMention="SendTeamsUserMention",t.NavigateBackToHost="NavigateBackToHost",t.GetClientUrlComplete="GetClientUrlComplete",t.GetWebUrlComplete="GetWebUrlComplete",t.CopyLinkComplete="CopyLinkComplete",t.SendConversationId="SendConversationId",t.CloseTeamsConversation="CloseTeamsConversation",t.PageLoaded="PageLoaded",t.FrameChanged="FrameChanged"}(Xe||(Xe={}));var tn="officeapps.live.com",en=2e3,nn=9e3,on=9500,rn=6e5;function sn(t){var e,i,o,r=(0,v.a)(),a=t.documentBootInfo,c=t.fetchItemFromNetwork,u=t.fetchAccessToken,l=t.sessionConfig,h=t.container,w=t.setTitle,y=t.onBootComplete,_=t.onBootFailure,S=t.onReturnFocus,k=t.onConversationClose,b=t.onNavigateBack,I=t.onOpenPageLevelConversation,R=t.onDocumentClose,E=t.onSuccessNotification,N=t.uiHostConfig,O=t.createDocument,U=t.openShareControl,M=t.onOpenInMobileApp,D=t.sharingLinkTokenProvider,F=t.onUserActivity,x=t.onCAAEMessage,B=t.onUserAccess,L=t.onMoveToFolder,W=t.onSharedFilePicker,j=t.onRename,G=t.initPackageParams,K=t.onFrameChange,z=t.invokeSessionRefreshInfoPopupBlockedDialog,$=t.onFileEmbed,V=null==N?void 0:N.supportsExplicitUnload;l.logger||(l.logger=(0,d.L8)());var J=l.hostCorrelationId,Q=l.isMsa,X=l.tenantId,Y=l.shareApiEndpoint,Z=l.organizationName,tt=l.logger,et=l.hostClientType,nt=l.channelId,it=l.health,ot=Nt(a.fileType,null==N?void 0:N.featureGates,tt);null==tt||tt.ULS.sendTraceTag(576578584,f.W.Xn,p.G.Info,"Lean Ui Host: bootApp");var rt,st=new Bt(rn),at=[],ct=function(t){return new Promise((function(e){ot&&!st&&e("No active session to close. Return from here.");var i=function(t){null==tt||tt.ULS.sendTraceTag(575411776,f.W.Xn,p.G.Info,"Dispose the WAC frame. And reboot: ".concat(t?"true":"false")),Mt.next(t),Mt.complete(),Sf(),e("WAC frame disposed")},o=function(){a.fileType===T.T.Excel&&(De=[]),null==Ot||Ot.unsubscribe(),null==Ut||Ut.unsubscribe()};if(!ht)return null==tt||tt.ULS.sendTraceTag(529093076,f.W.Xn,p.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void i(t);if(ot)null==ht||ht.removeEventListener(rt),null==st||st.cancel(),null==ht||ht.dispose().catch((function(t){null==tt||tt.ULS.sendTraceTag(527257879,f.W.Xn,p.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Ct,", Error: ").concat(t))})).finally((function(){o(),i(t)}));else if(at.forEach((function(t){var e=(0,n.CR)(t,2),i=e[0],o=e[1];ht.RemoveEventHandler(i,o)})),null==ht||ht.Dispose(V,function(t){if(t===T.T.OneNote)return nn}(a.fileType)),o(),V){ht.RegisterEventHandler(Pe.E_.Event_Unloaded,(function(){null==tt||tt.ULS.sendTraceTag(575411777,f.W.Xn,p.G.Info,"Receive Unloaded Event from WAC"),Ct=!0,clearTimeout(r),i(t)}));var r=window.setTimeout((function(){null==tt||tt.ULS.sendTraceTag(575411778,f.W.Xn,p.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Ct)),Ct||i(t)}),a.fileType===T.T.OneNote?on:en)}else null==tt||tt.ULS.sendTraceTag(575271647,f.W.Xn,p.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),i(t)}))},ut=function(t,e,i){var o,r,d,g,w=Promise.resolve(null===(o=null==t?void 0:t.wac)||void 0===o?void 0:o.applicationUrl),y=function(){return e.asObservable().pipe((function(t){return t.lift(new de(1))})).toPromise()},_=null!==(r=null==N?void 0:N.sessionOriginPrefix)&&void 0!==r?r:"TEAMS.UNIFIEDUIHOST.",C=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.getWdOrigin,r=t.reboot;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,s,a,c,u,l;return(0,n.Jh)(this,(function(h){switch(h.label){case 0:return[4,i()];case 1:if(e=h.sent(),s=t.previousSessionId,a=t.mode,c={},t.queryOverrides&&"string"==typeof t.queryOverrides)try{c=JSON.parse(t.queryOverrides)}catch(t){c={}}else c=t.queryOverrides||{};return u=t.isNewSession,l={previousSessionId:s,mode:a,queryOverrides:c,isNewSession:u},t.rebootMode===Pe.Bn.NewDocument?r({docUrl:t.documentUrl,fileType:e.fileType,wdOrigin:o(m.J4.BackstageMru),uiCulture:e.uiCulture,dataCulture:e.dataCulture,puid:e.puid,rebootOverrideData:l,clickTime:(0,v.a)()},!1):r((0,n.pi)((0,n.pi)({},e),{wdOrigin:o(m.J4.Reboot),rebootOverrideData:l,clickTime:(0,v.a)()}),!0),[2]}}))}))}}({getCurrentDocumentInfo:y,health:it,getWdOrigin:function(t){return"".concat(_).concat(t)},reboot:function(t,e){ct({documentBootInfo:t,navigationRequired:!e}).catch((function(){null==tt||tt.ULS.sendTraceTag(512296464,f.W.Xn,p.G.Error,"endSession: endSession error in DocumentReboot")}))}}),E=function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().renameHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}({bootedDocumentInfo:e,getCurrentDocumentInfo:y,hostRenameCallback:j,health:it}),P=function(t){var e=this,i=t.supportsRefreshTokenReauthPopUp,o=t.hostUrl,r=t.documentBootInfo,s=t.fetchItemFromNetwork,a=t.officeDocumentSession,c=t.appUrlPromise,u=t.invokePopupBlockedDialog,l=t.logger,h=t.health,d=0,v=!1,g=!1;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,w,y,_,C,S,k,T,b,A,I,R,E,N,P,H,O,U;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,11]),null==h||h.addQosPillar("Interruptions"),null==l||l.ULS.sendTraceTag(512247693,f.W.Xn,p.G.Info,"Start token refresh: Application : ".concat(r.fileType,", Origin: ").concat(r.wdOrigin)),[4,(0,yt.o)(r,s,l,!0,!1,0)];case 1:return e=n.sent(),w=null==e?void 0:e.wopiHostData.wac,y=t.Tokens.map((function(t){return e=t,i=(n=w).accessTokenExpiry,(o=n[e.charAt(0).toLowerCase()+e.slice(1)])?{Name:e,Expiry:i,Value:o.toString()}:{Name:e,Errors:[{Id:"404",Details:"Could not find this token"}]};var e,n,i,o})),null==h||h.recordKpiSuccess(m.yv.di),(0,Me.R)(Pe.KX.PostMessage_RefreshSessionInfo,{Tokens:y},c,a,l),d>0&&(null==l||l.ULS.sendTraceTag(509441036,f.W.Xn,p.G.Info,"Resetting popup retry count to 0 from ".concat(d," after successful token acquistion")),d=0),[3,11];case 2:_=n.sent(),(C=null!==(N=_.status)&&void 0!==N?N:(null===(P=_.httpResponse)||void 0===P?void 0:P.status)===He.W.TokenUnavailable?He.W.Unauthorized:null===(H=_.httpResponse)||void 0===H?void 0:H.status)||(null==l||l.ULS.sendTraceTag(508913162,f.W.Xn,p.G.Warning,"Unable to parse status from error: ".concat(JSON.stringify(_,Object.getOwnPropertyNames(_)),"; status: ").concat(C)),C=0),S=Oe({status:C,errorCode:null!==(O=_.errorCode)&&void 0!==O?O:"",message:null!==(U=_.message)&&void 0!==U?U:""}),n.label=3;case 3:return n.trys.push([3,9,,10]),void 0===C?[3,7]:(null==l||l.ULS.sendTraceTag(512549194,f.W.Xn,p.G.Warning,"Error while refreshing token - "+_.status),"string"!=typeof o?[3,4]:(T=o,[3,6]));case 4:return[4,o];case 5:T=n.sent(),n.label=6;case 6:return k=T,i&&t.AllowAADPopup&&k&&function(t,e,n){return e<Ve&&(t===He.W.Unauthorized||t===He.W.Forbidden&&n.indexOf("aadInteractionRequired")>-1)}(C,d,S.Details)?(b=function(){var e=t.Tokens.map((function(t){return{Name:t,Errors:[{Id:"202",Details:"AAD Interaction Required"}],SPCorrelationId:_.SPRequestGuid}}));(0,Me.R)(Pe.KX.PostMessage_RefreshSessionInfo,{Tokens:e},c,a,l)},A=function(){if(document.hidden&&d>0||g)b();else{var e=d;d++;var n=function(t,e,n){var i=t.concat("?wacreauth=1"),o=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,s=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+o,a=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-n/2+r,c=window.open(i,"","scrollbars=yes, width="+e+", height="+n+", top="+a+", left="+s);try{null==c||c.focus()}catch(t){return null}return c}(k,ze,$e);if(n)g=!0,setTimeout((function(){n.close(),g=!1}),2e4),b();else{null==l||l.ULS.sendTraceTag(509646289,f.W.Xn,p.G.Warning,"401 - Popup blocked [retry: ".concat(e,"]"));var i=function(){var e=Je(t.Tokens,C,_);null==h||h.recordKpiFailure(m.yv.di),null==h||h.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Supported pop-up did not open."],["AuthError","".concat(S.Details)],["HttpErrorCode","".concat(S.Id.toString())]])}),(0,Me.R)(Pe.KX.PostMessage_RefreshSessionInfo,{Tokens:e},c,a,l)};!u||v||document.hidden?document.hidden?(null==l||l.ULS.sendTraceTag(509084357,f.W.Xn,p.G.Warning,"Document is hidden"),b()):i():(v=!0,null==l||l.ULS.sendTraceTag(509136921,f.W.Xn,p.G.Info,"Popup blocked dialog invoked"),u({visible:!0,handleRefresh:function(){null==l||l.ULS.sendTraceTag(509136920,f.W.Xn,p.G.Info,"Retry button clicked. Resetting retry from ".concat(d," to 0.")),d=0,A()},handleCancel:function(){null==l||l.ULS.sendTraceTag(509136919,f.W.Xn,p.G.Info,"Continue button clicked"),i()},onDismiss:function(){null==l||l.ULS.sendTraceTag(509136918,f.W.Xn,p.G.Info,"Dialog was dismissed"),i()}}))}}},A()):(I=Je(t.Tokens,C,_),R="",d>=Ve?R="Exceeded maximum 401 reauth retry attempts at ".concat(d):C!==He.W.Unauthorized||i?C!==He.W.Unauthorized||t.AllowAADPopup?C!==He.W.Unauthorized&&(R="Do not retry on status codes other than 401"):R="No reauth pop-up support from the application":R="No reauth pop-up support from the host",null==h||h.recordKpiFailure(m.yv.di),null==h||h.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure.".concat(R?" ".concat(R,"."):"")],["AuthError","".concat(S.Details)],["HttpErrorCode","".concat(S.Id.toString())]])}),(0,Me.R)(Pe.KX.PostMessage_RefreshSessionInfo,{Tokens:I},c,a,l)),[3,8];case 7:null==h||h.recordKpiFailure(m.yv.di),null==h||h.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Status is undefined. This should not happen."],["AuthError","".concat(S.Details)],["HttpErrorCode","".concat(S.Id.toString())]])}),null==l||l.ULS.sendTraceTag(512549195,f.W.Xn,p.G.Error,"Unexpected error refreshing token ("+JSON.stringify(_)+")"),n.label=8;case 8:return[3,10];case 9:return E=n.sent(),null==h||h.recordKpiFailure(m.yv.di),null==h||h.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Failed to parse error response."],["AuthError","".concat(S.Details)],["HttpErrorCode","".concat(S.Id.toString())]])}),null==l||l.ULS.sendTraceTag(510248914,f.W.Xn,p.G.Error,"Unexpected error when parsing error ("+E+")"),[3,10];case 10:return[3,11];case 11:return[2]}}))}))}}({hostUrl:null==l?void 0:l.hostUrl,supportsRefreshTokenReauthPopUp:null==N?void 0:N.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:y,documentBootInfo:a,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:w,invokePopupBlockedDialog:z,logger:tt,health:it}),H=function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().shareHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:y,sharePointInfo:t.sharePointInfo,shareApiEndPointBase:Y,fetchAccessToken:u,openShareControl:U,correlationId:ft,isMsa:Q,tenantId:X,organizationName:Z,onOpen:function(){(0,Me.R)(Pe.KX.PostMessage_BlurFocus,void 0,gt,Rt,tt)},onClose:function(){(0,Me.R)(Pe.KX.PostMessage_GrabFocus,void 0,gt,Rt,tt)},health:it,featureGates:null==N?void 0:N.featureGates,logger:tt}),q=null!=B?B:function(t){var e=this,i=t.shareHandler,o=t.officeDocumentSession,r=t.appUrlPromise,s=t.logger;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e;return(0,n.Jh)(this,(function(n){return e=function(e,n){(0,Me.R)(Pe.KX.PostMessage_GrantPermissions,{Persons:t.Persons.map((function(t){return{Id:t.Id,Provider:t.Provider,Status:e?0:3,Reason:""}})),DialogCanceled:null!=n&&n,Id:t.Id},r,o,s)},i({wdUserSession:t.wdUserSession,mode:"atMention",onGrantAccessComplete:e,defaultRecipients:t.Persons.map((function(t){return t.Id}))}),[2]}))}))}}({getCurrentDocumentInfo:y,shareHandler:H,officeDocumentSession:i,appUrlPromise:w,logger:tt,health:it}),V=function(t){var e=this,i=t.onUserActivity;return function(){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i&&i(),[2]}))}))}}({getCurrentDocumentInfo:y,onUserActivity:F,health:it}),J=function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().createNewHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:y,createDocument:O,getWdOrigin:function(t){return"".concat(_).concat(t)},reboot:function(t,e){ct({documentBootInfo:t,navigationRequired:!e}).catch((function(t){var e=(0,A.vJ)(A.Fh.FeatureGate_CommandingAshaVetoes,null==N?void 0:N.featureGates);(0,A.dt)(A.Fh.FeatureGate_CommandingAshaVetoes,e,tt),e&&(null==it||it.recordQosError(m.DG.QosError_CreateNewHandlerEndSessionFailure,[m.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",m.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(ft)],["Reason",t]])})),null==tt||tt.ULS.sendTraceTag(512296463,f.W.Xn,p.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:tt,health:it,correlationId:ft}),ot=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.fetchAccessToken,r=t.officeDocumentSession,s=t.appUrlPromise,a=t.logger,c=t.health,u=t.correlationId;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,l,h,d,f;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:e=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),p=null!==(f=e.docUrl)&&void 0!==f?f:"",l=(0,_t.aE)(p)===_t.o4.OneDrive?"OneDrive":"SharePoint",[4,o(l,!1,t.Resource)];case 3:return h=n.sent(),null==c||c.recordKpiSuccess(m.yv.fi),(0,Me.R)(Pe.KX.PostMessage_SetAuthToken,{RequestId:t.RequestId,AuthToken:h.token,TokenExpiration:h.expiryMs?new Date(h.expiryMs):void 0},s,r,a),[3,5];case 4:return d=n.sent(),null==c||c.recordKpiFailure(m.yv.fi),null==c||c.recordQosError(m.DG.QosError_WopiFetchAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{extendedProperties:new Map([["ErrorName",m.DG.QosError_WopiFetchAuthTokenFailure],["CorrelationId","".concat(u)],["AuthError","".concat(null==d?void 0:d.error)],["ErrorCategory","".concat(null==d?void 0:d.errorCategory)]])}),(0,Me.R)(Pe.KX.PostMessage_SetAuthToken,{RequestId:t.RequestId,Error:"string"==typeof d?d:JSON.stringify(d)},s,r,a),[3,5];case 5:return[2]}var p}))}))}}({getCurrentDocumentInfo:y,fetchAccessToken:u,officeDocumentSession:i,appUrlPromise:w,logger:tt,health:it}),rt=function(t){var e=this,i=t.onOpenPageLevelConversation,o=t.hostSendConversationId,r=t.logger;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){return null==r||r.ULS.sendTraceTag(508150792,f.W.Xn,p.G.Info,"Trying to open the page level conversation"),t?i?(i(t.conversationId,t.pageUrl,o),[2]):(null==r||r.ULS.sendTraceTag(508150790,f.W.Xn,p.G.Error,"Receiving getSendConversationId message, but no onOpenPageLevelConversation callback is defined!"),[2]):(null==r||r.ULS.sendTraceTag(508150791,f.W.Xn,p.G.Error,"SendConversationId Response not present"),[2])}))}))}}({getCurrentDocumentInfo:y,onOpenPageLevelConversation:I,hostSendConversationId:Dt,health:it}),st=function(t){var e=this,i=t.onConversationClose,o=t.logger;return function(){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i?(i(),[2]):(null==o||o.ULS.sendTraceTag(508150794,f.W.Xn,p.G.Error,"Receiving closeTeamsConversation message, but no onConversationClose callback is defined!"),[2])}))}))}}({getCurrentDocumentInfo:y,onConversationClose:k,health:it}),at=function(t){var e=this,i=t.onNavigateBack,o=t.logger;return function(){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return i?(i(),[2]):(null==o||o.ULS.sendTraceTag(508150793,f.W.Xn,p.G.Error,"Receiving NavigateBackToHostHandler message, but no onNavigateBack callback is defined!"),[2])}))}))}}({getCurrentDocumentInfo:y,onNavigateBack:b,health:it}),ut=function(t){var e=this,i=t.onReturnFocus,o=t.logger;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){if(!i)return null==o||o.ULS.sendTraceTag(576217558,f.W.Xn,p.G.Error,"Receiving AccessibilityLoopComplete message, but no OnReturnFocus callback is defined!"),[2];switch(t.Direction){case"forward":i(!0);break;case"backward":i(!1);break;default:i()}return[2]}))}))}}({getCurrentDocumentInfo:y,onReturnFocus:S,health:it}),lt=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.hostClientType,r=t.logger,s=t.openInMobileAppCallback;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return null==r||r.ULS.sendTraceTag(526242818,f.W.Xn,p.G.Info,"Trying to open the ClientUrl}"),t?t.Status!==Ge.Succeeded.toString()?(null==r||r.ULS.sendTraceTag(526242820,f.W.Xn,p.G.Error,"Host_GetClientUrl failed with status code ".concat(t.Status)),[2]):(e=t.Url,[4,i()]):(null==r||r.ULS.sendTraceTag(526242819,f.W.Xn,p.G.Info,"Response not present"),[2]);case 1:return n.sent().fileType!==T.T.OneNote?(null==r||r.ULS.sendTraceTag(525682274,f.W.Xn,p.G.Info,"This handler is not supported for fileType: ".concat(T.T)),[2]):(o===Ke.android?a="market://details?id=com.microsoft.office.onenote":o===Ke.ios||o===Ke.ipados?a="https://itunes.apple.com/us/app/appname/id410395246":(null==r||r.ULS.sendTraceTag(526242821,f.W.Xn,p.G.Info,"HostClientType: ".concat(o," not supported.")),a=""),s?(s(e,a),[2]):(null==r||r.ULS.sendTraceTag(512337545,f.W.Xn,p.G.Error,"openInMobileApp callback is not defined"),[2]))}}))}))}}({getCurrentDocumentInfo:y,hostClientType:et,logger:tt,openInMobileAppCallback:M,health:it}),ht=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.logger,r=t.channelId,s=t.officeDocumentSession,a=t.appUrlPromise;return function(){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,i()];case 1:if(t.sent().fileType===T.T.OneNote){if(null==o||o.ULS.sendTraceTag(508036748,f.W.Xn,p.G.Info,"Sending channel id to WAC after document has been loaded"),!r)return null==o||o.ULS.sendTraceTag(508036747,f.W.Xn,p.G.Info,"sendChannelIdToWAC: Could not find channel id"),[2];(0,Me.R)(Pe.KX.PostMessage_HostSendChannelId,{channelId:r},a,s,o)}return[2]}}))}))}}({getCurrentDocumentInfo:y,channelId:nt,officeDocumentSession:i,appUrlPromise:w,health:it}),dt=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.hostClientType,r=t.logger;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return null==r||r.ULS.sendTraceTag(508352280,f.W.Xn,p.G.Info,"Trying to copy the WebUrl to clipboard for HostClientType: ".concat(o)),t?t.Status!==Ge.Succeeded.toString()?(null==r||r.ULS.sendTraceTag(508352279,f.W.Xn,p.G.Error,"Host_GetWebUrl failed with status code ".concat(t.Status," for HostClientType: ").concat(o)),[2]):t.Url?[4,i()]:(null==r||r.ULS.sendTraceTag(508352277,f.W.Xn,p.G.Info,"Web Url not present in the response for HostClientType: ".concat(o)),[2]):(null==r||r.ULS.sendTraceTag(508352278,f.W.Xn,p.G.Info,"Response not present"),[2]);case 1:return n.sent().fileType!==T.T.OneNote?[3,5]:((e=document.createElement("textarea")).style.position="absolute",e.style.opacity="0",e.value=t.Url,document.body.appendChild(e),document.execCommand("RemoveFormat"),s=document.execCommand("copy"),document.body.removeChild(e),s?[3,3]:[4,navigator.clipboard.writeText(t.Url).then((function(){null==r||r.ULS.sendTraceTag(508352276,f.W.Xn,p.G.Info,"navigator.clipboard command succeeded for HostClientType: ".concat(o,"!")),Qe(!0)})).catch((function(t){null==r||r.ULS.sendTraceTag(508352275,f.W.Xn,p.G.Error,"navigator.clipboard command failed for HostClientType: ".concat(o,", Error: ").concat(t)),Qe(!1)}))]);case 2:return n.sent(),[3,4];case 3:null==r||r.ULS.sendTraceTag(508352274,f.W.Xn,p.G.Info,"ExecCommand 'copy' succeeded for HostClientType: ".concat(o,"!")),Qe(!0),n.label=4;case 4:return[3,6];case 5:return null==r||r.ULS.sendTraceTag(508352273,f.W.Xn,p.G.Info,"This handler is not supported for fileType: ".concat(T.T)),[2];case 6:return[2]}}))}))}}({getCurrentDocumentInfo:y,hostClientType:et,logger:tt,health:it}),pt=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.fetchItemFromNetwork,r=t.officeDocumentSession,s=t.appUrlPromise,a=t.logger,c=t.health;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,je(Ue.GetWopiInfoFromUrl,t,i,o,s,r,a,c)];case 1:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:y,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:w,logger:tt,health:it}),vt=function(t){var e=this,i=t.getCurrentDocumentInfo,o=t.fetchItemFromNetwork,r=t.officeDocumentSession,s=t.appUrlPromise,a=t.logger,c=t.health;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,je(Ue.GetDavUrlFromIds,t,i,o,s,r,a,c)];case 1:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:y,fetchItemFromNetwork:c,officeDocumentSession:i,appUrlPromise:w,logger:tt,health:it}),mt=function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().actionCompleteHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:y,logger:tt,webUrl:null!==(d=t.webUrl)&&void 0!==d?d:"",health:it}),wt=function(t){var e=this;return function(){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return e.sent().openInBrowserHandler(t),[2]}}))}))}}({getCurrentDocumentInfo:y,logger:tt,webUrl:null!==(g=t.webUrl)&&void 0!==g?g:"",health:it,correlationId:ft}),Ct=function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return e.sent().openInMobileAppHandler(t,i),[2]}}))}))}}({getCurrentDocumentInfo:y,logger:tt,openInMobileAppCallback:M,health:it,correlationId:ft}),St={appUrlPromise:w,container:h,fetchAccessToken:u,fetchItemFromNetwork:c,getCurrentDocumentInfo:y,host:null==N?void 0:N.uiHostName,health:it,logger:tt,officeDocumentSession:i,wopiHostData:t,sessionConfig:l,uiHostConfig:N,initPackageParams:G},kt=null!=L?L:function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().moveToFolderFilePickerHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}(St),Tt=null!=W?W:function(t){var e=this;return function(i){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7076))];case 1:return[4,e.sent().commonPickerHandler(t,i)];case 2:return e.sent(),[2]}}))}))}}(St),bt=function(t){var e=this,i=t.customAuthConfigValue,o=t.officeDocumentSession,r=t.appUrlPromise,s=t.logger;return function(){return(0,n.mG)(e,void 0,void 0,(function(){var t,e;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return"string"!=typeof i?[3,1]:(e=i,[3,3]);case 1:return[4,i];case 2:e=n.sent(),n.label=3;case 3:return(t=e)&&(0,Me.R)(Pe.KX.PostMessage_SendCustomAuthConfig,{AuthConfig:t},r,o,s),[2]}}))}))}}({customAuthConfigValue:null==l?void 0:l.customAuthConfigValue,getCurrentDocumentInfo:y,officeDocumentSession:i,appUrlPromise:w,logger:tt,health:it}),At=function(t){var e=this,i=t.supportsPopAndPushState,o=t.logger,r=t.sharingLinkTokenProvider;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){return i?(r&&r.TokenPromise?(null==o||o.ULS.sendTraceTag(528004815,f.W.Xn,p.G.Info,"".concat(Ye,": Handling push state with sharing link token")),r.TokenPromise.then((function(e){if(e){var n=new URL(t.Url);n.searchParams.set(e.Key,e.Value),t.Url=n.toString()}Ze(t)})).catch((function(t){null==o||o.ULS.sendTraceTag(528004816,f.W.Xn,p.G.Error,"".concat(Ye,": Handling push state with sharing link token error ").concat(t))}))):(null==o||o.ULS.sendTraceTag(528004817,f.W.Xn,p.G.Info,"".concat(Ye,": Handling push state without sharing link token")),Ze(t)),[2]):[2]}))}))}}({getCurrentDocumentInfo:y,supportsPopAndPushState:null==N?void 0:N.supportsPopAndPushState,logger:tt,sharingLinkTokenProvider:D,health:it}),It=function(t){var e=this,i=t.onCAAEMessage;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){return i&&i(t),[2]}))}))}}({getCurrentDocumentInfo:y,onCAAEMessage:x,health:it}),Et=function(t){var e=t.appUrlPromise,n=t.logger,i=t.officeDocumentSession;return function(t){var o={State:t.state,Url:window.location.href};(0,Me.R)(Pe.KX.PostMessage_PopState,o,e,i,n)}}({getCurrentDocumentInfo:y,appUrlPromise:w,logger:tt,officeDocumentSession:i,health:it});!function(t){var e=t.onPopState;t.supportsPopAndPushState&&window.addEventListener("popstate",e)}({getCurrentDocumentInfo:y,onPopState:Et,supportsPopAndPushState:null==N?void 0:N.supportsPopAndPushState,health:it});var Nt=function(t){var e=this,i=t.onFrameChange;return function(t){return(0,n.mG)(e,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){return i&&i(t),[2]}))}))}}({getCurrentDocumentInfo:y,onFrameChange:K,health:it});return{documentRebootHandler:C,renameHandler:E,sessionRefreshInfoHandler:P,shareHandler:H,userAccessHandler:q,userActivityHandler:V,createNewHandler:J,getAuthTokenHandler:ot,sendConversationIdHandler:rt,closeTeamsConversationHandler:st,navigateBackToHostHandler:at,accessibilityLoopCompleteHandler:ut,getClientUrlCompleteHandler:lt,getWebUrlCompleteHandler:dt,loadingStatusHandler:ht,wopiInfoFromUrlHandler:pt,davUrlFromIdsHandler:vt,onCloseHandler:function(){null==tt||tt.ULS.sendTraceTag(575545427,f.W.Xn,p.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(R?"true":"false")),R&&R()},actionCompleteHandler:mt,openInBrowserHandler:wt,openInMobileAppHandler:Ct,moveToFolderPickerHandler:kt,commonFilePickerHandler:Tt,getCustomAuthConfigHandler:bt,pushStateHandler:At,caaeMessageHandler:It,frameChangedHandler:Nt,fileEmbedHandler:function(){$&&$()},dismissSplashScreenHandler:function(){var t=document.getElementById("splashscreen-container");t&&(t.style.display="none")}}},lt=(null==G?void 0:G.jsApiUrlInfos)?null==G?void 0:G.jsApiUrlInfos:new Map;0===lt.size&&lt.set(T.T.Word,{jsApiUrl:null===(e=null==G?void 0:G.wordBootstrapperUrlInfo)||void 0===e?void 0:e.url,jsApiSri:null===(i=null==G?void 0:G.wordBootstrapperUrlInfo)||void 0===i?void 0:i.sri,PreloadedInBootStrapper:null===(o=null==G?void 0:G.wordBootstrapperUrlInfo)||void 0===o?void 0:o.wordJsApiPreloadedInBootStrapper});var ht,dt=function(t,e,i,o,r,s,a,c,u,l,h){if(void 0===a&&(a=!1),Se||(Se=new Map),!t.isNewFile||!t.createNewInfo){var d=(0,wt.q_)(t);if(!d)return{correlationId:e,bootstrapperObservable:("Not enough document information was provided",new Gt.y((function(t){return t.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var w=Se.get(d);if(w)return w}return function(t,e,i,o,r,s,a,c,u,l,h){void 0===a&&(a=!1);var d=Ne(e),w=null==r?void 0:r.logger,y=(0,yt.o)(t,i,w,a,!(!t.isNewFile&&!t.templateId),1,!!(null==r?void 0:r.meeting)),_=new ge;y.then((function(e){e.fetchedDocumentIdentifier.then((function(i){var a;!function(t,e,i,o,r,s,a,c){var u=this,l=t.loadFunctionSubject,h=t.documentBootInfo,d=t.correlationId,g=t.wopiFetchData,w=void 0===g?{wopiHostData:void 0,fetchDiagnostics:void 0}:g,y=h.fileType,_=h.wdOrigin,S=h.puid,k=h.uiCulture,b=h.dataCulture,A=h.clickTime,I=h.rebootOverrideData,R=w.wopiHostData,E=w.fetchDiagnostics,N=null==i?void 0:i.logger,P=null==i?void 0:i.health;if(!(R&&R.wac&&R.wac.bootstrapperUrl&&R.wac.applicationUrl)){var H=!!R,O=!!(null==R?void 0:R.wac),U=new Map([["WopiHostDataPresent","".concat(H)],["WopiWacDataPresent","".concat(O)]]),M=JSON.stringify(Array.from(U.entries())),D={wacErrorName:m.AU.mi,qosErrorName:m.DG.QosError_VroomWopiFailure,errorMessage:M};return null==N||N.ULS.sendTraceTag(554964098,f.W.Xn,p.G.Info,"".concat(m.AU.mi,": Failed to get wopi data for the item, ").concat(M)),void(o&&o(D))}var F=c||R.wac.bootstrapperUrl,x=R.wac.applicationUrl;R.wac.userId&&(null==P||P.updatePartADimensions({loggableUserId:R.wac.userId}));var q=new Promise((function(t,e){setTimeout((function(){return e("jsApi timed out after 60 seconds")}),6e4)})),B=new Promise((function(t,c){return(0,n.mG)(u,void 0,void 0,(function(){return(0,n.Jh)(this,(function(u){return l.subscribe((function(){return t("jsApi successfully loaded")})),Re(F,x,y).then((function(t){var c,u=(0,n.CR)(function(t){var e=window.Microsoft;if(void 0===e)return[void 0,"Microsoft is undefined"];var n=e.Office,i=T.T[t];return n&&n[i]?[n[i],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(i)]}(y),2),g=u[0],w=u[1];if(!w&&g){var H,O,U=Pt(R,t.applicationUrl,null!==(c=null==e?void 0:e.uiHostName)&&void 0!==c?c:"UUIH",h,null==e?void 0:e.uiEmbed);try{O=new URLSearchParams(new URL(U).search).get("sc")||void 0}catch(t){null==N||N.ULS.sendTraceTag(520135565,f.W.Xn,p.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(t)))}Nt(y,null==e?void 0:e.featureGates,N)?(null==P||P.addOrUpdatePartCDimension("JsApiVersion","V2"),H=function(o){var c=o.container,u=o.flushTime;return new Gt.y((function(o){var l,w,y,T,P,H,M,D,x,q,B,L,W,j,G={host:{storageHostName:Tt(null!==(T=h.docUrl)&&void 0!==T?T:""),capabilities:{isFeatureEnabledCallback:Et(i),moveToFolder:null==e?void 0:e.supportsMoveToFolder,commonFilePicker:null==e?void 0:e.supportsCommonFilePicker,rebootDoc:null==e?void 0:e.supportsDocumentReboot,createNewDoc:null==e?void 0:e.supportsCreateNewDocument,authToken:null==e?void 0:e.supportsAuthToken,excelExternalLinks:null==e?void 0:e.supportsExcelExternalLinks,refreshAccessToken:null==e?void 0:e.supportsRefreshAccessToken,atMentions:null==e?void 0:e.supportsAtMentions,accessibilityLoop:null==e?void 0:e.supportsAccessibilityLoop,customAuthConfig:null==e?void 0:e.supportsCustomAuthConfig,directPrint:null===(P=null==e?void 0:e.supportsDirectPrint)||void 0===P||P,directDownload:null==e?void 0:e.supportsDirectDownload},uiHostName:(null==e?void 0:e.uiHostName)||St,requireExplicitUnload:null==e?void 0:e.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==e?void 0:e.uiHostIntegrationType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout,origin:null==i?void 0:i.origin},user:{id:R?R.wac.userId:S,isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:F,ui:{uiEmbed:null===(H=null==e?void 0:e.uiEmbed)||void 0===H||H,controls:(null==e?void 0:e.supportsHostUiControls)?[{id:"close",visibility:(null==e?void 0:e.showCloseButton)?1:0},{id:"share",visibility:(null==e?void 0:e.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==e?void 0:e.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==e?void 0:e.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==e?void 0:e.copyLinkEnabled)?1:0},{id:"conversation",visibility:(null==e?void 0:e.conversationButtonEnabled)?1:0}]:void 0,language:k,hideHeader:null==e?void 0:e.hideHeader,hideAppLauncherInHeader:null==e?void 0:e.hideAppLauncherInHeader,hideSearchInHeader:null==e?void 0:e.hideSearchInHeader,hideMeInHeader:null==e?void 0:e.hideMeInHeader,hideChatInHeader:null==e?void 0:e.hideChatInHeader,hideWorkflowInHeader:null==e?void 0:e.hideWorkflowInHeader,hideSettingsInHeader:null==e?void 0:e.hideSettingsInHeader,showAppIconInHeader:null==e?void 0:e.showAppIconInHeader,useNeutralColorInHeader:null==e?void 0:e.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==e?void 0:e.openLinksInNewWindow,contentAssemblyMode:null==e?void 0:e.contentAssemblyMode}},K=g.createApplication(G),z={hostSessionId:d},$=K.createSession(z);s&&s(K,R,h,$),r&&r();var V={appUrl:U,file:(0,n.pi)({name:R.fileName,getUrl:(null===(M=R.wac)||void 0===M?void 0:M.fileGetUrl)||R.downloadUrl,size:R.fileSize,eTag:R.eTag},h.docId&&{uniqueId:h.docId}),customFontCatalogUrl:R.wac.customFontCatalogUrl,contentBundle:{majorVersion:R.bundleVersion?Number(R.bundleVersion):0,url:null!==(D=R.bundleUrl)&&void 0!==D?D:"",staleness:R.bundleStaleness||0},newFileTemplate:h.newFileTemplate,container:c,wopi:{source:R.wac.wopiSrc,accessToken:R.wac.accessToken,expiry:parseInt(R.wac.accessTokenExpiry,10),wacToken:R.wac.wacToken},bootParams:{readOnly:R.readOnly,irmEnabled:R.irmEnabled,supportsDecryptedContentDownload:R.protectionEnabled,viewOnly:R.blocksDownload,disableChat:!0,openViewByDefault:"view"===h.intent,dataLanguage:b},diagnostics:(null===(x=null==i?void 0:i.bootDiagnostics)||void 0===x?void 0:x.legacyPerformanceData)?(0,n.pi)((0,n.pi)((0,n.pi)({},It(null===(q=null==i?void 0:i.bootDiagnostics)||void 0===q?void 0:q.legacyPerformanceData.host,null===(B=null==i?void 0:i.bootDiagnostics)||void 0===B?void 0:B.legacyPerformanceData.owlFrame)),At(A,u,_,E,t.performance,i,null==e?void 0:e.featureGates)),{legacyPerformanceData:null===(L=null==i?void 0:i.bootDiagnostics)||void 0===L?void 0:L.legacyPerformanceData}):bt(A,u,_,E,t.performance,i,null==e?void 0:e.featureGates),sessionContext:O||kt(),preseededSession:{key:R.preSeededSessionKey,id:R.preSeededWacSessionId},wdParams:(0,n.pi)((0,n.pi)((0,n.pi)({},h.templateId&&(l={},l.wdTpl=h.templateId,l)),I&&I.lcid&&(w={},w.wdlcid=I.lcid,w)||h.uiCulture&&(y={},y.wdlcid=h.uiCulture,y)),Ht(h.wdValue)),hostGeneratedSessionId:null==i?void 0:i.sessionId,meeting:null==i?void 0:i.meeting,rebootOverride:I,throttling:{protection:null===(W=R.wac)||void 0===W?void 0:W.clientThrottlingProtection,request:null===(j=R.wac)||void 0===j?void 0:j.requestedCallThrottling}};(0,v.l)(C.OwlWacBootStart),$.boot(V,a).then((function(t){var e;if("success"===t.completion)o.next({wopiHostData:R,officeApplication:K,bootedDocumentInfo:new jt(h),officeDocumentSession:$,wacBootDiagnostics:null===(e=null==$?void 0:$.diagnostics)||void 0===e?void 0:e.appInitDiagnostics}),o.complete();else if("cancelled"===t.completion)null==N||N.ULS.sendTraceTag(509646293,f.W.Xn,p.G.Info,"User cancelled document session boot");else{var n=t.completion,i={wacErrorName:m.AU.Si,qosErrorName:m.DG.QosError_EncounteredJsApiError,errorMessage:n,error:t.error},r=be(i),s=JSON.stringify(Array.from(r.entries()));null==N||N.ULS.sendTraceTag(575419404,f.W.Xn,p.G.Error,s),o.error(i)}})).catch((function(t){return null==N?void 0:N.ULS.sendTraceTag(512337547,f.W.Xn,p.G.Error,"officeDocumentSession.boot threw error: ".concat(t))}))}))}):(null==P||P.addOrUpdatePartCDimension("JsApiVersion","V1"),H=function(o){var s=o.container,a=o.flushTime;return new Gt.y((function(o){var c,u=function(t,e,n,i,o,r,s,a){return{HostName:"office.com",HostSessionId:e,UserId:t,OwnerId:void 0,UiLocale:n,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:s,DisableFocusOnBoot:!1,SessionContext:a||kt(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==o?void 0:o.hideHeader,HideAppLauncherInHeader:null==o?void 0:o.hideAppLauncherInHeader,HideSearchInHeader:null==o?void 0:o.hideSearchInHeader,HideMeInHeader:null==o?void 0:o.hideMeInHeader,HideChatInHeader:null==o?void 0:o.hideChatInHeader,HideWorkflowInHeader:null==o?void 0:o.hideWorkflowInHeader,HideSettingsInHeader:null==o?void 0:o.hideSettingsInHeader,ShowAppIconInHeader:null==o?void 0:o.showAppIconInHeader,UseNeutralColorInHeader:null==o?void 0:o.useNeutralColorInHeader,SupportsDocReboot:null==o?void 0:o.supportsDocumentReboot,SupportsCreateNewDocument:null==o?void 0:o.supportsCreateNewDocument,SupportsAuthToken:null==o?void 0:o.supportsAuthToken,SupportsAtMentions:null==o?void 0:o.supportsAtMentions,SupportsMoveToFolder:null==o?void 0:o.supportsMoveToFolder,SupportsCommonFilePicker:null==o?void 0:o.supportsCommonFilePicker,SupportsDirectPrint:null==o?void 0:o.supportsDirectPrint,SupportsDirectDownload:null==o?void 0:o.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==o?void 0:o.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==o?void 0:o.supportsExcelExternalLinks,UiHostIntegrationType:null==o?void 0:o.uiHostIntegrationType,OpenLinksInNewWindow:null==o?void 0:o.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==o?void 0:o.supportsCustomAuthConfig,ContentAssemblyMode:null==o?void 0:o.contentAssemblyMode,SupportsRefreshAccessToken:null==o?void 0:o.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout}}(R?R.wac.userId:S,d,k,b,e,i,Ht(h.wdValue),O),l=function(t,e){var i,o,r,s=t.docId,a=t.isNewFile,c=t.fileName,u=t.intent;return e?(0,n.pi)((0,n.pi)({FileName:e.fileName,FileGetUrl:(null===(i=e.wac)||void 0===i?void 0:i.fileGetUrl)||e.downloadUrl,CustomFontCatalogUrl:e.wac.customFontCatalogUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion,BundleStaleness:e.bundleStaleness},ReadOnly:e.readOnly,IrmEnabled:e.irmEnabled,ViewOnly:e.blocksDownload,ETag:e.eTag,ClientThrottlingProtection:null===(o=e.wac)||void 0===o?void 0:o.clientThrottlingProtection,RequestedCallThrottling:null===(r=e.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!a||e.isNewFile},s&&{DocUniqueId:s}),{OpenViewByDefault:"view"===u}):(0,n.pi)({FileName:c,IsNewFile:!0},s&&{DocUniqueId:s})}(h,R),w=bt(A,a,_,E,t.performance,i,null==e?void 0:e.featureGates),y=null==e?void 0:e.uiHostName,C={WopiSrc:(c=R.wac).wopiSrc,AccessToken:c.accessToken,AccessTokenExpiry:new Date(parseInt(c.accessTokenExpiry,10)),WacToken:c.wacToken},T=function(t,e,i,r,s,a,c,u,l,h,d,v,g,w,y,_,C,S,k,T){var b=e.applicationUrl,A=e.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===T&&(T={});var I={HostUIControls:S?[{id:"close",visibility:v?1:0},{id:"share",visibility:g?1:0},{id:"ellipsisOpenInBrowser",visibility:w?1:0},{id:"ellipsisDownload",visibility:y?1:0},{id:"copyLink",visibility:_?1:0},{id:"conversation",visibility:k?1:0}]:void 0,additionalApplicationParameters:T},R=Pt(d,b,l,h,C);return(0,n.pi)({BootstrapperUrl:A,Container:t,SessionInformation:r,ApplicationUrl:R,WopiPrecheckInfo:s,ApplicationCustomSettings:I,Diagnostics:a,FnOnInitializeSuccess:c,FnOnInitializeFailure:function(t){var e=t.errorObject.message,n={wacErrorName:m.AU.Ci,qosErrorName:m.DG.QosError_EncounteredJsApiError,errorName:t.errorType,errorMessage:e,error:t},i=be(n),r=JSON.stringify(Array.from(i.entries()));null==N||N.ULS.sendTraceTag(575419405,f.W.Xn,p.G.Error,r),o.error(n)},FnIsFeatureEnabled:Et(),RebootOverrideData:h.rebootOverrideData},i?{WopiInfo:i}:{})}(s,t,C,u,l,w,(function(t,e){o.next({wopiHostData:R,officeApplication:t,bootedDocumentInfo:new jt(h),wacBootDiagnostics:e}),o.complete()}),0,y,h,R,null==e?void 0:e.showCloseButton,null==e?void 0:e.supportsShare,null==e?void 0:e.openInBrowserEnabled,null==e?void 0:e.ellipsisDownloadACopyButtonEnabled,null==e?void 0:e.copyLinkEnabled,null==e?void 0:e.uiEmbed,null==e?void 0:e.supportsHostUiControls,null==e?void 0:e.conversationButtonEnabled,null==i?void 0:i.additionalApplicationParameters),I=(0,v.a)();null==N||N.ULS.sendTraceTag(576578583,f.W.Xn,p.G.Info,"BootStrapFile: About to call InitializeWopiPending");var P=g.Application.InitializeWopiPending(T,void 0,null==i?void 0:i.sessionId),H=(0,v.a)()-I;null==N||N.ULS.sendTraceTag(570775769,f.W.Xn,p.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!P,"][TimeElapsed: ").concat(H,"]"));var U=(0,v.a)();if(P){r&&r(),P.Complete(C);var M=(0,v.a)(),D=M-U,F=M-I;null==N||N.ULS.sendTraceTag(570775770,f.W.Xn,p.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(D,"][TimeElapsedSinceInitializeWopiPending: ").concat(F,"]"))}else{var x={wacErrorName:m.AU.yi,qosErrorName:m.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},q=be(x),B=JSON.stringify(Array.from(q.entries()));o.error(x),null==N||N.ULS.sendTraceTag(575419406,f.W.Xn,p.G.Error,B)}}))}),l.next(H),l.complete()}else{var M=null!=w?w:"Error message undefined. BootStrapped not loaded: ".concat(!g);null==N||N.ULS.sendTraceTag(575419403,f.W.Xn,p.G.Error,M);var D={wacErrorName:m.AU.wi,qosErrorName:m.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:M,error:w,inStaging:!1};o&&o(D)}})).catch((function(t){c(t)})),[2]}))}))}));Promise.race([q,B]).catch((function(t){var e=(null!=t?t:"Failed to load the document")+", bootstrapperUrl: ".concat(F.replace(/^https?:\/\//,"")),n={wacErrorName:m.AU.yi,qosErrorName:m.DG.QosError_FailedToLoadDocument,errorMessage:e,error:t,inStaging:!1};null==N||N.ULS.sendTraceTag(575419407,f.W.Xn,p.G.Error,"".concat(m.AU.yi,": ").concat(e)),o&&o(n)}))}({documentBootInfo:(0,n.pi)((0,n.pi)({},t),i),correlationId:d,loadFunctionSubject:_,wopiFetchData:e},o,r,s,c,u,l,null===(a=null==h?void 0:h.get(t.fileType))||void 0===a?void 0:a.jsApiUrl)})).catch((function(t){null==w||w.ULS.sendTraceTag(509723932,f.W.Xn,p.G.Error,"Failed to fetch document identifier for document with error: ".concat(t))}))})).catch((function(e){if(s){var n=JSON.stringify(e),i={wacErrorName:m.AU.gi,qosErrorName:m.DG.QosError_VroomWopiFailure,errorMessage:n,error:e,httpErrorCode:e.status,networkError:we(e)};s(i,t)}}));var S={correlationId:d,bootstrapperObservable:_.asObservable(),fileNamePromise:t.fileName?Promise.resolve(t.fileName):y.then((function(t){return t.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(t,e){y.then((function(e){var n,i;return t(null===(i=null===(n=null==e?void 0:e.wopiHostData)||void 0===n?void 0:n.wac)||void 0===i?void 0:i.applicationUrl)})).catch((function(t){e(t)}))}))};return r&&r.wiseEnvironment&&function(t,e,n,i,o,r){if(n){var s=(0,A.vJ)(A.Fh.FeatureGate_DisableEUDBBrowserULSRouting,o);t.then((function(t){if(t&&((0,A.dt)(A.Fh.FeatureGate_DisableEUDBBrowserULSRouting,s,n),!s)){var i=Te(t),o=(0,g.fy)(e,i.dataBoundary);n.flushAndSetNewEndpoint(o,(function(){null==n||n.ULS.sendTraceTag(509612803,f.W.Xn,p.G.Info,"Updated ULS endpoint. Environment: ".concat(e,", DataBoundary: ").concat(i.dataBoundary,", Region: ").concat(i.region))}))}})).catch((function(t){null==n||n.ULS.sendTraceTag(509875042,f.W.Xn,p.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(t.message))}))}if(i){var a=(0,A.vJ)(A.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,o);t.then((function(t){if(t&&((0,A.dt)(A.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,a,n),!a)){var o=Te(t),s=(0,g.S$)(e,r,o.dataBoundary);i.flushAndSetNewEndpoint(s,(function(){null==n||n.ULS.sendTraceTag(509612802,f.W.Xn,p.G.Info,"Updated Health endpoint. Environment: ".concat(e,", DataBoundary: ").concat(o.dataBoundary,", Region: ").concat(o.region))}))}})).catch((function(t){null==n||n.ULS.sendTraceTag(509875041,f.W.Xn,p.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(t.message))}))}}(S.applicationUrlPromise,r.wiseEnvironment,w,r.health,null==o?void 0:o.featureGates,r.sessionId),S}(t,e,i,o,r,s,a,c,(function(t,e,n,i){ht=t;var o=new jt(n),r=ut(e,o,i),s=r.documentRebootHandler,a=r.renameHandler,c=r.sessionRefreshInfoHandler,u=r.shareHandler,l=r.userAccessHandler,h=r.userActivityHandler,d=r.createNewHandler,f=r.getAuthTokenHandler,p=r.sendConversationIdHandler,v=r.closeTeamsConversationHandler,m=r.navigateBackToHostHandler,g=r.accessibilityLoopCompleteHandler,w=r.getClientUrlCompleteHandler,y=r.getWebUrlCompleteHandler,_=r.loadingStatusHandler,C=r.wopiInfoFromUrlHandler,S=r.davUrlFromIdsHandler,k=r.onCloseHandler,T=r.actionCompleteHandler,b=r.openInBrowserHandler,A=r.openInMobileAppHandler,I=r.moveToFolderPickerHandler,R=r.commonFilePickerHandler,E=r.getCustomAuthConfigHandler,N=r.pushStateHandler,P=r.caaeMessageHandler,H=r.frameChangedHandler,O=r.fileEmbedHandler,U=r.dismissSplashScreenHandler;rt=function(t){var e=t.data;switch(t.type){case Xe.Reboot:s(e);break;case Xe.FileRenamed:a(e);break;case Xe.UserAccessAndPermissions:l(e);break;case Xe.Share:u(e);break;case Xe.UserActivity:h(e);break;case Xe.CreateNewDocument:d(e);break;case Xe.RefreshSessionInfo:c(e);break;case Xe.GetAuthToken:f(e);break;case Xe.AccessibilityLoopCompleted:g(e);break;case Xe.GetClientUrlComplete:w(e);break;case Xe.LoadingStatus:_(e);break;case Xe.GetWebUrlComplete:y(e);break;case Xe.NavigateBackToHost:m(e);break;case Xe.SendConversationId:p(e);break;case Xe.CloseTeamsConversation:v(e);break;case Xe.GetWopiInfoFromUrl:C(e);break;case Xe.Close:k();break;case Xe.ActionCompleted:T(e);break;case Xe.OpenInBrowser:b(e);break;case Xe.OpenInMobileApp:A(e);break;case Xe.MoveToFolder:I(e);break;case Xe.SharedFilePicker:R(e);break;case Xe.GetCustomAuthConfig:E(e);break;case Xe.GetDavUrlFromIds:S(e);break;case Xe.PushState:N(e);break;case Xe.CAAEMessage:P(e);break;case Xe.FrameChanged:H(e);break;case Xe.FileEmbed:O();break;case Xe.DismissSplashScreen:U()}},ht.addEventListener(rt)}),l,h)}(a,J,c,N,l,_,!1,E,0,st,lt),ft=dt.correlationId,pt=dt.bootstrapperObservable,vt=dt.fileNamePromise,gt=dt.applicationUrlPromise;null==tt||tt.ULS.sendTraceTag(546182048,f.W.Xn,p.G.Info,"BootApp: Load document returned"),vt.then((function(t){return null==w?void 0:w(t)})).catch((function(){return"obligatory catch"}));var Ct,Rt=void 0,Ot=void 0,Ut=void 0,Mt=new mt.xQ,Dt=function(t){(0,Me.R)(Pe.KX.PostMessage_HostSendConversationId,{conversationId:t},gt,Rt,tt)};return Ot=function(t,e,n){return t.pipe(ce((function(t){return t({container:e,flushTime:n})}),void 0,1))}(pt,h,r).subscribe((function(t){var e=t.officeApplication,i=t.bootedDocumentInfo,o=t.wopiHostData,r=t.officeDocumentSession,s=t.wacBootDiagnostics;ht=e,Rt=r;var c=Xt(window,"message").pipe(pe((function(t){return!!t.data&&!!t.origin&&t.origin.endsWith(tn)})),Vt((function(t){return JSON.parse(t.data)})),pe((function(t){return!(!t||!t.MessageId)})));if(!ot){var u=ut(o,i,r),h=u.documentRebootHandler,d=u.renameHandler,m=u.sessionRefreshInfoHandler,g=u.shareHandler,w=u.userAccessHandler,_=u.userActivityHandler,S=u.createNewHandler,k=u.getAuthTokenHandler,b=u.sendConversationIdHandler,A=u.closeTeamsConversationHandler,I=u.navigateBackToHostHandler,R=u.accessibilityLoopCompleteHandler,E=u.getClientUrlCompleteHandler,O=u.getWebUrlCompleteHandler,U=u.loadingStatusHandler,M=u.wopiInfoFromUrlHandler,D=u.davUrlFromIdsHandler,F=u.onCloseHandler,x=u.actionCompleteHandler,B=u.openInBrowserHandler,L=u.moveToFolderPickerHandler,W=u.commonFilePickerHandler,j=u.getCustomAuthConfigHandler,G=u.pushStateHandler,K=u.caaeMessageHandler,z=u.fileEmbedHandler;at=[[Pe.Dm.PostMessage_SendConversationId,b],[Pe.Dm.PostMessage_CloseTeamsConversation,A],[Pe.Dm.PostMessage_NavigateBackToHost,I],[Pe.Dm.PostMessage_AccessibilityLoopComplete,R],[Pe.Dm.PostMessage_GetClientUrlComplete,E],[Pe.Dm.PostMessage_GetWebUrlComplete,O],[Pe.Dm.PostMessage_LoadingStatus,U],[Pe.E_.Event_DocumentReboot,h],[Pe.Dm.PostMessage_FileRenamed,d],[Pe.Dm.PostMessage_CheckUserAccess,w],[Pe.Dm.PostMessage_Share,g],[Pe.Dm.PostMessage_UserActivity,_],[Pe.Dm.PostMessage_AppCreateNewDocument,S],[Pe.Dm.PostMessage_OpenInBrowser,B],[Pe.E_.Event_MoveToFolder,L],[Pe.E_.Event_SharedFilePicker,W],[Pe.E_.Event_GetCustomAuthConfig,j],[Pe.Dm.PostMessage_CAAEMessage,K]],a.fileType===T.T.Excel&&(at.push([Pe.E_.Event_GetWopiInfoFromUrl,M]),at.push([Pe.E_.Event_GetDavUrlFromIds,D])),at.forEach((function(t){var i=(0,n.CR)(t,2),o=i[0],r=i[1];e.RegisterEventHandler(o,r)})),Ut=c.subscribe((function(t){switch(t.MessageId){case Pe.Dm.PostMessage_AppRefreshSessionInfo:m(t.Values);break;case Pe.Dm.PostMessage_GetAuthToken:k(t.Values);break;case Pe.Dm.PostMessage_Close:F();break;case Pe.Dm.PostMessage_ActionComplete:x(t.Values);break;case Pe.Dm.PostMessage_AppPushState:G(t.Values);break;case Pe.Dm.PostMessage_FileEmbed:z()}}))}if(y){if(null==tt||tt.ULS.sendTraceTag(546182049,f.W.Xn,p.G.Info,"BootApp: About to execute OnBootComplete"),(0,v.l)(C.OwlOnBootComplete),!P.isOwlFrame&&!P.isOwlFrameExperimentEnabled(null==N?void 0:N.featureGates,tt)){var $=function(t){var e,i=t[C.OwlStart]||t[C.OwlWithCustomFunctionsStart],o=t[C.OwlOnBootComplete];return{totalTime:o-i,owlPerformanceTimeline:(0,n.pi)((0,n.pi)({},t),((e={})[C.OwlStart]=i,e[C.OwlEnd]=o,e))}}(q("owl"));null==tt||tt.ULS.sendTraceTag(508568928,f.W.Xn,p.G.Important,H(a.fileType,l.wiseEnvironment,null==N?void 0:N.featureGates,null==N?void 0:N.uiHostName,null==N?void 0:N.uiHostIntegrationType,tt)+", OwlTraditional Telemetry Data: "+JSON.stringify($))}y(a,s)}}),(function(t){_&&(null==tt||tt.ULS.sendTraceTag(546182050,f.W.Xn,p.G.Info,"BootApp: About to execute OnBootFailure"),_(t)),null==Ot||Ot.unsubscribe(),null==Ut||Ut.unsubscribe()})),{endSession:ct,sessionEndObservable:Mt.asObservable(),hostAccessibilityLoopComplete:function(t){return(0,Me.R)(Pe.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:t?"forward":"backward"},gt,Rt,tt),!0},hostGetClientUrl:function(){(0,Me.R)(Pe.KX.PostMessage_HostGetClientUrl,{},gt,Rt,tt)},hostGetWebUrl:function(){(0,Me.R)(Pe.KX.PostMessage_HostGetWebUrl,{},gt,Rt,tt)},postFrameDiagnostics:function(t){(0,Me.R)(Pe.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:t},gt,Rt,tt)},hostBackButtonPressed:function(){return(0,Me.R)(Pe.KX.PostMessage_HostBackButtonPressed,{},gt,Rt,tt),!0},hostSendConversationId:Dt}}var an=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"];function cn(t,e,n,i,o,r,s,a,c,u,l,h,d,f,p,v){var m=new b.zP(t,n,e,c,a,u).health;return null==m||m.addQosPillar("Open"),null==m||m.updatePartADimensions({applicationLcid:i,loggableUserId:o,tenantId:r,uiHost:l,uiHostIntegrationType:h,sessionOrigin:d}),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",s),null==m||m.addOrUpdatePartCDimension("AppSessionId",t),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=f?f:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!v).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}var un=s(9435),ln=s(3079),hn=s(2685),dn=s(79);class fn{constructor(t){this.browserEnvironment="undefined"!=typeof window,this.config=(0,hn._7)(t,this.browserEnvironment),this.logger=new ln.Y(this.config.system.loggerOptions,dn.u,dn.i),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class pn extends fn{getModuleName(){return pn.MODULE_NAME}getId(){return pn.ID}async initialize(){return!1}}pn.MODULE_NAME="",pn.ID="TeamsAppOperatingContext";class vn extends fn{getModuleName(){return vn.MODULE_NAME}getId(){return vn.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}vn.MODULE_NAME="",vn.ID="StandardOperatingContext";class mn{constructor(t){this.config=t,this.logger=new ln.Y({loggerCallback:void 0,piiLoggingEnabled:!1,logLevel:void 0,correlationId:void 0},dn.u,dn.i)}async createController(){const t=new vn(this.config),e=new pn(this.config),n=[t.initialize(),e.initialize()];return Promise.all(n).then((async()=>{if(e.isAvailable()){const e=await Promise.resolve().then(s.bind(s,9140));return await e.StandardController.createController(t)}if(t.isAvailable()){const e=await Promise.resolve().then(s.bind(s,9140));return await e.StandardController.createController(t)}throw new Error("No controller found.")}))}}var gn=s(9140);class wn{static async createPublicClientApplication(t){const e=new mn(t),n=await e.createController();return new wn(t,n)}constructor(t,e){if(e)this.controller=e;else{const e=new vn(t);this.controller=new gn.StandardController(e)}}async initialize(){return this.controller.initialize()}async acquireTokenPopup(t){return this.controller.acquireTokenPopup(t)}acquireTokenRedirect(t){return this.controller.acquireTokenRedirect(t)}acquireTokenSilent(t){return this.controller.acquireTokenSilent(t)}acquireTokenByCode(t){return this.controller.acquireTokenByCode(t)}addEventCallback(t){return this.controller.addEventCallback(t)}removeEventCallback(t){return this.controller.removeEventCallback(t)}addPerformanceCallback(t){return this.controller.addPerformanceCallback(t)}removePerformanceCallback(t){return this.controller.removePerformanceCallback(t)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(t){return this.controller.getAccount(t)}getAccountByHomeId(t){return this.controller.getAccountByHomeId(t)}getAccountByLocalId(t){return this.controller.getAccountByLocalId(t)}getAccountByUsername(t){return this.controller.getAccountByUsername(t)}getAllAccounts(t){return this.controller.getAllAccounts(t)}handleRedirectPromise(t){return this.controller.handleRedirectPromise(t)}loginPopup(t){return this.controller.loginPopup(t)}loginRedirect(t){return this.controller.loginRedirect(t)}logout(t){return this.controller.logout(t)}logoutRedirect(t){return this.controller.logoutRedirect(t)}logoutPopup(t){return this.controller.logoutPopup(t)}ssoSilent(t){return this.controller.ssoSilent(t)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(t){this.controller.setLogger(t)}setActiveAccount(t){this.controller.setActiveAccount(t)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(t,e){return this.controller.initializeWrapperLibrary(t,e)}setNavigationClient(t){this.controller.setNavigationClient(t)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(t,e){return this.controller.hydrateCache(t,e)}clearCache(t){return this.controller.clearCache(t)}}var yn=s(8230);class _n{constructor(t,e,n,i,o,r,s){this.authority=e,this.libraryName=i,this.libraryVersion=o,this.applicationTelemetry=r,this.clientId=t,this.logger=n,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=s||new Set;for(const t of yn.x0)this.intFields.add(t)}startPerformanceMeasurement(t,e){return{}}getPreQueueTime(t,e){const n=this.preQueueTimeByCorrelationId.get(e);if(n){if(n.name===t)return n.time;this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${t}, unable to add queue measurement`)}else this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${e}, unable to add queue measurement`)}calculateQueuedTime(t,e){return t<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${t}`),0):e<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${e}`),0):e<t?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):e-t}addQueueMeasurement(t,e,n,i){if(!e)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${t}, cannot add queue measurement`);if(0===n)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${t} is ${n}`);else if(!n)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${t}`);const o={eventName:t,queueTime:i?0:n,manuallyCompleted:i},r=this.queueMeasurements.get(e);if(r)r.push(o),this.queueMeasurements.set(e,r);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${e} to queue measurements`);const t=[o];this.queueMeasurements.set(e,t)}this.preQueueTimeByCorrelationId.delete(e)}startMeasurement(t,e){const n=e||this.generateId();e||this.logger.info(`PerformanceClient: No correlation id provided for ${t}, generating`,n),this.logger.trace(`PerformanceClient: Performance measurement started for ${t}`,n);const i=this.startPerformanceMeasurement(t,n);i.startMeasurement();const o={Ti:this.generateId(),status:yn.$L.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:t,startTimeMs:Date.now(),correlationId:n,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};return this.cacheEventByCorrelationId(o),{end:t=>this.endMeasurement({...o,...t},i),discard:()=>this.discardMeasurements(o.correlationId),add:t=>this.addFields(t,o.correlationId),increment:t=>this.incrementFields(t,o.correlationId),measurement:i,event:o}}endMeasurement(t,e){const n=this.eventsByCorrelationId.get(t.correlationId);if(!n)return this.logger.trace(`PerformanceClient: Measurement not found for ${t.Ti}`,t.correlationId),null;const i=t.Ti===n.Ti;let o={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};i?(o=this.getQueueInfo(t.correlationId),this.discardCache(n.correlationId)):n.incompleteSubMeasurements?.delete(t.Ti),e?.endMeasurement();const r=e?.flushMeasurement();if(!r)return this.logger.trace("PerformanceClient: Performance measurement not taken",n.correlationId),null;if(this.logger.trace(`PerformanceClient: Performance measurement ended for ${t.name}: ${r} ms`,t.correlationId),!i)return n[t.name+"DurationMs"]=Math.floor(r),{...n};let s={...n,...t},a=0;return s.incompleteSubMeasurements?.forEach((e=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${e.name} found for ${t.name}`,s.correlationId),a++})),s.incompleteSubMeasurements=void 0,s={...s,durationMs:Math.round(r),queuedTimeMs:o.totalQueueTime,queuedCount:o.totalQueueCount,queuedManuallyCompletedCount:o.manuallyCompletedCount,status:yn.$L.Completed,incompleteSubsCount:a},this.truncateIntegralFields(s),this.emitEvents([s],t.correlationId),s}addFields(t,e){this.logger.trace("PerformanceClient: Updating static fields");const n=this.eventsByCorrelationId.get(e);n?this.eventsByCorrelationId.set(e,{...n,...t}):this.logger.trace("PerformanceClient: Event not found for",e)}incrementFields(t,e){this.logger.trace("PerformanceClient: Updating counters");const n=this.eventsByCorrelationId.get(e);if(n)for(const e in t){if(n.hasOwnProperty(e)){if(isNaN(Number(n[e])))return}else n[e]=0;n[e]+=t[e]}else this.logger.trace("PerformanceClient: Event not found for",e)}cacheEventByCorrelationId(t){const e=this.eventsByCorrelationId.get(t.correlationId);e?(this.logger.trace(`PerformanceClient: Performance measurement for ${t.name} added/updated`,t.correlationId),e.incompleteSubMeasurements=e.incompleteSubMeasurements||new Map,e.incompleteSubMeasurements.set(t.Ti,{name:t.name,startTimeMs:t.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${t.name} started`,t.correlationId),this.eventsByCorrelationId.set(t.correlationId,{...t}))}getQueueInfo(t){const e=this.queueMeasurements.get(t);e||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${t}`);let n=0,i=0,o=0;return e?.forEach((t=>{n+=t.queueTime,i++,o+=t.manuallyCompleted?1:0})),{totalQueueTime:n,totalQueueCount:i,manuallyCompletedCount:o}}discardMeasurements(t){this.logger.trace("PerformanceClient: Performance measurements discarded",t),this.eventsByCorrelationId.delete(t)}discardCache(t){this.discardMeasurements(t),this.logger.trace("PerformanceClient: QueueMeasurements discarded",t),this.queueMeasurements.delete(t),this.logger.trace("PerformanceClient: Pre-queue times discarded",t),this.preQueueTimeByCorrelationId.delete(t)}addPerformanceCallback(t){const e=this.generateId();return this.callbacks.set(e,t),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${e}`),e}removePerformanceCallback(t){const e=this.callbacks.delete(t);return e?this.logger.verbose(`PerformanceClient: Performance callback ${t} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${t} not removed.`),e}emitEvents(t,e){this.logger.verbose("PerformanceClient: Emitting performance events",e),this.callbacks.forEach(((n,i)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${i}`,e),n.apply(null,[t])}))}truncateIntegralFields(t){this.intFields.forEach((e=>{e in t&&"number"==typeof t[e]&&(t[e]=Math.floor(t[e]))}))}}var Cn=s(1899);class Sn{constructor(t,e){this.correlationId=e,this.measureName=Sn.makeMeasureName(t,e),this.startMark=Sn.makeStartMark(t,e),this.endMark=Sn.makeEndMark(t,e)}static makeMeasureName(t,e){return`msal.measure.${t}.${e}`}static makeStartMark(t,e){return`msal.start.${t}.${e}`}static makeEndMark(t,e){return`msal.end.${t}.${e}`}static supportsBrowserPerformance(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName}static flushMeasurements(t,e){if(Sn.supportsBrowserPerformance())try{e.forEach((e=>{const n=Sn.makeMeasureName(e.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(Sn.makeStartMark(n,t)),window.performance.clearMarks(Sn.makeEndMark(n,t)))}))}catch(t){}}startMeasurement(){if(Sn.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}}endMeasurement(){if(Sn.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}}flushMeasurement(){if(Sn.supportsBrowserPerformance())try{const t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){const e=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),e}}catch(t){}return null}}class kn extends _n{constructor(t,e){super(t.auth.clientId,t.auth.authority||`${Cn.gT.DEFAULT_AUTHORITY}`,new ln.Y(t.system?.loggerOptions||{},dn.u,dn.i),dn.u,dn.i,t.telemetry?.application||{appName:"",appVersion:""},e)}startPerformanceMeasurement(t,e){return new Sn(t,e)}generateId(){return window.crypto.randomUUID()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(t){const e=this.eventsByCorrelationId.get(t.event.correlationId),n=e&&e.Ti===t.event.Ti,i=[];n&&e?.incompleteSubMeasurements&&e.incompleteSubMeasurements.forEach((t=>{i.push({...t})})),i.length>0&&Sn.flushMeasurements(t.event.correlationId,i)}supportsBrowserPerformanceNow(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}startMeasurement(t,e){const n=this.getPageVisibility(),i=super.startMeasurement(t,e);return{...i,end:t=>{const e=i.end({startPageVisibility:n,endPageVisibility:this.getPageVisibility(),...t});return this.deleteIncompleteSubMeasurements(i),e},discard:()=>{i.discard(),this.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}}}setPreQueueTime(t,e){if(!this.supportsBrowserPerformanceNow())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${t}`);if(!e)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${t} not provided, unable to set telemetry queue time`);const n=this.preQueueTimeByCorrelationId.get(e);n&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${n.name} found`,e),this.addQueueMeasurement(n.name,e,void 0,!0)),this.preQueueTimeByCorrelationId.set(e,{name:t,time:window.performance.now()})}addQueueMeasurement(t,e,n,i){if(!this.supportsBrowserPerformanceNow())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${t}`);if(!e)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${t} not provided, unable to add queue measurement`);const o=super.getPreQueueTime(t,e);if(!o)return;const r=window.performance.now(),s=n||super.calculateQueuedTime(o,r);return super.addQueueMeasurement(t,e,s,i)}}var Tn=s(1120),bn="function",An="object",In="undefined",Rn="prototype",En="hasOwnProperty",Nn=Object,Pn=Nn[Rn],Hn=Nn.assign,On=Nn.create,Un=Nn.defineProperty,Mn=Pn[En],Dn=null;function Fn(t){void 0===t&&(t=!0);var e=!1===t?null:Dn;return e||(typeof globalThis!==In&&(e=globalThis),e||typeof self===In||(e=self),e||typeof window===In||(e=window),e||typeof s.g===In||(e=s.g),Dn=e),e}function xn(t){throw new TypeError(t)}function qn(t){if(On)return On(t);if(null==t)return{};var e=typeof t;function n(){}return e!==An&&e!==bn&&xn("Object prototype may only be an Object:"+t),n[Rn]=t,new n}(Fn()||{}).Symbol,(Fn()||{}).Reflect;var Bn,Ln=function(t,e){return Ln=Nn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e[En](n)&&(t[n]=e[n])},Ln(t,e)};function Wn(t,e){function n(){this.constructor=t}typeof e!==bn&&null!==e&&xn("Class extends value "+String(e)+" is not a constructor or null"),Ln(t,e),t[Rn]=null===e?qn(e):(n[Rn]=e[Rn],new n)}function jn(t,e){for(var n=0,i=e.length,o=t.length;n<i;n++,o++)t[o]=e[n];return t}var Gn,Kn="undefined",zn="constructor",$n="prototype",Vn="function",Jn="_dynInstFuncs",Qn="_isDynProxy",Xn="_dynClass",Yn="_dynInstChk",Zn=Yn,ti="_dfOpts",ei="_unknown_",ni="__proto__",ii="_dyn"+ni,oi="__dynProto$Gbl",ri="_dynInstProto",si="useBaseInst",ai="setInstFuncs",ci=Object,ui=ci.getPrototypeOf,li=ci.getOwnPropertyNames,hi=(typeof globalThis!==Kn&&(Gn=globalThis),Gn||typeof self===Kn||(Gn=self),Gn||typeof window===Kn||(Gn=window),Gn||typeof s.g===Kn||(Gn=s.g),Gn||{}),di=hi[oi]||(hi[oi]={o:(Bn={},Bn[ai]=!0,Bn[si]=!0,Bn),n:1e3});function fi(t,e){return t&&ci[$n].hasOwnProperty.call(t,e)}function pi(t){return t&&(t===ci[$n]||t===Array[$n])}function vi(t){return pi(t)||t===Function[$n]}function mi(t){var e;if(t){if(ui)return ui(t);var n=t[ni]||t[$n]||(t[zn]?t[zn][$n]:null);e=t[ii]||n,fi(t,ii)||(delete t[ri],e=t[ii]=t[ri]||t[ii],t[ri]=n)}return e}function gi(t,e){var n=[];if(li)n=li(t);else for(var i in t)"string"==typeof i&&fi(t,i)&&n.push(i);if(n&&n.length>0)for(var o=0;o<n.length;o++)e(n[o])}function wi(t,e,n){return e!==zn&&typeof t[e]===Vn&&(n||fi(t,e))}function yi(t){throw new TypeError("DynamicProto: "+t)}function _i(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}function Ci(t,e){return fi(t,$n)?t.name||e||ei:((t||{})[zn]||{}).name||e||ei}function Si(t,e,n,i){fi(t,$n)||yi("theClass is an invalid class definition.");var o=t[$n];(function(t,e){if(ui){for(var n=[],i=mi(e);i&&!vi(i)&&!_i(n,i);){if(i===t)return!0;n.push(i),i=mi(i)}return!1}return!0})(o,e)||yi("["+Ci(t)+"] not in hierarchy of ["+Ci(e)+"]");var r=null;fi(o,Xn)?r=o[Xn]:(r="_dynCls$"+Ci(t,"_")+"$"+di.n,di.n++,o[Xn]=r);var s=Si[ti],a=!!s[si];a&&i&&void 0!==i[si]&&(a=!!i[si]);var c=function(t){var e={};return gi(t,(function(n){!e[n]&&wi(t,n,!1)&&(e[n]=t[n])})),e}(e),u=function(t,e,n,i){function o(t,e,n){var o=e[n];if(o[Qn]&&i){var r=t[Jn]||{};!1!==r[Zn]&&(o=(r[e[Xn]]||{})[n]||o)}return function(){return o.apply(t,arguments)}}var r={};gi(n,(function(t){r[t]=o(e,n,t)}));for(var s=mi(t),a=[];s&&!vi(s)&&!_i(a,s);)gi(s,(function(t){!r[t]&&wi(s,t,!ui)&&(r[t]=o(e,s,t))})),a.push(s),s=mi(s);return r}(o,e,c,a);n(e,u);var l=!!ui&&!!s[ai];l&&i&&(l=!!i[ai]),function(t,e,n,i,o){if(!pi(t)){var r=n[Jn]=n[Jn]||{},s=r[e]=r[e]||{};!1!==r[Zn]&&(r[Zn]=!!o),gi(n,(function(e){wi(n,e,!1)&&n[e]!==i[e]&&(s[e]=n[e],delete n[e],(!fi(t,e)||t[e]&&!t[e][Qn])&&(t[e]=function(t,e){var n=function(){var i=function(t,e,n,i){var o=null;if(t&&fi(n,Xn)){var r=t[Jn]||{};if((o=(r[n[Xn]]||{})[e])||yi("Missing ["+e+"] "+Vn),!o[Yn]&&!1!==r[Zn]){for(var s=!fi(t,e),a=mi(t),c=[];s&&a&&!vi(a)&&!_i(c,a);){var u=a[e];if(u){s=u===i;break}c.push(a),a=mi(a)}try{s&&(t[e]=o),o[Yn]=1}catch(t){r[Zn]=!1}}}return o}(this,e,t,n)||function(t,e,n){var i=e[t];return i===n&&(i=mi(e)[t]),typeof i!==Vn&&yi("["+t+"] is not a "+Vn),i}(e,t,n);return i.apply(this,arguments)};return n[Qn]=1,n}(t,e)))}))}}(o,r,e,c,!1!==l)}Si[ti]=di.o;var ki="initialize",Ti="name",bi="getNotifyMgr",Ai="identifier",Ii="push",Ri="isInitialized",Ei="config",Ni="instrumentationKey",Pi="logger",Hi="length",Oi="time",Ui="processNext",Mi="getProcessTelContext",Di="addNotificationListener",Fi="removeNotificationListener",xi="stopPollingInternalLogs",qi="onComplete",Bi="getPlugin",Li="flush",Wi="_extensions",ji="splice",Gi="teardown",Ki="messageId",zi="message",$i="isAsync",Vi="_doTeardown",Ji="update",Qi="getNext",Xi="diagLog",Yi="setNextPlugin",Zi="createNew",to="cookieCfg",eo="indexOf",no="substring",io="userAgent",oo="split",ro="setEnabled",so="substr",ao="nodeType",co="apply",uo="replace",lo="enableDebugExceptions",ho="toLowerCase",fo="call",po="type",vo="handler",mo="listeners",go="isChildEvt",wo="getCtx",yo="setCtx",_o="complete",Co="traceId",So="spanId",ko="traceFlags",To="",bo="channels",Ao="core",Io="createPerfMgr",Ro="disabled",Eo="extensionConfig",No="processTelemetry",Po="priority",Ho="eventsSent",Oo="eventsDiscarded",Uo="eventsSendRequest",Mo="perfEvent",Do="errorToConsole",Fo="warnToConsole",xo="getPerfMgr",qo="toISOString",Bo="endsWith",Lo="startsWith",Wo="indexOf",jo="trim",Go="toString",Ko="__proto__",zo="constructor",$o=Un,Vo=Nn.freeze,Jo=(Nn.seal,Nn.keys),Qo=String[Rn],Xo=Qo[jo],Yo=Qo[Bo],Zo=Qo[Lo],tr=Date[Rn][qo],er=Array.isArray,nr=Pn[Go],ir=Mn[Go],or=ir[fo](Nn),rr=/-([a-z])/g,sr=/([^\w\d_$])/g,ar=/^(\d+[\w\d_$])/,cr=Object.getPrototypeOf;function ur(t){return void 0===t||typeof t===In}function lr(t){return null===t||ur(t)}function hr(t){return!lr(t)}function dr(t){return!(!t||typeof t!==An)}function fr(t){return!(!t||typeof t!==bn)}function pr(t){var e=t;return e&&yr(e)&&(e=(e=(e=e[uo](rr,(function(t,e){return e.toUpperCase()})))[uo](sr,"_"))[uo](ar,(function(t,e){return"_"+e}))),e}function vr(t,e){if(t)for(var n in t)Mn[fo](t,n)&&e[fo](t,n,t[n])}function mr(t,e){var n=!1;return t&&e&&!(n=t===e)&&(n=Zo?t[Lo](e):function(t,e){var n=!1,i=e?e[Hi]:0;if(t&&i&&t[Hi]>=i&&!(n=t===e)){for(var o=0;o<i;o++)if(t[o]!==e[o])return!1;n=!0}return n}(t,e)),n}function gr(t,e){return!(!t||!e)&&-1!==t[eo](e)}var wr=er||function(t){return!(!t||"[object Array]"!==nr[fo](t))};function yr(t){return"string"==typeof t}function _r(t){return"number"==typeof t}function Cr(t){return"boolean"==typeof t}function Sr(t){var e=!1;if(t&&"object"==typeof t){var n=cr?cr(t):function(t){if(t){if(cr)return cr(t);var e=t[Ko]||t[Rn]||t[zo];if(e)return e}return null}(t);n?(n[zo]&&Mn[fo](n,zo)&&(n=n[zo]),e=typeof n===bn&&ir[fo](n)===or):e=!0}return e}function kr(t){if(t)return tr?t[qo]():function(t){if(t&&t.getUTCFullYear){var e=function(t){var e=String(t);return 1===e[Hi]&&(e="0"+e),e};return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(t)}function Tr(t,e,n){var i=t[Hi];try{for(var o=0;o<i&&(!(o in t)||-1!==e[fo](n||t,t[o],o,t));o++);}catch(t){}}function br(t,e,n){if(t){if(t[Wo])return t[Wo](e,n);var i=t[Hi],o=n||0;try{for(var r=Math.max(o>=0?o:i-Math.abs(o),0);r<i;r++)if(r in t&&t[r]===e)return r}catch(t){}}return-1}function Ar(t){return t&&(t=Xo&&t[jo]?t[jo]():t[uo]?t[uo](/^\s+|(?=\s)\s+$/g,To):t),t}var Ir=!{toString:null}.propertyIsEnumerable("toString"),Rr=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Er(t){var e=typeof t;if(e===bn||e===An&&null!==t||xn("objKeys called on non-object"),!Ir&&Jo)return Jo(t);var n=[];for(var i in t)t&&Mn[fo](t,i)&&n[Ii](i);if(Ir)for(var o=Rr[Hi],r=0;r<o;r++)t&&Mn[fo](t,Rr[r])&&n[Ii](Rr[r]);return n}function Nr(t,e,n,i){if($o)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),i&&(o.set=i),$o(t,e,o),!0}catch(t){}return!1}function Pr(t){return Vo&&vr(t,(function(t,e){(wr(e)||dr(e))&&Vo(e)})),Hr(t)}var Hr=Vo||function(t){return t};function Or(){var t=Date;return t.now?t.now():(new t).getTime()}function Ur(t){return(e=t)&&"[object Error]"===nr[fo](e)?t[Ti]:To;var e}function Mr(t,e,n,i,o){var r=n;return t&&((r=t[e])===n||o&&!o(r)||i&&!i(n)||(r=n,t[e]=r)),r}function Dr(t,e,n){var i;return t?!(i=t[e])&&lr(i)&&(i=ur(n)?{}:n,t[e]=i):i=ur(n)?{}:n,i}function Fr(t,e){return lr(t)?e:t}function xr(t){return!!t}function qr(t){throw new Error(t)}function Br(t,e,n,i,o){t&&e&&n&&(!1!==o||ur(t[e]))&&(t[e]=function(t,e){var n=null,i=null;return fr(t)?n=t:i=t,function(){var t=arguments;if(n&&(i=n()),i)return i[e][co](i,t)}}(n,i))}function Lr(t){return t&&Hn&&(t=Nn(Hn({},t))),t}function Wr(t,e,n,i,o,r){var s=arguments,a=s[0]||{},c=s[Hi],u=!1,l=1;for(c>0&&Cr(a)&&(u=a,a=s[l]||{},l++),dr(a)||(a={});l<c;l++){var h=s[l],d=wr(h),f=dr(h);for(var p in h)if(d&&p in h||f&&Mn[fo](h,p)){var v=h[p],m=void 0;if(u&&v&&((m=wr(v))||Sr(v))){var g=a[p];m?wr(g)||(g=[]):Sr(g)||(g={}),v=Wr(u,g,v)}void 0!==v&&(a[p]=v)}}return a}var jr="ctx",Gr="ParentContextKey",Kr="ChildrenContextKey",zr=function(){function t(e,n,i){var o,r=this,s=!1;r.start=Or(),r[Ti]=e,r[$i]=i,r[go]=function(){return!1},fr(n)&&(s=Nr(r,"payload",(function(){return!o&&fr(n)&&(o=n(),n=null),o}))),r[wo]=function(e){return e?e===t[Gr]||e===t[Kr]?r[e]:(r[jr]||{})[e]:null},r[yo]=function(e,n){e&&(e===t[Gr]?(r[e]||(r[go]=function(){return!0}),r[e]=n):e===t[Kr]?r[e]=n:(r[jr]=r[jr]||{})[e]=n)},r[_o]=function(){var e=0,i=r[wo](t[Kr]);if(wr(i))for(var o=0;o<i[Hi];o++){var a=i[o];a&&(e+=a[Oi])}r[Oi]=Or()-r.start,r.exTime=r[Oi]-e,r[_o]=function(){},!s&&fr(n)&&(r.payload=n())}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),$r=function(){function t(e){this.ctx={},Si(t,this,(function(t){t.create=function(t,e,n){return new zr(t,e,n)},t.fire=function(t){t&&(t[_o](),e&&fr(e[Mo])&&e[Mo](t))},t[yo]=function(e,n){e&&((t[jr]=t[jr]||{})[e]=n)},t[wo]=function(e){return(t[jr]||{})[e]}}))}return t.__ieDyn=1,t}(),Vr="CoreUtils.doPerf";function Jr(t,e,n,i,o){if(t){var r=t;if(r[xo]&&(r=r[xo]()),r){var s=void 0,a=r[wo](Vr);try{if(s=r.create(e(),i,o)){if(a&&s[yo]&&(s[yo](zr[Gr],a),a[wo]&&a[yo])){var c=a[wo](zr[Kr]);c||(c=[],a[yo](zr[Kr],c)),c[Ii](s)}return r[yo](Vr,s),n(s)}}catch(t){s&&s[yo]&&s[yo]("exception",t)}finally{s&&r.fire(s),r[yo](Vr,a)}}}return n()}var Qr="window",Xr="document",Yr="navigator",Zr="location",ts="JSON",es="crypto",ns="msCrypto",is="msie",os="trident/",rs="XMLHttpRequest",ss=null,as=null,cs=!1,us=null,ls=null;function hs(t,e){var n=!1;if(t){try{if(!(n=e in t)){var i=t[Rn];i&&(n=e in i)}}catch(t){}if(!n)try{n=!ur((new t)[e])}catch(t){}}return n}function ds(t){var e=Fn();return e&&e[t]?e[t]:t===Qr&&fs()?window:null}function fs(){return Boolean(typeof window===An&&window)}function ps(){return fs()?window:ds(Qr)}function vs(){return Boolean(typeof document===An&&document)}function ms(){return vs()?document:ds(Xr)}function gs(){return Boolean(typeof navigator===An&&navigator)}function ws(){return gs()?navigator:ds(Yr)}function ys(t){if(t&&cs){var e=ds("__mockLocation");if(e)return e}return typeof location===An&&location?location:ds(Zr)}function _s(){return Boolean(typeof JSON===An&&JSON||null!==ds(ts))}function Cs(){return _s()?JSON||ds(ts):null}function Ss(){var t=ws();return!(!t||!t.product)&&"ReactNative"===t.product}function ks(){var t=ws();if(t&&(t[io]!==as||null===ss)){var e=((as=t[io])||To)[ho]();ss=gr(e,is)||gr(e,os)}return ss}function Ts(t){var e=Object[Rn].toString[fo](t),n=To;return"[object Error]"===e?n="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t[Ti]+"'":_s()&&(n=Cs().stringify(t)),e+n}function bs(){return null===ls&&(ls=gs()&&Boolean(ws().sendBeacon)),ls}function As(t){var e=!1;try{e=!!ds("fetch");var n=ds("Request");e&&t&&n&&(e=hs(n,"keepalive"))}catch(t){}return e}function Is(){var t=!1;try{t=!!ds(rs)}catch(t){}return t}var Rs,Es=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ns=null;function Ps(t,e){return function(){var n=arguments,i=Hs(e);if(i){var o=i.listener;o&&o[t]&&o[t][co](o,n)}}}function Hs(t){var e,n=Ns;return n||!0===t.disableDbgExt||(n=Ns||((e=ds("Microsoft"))&&(Ns=e.ApplicationInsights),Ns)),n?n.ChromeDbgExt:null}function Os(t){if(!Rs){Rs={};for(var e=0;e<Es[Hi];e++)Rs[Es[e]]=Ps(Es[e],t)}return Rs}function Us(t){return t?'"'+t[uo](/\"/g,To)+'"':To}function Ms(t,e){var n=typeof console!==In?console:ds("console");if(n){var i="log";n[t]&&(i=t),fr(n[i])&&n[i](e)}}var Ds=function(){function t(t,e,n,i){void 0===n&&(n=!1);var o=this;o[Ki]=t,o[zi]=(n?"AI: ":"AI (Internal): ")+t;var r=To;_s()&&(r=Cs().stringify(i));var s=(e?" message:"+Us(e):To)+(i?" props:"+Us(r):To);o[zi]+=s}return t.dataType="MessageData",t}();function Fs(t,e){return(t||{})[Pi]||new xs(e)}var xs=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var n,i,o,r,s=0,a={};Si(t,this,(function(t){function c(e,n){if(!(s>=o)){var r=!0,c="AITR_"+n[Ki];if(a[c]?r=!1:a[c]=!0,r&&(e<=i&&(t.queue[Ii](n),s++,u(1===e?"error":"warn",n)),s===o)){var l="Internal events throttle limit per PageView reached for this app.",h=new Ds(23,l,!1);t.queue[Ii](h),1===e?t[Do](l):t[Fo](l)}}}function u(t,n){var i=Hs(e||{});i&&i[Xi]&&i[Xi](t,n)}!function(t){n=Fr(t.loggingLevelConsole,0),i=Fr(t.loggingLevelTelemetry,1),o=Fr(t.maxMessageLimit,25),r=Fr(t.enableDebug,Fr(t[lo],!1))}(e||{}),t.consoleLoggingLevel=function(){return n},t.telemetryLoggingLevel=function(){return i},t.maxInternalMessageLimit=function(){return o},t[lo]=function(){return r},t.throwInternal=function(e,i,o,s,l){void 0===l&&(l=!1);var h=new Ds(i,o,l,s);if(r)throw Ts(h);var d=1===e?Do:Fo;if(ur(h[zi]))u("throw"+(1===e?"Critical":"Warning"),h);else{if(l){var f=+h[Ki];!a[f]&&n>=e&&(t[d](h[zi]),a[f]=!0)}else n>=e&&t[d](h[zi]);c(e,h)}},t[Fo]=function(t){Ms("warn",t),u("warning",t)},t[Do]=function(t){Ms("error",t),u("error",t)},t.resetInternalMessageCount=function(){s=0,a={}},t.logInternalMessage=c}))}return t.__ieDyn=1,t}();function qs(t){return t||new xs}function Bs(t,e,n,i,o,r){void 0===r&&(r=!1),qs(t).throwInternal(e,n,i,o,r)}function Ls(t,e){qs(t)[Fo](e)}var Ws=4294967296,js=4294967295,Gs=!1,Ks=123456789,zs=987654321;function $s(t){var e=0,n=ds(es)||ds(ns);return n&&n.getRandomValues&&(e=n.getRandomValues(new Uint32Array(1))[0]&js),0===e&&ks()&&(Gs||function(){try{var t=2147483647&Or();(e=(Math.random()*Ws^t)+t)<0&&(e>>>=0),Ks=123456789+e&js,zs=987654321-e&js,Gs=!0}catch(t){}var e}(),e=function(t){var e=((zs=36969*(65535&zs)+(zs>>16)&js)<<16)+(65535&(Ks=18e3*(65535&Ks)+(Ks>>16)&js))>>>0&js|0;return e>>>=0}()&js),0===e&&(e=Math.floor(Ws*Math.random()|0)),t||(e>>>=0),e}function Vs(t){void 0===t&&(t=22);for(var e=$s()>>>0,n=0,i=To;i[Hi]<t;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&e),e>>>=6,5===n&&(e=($s()<<2&4294967295|3&e)>>>0,n=0);return i}var Js=Un,Qs="2.8.14",Xs="."+Vs(6),Ys=0;function Zs(t){return 1===t[ao]||9===t[ao]||!+t[ao]}function ta(t,e){return void 0===e&&(e=!1),pr(t+Ys+++(e?"."+Qs:To)+Xs)}function ea(t){var e={id:ta("_aiData-"+(t||To)+"."+Qs),accept:function(t){return Zs(t)},get:function(t,n,i,o){var r=t[e.id];return r?r[pr(n)]:(o&&((r=function(t,e){var n=e[t.id];if(!n){n={};try{Zs(e)&&(function(t,e,n){if(Js)try{return Js(t,e,{value:n,enumerable:!1,configurable:!0}),!0}catch(t){}return!1}(e,t.id,n)||(e[t.id]=n))}catch(t){}}return n}(e,t))[pr(n)]=i),i)},kill:function(t,e){if(t&&t[e])try{delete t[e]}catch(t){}}};return e}function na(t,e,n){return!(!t||t[Hi]!==e||t===n||!t.match(/^[\da-f]*$/))}function ia(t){return na(t,32,"00000000000000000000000000000000")}function oa(t){return na(t,16,"0000000000000000")}var ra=ea("plugin");function sa(t){return ra.get(t,"state",{},!0)}function aa(t,e){for(var n,i=[],o=null,r=t[Qi]();r;){var s=r[Bi]();s&&(o&&fr(o[Yi])&&fr(s[No])&&o[Yi](s),(fr(s[Ri])?s[Ri]():(n=sa(s))[Ri])||i[Ii](s),o=s,r=r[Qi]())}Tr(i,(function(i){var o=t[Ao]();i[ki](t.getCfg(),o,e,t[Qi]()),n=sa(i),i[Ao]||n[Ao]||(n[Ao]=o),n[Ri]=!0,delete n[Gi]}))}function ca(t){return t.sort((function(t,e){var n=0;if(e){var i=fr(e[No]);fr(t[No])?n=i?t[Po]-e[Po]:1:i&&(n=-1)}else n=t?1:-1;return n}))}var ua="TelemetryPluginChain",la="_hasRun",ha="_getTelCtx",da=0;function fa(t,e,n,i){var o=null,r=[];null!==i&&(o=i?function(t,e,n){for(;t;){if(t[Bi]()===n)return t;t=t[Qi]()}return ga([n],e[Ei]||{},e)}(t,n,i):t);var s={$:function(){var t=o;if(o=t?t[Qi]():null,!t){var e=r;e&&e[Hi]>0&&(Tr(e,(function(t){try{t.func[fo](t.self,t.args)}catch(t){Bs(n[Pi],2,73,"Unexpected Exception during onComplete - "+Ts(t))}})),r=[])}return t},ctx:{core:function(){return n},diagLog:function(){return Fs(n,e)},getCfg:function(){return e},getExtCfg:a,getConfig:function(t,n,i){void 0===i&&(i=!1);var o,r=a(t,null);return r&&!lr(r[n])?o=r[n]:e&&!lr(e[n])&&(o=e[n]),lr(o)?i:o},hasNext:function(){return!!o},getNext:function(){return o},setNext:function(t){o=t},iterate:function(t){for(var e;e=s.$();){var n=e[Bi]();n&&t(n)}},onComplete:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&r[Ii]({func:t,self:ur(e)?s.ctx:e,args:n})}}};function a(t,n,i){var o;if(void 0===n&&(n={}),void 0===i&&(i=0),e){var r=e[Eo];r&&t&&(o=r[t])}if(o){if(dr(n)&&0!==i){var s=Wr(!0,n,o);e&&2===i&&vr(n,(function(t){if(lr(s[t])){var n=e[t];lr(n)||(s[t]=n)}})),o=s}}else o=n;return o}return s}function pa(t,e,n,i){var o=fa(t,e,n,i),r=o.ctx;return r[Ui]=function(t){var e=o.$();return e&&e[No](t,r),!e},r[Zi]=function(t,i){return void 0===t&&(t=null),wr(t)&&(t=ga(t,e,n,i)),pa(t||r[Qi](),e,n,i)},r}function va(t,e,n){var i=e[Ei]||{},o=fa(t,i,e,n),r=o.ctx;return r[Ui]=function(t){var e=o.$();return e&&e.unload(r,t),!e},r[Zi]=function(t,n){return void 0===t&&(t=null),wr(t)&&(t=ga(t,i,e,n)),va(t||r[Qi](),e,n)},r}function ma(t,e,n){var i=e[Ei]||{},o=fa(t,i,e,n).ctx;return o[Ui]=function(t){return o.iterate((function(e){fr(e[Ji])&&e[Ji](o,t)}))},o[Zi]=function(t,n){return void 0===t&&(t=null),wr(t)&&(t=ga(t,i,e,n)),ma(t||o[Qi](),e,n)},o}function ga(t,e,n,i){var o=null,r=!i;if(wr(t)&&t[Hi]>0){var s=null;Tr(t,(function(t){if(r||i!==t||(r=!0),r&&t&&fr(t[No])){var a=function(t,e,n){var i,o=null,r=fr(t[No]),s=fr(t[Yi]),a={getPlugin:function(){return t},getNext:function(){return o},processTelemetry:function(i,u){c(u=u||function(){var i;return t&&fr(t[ha])&&(i=t[ha]()),i||(i=pa(a,e,n)),i}(),(function(e){if(!t||!r)return!1;var n=sa(t);return!n[Gi]&&!n[Ro]&&(s&&t[Yi](o),t[No](i,e),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||u[Ui](i)},unload:function(e,n){c(e,(function(){var i=!1;if(t){var o=sa(t),r=t[Ao]||o[Ao];!t||r&&r!==e.core()||o[Gi]||(o[Ao]=null,o[Gi]=!0,o[Ri]=!1,t[Gi]&&!0===t[Gi](e,n)&&(i=!0))}return i}),"unload",(function(){}),n[$i])||e[Ui](n)},update:function(e,n){c(e,(function(){var i=!1;if(t){var o=sa(t),r=t[Ao]||o[Ao];!t||r&&r!==e.core()||o[Gi]||t[Ji]&&!0===t[Ji](e,n)&&(i=!0)}return i}),"update",(function(){}),!1)||e[Ui](n)},_a:i=t?t[Ai]+"-"+t[Po]+"-"+da++:"Unknown-0-"+da++,Ca:function(t){o=t}};function c(e,n,r,s,a){var c=!1,u=t?t[Ai]:ua,l=e[la];return l||(l=e[la]={}),e.setNext(o),t&&Jr(e[Ao](),(function(){return u+":"+r}),(function(){l[i]=!0;try{var t=o?o._a:To;t&&(l[t]=!1),c=n(e)}catch(t){var s=!o||l[o._a];s&&(c=!0),o&&s||Bs(e[Xi](),1,73,"Plugin ["+u+"] failed during "+r+" - "+Ts(t)+", run flags: "+Ts(l))}}),s,a),c}return Hr(a)}(t,e,n);o||(o=a),s&&s.Ca(a),s=a}}))}return i&&!o?ga([i],e,n):o}function wa(t,e,n){e&&wr(e)&&e[Hi]>0&&(Tr(e=e.sort((function(t,e){return t[Po]-e[Po]})),(function(t){t[Po]<500&&qr("Channel has invalid priority - "+t[Ai])})),t[Ii]({queue:Hr(e),chain:ga(e,n[Ei],n)}))}var ya="toGMTString",_a="toUTCString",Ca="cookie",Sa="expires",ka="enabled",Ta="isCookieUseDisabled",ba="disableCookiesUsage",Aa="_ckMgr",Ia=null,Ra=null,Ea=null,Na=ms(),Pa={},Ha={};function Oa(t){return!t||t.isEnabled()}function Ua(t,e){return!!(e&&t&&wr(t.ignoreCookies))&&-1!==t.ignoreCookies[eo](e)}function Ma(t,e){var n;if(t)n=t.getCookieMgr();else if(e){var i=e[to];n=i[Aa]?i[Aa]:Da(e)}return n||(n=function(t,e){var n=Da[Aa]||Ha[Aa];return n||(n=Da[Aa]=Da(t,e),Ha[Aa]=n),n}(e,(t||{})[Pi])),n}function Da(t,e){var n,i=function(t){var e=t[to]=t[to]||{};if(Mr(e,"domain",t.cookieDomain,hr,lr),Mr(e,"path",t.cookiePath||"/",null,lr),lr(e[ka])){var n=void 0;ur(t[Ta])||(n=!t[Ta]),ur(t[ba])||(n=!t[ba]),e[ka]=n}return e}(t||Ha),o=i.path||"/",r=i.domain,s=!1!==i[ka],a=((n={isEnabled:function(){var t=s&&Fa(e),n=Ha[Aa];return t&&n&&a!==n&&(t=Oa(n)),t}})[ro]=function(t){s=!1!==t},n.set=function(t,e,n,s,c){var u=!1;if(Oa(a)&&!function(t,e){return!!(e&&t&&wr(t.blockedCookies)&&-1!==t.blockedCookies[eo](e))||Ua(t,e)}(i,t)){var l={},h=Ar(e||To),d=h[eo](";");if(-1!==d&&(h=Ar(e[no](0,d)),l=xa(e[no](d+1))),Mr(l,"domain",s||r,xr,ur),!lr(n)){var f=ks();if(ur(l[Sa])){var p=Or()+1e3*n;if(p>0){var v=new Date;v.setTime(p),Mr(l,Sa,qa(v,f?ya:_a)||qa(v,f?ya:_a)||To,xr)}}f||Mr(l,"max-age",To+n,null,ur)}var m=ys();m&&"https:"===m.protocol&&(Mr(l,"secure",null,null,ur),null===Ra&&(Ra=!function(t){return!(!yr(t)||!gr(t,"CPU iPhone OS 12")&&!gr(t,"iPad; CPU OS 12")&&!(gr(t,"Macintosh; Intel Mac OS X 10_14")&&gr(t,"Version/")&&gr(t,"Safari"))&&(!gr(t,"Macintosh; Intel Mac OS X 10_14")||!function(t,e){var n=!1;return t&&e&&!(n=t===e)&&(n=Yo?t[Bo](e):function(t,e){var n=!1,i=e?e[Hi]:0,o=t?t[Hi]:0;if(i&&o&&o>=i&&!(n=t===e)){for(var r=o-1,s=i-1;s>=0;s--){if(t[r]!=e[s])return!1;r--}n=!0}return n}(t,e)),n}(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!gr(t,"Chrome/5")&&!gr(t,"Chrome/6")&&(!gr(t,"UnrealEngine")||gr(t,"Chrome"))&&!gr(t,"UCBrowser/12")&&!gr(t,"UCBrowser/11"))}((ws()||{})[io])),Ra&&Mr(l,"SameSite","None",null,ur)),Mr(l,"path",c||o,null,ur),(i.setCookie||Wa)(t,Ba(h,l)),u=!0}return u},n.get=function(t){var e=To;return Oa(a)&&!Ua(i,t)&&(e=(i.getCookie||La)(t)),e},n.del=function(t,e){var n=!1;return Oa(a)&&(n=a.purge(t,e)),n},n.purge=function(t,n){var o,r=!1;if(Fa(e)){var s=((o={}).path=n||"/",o[Sa]="Thu, 01 Jan 1970 00:00:01 GMT",o);ks()||(s["max-age"]="0"),(i.delCookie||Wa)(t,Ba(To,s)),r=!0}return r},n);return a[Aa]=a,a}function Fa(t){if(null===Ia){Ia=!1;try{Ia=void 0!==(Na||{})[Ca]}catch(e){Bs(t,2,68,"Cannot access document.cookie - "+Ur(e),{exception:Ts(e)})}}return Ia}function xa(t){var e={};return t&&t[Hi]&&Tr(Ar(t)[oo](";"),(function(t){if(t=Ar(t||To)){var n=t[eo]("=");-1===n?e[t]=null:e[Ar(t[no](0,n))]=Ar(t[no](n+1))}})),e}function qa(t,e){return fr(t[e])?t[e]():null}function Ba(t,e){var n=t||To;return vr(e,(function(t,e){n+="; "+t+(lr(e)?To:"="+e)})),n}function La(t){var e=To;if(Na){var n=Na[Ca]||To;Ea!==n&&(Pa=xa(n),Ea=n),e=Ar(Pa[t]||To)}return e}function Wa(t,e){Na&&(Na[Ca]=t+"="+e)}function ja(){var t=[];return{add:function(e){e&&t[Ii](e)},run:function(e,n){Tr(t,(function(t){try{t(e,n)}catch(t){Bs(e[Xi](),2,73,"Unexpected error calling unload handler - "+Ts(t))}})),t=[]}}}var Ga="getPlugin",Ka=function(){function t(){var e,n,i,o,r,s=this;function a(t){void 0===t&&(t=null);var e=t;if(!e){var o=n||pa(null,{},s[Ao]);e=i&&i[Ga]?o[Zi](null,i[Ga]):o[Zi](null,i)}return e}function c(t,e,o){t&&Mr(t,Eo,[],null,lr),!o&&e&&(o=e[Mi]()[Qi]());var r=i;i&&i[Ga]&&(r=i[Ga]()),s[Ao]=e,n=pa(o,t,e,r)}function u(){e=!1,s[Ao]=null,n=null,i=null,r=[],o=ja()}u(),Si(t,s,(function(t){t[ki]=function(t,n,i,o){c(t,n,o),e=!0},t[Gi]=function(e,n){var s,a=t[Ao];if(a&&(!e||a===e[Ao]())){var c,l=!1,h=e||va(null,a,i&&i[Ga]?i[Ga]():i),d=n||((s={reason:0})[$i]=!1,s);return t[Vi]&&!0===t[Vi](h,d,f)?c=!0:f(),c}function f(){if(!l){l=!0,o.run(h,n);var t=r;r=[],Tr(t,(function(t){t.rm()})),!0===c&&h[Ui](d),u()}}},t[Ji]=function(e,n){var o=t[Ao];if(o&&(!e||o===e[Ao]())){var r,s=!1,a=e||ma(null,o,i&&i[Ga]?i[Ga]():i),u=n||{reason:0};return t.Sa&&!0===t.Sa(a,u,l)?r=!0:l(),r}function l(){s||(s=!0,c(a.getCfg(),a.core(),a[Qi]()))}},t.ka=function(t){t&&(wr(t)?r=r.concat(t):r[Ii](t))},Br(t,"_addUnloadCb",(function(){return o}),"add")})),s[Xi]=function(t){return a(t)[Xi]()},s[Ri]=function(){return e},s.setInitialized=function(t){e=t},s[Yi]=function(t){i=t},s[Ui]=function(t,e){e?e[Ui](t):i&&fr(i[No])&&i[No](t,null)},s.Ta=a}return t.__ieDyn=1,t}(),za=function(t){function e(){var n,i,o=t.call(this)||this;function r(){n=0,i=[]}return o.identifier="TelemetryInitializerPlugin",o.priority=199,r(),Si(e,o,(function(t,e){t.addTelemetryInitializer=function(t){var e={id:n++,fn:t};return i[Ii](e),{remove:function(){Tr(i,(function(t,n){if(t.id===e.id)return i[ji](n,1),-1}))}}},t[No]=function(e,n){for(var o=!1,r=i[Hi],s=0;s<r;++s){var a=i[s];if(a)try{if(!1===a.fn[co](null,[e])){o=!0;break}}catch(t){Bs(n[Xi](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Ur(t),{exception:Ts(t)},!0)}}o||t[Ui](e,n)},t[Vi]=function(){r()}})),o}return Wn(e,t),e.__ieDyn=1,e}(Ka),$a="Plugins must provide initialize method",Va="_notificationManager",Ja="SDK is still unloading...",Qa={loggingLevelConsole:1};function Xa(t,e){return new $r(e)}function Ya(t,e){var n=!1;return Tr(e,(function(e){if(e===t)return n=!0,-1})),n}var Za=function(){function t(){var e,n,i,o,r,s,a,c,u,l,h,d,f,p,v,m,g,w,y,_,C=0,S=!1;Si(t,this,(function(t){function k(n){if(!C&&!S&&(n||t[Pi]&&t[Pi].queue[Hi]>0)){var i=Fr(e.diagnosticLogInterval);i&&i>0||(i=1e4),C=setInterval((function(){clearInterval(C),C=0,N()}),i)}return C}function T(){n=!1,e=Wr(!0,{},Qa),t[Ei]=e,t[Pi]=new xs(e),t[Wi]=[],v=new za,i=[],o=null,r=null,s=null,a=null,c=null,l=null,u=[],h=null,d=null,f=null,p=!1,m=null,g=ta("AIBaseCore",!0),w=ja(),_=null}function b(){var n=pa(R(),e,t);return n[qi](k),n}function A(n){var i=function(t,e,n){var i,o=[],r={};return Tr(n,(function(e){(lr(e)||lr(e[ki]))&&qr($a);var n=e[Po],i=e[Ai];e&&n&&(lr(r[n])?r[n]=i:Ls(t,"Two extensions have same priority #"+n+" - "+r[n]+", "+i)),(!n||n<500)&&o[Ii](e)})),(i={all:n})[Ao]=o,i}(t[Pi],0,u);l=i[Ao],c=null;var o=i.all;if(f=Hr(function(t,e,n){var i=[];if(t&&Tr(t,(function(t){return wa(i,t,n)})),e){var o=[];Tr(e,(function(t){t[Po]>500&&o[Ii](t)})),wa(i,o,n)}return i}(d,o,t)),h){var r=br(o,h);-1!==r&&o[ji](r,1),-1!==(r=br(l,h))&&l[ji](r,1),h.ba(f)}else h=function(t,e){function n(){return pa(null,e[Ei],e,null)}function i(t,e,n,i){var o=t?t[Hi]+1:1;function r(){0==--o&&(i&&i(),i=null)}o>0&&Tr(t,(function(t){if(t&&t.queue[Hi]>0){var i=t.chain,s=e[Zi](i);s[qi](r),n(s)}else o--})),r()}var o=!1,r={identifier:"ChannelControllerPlugin",priority:500,initialize:function(e,n,i,r){o=!0,Tr(t,(function(t){t&&t.queue[Hi]>0&&aa(pa(t.chain,e,n),i)}))},isInitialized:function(){return o},processTelemetry:function(e,o){i(t,o||n(),(function(t){t[Ui](e)}),(function(){o[Ui](e)}))},update:function(e,n){var o=n||{reason:0};return i(t,e,(function(t){t[Ui](o)}),(function(){e[Ui](o)})),!0},pause:function(){i(t,n(),(function(t){t.iterate((function(t){t.pause&&t.pause()}))}),null)},resume:function(){i(t,n(),(function(t){t.iterate((function(t){t.resume&&t.resume()}))}),null)},teardown:function(e,n){var r=n||{reason:0,isAsync:!1};return i(t,e,(function(t){t[Ui](r)}),(function(){e[Ui](r),o=!1})),!0},getChannel:function(e){var n=null;return t&&t[Hi]>0&&Tr(t,(function(t){if(t&&t.queue[Hi]>0&&(Tr(t.queue,(function(t){if(t[Ai]===e)return n=t,-1})),n))return-1})),n},flush:function(e,o,r,s){var a=1,c=!1,u=null;function l(){a--,c&&0===a&&(u&&(clearTimeout(u),u=null),o&&o(c),o=null)}return s=s||5e3,i(t,n(),(function(t){t.iterate((function(t){if(t[Li]){a++;var n=!1;t[Li](e,(function(){n=!0,l()}),r)||n||(e&&null==u?u=setTimeout((function(){u=null,l()}),s):l())}}))}),(function(){c=!0,l()})),!0},ba:function(e){t=e}};return r}(f,t);o[Ii](h),l[Ii](h),t[Wi]=ca(o),h[ki](e,t,o),aa(b(),o),t[Wi]=Hr(ca(l||[])).slice(),n&&function(e){var n=ma(R(),t);n[qi](k),t.Aa&&!0===t.Aa(n,e)||n[Ui](e)}(n)}function I(e){var n,i=null,o=null;return Tr(t[Wi],(function(t){if(t[Ai]===e&&t!==h&&t!==v)return o=t,-1})),!o&&h&&(o=h.getChannel(e)),o&&((n={plugin:o})[ro]=function(t){sa(o)[Ro]=!t},n.isEnabled=function(){var t=sa(o);return!t[Gi]&&!t[Ro]},n.remove=function(t,e){var n;void 0===t&&(t=!0);var i=[o],r=((n={reason:1})[$i]=t,n);E(i,r,(function(t){t&&A({reason:32,removed:i}),e&&e(t)}))},i=n),i}function R(){if(!c){var n=(l||[]).slice();-1===br(n,v)&&n[Ii](v),c=ga(ca(n),e,t)}return c}function E(n,i,o){if(n&&n[Hi]>0){var r=va(ga(n,e,t),t);r[qi]((function(){var t=!1,e=[];Tr(u,(function(i,o){Ya(i,n)?t=!0:e[Ii](i)})),u=e;var i=[];d&&(Tr(d,(function(e,o){var r=[];Tr(e,(function(e){Ya(e,n)?t=!0:r[Ii](e)})),i[Ii](r)})),d=i),o&&o(t),k()})),r[Ui](i)}else o(!1)}function N(){if(t[Pi]&&t[Pi].queue){var n=t[Pi].queue.slice(0);t[Pi].queue[Hi]=0,Tr(n,(function(n){var i,o=((i={})[Ti]=m||"InternalMessageId: "+n[Ki],i.iKey=Fr(e[Ni]),i.time=kr(new Date),i.baseType=Ds.dataType,i.baseData={message:n[zi]},i);t.track(o)}))}}function P(t,e,n,i){return h?h[Li](t,e,n||6,i):(e&&e(!1),!0)}function H(e){var n=t[Pi];n?(Bs(n,2,73,e),k()):qr(e)}var O,U,M;T(),t[Ri]=function(){return n},t[ki]=function(i,r,a,c){var l,h;p&&qr(Ja),t[Ri]()&&qr("Core should not be initialized more than once"),e=i||{},t[Ei]=e,lr(i[Ni])&&qr("Please provide instrumentation key"),o=c,t[Va]=c,!0===(h=Fr(e.disableDbgExt))&&y&&(o[Fi](y),y=null),o&&!y&&!0!==h&&(y=Os(e),o[Di](y)),!(l=Fr(e.enablePerfMgr))&&s&&(s=null),l&&Dr(e,Io,Xa),Dr(e,Eo,{}).NotificationManager=o,a&&(t[Pi]=a);var v=Dr(e,"extensions",[]);(u=[])[Ii].apply(u,jn(jn([],r),v)),d=Dr(e,bo,[]),A(null),f&&0!==f[Hi]||qr("No "+bo+" available"),n=!0,t.releaseQueue()},t.getTransmissionControls=function(){var t=[];return f&&Tr(f,(function(e){t[Ii](e.queue)})),Hr(t)},t.track=function(n){n.iKey=n.iKey||e[Ni],n[Oi]=n[Oi]||kr(new Date),n.ver=n.ver||"4.0",!p&&t[Ri]()?b()[Ui](n):i[Ii](n)},t[Mi]=b,t[bi]=function(){return o||(o=function(){var t;return qn(((t={})[Di]=function(t){},t[Fi]=function(t){},t[Ho]=function(t){},t[Oo]=function(t,e){},t[Uo]=function(t,e){},t))}(),t[Va]=o),o},t[Di]=function(t){o&&o[Di](t)},t[Fi]=function(t){o&&o[Fi](t)},t.getCookieMgr=function(){return a||(a=Da(e,t[Pi])),a},t.setCookieMgr=function(t){a=t},t[xo]=function(){if(!r&&!s&&Fr(e.enablePerfMgr)){var n=Fr(e[Io]);fr(n)&&(s=n(t,t[bi]()))}return r||s||null},t.setPerfMgr=function(t){r=t},t.eventCnt=function(){return i[Hi]},t.releaseQueue=function(){if(n&&i[Hi]>0){var t=i;i=[],Tr(t,(function(t){b()[Ui](t)}))}},t.pollInternalLogs=function(t){return m=t||null,S=!1,C&&(clearInterval(C),C=null),k(!0)},t[xi]=function(){S=!0,C&&(clearInterval(C),C=0,N())},U=function(){return v},M=["addTelemetryInitializer"],(O=t)&&U&&dr(O)&&wr(M)&&Tr(M,(function(t){yr(t)&&Br(O,t,U,t,undefined)})),t.unload=function(e,i,o){var r;void 0===e&&(e=!0),n||qr("SDK is not initialized"),p&&qr(Ja);var s=((r={reason:50})[$i]=e,r.flushComplete=!1,r),a=va(R(),t);function c(e){s.flushComplete=e,p=!0,w.run(a,s),t[xi](),a[Ui](s)}a[qi]((function(){T(),i&&i(s)}),t),N(),P(e,c,6,o)||c(!1)},t[Bi]=I,t.addPlugin=function(t,e,n,i){if(!t)return i&&i(!1),void H($a);var o=I(t[Ai]);if(o&&!e)return i&&i(!1),void H("Plugin ["+t[Ai]+"] is already loaded!");var r={reason:16};function s(e){u[Ii](t),r.added=[t],A(r),i&&i(!0)}if(o){var a=[o.plugin];E(a,{reason:2,isAsync:!!n},(function(t){t?(r.removed=a,r.reason|=32,s()):i&&i(!1)}))}else s()},t.evtNamespace=function(){return g},t[Li]=P,t.getTraceCtx=function(t){var e;return _||(e={},_={getName:function(){return e[Ti]},setName:function(t){e[Ti]=t},getTraceId:function(){return e[Co]},setTraceId:function(t){ia(t)&&(e[Co]=t)},getSpanId:function(){return e[So]},setSpanId:function(t){oa(t)&&(e[So]=t)},getTraceFlags:function(){return e[ko]},setTraceFlags:function(t){e[ko]=t}}),_},t.setTraceCtx=function(t){_=t||null},Br(t,"addUnloadCb",(function(){return w}),"add")}))}return t.__ieDyn=1,t}();function tc(t,e,n,i){Tr(t,(function(t){if(t&&t[e])if(n)setTimeout((function(){return i(t)}),0);else try{i(t)}catch(t){}}))}var ec,nc=function(){function t(e){this.listeners=[];var n=!!(e||{}).perfEvtsSendAll;Si(t,this,(function(t){t[Di]=function(e){t.listeners[Ii](e)},t[Fi]=function(e){for(var n=br(t[mo],e);n>-1;)t.listeners[ji](n,1),n=br(t[mo],e)},t[Ho]=function(e){tc(t[mo],Ho,!0,(function(t){t[Ho](e)}))},t[Oo]=function(e,n){tc(t[mo],Oo,!0,(function(t){t[Oo](e,n)}))},t[Uo]=function(e,n){tc(t[mo],Uo,n,(function(t){t[Uo](e,n)}))},t[Mo]=function(e){e&&(!n&&e[go]()||tc(t[mo],Mo,!1,(function(t){e[$i]?setTimeout((function(){return t[Mo](e)}),0):t[Mo](e)})))}}))}return t.__ieDyn=1,t}(),ic=function(t){function e(){var n=t.call(this)||this;return Si(e,n,(function(t,e){function n(e){var n=t[bi]();n&&n[Oo]([e],2)}t[ki]=function(t,n,i,o){e[ki](t,n,i||new xs(t),o||new nc(t))},t.track=function(i){Jr(t[xo](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),qr("Invalid telemetry item")),function(t){lr(t[Ti])&&(n(t),qr("telemetry name required"))}(i),e.track(i)}),(function(){return{item:i}}),!i.sync)}})),n}return Wn(e,t),e.__ieDyn=1,e}(Za),oc="",rc="version",sc="properties",ac="on",cc="attachEvent",uc="addEventListener",lc="detachEvent",hc="removeEventListener",dc="events",fc="visibilitychange",pc="pagehide",vc="pageshow",mc="unload",gc="beforeunload",wc=ta("aiEvtPageHide"),yc=ta("aiEvtPageShow"),_c=/\.[\.]+/g,Cc=/[\.]+$/,Sc=1,kc=ea("events"),Tc=/^([^.]*)(?:\.(.+)|)/;function bc(t){return t&&t[uo]?t[uo](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,To):t}function Ac(t,e){var n;if(e){var i=To;wr(e)?(i=To,Tr(e,(function(t){(t=bc(t))&&("."!==t[0]&&(t="."+t),i+=t)}))):i=bc(e),i&&("."!==i[0]&&(i="."+i),t=(t||To)+i)}var o=Tc.exec(t||To)||[];return(n={})[po]=o[1],n.ns=(o[2]||To).replace(_c,".").replace(Cc,To)[oo](".").sort().join("."),n}function Ic(t,e,n){void 0===n&&(n=!0);var i=kc.get(t,dc,{},n),o=i[e];return o||(o=i[e]=[]),o}function Rc(t,e,n,i){t&&e&&e[po]&&(t[hc]?t[hc](e[po],n,i):t[lc]&&t[lc](ac+e[po],n))}function Ec(t,e,n,i){for(var o=e[Hi];o--;){var r=e[o];r&&(n.ns&&n.ns!==r.evtName.ns||i&&!i(r)||(Rc(t,r.evtName,r[vo],r.capture),e[ji](o,1)))}}function Nc(t,e){return e?Ac("xx",wr(e)?[t].concat(e):[t,e]).ns[oo]("."):t}function Pc(t,e,n,i,o){var r;void 0===o&&(o=!1);var s=!1;if(t)try{var a=Ac(e,i);if(s=function(t,e,n,i){var o=!1;return t&&e&&e[po]&&n&&(t[uc]?(t[uc](e[po],n,i),o=!0):t[cc]&&(t[cc](ac+e[po],n),o=!0)),o}(t,a,n,o),s&&kc.accept(t)){var c=((r={guid:Sc++,evtName:a})[vo]=n,r.capture=o,r);Ic(t,a.type)[Ii](c)}}catch(t){}return s}function Hc(t,e,n,i,o){if(void 0===o&&(o=!1),t)try{var r=Ac(e,i),s=!1;!function(t,e,n){if(e[po])Ec(t,Ic(t,e[po]),e,n);else{var i=kc.get(t,dc,{});vr(i,(function(i,o){Ec(t,o,e,n)})),0===Er(i)[Hi]&&kc.kill(t,dc)}}(t,r,(function(t){return!((!r.ns||n)&&t[vo]!==n||(s=!0,0))})),s||Rc(t,r,n,o)}catch(t){}}function Oc(t,e,n,i){var o=!1;return e&&t&&t[Hi]>0&&Tr(t,(function(t){t&&(n&&-1!==br(n,t)||(o=function(t,e,n){var i=!1,o=ps();o&&(i=Pc(o,t,e,n),i=Pc(o.body,t,e,n)||i);var r=ms();return r&&(i=Pc(r,t,e,n)||i),i}(t,e,i)||o))})),o}function Uc(t,e,n){t&&wr(t)&&Tr(t,(function(t){t&&function(t,e,n){var i=ps();i&&(Hc(i,t,e,n),Hc(i.body,t,e,n));var o=ms();o&&Hc(o,t,e,n)}(t,e,n)}))}function Mc(t,e,n){var i=Nc(wc,n),o=Oc([pc],t,e,i);return e&&-1!==br(e,fc)||(o=Oc([fc],(function(e){var n=ms();t&&n&&"hidden"===n.visibilityState&&t(e)}),e,i)||o),!o&&e&&(o=Mc(t,null,n)),o}function Dc(t,e,n){var i=Nc(yc,n),o=Oc([vc],t,e,i);return!(o=Oc([fc],(function(e){var n=ms();t&&n&&"visible"===n.visibilityState&&t(e)}),e,i)||o)&&e&&(o=Dc(t,null,n)),o}function Fc(){var t=xc();return t[no](0,8)+"-"+t[no](8,12)+"-"+t[no](12,16)+"-"+t[no](16,20)+"-"+t[no](20)}function xc(){for(var t,e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=To,i=0;i<4;i++)n+=e[15&(t=$s())]+e[t>>4&15]+e[t>>8&15]+e[t>>12&15]+e[t>>16&15]+e[t>>20&15]+e[t>>24&15]+e[t>>28&15];var o=e[8+(3&$s())|0];return n[so](0,8)+n[so](9,4)+"4"+n[so](13,3)+o+n[so](16,3)+n[so](19,12)}var qc="1DS-Web-JS-3.2.12",Bc="withCredentials",Lc=((ec={})[0]=0,ec[2]=6,ec[1]=1,ec[3]=7,ec[4098]=6,ec[4097]=1,ec[4099]=7,ec);function Wc(t){return!(t===oc||lr(t))}function jc(t,e,n){var i=-1;if(!ur(t))if(e>0&&(32===e?i=8192:e<=13&&(i=e<<5)),function(t){return t>=0&&t<=9}(n))-1===i&&(i=0),i|=n;else{var o=Lc[Jc(t)]||-1;-1!==i&&-1!==o?i|=o:6===o&&(i=o)}return i}function Gc(t,e,n){var i;return void 0===n&&(n=!0),t&&(i=t.get(e),n&&i&&decodeURIComponent&&(i=decodeURIComponent(i))),i||oc}function Kc(t){void 0===t&&(t="D");var e=Fc();return"B"===t?e="{"+e+"}":"P"===t?e="("+e+")":"N"===t&&(e=e.replace(/-/g,oc)),e}function zc(t,e,n,i,o){var r={},s=!1,a=0,c=arguments.length,u=arguments;for("[object Boolean]"===Object[Rn].toString.call(u[0])&&(s=u[0],a++);a<c;a++)vr(u[a],(function(t,e){s&&e&&dr(e)?wr(e)?(r[t]=r[t]||[],Tr(e,(function(e,n){e&&dr(e)?r[t][n]=zc(!0,r[t][n],e):r[t][n]=e}))):r[t]=zc(!0,r[t],e):r[t]=e}));return r}Boolean(ms()),Boolean(ps());var $c=function(){var t=ds("performance");return t&&t.now?t.now():Or()};function Vc(t,e){var n=t;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[e]=$c()}function Jc(t){var e=0;if(null!=t){var n=typeof t;"string"===n?e=1:"number"===n?e=2:"boolean"===n?e=3:n===An&&(e=4,wr(t)?(e=4096,t.length>0&&(e|=Jc(t[0]))):Mn.call(t,"value")&&(e=8192|Jc(t.value)))}return e}var Qc=function(t){function e(){var n=t.call(this)||this;return n.pluginVersionStringArr=[],Si(e,n,(function(t,e){t.logger&&t.logger.queue||(t.logger=new xs({loggingLevelConsole:1})),t.initialize=function(n,i,o,r){Jr(t,(function(){return"AppInsightsCore.initialize"}),(function(){var s=t.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;!a||a.getProperty&&a.setProperty||qr("Invalid property storage override passed."),n.channels&&Tr(n.channels,(function(t){t&&Tr(t,(function(t){if(t.identifier&&t.version){var e=t.identifier+"="+t.version;s.push(e)}}))}))}t.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},i&&Tr(i,(function(t){if(t&&t.identifier&&t.version){var e=t.identifier+"="+t.version;s.push(e)}})),t.pluginVersionString=s.join(";"),t.pluginVersionStringArr=s;try{e.initialize(n,i,o,r),t.pollInternalLogs("InternalLog")}catch(e){var c=t.logger,u=Ts(e);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Bs(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:i,logger:o,notificationManager:r}}))},t.track=function(n){Jr(t,(function(){return"AppInsightsCore.track"}),(function(){var i,o=n;if(o){o.timings=o.timings||{},o.timings.trackStart=$c(),(i=o.latency)&&_r(i)&&i>=1&&i<=4||(o.latency=1);var r=o.ext=o.ext||{};r.sdk=r.sdk||{},r.sdk.ver=qc;var s=o.baseData=o.baseData||{};s[sc]=s[sc]||{};var a=s[sc];a[rc]=a[rc]||t.pluginVersionString||oc}e.track(o)}),(function(){return{item:n}}),!n.sync)}})),n}return Wn(e,t),e.__ieDyn=1,e}(ic);const Xc=Qc;function Yc(t){var e={};return vr(t,(function(t,n){e[t]=n[1],e[n[0]]=n[1]})),Pr(e)}var Zc,tu="locale",eu="ver",nu="name",iu=Yc({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),ou=Yc({id:[0,"id"],ver:[1,eu],appName:[2,nu],locale:[3,tu],expId:[4,"expId"],env:[5,"env"]}),ru=Yc({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),su=Yc({locale:[0,tu],localId:[1,"localId"],id:[2,"id"]}),au=Yc({osName:[0,nu],ver:[1,eu]}),cu=Yc({ver:[0,eu],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),uu=Yc({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),lu=Yc({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),hu=Yc({tz:[0,"tz"]}),du=Yc({sessionId:[0,"sesId"]}),fu=Yc({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),pu=Yc({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),vu=Yc({traceId:[0,"traceID"],traceName:[1,nu],parentId:[2,"parentID"]}),mu=Yc({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]});function gu(){return void 0===Zc&&(Zc=!!yu(0)),Zc}function wu(){return gu()?yu(0):null}function yu(t){var e,n,i=null;try{var o=Fn();if(!o)return null;n=new Date,(i=0===t?o.localStorage:o.sessionStorage)&&fr(i.setItem)&&(i.setItem(n,n),e=i.getItem(n)!==n,i.removeItem(n),e&&(i=null))}catch(t){i=null}return i}function _u(){return this.getId()}function Cu(t){this.setId(t)}var Su=function(){function t(){Si(t,this,(function(t){t.setId=function(e){t.customId=e},t.getId=function(){return yr(t.customId)?t.customId:t.automaticId}}))}return t.Ia=void Nr(t.prototype,"id",_u,Cu),t}(),ku="ai_session",Tu=function(){function t(e,n){var i,o,r=Fs(e),s=Ma(e);Si(t,this,(function(e){var a,c={sessionRenewalMs:(a=n).sessionRenewalMs&&function(){return a.sessionRenewalMs},sessionExpirationMs:a.sessionExpirationMs&&function(){return a.sessionExpirationMs},cookieDomain:a.cookieDomain&&function(){return a.cookieDomain},namePrefix:a.namePrefix&&function(){return a.namePrefix},sessionAsGuid:function(){return a.sessionAsGuid},idLength:function(){return a.idLength?a.idLength:22}};function u(t){var n=e.automaticSession,i=t.split("|");i.length>0&&n.setId(i[0]);try{if(i.length>1){var o=+i[1];n.acquisitionDate=+new Date(o),n.acquisitionDate=n.acquisitionDate>0?n.acquisitionDate:0}if(i.length>2){var s=+i[2];n.renewalDate=+new Date(s),n.renewalDate=n.renewalDate>0?n.renewalDate:0}}catch(t){Bs(r,1,510,"Error parsing ai_session cookie, session will be reset: "+t)}0===n.renewalDate&&Bs(r,2,517,"AI session renewal date is 0, session will be reset.")}function l(){var t=e.automaticSession,n=(new Date).getTime(),i=e.config.sessionAsGuid();!ur(i)&&i?Cr(i)?t.setId(Kc()):t.setId(Kc(i)):t.setId(Vs(c&&c.idLength?c.idLength():22)),t.acquisitionDate=n,t.renewalDate=n,h(t.getId(),t.acquisitionDate,t.renewalDate),gu()||Bs(r,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function h(t,n,r){var a=n+e.config.sessionExpirationMs(),c=r+e.config.sessionRenewalMs(),u=new Date,l=[t,n,r];a<c?u.setTime(a):u.setTime(c);var h=e.config.cookieDomain?e.config.cookieDomain():null;s.set(o(),l.join("|")+";expires="+u.toUTCString(),null,h),i=(new Date).getTime()}fr(n.sessionExpirationMs)||(c.sessionExpirationMs=function(){return t.acquisitionSpan}),fr(n.sessionRenewalMs)||(c.sessionRenewalMs=function(){return t.renewalSpan}),e.config=c,o=function(){return e.config.namePrefix&&e.config.namePrefix()?ku+e.config.namePrefix():ku},e.automaticSession=new Su,e.update=function(){e.automaticSession.getId()||function(){var t=s.get(o());if(t&&fr(t.split))u(t);else{var n=function(t,e){var n=wu();if(null!==n)try{return n.getItem(e)}catch(e){Zc=!1,Bs(t,1,503,"Browser failed read of local storage. "+e)}return null}(r,o());n&&u(n)}e.automaticSession.getId()||l()}();var n=e.automaticSession,a=e.config,c=(new Date).getTime(),d=c-n.acquisitionDate>a.sessionExpirationMs(),f=c-n.renewalDate>a.sessionRenewalMs();d||f?l():(!i||c-i>t.cookieUpdateInterval)&&(n.renewalDate=c,h(n.getId(),n.acquisitionDate,n.renewalDate))},e.backup=function(){var t=e.automaticSession;!function(t,e,n){!function(t,e,n){var i=wu();if(null!==i)try{return i.setItem(e,n),!0}catch(e){Zc=!1,Bs(t,1,504,"Browser failed write to local storage. "+e)}}(r,o(),[t,e,n].join("|"))}(t.getId(),t.acquisitionDate,t.renewalDate)}}))}return t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}(),bu=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function Au(t,e){void 0===e&&(e=bu);var n=null;if(t)for(var i=t.split(","),o=0;o<i.length;o++)Iu(i[o],e)&&(n?n+=","+i[o]:n=i[o]);return n}function Iu(t,e){if(void 0===e&&(e=bu),!t||t.length<4)return!1;for(var n=!1,i=t.substring(0,3).toString().toUpperCase(),o=0;o<e.length;o++)if(e[o]+":"===i&&t.length<=256){n=!0;break}return n}function Ru(){return this.getExpId()}var Eu=function(){function t(e,n){var i=null,o=bu.slice(0),r=Ma(n),s=e;Si(t,this,(function(t){if(vs()){var n=ms().documentElement;n&&(t.locale=n.lang)}function a(t){t!==i&&(i=Au(t,o))}t.env=e.env?e.env:function(t){var e,n={},i=ms();if(i){e=i&&i.querySelectorAll("meta");for(var o=0;o<e.length;o++){var r=e[o];r.name&&0===r.name.toLowerCase().indexOf(t)&&(n[r.name.replace(t,"")]=r.content)}}return n}("awa-").env,t.getExpId=function(){return s.expId?(a(s.expId),i):(a(Gc(r,"Treatments")),i)}}))}return t.validateAppExpId=Au,t.Ia=void Nr(t.prototype,"expId",Ru),t}(),Nu=function(){},Pu=function(){};function Hu(){return this.getMsfpc()}function Ou(){return this.getAnid()}var Uu=function(){function t(e,n){var i=Ma(n);Si(t,this,(function(t){e.serviceName&&(t.serviceName=e.serviceName),t.getMsfpc=function(){return Gc(i,"MSFPC")},t.getAnid=function(){return Gc(i,"ANON").slice(0,34)}}))}var e;return t.Ia=(Nr(e=t.prototype,"msfpc",Hu),void Nr(e,"anid",Ou)),t}(),Mu=function(){var t=(new Date).getTimezoneOffset(),e=t%60,n=(t-e)/60,i="+";n>0&&(i="-"),n=Math.abs(n),e=Math.abs(e),this.tz=i+(n<10?"0"+n:n.toString())+":"+(e<10?"0"+e:e.toString())},Du={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Fu={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},xu="([\\d,_,.]+)",qu="Unknown",Bu=[{r:Du.WINPHONE,os:"Windows Phone"},{r:Du.WINRT,os:"Windows RT"},{r:Du.WIN,os:"Windows"},{r:Du.IOS,os:"iOS"},{r:Du.ANDROID,os:"Android"},{r:Du.LINUX,os:"Linux"},{r:Du.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Du.OSX,os:"Mac OS X"}];function Lu(t,e){var n=t.match(new RegExp(e+" ([\\d,.]+)"));return n?Fu[n[1]]?Fu[n[1]]:n[1]:qu}function Wu(t){return t.indexOf(".")>-1?".":t.indexOf("_")>-1?"_":null}var ju=function(t){if(t.populateOperatingSystemInfo){var e=this,n=ws()||{},i=t.userAgent||n.userAgent||"",o=t.userAgentData||n.userAgentData||{};if(i){var r=function(t){for(var e=0;e<Bu.length;e++){var n=Bu[e];if(n.r&&t.match(n.r))return n.os;if(n.s&&-1!==t.indexOf(n.s))return n.os}return qu}(i.toLowerCase());e.name=r,e.ver=function(t,e){return"Windows"===e?Lu(t,"Windows NT"):"Android"===e?Lu(t,e):"Mac OS X"===e?function(t){var e=t.match(new RegExp("Mac OS X "+xu));if(e){var n=e[1].replace(/_/g,".");if(n){var i=Wu(n);return i?n.split(i)[0]:n}}return qu}(t):"iOS"===e?function(t){var e=t.match(new RegExp("OS "+xu));if(e){var n=e[1].replace(/_/g,".");if(n){var i=Wu(n);return i?n.split(i)[0]:n}}return qu}(t):qu}(i,r)}e.name&&e.name!==qu||!yr(o.platform)||(e.name=o.platform)}},Gu="MicrosoftApplicationsTelemetryDeviceId",Ku=function(){function t(e,n){var i=0;Si(t,this,(function(t){var o=e.propertyStorageOverride;t.seq=i,t.epoch=$s(!1).toString();var r=Ma(n,e);if(r.isEnabled()||o){var s=function(t,e,n){return e?e.getProperty(n)||"":Gc(t,n)}(r,o,Gu);s||(s=Fc()),function(t,e,n,i){e?e.setProperty(n,i):t.set(n,i,31536e3)}(r,o,Gu,s),t.installId=s}else r.purge(Gu);t.getSequenceId=function(){return++i}}))}return t.__ieDyn=1,t}(),zu=function(t,e,n,i){var o=this;if(o.traceId=e||xc(),t.enableDistributedTracing&&!n&&(n=xc().substring(0,16)),o.parentId=n,t.enableApplicationInsightsTrace){o.name=i;var r=ys();r&&r.pathname&&(o.name=r.pathname)}},$u="setLocalId";function Vu(){return this.getLocalId()}function Ju(t){this[$u](t)}var Qu=function(){function t(e,n,i){var o,r=n,s=Ma(i,e);Si(t,this,(function(n){if(s&&s.isEnabled()&&(d(),r.enableApplicationInsightsUser)){var i=Gc(s,t.userCookieName);if(i){var a=i.split(t.cookieSeparator);a.length>0&&(n.id=a[0])}if(!n.id){n.id=Vs(e&&!ur(e.idLength)?e.idLength:22);var c=kr(new Date);n.accountAcquisitionDate=c;var u=[n.id,c],l=r.cookieDomain?r.cookieDomain:void 0;s.set(t.userCookieName,u.join(t.cookieSeparator),31536e3,l)}}if("undefined"!=typeof navigator){var h=navigator;n.locale=h.userLanguage||h.language}function d(){if(!r.hashIdentifiers&&!r.dropIdentifiers){var t=Gc(s,"MUID");t&&(o="t:"+t)}return o}n.getLocalId=function(){return o||d()},n[$u]=function(t){o=t}}))}return t.cookieSeparator="|",t.userCookieName="ai_user",t.Ia=void Nr(t.prototype,"localId",Vu,Ju),t}(),Xu=function(t){var e=this;e.popSample=100,e.eventFlags=0,t.hashIdentifiers&&(e.eventFlags=1048576|e.eventFlags),t.dropIdentifiers&&(e.eventFlags=2097152|e.eventFlags),t.scrubIpOnly&&(e.eventFlags=4194304|e.eventFlags)},Yu=["Required","Analytics","SocialMedia","Advertising"],Zu="([\\d,.]+)",tl="Unknown",el="Edg/",nl=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:el,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],il=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function ol(t,e){return e.indexOf(t)>-1}function rl(t,e){for(var n=0;n<e.length;n++)if(t==e[n].brand)return e[n].version;return null}function sl(){return this.getUserConsent()}var al=function(){function t(e,n){var i=Ma(n),o=e||{};Si(t,this,(function(t){var e=ys();if(e){var n=e.hostname;n&&(t.domain="file:"===e.protocol?"local":n)}if(o.populateBrowserInfo){var r=o.userAgent,s=(o.userAgentData||{}).brands,a=ws();a&&(r=r||a.userAgent||"",s=s||(a.userAgentData||{}).brands),function(e,n){if(wr(n))try{for(var i=0;i<il.length;i++){var o=rl(il[i].br,n);if(o)return t.browser=il[i].b,void(t.browserVer=o)}}catch(t){}if(e){var r=function(t){if(t)for(var e=0;e<nl.length;e++)if(ol(nl[e].ua,t))return nl[e].b;return tl}(e);t.browser=r,t.browserVer=function(t,e){return"MSIE"===e?function(t){var e=t.match(new RegExp("MSIE "+Zu));if(e)return e[1];var n=t.match(new RegExp("rv:"+Zu));return n?n[1]:void 0}(t):function(t,e){"Safari"===t?t="Version":"Edge"===t&&ol(el,e)&&(t="Edg");var n=e.match(new RegExp(t+"/"+Zu));return n||"Opera"===t&&(n=e.match(new RegExp("OPR/"+Zu)))?n[1]:tl}(e,t)}(e,r)}}(r,s);var c=function(){var t={h:0,w:0},e=ps();return e&&e.screen&&(t.h=screen.height,t.w=screen.width),t}();t.screenRes=c.w+"X"+c.h}ur(o.gpcDataSharingOptIn)?t.gpcDataSharingOptIn=null:t.gpcDataSharingOptIn=o.gpcDataSharingOptIn,t.getUserConsent=function(){return o.userConsented||!!Gc(i,o.userConsentCookieName||"MSCC")},t.getUserConsentDetails=function(){var e=null;try{var n=o.callback;if(n&&n.userConsentDetails){var i=n.userConsentDetails();if(i){e=o.disableConsentDetailsSanitize?i:{};for(var r=0;r<Yu.length;r++){var s=Yu[r];e[s]=i[s]||!1}}}var a=t.gpcDataSharingOptIn;return null!==a&&((e=e||{}).GPC_DataSharingOptIn=!!a),e?JSON.stringify(e):null}catch(t){}},Nr(t,"userConsent",t.getUserConsent)}))}return t.Ia=void Nr(t.prototype,"userConsent",sl),t}();function cl(t,e,n,i,o){var r=e.ext[iu[t]];return r&&vr(i,(function(t,e){if(yr(e)||_r(e)||Cr(e)){var i=r[n[t]];!o&&(i||yr(i)||_r(i)||Cr(i))&&(e=i),r[n[t]]=e}})),r}var ul=function(){function t(e,n,i){Si(t,this,(function(t){t.app=new Eu(n,i),t.cloud=new Nu,t.user=new Qu(e,n,i),t.os=new ju(n),t.web=new al(n,i);var o=new Ku(e,i),r=new Uu(n,i),s=new Xu(n);t.loc=new Mu,t.device=new Pu;var a=new Tu(i,n);t.session=new Su;var c,u,l,h=(c=new zu(n),u=p(),l=c||{},{getName:function(){return l.name},setName:function(t){u&&u.setName(t),l.name=t},getTraceId:function(){return l.traceId},setTraceId:function(t){u&&u.setTraceId(t),ia(t)&&(l.traceId=t)},getSpanId:function(){return l.parentId},setSpanId:function(t){u&&u.setSpanId(t),oa(t)&&(l.parentId=t)},getTraceFlags:function(){return l.traceFlags},setTraceFlags:function(t){u&&u.setTraceFlags(t),l.traceFlags=t}}),d=!(n||{}).eventContainExtFields;function f(){var e=t.session;if(e&&yr(e.customId))return e.customId;a.update();var n=a.automaticSession;if(n){var i=n.getId();i&&yr(i)&&(e.automaticId=i)}return e.automaticId}function p(){var t=h;return i&&i.getTraceCtx&&(t=i.getTraceCtx(!1)||h),t}t.getTraceCtx=function(){return h},t.getSessionId=f,t.applyApplicationContext=function(e){var n,i=t.app;cl(4,e,ou,((n={})[0]=i.id,n[1]=i.ver,n[2]=i.name,n[3]=i.locale,n[4]=i.getExpId(),n[5]=i.env,n),d)},t.applyUserContext=function(e){var n,i=t.user;cl(0,e,su,((n={})[1]=i.getLocalId(),n[0]=i.locale,n[2]=i.id,n),d)},t.applyWebContext=function(e){var n,i=t.web;cl(3,e,ru,((n={})[0]=i.domain,n[1]=i.browser,n[2]=i.browserVer,n[3]=i.screenRes,n[5]=i.getUserConsentDetails(),n[4]=i.getUserConsent(),n),d)},t.applyOsContext=function(e){var n,i=t.os;cl(5,e,au,((n={})[0]=i.name,n[1]=i.ver,n),d)},t.applySdkContext=function(t){var e;cl(6,t,cu,((e={})[2]=o.installId,e[1]=o.getSequenceId(),e[3]=o.epoch,e),d)},t.applyIntWebContext=function(t){var e;cl(7,t,uu,((e={})[0]=r.getMsfpc(),e[1]=r.getAnid(),e[2]=r.serviceName,e),d)},t.applyUtcContext=function(t){var e,n=((e={})[0]=s.popSample,e);s.eventFlags>0&&(n[1]=s.eventFlags),cl(8,t,lu,n,d)},t.applyLocContext=function(e){var n;cl(9,e,hu,((n={})[0]=t.loc.tz,n),d)},t.applySessionContext=function(t){var e;cl(4,t,du,((e={})[0]=f(),e),d)},t.applyDeviceContext=function(e){var n,i=t.device;cl(1,e,fu,((n={})[0]=i.localId,n[2]=i.make,n[3]=i.model,n[1]=i.deviceClass,n),d)},t.applyCloudContext=function(e){var n,i=t.cloud;cl(10,e,pu,((n={})[0]=i.role,n[1]=i.roleInstance,n[2]=i.roleVer,n),d)},t.applyAITraceContext=function(t){var e;if(n.enableApplicationInsightsTrace){var i=p();i&&cl(2,t,vu,((e={})[0]=i.getTraceId(),e[1]=i.getName(),e[2]=i.getSpanId(),e),!1)}},t.applyDistributedTraceContext=function(t){var e,n=p();if(n){var i=((e={})[0]=n.getTraceId(),e[1]=n.getSpanId(),e),o=n.getTraceFlags();lr(o)||(i[2]=o),cl(11,t,mu,i,!1)}}}))}return t.__ieDyn=1,t}(),ll=[iu[4],iu[0],iu[3],iu[5],iu[6],iu[7],iu[8],iu[9],iu[1],iu[2],iu[11],iu[10]];const hl=function(t){function e(){var n,i,o,r=t.call(this)||this;return r.identifier="SystemPropertiesCollector",r.priority=3,r.version="3.2.12",Si(e,r,(function(t,e){function r(){n=null,i={}}r(),t.initialize=function(i,r,s){e.initialize(i,r,s),o=t.Ta().getExtCfg(t.identifier),n=new ul(i,o,r),r&&r.setTraceCtx&&r.setTraceCtx(n.getTraceCtx())},t.processTelemetry=function(e,r){Vc(e,t.identifier),r=t.Ta(r);var s,a,c=e.ext=e.ext?e.ext:{};e.data=e.data?e.data:{},Tr(ll,(function(t){c[t]=c[t]||{}})),n&&(n.applyApplicationContext(e),n.applyUserContext(e),n.applyWebContext(e),n.applyOsContext(e),n.applySdkContext(e),n.applyIntWebContext(e),n.applyUtcContext(e),n.applyLocContext(e),n.applySessionContext(e),n.applyDeviceContext(e),o.enableApplicationInsightsTrace&&n.applyAITraceContext(e),o.enableDistributedTracing&&n.applyDistributedTraceContext(e),n.applyCloudContext(e)),Tr(Er(c),(function(t){0===Er(c[t]).length&&delete c[t]})),s=i,a=e.data,s&&vr(s,(function(t,e){a[t]||(a[t]=e)})),t.processNext(e,r)},t.getPropertiesContext=function(){return n},t.setProperty=function(t,e){i[t]=e},t.Ra=function(t,e){var i=(t||{}).core();if(i&&i.getTraceCtx&&n){var o=i.getTraceCtx(!1);o&&o===n.getTraceCtx()&&i.setTraceCtx(null)}r()}})),r}return Wn(e,t),e.__ieDyn=1,e}(Ka);var dl,fl=(dl={},vr({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(t,e){dl[t]=e,dl[e]=t})),Pr(dl)),pl="REAL_TIME",vl="",ml="POST",gl="drop",wl="requeue",yl="application/x-json-stream",_l="cache-control",Cl="content-type",Sl="kill-duration",kl="time-delta-millis",Tl="client-version",bl="client-id",Al="time-delta-to-apply-millis",Il="upload-time",Rl="apikey",El="AuthMsaDeviceTicket",Nl="AuthXToken",Pl="msfpc",Hl="trace",Ol="user";function Ul(t){var e=(t.ext||{}).intweb;return e&&Wc(e[Pl])?e[Pl]:null}function Ml(t){for(var e=null,n=0;null===e&&n<t.length;n++)e=Ul(t[n]);return e}var Dl=function(){function t(e,n){var i=n?[].concat(n):[],o=this,r=Ml(i);o.iKey=function(){return e},o.Msfpc=function(){return r||vl},o.count=function(){return i.length},o.events=function(){return i},o.addEvent=function(t){return!!t&&(i.push(t),r||(r=Ul(t)),!0)},o.split=function(n,o){var s;if(n<i.length){var a=i.length-n;lr(o)||(a=o<a?o:a),s=i.splice(n,a),r=Ml(i)}return new t(e,s)}}return t.create=function(e,n){return new t(e,n)},t}();const Fl=function(){function t(){var e=!0,n=!0,i=!0,o="use-collector-delta",r=!1;Si(t,this,(function(t){t.allowRequestSending=function(){return e},t.firstRequestSent=function(){i&&(i=!1,r||(e=!1))},t.shouldAddClockSkewHeaders=function(){return n},t.getClockSkewHeaderValue=function(){return o},t.setClockSkew=function(t){r||(t?(o=t,n=!0,r=!0):n=!1,e=!0)}}))}return t.__ieDyn=1,t}();var xl=function(){function t(){var e={};Si(t,this,(function(t){t.setKillSwitchTenants=function(t,n){if(t&&n)try{var i=function(t){var e=[];return t&&Tr(t,(function(t){e.push(Ar(t))})),e}(t.split(","));if("this-request-only"===n)return i;for(var o=1e3*parseInt(n,10),r=0;r<i.length;++r)e[i[r]]=Or()+o}catch(t){return[]}return[]},t.isTenantKilled=function(t){var n=e,i=Ar(t);return void 0!==n[i]&&n[i]>Or()||(delete n[i],!1)}}))}return t.__ieDyn=1,t}();const ql=xl;function Bl(t){var e,n=Math.floor(1200*Math.random())+2400;return e=Math.pow(2,t)*n,Math.min(e,6e5)}var Ll,Wl=2e6,jl=Math.min(Wl,65e3),Gl="metadata",Kl="f",zl=/\./,$l=function(){function t(e,n,i,o){var r="data",s="baseData",a=!!o,c=n,u={};Si(t,this,(function(t){function n(t,e,o,r,s,l,h){vr(t,(function(t,d){var f=null;if(d||Wc(d)){var p=o,v=t,m=s,g=e;if(a&&!r&&zl.test(t)){var w=t.split("."),y=w.length;if(y>1){m&&(m=m.slice());for(var _=0;_<y-1;_++){var C=w[_];g=g[C]=g[C]||{},p+="."+C,m&&m.push(C)}v=w[y-1]}}var S=r&&function(t,e){var n=u[t];return void 0===n&&(t.length>=7&&(n=mr(t,"ext.metadata")||mr(t,"ext.web")),u[t]=n),n}(p);if(f=!S&&c&&c.handleField(p,v)?c.value(p,v,d,i):function(t,e,n){if(!e&&!Wc(e)||"string"!=typeof t)return null;var i,o=typeof e;if("string"===o||"number"===o||"boolean"===o||wr(e))e={value:e};else if("object"!==o||Mn.call(e,"value")){if(lr(e.value)||e.value===oc||!yr(e.value)&&!_r(e.value)&&!Cr(e.value)&&!wr(e.value))return null}else e={value:n?JSON.stringify(e):e};if(wr(e.value)&&!(e.value.length>0))return null;if(!lr(e.kind)){if(wr(e.value)||!(0===(i=e.kind)||i>0&&i<=13||32===i))return null;e.value=e.value.toString()}return e}(v,d,i)){var k=f.value;if(g[v]=k,l&&l(m,v,f),h&&"object"==typeof k&&!wr(k)){var T=m;T&&(T=T.slice()).push(v),n(d,k,p+"."+v,r,T,l,h)}}}}))}t.createPayload=function(t,e,n,i,o,r){return{apiKeys:[],payloadBlob:vl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:t,isTeardown:e,isSync:n,isBeacon:i,sendType:r,sendReason:o}},t.appendPayload=function(n,i,o){var r=n&&i&&!n.overflow;return r&&Jr(e,(function(){return"Serializer:appendPayload"}),(function(){for(var e=i.events(),r=n.payloadBlob,s=n.numEvents,a=!1,c=[],u=[],l=n.isBeacon,h=l?65e3:3984588,d=l?jl:Wl,f=0,p=0;f<e.length;){var v=e[f];if(v){if(s>=o){n.overflow=i.split(f);break}var m=t.getEventBlob(v);if(m&&m.length<=d){var g=m.length;if(r.length+g>h){n.overflow=i.split(f);break}r&&(r+="\n"),r+=m,++p>20&&(r.substr(0,1),p=0),a=!0,s++}else m?c.push(v):u.push(v),e.splice(f,1),f--}f++}if(c&&c.length>0&&n.sizeExceed.push(Dl.create(i.iKey(),c)),u&&u.length>0&&n.failedEvts.push(Dl.create(i.iKey(),u)),a){n.batches.push(i),n.payloadBlob=r,n.numEvents=s;var w=i.iKey();-1===br(n.apiKeys,w)&&n.apiKeys.push(w)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:o}})),r},t.getEventBlob=function(t){try{return Jr(e,(function(){return"Serializer.getEventBlob"}),(function(){var e={};e.name=t.name,e.time=t.time,e.ver=t.ver,e.iKey="o:"+function(t){if(t){var e=t.indexOf("-");if(e>-1)return t.substring(0,e)}return oc}(t.iKey);var i={},o=t.ext;o&&(e.ext=i,vr(o,(function(t,e){n(e,i[t]={},"ext."+t,!0,null,null,!0)})));var a=e[r]={};a.baseType=t.baseType;var c=a[s]={};return n(t.baseData,c,s,!1,[s],(function(t,e,n){Vl(i,t,e,n)}),!0),n(t.data,a,r,!1,[],(function(t,e,n){Vl(i,t,e,n)}),!0),JSON.stringify(e)}),(function(){return{item:t}}))}catch(t){return null}}}))}return t.__ieDyn=1,t}();function Vl(t,e,n,i){if(i&&t){var o=jc(i.value,i.kind,i.propertyType);if(o>-1){var r=t[Gl];r||(r=t[Gl]={f:{}});var s=r[Kl];if(s||(s=r[Kl]={}),e)for(var a=0;a<e.length;a++){var c=e[a];s[c]||(s[c]={f:{}});var u=s[c][Kl];u||(u=s[c][Kl]={}),s=u}s=s[n]={},wr(i.value)?s.a={t:o}:s.t=o}}}var Jl="sendAttempt",Ql="&NoResponseBody=true",Xl=((Ll={})[1]=wl,Ll[100]=wl,Ll[200]="sent",Ll[8004]=gl,Ll[8003]=gl,Ll),Yl={},Zl={};function th(t,e,n){Yl[t]=e,!1!==n&&(Zl[e]=t)}function eh(t){try{return t.responseText}catch(t){}return vl}function nh(t,e){var n,i,o=!1;if(t&&e){var r=Er(t);if(r&&r.length>0)for(var s=e.toLowerCase(),a=0;a<r.length;a++){var c=r[a];if(c&&(i=c,(n=e)&&Mn[fo](n,i))&&c.toLowerCase()===s){o=!0;break}}}return o}function ih(t,e,n,i){e&&n&&n.length>0&&(i&&Yl[e]?(t.hdrs[Yl[e]]=n,t.useHdrs=!0):t.url+="&"+e+"="+n)}function oh(t,e){return e&&(_r(e)?t=[e].concat(t):wr(e)&&(t=e.concat(t))),t}th(El,El,!1),th(Tl,Tl),th(bl,"Client-Id"),th(Rl,Rl),th(Al,Al),th(Il,Il),th(Nl,Nl);var rh=function(){function t(e,n,i,o,r){this.Ea=[];var s,a,c,u,l,h,d,f,p,v,m="?cors=true&"+Cl.toLowerCase()+"="+yl,g=new ql,w=!1,y=new Fl,_=!1,C=0,S=!0,k=[],T={},b=[],A=null,I=!1,R=!1,E=!1;Si(t,this,(function(t){var N=!0;function P(t,e){for(var n=0,i=null,o=0;null==i&&o<t.length;)1===(n=t[o])?(null===us&&(us=typeof XDomainRequest!==In)&&Is()&&(us=us&&!hs(ds(rs),"withCredentials")),us?i=H:Is()&&(i=U)):2===n&&As(e)&&(!e||e&&!f)?i=O:_&&3===n&&bs()&&(i=D),o++;return i?{Na:n,Pa:e,sendPOST:i}:null}function H(t,e,n){var i=new XDomainRequest;i.open(ml,t.urlString),t.timeout&&(i.timeout=t.timeout),i.onload=function(){var t=eh(i);M(e,200,{},t),$(t)},i.onerror=function(){M(e,400,{})},i.ontimeout=function(){M(e,500,{})},i.onprogress=function(){},n?i.send(t.data):r.set((function(){i.send(t.data)}),0)}function O(t,e,n){var i,o=t.urlString,s=!1,a=!1,c=((i={body:t.data,method:ml}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(c.keepalive=!0,2===t.Ha&&(s=!0,v&&(o+=Ql))),N&&(c.credentials="include"),t.headers&&Er(t.headers).length>0&&(c.headers=t.headers),fetch(o,c).then((function(t){var n={},i=vl,o=t.headers;o&&o.forEach((function(t,e){n[e]=t})),t.body&&t.text().then((function(t){i=t})),a||(a=!0,M(e,t.status,n,i),$(i))})).catch((function(t){a||(a=!0,M(e,0,{}))})),s&&!a&&(a=!0,M(e,200,{})),!a&&t.timeout>0&&r.set((function(){a||(a=!0,M(e,500,{}))}),t.timeout)}function U(t,e,n){var i=t.urlString;function o(t,e,n){if(!t[n]&&e&&e.getResponseHeader){var i=e.getResponseHeader(n);i&&(t[n]=Ar(i))}return t}function r(t,n){M(e,t.status,function(t){var e,n,i={};return t.getAllResponseHeaders?(e=t.getAllResponseHeaders(),n={},yr(e)&&Tr(Ar(e).split(/[\r\n]+/),(function(t){if(t){var e=t.indexOf(": ");if(-1!==e){var i=Ar(t.substring(0,e)).toLowerCase(),o=Ar(t.substring(e+1));n[i]=o}else n[Ar(t)]=1}})),i=n):(i=o(i,t,kl),i=o(i,t,Sl),i=o(i,t,"kill-duration-seconds")),i}(t),n)}n&&t.disableXhrSync&&(n=!1);var s=function(t,e,n,i,o,r){function s(t,e,n){try{t[e]=n}catch(t){}}void 0===i&&(i=!1),void 0===o&&(o=!1);var a=new XMLHttpRequest;return i&&s(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&s(a,Bc,n),a.open(t,e,!o),n&&s(a,Bc,n),!o&&r&&s(a,"timeout",r),a}(ml,i,N,!0,n,t.timeout);vr(t.headers,(function(t,e){s.setRequestHeader(t,e)})),s.onload=function(){var t=eh(s);r(s,t),$(t)},s.onerror=function(){r(s)},s.ontimeout=function(){r(s)},s.send(t.data)}function M(t,e,n,i){try{t(e,n,i)}catch(t){Bs(a,2,518,Ts(t))}}function D(t,e,n){var i=200,o=t.Oa,r=t.urlString+(v?Ql:vl);try{var s=ws();if(!s.sendBeacon(r,t.data))if(o){var c=[];Tr(o.batches,(function(t){if(c&&t&&t.count()>0){for(var e=t.events(),n=0;n<e.length;n++)if(!s.sendBeacon(r,A.getEventBlob(e[n]))){c.push(t.split(n));break}}else c.push(t.split(0))})),V(c,8003,o.sendType,!0)}else i=0}catch(t){Ls(a,"Failed to send telemetry using sendBeacon API. Ex:"+Ts(t)),i=0}finally{M(e,i,{},vl)}}function F(t){return 2===t||3===t}function x(t){return R&&F(t)&&(t=2),t}function q(){return!w&&C<n}function B(){var t=b;return b=[],t}function L(t,e,n){var i=!1;return t&&t.length>0&&!w&&c[e]&&A&&(i=0!==e||q()&&(n>0||y.allowRequestSending())),i}function W(t){var e={};return t&&Tr(t,(function(t,n){e[n]={iKey:t.iKey(),evts:t.events()}})),e}function j(t,n,i,o,r){if(t&&0!==t.length)if(w)V(t,1,o);else{o=x(o);try{var s=t,l=0!==o;Jr(u,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(t=t.slice(0));for(var a=[],u=null,h=$c(),d=c[o]||(l?c[1]:c[0]),f=d&&d.Na,v=p&&(R||F(o)||3===f||d.Pa&&2===f);L(t,o,n);){var m=t.shift();m&&m.count()>0&&(g.isTenantKilled(m.iKey())?a.push(m):(u=u||A.createPayload(n,i,l,v,r,o),A.appendPayload(u,m,e)?null!==u.overflow&&(t=[u.overflow].concat(t),u.overflow=null,K(u,h,$c(),r),h=$c(),u=null):(K(u,h,$c(),r),h=$c(),t=[m].concat(t),u=null)))}u&&K(u,h,$c(),r),t.length>0&&(b=t.concat(b)),V(a,8004,o)}),(function(){return{batches:W(s),retryCount:n,isTeardown:i,isSynchronous:l,sendReason:r,useSendBeacon:F(o),sendType:o}}),!l)}catch(t){Bs(a,2,48,"Unexpected Exception sending batch: "+Ts(t))}}}function G(t,e,n){t[e]=t[e]||{},t[e][s.identifier]=n}function K(e,n,o,r){if(e&&e.payloadBlob&&e.payloadBlob.length>0){var l=!!t.sendHook,p=c[e.sendType];!F(e.sendType)&&e.isBeacon&&2===e.sendReason&&(p=c[2]||c[3]||p);var v=E;(e.isBeacon||3===p.Na)&&(v=!1);var w=function(t,e){var n={url:m,hdrs:{},useHdrs:!1};e?(n.hdrs=zc(n.hdrs,T),n.useHdrs=Er(n.hdrs).length>0):vr(T,(function(t,e){Zl[t]?ih(n,Zl[t],e,!1):(n.hdrs[t]=e,n.useHdrs=!0)})),ih(n,bl,"NO_AUTH",e),ih(n,Tl,qc,e);var i=vl;Tr(t.apiKeys,(function(t){i.length>0&&(i+=","),i+=t})),ih(n,Rl,i,e),ih(n,Il,Or().toString(),e);var o=function(t){for(var e=0;e<t.batches.length;e++){var n=t.batches[e].Msfpc();if(n)return encodeURIComponent(n)}return vl}(t);if(Wc(o)&&(n.url+="&ext.intweb.msfpc="+o),y.shouldAddClockSkewHeaders()&&ih(n,Al,y.getClockSkewHeaderValue(),e),u.getWParam){var r=u.getWParam();r>=0&&(n.url+="&w="+r)}for(var s=0;s<k.length;s++)n.url+="&"+k[s].name+"="+k[s].value;return n}(e,v);v=v||w.useHdrs;var _=$c();Jr(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var c=0;c<e.batches.length;c++)for(var m=e.batches[c].events(),k=0;k<m.length;k++){var T=m[k];if(I){var b=T.timings=T.timings||{};G(b,"sendEventStart",_),G(b,"serializationStart",n),G(b,"serializationCompleted",o)}T[Jl]>0?T[Jl]++:T[Jl]=1}V(e.batches,1e3+(r||0),e.sendType,!0);var A={data:e.payloadBlob,urlString:w.url,headers:w.hdrs,Oa:e,Ha:r,timeout:h,disableXhrSync:d,disableFetchKeepAlive:f};v&&(nh(A.headers,_l)||(A.headers[_l]="no-cache, no-store"),nh(A.headers,Cl)||(A.headers[Cl]=yl));var E=null;p&&(E=function(n){y.firstRequestSent();var o=function(n,o){!function(e,n,o,r){var a=9e3,c=null,u=!1,l=!1;try{var h=!0;if(typeof e!==In){if(n){y.setClockSkew(n[kl]);var d=n[Sl]||n["kill-duration-seconds"];Tr(g.setKillSwitchTenants(n["kill-tokens"],d),(function(t){Tr(o.batches,(function(e){if(e.iKey()===t){c=c||[];var n=e.split(0);o.numEvents-=n.count(),c.push(n)}}))}))}if(200==e||204==e)return void(a=200);(!function(t){return!(t>=300&&t<500&&408!=t&&429!=t||501==t||505==t)}(e)||o.numEvents<=0)&&(h=!1),a=9e3+e%1e3}if(h){a=100;var f=o.retryCnt;0===o.sendType&&(f<i?(u=!0,z((function(){0===o.sendType&&C--,j(o.batches,f+1,o.isTeardown,R?2:o.sendType,5)}),R,Bl(f))):(l=!0,R&&(a=8001)))}}finally{u||(y.setClockSkew(),function(e,n,i,o){try{o&&s.Ua(),200===n&&(o||e.isSync||s.Ma(),function(t){if(I){var e=$c();Tr(t,(function(t){t&&t.count()>0&&function(t,e){I&&Tr(t,(function(t){G(t.timings=t.timings||{},"sendEventCompleted",e)}))}(t.events(),e)}))}}(e.batches)),V(e.batches,n,e.sendType,!0)}finally{0===e.sendType&&(C--,5!==i&&t.sendQueuedRequests(e.sendType,i))}}(o,a,r,l)),V(c,8004,o.sendType)}}(n,o,e,r)},c=e.isTeardown||e.isSync;try{p.sendPOST(n,o,c),t.sendListener&&t.sendListener(A,n,c,e.isBeacon)}catch(t){Ls(a,"Unexpected exception sending payload. Ex:"+Ts(t)),M(o,0,{})}}),Jr(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(E)if(0===e.sendType&&C++,l&&!e.isBeacon&&3!==p.Na){var n={data:A.data,urlString:A.urlString,headers:zc({},A.headers),timeout:A.timeout,disableXhrSync:A.disableXhrSync,disableFetchKeepAlive:A.disableFetchKeepAlive},i=!1;Jr(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{t.sendHook(n,(function(t){i=!0,S||t.Oa||(t.Oa=t.Oa||A.Oa,t.Ha=t.Ha||A.Ha),E(t)}),e.isSync||e.isTeardown)}catch(t){i||E(A)}}))}else E(A)}))}),(function(){return{thePayload:e,serializationStart:n,serializationCompleted:o,sendReason:r}}),e.isSync)}e.sizeExceed&&e.sizeExceed.length>0&&V(e.sizeExceed,8003,e.sendType),e.failedEvts&&e.failedEvts.length>0&&V(e.failedEvts,8002,e.sendType)}function z(t,e,n){e?t():r.set(t,n)}function $(e){var n=t.Ea;try{for(var i=0;i<n.length;i++)try{n[i](e)}catch(t){Bs(a,1,519,"Response handler failed: "+t)}if(e){var o=JSON.parse(e);Wc(o.webResult)&&Wc(o.webResult[Pl])&&l.set("MSFPC",o.webResult[Pl],31536e3)}}catch(t){}}function V(t,e,n,i){if(t&&t.length>0&&o){var r=o[(c=e,l=Xl[c],Wc(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l=gl:c>=1e3&&c<=1999&&(l="send")),l)];if(r){var s=0!==n;Jr(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){z((function(){try{r.call(o,t,e,s,n)}catch(t){Bs(a,1,74,"send request notification failed: "+t)}}),i||s,0)}),(function(){return{batches:W(t),reason:e,isSync:s,sendSync:i,sendType:n}}),!s)}}var c,l}t.initialize=function(t,e,n,i,o){var r;o||(o={}),m=t+m,E=!!ur(o.avoidOptions)||!o.avoidOptions,u=e,l=e.getCookieMgr(),I=!u.config.disableEventTimings;var g=!!u.config.enableCompoundKey;a=(s=n).diagLog();var w=o.valueSanitizer,y=o.stringifyObjects;ur(o.enableCompoundKey)||(g=!!o.enableCompoundKey),h=o.xhrTimeout,d=!!o.disableXhrSync,f=!!o.disableFetchKeepAlive,v=!1!==o.addNoResponse,_=!Ss(),A=new $l(u,w,y,g),lr(o.useSendBeacon)||(_=!!o.useSendBeacon);var C=i,k=o.alwaysUseXhrOverride?i:null,T=o.alwaysUseXhrOverride?i:null,b=[3,2];if(!i){S=!1;var R=ys();R&&R.protocol&&"file:"===R.protocol.toLowerCase()&&(N=!1);var H=[];Ss()?(H=[2,1],b=[2,1,3]):H=[1,2,3],(i=P(H=oh(H,o.transports),!1))||Ls(a,"No available transport to send events"),C=P(H,!0)}k||(k=P(b=oh(b,o.unloadTransports),!0)),p=!S&&(_&&bs()||!f&&As(!0)),(r={})[0]=i,r[1]=C||P([1,2,3],!0),r[2]=k||C||P([1],!0),r[3]=T||P([2,3],!0)||C||P([1],!0),c=r},t.Da=function(){return[c[0],g,A,c]},t.addQueryStringParameter=function(t,e){for(var n=0;n<k.length;n++)if(k[n].name===t)return void(k[n].value=e);k.push({name:t,value:e})},t.addHeader=function(t,e){T[t]=e},t.canSendRequest=function(){return q()&&y.allowRequestSending()},t.sendQueuedRequests=function(t,e){ur(t)&&(t=0),R&&(t=x(t),e=2),L(b,t,0)&&j(B(),0,!1,t,e||0)},t.isCompletelyIdle=function(){return!w&&0===C&&0===b.length},t.setUnloading=function(t){R=t},t.addBatch=function(t){if(t&&t.count()>0){if(g.isTenantKilled(t.iKey()))return!1;b.push(t)}return!0},t.teardown=function(){b.length>0&&j(B(),0,!0,2,2)},t.pause=function(){w=!0},t.resume=function(){w=!1,t.sendQueuedRequests(0,4)},t.sendSynchronousBatch=function(t,e,n){t&&t.count()>0&&(lr(e)&&(e=1),R&&(e=x(e),n=2),j([t],0,!1,e,n||0))}}))}return t.__ieDyn=1,t}();function sh(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout(t,e,n)}function ah(t){clearTimeout(t)}function ch(t,e){return{set:t||sh,clear:e||ah}}var uh="eventsDiscarded",lh="overrideInstrumentationKey",hh="maxEventRetryAttempts",dh="maxUnloadEventRetryAttempts",fh=function(t){function e(){var n,i=t.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.12";var o,r,s,a,c,u,l,h=!1,d=[],f=null,p=!1,v=0,m=500,g=0,w=1e4,y={},_=pl,C=null,S=null,k=0,T=0,b={},A=-1,I=!0,R=!1,E=6,N=2;return Si(e,i,(function(t,e){function i(t){"beforeunload"!==(t||ps().event).type&&(R=!0,r.setUnloading(R)),q(2,2)}function P(t){R=!1,r.setUnloading(R)}function H(t,e){if(t.sendAttempt||(t.sendAttempt=0),t.latency||(t.latency=1),t.ext&&t.ext[Hl]&&delete t.ext[Hl],t.ext&&t.ext[Ol]&&t.ext[Ol].id&&delete t.ext[Ol].id,I&&(t.ext=Lr(t.ext),t.baseData&&(t.baseData=Lr(t.baseData)),t.data&&(t.data=Lr(t.data))),t.sync)if(k||p)t.latency=3,t.sync=!1;else if(r)return I&&(t=Lr(t)),void r.sendSynchronousBatch(Dl.create(t.iKey,[t]),!0===t.sync?1:t.sync,3);var n=t.latency,i=g,o=w;4===n&&(i=v,o=m);var s=!1;if(i<o)s=!W(t,e);else{var a=1,c=20;4===n&&(a=4,c=1),s=!0,function(t,e,n,i){for(;n<=e;){var o=B(t,e,!0);if(o&&o.count()>0){var r=o.split(0,i),s=r.count();if(s>0)return 4===n?v-=s:g-=s,X(uh,[r],fl.QueueFull),!0}n++}return j(),!1}(t.iKey,t.latency,a,c)&&(s=!W(t,e))}s&&Q(uh,[t],fl.QueueFull)}function O(t,e,n){var i=G(t,e,n);return r.sendQueuedRequests(e,n),i}function U(){return g>0}function M(){if(A>=0&&G(A,0,c)&&r.sendQueuedRequests(0,c),v>0&&!S&&!p){var t=y[_][2];t>=0&&(S=F((function(){S=null,O(4,0,1),M()}),t))}var e=y[_][1];!C&&!f&&e>=0&&!p&&(U()?C=F((function(){C=null,O(0===T?3:1,0,1),T++,T%=2,M()}),e):T=0)}function D(){n=null,h=!1,d=[],f=null,p=!1,v=0,m=500,g=0,w=1e4,y={},_=pl,C=null,S=null,k=0,T=0,o=null,b={},s=void 0,a=0,A=-1,c=null,I=!0,R=!1,E=6,N=2,u=null,l=ch(),r=new rh(500,2,1,{requeue:V,send:Y,sent:Z,drop:tt,rspFail:et,oth:nt},l),$(),b[4]={batches:[],iKeyMap:{}},b[3]={batches:[],iKeyMap:{}},b[2]={batches:[],iKeyMap:{}},b[1]={batches:[],iKeyMap:{}},it()}function F(t,e){0===e&&k&&(e=1);var n=1e3;return k&&(n=Bl(k-1)),l.set(t,e*n)}function x(){return null!==C&&(l.clear(C),C=null,T=0,!0)}function q(t,e){x(),f&&(l.clear(f),f=null),p||O(1,t,e)}function B(t,e,n){var i=b[e];i||(i=b[e=1]);var o=i.iKeyMap[t];return!o&&n&&(o=Dl.create(t),i.batches.push(o),i.iKeyMap[t]=o),o}function L(e,n){r.canSendRequest()&&!k&&(s>0&&g>s&&(n=!0),n&&null==f&&t.flush(e,null,20))}function W(t,e){I&&(t=Lr(t));var n=t.latency,i=B(t.iKey,n,!0);return!!i.addEvent(t)&&(4!==n?(g++,e&&0===t.sendAttempt&&L(!t.sync,a>0&&i.count()>=a)):v++,!0)}function j(){for(var t=0,e=0,n=function(n){var i=b[n];i&&i.batches&&Tr(i.batches,(function(i){4===n?t+=i.count():e+=i.count()}))},i=1;i<=4;i++)n(i);g=e,v=t}function G(e,n,i){var o=!1,s=0===n;return!s||r.canSendRequest()?Jr(t.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var t=[],n=4;n>=e;){var i=b[n];i&&i.batches&&i.batches.length>0&&(Tr(i.batches,(function(e){r.addBatch(e)?o=o||e&&e.count()>0:t=t.concat(e.events()),4===n?v-=e.count():g-=e.count()})),i.batches=[],i.iKeyMap={}),n--}t.length>0&&Q(uh,t,fl.KillSwitch),o&&A>=e&&(A=-1,c=0)}),(function(){return{latency:e,sendType:n,sendReason:i}}),!s):(A=A>=0?Math.min(A,e):e,c=Math.max(c,i)),o}function K(t,e){O(1,0,e),j(),z((function(){t&&t(),d.length>0?f=F((function(){f=null,K(d.shift(),e)}),0):(f=null,M())}))}function z(t){r.isCompletelyIdle()?t():f=F((function(){f=null,z(t)}),.25)}function $(){(y={})[pl]=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function V(e,n){var i=[],o=E;R&&(o=N),Tr(e,(function(e){e&&e.count()>0&&Tr(e.events(),(function(e){e&&(e.sync&&(e.latency=4,e.sync=!1),e.sendAttempt<o?(Vc(e,t.identifier),H(e,!1)):i.push(e))}))})),i.length>0&&Q(uh,i,fl.NonRetryableStatus),R&&q(2,2)}function J(e,n){var i=t.Fa||{},o=i[e];if(o)try{o.apply(i,n)}catch(n){Bs(t.diagLog(),1,74,e+" notification failed: "+n)}}function Q(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&e.length>0&&J(t,[e].concat(n))}function X(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&e.length>0&&Tr(e,(function(e){e&&e.count()>0&&J(t,[e.events()].concat(n))}))}function Y(t,e,n){t&&t.length>0&&J("eventsSendRequest",[e>=1e3&&e<=1999?e-1e3:0,!0!==n])}function Z(t,e){X("eventsSent",t,e),M()}function tt(t,e){X(uh,t,e>=8e3&&e<=8999?e-8e3:fl.Unknown)}function et(t){X(uh,t,fl.NonRetryableStatus),M()}function nt(t,e){X(uh,t,fl.Unknown),M()}function it(){a=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,w/6)}D(),t.Da=function(){return[r]},t.initialize=function(a,c,h){Jr(c,(function(){return"PostChannel:initialize"}),(function(){var d,f,p,v,g=c;e.initialize(a,c,h);try{c.addUnloadCb,u=Nc(ta(t.identifier),c.evtNamespace&&c.evtNamespace());var y=t.Ta();a.extensionConfig[t.identifier]=a.extensionConfig[t.identifier]||{},n=y.getExtCfg(t.identifier),l=ch(n.setTimeoutOverride,n.clearTimeoutOverride),I=!n.disableOptimizeObj&&!!ds("chrome"),function(t){var e=t.getWParam;t.getWParam=function(){var t=0;return n.ignoreMc1Ms0CookieProcessing&&(t|=2),t|e()}}(g),n.eventsLimitInMem>0&&(w=n.eventsLimitInMem),n.immediateEventLimit>0&&(m=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(s=n.autoFlushEventsLimit),_r(n[hh])&&(E=n[hh]),_r(n[dh])&&(N=n[dh]),it(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(o=n.httpXHROverride),Wc(a.anonCookieName)&&r.addQueryStringParameter("anoncknm",a.anonCookieName),r.sendHook=n.payloadPreprocessor,r.sendListener=n.payloadListener;var _=n.overrideEndpointUrl?n.overrideEndpointUrl:a.endpointUrl;t.Fa=c.getNotifyMgr(),r.initialize(_,t.core,t,o,n);var C=a.disablePageUnloadEvents||[];d=[gc,mc,pc],p=C,v=u,(f=i)&&d&&wr(d)&&!Oc(d,f,p,v)&&p&&p[Hi]>0&&Oc(d,f,null,v),Mc(i,C,u),Dc(P,a.disablePageShowEvents,u)}catch(e){throw t.setInitialized(!1),e}}),(function(){return{coreConfig:a,core:c,extensions:h}}))},t.processTelemetry=function(e,i){Vc(e,t.identifier);var o=(i=t.Ta(i)).getExtCfg(t.identifier),r=!!n.disableTelemetry;o&&(r=r||!!o.disableTelemetry);var s=e;r||h||(n[lh]&&(s.iKey=n[lh]),o&&o[lh]&&(s.iKey=o[lh]),H(s,!0),R?q(2,2):M()),t.processNext(s,i)},t.Ra=function(t,e){var n;q(2,2),h=!0,r.teardown(),Uc([gc,mc,pc],null,u),n=Nc(wc,u),Uc([pc],null,n),Uc([fc],null,n),function(t,e){var n=Nc(yc,e);Uc([vc],null,n),Uc([fc],null,n)}(0,u),D()},t.setEventQueueLimits=function(t,e){w=t>0?t:1e4,s=e>0?e:0,it();var n=g>t;if(!n&&a>0)for(var i=1;!n&&i<=3;i++){var o=b[i];o&&o.batches&&Tr(o.batches,(function(t){t&&t.count()>=a&&(n=!0)}))}L(!0,n)},t.pause=function(){x(),p=!0,r.pause()},t.resume=function(){p=!1,r.resume(),M()},t.addResponseHandler=function(t){r.Ea.push(t)},t.xa=function(t){x(),$(),_=pl,M(),vr(t,(function(t,e){var n=e.length;if(n>=2){var i=n>2?e[2]:0;if(e.splice(0,n-2),e[1]<0&&(e[0]=-1),e[1]>0&&e[0]>0){var o=e[0]/e[1];e[0]=Math.ceil(o)*e[1]}i>=0&&e[1]>=0&&i>e[1]&&(i=e[1]),e.push(i),y[t]=e}}))},t.flush=function(t,e,n){if(void 0===t&&(t=!0),!p)if(n=n||1,t)null==f?(x(),G(1,0,n),f=F((function(){f=null,K(e,n)}),0)):d.push(e);else{var i=x();O(1,1,n),null!=e&&e(),i&&M()}},t.setMsaAuthTicket=function(t){r.addHeader(El,t)},t.hasEvents=U,t.qa=function(t){_!==t&&void 0!==y[t]&&(x(),_=t,M())},t.Ua=function(){k<4&&(k++,x(),M())},t.Ma=function(){k&&(k=0,x(),M())},Nr(t,"_setTimeoutOverride",(function(){return l.set}),(function(t){l=ch(t,l.clear)})),Nr(t,"_clearTimeoutOverride",(function(){return l.clear}),(function(t){l=ch(l.set,t)}))})),i}return Wn(e,t),e.__ieDyn=1,e}(Ka);const ph=fh;var vh=function(t){function e(){var n,i,o=t.call(this)||this;return Si(e,o,(function(t,e){t.initialize=function(t,r){var s=o;Jr(o,(function(){return"ApplicationInsights:initialize"}),(function(){n=new ph;var o=[i=new hl];r&&(o=o.concat(r)),t||qr("You must provide a config object!");var a=t.channels;if(a&&a.length>0){for(var c=!1,u=0;u<a[0].length;u++)if(a[0][u].identifier===n.identifier){c=!0;break}c||a[0].push(n)}else t.channels=[[n]];var l=t.extensionConfig=t.extensionConfig||[];l[n.identifier]=l[n.identifier]||t&&t.channelConfiguration||{},l[i.identifier]=l[i.identifier]||t&&t.propertyConfiguration||{};try{e.initialize(t,o)}catch(t){Bs(s.logger,1,514,"Failed to initialize SDK."+Ts(t))}}),(function(){return{config:t,extensions:r}}))},t.getPropertyManager=function(){return i},t.getPostChannel=function(){return n}})),o}return Wn(e,t),e.__ieDyn=1,e}(Xc);const mh=vh,gh={...yn.Ak,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedClientApplicationSendSSOSilentRequest",EmbeddedClientApplicationSendPopupRequest:"embeddedClientApplicationSendPopupRequest",EmbeddedClientApplicationSendRedirectRequest:"embeddedClientApplicationSendRedirectRequest",EmbeddedClientApplicationHandleRedirectRequest:"embeddedClientApplicationHandleRedirectRequest",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedClientApplicationSendSilentRefreshRequest"},wh=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);class yh{constructor(t,e){this.logger=t,this.isSampled=!e?.disabled&&this.calculateSampling(e?.samplingPercentage),this.logger.verbose(`PerformanceTelemetryReporter: Sampled for 1p telemetry: ${this.isSampled.toString()}`),this.eventsToEmit=e?.eventsToEmit||[gh.AcquireTokenSilent,gh.SsoSilent,gh.AcquireTokenByCode,gh.InitializeClientApplication],this.logger.verbose(`PerformanceTelemetryReporter: Events to be tracked include : ${this.eventsToEmit}`),this.logger.verbose(`PerformanceTelemetryReporter: Events passed in the PerformanceTelemetryConfiguration are: ${e?.eventsToEmit}`);const n={instrumentationKey:yh.instrumentationKey,extensions:[]};this.appInsights=new mh,this.appInsights.initialize(n,[]),this.logger.verbose("PerformanceTelemetryReporter: Initialized")}calculateSampling(t){return 0===t?(this.logger.verbose(" PerformanceTelemetryReporter: No sampling rate configured."),!1):(this.logger.verbose(`PerformanceTelemetryReporter: Configured sampling rate = ${t} `),this.logger.verbose(`PerformanceTelemetryReporter: DEFAULT sampling rate = ${yh.DEFAULT_SAMPLING_RATE}`),Math.random()<=(t||yh.DEFAULT_SAMPLING_RATE))}sendCustomEvent(t){const e={...t,appName:void 0},n={name:t.name,data:e};this.logger.verbose(`PerformanceTelemetryReporter: Sending ${n.name} for tracking`),this.appInsights.track(n)}canSendEvent(t){const e=!this.eventsToEmit||this.eventsToEmit?.indexOf(t.name)>-1,n=yh.DEFAULT_ALLOWED_CLOUDS.some((e=>0===t.authority.indexOf(e.toString())));return this.isSampled&&e&&n}getPerformanceTelemetryCallback(){return this.logger.trace("PerformanceTelemetryReporter: Attaching callback to send custom metrics."),this.logger.verbose(" PerformanceTelemetryReporter: Returning callback as telemetry emitted."),t=>{t.forEach((t=>{this.canSendEvent(t)?(this.logger.verbose(`PerformanceTelemetryReporter: Emitting telemetry for ${t.name}`,t.correlationId),this.sendCustomEvent(t)):this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${t.name}`,t.correlationId)}))}}}yh.DEFAULT_SAMPLING_RATE=.1,yh.DEFAULT_ALLOWED_CLOUDS=[Tn.z.AzurePublic,Tn.z.AzurePpe],yh.instrumentationKey="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725";class _h extends wn{constructor(t,e){e?.disabled||t.telemetry?.client||(t.telemetry={...t.telemetry,client:t.telemetry?.client||new kn(t,wh)}),super(t);const n=new yh(this.getLogger(),e);this.addPerformanceCallback(n.getPerformanceTelemetryCallback())}}var Ch,Sh,kh=s(5483),Th=s(2656),bh=null===(Ch=document.getElementById("owl"))||void 0===Ch?void 0:Ch.dataset,Ah="e03a13ee-9730-4cae-8525-47559c8cf18a",Ih="6a2a0a9e-6f11-4d59-b8a1-afd8bfd2401c";function Rh(t,e,i,o,r){return(0,n.mG)(this,void 0,void 0,(function(){var s,a,c,u,l,h,d,m,g,y,_,S=this;return(0,n.Jh)(this,(function(k){switch(k.label){case 0:return[4,t];case 1:return s=k.sent(),a=null===e?(0,w.n)()[0]:e,(0,v.l)(C.OwlGetAccountByUsernameStart),c=(0,v.a)(),u=i?s.getAccountByUsername(i):null,(0,v.l)(C.OwlGetAccountByUsernameEnd),l=(0,v.a)(),null==o||o.ULS.sendTraceTag(508053090,f.W.Xn,p.G.Warning,"[OWL] Msal get user account from cache, take time: ".concat(l-c)),null!==u?[3,3]:[4,Nh(s,a,i,o)];case 2:return(h=k.sent())?[2,h.accessToken]:[2,Promise.reject("SsoSilent login failed")];case 3:if(r)try{d=atob(r)}catch(t){return[2,Promise.reject("Failed to decode claims")]}return m={correlationId:e,account:u,scopes:["".concat(Ah,"/.default")],claims:d},(0,v.l)(C.OwlTryGetWacTokenStart),g=(0,v.a)(),y=s.acquireTokenSilent(m),_="",[4,y.then((function(t){if(t.fromCache)if(r){(0,v.l)(C.OwlTryGetWacTokenWithClaimsFromCacheEnd);var e=(0,v.a)();null==o||o.ULS.sendTraceTag(508045138,f.W.Xn,p.G.Warning,"[OWL] Msal get wac token silently with claims from cache succeed, take time: ".concat(e-g))}else{(0,v.l)(C.OwlTryGetWacTokenFromCacheEnd);var n=(0,v.a)();null==o||o.ULS.sendTraceTag(508122775,f.W.Xn,p.G.Warning,"[OWL] Msal get wac token silently from cache succeed, take time: ".concat(n-g))}else if(r){(0,v.l)(C.OwlTryGetWacTokenWithClaimsEnd);var i=(0,v.a)();null==o||o.ULS.sendTraceTag(508045137,f.W.Xn,p.G.Warning,"[OWL] Msal get wac token silently with claim succeed, take time: ".concat(i-g))}else{(0,v.l)(C.OwlTryGetWacTokenEnd);var s=(0,v.a)();null==o||o.ULS.sendTraceTag(508155349,f.W.Xn,p.G.Info,"[OWL] Msal get wac token silently succeed, take time: ".concat(s-g))}_=t.accessToken})).catch((function(t){return(0,n.mG)(S,void 0,void 0,(function(){var e;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return A.Fh.FeatureGate_EcsHootGate&&t instanceof un.Yo?[4,Hh(s,m,o)]:[3,2];case 1:return e=n.sent(),_=e.accessToken,[3,3];case 2:null==o||o.ULS.sendTraceTag(508123353,f.W.Xn,p.G.Warning,"[OWL] Msal failed to get wac token silently: error ".concat(t)),n.label=3;case 3:return[2]}}))}))}))];case 4:return k.sent(),[2,_]}}))}))}function Eh(t,e){var i=this,o=function(t){var e,n;return{appIds:[Ih],authority:null!==(e=N||(null==bh?void 0:bh.authority))&&void 0!==e?e:"",authorityType:t.isMsa?"msa":"aad",upn:null!==(n=t.loginHint||t.upn)&&void 0!==n?n:"string"==typeof t.customAuthConfigValue?JSON.parse(t.customAuthConfigValue).login_Hint:""}}(t);return new Promise((function(t){return(0,n.mG)(i,void 0,void 0,(function(){var i,r,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return o.authority&&(o.authority=o.authority.replace(Sh.ProdLegacy,Sh.Prod)),"msa"===o.authorityType.toLowerCase()?o.authority=Sh.Prod+Sh.MsaSuffix:(o.authority||(o.authority=Sh.Prod+Sh.AadSuffix),o.authority.indexOf(Sh.AadSuffix)<0&&("/"===o.authority.charAt(o.authority.length-1)?o.authority+=Sh.AadSuffix:o.authority+="/"+Sh.AadSuffix)),i={auth:{authority:o.authority,clientId:Ih,redirectUri:"/suite/OAuth.html",clientCapabilities:["CP1"]},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},r={disabled:!1,samplingPercentage:1},(0,v.l)(C.OwlMsalInitStart),s=new _h(i,r),a=(0,v.a)(),[4,s.initialize()];case 1:return n.sent(),(0,v.l)(C.OwlMsalInitEnd),c=(0,v.a)(),null==e||e.ULS.sendTraceTag(508143306,f.W.Xn,p.G.Info,"[OWL] Msal init time: ".concat(c-a)),t(s),[2]}}))}))}))}function Nh(t,e,i,o){return(0,n.mG)(this,void 0,void 0,(function(){var r,s,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:r={loginHint:i,correlationId:e,scopes:["".concat(Ah,"/.default")]},n.label=1;case 1:return n.trys.push([1,3,,6]),(0,v.l)(C.OwlMsalSsoSilentStart),s=(0,v.a)(),[4,t.ssoSilent(r)];case 2:return(a=n.sent())&&(c=(0,v.a)(),(0,v.l)(C.OwlMsalSsoSilentEnd),null==o||o.ULS.sendTraceTag(508143305,f.W.Xn,p.G.Info,"[OWL] Msal ssoSilent succeed, take time: ".concat(s-c))),[2,a];case 3:return u=n.sent(),A.Fh.FeatureGate_EcsHootGate&&u instanceof un.Yo?[4,Ph(t,r,o)]:[3,5];case 4:return[2,n.sent()];case 5:return null==o||o.ULS.sendTraceTag(508143303,f.W.Xn,p.G.Warning,"[OWL] Msal ssoSilent failed, error: ".concat(u)),[2,Promise.reject(u)];case 6:return[2]}}))}))}function Ph(t,e,i,o){return void 0===o&&(o=2),(0,n.mG)(this,void 0,void 0,(function(){var r,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),(0,v.l)(C.OwlMsalLoginPopupStart),r=(0,v.a)(),[4,t.loginPopup(e)];case 1:return(s=n.sent())&&(a=(0,v.a)(),(0,v.l)(C.OwlMsalLoginPopupEnd),null==i||i.ULS.sendTraceTag(508123352,f.W.Xn,p.G.Info,"[OWL] Msal loginPopup succeed, take time: ".concat(a-r))),[2,s];case 2:return(c=n.sent())instanceof kh.Ut&&c.errorCode===Th.E&&document.getElementById("authenticationButton")?[4,Ph(t,e,i,o-1)]:[3,4];case 3:n.sent(),n.label=4;case 4:return null==i||i.ULS.sendTraceTag(508123351,f.W.Xn,p.G.Warning,"[OWL] Msal loginPopup failed"),[2,Promise.reject(c)];case 5:return[2]}}))}))}function Hh(t,e,i,o){return void 0===o&&(o=2),(0,n.mG)(this,void 0,void 0,(function(){var r=this;return(0,n.Jh)(this,(function(s){return[2,new Promise((function(s){return(0,n.mG)(r,void 0,void 0,(function(){var r,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),(0,v.l)(C.OwlTryGetWacTokenPopupStart),r=(0,v.a)(),[4,t.acquireTokenPopup(e)];case 1:return(a=n.sent())&&(c=(0,v.a)(),(0,v.l)(C.OwlTryGetWacTokenPopupEnd),null==i||i.ULS.sendTraceTag(508123355,f.W.Xn,p.G.Info,"[OWL] Msal get wac token through popup succeed, take time: ".concat(c-r)),s(a)),[3,5];case 2:return(u=n.sent())instanceof kh.Ut&&u.errorCode===Th.E&&o>0&&document.getElementById("authenticationButton")?[4,Hh(t,e,i,o-1)]:[3,4];case 3:n.sent(),n.label=4;case 4:return null==i||i.ULS.sendTraceTag(508123354,f.W.Xn,p.G.Warning,"[OWL] Msal failed to get wac token through popup: error ".concat(u)),[3,5];case 5:return[2]}}))}))}))]}))}))}!function(t){t.Prod="https://login.microsoftonline.com/",t.ProdLegacy="https://login.windows.net/",t.Ppe="https://login.windows-ppe.net/",t.AadSuffix="organizations",t.MsaSuffix="consumers"}(Sh||(Sh={}));var Oh=s(7822),Uh="WacDataCenter";function Mh(t){switch(t){case T.T.Word:case T.T.PowerPoint:case T.T.Excel:case T.T.OneNote:case T.T.Visio:return"".concat(t.toString()).concat(Uh);default:return}}function Dh(t){var e,n=Mh(t),i=n?null===localStorage||void 0===localStorage?void 0:localStorage.getItem(n):void 0;return null!==(e=null!=i?i:null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Uh))&&void 0!==e?e:void 0}function Fh(t,e){if(e){null===localStorage||void 0===localStorage||localStorage.setItem(Uh,e);var n=Mh(t);n&&(null===localStorage||void 0===localStorage||localStorage.setItem(n,e))}}var xh,qh,Bh,Lh=s(4994),Wh=s(3159);function jh(t,e,i,o,r){var s=this;void 0===i&&(i=!1),m.c.driveItemStartTime=(0,v.a)(),(0,v.l)("driveItemStartTime"),xh||(xh=new Map);var a=xh.get(t);if(!i&&a&&a.promise&&(!a.expiryTime||a.expiryTime>new Date))return m.c.driveItemEndTime=(0,v.a)(),(0,v.l)("driveItemEndTime"),null==o||o.ULS.sendTraceTag(553726288,f.W.Xn,p.G.Info,"GetDriveItem: Returning drive item from the cache"),a.promise;null==o||o.ULS.sendTraceTag(553726289,f.W.Xn,p.G.Info,"GetDriveItem: Invalidating the cache"),xh.delete(t),null==o||o.ULS.sendTraceTag(546182045,f.W.Xn,p.G.Info,"GetDriveItem: About to make the fetch call to get drive item");var c=t,u={method:Lh.hx.Get,headers:e.headers};if((0,A.dt)(A.Fh.FeatureGate_BypassOPTIONSCall,r,o),r){c=t.concat("&ump=1");var l=function(t){var e=(0,Wh.c)(),i=[];return i.push("--".concat(e)),void 0!==t&&Object.entries(t).forEach((function(t){var e=(0,n.CR)(t,2),o=e[0],r=e[1];void 0!==r&&i.push("".concat(o,": ").concat(r))})),i.push("X-HTTP-Method-Override: GET"),i.push("\r\n--".concat(e,"--")),{body:i.join("\r\n"),headers:{"Content-Type":"multipart/form-data;boundary=".concat(e)}}}(e.headers),h=l.body,d=l.headers;u={method:Lh.hx.Post,headers:d,body:h},null==o||o.ULS.sendTraceTag(508961629,f.W.Xn,p.G.Info,"GetDriveItem: POST request to get drive item: content-length : ".concat(h.length))}var g=fetch(c,u).catch((function(t){return Promise.reject({api:"getItem",failure:t,message:"Fetch call failed",retry:!0})})).then((function(e){return(0,n.mG)(s,void 0,void 0,(function(){var i,r,s,a,c,u,l,h,d,v;return(0,n.Jh)(this,(function(w){switch(w.label){case 0:if(200===e.status)return i=e.json().then((function(t){return t||Promise.reject({api:"getItem",status:e.status,message:"Ok httpStatus, invalid response"})})),r=new Map,a=null===(c=null==e?void 0:e.headers)||void 0===c?void 0:c.get("SPRequestGuid"),m.c.spRequestGuid=null!=a?a:void 0,r.set("SPRequestGuid",a),null==o||o.ULS.sendTraceTag(554964099,f.W.Xn,p.G.Info,"GetDriveItem:  [VroomResponseHeaders: ".concat(JSON.stringify(r),"]")),xh.set(t,{promise:g,expiryTime:(y=new Date,new Date(y.getFullYear(),y.getMonth(),y.getDate(),y.getHours()+24,y.getMinutes(),y.getSeconds(),y.getMilliseconds()))}),[2,i];w.label=1;case 1:return w.trys.push([1,3,,4]),[4,e.json()];case 2:return s=w.sent(),a=null===(u=null==e?void 0:e.headers)||void 0===u?void 0:u.get("SPRequestGuid"),m.c.spRequestGuid=null!=a?a:void 0,[2,Promise.reject((0,n.pi)((0,n.pi)({api:"getItem",SPRequestGuid:a,status:e.status,errorCode:null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.code,innerErrorCode:null===(d=null===(h=null==s?void 0:s.error)||void 0===h?void 0:h.innerError)||void 0===d?void 0:d.code,message:null===(v=null==s?void 0:s.error)||void 0===v?void 0:v.message,redirectLocation:(null==s?void 0:s.error)?null==s?void 0:s.error["@error.redirectLocation"]:void 0},Gh(e)),{retry:429===e.status||e.status>=500}))];case 3:return w.sent(),[2,Promise.reject({api:"getItem",status:e.status,message:"request failed, could not retrieve error object."})];case 4:return[2]}var y}))}))})).finally((function(){m.c.driveItemEndTime=(0,v.a)(),(0,v.l)("driveItemEndTime")}));return g}function Gh(t){var e,i,o,r=null===(o=null==t?void 0:t.headers)||void 0===o?void 0:o.get("www-authenticate"),s=void 0,a=void 0;if(r){var c=r.split(",");if(c)try{for(var u=(0,n.XA)(c),l=u.next();!l.done;l=u.next()){var h=l.value,d=h&&h.trim();d&&d.startsWith("error=")?s=d.split('"')[1]:d&&d.startsWith("claims=")&&(a=[d.split('"')[1]])}}catch(t){e={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}}return{claimsError:s,claims:a}}var Kh="getItemFromWac",zh="x-behind-service-response-status",$h="GetDriveItem",Vh=new Map,Jh="owlfc";function Qh(t,e,i){return(0,n.mG)(this,void 0,void 0,(function(){var o;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:qh=(0,v.a)(),Vh.set("StartTime",qh.toString()),i||null==e||e.ULS.sendTraceTag(526951836,f.W.Xn,p.G.Info,"GetDriveItem: Health object not initialized"),null==i||i.recordKpiUsage($h,k.o.FailureBased,Jh,Vh),Vh.delete("StartTime"),m.c.driveItemFromWacStartTime=(0,v.a)(),(0,v.l)("driveItemFromWacStartTime"),n.label=1;case 1:return n.trys.push([1,3,4,5]),null==e||e.ULS.sendTraceTag(523867683,f.W.Xn,p.G.Info,"GetDriveItem: About to make the fetch call to get drive item"),[4,fetch(t.url,{method:t.method,headers:t.headers,body:JSON.stringify(t.body)})];case 2:return[2,Xh(n.sent(),e,i)];case 3:return o=n.sent(),Bh=(0,v.a)(),Vh.set("DriveItemError",JSON.stringify(o)),Vh.set("FailureTime",Bh.toString()),null==i||i.recordKpiFailure($h,"GetDriveItemFromHootFailed",!1,!1,{durationMs:Bh-qh,extendedProperties:Vh}),[2,Promise.reject({api:Kh,failure:o,message:"Failed to post request to Hoot"})];case 4:return m.c.driveItemFromWacEndTime=(0,v.a)(),(0,v.l)("driveItemFromWacEndTime"),[7];case 5:return[2]}}))}))}function Xh(t,e,i){var o,r,s;return(0,n.mG)(this,void 0,void 0,(function(){var a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(t.status===He.W.OK)return[2,Yh(t,e)];Bh=(0,v.a)(),Vh.set("FailureTime",Bh.toString()),null==i||i.recordKpiFailure($h,"WacHootServiceNotAvailable",!1,!0,{durationMs:Bh-qh,extendedProperties:Vh}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.json()];case 2:return a=n.sent(),c=null===(o=null==t?void 0:t.headers)||void 0===o?void 0:o.get("SPRequestGuid"),m.c.spRequestGuid=null!=c?c:void 0,[2,Promise.reject({api:Kh,SPRequestGuid:c,status:t.status,errorCode:null===(r=null==a?void 0:a.error)||void 0===r?void 0:r.code,message:null===(s=null==a?void 0:a.error)||void 0===s?void 0:s.message})];case 3:return n.sent(),[2,Promise.reject({api:Kh,status:t.status,message:"Request to Hoot failed, could not reach out Hoot for retrieving object."})];case 4:return[2]}}))}))}function Yh(t,e){var i,o,r=null===(i=null==t?void 0:t.headers)||void 0===i?void 0:i.get(zh),s=r?parseInt(r,10):He.W.InternalServiceError,a=new Map,c=null===(o=null==t?void 0:t.headers)||void 0===o?void 0:o.get("SPRequestGuid");return m.c.spRequestGuid=null!=c?c:void 0,a.set("SPRequestGuid",c),null==e||e.ULS.sendTraceTag(526951837,f.W.Xn,p.G.Info,"GetDriveItemFromWac: [VroomResponseHeaders: ".concat(JSON.stringify(a),"]. The http response status code from downstream service to Hoot: ").concat(s.toString())),s===He.W.OK?t.json().then((function(e){return e||Promise.reject({api:Kh,SPRequestGuid:c,status:t.status,message:"Ok httpStatus, invalid response"})})):Promise.reject((0,n.pi)({api:Kh,SPRequestGuid:c,status:t.status,sharePointCallStatus:s,message:"Post request to Hoot succeed, Hoot failed to retrieve object from downstream service."},Gh(t)))}var Zh="Failed to parse stringified drive item.";function td(t,e,i,o,r,s,a,c,u){return(0,n.mG)(this,void 0,void 0,(function(){var l,h,d,m,w,y,_,S,k,T,b;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return l={docBootInfo:t,essOptions:e,api:r},h=(0,g.XQ)(o,s),(0,v.l)(C.OwlMsalGetAccessTokenStart),[4,Rh(i,s,a,c)];case 1:if(!(d=n.sent()))return[2,Promise.reject("Failed to fetch necessary Wac token.")];(0,v.l)(C.OwlMsalGetAccessTokenEnd),w=ed(m={accept:"application/json"},l,h,s,d),n.label=2;case 2:return n.trys.push([2,4,,9]),(0,v.l)(C.OwlGetDriveItemStart),[4,Qh(w,c,u)];case 3:if(!(T=n.sent()))return[2,Promise.reject("Failed to fetch DriveItem from Hoot.")];if((0,v.l)(C.OwlGetDriveItemEnd),!(b=nd(T,c)))throw new SyntaxError(Zh);return[2,b];case 4:return(y=n.sent())instanceof SyntaxError||null==c||c.ULS.sendTraceTag(508155348,f.W.Xn,p.G.Warning,"Failed to get vroom data from Hoot. [Error: ".concat(JSON.stringify(y),"] [Reason: ").concat(null==y?void 0:y.failure,"]")),y&&401===y.sharePointCallStatus&&"insufficient_claims"===y.claimsError&&y.claims?(null==c||c.ULS.sendTraceTag(508155347,f.W.Xn,p.G.Warning,"Hoot Vroom call failed with claims challenge, retrying with claims."),[4,Rh(i,s,a,c,y.claims)]):[3,7];case 5:return(_=n.sent())?[4,Qh(ed(m,l,h,s,_),c,u)]:[2,Promise.reject("Failed to fetch necessary Wac token with Claims")];case 6:return S=n.sent(),(k=nd(S,c))?[2,k]:[2,Promise.reject(Zh)];case 7:return[4,Qh(w,c,u)];case 8:return T=n.sent(),(b=nd(T,c))?[2,b]:[2,Promise.reject(Zh)];case 9:return[2]}}))}))}function ed(t,e,i,o,r){var s,a={Authorization:null!==(s=id(r).Authorization)&&void 0!==s?s:"",SessionId:o},c=(0,n.pi)((0,n.pi)({},e),{optionsHttpRequestHeaders:a});return{url:i,method:Lh.hx.Post,headers:t,body:c}}function nd(t,e){try{return JSON.parse(t.graphDriveItem)}catch(t){return null==e||e.ULS.sendTraceTag(508155346,f.W.Xn,p.G.Error,"Failed to parse Vroom response from JSON string. [".concat(t.name,": ").concat(t.message,"]")),null}}function id(t,e){var n=null!=e?e:{};return t?(n.Authorization="Bearer ".concat(t).trim(),n):n}var od=s(9895);function rd(t){if(t&&t.length){if(t.match(_t.pK)||t.match(_t.XU))return"OneDrive";if(t.match(_t.VJ))return"SharePoint";if(t.match(_t.JK))return"Graph"}}var sd=function(t){return"action=".concat(t)},ad=function(t){return(null==t?void 0:t.isESSEnabled)&&(null==t?void 0:t.wacDataCenter)?[cd(null==t?void 0:t.wacDataCenter),ud(null==t?void 0:t.sessionId),ld(null==t?void 0:t.hostCorrelationId)]:[]},cd=function(t){return t?"WacDataCenter=".concat(t):void 0},ud=function(t){return t?"usid=".concat(t):void 0},ld=function(t){return t?"hid=".concat(t):void 0},hd=function(t){return t&&t.length?"$select="+t.join(","):void 0};function dd(t){return(0,od.sm)(t,{accept:"application/json",prefer:"allow-zerobyte"})}function fd(t,e,i,o,r,s,a,c){return void 0===r&&(r=!1),void 0===c&&(c=dd),(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return t?[2,e(i,r,o,void 0,!0).then(c).then((function(e){return jh(t,{headers:e},r,s,a)})).catch((function(n){return null==s||s.ULS.sendTraceTag(512255580,f.W.Xn,p.G.Warning,"GetDriveItemWithUrl: error when trying to getDriveItem: ".concat(n)),n&&401===n.status&&"insufficient_claims"===n.claimsError&&"authChallengeRequired"===n.innerErrorCode&&n.claims?(null==s||s.ULS.sendTraceTag(523076960,f.W.Xn,p.G.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),e(i,r,o,void 0,!0,n.claims).then(c).then((function(e){return jh(t,{headers:e},r,s,a)}))):Promise.reject(n)}))]:[2,Promise.reject("No api endpoint given")]}))}))}function pd(t){var e={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,od.sm)(t,e),e}var vd,md=function(t){return t?"expand=thumbnails":""};function gd(t,e,i,o,r,s,a,c,u){void 0===o&&(o=!1),void 0===r&&(r="open"),void 0===s&&(s=!1);var l=i.inMockMode,h=i.getAccessToken,d=function(t,e){try{null==e||e.ULS.sendTraceTag(541870043,f.W.Xn,p.G.Info,"getSharesUrl: Start constructing shares Url");for(var n=t.replace(/[,@+$#]/g,(function(t){return encodeURIComponent(t)})),i=window.btoa((s=encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})),a=void 0,(a=s)&&(a=a.replace(/#/g,"%23")),a)),o=i.length-1;"="===i.charAt(o);)--o;var r=i.slice(0,o+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(r,"/driveItem")}catch(t){return void(null==e||e.ULS.sendTraceTag(541872152,f.W.Xn,p.G.Error,"getSharesUrl: Failed to get Share Url. ".concat(t)))}var s,a}(t,a);if(!d)return Promise.reject("No shareUrl");var v=function(t,e,n){var i,o=e.isConsumer,r=e.oneDriveResourceId,s=new URL(t);if(s&&s.protocol&&s.host){var a=o?r:"".concat(s.protocol,"//").concat(s.host),c=o?function(t){return t.inMockMode?t.officeHomeApiRoot:t.oneDriveConsumerApi}(e):function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var o=e.inMockMode?e.officeHomeApiRoot:t;return"".concat(o,n?"/_api":i?"/_api/v2.1":"/_api/v2.0")}(a||"",e),u=o?"OneDrive":null!==(i=rd(a||""))&&void 0!==i?i:"None";if(a&&c&&u)return{baseUrl:c,tokenType:u,resourceUrl:a,hostname:s.hostname};null==n||n.ULS.sendTraceTag(542492316,f.W.Xn,p.G.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!a,"][InvalidBaseUrl: ").concat(!c,"][InvalidTokenType: ").concat(!u,"]"))}else null==n||n.ULS.sendTraceTag(542492315,f.W.Xn,p.G.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!s,"][InvalidProtocol: ").concat(!(null==s?void 0:s.protocol),"][Invalidhost: ").concat(!(null==s?void 0:s.host),"]"))}(t,i,a);if(!v)return Promise.reject("No apiInfo");var m=new Date;m.setSeconds(0,0);var g=(0,n.ev)([hd(e),sd(r),md(s)],(0,n.CR)(ad(c)),!1).filter((function(t){return!!t})).join("&"),w=l?"shares?itemUrl=".concat(encodeURIComponent(d),"&currentDate=").concat(m.toISOString()):"".concat(d,"?").concat(g);return fd("".concat(v.baseUrl,"/").concat(w),h,v.tokenType,v.resourceUrl,o,a,u,pd)}function wd(t,e,i,o,r,s,a,c,u){var l;void 0===o&&(o=!1),void 0===r&&(r="open");var h=t.driveId,d=t.docId,v=t.baseUrl,m=t.docUrl;if(!h||!d)return Promise.reject("Not enough document information was given to retrieve the item");var w,y,_=(0,n.ev)([hd(e),sd(r)],(0,n.CR)(ad(c)),!1).filter((function(t){return!!t})).join("&"),C=function(t){if(!t)return null;var e=new URL(t);return e.protocol+"//"+e.host}(null!=v?v:m);C?(y=C,w="".concat(v||C,"/_api/v2.0"),null==a||a.ULS.sendTraceTag(543958855,f.W.Xn,p.G.Info,"making vroom service call with driveId+docId")):(y=(0,g.A8)(s),w="".concat(y,"/v1.0"),null==a||a.ULS.sendTraceTag(543958856,f.W.Xn,p.G.Info,"making graph service call with driveId+docId"));var S="".concat(w,"/drives/").concat(encodeURIComponent(h),"/items/").concat(encodeURIComponent(d),"/?").concat(_),k=null!==(l=rd(y))&&void 0!==l?l:"None";return fd(S,i.getAccessToken,k,y,o,a,u)}function yd(t){var e={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,od.sm)(t,e),e}function _d(t,e,i,o,r,s,a,c,u,l){var h;if(void 0===r&&(r=!1),void 0===s&&(s="open"),!t||!e)return Promise.reject("Not enough document information was given to retrieve the item");var d,f=new URL(e),p="".concat(f.protocol,"//").concat(f.host),v=(0,n.ev)([hd(i),sd(s)],(0,n.CR)(ad(c)),!1).filter((function(t){return!!t})).join("&");(0,A.dt)(A.Fh.FeatureGate_Vroom21SupportGate,u,a),m.c.isVroom21=u,d=u?"".concat(e,"/_api/v2.1/sites/root/items/").concat(encodeURIComponent(t),"/driveItem?").concat(v):"".concat(e,"/_api/v2.0/sites/root/items/").concat(encodeURIComponent(t),"/driveItem?").concat(v);var g=null!==(h=rd(e))&&void 0!==h?h:"None";return fd(d,o.getAccessToken,g,p,r,a,l,yd)}var Cd,Sd,kd,Td,bd,Ad,Id,Rd,Ed,Nd,Pd,Hd,Od,Ud,Md,Dd="getItemFromWac";function Fd(t,e,i,o){var r={Authorization:(0,od.sm)(o).Authorization,SessionId:i},s=(0,n.pi)((0,n.pi)({},e),{optionsHttpRequestHeaders:r});return{url:vd,method:Lh.hx.Post,headers:t,body:s}}function xd(t,e){if(t&&t.KMSI){var n={token:e,expiryTime:t.wacTokenExpTime};null==Ct||Ct.setItem(Ah,JSON.stringify(n))}}function qd(t,e){if(t)try{return JSON.parse(t.graphDriveItem)}catch(t){null==e||e.ULS.sendTraceTag(520439698,f.W.Xn,p.G.Error,"GetDriveItemFromWacWithUrl: Failed to parse vroom response from string to JSON. [Error: ".concat(JSON.stringify(t),"]"))}return Promise.reject({api:Dd,message:"Failed to parse response data from string to JSON due to invalid data or format"})}var Bd,Ld=!1,Wd=!1,jd=m.NF.SharePointOnline,Gd="owl-container",Kd="PrebootDocumentOpen",zd="owlfc";function $d(t){var e,n,i;if(!(null===(e=null==t?void 0:t.clientVersion)||void 0===e?void 0:e.trim()))throw new Error("invalid clientVersion");if(!t.exposure||t.exposure<=0||t.exposure>100)throw new Error("invalid exposure ("+(null!==(n=t.exposure)&&void 0!==n?n:"undefined")+")");t.wiseEnvironment=null===(i=t.wiseEnvironment)||void 0===i?void 0:i.toLocaleUpperCase(),Cd=t}function Vd(t){var e;return null!==(e=document.getElementById(Gd))&&void 0!==e?e:Yd(t,Gd)}function Jd(){if(Cd)return Cd.clientVersion;null==Ed||Ed.ULS.sendTraceTag(508060617,f.W.Xn,p.G.Error,"You must call initPackage before calling getOwlVersion")}function Qd(t){switch(t){case"Graph":return(0,g.A8)(Ud);case"OneDrive":return(0,g.Y6)();case"SharePoint":return(0,g.tf)();default:return""}}function Xd(t){var e;if(t){var n;try{n=new URL(t)}catch(t){return}return null!==(e=new URLSearchParams(n.search).get("nav"))&&void 0!==e?e:void 0}}function Yd(t,e){var n=document.createElement("div");return n.id=e,t.appendChild(n)}function Zd(t){return Sd?Sd(t):Promise.reject("endSession not defined")}function tf(t){return kd?kd(t):(null==Ed||Ed.ULS.sendTraceTag(555872272,f.W.Xn,p.G.Error,"hostAccessibilityLoopComplete no defined"),!1)}function ef(){return Ad?Ad():(null==Ed||Ed.ULS.sendTraceTag(508127040,f.W.Xn,p.G.Error,"hostBackButtonPressed no defined"),!1)}function nf(){if(Td)return null==Ed||Ed.ULS.sendTraceTag(508355844,f.W.Xn,p.G.Info,"Trying to get hostGetClientUrl."),void Td();null==Ed||Ed.ULS.sendTraceTag(526152082,f.W.Xn,p.G.Error,"hostGetClientUrl not defined")}function of(){if(bd)return null==Ed||Ed.ULS.sendTraceTag(508352272,f.W.Xn,p.G.Info,"Trying to get WebUrl"),void bd();null==Ed||Ed.ULS.sendTraceTag(508352271,f.W.Xn,p.G.Error,"hostGetWebUrl not defined")}function rf(t){var e,i,o,r,a=this,c=(0,v.a)();L(),(0,v.l)([C.OwlStart,"packageEntryTime"]);var u=t.documentIdentifier,l=t.sessionConfig,h=t.uiHostConfig,d=t.getAuthToken,y=t.eventHandlers,_=t.container;Ud=null!==(e=null==Cd?void 0:Cd.wiseEnvironment)&&void 0!==e?e:l.wiseEnvironment;var S=(0,n.pi)((0,n.pi)({},u),{fileType:l.fileType,wdOrigin:null!==(i=l.sessionOrigin)&&void 0!==i?i:"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:l.wdValue,uiCulture:l.uiCulture,dataCulture:l.dataCulture,puid:l.puid,clickTime:l.clickTime,isNewFile:l.isNewFile,navId:Xd(null!==(o=u.shareUrl)&&void 0!==o?o:u.docUrl),templateId:u.templateId,intent:null!==(r=l.intent)&&void 0!==r?r:"open"}),I=xt(S),R=l.sessionId||I||(0,w.n)()[0];l.bootDiagnostics=l.bootDiagnostics||{};var E=l.bootDiagnostics.ringId;l.bootDiagnostics.packageEntryTime=l.bootDiagnostics.packageEntryTime||c,Ed=new b.G2(R,Ud).logger,l.logger=Ed;var N=R===I,H=null==l?void 0:l.isNewFile;if(l.bootDiagnostics.isPrebooted=N,function(t,e,n,i,o,r){var s,a,c,u,l=t.wiseEnvironment;t.health=null!==(s=t.health)&&void 0!==s?s:cn(e,l,t.fileType,t.uiCulture,t.puid,t.tenantId,t.hostCorrelationId,null==r?void 0:r.exposure,null==r?void 0:r.clientVersion,t.isSynthetic,n.uiHostName,n.uiHostIntegrationType,t.sessionOrigin,i,o),t.hostClientType&&(null===(a=t.health)||void 0===a||a.addOrUpdatePartCDimension("HostClientType",t.hostClientType)),t.teamType&&(null===(c=t.health)||void 0===c||c.addOrUpdatePartCDimension("TeamType",t.teamType)),t.isPopOut&&(null===(u=t.health)||void 0===u||u.addOrUpdatePartCDimension("IsPopOut",(!!t.isPopOut).toString()))}(l,R,h,E,H,Cd),Nd=l.health,P.checkOwlFrameCookie(Ud,h.featureGates),P.isOwlFrameBootEnabled(h.featureGates,Ed)&&(Ld=!0,_f(Ud,l.fileType,_,!0,R).then((function(e){(0,v.l)(C.OwlCreateFrameEnd),e.status===lf.Success?(t.sessionConfig.initPackageParams=Cd,(0,v.l)(C.OwlBootAppMessageSend),null==df||df.sendMessage({id:U.BootApplication,data:W(t)}),null==Ed||Ed.ULS.sendTraceTag(508432458,f.W.Xn,p.G.Info,"CreateOwlFrame: Succeeded and now booting document")):(null==Nd||Nd.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Ed||Ed.ULS.sendTraceTag(508432456,f.W.Xn,p.G.Error,"CreateOwlFrame: Failed to create frame"))})).catch((function(t){null==Nd||Nd.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(t)]])}),null==Ed||Ed.ULS.sendTraceTag(508432455,f.W.Xn,p.G.Error,"CreateOwlFrame: Exception: ".concat(t))})),P.isOwlFrameBootEnabled(h.featureGates,Ed))){var M=function(t,e){var i=this;return null==df||df.registerHandler(O.GetAuthToken,(function(e){return(0,n.mG)(i,void 0,void 0,(function(){var i,o,r,s,a,c;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),r=e.data,s=r.resourceUrl,a=r.claims,[4,t.getAuthToken(s,a)];case 1:return i=n.sent(),[3,4];case 2:return c=n.sent(),o=c,[3,4];case 3:return null==df||df.sendMessage({id:U.GetAuthTokenResponse,data:{token:i,error:o,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),gt(t.eventHandlers,e,t.sessionConfig.wiseEnvironment,t.uiHostConfig,t.sessionConfig.logger)}(t,S),D=Cf();return Sd=D.endSession,kd=D.hostAccessibilityLoopComplete,Td=D.hostGetClientUrl,bd=D.hostGetWebUrl,Ad=D.hostBackButtonPressed,Id=D.hostSendConversationId,(0,n.pi)((0,n.pi)({},D),{sessionEndObservable:M})}if(Hd=(0,A.vJ)(A.Fh.FeatureGate_EcsHootGate,h.featureGates),P.isOwlFrame&&Hd&&!l.isAnonymous&&(l.loginHint||l.upn)&&(Bd||(Bd=Eh(l,Ed))),Cd||(Cd=l.initPackageParams),Od=function(t,e){switch(t){case T.T.PowerPoint:return(0,A.vJ)(A.Fh.FeatureGate_Vroom21SupportGate,e.featureGates);case T.T.Word:return(0,A.vJ)(A.Fh.FeatureGate_Vroom21ForWord,e.featureGates);case T.T.Excel:return(0,A.vJ)(A.Fh.FeatureGate_Vroom21ForExcel,e.featureGates);default:return!1}}(l.fileType,h),Md=(0,A.vJ)(A.Fh.FeatureGate_BypassOPTIONSCall,h.featureGates),Wd=(0,A.vJ)(A.Fh.FeatureGate_ManualRedirectOnTenantChangeGate,h.featureGates),N){var F=new Map;F.set("StartTime",(new Date).toUTCString()),qt(S,R),null==Nd||Nd.recordKpiUsage(Kd,k.o.FailureBased,zd,F)}if(Pd=Vd(_),u.docUrl||u.driveId&&u.docId||u.shareUrl||u.baseUrl&&u.fileId){var x,q=af(d),B={correlationId:l.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:q},j=(0,n.pi)((0,n.pi)({},l),{shareApiEndpoint:(0,g.PO)(Ud),metaUiHostVersion:Oh.J.version,logger:Ed,sessionId:R}),G={isESSEnabled:j.isESSEnabled,wacDataCenter:j.isESSEnabled?Dh(l.fileType):void 0,sessionId:j.sessionId,hostCorrelationId:j.hostCorrelationId};(0,A.dt)(A.Fh.FeatureGate_EcsHootGate,Hd,Ed),Hd&&P.isOwlFrame?(null==Ed||Ed.ULS.sendTraceTag(520757324,f.W.Xn,p.G.Info,"FetchItemFromWac: Hoot endpoint enabled in ECS, fetch driveItem from Wac"),x=uf(S)?cf(B,Ud,G,Od,Md):function(t,e,i,o){return function(r,s,a,c){return void 0===s&&(s=!1),void 0===a&&(a=!1),null==c||c.ULS.sendTraceTag(526951838,f.W.Xn,p.G.Info,"Item to be fetched through wac service"),function(t,e,i,o,r,s,a,c){var u=this,l={docBootInfo:i,essOptions:s,api:r};return vd=(0,g.XQ)(o,e),function(t,e){return(0,n.mG)(this,void 0,void 0,(function(){var i,o;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(i=null==Ct?void 0:Ct.getItem(Ah))try{if((o=JSON.parse(i))&&o.token&&o.expiryTime&&parseInt(o.expiryTime,10)>(new Date).getTime()/1e3)return null==e||e.ULS.sendTraceTag(524821017,f.W.Xn,p.G.Info,"GetDriveItemFromWacWithUrl: Fetched valid access token from the windows local storage cache"),[2,o.token];null==Ct||Ct.removeItem(Ah)}catch(t){null==Ct||Ct.removeItem(Ah)}return[4,t("None",!0,Ah,void 0,!0)];case 1:return[2,n.sent()]}}))}))}(t,a).then((function(i){var o={accept:"application/json"},r=Fd(o,l,e,i);return Qh(r,a,c).then((function(t){return xd(t,i),qd(t,a)})).catch((function(s){return(0,n.mG)(u,void 0,void 0,(function(){return(0,n.Jh)(this,(function(n){return null==a||a.ULS.sendTraceTag(526471961,f.W.Xn,p.G.Error,"GetDriveItemFromWacWithUrl: Retrying getDriveItemFromWac. [Error: ".concat(JSON.stringify(s),"][FailureReason: ").concat(null==s?void 0:s.failure,"]")),s&&401===s.sharePointCallStatus&&"insufficient_claims"===s.claimsError&&s.claims?(null==a||a.ULS.sendTraceTag(512492100,f.W.Xn,p.G.Warning,"GetDriveItemFromWacWithUrl: Wac call vroom failed with claims challenge. Retry with claims"),[2,t("None",!0,Ah,void 0,!0,s.claims).then((function(t){return Qh(Fd(o,l,e,t),a,c).then((function(e){return xd(e,t),qd(e,a)}))}))]):[2,Qh(r,a,c).then((function(t){return xd(t,i),qd(t,a)}))]}))}))}))}))}(t.getAccessToken,e,r,i,jd,o,c,Nd)}}(B,R,Ud,G)):(null==Ed||Ed.ULS.sendTraceTag(520757325,f.W.Xn,p.G.Info,"FetchItemFromVroom: Hoot endpoint disabled in ECS, fetch driveItem from Vroom"),x=cf(B,Ud,G,Od,Md));var K={documentBootInfo:S,fetchItemFromNetwork:x,fetchAccessToken:q,openShareControl:function(t){return(0,n.mG)(a,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,s.e(4630).then(s.bind(s,7015))];case 1:return[2,e.sent().openVanillaJsShareControl(t,{},Pd)]}}))}))},sessionConfig:j,onBootComplete:y.onBootComplete,onBootFailure:y.onBootFailure,onReturnFocus:y.onReturnFocus,onConversationClose:y.onConversationClose,onNavigateBack:y.onNavigateBack,onOpenPageLevelConversation:y.onOpenPageLevelConversation,onDocumentClose:function(){y.onDocumentClose&&y.onDocumentClose(),null==Nd||Nd.shutdown()},onSuccessNotification:y.onSuccessNotification,onOpenInMobileApp:y.onOpenInMobileApp,onRename:y.onRename,uiHostConfig:h,createDocument:function(t){return(0,n.mG)(a,void 0,void 0,(function(){var e,i;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,s.e(4630).then(s.bind(s,6105))];case 1:return e=n.sent(),i={fileType:t.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:l.uiCulture,dataCulture:l.dataCulture,puid:l.puid,clickTime:t.clickTime,isNewFile:!0},[2,e.createNewDocument(B,i,t,Ud,Ed)]}}))}))},container:_};return sf(K)}null==Ed||Ed.ULS.sendTraceTag(576217559,f.W.Xn,p.G.Error,"No document url is found. Exit")}function sf(t){var e,i,o,r,s,a,c,u,l=this,h=(0,v.a)();(0,v.l)(C.OwlWithCustomFunctionsStart),L();var d=null!==(e=null==Cd?void 0:Cd.wiseEnvironment)&&void 0!==e?e:t.sessionConfig.wiseEnvironment,g=!!t.sessionConfig.health,y=function(t,e){var i,o,r,s,a,c,u,l,h,d,f,p=null!==(i=null==e?void 0:e.wiseEnvironment)&&void 0!==i?i:t.sessionConfig.wiseEnvironment,v=t.sessionConfig.sessionId||(0,w.n)();(t.sessionConfig.logger||(t.sessionConfig.logger=new b.G2(v,p).logger),t.sessionConfig.owlRollout="".concat(p,".").concat(null==e?void 0:e.exposure),t.sessionConfig.owlVersion=null==e?void 0:e.clientVersion,t.sessionConfig.health)||(f="string"==typeof v?v:(0,n.CR)(v,1)[0],t.sessionConfig.health=cn(f,p,null===(o=t.documentBootInfo)||void 0===o?void 0:o.fileType,null===(r=t.documentBootInfo)||void 0===r?void 0:r.uiCulture,null===(s=t.documentBootInfo)||void 0===s?void 0:s.puid,t.sessionConfig.tenantId,t.sessionConfig.hostCorrelationId,null==e?void 0:e.exposure,null==e?void 0:e.clientVersion,t.sessionConfig.isSynthetic,null===(a=t.uiHostConfig)||void 0===a?void 0:a.uiHostName,null===(c=t.uiHostConfig)||void 0===c?void 0:c.uiHostIntegrationType,null===(u=t.documentBootInfo)||void 0===u?void 0:u.wdOrigin,null===(l=t.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,null===(h=t.documentBootInfo)||void 0===h?void 0:h.isNewFile,null===(d=t.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.isOdcMigrated));return t}(t,Cd),_=null!==(i=y.sessionConfig.sessionId)&&void 0!==i?i:(0,w.n)()[0];t.sessionConfig.sessionId=_,P.checkOwlFrameCookie(d,null===(o=t.uiHostConfig)||void 0===o?void 0:o.featureGates),Hd||(Hd=(0,A.vJ)(A.Fh.FeatureGate_EcsHootGate,null===(r=y.uiHostConfig)||void 0===r?void 0:r.featureGates)),P.isOwlFrame&&Hd&&!t.sessionConfig.isAnonymous&&(t.sessionConfig.loginHint||t.sessionConfig.upn)&&(Bd||(Bd=Eh(t.sessionConfig,Ed)),uf(t.documentBootInfo)||(t.fetchItemFromNetwork=function(e,n,i,o){var r;void 0===n&&(n=!1),void 0===i&&(i=!1);var s={isESSEnabled:t.sessionConfig.isESSEnabled,wacDataCenter:t.sessionConfig.isESSEnabled?Dh(t.documentBootInfo.fileType):void 0,sessionId:t.sessionConfig.sessionId,hostCorrelationId:t.sessionConfig.hostCorrelationId},a=null===(r=t.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isOdcMigrated;return"boolean"!=typeof a||a||(jd=m.NF.OneDriveConsumer),td(e,s,Bd,t.sessionConfig.wiseEnvironment,jd,_,t.sessionConfig.upn,o,Nd)})),g||(Nd=y.sessionConfig.health),Ed||(Ed=y.sessionConfig.logger);var S=(0,A.vJ)(A.Fh.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled,null===(s=t.uiHostConfig)||void 0===s?void 0:s.featureGates);if(null==Ed||Ed.ULS.sendTraceTag(508121308,f.W.Xn,p.G.Important,"OAuth Feature Gate: ".concat(S?"Enabled":"Disabled")),function(t,e){var n,i,o,r,s;t.sessionConfig.bootDiagnostics=t.sessionConfig.bootDiagnostics||{},t.sessionConfig.bootDiagnostics.packageEntryTime=t.sessionConfig.bootDiagnostics.packageEntryTime||e,t.sessionConfig.bootDiagnostics.perfNavigationTiming=t.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,b.pb)(),P.isOwlFrameBootEnabled(null===(n=t.uiHostConfig)||void 0===n?void 0:n.featureGates,Ed)&&(t.sessionConfig.bootDiagnostics.legacyPerformanceData=t.sessionConfig.bootDiagnostics.legacyPerformanceData||{host:(0,b.vb)()},P.isOwlFrame&&(t.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming=t.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming||(0,b.pb)(),t.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame=t.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame||(0,b.vb)())),t.sessionConfig.bootDiagnostics.loadManifestStartTime=t.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(i=null==Cd?void 0:Cd.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestStartTime),t.sessionConfig.bootDiagnostics.loadManifestEndTime=t.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(o=null==Cd?void 0:Cd.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadManifestEndTime),t.sessionConfig.bootDiagnostics.loadOwlStartTime=t.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(r=null==Cd?void 0:Cd.owlBootstrapperDiagnostics)||void 0===r?void 0:r.loadOwlStartTime),t.sessionConfig.bootDiagnostics.loadOwlEndTime=t.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(s=null==Cd?void 0:Cd.owlBootstrapperDiagnostics)||void 0===s?void 0:s.loadOwlEndTime)}(y,h),!Ld&&P.isOwlFrameBootEnabled(null===(a=t.uiHostConfig)||void 0===a?void 0:a.featureGates,Ed)&&(Ld=!0,_f(d,t.documentBootInfo.fileType,t.container,!0,_).then((function(e){return(0,n.mG)(l,void 0,void 0,(function(){var i,o,r;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return(0,v.l)(C.OwlCreateFrameEnd),e.status!==lf.Success?[3,4]:(t.sessionConfig.initPackageParams=Cd,(0,v.l)(C.OwlBootAppWithCustomFunctionsMessageSend),null!=df?[3,1]:[3,3]);case 1:return o=(i=df).sendMessage,r={id:U.BootApplicationWithCustomFunctions},[4,j(t)];case 2:o.apply(i,[(r.data=n.sent(),r)]),n.label=3;case 3:return null==Ed||Ed.ULS.sendTraceTag(508432454,f.W.Xn,p.G.Info,"CreateOwlFrame: Succeeded and now booting document"),[3,5];case 4:null==Nd||Nd.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Ed||Ed.ULS.sendTraceTag(508432452,f.W.Xn,p.G.Error,"CreateOwlFrame: Failed to create frame"),n.label=5;case 5:return[2]}}))}))})).catch((function(t){null==Nd||Nd.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(t)]])}),null==Ed||Ed.ULS.sendTraceTag(508432451,f.W.Xn,p.G.Error,"CreateOwlFrame: Exception: ".concat(t))})),P.isOwlFrameBootEnabled(null===(c=t.uiHostConfig)||void 0===c?void 0:c.featureGates,Ed))){var k=function(t){var e=this,i=gt(t,t.documentBootInfo,t.sessionConfig.wiseEnvironment,t.uiHostConfig,t.sessionConfig.logger);return null==df||df.registerHandler(O.FetchItemFromNetwork,(function(i){return(0,n.mG)(e,void 0,void 0,(function(){var e,o,r,s,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),r=i.data,s=r.docBootInfo,a=r.forceRefresh,c=r.zeroByte,[4,t.fetchItemFromNetwork(s,a,c)];case 1:return e=n.sent(),[3,4];case 2:return u=n.sent(),o=u,[3,4];case 3:return null==df||df.sendMessage({id:U.FetchItemFromNetworkResponse,data:{correlationId:i.correlationId,item:e,error:o}}),[7];case 4:return[2]}}))}))})),null==df||df.registerHandler(O.FetchAccessToken,(function(i){return(0,n.mG)(e,void 0,void 0,(function(){var e,o,r,s,a,c,u,l,h;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return e=i.data,o=e.tokenConsumer,r=e.forceFetch,s=e.resourceUrl,a=e.scope,c=e.isBoot,u=e.claims,l=e.silent,[4,t.fetchAccessToken(o,r,s,a,c,u,l)];case 1:return h=n.sent(),null==df||df.sendMessage({id:U.FetchAccessTokenResponse,data:{correlationId:i.correlationId,response:h}}),[2]}}))}))})),null==df||df.registerHandler(O.OpenShareControl,(function(i){return(0,n.mG)(e,void 0,void 0,(function(){var e,o,r;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return e=i.data,o=e.shareProps,r=e.isShareDialogueZoomEnabled,[4,t.openShareControl(o,r)];case 1:return n.sent(),null==df||df.sendMessage({id:U.OpenShareControlResponse,data:{correlationId:i.correlationId}}),[2]}}))}))})),null==df||df.registerHandler(O.CreateDocument,(function(i){return(0,n.mG)(e,void 0,void 0,(function(){var e,o,r,s,a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return e=i.data,o=e.createNewInfo,r=e.template,[4,null===(a=t.createDocument)||void 0===a?void 0:a.call(t,o,r)];case 1:return(s=n.sent())?null==df||df.sendMessage({id:U.CreateDocumentResponse,data:{correlationId:i.correlationId,url:s}}):null==df||df.sendMessage({id:U.CreateDocumentResponse,data:{correlationId:i.correlationId,error:"Failed to create document"}}),[2]}}))}))})),null==df||df.registerHandler(O.UserActivity,(function(e){var n;return null===(n=t.onUserActivity)||void 0===n?void 0:n.call(t)})),null==df||df.registerHandler(O.CAAEMessage,(function(e){var n;return null===(n=t.onCAAEMessage)||void 0===n?void 0:n.call(t,e.data)})),null==df||df.registerHandler(O.UserAccess,(function(e){var n;return null===(n=t.onUserAccess)||void 0===n?void 0:n.call(t,e.data)})),null==df||df.registerHandler(O.MoveToFolder,(function(e){var n;return null===(n=t.onMoveToFolder)||void 0===n?void 0:n.call(t,e.data)})),null==df||df.registerHandler(O.SharedFilePicker,(function(e){var n;return null===(n=t.onSharedFilePicker)||void 0===n?void 0:n.call(t,e.data)})),null==df||df.registerHandler(O.Rename,(function(e){var n;return null===(n=t.onRename)||void 0===n?void 0:n.call(t,e.data.newName)})),null==df||df.registerHandler(O.FrameChange,(function(e){var n;return null===(n=t.onFrameChange)||void 0===n?void 0:n.call(t,e.data)})),null==df||df.registerHandler(O.InvokeSessionRefreshInfoPopupBlockedDialog,(function(e){var n;null===(n=t.invokeSessionRefreshInfoPopupBlockedDialog)||void 0===n||n.call(t,{visible:e.data.visible,handleRefresh:function(){return null==ff?void 0:ff.sendMessage({id:U.SessionRefreshInfoDialogHandleRefresh,data:{}})},handleCancel:function(){return null==ff?void 0:ff.sendMessage({id:U.SessionRefreshInfoDialogHandleCancel,data:{}})},onDismiss:function(){return null==ff?void 0:ff.sendMessage({id:U.SessionRefreshInfoDialogOnDismiss,data:{}})}})})),null==df||df.registerHandler(O.FileEmbed,(function(e){var n;return null===(n=t.onFileEmbed)||void 0===n?void 0:n.call(t)})),i}(t),T=Cf();return Sd=T.endSession,kd=T.hostAccessibilityLoopComplete,Td=T.hostGetClientUrl,bd=T.hostGetWebUrl,Ad=T.hostBackButtonPressed,Id=T.hostSendConversationId,(0,n.pi)((0,n.pi)({},T),{sessionEndObservable:k})}var I=y.container;Pd=Vd(y.container),y.container=Pd;var R=xt(y.documentBootInfo),E=_===R,N=y.onBootFailure;if(y.onBootFailure=function(t,e){var n,i,o,r=t.httpErrorCode,s=function(t){switch(t){case m.AU.mi:case m.AU.gi:return!1;default:return!0}}(t.wacErrorName),a=null!==(n=t.networkError)&&void 0!==n&&n;if(null==Nd||Nd.recordQosError(t.qosErrorName,["UnifiedUiHostBootstrappingFailed"],ye(r,a),s,!0,!0,{inStaging:null===(i=t.inStaging)||void 0===i||i,extendedProperties:be(t)}),E){var c=new Map;c.set("FailureTime",(new Date).toUTCString()),c.set("Error",t.error),e&&c.set("DocumentBootInfo",JSON.stringify(e)),r&&c.set("HttpErrorCode",r),null==Nd||Nd.recordKpiFailure(Kd,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,v.a)()-((null===(o=y.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime)||h),extendedProperties:c})}N&&N(t,e),null==Nd||Nd.shutdown()},P.isOwlFrameExperimentEnabled(null===(u=y.uiHostConfig)||void 0===u?void 0:u.featureGates,Ed)){var H=t.onBootComplete;t.onBootComplete=function(t,e){(function(t,e,i){return(0,n.mG)(this,void 0,void 0,(function(){var o,r,s;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),(0,v.l)(C.OwlCreateFrameStart),[4,_f(i.sessionConfig.wiseEnvironment,e,t,!1,i.sessionConfig.sessionId)];case 1:return o=n.sent(),(0,v.l)(C.OwlCreateFrameEnd),o.status===lf.Success&&((0,v.l)(C.OwlTokenFetchingExperimentMessageSend),null==df||df.sendMessage({id:U.TokenFetchingExperiment,data:{bootParams:i}})),r=B({owlVersion:(null==Cd?void 0:Cd.clientVersion)||i.sessionConfig.owlVersion,wiseEnvironment:(null==Cd?void 0:Cd.wiseEnvironment)||i.sessionConfig.wiseEnvironment,exposure:null==Cd?void 0:Cd.exposure}).owlTelemetryData,null==Ed||Ed.ULS.sendTraceTag(508168084,f.W.Xn,p.G.Important,"[Auth Token Experiment Data (Host)]: ".concat(r)),[3,4];case 2:return s=n.sent(),o={status:lf.Error,error:"Caught unexpected exception: ".concat(s)},null==Nd||Nd.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(s)]])}),[3,4];case 3:return F(),[7];case 4:return null==Ed||Ed.ULS.sendTraceTag(508168083,f.W.Xn,p.G.Info,JSON.stringify(o)),[2]}}))}))})(y.container,y.documentBootInfo.fileType,y).catch((function(t){return null==Ed?void 0:Ed.ULS.sendTraceTag(508168085,f.W.Xn,p.G.Error,"Caught unexpected error running HOOT experiment: ".concat(t))})),null==H||H(t,e)}}var M=sn((0,n.pi)((0,n.pi)({},y),{initPackageParams:Cd}));Sd=M.endSession,kd=M.hostAccessibilityLoopComplete,Td=M.hostGetClientUrl,bd=M.hostGetWebUrl,Rd=M.postFrameDiagnostics,Ad=M.hostBackButtonPressed,Id=M.hostSendConversationId,P.isOwlFrame&&function(t,e,i,o,r,s,a,c){var u=this;null==ff||ff.registerHandler(U.EndSession,(function(e){return(0,n.mG)(u,void 0,void 0,(function(){var i,o,r;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return i=n.sent(),[3,4];case 2:return r=n.sent(),o=r,[3,4];case 3:return null==ff||ff.sendMessage({id:O.EndSessionResponse,data:{result:i,error:o,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),null==ff||ff.registerHandler(U.HostAccessibilityLoopComplete,(function(t){return e(t.data.navigateForward)})),null==ff||ff.registerHandler(U.GetClientUrl,(function(t){return i()})),null==ff||ff.registerHandler(U.GetWebUrl,(function(t){return o()})),null==ff||ff.registerHandler(U.BackButtonPressed,(function(t){return r()})),null==ff||ff.registerHandler(U.SendConversationId,(function(t){return s(t.data.conversationId)})),null==ff||ff.registerHandler(U.GetAuthTokenResponse,pf.getHandler(U.GetAuthTokenResponse,vt.Token)),null==ff||ff.registerHandler(U.FetchItemFromNetworkResponse,pf.getHandler(U.FetchItemFromNetworkResponse,vt.Item)),null==ff||ff.registerHandler(U.FetchAccessTokenResponse,pf.getHandler(U.FetchAccessTokenResponse,vt.Response)),null==ff||ff.registerHandler(U.OpenShareControlResponse,pf.getHandler(U.OpenShareControlResponse)),null==ff||ff.registerHandler(U.CreateDocumentResponse,pf.getHandler(U.CreateDocumentResponse,vt.URL)),null==ff||ff.registerHandler(U.TelemetryData,(function(t){var e=t.data,i=e.context,o=e.hostData,r=e.frameData,s=function(t,e){var i,o=t[C.OwlStart]||t[C.OwlWithCustomFunctionsStart],r=(t[C.OwlBootAppMessageSend]||t[C.OwlBootAppWithCustomFunctionsMessageSend])-o,s=e[C.OwlBootAppMessageReceive]||e[C.OwlBootAppWithCustomFunctionsMessageReceive],a=e[C.OwlOnBootComplete];return{hostTime:r,frameTime:a-s,totalTime:a-o,owlPerformanceTimeline:(0,n.pi)((0,n.pi)((0,n.pi)({},t),e),((i={})[C.OwlStart]=o,i[C.OwlEnd]=a,i))}}(JSON.parse(o.owlTelemetryData),JSON.parse(r.owlTelemetryData));a&&a(s.owlPerformanceTimeline),null==c||c.ULS.sendTraceTag(508614159,f.W.Xn,p.G.Important,i+", OwlFrame Telemetry Data: "+JSON.stringify(s)),null==c||c.ULS.sendTraceTag(508614158,f.W.Xn,p.G.Important,i+", Boot Telemetry Data: "+JSON.stringify({hostBoot:o.bootTelemetryData,frameBoot:r.bootTelemetryData}))}))}(Sd,kd,Td,bd,Ad,Id,Rd,Ed);var D=function(t){var e=t.subscribe((function(t){var i,o;if(t&&(null===(i=y.uiHostConfig)||void 0===i?void 0:i.supportsInternalReboot)){var r=(0,w.n)(),s=new b.G2(r,d);y.sessionConfig.sessionId=s.sessionId,y.sessionConfig.logger=s.logger,y.sessionConfig.bootDiagnostics=(o=y.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,v.a)(),isTestMode:null==o?void 0:o.isTestMode,isPrebooted:!1,ringId:null==o?void 0:o.ringId,teamsContextStartTime:0,teamsContextEndTime:0,owlFramePerfNavigationTiming:(0,b.pb)(),perfNavigationTiming:(0,b.pb)(),meetingLiveDiagnostics:void 0}),y.sessionConfig.highContrastMode=t.theme,I&&Pd&&Pd.parentNode===I&&I.removeChild(Pd),Pd=Yd(I,Gd);var a=sn((0,n.pi)((0,n.pi)({},y),{container:Pd,documentBootInfo:t.documentBootInfo,initPackageParams:Cd}));Sd=a.endSession,kd=a.hostAccessibilityLoopComplete,Td=a.hostGetClientUrl,bd=a.hostGetWebUrl,Ad=a.hostBackButtonPressed,Id=a.hostSendConversationId,e.unsubscribe(),D(a.sessionEndObservable)}else I&&Pd&&Pd.parentNode===I&&I.removeChild(Pd),e.unsubscribe();null==Nd||Nd.shutdown()}))};return D(M.sessionEndObservable),P.isOwlFrame&&M.sessionEndObservable.subscribe((function(t){null==ff||ff.sendMessage({id:O.EndSessionObservable,data:{rebootInfo:t}})})),(0,v.l)([C.OwlEnd,C.OwlWithCustomFunctionsEnd]),M}function af(t){return function(e,n,i,o,r,s){return null==Ed||Ed.ULS.sendTraceTag(546182046,f.W.Xn,p.G.Info,"FetchAccessToken: Start"),r&&(m.c.accessTokenStartTime=(0,v.a)(),(0,v.l)("accessTokenStartTime")),t(i||Qd(e),s).then((function(t){return{success:!0,token:t,format:"JWT",source:"OfficeHome"}})).catch((function(t){return Promise.reject({api:"getAuthToken",failure:t,message:"Failed to retrieve auth token"})})).finally((function(){null==Ed||Ed.ULS.sendTraceTag(546182047,f.W.Xn,p.G.Info,"FetchAccessToken: End"),r&&(m.c.accessTokenEndTime=(0,v.a)(),(0,v.l)("accessTokenEndTime"))}))}}function cf(t,e,i,o,r){var s=this;return function(a,c,u,l){return void 0===c&&(c=!0),void 0===u&&(u=!1),(0,n.mG)(s,void 0,void 0,(function(){var s,c,h;return(0,n.Jh)(this,(function(n){return s=!0,c=u?"editnew":"view"===a.intent?"view":"edit"===a.intent?"edit":"open",(null==i?void 0:i.isESSEnabled)&&i.wacDataCenter&&!an.includes("wacSession")&&an.push("wacSession"),a.shareUrl?(null==l||l.ULS.sendTraceTag(572634827,f.W.Xn,p.G.Info,"Item to be fetched using shareUrl"),[2,gd(a.shareUrl,an,t,s,c,!1,l,i,r).catch((function(e){if(e&&404===e.status&&"The site has been moved to a new location."===e.message&&e.redirectLocation&&a.shareUrl){null==l||l.ULS.sendTraceTag(546120988,f.W.Xn,p.G.Info,"Get item failed due to site move. Retry with the redirect location");var n=new URL(e.redirectLocation),o=new URL(a.shareUrl);return a.shareUrl=a.shareUrl.replace(o.hostname,n.hostname),gd(a.shareUrl,an,t,s,c,!1,l,i,r)}throw e}))]):a.driveId&&a.docId?(null==l||l.ULS.sendTraceTag(572634828,f.W.Xn,p.G.Info,"Item to be fetched using driveId and docId"),[2,wd(a,an,t,s,c,e,l,i,r)]):a.fileId&&a.baseUrl?(null==l||l.ULS.sendTraceTag(572343521,f.W.Xn,p.G.Info,"Item to be fetched using fileId and baseUrl"),[2,_d(a.fileId,a.baseUrl,an,t,s,c,l,i,o,r).catch((function(e){if(Wd&&e&&404===e.status&&e.redirectLocation){if(null==l||l.ULS.sendTraceTag(508380358,f.W.Xn,p.G.Important,"Get item failed due to site move. Retry with the redirect location"),a.baseUrl){var n=new URL(a.baseUrl),u=new URL(e.redirectLocation);a.baseUrl=a.baseUrl.replace(n.hostname,u.hostname)}return _d(a.fileId||"",a.baseUrl||"",an,t,s,c,l,i,o,r)}throw e}))]):(null==l||l.ULS.sendTraceTag(572634829,f.W.Xn,p.G.Info,"Item to be fetched using docUrl"),[2,gd(null!==(h=a.docUrl)&&void 0!==h?h:"",an,t,s,c,!1,l,i,r).catch((function(t){throw t}))])}))}))}}function uf(t){return!(t.shareUrl||!t.docId||!t.driveId||t.baseUrl||t.docUrl)}var lf,hf=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.Ba=t,this.La=new Map(e.map((function(t){return[t,new Map]})))}return t.prototype.registerHandlers=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach((function(e){return t.La.set(e,new Map)}))},t.prototype.getHandler=function(t,e,n){void 0===e&&(e=""),void 0===n&&(n="error");var i=this.La.get(t);return function(t){if(i){var o=i.get(t.data.correlationId);o&&(i.delete(t.data.correlationId),e?t.data[e]?o.resolve(t.data[e]):o.reject(t.data[n]||n):o.resolve())}}},t.prototype.getMessagePromise=function(t,e){var n=this,i=this.La.get(t);return i?new Promise((function(t,o){var r;n.Ba||o("frameToHostMessenger does not exist");var s=null===(r=n.Ba)||void 0===r?void 0:r.sendMessage(e);s?i.set(s,{resolve:t,reject:o}):o("Encountered error sending message to host")})):Promise.reject("No registered handlers ")},t}();!function(t){t[t.Success=0]="Success",t[t.Error=1]="Error",t[t.Timeout=2]="Timeout"}(lf||(lf={}));var df,ff,pf,vf,mf,gf="OwlFrame",wf=3e4,yf=m.NF.SharePointOnline;function _f(t,e,i,o,r){return(0,n.mG)(this,void 0,void 0,(function(){var s,a,c,u;return(0,n.Jh)(this,(function(n){return s=function(t){return new URL((0,g.wl)(t)).origin}(t),(a=document.createElement("iframe")).src="".concat(s).concat(E).concat(window.location.search?window.location.search+"&":"?","filetype=").concat(e,"&hostorigin=").concat(encodeURIComponent(window.location.origin),"&env=").concat(t).concat(r?"&corrid=".concat(r,"&usid=").concat(r):""),a.id=gf,a.allowFullscreen=!0,a.allow="microphone ".concat(s,"; autoplay ").concat(s,"; camera ").concat(s,"; clipboard-read ").concat(s,"; clipboard-write ").concat(s,"; keyboard-map ").concat(s,"; display-capture ").concat(s),a.setAttribute("style","inset: 0px; height: ".concat(o?"100%":"0px","; width: ").concat(o?"100%":"0px","; display: block; position: absolute; background-color: transparent; border: none; visibility: ").concat(o?"visible":"hidden",";")),(0,v.l)(C.OwlAddFrameToDOM),i.appendChild(a),c=new Promise((function(t){a.contentWindow&&(df=new h(a.contentWindow,s),vf=new hf(df,O.EndSessionResponse),df.registerHandler(O.FrameLoaded,(function(e){(0,v.l)(C.OwlLoadedMessageReceive),t(e.data.success?{status:lf.Success}:{status:lf.Error,error:e.data.error})})))})),u=new Promise((function(t){return setTimeout((function(){return t({status:lf.Timeout,error:"Timed out waiting for OWL frame to load after ".concat(wf," ms.")})}),wf)})),[2,Promise.race([c,u])]}))}))}function Cf(){return{endSession:function(t){return vf.getMessagePromise(O.EndSessionResponse,{id:U.EndSession,data:{rebootInfo:t}})},hostAccessibilityLoopComplete:function(t){return null==df||df.sendMessage({id:U.HostAccessibilityLoopComplete,data:{navigateForward:t}}),!0},hostGetClientUrl:function(){null==df||df.sendMessage({id:U.GetClientUrl,data:{}})},hostGetWebUrl:function(){null==df||df.sendMessage({id:U.GetWebUrl,data:{}})},hostBackButtonPressed:function(){return null==df||df.sendMessage({id:U.BackButtonPressed,data:{}}),!0},hostSendConversationId:function(t){null==df||df.sendMessage({id:U.SendConversationId,data:{conversationId:t}})}}}function Sf(){ff&&ff.dispose(),df&&df.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(t){return t.name.startsWith("owl")})).forEach((function(t){return window.performance.clearMarks(t.name)}));var t=document.getElementById(gf);t&&t.remove()}!function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.TeamsElectron=6]="TeamsElectron",t[t.Unknown=7]="Unknown"}(mf||(mf={}));var kf=window.navigator,Tf=kf?kf.userAgent:void 0;function bf(){return!!Tf&&Tf.indexOf("iPhone")>=0||/android.+mobile/i.test(kf.userAgent)}var Af,If,Rf,Ef=s(3731);function Nf(){var t=window.location.search,e=new URLSearchParams(t),n=e.get(m.$c.ItemId),i=e.get(m.$c.DriveId),o=e.get(m.$c.DocUrl);return{docId:null!=n?n:void 0,driveId:null!=i?i:void 0,docUrl:null!=o?o:void 0}}function Pf(t){return Rf||(Rf=function(){If||((If={})[T.T[T.T.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],If[T.T[T.T.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],If[T.T[T.T.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],If[T.T[T.T.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],If[T.T[T.T.OneNote]]=["one"]),Rf={};var t=function(t){if(!If.hasOwnProperty(t))return"continue";var e=If[t];if(!e)return"continue";e.forEach((function(e){Rf[e]=T.T[t]}))};for(var e in If)t(e);return Rf}()),t&&Rf[t.toLowerCase()]||T.T.None}function Hf(){var t=window.location.pathname.split("/");if(4===t.length||5===t.length)return function(t){switch(t){case"word":return T.T.Word;case"excel":return T.T.Excel;case"powerpoint":return T.T.PowerPoint;case"onenote":return T.T.OneNote;case"visio":return T.T.Visio;default:return}}(t[2].toLowerCase())}!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(Af||(Af={})),function(){var t,e;if(P.isOwlFrame){(0,v.l)(C.OwlFrameScriptExecutionStart);var i=new URLSearchParams(location.search),o=document.getElementById("owl"),r=i.get("hostorigin"),s="true"===(null===(e=null===(t=null==o?void 0:o.dataset)||void 0===t?void 0:t.validHost)||void 0===e?void 0:e.toLowerCase());r&&s&&function(t){var e=this;ff=new h(window.parent,t),pf=new hf(ff,U.GetAuthTokenResponse,U.FetchItemFromNetworkResponse,U.FetchAccessTokenResponse,U.OpenShareControlResponse,U.CreateDocumentResponse),ff.registerHandler(U.BootApplication,(function(t){(0,v.l)(C.OwlBootAppMessageReceive),rf(function(t){var e,i,o,r,s,a,c,u,l,h,d,f,p,v,m,g,w,y,_,C,S,k,T,A,I,R,E,N,P,H,M,D,F,x,q,B,L,W,j;return{documentIdentifier:t.documentIdentifier,sessionConfig:{hostCorrelationId:t.sessionConfig.hostCorrelationId,isMsa:t.sessionConfig.isMsa,tenantId:t.sessionConfig.tenantId,organizationName:t.sessionConfig.organizationName,sessionId:t.sessionConfig.sessionId,isESSEnabled:t.sessionConfig.isESSEnabled,experiments:t.sessionConfig.experiments,highContrastMode:t.sessionConfig.highContrastMode,additionalApplicationParameters:t.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=t.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(i=t.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(o=t.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isTestMode,isManifestCachingEnabled:null===(r=t.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(s=t.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isOwlBootstrapperEnabled,isPrebooted:null===(a=t.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(c=t.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.isVroom21,ringId:null===(u=t.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.ringId,teamsContextStartTime:null===(l=t.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(h=t.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.teamsContextEndTime,wopiDataStartTime:null===(d=t.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.wopiDataStartTime,wopiDataEndTime:null===(f=t.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataEndTime,bootStrapStartTime:null===(p=t.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapStartTime,bootStrapEndTime:null===(v=t.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.bootStrapEndTime,driveItemStartTime:null===(m=t.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(g=t.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemEndTime,driveItemFromWacStartTime:null===(w=t.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(y=t.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.driveItemFromWacEndTime,accessTokenStartTime:null===(_=t.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.accessTokenStartTime,accessTokenEndTime:null===(C=t.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.accessTokenEndTime,isCookieBlocked:null===(S=t.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.isCookieBlocked,meetingLiveDiagnostics:null===(k=t.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.meetingLiveDiagnostics,spRequestGuid:null===(T=t.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.spRequestGuid,createNewStartTime:null===(A=t.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.createNewStartTime,createNewEndTime:null===(I=t.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.createNewEndTime,loadManifestStartTime:null===(R=t.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadManifestStartTime,loadManifestEndTime:null===(E=t.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestEndTime,loadOwlStartTime:null===(N=t.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadOwlStartTime,loadOwlEndTime:null===(P=t.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadOwlEndTime,owlBootstrapperStartTime:null===(H=t.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(M=t.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.owlBootstrapperEndTime,isOdcMigrated:null===(D=t.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.isOdcMigrated,perfNavigationTiming:null===(F=t.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(x=t.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.owlFramePerfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:null===(B=null===(q=t.sessionConfig.bootDiagnostics)||void 0===q?void 0:q.legacyPerformanceData)||void 0===B?void 0:B.host,owlFrame:(null===(W=null===(L=t.sessionConfig.bootDiagnostics)||void 0===L?void 0:L.legacyPerformanceData)||void 0===W?void 0:W.owlFrame)||(0,b.vb)()}},uiHostTabId:t.sessionConfig.uiHostTabId,upn:t.sessionConfig.upn,meeting:t.sessionConfig.meeting,customAuthConfigValue:t.sessionConfig.customAuthConfigValue,wiseEnvironment:t.sessionConfig.wiseEnvironment,isSynthetic:t.sessionConfig.isSynthetic,hostUrl:t.sessionConfig.hostUrl,owlVersion:t.sessionConfig.owlVersion,owlRollout:t.sessionConfig.owlRollout,fileType:t.sessionConfig.fileType,clickTime:t.sessionConfig.clickTime,uiCulture:t.sessionConfig.uiCulture,dataCulture:t.sessionConfig.dataCulture,puid:t.sessionConfig.puid,isNewFile:t.sessionConfig.isNewFile,wdValue:t.sessionConfig.wdValue,sessionOrigin:t.sessionConfig.sessionOrigin,intent:t.sessionConfig.intent,hostClientType:t.sessionConfig.hostClientType,isPopOut:t.sessionConfig.isPopOut,teamType:t.sessionConfig.teamType,initPackageParams:t.sessionConfig.initPackageParams&&(0,n.pi)((0,n.pi)({},t.sessionConfig.initPackageParams),{jsApiUrlInfos:pt(null===(j=t.sessionConfig.initPackageParams)||void 0===j?void 0:j.jsApiUrlInfos)}),origin:t.sessionConfig.origin},uiHostConfig:(0,n.pi)((0,n.pi)({},t.uiHostConfig),{featureGates:t.uiHostConfig.featureGates?pt(t.uiHostConfig.featureGates):void 0}),getAuthToken:function(t,e){return pf.getMessagePromise(U.GetAuthTokenResponse,{id:O.GetAuthToken,data:{resourceUrl:t,claims:e}})},eventHandlers:{onBootComplete:G,onBootFailure:K,onReturnFocus:z,onConversationClose:$,onNavigateBack:V,onOpenPageLevelConversation:J,onDocumentClose:Q,onSuccessNotification:X,onOpenInMobileApp:Y},container:document.getElementById("owl-container")||rt()}}(t.data))})),ff.registerHandler(U.BootApplicationWithCustomFunctions,(function(e){(0,v.l)(C.OwlBootAppWithCustomFunctionsMessageReceive),sf(function(t,e){var i,o,r,s,a,c,u,l;return{documentBootInfo:t.documentBootInfo,fetchItemFromNetwork:Z,fetchAccessToken:tt,openShareControl:et,sessionConfig:(0,n.pi)((0,n.pi)({},t.sessionConfig),{bootDiagnostics:(0,n.pi)((0,n.pi)({},t.sessionConfig.bootDiagnostics),{perfNavigationTiming:null===(i=t.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(o=t.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.owlFramePerfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:null===(s=null===(r=t.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.legacyPerformanceData)||void 0===s?void 0:s.host,owlFrame:(null===(c=null===(a=t.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.legacyPerformanceData)||void 0===c?void 0:c.owlFrame)||(0,b.vb)()}})}),container:document.getElementById("owl-container")||rt(),createDocument:nt,setTitle:it,onBootComplete:G,onBootFailure:K,onReturnFocus:z,onConversationClose:$,onNavigateBack:V,onOpenPageLevelConversation:J,onDocumentClose:Q,onSuccessNotification:X,onOpenInMobileApp:Y,onUserActivity:ot,uiHostConfig:(0,n.pi)((0,n.pi)({},t.uiHostConfig),{featureGates:(null===(u=t.uiHostConfig)||void 0===u?void 0:u.featureGates)?pt(t.uiHostConfig.featureGates):void 0}),additionalApplicationParameters:t.additionalApplicationParameters,sharingLinkTokenProvider:t.sharingLinkTokenProvider?{TokenPromise:new Promise((function(t,e){null==ff||ff.registerHandler(U.SharingLinkTokenProvider,(function(n){n.data.token?t(n.data.token):e(n.data.error)}))}))}:void 0,onCAAEMessage:st,onUserAccess:at,onMoveToFolder:ct,onSharedFilePicker:ut,onRename:lt,initPackageParams:t.initPackageParams&&(0,n.pi)((0,n.pi)({},t.initPackageParams),{jsApiUrlInfos:pt(null===(l=t.initPackageParams)||void 0===l?void 0:l.jsApiUrlInfos)}),onFrameChange:ht,invokeSessionRefreshInfoPopupBlockedDialog:function(t){var n=new h(window.parent,e);n.registerHandler(U.SessionRefreshInfoDialogHandleRefresh,(function(){n.dispose(),t.handleRefresh()})),n.registerHandler(U.SessionRefreshInfoDialogHandleCancel,(function(){n.dispose(),t.handleCancel()})),n.registerHandler(U.SessionRefreshInfoDialogOnDismiss,(function(){n.dispose(),t.onDismiss()})),null==ff||ff.sendMessage({id:O.InvokeSessionRefreshInfoPopupBlockedDialog,data:{visible:t.visible}})},onFileEmbed:dt}}(e.data,t))})),ff.registerHandler(U.TokenFetchingExperiment,(function(t){return(0,n.mG)(e,void 0,void 0,(function(){var e,i,o,r,s,a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:L(),(0,v.l)(C.OwlTokenFetchingExperimentMessageReceived),e=t.data.bootParams,i=(0,d.L8)({remoteUlsEndpoint:(0,g.fy)(e.sessionConfig.wiseEnvironment),sessionId:e.sessionConfig.sessionId}),o=Eh(e.sessionConfig,i),r={isESSEnabled:e.sessionConfig.isESSEnabled,wacDataCenter:e.sessionConfig.isESSEnabled?Dh(e.documentBootInfo.fileType):void 0,sessionId:e.sessionConfig.sessionId,hostCorrelationId:e.sessionConfig.hostCorrelationId},"boolean"!=typeof(s=null===(u=e.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isOdcMigrated)||s||(yf=m.NF.OneDriveConsumer),n.label=1;case 1:return n.trys.push([1,3,4,5]),(0,v.l)(C.OwlGetDriveItemWithMsalStart),[4,td(e.documentBootInfo,r,o,e.sessionConfig.wiseEnvironment,yf,e.sessionConfig.sessionId,e.sessionConfig.upn,i)];case 2:return n.sent(),(0,v.l)(C.OwlGetDriveItemWithMsalEnd),[3,5];case 3:return a=n.sent(),null==i||i.ULS.sendTraceTag(508168087,f.W.Xn,p.G.Error,"Failed to get drive item with shared auth, error: ".concat(a)),[3,5];case 4:return F(),[7];case 5:return c=B({owlVersion:null==Cd?void 0:Cd.clientVersion,wiseEnvironment:null==Cd?void 0:Cd.wiseEnvironment,exposure:null==Cd?void 0:Cd.exposure}).owlTelemetryData,null==i||i.ULS.sendTraceTag(508168086,f.W.Xn,p.G.Important,"[Auth Token Experiment Data (Frame)]: ".concat(c)),[2]}}))}))})),(0,v.l)(C.OwlLoadedMessageSend),ff.sendMessage({id:O.FrameLoaded,data:{success:!0}})}(r)}}()}(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=a}();