'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1069:function(I,K,e){function m(T,Y=self){Y.addEventListener("message",function N(S){if(S&&S.data){var {id:V,type:Z,path:ca}=Object.assign({path:[]},S.data),W=(S.data.sZh||[]).map(x);try{const ka=ca.slice(0,-1).reduce((ja,na)=>ja[na],T),ma=ca.reduce((ja,na)=>ja[na],T);switch(Z){case "GET":var X=ma;break;case "SET":ka[ca.slice(-1)[0]]=x(S.data.value);X=!0;break;case "APPLY":X=ma.apply(ka,W);break;case "CONSTRUCT":const ja=
new ma(...W);X=Object.assign(ja,{[E]:!0});break;case "ENDPOINT":const {port1:na,port2:Ba}=new MessageChannel;m(T,Ba);X=w(na,[na]);break;case "RELEASE":X=void 0;break;default:return}}catch(ka){X={value:ka,[D]:0}}Promise.resolve(X).catch(ka=>({value:ka,[D]:0})).then(ka=>{const [ma,ja]=z(ka);Y.postMessage(Object.assign(Object.assign({},ma),{id:V}),ja);"RELEASE"===Z&&(Y.removeEventListener("message",N),"MessagePort"===Y.constructor.name&&Y.close())})}});Y.start&&Y.start()}function f(T){if(T)throw Error("Proxy has been released and is not useable");
}function a(T,Y=[],P=function(){}){let S=!1;const N=new Proxy(P,{get(V,Z){f(S);if(Z===H)return()=>u(T,{type:"RELEASE",path:Y.map(ca=>ca.toString())}).then(()=>{"MessagePort"===T.constructor.name&&T.close();S=!0});if("then"===Z){if(0===Y.length)return{then:()=>N};V=u(T,{type:"GET",path:Y.map(ca=>ca.toString())}).then(x);return V.then.bind(V)}return a(T,[...Y,Z])},set(V,Z,ca){f(S);const [W,X]=z(ca);return u(T,{type:"SET",path:[...Y,Z].map(ka=>ka.toString()),value:W},X).then(x)},apply(V,Z,ca){f(S);V=
Y[Y.length-1];if(V===y)return u(T,{type:"ENDPOINT"}).then(x);if("bind"===V)return a(T,Y.slice(0,-1));const [W,X]=l(ca);return u(T,{type:"APPLY",path:Y.map(ka=>ka.toString()),sZh:W},X).then(x)},construct(V,Z){f(S);const [ca,W]=l(Z);return u(T,{type:"CONSTRUCT",path:Y.map(X=>X.toString()),sZh:ca},W).then(x)}});return N}function l(T){T=T.map(z);return[T.map(Y=>Y[0]),Array.prototype.concat.apply([],T.map(Y=>Y[1]))]}function w(T,Y){U.set(T,Y);return T}function z(T){for(const [Y,P]of J)if(P.h4h(T)){const [S,
N]=P.serialize(T);return[{type:"HANDLER",name:Y,value:S},N]}return[{type:"RAW",value:T},U.get(T)||[]]}function x(T){switch(T.type){case "HANDLER":return J.get(T.name).deserialize(T.value);case "RAW":return T.value}}function u(T,Y,P){return new Promise(S=>{const N=v();T.addEventListener("message",function ca(Z){Z.data&&Z.data.id&&Z.data.id===N&&(T.removeEventListener("message",ca),S(Z.data))});T.start&&T.start();T.postMessage(Object.assign({id:N},Y),P)})}function v(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}I=e(0);const E=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),D=Symbol("Comlink.thrown"),G=T=>"object"===typeof T&&null!==T||"function"===typeof T,J=new Map([["proxy",{h4h:T=>G(T)&&T[E],serialize(T){const {port1:Y,port2:P}=new MessageChannel;m(T,Y);return[P,[P]]},deserialize(T){T.start();return a(T,[],void 0)}}],["throw",{h4h:T=>G(T)&&D in T,serialize({value:T}){return[T instanceof Error?
{BZa:!0,value:{message:T.message,name:T.name,stack:T.stack}}:{BZa:!1,value:T},[]]},deserialize(T){if(T.BZa)throw Object.assign(Error(T.value.message),T.value);throw T.value;}}]]),U=new WeakMap;e.d(K,"a",function(){return F});class F{static xrk(T){F.ukb=T;F.eZk=a(T,[],void 0)}static get Endpoint(){return F.ukb}static get yrk(){return F.eZk}}Object(I.a)(F,"WorkerUtils",null,[])},1080:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{}Object(I.a)(m,"WaterlineOverrideSettings",null,[])},
1081:function(I,K,e){I=e(0);var m=e(432),f=e(416),a=e(596),l=e(262),w=e(459);class z extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}Hn(){return w.a.KJf}static yma(H,D,G){const J=new z;J.FileId=H;J.HighWaterline=D;J.LowWaterline=G;return J}}Object(I.a)(z,"GetActivitiesRequest",l.a,[]);class x extends l.a{constructor(H,D,G){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=H;this.Waterline=D;this.Settings=G}Hn(){return w.a.pQf}static yma(H,D,
G){return new x(H,D,G)}}Object(I.a)(x,"GetRelevantActivitiesRequest",l.a,[]);class u extends l.a{constructor(H,D){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=H;this.WaterlineOverrideSettings=D}Hn(){return w.a.DYm}static yma(H,D){return new u(H,D)}}Object(I.a)(u,"GetWywaActivitiesRequest",l.a,[]);class v{}Object(I.a)(v,"RelevantActivitiesSettings",null,[]);class E extends l.a{constructor(){super();this.FileId=null}Hn(){return w.a.Nwd}static yma(H){const D=new E;D.FileId=H;return D}}
Object(I.a)(E,"UpdateWaterlineRequest",l.a,[]);e.d(K,"a",function(){return y});class y{constructor(H,D,G,J,U){this.BLk=H;this.HOd=D;this.p9e=G;this.kGc=J;this.Rfh=U}requestWYWAActivities(H){H=u.yma(this.HOd(),H);return m.a.then(this.D8(H,"wywa"),D=>D)}requestActivities(H,D){H=z.yma(this.HOd(),H,D);return m.a.then(this.D8(H,"activities"),G=>G)}eNo(){const H=E.yma(this.HOd());return m.a.then(this.D8(H,"waterline"),D=>D)}requestRelevantActivities(H,D){D=Object.assign(new v,{FirstDocumentOpen:D,MockDataEnabled:!1});
H=x.yma(this.HOd(),H,D);return m.a.then(this.D8(H,"relevant"),G=>G)}updateActivityState(H){return m.a.Pud(this.Rfh,D=>D.bCp(H.itemIds,H.activityStatesToSet,H.activityStatesToReset,H.resetUnseenCount))}requestActivityFeed(){return m.a.Pud(this.Rfh,H=>H.LJf(null))}D8(H,D){const G={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.Pud(this.BLk,J=>J.iu(this.p9e,G,f.a.nai(H,this.kGc),D)),J=>{if(!(J&&J.args&&J.args.data&&J.args.data.responseData))return null;({group:J}=a.a.A6(J.args.data.responseData));
return J&&J.Responses&&J.Responses.length?J.Responses[0]:null})}}Object(I.a)(y,"SharedActivityRepository",null,[])},1290:function(I,K,e){e.d(K,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.RVp=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.dZp=1]="VoiceDictationBadge";a[a.eZp=2]="VoiceDictationPhrase"})(f||(f={}))},1492:function(I,K,e){e.d(K,"a",function(){return a});I=e(0);var m=e(2),f=e(6);class a{static get fCb(){return!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.$("WordDesignerTelemetryPerConstructIsEnabled")}static gtb(l,w=!1){const z=f.a.kb(l);z.Wd();return(w?z.ic(4):z.Ina(4))?4:f.a.kb(l).Ib(36)?16:f.a.kb(l).Ib(14)?2:f.a.kb(l).Ib(38)?32:1}}Object(I.a)(a,"ConstructTypeHelper",null,[])},1524:function(I,K,e){e.d(K,"a",function(){return S});I=e(0);var m=e(218),f=e(21),a=e(267),l=e(2),w=e(226),z=e(5),x=e(76),u=e(11),v=e(773),E=e(133),y=e(261),H=e(3),D=e(85),G=e(65),J=e(38),U=e(462),F=e(175),T=e(18),Y=e(258),P=e(7);class S{static get Ig(){return Y.a.instance}static get Jc(){return m.a.instance}static lA(){return S.Qo||
(S.Qo=f.a.instance.Za("Box4.IExternalSelectionManager"))}static get lE(){return null!=S.B7g?S.B7g:S.B7g=f.a.instance.resolve("Box4.IParagraphIndentationReader")}static hVm(){this.zS||(this.zS=new x.a,this.zS.add(H.a.tE),this.zS.add(H.a.font),this.zS.add(H.a.O2),this.zS.add(H.a.GBa),this.zS.add(H.a.bold),this.zS.add(H.a.cC),this.zS.add(H.a.superscript),this.zS.add(H.a.subscript),this.zS.add(H.a.j9a),this.zS.add(H.a.EBa),this.zS.add(H.a.DKa),this.zS.add(H.a.Yqf),this.zS.add(H.a.EKa),this.zS.add(H.a.i9a),
this.zS.add(H.a.V4),this.zS.add(H.a.m6),this.zS.add(H.a.dG),this.zS.add(H.a.Ppb),this.zS.add(H.a.pYc));return this.zS}static bqc(N){return S.hVm().contains(N)?!0:!1}static oz(N,V,Z,ca,W){var X=!0;if(!V.view.Ee)return 2;var ka=V.view,ma=ka.ub;ma&&ma.ob.currentSelection||(S.Jc.qc(D.a.$e,{["Reason"]:G.a.Mo}),X=!1);Object(F.a)().YKa(E.a.Cbd,ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.ruf}),X=!1);if(Object(F.a)().YKa(E.a.lcb,ka.ub.hh))return S.Jc.qc(D.a.$e,{["Reason"]:G.a.sZc}),8;var ja=!S.bqc(N);S.Ig.gqc(ka.ub.hh,
ja)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.EI}),X=!1);Object(F.a)().YKa(E.a.yhe,ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.luf}),X=!1);Object(F.a)().YKa(y.c,ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.muf}),X=!1);Object(F.a)().YKa(v.a.u1f,ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.kuf}),X=!1);Object(F.a)().eHa(P.ParagraphReader.uZ,ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.NS}),X=!1);S.lA()&&S.lA().instance&&S.lA().instance.wZ(ka.ub.hh)&&(S.Jc.qc(D.a.$e,{["Reason"]:G.a.R$a}),X=!1);var na=null;ma&&ma.ob.currentSelection&&
(na=ma.ob.currentSelection);if(1===Z||!X||!na)return X?32:8;X=N===H.a.$sc||N===H.a.ahc||N===H.a.Oyc||N===H.a.wlc;ka=N===H.a.H_b||N===H.a.dQb||N===H.a.Vxc;ja=N===H.a.i2a||N===H.a.j2a||N===H.a.HG;const Ba=new J.GraphTransaction(15);Ba.Eb(na.Ya.node);na=new x.a;let Ma=!1;if(X||ka||ja)a.a.mark(7121),V=Object(F.a)().Wwi(V.Pk);else{a.a.mark(7119);V=U.OutlineElementGeneralizer.lna(ma.ob,!0);if(!V)return S.Jc.qc(D.a.pua,{["Reason"]:G.a.R5d}),Ba.dispose(),8;ma=N===H.a.Ubb||N===H.a.Wub;V.My&&ma&&(Ma=S.I4m(na,
V))}(N===H.a.G9||N===H.a.$sc||N===H.a.Rba||N===H.a.ahc||N===H.a.p$||N===H.a.Oyc||N===H.a.vMa||N===H.a.wlc)&&V.My&&1<V.length&&S.J4m(V)&&(W||(W={}),Object.getType(W)===Object&&(W.InContextSet=!0));l.AFrameworkApplication.va.Sf(V,N,Z,!0,ca,W);Ma&&S.jZn(na,V,W);Ba.dispose();T.StaticActiveAppFrame.Aa().Ne();X||ka||ja?a.a.mark(7122):a.a.mark(7120);return 32}static I4m(N,V){if(!V.My)return!1;let Z=!1,ca=!1;for(let X=0;X<V.length;X++)if(V.getContext(X).nm){var W=V.getContext(X).node;W&&(W=S.lE.wtb(W),2===
W.specialIndentType?(Z=!0,N.add(X)):1!==W.specialIndentType&&W.specialIndentType||(ca=!0))}return ca&&Z}static jZn(N,V,Z){if(V.My)for(let W=0;W<N.count;W++){var ca=V.getContext(N.K(W));if(!ca.nm)continue;ca=ca.node;const X=S.lE.wtb(ca);2!==X.specialIndentType||w.a.YDa(Z.value,X.NC)||ca.setValue(z.a.ve,X.NC-X.Bja)}}static yFg(N,V){let Z=!0;V.contextId!==u.a.paragraph?Z=!1:S.Ig.Rcb(V)?(S.Jc.qc(D.a.Lo,{["Reason"]:G.a.EI}),Z=!1):S.lA()&&S.lA().instance&&S.lA().instance.wZ(V)?(S.Jc.qc(D.a.Lo,{["Reason"]:G.a.R$a}),
Z=!1):V.nm&&(V=V.node,P.ParagraphReader.lc(V)&&V.LV&&(S.Jc.qc(D.a.Lo,{["Reason"]:G.a.NS}),Z=!1));return{returnValue:1!==N&&Z,xB:Z?32:8}}static J4m(N){if(!N.My)return!1;let V=1;for(let ca=0;ca<N.length;ca++){var Z=N.getContext(ca);if(Z&&Z.nm&&Z.contextId===u.a.paragraph&&(Z=Z.node))if(Z=P.ParagraphReader.VA(Z),!ca)V=Z;else if(Z!==V)return!0}return!1}}S.Qo=null;S.zS=null;Object(I.a)(S,"FormattingActionHelper",null,[])},1528:function(I,K,e){e.d(K,"a",function(){return f});e.d(K,"b",function(){return a});
var m=e(2);const f=l=>{switch(l){case 2:return WacWordeditorStrings.ResultTypeHeader;case 4:return WacWordeditorStrings.ResultTypeFooter;case 8:return WacWordeditorStrings.ResultTypeFootnote;case 16:return WacWordeditorStrings.ResultTypeEndnote;case 32:return WacWordeditorStrings.ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.J)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1548:function(I,K,e){I=e(0);
class m{constructor(z,x,u,v){this.Zxk=z;this.DRk=x;this.BRk=u;this.ERk=v}get f0d(){return this.Zxk}get Mye(){return this.DRk}get Kye(){return this.BRk}get resultType(){return this.ERk}}Object(I.a)(m,"SearchContext",null,[1990]);class f{r1d(z,x,u,v){var E=u-x;let y;if(100<=E)E=x,y=u;else{E=Math.max(0,x+Math.ceil(E/2)-50);y=Math.min(z.length,E+100);E=Math.max(0,y-100);let D;if(E&&" "!==z.charAt(E-1)){D=Math.min(x,E+10);for(var H=E;H<D;++H)if(" "===z.charAt(H)){E=H+1;break}}if(y!==z.length&&" "!==z.charAt(y))for(D=
Math.max(u,y-10),H=y-1;H>=D;--H)if(" "===z.charAt(H)){y=H;break}}z=z.substring(E,y);return new m(z,x-E,u-E,v)}s1d(z){return this.r1d(z.vIi(),z.Mc,z.end,"")}}Object(I.a)(f,"SearchContextFactory",null,[1974]);var a=e(117),l=e(1528);e.d(K,"a",function(){return w});class w extends f{constructor(){super()}s1d(z){let x=z.Mc,u=z.end;const v=({Mc:x,end:u}=w.GKm(z,x,u)).returnValue;z=l.a(z.type);return this.r1d(v,x,u,z)}static get instance(){return null!=w.j2g?w.j2g:w.j2g=new w}static GKm(z,x,u){z=z.vIi();
return w.YHj(z,x,u)}static YHj(z,x,u){const v=a.AParagraphNode.DR(z);if(v.length<z.length){z=z.substring(0,x);const E=a.AParagraphNode.DR(z);z=z.length-E.length;x-=z;u-=z}return{returnValue:v,Mc:x,end:u}}}Object(I.a)(w,"EditorSearchContextFactory",f,[])},1551:function(I,K,e){I=e(0);var m=e(2),f=e(21),a=e(403),l=e(739),w=e(23),z=e(18),x=e(137),u=e(54),v=e(565),E=e(187),y=e(229),H=e(72),D=e(26),G=e(7),J=e(3),U=e(5),F=e(61),T=e(482),Y=e(1064);class P{create(){return new Y.a}}Object(I.a)(P,"FootnoteEndnoteContainerNodeFactory",
null,[265]);var S=e(553);e.d(K,"a",function(){return N});class N{constructor(V,Z,ca,W,X,ka,ma,ja,na){this.CSd=null;N.ga=V;this.hI=ca;this.q6e=W;this.Cxk=ka;this.td=ma;this.pb=X;this.vLk=ja;this.Qyk=na;N.mi=Z}Tne(V,Z){this.Q7l(V);V.ic(7);this.hI.H2i(V,Z)||V.gg(7)}Q7l(V){if(this.q6e.v5i(V)){var Z=!1,ca=!1;if(V.ic(7)){do{const W=V.currentNode;if(37===W.type)switch(W.getValue(U.a.Q8)){case 0:ca=!0;break;case 1:Z=!0}}while(V.Di(7))}ca||this.mSh(V,0);Z||this.mSh(V,1)}}mSh(V,Z){const ca=this.Cxk.create(F.a.rMa);
ca.setValue(U.a.Q8,Z);V.pg(ca,7)}qVo(V){V&&this.vQj(V.tua)}vQj(V){V&&(V=w.SelectionFactory.Ie(V.Rb.paragraph,V.Rb.cp+1),this.pb.Uc(V))}FXn(V){let Z=this.vLk(V);void 0!==Z&&null!==Z?this.hI.xva(Z)&&(Z=this.hI.QIi(Z)):Z=V;return this.Qyk(Z)}pgp(){this.CSd?N.mi.$L.removeEntry(this.CSd):this.CSd=N.mi.$L.Hma(WacWordeditorStrings.FootnoteEndnoteFormattingUnsupportedNotification,!1);N.mi.$L.yB(this.CSd)}udl(V,Z){V=this.td.Gua(V,37,37);let ca=!1;if(V.ue()){do{const W=V.currentNode;this.hI.K4f(W)?this.iYh(W,
Z):ca=!0}while(V.xl())}ca&&this.pgp()}iYh(V,Z){T.f(V,ca=>{N.rjm(ca,Z);return!0},12)}o4m(V,Z){V=this.hI.Y5c(V,Z);return V?(V=this.td.Ag(V))?V.hasChildren():!1:!1}mDi(V,Z){V=this.hI.Y5c(V,Z);V=this.td.Ag(V);if(V.ue()){do if(Z=V.currentNode,1===Z.getValue(U.a.uua))return Z;while(V.xl())}return null}static Z5c(){return new N(m.AFrameworkApplication.va,z.StaticActiveAppFrame.Aa(),S.a.instance,x.a.instance,u.a.instance,new P,new v.a,E.OutlineNavigator.zXn,y.a.Tyf)}static get instance(){return null!=N.t2g?
N.t2g:N.t2g=N.Z5c()}static get gm(){return null!=N.w7g?N.w7g:N.w7g=f.a.instance.resolve("Box4.IParagraphEditor")}static rjm(V,Z){Z.oub?N.gm.Hs.pja(V,H.a.u1(V)):N.gm.Hs.pja(V,0);V=D.a.createTextRange(V,0,G.ParagraphReader.textLength(V));N.ga.Sf(V,J.a.font,2,!0,new a.a,new l.a(Z.fontName));N.ga.Sf(V,J.a.tE,2,!0,new a.a,new l.a(Z.fontSize))}}N.ga=null;N.mi=null;Object(I.a)(N,"FootnoteEndnoteEditor",null,[469])},1585:function(I,K,e){e.d(K,"a",function(){return F});I=e(0);var m=e(21),f=e(49),a=e(69),l=
e(60),w=e(38),z=e(536),x=e(137),u=e(565),v=e(123),E=e(112),y=e(5),H=e(908),D=e(794),G=e(553),J=e(1474),U=e(1551);class F{constructor(T,Y,P,S,N,V){this.hI=T;this.dTa=P;this.q6e=S;this.ySe=N;this.td=V}static get Zf(){return null!=F.J9g?F.J9g:F.J9g=m.a.instance.Wa("Box4.Styles.StyleSettings")}whn(T,Y,P){const S=this.LFi(Y,T.node),N=T.node.ed;if(!N)return null;const V=new w.GraphTransaction(15);V.Eb(T.node);V.Bh=P;P=this.xhn(S,Y);F.yhn(P,N,T,Y);V.dispose();return P}LFi(T,Y){const P=this.td.Lm();P.set(Y);
P.Ib(7);P.xd(7);this.dTa.Tne(P,T);return P}xhn(T,Y){const P=D.a.createNode();P.properties.setValue(y.a.Q8,Y);T.pg(P,8);this.ySe.aLl(P,Y);return P}static get Ug(){return null!=F.vXg?F.vXg:F.vXg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get c3(){return F.uV||(F.uV=new z.a)}static set c3(T){F.uV=T}static Z5c(){const {FootnoteEndnoteDefaultContentInserter:T}=e(1699);return new F(G.a.instance,J.a.instance,U.a.instance,x.a.instance,T.instance,new u.a)}static get instance(){return null!=
F.c3g?F.c3g:F.c3g=F.Z5c()}static yhn(T,Y,P,S){a.a.Gd().pn&&a.a.Gd().Qk.uI(P.node);const N=new v.a;N.setValue(y.a.flc,T.id);N.setValue(y.a.Q8,S);const V=Y.Mv(N,f.a.create());F.Ug.Vna(P,Z=>H.a.getInstance(Z,V,T.id),F.Szi(P.node,S,Object(E.a)()))}static Szi(T,Y,P){let S=null;if(T=P.kw(T))if(T=F.c3.Oca(T))Y=Y?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference,this.Zf.zl?(Y=T.Ev().Ena(Y),S=T.Qg(l.a.kc.Je(Y))):S=T.Rua(Y);return S}}F.uV=null;Object(I.a)(F,
"FootnoteEndnoteInserter",null,[596])},1590:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{static lLo(f,a){m.X5e=f;m.i9e=a}static iLo(f,a){m.f9e=f;m.P7a=a}static NKi(){return m.f9e===m.P7a?String.format(WacWordeditorStrings.ReplacedAllMessage,m.P7a,m.X5e,m.i9e):String.format(WacWordeditorStrings.ReplacedSomeMessage,m.f9e,m.P7a,m.X5e,m.i9e)}}m.f9e=0;m.P7a=0;m.X5e=null;m.i9e=null;Object(I.a)(m,"ReplaceAllContext",null,[])},1628:function(I,K,e){e.r(K);I=e(0);var m=e(2106),f=e(49),a=e(2),
l=e(465),w=e(21),z=e(2149),x=e(18),u=e(8),v=e(277),E=e(2108),y=e(12),H=e(19),D=e(1548);class G{constructor(Vb="",yb="",Db=!1,$b=!1){this.Gun=Db;this.yyn=$b;this.actionId=Vb;this.AQa=yb}}Object(I.a)(G,"SearchEntryPointContext",null,[]);class J{constructor(Vb){this.ula=null;this.Vw=!1;this.aS=Vb}initialize(){this.CY();this.bD();this.Sba(0)}bD(){this.ula.bD()}dispose(){this.aS=null}p7c(){return!1}get UJ(){return this.ula?this.ula.UJ:0}Sba(Vb){this.ula.Sba(Vb)}get isVisible(){return this.Vw}Bif(Vb){this.ula&&
this.ula.y_p(Vb)}$Ij(Vb){this.ula&&this.ula.qrq(Vb)}Qdk(Vb){this.ula&&this.ula.szq(Vb)}x7h(){this.ula&&this.ula.o2p()}Qze(Vb){this.ula&&this.ula.Qze(Vb)}}Object(I.a)(J,"FindReplacePane",null,[491,11]);var U=e(89),F=e(92),T=e(1876),Y=e(96),P=e(1264),S=e(243),N=e(205),V=e(1513),Z=e(386),ca=e(115),W=e(90),X=e(46),ka=e(1376),ma=e(39),ja=e(54),na=e(893),Ba=e(1417),Ma=e(1385),Ea=e(1424),ya=e(1420),ia=e(103),za=e(1090);class Ca{constructor(Vb){this.e2k=(yb,Db)=>{this.DSd.Bb(yb)?this.DSd.W(yb,Db):this.DSd.add(yb,
Db);(yb=this.gom(yb))&&this.GZi(Db,yb,this.Mbi(Ma.a.getTypeName()))};this.DSd=new ia.a;this.C_=new ia.a;this.annotationType=Ba.RoleDetectionAnnotation.getTypeName();Vb.JAo(this.e2k)}XI(Vb,yb){let Db;const $b=Vb.parentPath.substr(Vb.parentPath.lastIndexOf("\\")+1),Fa=Vb.content;if(!Fa||this.cyn(Fa))""!==$b&&({value:Db}=this.DSd.Nc($b,Db)).returnValue&&this.GZi(Db,Vb,this.Mbi(yb)),yb===Ma.a.getTypeName()?(yb=null,({value:yb}=this.C_.Nc($b,yb)).returnValue?this.C_.W($b,Vb):this.C_.add($b,Vb)):yb===Ea.a.getTypeName()&&
this.C_.remove($b)}GZi(Vb,yb,Db){const $b=this.KEm(yb);yb=this.hom(yb);0<yb&&Vb(Db,$b,yb)}hom(Vb){try{return Number.parseInvariant(Vb.id.substr(2))}catch(yb){u.ULS.sendTraceTag(554747009,367,10,yb.toString())}return-1}gom(Vb){let yb;return({value:yb}=this.C_.Nc(Vb,yb)).returnValue?yb:null}Xkd(Vb){if(Vb)for(const yb of Vb)this.XI(yb,"AugLoop_Core_AddOperation")}KEm(Vb){if(Vb=Vb.content)switch(Vb.roleType){case Ba.RoleType.Heading1:return 1;case Ba.RoleType.Heading2:return 2;case Ba.RoleType.Heading3:return 3;
case Ba.RoleType.Heading4:return 4;case Ba.RoleType.Heading5:return 5;case Ba.RoleType.Heading6:return 6;case Ba.RoleType.Heading7:return 7;case Ba.RoleType.Heading8:return 8;case Ba.RoleType.Heading9:return 9}return-1}cyn(Vb){Vb=Vb.roleType;return Vb===Ba.RoleType.Heading1||Vb===Ba.RoleType.Heading2||Vb===Ba.RoleType.Heading3||Vb===Ba.RoleType.Heading4||Vb===Ba.RoleType.Heading5||Vb===Ba.RoleType.Heading6||Vb===Ba.RoleType.Heading7||Vb===Ba.RoleType.Heading8||Vb===Ba.RoleType.Heading9}Mbi(Vb){if(Vb===
Ma.a.getTypeName()||Vb===ya.a.getTypeName())return za.a.hTh;if(Vb===Ea.a.getTypeName())return za.a.pzf;throw Error.create("Invalid operation type");}}Object(I.a)(Ca,"RoleDetectionAnnotationHandler",null,[365]);var db=e(95),pa=e(63),ua=e(1774),Ga=e(76),wa=e(118);class xa{constructor(Vb){this.C_=new ia.a;this.fCh=Vb}XI(Vb,yb){yb===Ma.a.getTypeName()?(yb=null,({value:yb}=this.C_.Nc(Vb.id,yb)).returnValue?this.C_.W(Vb.id,Vb):this.C_.add(Vb.id,Vb)):yb===Ea.a.getTypeName()&&this.C_.remove(Vb.id);this.fCh&&
this.fCh()}Xkd(Vb){if(Vb)for(const yb of Vb)this.XI(yb,Ma.a.getTypeName())}getAnnotations(){var Vb;const yb=[];if(0<(null===(Vb=this.C_)||void 0===Vb?void 0:Vb.count))for(const Db of this.C_.values)yb.push(Db);return yb}}Object(I.a)(xa,"ContractEntityAnnotationHandler",null,[365]);var sa=e(3),Ka=e(1635);class Na{constructor(Vb){this.ga=Vb}Q2n(){this.dYd()}Q4n(Vb){this.ga.Zb(H.a.qce,2,Vb)}X7n(){Ka.a.DHe();this.dYd()}dYd(){this.ga.Vb(sa.a.Pgc,2)}i$n(){this.ga.Vb(sa.a.yGf,2)}onSearchQueryChanged(Vb){this.ga.Zb(sa.a.zGf,
2,Vb)}Qao(){this.ga.Vb(H.a.replace,2)}Rao(){this.ga.Vb(H.a.replaceAll,2)}Mao(){this.ga.Vb(y.a.uGf,2)}Nao(){this.ga.Vb(y.a.OGf,2)}Pao(){this.ga.Vb(sa.a.Rpg,2)}Oao(){this.ga.Vb(sa.a.Hfg,2)}sxc(Vb){this.ga.Zb(H.a.sxc,2,Vb)}}Object(I.a)(Na,"FindReplaceActions",null,[510]);var ub=e(165);class Ua{}Ua.zU=ub.a.nsb;Ua.fwc=0;Ua.rCa="FindReplaceTaskPaneData";Ua.AU=WacWordeditorStrings.NavigationPaneTitle;Object(I.a)(Ua,"FindReplaceConstants",null,[]);var sb=e(791);class qb{u9j(Vb){var yb,Db,$b;return na.a.cbb(null===
($b=null===(Db=null===(yb=x.StaticActiveAppFrame.Aa())||void 0===yb?void 0:yb.tb)||void 0===Db?void 0:Db.rd)||void 0===$b?void 0:$b.Hd,Vb)}clearSelection(){if(this.c2e){const Vb=this.u9j(this.c2e);Vb&&Vb.pta()}this.c2e=this.aJh=null}hVo(Vb){this.clearSelection();if(Vb){const yb=this.u9j(Vb.parentPath);if(yb){const Db=Vb.content;Db&&(this.aJh=Vb.id,yb.c2a([new sb.a(Db.range.start,Db.range.start+Db.range.length)]),yb.yag(0,1));this.c2e=Vb.parentPath}}}}Object(I.a)(qb,"RangeAnnotationContentSelector",
null,[]);var ab=e(1590);class Xa{constructor(Vb){this.zJk=Vb}get il(){return this.zJk.value}mIm(Vb){Vb=this.il.abb(Vb);return this.Uqn(Vb)?null:Vb}Uqn(Vb){return Vb.id===this.il.kMa.id}static get instance(){return null!=Xa.N1g?Xa.N1g:Xa.N1g=Xa.JI()}static JI(){const Vb=new v.a(()=>z.a.instance.il);return new Xa(Vb)}}Object(I.a)(Xa,"SearchResultOrder",null,[]);var wb=e(7),Sa=e(117),cc=e(246);class Cb{constructor(Vb){this.z2e=Vb}get oJ(){return this.z2e.value}getSelectedText(){var Vb,yb;const Db=this.oJ.dha,
$b=null===(Vb=a.AFrameworkApplication.J)||void 0===Vb?void 0:Vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isImageSelectedTextFixEnabled",!1);if(Db){Vb=Db.cpBegin;const Fa=Db.cpEnd,lb=Fa-Vb,kb=null===(yb=a.AFrameworkApplication.J)||void 0===yb?void 0:yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCompleteParagraphSearchEnabled",!1);if(0<lb||kb&&-1===Vb&&-1===Fa)if(yb=Db.node,wb.ParagraphReader.lc(yb))return yb=0<lb?yb.characterData.substr(Vb,lb):yb.characterData.substring(0,yb.characterData.length),
$b?Sa.AParagraphNode.DR(yb,""):yb}return null}static getInstance(){return Cb.In()}static In(){const Vb=new v.a(()=>cc.a.instance);return new Cb(Vb)}}Object(I.a)(Cb,"SelectionHelper",null,[]);var Wa=e(31),Ja=e(100),Va=e(891),mb=e(896),Ab=e(319),Xb=e(892),Lb=e(1894);ub=e(208);var dc=e(244),yc=e(350),Wc=e(112),zb=e(662);class cd extends ub.a{constructor(Vb,yb,Db){super(Vb,yb,dc.a.Uua());this.HPa=Db;this.CSi=!1}get I5f(){return!0}get $na(){return super.$na|248}static $Pl(Vb){var yb=x.StaticActiveAppFrame.Aa().tb.rd;
const Db=yc.a.instance.Vc(3);yb&&(yb=Object(Wc.a)().DT(yb))&&(Vb=new cd(new zb.a,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),Vb),Db.H2b(Vb.Lc),Vb.qC(yb),Db.dispose(),Vb.CSi=!0)}}Object(I.a)(cd,"WordNavigationPaneReactHeadingsView",ub.a,[131,90,11]);class qc extends Sys.EventArgs{constructor(){super()}}Object(I.a)(qc,"FindReplaceToggleEventArgs",Sys.EventArgs,[]);class Dc extends J{constructor(Vb,yb,Db,$b,Fa,lb,kb,Ob,nc,zc,Pb,tb,ib,Rb){var gc,xc,Nc,Kc,fd,jd;super(Vb);this.mGb=Ua.zU;this.$Vk=
"FindReplaceTaskPaneProps";this.oc=U.FocusManager.instance();this.y4a=this.OUa=this.J3=this.ocf=null;this.vd=new F.a;this.HGf="findReplacePaneToggled";this.T6b=a.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled");this.Qtk=a.AFrameworkApplication.J.$("AutoDetectedHeadingsIsEnabled");this.rLk=null===(gc=a.AFrameworkApplication.J)||void 0===gc?void 0:gc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.sLk=null===(xc=a.AFrameworkApplication.J)||void 0===xc?void 0:
xc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneRemoveRedundantChangeView",!1);this.Rac=null===(Nc=a.AFrameworkApplication.J)||void 0===Nc?void 0:Nc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnScroll",!1);this.MOc=null===(Kc=a.AFrameworkApplication.J)||void 0===Kc?void 0:Kc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnSelectionChange",!1);this.XAh=null===(fd=a.AFrameworkApplication.J)||void 0===fd?void 0:fd.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneDisableShimmer",
!1);this.tLk=null===(jd=a.AFrameworkApplication.J)||void 0===jd?void 0:jd.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneUpdateCommandUIAsyncEnabled",!1);this.pLc=!1;this.IPg=()=>{this.isVisible&&this.O1d===E.a.intelligentPlaceholder&&this.ao()};this.kC=new T.a;this.jph=yb;this.ASa=E.a.headings;this.vUc=m.a.initial;this.yza=new Ga.a;this.nS="";this.mKc={matchCase:!1,matchWholeWord:!1};this.h9e="";this.X$e=null;this.qY=Db;this.IKh=!1;this.fnb=$b;this.pb=Fa;this.LLk=lb;this.OJa=kb;this.LM=
Ob;this.BLd=!0;this.Yaa=this.Xaa=!1;this.ff=nc;this.WF=zc;this.Sb=Pb;this.A_=tb;this.Shh=ib;this.ym=Rb;this.iOe&&this.OJa.BEo(()=>{this.ao()});if(this.Rac||this.MOc)this.Vqe=this.Vqe.bind(this),this.Pde=this.Pde.bind(this),this.Zze=this.Zze.bind(this),this.Iqh=new Y.a(0,1,0,this.Pde)}get Wcf(){return 1}get iOe(){return this.T6b&&this.Qtk&&!!this.ff}get jOe(){return this.T6b&&this.rLk&&!!this.ff}Pde(){var Vb=-1;this.MOc&&(Vb=ma.a.cPi(ja.a.instance.ob.currentSelection,this.ki));0<=Vb&&100>=Vb?Vb=this.WF.s7m():
(Vb=this.ki.vlm(),Vb=this.WF.r7m(Vb));Vb&&this.ao();this.pLc=!1}Y8k(Vb){this.vd.addHandler(this.HGf,Vb)}zJo(Vb){this.vd.removeHandler(this.HGf,Vb)}dEj(Vb){this.vd.raiseEvent(this.HGf,new qc(Vb))}vEo(Vb){this.Y8k(Vb)}fIo(Vb){this.zJo(Vb)}get headingsReady(){return this.WF?this.WF.headingsReady:!1}set headingsReady(Vb){this.WF&&(this.WF.headingsReady=Vb)}get O1d(){return this.ASa}g_j(){this.ASa=E.a.headings;this.ao()}Edp(){this.ASa=E.a.contracts;this.ao()}YZj(){this.ASa=E.a.find;X.a("NavigationPaneFind");
this.ao()}O_j(){this.ASa=E.a.replace;this.ao()}t_j(){this.ASa=E.a.intelligentPlaceholder;this.ao()}Lsd(Vb){this.IKh=Vb;this.ao()}p7c(){return this.O1d===E.a.replace}get UJ(){return this.vUc}Sba(Vb){this.vUc=Vb;this.ao()}Bif(Vb){this.G4k(Vb);this.ao()}G4k(Vb){const yb=this.LLk(Vb[Vb.length-1]);if(yb){let Db=-1;for(let $b=0;$b<this.yza.count;$b++)if(yb.id===this.yza.K($b).id){Db=$b;break}-1===Db?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.yza.PC(Db,this.kci(Vb))}else this.yza.addRange(this.kci(Vb))}$Ij(Vb){for(const yb of Vb)for(Vb=
this.yza.count-1;0<=Vb;Vb--)if(this.yza.K(Vb).id===yb.id){this.yza.removeAt(Vb);break}this.ao()}Qdk(Vb){for(const yb of Vb)for(Vb=this.yza.count-1;0<=Vb;Vb--)if(this.yza.K(Vb).id===yb.id){this.yza.W(Vb,this.jci(yb));break}this.ao()}x7h(){this.yza.clear();this.X$e=null;this.ao()}Qze(Vb){this.X$e=Vb?Vb.id:null;this.ao()}kci(Vb){if(!Vb)return new Ga.a;const yb=new Ga.a;for(const Db of Vb)yb.add(this.jci(Db));return yb}jci(Vb){const yb=this.fnb.s1d(Vb);return{id:Vb.id,searchBeginIndex:yb.Mye,searchEndIndex:yb.Kye,
searchResult:yb.f0d}}wIe(){}jIp(){var Vb={};this.aS.sxc(Vb);Vb=Vb[P.a.Value];this.ocf=ka.c(Vb)?"":Vb;this.ao()}hYa(){return this.nS}rTb(){return this.h9e}QCg(Vb){this.nS=Vb;this.ao()}JKa(){}initialize(){this.bQd=window.performance.now();const Vb=this.oc.te(this.mGb);Vb.parent=S.AFrame.rr;Vb.LN=!0;this.CY();a.AFrameworkApplication.ud("NavPaneRemoveRedundantChangeView-tf;NavPaneRemoveRedundantChangeView-cf");this.sLk||this.Sba(m.a.initial)}sU(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),
N.UISurfaces.aw().then(Vb=>{Vb.setSelectedTaskPane(this.mGb,this.Wcf);this.ZW();this.BLd&&this.rVj(!0);return null}).catch(Vb=>{Dc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Vb)})):(this.Ssd(),this.BLd&&this.rVj(!1))}rVj(Vb){var yb;const Db=this.jph();Db?this.nS=Db:Vb&&this.nS||(this.nS="");if(null===(yb=a.AFrameworkApplication.J)||void 0===yb||!yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontFindOnPaneOpenWithEmptyQuery",!1)||Vb||this.nS)this.aS.onSearchQueryChanged(this.nS)}$ua(){N.UISurfaces.aw().then(Vb=>
{Vb.hideTaskPane(this.mGb,this.Wcf);return null}).catch(Vb=>{Dc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Vb)})}CY(){this.qY.iLa();this.J3=this.qY.zPb(this.oc);this.P1k()}Ssd(){N.UISurfaces.aw().then(Vb=>{this.bQd=window.performance.now();Vb.showTaskPane(this.mGb,this.AB());Vb=[Object.assign(new Wa.a,{name:"Tab",string:this.ASa})];const yb=window.performance.now()-this.bQd;X.a("NavigationPaneOpen",!0,yb,Vb);return null}).catch(Vb=>{Dc.recordQosError("NavPaneOpenActionFailure",
["NavPaneInteractionFailed"],Vb)})}ao(){N.UISurfaces.aw().then(Vb=>{Vb.updateTaskPane(this.mGb,this.AB());return null}).catch(Vb=>{Dc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Vb)})}AB(){var Vb;const yb={activeTab:E.a.initial};this.kC.Dgb(yb);a.AFrameworkApplication.ud("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");const Db=null===(Vb=a.AFrameworkApplication.J)||void 0===Vb?void 0:Vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",
!1);return Object.assign(new V.a,{title:Ua.AU,hideHeader:!1,width:320,location:this.Wcf,contentProps:yb,onOpen:()=>{var $b,Fa;this.Vw=!0;this.WDo();this.XAo();const lb=null===($b=a.AFrameworkApplication.J)||void 0===$b?void 0:$b.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavigationPaneFocusAsyncEnabled",!1);this.BLd&&(lb?a.AFrameworkApplication.zc.pc(new Y.a(5,1,0,()=>{this.ZW()},0,"NavigationPaneFocusTask")):this.ZW());(null===(Fa=a.AFrameworkApplication.J)||void 0===Fa?0:Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneToggleAlignCanvas",
!1))&&this.dEj(!0);Z.a.rx("NavPaneAutoFocusOnScroll-tf;NavPaneAutoFocusOnScroll-cf");this.Rac&&this.PCo();Z.a.rx("NavPaneAutoFocusOnSelectionChange-tf;NavPaneAutoFocusOnSelectionChange-cf");this.MOc&&this.registerSelectionChangeHandler();a.AFrameworkApplication.ud("NavPaneUpdateCommandUIAsync-tf;NavPaneUpdateCommandUIAsync-cf");this.tLk?this.Sb.pc(new Y.a(5,1,0,()=>{x.StaticActiveAppFrame.Aa().Ne();x.StaticActiveAppFrame.Aa().GVa(this.IPg)})):(x.StaticActiveAppFrame.Aa().Ne(),x.StaticActiveAppFrame.Aa().GVa(this.IPg))},
onClose:()=>{var $b;try{const Fa=window.performance.now();this.qja();this.Vw=!1;this.JAp();this.jBp();this.Rac&&this.aBp();this.MOc&&this.lBp();this.aS.X7n();this.ocf="";this.vUc=m.a.initial;x.StaticActiveAppFrame.Aa().cyc(this.IPg);x.StaticActiveAppFrame.Aa().Ne();(null===($b=a.AFrameworkApplication.J)||void 0===$b?0:$b.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneToggleAlignCanvas",!1))&&this.dEj(!1);const lb=window.performance.now()-Fa;X.a("NavigationPaneClose",!0,lb)}catch(Fa){Dc.recordQosError("NavPaneCloseActionFailure",
["NavPaneInteractionFailed"],Fa)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0,isNonClosablePane:Db,showBackButton:Db,onManualClose:()=>{Db&&X.a("NavPaneBackButtonPressed")}})}WDo(){this.iOe&&!this.OUa&&na.a.Km().then(()=>{this.OUa=new Ca(this.OJa);this.ff.Cb(this.OUa,this.OUa.annotationType);this.ff.getAnnotationsByType(this.OUa.annotationType).then(Vb=>{this.OUa.Xkd(Vb)})})}jBp(){this.iOe&&this.OUa&&(this.ff.Gc(this.OUa,this.OUa.annotationType),this.OUa=null)}Wvp(){if(this.jOe){var Vb=
new Lb.ContractEntitySignal;Vb=Object.assign(new mb.a,{parentPath:["Signal",Ab.a.getTypeNameFor(Vb)],items:[Object.assign(new Xb.a,{body:Vb})]});this.A_.getAugLoopRuntimeManager().submitOperation(Object.assign(new Va.a,{operation:Vb}))}}XAo(){this.jOe&&!this.y4a&&na.a.Km().then(()=>{this.y4a=new xa(this.ao);this.ff.Cb(this.y4a,Lb.ContractEntityAnnotation.getTypeName());this.Wvp();this.ff.getAnnotationsByType(Lb.ContractEntityAnnotation.getTypeName()).then(Vb=>{this.y4a.Xkd(Vb)})})}registerSelectionChangeHandler(){this.pb.I8k(this.Zze)}lBp(){this.pb.sJo(this.Zze)}Zze(){this.pLc||
(this.pLc=!0,this.Sb.pc(this.Iqh))}get ki(){return this.ym}PCo(){this.ki.s6k(this.Vqe)}aBp(){this.ki.sIo(this.Vqe)}JAp(){this.jOe&&this.y4a&&(this.ff.Gc(this.y4a,Lb.ContractEntityAnnotation.getTypeName()),this.y4a=null)}P1k(){this.kC.BP(this.azm());this.kC.BP(this.czm());this.kC.BP(this.HBm());this.kC.BP(this.eum());this.kC.BP(this.DDm());this.kC.BP(this.Amm());this.kC.BP(this.onLinkExecute());this.kC.BP(this.onPivotTabExecute());this.kC.BP(this.vRm());this.kC.BP(this.tUm());this.kC.BP(this.hDm());
this.kC.BP(this.kVm());this.kC.BP(this.IOm())}kVm(){return Vb=>{Vb.autoDetectedHeadingsToggleDisabled=this.OJa?!this.OJa.Jhl():!0}}tUm(){return Vb=>{Vb.type=this.$Vk}}onLinkExecute(){return Vb=>{Vb.onLinkExecute=()=>{this.aS.i$n()}}}Vqe(){this.ki.I1b&&!this.MOc||this.pLc||(this.pLc=!0,this.Sb.pc(this.Iqh))}onPivotTabExecute(){return Vb=>{Vb.onPivotTabExecute=yb=>{switch(yb){case E.a.headings:this.g_j();break;case E.a.replace:this.O_j();break;case E.a.contracts:this.Edp();break;case E.a.intelligentPlaceholder:this.t_j();
break;default:this.YZj()}ka.b(this.nS)&&(this.nS=this.jph(),this.nS||(this.nS=""),ka.b(this.nS)||(this.aS.onSearchQueryChanged(this.nS),this.ao()))}}}vRm(){return Vb=>{Vb.showOutOfSyncNotification=this.IKh}}czm(){return Vb=>{Vb.findSearchBoxContent={onSearchQueryChanged:yb=>{this.nS=yb;this.ao();this.aS.onSearchQueryChanged(yb)},findOptions:this.mKc,matchCase:this.Xaa,matchWholeWord:this.Yaa,findSearchText:this.nS,onClearButtonExecute:()=>{void 0!==this.nS&&null!==this.nS&&""!==this.nS&&(this.nS=
"",this.pb.Uc(null),this.aS.Q2n())},onMatchCaseExecute:()=>{this.mKc.matchCase=!this.mKc.matchCase;this.Xaa=!this.Xaa;this.ao();this.aS.Mao()},onMatchWholeWordExecute:()=>{this.mKc.matchWholeWord=!this.mKc.matchWholeWord;this.Yaa=!this.Yaa;this.ao();this.aS.Nao()},onMenuClose:()=>{if(this.J3)this.J3.onMenuClose()},onMenuOpen:()=>{if(this.J3)this.J3.onMenuOpen()}}}}Amm(){return Vb=>{Vb.activeTab=this.O1d}}hDm(){return Vb=>{Vb.autoDetectedHeadingsToggleState=this.OJa?this.OJa.Khl:!1;this.WF.S2c=Vb.autoDetectedHeadingsToggleState;
!Vb.autoDetectedHeadingsToggleState&&this.OJa&&this.OJa.bvd(!1)}}azm(){return Vb=>{const yb={onReplaceAllExecute:()=>{this.aS.Rao()},onReplaceExecute:()=>{this.aS.Qao()},onReplaceQueryChanged:Db=>{this.h9e=Db;this.ao()},replaceSearchText:this.h9e};Vb.findReplaceContent={searchResults:this.yza.toArray(),replaceSearchBoxContent:yb,onNextSearchResultExecute:()=>{this.aS.Oao()},onPrevSearchResultExecute:()=>{this.aS.Pao()},onSearchResultSelected:Db=>{const {FindReplaceUIManager:$b}=e(1628);this.aS.Q4n(Db);
$b.Afj(1)},selectedResultId:this.X$e,summaryLabel:this.ocf,explanationText:this.nym(this.vUc),haveTooManySearchResults:this.vUc===m.a.Vja}}}nym(Vb){switch(Vb){case m.a.initial:return WacWordeditorStrings.LandingMessage;case m.a.$_a:return WacWordeditorStrings.NoMatchesMessage;case m.a.jyc:return ab.a.NKi();case m.a.Vja:return WacWordeditorStrings.TooManyResultsMessage;default:return""}}IOm(){return Vb=>{Vb.replaceFollowUpsWithCommentsIsEnabled=!0}}DDm(){return Vb=>{var yb=this.LM.tnm();const Db=[];
for(const $b of yb)yb=this.LM.f8d($b.ed,$b.id),Db.push({id:$b.id.toString(),intelligentPlaceholderAnchorText:yb});Vb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Db,onIntelligentPlaceholderInputExecute:$b=>{this.nS=$b;this.ASa=E.a.find;this.ao();this.aS.onSearchQueryChanged($b)},onSearchResultSelected:$b=>{this.ao();$b=f.a.Of($b);this.LM.rVo($b)}}}}HBm(){return Vb=>{var yb;let Db=()=>{};this.OJa&&(Db=Object(wa.a)(this.OJa,this.OJa.bvd,"toggleAutoDetectedHeadings"));const $b=null===
(yb=a.AFrameworkApplication.J)||void 0===yb?void 0:yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1);Vb.headingsContent={onHeaderInputExecute:Fa=>{this.nS=Fa;this.ASa=E.a.find;this.ao();X.a("NavigationPaneFind");this.aS.onSearchQueryChanged(Fa)},renderHeadingContent:(Fa,lb,kb)=>{this.Sb.pc(new Y.a(0,1,this.XAh?0:100,()=>{var Ob=window.performance.now()-this.bQd;if($b)this.headingsReady=!0,this.ao();else{var nc=this.WF.R5;this.headingsReady=!0;this.ao();kb.style.display=
"none";nc.first&&(Fa.style.display="block")}this.Rac&&this.Sb.pc(new Y.a(0,1,0,this.Pde));this.Sb.pc(new Y.a(1,1,0,()=>{cd.$Pl(this)}));nc=window.performance.now()-this.bQd;X.a("NavigationPaneHeadingsLoaded",!0,nc);Ob=[Object.assign(new Wa.a,{name:"HeadingFetchStart",double:Ob}),Object.assign(new Wa.a,{name:"HeadingFetchFinished",double:nc})];X.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Ob)}))},autoDetectedHeadingsToggle:Db,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.XAh||
this.headingsReady,headingsList:this.WF.R5,onHeadingChevronClick:Fa=>{this.WF.z$l(Fa);this.ao()},onClickHeading:Fa=>{this.ki.I1b=this.Rac;if(this.Sb.UB){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",Fa);const lb=window.performance.now();this.Sb.pc(new Y.a(0,1,0,()=>{this.WF.onClickHeading(Fa);this.ao();const kb=window.performance.now()-lb;X.a("NavigationPaneAsyncOnClickHeadingItem",!0,kb)}))}else this.WF.onClickHeading(Fa),
this.ao()},onClickBookmark:Fa=>{this.ki.I1b=this.Rac;if(this.Sb.UB){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",Fa);const lb=window.performance.now();this.Sb.pc(new Y.a(0,1,0,()=>{this.WF.onClickBookmark(Fa);this.ao();const kb=window.performance.now()-lb;X.a("NavigationPaneAsyncOnClickHeadingItem",!0,kb)}))}else this.WF.onClickBookmark(Fa),this.ao()},onShareHeadingClick:Fa=>{this.WF.onShareHeadingClick(Fa)},bookmarkIconUrl:db.a.kh("BookmarkDefault.png")}}}dum(){var Vb,
yb=null===(Vb=this.y4a)||void 0===Vb?void 0:Vb.getAnnotations();if(yb){Vb=Array(yb.length);let Db=0;for(const $b of yb)(yb=$b.content)&&(Vb[Db++]={id:$b.id,type:yb.type,value:yb.value});return Vb}return null}eum(){return Vb=>{Vb.contractsContent={onHeaderInputExecute:yb=>{this.nS=yb;this.ASa=E.a.find;this.ao();X.a("NavigationPaneFind");this.aS.onSearchQueryChanged(yb)},contractEntities:this.dum(),selectedEntityId:this.Shh.aJh,onEntitySelected:yb=>{var Db;const $b=null===(Db=this.y4a)||void 0===Db?
void 0:Db.getAnnotations();if($b)for(const Fa of $b)if(Fa.id===yb){this.Shh.hVo(Fa);break}this.ao()}}}}MUj(Vb){this.BLd=Vb}vGp(Vb){this.Sb.pc(new Y.a(0,1,0,()=>{this.WF.SPg(Vb)&&this.ao()}))}gRi(Vb){this.Sb.pc(new Y.a(0,1,0,()=>{const yb=this.WF.K_b;this.WF.qji(Vb)?this.ao():0===this.WF.K_b&&0<yb&&this.ao()}))}aPg(Vb,yb){this.Sb.pc(new Y.a(0,1,0,()=>{const Db=this.WF.K_b;this.WF.aPg(Vb,yb)?this.ao():0<this.WF.K_b&&0===Db&&this.ao()}))}kWl(Vb){this.Sb.pc(new Y.a(0,1,0,()=>{const yb=this.WF.K_b;this.WF.lWl(Vb)?
this.ao():0===this.WF.K_b&&0<yb&&this.ao()}))}J6o(Vb){this.WF.stp(Vb);this.ao()}zPg(Vb){this.WF.zPg(Vb)&&this.ao()}F2d(Vb){this.WF.F2d(Vb)&&this.ao()}wro(){return 0<this.WF.K_b}ZW(){this.oc.Rg(this.mGb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}qja(){if(this.ddb()){var Vb;(Vb=Object(pa.a)().Pd)?(Vb=Vb.lN,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Vb=this.oc.NY,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));
this.oc.Rg(Vb)}}ddb(){return!!this.oc.currentScope&&this.oc.currentScope.name===this.mGb}static getInstance(){return Dc.In()}static In(){var Vb,yb;return new Dc(new Na(a.AFrameworkApplication.va),Object(wa.a)(Cb.getInstance(),Cb.getInstance().getSelectedText,"getSelectedText"),ua.a.instance,D.a.instance,ja.a.instance,Object(wa.a)(Xa.instance,Xa.instance.mIm,"getNextSearchResult"),w.a.instance.Wa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),w.a.instance.Wa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
w.a.instance.Wa("Box4.AugmentationLoop.IAnnotationStorage"),w.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),ca.TaskManager.instance,w.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new qb,null===(yb=null===(Vb=x.StaticActiveAppFrame.Aa())||void 0===Vb?void 0:Vb.tb)||void 0===yb?void 0:yb.Xc)}static recordQosError(Vb,yb,Db){const $b=Object.assign(new Ja.a,{extendedProperties:new Map});Db&&$b.extendedProperties.set("exception",Db);W.Health.instance.recordQosError(Vb,
yb,!1,!0,!1,!1,$b)}}Object(I.a)(Dc,"ReactFindReplacePane",J,[490,491,11]);var mc=e(1528);e.d(K,"FindReplaceUIManager",function(){return lc});class lc{constructor(Vb,yb,Db=null,$b=null,Fa=null,lb=null){this.uCd=this.x7=0;this.Yaa=this.Xaa=this.ALb=!1;this.Sn=this.CBh=this.Iqa=null;this.RNa=this.q0e=!1;this.pk=Vb;this.Tq=Db;this.fnb=$b;this.tyh=Fa;this.qe=lb;lc.Fgc=new G}get $3f(){return this.q0e}set $3f(Vb){Vb!==this.q0e&&(this.q0e=Vb,this.b6h())}WBe(Vb){this.x7=Vb;this.update();this.x7||this.UJ!==
m.a.sAb&&this.UJ!==m.a.Vja?0<this.x7&&this.UJ===m.a.$_a?this.Sba(m.a.sAb):this.x7>lc.i7j&&this.UJ!==m.a.Vja&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.Sba(m.a.Vja)):this.Sba(m.a.$_a)}uAe(Vb){this.uCd=Vb;this.RNa&&this.update();this.tyh&&!this.tyh.value.Aod&&this.oCg()}reset(){}MGf(){this.qe&&(this.Sn=this.qe.rg("UserAction","Find"));if(this.RNa||!this.UJ)this.RNa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.Sba(m.a.cQj)}Nkc(){var Vb;this.RNa=!0;let yb=this.x7?
m.a.sAb:m.a.$_a;if(this.UJ!==m.a.Vja&&z.a.instance){const Db=z.a.instance.il;0<Db.lqa&&(Db.lqa>lc.i7j?yb=m.a.Vja:this.tHp(Db))}this.Sba(yb);this.update();this.Sn&&(this.Sn.stop(),this.Sn=null);lc.$Pj=f.a.create().toString();lc.Afj(0,this.Jic,this.hYa().length,this.x7);Object(mc.b)()&&(null===(Vb=this.pk)||void 0===Vb?0:Vb.isVisible)&&(Vb={},a.AFrameworkApplication.va.Zb(y.a.cwe,2,Vb),Vb[l.a.On]&&a.AFrameworkApplication.va.Zb(y.a.fge,2,{CommandValueId:{query:this.hYa(),matchCase:this.Xaa,matchWholeWordOnly:this.Yaa,
totalResultLimit:-1}}))}tHp(Vb){const yb=Vb.kMa;let Db=yb;const $b=[];do $b[$b.length]=Db,Db=Vb.abb(Db);while(yb!==Db);this.pk.Bif($b);this.Iqa&&this.pk.Qze(this.Iqa)}update(){this.pk&&this.pk.jIp()}get UJ(){return this.pk.UJ}get Jic(){return this.pk.O1d}XAb(Vb){this.$3f=Vb}b6h(){if(this.$3f)switch(this.UJ){case m.a.sAb:case m.a.$_a:case m.a.Vja:this.pk.Lsd(!0)}else this.pk.Lsd(!1)}Sba(Vb){if(this.pk.isVisible){switch(Vb){case m.a.$_a:case m.a.sAb:this.UJ===m.a.Vja&&(Vb=m.a.Vja)}this.pk&&(this.pk.Sba(Vb),
this.b6h());this.update();this.oCg()}}DXa(Vb,yb){const Db=this.RNa&&this.UJ!==m.a.Vja;switch(Vb){case 0:Db&&this.pk.Bif(yb);break;case 1:Db&&this.pk.$Ij(yb);break;case 4:Db&&this.pk.Qdk(yb);break;case 2:this.pk.x7h();break;case 3:this.Iqa=yb[0],Db&&0<this.x7&&this.pk.Qze(this.Iqa)}}get matchCase(){return this.Xaa}set matchCase(Vb){this.Xaa!==Vb&&(this.Xaa=Vb,this.Ubk())}get matchWholeWord(){return this.Yaa}set matchWholeWord(Vb){this.Yaa!==Vb&&(this.Yaa=Vb,this.Ubk())}Ubk(){this.pk.wIe()}hYa(){return this.pk.hYa()}rTb(){return this.pk.rTb()}QCg(Vb){this.pk.QCg(Vb)}JKa(){this.pk.JKa()}get P_j(){return 0<
this.x7&&this.UJ!==m.a.kyc&&this.UJ!==m.a.jyc}jZo(Vb){let yb="";Vb?yb=0<this.x7?String.format(WacWordeditorStrings.ReadoutReplacedAndMoveToNextResult,this.hYa(),this.rTb()):String.format(WacWordeditorStrings.ReadoutReplaceWithNoMoreResults,this.hYa(),this.rTb()):Vb||0<this.x7&&(yb=WacWordeditorStrings.ReadoutReplaceSkippedAndMoveToNextResult);this.oCg(yb)}dispose(){this.pk.dispose()}p7c(){return this.pk.p7c()}j3o(Vb,yb=!0){Vb!==this.Jic&&(Vb===E.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.pk.g_j()):
Vb===E.a.find?this.pk.YZj():Vb===E.a.replace?this.pk.O_j():Vb===E.a.intelligentPlaceholder&&(yb||this.pk.MUj(yb),this.pk.t_j()))}dC(Vb,yb=!0){this.pk.MUj(yb);Vb?(this.ALb||this.HYf(),this.pk.sU(),this.x7||this.UJ===m.a.$_a?a.AFrameworkApplication.J&&a.AFrameworkApplication.J.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.pk.Sba(m.a.sAb):this.Sba(m.a.initial)):this.pk.$ua()}HYf(){this.ALb||(this.pk.initialize(),this.ALb=!0)}oCg(Vb=""){var yb=this.YOm();yb&&(Vb=String.format(WacWordeditorStrings.FindReplaceResultSummaryScreenReaderNotification,
Vb,yb));this.fnb&&yb&&this.Iqa&&this.UJ!==m.a.Vja&&this.UJ!==m.a.kyc&&(yb=this.fnb.s1d(this.Iqa),Vb=String.format(WacWordeditorStrings.FindReplaceResultSummaryScreenReaderNotification,Vb,yb.f0d));(yb=this.mym())&&(Vb=String.format(WacWordeditorStrings.FindReplaceResultSummaryScreenReaderNotification,Vb,yb));this.Tq&&Vb&&this.CBh!==Vb&&(this.CBh=Vb,this.Tq.sendNotification(Vb,!0))}YOm(){let Vb="";switch(this.UJ){case m.a.C2j:Vb=WacWordeditorStrings.SummarySearching;break;case m.a.sAb:Vb=String.format(WacWordeditorStrings.ReadoutCurrentResult,
this.uCd,this.x7);break;case m.a.Vja:this.RNa&&(Vb=String.format(WacWordeditorStrings.ReadoutCurrentResult,this.uCd,this.x7));break;case m.a.$_a:Vb=WacWordeditorStrings.SummaryNoMatches;break;case m.a.kyc:Vb=WacWordeditorStrings.ReplaceAllInProgressReadout;break;case m.a.jyc:Vb=WacWordeditorStrings.ReplaceAllComplete}return Vb}mym(){let Vb="";switch(this.UJ){case m.a.initial:Vb=String.format(WacWordeditorStrings.FindReplaceResultSummaryScreenReaderNotification,WacWordeditorStrings.LandingMessage,
this.Vym());break;case m.a.$_a:Vb=WacWordeditorStrings.NoMatchesMessage;break;case m.a.jyc:Vb=ab.a.NKi();break;case m.a.Vja:Vb=WacWordeditorStrings.TooManyResultsMessage}return Vb}Vym(){let Vb="";this.Xaa&&this.Yaa?Vb=String.format(WacWordeditorStrings.SelectedSearchOptions,WacWordeditorStrings.MatchCase,WacWordeditorStrings.MatchWholeWord):this.Xaa?Vb=String.format(WacWordeditorStrings.SelectedSearchOption,WacWordeditorStrings.MatchCase):this.Yaa&&(Vb=String.format(WacWordeditorStrings.SelectedSearchOption,
WacWordeditorStrings.MatchWholeWord));return Vb}static getInstance(Vb){return lc.In(Vb)}static In(Vb){w.a.instance.ja("WordEditor.FindReplace.FindReplacePane",()=>Dc.getInstance()).as("WordEditor.FindReplace.FindReplacePane").ha();return new lc(w.a.instance.resolve("WordEditor.FindReplace.FindReplacePane"),Vb,w.a.instance.resolve("Common.Utils.IAriaNotifier"),D.a.instance,new v.a(()=>z.a.instance.U0b),x.StaticActiveAppFrame.Aa().Kt)}static Afj(Vb,yb=-1,Db=-1,$b=-1){u.ULS.sendTraceTag(4065352,312,
50,"{0}",{["SearchOp"]:Vb,["SearchComplete.ResultsCount"]:$b,["SearchOpsCorrelation"]:lc.$Pj,["ActionId"]:lc.Fgc.actionId,["SourceControlId"]:lc.Fgc.AQa,["IsNavPanOpenedAlready"]:lc.Fgc.Gun,["IsSearchFromNavPane"]:lc.Fgc.yyn,["CurrentTab"]:yb,["QueryLength"]:Db})}static Dpl(Vb,yb,Db){yb=void 0!==yb&&null!==yb?void 0===yb.SourceControlId||null===yb.SourceControlId?"Unknown":yb.SourceControlId:Vb===H.a.rBb?"FindKeyboardShorcut":Vb===H.a.sBb?"ReplaceKeyboardShorcut":"Unknown";switch(Vb){case H.a.NAc:Vb=
"ShowHeadingsPane";break;case H.a.rBb:Vb="ShowFindPane";break;case H.a.sBb:Vb="ShowReplacePane";break;case H.a.RAc:Vb="ShowIntelligentPlaceholderPane";break;case H.a.c3a:Vb="ToggleNavigationPane";break;default:Vb="Unknown"}lc.Fgc=new G(Vb,yb,Db,!0)}}lc.i7j=100;lc.$Pj=null;lc.Fgc=null;Object(I.a)(lc,"FindReplaceUIManager",null,[451,218,11])},1630:function(I,K,e){e.r(K);I=e(0);var m=e(243),f=e(148),a=e(101),l=e(2),w=e(21),z=e(89),x=e(1093),u=e(68),v=e(18),E=e(8),y=e(19),H=e(491),D=e(1474),G=e(1848),
J=e(204),U=e(377),F=e(10),T=e(469),Y=e(39),P=e(273),S=e(751),N=e(54),V=e(165),Z=e(553),ca=e(1700);class W{constructor(ab,Xa,wb,Sa,cc,Cb,Wa){this.kBh=this.vFh=this.moh=this.JM=this.Gib=this.n6b=this.VVe=this.URe=this.zTe=this.Z_=this.ala=this.lla=null;this.jIe=()=>{const Ja=this.pAa.pmc(this.JM),Va=this.pAa.nAm(this.JM);this.URe.innerText=Ja.toString();this.VVe.innerText=Va.toString();G.a.W1b(this.lla,1===Ja?!1:!0);G.a.W1b(this.ala,Ja===Va?!1:!0)};this.D0o=()=>{const Ja=this.oc.getRegion(V.a.fab);
let Va;if(this.Z_&&!this.Z_.disabled)Va=this.Z_;else if(this.lla.disabled){if(this.ala.disabled)return;Va=this.ala}else Va=this.lla;Va.focus();Ja.Al.eC(Va)};this.Wwa=(Ja,Va)=>{(Ja=Va.Pn.currentSelection)&&this.Z_&&G.a.W1b(this.Z_,Y.a.qn(Ja)?!0:!1)};this.isf=()=>{if(!this.ala.disabled){const Ja=this.pAa.Pvb(this.JM)?y.a.foe:y.a.eoe;this.ga.Vb(Ja,2)}return!0};this.jsf=()=>{if(!this.lla.disabled){const Ja=this.pAa.Pvb(this.JM)?y.a.hoe:y.a.goe;this.ga.Vb(Ja,2)}return!0};this.hsf=()=>{this.Z_&&!this.Z_.disabled&&
this.ga.Vb(y.a.Baj,2);return!0};this.oc=ab;this.ga=Sa;this.xh=cc;this.Ce=Cb;this.pb=Wa;this.pAa=wb;this.eca=document.createElement("div");this.eca.classList.add("FootnoteEndnoteActionBarControl");this.eca.style.zIndex=String(P.a.g4d);this.eca.style.position="relative";this.qJc=document.createElement("div");this.qJc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.eca.appendChild(this.qJc);this.sJl();this.eca.appendChild(this.n6b);this.eca.appendChild(this.Gib);this.y3=f.KeyInputManager.xc(a.a.H6,
0);this.Sdn();this.Rdn()}cna(ab){E.ULS.shipAssertTag(4520065,308,this.pAa.xva(ab));if(this.JM!==ab){this.JM=ab;this.jIe();ab=this.pAa.Pvb(this.JM);this.hMl(ab);this.JM.XUh(this.jIe);let Xa="",wb="";const Sa=this.pAa.pmc(this.JM);-1!==Sa&&(Xa=(Sa-1).toString(),wb=(Sa+1).toString());ab?(this.ala.title=this.ala.disabled?WacWordeditorStrings.NextFootnote:String.format(WacWordeditorStrings.NextFootnoteWithNumber,wb),this.lla.title=this.lla.disabled?WacWordeditorStrings.PrevFootnote:String.format(WacWordeditorStrings.PrevFootnoteWithNumber,
Xa)):(this.ala.title=this.ala.disabled?WacWordeditorStrings.NextEndnote:String.format(WacWordeditorStrings.NextEndnoteWithNumber,wb),this.lla.title=this.lla.disabled?WacWordeditorStrings.PrevEndnote:String.format(WacWordeditorStrings.PrevEndnoteWithNumber,Xa));this.Fzb()}}gQb(){this.JM&&(this.Z_&&this.Z_.parentNode===this.n6b&&this.n6b.removeChild(this.Z_),this.mRa(),this.JM.TIo(this.jIe),this.JM=null)}dispose(){this.oc.te(V.a.fab).Pu(this.y3)}hMl(ab){3===this.ga.mode&&(ab=ab?WacWordeditorStrings.FormatFootnotes:
WacWordeditorStrings.FormatEndnotes,this.Z_=this.Cvf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",ab,null),J.a.ju(this.Z_,J.a.bma,ab),this.n6b.appendChild(this.Z_))}sJl(){this.n6b=document.createElement("div");this.n6b.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.Gib=document.createElement("div");this.Gib.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.lla=this.Cvf("FootnoteEndnotePreviousButton",
"FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.Gib.appendChild(this.lla);this.URe=T.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.Gib.appendChild(this.URe);this.zTe=T.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.zTe.innerText=" / ";this.Gib.appendChild(this.zTe);this.VVe=T.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.Gib.appendChild(this.VVe);this.ala=this.Cvf("FootnoteEndnoteNextButton",
"FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.Gib.appendChild(this.ala)}Cvf(ab,Xa,wb,Sa){ab=G.a.M9a(ab,Xa,wb,Sa,void 0===Sa||null===Sa);ab.setAttribute(J.a.fi,J.a.i4);return ab}Sdn(){const ab=this.oc.te(V.a.fab);ab.parent=S.a.rr;ab.bindAction(this.y3,y.a.C8);ab.Rla(this.D0o)}Rdn(){var ab=new U.DOMFocusListing(()=>this.eca);ab.$ia=!1;ab.jo(2);ab.jo(1);ab=this.oc.rpb(this.eca,this.oc.te(V.a.fab),ab);ab.s1a();ab.nR=!0}Fzb(){this.Z_&&(this.xh.Cb(F.a.click,this.Z_,this.hsf),
this.moh=this.Ce.Ezb(this.Z_,this.hsf,a.a.vw));this.xh.Cb(F.a.click,this.lla,this.jsf);this.vFh=this.Ce.Ezb(this.lla,this.jsf,a.a.vw);this.xh.Cb(F.a.click,this.ala,this.isf);this.kBh=this.Ce.Ezb(this.ala,this.isf,a.a.vw);this.pb.BD(this.Wwa)}mRa(){this.Z_&&(this.xh.Gc(F.a.click,this.Z_,this.hsf),this.Ce.NCb(this.Z_,this.moh));this.xh.Gc(F.a.click,this.lla,this.jsf);this.Ce.NCb(this.lla,this.vFh);this.xh.Gc(F.a.click,this.ala,this.isf);this.Ce.NCb(this.ala,this.kBh);this.pb.vpa(this.Wwa)}static iAm(){return W.jAm()}static jAm(){return new W(z.FocusManager.instance(),
ca.a.instance,Z.a.instance,l.AFrameworkApplication.va,v.StaticActiveAppFrame.Aa().KG,v.StaticActiveAppFrame.Aa().LG,N.a.instance)}}Object(I.a)(W,"FootnoteEndnoteActionBarControl",null,[600]);var X=e(307),ka=e(12),ma=e(1551),ja=e(1798);class na{constructor(ab,Xa,wb,Sa,cc,Cb,Wa,Ja,Va,mb,Ab,Xb){this.kI=null;this.WX=!1;this.az=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.pbc=ab;this.Mjc=Xa;this.LFc=wb;this.pNk=Sa;this.j5e=cc;this.zn=Cb;this.Pkb=Wa;this.xh=Ja;this.cEh=Va;this.Dzk=Ab;this.mu=
this.pbc.ownerDocument.createElement("div");this.mu.id="FootnoteEndnoteControlOverlay";this.mu.className="EditingSurfaceOverlay";this.AM=this.fum();this.d6(!1);this.pbc.appendChild(this.mu);this.pbc.appendChild(this.AM);this.Mjc.bind();this.Xi=null;this.ga=Xb;this.dTa=mb}SNo(){const ab=this.cEh();ab&&ab.Aj&&(ab.pAb=0,ab.mVd())}Vak(ab){if(this.DWc){const Xa=this.DWc.tua;Xa&&(Xa.C1f=ab)}}get RL(){return this.WX}get DWc(){return this.kI}get dialog(){return this.Xi}get Zo(){return null!=this.C0g?this.C0g:
this.C0g=w.a.instance.Za("Common.IZoomManager")}ewf(){this.Xi=ja.a.rAm()}Yod(){this.Xi=null}show(ab=!0){this.WX||(this.Vak(!0),this.Dzk(),this.d6(!0),this.bD(),ab&&this.setFocus())}setFocus(){this.WX&&(this.Mjc.MAb(),this.pNk())}update(){this.WX&&(this.kI.isConnected?this.LFc.jIe():this.dismiss())}dismiss(ab=!1,Xa=!1){this.WX&&(this.Vak(!1),this.Mea(),this.SNo(),this.d6(!1),this.j5e(Xa),this.Xi&&(this.ga.Vb(ka.a.P0c,2),this.Xi=null),!ab&&this.kI&&this.kI.isConnected&&this.dTa.qVo(this.kI),this.gQb())}HMo(ab){const Xa=
null!==this.Zo.instance?this.Zo.instance.Ql:1;this.AM.style.width=ab.zai*Xa+"px";this.az.style.width=ab.DZc*Xa+"px";this.AM.style.marginLeft=ab.Jhc*Xa+"px";this.zn?this.az.style.marginRight=ab.Luf*Xa+"px":this.az.style.marginLeft=ab.Shc*Xa+"px";if(ab=this.cEh())ab=ab.zK,this.AM.style.bottom=ab.offsetHeight-ab.clientHeight+"px"}cna(ab){E.ULS.shipAssertTag(4520073,308,this.Pkb.xva(ab));this.kI!==ab&&(this.kI=ab,this.Mjc.cna(ab),this.LFc.cna(this.kI))}dispose(){this.dismiss();this.Mjc.dispose();this.LFc.dispose()}bD(){this.xh&&
this.xh.Cb(F.a.click,this.mu,this.onClick)}Mea(){this.xh&&this.xh.Gc(F.a.click,this.mu,this.onClick)}fum(){let ab;ab=document.createElement("div");ab.classList.add("FootnoteEndnoteControl");this.az=document.createElement("div");this.az.classList.add("FootnoteEndnoteContent");this.az.appendChild(this.Mjc.eca);this.az.appendChild(this.LFc.eca);ab.appendChild(this.az);return ab}d6(ab){ab=(this.WX=ab)?"":"none";this.mu.style.display=ab;this.AM.style.display=ab}gQb(){this.kI&&(this.Mjc.gQb(),this.LFc.gQb(),
this.kI=null)}static mae(){const ab=v.StaticActiveAppFrame.Aa().tb.Xc;return ab&&ab.Aj?ab:null}static mAm(ab,Xa,wb,Sa,cc){return new na(ab,Xa,wb,Sa,cc,l.AFrameworkApplication.isRtl,Z.a.instance,X.a.instance,na.mae,ma.a.instance,na.A0l,l.AFrameworkApplication.va)}static A0l(){l.AFrameworkApplication.va.Zb(ka.a.yub,2,!0)}}Object(I.a)(na,"FootnoteEndnoteControl",null,[599]);var Ba=e(834),Ma=e(6),Ea=e(187),ya=e(30),ia=e(7),za=e(23),Ca=e(80),db=e(1699),pa=e(333),ua=e(832),Ga=e(602),wa=e(1340),xa=e(63),
sa=e(257);class Ka extends pa.a{constructor(ab,Xa,wb,Sa,cc,Cb,Wa,Ja,Va,mb,Ab,Xb,Lb,dc,yc,Wc,zb){super(V.a.jna,wb,Sa,cc,Wa,Ja,Va,mb,Ab,Xb,Lb,dc,yc,Wc,zb);this.Vhh=ab;this.a7a=Cb;this.a7a.yud=this;Xa(this);this.features.YJg=!0}get I2i(){return!0}WSf(){const ab=this.Vhh.hJf(this);return ua.a.OI(this,ab)}RAf(ab){Object(sa.a)(Ka,ab)||this.Vhh.OAf()}t7c(){return Ga.a.Vjj}zx(){super.zx();this.a7a.aqi()}qC(ab,Xa=null){super.qC(ab,Xa);this.a7a.Mpi(this.Fd.ml)}detach(){this.a7a.$pi();super.detach()}H7d(){this.zx()}static K9a(){const {FootnoteEndnoteControlManager:ab}=
e(1630);return new Ka(ab.instance,wa.a.Xtf,v.StaticActiveAppFrame.Aa().tb,Object(xa.a)(),()=>w.a.instance.resolve("Box4.IUndoManager"),w.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),l.AFrameworkApplication.va,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),w.a.instance.resolve("Box4.IInteractiveEventNotifier"),w.a.instance.Za("Box4.ITextMetricsAdapter"),w.a.instance.resolve("Box4.IRotatingCoordinateConverter"),w.a.instance.Za("Common.IZoomManager"),w.a.instance.Wa("Box4.IContentControlViewElementManager"),
w.a.instance.Wa("Box4.CpConversionManagerImpl"),w.a.instance.Wa("Box4.ContentControlConfigSettings"),w.a.instance.Wa("Box4.IContentControlReader"),w.a.instance.Wa("Box4.IContentControlBoundaryNavigator"))}}Object(I.a)(Ka,"FootnoteEndnoteEditView",pa.a,[]);class Na{constructor(ab,Xa,wb,Sa=!1){this.vGb=null;this.g_e=this.Leh=!1;this.Fim=()=>{const cc=String.format("{0} {1}",this.g_e?WacWordeditorStrings.FootnoteEditingSurfaceAccessibilityTitleText:WacWordeditorStrings.EndnoteEditingSurfaceAccessibilityTitleText,
WacWordeditorStrings.EditingSurfaceAccessibilityDescribedByText);this.ry.sendNotification(cc,!0)};this.oc=ab;this.pAa=Xa;this.Ika=wb();this.qHd=Sa;this.eca=document.createElement("div");this.eca.classList.add("FootnoteEndnoteEditControl");this.qJc=document.createElement("div");this.qJc.classList.add("FootnoteEndnoteEditControlDividerElement");this.cMb=(new Ba.a(this.eca,"WACViewPanel_FootnoteEndnoteEditControl")).uM;this.eca.appendChild(this.qJc);this.eca.appendChild(this.cMb)}get ry(){return null!=
this.QWg?this.QWg:this.QWg=w.a.instance.resolve("Common.Utils.IAriaNotifier")}cna(ab){E.ULS.shipAssertTag(4520077,308,this.pAa.xva(ab));this.vGb!==ab&&(this.vGb=ab,this.Pmf(this.vGb),this.g_e=this.pAa.Pvb(this.vGb),this.qHd?(this.Ika.b2b(J.a.kWd),this.oc.te(V.a.jna).Eba(this.Fim)):this.Ika.vTj(this.g_e?WacWordeditorStrings.FootnoteEditingSurfaceAccessibilityTitleText:WacWordeditorStrings.EndnoteEditingSurfaceAccessibilityTitleText,J.a.kWd))}gQb(){const ab=Z.a.instance.Pvb(this.vGb)?"Footnote":"Endnote";
E.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:ab,["CalloutHeight"]:this.eca.scrollHeight});this.irb();this.vGb=null}bind(){this.Leh||(this.Ika.egc(this.cMb),this.Leh=!0)}MAb(){const ab=this.EQm();ab?this.Ika.Uc(ab):this.Ika.Jrd()}dispose(){this.irb()}Pmf(ab){this.irb();this.Ika.qC(ab,ab.ml)}irb(){this.Ika.detach()}EQm(){let ab=0;var Xa=null,wb=Ma.a.kb(this.vGb);Ea.OutlineNavigator.zda(wb);if((wb=ya.a.Ze(wb))&&ia.ParagraphReader.lc(wb)){if(Xa=Na.lEm(wb)){ab=Xa.Rb.cp+1;Xa=db.FootnoteEndnoteDefaultContentInserter.Gii;
const Sa=Xa.length;ab+Sa<=ia.ParagraphReader.textLength(wb)&&wb.characterData.substr(ab,Sa)===Xa&&(ab+=Sa)}Xa=za.SelectionFactory.Ie(wb,ab)}return Xa}static oAm(){return Na.pAm()}static pAm(){return new Na(z.FocusManager.instance(),Z.a.instance,()=>Ka.K9a(),l.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static lEm(ab){ab=Ca.i(ab,10);return 0<ab.length?ab[ab.length-1]:null}}Object(I.a)(Na,"FootnoteEndnoteEditControl",null,[597]);var ub=e(1152);class Ua{constructor(ab,
Xa){this.gJa=ab;this.zn=Xa}rnc(ab,Xa){ab=this.gJa.rnc(ab);var wb=Xa.clientWidth;const Sa=Xa.scrollLeft,cc=ab.zai;let Cb=ab.Jhc,Wa=ab.Jhc,Ja=Ua.Nbg,Va=Ua.Obg,mb=cc,Ab=ab.DZc;this.zn?Va=ab.Luf-Wa:Ja=ab.Shc-Cb;wb<cc&&(Cb=Math.max(Cb-Sa,0),mb=wb-Cb,this.zn?(wb=Xa.scrollWidth-Sa-wb,Wa=Xa.scrollWidth-ab.Jhc-cc,Va=Math.max(ab.Luf-wb-Wa,Ua.Obg),Ab=mb-Va-Ua.Nbg):(Ja=Math.max(ab.Shc-Sa-Cb,Ua.Nbg),Ab=mb-Ja-Ua.Obg));return new ub.a(Cb,mb,Ja,Va,Ab)}}Ua.Nbg=25;Ua.Obg=50;Object(I.a)(Ua,"FootnoteEndnoteViewPositionProvider",
null,[]);class sb{constructor(ab,Xa=0,wb=0){this.clientWidth=ab;this.scrollLeft=Xa;this.scrollWidth=wb?wb:ab}}Object(I.a)(sb,"PageViewScrollContainerSizeInfo",null,[]);e.d(K,"FootnoteEndnoteControlManager",function(){return qb});class qb{constructor(ab,Xa,wb,Sa,cc,Cb,Wa,Ja){this.dI=null;this.ZW=()=>{this.hr.RM(V.a.jna);this.hr.RM(V.a.fab);this.hr.wz(m.AFrame.Co);this.oc.RUc(V.a.jna);this.oc.Rg(V.a.jna)};this.L0o=Va=>{this.hr.wz(V.a.jna);this.hr.wz(V.a.fab);this.hr.RM(m.AFrame.Co);this.oc.j0c(V.a.jna);
(Va||this.oc.currentScope&&(this.oc.currentScope.name===V.a.jna||this.oc.currentScope.name===V.a.fab))&&this.oc.Rg(m.AFrame.Co)};this.oc=ab;this.hr=Xa;this.WCk=wb;this.XCk=Sa;this.VCk=cc;this.gJa=Cb;this.Cza=Wa;this.L3=Ja;this.y3=f.KeyInputManager.xc(a.a.H6,0);this.zYf();this.vY()}get control(){return this.dI}get dialog(){return this.control.dialog}get L0i(){return this.control.RL}ewf(){this.control.ewf()}Yod(){this.control.Yod()}bind(ab){this.gFl(ab)}DGg(ab){if(this.control.DWc!==ab.G9a)this.control.dismiss();
else if(this.L0i)return;this.ljc();this.control.cna(ab.G9a);this.control.show(ab.pCe)}ljc(){if(this.L3){const ab=new x.a(!0);this.L3.GPa(ab)}}N2(){this.control.setFocus()}nwd(){this.control.update()}OAf(ab,Xa=!1){this.ljc();this.control.dismiss(ab,Xa)}FMo(ab){const Xa=qb.mae().zK;ab=this.gJa.rnc(ab,new sb(Xa.clientWidth,Xa.scrollLeft,Xa.scrollWidth));this.control.HMo(ab)}dispose(){this.control.dispose();this.oc.te(V.a.jna).Pu(this.y3)}hJf(ab){E.ULS.shipAssertTag(4520074,308,!!this.control);E.ULS.shipAssertTag(4520075,
308,!!this.control.DWc);return this.iJf(this.control.DWc.id,ab)}gFl(ab){const Xa=this.XCk(),wb=this.VCk();this.dI=this.WCk(ab,Xa,wb,this.ZW,this.L0o)}zYf(){const ab=this.oc.te(V.a.jna);ab.parent=3===l.AFrameworkApplication.va.mode?u.a.LI:u.a.Ixc;this.oc.Phf(V.a.jna);ab.bindAction(this.y3,y.a.C8)}vY(){this.hr.vY(V.a.jna);this.hr.vY(V.a.fab)}iJf(ab,Xa){return()=>{const wb=qb.mae().Fd.ed.Mb(ab);this.Cza.lkc();if(!wb.isConnected)return E.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),
null;this.DGg(new H.a(wb,!0));return Xa}}static In(){const ab=new Ua(w.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),l.AFrameworkApplication.isRtl);return new qb(z.FocusManager.instance(),v.StaticActiveAppFrame.Aa().BA,na.mAm,Na.oAm,W.iAm,ab,D.a.instance,w.a.instance.resolve("Box4.IPasteFloatieEventSource"),w.a.instance.resolve("Common.IAppSettingsManager"))}static mae(){const ab=v.StaticActiveAppFrame.Aa().tb.Xc;return ab&&ab.Aj?ab:null}static get instance(){return null!=qb.R2g?qb.R2g:
qb.R2g=qb.In()}}Object(I.a)(qb,"FootnoteEndnoteControlManager",null,[556])},1635:function(I,K,e){function m(G,J){var U=u.a.instance;const F=v.FocusManager.instance();U.Dba(G);G=F.te(G);U=new E.DOMFocusListing(()=>J);U.$ia=!0;U.jo(8);U.jo(2);F.rpb(J,G,U).nR=!0}I=e(0);var f=e(453),a=e(2),l=e(19),w=e(46),z=e(1040),x={get interop(){var G=null===fishBowlUx||void 0===fishBowlUx?void 0:fishBowlUx.interop;if(!G)throw Error("fishBowlUx chunk is accessed before loading");return G}},u=e(421),v=e(89),E=e(377),
y=e(1042);e.d(K,"a",function(){return H});class H{static initialize(G,J,U,F){f.a.D$c("ribbon",this.Nzg);this.tX=J;this.mK=U;this.pxj=F;this.rAg=G;this.pPa=document.getElementById(this.pxj);try{this.Sxb=document.createElement("div"),this.Sxb.id=this.Ueg,this.Sxb.classList.add(this.lgm),this.pPa.append(this.Sxb),this.lJn().then(()=>{this.interop=null===x||void 0===x?void 0:x.interop;this.controller=this.interop.renderFishBowlNavButton(this.Sxb,{onclick:this.sXn,onVisibilityChange:this.eNp});this.TEg();
this.F8o();this.q_n();w.a("MicroNavIconShown")})}catch{w.a("MicroNavFloatieInitializationFailed")}}static async TEg(){this.tX&&this.tX.execute(G=>{G.UW(()=>{setTimeout(this.controller.reposition,10)})})}static async F8o(){this.mK&&this.mK.execute(G=>{G.wVc((J,U)=>this.ZSj(U))})}static ZSj(G){0==G.$db?this.controller.changeContentContainer(!1):this.controller.changeContentContainer(!0)}static async lJn(){return a.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("fishBowlUx"):
(await Object(z.b)(this.rAg)).JE.loadScript("fishBowlUx")}}var D=H;H.pxj="";H.Ueg="FishBowlNavButton";H.tX=null;H.mK=null;H.lgm="FishBowlNavButton";H.controller=null;H.interop=null;H.Sxb=null;H.pPa=null;H.phe=!1;H.Nzg="NavFloatie";H.tOj=!1;H.q_n=()=>{D.tOj||(f.a.geb("ribbon",D.Nzg),f.a.PYb("ribbon",D.Nzg),D.tOj=!0)};H.eNp=(G,J)=>{!G||J||D.phe||(D.phe=!0,m(D.Ueg,D.Sxb));if((!G||J)&&D.phe){D.phe=!1;G=D.Ueg;J=u.a.instance;const U=v.FocusManager.instance();U.currentScope.name===G&&U.Rg(y.a.Co);J.wz(G)}};
H.sXn=()=>{a.AFrameworkApplication.va.Zb(l.a.c3a,2,null,void 0)};H.dispose=()=>{D.Sxb&&D.controller&&(D.mK.execute(G=>{G.Oxe((J,U)=>D.ZSj(U))}),D.tX.execute(G=>{G.NPa(()=>{D.controller.reposition()})}),D.interop.dispose(D.Sxb))};H.Pxp=()=>{D.controller&&D.controller.hide()};H.DHe=()=>{D.controller&&D.controller.show()};Object(I.a)(H,"NavButton",null,[])},1657:function(I,K,e){e.d(K,"a",function(){return u});I=e(0);var m=e(8),f=e(243),a=e(2),l=e(10),w=e(265),z=e(152),x=e(21);class u{constructor(v,E){this.Aw=
null;this.TNd=!1;this.Slb=0;this.JOe=!1;this.Zwh="";this.tPe={};this.CCj=()=>{this.oc&&this.oc.zP(f.AFrame.Sia,!0)};this.Gqe=()=>{this.g1c();this.tli();this.Vhg();this.IAb();return!0};this.Hqe=()=>{this.g1c();this.tli();this.Vhg();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.IAb()},0)});return!0};this.Jjg=y=>{y.stopPropagation()};this.k7n=y=>{y.stopPropagation();if(y.ctrlKey||y.metaKey)m.ULS.sendTraceTag(508045274,306,50,"Blocking App Zoom on ModalDiv"),y.preventDefault()};this.S3e=
v;this.oc=E;this.CCh=this.Jjg;this.DCh=this.k7n;this.Qvh=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Pb.oEa;this.qB=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Pb.z9;this.Rvh=!!a.AFrameworkApplication.J&&a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1);this.JOe=a.AFrameworkApplication.J.isChangeGateEnabled("OfficeVSO:8394309_disableAppZoomOnModalSurface");this.za=a.AFrameworkApplication.J;this.yEk=new Set(["2759860553"])}onMenuOpen(){0<
this.Slb?this.Slb++:(this.Slb++,a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(this.CCj,0)}):this.CCj(),this.showModal())}TAn(){const v=document.getElementById("WACToolbarContainer");return!!v&&"block"===v.style.display}getRibbonMode(){return this.Rvh&&this.TAn()?"Toolbar":z.f()}Iqm(){const v=this.getRibbonMode(),E=appChrome.selectors.getShyState();return String.format("{0}{1}",
v,this.Qvh&&E.isActive&&0!==E.state?"_ShyRibbon":"")}yVm(v){var E=0;if(this.qB){if(this.tPe[v])return this.tPe[v];(E=document.getElementById("BusinessBar"))||m.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");E=E?E.offsetTop:0;this.tPe[v]=E}return E}showModal(){if(!this.Aw)if(this.Aw=this.createElement("div"),this.Aw.setAttribute("id","ReactModalDiv"),this.Aw.style.position="absolute",this.Aw.style.bottom="0px",this.Aw.style.left=
"0px",this.Aw.style.right="0px",this.Aw.style.backgroundColor="white",this.Aw.style.opacity="0.0",this.qB){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.Aw)}else this.S3e.appendChild(this.Aw);v=this.Iqm();if(v!==this.Zwh){const y=this.yVm(v);var E=appChrome.selectors.getShyState();this.Qvh&&E.isActive&&0!==E.state?(E=this.Rvh?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(z.f()),this.Aw.style.top=String.format("{0}px",
y+E)):this.Aw.style.top=String.format("{0}px",y);this.Zwh=v}this.Aw.style.display="block";this.Aw.style.visibility="visible";this.Aw.style.zIndex="1000";this.TNd||(this.JOe?window.addEventListener("wheel",this.DCh,{passive:!1}):window.addEventListener("wheel",this.CCh,!0),this.qie()?w.a.instance.Cb(l.a.zR,this.Aw,this.Hqe):w.a.instance.Cb(l.a.Lu,this.Aw,this.Gqe),this.TNd=!0)}onMenuClose(){this.Slb--;0<this.Slb||(0>this.Slb?this.Slb=0:this.RTi())}Vhg(){this.Slb=0;this.NAf();this.RTi()}createElement(v){v=
document.createElement(v);v.setAttribute("unselectable","on");return v}QTi(){this.oc&&this.oc.currentScope&&this.oc.currentScope.name===f.AFrame.Sia&&!a.AFrameworkApplication.zc.UB&&this.oc.PW(f.AFrame.Sia,!1);this.Aw&&(this.Aw.style.zIndex="-1",this.Aw.style.visibility="hidden",this.Aw.style.display="none");this.TNd&&(this.JOe?window.removeEventListener("wheel",this.DCh,{passive:!1}):window.removeEventListener("wheel",this.CCh,!0),this.qie()?w.a.instance.Gc(l.a.zR,this.Aw,this.Hqe):w.a.instance.Gc(l.a.Lu,
this.Aw,this.Gqe),this.TNd=!1)}RTi(){this.qie()||this.R1f()||this.Wrn()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.QTi()},0)}):this.QTi()}IAb(){4===a.AFrameworkApplication.ta.Pb.gl&&a.AFrameworkApplication.J.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?a.AFrameworkApplication.ta.IAb():this.oc.Rg(f.AFrame.Co)}g1c(){const v=x.a.instance.Wa("Common.IReactContextualUILauncher");v&&v.g1c()}NAf(){const v=x.a.instance.Wa("Common.IReactContextualUILauncher");v&&v.NAf()}tli(){a.AFrameworkApplication.ta&&
a.AFrameworkApplication.ta.Pb.YZa&&(this.qie()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}qie(){return a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}Wrn(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScope",!1)}R1f(){var v,E;return(null!==(E=null===(v=a.AFrameworkApplication.J)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScopeAsyncEnabled",
!1))&&void 0!==E?E:!1)&&null!=window&&null!=window.Event&&null!=window.Event.ActionCommandId&&this.yEk.has(window.Event.ActionCommandId)}}Object(I.a)(u,"ReactModalDiv",null,[])},1687:function(I,K,e){e.d(K,"a",function(){return a});I=e(0);var m=e(1055),f=e(5);class a{constructor(l,w){this.hS=this.sPc=null;this.qb=l;this.wjb=w}get key(){return"COMMENT"}get hx(){return WacWordeditorStrings.Comment}get TQ(){return this.hS}reset(l){this.hS=l.node}NGa(l){let w=null;if(this.sPc&&this.R0i(l,this.TQ,this.sPc))return w=
Object.assign(new m.a,{NH:this.key,contentObject:this.sPc}),{returnValue:!0,vI:w};this.sPc=null;const z=this.wjb.xwf(this.TQ);if(this.wjb.f0f(z)){let x=z.ue();for(;x;){if(this.R0i(l,this.TQ,x))return this.sPc=x,w=Object.assign(new m.a,{NH:this.key,contentObject:x,description:this.$Xa()}),{returnValue:!0,vI:w};x=z.xl()}}return{returnValue:!1,vI:w}}R0i(l,w,z){if(this.hZj(z))return!1;const x=this.wjb.unc(z,!0),u=this.wjb.unc(z,!1);return x&&u&&this.qb.ncd(w,x,u)&&(w=this.wjb.aDa(x,z.id,!0))&&(x!==this.TQ||
w.Rb.cp<=l)&&(z=this.wjb.aDa(u,z.id,!1))&&(u!==this.TQ||z.Rb.cp>l||z.Rb.cp>=l)?!0:!1}hZj(l){return l.ka(f.a.iK,!1)}$Xa(){return null}}Object(I.a)(a,"CommentDetailsProvider",null,[376,377])},1694:function(I,K,e){e.d(K,"a",function(){return f});I=e(0);K=e(533);var m=e(241);class f extends K.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(I.a)(f,"DocumentTypeClassifierAnnotation",K.a,[])},1698:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,
"__esModule",{value:!0});f(e(1884),K);f(e(1885),K)},1699:function(I,K,e){e.r(K);e.d(K,"FootnoteEndnoteDefaultContentInserter",function(){return J});I=e(0);var m=e(21),f=e(49),a=e(2),l=e(30),w=e(112),z=e(565),x=e(26),u=e(5),v=e(13),E=e(61),y=e(118),H=e(1169),D=e(916),G=e(1585);class J{constructor(U,F,T,Y,P=null){this.td=U;this.pwk=F;this.zn=T;J.ni=Y;this.xih=P||J.gNl}get xP(){return null!=this.r6g?this.r6g:this.r6g=m.a.instance.resolve("Box4.IOutlineEditor")}aLl(U,F){var T=this.td.Lm();T.set(U);this.xP.bVb(T,
null,!0);J.ni.u2b(T.currentNode,this.zn);U=l.a.Ze(T);J.Q2.Ord(F?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,U);T=this.xih(T.currentNode);J.Ug.lf(T,J.Gii);this.zhn(U,F)}zhn(U,F){var T=this.pwk(E.a.hpa);T.setValue(u.a.gu,1===F?36:35);T.setValue(u.a.mma,!0);T.setValue(v.a.Gea,!0);const Y=U.ed.Mv(T,f.a.create());T=this.xih(U);J.Ug.Vna(T,P=>D.a.getInstance(P,Y,!0),G.a.Szi(U,F,Object(w.a)()))}static In(){return new J(new z.a,Object(y.a)(H.a.instance,H.a.instance.createInstance,
"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Q2(){return null!=J.t9g?J.t9g:J.t9g=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Ug(){return null!=J.wXg?J.wXg:J.wXg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=J.d3g?J.d3g:J.d3g=J.In()}static gNl(U){return x.a.jd(U,0)}}J.Gii=" ";J.ni=null;Object(I.a)(J,"FootnoteEndnoteDefaultContentInserter",null,[616])},1700:function(I,K,
e){e.d(K,"a",function(){return w});I=e(0);var m=e(565),f=e(553),a=e(1474),l=e(1585);class w{constructor(z,x){this.Cza=x}uce(z,x,u){return(z=this.Cza.EHi(z.node,u?z.cpBegin:z.cpEnd,x))?z.Y8():null}nQi(z,x){return(z=this.Cza.ZMm(z.node,z.cpBegin,x))?z.Y8():null}static Z5c(){return new w(f.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=w.C2g?w.C2g:w.C2g=w.Z5c()}}Object(I.a)(w,"FootnoteEndnoteNavigator",null,[595])},1712:function(I,K,e){e.d(K,"a",function(){return w});
I=e(0);var m=e(2153),f=e(2),a=e(44),l=e(21);class w{constructor(z,x,u,v,E,y){this.bAa=z;this.cAa=x;this.cYe=u;this.j3=v;this.dDd=E;this.M6b=y}get h_j(){return!this.cAa&&!this.cYe}get Rnj(){return 2===this.M6b?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get zqi(){return CommonUIStrings.l_OICErrorMessageNoOffice}get MUi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get vub(){return CommonUIStrings.l_OICErrorHelpLink}get ETi(){return"OICFailure"}get icon(){return 3}get HTd(){return 2===
this.M6b?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Mvo(z){this.coj(z)}AGn(z){this.coj(z)}coj(z){let x=10;1===z?(l.a.instance.resolve("Common.IOfficeTrialExperience").V6f(this.M6b),x=3):2===z&&((!this.cYe||this.cYe(this.j3))&&this.cAa&&m.a.instance.zOl(this.cAa,this.bAa,this.j3),x=5);(0===z||1===z)&&this.bAa&&this.bAa(this.j3);f.AFrameworkApplication.Lod(a.a.svj,this.dDd,x);this.dispose()}dispose(){this.j3=
this.cAa=this.bAa=null}}Object(I.a)(w,"AOICErrorDialogWithTrial",null,[11])},1798:function(I,K,e){I=e(0);var m=e(191),f=e(16),a=e(204),l=e(21),w=e(2),z=e(236),x=e(610);class u{static get Fh(){return m.a.iA(u.pp,WacWordeditorStrings.FootnoteEndnoteFormattingOptionsFont,WacWordeditorStrings.FootnoteEndnoteFormattingOptionsIndent)}}u.pp="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(I.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var v=e(19),E=e(3);e.d(K,"a",function(){return y});class y extends m.a{constructor(H,D,G){super();this.Rph=!1;this.Y_=null;this.Cim=J=>{switch(J){case 1:this.ga.Vb(v.a.Bvi,2);break;case 2:this.ga.Vb(v.a.Cvi,2);break;case 0:this.ga.Vb(v.a.Dvi,2)}};this.Yw=D;this.MX=!1;this.D9b=y.iim;this.mi=H;this.ga=G;this.$g="FootnoteEndnoteFormattingOptionsDialog";this.Md=2;this.Fh=u.Fh;this.Ue(1,WacWordeditorStrings.FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ue(2,WacWordeditorStrings.FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.ti(WacWordeditorStrings.FootnoteEndnoteFormattingOptionsDialogTitle,this.Cim,null);this.oub=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.Y_}set fontName(H){this.Y_=H;if(H=document.getElementById("FontSizeComboBox"))H.focus(),this.mi.Ne()}get fontSize(){return this.D9b}get oub(){return this.Rph}set oub(H){this.Rph=H;this.Wjo()}Cda(){this.qXd("FontStyleComboBox","FontPlaceholder",
v.a.w7d.toString(),v.a.SCj.toString(),v.a.Lkd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.qXd("FontSizeComboBox","FontPlaceholder",v.a.x7d.toString(),E.a.Tld.toString(),v.a.Mkd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.N1(WacWordeditorStrings.FootnoteEndnotesIndentButtonText),""),D=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.N1(WacWordeditorStrings.FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.jXc("NoStyle","IndentPlaceholderStyles",v.a.Fvi.toString(),
v.a.TCj.toString(),H,WacWordeditorStrings.FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.jXc("FirstLineIndent","IndentPlaceholderStyles",v.a.Evi.toString(),v.a.Xrg.toString(),D,WacWordeditorStrings.FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}qXd(H,D,G,J,U,F,T){G=z.c(H,G,!0,!0,J,U,f.a.Mf(F),!0,T);this.W0d(H,D,G,"Medium")}jXc(H,D,G,J,U,F,T){G=z.f(H,G,J,f.a.Mf(U),f.a.Mf(F),T);this.W0d(H,D,G,"Large",F)}W0d(H,D,G,J,U=null){D=document.getElementById(D);this.Yw.h8a(H,G);G=this.Yw.xSb(H,
J);U&&a.a.PVd(G,String.format("{0}Label",H),U);D.appendChild(G);this.Yw.Uwa(H)}Wjo(){this.Yw.Uwa("NoStyle");this.Yw.Uwa("FirstLineIndent")}dispose(){this.MX||(this.Yw.I2("FontStyleComboBox"),this.Yw.I2("FontSizeComboBox"),this.Yw.I2("NoStyle"),this.Yw.I2("FirstLineIndent"),this.MX=!0);this.mi.Ne();super.dispose()}static get $2a(){return l.a.instance.resolve("Common.IStandaloneRootController").yja}static sAm(){return new y(x.a.Xm,y.$2a,w.AFrameworkApplication.va)}static rAm(){return y.sAm()}}y.iim=
-1;Object(I.a)(y,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1837:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(f,a){this.Ci=this.xJd=0;this.mph=a;this.SVk=f}Txb(){return this.xJd-this.Ci>=this.SVk}reset(){this.Ci=this.xJd=this.mph()}update(){this.xJd=this.mph()}}Object(I.a)(m,"TimeBasedTaskYieldStrategy",null,[342])},1853:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in
x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1854),K);f(e(1855),K)},1854:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1855:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.EndnoteSubDocument=
K.FootnoteSubDocument=K.ShapeSubDocument=K.TextboxSubDocument=K.CommentSubDocument=K.HeaderFooterSubDocument=K.MainSubDocument=void 0;const m=e(532);class f{constructor(v){m.SchemaObject.assign(f,this,v)}static getTypeName(){return"AugLoop_Word_MainSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[f.getTypeName()])}}K.MainSubDocument=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(v){m.SchemaObject.assign(a,
this,v)}static getTypeName(){return"AugLoop_Word_HeaderFooterSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[a.getTypeName()])}}K.HeaderFooterSubDocument=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(v){m.SchemaObject.assign(l,this,v)}static getTypeName(){return"AugLoop_Word_CommentSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[l.getTypeName()])}}K.CommentSubDocument=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(v){m.SchemaObject.assign(w,this,v)}static getTypeName(){return"AugLoop_Word_TextboxSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[w.getTypeName()])}}K.TextboxSubDocument=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(v){m.SchemaObject.assign(z,this,v)}static getTypeName(){return"AugLoop_Word_ShapeSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[z.getTypeName()])}}K.ShapeSubDocument=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(v){m.SchemaObject.assign(x,this,v)}static getTypeName(){return"AugLoop_Word_FootnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[x.getTypeName()])}}K.FootnoteSubDocument=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(v){m.SchemaObject.assign(u,this,v)}static getTypeName(){return"AugLoop_Word_EndnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[u.getTypeName()])}}K.EndnoteSubDocument=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1884:function(I,K){Object.defineProperty(K,"__esModule",{value:!0});K.ObjectSchemaType=K.ObjectSemantic=K.SequenceType=K.IntentIds=void 0;(function(e){e.Logging="Logging";e.ZeroTermMenu="ZeroTermMenu";e.Floatie="Floatie"})(K.IntentIds||(K.IntentIds={}));(function(e){e.CommandId="CommandId";e.ControlId="ControlId"})(K.SequenceType||(K.SequenceType={}));(function(e){e.CommandIdHistory="CommandIdHistory";e.ControlIdHistory=
"ControlIdHistory";e.FilteredCommandIdHistory="FilteredCommandIdHistory";e.CanvasContext="CanvasContext";e.ApplicationContext="ApplicationContext";e.UserContext="UserContext";e.GenericSuggestions="GenericSuggestions"})(K.ObjectSemantic||(K.ObjectSemantic={}));(function(e){e.CommandExecutionSequence="CommandExecutionSequence";e.WordCanvasContext="WordCanvasContext";e.ApplicationContext="ApplicationContext";e.UserContext="UserContext";e.RankedSuggestion="RankedSuggestion"})(K.ObjectSchemaType||(K.ObjectSchemaType=
{}))},1885:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.SearchSuggestionAnnotation=K.SearchSuggestionSignal=void 0;const m=e(532);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}K.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}K.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1894:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||
("get"in x?!l.XP:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1895),K);f(e(1896),K);f(e(1897),K);f(e(1898),K)},1895:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1896:function(I,K){Object.defineProperty(K,
"__esModule",{value:!0})},1897:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.ContractEntityAnnotation=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
K.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1898:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.ContractEntitySignal=void 0;const m=e(532);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()}},1900:function(I,K,e){e.r(K);e.d(K,"ReactOICErrorDialogWithTrial",function(){return l});I=e(0);var m=e(118);K=e(1712);var f=e(962),a=e(191);class l extends K.a{constructor(w,z,x,u,v,E){super(w,z,x,u,v,E);z={["errorMessage"]:this.zqi,["offerString"]:this.Rnj};w=new a.a(!1,!1,!0);this.h_j?(w.Md=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.vub,["onExecute"]:()=>{f.Redirect.showHelp(this.ETi)}}):(w.Md=4,w.Ue(2,this.MUi));w.Ue(1,this.HTd);w.$g=this.id;z={["id"]:this.id,
["dialogIcon"]:this.icon,["bodyControls"]:z};w.ti(this.dialogTitle,Object(m.a)(this,this.Mvo,"reactOICErrorDialogWithTrialHandler"),z)}}Object(I.a)(l,"ReactOICErrorDialogWithTrial",K.a,[])},1901:function(I,K,e){e.r(K);e.d(K,"OICErrorDialogWithTrial",function(){return a});I=e(0);var m=e(118);K=e(1712);var f=e(182);class a extends K.a{constructor(l,w,z,x,u,v){super(l,w,z,x,u,v);l=document.createElement("span");l.innerText=this.zqi;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
w=document.createElement("span");w.innerText=this.Rnj;l.appendChild(w);w=new f.StandardDialog;this.h_j?(w.Md=1,w.sUd(this.vub,this.ETi)):(w.Md=4,w.Ue(2,this.MUi));w.Ue(1,this.HTd);w.$g=this.id;w.Yx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.AGn,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(I.a)(a,"OICErrorDialogWithTrial",K.a,[])},1903:function(I,K,e){var m=this&&this.wX||(Object.create?function(a,l,w,z){void 0===z&&(z=w);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[w]}})}:
function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(K,"__esModule",{value:!0});f(e(1904),K);f(e(1905),K)},1904:function(I,K){Object.defineProperty(K,"__esModule",{value:!0})},1905:function(I,K,e){Object.defineProperty(K,"__esModule",{value:!0});K.SearchProviderAnnotation=K.SearchProviderSignal=void 0;const m=e(532);class f{constructor(l){m.SchemaObject.assign(f,
this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}K.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[a.getTypeName()])}}K.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1995:function(I,K,e){function m(oa){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");var Za;(null===(Za=y.AFrameworkApplication.J)||void 0===Za?0:Za.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveCommentsDependency",!1))?(Ca.a.instance.Rc(new vr,0,oa),Cl(oa),Eq(oa),Xg.main(oa),xa(oa),pi.main(oa),Ca.a.instance.Rc(new ul,0,oa)):(xa(oa),pi.main(oa),
Ca.a.instance.Rc(new vr,0,oa),Ca.a.instance.Rc(new ul,0,oa),Cl(oa),Eq(oa),Xg.main(oa))}var f=e(0),a=e(8),l=e(1322),w;(function(oa){oa[oa.unknown=0]="unknown";oa[oa.supported=1]="supported";oa[oa.Lzq=2]="userUnsupportedAnonymous";oa[oa.Mzq=3]="userUnsupportedNoLoginHint";oa[oa.wbq=4]="hostUnsupported";oa[oa.vpq=5]="perfAutomation"})(w||(w={}));Object(f.b)("SupportStatus",w);var z=e(937),x=e(1467);class u{constructor(oa){this.gLk=oa}initialize(){return Promise.resolve(0)}lle(){return Promise.resolve(0)}kX(){a.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.gLk}))}wHe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aFe(){return!1}w7c(){return"MockAuthTokenStrategy"}}Object(f.a)(u,"MockAuthTokenStrategy",null,[247]);var v=e(1637);class E{static get(oa,Za,xb){if(!xb)return oa;
let Zb=0;return Promise.race([oa,new Promise(sc=>{Zb=window.setTimeout(()=>{sc(Za)},xb)})]).then(sc=>{window.clearTimeout(Zb);return Promise.resolve(sc)}).catch(()=>{window.clearTimeout(Zb);return Promise.resolve(Za)})}}Object(f.a)(E,"PromiseWithTimeout",null,[]);var y=e(2),H=e(639);class D{constructor(oa,Za,xb,Zb,sc){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=oa;this.scope=Za;this.silentLogin=xb;this.options=Zb;this.correlationId=sc}}Object(f.a)(D,
"TokenRequestParameters",null,[250]);var G=e(17),J=e(21);class U{constructor(){this.fQh=null;let oa=y.AFrameworkApplication.J.rb(y.AFrameworkApplication.Zja),Za=y.AFrameworkApplication.J.rb(y.AFrameworkApplication.LHe);this.kdc=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",oa&&""!==oa?oa:"Unspecified",Za&&""!==Za?Za:"Unspecified")}initialize(){return new Promise(oa=>{J.a.instance.Za("Common.App.WopiIdentity.IWopiIdentity").execute(Za=>{this.fQh=Za;oa(0)})})}te(oa){const Za=
["HTTPS:","API:"];let xb=!1;const Zb=oa.toLocaleUpperCase();for(const sc of Za)if(Zb.startsWith(sc)){xb=!0;break}return xb||this.Jrn(oa)?oa+"/.default":oa}Jrn(oa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(oa)}lle(){return Promise.resolve(0)}kX(oa,Za,xb,Zb,sc,$c,Ed){if(G.a.e_a){sc=H.a.oNp;if(!sc)return Za=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Za);if(!Array.contains(sc,
oa))return Za=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+oa}),Promise.resolve(Za)}oa=this.te(xb);xb=new D(xb,oa,!Zb,null,y.AFrameworkApplication.userSessionId);return this.fQh.getAccessToken(xb,Za,Ed).then(Ud=>Object.assign(new x.a,{IsSuccess:!0,Token:Ud.accessToken}),Ud=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Ud}))}wHe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aFe(){return!1}w7c(){return this.kdc}}
Object(f.a)(U,"ParentFrameTokenStrategy",null,[247]);var F=e(782),T=e(76);class Y{constructor(){this.reject=this.resolve=null;this.startTime=0;this.jCj=this.N_h=null}}Object(f.a)(Y,"PromiseWrapper",null,[]);class P{constructor(oa=0){this.nB=0;this.lQc=!1;this.tB=new T.a;this._timeout=oa}enqueue(oa){return new Promise((Za,xb)=>{this.tB.add(Object.assign(new Y,{jCj:oa,resolve:Za,reject:xb}));this.process()})}process(){if(this.lQc||this.nB===this.tB.count)return!1;const oa=this.tB.K(this.nB++);try{this.lQc=
!0,oa.jCj().then(Za=>{this.lQc=!1;this.Ctf(oa,Za,null,!0)}).catch(Za=>{this.lQc=!1;this.Ctf(oa,null,Za,!1)})}catch(Za){this.lQc=!1,this.Ctf(oa,null,Za,!1)}return!0}Ctf(oa,Za,xb,Zb){if(Zb){const sc=()=>{oa.resolve(Za);this.process()};0<this._timeout?window.setTimeout(()=>{sc()},this._timeout):sc()}else{const sc=()=>{oa.reject(xb);this.process()};0<this._timeout?window.setTimeout(()=>{sc()},this._timeout):sc()}}}Object(f.a)(P,"PromiseQueue",null,[]);class S{constructor(){this.correlationId=this.resolve=
null}}Object(f.a)(S,"ResolveWithCorrelation",null,[]);var N=e(87),V=e(191),Z=e(971),ca=e(97);class W extends V.a{constructor(oa,Za,xb,Zb,sc,$c){super(!1,!1,!0);this.gkh=this.SHa=null;this.E$n=()=>{this.Xvi()};this.jMl=()=>this.jL;this.V8o=Ed=>{0===Ed&&(this.oXk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.mHb(null))};this.AAa=oa;this.MPk=xb;this.Tw=Zb;this.oXk=sc;this.mHb=$c;this.jL=document.createElement("iframe");this.jL.id=
"SharedAuthInteractiveFrame";this.jL.setAttribute("name","SharedAuthInteractiveFrame");this.jL.setAttribute("title","SharedAuthInteractiveFrame");this.jL.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.jL.style.border="0";this.jL.style.height="48px";this.jL.style.width="190px";$addHandler(this.jL,"error",this.E$n);oa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.AAa,Za,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",
y.AFrameworkApplication.userType);this.jL.src=oa;this.pzk=new Promise(Ed=>{this.gkh=Ed});this.hkh=!1}v2a(){this.SHa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.MPk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:y.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.jMl,["resolveDialogStyles"]:this.gkh}};this.Md=5;this.ti(CommonUIStrings.l_SignIn,this.V8o,this.SHa)}zdk(oa=!1,Za=5){this.SHa&&this.SHa.bodyControls&&(!0!==Object(N.a)(Object,this.SHa.bodyControls).frameLoaded&&
(Object(N.a)(Object,this.SHa.bodyControls).frameLoaded=!0),oa!==Object(N.a)(Object,this.SHa.bodyControls).frameLoadSuccess&&(Object(N.a)(Object,this.SHa.bodyControls).frameLoadSuccess=oa),Za!==this.SHa.dialogButtonsOption&&(this.SHa.dialogButtonsOption=null,this.Md=Za),this.update(this.SHa))}Lfp(oa,Za){const xb=new Z.a(ca.a.Z8o);xb.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:y.AFrameworkApplication.isRtl,["messageCorrelationId"]:oa,["dialogStyles"]:Za};
this.Tw.lgb(xb,this.jL.contentWindow,this.AAa)}Xvi(){this.zdk(!1,6)}get lXj(){return this.jL}get KZl(){return this.pzk.then(oa=>{this.hkh=!0;return oa})}get LZl(){return this.hkh}}Object(f.a)(W,"SharedAuthConsentDialog",V.a,[252]);var X=e(990),ka=e(90),ma=e(889),ja=e(59),na=e(127),Ba=e(100);class Ma{}Ma.kpiName="OAuthManager";Object(f.a)(Ma,"OAuthManagerConstants",null,[]);class Ea{constructor(){this.jL=null;this.rGd=0;this.Eac=this.Sdc=this.mOe=this.mHb=this.Tfa=this.dOh=null;this.R5n=()=>{const oa=
ja.a.We()-this.rGd;a.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",oa)};this.xyb=oa=>{const Za=ja.a.We()-this.rGd,xb=Object.assign(new Ba.a,{durationMs:Za});ka.Health.instance.recordKpiFailure(Ma.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,xb);a.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Za,this.Rlh?JSON.stringify(oa):"")};this.h$n=oa=>{const Za=this.Dmb.loadFrame;var xb=ja.a.We()-Za.startTime,Zb=oa.Values.AuthLibrary.toString();
oa=oa.Values.Success.toString();a.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",oa,Zb,xb);Zb&&(this.kdc="SharedAuthTokenStrategy "+Zb);Zb=Boolean.parse(oa);Zb||(oa=ma.a.HI(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.w7c()),xb=Object.assign(new Ba.a,{durationMs:xb,extendedProperties:oa}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"SharedAuthStrategyInitFailed",!1,!0,xb)));Za.resolve(Zb?0:1)};this.g$n=oa=>{if(oa.Values.interactive&&
this.Sdc&&this.Sdc.Values.messageCorrelationId){const xb=this.Sdc.Values.messageCorrelationId.toString();if(oa.Values.interactive&&this.Tfa){this.Tfa.KZl.then(Zb=>{this.Tw.lgb(this.Sdc,this.Tfa.lXj.contentWindow,this.AAa);this.Tfa.Lfp(xb,Zb);this.Tfa.zdk(!0);this.Sdc=null});return}}oa=this.Dmb.initFrame;const Za=ja.a.We()-oa.startTime;a.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Za);oa.resolve(0)};this.t5n=oa=>{if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var Za=
oa.Values.messageCorrelationId.toString(),xb=this.Dmb[Za];if(xb){var Zb=ja.a.We()-xb.startTime;a.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Zb);oa.Values.isSuccess&&oa.Values.isSuccess?xb.resolve(oa.Values.response):xb.reject(oa.Values.response);this.Z9j(Za)}else a.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};
this.n6n=()=>{if(this.Tfa.LZl)this.Tfa.Xvi();else if(this.mOe&&this.Tfa){const oa=new Z.a(ca.a.oXj);oa.Values=this.u_h(this.mOe,!0);this.Tw.lgb(oa,this.Tfa.lXj.contentWindow,this.AAa)}};this.G5n=()=>{this.Tfa&&this.Tfa.Kde()};this.Whg=oa=>{oa.Values.cancelled&&oa.Values.cancelled&&oa.Values.messageCorrelationId&&this.Z9j(oa.Values.messageCorrelationId.toString());this.Tfa&&this.Tfa.hide()};this.R6n=oa=>{if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var Za=this.Dmb[oa.Values.messageCorrelationId.toString()];
if(Za){var xb=ja.a.We()-Za.startTime;a.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",xb);oa.Values.isSuccess&&oa.Values.isSuccess?Za.resolve(oa.Values.response):Za.reject(oa.Values.response)}else a.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.Tw=
new X.a(null,null);this.kdc="SharedAuthTokenStrategy Unloaded";this.AAa=H.a.X8o;this.WJh=H.a.W8o;this.Rlh=H.a.enableConsoleLogging;this.zAk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.uUk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.hYk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Dmb={};this.$Fk=
new P(1500)}w7c(){return this.kdc}initialize(){if("loadFrame"in this.Dmb)return this.Dmb.loadFrame.N_h;if(!this.AAa)return ka.Health.instance.recordKpiFailure(Ma.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),a.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const oa=this.DEe("loadFrame");this.rGd=ja.a.We();var Za=this.AAa+this.WJh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+y.AFrameworkApplication.userSessionId+
"&WacUserType="+y.AFrameworkApplication.userType;this.hYk&&(Za+="&webworker=1");this.jL=document.createElement("iframe");this.xYf(this.jL);this.jL.style.cssText="height:0;width:0;display:none;";this.jL.id="SharedAuthFrame";this.jL.setAttribute("name","SharedAuthFrame");this.jL.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.jL.setAttribute("title","SharedAuthFrame");this.jL.src=Za;document.body.appendChild(this.jL);Za=ja.a.We()-this.rGd;a.ULS.sendTraceTag(573112899,
3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Za,this.jL.src);return oa}lle(oa){this.mOe=oa;const Za=new Z.a(ca.a.oXj);Za.Values=this.u_h(oa);oa=this.DEe("initFrame");this.Tw.lgb(Za,this.jL.contentWindow,this.AAa);a.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return oa}kX(oa,Za,xb,Zb,sc,$c){const Ed=new Z.a(ca.a.$8o),Ud=this.OKi();Ed.Values=this.B9j(oa,Za,xb,Zb,sc,$c,Ud);oa=this.DEe(Ud);Zb&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.$Fk.enqueue(()=>new Promise(Vd=>{this.Lxp($c,Ed,Vd,Ud)})):(this.Tw.lgb(Ed,this.jL.contentWindow,this.AAa),a.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Za));return oa}Lxp(oa,Za,xb,Zb){const sc=this.Dmb[Zb];sc&&(this.Sdc=Za,this.mHb=Object.assign(new S,{resolve:xb,correlationId:Zb}),this.Tfa=new W(this.AAa,this.WJh,oa,this.Tw,
sc,xb),this.Tfa.v2a())}OKi(){return na.a.create().toString()}B9j(oa,Za,xb,Zb,sc,$c,Ed){const Ud={};Ud.appName=oa;Ud.appId=Za;Ud.target=xb;Ud.withPopup=Zb;Ud.claims=sc;Ud.promptMessage=$c;Ud.messageCorrelationId=Ed;return Ud}xYf(oa){$addHandler(oa,"load",this.R5n);$addHandler(oa,"error",this.xyb);this.Tw.Pla(this.AAa);this.Tw.$w(ca.a.rXj);this.Tw.DG(ca.a.rXj,this.h$n);this.Tw.$w(ca.a.qXj);this.Tw.DG(ca.a.qXj,this.g$n);this.Tw.$w(ca.a.mXj);this.Tw.DG(ca.a.mXj,this.t5n);this.Tw.$w(ca.a.sXj);this.Tw.DG(ca.a.sXj,
this.R6n);this.Tw.$w(ca.a.pXj);this.Tw.DG(ca.a.pXj,this.n6n);this.Tw.$w(ca.a.nXj);this.Tw.DG(ca.a.nXj,this.G5n);this.Tw.$w(ca.a.kXj);this.Tw.DG(ca.a.kXj,this.Whg)}DEe(oa){const Za=new Y;Za.startTime=ja.a.We();const xb=new Promise((Zb,sc)=>{Za.resolve=Zb;Za.reject=sc});Za.N_h=xb;this.Dmb[oa]=Za;return xb}u_h(oa,Za=!1){const xb={};xb.appIds=this.wom();xb.upn=oa.loginHint;xb.authority=oa.authority;xb.authorityType=Object(l.a)(z.a,oa.authorityType);xb.tenantId=oa.tenantId;xb.correlationId=y.AFrameworkApplication.userSessionId;
xb.enableConsoleLogging=this.Rlh;xb.enablePopupFlash=this.zAk;xb.skipUpnCheck=this.uUk;xb.interactive=Za;return xb}wom(){const oa=[],Za=H.a.elf;for(const Zb in Za){var xb=Za[Zb];Array.contains(oa,xb)||Array.add(oa,xb)}return oa}wHe(oa,Za,xb,Zb,sc,$c){const Ed=new Z.a(ca.a.Y8o),Ud=this.OKi();Ed.Values=this.B9j(oa,Za,xb,Zb,sc,$c,Ud);this.dOh=Ed;oa=this.DEe(Ud);a.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Za);this.kdp();return oa}aFe(){return!0}kdp(){this.Eac||
(this.Eac=new F.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Eac.id=16,this.Eac.$bd=!1,this.Eac.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{a.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Tw.lgb(this.dOh,this.jL.contentWindow,this.AAa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),y.AFrameworkApplication.ta.Pb.dBa(this.Eac,!0)||a.ULS.sendTraceTag(555049438,
3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Z9j(oa){this.mHb&&this.mHb.correlationId===oa&&(this.mHb.resolve(null),this.mHb=null)}}Object(f.a)(Ea,"SharedAuthTokenStrategy",null,[247]);class ya{constructor(oa){this.kba=oa;this.kdc="UnsupportedAuthTokenStrategy Reason="+w[this.kba]}initialize(){return Promise.resolve(0)}lle(){return Promise.resolve(0)}kX(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:w[this.kba],ErrorMessage:"Unable to get a token. Reason: ["+
w[this.kba]+"]"}))}wHe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}aFe(){return!1}w7c(){return this.kdc}}Object(f.a)(ya,"UnsupportedAuthTokenStrategy",null,[247]);var ia=e(1399);class za{constructor(oa=null){this.R6=0;this.Xea=null;this.kKb=0;this.svh=!!window.location.search.match(RegExp("wdpa=1","gi"));const Za=ja.a.We();this.GFk=this.JYl(oa).then(xb=>
xb?this.Rbn():(a.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-Za)),xb=ma.a.HI(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.HL()),xb=Object.assign(new Ba.a,{durationMs:Math.floor(ja.a.We()-Za),extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyPickFailed",!1,!0,xb)),Promise.resolve(1))).then(xb=>0!==xb?Promise.resolve(xb):this.ZHn())}KYl(){if(this.svh)this.R6=
5,this.Xea=new ya(this.R6);else{var oa=H.a.dVn;oa&&0<oa.length?(this.R6=1,this.Xea=new u(oa)):y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")?y.AFrameworkApplication.J.$("IsAnonymousUser")?(this.R6=2,this.Xea=new ya(this.R6)):(oa=v.a.getAuthContext().loginHint)&&oa.length?H.a.t9c?(this.R6=1,this.Xea=new U):(this.R6=1,this.Xea=new Ea):(this.R6=3,this.Xea=new ya(this.R6)):(this.R6=4,this.Xea=new ya(this.R6))}}HL(){return this.Xea?this.Xea.w7c()||
"Unknown":"None"}JYl(oa=null){a.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Za=ja.a.We();return y.AFrameworkApplication.J.FAm().then(xb=>{xb?(this.KYl(),oa&&(this.Xea=oa),a.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",H.a.clientVersion,H.a.appVersion,H.a.t2l,this.HL(),Math.floor(ja.a.We()-Za))):a.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ja.a.We()-Za));return Promise.resolve(xb)},()=>{a.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ja.a.We()-Za));return Promise.resolve(!1)})}Rbn(){a.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.HL());const oa=ja.a.We();return E.get(this.Xea.initialize(),2,H.a.grg).then(Za=>{if(0===Za)a.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.HL(),Math.floor(ja.a.We()-oa));else if(1===Za){a.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-oa));var xb=ma.a.HI();void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.HL()),xb=Object.assign(new Ba.a,{durationMs:Math.floor(ja.a.We()-oa),extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyInitFailed",!1,!0,xb))}else 2===Za&&(a.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.HL(),Math.floor(ja.a.We()-oa)),xb=ma.a.HI(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.HL()),xb=Object.assign(new Ba.a,{durationMs:Math.floor(ja.a.We()-oa),extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyInitTimedOut",!1,!0,xb)));return Promise.resolve(Za)},()=>{a.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-oa));return Promise.resolve(1)})}ZHn(){a.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.HL());const oa=ja.a.We();return E.get(this.Xea.lle(v.a.getAuthContext()),2,H.a.grg).then(Za=>{if(0===Za)a.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.HL(),Math.floor(ja.a.We()-oa));else if(1===Za){a.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-oa));var xb=ma.a.HI();void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.HL()),xb=Object.assign(new Ba.a,
{durationMs:Math.floor(ja.a.We()-oa),extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyLoadFailed",!1,!0,xb))}else 2===Za&&(a.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-oa)),xb=ma.a.HI(),void 0!==xb&&null!==xb&&(xb.set("AuthLibrary",this.HL()),xb=Object.assign(new Ba.a,{durationMs:Math.floor(ja.a.We()-oa),extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,
"StrategyLoadTimedOut",!1,!0,xb)));return Promise.resolve(Za)},()=>{a.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.HL(),Math.floor(ja.a.We()-oa));return Promise.resolve(1)})}kX(oa,Za,xb=null,Zb){return this.uDc(oa,Za,!1,Zb,"",xb)}C9j(oa,Za,xb,Zb,sc=null){return this.uDc(oa,Za,!0,xb,Zb,sc)}uDc(oa,Za,xb,Zb,sc,$c,Ed=0){Ed+=1;a.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
oa,this.B1b(oa,Za),this.HL(),Ed);var Ud=ma.a.HI();void 0!==Ud&&null!==Ud&&(Ud.set("AuthLibrary",this.HL()),Ud.set("AppName",oa),Ud.set("Target",this.B1b(oa,Za)),ka.Health.instance.recordKpiUsage(Ma.kpiName,0,"WacOAuthFC",Ud));if(!H.a.isEnabled||this.svh){var Vd;return this.L9f((Vd=new x.a,Vd.IsSuccess=!1,Vd.Token=null,Vd.ErrorCode="NotEnabled",Vd.ErrorMessage="OAuthManager is disabled.",Vd),oa)}const Ie=H.a.elf[oa];if(void 0===Ie||null===Ie){a.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
oa);var Ue;return this.L9f((Ue=new x.a,Ue.IsSuccess=!1,Ue.Token=null,Ue.ErrorCode="DisallowedApp",Ue.ErrorMessage="Disallowed appName: "+oa,Ue),oa)}const dg=ja.a.We();let Pf=dg;const pc=this;Ud=this.GFk.then(ji=>{Pf=ja.a.We();return pc.Okn(oa,Ie,Za,xb,Zb,sc,$c,ji)});Vd=xb?0:H.a.grg;let yi;Ue=(yi=new x.a,yi.IsSuccess=!1,yi.Token=null,yi.ErrorCode="authTokenStrategy_timeout",yi.ErrorMessage="Auth Strategy timed out after ["+Vd+"] ms when fetching token",yi);const Ei=this,ok=this;return E.get(Ud,Ue,
Vd).then(ji=>Ed<=za.wSn&&(ji.ErrorCode===za.D6j||ji.ErrorCode===za.imp)?(a.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ed,Math.floor(ja.a.We()-dg)),Ei.uDc(oa,Za,xb,Zb,sc,$c,Ed)):ji.ErrorCode===za.$9i&&!xb&&(a.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ed,za.Hoi),za.p6l&&Ei.Xea.aFe()&&Ei.Xea.wHe(oa,Ie,Za,xb,Zb,sc).then(hk=>Promise.resolve(Ei.Vle(hk,oa,Za,Ie,dg,Pf))).catch(()=>
{let hk;const Sl=(hk=new x.a,hk.IsSuccess=!1,hk.Token=null,hk.ErrorCode="authTokenStrategy_failure",hk.ErrorMessage="LoginPopup failed, GetToken could not be called",hk);return Promise.resolve(Ei.Vle(Sl,oa,Za,Ie,dg,Pf))}),za.Hoi)?Ei.uDc(oa,Za,!0,Zb,sc,$c,Ed):Promise.resolve(Ei.Vle(ji,oa,Za,Ie,dg,Pf))).catch(()=>{let ji;const hk=(ji=new x.a,ji.IsSuccess=!1,ji.Token=null,ji.ErrorCode="authTokenStrategy_failure",ji.ErrorMessage="Auth Strategy failed with an unknown error",ji);return Promise.resolve(ok.Vle(hk,
oa,Za,Ie,dg,Pf))})}Okn(oa,Za,xb,Zb,sc,$c,Ed,Ud){return 1===Ud||2===Ud?this.L9f(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ud?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),oa):this.Xea.kX(oa,Za,xb,Zb,sc,$c,Ed).then(Vd=>Promise.resolve(this.Pmj(Vd,!0,oa))).catch(Vd=>Promise.resolve(this.Pmj(Vd,!1,oa)))}Vle(oa,Za,xb,Zb,sc,$c){const Ed={},Ud=ja.a.We()-$c;Ed.IsSuccess=oa.IsSuccess;Ed.ErrorCode=oa.IsSuccess?"Success":oa.ErrorCode||"";Ed.ErrorMessage=
oa.IsSuccess?"Success":this.B1b(Za,oa.ErrorMessage||"");Ed.Target=this.B1b(Za,xb||"");Ed.TimeInMS=Math.floor(Ud);Ed.LoadTimeInMS=Math.floor($c-sc);Ed.AuthLibrary=this.HL();Ed.AppName=Za;Ed.AuthorityType=Object(l.a)(z.a,v.a.p8d());Ed.UserType=this.aXm(v.a.getAuthContext());Ed.IsAuthSupportedInSession=w[this.R6];Ed.RequestCount=++this.kKb;Ed.AppId=Zb;a.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ed));oa.IsSuccess||(xb=ma.a.HI(),void 0!==xb&&null!==xb&&(xb.set("AppName",Za),xb.set("AuthLibrary",
this.HL()),xb.set("ErrorCode",oa.ErrorCode),xb.set("ErrorMessage",this.B1b(Za,oa.ErrorMessage)),Za=Object.assign(new Ba.a,{durationMs:Ud,extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"TryGetTokenFailure",!1,!0,Za)));return oa}L9f(oa,Za){a.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Za,this.B1b(Za,oa.ErrorMessage));const xb=ma.a.HI();void 0!==xb&&null!==xb&&(xb.set("AppName",Za),xb.set("AuthLibrary",this.HL()),
xb.set("ErrorCode",oa.ErrorCode),xb.set("ErrorMessage",this.B1b(Za,oa.ErrorMessage)),Za=Object.assign(new Ba.a,{extendedProperties:xb}),ka.Health.instance.recordKpiFailure(Ma.kpiName,"FailureBeforeGetToken",!1,!0,Za));return Promise.resolve(oa)}J2i(oa){return oa===ia.a.mGe}B1b(oa,Za){return this.J2i(oa)&&Za?"REDACTED":Za}aXm(oa){return y.AFrameworkApplication.J.$("IsAnonymousUser")?"anonymous":!oa.loginHint||1>oa.loginHint.length?"empty":-1<oa.loginHint.indexOf("guest#")?"guest":-1<oa.loginHint.indexOf("ext#")?
"external":0>oa.upn.indexOf("@")?"no-at":"supported"}Zln(){return 1===this.R6}Pmj(oa,Za,xb){let Zb=null,sc=null,$c=null,Ed=null;oa?oa.ErrorCode||oa.ErrorMessage?(sc=oa.ErrorCode?oa.ErrorCode:za.Zqi,$c=oa.ErrorMessage?oa.ErrorMessage:"No message"):oa.Token?Za?Zb=oa.Token:(sc=za.SEo,$c="A rejected promise returned a token."):(sc=za.Zqi,$c=JSON.stringify(oa)):(sc=za.GYn,$c="No result came from Auth Token Strategy");oa&&oa.Telemetry&&!this.J2i(xb)&&(Ed=oa.Telemetry,a.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(Ed)));if(sc===za.yVn||sc===za.Ttp)sc=za.D6j,$c="Auth Library Timed Out";sc===za.phl&&-1<$c.indexOf(za.qZk)&&(sc=za.$9i);if(sc||$c)Zb=null;return Object.assign(new x.a,{IsSuccess:!!Zb,Token:Zb,ErrorCode:sc,ErrorMessage:$c,Telemetry:Ed})}static get Hoi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get p6l(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}za.Ttp="token_renewal_error";za.Zqi="Exception";za.GYn="NoResult";za.SEo="RejectToken";za.yVn="monitor_window_timeout";za.D6j="Timeout";za.imp="authTokenStrategy_timeout";za.phl="login_required";za.qZk="AADSTS50058";za.$9i="Cookies Disabled";za.wSn=2;Object(f.a)(za,"OAuthManager",null,[207]);var Ca=e(186),db=e(29),pa=e(43),ua=e(84),Ga=e(103);class wa{get name(){return"Common.App.OAuth.OAuthPackage"}Ec(oa){oa.register(207,"Common.App.OAuth.IOAuthManager").ha().fe(()=>new za)}init(){const oa=J.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Qyp(oa);this.Pyp(oa)}Pyp(oa){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Za=y.AFrameworkApplication.J.rb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Za){var xb=H.a.D0d;if(xb&&xb.IsEnabled){var Zb=xb.Application,sc=H.a.authority;if(void 0!==Zb&&null!==Zb&&Zb.length&&void 0!==sc&&null!==sc&&sc.length){var $c=
w[oa.R6],Ed=G.a.aG,Ud=oa.HL();sc=JSON.stringify({access_token:{["xms_cc"]:{values:["cp1"]}}});var Vd=ja.a.We();oa.kX("CAETest",Zb,null,sc).then(Ie=>{const Ue=Math.floor(ja.a.We()-Vd);$c=w[oa.R6];Ed=G.a.aG;Ud=oa.HL();a.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Ue,Ie.IsSuccess,$c,Ie.ErrorCode,Za,Ed,Ud);if(Ie.IsSuccess){Ie="Bearer "+
Ie.Token;var dg=xb.Endpoint;if(dg){var Pf=ja.a.We();Ie={["Authorization"]:Ie};var pc=new Ga.a;pc.add("EnforceCAE","1");pc.add("IsCAEToken","1");dg=pa.a.iif(dg,pc);y.AFrameworkApplication.pe.LMb(dg,1,null,Ie,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(yi=>{var Ei,ok=Math.floor(ja.a.We()-Pf),ji=null;yi.mq?yi="Canceled":yi.wj?yi="Faulted":(ji=yi.result,yi=ji.succeeded?"Completed":"Failed");ok={["TaskResult"]:yi,["BrowserTokenDurationMS"]:Ue,["BrowserValidationDurationMS"]:ok};
ji&&(ok.HttpStatus=ji.args.data.Xe,ji.succeeded&&(ji=db.a(ji.args.data.responseData),ok.ServerValidationDurationMS=ji.ElapsedMilliseconds,ok.ServerValidationResult=ji.ValidatedToken,ok.KMSI=ji.KMSI,ok.Scopes=ji.Scopes,ok.TokenExpirationS=Math.floor(parseInt(ji.Expiration)-(new Date).getTime()/1E3),ok.ClaimChallenge=null===(Ei=ji.ClaimChallenge)||void 0===Ei?void 0:Ei.length));a.ULS.sendTraceTag(508950354,3E3,"Completed"===yi?50:15,ua.a.toJSON(ok))})}}else a.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",
Ie.ErrorCode,Ie.ErrorMessage)}).catch(Ie=>{const Ue=Math.floor(ja.a.We()-Vd);a.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",Ie.toString(),Ue)})}}}}}Qyp(oa){const Za=y.AFrameworkApplication.J.rb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Za){var xb=H.a.D0d;if(xb&&xb.IsEnabled){var Zb=xb.Application,sc=H.a.authority;if(void 0!==Zb&&null!==Zb&&Zb.length&&void 0!==sc&&null!==sc&&sc.length){var $c=
w[oa.R6],Ed=G.a.aG,Ud=oa.HL();try{var Vd=new Map;void 0!==Vd&&null!==Vd?(Vd.set("SupportStatus",$c),Vd.set("Browser",Ed),Vd.set("AuthStrategy",Ud)):Vd=null}catch(Ue){Vd=null}ka.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Vd);var Ie=ja.a.We();oa.kX("Core",Zb).then(Ue=>{const dg=Math.floor(ja.a.We()-Ie);$c=w[oa.R6];Ed=G.a.aG;Ud=oa.HL();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
dg,Ue.IsSuccess,$c,Ue.ErrorCode,Za,Ed,Ud);Vd&&(Vd.set("SupportStatus",$c),Vd.set("Browser",Ed),Vd.set("AuthStrategy",Ud));var Pf=Object.assign(new Ba.a,{durationMs:dg,extendedProperties:Vd});if(Ue.IsSuccess){if(ka.Health.instance.recordKpiSuccess("WacCorePFT",Pf),Pf="Bearer "+Ue.Token,y.AFrameworkApplication.pe.mDb=Pf,y.AFrameworkApplication.pe.oib=Ue.Telemetry.expiresOn?1E3*(Ue.Telemetry.expiresOn-60):null,Ue=xb.Endpoint){var pc=ja.a.We();y.AFrameworkApplication.pe.LMb(Ue,1,null,{["Authorization"]:Pf},
"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(yi=>{var Ei=Math.floor(ja.a.We()-pc),ok=null;yi.mq?yi="Canceled":yi.wj?yi="Faulted":(ok=yi.result,yi=ok.succeeded?"Completed":"Failed");Ei={["TaskResult"]:yi,["BrowserTokenDurationMS"]:dg,["BrowserValidationDurationMS"]:Ei};ok&&(Ei.HttpStatus=ok.args.data.Xe,ok.succeeded&&(ok=db.a(ok.args.data.responseData),Ei.ServerValidationDurationMS=ok.ElapsedMilliseconds,Ei.ServerValidationResult=ok.ValidatedToken,Ei.KMSI=ok.KMSI,Ei.Scopes=ok.Scopes,
Ei.TokenExpirationS=Math.floor(parseInt(ok.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===yi?50:15,ua.a.toJSON(Ei))})}}else ka.Health.instance.recordKpiFailure("WacCorePFT",Ue.ErrorCode,!1,!1,Pf)}).catch(Ue=>{var dg=Math.floor(ja.a.We()-Ie);dg=Object.assign(new Ba.a,{durationMs:dg,extendedProperties:Vd});ka.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Ue.toString(),!1,!1,dg)})}}}}dispose(){}static main(){Ca.a.instance.Rc(new wa)}static qDo(){Ca.a.instance.Rc(new wa,
0,!0)}}Object(f.a)(wa,"OAuthPackage",null,[0,1]);const xa=oa=>{Type.registerNamespace("Common.App.OAuth");oa?wa.qDo():wa.main()};var sa=e(382),Ka=e(373),Na=e(16);class ub{constructor(){new Ka.a}}Object(f.a)(ub,"SdxPaneSuppressionManager",null,[]);var Ua=e(277),sb=e(269),qb=e(126);class ab{constructor(oa){this.C4e=0;this.WLk=oa}Txb(){return this.C4e>=this.WLk}reset(){this.C4e=0}update(){this.C4e++}}Object(f.a)(ab,"NodeCountBasedTaskYieldStrategy",null,[342]);var Xa=e(1837);class wb{constructor(){this.Rqd=
new Set}HFa(oa){this.Rqd.add(oa)}bBp(oa){this.Rqd.delete(oa)}v$n(){return()=>{this.Rqd.forEach(oa=>{oa.onSessionClose()})}}w$n(){return()=>{this.Rqd.forEach(oa=>{oa.onSessionConnect()})}}x$n(){return()=>{this.Rqd.forEach(oa=>{oa.onSessionDisconnect()})}}}Object(f.a)(wb,"AlSessionLifeEventNotifier",null,[315]);var Sa=e(1785),cc=e(92),Cb=e(96),Wa=e(49),Ja=e(772),Va=e(5),mb=e(1417),Ab=e(533),Xb=e(1385),Lb=e(1424),dc=e(1420),yc=e(319),Wc=e(1441),zb=e(1559),cd=e(643),qc=e(963);class Dc{constructor(){this.token=
null}}Object(f.a)(Dc,"ReleaseAnnotationParameters",null,[]);class mc{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(mc,"SetAnnotationMetadataParameters",null,[]);class lc{constructor(){this.id=this.parentPath=null;this.value=0}}Object(f.a)(lc,"SetAnnotationStateParameters",null,[]);var Vb=e(529),yb=e(287),Db=e(482),$b=e(1561),Fa=e(322),lb=e(640),kb=e(7),Ob=e(893);class nc extends Sys.EventArgs{constructor(oa,Za){super();this.annotation=oa;this.annotationState=Za}}Object(f.a)(nc,
"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var zc=e(1842);class Pb extends Sys.EventArgs{constructor(oa){super();this.annotationType=oa}}Object(f.a)(Pb,"AnnotationActivationEventArgs",Sys.EventArgs,[]);var tb=e(1841);class ib{constructor(){this.newState=this.oldState=0;this.handlers=new T.a}}Object(f.a)(ib,"AnnotationResultStateUpdateData",null,[]);var Rb=e(623),gc=e(1007);class xc{constructor(){this.Vkf=this.jbl=this.Xkf=null}}Object(f.a)(xc,"AnnotationCallbacks",null,[]);class Nc{constructor(oa,
Za,xb,Zb,sc,$c){this.pec=null;this.eQc=new Ka.a(0);this.FUc=new Ka.a;this.Wzd=new Ka.a;this.JMd=new Rb.a;this.dkg=null;this.Tk=oa;this.ETa=Za;this.xJ=xb;this.JF=Zb;this.gL=sc;this.Qd=$c}PNp(oa,Za,xb,Zb){this.JF.Npc(oa)&&this.Tk.Ae(()=>{if(!this.pec){this.pec=new Ka.a;var sc=kb.ParagraphReader.ox(Ob.a.getRootNode(),!0,!0);for(const $c of sc)$c&&(sc=$c.ka(Va.a.qd,0))&&(this.pec.add(sc,$c.id),this.eQc.W($c.id.toString(),sc))}this.ETa.ckg(oa,($c,Ed)=>{if($c){var Ud=this.JF.MGi(oa);$c.contentDescriptor.Ry===
Ud&&((Ud=this.TAm($c))?$c.Iob?(Ud=this.Ivf($c,Ud))&&(Ed?xb(Ed,$c.contentDescriptor):Za(Ud,$c.contentDescriptor)):Zb($c.contentDescriptor):this.FVl($c,Object.assign(new xc,{Xkf:Za,jbl:xb,Vkf:Zb})))}})},"PAS:FEPAOT")}TAm(oa){if(3===oa.contentDescriptor.Ry){let Za;return({value:Za}=this.pec.Nc(oa.contentDescriptor.paragraphId)).returnValue?Za:null}if(4===oa.contentDescriptor.Ry)return Wa.a.nil;a.ULS.sendTraceTag(592525442,Nc.Gj,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Frn(oa,
Za){if(3===oa.contentDescriptor.Ry)return Za=this.gL.value.Mb(Za).getValue(Va.a.kk),oa.contentDescriptor.kk===Za;if(4===oa.contentDescriptor.Ry&&Za===Wa.a.nil)return!0;a.ULS.sendTraceTag(592525443,Nc.Gj,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}FVl(oa,Za){if(3===oa.contentDescriptor.Ry){const xb=oa.contentDescriptor.paragraphId;this.FUc.Bb(xb)||this.FUc.add(xb,new T.a);this.FUc.K(xb).add(Zb=>{12===Zb.type&&this.pec.add(xb,Zb.id);oa.Iob?(Zb=this.Ivf(oa,Zb.id))&&Za.Xkf(Zb,
oa.contentDescriptor):Za.Vkf(oa.contentDescriptor)})}else if(4===oa.contentDescriptor.Ry)if(oa.Iob){const xb=this.Ivf(oa,Wa.a.nil);xb&&Za.Xkf(xb,oa.contentDescriptor)}else Za.Vkf(oa.contentDescriptor);else a.ULS.sendTraceTag(592525444,Nc.Gj,15,"DelayCallbackForAnnotation: Unsupported content type")}Ivf(oa,Za){if(this.Frn(oa,Za)){if(Za=this.JF.SYn(oa.Iob,oa.contentDescriptor,Za.toString()))return this.Wzd.W(Za.id,oa.zfb),Za}else this.Qd.isFeatureEnabled(82)&&this.xJ.lVc(oa);return null}pdk(oa,Za){const xb=
this.JF.$8d(oa);xb&&(Za===Lb.a.getTypeName()?this.$wp(oa,xb):this.Kwp(oa,xb))}$wp(oa,Za){this.JF.Npc(oa.annotationType)&&(this.xJ.u1a(this.gL.value,Za,oa.annotationType),this.Wzd.remove(oa.id))}Kwp(oa,Za){if(this.JF.Npc(oa.annotationType)){Za=Object.assign(new gc.a,{Iob:this.JF.nbl(oa),contentDescriptor:Za,annotationType:oa.annotationType});Za=this.xJ.addAnnotation(this.gL.value,Za);this.Wzd.W(oa.id,Za);const xb=this.JF.wPi(oa.annotationType);xb&&this.JMd.contains(xb)&&(this.Tk.Ae(()=>{var Zb=kb.ParagraphReader.ox(Ob.a.getRootNode(),
!0,!0);if(Zb&&0<Zb.count){const sc=new T.a;for(const $c of Zb)(Zb=Nc.sae($c))&&sc.add(Zb);0<sc.count&&this.xJ.iTh(this.gL.value,xb,sc.toArray())}},"PAS:TAOCPA"),this.JMd.remove(xb))}}Cyb(oa){if(this.pec)if(oa){var Za=oa.ka(Va.a.qd,0);if(Za&&(this.eQc.W(oa.id.toString(),Za),({value:Za}=this.FUc.Nc(Za)).returnValue))for(const xb of Za)xb(oa)}else a.ULS.sendTraceTag(592525445,Nc.Gj,10,"OnParagraphNodeConnected: Invalid node")}hsj(oa,Za){if(oa){var xb=oa.id.toString();oa=oa.ka(Va.a.qd,0);var Zb=0;({value:Zb}=
this.eQc.Nc(xb)).returnValue&&(3===Za?(this.FUc.remove(Zb),this.eQc.remove(xb)):2===Za?this.eQc.W(xb,oa):a.ULS.sendTraceTag(592525447,Nc.Gj,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Nc.Gj,10,"UpdatePersistedAnnotations: Invalid node")}DOm(oa){let Za;return({value:Za}=this.Wzd.Nc(oa)).returnValue?Za:Wa.a.nil}dJp(oa,Za,xb){oa?Za?this.ETa.qJi(oa,Zb=>{if(Zb){const Ed=Nc.sae(Za,xb);if(Ed){var sc=Array(Zb.length),$c=!1;for(let Ud=
0;Ud<Zb.length;Ud++)if($c||Ed!==Zb[Ud])sc[Ud]=Zb[Ud];else{const Vd=Nc.sae(Za);if(!Vd)return;$c=!0;sc[Ud]=Vd;Zb[Ud]=Vd}$c&&this.xJ.iTh(this.gL.value,oa,sc)}}}):a.ULS.sendTraceTag(588863697,Nc.Gj,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Nc.Gj,10,"UpdateWorkflowParagraphVersion: null workflowType")}d4o(oa){oa?this.JMd.add(oa):a.ULS.sendTraceTag(588863698,Nc.Gj,10,"SetPendingWorkflow: null workflowType")}xyl(oa){oa?this.JMd.remove(oa):a.ULS.sendTraceTag(588105731,
Nc.Gj,10,"ClearPendingWorkflow: null workflowType")}static sae(oa,Za=0){if(!oa)return null;Za||(Za=oa.ka(Va.a.kk,0));oa=kb.ParagraphReader.fW(oa);if(Za&&oa)return String.format("{0}{1}{2}",oa,Nc.jgo,Za);a.ULS.sendTraceTag(588091606,Nc.Gj,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",Za?"valid":"0",oa?"valid":"0");return null}}Nc.Gj=389;Nc.jgo="-";Object(f.a)(Nc,"PersistedAnnotationStorage",null,[339]);class Kc{constructor(){this.config=this.token=null}}Object(f.a)(Kc,"UpdateAnnotationConfigParameters",
null,[]);var fd=e(153),jd=e(812),Id=e(325),ce=e(1281),Fe=e(1328),Fd=e(246),Qb=e(781),ch=e(2094),Nf=e(1840),Mf=e(888),Df=e(803),Ig=e(327),pg=e(38);class Rf{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg=null,Pf,pc=null,yi=null){this.Wmb=Pf;this.sa=new cc.a;this.tHa=new Ga.a;this.haa=new Ga.a;this.KF=new Ga.a;this.Oec=new Ga.a;this.SNe=new Ga.a;this.TIc=new Vb.a(yb.a.Oh());this.Z5e=new T.a;this.H6b=new Ga.a;this.ONe=new Ga.a;this.Xzd=new Ga.a;this.I6b=new Ga.a;this.iGc=new Ga.a;this.Yzd=new Ga.a;this.kCd=
new Ga.a;this.UKd=[];this.VKd=[];this.eOc=null;this.XLk=new Vb.a(yb.a.Oh());this.QNe=new Map;this.QIc=new Map;this.sHc=null;this.Kqa=new Ga.a;this.b0c=null;this.AEh=this.Ish=0;this.Lfa=this.l7a=null;this.ESl=()=>{if(this.UKd.length||this.VKd.length)try{0<this.UKd.length&&this.YQn(),0<this.VKd.length&&this.wAp()}finally{this.Jyl()}else this.Sb.Kf(this.eOc),this.eOc=null};this.Gyl=()=>{const Ei=new T.a;for(const ok of this.KF.values)if(Ei.add(ok),Ei.count===Rf.fMk)break;for(const ok of Ei)this.TWa(ok),
this.P1b(ok,Lb.a.getTypeName());this.KF.count||(this.Sb.Kf(this.sHc),this.sHc=null)};this.bid=(Ei,ok)=>{for(const ji of ok.yl)Ei=ji.intent,!Ei.type&&this.T9o(Ei.intent,ji.cpBegin,ji.cpEnd,ji.pXb)&&this.TWa(Ei.intent)};this.xGk=oa.$("AugLoopAnnotationsAttachingIsEnabled");this.DSk=oa.kF("SendReleaseMessageAnnotationList")||[];this.Qd=Ie;this.ZRa=dg;this.ETa=$c;this.xJ=Ed;this.xo=xb;this.JF=Ud;this.Hfa=Vd;this.gL=Zb;this.Tk=Za;this.Sb=sc;J.a.instance.resolve("Box4.ICharacterPropertiesEditor").pjf(this.bid);
this.Bq=Ue;this.ttk=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.mGk=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.hIk=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Uuh=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.Wmb&&this.c2m();this.mC=Fd.a.instance;this.Lfa=pc;null!==this.Lfa&&this.Lfa.xNm();
this.Pe=yi}get hHj(){return this.I6b}set hHj(oa){this.I6b=oa}Cb(oa,Za){a.ULS.sendTraceTag(41521862,Rf.Gj,50,"New registration for annotation type: {0}.",Za);this.addHandler(oa,Za);this.$gf(Za).catch(xb=>{a.ULS.sendTraceTag(594396739,Rf.Gj,10,"Failed to activate annotation type {0}: {1}",Za,xb.toString())})}addHandler(oa,Za){if(oa&&Za&&""!==Za){var xb=null;({value:xb}=this.I6b.Nc(Za,xb)).returnValue?xb.add(oa):(xb=new T.a,xb.add(oa),this.I6b.add(Za,xb))}else a.ULS.sendTraceTag(41521861,Rf.Gj,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",
!oa,!Za,""===Za)}Gc(oa,Za){a.ULS.sendTraceTag(41521863,Rf.Gj,50,"Unregister handler for annotation type: {0}.",Za);let xb=null;({value:xb}=this.I6b.Nc(Za,xb)).returnValue&&(xb.remove(oa),xb.count||(a.ULS.sendTraceTag(41521864,Rf.Gj,50,"Unregister all handlers for annotation type: {0}.",Za),this.I6b.remove(Za),this.y1n(Za)))}HVj(oa){this.b0c||(this.b0c=this.Bq.Vc(2),this.b0c.Eb(oa))}Jyl(){var oa;null===(oa=this.b0c)||void 0===oa?void 0:oa.dispose();this.b0c=null}wdi(){this.eOc||(this.eOc=new Cb.a(4,
2,100,this.ESl,141),this.Sb.pc(this.eOc))}YQn(){let oa;oa=Array.dequeue(this.UKd);const Za=Ob.a.cTb(this.gL.value,oa);if(Za)if(Za.ml){this.HVj(Za);var xb=null;if(({value:xb}=this.iGc.Nc(oa,xb)).returnValue){this.iGc.remove(oa);for(const Zb of xb)this.ZQn(Za,Zb)}else a.ULS.sendTraceTag(50663568,Rf.Gj,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.XLk.add(oa);else a.ULS.sendTraceTag(50436127,Rf.Gj,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}ZQn(oa,
Za){try{const xb=Za.content.range,Zb=new $b.a(0,xb.start,xb.start+xb.length,Wa.a.create(),Za,sc=>{this.SNe.W(Za.id,sc.toString())});this.xo.R_a(oa,Zb);Nf.a.QBb(Za,2);this.sa.Cha&&this.sa.raiseEvent(Rf.Yuc,new tb.a(Za,Xb.a.getTypeName()))}catch(xb){Nf.a.kfd(xb,[Za],!0)}}Uhj(oa){const Za=Ob.a.qbb(oa.parentPath);let xb=null;({value:xb}=this.iGc.Nc(Za,xb)).returnValue||(xb=new T.a,this.iGc.add(Za,xb),this.UKd.push(Za));xb.add(oa);this.wdi()}aRn(oa,Za){this.Tk.Ae(()=>{let xb;if(({value:xb}=this.haa.Nc(oa,
xb)).returnValue){var Zb=this.UYj(oa);for(const sc of xb){let $c;({value:$c}=this.KF.Nc(sc,$c)).returnValue&&Za($c)&&Rf.mVb($c)&&(this.Uhj($c),Zb&&this.sa.raiseEvent(Rf.Yuc,new tb.a($c,Lb.a.getTypeName())))}}},"AS:MIFAT")}xAp(oa,Za){this.Tk.Ae(()=>{let xb;if(({value:xb}=this.haa.Nc(oa,xb)).returnValue)for(const Zb of xb){let sc;({value:sc}=this.KF.Nc(Zb,sc)).returnValue&&Za(sc)&&Rf.mVb(sc)&&(this.BOg(sc),Nf.a.QBb(sc,4))}},"AS:UIFAT")}F1n(oa){var Za=Ob.a.QI(oa);let xb=null;if(({value:xb}=this.tHa.Nc(Za,
xb)).returnValue){Za=0;for(var Zb=new T.a;xb.count>Za;){var sc=xb.K(Za),$c=null;({value:$c}=this.KF.Nc(sc,$c)).returnValue&&Rf.mVb($c)?this.JF.msd(oa,$c)?this.TWa($c,!this.Qd.isFeatureEnabled(82)):(sc=$c.content.range,$c=new $b.a(0,sc.start,sc.start+sc.length,Wa.a.create(),$c),Zb.add($c),Za++):Za++}0<Zb.count&&this.xo.Gag(oa,Zb)}}wAp(){let oa=null;try{let Za="";Za=Array.dequeue(this.VKd);const xb=Ob.a.cTb(this.gL.value,Za);xb&&12===xb.type?(this.HVj(xb),({value:oa}=this.Yzd.Nc(Za,oa)).returnValue?
(this.xo.fwd(Zb=>oa.contains(Zb.intent),xb,0)&&oa.toArray().forEach(Zb=>{Nf.a.QBb(Zb,4)}),this.Yzd.remove(Za)):a.ULS.sendTraceTag(50663570,Rf.Gj,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")):a.ULS.sendTraceTag(50436128,Rf.Gj,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}catch(Za){Nf.a.kfd(Za,oa.toArray(),!0)}}BOg(oa){let Za;({value:Za}=this.SNe.Nc(oa.id,Za)).returnValue||(Za=Ob.a.qbb(oa.parentPath));this.SNe.remove(oa.id);var xb=null;({value:xb}=this.Yzd.Nc(Za,
xb)).returnValue||(xb=new T.a,this.Yzd.add(Za,xb),this.VKd.push(Za));xb.add(oa);this.wdi();xb=null;({value:xb}=this.iGc.Nc(Za,xb)).returnValue&&xb.remove(oa)}sge(oa){var Za;return Df.a.ryi&&(null===oa||void 0===oa?0:oa.content)&&Mf.a.typeGuard(oa.content)&&(null===(Za=oa.content)||void 0===Za?0:Za.id)?!0:!1}l3k(oa){const Za=oa.id;var xb=oa.annotationType;const Zb=oa.parentPath;if(this.JF.dwb(oa)){var sc=Ob.a.cbb(this.gL.value,Zb);if(sc&&(sc=sc.ka(Va.a.kk,0).toString(),oa.parentRevId&&sc!==oa.parentRevId))return!1}sc=
null;({value:sc}=this.haa.Nc(xb,sc)).returnValue||(sc=new T.a,this.haa.add(xb,sc));sc.add(Za);xb=null;({value:xb}=this.tHa.Nc(Zb,xb)).returnValue||(xb=new T.a,this.tHa.add(Zb,xb));xb.add(Za);this.KF.add(Za,oa);this.sge(oa)&&this.Oec.add(oa.content.id,Za);this.ONp(oa);return!0}get cie(){return Ig.a.npa&&null!==this.Lfa&&this.Lfa.YPf()}xio(oa){var Za,xb=oa.parentPath;if(this.cie&&Ig.a.Yln(oa)){xb=Ob.a.cbb(this.gL.value,xb);const sc=Ig.a.eln(xb),$c=Ig.a.Asi(xb);if(xb&&!0===sc&&$c<=Ig.a.Vag){const Ed=
xb.ra?xb.ra.length:0;oa=Ig.a.KHl(null===(Za=oa.content)||void 0===Za?void 0:Za.language);Za=null===xb||void 0===xb?void 0:xb.ed;if(oa&&Za)for(Za=0;Za<Ed;Za++){const Ud=xb.ra.jc(Za).formatting;var Zb=Ig.a.Ybm(Ud);if(Ud&&oa!==Zb&&null!==this.Pe){!0===Ig.a.Xbm(Ud)&&Ig.a.jMn(Zb,oa);Ig.a.iMn(oa);Zb=new pg.GraphTransaction(7);Zb.set(qb.a.wf.Um);const Vd=Ja.a.ted(oa);this.Pe.qm(Ud,Ig.a.fEm(Vd),oa);this.Pe.qm(Ud,Va.a.r_a,Vd);Zb.dispose()}}}xb&&!0===sc&&$c>Ig.a.Vag&&Ig.a.eKn()}}ONp(oa){const Za=this.JF.fyi(oa);
if(0===Za.length)this.zli(oa);else{let xb=!1;this.ETa.l8n(Za,oa.annotationType,(Zb,sc)=>{this.KF.Bb(oa.id)?(sc=this.JF.xwb(oa,Ob.a.kom(oa)),!Zb&&sc?(y.AFrameworkApplication.ud("3c7ef686;a13cd815"),this.osn&&(xb=!1),this.OPg(oa,10,!1)):Zb&&this.OPg(oa,Zb),xb||(this.zli(oa),xb=!0)):sc.u2a=!0})}}get osn(){if(null!=this.W3g)var oa=this.W3g;else{var Za;oa=this.W3g=null===(Za=y.AFrameworkApplication.J)||void 0===Za?void 0:Za.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreAllFix",!1)}return oa}zli(oa){const Za=
Rf.mVb(oa);Za&&this.Uhj(oa);!Za&&this.sa.Cha&&this.sa.raiseEvent(Rf.Yuc,new tb.a(oa,Xb.a.getTypeName()))}Nak(oa,Za,xb,Zb){let sc=!0;this.Tk.Ae(()=>{if(Zb.startsWith(Ob.a.qQb)){var $c=oa.id,Ed=null;if(Za===Lb.a.getTypeName())this.TWa(oa);else if(({value:Ed}=this.KF.Nc($c,Ed)).returnValue)a.ULS.sendTraceTag(41418891,Rf.Gj,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",$c,oa.annotationType),this.KF.W($c,oa);else if(this.xio(oa),!this.l3k(oa)){sc=!1;return}xb&&Za===Xb.a.getTypeName()&&
Zb!==Ob.a.qQb&&this.Z5e.add(oa.annotationType)}this.P1b(oa,Za)},"AS:UAS");return sc}k_o(oa){if(oa)for(const Za of oa)this.P1b(Za,dc.a.getTypeName()),oa=Za.content,this.kCd.Bb(oa.categoryName)?this.kCd.W(oa.categoryName,Za):this.kCd.add(oa.categoryName,Za);else a.ULS.sendTraceTag(592802119,Rf.Gj,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}GUh(oa){this.sa.addHandler(Rf.Yuc,oa)}FUh(oa){this.sa.addHandler(Rf.Eoj,oa)}Mpc(oa){return this.H6b.Bb(oa)}Q6k(oa){this.sa.addHandler(Rf.mpe,
oa)}EIo(oa){this.sa.removeHandler(Rf.mpe,oa)}UYj(oa){return!Ob.a.jg(oa)&&lb.a(oa)&&this.sa.Cha}TWa(oa,Za=!0){if(this.KF.Bb(oa.id)){var xb=this.KF.K(oa.id);this.sge(oa)&&this.Oec.remove(oa.content.id);this.KF.remove(oa.id);var Zb=null;({value:Zb}=this.tHa.Nc(oa.parentPath,Zb)).returnValue?(Zb.remove(oa.id),Rf.mVb(xb)&&this.BOg(xb)):a.ULS.sendTraceTag(50734169,Rf.Gj,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Zb=null;({value:Zb}=this.haa.Nc(oa.annotationType,Zb)).returnValue?
Zb.remove(oa.id):a.ULS.sendTraceTag(50734170,Rf.Gj,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.UYj(oa.annotationType)?this.sa.raiseEvent(Rf.Yuc,new tb.a(xb,Lb.a.getTypeName())):this.P1b(oa,Lb.a.getTypeName());Za&&this.Hfa.pdk(xb,Lb.a.getTypeName())}}bKf(oa,Za,xb=!1){const Zb=new T.a;var sc;if(!({value:sc}=this.haa.Nc(oa,sc)).returnValue)return Zb;for(const $c of sc)this.KF.Bb($c)?(oa=this.KF.K($c),(sc=this.JF.$8d(oa))&&(Za.equals(sc)||xb&&Za.overlaps(sc))&&
Zb.add(oa)):a.ULS.sendTraceTag(577843217,Rf.Gj,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",$c);return Zb}y2d(oa){let Za=null;if(({value:Za}=this.haa.Nc(oa,Za)).returnValue){oa=Za.toArray();for(const xb of oa){let Zb;({value:Zb}=this.KF.Nc(xb,Zb)).returnValue&&this.TWa(Zb)}}}oon(oa){return yc.a.getTypeNameFor(oa)===Id.a.getTypeName()}S0i(oa){var Za,xb;return(null===(xb=null===(Za=this.Wmb)||void 0===Za?void 0:Za.IGi)||void 0===xb?void 0:xb.call(Za))===jd.a.dFc&&
oa&&0===oa.priority?this.Wmb.Gud(oa.context.substr(oa.startInContext,oa.range.length)):!1}XBj(oa,Za){this.Tk.Ae(()=>{a.ULS.k6(Rf.Gj,100)&&a.ULS.sendTraceTag(41418894,Rf.Gj,100,"Operation of type {0} with path {1} received",yc.a.getTypeNameFor(oa),oa.parentPath.join("\\"));try{const xb=new zc.a(oa);for(const Zb of xb.annotations)if(Zb.annotationType===Fe.b.getTypeName()){const sc=Zb.content.results.map($c=>{var Ed;const Ud=null===(Ed=$c.M_)||void 0===Ed?void 0:Ed.seq;Ed=void 0===Ud?Zb.id:Zb.id+"_"+
Ud;return{id:Ed,body:{...$c,id:Ed},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.XBj({items:sc,parentPath:oa.parentPath,parentRevId:oa.parentRevId,H_:oa.H_},Za)}else xb.GVd===Xb.a.getTypeName()&&this.Nbp(Zb)?(y.AFrameworkApplication.ud("g8469255;j5hhe441"),this.Uuh&&(this.l7a||(this.l7a=Qb.a.IB()),this.Ish++,this.l7a.cUd("AnnotationSkippedDueToInvalidContextCount",this.Ish.toString()))):this.r8c(Zb,Za,xb.GVd,!0)}catch(xb){a.ULS.sendTraceTag(41418898,Rf.Gj,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",
xb.message,xb.stack)}},"AS:PO")}Nbp(oa){var Za;y.AFrameworkApplication.ud("01dfc961;05c12706");if(this.hIk&&lb.a(oa.annotationType)){var xb;let sc=xb=null;if(this.mC){xb=this.mC.dha;var Zb=null===xb||void 0===xb?void 0:xb.node;xb=Ob.a.qbb(oa.parentPath);if(Ob.a.cTb(this.gL.value,xb)!==Zb)return!1;oa=oa.content;xb=oa.context.substring(oa.startInContext,oa.startInContext+oa.range.length);sc=null===(Za=null===Zb||void 0===Zb?void 0:Zb.characterData)||void 0===Za?void 0:Za.substring(oa.range.start,oa.range.start+
oa.range.length);this.Uuh&&oa&&0===oa.priority&&(Za=0<oa.range.start?Zb.characterData.charAt(oa.range.start-1):null,Zb=oa.range.start+oa.range.length<Zb.characterData.length?Zb.characterData.charAt(oa.range.start+oa.range.length):null,"en-us"==oa.language.toLocaleLowerCase()&&sc&&xb&&sc===xb&&(Za&&Za.match("[A-Za-z0-9]")||Zb&&Zb.match("[A-Za-z0-9]"))&&(this.l7a||(this.l7a=Qb.a.IB()),this.AEh++,this.l7a.cUd("partialWordAnnotationsCount",this.AEh.toString())))}return sc&&xb&&sc!==xb?!0:!1}return!1}r8c(oa,
Za,xb,Zb){if(this.oon(oa.content)&&this.S0i(oa.content))this.Nea(oa,70);else{var sc=oa.parentPath;xb!==Lb.a.getTypeName()&&Zb||this.THj(oa);Zb&&xb===Xb.a.getTypeName()&&lb.a(oa.annotationType)&&oa.content.isHotCritique&&this.mGk?this.QIc.set(oa.id,{annotation:oa,time:Date.now()}):(Zb=oa.annotationType,Ob.a.jg(Zb)||Zb!==Wc.a.getTypeName()?!Ob.a.jg(Zb)&&lb.a(Zb)&&oa.content&&0==oa.content.priority&&fd.a.y9?(oa=Ob.a.qbb(sc))&&oa==fd.a.zmm()&&a.ULS.sendTraceTag(539870169,Rf.Gj,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):
xb!==Lb.a.getTypeName()&&this.TIc.contains(sc)?a.ULS.sendTraceTag(41418897,Rf.Gj,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",sc,oa.id):this.Lak(oa,sc,xb,Za):a.ULS.sendTraceTag(595342670,Rf.Gj,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",sc))}}FFo(oa){if(oa&&oa.annotationType&&this.JF.Npc(oa.annotationType)){var Za;if(({value:Za}=this.haa.Nc(oa.annotationType,Za)).returnValue&&(oa=this.JF.$8d(oa)))for(const xb of Za){let Zb;
({value:Zb}=this.KF.Nc(xb,Zb)).returnValue&&(Za=this.JF.$8d(Zb))&&(oa.equals(Za)||oa.overlaps(Za))&&this.TWa(Zb)}}}P1b(oa,Za){this.Tk.Ae(()=>{let xb=null;if(({value:xb}=this.hHj.Nc(oa.annotationType,xb)).returnValue)for(const Zb of xb)Zb.XI(oa,Za)},"AS:SATH")}Fyl(){a.ULS.sendTraceTag(50860999,Rf.Gj,50,"ClearStorage: Initiated Clearing Storage");this.sHc||(this.sHc=new Cb.a(4,2,100,this.Gyl,142),this.Sb.pc(this.sHc))}activateAnnotation(oa,Za){let xb;if(({value:xb}=this.Xzd.Nc(oa,xb)).returnValue){if(xb.contains(Za))return Promise.resolve(null);
xb.add(Za)}else{let Zb;this.Xzd.add(oa,(Zb=new T.a,Zb.add(Za),Zb))}return this.$gf(oa)}$gf(oa){a.ULS.sendTraceTag(41521865,Rf.Gj,50,"ActivateAnnotation: Activating annotation type {0}.",oa);if(this.H6b.Bb(oa))return Promise.resolve(null);var Za=null;if(({value:Za}=this.ONe.Nc(oa,Za)).returnValue)return Za;this.v_k(oa);if(Za=this.ZRa?this.ZRa():null){const xb=new qc.a;xb.annotationType=oa;this.ttk&&(this.Kqa.Bb(oa)||this.Kqa.W(oa,new ib),xb.stateUpdateHandler=(Zb,sc)=>{this.Kqa.K(oa).oldState=Zb;this.Kqa.K(oa).newState=
sc;for(const $c of this.Kqa.K(oa).handlers)$c(oa,Zb,sc)});Za=Za.activateAnnotation(xb);this.ONe.add(oa,Za);return Za.then(Zb=>{this.ONe.remove(oa);this.H6b.add(oa,Zb.token);this.Mak(Zb.token,oa);this.sa.raiseEvent(Rf.mpe,new Pb(oa,!0));this.a2m(oa);return Zb})}return Promise.reject(Error.create("Error during annotation activation"))}a2m(oa){const Za=this.JF.wPi(oa);Za&&this.ETa.qJi(Za,xb=>{if(this.Hfa.dkg){var Zb=kb.ParagraphReader.ox(Ob.a.getRootNode(),!0,!0);if(Zb&&0<Zb.count){let sc=0;for(const $c of Zb){Zb=
Nc.sae($c);if(!Zb)continue;let Ed=!1;for(;sc<xb.length;){if(Zb===xb[sc]){Ed=!0;break}sc++}if(!Ed){this.Hfa.dkg(Za);break}sc++}}}})}v_k(oa){this.Hfa.PNp(oa,(Za,xb)=>{0<this.bKf(oa,xb,!0).count||this.Nak(Za,Xb.a.getTypeName(),!0,Za.parentPath)},(Za,xb)=>{if(3!==xb.Ry)a.ULS.sendTraceTag(591541786,Rf.Gj,15,"Annotation moved to unsupported location type: {0}",xb.Ry);else if(Za.Ry!==xb.Ry)a.ULS.sendTraceTag(591541787,Rf.Gj,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",
Za.Ry,xb.Ry);else{Za=this.bKf(oa,Za);for(const sc of Za){const $c=sc.content;Za=Ob.a.cbb(this.gL.value,sc.parentPath);if(!Za){a.ULS.sendTraceTag(591541788,Rf.Gj,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.xo.fwd(Ed=>Ed.intent===$c,Za,0))break;var Zb=xb.nBa;Zb=new $b.a(0,Zb,Zb+xb.mBa,null,$c);this.xo.R_a(Za,Zb)}}},Za=>{for(const xb of this.bKf(oa,Za))this.TWa(xb,!1)})}releaseAnnotation(oa,Za){let xb;if(({value:xb}=this.Xzd.Nc(oa,xb)).returnValue){xb.contains(Za)&&
xb.remove(Za);if(0<xb.count)return Promise.resolve(!1);this.Xzd.remove(oa)}a.ULS.sendTraceTag(593790408,Rf.Gj,50,"ReleaseAnnotation: Releasing annotation type {0}.",oa);return this.DRj(oa)}y1n(oa){var Za=null;if(({value:Za}=this.haa.Nc(oa,Za)).returnValue){a.ULS.sendTraceTag(41418899,Rf.Gj,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",oa);for(const xb of Za)if(Za=null,({value:Za}=this.KF.Nc(xb,Za)).returnValue){const Zb=Za.parentPath;let sc=null;({value:sc}=this.tHa.Nc(Zb,
sc)).returnValue&&(sc.remove(xb),sc.count||this.tHa.remove(Zb));this.sge(Za)&&this.Oec.remove(Za.content.id);this.KF.remove(xb);Rf.mVb(Za)&&this.BOg(Za)}this.haa.remove(oa)}Array.contains(this.DSk,oa)&&this.DRj(oa)}DRj(oa){let Za=null;const xb=this.ZRa?this.ZRa():null;if(xb){if(({value:Za}=this.H6b.Nc(oa,Za)).returnValue){const Zb=new Dc;Zb.token=Za;this.H6b.remove(oa);this.sa.raiseEvent(Rf.mpe,new Pb(oa,!1));return xb.releaseAnnotation(Zb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}nbj(){this.Tk.Ae(()=>
{if(this.xGk){var oa=Ob.a.getRootNode();if(oa){var Za=new Ga.a;Db.f(oa,xb=>{var Zb=Ob.a.QI(xb),sc=null;if(({value:sc}=this.tHa.Nc(Zb,sc)).returnValue)for(const $c of sc)Zb=null,({value:Zb}=this.KF.Nc($c,Zb)).returnValue&&(Zb.parent=xb,Zb.Zvb=!0,Zb.UZb=2,Za.Bb(Zb.annotationType)||Za.W(Zb.annotationType,new T.a),Za.K(Zb.annotationType).add($c),sc=null,({value:sc}=this.haa.Nc(Zb.annotationType,sc)).returnValue&&sc.remove(Zb.id));return!0},12);for(const xb of this.haa.keys)if(oa=null,({value:oa}=this.haa.Nc(xb,
oa)).returnValue)for(const Zb of oa)if(oa=null,({value:oa}=this.KF.Nc(Zb,oa)).returnValue){let sc=null;oa.parentPath===Ob.a.qQb?(oa.UZb=1,oa.parent=null):({value:sc}=this.KF.Nc(oa.parentPath,sc)).returnValue?(oa.UZb=3,oa.parent=sc):(oa.UZb=0,oa.parent=null,a.ULS.sendTraceTag(41554060,Rf.Gj,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",oa.id));oa.Zvb=!0;Za.Bb(oa.annotationType)||Za.W(oa.annotationType,new T.a);Za.K(oa.annotationType).add(Zb)}else a.ULS.sendTraceTag(41997840,
Rf.Gj,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Zb);else a.ULS.sendTraceTag(41997841,Rf.Gj,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",xb);this.haa=Za;this.Z5e.clear()}else a.ULS.sendTraceTag(41554058,Rf.Gj,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,Rf.Gj,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}mbl(oa){this.XBj(oa,!0)}tao(oa,
Za){this.Tk.Ae(()=>{const xb=Za?Za+String.format("\\{0}",oa.id):Ob.a.QI(oa);a.ULS.sendTraceTag(41418900,Rf.Gj,50,"OnTileDeleted: Tile delete event received for tile {0}.",xb);this.TIc.contains(xb)||this.TIc.add(xb);var Zb=null;if(({value:Zb}=this.tHa.Nc(xb,Zb)).returnValue){a.ULS.sendTraceTag(41418901,Rf.Gj,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Zb.count,xb);for(const sc of Zb)Zb=null,({value:Zb}=this.KF.Nc(sc,Zb)).returnValue&&(this.P1b(Zb,Lb.a.getTypeName()),this.sa.Cha&&
this.sa.raiseEvent(Rf.Yuc,new tb.a(Zb,Lb.a.getTypeName())),this.sge(Zb)&&this.Oec.remove(Zb.content.id),this.KF.remove(sc));this.tHa.remove(xb)}},"AS:OTD")}sao(oa){oa=Ob.a.QI(oa);this.TIc.remove(oa)&&a.ULS.sendTraceTag(41418902,Rf.Gj,50,"OnTileAdded: Deleted tile {0} was re-added.",oa)}fHp(oa){if(oa){a.ULS.sendTraceTag(50436131,Rf.Gj,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",oa.count);var Za=new Ga.a;for(var xb of oa)oa=null,({value:oa}=Za.Nc(xb.parentPath,oa)).returnValue||
(oa=new Ga.a,Za.add(xb.parentPath,oa)),oa.W(xb.id,xb);for(const Zb of Za){Za=Ob.a.cbb(this.gL.value,Zb.key);if(!Za){a.ULS.sendTraceTag(50436160,Rf.Gj,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}xb=new Fa.a([0]);for(let sc=0,$c=Za.ra.length;sc<$c;sc++)oa=Za.ra.jc(sc),oa.yl&&xb.w3a(oa.yl,void 0,(Ed,Ud)=>{if(Ud){var Vd=null,Ie=Ud.intent;Ie&&({value:Vd}=Zb.value.Nc(Ie.id,Vd)).returnValue&&(Ie=new zb.a,Ie.start=Ud.Rb.cp,Ie.length=Ed.Rb.cp-Ie.start,Vd.content.range=Ie,Vd.uia=
!1)}})}}else a.ULS.sendTraceTag(50436130,Rf.Gj,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(oa){a.ULS.sendTraceTag(593049729,Rf.Gj,50,"GetAnnotationsByType: Method called for type {0}.",oa);return this.$gf(oa).then(()=>{const Za=new T.a;this.Tk.Ae(()=>{if(Ob.a.jg(oa)||oa!==Wc.a.getTypeName()){this.Z5e.contains(oa)&&this.nbj();var xb=null;if(({value:xb}=this.haa.Nc(oa,xb)).returnValue){a.ULS.sendTraceTag(41418903,Rf.Gj,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",
oa);var Zb=new T.a;for(const sc of xb)xb=null,({value:xb}=this.KF.Nc(sc,xb)).returnValue&&(xb.uia&&Zb.add(xb),Za.add(xb));Zb&&0<Zb.count&&Rf.mVb(Zb.K(0))&&this.fHp(Zb)}}else for(Zb of this.kCd.values)Za.add(Zb);Za.count||a.ULS.sendTraceTag(41418904,Rf.Gj,50,"GetAnnotationsByType: No annotations found for type {0}!",oa)},"AS:GABT");return Za},Za=>{a.ULS.sendTraceTag(41418905,Rf.Gj,10,"Exception occurred while fetching annotations of type {0}: {1}",oa,Za);return null})}getAnnotationById(oa){let Za=
null;return({value:Za}=this.KF.Nc(oa,Za)).returnValue?Za:null}Qxi(oa){let Za=null;return({value:Za}=this.Oec.Nc(oa,Za)).returnValue?(oa=null,({value:oa}=this.KF.Nc(Za,oa)).returnValue?oa:null):null}i8d(oa){let Za=null;if(this.tHa.Bb(oa))for(const xb of this.tHa.K(oa))if(oa=this.getAnnotationById(xb))Za||(Za=new T.a),Za.add(oa);return Za}y_a(oa){return(oa=this.getAnnotationById(oa))?(oa.Zvb||this.nbj(),oa):null}Nea(oa,Za){this.X5o(oa,Za);this.OPg(oa,Za);this.P1b(oa,dc.a.getTypeName())}lCp(oa,Za){this.aGp(oa,
Za);this.c3o(oa,Ob.a.jom(oa));this.P1b(oa,dc.a.getTypeName())}mCp(oa,Za){oa=this.JF.fyi(oa);for(const xb of oa)this.xJ.yPg(this.gL.value,xb,Za)}X5o(oa,Za){const xb=this.ZRa?this.ZRa():null;xb&&(oa=this.lom(oa,Za))&&xb.setAnnotationState(oa)}OPg(oa,Za,xb=!0){if(oa&&Rf.H_i(oa)){var Zb=this.getAnnotationById(oa.id);!oa.content||Zb&&oa.content===Zb.content||Ob.a.setAnnotationState(oa,Za);Zb&&Zb.content&&Ob.a.setAnnotationState(Zb,Za);xb&&this.sa.Cha&&(70===Za||60===Za)&&this.sa.raiseEvent(Rf.Eoj,new nc(oa,
Za))}}lom(oa,Za){let xb=null;oa&&(xb=Object.assign(new lc,{id:oa.id,value:Za}),Ob.a.jg(oa.parentPath)||(xb.parentPath=oa.parentPath.split("\\")));return xb}c3o(oa,Za){const xb=this.ZRa?this.ZRa():null;xb&&(oa=this.iom(oa,Za))&&xb.setAnnotationMetadata(oa)}aGp(oa,Za){if(oa&&Rf.H_i(oa)){var xb=this.getAnnotationById(oa.id);!oa.content||xb&&oa.content==xb.content||Ob.a.lSj(oa,Za);xb&&xb.content&&Ob.a.lSj(xb,Za)}}iom(oa,Za){if(!oa)return null;const xb=new mc;xb.id=oa.id;xb.value=Za;Ob.a.jg(oa.parentPath)||
(xb.parentPath=oa.parentPath.split("\\"));return xb}T9o(oa,Za,xb,Zb){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)&&(oa.annotationType===ch.b.getTypeName()||oa.annotationType===ch.d.getTypeName()))return!1;const sc=oa.content;if(this.JF.dwb(oa)&&sc){const $c=sc.range.start+sc.range.length;if(0<Zb&&$c<=xb||0>Zb&&$c<=xb+Zb)return!1;if(0<Zb&&sc.range.start>=Za||0>Zb&&sc.range.start>=xb)return sc.range.start+=Zb,!1}return!this.Qd.isFeatureEnabled(54)&&
sc&&sc.M_?(oa=this.JF.xwb(oa,60),!(60===sc.M_.state&&oa)):!0}WRh(oa,Za){this.Kqa.Bb(Za)||this.Kqa.W(Za,new ib);this.Kqa.K(Za).handlers.add(oa);oa(Za,this.Kqa.K(Za).oldState,this.Kqa.K(Za).newState)}CHj(oa,Za){this.Kqa.Bb(Za)&&this.Kqa.K(Za).handlers.contains(oa)&&this.Kqa.K(Za).handlers.remove(oa)}static H_i(oa){oa=yc.a.getBaseTypesFor(oa.content);return Array.contains(oa,Ab.a.getTypeName())}static mVb(oa){if(void 0===oa.content||null===oa.content||""===Ob.a.qbb(oa.parentPath))return!1;const Za=yc.a.getBaseTypesFor(oa.content);
return Array.contains(Za,cd.a.getTypeName())&&oa.annotationType!==mb.RoleDetectionAnnotation.getTypeName()}kCp(oa){oa?(this.QNe.AugLoop_Text_Critique=oa,oa=this.Mpc("AugLoop_Text_Critique")?this.H6b.K("AugLoop_Text_Critique"):null,this.Mak(oa,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Rf.Gj,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}Mak(oa,Za){if(oa&&this.QNe[Za]){const xb=new Kc;xb.token=oa;xb.config=this.QNe[Za];this.ZRa&&(this.ZRa().updateAnnotationConfig(xb),
a.ULS.sendTraceTag(540615553,Rf.Gj,50,"Annotation configuration has been updated for annotation type: {0}.",Za))}}THj(oa){let Za=null;({value:Za}=this.KF.Nc(oa.id,Za)).returnValue&&(oa.annotationType=Za.annotationType);this.QIc.has(oa.id)&&this.QIc.delete(oa.id)}Lak(oa,Za,xb,Zb){this.FFo(oa);this.Nak(oa,xb,Zb,Za)&&this.Hfa.pdk(oa,xb)}u1a(oa){const Za=oa.parentPath,xb=Lb.a.getTypeName();this.THj(oa);this.Nea(oa,70);this.TIc.contains(Za)||this.Lak(oa,Za,xb,!0)}KFm(oa){const Za=new T.a;oa=this.haa.Nc(oa).value;
if(null===oa)return Za;for(const xb of oa)oa=this.KF.Nc(xb).value,null!==oa&&Za.push(oa);return Za}async c2m(){await Object(ce.b)();this.OHj()}OHj(){const oa=this.KFm(Id.a.getTypeName());for(const Za of oa)this.S0i(Za.content)&&this.u1a(Za)}}Rf.Gj=389;Rf.Yuc="OnAnnotationOperation";Rf.Eoj="OnAnnotationLocalStateChange";Rf.mpe="OnAnnotationActivationChange";Rf.fMk=20;Object(f.a)(Rf,"AnnotationStorage",null,[340]);class qf{constructor(){this.Mze=null;this.wsd=!1}}Object(f.a)(qf,"AugmentationLoopStateManager",
null,[338]);var Mh=e(160),ed=e(596),dd=e(119),Vh=e(616),Gf=e(459),Td=e(262);class Xc extends Td.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}Hn(){return Gf.a.$Uo}static construct(oa,Za,xb,Zb,sc,$c){const Ed=new Xc;Ed.ExpectedEndRevisionId=oa;Ed.OriginString=Za;Ed.Authorization=
xb;Ed.AugLoopSeedUrl=Zb;Ed.FileId=sc;Ed.SeedBatchesInParallelIsEnabled=$c;Ed.AddDocumentKindTypeToPathIsEnabled=!0;Ed.CheckOnDemandNodeVersionEnabled=!0;Ed.AddSubDocumentKindTypeToPathIsEnabled=!0;return Ed}}Object(f.a)(Xc,"FullFileAugLoopSeedingRequest",Td.a,[]);class de{constructor(){this.authToken=this.url=this.originString=null}}Object(f.a)(de,"ReseedingTaskInfo",null,[]);var ze=e(18);class jf{constructor(oa,Za,xb,Zb,sc,$c){this.OG=null;this.xoh=!1;this.C8b=null;this.z9e=0;this.wld=(Ed,Ud)=>{Ed=
Ud.qga;this.C8b&&dd.AT(Ed,Vd=>Vd===this.C8b)&&(Ud.httpStatusCode!==Mh.a.jB||Ud.Xj||2!==Ud.Dte?Ud.httpStatusCode!==Mh.a.jB||Ud.Xj||1!==Ud.Dte?this.iNj(()=>{a.ULS.sendTraceTag(50861003,jf.Gj,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",Ud.httpStatusCode,Ud.Xj,Ud.Dte,Ud.Cm)}):(this.vS.wsd=!1,this.OG.nod(this.wld),this.ff.Fyl(),a.ULS.sendTraceTag(50861002,jf.Gj,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),
Ed=Object(N.a)(de,this.C8b),this.vDj(Ud.uNj,Ed.originString,Ed.url,Ed.authToken)):this.iNj(()=>{a.ULS.sendTraceTag(50861001,jf.Gj,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.Mcm=Ed=>{if(void 0===Ed||null===Ed||void 0===Ed.data||null===Ed.data||void 0===Ed.data.responseData||null===Ed.data.responseData)a.ULS.sendTraceTag(41445393,jf.Gj,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Ed.data.Xe!==
Mh.a.jB)a.ULS.sendTraceTag(41445394,jf.Gj,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Ed.data.Xe);else try{let Ud;({group:Ud}=ed.a.A6(Ed.data.responseData)).returnValue?Ud.Responses&&Ud.Responses.length?(Ed=null,Ud&&Ud.Responses&&Ud.Responses.length&&(Ed=Ud.Responses[0])?(this.zJ.r3a(Ed),Ed.StatusCode?a.ULS.sendTraceTag(41445398,jf.Gj,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Ed.StatusCode):a.ULS.sendTraceTag(41445399,
jf.Gj,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Ed.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,jf.Gj,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,jf.Gj,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,jf.Gj,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(Ud){a.ULS.sendTraceTag(41445400,
jf.Gj,10,"FileSeedingSuccessCallback: {0}",Ud.message)}};this.Lcm=Ed=>{void 0===Ed||null===Ed||void 0===Ed.data||null===Ed.data||void 0===Ed.data.responseData||null===Ed.data.responseData?a.ULS.sendTraceTag(41445401,jf.Gj,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,jf.Gj,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Ed.data.Xe)};this.ruk=oa.$("AugLoopServerSideSeedingIsEnabled");
this.puk=oa.$("AugLoopReseedingIsEnabled");this.quk=oa.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.Zzh=oa.sc("MaxReseedingRetries",1);this.$f=Za;this.lGd=xb;this.vS=Zb;this.zJ=sc;this.ff=$c;ze.StaticActiveAppFrame.Aa()&&ze.StaticActiveAppFrame.Aa().tb&&ze.StaticActiveAppFrame.Aa().tb.rd&&ze.StaticActiveAppFrame.Aa().tb.rd.Jg&&(this.OG=ze.StaticActiveAppFrame.Aa().tb.rd.Jg)}sfn(oa,Za,xb){if(this.ruk){var Zb=this.vS.Mze;Zb&&Zb.trim().length?this.xoh?this.puk&&(a.ULS.sendTraceTag(50861E3,jf.Gj,
50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.z9e=0,this.OG?(this.vS.wsd=!0,this.OG.dfc(this.wld),this.C8b=Object.assign(new de,{originString:oa,url:Za,authToken:xb}),this.OG.DC(null,null,this.C8b)):a.ULS.sendTraceTag(592814793,jf.Gj,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,jf.Gj,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.vDj(Zb,oa,Za,xb),this.xoh=!0):a.ULS.sendTraceTag(41445391,jf.Gj,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
jf.Gj,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}iNj(oa){this.z9e<this.Zzh?(a.ULS.sendTraceTag(594384E3,jf.Gj,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.z9e,this.Zzh),this.OG.DC(null,null,this.C8b)):(this.vS.wsd=!1,this.OG.nod(this.wld),oa())}vDj(oa,Za,xb,Zb){const sc=Xc.construct(oa,Za,Zb,xb,y.AFrameworkApplication.rootQuerySignature,this.quk);
a.ULS.sendTraceTag(595178454,jf.Gj,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.lGd.Xbb.execute(()=>{this.H4k(sc)})}H4k(oa){a.ULS.sendTraceTag(595178453,jf.Gj,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.$f.addRequest(qb.a.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Vh.b(oa),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.Mcm,this.Lcm,oa);a.ULS.sendTraceTag(42016906,
jf.Gj,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}jf.Gj=389;Object(f.a)(jf,"FullFileAugLoopSeedingService",null,[]);class hc{constructor(){}}Object(f.a)(hc,"RuntimeManagerInitializationTracker",null,[]);class wc{getAugLoopRuntimeManager(){return Qb.a.IB()}}Object(f.a)(wc,"AlFactoryWrapper",null,[337]);class Pc{Km(){return Ob.a.Km()}}Object(f.a)(Pc,"UtilsWrapper",null,[336]);var md=e(670),fe=e(1193);class se extends Sys.EventArgs{constructor(oa){super();this.foc=oa}}Object(f.a)(se,
"HasNodeEventsEventArgs",Sys.EventArgs,[]);class $d extends Sys.EventArgs{constructor(oa){super();this.$ca=oa}}Object(f.a)($d,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Md{constructor(oa,Za,xb){this.nhd=oa;this.graphNode=Za;this.fullPath=xb}}Object(f.a)(Md,"NodeEvent",null,[363]);class Ub{constructor(){this.EZe=this.nXe=!1;this.ZHb=null;this.sa=new cc.a;this.Cfa=new Ka.a(0);this.Kkb=new fe.a(yb.a.Oh());this.OIb=new fe.a(yb.a.Oh());this.TKd=[]}xUh(oa){this.sa.addHandler("IsCollectingNodeEventsChangedKey",
oa)}nyl(){this.Cfa=new Ka.a(0);this.foc=!1}get foc(){return this.nXe}set foc(oa){this.nXe!==oa&&(this.nXe=oa,this.sa.raiseEvent("HasNodeEventsChangedKey",new se(oa),this))}get $ca(){return this.EZe}set $ca(oa){this.EZe!==oa&&(this.EZe=oa,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new $d(oa),this))}D1b(oa,Za){this.Kkb.Bb(oa)||this.Kkb.W(oa,Za)}TSo(oa,Za){this.OIb.W(oa,Za)}com(oa){let Za=null;this.OIb.Bb(oa)&&(Za=this.OIb.K(oa),this.OIb.remove(oa));return Za}Zwe(oa,Za){if(oa)if(this.$ca){var xb=
3!==Za&&4!==Za&&5!==Za||!this.Kkb.Bb(String.format("{0}",oa.id))?Ob.a.QI(oa):this.Kkb.K(String.format("{0}",oa.id));if(({value:Zb}=this.Cfa.Nc(xb)).returnValue)if(Zb||3!==Za)if(5===Zb&&3===Za){if(oa=xb.split("\\").pop(),this.OIb.Bb(oa)){var Zb=this.OIb.K(oa);Zb===xb?(this.A$f(xb,Za),this.Cfa.add(xb,Za)):(this.OIb.W(oa,xb),this.Kkb.W(oa,Zb),this.Vfj(xb),this.Cfa.remove(xb),this.A$f(xb,Za),this.Cfa.add(Zb,5))}}else Zb&&(4!==Zb||0!==Za&&3!==Za&&5!==Za)&&(this.A$f(xb,Za),this.Cfa.add(xb,Za));else this.Vfj(xb),
this.Cfa.remove(xb);else this.zOn(xb,Za),this.TKd.push(oa),this.Cfa.add(xb,Za);this.foc=0<this.Cfa.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}zOn(oa,Za){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",oa,Za)}A$f(oa,Za){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",oa,Za)}Vfj(oa){a.ULS.sendTraceTag(593761367,
389,100,"Removing node {0} form _nodeIdEventKindMap.",oa)}tFl(){let oa=null;var Za=!1;let xb=null;for(;this.TKd.length&&!Za;){xb=Array.dequeue(this.TKd);if(!xb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.Kkb.Bb(String.format("{0}",xb.id))?(oa=this.Kkb.K(String.format("{0}",xb.id)),this.Kkb.remove(String.format("{0}",xb.id)),this.TKd.push(xb)):oa=Ob.a.QI(xb);Za=this.Cfa.Bb(oa)}if(!Za)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),
this.nyl(),null;Za=this.Cfa.K(oa);this.Cfa.remove(oa);this.foc=0<this.Cfa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",oa,Za);return new Md(Za,xb,oa)}Jyo(oa){this.ZHb=oa}uFl(){if(!this.ZHb)return null;for(var oa=0;oa<this.ZHb.length;oa++){var Za=this.ZHb.K(oa);Za=Ob.a.QI(Za.node);if(this.Cfa.Bb(Za))return null}oa=this.ZHb;this.ZHb=null;return oa}Dyl(){this.ZHb=null}ekp(){this.$ca=!0}mqn(oa){return this.Cfa.Bb(oa.id.toString())}}Object(f.a)(Ub,"NodeEventsCollection",
null,[335]);var Vc=e(1369),qd=e(13),vb=e(41),Kb=e(1287),Ic=e(364),kd=e(94);class Wd extends Kb.a{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue){super();this.AGd=new Vc.a;this.fEd=!1;this.AJc=null;this.ZOa=(dg,Pf)=>{(dg=Pf.node)&&this.xsd(dg)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Ob.a.Gap(dg,this.Yra.$ca,this.T6b,this.sSk)&&(this.Yra.Zwe(dg,0),this.Nbk(dg)));this.Yra.$ca&&this.Hfa.Cyb(dg)};this.Poj=(dg,Pf)=>{dg=Pf.node;this.Yra.D1b(String.format("{0}",dg.id),Ob.a.QI(dg))};
this.m0a=(dg,Pf)=>{(dg=Pf.node)&&this.xsd(dg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Yra.$ca&&this.Yra.Zwe(dg,3));this.Yra.$ca&&this.Hfa.hsj(dg,3)};this.FW=(dg,Pf)=>{dg=Pf.node;Pf=Pf.property;dg&&this.Ktk.has(Pf)&&this.xsd(dg)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Yra.$ca&&(this.Yra.Zwe(dg,2),Pf===Va.a.kk&&this.Nbk(dg)));this.Yra.$ca&&Pf===Va.a.qd&&this.Hfa.hsj(dg,2)};this.Qoj=(dg,Pf)=>{(dg=Pf.node)&&kb.ParagraphReader.lc(dg)&&
!this.hJc.has(dg)&&!this.EUe.has(dg)&&(this.hJc.add(dg),this.t2())};this.jsj=(dg,Pf)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(dg=Pf.node)&&this.ff.F1n(dg)};this.Tfg=()=>{this.ysd()?this.h$():this.fEd&&!this.Yra.$ca&&this.gwd()};this.jV=Za;this.Yra=xb;this.sSk=kd.b(Zb.Mze);this.T6b=oa.$("AugLoopOperationsAreEnabled");this.ff=sc;this.Hfa=$c;this.JF=Ed;this.Sb=Ud;this.xo=Vd;this.xJ=Ie;this.hJc=new Set;this.EUe=new Set;Ue.Cxa(this,7);this.Ktk=new Set([qd.a.so,qd.a.bold,qd.a.italic,
qd.a.underline,qd.a.font,qd.a.fontSize,qd.a.fontColor,vb.a.capitalization,qd.a.Ki,qd.a.Qq,Va.a.Lia,Va.a.P5,Va.a.vk,Va.a.Kia,Va.a.O5,Va.a.ua,Va.a.ya,Va.a.xa,Va.a.listID,Va.a.IW,Va.a.ve,Va.a.lFa,Va.a.Ax,Va.a.kk])}get index(){return 7}get Tid(){return this.AJc}set Tid(oa){this.AJc=oa;this.Hfa.dkg=oa?()=>{this.AJc()}:null}init(){this.ysd()&&this.h$();this.Yra.xUh(this.Tfg)}h$(){this.jV?(this.fEd=!0,this.jV.wv(this.ZOa),this.jV.wY(this.Poj),this.jV.bA(this.m0a),this.jV.yq(this.FW),this.jV.cVh(this.jsj),
this.jV.c7k(this.Qoj)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}gwd(){this.jV?(this.fEd=!1,this.jV.VW(this.ZOa),this.jV.upa(this.Poj),this.jV.jxa(this.m0a),this.jV.nU(this.FW),this.jV.PJj(this.jsj),this.jV.KIo(this.Qoj)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}mee(oa){oa&&this.AGd.add(oa.id,oa.ka(Va.a.kk,0))}Nbk(oa){this.AGd.Bb(oa.id)?(this.Hfa.dJp(Sa.a.IDe,oa,this.AGd.K(oa.id)),
this.AGd.remove(oa.id)):(this.Hfa.xyl(Sa.a.IDe),this.Tid&&this.Tid())}xsd(oa){const Za=ze.StaticActiveAppFrame.Aa().tb.Xc;return!!Za&&Za.Ly&&!!Za.Fd&&!!Za.Fd.ed&&!!oa&&!!oa.ed&&oa.ed.id===Za.Fd.ed.id}run(){if(0!==this.hJc.size){var oa=[];for(const Za of this.hJc)oa.push(Za),this.EUe.add(Za),100<=oa.length&&(this.lpi(oa),oa=[]);0<oa.length&&this.lpi(oa);this.hJc.clear()}}lpi(oa){const Za=new Cb.a(4,1,500,()=>{for(const xb of oa)this.EUe.delete(xb),this.oCp(xb)},158);this.Sb.pc(Za)}oCp(oa){var Za=this.xo.JMa(oa,
0,Zb=>this.vcp(Zb.intent));if(0<Za.count)for(const Zb of Za){Za=this.Hfa.DOm(Zb.intent.id);var xb=oa.bua;const sc=kb.ParagraphReader.fW(oa);Zb.end<Zb.Mc||(xb=Ic.a.G_c(sc,xb,Zb.Mc,Zb.end-Zb.Mc,Zb.Mc,Zb.end-Zb.Mc,oa),this.xJ.hvg(oa.ed,Za,xb))}}vcp(oa){return!!oa&&this.JF.dwb(oa)&&!!oa.content}ysd(){return!this.fEd&&this.Yra.$ca}}Object(f.a)(Wd,"ParagraphNodeEventHandler",Kb.a,[331]);var Ye=e(998),Re=e(266),le=e(968),Bh=e(241);class gf extends le.a{constructor(){super();this.H_=Object.assign(new Bh.a,
{T_:gf.getTypeName(),B_:gf.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(gf,"DeltaUpdateOperation",le.a,[]);var Wf=e(892);class $i{constructor(){this.referencedPath=null}}Object(f.a)($i,"ItemReference",null,[]);class wf extends Wf.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(wf,"ItemWithPath",Wf.a,[]);var Hf=e(1562);class vf extends Hf.a{constructor(){super();
this.prevParentPath=null;this.H_=Object.assign(new Bh.a,{T_:vf.getTypeName(),B_:vf.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(vf,"MoveOperation",Hf.a,[]);var Ui=e(1418);class rf extends Ui.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new Bh.a,{T_:rf.getTypeName(),B_:rf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(f.a)(rf,"SelectionSignal",Ui.a,[]);class ug extends rf{constructor(){super();this.content=null;this.H_=Object.assign(new Bh.a,{T_:ug.getTypeName(),B_:ug.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}Object(f.a)(ug,"SelectionContentSignal",rf,[]);class Eg{constructor(){this.range=this.tileReference=null}}Object(f.a)(Eg,"TextTileRange",null,[]);var th=e(1656),ei=e(891),Yj=
e(6),Zk=e(30),yg=e(39);class Kk{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud){this._augLoopRuntimeManager=this.IEd=null;this.Jaf=!1;this.nsa=this.e2e=this.qPd=null;this.Djh=2E3;this.Lfm=()=>{if(qb.a.FZ||Re.SessionStatusManager.instance&&Re.SessionStatusManager.instance.nq)Qb.a.IB().closeSession(),a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Sb.Kf(this.IEd);this.Tk.Ae(()=>{var Vd;const Ie=Fd.a.instance.dha;this.rF()&&this.lNo();for(this.wTc.reset();this.n6a.foc&&
!this.wTc.Txb();){let Pf;Pf=this.n6a.tFl();if(!Pf||!Pf.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.wTc.update();continue}if(!this.lap(Pf)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Pf.graphNode.id);this.wTc.update();continue}const pc=Pf.graphNode.id.toString();var Ue=-1,dg=!0;Ie&&yg.a.Df(Ie)&&pc==Ie.node.id.toString()&&(Ue=Ie.cpBegin,dg=!1);let yi=null;
if(this.EKb.contains(pc))switch(Pf.nhd){case 3:this.EKb.remove(pc);yi=3;break;default:yi=Pf.nhd}else switch(Pf.nhd){case 0:case 1:this.EKb.add(pc);yi=0;break;case 2:this.EKb.add(pc);yi=0;break;case 3:this.EKb.remove(pc);yi=3;break;default:yi=Pf.nhd}if(null!=yi){Ue=this.sIi(Pf.graphNode,Pf.fullPath,yi,Ue,dg);if(4==yi||5==yi){if(Ue.prevParentPath.join()!==Ue.parentPath.join()){dg=Object.assign(new Lb.a,{parentPath:Ue.prevParentPath,items:Ue.items});const Ei=Object.assign(new Xb.a,{parentPath:Ue.parentPath,
items:Ue.items,prevId:Ue.prevId,nextId:Ue.nextId});pc!==Ue.prevId&&pc!==Ue.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",yi,pc,Ue.prevId,Ue.nextId,Pf.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:dg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:Ei}));14===Pf.graphNode.type&&this.oRj(Pf.graphNode,
Ue.parentPath).forEach(ok=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:ok}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:Ue}));if(this.sAd&&this.nsa&&this.nsa[0]==pc)switch(yi){case 3:this.nsa=null;break;case 0:case 1:case 2:case 4:case 5:this.nsa[1]=null===(Vd=this.bmb.Btb(Pf.graphNode))||void 0===Vd?void 0:Vd.s5c(Pf.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",
yc.a.getTypeNameFor(Ue),pc);switch(yi){case 0:case 4:case 5:this.ff.sao(Pf.graphNode);break;case 3:this.ff.tao(Pf.graphNode,Ue.parentPath.join("\\"))}}this.wTc.update()}(Vd=this.n6a.uFl())&&this.mLj(Vd)},"TV:FPEFO")};this.Wwa=(Vd,Ie)=>{var Ue;if(Ie.Pn&&Ie.Pn.length){if(this.sAd)if(Vd=Ob.a.xIm(Ie.Pn),!Vd)this.nsa=null;else if(!this.nsa||this.nsa[0]!=Vd.id.toString()){const dg=this.n6a.mqn(Vd)?null:null===(Ue=this.bmb.Btb(Vd))||void 0===Ue?void 0:Ue.s5c(Vd);this.nsa=[Vd.id.toString(),dg]}this.Jaf&&
this.n6a.Jyo(Ie.Pn.currentSelection)}};this.za=oa;this.n6a=Za;this.Sb=xb;this.wTc=Zb;this.ouk=this.za.$("AugLoopOperationsAreEnabled");this.EKb=new Vb.a(yb.a.Oh());this.ff=sc;this.Tk=$c;this.bmb=Ed;this.pb=Ud;this.sAd=this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.pb.BD(this.Wwa);Ob.a.Km().then(()=>{this._augLoopRuntimeManager=Qb.a.IB();this.za.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new th.a,
{handler:Vd=>{this.ff.mbl(Vd)}}));this.ouk&&this.n6a.ekp();this.Ykp()}).catch(()=>{});this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.Djh=5E3)}lNo(){const oa=this.ff.QIc.entries();for(let Za=0;Za<this.ff.QIc.size;Za++){const xb=oa.next();y.AFrameworkApplication.ud("gi204158;ef1e2812");Date.now()-xb.value[1].time>=this.Djh&&this.ff.r8c(xb.value[1].annotation,!0,Xb.a.getTypeName(),!1)}}lap(oa){return 3===oa.nhd||Ob.a.oZj(oa.graphNode)}Ykp(){!this.IEd&&
this.n6a.$ca&&(this.IEd=new Cb.a(4,2,this.za.sc("NodeEventsFiringInterval",500),this.Lfm,131),this.Sb.pc(this.IEd))}oRj(oa,Za){var xb,Zb=[];const sc=Yj.a.kb(oa),$c=sc.Bs();for(var Ed=0;Ed<$c;Ed++){let Ud=sc.Gy(Ed);11===Ud.type&&(Ud=Zk.a.Ze(sc));const Vd=Ud.id.toString(),Ie=null===(xb=this.bmb.Btb(Ud))||void 0===xb?void 0:xb.tqb(Ud);Zb.push(Object.assign(new Wf.a,{body:Ie,id:Vd,revId:Ob.a.mSf(Ud)}));sc.xd(oa.type)}Za.push(oa.id.toString());xb=[];xb.push(Object.assign(new Xb.a,{parentPath:Za.slice(),
items:Zb,prevId:null}));for(Zb=0;Zb<$c;Zb++)Ed=sc.Gy(Zb),11===Ed.type&&(Ed=Zk.a.Ze(sc)),0<sc.Bs()&&(xb=xb.concat(this.oRj(Ed,Za))),sc.xd(oa.type);Za.pop();return xb}MMa(oa){return oa.split("\\").slice(0,-1)}sIi(oa,Za,xb,Zb=-1,sc=!0){var $c;let Ed=null,Ud=null;const Vd=oa.id.toString();var Ie=null;3!==xb&&(Ie=Ob.a.xol(oa));if(Ie)for(let Ue=0;Ue<Ie.length;Ue++)if(Ie[Ue]===Vd){Ud=Ue+1<Ie.length?Ie[Ue+1]:null;Ed=Ue?Ie[Ue-1]:null;break}Vd!==Ed&&Vd!==Ud||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",
xb,Vd,Ed,Ud,oa.type);Ie=null===($c=this.bmb.Btb(oa))||void 0===$c?void 0:$c.tqb(oa,Zb,sc);Zb=[Object.assign(new Wf.a,{body:Ie,id:Vd,revId:Ob.a.mSf(oa)})];switch(xb){case 0:case 1:return Object.assign(new Xb.a,{parentPath:this.MMa(Za),items:Zb,prevId:Ed,nextId:Ud});case 4:return Object.assign(new vf,{parentPath:this.MMa(Ob.a.QI(oa)),prevParentPath:this.MMa(Za),items:Zb,prevId:Ed,nextId:Ud});case 5:return xb=this.n6a.com(Vd),Object.assign(new vf,{parentPath:this.MMa(null!==xb&&void 0!==xb?xb:Ob.a.QI(oa)),
prevParentPath:this.MMa(Za),items:Zb,prevId:Ed,nextId:Ud});case 2:return Object.assign(new dc.a,{parentPath:this.MMa(Za),items:Zb});case 3:return Object.assign(new Lb.a,{parentPath:this.MMa(Za),items:Zb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",xb,Vd),Object.assign(new Hf.a,{parentPath:this.MMa(Za),items:Zb,prevId:Ed,nextId:Ud})}}OVm(oa){return this.nsa&&this.nsa[0]===oa?this.nsa[1]:null}MXo(oa){var Za;if(!this.sAd)return a.ULS.sendTraceTag(545552581,
389,10,"sendTile: autoreplace is not enabled"),!1;if(!Ob.a.oZj(oa))return!1;const xb=oa.id.toString();var Zb=this.EKb.contains(xb)?2:0;Zb=this.sIi(oa,Ob.a.QI(oa),Zb);this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:Zb}));this.EKb.add(xb);this.nsa=[xb,null===(Za=this.bmb.Btb(oa))||void 0===Za?void 0:Za.s5c(oa)];return!0}DWo(oa,Za){var xb;if(this.sAd){var Zb=oa.id.toString(),sc=this.MMa(Ob.a.QI(oa));Za=[Object.assign(new wf,{id:Zb,revId:Ob.a.mSf(oa),parentPath:sc,delta:Za})];
sc=Object.assign(new gf,{parentPath:sc,items:Za});this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:sc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Zb);this.nsa=[Zb,null===(xb=this.bmb.Btb(oa))||void 0===xb?void 0:xb.s5c(oa)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}Zfl(oa,Za){if(oa.tileReference.referencedPath.length!==Za.tileReference.referencedPath.length||oa.range.start!==Za.range.start||oa.range.length!==
Za.range.length||oa.range.isInsertionPoint!==Za.range.isInsertionPoint)return!1;for(let xb=0;xb<oa.tileReference.referencedPath.length;xb++)if(oa.tileReference.referencedPath[xb]!==Za.tileReference.referencedPath[xb])return!1;return!0}Ufl(oa,Za){if(oa.selectedRanges.length!==Za.selectedRanges.length||oa.content!==Za.content)return!1;for(let xb=0;xb<oa.selectedRanges.length;xb++)if(!this.Zfl(oa.selectedRanges[xb],Za.selectedRanges[xb]))return!1;return!0}mLj(oa){oa=this.getSelection(oa);if(!this.e2e||
!this.Ufl(oa,this.e2e)){var Za=this.qPd?this.qPd:Wa.a.create().toString(),xb=[Object.assign(new Wf.a,{body:oa,id:Za})];this.qPd?Za=Object.assign(new dc.a,{parentPath:["session","doc"],items:xb}):(this.qPd=Za,Za=Object.assign(new Xb.a,{parentPath:["session","doc"],items:xb}));this._augLoopRuntimeManager.submitOperation(Object.assign(new ei.a,{operation:Za}));this.e2e=oa}}getSelection(oa){var Za;if(!oa)return null;const xb=new T.a;let Zb="";for(let Ed=0;Ed<oa.length;Ed++){var sc=oa.K(Ed),$c=(null===
(Za=this.bmb.Btb(sc.node))||void 0===Za?void 0:Za.tqb(sc.node)).content;Zb+=$c;$c=sc.cpBegin<$c.length?sc.cpBegin:-1;$c=Object.assign(new zb.a,{start:$c,length:sc.cpEnd-sc.cpBegin});Object.assign($c,{isInsertionPoint:yg.a.Df(sc)||yg.a.em(sc)});const Ud=sc.node.id.toString();sc=this.MMa(Ob.a.QI(sc.node));sc.push(Ud);xb.add(Object.assign(new Eg,{range:$c,tileReference:Object.assign(new $i,{referencedPath:sc})}))}return Object.assign(new ug,{selectedRanges:xb.toArray(),content:Zb})}J5o(oa){(this.Jaf=
oa)?this.VKj():this.n6a.Dyl()}VKj(){this.mLj(this.pb.ob.currentSelection)}L4(){var oa,Za,xb=null===(oa=this.pb.ob)||void 0===oa?void 0:oa.currentSelection;if(xb){oa=new T.a;var Zb="";for(const sc of xb){xb=(null===(Za=this.bmb.Btb(sc.node))||void 0===Za?void 0:Za.tqb(sc.node)).content;Zb+=xb;xb=Object.assign(new zb.a,{start:sc.Uj,length:sc.Yp-sc.Uj});const $c=sc.node.id.toString(),Ed=this.MMa(Ob.a.QI(sc.node));Ed.push($c);oa.add(Object.assign(new Eg,{range:xb,tileReference:Object.assign(new $i,{referencedPath:Ed})}))}return Object.assign(new ug,
{selectedRanges:oa.toArray(),content:Zb})}}rF(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(Kk,"TileView",null,[332]);var Jh=e(33),zf=e(51);class cg{constructor(oa){zf.a.assign(cg,this,oa)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(oa){return zf.a.matchesTypesFor(oa,[cg.getTypeName()])}}cg.H_={T_:cg.getTypeName(),B_:cg.getBaseTypes()};
class xe{constructor(oa){zf.a.assign(xe,this,oa)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(oa){return zf.a.matchesTypesFor(oa,[xe.getTypeName()])}}xe.H_={T_:xe.getTypeName(),B_:xe.getBaseTypes()};class wi{constructor(oa){zf.a.assign(wi,this,oa)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(oa){return zf.a.matchesTypesFor(oa,[wi.getTypeName()])}}wi.H_={T_:wi.getTypeName(),B_:wi.getBaseTypes()};
class ig{constructor(oa){zf.a.assign(ig,this,oa)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(oa){return zf.a.matchesTypesFor(oa,[ig.getTypeName()])}}ig.H_={T_:ig.getTypeName(),B_:ig.getBaseTypes()};class Qi{constructor(oa){zf.a.assign(Qi,this,oa)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(oa){return zf.a.matchesTypesFor(oa,
[Qi.getTypeName()])}}Qi.H_={T_:Qi.getTypeName(),B_:Qi.getBaseTypes()};var el;(function(oa){oa[oa.Top=0]="Top";oa[oa.Center=1]="Center";oa[oa.Bottom=2]="Bottom"})(el||(el={}));var mj;(function(oa){oa[oa.none=0]="none";oa[oa.firstRow=32]="firstRow";oa[oa.lastRow=64]="lastRow";oa[oa.firstCol=128]="firstCol";oa[oa.lastCol=256]="lastCol";oa[oa.qmq=512]="noHBand";oa[oa.Bmq=1024]="noVBand";oa[oa.nwCell=160]="nwCell";oa[oa.neCell=288]="neCell";oa[oa.swCell=192]="swCell";oa[oa.seCell=320]="seCell";oa[oa.NUl=
1184]="defaultLook"})(mj||(mj={}));Object(f.b)("TableLookFlags",mj);class Uf{tqb(oa){if(oa)switch(oa.type){case 14:return this.bRl(oa);case 15:return new cg;case 16:return this.aRl(oa)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}bRl(oa){var Za=oa.CI||[];let xb=0;for(let Zb=0;Zb<Za.length;Zb++)xb+=Za[Zb];Za=Za.map((Zb,sc)=>({columnId:sc.toString(),widthPercent:0!=xb?100*Zb/xb:0}));return new ig({columnDefs:Za,tableLook:oa.properties.ka(Va.a.tableLook,mj.NUl),
complexTable:oa.properties.ka(Va.a.complexTable,!1),floatingTable:oa.properties.ka(Va.a.A2i,!1)})}aRl(oa){return new xe({rowspan:oa.properties.ka(Va.a.rowSpan,1),colspan:oa.properties.ka(Va.a.colSpan,1),borderInfo:{topBorder:{color:oa.properties.ka(Va.a.S3b,0),size:oa.properties.ka(Va.a.XBc,4),style:oa.properties.ka(Va.a.XBb,"single")},leftBorder:{color:oa.properties.ka(Va.a.Q3b,0),size:oa.properties.ka(Va.a.VBc,4),style:oa.properties.ka(Va.a.VBb,"single")},rightBorder:{color:oa.properties.ka(Va.a.R3b,
0),size:oa.properties.ka(Va.a.WBc,4),style:oa.properties.ka(Va.a.WBb,"single")},bottomBorder:{color:oa.properties.ka(Va.a.P3b,0),size:oa.properties.ka(Va.a.UBc,4),style:oa.properties.ka(Va.a.UBb,"single")}},verticalAlignment:oa.properties.ka(Va.a.MQa,el.Top),ghostCell:oa.properties.ka(Va.a.ghostCell,!1),renderCell:oa.properties.ka(Va.a.renderCell,!1),skippedCell:oa.properties.ka(Va.a.skippedCell,!1),fillColor:oa.properties.ka(qd.a.YE,0),verticalMerge:oa.properties.ka(Jh.a.vMerge,null)})}s5c(oa){return null===
oa||void 0===oa?void 0:oa.properties}}Object(f.a)(Uf,"TableElementNodeToTileConverter",null,[333]);class hh{constructor(oa,Za,xb){this.$r=Za;this.CGa=xb;this.m5d=!1;this.AJc=null;this.puj=(Zb,sc)=>{this.CFa(sc.node,0)};this.juj=(Zb,sc)=>{Zb=sc.node;this.CGa.D1b(Zb.id.toString(),Ob.a.QI(Zb))};this.quj=(Zb,sc)=>{this.CFa(sc.node,3)};this.Ere=(Zb,sc)=>{this.CFa(sc.node,2)};this.suj=(Zb,sc)=>{this.CFa(sc.node,0)};this.tuj=(Zb,sc)=>{this.CFa(sc.node,3)};this.ruj=(Zb,sc)=>{Zb=sc.node;this.CGa.D1b(Zb.id.toString(),
Ob.a.QI(Zb))};this.Fre=(Zb,sc)=>{this.CFa(sc.node,2)};this.luj=(Zb,sc)=>{this.CFa(sc.node,0)};this.kuj=(Zb,sc)=>{Zb=sc.node;this.CGa.D1b(Zb.id.toString(),Ob.a.QI(Zb))};this.muj=(Zb,sc)=>{this.CFa(sc.node,3)};this.Cre=(Zb,sc)=>{var $c;Zb=sc.node;if(sc.property===Va.a.ghostCell){if(sc=Zb.eh?Zb:null===($c=Zb.HEa)||void 0===$c?void 0:$c.OQ){$c=Yj.a.kb(sc);var Ed=$c.Bs();for(var Ud=0;Ud<Ed;Ud++){$c.Gy(Ud);var Vd=Zk.a.Ze($c);this.CGa.D1b(Vd.id.toString(),String.format("{0}\\{1}",Ob.a.QI(sc),Vd.id));this.CFa(Vd,
4);$c.xd(16)}}}else if(sc.property===qd.a.Fg){sc=Yj.a.kb(Zb);$c=sc.Bs();let Ie=null;Ed=[];for(Ud=0;Ud<$c;Ud++){sc.Gy(Ud);Vd=Zk.a.Ze(sc);this.CGa.TSo(Vd.id.toString(),String.format("{0}\\{1}",Ob.a.QI(Zb),Vd.id));if(14!==Vd.type){if(Ie=Ob.a.QI(Vd))this.CGa.D1b(Vd.id.toString(),Ie),this.CFa(Vd,5)}else Ed.push(Vd);sc.xd(16)}Ie&&Ed.forEach(Ue=>{this.CGa.D1b(Ue.id.toString(),String.format("{0}\\{1}",Ie.split("\\").slice(0,-1).join("\\"),Ue.id));this.CFa(Ue,5)})}this.CFa(Zb,2)};this.Tfg=()=>{this.ysd()?
this.h$():this.m5d&&!this.CGa.$ca&&this.gwd()};this.T6b=oa.$("AugLoopOperationsAreEnabled")}get Tid(){return this.AJc}init(){this.ysd()&&this.h$();this.CGa.xUh(this.Tfg)}h$(){const {d5j:oa,DFe:Za,R4j:xb}=this.MCi();if(oa&&Za&&xb){this.m5d=!0;var Zb=this.juj,sc=this.quj,$c=this.Ere;oa.wv(this.puj);oa.wY(Zb);oa.bA(sc);oa.yq($c);Zb=this.ruj;sc=this.tuj;$c=this.Fre;Za.wv(this.suj);Za.wY(Zb);Za.bA(sc);Za.yq($c);Zb=this.kuj;sc=this.muj;$c=this.Cre;xb.wv(this.luj);xb.wY(Zb);xb.bA(sc);xb.yq($c)}else a.ULS.sendTraceTag(524149329,
389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}gwd(){const {d5j:oa,DFe:Za,R4j:xb}=this.MCi();if(oa&&Za&&xb){this.m5d=!1;var Zb=this.juj,sc=this.quj,$c=this.Ere;oa.VW(this.puj);oa.upa(Zb);oa.jxa(sc);oa.nU($c);Zb=this.ruj;sc=this.tuj;$c=this.Fre;Za.VW(this.suj);Za.upa(Zb);Za.jxa(sc);Za.nU($c);Zb=this.kuj;sc=this.muj;$c=this.Cre;xb.VW(this.luj);xb.upa(Zb);xb.jxa(sc);xb.nU($c)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}CFa(oa,
Za){oa&&this.xsd(oa)&&this.CGa.$ca&&this.T6b&&this.CGa.Zwe(oa,Za)}MCi(){return{d5j:this.$r.Hf(14),DFe:this.$r.Hf(15),R4j:this.$r.Hf(16)}}xsd(oa){const Za=ze.StaticActiveAppFrame.Aa().tb.Xc;return!!Za&&Za.Ly&&!!Za.Fd&&!!Za.Fd.ed&&!!oa&&!!oa.ed&&oa.ed.id===Za.Fd.ed.id}ysd(){return!this.m5d&&!!this.CGa.$ca}}Object(f.a)(hh,"TableNodeEventHandler",null,[331]);class Jj{constructor(oa,Za){this.hxj=oa;this.jpp=Za}Btb(oa){return oa?14===oa.type||15===oa.type||16===oa.type?this.jpp:12===oa.type?this.hxj:null:
null}}Object(f.a)(Jj,"NodeToTileConverterHolder",null,[330]);var $h=e(350);class pi{get name(){return"Box4.AugmentationLoop"}Ec(oa){this.Z=oa;const Za=this.Z.resolve("Common.IAppSettingsManager"),xb=Za.$("AugLoopTaskUseTimeBasedYieldStrategy"),Zb=new Ub,sc=xb?new Xa.a(Za.sc("AugLoopTaskAllowedRunTimeBeforeYielding",10),ja.a.We):new ab(Za.sc("AugLoopTaskNodesToRunBeforeYielding",10));this.Z.ja("Common.ICpuMeter",()=>sa.a.instance).ha();this.Z.ja("Box4.AugmentationLoop.AugmentationLoopStateManager",
()=>new qf).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.Z.ja("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Wd(Za,qb.a.wf.Um.Hf(12),Zb,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.zc,this.Z.resolve("Box4.Intent.IIntentRangeEditor"),
this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();Ob.a.tCe()&&this.Z.ja("Box4.AugmentationLoop.TableNodeEventHandler",()=>new hh(Za,qb.a.wf.Um,Zb)).ha();this.Z.ja("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new ub).ha();let $c=null,Ed=null;Ig.a.npa&&($c=this.Z.resolve("Box4.Proofing.IProofingLanguageAutoDetectSettingsInfo"),Ed=oa.resolve("Box4.IFormattingEditor"));
this.Z.ja("Box4.AugmentationLoop.IFormattingExtractor",()=>new md.a(this.Z.resolve("Common.IAppSettingsManager"),this.Z.Wa("Box4.IFeatureHelper"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IParagraphIndentationReader"),this.Z.resolve("Box4.Styles.IWACStyleReader"),$c)).ha();this.Z.ja("Box4.AugmentationLoop.IAnnotationPolicies",()=>new Sa.a(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),this.Z.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.Z.ja("Box4.AugmentationLoop.IPersistedAnnotationStorage",
()=>new Nc(this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.IIntelligenceReader"),this.Z.resolve("Box4.IIntelligenceEditor"),this.Z.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),oa.resolve("Box4.IFeatureHelper"))).ha();const Ud=this.Z.resolve("IRoamingDictionary");this.Z.ja("Box4.AugmentationLoop.IAnnotationStorage",()=>new Rf(this.Z.resolve("Common.IAppSettingsManager"),this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.Intent.IIntentRangeEditor"),
new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),y.AFrameworkApplication.zc,this.Z.Wa("Box4.IIntelligenceReader"),this.Z.Wa("Box4.IIntelligenceEditor"),this.Z.Wa("Box4.AugmentationLoop.IAnnotationPolicies"),this.Z.Wa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),oa.resolve("Box4.IFeatureHelper"),$h.a.instance,()=>{try{return Qb.a.IB()}catch(Vd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Vd),null}},Ud,
$c,Ed)).ha();this.Z.ja("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new Jj(new Ye.a(this.Z.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new Uf)).ha();this.Z.ja("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new Kk(Za,Zb,y.AFrameworkApplication.zc,sc,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Common.ICpuMeter"),this.Z.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.Z.resolve("Box4.ISelectionManager"))).ha();
a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.Z.ja("Box4.AugmentationLoop.IUtilsWrapper",()=>new Pc).ha();this.Z.ja("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new wc).ha()}init(){if(y.AFrameworkApplication.MJ.BootFailed)a.ULS.sendTraceTag(512624089,389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");
const oa=new jf(this.Z.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.pe,qb.a.Hea,this.Z.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),sb.a.instance,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage")),Za=new wb;this.Z.register(315,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().RKp(()=>Za);y.AFrameworkApplication.ud("b8afb343;bjdjj400");const xb=Ob.a.XHn(this.Z.resolve("Common.IDynamicScriptLoaderProvider").JE,this.Z.resolve("Common.App.OAuth.IOAuthManager"),
oa,this.Z.resolve("Common.ISharedDependencyLoader"),Za);this.Z.ja("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new hc(xb)).ha();this.Z.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Ob.a.tCe()&&this.Z.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.Z.resolve("Box4.IIntelligenceReader").init();this.Z.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(oa){Ca.a.instance.Rc(new pi,
0,oa);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(pi,"Box4AugmentationLoopPackage",null,[0,1]);var vh=e(622),Bl=e(11),Bj=e(489),Vj=e(1655);class mh{constructor(oa,Za,xb,Zb=null,sc=null,$c=null){this.PQ=new Vj.a(Za,Zb,sc,$c);this.Rb=oa;this.ld=xb}get type(){return this.PQ.type}get id(){return this.PQ.id}get intent(){return this.PQ.intent}og(oa){return new mh(oa,this.type,this.ld,this.id,this.intent,this.PQ.UEa)}toString(){return String.format("Core = [{0}], IsStart = {1}",
this.PQ,this.ld)}}Object(f.a)(mh,"IntentObject",null,[79]);var xf=e(496),Wg=e(159),Oj=e(259);class Bg{constructor(){this.lKc=new Wg.a}uUd(oa,Za,xb,Zb,sc=null,$c=null,Ed=null){oa=oa.m1(Za,oa.ra.Uwp(Za));oa.yl||(oa.yl=new xf.a(oa));oa.yl.add(new mh(oa,xb,Zb,sc,$c,Ed));oa.Bcb=!0}sIj(oa){return oa.Rb&&oa.Rb.yl&&oa.Rb.yl.kod(Za=>Za===oa,[oa.type])?!0:!1}tIj(oa,Za){if(oa.type===Za.type&&oa.ld&&!Za.ld&&oa.Rb&&oa.Rb.yl&&oa.Rb.yl.contains(oa)&&Za.Rb&&Za.Rb.yl&&Za.Rb.yl.contains(Za)){var xb=[oa.type];oa.Rb.yl.kod(Zb=>
Zb===oa,xb);Za.Rb.yl.kod(Zb=>Zb===Za,xb)}}JLp(oa,Za,xb){if(!Za)return!1;xb=new Fa.a([xb]);for(let Zb=0;Zb<oa.length;Zb++){const sc=oa.jc(Zb);if(!sc.yl)continue;let $c=!0;xb.w3a(sc.yl,void 0,Ed=>{Ed.id&&Za.equals(Ed.id)&&($c=!1)});if(!$c)return!1}return!0}Dmo(oa,Za,xb,Zb){let sc=null,$c=null;Za=new Fa.a([Za]);const Ed=oa.ra;for(let Ud=0;Ud<Ed.length;Ud++){const Vd=Ed.jc(Ud);if(!Vd.yl)continue;let Ie=!0;Za.w3a(Vd.yl,void 0,(Ue,dg)=>{if(dg){var Pf=dg.Rb.cp<xb,pc=Ue.Rb.cp>Zb;Pf&&Ue.Rb.cp<=xb||dg.Rb.cp>=
Zb&&pc||(Pf&&pc?Ie=!1:Pf?sc=Ue:pc?$c=dg:this.tIj(dg,Ue))}});if(!Ie)return!1}if(sc){if(!this.sIj(sc))return!1;this.uUd(oa,xb,sc.type,sc.ld,sc.id,sc.intent,sc.PQ.UEa)}if($c){if(!this.sIj($c))return!1;this.uUd(oa,Zb,$c.type,$c.ld,$c.id,$c.intent,$c.PQ.UEa)}return!0}LFg(oa){let Za;return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Za}=this.lKc.Nc(oa.type,Za)).returnValue?Za.LFg(oa):!0}$Qn(oa,Za){if(this.LFg(Za)){var xb=Za.id,Zb=Za.type,sc=Za.Mc,
$c=Za.end;if(({cpEnd:$c}=Bg.Xfk(oa,sc,$c)).returnValue){if(Bj.a(Zb)){if(!this.JLp(oa.ra,xb,Zb))return}else if(!this.Dmo(oa,Zb,sc,$c))return;this.uUd(oa,sc,Zb,!0,xb,Za.intent,Za.PQ.UEa);this.uUd(oa,$c,Zb,!1,xb,Za.intent,Za.PQ.UEa)}}}ukd(oa,Za){ze.StaticActiveAppFrame.Aa().FDf(oa,()=>{const xb=new pg.GraphTransaction(2);try{xb.Eb(oa);const Zb=oa.R2();try{const sc=oa.A8();try{Za()}finally{sc&&sc.dispose()}}finally{Zb&&Zb.dispose()}}finally{xb&&xb.dispose()}})}R_a(oa,Za){this.ukd(oa,()=>{this.$Qn(oa,
Za)})}bRn(oa,Za){if(Za.count){var xb=new Rb.a,Zb=new Oj.a;for(var sc of Za){var $c=sc.value;Bj.a(sc.key)||$c.Sc((Ud,Vd)=>Ud.Mc!==Vd.Mc?Ud.Mc-Vd.Mc:Ud.end-Vd.end);if(Bg.OLp($c))for(var Ed of $c)$c=Ed.end,({cpEnd:$c}=Bg.Xfk(oa,Ed.Mc,$c)).returnValue&&($c=$c!==Ed.end?new $b.a(Ed.type,Ed.Mc,$c,Ed.id,Ed.intent,Ed.PQ.UEa):Ed,xb.add($c.Mc),xb.add($c.end),Bg.P2k(Zb,$c))}oa.O4d(xb);oa=oa.ra;for(xb=0;xb<oa.length;xb++){sc=oa.jc(xb);if(Ed=sc.yl)for(const Vd of Za.keys)Ed.removeType(Vd);let Ud;({value:Ud}=Zb.Nc(sc.cp,
Ud)).returnValue||(Ud=null);if(Ud){Ed||(Ed=sc.yl=new xf.a(sc));for(const Vd of Ud)Ed.add(Vd.og(sc))}sc.Bcb=!0}}}Gag(oa,Za){const xb=new Wg.a;for(const Zb of Za){let sc;({value:sc}=xb.Nc(Zb.type,sc)).returnValue||(sc=new T.a,xb.W(Zb.type,sc));sc.add(Zb)}this.ukd(oa,()=>{this.bRn(oa,xb)})}yAp(oa,Za,xb){oa=oa.ra;const Zb=new Fa.a([8]);Za===xb&&(xb+=1);for(let sc=0;sc<oa.length;sc++){const $c=oa.jc(sc);$c.yl&&Zb.w3a($c.yl,void 0,(Ed,Ud)=>{Ud&&Math.max(Ud.Rb.cp,Za)<Math.min(Ed.Rb.cp,xb)&&this.tIj(Ud,Ed)})}}COg(oa,
Za,xb){this.ukd(oa,()=>{this.yAp(oa,Za,xb)})}AAp(oa,Za){oa=oa.ra;for(let xb=0;xb<oa.length;xb++){const Zb=oa.jc(xb);Zb.yl&&Zb.yl.removeType(Za)}}MCb(oa,Za){this.ukd(oa,()=>{this.AAp(oa,Za)})}zAp(oa,Za,xb){let Zb=!1;Za=Za.ra;xb=[xb];for(let sc=0;sc<Za.length;sc++){const $c=Za.jc(sc);$c.yl&&(Zb=$c.yl.kod(oa,xb)||Zb)}return Zb}fwd(oa,Za,xb){let Zb=!1;this.ukd(Za,()=>{Zb=this.zAp(oa,Za,xb)});return Zb}zmc(oa,Za,xb,Zb){return!oa||0>xb||Zb>oa.characterData.length||xb>Zb?new T.a:this.JMa(oa,Za,sc=>Math.max(sc.Mc,
xb)<=Math.min(sc.end,Zb))}JMa(oa,Za,xb){return Bg.GDm(oa,Za,xb)}static GDm(oa,Za,xb){const Zb=new T.a;oa=oa.ra;Za=new Fa.a([Za]);if(!oa)return Zb;for(let sc=0;sc<oa.length;sc++){const $c=oa.jc(sc);$c.yl&&Za.w3a($c.yl,void 0,(Ed,Ud)=>{Ud&&(Ed=new $b.a(Ud.type,Ud.Rb.cp,Ed.Rb.cp,Ud.id,Ud.intent,Ud.PQ.UEa),xb(Ed)&&Zb.add(Ed))})}return Zb}u6c(oa,Za){const xb=new T.a;if(!Bg.yBn(oa.contextId))return xb;let Zb;const sc=oa.node;oa.contextId!==Bl.a.paragraph?(Zb=oa.cpBegin,oa=oa.cpEnd):(Zb=0,oa=sc.characterData.length);
xb.addRange(this.zmc(sc,Za,Zb,oa));return xb}FCo(oa){this.lKc.Bb(0)||this.lKc.W(0,oa)}static Xfk(oa,Za,xb){oa=kb.ParagraphReader.textLength(oa);if(Za>=oa)return{returnValue:!1,cpEnd:xb};xb>oa&&(xb=oa);return{returnValue:!0,cpEnd:xb}}static OLp(oa){if(!oa.count)return!0;const Za=new vh.a,xb=oa.K(0).type,Zb=Bj.a(xb);let sc=-1;for(const $c of oa){if($c.type!==xb||(Bj.c($c.type)?$c.Mc>$c.end:$c.Mc>=$c.end))return!1;if(Zb){oa=$c.id;if(!oa||oa.equals(Wa.a.nil)||Za.contains(oa))return!1;Za.add(oa)}else if(-1===
sc)sc=$c.end;else if(sc>$c.Mc)return!1}return!0}static P2k(oa,Za){let xb;({value:xb}=oa.Nc(Za.Mc,xb)).returnValue||(xb=new T.a,oa.W(Za.Mc,xb));xb.add(new mh(null,Za.type,!0,Za.id,Za.intent,Za.PQ.UEa));({value:xb}=oa.Nc(Za.end,xb)).returnValue||(xb=new T.a,oa.W(Za.end,xb));xb.add(new mh(null,Za.type,!1,Za.id,Za.intent,Za.PQ.UEa))}static yBn(oa){return oa===Bl.a.Nd||oa===Bl.a.kd||oa===Bl.a.paragraph}}Object(f.a)(Bg,"IntentRangeEditor",null,[334]);class Xg{constructor(){this.Z=null}get name(){return"Box4.Intent"}Ec(oa){this.Z=
oa;this.Z.ja("Box4.Intent.IntentRangeEditor",()=>new Bg).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.Z.resolve("Box4.IProofingManager")}dispose(){}static main(oa){Ca.a.instance.Rc(new Xg,0,oa);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)(Xg,"PackageManager",null,[0,1]);var kl=e(1034),ff=e(257),gj=e(1289);class ej{constructor(oa){this.oPn=oa;this.kPn=[]}get handler(){return this.oPn}get nua(){return this.kPn}}Object(f.a)(ej,"RegisteredListener",null,
[]);class zi{constructor(oa,Za){this.type=0;this.payload=null;this.type=oa;this.payload=Za}}Object(f.a)(zi,"OfficeSharedCommentsEvent",null,[1788]);class Lk{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(Lk,"ViewContainerEvent",null,[1788]);var Gh=e(603);class aj{constructor(oa){this.$$f=!1;this.jwa=new T.a;this.yme=oa}ZBo(oa){oa=new ej(oa);this.jwa.add(oa)}dak(oa){for(let Za=0;Za<this.jwa.count;++Za)if(this.jwa.K(Za).handler===oa){this.jwa.removeAt(Za);
break}}U1a(oa=!1){const Za=()=>{if(y.AFrameworkApplication.isShuttingDown)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let sc=0;sc<this.jwa.count;++sc){const $c=this.jwa.K(sc);for(;0<$c.nua.length;){var xb=Array.dequeue($c.nua);if(Object(ff.a)(Lk,xb)){var Zb=$c.handler;Zb(xb)}else Object(ff.a)(zi,xb)&&(Zb=$c.handler,Zb(xb.type,xb.payload))}}};oa?Za():this.$$f||(this.$$f=!0,Gh.a.c8(this.yme,()=>{Za();this.$$f=!1},gj.a.vhm))}}Object(f.a)(aj,
"GenericEventHost",null,[]);class ck{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(ck,"BasicEventPayload",null,[1816]);class yk{constructor(oa){this.nextPopulatedContextDetails=
0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=oa}}Object(f.a)(yk,"CommentContextDetails",null,[]);class eh{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(eh,"ContextChangeWithSelectedThreadIndex",null,[1816]);class vg{constructor(){this.tasks=this.comments=null}}Object(f.a)(vg,"LoadCommentsNoVirtualization",null,[1816]);class tm extends aj{constructor(oa){super(oa);
this.bIh=0}X4o(){this.bIh=1656}MCo(oa,Za,xb,Zb,sc,$c){oa=new ej(oa);$c&&Array.enqueue(oa.nua,this.mKl($c,this.bIh));$c=Za?Za.length:0;Array.enqueue(oa.nua,this.Hdi($c,xb,Zb,0));$c&&Array.enqueue(oa.nua,this.Oei(Za,sc));this.jwa.add(oa);this.U1a()}M4b(oa){this.dak(oa)}uWo(oa,Za,xb,Zb=0){this.ZUb(this.Hdi(oa,Za,xb,Zb));this.U1a()}vWo(oa,Za,xb){this.ZUb(this.MKl(oa,Za,xb));this.U1a()}WWo(oa,Za){this.ZUb(this.Oei(oa,Za));this.U1a()}selectComment(oa){this.ZUb(this.Lfi(oa,6));this.U1a()}highlightComment(oa){this.ZUb(this.Lfi(oa,
7));this.U1a()}TPg(oa,Za){this.ZUb(this.pOl(oa,Za));this.U1a()}bpg(oa,Za){this.ZUb(this.DQl(oa,Za));this.U1a()}mKl(oa,Za=0){const xb=new ck;xb.modelCapabilityFlags=oa;xb.richTextCapabilityFlags=Za;return new zi(12,xb)}Hdi(oa,Za,xb,Zb){const sc=new ck;sc.numberOfComments=oa;sc.numberOfThreads=Za;sc.contextDetails=Object.assign(new yk(xb),{nextPopulatedContextDetails:Zb});sc.contextDrafts=null;sc.rehydrationDrafts=null;return new zi(0,sc)}MKl(oa,Za,xb){const Zb=new ck;Zb.comments=oa;Zb.numberOfThreads=
Za;Zb.tasks=xb;return new zi(2,Zb)}Oei(oa,Za){const xb=new vg;xb.comments=oa;xb.tasks=Za;return new zi(1,xb)}Lfi(oa,Za){const xb=new ck;xb.commentId="";oa&&(xb.commentId=oa);return new zi(Za,xb)}pOl(oa,Za){const xb=new ck;xb.changes=[];xb.contextDetails=Object.assign(new yk(Za),{nextPopulatedContextDetails:oa});return new zi(10,xb)}DQl(oa,Za){const xb=new ck;xb.commentId=oa;xb.smartReplies=Za;return new zi(15,xb)}ZUb(oa){for(let Za=0;Za<this.jwa.count;++Za)Array.enqueue(this.jwa.K(Za).nua,oa)}}Object(f.a)(tm,
"OfficeSharedCommentsEventHost",aj,[1798]);var Cm=e(307),Fj=e(212),hj=e(309);class wg{constructor(){this.vaf=this.xch=!1;this.L7=this.fr=this.lsh=this.Tyh=this.bTd=this.sbc=this.MMh=this.jhh=this.JE=this.tSc=null}initialize(oa,Za,xb,Zb=null,sc=null,$c=null,Ed=null,Ud=null,Vd=null,Ie=null){this.JE=oa;this.jhh=Za;this.MMh=xb;this.sbc=Zb;this.bTd=sc;this.Tyh=$c;this.lsh=Ed;this.fr=Ud;this.xch=!0;this.L7=Vd;this.tSc=Ie}Gfe(){if(!this.xch)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),
new Promise((oa,Za)=>{Za(Gh.a.mH(-2130915313))});if(this.vaf)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.tSc||(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?this.tSc=appResourceLoader.loadChunk("sharedComments"):this.tSc=this.JE.loadScript("sharedComments"));return this.tSc.then(()=>{this.Rtj()})}Rtj(oa,Za){oa&&oa();this.vaf||(this.L7&&this.L7.execute(xb=>{xb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")}),Za&&Za(),sharedComments.instantiate(this.jhh,this.MMh,this.sbc,this.bTd,this.Tyh,this.lsh,this.fr));this.vaf=!0}}Object(f.a)(wg,"CommentActivationManager",null,[1836]);class Od extends aj{constructor(oa){super(oa)}FEo(oa){this.ZBo(oa)}tBp(oa){this.dak(oa)}tWj(oa){oa=this.JKl(oa);for(let Za=0;Za<this.jwa.count;++Za)Array.enqueue(this.jwa.K(Za).nua,oa);this.U1a(!0)}JKl(oa){const Za=new Lk;Za.eventType=3;Za.viewContainerVisibilityState=oa;return Za}Uhm(){const oa=
this.JRl();for(let Za=0;Za<this.jwa.count;++Za)Array.enqueue(this.jwa.K(Za).nua,oa);this.U1a(!0)}JRl(){const oa=new Lk;oa.eventType=2;return oa}}Object(f.a)(Od,"ViewContainerEventHost",aj,[1771]);class zg{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(zg,"CommentUIActionPayload",null,[]);var nh=e(320);class Vi{constructor(oa,Za){this.pRh=(xb,Zb,sc,$c,Ed)=>{if(this.OFc.Bb(xb)){var Ud=this.OFc.K(xb);if(!this.RDb.Bb(Ud))return 8;const Vd=this.RDb.K(Ud);if(Vd.preCallback){const Ie=Vd.preCallback(xb,
Zb,sc,$c,Ed);if(2!==Ie)return Ie}if(!Vd.registeredCallback)return 1===sc?8:2;Ud=Object.assign(new zg,{actionType:Ud});1===sc&&(Ud.actionBehavior=1);Ud=Vd.registeredCallback(Ud);return Vd.postCallback?Vd.postCallback(Ud,xb,Zb,sc,$c,Ed):Ud?32:8}return 2};this.ga=oa;this.RDb=Za;this.OFc=new nh.a;for(const xb of this.RDb)this.OFc.W(xb.value.canvasActionId,xb.key),oa=xb.value,oa.delayActionsUntilRegistration||this.qa(oa)}qa(oa){oa.withFlags?this.ga.nb(oa.canvasActionId,oa.canvasContextId,this.pRh,97):
this.ga.qa(oa.canvasActionId,oa.canvasContextId,this.pRh)}p1a(oa,Za){this.RDb.Bb(oa)&&(this.RDb.K(oa).delayActionsUntilRegistration&&this.qa(this.RDb.K(oa)),this.RDb.K(oa).registeredCallback=Za)}}Object(f.a)(Vi,"OfficeSharedCommentsActionHost",null,[1800]);var he=e(1845),td=e(89),kh=e(134),eg=e(1360),li=e(12),Ll=e(22),mi=e(565),Ek=e(1774),Ml=e(68),Qk=e(315),km=e(54),$l=e(15),ll=e(1054),tk=e(1047),am=e(1514),bf=e(243),Cj=e(10),Wh=e(34),zk=e(726),Hl=e(423),Xf=e(19),we=e(2102);class Rk{constructor(oa){this.$_=
oa;this.Gwc=new Ka.a;this.Jbb=new Ka.a;this.een();this.n7m=[new we.a(Wh.a.Q9h,Wh.a.rCl),new we.a(Wh.a.f_d,Wh.a.qCl),new we.a(Wh.a.I9h,Wh.a.eCl),new we.a(Wh.a.$Zd,Wh.a.dCl),new we.a(Wh.a.R9h,Wh.a.tCl),new we.a(Wh.a.g_d,Wh.a.sCl)]}t1a(oa){this.$_.t1a(oa);this.TFo(oa)}h3f(oa,Za){return!!oa&&!!oa.objectId&&Za.contains(Wa.a.Of(oa.objectId))}g_a(oa){oa=Object(N.a)(371,oa);return!!oa&&!!oa.objectId}TFo(oa){for(const Za of this.n7m)oa.classList.remove(Za.className,Za.n8c);oa.classList.remove(Wh.a.zog,Wh.a.i_d,
Wh.a.jtf,Wh.a.h_d,Rk.rUg)}een(){const oa=new Ka.a,Za=new Ka.a;oa.add(0,null);oa.add(1,Wh.a.f_d);oa.add(2,Wh.a.Q9h);oa.add(3,Wh.a.i_d);Za.add(0,null);Za.add(1,Wh.a.$Zd);Za.add(2,Wh.a.I9h);Za.add(3,Wh.a.jtf);this.Jbb.W(1,oa);this.Jbb.W(2,Za);this.Jbb.W(3,Za);this.Gwc.add(0,null);this.Gwc.add(1,Wh.a.g_d);this.Gwc.add(2,Wh.a.R9h);this.Gwc.add(3,Wh.a.h_d)}}Rk.rUg="CommentImportant";Object(f.a)(Rk,"CommentHighlightUtils",null,[]);class ml{constructor(){this.l4d=0;this.EOb=null}}Object(f.a)(ml,"CommentGuidsInElementInfo",
null,[]);class Nl{constructor(){this.ESi=!1;this.xta=this.CZb=null;this.T0a=this.wUb=0}}Object(f.a)(Nl,"HighlightInfoForElement",null,[]);class kk{constructor(){this.VVi=this.XVi=this.WVi=-1;this.XTi=[];this.yhc=[];this.m$c=this.n$c=-1;this.o0i=!1}}Object(f.a)(kk,"HighlightInfoForElementsInPara",null,[]);class Sn{constructor(){this.yOg=this.Kjg=null}}Object(f.a)(Sn,"OnAnchorMouseOutData",null,[]);var kg=e(1395);class gb{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud){this.RQe=oa;this.cfa=Za;this.Rn=xb;this.m7=
Zb;this.ga=sc;this.Sb=$c;this.Mj=Ed;this.t6a=this.$j=null;this.c3n=Vd=>{if(!this.$j||this.m7.She)return!0;if(Vd=Vd.er){if(this.$j.fD&&Vd[0].toString()===this.$j.fD.objectId)return!0;this.t6a&&Vd[0].equals(this.t6a.yOg[0])?this.Sb.Kf(this.t6a.Kjg):(this.t6a&&(this.Sb.Kf(this.t6a.Kjg),this.ga.Zb(li.a.j_d,2,this.t6a.yOg)),this.$j.hq.q0i(Vd[0])&&!this.Mj.Ln||this.ga.Zb(li.a.mtf,2,Vd));this.t6a=null}return!0};this.b3n=Vd=>{if(this.m7.She)return!0;const Ie=Vd.er;Ie&&(Vd=new Cb.a(2,1,0,()=>{this.ga.Zb(li.a.j_d,
2,Ie);this.t6a=null}),this.Sb.pc(Vd),this.t6a=Object.assign(new Sn,{Kjg:Vd,yOg:Ie}));return!0};this.spj=Vd=>{const Ie=new Cb.a(2,1,0,()=>{if(this.$j&&!this.$j.hq.$A){var Ue=Vd.er;if(!Ue)Ue=ze.StaticActiveAppFrame.Aa().yr.currentScope,this.$j.fD&&(!Ue||Ue.name!==bf.AFrame.pT&&Ue.name!==bf.AFrame.Xu)&&this.$j.clearSelection();else if(!this.$j.fD||Ue.toString()!==this.$j.fD.objectId)if(Ue=this.$j.hq.K4(Ue.toString()))Ue=Object.assign(new eg.a,{commentId:Ue.id,i6:!1,gea:1}),this.ga.Zb(Xf.a.selectComment,
2,Ue)}});this.Sb.pc(Ie);return!1};Ud.execute(Vd=>{this.$j=Vd})}J1h(oa,Za,xb,Zb){const sc=new kk,$c=[],Ed=this.cfa.g_a(Za)?Za.objectId:null;for(let Ie=0,Ue=oa.length;Ie<Ue;Ie++){var Ud=oa[Ie],Vd=kg.h(Ud);const dg=kg.e(Ud);Ud=new vh.a;const Pf=new Nl;if(Vd){const pc=new Hl.a(kg.c);Vd=this.fti(Vd,Ed,pc);0<Vd.length&&(this.ZEp(Vd,xb,Ud,Pf,Ed,Zb),$c.push(Object.assign(new ml,{l4d:Ie,EOb:pc})))}dg&&(Vd=this.fti(dg,Ed),0<Vd.length&&(this.aFp(Vd,xb,Ud,Pf,sc,Ed,Zb,Ie),this.sDp($c,Vd,Ie,Pf)));0<xb.count&&this.bFp(Za,
xb,Pf,Zb);this.qDp($c,Pf);sc.XTi.push(Pf)}return sc}mYh(oa,Za,xb){let Zb=!1;for(let sc=0,$c=oa.length;sc<$c;sc++){const Ed=oa[sc],Ud=Za.XTi[sc],Vd=zk.a(Ed);if(1!==Vd&&2!==Vd&&3!==Vd)continue;const Ie=3===Vd||2===Vd&&-1!==Ed.className.indexOf(Wh.a.ZYa);this.cfa.t1a(Ed);this.U3k(Ed,Ud,Ie,Zb);this.g2k(Ed,sc,Vd,Ud,Za,xb);this.h2k(Ed,sc,Za,Ud);Zb=Ie}}fti(oa,Za,xb=null){const Zb=[];for(let sc=0;sc<oa.length;sc++)this.RQe.RXj(oa[sc],oa[sc].toString()===Za)&&(Zb.push(oa[sc]),xb&&xb.add(oa[sc]));return Zb}ZEp(oa,
Za,xb,Zb,sc,$c){var Ed;let Ud=!1,Vd=!1;for(const Ue of oa){Za.add(Ue);xb.add(Ue);var Ie=Ue.toString();Ie===sc?(Ie=$c?1:2,Zb.T0a=Ie,Zb.wUb=Ie):this.h3f(this.$j.fD,Za)&&(Ie===(null===(Ed=this.$j.fD)||void 0===Ed?void 0:Ed.objectId)&&(Vd=!0),Ud=!0)}0<oa.length&&!Zb.T0a&&(Zb.T0a=Vd?1:3,Zb.wUb=Ud?1:3)}aFp(oa,Za,xb,Zb,sc,$c,Ed,Ud){var Vd,Ie;const Ue=new Hl.a(kg.c);Ed=Ed?1:2;let dg=!1;for(const Pf of oa){const pc=Pf.toString();Za.contains(Pf)||(pc===$c?sc.VVi=Ud:(sc.WVi=Ud,Zb.T0a=3,(null===(Vd=this.$j.fD)||
void 0===Vd?void 0:Vd.objectId)===pc&&(sc.XVi=Ud,Zb.T0a=1)),Ue.add(Pf));pc===(null===(Ie=this.$j.fD)||void 0===Ie?void 0:Ie.objectId)&&(dg=!0);Za.remove(Pf);xb.contains(Pf)&&this.$Ep(Zb,Pf,pc,$c,Ed);pc===$c&&(Zb.T0a=Ed)}0<oa.length&&!Zb.T0a&&(Zb.T0a=dg?1:3);0<Ue.count&&sc.yhc.push(Object.assign(new ml,{l4d:Ud,EOb:Ue}))}sDp(oa,Za,xb,Zb){0!==oa.length&&(Za.forEach(sc=>{for(let $c=oa.length-1;0<=$c;$c--){const Ed=oa[$c];if(Ed.EOb.contains(sc)){Ed.l4d===xb&&(Zb.xta?Zb.xta.push(sc):Zb.xta=[sc]);Ed.EOb.remove(sc);
break}}}),oa=oa.filter(sc=>0<sc.EOb.count))}bFp(oa,Za,xb,Zb){var sc,$c;this.h3f(oa,Za)?xb.wUb=Zb?1:2:xb.wUb||(xb.wUb=null!=(null===(sc=this.$j.fD)||void 0===sc?void 0:sc.objectId)&&Za.contains(Wa.a.Of(null===($c=this.$j.fD)||void 0===$c?void 0:$c.objectId))?1:3);xb.CZb||(xb.CZb=[]);for(const Ed of Za)xb.CZb.push(Ed)}qDp(oa,Za){if(0<oa.length){Za.xta||(Za.xta=[]);for(const xb of oa[oa.length-1].EOb)Za.xta.push(xb)}}$Ep(oa,Za,xb,Zb,sc){oa.ESi=!0;oa.CZb||(oa.CZb=[]);oa.CZb.push(Za);xb===Zb&&(oa.wUb=
sc)}h3f(oa,Za){return!!oa&&!!oa.objectId&&Za.contains(Wa.a.Of(oa.objectId))}U3k(oa,Za,xb,Zb){!Za.T0a||xb||Zb||((xb=this.cfa.Gwc.K(Za.T0a))&&oa.classList.add(xb),Za.ESi&&oa.classList.add(Wh.a.zog))}g2k(oa,Za,xb,Zb,sc,$c){Zb=this.cfa.Jbb.K(xb).K(Zb.wUb);Za<sc.VVi?Zb=$c?this.cfa.Jbb.K(xb).K(1):this.cfa.Jbb.K(xb).K(2):Za<sc.WVi&&!Zb&&(Zb=Za<sc.XVi?this.cfa.Jbb.K(xb).K(1):this.cfa.Jbb.K(xb).K(3));Zb&&(Za=sc.o0i,oa.classList.add(Zb),Za&&oa.classList.add(Rk.rUg))}h2k(oa,Za,xb,Zb){Zb.xta||(Zb.xta=this.Ysm(Za,
xb)||Zb.CZb);Za=null;Zb.xta&&0<Zb.xta.length&&(this.Rn.Cb(Cj.a.C5,oa,this.c3n,Zb.xta),this.Rn.Cb(Cj.a.JEa,oa,this.b3n,Zb.xta),Za=Zb.xta[0]);this.Rn.Cb(Cj.a.click,oa,this.spj,Za);this.Rn.Cb(Cj.a.gO,oa,this.spj,Za)}Ysm(oa,Za){for(;0<Za.yhc.length&&Za.yhc[0].l4d===oa;)Za.yhc.splice(0,1);if(0<Za.yhc.length){oa=[];for(const xb of Za.yhc[0].EOb)oa.push(xb);return oa}return null}}Object(f.a)(gb,"AllMarkupModeHighlightChangeHandler",null,[362]);var Fb=e(1364);class Wb extends Fb.a{constructor(oa){super(100,
25);this.MFc=new Ka.a(0);this.Zsk=6E4;this.shm=()=>{const Za=this.MFc.keys;if(Za.length){var xb="";for(let Zb=0;Zb<Za.length;Zb++)xb+=Za.K(Zb)+":"+this.MFc.K(Za.K(Zb))+";";this.axa(xb);this.MFc=new Ka.a(0)}};this.aEb=new T.a;this.aEb.add(1);this.aEb.add(6);this.aEb.add(2);this.aEb.add(4);this.aEb.add(10);this.aEb.add(11);this.uj=oa;oa.Otg&&window.setInterval(this.shm,this.Zsk)}JPa(oa){this.uj.kzp&&this.uj.Otg&&(this.aEb.contains(oa)?this.Jwo(oa):this.axa(oa+""))}Jwo(oa){this.MFc.W(oa,this.MFc.R4(oa,
0)+1)}}Object(f.a)(Wb,"CommentActionInTypingRecorder",Fb.a,[378]);var Cc=e(1569),id=e(226);class Ad{static fHo(oa){oa&&oa.atmention&&delete oa.atmention.isCurrentUser;return oa}}Object(f.a)(Ad,"DeltaFormatHelpers",null,[]);class Cd{constructor(){this.optional=this.attributes=null}}Object(f.a)(Cd,"Operation",null,[]);class qe extends Cd{constructor(){super();this.insert=null}}Object(f.a)(qe,"DeltaOperation",Cd,[]);class df{constructor(){this.ops=null}}Object(f.a)(df,"Delta",null,[]);var Ef=e(177),
Sf=e(154),Je=e(53),Ug=e(91),Kf=e(75),fl=e(110),Ji=e(513),lk=e(61),Sj=e(1169),dk=e(1567),Zd=e(1799);class qg{constructor(oa,Za,xb,Zb,sc){this.Qse=Za;this.id=xb;this.GUi=Zb;this.HUi=sc;this.WQi=oa}}Object(f.a)(qg,"CommentAttributedStringProps",null,[]);class sh{constructor(oa,Za){this.Eg=oa;this.kk=Za}}Object(f.a)(sh,"CommentParaInfo",null,[]);class qi extends dk.ACommentFormatTranslator{constructor(oa,Za,xb){super(oa,xb);this.Ge=Za}yGe(oa){const Za=new Cc.a;for(let xb=0;xb<oa.length;xb++){const Zb=
oa[xb];Zb.EVb=!0;this.wcl(Za,Zb);Za.Xna("\n")}return[Za.emc()]}ftp(oa,Za){oa=Cc.a.ktb(oa[0]);oa=this.yAj(oa);const xb=new T.a;let Zb=0,sc=null,$c=null;for(;Zb<oa.ops.length;){const Ed=oa.ops[Zb];sc||(sc=Sj.a.instance.createInstance(lk.a.paragraphNode),sc.EVb=!0,sc.Xg(Va.a.qd,id.a.BG()),Za(sc),sc.ra.clear(),sc.Fxa(""));"\n"===Ed.insert?($c=this.a9f(sc,$c),this.x7o(sc),xb.add(sc),sc=null):$c=this.gJn(sc,Ed,$c);Zb++}return xb.toArray()}Zsp(oa,Za,xb){oa=Cc.a.ktb(oa[0]);oa=this.yAj(oa);return Zd.a.aKl(oa,
Za,new qg(xb))}x7o(oa){const Za=oa.x3h();for(let xb=0;xb<Za;xb++)oa.Bf.rU(xb)}a9f(oa,Za){var xb=oa.N4d();xb.cp===oa.characterData.length?xb.Ui=!0:(xb=Object.assign(new Ef.a(oa,oa.characterData.length),{Ui:!0}),oa.ra.add(xb));xb=oa.ra.last;if(Za){Za=!!Za.cA;const Zb=this.mai(oa,xb,!Za,Za,null);xb.formatting=Zb;Za&&(oa=this.kai(oa,xb),xb.a5=oa.ol);xb.Qp=!0;Za=null}xb.cp||xb.formatting||(xb.formatting=new Sf.a(xb,Wa.a.nil));return Za}gJn(oa,Za,xb){const Zb=oa.N4d(),sc=!!Za.attributes&&!!Za.attributes.link,
$c=!!Za.attributes&&!!Za.attributes.atmention,Ed=this.mai(oa,Zb,sc,$c,Za);Zb.formatting=Ed;xb&&(xb.cA&&(xb=this.kai(oa,Zb),Zb.a5=xb.ol),Zb.Qp=!0,xb=null);if(sc||$c)this.CIn(Zb,oa,Za),xb=Zb.hyperlink;oa.Fxa(oa.characterData+Za.insert);return xb}kai(oa,Za){Za=new Sf.a(Za,Wa.a.create());let xb=this.m1d();xb.setValue(Va.a.AWb,!0);xb=oa.ed.mU(xb);Za.ol=xb.id;return Za}mai(oa,Za,xb,Zb,sc){Za=new Sf.a(Za,Wa.a.create());let $c=Sj.a.instance.createInstance(lk.a.q2a);if(xb||Zb)$c.setValue(qd.a.tG,!0),$c.setValue(qd.a.dda,
!0),xb&&this.PZo(oa,$c);sc&&sc.attributes&&this.Y4o(sc.attributes,$c);$c=oa.ed.mU($c);Za.ol=$c.id;return Za}PZo(oa,Za){(oa=this.Ge.pG(oa))&&(oa=oa.Qg(Je.a.AEc))&&Za.setValue(vb.a.wy,oa.id)}Y4o(oa,Za){this.o2b(oa.weight>=Cc.a.Egd,Za,qd.a.bold,!0);this.o2b(oa.italic,Za,qd.a.italic,!0);this.o2b(oa.underline,Za,qd.a.underline,!0);this.o2b(oa.underline,Za,qd.a.underlineType,Ug.a.JCb);this.o2b(oa.strikethrough,Za,qd.a.strikethrough,!0);if(Kf.a.$rc(oa.highlight)){var xb=Kf.a.wub(oa.highlight);this.o2b(!!oa.highlight,
Za,qd.a.highlight,Kf.a.gja(xb))}Kf.a.$rc(oa.color)&&(xb=Kf.a.wub(oa.color),this.o2b(!!oa.color,Za,qd.a.fontColor,Kf.a.gja(xb)))}o2b(oa,Za,xb,Zb){oa&&Za.setValue(xb,Zb)}CIn(oa,Za,xb){if(xb.attributes&&xb.attributes.atmention){var Zb=fl.a.Qua(xb.attributes.atmention.email);xb=xb.optional&&xb.optional.atmention&&xb.optional.atmention.contentId?xb.optional.atmention.contentId:Object(kg.d)(1===xb.attributes.atmention.resolveState);Zb=new Ji.a(oa,Zb,!0,void 0,void 0,void 0,xb);this.DJl(Zb,Za.ed);oa.hyperlink=
Zb}else Za=fl.a.Qua(xb.attributes.link),Zb=this.EMl(oa.paragraph.ra.first),oa.hyperlink=new Ji.a(oa,Za,!1,Zb.ol)}EMl(oa){let Za=this.Bfi();Za=oa.paragraph.ed.mU(Za);oa=new Sf.a(oa,Wa.a.nil);oa.ol=Za.id;return oa}DJl(oa,Za){var xb=String.format(' HYPERLINK "{0}"',oa.url),Zb=oa.cA;const sc=this.m1d();sc.setValue(Va.a.gu,15);sc.setValue(Va.a.cA,Zb);sc.setValue(Va.a.d_a,!0);sc.setValue(Va.a.G4,xb);oa.gBa(Za.mU(sc).id);Zb=this.m1d();Zb.setValue(Va.a.gu,47);Zb.setValue(Va.a.G4,xb);oa.gBa(Za.mU(Zb).id);
xb=this.m1d();xb.setValue(Va.a.gu,16);oa.gBa(Za.mU(xb).id)}Bfi(){const oa=Sj.a.instance.createInstance(lk.a.q2a);oa.setValue(qd.a.tG,!0);oa.setValue(qd.a.dda,!0);oa.setValue(qd.a.isHidden,!0);return oa}m1d(){const oa=this.Bfi();oa.setValue(qd.a.Gea,!0);return oa}yAj(oa){const Za=new T.a;for(let xb=0;xb<oa.ops.length;xb++){const Zb=oa.ops[xb];Zb.optional=Ad.fHo(Zb.optional);if(-1!==Zb.insert.indexOf("\n")&&"\n"!==Zb.insert){const sc=Zb.insert.split("\n");for(let $c=0;$c<sc.length;$c++)if(xb!==oa.ops.length-
1||$c!==sc.length-1||sc[$c])Za.add(Object.assign(new qe,{insert:sc[$c],attributes:Zb.attributes,optional:Zb.optional})),$c!==sc.length-1&&Za.add(Object.assign(new qe,{insert:"\n"}))}else Za.add(Zb)}return Object.assign(new df,{ops:Za.toArray()})}}qi.gmj=0;Object(f.a)(qi,"CommentDeltaFormatTranslator",dk.ACommentFormatTranslator,[]);var Dm=e(1687),Ci=e(1516);class nj{get userPrincipalName(){return this.J.rb("UserPrincipalName")}constructor(oa,Za,xb,Zb,sc){this.Oj=oa;this.J=Za;this.hH=xb;this.lh=Zb;
this.vE=sc}tH(oa){return this.Oj.tH(oa)}wnn(oa){oa=this.Oj.tH(oa);return oa?!oa.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}dbd(oa){return this.Oj.dbd(oa)}isCurrentUserMentioned(oa){var Za,xb;oa=this.Oj.Nsm(oa);for(const Zb of oa){if(!Zb.text||0===Zb.text.length)continue;oa=Cc.a.ktb(Zb.text[0]);let sc=0;for(;oa.ops&&sc<oa.ops.length;){const $c=null===(xb=null===(Za=oa.ops[sc])||void 0===Za?void 0:Za.attributes)||void 0===xb?void 0:xb.atmention;if($c&&
$c.email===this.userPrincipalName)return!0;sc++}}return!1}hid(){this.hH.G2("OnContentFilterUpdate")}Wja(){var oa;this.lh.Ln&&(null===(oa=this.vE)||void 0===oa?void 0:oa.execute(Za=>Za.logActivity("WordWebCommentFilterActivity","CommentFilterFpsIsEnabled")))}}Object(f.a)(nj,"CommentFilterActor",null,[375]);var mk=e(148),Jc=e(2095),Ha=e(918),eb=e(618);class rc{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd){this.Ri=oa;this.Sb=Za;this.Tk=xb;this.Y3a=Zb;this.Mj=sc;this.I_=$c;this.$h=Ed;this.GY=Ud;this.uU=Vd;
this.rGb=null;this.Adf=0;this.JId=!1;this.eNd=0;this.V4b=this.ctd=this.ngh=this.PMc=this.eMb=!1;this.RDc=()=>{this.GY.oGg()&&this.$h.RDc(this.JId,this.rlg)};this.kyb=()=>{this.$h.Lsa.Fva()&&(this.xnd(this.$h.Lsa.Xc),this.$h.Lsa.ayc(this.kyb))};this.rlg=()=>{this.Zhb();this.GY.qlg()};this.lJg=()=>{!this.eMb&&this.GY.zFg()&&(this.eNd=this.Jff.scrollTop,this.eMb=!0,this.Y3a.JPa(2))};this.aug=(Ie,Ue)=>{this.eMb&&(Ie=this.Jff.scrollTop,Ie-this.eNd?(this.PMc||Ue.NJe||this.updatePosition(),this.PMc||1!==
Ue.NJe||this.Zhb(),this.nkf(Ie),this.GY.nkg()):this.PMc=this.eMb=!1)};this.Jff=this.$h.eka;this.fpa=eb.a.tse;this.Ov=this.$h.Ov;this.$h.bai()}get xhe(){return this.GY.u4f()}get fpa(){return this.$h.fpa}set fpa(oa){this.$h.fpa=oa}get fZh(){return"1"===this.Ov.iJ.style.opacity}cXj(oa){this.ctd||(this.ctd=!0,this.$h.Jzj(),this.rGb=oa(this.Ov.Una,this.$h.cJj,()=>{this.updatePosition()}),this.$h.Qej(this.rGb),this.GY.initialize(this.rGb,this),this.$h.initialize(this.rGb,this.GY.nyb),this.$h.zGj(),this.$h.XWj(),
this.$h.YWj(),this.$h.bXj(this.GY.Cnf,this.GY.mre,this.GY.lre),this.Iug())}fAc(){}oCe(){return this.$h.VXj()}setInitialActiveContainerId(oa,Za,xb=null){this.$h.setInitialActiveContainerId(oa,0,xb)}updatePosition(){if(!this.V4b&&this.xhe&&this.Ri.Zua()){var oa=ja.a.We()-this.Adf<eb.a.vdk;oa||this.JId||this.Zhb(oa)}}Hmf(){this.Zhb()}V1a(oa,Za,xb){this.I_.G2("OnFloatingCommentsVisibilityChange",!0);this.$h.V1a(oa,Za,xb)}BLa(oa,Za,xb=!1){this.$h.BLa(oa,Za,()=>{this.Ri.K8c()||this.$h.Mde();this.GY.uig()},
xb)}Jec(oa,Za,xb){this.$h.Jec(oa,Za,xb,this.$h.ki,this.GY.O6c,this.GY.chg)}hyj(oa){this.V4b=!0;oa();this.V4b=!1}yod(oa,Za,xb){this.$h.yod(oa,Za,xb)}khc(){this.$h.khc()}Tdk(){const oa="1"===this.Ov.iJ.style.opacity;switch(!0){case oa&&!this.Ri.K8c():this.$h.Mde();break;case !oa&&this.Ri.K8c():this.$h.j3b()}}HMg(oa=!0){this.GY.iGg&&this.$h.c7j(oa)}static kCi(oa,Za=null){const xb=new Ga.a;for(const Zb of oa)Zb.kg||Zb.kt!==Jc.a.$F&&(!Za||Za(Zb))&&rc.P0k(xb,Zb.objectId,Zb);return xb}static P0k(oa,Za,xb){let Zb;
({value:Zb}=oa.Nc(Za,Zb)).returnValue||(Zb=[],oa.W(Za,Zb));Zb.push(xb)}xnd(oa){oa&&(oa.d8(()=>{this.RDc()}),this.eNd=this.Jff.scrollTop,oa.kVh(this.lJg),oa.lVh(this.aug))}Iug(){this.$h.ki?this.xnd(this.$h.ki):this.$h.Lsa?this.$h.Lsa.bfc(this.kyb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}nkf(oa){this.Ov.iJ.style.top=oa-this.eNd+"px";this.PMc=!1}Zhb(oa=!1){oa=new Cb.a(0,1,0,()=>{this.xBf()},129,void 0,!oa);this.Sb.pc(oa);this.JId=!0;this.PMc=
this.eMb;this.Y3a.JPa(10)}OPf(oa){return this.$h.LWa({contentAnchorPositions:oa.contentAnchorPositions})}xBf(){this.JId=!1;if(this.Ov.Una&&this.rGb&&this.Ri.Zua()){this.$h.a5d();var oa=0;this.Tk.Ae(()=>{oa=this.$h.p9d()},"FCM:UP:GET");var Za=null,xb=null;this.Tk.Ae(()=>{const Zb=this.GY.HAi(oa,this.$h.ki);Za=Zb.cDl;xb=this.OPf(Zb)},"FCM:UP:GP");this.Tk.Ae(()=>{this.eMb?(this.$h.qoi(xb),this.eMb=!1):this.rGb.emitEvent(3,xb);this.I_.zwe()},"FCM:UP:RC");this.rGb.setFirstCommentRenderDone();"0"===this.Ov.iJ.style.opacity&&
0<Za.count&&!this.Mj.Ln&&this.Mj.tQa&&this.Tk.Ae(()=>{this.$h.j3b()},"FCM:UP:SFC");!this.ngh&&0<Za.count&&(Gh.a.c8(this.Sb,this.$h.pfj,gj.a.ofj),this.ngh=!0);this.Adf=ja.a.We();this.Y3a.JPa(6)}else this.Adf=ja.a.We()}}Object(f.a)(rc,"FloatingCommentManager",null,[352,353]);var Uc=e(135),bd=e(1365),Hd;(function(oa){oa[oa.avq=0]="singleHint";oa[oa.Hlq=1]="multiHint";oa[oa.ksq=2]="resolvedHint";oa[oa.Ilq=3]="multiResolvedHint";oa[oa.entryPoint=4]="entryPoint";oa[oa.unknown=void 0]="unknown"})(Hd||(Hd=
{}));Object(f.b)("CommentIconType",Hd);var Pe=e(152),Le=e(1127);const De={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Hd.unknown]:""},lf={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter",
"OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Hd.unknown]:[]},Af=(oa,Za)=>{switch(oa){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Za){case 3:return Le.a.X9h;
case 2:return Le.a.Y9h;case 1:return Le.a.Z9h}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Za){case 3:return Le.a.U9h;case 2:return Le.a.V9h;case 1:return Le.a.W9h}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Za){case 3:return Le.a.$9h;case 2:return Le.a.a$h;
case 1:return Le.a.b$h}}},mg=(oa,Za)=>{Pe.a("renderIcon")&&appChrome.api.renderIcon(oa,Za)};class hi{}hi.YTi=16;hi.P8m=1;hi.aYf=20;hi.Cik=2;Object(f.a)(hi,"CommentIconConstants",null,[]);class Uh{constructor(){this.a_d=0;this.pWc=!1}}Object(f.a)(Uh,"CommentHintCensus",null,[]);class nk{constructor(oa,Za,xb,Zb,sc){this.nhh=oa;this.YAa=xb;this.Azk=Zb;this.zma=sc;this.wVa=-1;this.QQe=new Set(Za)}get y(){if(-1!==this.wVa)return this.wVa;const oa=Sys.UI.DomElement.getBounds(this.nhh),Za=this.nhh.getClientRects();
return this.wVa=0<Za.length&&Za[0]?this.Azk?oa.y/this.YAa+hi.Cik:Math.floor(Za[0].height)/(2*this.YAa)+oa.y/this.YAa-hi.YTi/2:0}get e_d(){return Array.from(this.QQe)}y5k(oa){this.QQe=new Set([...this.QQe,...oa])}}Object(f.a)(nk,"HintInfo",null,[383]);class fi extends bd.a{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc){super();this.uj=oa;this.xh=Za;this.Rn=xb;this.dQ=Zb;this.ga=sc;this.Ri=Ie;this.Xya=Ue;this.Y3a=dg;this.Mj=Pf;this.Zwk=pc;this.xBd=new Map;this.RGb=this.GKb=null;this.WCc={rCb:-1,
Lfg:-1}}s2a(oa){let Za=!1;qb.a.Phk&&oa.rc.Aj?sa.a.instance.Ae(()=>{Za=kg.o(oa,!0)},"CHA:SCIVE"):sa.a.instance.Ae(()=>{Za=kg.n(oa.htmlElement,!0)},"CHA:SCI");return Za}JWa(oa){const Za=this.zoom,xb=oa.z2,Zb=oa.rNa;let sc=0;for(let Ud=0;Ud<oa.l9.length;Ud++)if(0<oa.l9[Ud].width){sc=Ud;break}const $c=oa.Y8a(1,hi.aYf,Za,sc);this.Y3a.JPa(1);let Ed=[];Zb.forEach((Ud,Vd)=>{const Ie=oa.l9[Vd].y/Za;Ud=this.VMl(this.UBm(Ud,Vd),Ue=>this.FMl(xb,Ue,Ue.y-Ie,$c),()=>fi.MOl(xb));Ed=Ed.concat(Ud)});return Ed}VMl(oa,
Za,xb){xb=xb();const Zb=[];for(const sc of oa){oa=Za(sc);for(const Ed of sc.e_d)this.xBd.set(Ed.toString(),oa);const $c=this.cIi(sc.e_d);this.lck($c,oa);null==xb.zma&&(xb.zma=sc.zma);xb.appendChild(oa);Zb.push(oa)}this.toc(this.RGb);this.Bub(this.GKb);return[xb]}cIi(oa){var Za,xb;let Zb=0,sc=0;for(const $c of oa)if(this.Ri.t3f($c)){if(this.uj.contentFilterApiEnabled&&this.Mj.Ln&&(oa=this.Ri.K4($c.toString()),null===(xb=(Za=this.Zwk).isContentInFilteredContent)||void 0===xb||!xb.call(Za,oa.id)))continue;
this.Ri.q0i($c)?sc+=1:Zb+=1}Za=new Uh;Za.a_d=Zb+sc;Za.pWc=0===Zb;return Za}KDc(oa){if(oa=this.xBd.get(oa.objectId)){var Za=kg.h(oa);Za=this.cIi(Za);this.lck(Za,oa)}}lck(oa,Za){let xb,Zb;if(this.uj.contentFilterApiEnabled&&0===oa.a_d)Za.style.display="none";else if(1===oa.a_d?(xb=oa.pWc?2:0,Zb=oa.pWc?WacWordeditorStrings.CommentHintIcon_SingleResolvedLabel:WacWordeditorStrings.CommentHintIcon_SingleActiveLabel):1<=oa.a_d&&(xb=oa.pWc?3:1,Zb=oa.pWc?WacWordeditorStrings.CommentHintIcon_MultiResolvedLabel:
WacWordeditorStrings.CommentHintIcon_MultiActiveLabel),Za.style.display="block",oa=Za.firstElementChild)this.A1o(oa,xb),oa.title=Zb+". "+oa.title,mg(De[xb],oa)}A1o(oa,Za){oa.title=WacWordeditorStrings.CommentHintIcon_UserActionStatement;Uc.a.un(oa,fi.c$h,Za)}UBm(oa,Za){oa=this.GMl(oa,Za);oa.sort((xb,Zb)=>xb.y-Zb.y);return this.FTn(oa)}GMl(oa,Za){const xb=[],Zb=this.uj.qt,sc=this.zoom;oa=kg.g(oa,!0);for(let $c=0,Ed=oa.length;$c<Ed;$c++){const Ud=oa[$c],Vd=kg.h(Ud);Vd&&xb.push(new nk(Ud,Vd,sc,Zb,Za))}return xb}FTn(oa){let Za=
null;const xb=[];for(let Zb=0;Zb<oa.length;Zb++)Za&&Math.abs(oa[Zb].y-Za.y)<hi.YTi+hi.P8m?Za.y5k(oa[Zb].e_d):(Za=oa[Zb],xb.push(Za));return xb}FMl(oa,Za,xb,Zb){const sc=oa.Gh.ownerDocument,$c=sc.createElement("div");$c.className=fi.S9h;$c.style.top=xb+"px";$c.style.left=Zb+"px";$c.style.right="auto";$c.style.zIndex="40";Uc.a.un($c,Wh.a.ZYc,Za.e_d);Za=sc.createElement("span");this.GPg(Za,$c);mg(De[0],Za);this.EG(Za,oa);return $c}GPg(oa,Za){oa.title=CommonUIStrings.l_CommentHintTooltip;oa.setAttribute("role",
"button");Za.appendChild(oa)}EG(oa,Za){this.xh.wK(Cj.a.click,oa,this.H5n.bind(this),Za);this.xh.Cb(Cj.a.dF,oa,this.K5n.bind(this));this.Rn.Cb(Cj.a.C5,oa,this.M5n.bind(this));this.Rn.Cb(Cj.a.pK,oa,this.L5n.bind(this));this.dQ.Cb(oa,this.J5n.bind(this))}static MOl(oa){oa=oa.Gh.ownerDocument.createElement("div");oa.className=fi.Cdo;return oa}J5n(){return!0}K5n(){return!0}H5n(oa){const Za=kg.h(oa.uy.parentNode);oa.eventName===Cj.a.gO&&(this.Xya.Trf(),this.Q7h());this.ga.Zb(li.a.T9h,2,Za);return!0}M5n(oa){this.FMa(this.RGb)!==
oa.uy&&(oa=kg.h(oa.uy.parentNode),this.ga.Zb(li.a.mtf,2,oa));return!0}L5n(){this.ga.Vb(li.a.j_d,2);return!0}toc(oa){this.Q7h();this.RGb=oa;this.wdl()}wdl(){this.xdl(this.FMa(this.RGb),this.FMa(this.GKb))}Bub(oa){this.byl();this.GKb=oa;if(oa=this.FMa(this.GKb)){const Za=this.d$d(oa);this.aBe(oa,Za,1)}}FMa(oa){if(!oa)return null;let Za=null;if(oa=this.Ri.K4(oa))if(oa=oa.kg?this.Ri.tH(oa.kg):oa)Za=oa.objectId;return Za&&this.xBd.has(Za)?this.xBd.get(Za).firstChild:null}Q7h(){this.dyl(this.FMa(this.RGb),
this.FMa(this.GKb))}dyl(oa,Za){if(oa){const xb=this.d$d(oa);this.aBe(oa,xb,oa===Za?1:3);this.RGb=null}}xdl(oa,Za){oa&&(oa.title=0<this.WCc.Lfg&&1<this.WCc.rCb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.WCc.Lfg,this.WCc.rCb):CommonUIStrings.l_CommentHintTooltip,Za!==oa&&(Za=this.d$d(oa),this.aBe(oa,Za,2)))}byl(){const oa=this.FMa(this.RGb),Za=this.FMa(this.GKb);if(Za){const xb=this.d$d(Za);this.aBe(Za,xb,oa===Za?2:3);this.GKb=null}}aBe(oa,Za,xb){this.Xrn()?
this.p1o(oa,xb):this.r3o(oa,Za,xb)}p1o(oa,Za){oa=null===oa||void 0===oa?void 0:oa.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===oa||void 0===oa?void 0:oa.length)&&(oa[0].style.fill=2===Za||1===Za?"Highlight":"ButtonText")}r3o(oa,Za,xb){Za=lf[Za];for(let sc=0;sc<Za.length;sc++){var Zb=Za[sc];const $c=Af(Zb,xb);if(!this.von($c)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${$c}.`);break}Zb=null===oa||void 0===oa?void 0:oa.querySelectorAll("."+Zb);0<(null===
Zb||void 0===Zb?void 0:Zb.length)&&(Zb[0].style.fill=`var(${$c})`)}}Xrn(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}d$d(oa){return Uc.a.Mb(oa,fi.c$h)}von(oa){var Za;const xb=document.getElementById(Ml.a.x1c);return!(null===(Za=null===xb||void 0===xb?void 0:xb.style)||void 0===Za||!Za.getPropertyValue(oa))}}fi.S9h="clip16x16 HintContainer";fi.Cdo="OutlineElementHintMargin";fi.c$h="CommentIconType";Object(f.a)(fi,"CommentHintActor",bd.a,[370]);var kc=
e(1009);class Ze extends kc.a{get iGg(){return this.W4()}get BBf(){return this.NRp.bMi()}constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue){super();this.lh=oa;this.zv=Za;this.Oj=xb;this.jj=Zb;this.STd=sc;this.hH=$c;this.$h=Ed;this.getSelectedText=Ud;this.NRp=Vd;this.focusManager=Ie;this.aqb=Ue;this.Thd=()=>{};this.bqe=()=>{};this.Fdh=!1;this.Ztl={[0]:()=>this.dji(),[1]:()=>this.ZAc.Hmf(),[2]:()=>this.dji()};this.qlg=()=>{this.STd.JPa(11)};this.Cnf=dg=>{for(const Pf of kg.v)dg.bindAction(mk.KeyInputManager.Jy(Pf),
Xf.a.Cpf)};this.mre=()=>{this.bqe()};this.lre=(dg,Pf)=>{if(dg.name!==bf.AFrame.Xu&&Pf){var pc=this.Oj.Nv?this.Oj.Nv.id:"";this.lh.dZb||(this.lh.dZb=Gh.a.c8(this.jj,()=>{this.Thd(pc)}))}};this.Utj=()=>{};this.nyb=()=>{this.KZj()};this.chg=(dg,Pf)=>{0===Pf&&(this.hH.zwe(),this.STd.JPa(0))};this.uig=()=>{this.STd.JPa(5)};this.O6c=dg=>{let Pf=0;const pc=this.Oj.vT();for(let yi=0;yi<pc.length;yi++){if(pc[yi].kg||pc[yi].done)continue;if((pc[yi].kt===Jc.a.$F?pc[yi].yC.draftId:pc[yi].id)===dg.contentId)break;
const Ei=this.hA.getContentAnchorPosition(pc[yi].id);!Ei||4<Math.abs(dg.anchorTop-Ei.anchorTop)||Pf++}return Pf};this.woj=()=>{this.hH.zwe()};this.nkg=()=>{this.STd.JPa(2)};this.KZj=()=>{if(!this.Fdh&&this.$h.eka){const dg=this.$h.eka.getElementsByClassName(fi.S9h);for(let Pf=0;Pf<dg.length;Pf++)dg[Pf].style.opacity="1";this.Fdh=!0}}}initialize(oa,Za){this.hA=oa;this.ZAc=Za;this.ynd();this.zv.ribbonCommentFilteringEnabled&&this.bDo();this.dDo()}M0o(oa,Za){this.bqe=oa;this.Thd=Za}QAi(oa,Za){return{x8a:this.ytm(oa,
Za),containerContentByType:{}}}HAi(oa,Za){const xb=rc.kCi(this.Oj.vT(),this.Oj.boa),Zb=[],sc=kg.f(!0);var $c=this.Oj.vT();Za=this.fpo(Za,$c,xb);!Za.Npg&&Za.contentAnchorPosition&&(Zb.push(Za.contentAnchorPosition),Za.contentAnchorPosition=null);for($c=0;$c<sc.length;$c++){const Ed=sc[$c],Ud=kg.h(Ed);if(Ud)for(let Vd=0;Vd<Ud.length;Vd++){const Ie=this.getContentAnchorPosition(oa,xb,Ed,Ud[Vd]);Ie&&(Zb.push(Ie),Za.Npg&&Za.contentAnchorPosition&&Ie.contentId===Za.Npg.id&&(Zb.push(Za.contentAnchorPosition),
Za.contentAnchorPosition=null))}}Za.contentAnchorPosition&&Zb.splice(0,0,Za.contentAnchorPosition);return{cDl:xb,contentAnchorPositions:Zb}}u4f(){var oa;return!(null===(oa=this.hA)||void 0===oa||!oa.getAreContainersEnabled())}W4(){return this.Oj.Zua()}zFg(){return this.W4()}Dsd(){return this.W4()}oGg(){return this.hA&&this.$h.eka&&this.W4()}Ftp(){this.hH.G2("OnFloatingCommentsVisibilityChange",this.lh.tQa);if(this.lh.tQa)this.$h.j3b();else{const oa=this.Oj.DL;oa.fD&&oa.clearSelection();this.$h.Mde()}}Itj(oa){0!==
oa&&this.Thd(this.Oj.Nv?this.Oj.Nv.id:"")}getContentAnchorPosition(oa,Za,xb,Zb){let sc=null;return({value:sc}=Za.Nc(Zb.toString(),sc)).returnValue?(Za=sc[0])&&!Za.kg?{...(new Ha.a),anchorTop:(eb.a.K5c(xb)-oa)/this.$h.Lga,anchorLeft:0,containerContentType:0,contentId:Za.id}:null:null}fpo(oa,Za,xb){var Zb,sc;const $c={};"CREATE"===(null===(sc=null===(Zb=this.Oj.$A)||void 0===Zb?void 0:Zb.yC)||void 0===sc?void 0:sc.sessionType)&&(Zb=this.$h.eka.querySelectorAll(kg.b),oa=this.$h.nyi((0<Zb.length?Zb[0]:
null)||this.getSelectedText(),this.Oj.$A.yC.draftId,0,oa),$c.Npg=this.wLm(Za,xb),$c.contentAnchorPosition=oa);return $c}wLm(oa,Za){var xb=Array.indexOf(oa,this.Oj.$A);for(--xb;-1<xb;xb--)if(Za.Bb(oa[xb].objectId))return oa[xb]}ytm(oa,Za){return this.HAi(oa,Za).contentAnchorPositions}ynd(){this.hH.H2("OnAfterTrackChangeMarkupViewChange",(oa,Za)=>{if(Za)this.Ztl[Za.nl]()})}dDo(){this.hH.H2("OnFloatingCommentsToggle",this.Ftp.bind(this))}dji(){const oa=kg.j();if(0!==oa.length){var Za=rc.kCi(this.Oj.vT()),
xb=this.Oj.DL;for(let Zb=0;Zb<oa.length;Zb++){const sc=kg.h(oa[Zb]);for(let $c=0;$c<sc.length;$c++){let Ed;({value:Ed}=Za.Nc(sc[$c].toString(),Ed)).returnValue&&(Ed.forEach(Ud=>{var Vd;Ud&&!Ud.kg&&(this.ZAc.BLa(Ud.id,0,!1),(null===(Vd=xb.fD)||void 0===Vd?void 0:Vd.id)===Ud.id&&xb.clearSelection())}),this.focusManager.Rg(bf.AFrame.Co))}}}}bDo(){this.hH.H2("OnContentFilterUpdate",this.P4n.bind(this))}P4n(){var oa;let Za=[],xb=[];null===(oa=this.aqb)||void 0===oa?void 0:oa.getAllContent().forEach(Zb=>
{this.aqb.isContentInFilteredContent(null===Zb||void 0===Zb?void 0:Zb.contentId)?Za.push(Zb):xb.push(Zb)});this.$h.cdm(Za,xb)}}Object(f.a)(Ze,"CommentFloatingContainerActor",kc.a,[373]);var Fg=e(1367),ii=e(329),te=e(2103),pe=e(207);class Ee extends Fg.a{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd){super();this.HJk=oa;this.wjb=Za;this.RQe=xb;this.Tk=sc;this.cfa=Ud;this.I_=Vd;this.$j=null;this.nl=1;Zb.execute(Ie=>{this.$j=Ie});this.w7=[];this.KHc=new pe.ScriptSharpLegacyMap;this.QAo($c,Ed);this.ynd()}get fl(){return this.HJk.value}get kCl(){return this.wjb}get Fha(){return!!this.$j}get Cub(){return 0}get Kbb(){return this.w7}get Hqh(){return this.KHc.Bb(this.nl)?
this.KHc.K(this.nl):this.KHc.K(0)}g_a(oa){return this.cfa.g_a(oa)}fbb(oa,Za){if(oa=Object(N.a)(371,oa))for(const xb of this.xpo(oa))Za.add(xb)}$Oa(oa,Za){this.Fha&&this.Tk.Ae(()=>{this.c8n(oa,Za)},"CHA:OPHC")}c8n(oa,Za){if(this.$j.hq.Zua()){var xb=this.Yt.pLa,Zb=new Vb.a(new ii.a),sc=Za.DPa("*"),$c=this.ctm(xb),Ed=!!xb&&!xb.action||!!$c&&$c===this.$j.fD,Ud;this.Tk.Ae(()=>{this.RQe.uJm(oa.id,Zb,null===$c||void 0===$c?void 0:$c.objectId)},"OPHC:GOI");this.Tk.Ae(()=>{Ud=this.Hqh.J1h(sc,$c,Zb,Ed);Ud.o0i=
this.m0i(xb)&&0===xb.action},"OPHC:BHI");this.Tk.Ae(()=>{this.Hqh.mYh(sc,Ud,Ed)},"OPHC:AH")}}ctm(oa){let Za=null;!this.m0i(oa)||0!==oa.action&&2!==oa.action||(Za=this.Yt.pLa.ZD);return Za||this.$j.fD}xpo(oa){if(!oa)return[];oa=this.fl.Mb(Wa.a.Of(oa.objectId));return this.kCl.qae(oa,null)}AHj(){return!1}pJ(oa,Za,xb){this.Fha&&(oa=Object.assign(new te.a,{action:oa,type:0,ZD:Za,XN:xb}),this.Yt.pJ(oa))}Trf(){this.Fha&&(this.pJ(3,this.$j.Foc,this.$j.Foc),this.$j.Foc=null)}QAo(oa,Za){this.KHc.add(1,oa);
this.KHc.add(0,Za)}ynd(){this.I_.H2("OnBeforeTrackChangeMarkupViewChange",(oa,Za)=>{Za&&Za.sfg!==this.nl&&(this.nl=Za.sfg)})}m0i(oa){return oa&&0===oa.type}}Object(f.a)(Ee,"CommentHighlightActor",Fg.a,[372,307]);var rd=e(1037),wj=e(601),ui=e(530),Ch=e(1412);class $g{constructor(oa,Za){this.QCl=oa;this.Wgg=Za}}Object(f.a)($g,"CommentEndParaIdBeforeChangeInfo",null,[]);var fa=e(1570);class Ya{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud){this.i7f=oa;this.lh=Za;this.Oj=xb;this.hH=Zb;this.$r=sc;this.Om=$c;this.oCl=
Ed;this.zv=Ud;this.NEb=null;this.lpo=()=>{if(!this.Oj.Zua()){var Vd=kg.m();[Wh.a.jtf].forEach(Ie=>{this.Ayl(Vd,Ie)})}};this.gpo=(Vd,Ie)=>{(Vd=Ie.vL)&&!kg.u(Vd)&&(Ie=this.Oj.gLf(Vd),Wa.a.Kx(Ie.Ftd,Ie.j2c)||this.Hbk(Ie,Vd)||this.p6h(Ie.OKa,Ie.wWa,Vd)||this.UPg(Vd))};this.S1n=(Vd,Ie)=>{Ie.property===Va.a.ICa&&(Vd=kg.i(Ie.node,Wa.a.nil),this.NEb=new $g(Ie.node.id,Vd))};this.e3n=(Vd,Ie)=>{Vd=Ie.node;if(Ie.property===Va.a.ICa&&Vd){var Ue=kg.l(Vd,Wa.a.nil);Ie=kg.i(Vd,Wa.a.nil);var dg=this.NEb?this.Hd.Mb(this.NEb.Wgg):
null;!kg.u(Vd)&&Ue&&!Ue.equals(Ie)&&this.NEb&&Vd.id.equals(this.NEb.QCl)&&!Ue.equals(this.NEb.Wgg)&&dg&&dg.isConnected&&this.hif(this.NEb.Wgg,Vd.id);Ie&&this.lh.fB.Bb(Ie)&&(Ue=this.lh.fB.K(Ie),Ue.Fbb&&(a.ULS.shipAssertTag(572835481,327,!!Ue.tR,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),Ue.tR&&Ue.tR.contains(Vd.id)&&(Ue.tR.remove(Vd.id),Ue.tR.count||(Ue.Fbb=!1),this.lh.JZ.Bb(Vd.id)?this.lh.JZ.K(Vd.id).remove(Ie):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};
this.Iid=(Vd,Ie)=>{Vd=Ie.node.id;this.lh.fB.Bb(Vd)&&this.lHo(Vd)};this.C1n=(Vd,Ie)=>{Ie&&Ie.node&&this.o4a.Bb(Ie.node)&&(Vd=this.o4a.K(Ie.node).sse,this.o4a.Bb(Vd)||(Vd=this.o4a.K(Ie.node),this.p6h(Vd.dyf?Vd.currentNode:Vd.sse,Vd.dyf?Vd.sse:Vd.currentNode,Vd.vL)||this.UPg(Vd.vL)),this.o4a.remove(Ie.node))};this.h3n=(Vd,Ie)=>{const Ue=Vd.Lk;if(!Ie&&this.Gmb.Bb(Ue)){var dg;(dg=this.Gmb).W(Ue,dg.K(Ue)&(Vd.ld?-2:-3));this.Gmb.K(Ue)||(this.UPg(this.Hd.Mb(Ue)),this.Gmb.remove(Ue))}};this.o4a=new ui.a(new rd.a);
this.Gmb=new fe.a(kg.c);this.hH.H2("OnCommentNodeAdded",this.gpo);this.hH.H2("OnCommentNodeDeleted",this.lpo);this.zv.contentFilterApiEnabled?(this.hH.H2("OnCommentPaneOpen",this.Zjn.bind(this)),this.hH.H2("OnCommentPaneClose",this.Yjn.bind(this)),this.hH.H2("OnContentFilterUpdate",this.hid.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Vd=>{this.hH.H2(Vd,this.Wjn.bind(this))});this.hH.H2("OnFloatingCommentsVisibilityChange",this.Xjn.bind(this));oa=this.$r.Hf(12);oa.bA(this.Iid);
oa.wv(this.C1n);this.$r.Hf(40).xVc(this.S1n);this.$r.Hf(40).yq(this.e3n);wj.a.q1a(this.h3n)}get Kw(){return this.i7f.value}get Hd(){return this.Kw.Hd}uJm(oa,Za,xb){if(this.Ufo(oa))for(const Zb of this.lh.fB.K(oa).tR)!this.RXj(Zb,xb===Zb.toString())||Za.add(Zb)}RXj(oa,Za){const xb=this.Hd.Mb(oa),Zb=kg.u(xb);if(!xb||Zb)return!1;oa=this.Oj.K4(oa.toString());return!oa||this.zv.contentFilterApiEnabled&&this.lh.Ln&&!this.oCl.isContentInFilteredContent(oa.id)||!this.lh.Ln&&!this.Oj.boa(oa)&&!Za?!1:!0}Ufo(oa){return this.wfo(oa)}Ayl(oa,
Za){oa=oa.querySelectorAll(`.${Za}`);if(0!==oa.length)for(let xb=0;xb<oa.length;xb++)oa[xb].classList.remove(Za)}UPg(oa){if(oa){var Za=Ch.a.qae(oa,null),xb=new Rb.a;for(let Zb=1;Zb<Za.length-1;Zb++)this.hif(Za[Zb].id,oa.id),xb.add(Za[Zb]);zk.b(xb)}}Xjn(){const oa=new Rb.a;for(const Za of this.Oj.vT())!Za.kg&&Za.kt!==Jc.a.$F&&this.Oj.boa(Za)&&this.Oj.IIe(Za,oa);zk.b(oa)}wfo(oa){if(!this.lh.nW)return!1;let Za=null;if(({value:Za}=this.lh.fB.Nc(oa,Za)).returnValue)return Za.Fbb;let xb=!1;this.Om.Ae(()=>
{const Zb=kg.f();for(let sc=0;sc<Zb.length;sc++)xb=this.EGp(Zb[sc],oa,xb);xb||(this.lh.fB.add(oa,new fa.a),this.lh.fB.K(oa).Fbb=!1)},"CHORA:PHOC");return xb}EGp(oa,Za,xb){oa=kg.h(oa);if(!oa)return xb;for(let Zb=0;Zb<oa.length;Zb++){const sc=this.Hd.Mb(oa[Zb]);sc&&!kg.u(sc)&&(xb=xb||this.Cul(sc,Za))}return xb}Cul(oa,Za){var xb=this.Oj.gLf(oa);if(this.Hbk(xb,oa))return!1;var Zb=xb.Ftd;const sc=xb.j2c;xb=xb.OKa;if(Zb!==Wa.a.nil&&(Zb.equals(sc)||Zb.equals(Za)))return!1;for(Zb=kb.ParagraphReader.Cg(xb,
!1);Zb&&!Zb.id.equals(sc);){if(Zb.id.equals(Za))return this.hif(Za,oa.id),!0;Zb=kb.ParagraphReader.Cg(Zb,!1)}return!1}hif(oa,Za){this.lh.JZ.Bb(Za)||this.lh.JZ.add(Za,new Vb.a(new ii.a));this.lh.JZ.K(Za).add(oa);this.lh.fB.Bb(oa)?this.lh.fB.K(oa).tR||(this.lh.fB.K(oa).tR=new Vb.a(new ii.a)):this.lh.fB.add(oa,new fa.a(!0));this.lh.fB.K(oa).Fbb=!0;this.lh.fB.K(oa).tR.add(Za)}lHo(oa){if(this.lh.fB.K(oa).tR)for(const Za of this.lh.fB.K(oa).tR)this.lh.JZ.Bb(Za)?this.lh.JZ.K(Za).remove(oa):a.ULS.sendTraceTag(572835483,
327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.lh.fB.remove(oa)}Wjn(){const oa=new Rb.a;for(const Za of this.Oj.vT())Za.kg||Za.kt===Jc.a.$F||this.Oj.boa(Za)||this.Oj.IIe(Za,oa);zk.b(oa)}Zjn(){this.h_f("OnCommentPaneOpen")}hid(){this.h_f("OnContentFilterUpdate")}Yjn(){this.h_f("OnCommentPaneClose")}h_f(oa){const Za=new Rb.a;for(const xb of this.Oj.vT())xb.kg||xb.kt===Jc.a.$F||this.Oj.DL.c4h(oa,xb)||this.Oj.IIe(xb,Za);zk.b(Za)}Hbk(oa,Za){let xb=!1;if(!oa.nEe||!oa.E4d){xb=!0;
if(!oa.OKa||!oa.wWa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!oa.OKa,!oa.wWa),!0;oa.nEe||this.o4a.Bb(oa.OKa)||this.o4a.add(oa.OKa,{vL:Za,currentNode:oa.OKa,sse:oa.wWa,dyf:!0});oa.E4d||this.o4a.Bb(oa.wWa)||this.o4a.add(oa.wWa,{vL:Za,currentNode:oa.wWa,sse:oa.OKa,dyf:!1})}return xb}p6h(oa,Za,xb){oa=Ch.a.aDa(oa,xb.id,!0);Za=Ch.a.aDa(Za,xb.id,!1);let Zb;oa||({value:Zb}=this.Gmb.Nc(xb.id,Zb),this.Gmb.W(xb.id,Zb&1));Za||({value:Zb}=this.Gmb.Nc(xb.id,Zb),
this.Gmb.W(xb.id,Zb&2));return!oa||!Za}}Object(f.a)(Ya,"CommentHighlightOnRestActor",null,[374]);var Hb=e(563),Yb=e(453),qa=e(554);class hb{constructor(oa,Za){this.cMb=oa;this.ora=Za}getViewContainer(){return this.cMb}registerForViewContainerEvents(oa){this.ora.FEo(oa)}unregisterForViewContainerEvents(oa){this.ora.tBp(oa)}}Object(f.a)(hb,"ViewContainerProvider",null,[1770]);class Tb{constructor(oa,Za,xb,Zb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=
oa;this.appLocale=Za;this.uiCulture=xb;this.dataCulture=Zb}}Object(f.a)(Tb,"LocalizationDetails",null,[]);var Mc=e(1129),vc=e(1425),fb=e(500);class xd{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc,yi,Ei,ok,ji,hk,Sl,Ko,cm,Lo,nm,pq,vl,Gk,vi,so,Zp,El){this.jt=oa;this.Oj=Za;this.FOb=xb;this.q4=Zb;this.zv=sc;this.lh=$c;this.b7d=Ed;this.uoc=Ud;this.Eq=Vd;this.Tb=Ie;this.dynamicScriptLoader=Ue;this.BQo=dg;this.focusManager=Pf;this.r_d=pc;this.q_d=yi;this.ehf=Ei;this.IMp=ok;this.vE=ji;this.hH=hk;
this.lSo=Sl;this.sam=Ko;this.Wnj=cm;this.JMp=Lo;this.RBa=nm;this.GY=pq;this.$h=vl;this.uU=Gk;this.Iuf=vi;this.Feb=so;this.l_d=Zp;this.sGl=El;this.bMc=this.hAa=null;this.gsh=!1;this.s5e=[];this.aIh=this.hsh=!1;this.initialize=(Lm,Nk)=>{this.adn(Nk)};this.DTl=Lm=>Kf.a.m0d(Lm);this.i3n=()=>{this.WWi()};this.Ozm=(Lm,Nk,wl)=>{Lm={...(new Mc.a),containerPanel:Lm,paneOpenedCallback:Nk,paneClosedCallback:wl,ulsLogger:new Hb.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,
viewportInfo:this.$h.ULf(),destroyAllContainersCallback:()=>{this.lh.Ln||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.zv.c7d,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.zv.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.zv.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.zv.contentNavigationApiEnabled,
contentFilterApiEnabled:this.zv.contentFilterApiEnabled,returnToDraftFixEnabled:!0,ribbonCommentFilteringEnabled:this.zv.ribbonCommentFilteringEnabled}};this.zv.contentNavigationApiEnabled&&(Lm.sidetrackContentNavigationApi=this.Iuf,Lm.featureGateApiSettings=this.GY.BBf,Lm.telemetryDetails=this.Wnj,this.zv.contentFilterApiEnabled&&(Lm.contentFilterAPI=this.sGl));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Lm)};this.V4n=Lm=>{2!==this.jt.mode&&3!==this.jt.mode&&this.Oj.Nv&&Lm===
this.Oj.Nv.id&&this.jt.clearSelection();ze.StaticActiveAppFrame.Aa().Ne(!0)};this.upj=(Lm,Nk)=>{this.qy("onCSCStart",window.performance.now());this.oob&&!Lm&&(this.Xbo(),this.qy("openInFishbowl",!0));this.FOb.sob&&this.zv.$Pb&&this.Tb.Vb(li.a.IOa,2);Nk&&Nk();this.qy("onCSCEnd",window.performance.now())};this.hH.H2("OnCommentInit",this.initialize);this.hH.H2("OnCommentRenderedOnce",this.i3n);this.GY.M0o(()=>{},this.V4n);fb.a.S8c&&(this.lh.tQa=!1)}get MSa(){return this.jt}get oob(){return this.lh.oob}qy(oa,
Za){this.Feb.qy(kl.a.comments,oa,Za,!0)}adn(oa){if(this.lh.nW)oa&&oa.NOa&&oa.NOa();else if(this.gsh)(null===oa||void 0===oa?0:oa.NOa)&&this.s5e.push(oa.NOa);else{var Za=this.zv.boc;this.qy("hasCommentOnBoot",Za);Za?(this.RBa.logKpiUsage(vc.a.DOb,0),y.AFrameworkApplication.Goa("3f3e3317;d8ebf581")):Yb.a.u_n();this.gsh=!0;this.qy("initInProgress",!0);this.Oj.initialize(this.jt);this.FOb.initialize(this.jt,null);this.FOb.ZWj(this.jt);this.uoc.Xdn(this.q4.C5o);this.qy("InitAMSetup",window.performance.now());
this.hAa=J.a.instance.Wa("Common.App.People.IExternalPeopleAPI");qb.a.cqc&&null!=this.hAa?(this.r_d.initialize(this.hAa),this.CWi(oa)):qa.a.xr(this.sam).continueWith(xb=>{(this.hAa=xb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.r_d.initialize(this.hAa);this.CWi(oa)})}}CWi(oa){this.MSa.gtf.initialize(this.MSa,this.Oj,this.hAa,this.r_d);this.ehf.initialize(this.dynamicScriptLoader,this.MSa.gtf,this.Wnj,this.hAa,new hb(this.IMp,this.JMp),
this.KGi(),"",this.r_d.bMi(),this.vE,qb.a.M2b);this.qy("AMInitialized",window.performance.now());qb.a.cqc?this.Xin(oa):this.zv.contentNavigationApiEnabled?(qb.a.bab?qb.a.bab:this.$h.Sbj()).then(()=>{this.qy("FCMLoaded",window.performance.now());this.fAc();this.Gfe(oa)}):this.Gfe(oa)}dAj(){var oa;null===(oa=sharedComments.setDarkModeColorHandler)||void 0===oa?void 0:oa.call(sharedComments,this.DTl)}Gfe(oa){this.bMc=this.ehf.Gfe(void 0,this.dAj.bind(this));this.E$c(oa);this.lh.nW=!0;this.zv.SDe&&this.q_d.initialize()}E$c(oa){if(!this.lh.Pbb){this.qy("InitCSStart",
window.performance.now());var Za=this.Eq.rg("Task","InitiateCommentingSession");this.RBa.logKpiUsage(vc.a.k_d,0);try{this.dVg(),this.lh.Pbb=!0,this.bMc.then(()=>{this.qy("SCLoaded",window.performance.now());this.$h.OWi();this.qy("FCMInitiated",window.performance.now());this.tMj(oa);this.Nzj(oa)})}catch(xb){a.ULS.yA(539567713,327,10,xb,`Comments Initialization Failed: ${xb}`),this.RBa.logKpiFailure(vc.a.k_d,"CommentsInitializationFailed",{isInternal:!0},{name:vc.a.QBa,isInternal:!0})}finally{Za.stop(),
this.qy("InitCSEnd",window.performance.now())}this.Tb.Vb(li.a.itf,2)}}Ybo(oa){this.Tb.Vb(li.a.S2,2);this.GY.KZj();Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.q4.selectComment(oa,{...(new eg.a),i6:!0,gea:1});this.focusManager.Rg(bf.AFrame.Xu);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.eH)},gj.a.mVo);this.RBa.Sy(li.a.ltf)}feb(){this.Tb.Vb(li.a.feb,2)}uIn(oa,Za){(qb.a.bab?qb.a.bab:this.$h.Sbj()).then(()=>
{this.qy("FCMLoaded",window.performance.now());this.fAc();this.upj(oa,Za)}).catch(xb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+xb.toString())})}fAc(){this.uU.trackChangeInSidetrackEnabled?(this.b7d.fAc(),this.qy("STSet",window.performance.now())):this.b7d.cXj(this.Ozm)}WWi(){this.aIh||(this.lh.nW&&this.bMc?(this.bMc.then(()=>{const oa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.lSo.execute(Za=>{oa.registerSafelinksNavigator(Za.wDc.bind(Za))});
this.BQo.execute(Za=>{Za.TAo(oa)})}),this.aIh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.hsh=!0))}KGi(){return new Tb(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Xin(oa){const Za=this.Eq.rg("Task","InitiateCommentingSession");try{this.t8o(oa),this.lh.nW=!0,this.zv.SDe&&this.q_d.initialize(),this.Tb.Vb(li.a.itf,2)}catch(xb){a.ULS.yA(508102016,
327,10,xb,`Floating Comments Initialization Failed: ${xb}`),this.RBa.logKpiFailure(vc.a.k_d,"CommentsInitializationFailed",{isInternal:!0},{name:vc.a.QBa,isInternal:!0})}finally{Za.stop(),this.qy("InitCSEnd",window.performance.now())}}t8o(oa){this.lh.Pbb||(this.qy("InitCSStart",window.performance.now()),this.RBa.logKpiUsage(vc.a.k_d,0),this.dVg(),this.lh.Pbb=!0,this.bMc=qb.a.M2b,Promise.all([qb.a.bab,qb.a.M2b]).then(()=>{this.fAc();this.$h.OWi();this.qy("FCMInitiated",window.performance.now());this.ehf.Rtj(void 0,
this.dAj.bind(this));this.tMj(oa);this.Nzj(oa)}).catch(()=>{[qb.a.bab,qb.a.M2b].forEach(Za=>this.oMn(Za))}))}oMn(oa){oa.catch(Za=>{a.ULS.sendTraceTag(508101828,327,10,`Failed to load dependant scripts. ${Za}`)})}Nzj(oa){oa&&oa.NOa&&oa.NOa();for(const Za of this.s5e)Za();this.hsh&&this.WWi();this.s5e=[]}dVg(){const oa=this.Eq.rg("Task","InitiateCommentingSession-UpdateModel");this.l_d.tdn();oa.stop();this.qy("initAtBoot",window.performance.now());this.zv.qt&&this.Oj.Zua()&&a.ULS.sendTraceTag(574734882,
327,50,String.format("Comments loaded into the model at {0}",ja.a.We()));kh.a.get_instance().AK(12);a.ULS.sendTraceTag(508101987,327,50,"CommentRendered AppInitializationStatus was set")}tMj(oa){if(this.zv.qt){var Za=!1;if(this.oob){var xb=this.q4.T8d(this.oob);xb?(y.AFrameworkApplication.ud("3ge3g205;cha3g788"),xb=this.q4.U8d(xb,0),xb)?this.Oj.boa(xb)||(Za=!0,this.Ybo(xb)):(Za=!0,this.feb()):Za=!0}oa=oa?oa.rqj:null;this.zv.contentNavigationApiEnabled||qb.a.cqc?this.upj(Za,oa):this.uIn(Za,oa)}}Xbo(){this.q4.oQj(this.oob,
{...(new eg.a),bGg:!1,Wad:!0});this.RBa.Sy(li.a.ltf)}}Object(f.a)(xd,"CommentInitActor",null,[]);class We{constructor(oa,Za,xb,Zb){this.xh=oa;this.dQ=Za;this.ga=xb;this.wk=Zb;this.oJe=this.f5a=null}get zoom(){let oa=1;this.wk&&this.wk.instance&&(oa=this.wk.instance.Ql);return 0<oa?oa:1}Vbm(oa,Za){if(!this.oJe||!oa.rNa||Za>=oa.rNa.length)return null;const xb=this.zoom,Zb=oa.z2,sc=oa.Y8a(1,hi.aYf,xb,Za);return this.GLl(Zb,(this.oJe.y-oa.l9[Za].y)/xb+hi.Cik,sc)}GLl(oa,Za,xb){if(this.f5a)return(oa=this.f5a.parentElement)&&
oa.removeChild(this.f5a),this.YSj(this.f5a,Za,xb),this.f5a;const Zb=oa.Gh.ownerDocument,sc=Zb.createElement("div");sc.className=We.lCl;this.YSj(sc,Za,xb);Za=Zb.createElement("span");this.GPg(Za,sc);mg(De[4],Za);this.fCo(Za,oa);return this.f5a=sc}GPg(oa,Za){oa.title=CommonUIStrings.l_CommentNewCommentButton;oa.setAttribute("role","button");Za.appendChild(oa)}fCo(oa,Za){this.xh.wK(Cj.a.click,oa,this.B4n.bind(this),Za);this.xh.Cb(Cj.a.dF,oa,this.D4n.bind(this));this.dQ.Cb(oa,this.C4n.bind(this))}Gde(){if(this.f5a){const oa=
this.f5a.parentElement;oa&&oa.removeChild(this.f5a)}}YSj(oa,Za,xb){oa.style.left=xb+hi.aYf+"px";oa.style.top=Za+"px";oa.style.right="auto";oa.style.display="block";oa.style.position="absolute";oa.style.overflow="hidden";oa.style.cursor="default";oa.style.zIndex="40"}D4n(){return!0}B4n(oa){this.ga.JD=30;this.ga.Vb(li.a.IOa,2);oa=oa.uy;mg(De[4],oa);oa=oa.parentElement;(null===oa||void 0===oa?0:oa.parentElement)&&oa.parentElement.removeChild(oa);return!0}C4n(){return!0}}We.lCl="clip16x16 EntryPointContainer";
Object(f.a)(We,"CommentMarginEntryPointActor",null,[]);var Ke=e(434),Qd=e(86),Gg=e(231),Xh=e(35),lh=e(114);class Ge{constructor(oa,Za,xb,Zb,sc,$c,Ed){this.i7f=oa;this.$Fn=Za;this.hq=xb;this.lh=Zb;this.zv=sc;this.otf=$c;this.RBa=Ed;this.hCj=new Set;this.DXb=new Set;this.xjd=new Gg.a;this.zhc=new Map;this.g$h=J.a.instance.zf("Box4.CommentParagraphMapping");this.GOb=new Set;this.uma=this.S8d()}get Kw(){return this.i7f.value}get Hd(){return this.Kw.Hd}get QKa(){return this.$Fn.value}S8d(){const oa=new Yj.a;
oa.set(this.Kw);this.QKa.Wdb(oa);return oa}tdn(){this.lh.Pbb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",Xh.Debug.oab());this.zv.contentNavigationApiEnabled||(this.zv.boc&&this.rdn(),this.hq.Arj())}k2n(){this.gNj();this.GOb.forEach(oa=>{this.ZVg(oa)});this.GOb.clear();this.hq.Arj()}ZVg(oa){if(Ke.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${oa}`);var Za=
this.zhc.get(oa).pBc,xb=this.zhc.get(oa).fkc;Za===Wa.a.nil||xb===Wa.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Za} or end ${xb} has invalid value`):(this.g$h.value.A9a.set(oa,Za),this.g$h.value.z9a.set(oa,xb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Za} and End ${xb} mapping info for Comment ${oa} added on Comment Model load`))}}Agn(oa){const Za=[];for(const xb of oa)oa=xb.Lk.toString(),this.pbk(oa,xb.paragraph.id,xb.ld),xb.ld&&(this.hCj.has(oa)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",
xb.Lk):(this.hCj.add(oa),(oa=this.R0k(xb))&&Za.push(oa)));return Za}pbk(oa,Za,xb){Ke.a.isEnabled&&(this.zhc.has(oa)||this.zhc.set(oa,{pBc:Wa.a.nil,fkc:Wa.a.nil}),xb?this.zhc.get(oa).pBc=Za:this.zhc.get(oa).fkc=Za)}R0k(oa){var Za=this.Hd.Mb(oa.Lk);this.uma.yk(Za);if(40!==this.uma.Jf||!Za)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!Za,!oa.Lk),this.uma=39===this.uma.Jf?this.uma:this.S8d(),
null;Za=this.hq.T0d(this.uma);let xb;if(({index:xb}=this.hq.sHe(Za)).returnValue)if(this.hq.Dhf(Za,xb),this.DXb.add(Za.objectId),kg.r(Za)||this.GOb.add(Za.objectId),Za.kg)this.fHf(Za);else return{contentId:Za.id,containerContentType:0,Tda:{Kd:oa.Rb.cp,tP:oa.paragraph.Jl}};else this.xjd.add(Za);return null}fHf(oa){if(oa.kg){var Za=this.hq.tH(oa.kg);if(Za&&Za.kg){const xb=this.hq.tH(Za.kg);xb&&(xb.kg?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(oa.kg=Za.kg,
a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${oa.objectId} parentObjectId: ${Za.objectId}`)))}}}rdn(){const oa=new Ka.a(0),Za=Qd.a.Mp(this.hq.I3a),xb=new Set;this.zv.Ado&&!Ke.a.isEnabled&&this.E3k(Za,oa);const Zb=this.S8d(),sc=new Set,$c=new Set,Ed=new pg.GraphTransaction(2);try{if(Ed.nw(Zb),Zb.dw(1)){for(;Za.moveNext();){if(!kb.ParagraphReader.Wh(Za.iterator))continue;const Vd=Za.iterator.currentNode,Ie=kb.ParagraphReader.ftb(Vd,0);Ke.a.isEnabled&&this.fRn(Vd,
Ie,oa);xb.add(Vd.id.toString());this.yBj(Ie,$c,Zb,sc)}this.gNj();const Ud=this.dtm(xb);0<Ud.length&&this.TPo(Ud,xb,Zb,$c);this.GOb.forEach(Vd=>{this.ZVg(Vd)});this.GOb.clear()}}finally{Ed&&Ed.dispose()}0==this.DXb.size&&this.zv.boc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Ci.a.DMn(sc,$c,this.Hd)}yBj(oa,Za,xb,Zb){for(const sc of oa){oa=this.zv.qt?!sc.ld:sc.ld;const $c=sc.Lk.toString();this.pbk($c,sc.paragraph.id,sc.ld);oa?Za.has($c)||Zb.add($c):
Za.has($c)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",sc.Lk):(Za.add($c),this.S0k(sc,xb))}}TPo(oa,Za,xb,Zb){const sc=this.CKm(oa);Ci.a.Evl(sc);const $c=new Set,Ed=new Set;sc.forEach(Vd=>{Za.has(Vd.id.toString())||Ed.has(Vd.id.toString())||(Ed.add(Vd.id.toString()),Vd=kb.ParagraphReader.ftb(Vd,0),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Vd.length} CommentRangeObjects`),this.yBj(Vd,Zb,xb,$c))});const Ud=[];oa.forEach(Vd=>{this.DXb.has(Vd)||
Ud.push(Vd)});0<Ud.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${Ud.length} Failed To Load on Retry: ${Ud.join(",")}`),this.RBa.logKpiFailure(vc.a.DOb,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:vc.a.QBa,isInternal:!0}))}CKm(oa){const Za=[];oa.forEach(xb=>{if(xb=this.otf.FAi(xb))xb=kg.l(xb),(xb=this.Hd.Mb(xb))&&xb.ml&&Za.push(xb)});return Za}S0k(oa,Za){const xb=this.Hd.Mb(oa.Lk);Za.yk(xb);40===Za.Jf&&xb?(oa=this.hq.T0d(Za),({index:Za}=this.hq.sHe(oa)).returnValue?(this.hq.Dhf(oa,
Za),this.DXb.add(oa.objectId),kg.r(oa)||this.GOb.add(oa.objectId),oa.kg&&this.fHf(oa)):this.xjd.add(oa)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!xb,!oa.Lk),39===Za.Jf||this.S8d())}dtm(oa){const Za=[],xb=this.otf.Xsm();if(this.DXb.size===xb.length)return Za;xb.forEach(Zb=>{!this.DXb.has(Zb)&&Ci.a.LBn(Zb,oa,this.otf,this.Hd)&&Za.push(Zb)});return Za}gNj(){for(let oa=0;oa<this.xjd.length;oa++){const Za=this.xjd.K(oa);
let xb;({index:xb}=this.hq.sHe(Za)).returnValue?(this.hq.Dhf(Za,xb),kg.r(Za)||this.GOb.add(Za.objectId),this.DXb.add(Za.objectId),Za.kg&&this.fHf(Za)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",Za.HYa,Za.x$a,Za.objectId,Za.kg))}this.xjd.clear()}E3k(oa,Za){oa.Oq(xb=>{if(11===xb.Jf){var Zb=xb.currentNode;const sc=Zb.ka(lh.a.vtf,null),$c=Zb.ka(lh.a.ttf,null);xb=!!sc&&0<sc.length;const Ed=
!!$c&&0<$c.length;xb&&sc.forEach(Vd=>{const Ie=this.Hd.Mb(Vd);Ie&&!kg.u(Ie)&&Za.add(Vd,0)});Ed&&$c.forEach(Vd=>{Za.Bb(Vd)&&Za.remove(Vd)});(Zb=Zb.ka(qd.a.FI,null))&&Zb.forEach(Vd=>{const Ie=this.Hd.Mb(Vd);kb.ParagraphReader.lc(Ie)&&!this.lh.fB.Bb(Vd)&&this.lh.fB.add(Vd,new fa.a)});const Ud=Za.keys;for(let Vd=0;Vd<Ud.length;Vd++){Zb&&0<Za.K(Ud.K(Vd))&&(this.lh.JZ.Bb(Ud.K(Vd))||this.lh.JZ.add(Ud.K(Vd),new Vb.a(new ii.a)),Zb.forEach(Ue=>{const dg=this.Hd.Mb(Ue);kb.ParagraphReader.lc(dg)&&(this.lh.fB.K(Ue).tR||
(this.lh.fB.K(Ue).tR=new Vb.a(new ii.a)),this.lh.JZ.K(Ud.K(Vd)).add(Ue),this.lh.fB.K(Ue).Fbb=!0,this.lh.fB.K(Ue).tR.add(Ud.K(Vd)))}));let Ie;Za.W(Ie=Za.keys.K(Vd),Za.K(Ie)+1)}return xb||Ed}return!0},null)}fRn(oa,Za,xb){oa&&(this.mqk(Za,xb),this.lh.fB.Bb(oa.id)||this.lh.fB.add(oa.id,new fa.a),xb.forEach((Zb,sc)=>{0<sc&&(this.lh.JZ.Bb(Zb)||this.lh.JZ.add(Zb,new Vb.a(new ii.a)),this.lh.fB.K(oa.id).tR||(this.lh.fB.K(oa.id).tR=new Vb.a(new ii.a)),this.lh.JZ.K(Zb).add(oa.id),this.lh.fB.K(oa.id).Fbb=!0,
this.lh.fB.K(oa.id).tR.add(Zb));xb.W(Zb,sc+1);return!0}))}mqk(oa,Za){oa.forEach(xb=>{if(xb.ld){const Zb=this.Hd.Mb(xb.Lk);Zb&&!kg.u(Zb)&&Za.W(xb.Lk,0)}else Za.Bb(xb.Lk)&&Za.remove(xb.Lk)})}}Object(f.a)(Ge,"CommentModelBootLoader",null,[369]);var sg=e(1051);class Yf{constructor(oa){this.d$h=oa;this.rKc=null;this.vAh=void 0;this.wAh=null;this.mPc=new Map;this.$Te=new Map}wEo(){sg.a.q1a(this.pDp.bind(this))}pDp(oa,Za){const xb=oa.id.toString();var Zb=oa.getValue(Va.a.KI).toString();Za?(this.mPc.delete(xb),
this.$Te.delete(Zb)):(this.mPc.set(xb,oa),this.$Te.set(Zb,oa));0===this.mPc.size&&this.rKc&&(oa=+new Date-+this.rKc,this.rKc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${oa}`));Za||this.vAh!==Zb||(Za=+new Date-+this.wAh,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Za}`),Zb=new Ba.a,Zb.durationMs=Za,this.d$h.logKpiFailure(vc.a.c_d,"CommentFoundAfterDeeplinkAttempt",
{isInternal:!0,additionalValues:Zb},{name:vc.a.M9h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Zb}));this.rKc||(this.rKc=new Date)}set bVn(oa){this.vAh=oa;this.wAh=new Date;if(oa=this.Vsm(oa))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${oa.id} present but failed to load`),oa=new Ba.a,this.d$h.logKpiFailure(vc.a.c_d,"CommentPresentButFailedToLoad",{isInternal:!0},{name:vc.a.M9h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:oa})}Xsm(){return[...this.mPc.keys()]}Vsm(oa){return this.$Te.get(oa)}FAi(oa){return this.mPc.get(oa)}}
Object(f.a)(Yf,"CommentNodeTracker",null,[]);class Um{get contentType(){return 0}constructor(oa,Za,xb,Zb,sc){this.czg=oa;this.hq=Za;this.q4=xb;this.DL=Zb;this.lh=sc;this.czg.YGj(this)}sQj(oa,Za,xb){0===Za?(Za=this.hq.dbd(oa),this.q4.selectComment(Za?this.hq.$A:this.hq.tH(oa),Object.assign(new eg.a,{i6:xb||Za,gea:1}))):this.DL.clearSelection()}xYj(oa){if(this.lh.Ln||this.hq.dbd(oa.contentId))return!0;const Za=this.hq.tH(oa.contentId);if(Za)return this.hq.boa(Za);a.ULS.sendTraceTag(508878870,327,10,
`Failed to find comment for contentId: ${oa.contentId}`);return!1}}Object(f.a)(Um,"CommentReviewSuggestionContentActor",null,[368]);class gl{get TJg(){return this.RJg}constructor(oa,Za){this.l_d=oa;this.zv=Za;this.RJg=new Set([12])}initialize(){}h9f(oa){if(!kb.ParagraphReader.lc(oa.node))return[];oa=kb.ParagraphReader.ftb(oa.node,0);return this.l_d.Agn(oa)}Xoj(){this.l_d.k2n()}mSi(){return this.zv.rhp?this.zv.boc:!0}}Object(f.a)(gl,"CommentReviewSuggestionContentProvider",null,[367]);var ah=e(465),
Qg=e(98),xh=e(131),je=e(773),He=e(1515);class Bf{constructor(){this.commentId=null;this.Ocd=!1}}Object(f.a)(Bf,"CommentToSelectOnPaneLoadData",null,[]);class uk{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc,yi,Ei){this.jt=oa;this.hq=Za;this.PKa=xb;this.q4=Zb;this.hH=sc;this.lh=$c;this.b7d=Ed;this.zv=Ud;this.FOb=Vd;this.mXb=Ie;this.Tb=Ue;this.j7f=dg;this.focusManager=Pf;this.Om=pc;this.NCl=yi;this.aqb=Ei;this.vmd=(ok,ji,hk,Sl,Ko)=>{if(1===hk||!Ko)return 32;Ko[ah.a.On]=fb.a.S8c?this.lh.Ln:this.lh.tQa;
return 32};this.Tb.qa(li.a.d3b,Qg.a.frame,this.jt.d3b.bind(this.jt));this.Tb.qa(li.a.M3d,Qg.a.frame,this.M3d.bind(this));this.Tb.qa(li.a.htf,Qg.a.frame,this.a3n.bind(this));this.Tb.qa(li.a.YBl,Qg.a.frame,this.$2n.bind(this));this.Tb.qa(li.a.Xlj,Qg.a.frame,this.t7n.bind(this));this.Tb.qa(li.a.vli,Qg.a.frame,this.h4n.bind(this));this.Tb.qa(li.a.T9h,Qg.a.frame,this.I5n.bind(this));this.Tb.nb(li.a.mtf,Qg.a.frame,this.gdl.bind(this),64);this.Tb.nb(li.a.j_d,Qg.a.frame,this.UFo.bind(this),64);this.Tb.qa(Xf.a.selectComment,
Qg.a.frame,this.q4.jVo.bind(this.q4));this.zv.JGn&&this.Tb.qa(Xf.a.Rke,Qg.a.frame,this.Rke.bind(this));this.rSh(Xf.a.A0c,!1);this.rSh(Xf.a.kzf,!0);this.Tb.nb(Xf.a.m_d,Qg.a.frame,this.m_d.bind(this),64);this.Tb.qa(Xf.a.DMg,Qg.a.frame,this.Cao.bind(this));this.Tb.nb(Xf.a.vmd,Qg.a.frame,this.vmd.bind(this),96);this.Tb.qa(Xf.a.Bej,Qg.a.frame,xh.ActionManager.qg);this.Tb.qa(Xf.a.Cpf,Qg.a.frame,this.epl.bind(this));this.Tb.qa(Xf.a.cji,Qg.a.frame,(ok,ji)=>je.a.bda(ji.Pk)&&je.a.Ovb()?8:32);this.zv.ribbonCommentFilteringEnabled&&
(this.Tb.qa(Xf.a.r6d,Qg.a.frame,this.r6d.bind(this)),this.Tb.qa(Xf.a.s6d,Qg.a.frame,this.s6d.bind(this)),this.Tb.qa(Xf.a.t6d,Qg.a.frame,this.t6d.bind(this)),this.Tb.qa(Xf.a.yye,Qg.a.frame,this.yye.bind(this)))}get Oj(){return this.hq}get mode(){return this.jt.mode}get fD(){return this.jt.fD}get cF(){return this.zv.qt}get fl(){return this.mXb.value}get ub(){return this.j7f.value}get DL(){return this.jt}M3d(oa,Za,xb,Zb,sc){return sc?sc?(oa=this.q4.T8d(sc.NavigationId))&&this.q4.U8d(oa,1)?32:8:(a.ULS.sendTraceTag(540160449,
327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}a3n(oa,Za,xb,Zb,sc){sc&&this.hH.G2("OnCommentInit",{...(new He.a),NOa:()=>{var $c=this.q4.T8d(sc.NavigationId);if($c){var Ed=this.q4.U8d($c,1);Ed?this.FOb.isVisible?(this.rqd(Ed,1),this.focusManager.scopeChanged(bf.AFrame.Xu)):this.Oj.boa(Ed)?($c=kg.t(Ed),this.q4.selectComment(Ed,{...(new eg.a),i6:!$c,gea:1}),this.focusManager.scopeChanged(bf.AFrame.pT)):
(this.lh.Ln||this.Tb.Vb(li.a.S2,2),Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.rqd(Ed,1)},gj.a.rqd)):this.Tb.Vb(li.a.feb,2)}}});return 32}$2n(oa,Za,xb,Zb,sc){sc?(oa=this.Oj.n5c(sc))?this.DL.bvc(oa.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.DL.bvc(null);return 32}t7n(oa,Za,xb,Zb,sc){if(sc){if(this.lh.Pbb){for(oa=0;oa<sc.length;oa++)this.Oj.TSj(sc[oa]);this.jt.vfb()}else this.Oj.E5k(sc);this.LMn(sc)}return 32}h4n(oa,Za,xb,Zb,
sc){if(sc)if(this.lh.Pbb){for(oa=0;oa<sc.length;oa++)this.Oj.TSj(sc[oa],!0);this.jt.vfb()}else this.Oj.myl();return 32}I5n(oa,Za,xb,Zb,sc){this.cF||this.lh.Ln||this.Tb.Vb(li.a.S2,2);if(sc){oa=null;if(!this.fD||2!==this.mode&&3!==this.mode){if(!sc)return 8;if(this.cF)oa=this.Ldm(sc);else for(Za=0;Za<sc.length&&(oa=this.Oj.K4(sc[Za].toString()),this.b7d.xhe&&(!oa||oa.done));Za++);}else oa=this.fD;this.rqd(oa,1);oa&&this.lh.nW&&this.focusManager.Rg(this.cF&&!this.lh.Ln?bf.AFrame.pT:bf.AFrame.Xu)}else a.ULS.sendTraceTag(5017933,
327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}gdl(oa,Za,xb,Zb,sc){var $c;if(!sc)return 32;if(sc&&0<sc.length){Za=oa=xb=0;Zb=!1;for(let Ed=0;Ed<sc.length;Ed++)sc[Ed].toString()===(null===($c=this.fD)||void 0===$c?void 0:$c.objectId)?(Zb=!0,oa++):this.hq.t3f(sc[Ed])&&(Zb&&0===xb&&(xb=Ed,Za=oa),oa++);($c=this.hq.K4(sc[xb].toString()))?(this.PKa.WCc.Lfg=Za+1,this.PKa.WCc.rCb=oa,this.DL.bvc($c.id)):(sc=sc[xb],this.fl.Mb(sc)?a.ULS.sendTraceTag(540148256,327,10,
`Comment Node with ObjectId ${sc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",sc.toString()))}return 32}UFo(){this.DL.bvc(null);return 32}rSh(oa,Za){this.Tb.qa(oa,Qg.a.frame,(xb,Zb,sc)=>this.M3n(sc,Za))}Cao(oa,Za,xb){var Zb;if(1===xb)return this.hq.$A?8:32;if(2===xb){if(fb.a.S8c||this.lh.Ln)return this.Tb.Vb(li.a.S2,2),this.lh.tQa=this.lh.Ln,32;if(!this.hq.K8c())return 32;this.lh.tQa=!this.lh.tQa;
this.hH.G2("OnFloatingCommentsToggle");null===(Zb=ze.StaticActiveAppFrame.Aa())||void 0===Zb?void 0:Zb.Ne(!0)}return 32}Rke(oa,Za,xb){2===xb&&(oa=this.Oj.Bq.Vc(7),oa.Eb(this.Oj.I3a),Za=new Cc.a,Za.Xna(`${String.fromCodePoint(128077)} \n`),this.hq.iic(km.a.instance.ob.currentSelection,void 0,Za),this.NCl.Gde(),oa.dispose());return 32}M3n(oa,Za=!1){if(2===oa)oa=this.Oj.Bq.Vc(15),oa.Eb(this.Oj.I3a),this.Om.Ae(()=>{this.A0c(Za)},"ECM:DAC"),oa.dispose();else if(1===oa&&(!this.Oj.Zua()||this.zv.bWl&&Za&&
!this.Oj.j5m()))return 2;return 32}A0c(oa=!1){this.jt.mode=1;const Za=this.Oj.vT();for(const xb of Za)xb.kt===Jc.a.$F||oa&&!xb.done||xb.kg||this.jt.deleteComment(xb);this.focusManager.Rg(bf.AFrame.Co);0<(oa?this.Oj.vT().filter(xb=>xb.done):this.Oj.vT()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",oa):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",oa)}m_d(oa,Za,xb){if(2===xb)if(oa=this.focusManager.currentScope.name,
oa!==bf.AFrame.Xu&&oa!==bf.AFrame.pT){!this.cF||this.lh.Ln?(this.lh.Ln||this.Tb.Vb(li.a.S2,2),this.focusManager.Rg(bf.AFrame.Xu)):this.focusManager.Rg(bf.AFrame.pT);var Zb=this.ub.ob.currentSelection;if(!Zb||!Zb.Ya)return 2;oa=Zb.Ya.cpBegin;Za=Zb.Ya.node;Zb=!!this.fD&&(yg.a.qn(Zb)||Zb.GN)&&kg.s(this.fD,Za,this.fl,oa);oa=!!this.fD&&(2===this.mode||3===this.mode);if(Zb||oa)return this.DL.uQj(this.fD.id,!0),32;Zb=this.cF&&!this.lh.Ln?this.Oj.GAi(!0,!0):null;this.DL.sVo(Zb)}else this.Oj.Nv&&(this.jt.uoc.nQj(this.Oj.Nv,
!0),this.jt.uoc.Bub(null===(Zb=this.Oj.Nv)||void 0===Zb?void 0:Zb.objectId)),this.focusManager.Rg(bf.AFrame.Co);return 32}epl(){return 4}LMn(oa){const Za=new Set;for(let xb=0;xb<oa.length;xb++){const Zb=this.Oj.n5c(oa[xb]);Zb&&Za.add(Zb.kg?Zb.kg:Zb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Za.size.toString())}rqd(oa,Za){oa?this.FOb&&!this.lh.nW?this.lh.cqb=Object.assign(new Bf,{commentId:oa.id,Ocd:!1}):this.q4.selectComment(oa,Object.assign(new eg.a,{i6:!!Za,gea:Za})):
a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}Ldm(oa){let Za=null,xb=!1;for(let Zb=0;Zb<oa.length;Zb++){const sc=oa[Zb].toString();if(this.Oj.t3f(oa[Zb])){Za||(Za=sc);if(xb&&this.Oj.Nv.objectId!==sc)return this.Oj.K4(sc);xb=xb||!!this.Oj.Nv&&this.Oj.Nv.objectId===sc}}return Za?this.Oj.K4(Za):null}iAe(oa){this.lh.filter=oa;this.aqb.onRibbonFilterChanged(oa);this.Tb.Vb(Xf.a.CNj,2);this.hH.G2("OnContentFilterUpdate")}r6d(oa,Za,xb){if(2===xb)this.iAe({...this.lh.filter,
resolutionStatus:2===this.lh.filter.resolutionStatus?0:2});else if(1===xb&&!this.Oj.Zua())return 2;return 32}s6d(oa,Za,xb){if(2===xb)this.iAe({...this.lh.filter,mentionsToCurrentUser:!this.lh.filter.mentionsToCurrentUser});else if(1===xb&&!this.Oj.Zua())return 2;return 32}t6d(oa,Za,xb){if(2===xb)this.iAe({...this.lh.filter,resolutionStatus:1===this.lh.filter.resolutionStatus?0:1});else if(!(1!==xb||this.FOb.isVisible&&this.Oj.Zua()))return 2;return 32}yye(oa,Za,xb){if(2===xb)this.iAe({mentionsToCurrentUser:!1,
resolutionStatus:0});else if(1===xb&&!this.Oj.Zua())return 2;return 32}}Object(f.a)(uk,"CommentsActionManager",null,[]);var bm=e(162),Ai=e(40),Pd=e(205),ai=e(1847),Pg=e(545),Vl=e(31),fg;(function(oa){oa[oa.L2p=0]="commentDeeplink";oa[oa.V4h=1]="catchUpActivity"})(fg||(fg={}));Object(f.b)("DeeplinkSource",fg);class um{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf){this.ga=oa;this.Ri=Za;this.Wz=xb;this.SQe=Zb;this.XU=sc;this.UJh=$c;this.oc=Ed;this.Mj=Ud;this.uj=Vd;this.fIb=Ie;this.UQe=Ue;this.aL=
dg;this.gbf=!1;this.C5o=pc=>{if(this.uj.qt&&!this.Mj.Ln){const yi=new Cb.a(0,1,0,()=>{this.DSj(pc)},136,void 0,!0);y.AFrameworkApplication.zc.pc(yi)}else this.DSj(pc)};Pf.execute(pc=>{this.oI=pc})}get hq(){return this.Ri}get ub(){return this.fIb.value}roi(oa){let Za=oa.kt===Jc.a.$F?oa.yC.draftId:oa.id,xb=null;oa.kg&&(Za=oa.kg,xb=()=>{this.UJh.selectComment(oa.id)});this.XU.setInitialActiveContainerId(Za,0,xb)}jVo(oa,Za,xb,Zb,sc){if(!sc.commentId)return 2;oa=this.Ri.tH(sc.commentId);if(!oa)return 2;
this.wAb(oa,sc);return 32}rQj(oa,Za){var xb,Zb;if(oa){var sc=(null===(Zb=null===(xb=this.Ri.$A)||void 0===xb?void 0:xb.yC)||void 0===Zb?void 0:Zb.draftId)===oa?this.Ri.$A:this.Ri.tH(oa);this.selectComment(sc,Za)}}selectComment(oa,Za){oa&&this.wAb(oa,Za)}oQj(oa,Za){var xb=this.T8d(oa);xb&&((xb=this.U8d(xb,0))?Za.bGg?(this.Mj.cqb=Object.assign(new Bf,{commentId:xb.id,Ocd:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.wAb(xb,Object.assign(new eg.a,{commentId:xb.id,
gea:1,i6:!0,Wad:!0})),this.uj.qt&&void 0!==oa&&null!==oa&&this.roi(xb),Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.oc.Rg(this.uj.qt&&!this.Mj.Ln?bf.AFrame.pT:bf.AFrame.Xu)},gj.a.O0o),bm.a.instance.Gf(Ai.a.Whi,(new Date).getTime()),oa=this.uj.qt?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",oa+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,oa,(new Date).getTime()-y.AFrameworkApplication.eH)):this.ga.Vb(li.a.feb,2))}T8d(oa){let Za=null;var xb=
null;if(Na.a.erc(oa))Za=oa;else if(({Zv:xb}=db.d(oa)).returnValue&&(oa=xb))return Pg.a.comment in oa&&(Za=oa[Pg.a.comment]),Za;Za||(xb=xb?Object.keys(xb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",xb?xb.join(","):"Not Json."));return Za?Za.toString():null}U8d(oa,Za){const xb=this.Ri.n5c(oa),Zb=0===Za;Zb&&this.aL.logKpiUsage(vc.a.c_d,0);if(!xb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",oa,Za);const sc=
new Vl.a;sc.name="DeepLinkSource";sc.string=fg[Za];this.aL.logActivity("CommentDeeplinkNotFound",{dataFields:[sc]});Zb&&(Za=new Ba.a,Za.extendedProperties=new Map([["ErrorLevel","warning"]]),this.aL.logKpiFailure(vc.a.c_d,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Za}),this.UQe.bVn=oa)}return xb}DSj(oa){this.gbf=!0;this.ub.Uc(oa);this.gbf=!1}wAb(oa,Za){if(oa){this.Mj.tQa||this.ga.Vb(Xf.a.DMg,2);this.Mj.dZb&&(y.AFrameworkApplication.zc.Kf(this.Mj.dZb),this.Mj.dZb=null);var xb=
this.Ri.Nv,Zb=this.hq.LPf(oa),sc=2===Za.gea,$c={};sc&&($c.TriggeredByFindReplace=!0);if(this.Mj.Ln)sc&&($c.PaneAlreadyOpen=!0),Pd.UISurfaces.aw().then(Ed=>{Ed.setSelectedTaskPane(ai.a.n_d);return null});else if(oa.kt!==Jc.a.$F&&!this.hq.boa(oa))this.Mj.nW?this.ga.Vb(Xf.a.S2,2):this.Mj.cqb=Object.assign(new Bf,{commentId:oa.id,Ocd:Za.Wad}),sc&&($c.OpeningPaneToSelect=!0);else if(this.uj.qt){const Ed=Zb.kt===Jc.a.$F;Ed?this.XU.V1a(Zb.yC.draftId,0,Za.i6):this.XU.V1a(Zb.id,0,Za.i6);!Ed&&sc&&($c.SelectingDHC=
!0)}Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.Mj.nW&&(Za.i6&&this.oc.Rg(this.uj.qt&&!this.Mj.Ln?bf.AFrame.pT:bf.AFrame.Xu),Za.Wad&&this.hq.boa(oa)||!Za.i6&&!Za.gea||this.UJh.selectComment(oa.id))},gj.a.TCg);sc=this.hq.LPf(xb);this.oI&&sc&&sc.id!==Zb.id&&this.oI.fireEvent(9,{comment:sc});this.Ri.selectComment(oa);this.oI&&oa.kt===Jc.a.normal&&!oa.kg&&this.oI.fireEvent(8,{comment:oa});this.SQe.highlightComment(oa,!0);this.Wz.pJ(0,Zb,xb);ze.StaticActiveAppFrame.Aa().Ne(!0);0<Object.keys($c).length&&
this.aL.Sy(Xf.a.selectComment,{customData:$c})}}}Object(f.a)(um,"CommentSelectionActor",null,[366]);class oj extends Ui.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Bh.a,{T_:oj.getTypeName(),B_:oj.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(oj,"CommentSmartReplySignal",Ui.a,[]);class Dd extends Ab.a{constructor(){super();this.DomainName=this.CommentId=
null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Bh.a,{T_:Dd.getTypeName(),B_:Dd.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(Dd,"SmartReply",Ab.a,[]);var pj=e(896);class Kh{constructor(oa){this.Wya=oa}rPb(oa,Za){return Object.assign(new pj.a,{parentPath:["Signal",oj.getTypeName()],items:[Object.assign(new Wf.a,{body:Object.assign(new oj,{commentId:oa,comment:Za})})]})}bpg(oa){const Za=
new T.a;if(oa&&oa.CommentId&&oa.ResultSets&&0<oa.ResultSets.length&&oa.ResultSets[0].Documents&&0<oa.ResultSets[0].Documents.length){for(const xb of oa.ResultSets[0].Documents)Za.add(xb.Caption);0<Za.count&&this.Wya.bpg(oa.CommentId,Za.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Dd.getTypeName()}}Object(f.a)(Kh,"BaseCommentSmartReplyProvider",null,[1888]);class Rc extends Kh{get Vie(){if(null!=this.v4g)var oa=this.v4g;else{var Za;
oa=this.v4g=null===(Za=y.AFrameworkApplication.J)||void 0===Za?void 0:Za.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveCommentsDependency",!1)}return oa}constructor(oa,Za,xb,Zb,sc){super(oa);this.tPh=sc;this.ff=Za;this.WE=xb;this.Sdh=Zb}initialize(){var oa;this.Vie?null===(oa=this.tPh)||void 0===oa?void 0:oa.execute(async Za=>{await Za.Km();this.ff.Cb(this,Kh.prototype.getTypeName.call(this))}):this.WE.Km().then(()=>{this.ff.Cb(this,Kh.prototype.getTypeName.call(this))})}invoke(oa,Za){var xb;
this.Vie?null===(xb=this.tPh)||void 0===xb?void 0:xb.execute(async Zb=>{await Zb.Km();this.Sdh.getAugLoopRuntimeManager().submitOperation(Object.assign(new ei.a,{operation:this.rPb(oa,Za)}))}):this.WE.Km().then(()=>{this.Sdh.getAugLoopRuntimeManager().submitOperation(Object.assign(new ei.a,{operation:this.rPb(oa,Za)}))})}XI(oa,Za){oa&&yc.a.getTypeNameFor(oa.content)===this.getTypeName()&&Za===Xb.a.getTypeName()?this.bpg(oa.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}
Object(f.a)(Rc,"CommentSmartReplyProvider",Kh,[365]);var ri=e(37),Wi=e(386),lm=e(137),Sk=e(610);class kf{constructor(oa,Za,xb,Zb,sc,$c){this.za=oa;this.Qd=Za;this.rB=xb;this.x2e=Zb;this.UQe=sc;this.uU=$c;this.ZGb=!1;this.UQe.wEo();this.khh=this.TIm();this.Otg&&(ri.a.addHandler(window.self,Cj.a.dWh,()=>{this.ZGb=!0}),ri.a.addHandler(window.self,Cj.a.eWh,()=>{this.ZGb=!1}));0<this.khh&&(Wi.a.rx("77dda873;fe8jd931"),Wi.a.rx("3i71d191;hgci6218"),Wi.a.rx("g5h1c854;ijc37458"))}get Kw(){return this.rB?this.rB.value:
null}get QKa(){return this.x2e.value}get kzp(){return this.ZGb}get boc(){return null!=this.S0g?this.S0g:this.S0g=(()=>0<this.khh)()}get qt(){return null!=this.ZYg?this.ZYg:this.ZYg=(()=>this.uU.qt)()}get e0l(){return null!=this.YYg?this.YYg:this.YYg=!0}get b4b(){return null!=this.s$g?this.s$g:this.s$g=(()=>this.Qd.isFeatureEnabled(107)&&!Sk.a.gcd)()}get FWo(){return null!=this.F8g?this.F8g:this.F8g=(()=>this.Qd.isFeatureEnabled(31)&&this.za.$("SendErrorReportOnCommentInboundCrashIsEnabled"))()}get ZBl(){return null!=
this.MXg?this.MXg:this.MXg=(()=>this.za.$("CommentAnchorHighlightOnIpSelectionIsEnabled"))()}get Otg(){return null!=this.f8g?this.f8g:this.f8g=!1}get xmj(){return null!=this.i6g?this.i6g:this.i6g=(()=>this.za.$("NoHighlightWhenCommentDraftInProgressIsEnabled"))()}get $Pb(){return null!=this.LYg?this.LYg:this.LYg=(()=>this.qt&&!this.boc&&!this.za.rb("BootActivityNavigationId")&&G.a.Fv)()}get Pgl(){return this.za.$("AtMentionUserFloodGateCampaignIsEnabled")}get pCl(){return null!=this.NXg?this.NXg:
this.NXg=(()=>this.za.$("CommentFriendlyTimestampsIsEnabled"))()}get X_l(){return null!=this.WYg?this.WYg:this.WYg=(()=>this.za.rb("DisabledChangeGatesInSharedComments"))()}get c7d(){return null!=this.M_g?this.M_g:this.M_g=(()=>this.uU.c7d)()}get o3b(){return null!=this.$8g?this.$8g:this.$8g=(()=>G.a.WT?this.JDe:this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1))()}get JDe(){return null!=this.Y8g?this.Y8g:this.Y8g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimpleMarkupModeInSafari",
!1))()}get SDe(){return null!=this.k9g?this.k9g:this.k9g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1))()}get TZ(){return null!=this.V7g?this.V7g:this.V7g=(()=>this.za.rb("PresenceUserId"))()}get aea(){return null!=this.g8g?this.g8g:this.g8g=Sk.a.sKe&&!!lm.a.instance&&lm.a.instance.hDa(ze.StaticActiveAppFrame.Aa().tb.rd).aea}get Lrb(){return null!=this.mZg?this.mZg:this.mZg=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1))()}get jqp(){return null!=this.r$g?this.r$g:this.r$g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1))()}get eDl(){return null!=this.OXg?this.OXg:this.OXg=(()=>this.za.$("CommentsTasksFpsIsEnabled"))()}get trackChangeInSidetrackEnabled(){return null!=this.eah?this.eah:this.eah=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1))()}get JGn(){return null!=this.l5g?this.l5g:this.l5g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",
!1))()}get contentNavigationApiEnabled(){return null!=this.oYg?this.oYg:this.oYg=(()=>this.uU.contentNavigationApiEnabled)()}get Ado(){return null!=this.y6g?this.y6g:this.y6g=(()=>this.Qd.isFeatureEnabled(80))()}get contentFilterApiEnabled(){return null!=this.lYg?this.lYg:this.lYg=(()=>this.uU.contentFilterApiEnabled)()}get rhp(){return null!=this.j9g?this.j9g:this.j9g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1))()}get ribbonCommentFilteringEnabled(){return null!=
this.n8g?this.n8g:this.n8g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCommentFilteringEnabled",!1))()}get bWl(){return null!=this.MYg?this.MYg:this.MYg=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.DeleteAllCommentsCheckFixEnabled",!1))()}get Jmf(){return null!=this.XWg?this.XWg:this.XWg=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionBookmarkFixup",!1))()}get qDl(){return null!=this.PXg?this.PXg:this.PXg=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixStuckCommentCommit",
!1))()}get Cpn(){return null!=this.G3g?this.G3g:this.G3g=(()=>this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.DuplicateReactionFix",!1))()}TIm(){if(this.Kw&&this.QKa){const oa=new Yj.a;oa.set(this.Kw);this.QKa.Wdb(oa);let Za=0;39===oa.Jf&&(Za=oa.Bs());return Za}return-1}}Object(f.a)(kf,"CommentsSettings",null,[]);class tp{constructor(){this.Ech=null;this.nW=!1;this.dZb=this.cqb=null;this.fB=new ui.a(new ii.a);this.JZ=new ui.a(new ii.a);this.rtg=this.Pbb=!1;this.tQa=!0;this.filter={mentionsToCurrentUser:!1,
resolutionStatus:0}}get Ln(){return fb.a.Ln}set Ln(oa){fb.a.Ln=oa}get oob(){return this.Ech}set oob(oa){this.Ech=oa}}tp.nl=1;Object(f.a)(tp,"CommentsState",null,[]);var jn=e(1362);class Em{constructor(oa){this.cfa=oa}J1h(oa,Za,xb){const Zb=new kk;Za=this.cfa.g_a(Za)?Za.objectId:null;if(!Za)return Zb;Za=Wa.a.Of(Za);if(xb.contains(Za))return Zb.n$c=0,Zb.m$c=oa.length,Zb;for(let $c=0,Ed=oa.length;$c<Ed;$c++){var sc=oa[$c];xb=kg.h(sc);sc=kg.e(sc);xb&&jn.a.Eai(xb,Za)&&(Zb.n$c=$c);if(sc&&jn.a.Eai(sc,Za)){Zb.m$c=
$c;break}}return Zb}mYh(oa,Za,xb){const Zb=-1===Za.n$c&&-1===Za.m$c,sc=-1<Za.n$c?Za.n$c:-1;Za=-1<Za.m$c?Za.m$c:oa.length;const $c=!Zb&&sc===Za;var Ed=!1;for(let Ud=0;Ud<oa.length;Ud++){const Vd=oa[Ud],Ie=zk.a(Vd);if(1!==Ie&&2!==Ie&&3!==Ie)continue;this.cfa.t1a(Vd);if(Zb||Ud<sc||Ud>Za)continue;const Ue=3===Ie||2===Ie&&-1!==Vd.className.indexOf(Wh.a.ZYa),dg=xb?1:2;this.lel(Ud,sc,Za,dg,Ue,Ed,Vd,$c);if(Ud!==Za||$c)(Ed=this.cfa.Jbb.K(Ie).K(dg))&&Vd.classList.add(Ed),Ed=Ue}}lel(oa,Za,xb,Zb,sc,$c,Ed,Ud){oa!==
Za&&oa!==xb||sc||$c||((oa=this.cfa.Gwc.K(Zb))&&Ed.classList.add(oa),Ud&&Ed.classList.add(Wh.a.zog))}}Object(f.a)(Em,"DefaultHighlightChangeHandler",null,[362]);var Vm;(function(oa){oa[oa.success=0]="success";oa[oa.Mo=1]="noSelection";oa[oa.Vcq=2]="invalidContent"})(Vm||(Vm={}));Object(f.b)("AnchorCreationResult",Vm);var Rg=e(63),rb=e(23),Sb=e(26),Tc=e(284),pd=e(258),Ae=e(1045);class ne{}Object(f.a)(ne,"EditorAnchorInfo",null,[380]);class Oe{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd){this.gGn=oa;this.j7f=
Za;this.Oj=xb;this.ODa=Zb;this.PKa=sc;this.wu=$c;this.hH=Ed;this.zv=Ud;this.TMg=Vd;this.MJh=null;this.ODa.LPa(this.PKa);this.zv.contentFilterApiEnabled&&(this.hH.H2("OnCommentPaneOpen",this.iFp.bind(this)),this.hH.H2("OnCommentPaneClose",this.hFp.bind(this)),this.hH.H2("OnContentFilterUpdate",this.hid.bind(this)))}get ub(){return this.j7f.value}get fl(){return this.gGn.value}initialize(){}Xdn(oa){this.MJh=oa}dispose(){}Bub(oa){this.PKa.Bub(oa)}toc(oa){this.PKa.toc(oa)}highlightComment(oa){this.nQj(oa,
!1);this.PKa.Bub(oa.objectId)}KDc(oa){this.PKa.KDc(oa)}FMa(oa){return this.PKa.FMa(oa)}hid(){this.eMe("OnContentFilterUpdate")}iFp(){this.eMe("OnCommentPaneOpen")}hFp(){this.eMe("OnCommentPaneClose")}eMe(oa){const Za=[],xb=new Set;for(const sc of this.Oj.vT())if(!sc.kg&&sc.kt!==Jc.a.$F&&!this.Oj.DL.c4h(oa,sc)){var Zb=this.UJm(sc);xb.has(Zb.id.toString())||(xb.add(Zb.id.toString()),(Zb=Zb.ug(Object(Rg.a)().Pd.Lc))&&Za.push(Zb))}Za.forEach(sc=>{this.ODa.LDc(sc)})}UJm(oa){var Za,xb,Zb;const sc=null===
(Za=this.fl)||void 0===Za?void 0:Za.Mb(oa.objectId);if(!sc)return null;oa=kg.l(sc);Za=null===(xb=this.fl)||void 0===xb?void 0:xb.Mb(oa);return null===(Zb=this.TMg.instance)||void 0===Zb?void 0:Zb.HTb(Za)}nQj(oa,Za){if(!oa.kt){var xb=this.fl.Mb(Wa.a.Of(oa.objectId)),Zb=Ch.a.kha(xb,this.fl,!0);xb=Ch.a.kha(xb,this.fl,!1);if(Zb&&xb){const sc=Zb.Rb.paragraph;Zb=Zb.Rb.cp;if(this.Syn(sc,Zb))ze.StaticActiveAppFrame.Aa().Ne(!0);else{Zb=rb.SelectionFactory.Ie(sc,Zb);xb=Sb.a.jd(xb.Rb.paragraph,xb.Rb.cp);if(Oe.Ig.cda(Zb.Ya)||
Oe.Ig.cda(xb))oa.PZa=!0,oa.Udb();oa=Za?rb.SelectionFactory.SA(Zb,xb):Zb;this.MJh(oa)}}}}ayl(){this.PKa.toc(null);this.PKa.Bub(null)}CJl(){const oa=new ne;return{returnValue:Vm.success,anchor:oa}}Syn(oa,Za){if(oa&&Object(ff.a)(Ae.a,this.wu.Pd)){var xb=oa.ug(this.wu.Pd.Lc);oa=document.getElementById(Ml.a.G3a);if(xb&&oa){Za=Tc.a.fx(xb,Za);if(!Za)return!1;Za=Za.y;xb=Sys.UI.DomElement.getBounds(oa).y;oa=oa.offsetHeight;if(Za>=xb&&Za<=xb+oa)return!0}}return!1}static get Ig(){return pd.a.instance}static getInstance(){return Oe.In()}static In(){return Oe._instance||
(Oe._instance=new Oe(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),new Ua.a(()=>km.a.instance),J.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),J.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,J.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Object(Rg.a)(),J.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),J.a.instance.resolve("WordEditor.Comments.CommentsSettings"),J.a.instance.Za("WordEditor.Indicator.TopLevelOutlineElementCache")))}}
Oe._instance=null;Object(f.a)(Oe,"EditorCommentHintManager",null,[357,358,11]);var Of=e(69),Yg=e(2099),If=e(365),Ph=e(1135);class Se extends he.a{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc,yi,Ei,ok,ji,hk,Sl,Ko,cm,Lo,nm,pq,vl){super(Ed);this.oj=Za;this.fIb=Ud;this.gtf=Ie;this.Xya=Ue;this.MHc=dg;this.XU=Pf;this.uj=pc;this.Tq=yi;this.M7b=Ei;this.Mj=ok;this.I_=ji;this.qe=Sl;this.aL=Ko;this.GY=Lo;this.aqb=nm;this.TMg=vl;this.tTi=this.NLh=this.z5a=null;this.kyb=()=>{this.Hya.Fva()&&(this.PGj(this.Hya.Xc),
this.Hya.ayc(this.kyb))};this.Kgd=Gk=>{kg.y(void 0,Gk.mode)?1===Gk.mode&&(this.PG=0):this.PG=1;this.Ri.$A&&0===this.PG?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Ri.$A.yC.sessionType):this.Mj.nW&&(this.cF||this.b7.isVisible)&&this.vfb()};this.k1n=()=>{this.Mj.Pbb?this.mode=0:this.PG=0};this.ePa=(Gk,vi)=>{var so;Gk=vi.Pn.currentSelection;if((this.cF||this.Hia&&this.Hia.isVisible)&&!this.M7b.gbf&&Gk){vi=yg.a.qn(Gk);
var Zp=Gk.GN;null!==(so=this.tTi)&&void 0!==so&&so.Qga||(this.hq||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),so=this.hq&&this.hq.Evb(this.ga,!1),1!==this.mode||vi&&!Zp||!so?this.MHc.Gde():this.ONl(Gk));2!==this.mode&&3!==this.mode&&this.uj.ZBl&&this.pxp(Gk,vi,Zp)}};this.zvl=()=>{if(this.Oj&&this.Oj.$A&&!qb.a.x_f){var Gk=this.Oj.$A;Gk.yC.sessionType!==Yg.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Gk.kt} present on app shutdown`),(Gk=
Ci.a.bxm(Gk))&&this.aL.logKpiFailure(Gk,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:vc.a.QBa,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.u1n=()=>{if(this.Mj.nW){var Gk=()=>!0;this.cF&&!this.Mj.Ln&&(Gk=vi=>this.hq.boa(vi));Gk=this.hq.v8d(Gk);this.vfb(Gk)}};this.h1n=()=>{if(this.Mj.nW){var Gk=()=>!0;this.cF&&!this.Mj.Ln&&(Gk=vi=>this.hq.boa(vi));Gk=this.hq.v8d(Gk);this.vfb(Gk)}};this.ga=Ed;this.PG=kg.y(this.ga.mode,void 0)?0:1;this.b7=sc;this.Ri=Zb;this.tfa=$c;this.oc=
Vd;this.sDo();xb.xfb(this.Xya);this.ub.BD(this.ePa);oa.CWR(()=>oa.result.MG.cKa(this.k1n));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.t8a(this.Kgd);this.I_.H2("OnAfterTrackChangeMarkupViewChange",this.u1n);y.AFrameworkApplication.IG&&y.AFrameworkApplication.IG(this.zvl);this.I_.H2("onAfterExpandCollapseChange",this.h1n);pq.execute(Gk=>{this.oI=Gk});cm.execute(Gk=>{Gk.$Gl.execute(vi=>{this.tTi=vi})})}sDo(){this.Hya&&(this.Hya.Fva()?this.PGj(this.Hya.Xc):this.Hya.bfc(this.kyb))}PGj(oa){oa.d8(()=>
{this.Rkp()})}get Hya(){var oa;return null===(oa=Sk.a.Xm)||void 0===oa?void 0:oa.tb}get ub(){return this.fIb.value}get Oj(){return this.Ri}get hq(){return this.Ri}get cF(){return this.uj.qt}get imj(){return!0}get hRj(){return!0}get Foc(){return this.z5a}set Foc(oa){this.z5a=oa}get mode(){return super.mode}set mode(oa){oa!==this.PG&&(super.mode=oa,this.Udb())}get fD(){return this.model&&this.model.Nv?this.model.Nv.kg?this.model.tH(this.model.Nv.kg):this.model.Nv:null}get fl(){return this.oj.value}get LZj(){return!1}get aea(){return this.uj.aea}vfb(oa=
null){var Za=this.hq;const xb=!this.PG,Zb=this.Hia.mCl,sc=Za.bae();Zb.TPg(sc?5:1,xb);oa=this.uj.o3b&&oa?oa:Za.iLf(this.uj.o3b&&this.cF&&!this.Mj.Ln);Zb.vWo(oa,sc,Za.r4a);this.uPg();Za=0;Ci.a.n3d&&(Za=+new Date-+Ci.a.n3d);Ci.a.k8h();a.ULS.sendTraceTag(572281362,327,50,`Comment Context Reloaded, Time Taken: ${Za}`)}iid(oa,Za,xb=!1){this.Mj.Ln?this.XU.Tdk():Za?this.XU.BLa(oa.kt===Jc.a.$F?oa.yC.draftId:oa.id,0,xb):this.tvo(oa)}tvo(oa){const {fsp:Za}=this.Ri.YCm(oa),xb=this.tfa.FMa(oa.objectId);xb&&this.XU.Jec(oa.id,
xb.parentElement,0,Za)}xQj(oa){const Za=this.fD;this.tqd();this.Xya.pJ(0,this.Ri.Nv,Za);this.cF&&this.Ri.Nv&&!this.Mj.Ln&&this.XU.V1a(this.Ri.Nv.id,0,1===oa)}tVo(){const oa=this.fD;this.uqd();this.Xya.pJ(0,this.Ri.Nv,oa);this.cF&&this.Ri.Nv&&!this.Mj.Ln&&this.XU.V1a(this.Ri.Nv.id,0,!1)}KDc(oa){this.tfa.KDc(oa)}O5l(oa,Za){this.XU.Jec(oa,null,0,Za)}Oho(oa){this.XU.hyj(oa)}Q5l(oa,Za){this.XU.yod(oa,Za,0)}uEp(){this.XU.Hmf()}qQj(oa){if(oa&&(2!==this.mode||oa.kt===Jc.a.$F)){var Za=this.Ri.Nv;Za!==oa&&
(this.Ri.selectComment(oa),this.b7.isVisible?this.Mj.nW?(this.b7.selectComment(oa,1),this.ora.selectComment(oa.id)):this.Mj.cqb=Object.assign(new Bf,{commentId:oa.id,Ocd:!1}):this.cF&&!oa.done&&(this.uQj(oa.id,!1),this.ora.selectComment(oa.id)),!this.b7.isVisible&&this.cF&&oa.done||(this.uoc.Bub(oa.objectId),this.Xya.pJ(0,this.fD,Za)))}}E$c(){}sDf(){this.Mj.Pbb=!1}JMb(oa){this.uj.xmj&&this.Ri.Nv&&this.clearSelection();super.JMb(oa);this.aL.logKpiUsage(vc.a.stf,0);this.uPg();if(this.cF){const Za=this.Ri.bVm(oa.draftId);
this.O5l(oa.draftId,Za)}}vob(oa,Za){this.aL.logKpiUsage(vc.a.p_d,0);super.vob(oa,Za)}SBa(oa){this.cF&&null!=oa.yC&&this.Ri.VHj(oa.yC.draftId);super.SBa(oa);this.tfa.Bub(oa.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",kg.a(oa));this.aL.logKpiUsage(vc.a.K9h,0);this.Fvl(oa);Ci.a.oMp(oa,this.fl,this.aL);this.aL.Sy(Xf.a.J9h,{succeeded:!0,customData:{actionType:oa.kg?Yg.a.reply:Yg.a.create}})}eqb(oa){super.eqb(oa);this.aL.Sy(Xf.a.J9h,{succeeded:!0,customData:{actionType:Yg.a.trb}})}Fvl(oa){if(oa.kg){var Za=
this.Ri.LPf(oa);if(Za.PVc&&Za.QVc){var xb=this.fl.Mb(Wa.a.Of(Za.QVc));Za=Za.QVc===Za.PVc?null:this.fl.Mb(Wa.a.Of(Za.PVc));Ci.a.JUg(xb,oa,!0);Ci.a.JUg(Za,oa,!1)}}}B0c(oa){super.B0c(oa);this.fD&&this.fD.id===oa.id&&(super.clearSelection(),this.cF&&this.XU.khc());if(this.cF)if(kg.t(oa)){var Za=[];let xb=null;for(const Zb of this.model.vT())Zb!==oa&&(Zb.kg===oa.kg&&Za.push(Zb),Zb.id===oa.kg&&(xb=Zb));xb&&xb.id&&xb.objectId&&!xb.done&&this.hq.iK(xb.objectId)&&!this.hq.$yj(xb.objectId)&&!Za.length&&this.iid(xb,
!0)}else Za=oa.kt===Jc.a.$F,oa.done||this.iid(oa,!0),Za&&this.Ri.VHj(oa.yC.draftId)}urb(oa,Za){1===this.mode&&oa&&(this.Ri.N1c(oa,Za),Yg.a.trb===Za.sessionType&&this.aL.logKpiUsage(vc.a.P9h,0),this.uj.b4b&&3!==Yg.a.SNf(Za.sessionType)&&this.M7b.selectComment(oa,Object.assign(new eg.a,{i6:!1,gea:0})))}Nze(oa){this.cF&&!this.Mj.Ln||super.Nze(oa)}deleteComment(oa){oa.kt!==Jc.a.$F&&this.hq.rji(Wa.a.Of(oa.objectId));this.z5a&&this.z5a.id===oa.id&&(this.Ri.Nv&&this.z5a.id===this.Ri.Nv.id?this.z5a=null:
this.Xya.Trf());!this.Ri.Nv||this.Ri.Nv.id!==oa.id&&this.Ri.Nv.kg!==oa.id?this.Ri.Nv&&this.Xya.pJ(0,this.Ri.Nv,null):void 0===oa.kg||null===oa.kg?this.clearSelection():this.Ri.selectComment(this.Ri.tH(oa.kg));oa.PZa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",kg.a(oa));super.deleteComment(oa);a.ULS.sendTraceTag(50426377,327,50,`${kg.a(oa)} deleted by user action. DurableId: ${oa.x$a}`)}mOb(oa,Za){super.mOb(oa,Za);this.cF&&!this.Mj.Ln&&Za&&(this.Ri.Nv&&
this.Ri.Nv.id===oa.id&&this.clearSelection(),this.Foc&&this.Foc.id===oa.id&&this.Xya.Trf())}sVo(oa=null){(oa=this.hq.Tsm(oa))?this.M7b.selectComment(oa,Object.assign(new eg.a,{i6:!0,gea:1})):this.xQj(1)}ONl(oa){var Za,xb=this.Hya.Xc;if(xb){var Zb=oa.Ya.node,sc=null===(Za=this.TMg.instance)||void 0===Za?void 0:Za.HTb(Zb);if(sc)for(const $c of xb.bZ(sc))if($c&&$c instanceof If.a&&(Za=$c,xb=Ph.a.nfi(Za),this.MHc.oJe=this.gcm(Zb,oa),sc=this.pql(xb),null!==sc)){if(oa=this.MHc.Vbm(xb,sc))xb.rNa[sc].appendChild(oa),
Za.jD(oa);break}}}gcm(oa,Za){let xb;for(const Zb of oa.QK)if(Zb&&Zb){xb=Zb;break}oa=Za.Ya.Uj;Za=!(null===xb||void 0===xb||!xb.Cq)&&0<xb.Cq.length;return 0>oa||!Za||null===xb||void 0===xb||!xb.oEf?null:Tc.a.m4(oa,xb,!1,!1)}pql(oa){var Za;const xb=null===(Za=this.MHc.oJe)||void 0===Za?void 0:Za.y;for(const [Zb,sc]of oa.l9.entries())if(oa=xb-sc.y,-2<=oa&&oa<sc.height+2)return Zb;return null}Udb(){qb.a.mub=2===this.mode||3===this.mode;1!==this.mode&&this.MHc.Gde()}pxp(oa,Za,xb){const Zb=this.oc.currentScope;
let sc=null;if(Za||xb){Za=oa.Ya.cpBegin;oa=oa.Ya.node;if(this.fD&&kg.s(this.fD,oa,this.fl,Za))return;sc=this.BHm(oa,Za)}sc?!this.cF||this.Mj.Ln?Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.qQj(sc)},gj.a.lVo):this.qQj(sc):!this.Ri.Nv||Zb&&Zb.name===bf.AFrame.pT||this.clearSelection()}BHm(oa,Za){let xb=null;const Zb=this.model.vT();for(let sc=Zb.length-1;0<=sc;sc--){const $c=Zb[sc];if($c.objectId&&!($c.kg||this.cF&&!this.Hia.isVisible&&$c.done)&&kg.s($c,oa,this.fl,Za)){xb=$c;break}}return xb}selectComment(oa,
Za=1){this.M7b.rQj(oa,Object.assign(new eg.a,{i6:1===Za,gea:Za}))}uQj(oa,Za){const xb=this.Ri.tH(oa);xb?this.cF&&!kg.t(xb)&&xb.kt!==Jc.a.$F&&this.XU.V1a(oa,0,Za):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const oa=this.model.Nv;this.oI&&oa&&this.oI.fireEvent(9,{comment:oa});super.clearSelection();this.Xya.pJ(1,oa,oa);this.cF&&oa&&this.XU.khc()}tyn(){var oa;return 500>(null===(oa=this.NLh)||void 0===oa?void 0:oa.qj)}bvc(oa,Za=1){if(!this.uj.xmj||!this.Ri.$A){var xb=
this.Ri.tH(oa),Zb=null;xb||(Zb=this.z5a);var sc=this.tyn(),$c=!1;1===Za&&this.ora&&(sc?$c=!0:this.ora.highlightComment(oa));oa?xb?sc?$c=!0:this.tfa.toc(xb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.tfa.toc(null);xb?sc?$c=!0:(this.z5a=xb,this.Xya.pJ(2,xb,Zb)):(this.z5a=null,this.Xya.pJ(3,null,Zb));$c&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}Rkp(){this.qe&&(this.NLh=
this.qe.rg("UserAction","StartScrollDetectionStopwatch"))}notify(oa,Za){this.Tq.sendNotification(oa,Za)}uPg(){this.aqb.onContentChanged()}c4h(oa,Za){var xb,Zb;switch(oa){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.khp(Za);case "OnContentFilterUpdate":return!(null===(Zb=(xb=this.aqb).isContentInFilterUpdateDiff)||void 0===Zb?0:Zb.call(xb,Za.id));default:return!0}}khp(oa){return!oa.done&&this.hq.boa(oa)===this.aqb.isContentInFilteredContent(oa.id)}static getInstance(){return Se.In()}static In(){Se.Ch||
(Se.Ch=new Se(Of.a.uDa(),new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),J.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,J.a.instance.resolve("Common.Comments.ICommentModel"),J.a.instance.resolve("Common.Comments.ICommentPane"),Oe.getInstance(),y.AFrameworkApplication.va,new Ua.a(()=>km.a.instance),td.FocusManager.instance(),J.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),J.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),J.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
J.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),J.a.instance.resolve("WordEditor.Comments.CommentsSettings"),J.a.instance.resolve("Common.Utils.IAriaNotifier"),J.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),J.a.instance.resolve("WordEditor.Comments.CommentsState"),J.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Sk.a.Xm.tb.Xc,ze.StaticActiveAppFrame.Aa().Kt,J.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),J.a.instance.Za("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
J.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),J.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),J.a.instance.Za("WordEditor.Extension.RichApiEventManager"),J.a.instance.Za("WordEditor.Indicator.TopLevelOutlineElementCache")),Se.Ch.L2b=!0);return Se.Ch}}Se.Ch=null;Object(f.a)(Se,"EditorCommentManager",he.a,[359,360,361,11]);var Cg=e(1773);class Vg{constructor(oa,Za,xb,Zb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=
oa;this.body=Za;this.confirmButton=xb;this.cancelButton=Zb}}Object(f.a)(Vg,"ViewContainerModalDialogStrings",null,[]);e(1373);class qj{constructor(oa,Za){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=oa;this.canvasContextId=Za}}Object(f.a)(qj,"CommentUIAction",null,[]);var Tn=e(1513);class Wp{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc,yi,Ei,ok){this.ga=
oa;this.xh=Za;this.Ce=xb;this.oc=Zb;this.hr=sc;this.mi=$c;this.qY=Ed;this.Wya=Ud;this.bTd=Vd;this.Hff=Ie;this.Sb=Ue;this.XU=dg;this.uj=Pf;this.Mj=pc;this.M7b=yi;this.I_=Ei;this.lra=ok;this.SQe=this.$j=null;this.QJh=this.Gch=!1;this.TQc=null;this.yep=(ji,hk,Sl)=>2!==Sl||this.Mj.nW?1===Sl?32:2:(this.I_.G2("OnCommentInit",Object.assign(new He.a,{NOa:()=>{this.ga.Vb(li.a.S2,2)}})),32);this.gYf=(ji,hk,Sl)=>1!==Sl||this.Mj.nW?2:8;this.M_k=(ji,hk,Sl)=>{if(1===Sl)return!this.Evb()||this.sob?8:this.Mj.nW?
2:32;if(!this.Mj.nW)return this.sob=!0,this.I_.G2("OnCommentInit",Object.assign(new He.a,{NOa:()=>{this.qt||this.Mj.Ln||this.ga.Vb(li.a.S2,2)}})),32;this.qt||this.Mj.Ln||this.ga.Vb(li.a.S2,2);(this.qt||this.Mj.Ln)&&this.oc.Rg(this.Mj.Ln?bf.AFrame.Xu:bf.AFrame.pT);return 2};this.$Vl=(ji,hk,Sl)=>1===Sl&&Re.SessionStatusManager.instance.zk?8:2;this.F_l=(ji,hk,Sl,Ko)=>1!==Ko||(this.qt||this.isVisible)&&this.$j.model.Nv?ji||this.$j.model.Nv?32:8:8;this.yub=(ji,hk,Sl,Ko,cm)=>{if(1===Sl||!this.Mj.Ln)return 32;
if(!this.qt&&2===Sl&&(2===this.$j.mode||3===this.$j.mode))return cm=new Vg(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.bTd.invokeModalConfirmationDialog(()=>{this.o3n(ji,hk,Sl,Ko)},()=>{this.u2n()},cm),32;this.Ide();if(this.qt)return 32;cm&&this.poi();return 32};this.xxc=(ji,hk,Sl,Ko,cm)=>{if(1===Sl)return 32;cm[ah.a.On]=this.isVisible;return 32};this.OFc=this.uJl()}get isVisible(){return this.Mj.Ln}get sob(){return this.Gch}set sob(oa){this.Gch=
oa}get a9o(){return"SharedCommentsTaskPaneProps"}get Rjd(){return null}get Ylj(){return null}get XO(){return this.hr}get Hia(){return null}get mCl(){return this.Wya}get qt(){try{return this.uj.qt}catch(oa){return!1}}KGi(){return new Tb(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}uJl(){const oa=new Wg.a,Za=new qj(li.a.IOa,Qg.a.frame);Za.preCallback=this.M_k;const xb=new qj(Xf.a.Ffg,Qg.a.frame),Zb=new qj(Xf.a.Qpg,
Qg.a.frame),sc=new qj(Xf.a.deleteComment,Qg.a.frame);sc.preCallback=this.$Vl;sc.postCallback=this.F_l;const $c=new qj(Xf.a.CNj,Qg.a.frame);this.qt&&(xb.preCallback=this.gYf,Zb.preCallback=this.gYf,$c.preCallback=this.gYf);const Ed=new qj(li.a.S2,Qg.a.frame);Ed.preCallback=this.yep;oa.W(6,Ed);oa.W(0,Za);oa.W(1,xb);oa.W(2,Zb);oa.W(3,sc);oa.W(7,$c);return oa}ZWj(oa){this.QJh||(this.YVk=this.Vae(),this.qY.iLa(),this.i8o(),this.c8o(oa),this.QJh=!0)}c8o(oa){this.$j=oa;this.SQe=oa.uoc;this.$j.Kqi=this.Wya}initialize(oa){this.ZWj(oa);
this.mc()}CYf(){this.TQc&&this.oc.Rg(bf.AFrame.Xu);this.sob&&!this.qt?(this.ga.Vb(li.a.IOa,2),this.sob=!1):this.Mj.cqb&&Gh.a.c8(y.AFrameworkApplication.zc,()=>{const oa=this.Mj.cqb.commentId,Za=this.Mj.cqb.Ocd;this.ga.Zb(Xf.a.selectComment,2,Object.assign(new eg.a,{commentId:oa,gea:1,i6:!0,Wad:Za}));Za&&(Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.oc.Rg(bf.AFrame.Xu)},gj.a.TCg),bm.a.instance.Gf(Ai.a.Whi,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",
(new Date).getTime()-y.AFrameworkApplication.eH);this.Mj.cqb=null},gj.a.kVo)}dispose(){}A$(){}selectComment(){this.isVisible||this.qt||this.u_j();this.mi.Ne(!0)}mc(){this.ga.qa(li.a.yub,Qg.a.frame,this.yub);this.ga.nb(li.a.xxc,Qg.a.frame,this.xxc,96)}Udb(){-1!==this.$j.mode&&(this.$j.mode||this.poi())}poi(){const oa=this.$j,Za=oa.hq,xb=Za.bae(),Zb=Za.iLf(this.uj.o3b&&this.uj.qt&&!this.Mj.Ln);this.Wya.uWo(Zb.length,xb,!oa.mode,xb?5:1);this.Wya.WWo(Zb,Za.r4a)}i8o(){const oa=this.oc.te(bf.AFrame.Xu);
oa.parent=bf.AFrame.rr;oa.LN=!0;oa.Hye=!0;oa.$Cb=!0;oa.n8a((Za,xb)=>{eb.a.b4h(xb.name)&&(this.Mj.dZb=Gh.a.c8(this.Sb,()=>{xb.name!==bf.AFrame.pT&&2!==this.$j.mode&&3!==this.$j.mode&&(this.$j.clearSelection(),this.mi.Ne(!0));this.Mj.dZb=null},gj.a.f3n))});this.hr.vY(bf.AFrame.Xu);for(const Za of kg.v)oa.bindAction(mk.KeyInputManager.Jy(Za),Xf.a.Cpf)}B0o(){this.TQc&&this.Hff.Uhm()}$5h(){this.dCk&&this.B0o()}o3n(oa,Za,xb,Zb){const sc=this.$j,$c=sc.hq.$A;$c&&$c.yC?sc.gtf.endCommentSession($c.yC.draftId):
a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.yub(oa,Za,xb,Zb,!0);Gh.a.c8(this.Sb,()=>{this.mi.Ne(!0)},gj.a.NQo)}u2n(){this.TQc&&this.oc.Rg(bf.AFrame.Xu);this.mi.Ne(!0)}IPa(oa){oa.Pu(this.oc.w0);oa.Pu(this.oc.x0)}d3b(oa,Za,xb){if(1===xb)return 32;this.u_j();return 32}u_j(){this.isVisible||(this.Mj.tQa=!0,this.Mj.nW?(this.B0l(),this.Mj.Ln=!0,this.I_.zwe(),this.oc.RUc(bf.AFrame.Xu),this.qt&&this.uj.o3b&&this.$j.vfb(this.$j.model.v8d(()=>!0)),this.dCk=
!0,Pd.UISurfaces.aw().then(oa=>{oa.showTaskPane(ai.a.n_d,this.YVk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.$j.bvc(null),this.mi.Ne(!0),this.IPa(this.oc.te(bf.AFrame.Xu)),this.I_.G2("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.I_.G2("OnCommentInit",Object.assign(new He.a,{NOa:()=>{this.Mj.Ln||this.ga.Vb(li.a.S2,2)}})))}B0l(){this.ga.Zb(Xf.a.C8,2,null);this.ga.Zb(Xf.a.PY,2,null)}Evb(){return this.lra.Evb(this.ga,
!1)}JMb(){}show(){this.isVisible||this.ga.Vb(li.a.S2,2)}urb(){return 2}Ide(){this.$j.jfo();this.Mj.Ln=!1;if(this.qt&&this.uj.o3b){const Za=this.$j.model;this.$j.vfb(Za.v8d(xb=>Za.boa(xb)))}var oa=td.FocusManager.instance();oa.currentScope&&oa.currentScope.name===bf.AFrame.Xu&&oa.Rg(this.qt&&(2===this.$j.mode||3===this.$j.mode||this.$j.Oj.Nv)?bf.AFrame.pT:oa.NY);this.hr.wz(bf.AFrame.Xu);this.oc.j0c(bf.AFrame.Xu);Pd.UISurfaces.aw().then(Za=>{Za.hideTaskPane(ai.a.n_d,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,
327,10,"Error hiding Comment Pane.")});this.qt&&(oa=this.$j.model.Nv)&&this.vDp(oa);this.I_.G2("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}vDp(oa){oa.done?this.$j.clearSelection():this.M7b.roi(oa)}jao(oa=null){this.Hff.tWj(3);this.CYf();if(oa){this.$5h();ri.a.fxe(oa,[Cj.a.contextMenu]);const Za=this.oc.te(bf.AFrame.Xu);this.xh.hVc(bf.AFrame.Xu,oa,Za.$Cb)}}T8n(oa){this.hr.RM(bf.AFrame.Xu);1!==oa&&Gh.a.c8(y.AFrameworkApplication.zc,()=>{this.oc.scopeChanged(bf.AFrame.Xu)},
gj.a.TCg)}onTaskPaneClose(){this.Mj.nW&&this.Hff.tWj(1)}Vae(){const oa={type:this.a9o,o9p:this.$5h};return Object.assign(new Tn.a,{title:WacWordeditorStrings.Comments,contentProps:oa,hideHeader:!1,width:300,location:2,onOpen:Za=>{this.TQc=Za;this.jao(Za);this.XU.HMg(!0)},onClose:()=>{this.TQc=null;this.ga.Zb(li.a.yub,2,!0);this.mi.Ne(!0);this.onTaskPaneClose();const Za=this.$j.hq;this.Mj.tQa&&Za.K8c()&&this.XU.HMg(!1)},onShow:Za=>{this.T8n(Za)}})}S2(){return 32}}Object(f.a)(Wp,"OfficeSharedCommentPane",
null,[11,350,351]);var bj=e(1662),Kj=e(182);class Tj{constructor(oa,Za){this.containerType="full-pane";this.identifier=null;this.ga=oa;this.identifier=Za}openView(){this.ga.Vb(li.a.d3b,2)}closeView(){this.ga.Zb(li.a.yub,2,!0)}invokeModalConfirmationDialog(oa,Za,xb){const Zb=new Kj.StandardDialog;xb&&xb.title&&xb.body&&xb.confirmButton&&xb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),xb=new Vg("","","",""));Zb.Md=1;Zb.Ue(1,xb.confirmButton);
Zb.Ue(0,xb.cancelButton);Zb.Yx(xb.title,xb.body,1,sc=>{1===sc?oa():Za()})}}Object(f.a)(Tj,"ViewContainerAPI",null,[348,349]);class oh{constructor(oa,Za,xb){this.Lup=oa;this.lh=Za;this.ZQa=xb;this.vd=new cc.a;this.Lup.execute(Zb=>{this.ZQa.oxe("OnBeforeTrackChangeMarkupViewChange",(sc,$c)=>{$c&&$c.sfg!==Zb.nl&&this.vd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",$c)});this.ZQa.oxe("OnAfterTrackChangeMarkupViewChangeEventKey",(sc,$c)=>{$c&&$c.nl===Zb.nl&&(tp.nl=Zb.nl,this.vd.raiseEvent("OnAfterTrackChangeMarkupViewChange",
$c))})})}H2(oa,Za){this.vd.addHandler(oa,Za)}G2(oa,Za){this.vd.raiseEvent(oa,Za)}zwe(){this.lh.rtg||(this.lh.rtg=!0,this.vd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(oh,"WordCommentEventsActor",null,[]);var Fc=e(1844);class Io{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Io,"InitCommentSessionResult",null,[]);class Rl extends Io{constructor(){super();this.updatedDraftSessionConfiguration=null}}
Object(f.a)(Rl,"BeginDraftingHostResult",Io,[]);var tg=e(2156),Dq=e(2101),Gp=e(1050);class Hp{constructor(oa,Za,xb,Zb,sc,$c,Ed,Ud,Vd,Ie,Ue,dg,Pf,pc,yi){this.jj=oa;this.Wya=Za;this.ssk=xb;this.Mvp=Zb;this.q_d=sc;this.zv=$c;this.xv=Ed;this.focusManager=Ud;this.vE=Vd;this.Tb=Ie;this.Om=Ue;this.q4=dg;this.lh=Pf;this.OCl=pc;this.MCl=yi;this.sbc=this.$aa=this.vq=null;this.fxk="WordWebCommitNewCommentActivity";this.gxk="WordWebCommitTaskActivity";this.cxk="WordWebCommentReactionActivity";this.phh=null}get lra(){return this.$aa}Mmo(oa){var Za;
const xb=this.lra.$A,Zb=this.$aa.vT();if(Zb&&xb){const sc=Gp.a.dsb(null!==(Za=xb.authorId)&&void 0!==Za?Za:"");Za=new Fc.a(xb.authorId,xb.Wfc,xb.author,null!==sc&&void 0!==sc?sc:"",!0);oa.author=Za;oa.insertIndex=Array.indexOf(Zb,xb);oa.authorName=xb.author;oa.authorIdentity="";return null}return Gh.a.mH(-2130915320)}initialize(oa,Za,xb,Zb){this.vq=oa;this.$aa=Za;this.sbc=xb;this.phh=Zb}beginDraftingAsync(oa){if(!oa)return new Promise((Zb,sc)=>{sc(Gh.a.mH(-2130915327))});const Za=new Rl,xb=Yg.a.SNf(oa.sessionType);
return void 0===xb||null===xb?new Promise((Zb,sc)=>{sc(Gh.a.mH(-2130915317))}):new Promise((Zb,sc)=>{Gh.a.c8(this.jj,()=>{if(1!==this.vq.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.vq.mode),sc(Gh.a.mH(-2130915325));else{this.A5h();try{switch(xb){case 0:if(!this.vq.Hia.Evb()){sc(Gh.a.mH(-2130915326));return}this.OCl.Gde();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${oa.draftId}`);this.vq.JMb(oa);break;case 1:if(!oa.threadId||""===
oa.threadId){sc(Gh.a.mH(-2130915324));return}if(this.zv.SDe){const Ud=this.$aa.tH(oa.threadId);if(Ud){const Vd=this.$aa.BAi(Ud,!1),Ie=tg.a.pSb(Ud,Vd,Ud.authorId===this.zv.TZ);Ie&&this.q_d.invoke(oa.threadId,Ie)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.vq.mode)}this.vq.vob(oa.threadId,oa);break;case 3:if(!oa.threadId||""===oa.threadId){sc(Gh.a.mH(-2130915324));return}var $c=this.$aa.tH(oa.threadId);if(!$c){sc(Gh.a.mH(-2130915323));return}this.vq.urb($c,
oa);break;case 2:if(!oa.commentId||""===oa.commentId){sc(Gh.a.mH(-2130915324));return}const Ed=this.$aa.tH(oa.commentId);if(!Ed){sc(Gh.a.mH(-2130915323));return}this.vq.urb(Ed,oa)}}catch(Ed){sc(Ed);this.VLj();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Ed} on Session ${xb}`);return}($c=this.Mmo(Za))?sc($c):Zb(Za);this.VLj()}},gj.a.beginDraftingAsync)})}commit(oa,Za,xb){const Zb=this.lra.$A;if(!Zb)throw Gh.a.mH(-2130915320);var sc=Zb.yC;if(!sc)throw Gh.a.mH(-2130915320);const $c=Yg.a.SNf(sc.sessionType);
if(void 0===$c||null===$c)throw Gh.a.mH(-2130915317);if(oa!==sc.draftId)throw Gh.a.mH(-2130915327);let Ed=!1,Ud=!1;sc=!1;switch($c){case 3:if(!xb)throw Gh.a.mH(-2130915327);break;case 0:this.Om.Ae(()=>{if(!this.vq.Hia.Evb())throw Gh.a.mH(-2130915326);Zb.text=[Za];this.vq.cF&&!this.lh.Ln?this.vq.Oho(()=>{this.vq.SBa(Zb);this.vq.Q5l(oa,Zb.id)}):this.vq.SBa(Zb);Ud=xb&&null!=xb.Task;Ed=!0;Gh.a.c8(this.jj,()=>{this.wAb(Zb.id)},gj.a.wAb)},"WESCA:C:C");break;case 1:this.Om.Ae(()=>{Zb.text=[Za];this.vq.SBa(Zb);
Ud=xb&&null!=xb.Task;Ed=!0},"WESCA:C:R");break;case 2:this.Om.Ae(()=>{Zb.text=[Za];this.vq.eqb(Zb);this.CBj(Xf.a.AKn)},"WESCA:C:E");break;default:throw Gh.a.mH(-2130915322);}xb&&(xb.Resolve&&(this.VSj(Zb,xb.Resolve.isResolved),xb.Resolve.isResolved&&!this.lh.Ln&&this.vq.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),xb.Task&&this.vq.nDl(Zb,xb.Task),xb.Reaction&&(sc=!0,xb.Reaction.isActive?this.vq.hUd(Zb,xb.Reaction.reactionType):this.vq.Bxe(Zb,xb.Reaction.reactionType)));this.zv.eDl&&Ud&&this.vE.execute(Vd=>
Vd.logActivity(this.gxk,"CommentsTasksFpsIsEnabled"));Ed&&this.vE.execute(Vd=>{Vd.logActivity(this.fxk,"CommentsFpsIsEnabled")});sc&&this.vE.execute(Vd=>{Vd.logActivity(this.cxk,"CommentReactionsFpsIsEnabled")});return Zb.id}endCommentSession(oa){const Za=this.lra.$A;if(Za){if(Za.yC&&Za.yC.draftId!==oa)throw Gh.a.mH(-2130915327);if(Za.kt===Jc.a.$F)this.vq.deleteComment(Za),!this.vq.cF||Za.kg||this.lh.Ln||this.focusManager.Rg(bf.AFrame.Co);else{if(3!==this.vq.mode){a.ULS.sendTraceTag(33621450,327,
50,"CommentingMode != EditingComment at the time of ending a comment session");return}Za.kt=Jc.a.normal;Za.T1a=Dq.a.succeeded;Za.yC=null;this.vq.wqf()}}this.xv&&this.xv.Ne(!0);this.lra.bae()||this.Wya.TPg(1,!this.vq.mode)}deleteComment(oa){(oa=this.$aa.tH(oa))?(this.vq.deleteComment(oa),this.vq.cF&&!this.lh.Ln?oa.kg||this.focusManager.Rg(bf.AFrame.Co):this.focusManager.scopeChanged(bf.AFrame.Xu),this.Mvp.YFg(oa)&&this.CBj(Xf.a.Bej)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(oa){this.wAb(oa,
0)}highlightComment(oa){this.vq.bvc(oa,0)}setThreadResolvedState(oa,Za){(oa=this.$aa.tH(oa))&&this.VSj(oa,Za)}VSj(oa,Za){if(oa.kg&&""!==oa.kg)throw Gh.a.mH(-2130915321);this.vq.mOb(oa,Za);Za&&!this.lh.Ln&&this.focusManager.Rg(bf.AFrame.Co)}presentLinkToComment(oa){var Za=this.$aa.tH(oa);Za?(Za=this.lra.r9d(Za))?(oa={["nav"]:btoa(`{"${Pg.a.comment}":${Za}}`),["mode"]:"copy"},this.MCl.Sy(Xf.a.presentLinkToComment),this.Tb.Zb(li.a.wca,2,oa,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,
327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",oa):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",oa)}selectFirstThreadInNextCommentContext(){this.vq.xQj(0)}selectLastThreadInPreviousCommentContext(){this.vq.tVo()}registerForCommentEvents(oa){const Za=this.lra.iLf(this.zv.o3b&&this.zv.qt&&!this.lh.Ln),xb=this.lra.r4a,Zb=this.lra.bae(),sc=!this.vq.mode;this.Wya.X4o();this.phh.RGm().then($c=>{this.Wya.MCo(oa,Za,Zb,sc,xb,$c);this.Wya.TPg(Zb?5:
1,sc);this.xv&&this.xv.Ne(!0)})}unregisterForCommentEvents(oa){this.Wya.M4b(oa)}registerForAction(oa,Za){this.ssk.p1a(oa,Za)}unregisterForAction(){}checkAtMentionCapability(){return this.sbc?this.sbc.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(oa=>{oa(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}A5h(){const oa=this.vq.cF&&
!this.lh.Ln?bf.AFrame.pT:bf.AFrame.Xu;if(oa===bf.AFrame.Xu){if(!this.lh.Ln)return;Pd.UISurfaces.aw().then(Za=>{Za.setSelectedTaskPane(ai.a.n_d);return null})}this.focusManager.scopeChanged(oa)}wAb(oa,Za=1){this.A5h();this.q4.rQj(oa,Object.assign(new eg.a,{gea:Za,i6:1===Za}))}VLj(){this.vq.Hia.sob&&(this.vq.Hia.sob=!1)}CBj(oa){this.Tb.Vb(oa,2)}}Object(f.a)(Hp,"WordEditorSharedCommentAPI",null,[346,347]);class ic{constructor(oa,Za,xb,Zb,sc,$c,Ed=null){this.date=this.author=this.commentBody=this.parentId=
this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=oa;this.parentId=Za;this.commentBody=xb;this.author=Zb;this.date=sc;this.commentFlags=$c;this.usersByReactionType=Ed}}Object(f.a)(ic,"OfficeSharedCommentModel",null,[]);e(1638);class Dj{constructor(oa,Za,xb){this.za=oa;this.mXb=Za;this.RBa=xb;this.NRh="AD";this.LHc=new Ka.a;this.tff=new Ka.a;this.shl=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.mhh=new vh.a}get userPrincipalName(){return this.za.rb("UserPrincipalName")}get bfb(){return this.za.rb("PresenceProvider")}get TZ(){return this.za.rb("PresenceUserId")}get fl(){return this.mXb.value}Lmj(oa){const Za=
this.shl.exec(oa);return Za?Za[1]:oa}aMi(oa,Za=!1){let xb=0;oa.done&&(xb=oa.kg&&""!==oa.kg?xb|4:xb|8);oa.Wai&&(xb|=2);Za&&(xb|=1);this.YFg(oa)&&(xb|=16);oa.U2f&&(xb|=32);this.g5m(oa)||(xb|=128);return xb}g5m(oa){return oa?(oa=this.fl.Mb(oa.objectId))?oa.hasProperty(Va.a.JV):!1:!1}YFg(oa){if(!oa)return!1;if(void 0===oa.authorId||null===oa.authorId||""===oa.authorId)return this.Tle(oa.id,oa.objectId,"Comment AuthorId null or empty"),this.RBa.logKpiFailure(vc.a.QBa,"CommentAuthorIdMissingOrBadFormat",
{isInternal:!0},{name:vc.a.QBa,isInternal:!0}),!1;if(void 0===this.TZ||null===this.TZ||""===this.TZ)return this.Tle(oa.id,oa.objectId,"PresenceUserId null or empty"),!1;if(this.TZ==oa.authorId&&oa.Wfc==this.bfb)return!1;const Za=this.N5d(oa.authorId),xb=this.N5d(this.TZ);if(!Za)return this.Tle(oa.id,oa.objectId,"UserInfo Can't be extracted from Comment AuthorId"),this.RBa.logKpiFailure(vc.a.QBa,"CommentAuthorIdMissingOrBadFormat",{isInternal:!0},{name:vc.a.QBa,isInternal:!0}),!1;if(this.bfb===this.NRh&&
Za&&xb&&Za[0]!=this.userPrincipalName&&Za[1]!=xb[1])return!0;this.Tle(oa.id,oa.objectId,"Unknown");return!1}isCurrentUser(oa){if(!oa||void 0===oa.authorId||null===oa.authorId||""===oa.authorId||void 0===this.TZ||null===this.TZ||""===this.TZ)return!1;if(this.TZ==oa.authorId&&oa.Wfc==this.bfb)return!0;oa=this.N5d(oa.authorId);const Za=this.N5d(this.TZ);return this.bfb===this.NRh&&oa&&Za?oa[0]==this.userPrincipalName||oa[1]==Za[1]:!1}N5d(oa){if(void 0===oa||null===oa)return null;oa=oa.split("::");return 3===
oa.length?oa.slice(1,3):null}Tle(oa,Za,xb){oa&&!this.mhh.contains(oa)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Za}; reason: ${xb}`),this.mhh.add(oa))}Ewi(oa,Za){var xb;if(!oa)return null;const Zb=oa.cje;let sc=!1;kg.y(Za,void 0)&&(sc=!0);Za=oa.author?this.Lmj(oa.author):"";const $c=Gp.a.dsb(null!==(xb=oa.authorId)&&void 0!==xb?xb:"");xb=new Fc.a(oa.authorId?oa.authorId:"",oa.Wfc,Za,null!==$c&&void 0!==$c?$c:"",this.isCurrentUser(oa));return new ic(oa.id?oa.id:
"",oa.kg?oa.kg:"",oa.text&&oa.text.length?oa.text[0]:null,xb,oa.date||Zb?oa.date:new Date,this.aMi(oa,sc),this.cMi(oa.usersByReactionType))}jkm(oa,Za,xb){const Zb=[],sc=new Ka.a;if(!oa)return Zb;for(const $c of oa)$c.kt!==Jc.a.$F&&xb($c)&&($c.id&&this.LHc.Bb($c.id)?(oa=this.LHc.K($c.id),oa=this.gOl($c,oa,Za),Zb.push(oa),sc.W($c.id,oa)):$c.id?(oa=this.Ewi($c,Za),Zb.push(oa),sc.W($c.id,oa)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.LHc=sc;return Zb}Hqm(oa,Za,xb){const Zb=
[];for(const sc of oa)sc.kt!==Jc.a.$F&&xb(sc)&&(sc.id&&this.LHc.Bb(sc.id)?Zb.push(this.LHc.K(sc.id)):sc.id&&Zb.push(this.Ewi(sc,Za)));return Zb}gOl(oa,Za,xb){var Zb=oa.cje,sc=kg.y(xb,void 0);xb=oa.kg?oa.kg:"";const $c=oa.text&&oa.text.length?oa.text[0]:null,Ed=oa.author?this.Lmj(oa.author):"",Ud=oa.authorId?oa.authorId:"",Vd=oa.Wfc?oa.Wfc:"",Ie=Gp.a.dsb(Ud);Zb=oa.date||Zb?oa.date:new Date;sc=this.aMi(oa,sc);const Ue=this.isCurrentUser(oa),dg=this.cMi(oa.usersByReactionType);return Za.parentId===xb&&
Za.commentBody===$c&&Za.author.DisplayName===Ed&&Za.author.UserId===Ud&&Za.author.Provider===Vd&&Za.author.IsCurrentUser===Ue&&Za.date===Zb&&Za.commentFlags===sc&&this.Rfl(Za.usersByReactionType,dg)?Za:(Za=new Fc.a(Ud,Vd,Ed,null!==Ie&&void 0!==Ie?Ie:"",Ue),new ic(oa.id,xb,$c,Za,Zb,sc,dg))}Rfl(oa,Za){if(!oa&&!Za)return!0;if(!Za||!oa)return!1;var xb=Object.keys(oa);if(xb.length!==Object.keys(Za).length)return!1;for(const Zb of xb){if(!(Zb in Za))return!1;xb=oa[Zb];const sc=Za[Zb];if(xb.length!==sc.length)return!1;
for(let $c=0;$c<xb.length;$c++)if(!this.Gfl(xb[$c],sc[$c]))return!1}return!0}Gfl(oa,Za){return oa||Za?oa&&Za&&oa.UserId===Za.UserId&&oa.Provider===Za.Provider&&oa.Email===Za.Email&&oa.DisplayName===Za.DisplayName&&oa.IsCurrentUser===Za.IsCurrentUser?!0:!1:!0}cMi(oa){if(!oa)return null;const Za={},xb=this.za.rb("PresenceUserId");for(const sc of Object.keys(oa)){const $c=[];var Zb=oa[sc];for(const Ed of Zb){Zb=Ed.UserId===xb;let Ud;this.tff.Bb(Ed.UserId)?(Ud=this.tff.K(Ed.UserId),Ud.IsCurrentUser=Zb):
(Ud=new Fc.a(Ed.UserId,Ed.Provider,Ed.DisplayName,Ed.Email,Zb),this.tff.add(Ed.UserId,Ud));$c.push(Ud)}Za[sc]=$c}return Za}}Object(f.a)(Dj,"WordEditorSharedCommentModelTranslator",null,[344]);class Fm{constructor(){this.fr=null;this.lAd=this.tFh=this.Ndh=this.LMh=this.IPh=this.iBh=this.wHh=!1}bMi(){this.fr||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.zVj());return this.fr}RGm(){return new Promise((oa,Za)=>{this.lAd?oa(this.qHi()):
this.qSj().then(()=>{oa(this.qHi())}).catch(xb=>{Za(xb)})})}qHi(){this.lAd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let oa;oa=33;this.Ndh&&(oa|=2);this.wHh&&(oa|=8);this.IPh&&(oa|=16);this.iBh&&(oa|=4);this.LMh&&(oa|=64);this.tFh&&(oa|=128);return oa}}Object(f.a)(Fm,"OfficeSharedCommentsAppCapabilities",null,[1799]);class Il extends Fm{constructor(oa){super();this.hAa=null;this.uj=
oa;this.j6o();this.zVj()}j6o(){this.LMh=this.uj.b4b;this.IPh=!1;this.tFh=this.iBh=this.wHh=!0}initialize(oa){this.hAa=oa;this.qSj()}zVj(){this.fr={};this.fr.LivePersonaPicker="true";this.fr.PersonaColor="true";this.fr.DiscreteHostedComments=this.uj.e0l.toString();this.fr.NewCommentButton="true";this.fr.DisabledChangeGates=this.uj.X_l;this.fr.CommentsFluentUI="true";this.fr.CommentTasks=this.uj.b4b.toString();this.fr.CommentTasksFromReply=this.fr.CommentTasks;this.fr.CommentFriendlyTimestamps=this.uj.pCl.toString();
this.fr.AtMentionFloodgateSurvey=this.uj.Pgl.toString();this.fr.HyperlinksInComments="true";this.fr.LogDraftCommentIdPair="true";this.fr.RichTextFormattingInWeb="true";this.fr.RichContentEditIntegration="true";this.fr.HyperlinksWithDisplayText="true";this.fr.SmartReplies=this.uj.SDe.toString();this.fr.LinkToComment="true";this.fr.TaskPaneWithNewInfrastructure="true";this.fr.CommentReactions="true";this.fr.WebThemeIntegration="true";this.fr.NewSelectionInteractions="true";this.fr.HighlightsAndFontColorInWebComments=
"true";this.fr.TruncationUIWithReadMoreText="true";this.fr.CtrlEnterTip="true";this.fr.AtMentionHintMessage="true";this.fr.LivePersonaCardForWeb="true";this.fr.TaskHistoryRecordIDs=this.uj.jqp.toString();this.fr.ContentNavigation=this.uj.contentNavigationApiEnabled.toString();this.fr.RibbonCommentFilteringEnabled=this.uj.ribbonCommentFilteringEnabled.toString()}qSj(){return new Promise((oa,Za)=>{this.hAa?this.hAa.atMentionsEnabledAsync().then(xb=>{this.Ndh=xb;this.lAd=!0;oa(this.lAd)}):(a.ULS.sendTraceTag(588292830,
327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Za(Gh.a.mH(-2130915320)))})}}Object(f.a)(Il,"WordSharedCommentsAppCapabilities",Fm,[345]);class Mk{constructor(){this._initialized=!1;this.dDl={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:vc.a.IFf,vetoPillar:7};this.sqp={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:bj.a.IFf,vetoPillar:7}}get Feb(){return null!=this.Q6g?
this.Q6g:this.Q6g=(()=>this.Z.resolve("Box4.IPackageBootPerfLogger"))()}e4(oa){this.Feb.e4(kl.a.comments,oa,!0)}get name(){return"WordEditor.Comments"}Ec(oa){this.Z=oa;this.e4("CPConfigStart");oa.ja("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new ll.a(ka.Health.instance,new tk.a,this.dDl)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();oa.ja("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new ll.a(ka.Health.instance,new tk.a,this.sqp)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();
oa.ja("WordEditor.Comments.CommentNodeTracker",()=>new Yf(this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();oa.ja("WordEditor.Comments.CommentsSettings",()=>new kf(y.AFrameworkApplication.J,this.Z.resolve("Box4.IFeatureHelper"),new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd),new Ua.a(()=>am.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();
oa.ja("WordEditor.Comments.CommentsState",()=>new tp).ha();oa.ja("WordEditor.Comments.WordCommentEventsActor",()=>new oh(oa.Za("Box4.TrackChange.ITrackChangeManager"),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();oa.ja("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Dj(y.AFrameworkApplication.J,new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();
oa.ja("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new qi(oa.resolve("WordEditor.Comments.CommentsSettings"),oa.resolve("Box4.Styles.IWACStyleReader"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();oa.ja("Common.Comments.OfficeSharedCommentsEventHost",()=>new tm(y.AFrameworkApplication.zc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();oa.ja("WordEditor.Comments.CommentActionInTypingRecorder",()=>
new Wb(this.Z.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();oa.ja("WordEditor.Comments.EditorCommentModel",Cg.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();oa.ja("WordEditor.Comments.ICommentModelBootLoader",()=>new Ge(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd),new Ua.a(()=>am.a.instance),oa.resolve("WordEditor.Comments.IEditorCommentModel"),
oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("WordEditor.Comments.CommentsSettings"),oa.resolve("WordEditor.Comments.CommentNodeTracker"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));oa.ja("WordEditor.Comments.ICommentFilterActor",()=>new nj(oa.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.J,oa.resolve("WordEditor.Comments.WordCommentEventsActor"),oa.resolve("WordEditor.Comments.CommentsState"),oa.Za("Common.ISystemInitiatedFeedback"))).ha();
oa.resolve("WordEditor.Comments.ICommentFilterActor");oa.ja("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Ya(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("WordEditor.Comments.IEditorCommentModel"),oa.resolve("WordEditor.Comments.WordCommentEventsActor"),oa.resolve("Box4.INotebookManager").Um,sa.a.instance,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),oa.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();
oa.ja("WordEditor.Comments.CommentHighlightUtils",()=>new Rk(oa.resolve("Box4.Highlight.IHighlightManager"))).ha();oa.ja("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Em(oa.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();oa.ja("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new gb(oa.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),oa.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ta.J$,y.AFrameworkApplication.ta.SQa,
y.AFrameworkApplication.va,y.AFrameworkApplication.zc,oa.resolve("WordEditor.Comments.CommentsState"),oa.Za("WordEditor.Comments.IEditorCommentManager"))).ha();oa.ja("WordEditor.Comments.CommentHighlightActor",()=>new Ee(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),oa.resolve("WordEditor.CommentsInteractive.ICommentEditor"),oa.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),oa.Za("WordEditor.Comments.IEditorCommentManager"),sa.a.instance,oa.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),
oa.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),oa.resolve("WordEditor.Comments.CommentHighlightUtils"),oa.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();oa.ja("WordEditor.Comments.CommentHintActor",()=>new fi(oa.resolve("WordEditor.Comments.CommentsSettings"),Cm.a.instance,Fj.a.instance,hj.a.instance,y.AFrameworkApplication.va,Ll.TableCellReader.Dtn,$l.o,new mi.a,oa.Za("Box4.ContentControlConfigSettings"),oa.resolve("WordEditor.Comments.IEditorCommentModel"),
oa.resolve("WordEditor.Comments.ICommentHighlightActor"),oa.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();oa.ja("WordEditor.Comments.CommentMarginEntryPointActor",()=>new We(Cm.a.instance,hj.a.instance,y.AFrameworkApplication.va,oa.Za("Common.IZoomManager"))).ha();oa.ja("WordEditor.Comments.ViewContainerAPI",()=>new Tj(y.AFrameworkApplication.va,
"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();oa.ja("Common.Comments.CommentActivationManager",()=>new wg).as("Common.Comments.ICommentActivationManager").ha();oa.ja("Common.Comments.ViewContainerEventHost",()=>new Od(y.AFrameworkApplication.zc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();oa.ja("WordEditor.Comments.CommentSmartReplyProvider",()=>new Rc(this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.Za("Box4.AugmentationLoop.IUtilsWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();oa.ja("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new Il(oa.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.e4("CPConfigEnd")}init(){this.e4("CPInitStart");
const oa=this.Z.resolve("Box4.IFeatureHelper"),Za=oa.Fs.isCompleted;qb.a.cqc&&Za?this.UUg():oa.Fs.continueWith(()=>{this.UUg()})}UUg(){try{this.Sp(),this.e4("CPInitEnd")}catch(oa){throw a.ULS.yA(524300632,327,10,oa,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",oa),this.Feb.qy(kl.a.comments,"CPInitException",oa,!0),oa;}}Sp(){const oa=this.Z.resolve("WordEditor.Comments.CommentsSettings");this.e4("onAfterGFNLoadedStart");this.Z.ja("WordEditor.Comments.OfficeSharedCommentPane",
()=>new Wp(y.AFrameworkApplication.va,y.AFrameworkApplication.ta.KG,y.AFrameworkApplication.ta.LG,y.AFrameworkApplication.ta.yr,y.AFrameworkApplication.ta.BA,ze.StaticActiveAppFrame.Aa(),Ek.a.instance,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.Z.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.zc,this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),oa,this.Z.resolve("WordEditor.Comments.CommentsState"),
this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.Z.ja("Common.Comments.OfficeSharedCommentsActionHost",()=>new Vi(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane").OFc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.Z.ja("WordEditor.Comments.WordEditorSharedCommentAPI",
()=>new Hp(y.AFrameworkApplication.zc,this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.Z.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),oa,ze.StaticActiveAppFrame.Aa(),y.AFrameworkApplication.ta.yr,this.Z.Za("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,sa.a.instance,this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),
this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();he.a.factory=Se.getInstance;this.Z.ja("WordEditor.Comments.EditorCommentManager",Se.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.Z.ja("WordEditor.Comments.CommentFloatingContainerActor",
()=>new Ze(this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.zc,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${Ml.a.G3a} .${Qk.a.Uic}`),this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
y.AFrameworkApplication.ta.yr,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const Za=this.Z.resolve("WordEditor.Sidetrack.SidetrackSettings"),xb=Za.trackChangeInSidetrackEnabled;xb&&this.Z.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").DGj(this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.Z.ja("WordEditor.Comments.FloatingCommentManager",()=>new rc(this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),
y.AFrameworkApplication.zc,sa.a.instance,this.Z.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),Za)).ha();this.Z.ja("WordEditor.Comments.IFloatingCommentManager",()=>xb?this.Z.resolve("WordEditor.Sidetrack.SidetrackManager"):this.Z.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();
this.Z.ja("WordEditor.Comments.CommentSelectionActor",()=>new um(y.AFrameworkApplication.va,this.Z.resolve("Common.Comments.ICommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHighlightActor"),Oe.getInstance(),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),this.Z.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ta.yr,this.Z.resolve("WordEditor.Comments.CommentsState"),oa,new Ua.a(()=>km.a.instance),this.Z.resolve("WordEditor.Comments.CommentNodeTracker"),
this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.Z.Za("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.Z.ja("WordEditor.Comments.CommentInitActor",()=>new xd(this.Z.resolve("WordEditor.Comments.IEditorCommentManager"),this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),this.Z.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),oa,this.Z.resolve("WordEditor.Comments.CommentsState"),
this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),Oe.getInstance(),ze.StaticActiveAppFrame.Aa().Kt,y.AFrameworkApplication.va,this.Z.resolve("Common.IDynamicScriptLoaderProvider").JE,this.Z.Za("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ta.yr,this.Z.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.Z.resolve("Common.Comments.ICommentSmartReplyProvider"),this.Z.resolve("Common.Comments.ICommentActivationManager"),this.Z.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.Z.Za("Common.ISystemInitiatedFeedback"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.Za("Common.App.SafeLinks.ISafeLinksManager"),this.Z.Za("Common.App.People.IExternalPeopleAPI"),this.Z.resolve("Common.OfficeSharedCommentsTelemetry"),this.Z.resolve("Common.Comments.IViewContainerEventHost"),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.Z.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.Z.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
Za,this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.Z.resolve("Box4.IPackageBootPerfLogger"),this.Z.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.Z.ja("WordEditor.Comments.CommentsActionManager",()=>new uk(this.Z.resolve("WordEditor.Comments.EditorCommentManager"),this.Z.resolve("WordEditor.Comments.EditorCommentModel"),this.Z.resolve("WordEditor.Comments.ICommentHintActor"),
this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("WordEditor.Comments.IFloatingCommentManager"),oa,this.Z.resolve("Common.Comments.ICommentPane"),new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd.Hd),y.AFrameworkApplication.va,new Ua.a(()=>km.a.instance),td.FocusManager.instance(),sa.a.instance,this.Z.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
this.Z.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.CommentsActionManager").ha();this.Z.resolve("WordEditor.Comments.CommentInitActor");oa.contentNavigationApiEnabled&&(this.Z.ja("WordEditor.Comments.CommentContentProvider",()=>new gl(this.Z.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.Z.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.Z.ja("WordEditor.Comments.CommentContentActor",()=>new Um(this.Z.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.Z.resolve("WordEditor.Comments.IEditorCommentModel"),this.Z.resolve("WordEditor.Comments.ICommentSelectionActor"),this.Z.resolve("WordEditor.Comments.IEditorCommentManager"),this.Z.resolve("WordEditor.Comments.CommentsState"))).ha(),this.Z.resolve("WordEditor.Comments.CommentContentProvider"),this.Z.resolve("WordEditor.Comments.CommentContentActor"));const Zb=oa.qt,sc=this.Z.resolve("WordEditor.Comments.EditorCommentManager");this.Z.resolve("WordEditor.Comments.CommentsActionManager");sc&&Zb&&
(this.Z.resolve("WordEditor.Comments.CommentsState").oob=Mk.fzi(),oa.$Pb||this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").G2("OnCommentInit"));Ci.a.OMn();oa.boc&&ze.StaticActiveAppFrame.Aa().tb.DDf();he.a.instance&&(oa.$Pb||kh.a.get_instance().Zk(4,()=>{this.g3n(Zb)},11).continueWith(()=>{this.qdn()}),this._initialized=!0);this.PAo(this.Z.Za("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}qdn(){this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").G2("OnCommentInit")}g3n(oa){oa||
this.tZm()}tZm(){const oa=Mk.fzi();oa&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.eH),this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").G2("OnCommentInit",Object.assign(new He.a,{NOa:()=>{he.a.instance.Hia.isVisible||y.AFrameworkApplication.va.Vb(li.a.S2,2);this.Z.resolve("WordEditor.Comments.ICommentSelectionActor").oQj(oa,Object.assign(new eg.a,{bGg:!0}))}})),this.Z.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Sy(li.a.ltf))}PAo(oa,
Za,xb){oa&&oa.execute(Zb=>{Zb.SW(new Dm.a(Za,xb))})}dispose(){this._initialized&&(he.a.instance&&he.a.instance.dispose(),this._initialized=!1)}static fzi(){return y.AFrameworkApplication.J.rb("BootActivityNavigationId")}}Object(f.a)(Mk,"PackageManager",null,[0,1]);const Eq=oa=>{const Za=J.a.instance.Za("Box4.IPackageBootPerfLogger"),xb=window.performance.now();Za.execute(Zb=>{Zb.qy(kl.a.comments,"CPMain",xb,!0)});Ca.a.instance.Rc(new Mk,0,oa)};var ge=e(1010);class Lj{isComment(oa){return Ch.a.isComment(oa)}Oge(oa){return Ch.a.Oge(oa)}f0f(oa){return Ch.a.f0f(oa)}fig(oa,
Za){Ch.a.fig(oa,Za)}jig(oa,Za){Ch.a.jig(oa,Za)}xwf(oa){return Ch.a.xwf(oa)}Wdb(oa){return am.a.instance.Wdb(oa)}deleteComment(oa,Za){Ch.a.deleteComment(oa,Za)}B2d(oa,Za){Ch.a.B2d(oa,Za)}Mzb(oa){Ch.a.Mzb(oa)}kha(oa,Za,xb){return Ch.a.kha(oa,Za,xb)}aDa(oa,Za,xb){return Ch.a.aDa(oa,Za,xb)}unc(oa,Za){return Ch.a.unc(oa,Za)}m5c(oa,Za,xb,Zb=null){return Ch.a.m5c(oa,Za,xb,Zb)}Hec(oa,Za,xb,Zb){Ch.a.Hec(oa,Za,xb,Zb)}gUd(oa,Za,xb,Zb){return Ch.a.gUd(oa,Za,xb,Zb)}get DVb(){return Ch.a.DVb}set DVb(oa){Ch.a.DVb=
oa}sZb(oa,Za){Ch.a.sZb(oa,Za)}Tnd(oa){Ch.a.Tnd(oa)}rvg(oa){Ch.a.rvg(oa)}qae(oa,Za){return Ch.a.qae(oa,Za)}gig(oa,Za){Ch.a.gig(oa,Za)}iig(oa,Za){Ch.a.iig(oa,Za)}Dpe(oa,Za,xb,Zb,sc,$c){Ch.a.Dpe(oa,Za,xb,Zb,sc,$c)}KDf(oa,Za){Ch.a.KDf(oa,Za)}pld(oa,Za,xb,Zb){return Ch.a.pld(oa,Za,xb,Zb)}uld(oa,Za,xb,Zb){return Ch.a.uld(oa,Za,xb,Zb)}}Object(f.a)(Lj,"CommentEditorProxy",null,[230]);class Xp{constructor(){this.Z=null}get T3b(){return null!=this.g$g?this.g$g:this.g$g=(()=>this.Z.Za("WordEditor.ITableEditor"))()}get Feb(){return null!=
this.R6g?this.R6g:this.R6g=(()=>this.Z.resolve("Box4.IPackageBootPerfLogger"))()}e4(oa){this.Feb.e4(kl.a.comments,oa,!0)}get name(){return"WordEditor.CommentsInteractive"}Ec(oa){this.Z=oa;this.e4("CIPConfigStart");oa.ja("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Lj).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.e4("CIPConfigEnd")}init(){this.e4("CIPInitStart");this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp();this.e4("CIPInitEnd")})}Sp(){this.U8m()}dispose(){}U8m(){wj.a.q1a(Ch.a.jig);
ge.a.WUd(Ch.a.gig);ge.a.XUd(Ch.a.iig);ge.a.j7k(Ch.a.d3n);this.T3b.execute(Za=>{Za.vjf(Ch.a.sZb)});const oa=qb.a.wf.Um;oa.Hf(39).yq(Ch.a.fig);ge.a.B6k(Ch.a.g2n);ge.a.t6k(Ch.a.v1n);Ke.a.isEnabled&&oa.Hf(12).bA(Ch.a.Xnk)}}Object(f.a)(Xp,"PackageManager",null,[0,1]);const Cl=oa=>{const Za=J.a.instance.Za("Box4.IPackageBootPerfLogger"),xb=window.performance.now();Za.execute(Zb=>{Zb.qy(kl.a.comments,"CIPMain",xb,!0)});Ca.a.instance.Rc(new Xp,0,oa)};var Yp=e(101),Qo=e(1657),oq=e(421),Fk=e(116);class Di{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(Di,"TaskPaneGroupAppProps",null,[]);var tn=e(188);class vk{static tDl(oa,Za){td.FocusManager.kO()&&(Fj.a.instance.$Ja(oa,Za,!1),tn.a.instance.$Ja(oa,Za,!1),y.AFrameworkApplication.ta.BA.vY(oa))}}Object(f.a)(vk,"ReactTaskPaneManagerUtils",null,[]);var bg=e(169),Ri=e(377);class vm{constructor(){this.type=
null}}Object(f.a)(vm,"SampleTaskPaneProps",null,[]);var ef=e(1659),xj=e(118);class Sg{constructor(){this.entry=null;this.show=!1}}Object(f.a)(Sg,"AnimationBatchEntry",null,[]);var Zj=e(383),hl=e(1658),Ao=e(199);class Bn{constructor(){this.hEh=[];this.iEh=[];this.Bsa={};this.tSa=this.sSa=null;this.wRd=!1;this.J3=null;this.DOd=this.EJd=0;this.gGc=[];this.e0e=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.mwb;this.qB=!1}initialize(){this.wRd=!1;(this.qB=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.z9)&&
this.lxf()}nxf(oa,Za,xb,Zb){Za=this.Mbe(Za);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.lxf();const sc=document.createElement("div");sc.id=Za;sc.className=Bn.vNp;sc.style.width="0";this.e0e||(this.E1k(xb,Za,sc),this.Bsa[Za]=oa.nxf(Za,xb,Zb,sc));return sc}lxf(){this.wRd||this.y8o()}E1k(oa,Za,xb){let Zb=null,sc=null;0===oa?(Zb=this.sSa,sc=this.hEh):1===oa&&(Zb=this.tSa,sc=this.iEh);if(Zb){oa=!1;for(let $c=0;$c<sc.length;$c++)if(!oa)sc[$c]===Za&&(oa=!0);else if(sc[$c]in this.Bsa){this.xin(Zb,
xb,this.Bsa[sc[$c]]);return}Zb.appendChild(xb)}}xin(oa,Za,xb){oa.insertBefore(Za,xb.element)}o1l(oa){oa=this.Mbe(oa);if(oa in this.Bsa){const Za=this.Bsa[oa];Za.element.parentNode.removeChild(Za.element);delete this.Bsa[oa]}}X_j(oa){oa=this.Mbe(oa);oa in this.Bsa&&(oa=this.Bsa[oa])&&!oa.isVisible&&(this.j_j(oa,!0),this.JVh(oa.position,!0,this.w3h(oa,!0)),1===oa.position&&1<ua.a.count(this.Bsa)&&this.tOn())}Z6m(oa){oa=this.Mbe(oa);oa in this.Bsa&&(oa=this.Bsa[oa])&&oa.isVisible&&(this.j_j(oa,!1),this.JVh(oa.position,
!1,this.w3h(oa,!1)))}zPb(oa){if(this.J3)return this.J3;const Za=document.createElement("div");document.body.appendChild(Za);Za&&(this.J3=new Qo.a(Za,oa));return this.J3}j_j(oa,Za){oa.element&&(oa.isVisible=Za,this.gGc.push(Object.assign(new Sg,{entry:oa,show:Za})));0===oa.position?this.EJd+=Za?1:-1:this.DOd+=Za?1:-1;1===this.gGc.length&&window.setTimeout(Object(xj.a)(this,this.Ikp,"startPaneAnimation"),0);this.qB&&oa.element&&oa.element.parentNode&&(0===oa.position&&!this.EJd||1===oa.position&&!this.DOd?
(oa.element.parentNode.style.minHeight="0px",oa.element.parentNode.style.height="0px",oa.element.parentNode.style.overflow="hidden"):(oa.element.parentNode.style.minHeight="",oa.element.parentNode.style.height="",oa.element.parentNode.style.overflow=""))}Ikp(){this.csj();var oa=dd.where(dd.asEnumerable(this.gGc),sc=>0===sc.entry.position),Za=dd.where(oa,sc=>!sc.show);if(dd.any(Za)&&dd.Ct(Za)!==dd.Ct(oa)){for(var xb of Za)xb.entry.element.style.width="0";oa=dd.where(oa,sc=>sc.show)}Za=dd.where(dd.asEnumerable(this.gGc),
sc=>1===sc.entry.position);xb=dd.where(Za,sc=>!sc.show);if(dd.any(xb)&&dd.Ct(xb)!==dd.Ct(Za)){for(var Zb of xb)Zb.entry.element.style.width="0";Za=dd.where(Za,sc=>sc.show)}for(const sc of dd.concat(oa,Za))oa=sc.entry,Ao.WacAirSpace.f_(oa.element,Zj.a.SGg),Zb=new hl.a(oa.element),sc.show?Zb.Rkf(0,oa.width):Zb.Rkf(oa.width,0),Ao.WacAirSpace.animate(Zb,null,null);this.gGc.length=0}csj(){}w3h(oa,Za){let xb=oa.width;oa=0===oa.position?this.EJd:this.DOd;if(Za&&1===oa||!Za&&!oa)xb+=1;return xb}y8o(){this.wRd||
(this.sSa||(this.sSa=document.createElement("div"),this.sSa.id=Bn.tNp,this.sSa.className=Bn.Ogk,Sys.UI.DomElement.addCssClass(this.sSa,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.hda&&Sys.UI.DomElement.addCssClass(this.sSa,"FlexBoxLayout"),this.e0e&&Sys.UI.DomElement.addCssClass(this.sSa,Bn.Lgk),this.TTh(0,this.sSa)),this.tSa||(this.tSa=document.createElement("div"),this.tSa.id=Bn.uNp,this.tSa.className=Bn.Ogk,Sys.UI.DomElement.addCssClass(this.tSa,"alignRight"),y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.hda&&Sys.UI.DomElement.addCssClass(this.tSa,"FlexBoxLayout"),this.e0e&&Sys.UI.DomElement.addCssClass(this.tSa,Bn.Lgk),this.TTh(1,this.tSa)),this.zuj(this.sSa,this.tSa),this.wRd=!0)}zuj(){}hBa(oa,Za){Array.add(1===oa?this.iEh:this.hEh,Za)}Mbe(oa){return oa+"-Entry"}tOn(){let oa=0;for(const Za of ua.a.zT(this.Bsa)){const xb=Object(N.a)(1878,this.Bsa[Za]);xb&&xb.isVisible&&1===xb.position&&oa++}2===oa?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<oa&&
a.ULS.sendTraceTag(595179605,320,50,oa+" simultaneous panes open")}}Bn.tNp="WACTaskPaneContainerLeft";Bn.uNp="WACTaskPaneContainerRight";Bn.Ogk="WACTaskPaneContainer";Bn.vNp="WACTaskPaneEntry";Bn.Lgk="WACReactTaskPaneContainer";Object(f.a)(Bn,"BaseTaskPaneManager",null,[1879]);var Ol=e(649),Jo=e(310);class eo extends Bn{constructor(oa,Za){super();this.SOc=this.ROc=this.Lff=this.Kff=0;this.Rvi=()=>{Object(Rg.a)().forEach(xb=>{xb.H7d()})};this.ga=oa;this.Zsh=Za}TTh(oa,Za){const xb=ze.StaticActiveAppFrame.Aa().VH;
xb.parentNode&&(oa?1===oa&&(this.qB?((oa=Object(Jo.a)("FarPane"))&&oa.appendChild(Za),Za.classList.add("regionComposer"),ze.StaticActiveAppFrame.Aa().ES.registerBoundingWindowRectsChanged("farPane",(Zb,sc)=>{"DP"===sc||3===sc?Za.classList.add("DL"):Za.classList.remove("DL")})):xb.parentNode.insertBefore(Za,xb.nextSibling)):this.qB?((oa=Object(Jo.a)("NearPane"))&&oa.appendChild(Za),Za.classList.add("regionComposer")):xb.parentNode.insertBefore(Za,xb))}JVh(oa,Za,xb){this.qB||(Za=Za?xb:-xb,oa?this.SOc+=
Za:this.ROc+=Za)}csj(){if(!this.qB){var oa=ze.StaticActiveAppFrame.Aa().VH;Ao.WacAirSpace.f_(oa,Zj.a.SGg);if(this.Kff!==this.ROc){const Za=new Ol.a(oa);Za.Val(this.Kff,this.ROc,this.Zsh);Ao.WacAirSpace.animate(Za,null,this.Rvi);this.Kff=this.ROc}this.Lff!==this.SOc&&(oa=new Ol.a(oa),oa.Wal(this.Lff,this.SOc,this.Zsh),Ao.WacAirSpace.animate(oa,null,this.Rvi),this.Lff=this.SOc)}}}Object(f.a)(eo,"TaskPaneManager",Bn,[]);var tl=e(165);class Ro extends eo{get h2i(){null==this.tMe&&(this.tMe=y.AFrameworkApplication.J?
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.tMe}constructor(oa,Za){super(oa,Za);this.w0=mk.KeyInputManager.xc(Yp.a.iB,0);this.x0=mk.KeyInputManager.xc(Yp.a.iB,4);this.D9e=this.BOc=null;this.zyh="AccCheckerTaskPane";this.sa=new cc.a;this.isPaneOpen=!1;this.tMe=this.$Ue=null;this.hBa(0,"SampleTaskPane");this.hBa(0,tl.a.nsb);this.hBa(1,tl.a.Ggl);this.hBa(1,"CustomTaskPane");this.hBa(1,tl.a.FZf);this.hBa(1,bf.AFrame.Xu);
this.hBa(1,bf.AFrame.KRh);this.hBa(1,bf.AFrame.FRh);this.hBa(1,tl.a.M7d);this.hBa(1,tl.a.L0c);this.hBa(1,tl.a.F2c);this.hBa(1,tl.a.U9i);this.YHk=(this.udh=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Pb)&&y.AFrameworkApplication.ta.Pb.O3f;this.ZGk=Sk.a.isc;this.dHk=this.udh&&y.AFrameworkApplication.ta.Pb.Ecd;this.initialize();oa.nb(Xf.a.kHg,Bl.a.application,Ro.kHg,96)}get Eye(){if(!ze.StaticActiveAppFrame.Aa()||!ze.StaticActiveAppFrame.Aa().VH)return null;this.D9e||(this.D9e=new Qo.a(ze.StaticActiveAppFrame.Aa().VH,
td.FocusManager.instance()));return this.D9e}mc(){}zuj(oa,Za){const xb=oq.a.instance,Zb=td.FocusManager.instance(),sc=Fk.EventHandlerManager.instance,$c=this;Pd.UISurfaces.aw().then(Ed=>{$c.BOc=$c.zPb(Zb);let Ud;Ed.renderTaskPaneGroups(oa,Za,(Ud=new Di,Ud.middleContainer=ze.StaticActiveAppFrame.Aa().VH,Ud.onTabStripFocus=()=>{Zb.scopeChanged(tl.a.RBc)},Ud.onOpen=(Vd,Ie)=>{$c.P3f(Vd)&&vk.tDl(Vd,Ie);sc.Nhf(Ie,"focus",$c.sLi(Vd,Zb),!0);var Ue=$c.Z3i(Vd),dg=Ed.selectors.getTabbedTaskPaneCount(Ue?1:2);
Ue=Ue?tl.a.qFe:tl.a.RBc;1===dg&&(xb.Dba(Ue),this.isPaneOpen=!0,this.VDj({isPaneOpen:this.isPaneOpen,a4b:Ie}));Ie=$c.cNf(Vd);if(dg=Zb.te(Ie))dg.rZc=Ue,$c.scp(Vd)&&(dg.Pu($c.w0),dg.Pu($c.x0)),xb.E2i(Ie)&&xb.wz(Ie);this.h2i&&this.I5d&&this.I5d.dismissFloatie(!0)},Ud.onClose=(Vd,Ie)=>{$c.P3f(Vd);const Ue=$c.Z3i(Vd),dg=Ue?tl.a.qFe:tl.a.RBc;Ed.selectors.getTabbedTaskPaneCount(Ue?1:2)||(xb.wz(dg),this.isPaneOpen=!1,this.VDj({isPaneOpen:this.isPaneOpen,a4b:Ie}));sc.vvg(Ie,"focus",$c.sLi(Vd,Zb),!0);this.h2i&&
this.I5d&&this.I5d.dismissFloatie(!0)},Ud.setFocusCallback=(Vd,Ie)=>{$c.P3f(Vd)&&Ie&&(Vd=Zb.te($c.cNf(Vd)),Vd.Eyl(),Vd.Rla(Ie))},Ud.onOverflowMenuOpen=()=>{if($c.BOc)$c.BOc.onMenuOpen()},Ud.onOverflowMenuClose=()=>{if($c.BOc)$c.BOc.onMenuClose()},Ud.onShow=(Vd,Ie)=>{2===Ie&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Zb.Rg(Vd)},0)})},Ud.onHide=(Vd,Ie,Ue)=>{Ue&&1!==Ie&&Zb.Rg(Zb.NY)},Ud.onResizeStart=()=>{if(ze.StaticActiveAppFrame.Aa()&&(ze.StaticActiveAppFrame.Aa().VH.className=Ml.a.ORg,
$c.Eye))$c.Eye.onMenuOpen()},Ud.onResizeEnd=()=>{if(ze.StaticActiveAppFrame.Aa()&&(bg.a.C6i()||(ze.StaticActiveAppFrame.Aa().VH.className+=" "+ze.StaticActiveAppFrame.Aa().L4h),$c.Eye))$c.Eye.onMenuClose()},Ud));this.qea(tl.a.RBc,Zb,Za,$c);this.qea(tl.a.qFe,Zb,oa,$c);return null})}qea(oa,Za,xb,Zb){const sc=Za.te(oa);sc.parent=bf.AFrame.rr;sc.LN=!0;Fj.a.instance.$Ja(oa,xb,!1);tn.a.instance.$Ja(oa,xb,!1);oa=new Ri.DOMFocusListing(()=>xb);oa.jo(3);oa.jo(2);oa.jo(4);oa.jo(1);Za.jta(()=>xb,sc,oa).nR=!0;
sc.Pu(Zb.w0);sc.Pu(Zb.x0)}cNf(oa){return oa===this.zyh?tl.a.MQh:oa}sLi(oa,Za){return()=>{Za.scopeChanged(this.cNf(oa))}}scp(oa){return oa===this.zyh?!1:!0}Fqn(oa){return oa===tl.a.nsb}P3f(oa){return this.Fqn(oa)||oa===tl.a.MQh||0<=oa.indexOf("AppForOfficePanel")||oa===tl.a.M7d||oa===tl.a.FZf&&this.YHk||oa===tl.a.L0c&&this.ZGk||oa===tl.a.F2c&&this.dHk||oa===ef.a.ORb||oa===tl.a.U9i?!0:!1}Z3i(oa){return oa===tl.a.nsb||"SampleTaskPane"===oa}static sUm(){return new Ro(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static kHg(oa,
Za,xb,Zb,sc){if(1===xb)return 32;Pd.UISurfaces.aw().then($c=>{$c.showTaskPane(sc,Object.assign(new Tn.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new vm,{type:"SampleTaskPaneProps"})}));return null});return 32}u8a(oa){this.sa.addHandler("onPaneToggle",oa)}pod(oa){this.sa.removeHandler("onPaneToggle",oa)}VDj(oa){this.sa.raiseEvent("onPaneToggle",oa)}get I5d(){this.$Ue||(this.$Ue=J.a.instance.Wa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.$Ue}}
Object(f.a)(Ro,"TaskPaneManager",eo,[228]);class vr{constructor(){this.pY=null}get name(){return"WordEditor.TaskPaneManager"}Ec(){}init(){this.pY=Ro.sUm();this.pY.mc();ze.StaticActiveAppFrame.Aa().qhb=this.pY}dispose(){}}Object(f.a)(vr,"PackageManager",null,[0,1]);var up=e(2155),kn=e(112),ip=e(1661);class mm{constructor(oa,Za,xb,Zb,sc,$c,Ed){this.fVa=oa;this.Xfa=Za;this.sba=xb;this.td=Zb;this.oDk=sc;this.G4e=$c;this.rIb=Ed;ip.a.i7k((Ud,Vd)=>{this.p5k(Vd.graphNode,Vd.$Bl)});ip.a.P7k((Ud,Vd)=>{this.JIl(Vd.graphNode,
Vd.Nzl)})}u$d(){var oa=this.oDk();const Za=this.td.Lm();Za.set(oa);if(this.Xfa.Vyp(Za))return Za;Za.set(oa);Object(kn.a)().bU(Za);oa=this.sba.dRl(Za.currentNode);Za.yk(oa);return Za}Kbe(oa){const Za=this.u$d();let xb=null;this.Xfa.D7d(Za,Zb=>{this.sba.ANi(Zb)===oa&&(xb=Zb);return!xb});return xb}wNi(oa){const Za=this.u$d();let xb=null;this.Xfa.D7d(Za,Zb=>{this.sba.Anc(Zb)===oa&&(xb=Zb);return!xb});return xb}jfj(oa,Za,xb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",
oa,Za,xb)}BNi(){const oa=this.u$d(),Za=[];this.Xfa.D7d(oa,xb=>{Za.push(this.sba.ANi(xb));return!0});return Za}Lqb(oa,Za){if(!Za.length)return this.rIb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const xb=this.u$d(),Zb=na.a.create().toString(),sc=new Gg.a;for(let $c of Za)sc.add($c),this.jfj($c.type,Zb,$c.completion);Za=this.fVa.TBg(sc);this.sba.Lqb(xb.currentNode,Zb,oa,Za);this.G4e();return Zb}Kf(oa){(oa=this.Kbe(oa))?(this.sba.Kf(oa),this.G4e()):
this.rIb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}Anc(oa){oa=this.Kbe(oa);return oa?this.sba.Anc(oa):(this.rIb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}xNi(oa){return this.sba.Anc(oa)}zNi(oa){oa=this.Kbe(oa);if(!oa)return this.rIb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;oa=this.sba.$Qf(oa);return this.fVa.cjc(oa).toArray()}Gcl(oa,Za){if(!Za.length)return this.rIb&&
a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const xb=this.Kbe(oa);if(!xb)return this.rIb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Zb=this.sba.$Qf(xb),sc=this.fVa.cjc(Zb);for(let $c of Za)sc.add($c),this.jfj($c.type,oa,$c.completion);oa=this.fVa.TBg(sc);oa!==Zb&&(this.sba.G5o(xb,oa),this.G4e());return!0}p5k(oa,Za){if(Za=this.wNi(Za)){const xb=this.td.Lm();xb.set(oa);this.sba.pc(Za.clone(),this.sba.F8l(Za,
xb))}}lFj(oa,Za,xb){if(Za.Bb(oa))return Za.K(oa);const Zb=na.a.create().toString();Za.add(oa,Zb);xb&&this.rIb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Zb}JIl(oa,Za){const xb=new Oj.a;var Zb=this.td.Lm();Zb.set(oa);Zb.ic(38)&&this.Xfa.D7d(Zb,sc=>{const $c=this.sba.Anc(sc);void 0!==$c&&null!==$c&&xb.add($c,sc);return!0});for(let sc of Za)if(oa=null,({value:oa}=xb.Nc(sc.key,oa)).returnValue)if(sc.value===sc.key)oa=this.wNi(sc.key),
this.sba.w6o(oa,parseInt(sc.key));else{oa=this.sba.$Qf(oa);if(!oa||""===oa){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}oa=this.fVa.cjc(oa);Zb=new Ga.a;for(let $c=0;$c<oa.length;$c++){if(oa.K($c).commentId){const Ed=Number.parseInvariant(oa.K($c).commentId);Za.Bb(Ed)?oa.K($c).commentId=Za.K(Ed).toString():oa.K($c).commentId=null}oa.K($c).recordId=this.lFj(oa.K($c).recordId,Zb,!1);-1===oa.K($c).type&&(oa.K($c).undoId=
this.lFj(oa.K($c).undoId,Zb,!0))}this.Lqb(sc.value,oa.toArray())}}static tu(){return new mm(J.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),J.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),J.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new mi.a,()=>ze.StaticActiveAppFrame.Aa().tb.rd,()=>{J.a.instance.Za("Common.Interface.IEditNotificationManager").execute(oa=>{oa.editHappened()})},!0)}}Object(f.a)(mm,"TaskActor",null,[258]);var Fq=e(1111);class br{create(){return new Fq.a}}
Object(f.a)(br,"TaskContentNodeFactory",null,[265]);var xi=e(1076);class bh{create(){return new xi.a}}Object(f.a)(bh,"TaskNodeFactory",null,[265]);class Dl{constructor(oa,Za,xb,Zb,sc,$c){this.Xfa=oa;this.Zc=Za;this.td=xb;this.TVk=Zb;this.WVk=sc;this.W6b=$c}BPl(oa,Za,xb){const Zb=this.WVk.create(lk.a.kCc);Zb.setValue(Va.a.taskId,oa);Zb.setValue(Va.a.X3b,Za);Zb.setValue(Va.a.FGa,xb);return Zb}Cnc(oa){const Za=this.Zc.Vc(4);Za.Eb(oa);this.W6b();return Za}ANi(oa){return this.Xfa.DWb(oa)?oa.getValue(Va.a.taskId):
(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}Anc(oa){return this.Xfa.DWb(oa)?oa.hasProperty(Va.a.X3b)?oa.getValue(Va.a.X3b):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}$Qf(oa){return this.Xfa.DWb(oa)?oa.getValue(Va.a.FGa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}dRl(oa){if(7!==oa.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Za=this.Cnc(oa);try{const xb=this.TVk.create(lk.a.QQa),Zb=this.td.Lm();
Zb.set(oa);Zb.a8(xb,38,Dl.fqp);return xb}finally{Za&&Za.dispose()}}Lqb(oa,Za,xb,Zb){if(!this.Xfa.Y4f(oa))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const sc=this.Cnc(oa);try{const $c=this.BPl(Za,xb,Zb),Ed=this.td.Lm();Ed.set(oa);Ed.a8($c,1,new Wa.a(na.a.kCa(xb.toString()),1));return $c}finally{sc&&sc.dispose()}}Kf(oa){if(this.Xfa.DWb(oa))if(oa.anchor&&oa.anchor.rt){var Za=oa.anchor.rt.Ku.node;if(this.Xfa.Y4f(Za)){var xb=this.Cnc(Za);try{const Zb=this.td.Lm();Zb.set(Za);
Zb.yk(oa.anchor.node);Zb.qh()}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}G5o(oa,Za){if(this.Xfa.DWb(oa)){var xb=this.Cnc(oa);try{oa.setValue(Va.a.FGa,Za)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}w6o(oa,Za){if(this.Xfa.DWb(oa)){var xb=
this.Cnc(oa);try{const Zb=oa.hasProperty(Va.a.X3b)?oa.getValue(Va.a.X3b):null;void 0===Zb||null===Zb||Zb===Za?oa.Xg(Va.a.X3b,Za):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}F8l(oa,Za){if(!Za.dw(38)){const xb=this.td.Lm();xb.set(oa);xb.Ib(71);xb.xd(71);oa=Db.b(xb.currentNode,oa.hk().ed,!0);Za.pg(oa,38)}return Za.ic(38)}pc(oa,Za){if(this.Xfa.Y4f(Za)){var xb=this.Cnc(Za);try{const Zb=this.td.Lm();
Zb.set(Za);Zb.pg(oa,1)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static tu(){return new Dl(J.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new $h.a,new mi.a,new br,new bh,()=>{Sk.a.Xm.tb.rd.qG.k4(10)})}}Dl.fqp=new Wa.a(na.a.Of("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(f.a)(Dl,"TaskEditor",null,[257]);class cr{constructor(oa,Za){this.rB=oa;this.sJb=Za}DWb(oa){return!!oa&&72===oa.type}yAn(oa){return!!oa&&71===oa.Jf}Y4f(oa){return!!oa&&
71===oa.type}Vyp(oa){oa.set(this.rB.value);this.sJb.bU(oa);return!!oa.ic(38)}D7d(oa,Za){if(oa&&Za)if(this.yAn(oa))for(var xb=!0,Zb=oa.ic(1);xb&&Zb;)this.DWb(Zb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Zb.type),xb=Za(Zb),Zb=oa.gg(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",oa.Jf);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static tu(){return new cr(new Ua.a(()=>ze.StaticActiveAppFrame.Aa().tb.rd),Object(kn.a)())}}
Object(f.a)(cr,"TaskNavigator",null,[229]);class ul{constructor(){this.Z=null}get name(){return"WordEditor.Tasks"}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}dispose(){}Ec(oa){this.Z=oa;oa.ja("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new up.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();oa.ja("WordEditor.Tasks.TaskNavigator",()=>cr.tu()).as("WordEditor.Tasks.ITaskNavigator").ha();oa.ja("WordEditor.Tasks.TaskEditor",()=>Dl.tu()).as("WordEditor.Tasks.ITaskEditor").ha();
oa.ja("WordEditor.Tasks.TaskActor",()=>mm.tu()).as("WordEditor.Tasks.ITaskActor").ha()}Sp(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(107)}}Object(f.a)(ul,"TasksPackage",null,[0,1]);e.d(K,"a",function(){return m})},2011:function(I,K,e){I=e(0);var m=e(2),f=e(131),a=e(49),l=e(226),w=e(21),z=e(16),x=e(90),u=e(218),v=e(46),E=e(31),y=e(13),H=e(41),D=e(5),G=e(8),J=e(87),U=e(320),F=e(75),T=e(11),Y=e(6),P=e(83),S=e(133),N=e(30),V=e(229),Z=e(93),ca=e(237),W=e(15),X=e(80),ka=e(154),ma=e(689),ja=
e(3),na=e(85),Ba=e(65),Ma=e(126),Ea=e(91),ya=e(38),ia=e(495),za=e(462),Ca=e(39),db=e(23),pa=e(54),ua=e(175),Ga=e(18),wa=e(27),xa=e(258),sa=e(7),Ka=e(1052),Na=e(1492),ub=e(1524),Ua=e(313),sb=e(267),qb=e(89),ab=e(312),Xa=e(466);class wb extends Ua.a{constructor(Va,mb,Ab,Xb,Lb,dc,yc,Wc){super();this.gJh=this.mz=null;this.init(Va);this.$m("FormattingViewOperation");this.bvb(m.AFrameworkApplication.va,mb,Xb,Lb,dc);this._context=Ab;this.Eib=0;this._isEnabled=!0;this.PBk=yc;this.Qo=Wc}get $ga(){return this.Qo.instance}run(){const Va=
this._context.view;var mb=null;Va.Ee&&(mb=Va.ub);if(mb){var Ab=mb.ob.currentSelection,Xb=!ub.a.bqc(this.actionId);!Ab||wb.Ig.o4f(Ab,Xb)?(wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.EI}),this._isEnabled=!1):this.$ga&&this.$ga.tqc(Ab)?(wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.R$a}),this._isEnabled=!1):Object(ua.a)().eHa(sa.ParagraphReader.uZ,mb.hh)&&(wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.NS}),this._isEnabled=!1)}else wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.xia}),this._isEnabled=!1;1!==this.behavior&&this._isEnabled||(this._isEnabled&&
(Ab=mb.ob.currentSelection,1===mb.ob.length&&1===Ab.length&&Ca.a.Rm(Ab.Ya)&&X.b(Ab.Ya)&&(wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.uZc}),this._isEnabled=!1)),(Ab=this._isEnabled)&&this.actionId===ja.a.w$&&((Ab=Array.from(mb.ob.currentSelection).some(P.a.nuf))||wb.Jc.qc(na.a.$e,{["Reason"]:Ba.a.LBf})),this.Vt=Ab?32:8,this.Eib=3);this.Eib||(sb.a.mark(5730),this.gJh=Xa.a.instance.tPb(),Ab=mb.ob.currentSelection.Ya,this.mz=new ya.GraphTransaction(15),this.mz.Eb(Ab.node),this.mz.Bh=this.actionId,this.Eib=1);if(1===
this.Eib){this.ZE||this.Xqd(this._context.Pk);if(1===this.efb())return;this.Eib=2}if(2===this.Eib){if(this.actionId===ja.a.w$)if(mb=mb.hh,mb.My)for(Ab=0;Ab<mb.length;Ab++)Xb=mb.getContext(Ab),this.g$j(Xb);else this.g$j(mb);ab.a.Fuf&&this.Pwp(this.actionId,this.Ed);this.gJh.qxa(this.actionId===ja.a.O2||this.actionId===ja.a.GBa);(mb=Object(J.a)(410,this.Ed))&&!mb.r2a||qb.FocusManager.instance().Rg(Va.lN);this.mz.dispose();this.mz=null;Ga.StaticActiveAppFrame.Aa().Ne();sb.a.mark(5731);this.Eib=3;this.Vt=
32}3===this.Eib&&(this.PBk.process(this.actionId,this._context,this.behavior,this.response),this.Kxa())}Pwp(Va,mb){const Ab={};Ab.FormattingActionId=Va;Ab.FormattingActionData=mb;8===this.ga.Zb(ja.a.XVd,2,Ab)&&G.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Va,mb)}g$j(Va){(Ca.a.Ny(Va)||Ca.a.em(Va))&&Ma.a.VR.Cja(Va.node)}static get Ig(){return xa.a.instance}static get Jc(){return u.a.instance}}Object(I.a)(wb,"FormattingViewOperation",
Ua.a,[]);var Sa=e(1043),cc=e(48),Cb=e(42);e.d(K,"a",function(){return Ja});const Wa=new Set([ja.a.V4,ja.a.m6,ja.a.dG,ja.a.DKa,ja.a.EKa,ja.a.i9a,ja.a.EBa,ja.a.j9a]);class Ja{constructor(Va,mb,Ab=null,Xb,Lb,dc,yc,Wc,zb,cd,qc,Dc,mc){this.kpiName="ChangeCaseCommandUsage";this.uca="wwaengidc";this.Owb=new Map;this.szh=new Set;this.YRb=()=>new ma.a(2);this.MCj=(lc,Vb,yb,Db,$b)=>{Db=!0;Vb.contextId!==T.a.view&&(Db=!1);if(1===yb&&!Db)return 8;if(lc===ja.a.Uld)lc=$b.formatting,$b=$b.SHg;else{if(!Vb.view||
!Vb.view.Ee)return 2;Vb=Vb.view;if(!Vb.ub||!Vb.ub.ob.currentSelection)return 8;lc=$b;$b=Vb.ub.ob}this.cEl($b,lc);return 32};this.ylf=(lc,Vb,yb,Db,$b,Fa)=>new wb(lc,Vb,yb,Db,$b,Fa,this.uCk,Ja.lA());this.VVd=(lc,Vb,yb,Db,$b)=>{var Fa,lb,kb;let Ob=!0,nc=Vb;const zc=!ub.a.bqc(lc);Vb.contextId!==T.a.Nd&&Vb.contextId!==T.a.kd?Ob=!1:(Ja.Ig.cda(nc,!1,zc)&&(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.EI}),Ob=!1),Ja.lA()&&Ja.lA().instance&&Ja.lA().instance.wZ(nc)&&(Ob=!1),Ob&&Ca.a.Rm(Vb)&&X.b(nc)&&(Ja.Jc.qc(na.a.Lo,
{["Reason"]:Ba.a.uZc}),Ob=!1),sa.ParagraphReader.uZ(Vb)&&(Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.NS}),Ob=!1));if(1===yb||!Ob)return Ob?32:8;if(Vb.contextId===T.a.kd)return 2;(Vb=null===(Fa=this.Iq)||void 0===Fa?void 0:Fa.Dae(nc))&&(nc=Vb);this.qcp(lc)&&(Fa=Ca.a.C4b(nc),Ca.a.Df(Fa)||(nc=Fa));Fa="boolean"===typeof $b&&$b;Vb=!1;(null===(lb=this.nTa)||void 0===lb?0:lb.annotateRange)&&(null===(kb=this.nTa)||void 0===kb?0:kb.s3f(nc.node))&&(Vb=this.zY(nc,lc,$b,Fa));Vb&&lc!==ja.a.w$||Ja.DF.zY(nc,Pb=>{this.Izc(Pb,
lc,$b,nc.cpEnd)},Fa);nc.node.pr&&(lb=[Object.assign(new E.a,{name:"Source",string:"CharacterFormatting"})],v.a("TOCFormatting",!0,void 0,lb));this.Xmn(lc)&&this.yYd(nc,lc);Db&&Na.a.fCb&&(Db.Av|=Na.a.gtb(nc.node));return 32};this.dvd=(lc,Vb,yb)=>1!==yb&&2===yb?(this.Owb.set("Source","Shortcut"),lc=Vb.node.characterData.substr(Vb.cpBegin,Vb.cpEnd-Vb.cpBegin),Ja.H4f(lc,0,lc.length)?this.yYd(Vb,ja.a.DKa):Ja.Pzn(lc,lc.length)?this.yYd(Vb,ja.a.EBa):this.yYd(Vb,ja.a.EKa)):32;this.Ppb=(lc,Vb,yb)=>{let Db=
!0;lc=!ub.a.bqc(lc);Vb.contextId!==T.a.Nd&&Vb.contextId!==T.a.kd?Db=!1:(Ja.Ig.cda(Vb,!1,lc)&&(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.EI}),Db=!1),Db&&Ca.a.Rm(Vb)&&X.b(Vb)&&(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.uZc}),Db=!1),Db&&sa.ParagraphReader.uZ(Vb)&&(Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.NS}),Db=!1));if(1===yb||!Db)return Db?32:8;Vb=Vb.node;this.Ww.vOb(Vb,!1);Vb.pr&&(Vb=[Object.assign(new E.a,{name:"Source",string:"ClearFormatting"})],v.a("TOCFormatting",!0,void 0,Vb));return 32};this.pYc=(lc,Vb,yb,Db,$b)=>
{lc={};lc[Sa.a.FRa]=6168;lc[Sa.a.ERa]=6169;const Fa=Vb.view;var lb=null;Fa.Aj&&(lb=Fa);var kb=!0;let Ob=32;lb&&(lb=lb.ub.ob.currentSelection)&&(Ja.Ig.o4f(lb)?(Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.EI}),Ob=8,kb=!1):1===yb&&(Ob=32,kb=!1));kb&&(kb=new ya.GraphTransaction(1===yb?3:15),kb.Eb(Fa.root),Ob=Sa.a.Nwa(ja.a.Ppb,Vb,yb,Db,$b,lc,12),kb.dispose());return Ob};this.Glf=(lc,Vb,yb,Db,$b)=>{var Fa,lb=!0,kb=32;const Ob=!ub.a.bqc(lc);Vb.contextId!==T.a.kd?lb=!1:Ja.Ig.cda(Vb,!1,Ob)&&(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.EI}),
lb=!1);if(1===yb||!lb)return lb?32:8;yb=Vb.node;lc===ja.a.dG&&(Ja.om.rYc(yb),this.Ww.j8h(yb),lb=this.Vk.pG(yb).Qg(this.Vk.wordStyleIdNormal),this.Gr.IP(lb,yb,!0));yb=Ja.Ok.WQf(Vb);!yb&&(lb=null===(Fa=this.Iq)||void 0===Fa?void 0:Fa.Dae(Vb))&&(Vb=lb,yb=db.SelectionFactory.aq(Vb));if(yb)kb=pa.a.oPb(yb),kb=m.AFrameworkApplication.va.Sf(kb,lc,2,!1,Db,$b);else{Db=Object(J.a)(410,$b);Fa=P.a.uu(Vb);if(!Fa)return 16;Fa=Fa.cache;switch(lc){case ja.a.font:Ja.Qui();if(Db&&Db.Ed){const {fontName:nc,Tja:zc,bold:Pb,
italic:tb}=Ja.fNf(Db.Ed);Ja.Ok.UAe(nc);Ja.Ok.nEg(zc);Object(ia.a)()&&(lc=1==Pb,$b=1==tb,lc||$b)&&(Ja.Ok.GP(lc),Ja.Ok.cC($b))}break;case ja.a.Uy:G.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Ja.Ok.Uy($b);break;case ja.a.Ixa:Ja.Ok.Uy($b);this.vK.bKa($b)||G.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.pma:Ja.Ok.pma();break;case ja.a.O2:G.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");
Ja.Ok.lGa($b);break;case ja.a.hea:Ja.Ok.lGa($b);this.vK.bKa($b)||G.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.GBa:Ja.Ok.kZd();break;case ja.a.tE:Ja.Qui();Ja.Ok.tE(Db.Ed);break;case ja.a.V4:lc=Ja.Ok.dK(y.a.fontSize,Fa.fontSize);Ja.Ok.tE(this.Pe.V4(lc));break;case ja.a.m6:lc=Ja.Ok.dK(y.a.fontSize,Fa.fontSize);Ja.Ok.tE(this.Pe.m6(lc));break;case ja.a.bold:lc=Ja.Ok.dK(y.a.bold,Fa.isBold);Ja.Ok.GP(!lc);break;case ja.a.cC:lc=Ja.Ok.dK(y.a.italic,
Fa.isItalic);Ja.Ok.cC(!lc);break;case ja.a.underline:lc=Ja.Ok.dK(y.a.underline,Fa.isUnderline);Ja.Ok.z$(!lc);break;case ja.a.Lpa:Ja.Ok.Lpa($b);break;case ja.a.superscript:lc=Ja.Ok.dK(y.a.superscript,Fa.isSuperscript);Ja.Ok.Mxa(!lc);break;case ja.a.subscript:lc=Ja.Ok.dK(y.a.subscript,Fa.isSubscript);Ja.Ok.oQa(!lc);break;case ja.a.strikethrough:lc=Ja.Ok.dK(y.a.strikethrough,Fa.isStrikethrough);Ja.Ok.Jpa(!lc);break;case ja.a.Ew:lc=Ja.Ok.dK(H.a.Ew,Fa.isDoubleStrikethrough);Ja.Ok.PAe(!lc);break;case ja.a.dG:Ja.Ok.Yzb();
break;case ja.a.w$:$b.hasProperty(y.a.bE)&&Ja.Ok.w$($b.getValue(y.a.bE));$b.hasProperty(D.a.noProof)&&(lc=$b.getValue(D.a.noProof),Ja.Ok.q3o(lc));break;default:this.szh.has(lc)||(this.szh.add(lc),($b=f.ActionManager.yba(lc))&&$b.length||($b="UnknownAction"),G.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${$b} (${lc})`))}}Ga.StaticActiveAppFrame.Aa().Ne();return kb};this.AY=(lc,Vb,yb,Db,$b)=>{Db=Ja.Jc.vr(ja.a.$_o);var Fa=!0;Vb.contextId!==T.a.od&&
(Fa=!1);if(1===yb||!Fa)return Fa?32:8;yb=Vb.node;Cb.a.Qe?Fa=Cb.a.isListItem(yb):(Fa=Y.a.kb(yb),Fa.Wd(),Fa=Fa.Ina(4),Fa=!!Fa&&Ja.Vd.Ava(Fa));if(Fa&&!Ma.a.htc)return 8;var lb=!sa.ParagraphReader.textLength(yb);Db.properties.W("Action",lc.toString());Db.properties.W("ListContext",Fa.toString());Db.properties.W("IsEmptyParagraph",lb.toString());G.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",lc,Fa,lb);Fa=yb.ra.last;this.DHo(yb,lc);var kb=!!Fa.formatting;
const Ob=yb.getValue(D.a.hua);lb=this.ee.J$a(yb);kb=!kb&&Ob&&Ob.equals(a.a.nil)?new ka.a(Fa,a.a.nil):lb.og(lb.Rb);this.Izc(lb,lc,$b,Fa.cp);Ja.lk.c2b(yb,Fa,Vb.cpBegin,Vb.cpEnd,kb,lb,Ja.Yd.Zg);Db.end();return 32};this.Xsa=(lc,Vb,yb)=>{lc=!0;const Db=Y.a.kb(Vb.node);Db.Wd();Vb.contextId===T.a.od&&(Cb.a.Qe?Cb.a.isListItem(Vb.node):Db.Ina(4))||(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.T7f}),lc=!1);return(Cb.a.Qe?Cb.a.isListItem(Vb.node):Ja.Vd.Ava(Db.currentNode))?1!==yb&&lc?32:lc?32:8:8};this.Ywa=(lc,Vb,yb,Db,
$b)=>{lc=!0;Vb.contextId!==T.a.paragraph&&(lc=!1);if(1===yb&&!lc)return 8;yb=Vb.node;-1!==$b.Ki?$b.Ki!==sa.ParagraphReader.VA(yb)&&($b.Ki=0):$b.Ki=sa.ParagraphReader.VA(yb);lc=this.Vq.wtb(yb);$b.fw?(!$b.H4m&&this.K4m($b.fw,lc)&&2===$b.fw.specialIndentType&&($b.fw.specialIndentType=0),$b.fw.Xub===lc.Xub&&l.a.YDa($b.fw.NC,lc.NC)||($b.fw.NC=Number.MAX_VALUE),$b.fw.Yub===lc.Yub&&l.a.YDa($b.fw.Kha,lc.Kha)||($b.fw.Kha=Number.MAX_VALUE)):$b.fw=lc;Vb=Object(ua.a)().i_h(Vb.Pk);void 0!==Vb&&null!==Vb&&(Vb=
Vb.node,void 0!==Vb&&null!==Vb&&(Vb=V.a.instance.zW(Vb),void 0!==Vb&&null!==Vb&&(Vb=Ja.wg.nx(Vb)-(Ja.wg.eP(Vb)+Ja.wg.fP(Vb)+Ma.a.iHa),lc.k$c=Vb-lc.NC,lc.j$c=Vb-lc.Kha,$b.fw.j$c=Math.min($b.fw.j$c,lc.j$c),$b.fw.k$c=Math.min($b.fw.k$c,lc.k$c))));Vb=this.c0.uYa(yb);$b.TR?($b.TR.beforeSpacing=Ja.RVh(Vb.beforeSpacing,$b.TR.beforeSpacing),$b.TR.afterSpacing=Ja.RVh(Vb.afterSpacing,$b.TR.afterSpacing),$b.TR.lineSpacing.unit===Vb.lineSpacing.unit&&l.a.YDa($b.TR.lineSpacing.value,Vb.lineSpacing.value)||($b.TR.lineSpacing.unit=
0,$b.TR.lineSpacing.value=0)):$b.TR=Vb;Vb=new Y.a;Vb.set(yb);Vb.Ib(11);if(yb=Vb.xd(11))$b.isRtl=Z.a.Rp(yb);yb=Ja.Vd.Fy(Vb);Vb=16;void 0!==yb&&null!==yb&&(Vb=yb.listType);$b.listType=Ja.avm($b.listType,Vb);$b.cB=16===$b.listType?null:yb;return 32};this.lso=(lc,Vb,yb,Db,$b)=>{$b.isRtl=Z.a.Rp(N.a.kn(Vb.node));return 32};this.OYh=(lc,Vb,yb)=>{if(lc===ja.a.D2b)lc=!0;else if(lc===ja.a.C2b)lc=!1;else return 2;lc&&this.zfj(Vb);if(1===yb)return 32;this.ni.t2b(N.a.kn(Vb.node),lc);return 32};this.aso=(lc,Vb,
yb,Db,$b)=>{lc=Vb.node;$b.isRtl=Z.a.isRtl(N.a.kn(lc));$b.Ki=S.a.VA(lc);return 32};this.mto=(lc,Vb,yb,Db,$b)=>{lc=Vb.node;$b.isRtl=Z.a.isRtl(N.a.kn(lc));$b.Ki=wa.TableReader.VA(lc);-1!==$b.Ki&&$b.Ki||($b.Ki=$b.isRtl?3:1);return 32};this.Jfc=(lc,Vb,yb,Db,$b)=>{let Fa;if(!({xB:Fa}=ub.a.yFg(yb,Vb)).returnValue)return Fa;const lb=Vb.node;switch(lc){case ja.a.C2b:this.ni.bAc(lb,!1);break;case ja.a.D2b:this.zfj(Vb);this.ni.bAc(lb,!0);break;case ja.a.w$:Fa=m.AFrameworkApplication.va.Sf(Vb.Pk,lc,yb,!0,Db,
$b),32===Fa&&sa.ParagraphReader.Xn(Vb)&&Ja.Cld&&Ja.Cld.Cja(lb)}return 32};this.Yxl=(lc,Vb,yb,Db,$b)=>{const Fa={};Fa[Sa.a.FRa]=6168;Fa[Sa.a.ERa]=6169;var lb=Vb.view;const kb=new ya.GraphTransaction(1===yb?3:15);kb.Eb(lb.root);let Ob=Sa.a.Nwa(lc,Vb,yb,Db,$b,Fa,0),nc=null;lb.Aj&&(nc=lb);lb=!0;let zc=null;nc&&(zc=nc.ub.ob.currentSelection)&&(lc=!ub.a.bqc(lc),Ja.Ig.o4f(zc,lc)?(Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.EI}),Ob=8,lb=!1):1===yb&&(Ob=32,lb=!1),Object(ua.a)().eHa(sa.ParagraphReader.uZ,nc.ub.hh)&&
(Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.NS}),Ob=8,lb=!1));lb&&this.Uzn(zc)&&(Ob=Sa.a.Nwa(ja.a.Ppb,Vb,yb,Db,$b,Fa,12));kb.dispose();return Ob};this.Xxl=(lc,Vb,yb)=>{lc=!0;Vb.contextId!==T.a.paragraph&&Vb.contextId!==T.a.kd?lc=!1:Ja.Ig.Rcb(Vb)&&(Ja.Jc.qc(na.a.Lo,{["Reason"]:Ba.a.EI}),lc=!1);if(1===yb||!lc)return lc?32:8;Vb=Vb.node;yb=new ya.GraphTransaction(15);yb.Eb(Vb);Ja.om.rYc(Vb);this.Ww.vOb(Vb,!0);this.Gr.wYc(Vb);yb.dispose();return 2};this.d0m=(lc,Vb,yb)=>{lc=!0;Vb.contextId!==T.a.view&&(lc=!1);if(1===
yb&&!lc)return 8;if(!Vb.view||!Vb.view.Ee)return 2;Vb=Vb.view;if(!Vb.ub||!Vb.ub.ob.currentSelection)return 8;if(Object(ua.a)().eHa(sa.ParagraphReader.uZ,Vb.ub.hh))return Ja.Jc.qc(na.a.$e,{["Reason"]:Ba.a.NS}),8;Vb=Vb.ub.ob;for(const Db of Vb)for(const $b of Db)if($b&&$b.contextId!==T.a.Nd&&$b.contextId!==T.a.kd&&$b.contextId!==T.a.paragraph&&$b.contextId!==T.a.od)return 2;return 32};this.lfb=(lc,Vb,yb,Db,$b)=>{lc=!0;Vb.contextId!==T.a.paragraph&&(lc=!1);if(1===yb&&!lc)return 8;$b.fw||(Vb=Vb.node,
yb=this.Vq.wtb(Vb),$b.fw=yb,Vb=N.a.kn(Vb),$b.isRtl=Vb?Z.a.Rp(Vb):!1);return 32};this.nto=(lc,Vb,yb,Db,$b)=>{Vb=Vb.node;lc=N.a.kn(Vb);$b.fw||(Vb=this.ZKm(Vb),Vb=this.Vq.wtb(Vb),$b.fw=Vb,$b.isRtl=Z.a.isRtl(lc));return 32};this.uCk=Va;this.nTa=mb;this.Faa=Ab;this.Iq=Xb;this.Pe=Lb;this.ee=dc;this.Ww=yc;this.c0=Wc;this.Gr=cd;this.Vk=zb;this.ni=qc;this.Vq=mc}get vK(){return null!=this.b8g?this.b8g:this.b8g=w.a.instance.Wa("Box4.UI.RecentColorsSectionHandler")}get K1f(){if(null!=this.P3g)var Va=this.P3g;
else m.AFrameworkApplication.ud("91cji169;50h4g153"),Va=this.P3g=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isGalleryFormattingEOPFixEnabled",!1);return Va}get s7d(){return!!this.Faa&&this.Faa.enabled}mc(){const Va=m.AFrameworkApplication.va,mb=this.lso;(Ja.Dc?Ja.Dc.sG(35):m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled"))?(Va.qa(ja.a.font,T.a.od,this.AY),Va.qa(ja.a.tE,T.a.od,this.AY),Va.qa(ja.a.V4,
T.a.od,this.AY),Va.qa(ja.a.m6,T.a.od,this.AY),Va.qa(ja.a.Uy,T.a.od,this.AY),Va.qa(ja.a.Ixa,T.a.od,this.AY),Va.qa(ja.a.pma,T.a.od,this.AY),Va.qa(ja.a.O2,T.a.od,this.AY),Va.qa(ja.a.hea,T.a.od,this.AY),Va.qa(ja.a.GBa,T.a.od,this.AY),Va.qa(ja.a.bold,T.a.od,this.AY),Va.qa(ja.a.cC,T.a.od,this.AY),Va.qa(ja.a.underline,T.a.od,this.AY),Va.qa(ja.a.Lpa,T.a.od,this.AY),Va.qa(ja.a.superscript,T.a.od,this.AY),Va.qa(ja.a.subscript,T.a.od,this.AY),Va.qa(ja.a.strikethrough,T.a.od,this.AY),Va.qa(ja.a.Ew,T.a.od,this.AY),
Va.qa(ja.a.w$,T.a.od,this.AY),Va.qa(ja.a.dG,T.a.od,this.AY)):Ma.a.htc&&(Va.qa(ja.a.font,T.a.od,this.Xsa),Va.qa(ja.a.tE,T.a.od,this.Xsa),Va.qa(ja.a.Uy,T.a.od,this.Xsa),Va.qa(ja.a.Ixa,T.a.od,this.Xsa),Va.qa(ja.a.pma,T.a.od,this.Xsa),Va.qa(ja.a.bold,T.a.od,this.Xsa),Va.qa(ja.a.cC,T.a.od,this.Xsa),Va.qa(ja.a.superscript,T.a.od,this.Xsa),Va.qa(ja.a.subscript,T.a.od,this.Xsa),Va.qa(ja.a.strikethrough,T.a.od,this.Xsa),Va.qa(ja.a.Ew,T.a.od,this.Xsa),Va.qa(ja.a.V4,T.a.od,this.Xsa),Va.qa(ja.a.m6,T.a.od,this.Xsa));
const Ab=Ma.a.Z2a.k_c(Xb=>za.OutlineElementGeneralizer.lna(Xb.ob,!0));Va.nb(ja.a.Yqf,T.a.view,this.d0m,100);Va.nb(ja.a.dvd,T.a.Nd,this.dvd,1028);Va.qa(ja.a.c1a,T.a.view,this.MCj);Va.qa(ja.a.Uld,T.a.view,this.MCj);Va.qa(ja.a.Ywa,T.a.view,Ab);Va.qa(ja.a.Ywa,T.a.paragraph,this.Ywa);Va.qa(ja.a.Ywa,T.a.image,this.aso);Va.qa(ja.a.Ywa,T.a.oRa,mb);Va.qa(ja.a.Ywa,T.a.table,this.mto);Va.qa(ja.a.lfb,T.a.view,Ab);Va.qa(ja.a.lfb,T.a.paragraph,this.lfb);Va.qa(ja.a.lfb,T.a.table,this.nto);Va.Oc(ja.a.c1a,99);Va.Oc(ja.a.Uld,
1127);Va.Oc(ja.a.Ywa,97);Va.Oc(ja.a.lfb,97);this.BQ(Va,ja.a.font);this.BQ(Va,ja.a.tE);this.BQ(Va,ja.a.V4);this.BQ(Va,ja.a.m6);Va.qob(ja.a.nvi,T.a.view,this.ylf);Va.Oc(ja.a.nvi,1092);this.BQ(Va,ja.a.Uy);this.BQ(Va,ja.a.Ixa);this.BQ(Va,ja.a.pma);this.BQ(Va,ja.a.O2);this.BQ(Va,ja.a.hea);this.BQ(Va,ja.a.i9a);this.BQ(Va,ja.a.DKa);this.BQ(Va,ja.a.EKa);this.BQ(Va,ja.a.EBa);this.BQ(Va,ja.a.j9a);this.BQ(Va,ja.a.GBa);this.BQ(Va,ja.a.bold);Va.T1b(ja.a.bold,this.YRb);this.BQ(Va,ja.a.cC);Va.T1b(ja.a.cC,this.YRb);
this.BQ(Va,ja.a.underline);Va.T1b(ja.a.underline,this.YRb);this.BQ(Va,ja.a.Lpa);this.BQ(Va,ja.a.superscript);Va.T1b(ja.a.superscript,this.YRb);this.BQ(Va,ja.a.subscript);Va.T1b(ja.a.subscript,this.YRb);this.BQ(Va,ja.a.strikethrough);Va.T1b(ja.a.strikethrough,this.YRb);this.BQ(Va,ja.a.Ew);Va.T1b(ja.a.Ew,this.YRb);Va.nb(ja.a.sZa,T.a.Nd,this.VVd,96);Va.qob(ja.a.w$,T.a.view,this.ylf);Va.qa(ja.a.w$,T.a.paragraph,this.Jfc);Va.qa(ja.a.w$,T.a.Nd,this.VVd);Va.qa(ja.a.w$,T.a.kd,this.Glf);Va.qa(ja.a.dG,T.a.view,
this.Yxl);Va.qa(ja.a.dG,T.a.paragraph,this.Xxl);Va.qa(ja.a.dG,T.a.Nd,this.VVd);Va.qa(ja.a.dG,T.a.kd,this.Glf);Va.Oc(ja.a.dG,1036);Va.qa(ja.a.Ppb,T.a.Nd,this.Ppb);Va.qa(ja.a.Ppb,T.a.kd,this.Ppb);Va.qa(ja.a.pYc,T.a.view,this.pYc);Va.qa(ja.a.C2b,T.a.view,ub.a.oz);Va.qa(ja.a.C2b,T.a.paragraph,this.Jfc);Va.qa(ja.a.C2b,T.a.oRa,this.OYh);Va.Oc(ja.a.C2b,1028);Va.qa(ja.a.D2b,T.a.view,ub.a.oz);Va.qa(ja.a.D2b,T.a.paragraph,this.Jfc);Va.qa(ja.a.D2b,T.a.oRa,this.OYh);Va.Oc(ja.a.D2b,1028)}BQ(Va,mb){Va.qob(mb,T.a.view,
this.ylf);Va.qa(mb,T.a.Nd,this.VVd);Va.qa(mb,T.a.kd,this.Glf);Va.Oc(mb,1036)}cEl(Va,mb){for(const zb of Va)for(const cd of zb){Va=null;if(cd.contextId===T.a.Nd){if(X.b(cd))continue;Va=[];var Ab=cd.node.ra;if(Ab){var Xb=Ab.length-1,Lb=cd.cpBegin;const qc=cd.cpEnd;let Dc=!1;const mc=cd.node.characterData;if(mc&&""!==mc){var dc=mc.substr(Lb,qc-Lb);dc&&""!==dc&&z.a.wuf(dc,0,dc.length)&&(Dc=!0)}dc=!1;for(let lc=0;lc<Xb;lc++){var yc=Ab.jc(lc).cp,Wc=Ab.jc(lc+1).cp;if(Ab.jc(lc).formatting&&Math.max(yc,Lb)<
Math.min(Wc,qc)){if(mc&&""!==mc&&(yc=yc<Lb?Lb:yc,Wc=mc.substr(yc,(Wc<qc?Wc:qc)-yc),!Dc&&z.a.wuf(Wc,0,Wc.length)))continue;dc=!0;Va.push(Ab.jc(lc).formatting)}else if(dc)break}Ab.jc(Xb).formatting&&cd.cpEnd>Ab.jc(Xb).cp&&Va.push(Ab.jc(Xb).formatting)}}else if(cd.contextId===T.a.paragraph&&!sa.ParagraphReader.uZ(cd)){if(Va=[],Ab=cd.node.ra)for(Xb=this.K1f&&1!=Ab.length?Ab.length-1:Ab.length,Lb=0;Lb<Xb;Lb++)Ab.jc(Lb).formatting&&Va.push(Ab.jc(Lb).formatting)}else if(cd.contextId===T.a.od&&(!this.K1f||
this.K1f&&1===zb.length))Va=[P.a.uu(cd)];else if(cd.contextId===T.a.kd){this.Jro(cd,mb);return}if(Va&&0<Va.length)for(const qc of Va)if(P.a.ePg(mb,qc.cache,cd))return}}Jro(Va,mb){if(Va=P.a.uu(Va)){Va=Va.cache;var Ab=Ja.Ok.dK(y.a.bold,Va.isBold);mb.bold=Ab?1:0;Ab=Ja.Ok.dK(y.a.italic,Va.isItalic);mb.italic=Ab?1:0;Ab=Ja.Ok.dK(y.a.underline,Va.isUnderline);mb.underline=Ab?1:0;mb.underlineType=Ja.Ok.dK(y.a.underlineType,Va.underlineType);Ab=Ja.Ok.dK(y.a.superscript,Va.isSuperscript);mb.superscript=Ab?
1:0;Ab=Ja.Ok.dK(y.a.subscript,Va.isSubscript);mb.subscript=Ab?1:0;Ab=Ja.Ok.dK(y.a.strikethrough,Va.isStrikethrough);mb.strikethrough=Ab?1:0;Ab=Ja.Ok.dK(H.a.Ew,Va.isDoubleStrikethrough);mb.Ew=Ab?1:0;Ab=Ja.Ok.dK(y.a.font,Va.aK);mb.fontName=Ea.a.Jab(Ab);mb.Tja=Va.mf;mb.fontSize=Ja.Ok.dK(y.a.fontSize,Va.fontSize);mb.fontColor=Ja.Ok.dK(y.a.fontColor,Va.fontColor);mb.highlight=Ja.Ok.dK(y.a.highlight,Va.highlight)}}qcp(Va){return Va===ja.a.Lpa||Va===ja.a.Ew||Va===ja.a.O2}static fNf(Va){return"string"===
typeof Va?{fontName:Va,Tja:-1,bold:2,italic:2}:Va}zY(Va,mb,Ab,Xb){const Lb=Va.cpBegin,dc=Va.cpEnd;var yc=Va.node;let Wc=P.a.uu(Va),zb=Lb;if(Wa.has(mb))for(const cd of yc.ra)if(!(cd.cp<=Lb)){if(cd.cp>=dc)break;cd.formatting&&cd.formatting.cache.fontSize!=Wc.cache.fontSize&&(yc=this.kNf(Va.node,Wc,mb,Ab,Xb),this.nTa.annotateRange(Va.node,zb,cd.cp,yc),zb=cd.cp,Wc=cd.formatting)}mb=this.kNf(Va.node,Wc,mb,Ab,Xb);this.nTa.annotateRange(Va.node,zb,dc,mb);return!0}kNf(Va,mb,Ab,Xb,Lb){const dc={},yc=Object(J.a)(410,
Xb),Wc=mb.cache;switch(Ab){case ja.a.bold:2===Xb.value&&(Xb.value=Wc.isBold?0:1);dc[y.a.bold.id]=1===Xb.value;break;case ja.a.cC:2===Xb.value&&(Xb.value=Wc.isItalic?0:1);dc[y.a.italic.id]=1===Xb.value;break;case ja.a.underline:2===Xb.value&&(Xb.value=Wc.isUnderline?0:1);Xb=1===Xb.value;dc[y.a.underline.id]=Xb;dc[y.a.underlineType.id]=Xb?Ea.a.JCb:Ea.a.oX;break;case ja.a.Lpa:dc[y.a.underlineType.id]=Xb.number;dc[y.a.underline.id]=Xb.number!==Ea.a.oX;break;case ja.a.superscript:2===Xb.value&&(Xb.value=
Wc.isSuperscript?0:1);dc[y.a.superscript.id]=1===Xb.value;1===Xb.value&&(dc[y.a.subscript.id]=!1);break;case ja.a.subscript:2===Xb.value&&(Xb.value=Wc.isSubscript?0:1);dc[y.a.subscript.id]=1===Xb.value;1===Xb.value&&(dc[y.a.superscript.id]=!1);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.JD?G.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Xb.value&&(Xb.value=Wc.isStrikethrough?
0:1);dc[y.a.strikethrough.id]=1===Xb.value;break;case ja.a.Ew:2===Xb.value&&(Xb.value=Wc.isDoubleStrikethrough?0:1);dc[H.a.Ew.id]=1===Xb.value;break;case ja.a.font:if(yc&&yc.Ed){const {fontName:cd,Tja:qc,bold:Dc,italic:mc}=Ja.fNf(yc.Ed);Xb=cd.substr(0,Ja.oij);this.s7d&&(dc[D.a.j4.id]=Xb,dc[D.a.oH.id]=Xb,dc[D.a.t8.id]=Xb,dc[D.a.j9.id]=Xb,dc[D.a.tf.id]=qc,dc[D.a.If.id]=qc,dc[D.a.nf.id]=qc,dc[D.a.vf.id]=qc);dc[y.a.font.id]=Xb;dc[D.a.mf.id]=qc;if(Object(ia.a)()){Xb=1==Dc;var zb=1==mc;if(Xb||zb)dc[y.a.bold.id]=
Xb,dc[y.a.italic.id]=zb}}break;case ja.a.Uy:Xb=Ka.a.instance.sma(Va,Xb);dc[y.a.fontColor.id]=Xb;break;case ja.a.Ixa:zb=Ka.a.instance.sma(Va,Xb);dc[y.a.fontColor.id]=zb;this.vK.bKa(Xb)||G.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.pma:dc[y.a.fontColor.id]=F.a.auto;break;case ja.a.O2:dc[y.a.highlight.id]=parseInt(Xb,16);break;case ja.a.hea:dc[y.a.highlight.id]=parseInt(Xb,16);this.vK.bKa(Xb)||G.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ja.a.GBa:dc[y.a.highlight.id]=F.a.auto;break;case ja.a.tE:dc[y.a.fontSize.id]=this.Pe.Hhc(yc.Ed);break;case ja.a.V4:Wc&&Wc.fontSize&&(dc[y.a.fontSize.id]=this.UCm(Wc.fontSize));break;case ja.a.m6:Wc&&Wc.fontSize&&(dc[y.a.fontSize.id]=this.Ovm(Wc.fontSize));break;case ja.a.sZa:if(Xb=null===(zb=Ja.pD)||void 0===zb?void 0:zb.sZa)for(const cd of Xb.Ak())dc[cd.id]=Xb.Uf(cd);break;case ja.a.dG:if(Xb=mb.qp)for(const cd of Xb.Ak())dc[cd.id]=null;dc[D.a.uOb.id]=!0;break;case ja.a.DKa:case ja.a.EKa:case ja.a.i9a:case ja.a.EBa:case ja.a.j9a:Wc.KYa&&
2===Wc.capitalization&&(dc[H.a.capitalization.id]=0)}null!=Lb&&(dc[m.AFrameworkApplication.KIf]=Lb);return dc}UCm(Va){Va=this.Pe.V4(Va);return this.Pe.Hhc(Va)}Ovm(Va){Va=this.Pe.m6(Va);return this.Pe.Hhc(Va)}Izc(Va,mb,Ab,Xb){var Lb=Va.cache;const dc=Object(J.a)(410,Ab);switch(mb){case ja.a.bold:2===Ab.value&&(Ab.value=Lb.isBold?0:1);this.Pe.GP(Va,1===Ab.value);break;case ja.a.cC:2===Ab.value&&(Ab.value=Lb.isItalic?0:1);this.Pe.cC(Va,1===Ab.value);break;case ja.a.underline:2===Ab.value&&(Ab.value=
Lb.isUnderline?0:1);this.Pe.z$(Va,1===Ab.value);break;case ja.a.Lpa:this.Pe.Lpa(Va,Ab);break;case ja.a.superscript:2===Ab.value&&(Ab.value=Lb.isSuperscript?0:1);this.Pe.Mxa(Va,1===Ab.value);break;case ja.a.subscript:2===Ab.value&&(Ab.value=Lb.isSubscript?0:1);this.Pe.oQa(Va,1===Ab.value);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.JD?G.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");
2===Ab.value&&(Ab.value=Lb.isStrikethrough?0:1);this.Pe.Jpa(Va,1===Ab.value);break;case ja.a.Ew:2===Ab.value&&(Ab.value=Lb.isDoubleStrikethrough?0:1);this.Pe.PAe(Va,1===Ab.value);break;case ja.a.font:if(dc&&dc.Ed){const {fontName:yc,Tja:Wc,bold:zb,italic:cd}=Ja.fNf(dc.Ed);this.Pe.rja(Va,yc.substr(0,Ja.oij));this.Pe.nEg(Va,Wc);Object(ia.a)()&&(Ab=1==zb,Xb=1==cd,Ab||Xb)&&(this.Pe.GP(Va,Ab),this.Pe.cC(Va,Xb))}break;case ja.a.Uy:G.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");
this.Pe.Uy(Va,Ab,null);break;case ja.a.Ixa:this.Pe.Uy(Va,Ab,null);this.vK.bKa(Ab)||G.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.pma:this.Pe.pma(Va);break;case ja.a.O2:G.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Pe.lGa(Va,Ab);break;case ja.a.hea:this.Pe.lGa(Va,Ab);this.vK.bKa(Ab)||G.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ja.a.GBa:this.Pe.kZd(Va);break;case ja.a.tE:this.Pe.tE(Va,dc.Ed);break;case ja.a.V4:this.Pe.VQi(Va);break;case ja.a.m6:this.Pe.h0j(Va);break;case ja.a.w$:Lb=Ab.ka(D.a.noProof,!1);this.Pe.lBe(Va,Ab.getValue(y.a.bE),Xb,Lb);break;case ja.a.sZa:this.Pe.WAe(Va);break;case ja.a.dG:this.Pe.ota(Va);break;case ja.a.DKa:case ja.a.EKa:case ja.a.i9a:case ja.a.EBa:case ja.a.j9a:Lb.KYa&&2===Lb.capitalization&&this.Pe.Kxl(Va)}}DHo(Va,mb){ja.a.dG===mb&&N.a.kn(Va).properties.removeProperty(y.a.L5)}K4m(Va,
mb){return this.jZh(Va,mb)||this.jZh(mb,Va)}jZh(Va,mb){return(1===Va.specialIndentType||!Va.specialIndentType)&&2===mb.specialIndentType}ZKm(Va){var mb;Va=Y.a.kb(Va);Va.Ib(11);W.f(Va,0,0);Va.ue();if(null===(mb=cc.a.getInstance())||void 0===mb?0:mb.fda)return Z.a.uN(Va);Va.g9();return Va.currentNode}Uzn(Va){return!Va||Ca.a.qn(Va)||1===Va.length&&Ca.a.Rm(Va.Ya)&&!Ca.a.Mvb(Va.Ya)?!1:!0}zfj(Va){Ja.sIh.Bb(Va.contextId)||(G.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Va.contextId),Ja.sIh.W(Va.contextId,
!0))}Xmn(Va){return Va===ja.a.i9a||Va===ja.a.DKa||Va===ja.a.EKa||Va===ja.a.EBa||Va===ja.a.j9a}yYd(Va,mb){const Ab=Va.node,Xb=Ab.characterData.substr(Va.cpBegin,Va.cpEnd-Va.cpBegin);this.Owb.set("Command",mb.toString());x.Health.instance.recordKpiUsage(this.kpiName,1,this.uca,this.Owb);mb=Ja.orp(Xb,mb);Ab.Fxa(Ab.characterData.substr(0,Va.cpBegin)+mb+Ab.characterData.substr(Va.cpEnd));return 32}static get Ok(){return Ja.pD||(Ja.pD=w.a.instance.resolve("Box4.IInsertionPointFormatting"))}static lA(){return Ja.Qo||
(Ja.Qo=w.a.instance.Za("Box4.IExternalSelectionManager"))}static get Ig(){return xa.a.instance}static get Jc(){return u.a.instance}static get Dc(){return null!=Ja.r_g?Ja.r_g:Ja.r_g=w.a.instance.Wa("Box4.IFeatureHelper")}static get Cld(){return Ma.a.VR}static get Yd(){return null!=Ja.Bah?Ja.Bah:Ja.Bah=w.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lk(){return null!=Ja.aah?Ja.aah:Ja.aah=w.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get DF(){return null!=
Ja.D$g?Ja.D$g:Ja.D$g=w.a.instance.resolve("Box4.TextFormattingHelper")}static get Vd(){return null!=Ja.R5g?Ja.R5g:Ja.R5g=w.a.instance.resolve("Box4.List.IListReader")}static get om(){return null!=Ja.D5g?Ja.D5g:Ja.D5g=w.a.instance.resolve("Box4.List.IListEditor")}static get wg(){return ca.a.instance}static avm(Va,mb){return 42===Va?mb:Va!==mb||16===Va?16:Va}static RVh(Va,mb){Va.K0i||(mb.K0i?mb=Va:mb.unit===Va.unit&&l.a.YDa(mb.value,Va.value)||(mb.value=-1));return mb}static orp(Va,mb){switch(mb){case ja.a.DKa:return Va.toLowerCase();
case ja.a.EKa:return 6!==m.AFrameworkApplication.va.JD?G.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):G.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),Va.toUpperCase();case ja.a.i9a:case ja.a.EBa:return Ja.pul(Va,mb===ja.a.EBa);case ja.a.j9a:return Ja.Ltp(Va);default:return Va}}static Ltp(Va){let mb="";for(let Ab=0;Ab<Va.length;Ab++)mb=Va.charAt(Ab)===Va.charAt(Ab).toUpperCase()?mb+Va.charAt(Ab).toLowerCase():mb+Va.charAt(Ab).toUpperCase();
return mb}static pul(Va,mb){let Ab,Xb,Lb=!0,dc=Va.length,yc=0,Wc=Ja.H4f(Va,yc,dc);for(;0<dc;){Xb=Ab=!1;var zb=dc;let qc;var cd=void 0;for(cd=0;0<zb&&Ja.Pwl(Va.charAt(yc+cd));cd++,zb--)Xb=Ja.kje(Va.charAt(yc+cd));for(qc=cd;0<zb&&!(Ab=Ja.kje(Va.charAt(yc+cd)))&&" "!==Va.charAt(yc+cd)&&"/"!==Va.charAt(yc+cd);cd++,zb--);zb=cd-qc;if(0>=zb)break;yc+=qc;cd=Va.substr(yc,zb);cd=cd===cd.toUpperCase();if(Wc||!cd)Va=Lb||Xb||mb?Va.substr(0,yc)+Va.charAt(yc).toUpperCase()+Va.substr(yc+1,zb-1).toLowerCase()+Va.substr(yc+
zb):Va.substr(0,yc)+Va.substr(yc,zb).toLowerCase()+Va.substr(yc+zb);dc-=zb+qc;yc+=zb;if(Lb=Ab)yc++,dc--,Wc=Ja.H4f(Va,yc,dc)}return Va}static H4f(Va,mb,Ab){for(;0<Ab&&!Ja.kje(Va.charAt(mb));){if(Va.charAt(mb)!==Va.charAt(mb).toUpperCase())return!1;mb++;Ab--}return!0}static Pzn(Va,mb){for(var Ab=0;0<mb&&!Ja.kje(Va.charAt(Ab));){if(Va.charAt(Ab)!==Va.charAt(Ab).toLowerCase())return!1;Ab++;mb--}return!0}static kje(Va){return"."===Va||"!"===Va||"?"===Va?!0:!1}static Pwl(Va){return-1==="0123456789".indexOf(Va)&&
Va.toUpperCase()===Va.toLowerCase()}static Qui(){const Va=w.a.instance.Za("Common.ISystemInitiatedFeedback");Va&&Va.execute(mb=>{mb.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}Ja.sIh=new U.a;Ja.pD=null;Ja.Qo=null;Ja.oij=31;Object(I.a)(Ja,"TextFormattingActor",null,[])},2106:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);var m;(function(f){f[f.initial=0]="initial";f[f.C2j=1]="startSearch";f[f.cQj=2]="searching";f[f.sAb=3]="searchComplete";f[f.kyc=4]="replaceAllInProgress";
f[f.jyc=5]="replaceAllComplete";f[f.Vja=6]="tooManyResults";f[f.$_a=7]="noMatchesFound"})(m||(m={}));Object(I.b)("FindReplaceViewType",m)},2108:function(I,K,e){e.d(K,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||(m={}))},2135:function(I,K,e){function m(b,h){h=Object.assign(new ma.a,{name:"LinkType",string:h});f(fb.a.chn,
b,[h])}function f(b,h,r,A=!0){h&&h.UILocation&&Object($d.d)(b,A,$d.e,0,h.UILocation,0,r)}function a(b,h){const r=Xa.a.instance;return new My(b,h,r.zf("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,r.zf("WordEditor.Bookmark.FullBookmarkManager").value,r.resolve("Box4.IHyperlinkStrategy"),r.resolve("Box4.IHyperlinkEditor"),r.resolve("Box4.ICharacterPropertiesEditor"),r.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,r.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
mp.a.instance,r.Wa("Box4.IInternalLinkManager"))}function l(b,h){var r;return b===Tt.none?"none":null===(r=$C[b])||void 0===r?void 0:r[h]}function w(){const b=Xa.a.instance.Wa("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&v.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function z(){const b=Xa.a.instance.Wa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&v.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}function x(b){b.Za("Box4.AugmentationLoop.IUtilsWrapper").execute(async h=>{var r,A,L,ba;await h.Km();h=FC.a.IB();const ra=await h.getSession();null!==(ba=null===(L=null===(A=null===(r=null===ra||void 0===ra?void 0:ra.sessionManager)||void 0===r?void 0:r.networkWorkerManager)||void 0===A?void 0:A.globalUrl)||void 0===L?void 0:L.startsWith)&&void 0!==ba&&ba.call(L,"ws://localhost")&&(r={message:new mO.y({seq:0,ops:[new ss.a({parentPath:["session"],items:[{id:"doc",body:new VO.d({isReadonly:!1})}]}),
new ss.a({parentPath:["session","doc"],items:[{id:"headerfooters",body:new PL.HeaderFooterSubDocument},{id:"comments",body:new PL.CommentSubDocument},{id:"main",body:new PL.MainSubDocument}]})]})},h.submitCustomMessage(r))})}e.r(K);var u=e(0),v=e(8),E=e(118),y=e(2),H=e(29),D=e(16),G=e(193),J=e(97);class U{constructor(b){this.oMg=0;this.yUb=this.bxc=this.AGa=null;this.dX=y.AFrameworkApplication.ta.Kt;this.L1=b;this.L1.$w(J.a.jTj);this.L1.DG(J.a.jTj,Object(E.a)(this,this.Z8n,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.yUb)return v.ULS.sendTraceTag(589050652,
344,100,"Returning existing promise"),this.yUb;this.AGa=this.dX.rg("ComponentAttach","getCustomAuthConfig");return this.yUb=new Promise((b,h)=>{const r={};let A=!1,L=!1,ba=0;this.oMg=window.setInterval(()=>{4>ba?(ba++,this.L1.sendMessage(J.a.getCustomAuthConfig,r)):(window.clearInterval(this.oMg),A=!0,v.ULS.sendTraceTag(588087303,344,10,H.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.bxc=(ra,Ia)=>{window.clearInterval(this.oMg);A||L||(L=!0,ra?(v.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),b(ra)):(v.ULS.sendTraceTag(589050654,369,10,H.c({["error"]:Ia.toString()})),h(Ia)))};this.L1.sendMessage(J.a.getCustomAuthConfig,r)})}Z8n(b){try{const h=H.a(b.Values[G.a.tpl]);let r=y.AFrameworkApplication.J.rb("Application")||"";r=D.a.Ph(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.AGa&&(this.AGa.stop(),this.AGa=null);this.bxc(h,"")}catch(h){v.ULS.sendTraceTag(589050655,344,10,H.c({["error"]:h.message,["stack"]:h.stack})),this.bxc(null,h.message)}}}Object(u.a)(U,"AccountSwitchingManager",null,[206]);var F=e(186);class T{get name(){return"Common.App.AccountSwitching"}Ec(b){b.register(U,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().fe(()=>
new U(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){F.a.instance.Rc(new T)}}Object(u.a)(T,"AccountSwitchingPackage",null,[0,1]);var Y;(function(b){b[b.nab=0]="generalException";b[b.Ufe=1]="invalidArgument";b[b.$fg=2]="notAllowed";b[b.Zkf=3]="apiNotAvailable";b[b.zBp=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.rhf=6]="adalTimeout";b[b.ofk=7]="userNotSignedIn";b[b.dxd=8]="userAborted";b[b.q0j=9]="silentSignInFailed";b[b.kad=10]="invalidResourceUrl";b[b.VZf=
11]="invalidGrant";b[b.iai=12]="connectionLost";b[b.lsf=13]="clientError";b[b.ZBg=14]="serverError"})(Y||(Y={}));Object(u.b)("ErrorCodes",Y);e(1835);class P{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(u.a)(P,"OutstandingRequest",null,[]);class S{}S.MYn="AADSTS50058";S.kad="AADSTS50001";S.FYn="AADSTS65001";S.tZn="AADSTS70011";S.dxd="13002";S.hlo="Popup Window is null";S.glo="Popup Window closed";S.rhf="Token renewal operation failed due to timeout";
S.g7j="tokenRevoked";Object(u.a)(S,"WopiHostErrorType",null,[]);var N=e(639),V=e(49),Z=e(1834);class ca{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(ca,"WopiIdentityInfo",null,[799]);class W{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(u.a)(W,"WopiIdentityToken",null,[798]);var X=e(17),ka=e(192),ma=e(31),ja=e(242);class na{constructor(b){this._initialized=
!1;this.Y8n=h=>{let r=null;try{const L=h.Values[G.a.xIg],ba=h.Values[G.a.Ojp],ra=h.Values[G.a.a2j],Ia=h.Values[G.a.Wjp];let Ta=null,ob=null;const nb=this.Xvc[L];if("undefined"!==typeof nb&&nb){var A=[];Array.add(A,Object.assign(new ma.a,{name:G.a.wIg,string:nb.requestParameters.correlationId}));ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:A}));r=nb.requestCallback;delete this.Xvc[L];"undefined"!==typeof ba&&ba&&ba.length?
ob=new W(ba,ra,Ia):Ta=Y[this.wQn(h)];A="getAccessToken_"+L;A in this.AEe&&(this.AEe[A].stop(),delete this.AEe[A]);r(ob,Ta)}else v.ULS.sendTraceTag(37856066,344,10,H.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:L}))}catch(L){h=h.Values[G.a.xIg],h in this.Xvc&&delete this.Xvc[h],this.zle(),v.ULS.sendTraceTag(37856067,344,10,H.c({["error"]:L.message,["stack"]:L.stack})),r&&r(null,"generalException")}};this.Xvc={};this.AEe={};this.dX=y.AFrameworkApplication.ta.Kt;this.KWf=
b}u2c(b){this._initialized||(b.$w(J.a.Swc),b.DG(J.a.Swc,this.Y8n),this._initialized=!0)}getAccessToken(b,h,r=null){this.ZL(b,h);return new Promise((A,L)=>{if(this.D_f(h))if(h in this.Xvc)L("unresolvedPendingRequest");else{var ba=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,H.c({["error"]:"Request timeout.",["callerId"]:h}));L("timeout")},12E4);this.FJf(b,h,r,(ra,Ia)=>{window.clearTimeout(ba);ra?A(ra):(v.ULS.sendTraceTag(37856033,369,15,H.c({["error"]:Y[Ia]})),L(Ia))})}else v.ULS.sendTraceTag(37856034,
344,10,H.c({["error"]:"Caller is not allowed."})),L("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.D_f(b)?this.kNm((A,L)=>{A?h(A):(v.ULS.sendTraceTag(37856064,369,10,H.c({["error"]:L.toString()})),r(L))}):(v.ULS.sendTraceTag(37856065,344,10,H.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const A=this.getAuthContextSync(b);A?h(A):r("notAllowed")})}getAuthContextSync(b){if(this.D_f(b)){const h=new Z.a;h.upn=y.AFrameworkApplication.J.rb("UserPrincipalName");
h.userId=y.AFrameworkApplication.J.rb("LoggableUserId");h.authority=y.AFrameworkApplication.J.rb("HostAuthAuthority");h.tenantId=y.AFrameworkApplication.J.rb("TenantId");h.isAnonymous=y.AFrameworkApplication.J.$("IsAnonymousUser");h.supportsAuthToken=this.r9m(b);b=y.AFrameworkApplication.J.rb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}v.ULS.sendTraceTag(40751647,344,10,H.c({["error"]:"Caller is not allowed."}));return null}r9m(b){const h=N.a.t9c;
return X.a.e_a?h&&N.a.x5j?Array.contains(N.a.x5j,b.toLowerCase()):!1:h}FJf(b,h,r,A){var L=[];Array.add(L,Object.assign(new ma.a,{name:"CallerId",string:h}));Array.add(L,Object.assign(new ma.a,{name:G.a.wIg,string:b.correlationId}));ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:L}));L=V.a.create().toString();const ba="getAccessToken_"+L,ra=this.dX.rg("ComponentAttach",ba);this.AEe[ba]=ra;const Ia={};Ia[G.a.xIg]=L;Ia[G.a.Tjp]=
b.resource;Ia[G.a.Ujp]=b.scope;Ia[G.a.a2j]=y.AFrameworkApplication.J.rb("HostAuthType");Ia[G.a.Xjp]=y.AFrameworkApplication.J.rb("UserPrincipalName");Ia[G.a.Vjp]=b.silentLogin;Ia[G.a.Qjp]=b.options;Ia[G.a.wIg]=b.correlationId;Ia[G.a.Rjp]=h;r&&(Ia[G.a.addinName]=r.AddinName,Ia[G.a.Pjp]=r.AddinTrustId);this.KWf.execute(Ta=>{this.u2c(Ta);Ta.sendMessage(J.a.getAuthToken,Ia)});this.Xvc[L]=new P(b,A)}kNm(b){const h=y.AFrameworkApplication.J.rb("UserName"),r=y.AFrameworkApplication.J.rb("UserPrincipalName"),
A=y.AFrameworkApplication.J.rb("LoggableUserIdSpace"),L=new ca;L.email=r;L.displayName=h;switch(A){case "OrgIdPuid":L.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":L.authority="MicrosoftAccount";break;default:L.authority=A}b(L,null)}D_f(b){var h=y.AFrameworkApplication.iZm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=N.a.elf;for(const r in h)if(b===h[r].toLowerCase())return!0;return!1}wQn(b){b=b.Values[G.a.Sjp];this.zle();v.ULS.sendTraceTag(39068821,
344,15,H.c({["error"]:b}));return b?-1<b.indexOf(S.MYn)?9:-1<b.indexOf(S.hlo)||-1<b.indexOf(S.glo)?12:-1<b.indexOf(S.kad)?10:-1<b.indexOf(S.dxd)?8:-1<b.indexOf(S.tZn)||-1<b.indexOf(S.FYn)||b===S.g7j?11:-1<b.indexOf(S.rhf)?6:0:13}ZL(b,h){b=this.Ozo(b.resource);v.ULS.sendTraceTag(39921882,344,50,H.c({["callerId"]:h,["resource"]:b}))}zle(){v.ULS.sendTraceTag(39068822,344,50,H.c({["userAgent"]:window.navigator.userAgent}))}Ozo(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/",
"\\")}}Object(u.a)(na,"WopiIdentityManager",null,[764]);class Ba{constructor(){this.Z=null;this.Gz=()=>{try{this.Z.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){v.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}}get name(){return"Common.App.WopiIdentity"}Ec(b){this.Z=b;b.register(na,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().fe(()=>new na(b.Za("Postmessage.IHostPostmessenger")))}init(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.lq(this.Gz)}dispose(){}static main(){F.a.instance.Rc(new Ba)}}Object(u.a)(Ba,"WopiIdentityPackage",null,[0,1]);var Ma=e(530),Ea=e(287),ya=e(87),ia;(function(b){b[b.p0p=0]="applicationFeatureHelperHandler";b[b.B2p=1]="cloudPolicySettings";b[b.V_p=2]="alternateAuthToken"})(ia||(ia={}));Object(u.b)("ApplicationFeatureHelperRequestType",ia);class za{constructor(){this.message=null;this.httpStatusCode=0}}Object(u.a)(za,"HttpRequstToPromiseRejectData",null,[]);var Ca=e(90),db=
e(43),pa=e(160),ua=e(558);class Ga{constructor(b,h){this.za=b;this.$f=h}jPb(b,h,r,A=null,L=null,ba=null,ra=null,Ia=null){const Ta=ia[r],ob=Ta+"RequestFailure";Ca.Health.instance.recordKpiUsage(ob,0,"jpittsdirects",null);return new Promise((nb,Eb)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Ta);const bc=null!=ra?ra:this.za.sc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Bc=null!=Ia?Ia:this.za.sc("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.$f.o8a(b,1,null,this.k6c(r,A),ba,1,Yc=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Ta);try{if(void 0===Yc||null===Yc||void 0===Yc.data||null===Yc.data||void 0===Yc.data.responseData||null===Yc.data.responseData){Ca.Health.instance.recordKpiFailure(ob,"Invalid RequestSucceededEventArgs",!1,!0,null);const Jd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Ta);Eb(this.e9(Jd,Yc))}else if(Yc.data.Xe!==pa.a.jB){Ca.Health.instance.recordKpiFailure(ob,"HttpStatusCode_"+Yc.data.Xe.toString(),!1,!0,null);const Jd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Yc.data.Xe,Ta);Eb(this.e9(Jd,Yc))}else{void 0!==L&&null!==L&&void 0!==Yc.data.Pi&&null!==Yc.data.Pi&&L(Yc.data.Pi);var zd=h(Yc.data.responseData);if(zd)v.ULS.sendTraceTag(50622690,
3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Ta),nb(zd);else{Ca.Health.instance.recordKpiFailure(ob,"Parse Failure",!1,!0,null);const Jd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Ta);Eb(this.e9(Jd,Yc))}}}catch(Jd){Ca.Health.instance.recordKpiFailure(ob,"Unexpected Failure",!1,!0,null),zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Jd,Ta),Eb(this.e9(zd,Yc))}},Yc=>{if(Yc.data){Ca.Health.instance.recordKpiFailure(ob,"HttpStatusCode_"+Yc.data.Xe.toString(),!1,!0,null);var zd=ua.a.xTb(Yc.data.responseData||"No Data");zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Yc.data.Xe,zd,Ta)}else Ca.Health.instance.recordKpiFailure(ob,"Invalid RequestFailedEventArgs",!1,!0,null),zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
Ta);Eb(this.e9(zd,Yc))},void 0,void 0,bc,Bc)})}e9(b,h){const r=new za;r.message=b;r.httpStatusCode=h&&h.data?h.data.Xe:-1;return r}k6c(b,h){const r={};r["x-UserDataSignature"]=this.za.rb("UserDataSignature");r["x-LicensingIsEnabled"]=this.za.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.za.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.za.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.za.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
"true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=db.a.LL(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(h)for(const A of h.keys)r[A]=h.K(A);return r}}Object(u.a)(Ga,"HttpRequestToPromiseUtility",null,[]);var wa;(function(b){b[b.KOn=0]="loki";b[b.A0p=1]="augloopACLP"})(wa||(wa={}));Object(u.b)("AlternateAuthSupportApp",wa);class xa{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(xa,"WacAlternateAuthToken",null,[]);class sa{constructor(b,h){this.Stp=3E5;this.sgo=r=>{let A=null;({Zv:A}=H.d(r));return A};if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.za=b;this.Qzd=new Ma.a(Ea.a.Oh());this.xLc=new Ga(b,h);void 0!==N.a.D$f&&null!==N.a.D$f&&void 0!==N.a.cme&&null!==N.a.cme&&0<N.a.cme&&(b=new xa,b.Token=N.a.D$f,b.ExpirationTime=N.a.cme,this.Qzd.W("loki",b))}Tnm(){let b=null;this.Qzd.Bb(wa[0])&&(b=this.Qzd.K(wa[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.$bm():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-Date.now()<this.Stp}$bm(){const b=new Ma.a(Ea.a.Oh());b.W("X-AlternateAuthApp",wa[0]);return this.xLc.jPb(this.gYa("/afhs/AlternateAuthHelperHandler.ashx"),
this.sgo,2,b).then(h=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",wa[0]);this.Qzd.W(wa[0],h);return h.Token},h=>{h=Object(ya.a)(za,h);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}gYa(b){const h=this.za.$("SuiteOriginForAFHSIsEnabled")?this.za.rb("SuiteOrigin"):this.za.rb("WebServiceBase");return String.format("{0}{1}?{2}",
h,b,y.AFrameworkApplication.lm)}}Object(u.a)(sa,"AlternateAuthHelper",null,[741]);var Ka=e(623);class Na{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(u.a)(Na,"FeatureStateChangeArgs",null,[]);var ub=e(889),Ua=e(211),sb=e(84),qb=e(127),ab;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(ab||(ab={}));Object(u.b)("FeatureState",ab);var Xa=e(21),wb=e(12),Sa=e(100);class cc{constructor(b,h,r=null,
A=null,L=null){this.hsb=this.isa=this.mHh=this.Jlb=this.FQd=null;this.xgo=ba=>{(ba=H.b(ba))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",ba)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return ba.Features};this.G0m=()=>{v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.hsb.then(ba=>{this.YFj(ba)}).catch(()=>{this.YFj({})})};this.woo=ba=>{try{ba&&"Date"in ba&&(this.isa=new Date(ba.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.isa.toString()))}catch(ra){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",ra)}};this.xLc=new Ga(b,h);this.za=b;this.MJk=b.sc("LicensingMaxRetryAttempts",0);this.hId=b.$("IsO365ConsumerHost");this.O_e=b.$("IsO365CommercialHost");
this.i_e=b.$("PremiumUpsellIsEnabled");this.B$b=!1;this.o2e=0;this.Tgh=r;this.rPh=A;this.ga=L;this.Ilb=b.$("LicensingIsEnabled");this.VIb=b.$("OcpsIsEnabled")&&this.O_e;this.uff=b.$("ShowPrivacyDialog")&&!!A;this.p$b=b.$("IsAnonymousUser");this.U5d=new Promise(ba=>{ba(!1)});this.CCb=new Promise(ba=>{ba(!0)});this.gsb=new Ma.a(Ea.a.Oh());this.XSd=!0;this.Cyh=this.REm();this.Qcb()&&!this.p$b?(void 0!==y.AFrameworkApplication.ta&&null!==y.AFrameworkApplication.ta&&(this.FQd=y.AFrameworkApplication.ta.Kt,
void 0!==this.FQd&&null!==this.FQd&&(this.Jlb=this.FQd.O_a("WebServiceCall","ApplicationFeatureHelperService"))),this.hsb=this.VNg()):this.hsb=new Promise(ba=>{ba({})});this.hsb.catch(ba=>{ba=Object(ya.a)(za,ba);v.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ba?ba.httpStatusCode.toString():"Unknown")});this.XSd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ba=>{this.B$b=ba;return null})}REm(){const b=this.za.RA("AllLicensedFeatures")?this.za.kF("AllLicensedFeatures"):
[],h=new Ka.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}Qcb(){return this.O_e||this.hId}VNg(b=0,h=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=ub.a.HI();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.hId.toString()),r.set("isO365CommercialHost",this.O_e.toString()),r.set("isFreemiumUpsellSettingEnabled",this.i_e.toString()));Ca.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",r);Ca.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.Jlb&&null!==this.Jlb&&this.Jlb.start();let A=null;h&&(A=new Ma.a(Ea.a.Oh()),A.W("x-LicensingForceRefresh","true"));this.mHh=new Date;return(this.Ilb?this.xLc.jPb(this.gYa("/afhs/ApplicationFeatureHelperHandler.ashx"),this.xgo,0,A,this.woo,["Date"]):Promise.resolve({})).then(L=>{const ba=Object.assign(new Sa.a,{durationMs:this.U2j()});ba.extendedProperties=r;ba.extendedProperties&&
L&&(ba.extendedProperties.set("featureCount",sb.a.count(L).toString()),ba.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in L).toString()),ba.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in L).toString()),"FreemiumUpsell"in L&&ba.extendedProperties.set("isFreemiumUpsellEnabled",L.FreemiumUpsell.toString()),this.isa&&ba.extendedProperties.set("fromCache",(this.isa<this.mHh).toString()));Ca.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ba);return L},L=>{const ba=Object.assign(new Sa.a,{durationMs:this.U2j()}),ra=Object(ya.a)(za,L);if(!ra)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ca.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ba),new Promise((Ia,Ta)=>{Ta(L)});ba.extendedProperties=r;ba.extendedProperties&&ba.extendedProperties.set("status",ra.httpStatusCode.toString());
Ca.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ba);return 408===ra.httpStatusCode&&++b<=this.MJk?this.VNg(b):new Promise((Ia,Ta)=>{Ta(ra)})})}gYa(b){var h=this.za.$("SuiteOriginForAFHSIsEnabled")?this.za.rb("SuiteOrigin"):this.za.rb("WebServiceBase");h=String.format("{0}{1}",h,b);this.za.RA("ApplicationFeatureHelperHttpCachingEnabled")&&this.za.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=cc.P$d(this.za))&&0<b.length&&(this.XSd&&(b+="ucbf"),h=new Ua.QueryStringBuilder(h),
h.Me("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.VIb&&!this.uff&&!this.Ilb)return this.CCb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.VIb?this.Tgh.nN("ControllerConnectedServicesEnabled"):this.CCb;const ba=this.uff?this.rPh.getSettings().then(ra=>2!==ra.aN,()=>h):this.CCb;return r.then(ra=>ra?ba:this.U5d)}if("FreemiumUpsell"===b&&(!this.i_e||!this.hId||
this.p$b))return this.U5d;r=null;r=this.VIb?this.Tgh.isFeatureEnabled(b):this.CCb;let A=null;A=this.Ilb?this.vqn(b,h):this.CCb;let L=null;L=this.uff?this.rPh.isFeatureEnabled(b):this.CCb;return r.then(ba=>ba?L.then(ra=>ra?A:this.U5d):this.U5d).then(ba=>{this.Kej(b,ba,!0);return ba},()=>{this.Kej(b,h,!1);return h})}Kej(b,h,r){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.Ilb)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,
3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.hsb.then(r=>this.Tbe(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.i_e&&this.hId&&!this.p$b){if(this.B$b&&2!==this.o2e||!this.B$b&&1!==this.o2e)v.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.B$b.toString()),this.o2e=this.B$b?2:1;return this.B$b}return!1}launchUpsellExperience(b,h=null){v.ULS.sendTraceTag(594564814,3004,
50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=ub.a.HI();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));Ca.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);(r=Xa.a.instance.Wa("Common.IInProductMessagingUIManager"))?r.vaj(b,this.G0m,h):(v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",
!1,!0,null),this.ga.Zb(wb.a.S7d,2,{["experience"]:b}))}dxa(b,h){if(!this.Ilb)return null;if(!b||!h)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=qb.a.create().toString();this.gsb.Bb(b)||this.gsb.W(b,new Ma.a(Ea.a.Oh()));this.gsb.K(b).add(r,h);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}O0b(b,
h){this.Ilb&&(b&&this.gsb.Bb(b)?h&&qb.a.isValid(h)?this.gsb.K(b).Bb(h)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.gsb.K(b).remove(h)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}Tbe(b,h,r){return this.XSd?b in h?h[b].LicenseTier:r:b in h?this.hho(h[b],r):r}hho(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}YFj(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.VNg(0,!0);
h.then(r=>{this.hsb=h;sb.a.count(r)>sb.a.count(b)?Ca.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const A of this.gsb.keys)if(A in r){const L=this.Tbe(A,r,0);A in b?this.Tbe(A,b,0)!==L&&this.ogg(A,!0,L):this.ogg(A,!0,L)}else A in b&&this.ogg(A,!1,this.Tbe(A,b,0))}).catch(r=>{Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(r))})}ogg(b,h,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Na(b,h,r);r=this.gsb.K(b);for(const A of r)try{A.value(h)}catch(L){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,A.key,L.message))}}uqn(b,h){if(this.Ilb){const r=
this.Cyh.contains(b);let A=!0,L="",ba=!1;return this.hsb.then(ra=>{b in ra?(ra=ra[b],L=ab[ra.FeatureState],A=1!==ra.FeatureState):A=!r;this.Yej(b,r,L,ba,h,A);return A},()=>{ba=!0;r&&(A=h);this.Yej(b,r,L,ba,h,A);return A})}return this.CCb}Yej(b,h,r,A,L,ba){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,A,r,L,ba)}vqn(b,h){if(this.XSd)return this.uqn(b,h);if(this.Ilb){if(this.Cyh.contains(b))return this.hsb.then(r=>
b in r,()=>h);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.CCb}U2j(){if(void 0!==this.Jlb&&null!==this.Jlb){const b=this.Jlb.qj;this.Jlb.stop();return b}return null}static P$d(b){try{if(X.a.bFe){const h=b.rb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),A=JSON.parse(r).LocalStorageKey;if(void 0!==A&&null!==A&&0<A.length)return A}}}catch(h){v.ULS.sendTraceTag(578863816,
3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(u.a)(cc,"ApplicationFeatureHelper",null,[742]);var Cb=e(76);class Wa{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(u.a)(Wa,"CloudPolicySettingsCacheData",null,[]);var Ja=e(1254),Va=e(638),mb=e(308);class Ab{static n0j(){return y.AFrameworkApplication.J.$("SideCarIsEnabled")?Ab.Gze&&
Ab.cbd?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Ab.Gze=mb.a.create(y.AFrameworkApplication.J.rb("SideCarUrl"));Va.a.UY(Ab.Gze);Ab.Gze.L0((r,A)=>{(Ab.cbd=A.succeeded)?b(A.succeeded):h(A.succeeded)})}):new Promise(b=>{b(!1)})}}Ab.cbd=!1;Ab.Gze=null;Object(u.a)(Ab,"SideCarLoader",null,[]);class Xb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(Xb,"CloudPolicySettingsData",null,[]);class Lb{constructor(b,h){this.WPe=0;this.FZd=null;this.Ago=r=>{let A=
null;({Zv:A}=H.d(r));r=!!A;v.ULS.sendTraceTag(50622687,3004,r?50:10,"ParseCloudPolicySettingsResponse: Success={0}",r);return A};this.Koo=r=>{try{if(void 0!==r&&null!==r&&"CheckIn-Interval"in r){const A=parseInt(r["CheckIn-Interval"]);void 0!==A&&null!==A&&0<A&&(this.WPe=A)}}catch(A){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",A)}};this.xLc=new Ga(b,h);this.za=b;h=b.rb("HostAuthType");this.VIb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===
h||null===h)&&"aad"===h.toLowerCase();this.SBh=H.b(b.rb("OcpsDefaultSettings")||"{}");this.MNc=this.P$d();h=this.za.RA("ServicesControlsMicrosoftControllerServicesList")?this.za.kF("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.dCd=new Ka.a;for(let r=0;r<h.length;r++)this.dCd.add(h[r]);this.VIb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.FZd=this.Rxp():this.FZd=this.UNg(this.VIb,this.gYa("/afhs/CloudPolicySettings.ashx"),this.Ago);this.FZd.then(()=>null).catch(r=>{r=Object(ya.a)(za,
r);v.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}nN(b,h=!0,r=!0){if(!this.VIb){const ra=this;return new Promise(Ia=>{Ia(ra.U6c(b))})}const A=this,L=this,ba=this.FZd.then(ra=>{try{let Ia=null;ra.PolicySettings&&"unknown"in ra.PolicySettings&&(Ia=ra.PolicySettings.unknown);if(Ia){if(b in Ia&&void 0!==Ia[b]&&null!==Ia[b])return new Promise(ob=>{ob("0"!==Ia[b])});const Ta=b.toLowerCase();if(Ta in Ia&&void 0!==
Ia[Ta]&&null!==Ia[Ta])return new Promise(ob=>{ob("0"!==Ia[Ta])});if(r)return v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default"),new Promise(ob=>{ob(A.U6c(b))});v.ULS.sendTraceTag(508395746,3004,50,"Policy"+b+" not found, returning PolicyNotConfigured error");return new Promise((ob,nb)=>{nb("PolicyNotConfigured")})}return new Promise(Ta=>{Ta(A.U6c(b))})}catch(Ia){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",Ia.message),A.handleError(Ia.toString(),
h,A.U6c(b))}},ra=>L.handleError(ra,h,L.U6c(b)));ba.then(ra=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ra);return null});return ba}isFeatureEnabled(b,h=!0){if(this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.xqn(b,h);let r=new Promise(L=>{L(!0)}),A="";this.dCd.contains(b)&&(A="ControllerConnectedServicesEnabled",r=this.nN(A,h));r.then(L=>{v.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,L,A);return null});return r}xqn(b,h=!0){let r=new Promise(L=>{L(!0)}),A="";"mso_sendASmile"===b?A="Enabled":"Survey"===b||"FloodgateSurvey"===b?A="SurveyEnabled":this.dCd.contains(b)&&(A="ControllerConnectedServicesEnabled");""!==A&&(r=this.nN(A,h));r.then(L=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,L,A);return null});return r}handleError(b,h,r){return h?new Promise(A=>{A(r)}):new Promise((A,L)=>{L(b)})}UNg(b,h,r){if(!b)return Promise.resolve(new Xb);let A=!1,L=null;Ca.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ba=this.Hvf("GetCloudPolicySettings");return(new Promise((ra,Ia)=>{if(void 0!==this.MNc&&null!==this.MNc&&0<this.MNc.length){const Ta=this.txp();if(void 0!==Ta&&null!==Ta){A=!0;ra(Ta);return}}this.xLc.jPb(h,r,1,null,this.Koo,["CheckIn-Interval"],
this.za.sc("CloudPolicySettingsRequestQueueTimeout",15E3),this.za.sc("CloudPolicySettingsRequestSentTimeout",3E4)).then(Ta=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Hyp(Ta);ra(Ta);return Ta},Ta=>{Ia(Ta);return null})})).then(ra=>{({gB:ba,returnValue:L}=this.xEe(ba));var Ia=ub.a.HI();Ia&&Ia.set("FromCache",A.toString());Ia=Object.assign(new Sa.a,{durationMs:L,extendedProperties:Ia});Ca.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ia);return ra})}Rxp(){return Ab.n0j().then(()=>
{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}gYa(b){const h=this.za.$("SuiteOriginForAFHSIsEnabled")?this.za.rb("SuiteOrigin"):this.za.rb("WebServiceBase");return String.format("{0}{1}",h,b)}U6c(b){return b in this.SBh?"0"!==this.SBh[b]:!0}txp(){try{const b=Ja.a.instance.getItem(this.MNc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new Xb;r.PolicySettings=h.PolicySettings;r.ControllerConnectedServicesFeatureNames=new Cb.a;this.za.RA("ServicesControlsMicrosoftControllerServicesList")&&this.za.kF("ServicesControlsMicrosoftControllerServicesList");for(const A of this.dCd)r.ControllerConnectedServicesFeatureNames.add(A);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}Hyp(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.WPe)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Wa(b,this.WPe),r=JSON.stringify(h);
v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);Ja.a.instance.setItem(this.MNc,r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}P$d(){const b=cc.P$d(this.za);return b&&0<b.length?"OCPS"+b:null}Hvf(b){const h=Xa.a.instance.Wa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
h&&null!==h?h.rg("WebServiceCall",b):null}xEe(b){if(void 0!==b&&null!==b){const h=b.qj;b.stop();return{returnValue:h,gB:null}}return{returnValue:null,gB:b}}}Object(u.a)(Lb,"CloudPolicySettingsHelper",null,[739]);class dc{constructor(){this.fni=this.jfk=this.aN=0;this.gni=this.kfk=this.VOb="";this.zbf=this.z3a=2}clone(){const b=new dc;b.aN=this.aN;b.jfk=this.jfk;b.fni=this.fni;b.VOb=this.VOb;b.kfk=this.kfk;b.gni=this.gni;b.z3a=this.z3a;b.zbf=this.src;return b}get src(){return this.zbf}serialize(b=
null){const h={};if(!b||b.contains(dc.UYb))h[dc.UYb]=this.aN;if(!b||b.contains(dc.Fhd))h[dc.Fhd]=this.VOb;if(!b||b.contains(dc.Ghd))h[dc.Ghd]=this.z3a;return JSON.stringify(h)}static create(b,h=null){const r=new dc;r.zbf=b;void 0!==h&&null!==h&&(dc.UYb in h&&(r.aN=h[dc.UYb]),dc.Fhd in h&&(r.VOb=h[dc.Fhd]),dc.Ghd in h&&(r.z3a=h[dc.Ghd]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return dc.create(h,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",r.toString()),r;}}}dc.UYb="CCS";dc.Fhd="CCSTime";dc.Ghd="OfficePrivacyRoamedNoticeShown";Object(u.a)(dc,"UserPrivacySettings",null,[]);var yc=e(196);class Wc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.za=b;this.$f=h;this.taf=this.ef=null}gYa(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.za.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(y.AFrameworkApplication.lm);return h.toString()}executeRequest(b,h,r,A=null){return this.$f.LMb(b,h,A,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.ef||null===this.ef||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");
else{var A=this.ef.aN!==b.aN;if(2===this.ef.src&&A)this.fTo(b),h(!0);else{var L=this.oYo(b);if(void 0===L||null===L||!L.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.ef.src)h(this.a$j(L));else if(0===this.ef.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",L);const ba=this.executeRequest(this.gYa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
L);ba.continueWith(()=>{if(ba.mq||ba.wj)v.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ra=ba.result;void 0!==ra.args&&null!==ra.args&&void 0!==ra.args.data&&null!==ra.args.data&&ra.args.data.Xe===pa.a.jB?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ba){v.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",ba.toString()),h(!1)}})}oYo(b){if(void 0===this.ef||null===this.ef||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new Cb.a;0===b.src?(this.ef.aN!==b.aN&&(h.add(dc.UYb),h.add(dc.Fhd)),this.ef.z3a!==b.z3a&&h.add(dc.Ghd)):1===b.src&&this.ef.aN!==b.aN&&h.add(dc.UYb);return h.count?b.serialize(h):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.taf){const b=this;this.taf=new Promise(h=>{try{b.ef?h(b.ef.clone()):b.Jxp().then(r=>{b.ef=r;h(b.ef.clone());return null},()=>{b.Hxp().then(r=>{b.ef=r;h(b.ef.clone());return null},()=>{b.Ixp().then(r=>{b.ef=r;h(b.ef.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.ef=new dc;h(b.ef.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
r.toString()),b.ef=new dc,h(b.ef.clone())}})}return this.taf}Jxp(){return new Promise((b,h)=>{try{const A=-1!==window.location.href.indexOf("&wd_pn=2");if(this.za.$("PrivacyDialogShouldCheckRoaming")||A){var r=this.executeRequest(this.gYa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.mq||r.wj)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const L=r.result;if(L&&L.args&&L.args.data)if(L.args.data.Xe!==
pa.a.jB)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",L.args.data.Xe);else{if(L.args.data.responseData){b(Wc.parse(L.args.data.responseData,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",L.args.data.responseData);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(L){v.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",L.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(A){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
A.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Hxp(){return new Promise((b,h)=>{try{const r=yc.a.get("WacUPToggleState");let A=null;void 0!==r&&null!==r&&0<r.length&&(A=decodeURIComponent(r));if(void 0!==A&&null!==A&&0<A.length){const L=Wc.parse(A,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",L.toString());b(L)}else{const L=dc.create(1),ba=new Cb.a;ba.add(dc.UYb);const ra=L.serialize(ba);this.a$j(ra)?
(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ra),b(L)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ra),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Ixp(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");const r=dc.create(2);h?(r.aN=2,y.AFrameworkApplication.bli(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.aN=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),
h=dc.create(2),h.aN=1,b(h)}})}fTo(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.aN?y.AFrameworkApplication.bli():y.AFrameworkApplication.k6l();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}a$j(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.za.rb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return yc.a.wWj("WacUPToggleState",b,yc.a.U_a,h)}catch(h){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.za.RA("ServicesControlsMicrosoftControllerServicesList")?this.za.kF("ServicesControlsMicrosoftControllerServicesList"):[],A=new Ka.a;for(let L=0;L<r.length;L++)A.add(r[L]);return A.contains(b)?
2!==h.aN:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),dc.deserialize(b,h)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(u.a)(Wc,"UserPrivacySettingsHelper",null,[740]);class zb{constructor(){this.Z=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Ec(b){this.Z=
b;this.Z.register(739,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().fe(()=>new Lb(y.AFrameworkApplication.J,y.AFrameworkApplication.pe));this.Z.register(740,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().fe(()=>new Wc(y.AFrameworkApplication.J,y.AFrameworkApplication.pe));this.Z.register(741,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().fe(()=>new sa(y.AFrameworkApplication.J,y.AFrameworkApplication.pe));this.Z.register(742,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().fe(()=>
new cc(y.AFrameworkApplication.J,y.AFrameworkApplication.pe,this.Z.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Z.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),y.AFrameworkApplication.va))}init(){y.AFrameworkApplication.J.lq(()=>{const b=this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");y.AFrameworkApplication.J.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{v.ULS.sendTraceTag(42513092,
3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.rb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.rb("IsAnonymousUser"));return null}));this.Z.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");
this.Yqp()})}dispose(){}Yqp(){try{y.AFrameworkApplication.J.$("SideCarIsEnabled")&&Ab.n0j().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){F.a.instance.Rc(new zb)}}Object(u.a)(zb,"ApplicationFeatureHelperPackage",null,[0,1]);var cd=e(180);class qc{T$d(b,h){let r;const A=[];for(;r=h.exec(b);){const L=r.index;A.push(new cd.a(L,L+r[0].length))}return A}isEndPuncSpecialCase(b){const h=this.T$d(b,
qc.Iip);for(const r of h)if(r.end===b.length)return!0;return!1}U2c(b){for(const h of qc.G$l){const r=this.T$d(b,h);if(0<r.length&&!r[0].Mc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.T$d(A,qc.bpi);for(h=b.length-1;0<=h;h--){const L=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[h].Mc,A.length),r+b[h].end+this.U2c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.T$d(A,qc.bpi);for(r=0;r<b.length;r++){const L=A.substring(0,
b[r].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[r].Mc,A.length),h+b[r].end+this.U2c(A)}return-1}}qc.ZEf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";qc.$Ef="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
qc.aFf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";qc.G$l=[new RegExp(qc.ZEf,"ig"),new RegExp(qc.$Ef,"ig"),new RegExp(qc.aFf,"ig")];qc.YHg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";qc.aIg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";qc.$Hg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
qc.ZHg=qc.aIg+"|"+qc.$Hg;qc.bIg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";qc.cIg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";qc.dIg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
qc.eIg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";qc.RBg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
qc.ZHg+"|"+qc.bIg+"|"+qc.cIg+")";qc.QBg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
qc.dIg+")";qc.Pfg=qc.YHg+"|"+qc.eIg;qc.XHg=qc.Pfg+"|"+qc.RBg+"|"+qc.QBg;qc.bpi=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");qc.Iip=new RegExp(qc.XHg,"g");Object(u.a)(qc,"ProofingSentenceSeparatorScriptSharp",null,[737]);class Dc{Fyd(b,h){const r=[];let A;for(;null!=(A=h.exec(b));){const L=A.index;r.push({Mc:L,end:L+A[0].length})}return r}isEndPuncSpecialCase(b){return this.Fyd(b,Dc.gpk).some(h=>
h.end==b.length)}U2c(b){for(const h of Dc.xlk){const r=this.Fyd(b,h);if(0<r.length&&0==r[0].Mc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.Fyd(A,Dc.$Tg);for(h=b.length-1;0<=h;h--){const L=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return A=A.substring(b[h].Mc,A.length),r+b[h].end+this.U2c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.Fyd(A,Dc.$Tg);for(r=0;r<b.length;r++){const L=A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(L))return A=
A.substring(b[r].Mc,A.length),h+b[r].end+this.U2c(A)}return-1}}Dc.dkk="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Dc.bpk="[\u2639\u263a\u263b]";Dc.ZUg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Dc.dlk="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Dc.$nk="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Dc.fVg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Dc.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Dc.YUg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Dc.$mk="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Dc.Zmk="[\uff21-\uff3a\uff41-\uff5a]";Dc.Xmk="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Dc.Wmk="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Dc.Ymk="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Dc.cLe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Dc.ZTg="[\u3002\uff61]";Dc.bzd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Dc.Dlk="[\u00bb\u2019\u201d\u203a\"']";Dc.uLe=Dc.dkk+"|"+Dc.bpk;Dc.ank="[\u2028\u2029\n\r]";Dc.Vmk="("+Dc.bzd+"|"+Dc.ZUg+"|"+Dc.fVg+"|"+Dc.YUg+
")";Dc.Umk="("+Dc.bzd+"|"+Dc.ZUg+"|"+Dc.fVg+"|"+Dc.Symbol+"|"+Dc.YUg+"|"+Dc.dlk+"|"+Dc.$nk+")";Dc.ZEf="("+Dc.cLe+"("+Dc.uLe+"|"+Dc.Dlk+"|"+Dc.bzd+")*"+Dc.ank+")";Dc.$Ef="("+Dc.cLe+"("+Dc.uLe+")*("+Dc.bzd+")+)";Dc.aFf="("+Dc.ZTg+"("+Dc.uLe+")*)";Dc.xlk=[new RegExp(Dc.ZEf,"ig"),new RegExp(Dc.$Ef,"ig"),new RegExp(Dc.aFf,"ig")];Dc.YHg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Dc.aIg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Dc.$Hg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Dc.ZHg=Dc.aIg+"|"+Dc.$Hg;Dc.bIg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Dc.cIg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Dc.dIg="(("+Dc.$mk+"|"+Dc.Xmk+"|"+Dc.Ymk+")[.])+|(("+Dc.Wmk+")[.\ufe52\uff0e])+";Dc.eIg="("+Dc.Zmk+")[.\ufe52\uff0e]";Dc.RBg=Dc.Vmk+"("+Dc.ZHg+"|"+Dc.bIg+"|"+Dc.cIg+")";Dc.QBg=Dc.Umk+"("+Dc.dIg+")";Dc.Pfg=Dc.YHg+"|"+Dc.eIg;Dc.XHg=Dc.Pfg+"|"+Dc.RBg+"|"+Dc.QBg;Dc.$Tg=new RegExp(Dc.cLe+"|"+Dc.ZTg,"ig");Dc.gpk=new RegExp(Dc.XHg,"g");Object(u.a)(Dc,"ProofingSentenceSeparator",null,[737]);class mc{constructor(){this.Z=null}get name(){return"Box4.ProofingGrammarCheck"}Ec(b){this.Z=b;y.AFrameworkApplication.J.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ja("Box4.Proofing.IProofingSentenceSeparator",()=>new Dc).ha():b.ja("Box4.Proofing.IProofingSentenceSeparator",()=>new qc).ha()}init(){this.Z.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){F.a.instance.Rc(new mc)}}Object(u.a)(mc,"Box4GrammarCheckPackage",null,[0,1]);var lc=e(148),Vb=e(63),yb=e(1852),Db=e(18);class $b{constructor(){this.Z=null}get name(){return"Box4.AtMentions"}Ec(b){this.Z=b;this.Z.ja("Box4.AtMentions.IAtMentionsListener",()=>new yb.a(this.Z.resolve("Box4.IEditingDomManager"),
this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.BackspaceDeleteEventSource"),Object(Vb.a)(),"@",["@","/"])).ha()}init(){y.AFrameworkApplication.J.lq(()=>{this.Z.resolve("Box4.AtMentions.IAtMentionsListener").bgc(Db.StaticActiveAppFrame.Aa().tb,lc.KeyInputManager.instance)})}dispose(){this.Z.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){F.a.instance.Rc(new $b)}}Object(u.a)($b,"Box4AtMentionsPackage",null,[0,1]);class Fa{get name(){return"Box4.Workers"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new Fa)}}
Object(u.a)(Fa,"Box4WorkersPackage",null,[0,1]);var lb=e(320),kb=e(103);class Ob{constructor(){this.VRa=new kb.a}s$(b,h){this.VRa.W(b,h)}OJf(b){({value:b}=this.VRa.Nc(b));return b}}Object(u.a)(Ob,"AggregationMethodsForActivityName",null,[]);var nc=e(260);class zc{constructor(){this.nNd=new lb.a;this.VRa=new lb.a}s$(b,h,r){this.VRa.Bb(b)&&this.VRa.K(b)||this.VRa.W(b,new Ob);this.VRa.K(b).s$(h,r)}OJf(b,h){return this.VRa.Bb(b)&&this.VRa.K(b)?this.VRa.K(b).OJf(h):null}k7c(b){this.nNd.Bb(b)&&this.nNd.K(b)||
this.nNd.W(b,new nc.a);return this.nNd.K(b)}Mhi(b,h){this.k7c(b).add(h)}}Object(u.a)(zc,"ActivityAggregationInfo",null,[791]);var Pb=e(257),tb=e(997),ib=e(1013);class Rb extends tb.a{constructor(b,h){super(b);this.Oef=(this.Bsk=h)?h.Gzm():ib.a.wJf()}get YJa(){return this.Bsk}get activityName(){return this.YJa.name}get startTime(){return this.YJa.startTime}get endTime(){return this.YJa.endTime}end(){}cancel(){}bIf(){}HEp(){this.tlc.W("AM",this.YJa.mode.toString());this.tlc.W("C",this.YJa.count.toString());
this.tlc.W("DA",this.YJa.yni.toFixed(2));this.tlc.W("DV",this.YJa.q4l.toFixed(2))}bQf(b){return this.YJa.bQf(b)}MQf(){return this.YJa.MQf()}Zec(){for(const b of this.YJa.ZJa)b.Zec()}}Object(u.a)(Rb,"AggregatedActivity",tb.a,[]);class gc{constructor(b,h){this.wNe=0;this.qHa=b;this.Z3a=h}B$k(b,h){this.wNe=h;for(h=0;h<b.count;h++){const r=b.K(h);this.C$k(r)}}C$k(b){const h=Object(ya.a)(Rb,b);if(h)if(1===this.wNe)this.A$k(h);else if(2===this.wNe){this.D$k(h);for(const r of this.Z3a.k7c(this.qHa)){const A=
h.YJa.ZJa.K(0);A.properties.Bb(r)&&b.properties.W(r,A.properties.K(r))}}}A$k(b){for(const h of this.Z3a.k7c(this.qHa))this.uOj(b,h)}D$k(b){for(const h of b.MQf())this.uOj(b,h)}uOj(b,h){const r=this.Z3a.OJf(this.qHa,h);if(r){const A=b.bQf(h);b.properties.W(h,r(A))}}}Object(u.a)(gc,"PropertyAggregationHelper",null,[]);var xc=e(1086);class Nc{constructor(b,h,r,A,L){this.C6b=b;this.Z3a=h;this.thh=L;this.eNe=A;this.hJk=r}get DRh(){return this.hJk.value}aZc(b){if(Object(Pb.a)(xc.a,b))b.aZc();else if(Object(Pb.a)(Rb,
b)&&this.eNe.k4h(b.activityName.toString())){b=Object(ya.a)(Rb,b);b.HEp();b=b.Bhj();var h=[];Array.add(h,b);b=H.c(h);v.ULS.sendTraceTag(6907266,213,50,b)}}hKa(b,h){const r=(new Date).getTime();var A=this.thh.list.K(b);const L=({F$k:A}=this.cnm(A)).returnValue;this.thh.list.W(b,new Cb.a);h&&(A=this.UIl(A,r,this.C6b.qQi));0<A.count&&(new gc(b,this.Z3a)).B$k(A,L)}UIl(b,h,r){const A=new Cb.a;for(let L=0;L<b.count;L++){const ba=b.K(L);ba.startTime>h-r?ba.Zec():A.add(ba)}return A}cnm(b){const h=this.DRh.z6j(b);
b=this.DRh.ysp(b);const r=this.G$k(h,b);return{returnValue:r,F$k:1===r?h:b}}G$k(b,h){return b.count*this.C6b.Zjj<h.count?1:2}get enabled(){return this.C6b.enabled}Zec(){}}Object(u.a)(Nc,"ActivityAggregationManager",null,[790]);class Kc{constructor(b){this.enabled=!1;this.rij=500;this.Ejj=2;this.Zjj=5;this.qQi=3E4;this.b3c(b.appSettings)}b3c(b){this.enabled=Boolean.parse(b[Kc.nDf]||"false");this.rij=parseInt(b[Kc.eSn]||"500");this.Ejj=parseInt(b[Kc.IUn]||"2");this.Zjj=parseInt(b[Kc.fVn]||"5");this.qQi=
parseInt(b[Kc.BZm]||"30000")}}Kc.nDf="ActivityAggregationEnabled";Kc.eSn="ActivityAggregationMaxInterval";Kc.IUn="ActivityAggregationMinChain";Kc.fVn="ActivityAggregationModeFactor";Kc.BZm="ActivityAggregationGraceWindow";Object(u.a)(Kc,"ActivityAggregationParams",null,[]);class fd{constructor(b,h){this.Z3a=b;this.Dch=h}z6j(b,h=1){if(!b||!b.count)return b;const r=new Cb.a;var A=null;for(let L=0;L<b.count;L++){const ba=b.K(L);if(!ba)continue;const ra=ba.activityName;A?A.sCn(ba)?A.add(ba):(A=A.process(),
r.addRange(A),A=this.Dch(ra,h),A.add(ba)):(A=this.Dch(ra,h),A.add(ba))}A&&(b=A.process(),r.addRange(b));return r}ysp(b){if(!b||!b.count)return b;const h={};var r=null;for(let L=0;L<b.count;L++){const ba=b.K(L);if(ba){if(!r){r=new Cb.a;var A=this.Z3a.k7c(ba.activityName);for(const ra of A)r.add(ra)}A=this.LNm(ba,r);null!==A&&(A in h&&h[A]||(h[A]=new Cb.a),h[A].add(ba))}}b=new Cb.a;for(const L of sb.a.zT(h))r=this.z6j(h[L],2),b.addRange(r);return b}LNm(b,h){let r="";for(const A of h)r+=A,r=b.properties.Bb(A)&&
void 0!==b.properties.K(A)&&null!==b.properties.K(A)?r+b.properties.K(A):r+"null";return r}}Object(u.a)(fd,"ActivityAggregationSchemes",null,[788]);class jd{constructor(b,h,r,A,L){this.Su=this.Ci=0;this.C6b=r;this.WFc=A;this.Z3a=L;this.name=b;this.RE=h;this.ZJa=new Cb.a}get mode(){return this.RE}get count(){return this.ZJa.count}get startTime(){return this.Ci}get endTime(){return this.Su}get yni(){if(!this.count)return 0;let b=0;for(const h of this.ZJa)b+=h.endTime-h.startTime;return b/this.count}get q4l(){if(!this.count)return 0;
let b=0;const h=this.yni;for(const r of this.ZJa){const A=r.endTime-r.startTime;b+=(A-h)*(A-h)}return b/this.count}add(b){this.count?this.Su=b.endTime>this.endTime?b.endTime:this.endTime:(this.Ci=b.startTime,this.Su=b.endTime);this.ZJa.add(b)}sCn(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.C6b.rij}process(){if(this.count>=this.C6b.Ejj){const b=new Cb.a,h=this.WFc(this);b.add(h);return b}return this.ZJa}bQf(b){const h=new Cb.a;for(const r of this.ZJa)if(r.properties.Bb(b)){const A=r.properties.K(b);
h.add(A)}else h.add(null);return h}MQf(){const b=this.Z3a.k7c(this.name),h=new nc.a;for(const r of this.Gnm())b.contains(r)||h.add(r);return h}Gnm(){const b=new nc.a;if(!this.ZJa)return b;for(const h of this.ZJa)for(const r of h.properties.keys)b.add(r);return b}Gzm(){return this.ZJa.K(0).uniqueID}}Object(u.a)(jd,"ActivityCollection",null,[789]);class Id{constructor(){this.REb=new lb.a}get list(){return this.REb}add(b){const h=b.activityName;if(this.REb.Bb(h)&&this.REb.K(h)){const r=this.VCm(this.REb.K(h),
b);this.REb.K(h).insert(r,b)}else this.REb.W(h,new Cb.a),this.REb.K(h).add(b)}VCm(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.K(r).startTime)return r+1;return 0}}Object(u.a)(Id,"CompletedActivitiesHelper",null,[787]);class ce{constructor(){this.Z=null}get name(){return"Common.App.ActivityAggregator"}init(){y.AFrameworkApplication.IG(()=>{this.Z.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Ec(b){this.Z=b;const h=A=>new Rb(()=>b.Wa("Common.App.Activities.IActivityAggregationManager"),
A),r=(A,L)=>new jd(A,L,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Nc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().fe(()=>new Nc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.zf("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Kc,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().fe(()=>new Kc(y.AFrameworkApplication.J));b.register(zc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().fe(()=>new zc);b.register(fd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().fe(()=>new fd(b.resolve("Common.IActivityAggregationInfo"),
r));b.register(Id,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().fe(()=>new Id)}static main(){F.a.instance.Rc(new ce)}}Object(u.a)(ce,"ActivityAggregatorPackage",null,[0,1]);var Fe=e(725),Fd=e(10),Qb=e(1275);class ch{constructor(b){this.GFh=0;this.RPe=null;this.Nxc=()=>{v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(h=>{h.getChatsContainer(this.H2n)}).catch(h=>{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
h)}),this.chat.getChatsCounter().then(h=>{h.onChatsCountChange(this.zul)}).catch(h=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",h)}),this.chat.getKeyboard().then(h=>{h.onKeyDown(this.K2n)}).catch(h=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",h)}))}catch(h){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",h)}};this.zul=h=>{v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",h);if(!h)this.aFg.G2n();
else if(1===h&&!this.GFh){const r=document.getElementById(this.RPe?this.RPe:Qb.a.pOb);r?this.aFg.L2n(r,this.wvp):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.GFh=h};this.H2n=h=>{this.RPe=h};this.K2n=h=>{h.ctrlKey&&"f6"===h.key.toLowerCase()&&this.vvp(h.shiftKey)};this.wvp=()=>{v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(h=>{h.focusConversationInput()}).catch(h=>{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",
h)})}catch(h){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",h)}};this.tQk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get aFg(){return this.tQk.value}mc(){this.isInitialized?this.Nxc():this.ZCo(this.Nxc)}ZCo(b){Fe.a.instance.Cb(Fd.a.bop,window.self,()=>{b();return!0})}vvp(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.aFg.I2n(b)}}Object(u.a)(ch,"ChatManager",null,[697]);var Nf=e(92);class Mf{constructor(){this.sa=new Nf.a;
this.VWk=!1}q8k(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}X7k(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get mup(){return this.VWk}YDj(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(u.a)(Mf,"HeaderEventSource",null,[]);var Df=e(243),Ig=e(377),pg=e(101);class Rf{constructor(b,h,r,A,L){this.lSd=null;this.J2n=()=>{this.lSd&&this.lSd()};this.oc=b;this.hr=h;this.Rn=r;this.YWk=A;this.ga=L}BGj(b,h,r,A=null){const L=this.oc.te(h);
L.parent=r;L.LN=!0;A&&L.Eba(A);this.Rn.$Ja(h,b,!1);this.YWk.$Ja(h,b,!1);h=new Ig.DOMFocusListing(()=>b);h.jo(2);h.jo(1);h.jo(8);h.jo(5);h.jo(3);h.jo(6);this.oc.jta(()=>b,L,h).nR=!0;h=lc.KeyInputManager.xc(pg.a.iB,0);r=lc.KeyInputManager.xc(pg.a.iB,4);L.Pu(h);L.Pu(r)}onFlexPaneOpen(b){this.BGj(b,Qb.a.fuc,Qb.a.QYa);this.oc.Rg(Qb.a.fuc);this.hr.Dba(Qb.a.fuc)}onFlexPaneClose(){this.hr.wz(Qb.a.fuc);this.oc.Rg(Qb.a.QYa)}L2n(b,h){this.lSd||(this.lSd=h,this.BGj(b,Qb.a.pOb,Df.AFrame.UM,this.J2n));this.oc.Rg(Qb.a.pOb);
this.hr.Dba(Qb.a.pOb)}G2n(){this.hr.wz(Qb.a.pOb);this.oc.g4c(Df.AFrame.Co)}I2n(b){this.ga.Vb(b?wb.a.yFf:wb.a.O5d,2)}}Object(u.a)(Rf,"ReactSharedHeaderFocusManager",null,[694]);var qf=e(131),Mh=e(1061),ed=e(59),dd=e(98);class Vh{constructor(b){this.Ilj=(h,r,A,L,ba)=>{if(1===A)return 32;h=8;2===A&&(A=this.dLf(ba,"experience","gopremiumribbon"),ba=db.a.Jca("2116536"),ba=db.a.xq(ba,"ocid",Mh.b(y.AFrameworkApplication.ta.Pb.gl,y.AFrameworkApplication.ta.Pb.Uoa,A)),ed.a.Zm(ba,"_blank",void 0,"NavigateToUpsellPage"),
h=32,this.ga.Vb(wb.a.fLj,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return h};this.launchUpsellExperience=(h,r,A,L,ba)=>{if(1===A)return 32;var ra=8;2===A&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ra=Xa.a.instance.Wa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(h=this.dLf(ba,"experience","gopremium"),ba=this.dLf(ba,"dimeCampaignId",null),ra.launchUpsellExperience(h,ba),ra=32):(v.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),
ra=this.Ilj(h,r,A,L,ba)));return ra};this.ga=b}mc(){this.ga.qa(wb.a.S7d,dd.a.frame,this.Ilj);this.ga.qa(wb.a.Cwi,dd.a.frame,this.launchUpsellExperience);this.ga.qa(wb.a.sMo,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.fLj,dd.a.frame,qf.ActionManager.qg)}dLf(b,h,r){b&&b[h]&&(r=Object(ya.a)(String,b[h]));return r}}Object(u.a)(Vh,"UpsellActor",null,[693]);class Gf{constructor(){this.Z=null}get name(){return"Common.App.Header"}init(){Xa.a.instance.resolve("Common.App.Header.IUpsellActor").mc();Xa.a.instance.resolve("Common.App.Header.IChatManager").mc()}dispose(){}Ec(b){this.Z=
b;this.Z.register(Mf,"Common.App.Header.HeaderEventSource").ha();this.Z.register(Vh,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().fe(()=>new Vh(y.AFrameworkApplication.va));this.Z.register(Rf,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().fe(()=>new Rf(y.AFrameworkApplication.ta.yr,y.AFrameworkApplication.ta.BA,y.AFrameworkApplication.ta.J$,y.AFrameworkApplication.ta.dGe,y.AFrameworkApplication.va));this.Z.register(ch,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().fe(()=>new ch(this.Z.zf("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){F.a.instance.Rc(new Gf)}}Object(u.a)(Gf,"CommonAppHeaderPackage",null,[0,1]);var Td=e(782);class Xc{static Eyi(b,h){switch(b){case 3:return Xc.xYm(h);case 2:return Xc.fKm(h);case 1:return Xc.iym(h)}return""}static xYm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static fKm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static iym(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static KZ(b,h,r){if(X.a.Yi||X.a.gK)window.setTimeout(()=>{Xc.MFj(r,Xc.hce())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Xc.mXh(r),b,0,!1)}static fzl(b,h,r,A){h&&A&&A();
Xc.KZ(b,h,r)}static hce(){return X.a.Yi?1:X.a.gK?2:X.a.hdb?3:X.a.fm?4:0}static cYm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static dYm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get F2f(){return"zh-CN"===window.navigator.language}static MFj(b,h){1===h?(v.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Xc.Eyi(b,h),8<X.a.Lbb?ed.a.Zm(b,void 0,void 0,"RedirectToAppStore"):ed.a.wsb(b)):document.hidden||(Xc.F2f?(b=y.AFrameworkApplication.J.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),ed.a.wsb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Xc.Eyi(b,
h),null,null)))}static mXh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get OCe(){return(X.a.hdb||X.a.fm)&&X.a.zt}static get Mbp(){return X.a.Yi||X.a.gK}static Yyi(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static k4i(b){return(b=Xc.ODm(b))&&""!==b?Boolean.parse(b):!1}static vEg(b){Xc.b2o(b)}static ODm(b){try{return localStorage.getItem(b)}catch(h){return v.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static b2o(b){try{localStorage.setItem(b,"true")}catch(h){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}Xc.Z6h="ChromeExtensionBarDismiss";Object(u.a)(Xc,"WildFireUtilities",null,[]);var de=e(373);class ze{constructor(){this.NNe=new de.a;this.LNe=new de.a;this.KNe=new de.a;this.bml(this.NNe);this.aml(this.LNe);this.$ll(this.KNe);this.fYe=new de.a;
this.eYe=new de.a;this.dYe=new de.a;this.Iol(this.fYe);this.Hol(this.eYe);this.Gol(this.dYe);this.jQe=new de.a;this.nml(this.jQe);this.EMb(this.jQe);this.EMb(this.KNe);this.EMb(this.LNe);this.EMb(this.NNe);this.EMb(this.eYe);this.EMb(this.fYe);this.EMb(this.dYe)}wbe(b,h){switch(b){case 1:return this.nZm(h);case 2:return this.dom(h)}return Xc.OCe?this.jQe:null}bml(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}aml(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}$ll(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Iol(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}nml(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Hol(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Gol(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}EMb(b){b.add("Corporation","Microsoft Corporation")}nZm(b){switch(b){case 3:return this.fYe;case 2:return this.eYe;case 1:return this.dYe}return null}dom(b){switch(b){case 3:return this.NNe;case 2:return this.LNe;case 1:return this.KNe}return null}static get instance(){ze._instance||
(ze._instance=new ze);return ze._instance}}ze._instance=null;Object(u.a)(ze,"WildFireStringFactory",null,[]);class jf{constructor(b,h,r,A,L=null,ba=null){this.L5e=null;this._id=b;this.m7e=h;this.DDk=L;this.oMc=A;this.QRc=ba;this.Uib=null;this.nUc=r;this.eTc=ze.instance.wbe(h,b)}kKl(){this.Uib=new Td.a(this.title,this.message,null);this.Uib.addButton(this.Yol,Object(E.a)(this,this.n2n,"onButtonOneClick"),"");this.nUc&&this.Uib.JTh(this.dpl,Object(E.a)(this,this.s2n,"onButtonTwoClick"));this.Uib.rma=
Object(E.a)(this,this.g0l,"dismissBar");this.Uib.image=3;this.Uib.id=16;this.Uib.closeable=!0}get title(){return this.eTc.K("Headline")}get message(){return this.eTc.K("CallToAction")}get Yol(){return this.nUc?this.eTc.K("InstallButton"):this.eTc.K("UseAppButton")}get dpl(){return this.nUc?this.eTc.K("OpenAppButton"):""}n2n(){this.nUc?this.Qin():this.gKp()}s2n(){this.nUc&&this.Obo()}get r2h(){return this.Uib}get Bwa(){this.L5e||(this.L5e=this.DDk());return this.L5e}Qin(){v.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.oMc&&this.QRc&&this.QRc();Xc.MFj(this._id,this.m7e)}Obo(){this.Bwa&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.oMc&&this.QRc&&this.QRc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Xc.mXh(this._id),this.Bwa,0,!1))}gKp(){Xc.OCe?this.Uol():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Xc.vEg("BizBarClicked"),1!==this.m7e&&2!==this.m7e||Xc.fzl(this.Bwa,this.oMc,this._id,this.QRc))}Uol(){this.oMc?
v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");ed.a.wsb(y.AFrameworkApplication.J.appSettings.WildFireChromeExtensionUrl.toString())}h0l(){this.oMc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Xc.vEg(Xc.Z6h)}g0l(){Xc.OCe?this.h0l():(Xc.vEg(Xc.Yyi(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static uxf(){const b=y.AFrameworkApplication.ta.Pb;
new jf(b.gl,Xc.hce(),8<X.a.Lbb,1===b.Uoa,()=>b.EY,b.Zzg());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(u.a)(jf,"WildFireBusinessBar",null,[]);class hc{get name(){return"Common.App.WildFire"}Ahf(b){const h=y.AFrameworkApplication.ta.Pb;let r=!1;b&&(b.kKl(),b.r2h&&(r=h.dBa(b.r2h,!0)));return r}sKl(){var b=y.AFrameworkApplication.ta.Pb;b=new jf(b.gl,Xc.hce(),!1,1===b.Uoa);this.Ahf(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}uxf(b,h,r,A,L,ba){b=new jf(b,
r,A,h,L,ba);this.Ahf(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}QRl(){const b=y.AFrameworkApplication.ta.Pb;var h=y.AFrameworkApplication.J;const r=b.gl,A=1===b.Uoa;if(h.$(Xc.cYm(r))){var L=Xc.hce(),ba=8<X.a.Lbb;if(2!==r||2!==L||!A){h=h.$(Xc.dYm(r));var ra=b.Zzg(),Ia=()=>b.EY;h&&!Xc.k4i(Xc.Yyi(r))&&this.uxf(r,A,L,ba,Ia,ra)}}}init(){var b=y.AFrameworkApplication.J;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;Xc.OCe&&b&&!Xc.k4i(Xc.Z6h)?this.sKl():
(document.body&&Xc.Mbp&&this.QRl(),y.AFrameworkApplication.va.qa(wb.a.Z6f,dd.a.frame,Object(E.a)(this,this.Z6f,"launchWildFireBusinessBar")))}Z6f(b,h,r,A,L){if(1===r)return 32;if(!L)return 8;this.uxf(L.app,L.mode,L.platform,L.useTwoButton,null,null);return 32}dispose(){}Ec(){}static main(){F.a.instance.Rc(new hc)}}Object(u.a)(hc,"PackageManager",null,[0,1]);class wc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(wc,"BrowserInfo",null,[]);class Pc{constructor(){this.Version=
this.Name=null}}Object(u.a)(Pc,"PluginInfo",null,[]);class md{static H9(){if(y.AFrameworkApplication.J.$("LogBrowserInfoIsEnabled")){var b=md.Fkm();try{const h=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,h)}catch(h){v.ULS.sendTraceTag(6903564,102,15,h.message)}}else v.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static getPlugins(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const A=b[r].name,L=b[r].version;
Array.add(h,Object.assign(new Pc,{Name:A,Version:L}))}return h}static Fkm(){const b=new wc,h=new Sys.StringBuilder;md.KL(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);md.KL(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);md.KL(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);md.KL(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);md.KL(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);md.KL(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);md.KL(r=>{b.ScreenWidth=r},()=>window.screen.width,h);md.KL(r=>{b.ScreenHeight=r},()=>window.screen.height,h);md.KL(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);md.KL(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);md.KL(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);md.KL(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);md.KL(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);md.KL(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);md.KL(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);md.KL(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);md.KL(r=>{b.WinOrientation=r},()=>window.self.orientation,h);md.KL(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);md.KL(r=>{b.SupportsTouch=r},()=>X.a.eud,h);md.KL(r=>{b.NavAppName=r},()=>window.navigator.appName,h);md.KL(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);md.KL(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);md.KL(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);md.KL(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);md.KL(r=>{b.NavPlugins=r},md.getPlugins,h);md.KL(r=>{b.CalculatedDevicePixelRatio=r},()=>md.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static KL(b,h,r){try{const A=h();b(A)}catch(A){r.isEmpty()||r.append(" | "),r.append(A.message||
"null")}}}Object(u.a)(md,"BrowserInfoLogger",null,[]);class fe{get name(){return"Common.App.BrowserInfoLogger"}Ec(){}init(){md.H9()}dispose(){}static main(){F.a.instance.Rc(new fe)}}Object(u.a)(fe,"BrowserInfoLoggerPackage",null,[0,1]);class se{constructor(){this.sa=new Nf.a}TMb(b){this.sa.addHandler("OnEditHappenedEvent",b)}Pxe(b){this.sa.removeHandler("OnEditHappenedEvent",b)}iuo(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(u.a)(se,"EditNotificationEventSource",null,[]);var $d=e(46),Md=e(96);
class Ub{constructor(b,h,r,A,L,ba,ra=0){this.eUe=!1;this.dUe=this.RIb=null;this.nPh=!1;this.Iqd=()=>{this.eUe&&(this.$kb.CWR(()=>this.$kb.result.sendMessage(J.a.N4l,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.eUe=!1)};this.mMo=()=>{try{this.MFd&&($d.c(wb.a.rCf),this.MFd=!1)}catch(Ia){this.MFd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+Ia)}};this.Sb=h;this.$Kd=b;this.$kb=
r;this.Bka=A;this.lPh=L;this.eAk=ba;this.EDd=0;this.MFd=!1;try{0<ra&&(this.EDd=ra,3E5>this.EDd&&(this.EDd=3E5),this.Sb&&!this.dUe&&(this.dUe=new Md.a(3,2,this.EDd,this.mMo),this.Sb.pc(this.dUe)))}catch(Ia){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ia)}}get nJe(){return this.nPh}editHappened(){this.nJe?this.MFd=!0:(this.nPh=!0,Ca.Health.instance.addQosPillar("Save"),Ca.Health.instance.addQosPillar("ContentCreation"),
$d.c(wb.a.rCf));this.eUe=!0;this.lPh&&this.lPh.GRh();this.Bka&&this.Bka.iuo();y.AFrameworkApplication.Kg&&y.AFrameworkApplication.Kg.KQn();this.eAk&&!this.RIb&&(this.Iqd(null),this.RIb=new Md.a(3,2,this.$Kd,this.Iqd,113),this.Sb.pc(this.RIb))}}Object(u.a)(Ub,"EditNotificationManager",null,[699]);class Vc{constructor(b,h,r,A,L){this.dXe=this.RIb=null;this.Q9b=this.aNe=!1;this.HGj=()=>{const ba=document.getElementById(y.AFrameworkApplication.fWc);!this.Q9b&&this.Rn&&ba&&(this.Rn.Cb(Fd.a.C5,ba,this.jcg,
null),this.Q9b=!0);this.e5e(()=>{this.dispose()})};this.jcg=()=>{this.Q9b&&(this.Rn.Gc(Fd.a.C5,document.getElementById(y.AFrameworkApplication.fWc),this.jcg),this.Q9b=!1);this.GRh();return!1};this.Iqd=()=>{this.aNe&&(this.$kb.CWR(()=>this.$kb.result.sendMessage(J.a.DKp,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.aNe=!1)};this.Sb=h;this.$Kd=b;this.$kb=r;this.Rn=A;this.e5e=L;this.HGj(null)}GRh(){this.aNe=!0;this.dXe||(this.dXe=
new Md.a(3,2,this.$Kd,this.HGj,112),this.Sb.pc(this.dXe));this.RIb||(this.Iqd(null),this.RIb=new Md.a(3,2,this.$Kd,this.Iqd,111),this.Sb.pc(this.RIb))}dispose(){this.Q9b&&(this.Rn.Gc(Fd.a.C5,document.getElementById(y.AFrameworkApplication.fWc),this.jcg),this.Q9b=!1)}}Object(u.a)(Vc,"UserActivityHostNotificationManager",null,[698,11]);var qd=e(212),vb=e(115),Kb=e(554);class Ic{constructor(){this.Z=null;this.Gz=()=>{Ic.O4l&&0<Ic.uCf&&(this.Z.register(se,"Common.App.HostNotification.EditNotificationEventSource").ha(),
this.Z.register(Vc,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().fe(()=>new Vc(6E4,vb.TaskManager.instance,Kb.a.xr(this.Z.Za("Postmessage.IHostPostmessenger")),qd.a.instance,y.AFrameworkApplication.IG)),this.Z.register(Ub,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().fe(()=>new Ub(Ic.uCf,vb.TaskManager.instance,Kb.a.xr(this.Z.Za("Postmessage.IHostPostmessenger")),
this.Z.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Z.Wa("Common.Interface.IUserActivityHostNotificationManager"),Ic.P4l,Ic.G4l)),this.Z.resolve("Common.Interface.IEditNotificationManager"),v.ULS.shipAssertTag(38086291,209,0<Ic.uCf,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.lq(this.Gz)}Ec(b){this.Z=b}dispose(){}static get uCf(){return y.AFrameworkApplication.J?
parseInt(y.AFrameworkApplication.J.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get G4l(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get O4l(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationIsEnabled")}static get P4l(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationPostMessageIsEnabled")}static main(){F.a.instance.Rc(new Ic)}}
Object(u.a)(Ic,"CommonHostNotificationPackage",null,[0,1]);class kd{constructor(b,h,r){this.YKb=null;this.YCe=()=>{this.YKb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Onh.display()};this.jep=(A,L,ba,ra,Ia)=>A!==wb.a.YCe?2:1===ba?32:2===ba&&Ia?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Ia),Ia?this.Hzb():(this.YKb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Sb.Kf(this.YKb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Onh.remove(null)),this.YKb=null),32):8;this.Sb=b;this.ga=h;this.Onh=r.create()}Hzb(){this.YKb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.YKb=new Md.a(2,1,3E4,this.YCe,67),this.Sb.pc(this.YKb))}p1a(){this.ga.qa(wb.a.YCe,dd.a.frame,this.jep)}}Object(u.a)(kd,"FloatPaneActor",null,
[696]);var Wd=e(104),Ye=e(105),Re=e(37),le=e(204);class Bh{constructor(b,h,r,A,L){this.K2e=this.mLc=this.VNd=this.X6a=this.hla=this.m4a=this.bPe=this.Ffa=this.$Pc=this.HNc=this.INc=this.NVe=null;this.P6n=()=>{const ba=this.za.sc("O365AdPaneShowingDuration",60);this.Jdi();this.Ffa.style.display="block";this.Ffa.style.height=this.hla.height+"px";this.mLc=new Md.a(2,1,1E3*ba,Object(E.a)(this,this.hide,"hide"),67);this.Sb.pc(this.mLc);this.pIj()};this.O6n=()=>{v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.pIj();this.hla=null};this.Qsj=()=>{v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.mLc&&this.Sb.Kf(this.mLc);this.hide();return!0};this.Sb=h;this.za=b;this.xh=r;this.Z=L;this.uHa=A}Jdi(){this.Ffa=document.createElement("div");this.Ffa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.Ffa.style.width=this.hla.width+"px";(this.K2e=this.VIm(this.uHa))?(this.X6a=document.createElement("a"),
this.X6a.setAttribute(le.a.fi,le.a.NA),this.xh.Cb(Fd.a.click,this.X6a,this.Qsj),this.X6a.href=this.K2e,this.X6a.target="_blank",this.X6a.appendChild(this.hla),this.Ffa.appendChild(this.X6a)):this.Ffa.appendChild(this.hla);this.m4a=document.createElement("a");this.m4a.setAttribute(le.a.fi,le.a.i4);this.m4a.className="StandardButton WACFloatPaneCloseButton";this.m4a.title=CommonUIStrings.l_Close;this.m4a.tabIndex=-1;this.bPe=Ye.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.bPe.setAttribute(le.a.fi,le.a.NA);this.m4a.appendChild(this.bPe);this.xh.Cb(Fd.a.click,this.m4a,this.onClose);this.Ffa.appendChild(this.m4a);this.$Pc.appendChild(this.Ffa)}ICm(b){const h=this.za.$("O365PromotionHasStarted");switch(b){case 2:return Wd.a.Bga(String.format("adppt{0}.png",h?"sale":""));case 1:return Wd.a.Bga(String.format("adxls{0}.png",h?"sale":""));case 3:return Wd.a.Bga(String.format("addoc{0}.png",h?"sale":""))}return null}VIm(b){const h=this.za.rb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.mLc=null;this.Ffa&&!this.VNd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.Ffa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Ffa.style.height="0px",this.VNd=new Md.a(2,1,1E3,Object(E.a)(this,
this.remove,"remove"),67),this.Sb.pc(this.VNd))}remove(){this.Ffa&&this.$Pc&&(this.X6a&&this.xh.Gc(Fd.a.click,this.X6a,this.Qsj),this.xh.Gc(Fd.a.click,this.m4a,this.onClose),this.$Pc.removeChild(this.Ffa),this.Ffa=null);this.VNd=null}display(){if(this.NVe=this.Z.Wa("Common.IFloatPaneContainer"))if(this.$Pc=this.NVe.container){var b=this.ICm(this.uHa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.hla=document.createElement("img"),this.hla.className="WACFloatPaneImage",
this.INc=this.P6n,Re.a.addHandler(this.hla,Fd.a.load,this.INc),this.HNc=this.O6n,Re.a.addHandler(this.hla,Fd.a.error,this.HNc),this.hla.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}pIj(){this.INc&&this.hla&&Re.a.removeHandler(this.hla,
Fd.a.load,this.INc);this.INc=null;this.HNc&&this.hla&&Re.a.removeHandler(this.hla,Fd.a.error,this.HNc);this.HNc=null}dispose(){this.hide()}}Object(u.a)(Bh,"FloatPane",null,[718]);class gf{constructor(b,h,r,A,L){this.Sb=h;this.za=b;this.xh=r;this.Z=L;this.uHa=A}create(){return new Bh(this.za,this.Sb,this.xh,this.uHa,this.Z)}}Object(u.a)(gf,"FloatPaneFactory",null,[695]);var Wf=e(307);class $i{constructor(){this.Z=null}get name(){return"Common.App.FloatPane"}get x2i(){return y.AFrameworkApplication.J.$("O365AdvertisementIsEnabled")&&
y.AFrameworkApplication.J.$("IsShowAdvertisementPaneEnabled")}init(){this.x2i&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").Hzb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Z.resolve("Common.App.FloatPane.IFloatPaneActor").p1a())}Ec(b){this.Z=b;this.x2i&&(this.Z.register(gf,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").fe(()=>new gf(y.AFrameworkApplication.J,
y.AFrameworkApplication.zc,Wf.a.instance,y.AFrameworkApplication.ta.Pb.gl,this.Z)).ha(),this.Z.register(kd,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").fe(()=>new kd(y.AFrameworkApplication.zc,y.AFrameworkApplication.va,this.Z.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){F.a.instance.Rc(new $i)}}Object(u.a)($i,"FloatPanePackage",null,[0,1]);var wf=e(1637);class Hf{}Object(u.a)(Hf,"LokiTokenResult",null,[]);class vf{constructor(b){this.gLd=
b}FOf(){const b=this.UFm();return b?vf.Qcb?new Promise((h,r)=>{this.gLd.continueWith(()=>{this.gLd.mq||this.gLd.wj?r(Error.create("Error downloading auth library")):this.gLd.result.kX("Loki",b).then(A=>{A=y.AFrameworkApplication.J.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.XFm():A.IsSuccess&&A.Token?Object.assign(new Hf,{isSuccess:!0,token:A.Token,errorMessage:null}):Object.assign(new Hf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(A)});h(A);return A})})}):Promise.resolve(Object.assign(new Hf,
{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Hf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",wf.a.Myi())}))}XFm(){const b=y.AFrameworkApplication.J.rb("LokiUserDataSignature")||"";return Object.assign(new Hf,{isSuccess:!0,token:b,errorMessage:null})}UFm(){let b=null;const h=wf.a.p8d();2===h?b=y.AFrameworkApplication.J.rb("LokiAADAppId"):1===
h&&(b=y.AFrameworkApplication.J.rb("LokiMSAAppId"));return b}static get Qcb(){return y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")}}Object(u.a)(vf,"LokiTokenManager",null,[692]);class Ui{get name(){return"Common.App.LivePersonaUtils"}init(){Xa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Ec(b){b.register(vf,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().fe(()=>new vf(Kb.a.xr(b.Za("Common.App.OAuth.IOAuthManager"))))}static main(){F.a.instance.Rc(new Ui)}}
Object(u.a)(Ui,"LivePersonaUtilsPackage",null,[0,1]);class rf{constructor(b){this.GNe=b}B1i(b){if(!this.GNe)return!0;b=db.a.CNf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.GNe.length;h++)if(b.endsWith(this.GNe[h]))return!0;return!1}}Object(u.a)(rf,"DomainAllowListManager",null,[]);class ug{constructor(b,h){this.syf=null;this.Ldf=b;this.url=h}get FQg(){return db.a.Zda(this.url)}get Ou(){return this.Ldf}xMg(){const b={},h=this.Ou;b.a=this.FQg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);
b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);
b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.syf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(u.a)(ug,"PerformanceTimingEntry",null,[]);const Eg=(b,h)=>{var r,A;const L={};let ba=null;switch(b){case 0:ba="ResourceTiming";b=h.a;null!=b&&(L.Url=b);b=h.b;null!=b&&(L.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(L.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(L.RedirectEnd=
b);b=null==h.e?null:h.e.toString();null!=b&&(L.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(L.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(L.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(L.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(L.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(L.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(L.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(L.ResponseStart=b);b=null==
h.m?null:h.m.toString();null!=b&&(L.ResponseEnd=b);b=h.n;null!=b&&(L.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(L.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(L.EncodedBodySize=b);b=null==h.q?null:h.q.toString();null!=b&&(L.TransferSize=b);h=null!==(A=null===(r=h.r)||void 0===r?void 0:r.toString())&&void 0!==A?A:null;null!=h&&(L.responseStatus=h);break;case 1:ba="PerformanceTiming",r=h.a,null!=r&&(L.Url=r),r=null==h.b?null:h.b.toString(),null!=r&&(L.NavigationStart=r),
r=null==h.c?null:h.c.toString(),null!=r&&(L.UnloadEventStart=r),r=null==h.d?null:h.d.toString(),null!=r&&(L.UnloadEventEnd=r),r=null==h.e?null:h.e.toString(),null!=r&&(L.RedirectStart=r),r=null==h.f?null:h.f.toString(),null!=r&&(L.RedirectEnd=r),r=null==h.g?null:h.g.toString(),null!=r&&(L.FetchStart=r),r=null==h.h?null:h.h.toString(),null!=r&&(L.DomainLookupStart=r),r=null==h.i?null:h.i.toString(),null!=r&&(L.DomainLookupEnd=r),r=null==h.j?null:h.j.toString(),null!=r&&(L.ConnectStart=r),r=null==h.k?
null:h.k.toString(),null!=r&&(L.ConnectEnd=r),r=null==h.l?null:h.l.toString(),null!=r&&(L.SecureConnectionStart=r),r=null==h.m?null:h.m.toString(),null!=r&&(L.RequestStart=r),r=null==h.n?null:h.n.toString(),null!=r&&(L.ResponseStart=r),r=null==h.o?null:h.o.toString(),null!=r&&(L.ResponseEnd=r),r=null==h.p?null:h.p.toString(),null!=r&&(L.DomLoading=r),r=null==h.q?null:h.q.toString(),null!=r&&(L.DomInteractive=r),r=null==h.r?null:h.r.toString(),null!=r&&(L.DomContentLoadedEventStart=r),r=null==h.s?
null:h.s.toString(),null!=r&&(L.DomContentLoadedEventEnd=r),r=null==h.t?null:h.t.toString(),null!=r&&(L.DomComplete=r),r=null==h.u?null:h.u.toString(),null!=r&&(L.LoadEventStart=r),r=null==h.v?null:h.v.toString(),null!=r&&(L.LoadEventEnd=r),h=h.w,null!=h&&(L.CustomText=h)}L.Table=ba;return Sys.Serialization.JavaScriptSerializer.serialize(L)};var th=e(40),ei=e(162),Yj=e(183);class Zk{constructor(b,h=null,r=null){this.an=b;this.EQg=this;this.LCk=h||(()=>window.location.href);this.MTe=new rf(r)}run(){if(Zk.SNb(window.performance))try{const L=
this.LCk();if(Zk.hXk.exec(L)&&this.MTe.B1i(L)){var b=new ug(window.performance.timing,L);Yj.a.instance.Uwo(b.Ou.fetchStart);Yj.a.instance.Vwo(b.Ou.navigationStart);Yj.a.instance.q2(th.a.Ojm,"connectStart","requestStart");Yj.a.instance.q2(th.a.Xjm,"requestStart","responseStart");Yj.a.instance.q2(th.a.$jm,"responseStart","responseEnd");this.EQg.Bdb(1,b.xMg());this.an.Gf(th.a.uMa,b.Ou.fetchStart);this.an.Gf(th.a.Ujm,b.Ou.domainLookupStart);this.an.Gf(th.a.Tjm,b.Ou.domainLookupEnd);this.an.Gf(th.a.Qjm,
b.Ou.connectStart);this.an.Gf(th.a.bkm,b.Ou.secureConnectionStart);this.an.Gf(th.a.Pjm,b.Ou.connectEnd);this.an.Gf(th.a.Yjm,b.Ou.requestStart);this.an.Gf(th.a.slc,b.Ou.responseStart);this.an.Gf(th.a.Vjm,b.Ou.responseEnd-b.Ou.responseStart);this.an.Gf(th.a.Zjm,b.Ou.responseStart-b.Ou.requestStart);var h=0,r=0,A=0;({transferSize:h,pDf:r,Pyf:A}=this.jyp(L)).returnValue&&(this.an.Gf(th.a.dkm,h),this.an.Gf(th.a.Rjm,A),this.an.Gf(th.a.Wjm,r));this.an.Gf(th.a.m4c,b.Ou.navigationStart)}}catch(L){v.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",L)}}jyp(b){let h,r,A;A=r=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,pDf:r,Pyf:A};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,pDf:r,Pyf:A};b=b[0];var L=b.transferSize;void 0!==h&&null!==h&&(h=L);L=b.decodedBodySize;void 0!==L&&null!==L&&(A=L);b=b.encodedBodySize;void 0!==
b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,pDf:r,Pyf:A}}Bdb(b,h){v.ULS.sendTraceTag(4551815,306,50,Eg(b,h))}static get instance(){return Zk._instance||(Zk._instance=new Zk(ei.a.instance,null,y.AFrameworkApplication.J.$("PerfTimingLoggerFilterDomainsIsEnabled")?y.AFrameworkApplication.J.kF("ResourceLoggerDomainAllowList"):null))}static SNb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Zk._instance=null;Zk.hXk=RegExp("^https?://.*","i");Object(u.a)(Zk,"PerformanceTimingLogger",
null,[691]);class yg{constructor(b,h){this.syf=null;this.Ldf=b;this.behavior=h;this.url=this.Ou.name}get FQg(){return 2===this.behavior?this.url:db.a.Zda(this.url)}get Ou(){return this.Ldf}xMg(){const b={},h=this.Ou;b.a=this.FQg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&
null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(yg.ibb(h,"decodedBodySize"));b.p=this.round(yg.ibb(h,"encodedBodySize"));b.q=this.round(yg.ibb(h,"transferSize"));b.n=this.syf;b.r=yg.ibb(h,"responseStatus")||0;return b}round(b){return Math.round(1E3*b)/1E3}static ibb(b,h){return b[h]}}Object(u.a)(yg,"ResourceTimingEntry",null,[717]);class Kk{constructor(b,h=null,r=100){this.xdh=
b;this.CQd=h;this.Rib={};this.Lvk=r;this.Tch=y.AFrameworkApplication&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}Mwp(b){var h=b.name.toLowerCase();const r=db.a.Gtb(h);this.DMj(r,h)&&(r in this.Rib?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.F8i(b),h.encodedsize=yg.ibb(b,"encodedBodySize"),h.decodedsize=
yg.ibb(b,"decodedBodySize"),this.Rib[r]=h))}Nwp(b){var h=b.name.toLowerCase();const r=db.a.Gtb(h);this.VOo(r,h)&&(r in this.Rib?v.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.F8i(b),h.encodedsize=yg.ibb(b,"encodedBodySize"),h.decodedsize=yg.ibb(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,
h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.Rib[r]=h))}DMj(b,h){if(this.xdh)return Array.contains(this.xdh,b);if(this.CQd)for(b=db.a.dW(h),h=0;h<this.CQd.length;h++)if(this.CQd[h]&&b.endsWith(this.CQd[h]))return!0;return!1}VOo(b,h){return this.DMj(b,h)?b.endsWith(".js")||b.endsWith(".css"):!1}F8i(b){try{const h=yg.ibb(b,"transferSize");if(void 0!==h&&null!==h)return!h;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return b.responseEnd-b.fetchStart<this.Lvk}catch(h){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}szo(){if(sb.a.jg(this.Rib))v.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=y.AFrameworkApplication.flightId?y.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new Sa.a,{extendedProperties:ub.a.HI()});h.extendedProperties.set("Flights",
H.c(b));this.cfj(h,this.Rib,Ca.Health.instance)}}NJf(b){let h=0,r=0,A=0,L=0,ba=0;const ra=this.Rib;for(const ob in ra){var Ia=ob,Ta=ra[ob];Ia.endsWith(".js")&&(Ta=Object(ya.a)(Object,Ta),Ta.responseend<b&&(h+=1,r+=Ta.decodedsize,L+=Ta.encodedsize,A+=Ta.iscached?0:Ta.encodedsize,Ia=Ia.toLowerCase(),this.Tch&&(y.AFrameworkApplication.J.rb("Slice1Name").toLowerCase().endsWith(Ia)?ba|=1:Ia.endsWith(".common.js")||Ia.endsWith(".othercommon.js")||Ia.endsWith(".ext.js")?ba|=2:Ia.endsWith("common50.min.js")&&
(ba|=4))))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=A;b.encodedBytes=L;this.Tch&&(b.lazyChunksLoaded=ba);return b}cfj(b,h,r){if(h){var A=0,L=0,ba=0,ra=0,Ia=0,Ta=0,ob=0,nb=0,Eb=0,bc=0,Bc=0;for(const zd in h){var Yc=h[zd];try{const Jd=Object(ya.a)(Object,Yc);if(!Jd)continue;const ie=Jd.iscached?Boolean.parse(Jd.iscached.toString()):!1,re=Jd.fetchstart?this.parseFloat(Jd.fetchstart.toString()):0,me=(Jd.responseend?this.parseFloat(Jd.responseend.toString()):0)-re,Sd=Jd.encodedsize?this.parseFloat(Jd.encodedsize.toString()):
0,cf=Jd.decodedsize?this.parseFloat(Jd.decodedsize.toString()):0;A+=me;ra+=Sd;ob+=cf;bc++;ie?(ba+=me,Ta+=Sd,Eb+=cf,Bc++):(L+=me,Ia+=Sd,nb+=cf)}catch(Jd){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Jd.message)}}b.extendedProperties.set("StaticResources",H.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",A.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",L.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",
ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ia.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Ta.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",ob.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",nb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Eb.toString());
b.extendedProperties.set("TotalNumberOfResourcesDownloaded",bc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Bc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(u.a)(Kk,"AppStaticResourceManager",null,[]);class Jh extends Sys.EventArgs{constructor(b){super();this.entries=
b}}Object(u.a)(Jh,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class zf{constructor(b,h,r=null,A=null,L=100,ba=!1){this.R0e=!1;this.wq=null;this.nIc=0;this.sa=new Nf.a;this.iEb=null;this.G3=!1;this.wNh=0;this.Sb=b;this.pjh=0;this.EQg=this;this.MTe=new rf(r);this.EO=h;A&&(this.iEb=new Kk(null,A,L));this.Ysk=ba}get x1h(){try{return!(void 0===this.EO||null===this.EO)&&!(void 0===this.EO.getEntriesByType||null===this.EO.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
b),!1}}get lUl(){return this.pjh}get isActive(){return this.G3}get pMg(){return this.wNh}uUh(b){this.sa.addHandler(zf.mEf,b)}vJj(b){this.sa.removeHandler(zf.mEf,b)}Ec(b,h){const r=this.pMg!==b;this.wNh=b;this.isActive&&this.Sb&&r&&(this.Kf(),this.pc());this.pjh=h}activate(){!this.isActive&&this.x1h&&(this.pc(),this.G3=!0)}deactivate(b){this.isActive&&(this.Kf(),b&&this.flush(),this.G3=!1)}flush(){if(this.isActive&&this.x1h)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.nIc&&
v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.nIc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.nIc=0);const r=[];for(let A=this.nIc;A<b.length;A++)this.MTe.B1i(b[A].name)&&(this.iEb&&(this.Ysk?this.iEb.Nwp(b[A]):this.iEb.Mwp(b[A])),r.push(new yg(b[A],this.lUl)));h||(this.nIc=b.length);this.sa.raiseEvent(zf.mEf,
new Jh(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.EQg.Bdb(0,r[b].xMg());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(h){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}Bdb(b,h){v.ULS.sendTraceTag(4310804,306,50,Eg(b,h))}Pwo(){this.iEb.szo()}NJf(b){return this.iEb.NJf(b)}pc(){this.Sb&&0<this.pMg&&(this.wq=new Md.a(3,2,1E3*this.pMg,
()=>{this.flush()},5),this.Sb.pc(this.wq),this.R0e=!0)}Kf(){this.R0e&&(this.Sb.Kf(this.wq),this.wq=null,this.R0e=!1)}}zf.mEf="EntriesAvailable";Object(u.a)(zf,"ResourceTimingLogger",null,[674,691]);class cg{constructor(){this.Z=null}get name(){return"Common.ResourceTiming"}init(){this.Z.resolve("Common.NetworkTiming.IResourceTimingLogger");Zk.instance.run()}dispose(){}Ec(b){this.Z=b;let h=null;if(y.AFrameworkApplication.J.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=y.AFrameworkApplication.J.kF("ResourceLoggerDomainAllowList")}catch(ba){v.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push(db.a.dW(Wd.a.o6).toLowerCase());r.push(db.a.dW(Wd.a.fsd).toLowerCase());const A=y.AFrameworkApplication.J.sc("AppStaticResourceMonitorCacheThresholdInMs",100),L=y.AFrameworkApplication.J.$("PPTAggregateResourceTimingV2Enabled");b.register(674,"Common.NetworkTiming.IResourceTimingLogger").ha().fe(()=>new zf(y.AFrameworkApplication.zc,window.performance,h,r,A,L))}static main(){F.a.instance.Rc(new cg)}}Object(u.a)(cg,
"ResourceTimingPackage",null,[0,1]);var xe=e(277);class wi{constructor(){this.XMe={}}r_k(b){this.XMe[b.id.toString()]=b}RZn(b){const h=this.XMe;for(const r in h)h[r].notify(b,!1);this.XMe={}}Uro(b,h){h&&this.r_k(h);return this.ftj(b,h)}$Cf(b){this.RZn(b)}ooi(b,h){b.notify(h,!0)}}Object(u.a)(wi,"AEventEmitter",null,[690]);var ig;(function(b){b[b.bgg=0]="notStarted";b[b.waiting=1]="waiting";b[b.ECe=2]="shouldRetry";b[b.complete=3]="complete"})(ig||(ig={}));Object(u.b)("EventResultState",ig);class Qi{constructor(){this._state=
0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:ig[this._state],["NewState"]:ig[b]},"ResultType",this.UKi());this._state=b}}Object(u.a)(Qi,"AEventResult",null,[702]);class el extends Qi{constructor(){super();this.ccf=this.sQc=null;this.state=0;this.qZe=this.Bsh=!1}get Mia(){return this.sQc}get ghb(){return this.ccf}get Yin(){return this.Bsh}UKi(){return"GetMoreInfo Result"}}Object(u.a)(el,"GetMoreInfoResult",Qi,[733,
702]);var mj=e(1259),Uf=e(1488),hh=e(1062);class Jj{constructor(b,h,r,A,L,ba,ra,Ia){this.DZb=(Ta,ob,nb,Eb,bc)=>{bc&&bc.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:bc.SourceControlId,["AppType"]:hh.a[this.via]}),ed.a.Zm(bc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.Flg=(Ta,ob,nb,Eb,bc)=>{if(bc&&bc.MenuItemId){const Bc=y.AFrameworkApplication.J.$("WacInTabOpenMRUIsEnabledForUiHost"),Yc=y.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");
v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Bc,Yc);if(Bc&&Yc){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:bc.SourceControlId,["AppType"]:hh.a[this.via]});Ta=bc.MenuItemId.toString();const zd={};zd[G.a.Jxc]="1";zd[G.a.documentUrl]=Ta;zd[G.a.reason]=Uf.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");y.AFrameworkApplication.NL().execute(Jd=>{Jd.sendMessage(J.a.rQb,
zd)})}else this.DZb(Ta,ob,nb,Eb,bc)}return 32};this.E3d=()=>{this.ifj();return 32};this.ga=b;this.$f=h;this.mi=r;this.uHa=A;this.Sb=L;this.TG=ba;this.bEk=ra;this.ZQd=Ia}RAo(){this.Buc.qa(wb.a.DZb,dd.a.frame,this.DZb);this.Buc.qa(wb.a.Flg,dd.a.frame,this.Flg);y.AFrameworkApplication.Tma?this.ifj():this.Buc.nb(wb.a.E3d,dd.a.frame,this.E3d,96)}D_a(b,h,r=""){if(h&&h.ZI){const A=mj.a[h.status];h=h.ZI.getTime();const L=this.Zq()-h;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",
{["Caller"]:b,["RequestStatus"]:A,["ElapsedMs"]:L,["StartTime"]:h,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}ifj(){var b=y.AFrameworkApplication.J.$("QPGVCI"),h=db.a.LL(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=db.a.LL(document.URL,"wdPreviousSession",b);b=db.a.LL(document.URL,"wdPreviousCorrelation",b);var A=y.AFrameworkApplication.J.$("NAOPLP");if(y.AFrameworkApplication.Tma){var L=
y.AFrameworkApplication.Tma.getTime();!h||h>L?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:L,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:L-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get Buc(){return this.ga.value}get fhd(){return this.$f.value}get Vlj(){return this.mi.value}get via(){return this.uHa.value}get noe(){return this.Sb.value}get Zq(){return this.TG}get HOa(){return this.bEk.value}get O2a(){return this.ZQd.value}static get instance(){return Jj._instance||(Jj._instance=Jj.tu())}static tu(){return new Jj(new xe.a(()=>y.AFrameworkApplication.va),new xe.a(()=>y.AFrameworkApplication.pe),new xe.a(()=>y.AFrameworkApplication.ta),
new xe.a(()=>y.AFrameworkApplication.ta.Pb.gl),new xe.a(()=>y.AFrameworkApplication.zc),()=>(new Date).getTime(),new xe.a(()=>y.AFrameworkApplication.ta.Pb.HOa),new xe.a(()=>y.AFrameworkApplication.O2a))}}Jj._instance=null;Object(u.a)(Jj,"NewAndOpenCommonHelpers",null,[689]);class $h{constructor(b,h,r){this.wPd=this.wq=null;this.P9e=0;this.LSk=b;this.Sb=h;this.Rjh=r}m$k(){this.P9e=this.Cyc+1}oyg(b){this.wq&&(this.Sb.Kf(this.wq),this.wq=null);b&&(this.P9e=0)}Fkp(b){const h=this.Jsp;0<=h?(this.m$k(),
this.oyg(!1),this.wq=new Md.a(4,1,h,b,107),this.Sb.pc(this.wq)):(this.oyg(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Rjh}))}get Cyc(){return this.P9e}get Jsp(){return this.Cyc>=this.WRj.length?-1:this.WRj[this.Cyc]}get WRj(){if(!this.wPd){const b=(this.LSk.value||"0").split(",");this.wPd=[];for(let h=0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Rjh,["Entry"]:b[h]}):
Array.add(this.wPd,r)}}return this.wPd}}Object(u.a)($h,"RetryHelper",null,[]);class pi extends wi{constructor(b,h){super();this.SIa=b;this.yRc=new $h(h,this.Ngd.noe,"GetMoreInfo");this.Rv=new el}SPn(){this.xag("Document opened")}MNl(b){return()=>{this.xag(b,!0)}}ftj(b,h=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Rv.state?(h&&this.ooi(h,this.Rv),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.xag(b);return this.Rv}xag(b,h=!1){this.yRc.oyg(!h);1===this.Rv.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.yRc.Cyc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.yRc.Cyc}),this.Rv.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Ngd.HOa,y.AFrameworkApplication.lm),this.Ngd.fhd.o8a(h,1,null,null,[pi.TEh,pi.OLh],5,this.tMl(),this.sMl(b)))}tMl(){return b=>
{var h=!1;let r=!1;var A=!1,L;y.AFrameworkApplication.J.$("GetMoreInfoDataFromResponseBody")&&(b.data.responseData?({Zv:L}=H.d(b.data.responseData)).returnValue?L?(A=!0,this.Rv.ccf=L.StorageServiceDisplayName,this.Rv.sQc=pi.v9i(L.PersonalFileStorageUrl)?L.PersonalFileStorageUrl:"",""===this.Rv.Mia&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.rb("FileSource")&&(this.Rv.sQc=db.a.Zda(y.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.Rv.Mia&&""!==this.Rv.ghb):v.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));A||((L=b.data.Pi)?(this.Rv.ccf=(L[pi.OLh]||"").toString(),h=(L[pi.TEh]||"").toString(),
this.Rv.sQc=pi.v9i(h)?h:"",""===this.Rv.Mia&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.rb("FileSource")?(this.Rv.sQc=db.a.Zda(y.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.Rv.Mia&&""!==this.Rv.ghb):h=""===h&&""!==this.Rv.ghb):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));A=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.yRc.Cyc,r,h,A);this.Ngd.D_a("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
b.data,A);this.kSj(3,h,r)}}sMl(b){return h=>{this.Ngd.D_a("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.kSj(2);this.yRc.Fkp(this.MNl(b))}}kSj(b,h=!1,r=!1){this.Rv.state=b;this.Rv.Bsh=h;this.Rv.qZe=r;this.$Cf(this.Rv)}get Ngd(){return this.SIa.value}static get instance(){return pi._instance||(pi._instance=pi.tu())}static tu(){return new pi(new xe.a(()=>Jj.instance),new xe.a(()=>y.AFrameworkApplication.fHm))}static v9i(b){if(!b)return v.ULS.sendTraceTag(5849624,
202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(D.a.Ph(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}pi.TEh="PersonalFileStorageUrl";pi.OLh="StorageServiceDisplayName";pi._instance=null;Object(u.a)(pi,"GetMoreInfoActor",wi,[]);class vh{constructor(b,h,r,A,L){this.rFk=6E4;this.EVi="inactive";this.wRh="active";this.G3=!0;this.Sb=b;this.iDk=h;this.TG=r;this.TRd=A;this.sa=new Nf.a;L&&this.vkp();this.Xwh=
this.dGi()}YRh(b){this.sa.addHandler(this.wRh,b)}y3k(b){this.sa.addHandler(this.EVi,b)}vkp(){const b=new Md.a(5,2,this.rFk,Object(E.a)(this,this.Qan,"inactiveLoop"),108);this.Ran.pc(b)}Qan(){const b=this.dGi(),h=this.Zq()-b;h>this.vGe&&this.G3&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.G3=!1,this.sa.raiseEvent(this.EVi));b-this.Xwh>this.vGe&&(this.G3=!0,this.sa.raiseEvent(this.wRh));this.Xwh=b}get Ran(){return this.Sb.value}get dGi(){return this.iDk}get Zq(){return this.TG}get vGe(){return this.TRd.value}static get instance(){return vh._instance||
(vh._instance=vh.tu())}static tu(){return new vh(new xe.a(()=>vb.TaskManager.instance),()=>y.AFrameworkApplication.gXb.getTime(),()=>(new Date).getTime(),new xe.a(()=>y.AFrameworkApplication.vGe),!0)}}vh._instance=null;Object(u.a)(vh,"InactivityManager",null,[]);var Bl=e(1688);class Bj extends Qi{constructor(){super();this.mLk=this.PAh=this.OAh=null;this.state=this.xNh=0;this.qZe=!1}get Jcg(){return this.OAh}get Rkj(){return this.PAh}get Psp(){return this.xNh}UKi(){return"MruActor Result"}}Object(u.a)(Bj,
"MruResult",Qi,[701,702]);class Vj{constructor(b,h,r){this.task=null;this.cfe=b;this.maxRetries=h;this.jj=r;this.retryCount=this.iad=0;this.W7e=this.Udd=null}wwn(b,h){return b===pa.a.jlc||20===h||18===h||3===h}Wxn(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get xue(){return this.W7e}reset(){this.iad=this.retryCount=0;this.W7e=this.Udd=null;this.task&&(this.jj.Kf(this.task),this.task=null)}yfn(b,h,r,A){this.W7e=
String.format("{0}_{1}",r,A);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.wwn(r,A))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Wxn(A)&&1<=this.iad)return this.Udd=r,!1;h=Math.max(h,this.cfe*Math.pow(2,this.iad));if(26===A)h=Math.max(h,3E4);else if(27===A||28===A)h=Math.max(h,6E4);9===A||412===r&&(null==this.Udd||412!==this.Udd)?h=500:this.iad+=1;this.Udd=r;this.retryCount+=1;
this.task&&this.jj.Kf(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new Md.a(2,1,h,b,107);this.jj.pc(this.task);return!0}}Object(u.a)(Vj,"RetryManager",null,[]);var mh=e(152);class xf{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(xf,"WriteOptions",null,[]);var Wg=e(552);class Oj extends wi{constructor(b,h,r,A,L,ba,ra){super();this.sSp=Ia=>{this.zRi(Ia.data)};this.WRl=Ia=>
{if(Ia.data.Xe===pa.a.sic)this.zRi(Ia.data);else{var Ta=Ia.data.Xe===pa.a.e$,ob=ub.a.HI();this.JRi(this.hob,Ia,this.ERl(),ob);ob&&(ob.set("StatusCode",Ia.data.Xe.toString()),Ta||this.Lhf(Ia.data,ob));Ca.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ia.data.Xe),Ta,!1,Object.assign(new Sa.a,{extendedProperties:ob}))}};this.qHm=Ia=>{this.vHi(Ia)};this.pHm=Ia=>{this.vHi(Ia,!0)};this.mHm=Ia=>{this.uHi(Ia)};this.kHm=Ia=>{this.uHi(Ia,!0)};this.SIa=b;this.aKk=h;this.Lmb=new Vj(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.uR.noe);this.hob=new Vj(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.uR.noe);this.wQk=r;this.wQh=A;this.fZk={};this.Tra=new Bj;this.HCk=L;this.JKd="";this.gQ=ba;this.Wlh=ra;this.NNd="";this.BQk=y.AFrameworkApplication.J.sc("WordRecentLinksCount",
25)}get DKe(){return this.fZk}IEo(){this.uR.Buc.qa(wb.a.bKj,dd.a.frame,Object(E.a)(this,this.JJo,"renameMruEntry"))}JJo(){return this.aTg("Rename")}fQn(){this.Dhj("File Opened")}gQn(){this.Dhj("IntervalUpdate")}Dhj(b){v.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.aTg(b)}sna(b){(b=D.a.sna(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}l8d(){switch(this.uR.via){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}gXm(b){var h=this.HCk();if(!h)return null;const r=new xf;r.documentUrl=this.Wlh.value?encodeURI(h):h;r.mruItemId=this.JKd;r.app=this.l8d();if(h=this.gQ())r.folderName=h.breadcrumbFolderName,h=h.sC,r.documentName=D.a.oN(h),r.documentExt=this.sna(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(r)}aTg(b,h=!1){if(4===this.uR.via&&!y.AFrameworkApplication.B3d)return 2;var r=ub.a.HI();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.JKd?"true":"false"),r.set("URLEncoded",this.Wlh.value?"true":"false"));Ca.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.gXm(r);if(!b)return h=!y.AFrameworkApplication.H5b,r&&(r.set("WebEditingIsEnabled",y.AFrameworkApplication.H5b?"true":"false"),r.set("ProtectedFile",y.AFrameworkApplication.AR?
"true":"false")),Ca.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Sa.a,{extendedProperties:r})),2;this.hob&&!h&&this.hob.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.uR.HOa,this.v9f);this.wQh?this.DKe["X-FileId"]=y.AFrameworkApplication.lm:r+=String.format("&{0}",y.AFrameworkApplication.lm);y.AFrameworkApplication.sessionStartInfoSettings&&(this.DKe["X-Office-AudienceGroup"]=Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.DKe["X-Timeout"]=15E3;return this.uR.fhd.addRequest(r,2,b,this.DKe,!0,5,this.sSp,this.WRl,null,void 0,void 0,void 0,void 0,"4")}zRi(b){const h=ub.a.HI();this.hob&&(h&&this.hob.xue&&(h.set("LastError",this.hob.xue),h.set("NumRetries",this.hob.retryCount.toString())),this.hob.reset());const r=Bl.c(b.responseData);r&&r.diagnostics_data&&(this.JKd=r.diagnostics_data.mru_id);b=+b.MQ-+b.ZI;h&&h.set("RequestDuration",b.toString());Ca.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Sa.a,
{extendedProperties:h}))}ERl(){return()=>{this.aTg("Retry",!0)}}oHm(){this.Pfd("Polling")}nHm(){this.Pfd("Retry",!0)}VPn(){this.Pfd("Open")}UPn(){this.Pfd("Activity")}TPn(){this.Pfd("ActivityRecentLinks",!1,!0)}Pfd(b,h=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const A=ub.a.HI();A&&(A.set("Trigger",b),A.set("IsRetry",h?"true":"false"),r&&A.set("RecentLinks","true"));Ca.Health.instance.recordKpiUsage("GetMru",0,"smartfio",A);this.Lmb&&!h&&this.Lmb.reset();
r?this.qei(this.pHm,this.kHm,!0):this.qei(this.qHm,this.mHm)}Lhf(b,h){b&&b.Pi&&(b=b.Pi["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}BLn(b,h){b&&(h&&h.set("RequestDuration",(+b.MQ-+b.ZI).toString()),Ca.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Sa.a,{extendedProperties:h})))}vHi(b,h=!1){var r="";let A=null,L=null,ba=null;const ra=Bl.c(b.data.responseData);ra&&(A=ra.places?ra.places.items:[],L=ra.documents?ra.documents.items:[],(ba=Bl.a(ra,h))&&(r=H.c(ba)));y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.YZa&&mh.c()&&(h?this.NNd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=ub.a.HI();this.Lmb&&(r&&this.Lmb.xue&&(r.set("LastError",this.Lmb.xue),r.set("NumRetries",this.Lmb.retryCount.toString())),this.Lmb.reset());h&&r&&r.set("RecentLinks","true");ba||A||L?(h?this.uR.D_a("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.uR.D_a("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.GIe(3,ba,A,L),this.BLn(b.data,
r)):(h?this.uR.D_a("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.uR.D_a("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.Lhf(b.data,r),Ca.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Sa.a,{extendedProperties:r})),this.GIe(3,null,null,null,!0));this.$Cf(this.Tra)}JRi(b,h,r,A){let L=0,ba=0;const ra=Bl.c(h.data.responseData);ra&&(null!=ra.response_code&&(L=ra.response_code,A&&
A.set("MruResponseCode",L.toString()),9===L&&(this.JKd="")),ra.error_data&&null!=ra.error_data.retry_after_ms&&(ba=ra.error_data.retry_after_ms,A&&A.set("ExpectedRetryAfter",ba.toString())));b&&(h=b.yfn(r,ba,h.data.Xe,L),A&&(A.set("CurrentRetryCount",b.retryCount.toString()),A.set("RetryScheduled",h?"true":"false")))}uHi(b,h=!1){const r=b.data.Xe===pa.a.e$,A=ub.a.HI();A&&(A.set("StatusCode",b.data.Xe.toString()),h&&A.set("RecentLinks","true"),r||this.Lhf(b.data,A));h?this.uR.D_a("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.uR.D_a("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.GIe(2);this.JRi(this.Lmb,b,Object(E.a)(this,this.nHm,"getMruFromServerRetryTask"),A);Ca.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Xe),r,!1,Object.assign(new Sa.a,{extendedProperties:A}));this.$Cf(this.Tra);y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.YZa&&mh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.NNd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}GIe(b,h=null,r=null,A=null,L=!1){if(3!==this.Tra.state||3===b)this.Tra.OAh=h,this.Tra.PAh=r,this.Tra.mLk=A,this.Tra.state=b,this.Tra.qZe=L,this.Tra.xNh=this.uR.Zq()}ftj(b,h){v.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Tra.state});h&&3===this.Tra.state&&this.ooi(h,this.Tra);return this.Tra}qei(b,h,r=!1){this.GIe(1);let A;const L={};A=r?String.format(this.uR.HOa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.BQk,
"OfficeSuite",this.v9f,"ClassicMru"):String.format(this.uR.HOa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.l8d(),this.v9f);this.wQk.value||(A+="&entity=docs");y.AFrameworkApplication.sessionStartInfoSettings&&(L["X-Office-AudienceGroup"]=Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(L["X-Office-Application"]="147");this.wQh?L["X-FileId"]=y.AFrameworkApplication.lm:A+=String.format("&{0}",y.AFrameworkApplication.lm);this.uR.fhd.addRequest(A,
1,null,L,!0,5,b,h,null)}get uR(){return this.SIa.value}get v9f(){return this.aKk.value}static get instance(){return Oj._instance||(Oj._instance=Oj.tu())}static tu(){return new Oj(new xe.a(()=>Jj.instance),new xe.a(()=>Wg.a.Vg(y.AFrameworkApplication.lcid).name),new xe.a(()=>y.AFrameworkApplication.ta.Pb.$I),y.AFrameworkApplication.J.$("MruWriteFileIdInHeader"),()=>y.AFrameworkApplication.ta.Pb.EY,()=>y.AFrameworkApplication.dv,new xe.a(()=>y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled")))}}Oj._instance=
null;Object(u.a)(Oj,"MruActor",wi,[]);class Bg{constructor(){this.gUc=this.qGh=this.Z=null;this.Bi=!1;this.QWl=()=>{vb.TaskManager.instance.Kf(this.Tkj)};this.LSh=()=>{vb.TaskManager.instance.pc(this.Tkj)}}get name(){return"Common.App.NewAndOpen.Core"}Ec(b){this.Z=b;b.register(689,"Common.INewAndOpenCommonHelpers").ha().fe(()=>Jj.instance);b.register(690,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().fe(()=>pi.instance);b.register(690,"Common.IEventEmitter<Common.IMruResult>").ha().fe(()=>
Oj.instance)}init(){y.AFrameworkApplication.J.lq(()=>{this.Wbb()})}Wbb(){this.Z.resolve("Common.INewAndOpenCommonHelpers");this.Z.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Z.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Jj.instance.RAo();y.AFrameworkApplication.NEa&&(b=!0);y.AFrameworkApplication.ytg&&(Oj.instance.VPn(),0<y.AFrameworkApplication.Skj&&this.LSh(),this.q8o(),b=!0);y.AFrameworkApplication.O2a&&b&&pi.instance.SPn();y.AFrameworkApplication.sGp&&(b=Oj.instance,
b.IEo(),b.fQn(),vb.TaskManager.instance.pc(this.tGp))}q8o(){vh.instance.YRh(Object(E.a)(Oj.instance,Oj.instance.UPn,"makeGetMruRequestActivityTrigger"));vh.instance.YRh(this.LSh);vh.instance.y3k(this.QWl)}get Tkj(){return this.qGh||(this.qGh=new Md.a(5,2,y.AFrameworkApplication.Skj,Object(E.a)(Oj.instance,Oj.instance.oHm,"getMruFromServerTask"),109))}get tGp(){return this.gUc||(this.gUc=new Md.a(2,2,6E4*y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",
1440),Object(E.a)(Oj.instance,Oj.instance.gQn,"makeUpdateMruTask"),197))}dispose(){this.Bi||(this.Bi=!0,this.gUc&&(vb.TaskManager.instance.Kf(this.gUc),this.gUc=null))}}Object(u.a)(Bg,"CorePackageManager",null,[0,1,11]);var Xg=e(1480),kl=e(157);class ff{static y6l(b){return ff.g2h("New",b)}static z6l(b){return ff.g2h("Open",b)}static M1h(b,h){return ff.V8a("LoadingMenuSection",ff.qJn,b,ff.lXc("lblLoading",h))}static mXc(b,h,r=null,A=null){return ff.V8a("MessageMenuSection",ff.Qkj,h,ff.lXc("lblMessage",
b,r,A))}static unl(b){return ff.M1h(b,CommonUIStrings.l_VoicedLoadingText)}static vnl(b,h){return ff.mXc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Mia,h.ghb)}static tnl(b,h){return ff.mXc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.ghb,"\n\n"),b.labelText)}static Q1h(b){return ff.mXc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static rnl(b,h,r){return ff.V8a("menuNewBlank",ff.S5m,r?b.labelText:null,ff.hXc(b.oTi,b.pTi,b.qTi,null,b.Mbb,b.M9c,h,"blank"))}static nol(){return ff.lXc("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static e2h(){return ff.lXc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static ool(b,h){return ff.V8a("menuNewTemplates",b,null,h)}static pnl(b,h){return ff.V8a("menuNewMoreTemplates",ff.zvi,null,ff.hXc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static gml(b,h,r){let A="";r&&h&&(A=ff.V8a("BrowseMoreMenuSection",ff.zvi,null,ff.hXc("btnBrowseMore",h,h,null,null,null,b||
"1959943459",r)));return A}static lXc(b,h,r=null,A=null){let L=A;h&&0<h.length&&(L=ff.emj.dzb(h).trimEnd(),L=0<=L.indexOf("{0}")?String.format(L,A):String.format("{0} {1}",L,A));r=r&&A?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',D.a.Mf(r),D.a.Mf(A),D.a.Mf(L)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',D.a.Mf(b||""),ff.emj.dzb(D.a.Mf(h||"")),r)}static hXc(b,h,
r,A,L,ba,ra,Ia){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',D.a.Mf(b||""),D.a.Mf(h||""),D.a.Mf(r||""),A||"32by32",D.a.Mf(L||""),D.a.Mf(ba||""),ra,D.a.Mf(Ia||""))}static g2h(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static V8a(b,h,r,A){r=r?String.format('Title="{0}"',
D.a.Mf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',D.a.Mf(b||""),D.a.Mf(h||""),r,A)}}ff.Qkj="MenuMru";ff.qJn="MenuLoading";ff.S5m="MenuHeader";ff.zvi="MenuFooter";ff.emj=kl.a.gG("\n","&#10;");Object(u.a)(ff,"NewAndOpenXmlUtilities",null,[]);class gj{constructor(){this.folderName=this.folderUrl=
this.hostName=this.hostUrl=null}}Object(u.a)(gj,"HostInformation",null,[]);var ej=e(328),zi=e(386);const Lk={topLevelKpiName:"CreateNewDocument_FileMenu",featureName:"New",crewAlias:"wwbootperf",vetoPillar:"Boot",areaName:"Boot",doNotEmitAggregatedCount:!1};class Gh{constructor(b,h,r,A,L,ba){this.yTc=this.$y=this.JAd=null;this.cQd=this.Xaf=!1;this.jAh=0;this.i0e=!1;this.Vte=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;2!==Ta||this.i0e||(this.jAh=(new Date).getTime(),this.gId&&this.$d.logKpiUsage({kpiName:"CreateNewDocument_FileMenuRender",
kpiType:0}),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.KCe,["CachedNewMenuXmlExists"]:!!this.JAd,["ShouldCallGetMoreInfo"]:this.cU.O2a}));return this.Sko(nb)};this.SIa=b;this.hKc=h;this.s5a=new xe.a(()=>new Xg.a(r.value,Object(E.a)(this,this.aTb,"getMoreInfoEventReceived")));this.kLk=A;this.Zlb=L;this.RTk=ba;this.ASc=this.KCe;this.GId=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("GateTemplateRenderingByGetMoreInfoResponse");
this.UHk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PremiumTemplateEnabled");this.gId=!!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.NewKpiForCreateNew",!1);this.$d=ej.a.getInstance(Lk)}get g8(){switch(this.cU.via){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}mc(){const b=this.cU.Buc;b.qa(wb.a.poe,dd.a.frame,Object(E.a)(this,this.poe,"newDocument"));b.qa(wb.a.Vte,dd.a.frame,this.Vte)}poe(b,
h,r,A,L){if(1===r)return 32;if(2===r&&L){this.gId&&this.$d.logKpiUsage({kpiName:"CreateNewDocument_FileMenuExec",kpiType:0});if(y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&L.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),y.AFrameworkApplication.va.Vb(wb.a.pmo,2);if(L.MenuItemId&&L.SourceControlId)return"NewDocumentHome"===L.SourceControlId&&$d.a("NewDocumentFromHomeTab"),this.C_c(L.MenuItemId,L.SourceControlId)}return 8}C_c(b,
h){var r=this.toe.Zei;if(null===r)return this.mfd("RelativePathIsNull",!0),8;var A=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const L=y.AFrameworkApplication.Ewb;"blank"===b&&this.Mun()&&(v.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.g8),b="blankNew");if(L&&A){v.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ba={};ba[G.a.template]=
b;ba[G.a.g8]=this.g8;ba[G.a.lcid]=y.AFrameworkApplication.lcid.toString();ba[G.a.reason]=Uf.a.Iwf;ba[G.a.uiCulture]=y.AFrameworkApplication.uiCulture;ba[G.a.dataCulture]=y.AFrameworkApplication.dataCulture;y.AFrameworkApplication.NL().execute(ra=>{ra.sendMessage(J.a.C_c,ba)})}else if(A=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,D.a.nj(this.NEa),D.a.nj(b),D.a.nj(this.g8),D.a.nj(y.AFrameworkApplication.lcid.toString()),
D.a.nj(A.toString()),D.a.nj(h),D.a.nj(y.AFrameworkApplication.QO),y.AFrameworkApplication.lm),(r=y.AFrameworkApplication.J.rb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+D.a.nj(r)),h+="&"+y.AFrameworkApplication.obe(),(r=this.$y?this.$y.Mia:null)?h+="&DestinationUrl="+D.a.nj(r):3===this.cU.via&&this.cU.O2a&&(this.mfd("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",!0),v.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===
this.NEa?zi.a.rx("6f63j813;9a66f561"):zi.a.rx("b8jd0489;3228j491"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1)){r={ugfu:"1"};if(!y.AFrameworkApplication.pe.oib||y.AFrameworkApplication.pe.oib>=Date.now())r.wacAadToken=y.AFrameworkApplication.pe.mDb;ed.a.gue("_blank",h,r)}else ed.a.Zm(h,"_blank",
void 0,"CreateNewDocument");2!==this.cU.via&&3!==this.cU.via||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:hh.a[this.cU.via],["Template"]:b});y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.cU.via&&("blank"===b||"blankNew"===b?$d.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ma.a,{name:"TemplateId",string:b})],$d.b("ConsumerTemplateNew",null,0,!0,0,b)));
this.dfj(!0);return 32}Mun(){let b=!1;switch(this.cU.via){case 3:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return b}XNn(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const A=window.performance;if(A&&"undefined"!==
typeof A.getEntriesByName){for(let ba=0;ba<b.length;ba++){var L=A.getEntriesByName(b[ba]);L&&0<L.length&&(L=L[0],h=Math.min(parseInt(String(L.fetchStart)),h),r=Math.max(parseInt(String(L.responseEnd)),r))}r>h&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}Sko(b){b&&(this.JAd?b.PopulationXML=this.JAd:(this.cU.O2a&&!this.$y&&this.iYn.F1("Opened New menu",!0),b.PopulationXML=this.Ulm(this.HNi())));
return 32}z6i(){return!this.cU.O2a||!!this.$y&&3===this.$y.state&&!!this.$y.ghb&&!!this.$y.Mia}Q3f(){return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.YZa&&!this.GId?!0:this.z6i()}HNi(){if(!this.KCe&&!this.GId&&!this.Q3f())return null;if(this.ASc&&!this.cQd){let h=!1;var b="9";const r=y.AFrameworkApplication.J.appSettings;"NumberOfTemplatesInBackstage"in r&&(b=r.NumberOfTemplatesInBackstage);let A=this.g8;"TemplateCollectionId"in r&&(A=r.TemplateCollectionId);this.UHk&&"PowerPointWAC"===
A&&(h=!0);b=String.format(this.cU.HOa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",D.a.nj(y.AFrameworkApplication.lcid.toString()),D.a.nj(A),b);Boolean.parse(r.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(r.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in r&&(b+="&templateTier="+r.TemplateTier);b=h?b+"&p=1":b+"&p=0";b+="&"+y.AFrameworkApplication.obe();this.cU.fhd.addRequest(b,1,null,null,!1,2,L=>{this.cU.D_a("CreateNewActor.GetTemplateListJson",
L.data);this.Xqp(L.data.responseData)},L=>{this.cU.D_a("CreateNewActor.GetTemplateListJson",L.data);this.Wqp()},null,void 0,void 0,void 0,void 0,"5");this.ASc=!1}return this.yTc}Xqp(b){this.yTc=b;this.ASc=!1;this.mnd();this.GId?this.Q3f()?this.YAf():this.$y&&(v.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.mfd("GetMoreInfoReceivedButInfoIsMissing",!1),this.XAf()):this.YAf()}YAf(){if(y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.YZa&&mh.c()){const b=
y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=y.AFrameworkApplication.Ewb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.yTc,!0,b&&h));this.dfj(!1);3===this.cU.via&&v.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}Wqp(){this.cQd=this.ASc=!0;this.mnd();this.mfd("TemplateServiceFailed",!1);this.XAf();Ca.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}XAf(){y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.YZa&&mh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.cU.via&&v.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}dfj(b){this.gId&&this.$d.logKpiSuccess({kpiName:b?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}mfd(b,h){this.gId&&this.$d.logKpiFailure({kpiName:h?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:b})}kSf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===
b[r].ImageType){h=r;break}const A=b.length?b[h]:null;b=A?A.Url||"":"";var L;let ba=r=h=!1;if(A&&(L=A.AspectRatio))L=parseFloat(L),1>L?h=!0:1.5<L?r=!0:1===L&&(ba=!0);else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.cU.via){case 3:h=!0;break;case 2:r=!0;break;case 5:ba=!0}return{returnValue:b,qan:h?"95by123":r?"123by69":ba?"100by100":"123by95"}}Ulm(b){b=({nCe:h}=this.snl(b,this.toe,this.toe.pXc||"1056925771")).returnValue;if(h){this.JAd=b;var h=(new Date).getTime()-
this.jAh;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}aTb(b,h){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.$y||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Xaf=!0,this.mnd()):(this.$y=b,h||this.mnd(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.YZa&&mh.c()&&mh.d("setFileMenuHostInformation")&&(b=Object.assign(new gj,
{hostUrl:this.$y.Mia,hostName:this.$y.ghb,folderUrl:y.AFrameworkApplication.breadcrumbFolderUrl,folderName:y.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.GId&&this.yTc&&this.yTc.length&&(this.Q3f()?this.YAf():(this.mfd("PersonalFileStorageInfoIsMissing",!1),this.XAf()),v.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}snl(b,
h,r){let A;A=!1;const L=this.z6i();let ba="";this.cU.O2a&&(this.Xaf?(ba=ff.Q1h(h),this.Xaf=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.$y?L?ba=ff.vnl(h,this.$y):this.$y.Yin?(A=!0,this.ASc=!1,ba=ff.tnl(h,this.$y),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(A=!0,ba=ff.Q1h(h),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.$y.Mia,["StorageServiceDisplayNameIsSet"]:!!this.$y.ghb})):(ba=ff.unl(h.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));L&&(ba+=ff.rnl(h,r,!ba)+({nCe:A}=this.mol(b,r)).returnValue);return{returnValue:ff.y6l(ba),nCe:A}}mol(b,h){let r;r=!1;if(!this.KCe)return r=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",nCe:r};let A="",L="",ba="MenuTemplate";if(this.cQd)A=
ff.e2h(),this.cQd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ra=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);A=this.lol(ra,h);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");y.AFrameworkApplication.fmj&&"OneDrive"===this.NEa&&(L=ff.pnl(this.jYn,y.AFrameworkApplication.fmj))}catch(ra){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),
A=ff.e2h()}r=!0}else ba="MenuLoading",A=ff.nol(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:ff.ool(ba,A)+L,nCe:r}}lol(b,h){let r="";const A=[];for(let ba=0;ba<b.length;ba++){var L=b[ba];let ra="";if(L){const Ia=L.Title,Ta=L.AssetId;L=L.Thumbnails;Ta&&Ia&&L&&({qan:L,returnValue:ra}=this.kSf(L),r+=ff.hXc("jbtnNewTemplate"+ba,Ia,null,L,null,ra,h,Ta))}A[ba]=ra}b=new Md.a(4,1,5E3,()=>{this.XNn(A)},106);this.cU.noe.pc(b);return r}mnd(){this.i0e=
!0;this.cU.Vlj.uRa(this.toe.Y3c);this.i0e=!1}get cU(){return this.SIa.value}get toe(){return this.hKc.value}get iYn(){return this.s5a.value}get jYn(){return this.kLk.value}get NEa(){return this.Zlb.value}get KCe(){return this.RTk.value}}Object(u.a)(Gh,"CreateNewActor",null,[]);class aj{constructor(){this._initialized=!1;this.fcf={}}lF(b){this.eqi();return this.get(b)}contains(b){this.eqi();return b.toString()in this.fcf}eqi(){this._initialized||(this.d5k(),this._initialized=!0)}xob(b,h){this.fcf[b.toString()]=
h}get(b){return this.fcf[b.toString()]}}Object(u.a)(aj,"AIntlHelper",null,[]);class ck extends aj{constructor(){super()}d5k(){this.xob(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.xob(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.xob(2,CommonUIStrings.l_Open);this.xob(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.xob(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.xob(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return ck._instance||(ck._instance=new ck)}static zco(b){return ck.instance.lF(b)}}
ck._instance=null;Object(u.a)(ck,"MruActorIntlHelper",aj,[]);var yk;(function(b){b[b.success=0]="success";b[b.fk=1]="failure";b[b.r3b=2]="spinner";b[b.none=3]="none"})(yk||(yk={}));Object(u.b)("DisplayState",yk);class eh{constructor(b,h,r,A,L,ba,ra,Ia){this.mPe=null;this.Yff=!0;this.IAd="";this.QWk=0;this.nac=null;this.O1e=3;this.Zog=(Ta,ob,nb,Eb,bc)=>1!==nb&&bc?this.Qko(bc):32;this.za=Ia;this.SIa=b;this.HAa=h;this.zBk=r;this.pvk=A;this.ovk=L;this.s5a=new xe.a(()=>new Xg.a(ba.value,null));this.lDk=
new xe.a(()=>new Xg.a(ra.value,Object(E.a)(this,this.CWn,"mruEventResultReceived")));this.za.$("WacInTabOpenMRUIsEnabledForUiHost");this.za.$("UiHostSupportsDocRebootFeatures")}CWn(b,h){this.nac=b;h||this.bGj()}FDo(){this.uR.Buc.nb(wb.a.Zog,dd.a.frame,this.Zog,96)}Qko(b){this.m7l();this.l7l();b.PopulationXML=ff.z6l(this.IAd+this.mPe);return 32}m7l(){var b=3;let h=!1;if(this.IAd&&this.QWk===this.nac.Psp)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),
b=this.O1e;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.uR.Zq();this.nac=this.BWn.F1("File Open opened",!0);this.IAd&&2!==this.O1e&&3!==this.nac.state?h=!0:(b=this.$Qm(this.nac),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.YZa&&mh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.IAd=({aYn:b}=this.Wlm(this.nac)).returnValue);r=this.uR.Zq()-r;v.ULS.sendTraceTag(5849629,
202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:yk[b]},1!==b&&(r.IsStale=h),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.O1e=b}$Qm(b){let h;try{h=H.c(b.Jcg)}catch(r){h=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}l7l(){this.Yff?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),
this.mPe=({GNp:this.Yff}=this.PPn()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Yff,["NotDisplayingLink"]:!this.mPe})}Wlm(b){let h;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=ff.M1h(this.rbb(2),this.rbb(5))):3===b.state&&b.Jcg?(h=this.qnl(b.Jcg),b=0):(v.ULS.sendTraceTag(5849634,
202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=ff.mXc(this.rbb(1),this.rbb(2)),b=1);return{returnValue:h,aYn:b}}qnl(b){let h;const r=this.wgd.pXc||"2155708348";if(b.length){h=ff.lXc("lblRecentDocuments",this.rbb(3));let A=0;for(let L=0;L<b.length;L++){const ba=b[L];"FileName"in ba&&"DocumentUrl"in ba&&"Path"in ba&&(h+=ff.hXc("MruButton"+L,ba.FileName.toString(),ba.Path.toString(),null,this.wgd.Mbb,this.wgd.M9c,r,ba.DocumentUrl.toString()),ba.IsPinned&&A++)}h=ff.V8a("RecentDocumentsMenuSection",
ff.Qkj,this.rbb(2),h);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:A})}else h=ff.mXc(this.rbb(0),this.rbb(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}PPn(){let b;b=!0;let h=this.xll;var r=this.wll;if(h&&r||!this.uR.O2a)b=!1;else{const A=this.U$d.F1("File Open",!1);3===A.state&&(h=A.Mia,r=A.ghb,b=!1)}r=r?String.format(this.rbb(4),r):null;return{returnValue:ff.gml(this.wgd.pXc,
r,h),GNp:b}}bGj(){this.uR.Vlj.uRa(this.wgd.Y3c)}get uR(){return this.SIa.value}get rbb(){return this.HAa.value}get wgd(){return this.zBk.value}get xll(){return this.pvk.value}get wll(){return this.ovk.value}get U$d(){return this.s5a.value}get BWn(){return this.lDk.value}}Object(u.a)(eh,"MruRenderer",null,[]);var vg=e(1489);class tm{constructor(b,h,r,A,L,ba,ra){this.$y=null;this.RIh=!1;this.xza=this.W6=0;this.aTb=Ia=>{if(!this.$y&&3===Ia.state)this.$y=Ia;else if(2===Ia.state){this.RIh?v.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.U$d.F1("NewDocumentFromStream",!0),this.RIh=!0);return}this.Lwf()};this.dYn=Ia=>{if(Ia&&Ia.data&&Ia.data.responseData)if(({Zv:Ta}=H.d(Ia.data.responseData)).returnValue)if(Ia=Ta,Ia.StatusCode!==pa.a.jB&&Ia.StatusCode!==pa.a.sic)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.g8,this.xza,Ia.StatusCode),this.Tac(null);else if(Ia.NewDocumentUrl&&""!==Ia.NewDocumentUrl){var Ta=
(new Date).getTime()-this.W6;v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.g8,this.xza,Ta);this.DLk(Ia.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.g8,this.xza),this.Tac(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.g8,this.xza,{["ResponseData"]:vg.a.Hvd(Ia.data.responseData)}),
this.Tac(null);else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.g8,this.xza),this.Tac(null)};this.cYn=Ia=>{Ia&&Ia.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.g8,this.xza,Ia.data.status);this.Tac(null)};this.DLk=b;this.Tac=h;this.NKd=r;this.hKc=A;this.Zlb=L;this.SIa=ba;this.s5a=new xe.a(()=>new Xg.a(ra.value,this.aTb))}C_c(){!this.$y&&
this.lfg.O2a?this.U$d.F1("NewDocumentFromStream",!0):this.Lwf()}Lwf(){this.W6=(new Date).getTime();var b=this.Fcm.Zei;if(null===b)this.Tac(null);else{var h=this.NKd.menuItemId,r=this.NKd.AQa,A=this.NKd.jmp,L=this.NKd.Ncm;this.xza="streamBase64"===A?L.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.g8,this.xza);var ba=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,D.a.nj(this.NEa),
D.a.nj(h),D.a.nj(this.g8),D.a.nj(y.AFrameworkApplication.lcid.toString()),D.a.nj(ba.toString()),D.a.nj(r),D.a.nj(y.AFrameworkApplication.QO),y.AFrameworkApplication.lm,D.a.nj(A));b+="&"+y.AFrameworkApplication.obe();(h=this.$y?this.$y.Mia:null)&&(b+="&DestinationUrl="+D.a.nj(h));this.lfg.fhd.addRequest(b,2,L,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.dYn,this.cYn,null,void 0,void 0,void 0,void 0,"31")}}get g8(){switch(this.lfg.via){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get Fcm(){return this.hKc.value}get NEa(){return this.Zlb.value}get lfg(){return this.SIa.value}get U$d(){return this.s5a.value}}Object(u.a)(tm,"NewDocumentFromStreamOperation",null,[]);class Cm{constructor(b,h,r,A){this.hKc=b;this.Zlb=h;this.SIa=r;this.kDk=A}create(b,h,r){return new tm(b,h,r,this.hKc,this.Zlb,this.SIa,this.kDk)}}Object(u.a)(Cm,"NewDocumentFromStreamOperationFactory",null,[716]);var Fj=e(144);class hj{get name(){return"Common.App.NewAndOpen.UX"}Ec(b){b.register(Cm,
"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().fe(()=>new Cm(new xe.a(()=>y.AFrameworkApplication.ta.Pb.NMf()),new xe.a(()=>y.AFrameworkApplication.NEa),new xe.a(()=>b.Wa("Common.INewAndOpenCommonHelpers")),new xe.a(()=>b.Wa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){y.AFrameworkApplication.J.lq(()=>{this.Wbb()})}Wbb(){const b=Kb.a.xr(Xa.a.instance.Za("Common.INewAndOpenCommonHelpers")),
h=Kb.a.xr(Xa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));y.AFrameworkApplication.NEa&&Fj.Task.WAA.call(null,b,h).continueWith(()=>{const r=new Gh(new xe.a(()=>b.result),new xe.a(()=>y.AFrameworkApplication.ta.Pb.NMf()),new xe.a(()=>h.result),new xe.a(()=>y.AFrameworkApplication.ta.Pb.OMf().pXc||"1959943459"),new xe.a(()=>y.AFrameworkApplication.NEa),new xe.a(()=>y.AFrameworkApplication.Nun));r.mc();r.mnd()});if(y.AFrameworkApplication.ytg){const r=Kb.a.xr(Xa.a.instance.Za("Common.IEventEmitter<Common.IMruResult>"));
Fj.Task.WAA.call(null,b,h,r).continueWith(()=>{const A=new eh(new xe.a(()=>b.result),new xe.a(()=>ck.zco),new xe.a(()=>y.AFrameworkApplication.ta.Pb.OMf()),new xe.a(()=>y.AFrameworkApplication.yco),new xe.a(()=>y.AFrameworkApplication.xco),new xe.a(()=>h.result),new xe.a(()=>r.result),y.AFrameworkApplication.J);A.FDo();A.bGj()})}}dispose(){}}Object(u.a)(hj,"UXPackageManager",null,[0,1,11]);var wg=e(182);class Od extends wg.StandardDialog{constructor(){super();this.Md=0;this.Ue(1,CommonUIStrings.l_DialogClose)}fT(b){this.zA(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}gBf(b){this.zA(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(Od,"ErrorDialog",wg.StandardDialog,[700]);var zg=e(347);class nh{wyi(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new zg.a;b.setResult("api.onedrive.com");return b.task}}Object(u.a)(nh,"OneDriveConsumerEndpointHelper",null,[673]);var Vi=e(44);class he{constructor(b,h,r,A){this.bJb=
this.SOa=null;this.saf=this.uaf=!1;this.gbc=null;this.za=b;this.K6b=h;this.hIb=r;this.eL=A}get WWh(){return this.K6b}get J(){return this.za}Qmc(){this.gbc||(this.gbc=this.Pvc?mb.a.create(this.Pvc,null,null,null,!1):null);return this.gbc}setup(b){this.bJb=b;this.uaf||this.saf?this.uaf&&this.bJb&&this.bJb(!0):(b=this.Qmc())?(this.saf=!0,b.xdb.continueWith(h=>{this.D7n(h)}),Va.a.UY(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.bJb(!1))}ujg(b){v.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",b.Yk?b.Yk.toString():"No error detail.")}D7n(b){this.saf=!1;if(b.wj)this.ujg(b),this.bJb(!1);else try{this.uaf=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.rYf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.bJb(!0)}catch(h){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.bJb(!1)}}Gtd(b){this.SOa=b;this.hIb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):
(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(E.a)(this,this.qhg,"onApiReady")))}qhg(b){b?this.Gke():this.Pq()}Pq(){this.eL().fT(Vi.a.ybo)}iE(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.SOa&&this.SOa(!0,b)}dispose(){this.gbc&&this.gbc.dispose()}}Object(u.a)(he,"AOneDriveFilePickerApiManager",null,[719,11]);class td extends he{constructor(b,h,r,A,L,ba){super(h,r,A,ba);this.Eh=null;this.CAa=
b;this.ZTk=L}get Pvc(){return this.J.rb("OneDriveApiUrl")}start(b,h){this.Eh=b;this.Gtd(h)}rYf(){WL.init(1===this.WWh||2===this.WWh?{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Gtd(b){this.SOa=b;!this.hIb&&this.CAa.wad?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(E.a)(this,this.qhg,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.ZTk())}Gke(){try{v.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Eh).then(Object(E.a)(this,this.iE,"onSuccess"),Object(E.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Pq()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",
b.error.code,b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.SOa&&this.SOa(!1,b);this.Pq()}}Object(u.a)(td,"OneDriveFilePickerApiManagerV5",he,[]);class kh extends he{constructor(b,h,r,A,L){super(b,h,r,A);this.gGd=this.hDh=null;this.FGe=()=>{this.gGd.style.visibility="hidden"===this.gGd.style.visibility?"":"hidden"};this.BAk=L;this.options={};this.options.clientId=this.J.rb("OneDriveApiV7ClientId");this.options.cancel=this.FGe}get Pvc(){return this.J.rb("OneDriveApiV72Url")}start(b,
h){this.gGd=h;const r=this.BAk.wyi();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.hDh=r.result;this.Gtd((A,L)=>{this.FGe();b(A,L)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.Yk.message);this.FGe()},5)}rYf(){this.options.success=b=>{const h={};h.data=b;this.iE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.hDh;this.options.advanced.iframeParentDiv=this.gGd}Gke(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.FGe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Pq()}}onFailure(b){this.SOa&&this.SOa(!1,b);this.Pq()}}Object(u.a)(kh,"OneDriveFilePickerApiManagerV7",he,[]);class eg extends he{constructor(b,h,r,A){super(b,h,r,A);this.Jtk=b;this.options={};this.options.advanced=
{};this.options.action="query";this.options.clientId=this.J.rb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Pvc(){return this.J.rb("OneDriveApiV72Url")}start(b,h,r,A){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=A;this.options.cancel=h;this.Jtk.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Gtd(b)}Gtd(b){this.SOa=b;this.hIb?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(E.a)(this,this.qhg,"onApiReady")))}rYf(){this.options.success=b=>{const h={};h.data=b;this.iE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}Gke(){try{v.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Pq()}}ujg(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.Yk?b.Yk.toString():"No error detail.");Va.a.EHo(this.Pvc);this.gbc=null}Pq(){this.eL().gBf(Vi.a.ySo)}onFailure(b){this.SOa&&this.SOa(!1,b)}}Object(u.a)(eg,"OneDriveFilePickerApiManagerV72",he,[]);class li{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(u.a)(li,"IExtraData",
null,[]);class Ll extends eg{constructor(b,h,r,A){super(b,h,r,A);this.options.advanced.filter=b.rb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.gXh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.rb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new li(y.AFrameworkApplication.userSessionId))}get Pvc(){return this.J.rb("OneDriveApiV72Url")}Gke(){try{v.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Pq()}}}Object(u.a)(Ll,"OneDriveFilePickerApiOpenManagerV72",
eg,[]);class mi{constructor(b){this.Xr=null;this.eHm=h=>{if(h.data.Xe===pa.a.e$&&"X-NewKey"in h.data.Pi){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const r={};r["X-Key"]=h.data.Pi["X-NewKey"];this.pBg(r)}else 0<this.N9e?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.N9e),this.N9e--,this.pBg()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Xr.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.gHm=h=>{"PersonalFileStorageUrl"in h.data.Pi&&""!==h.data.Pi.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Xr.setResult(h.data.Pi.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Xr.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};
this.$f=b;this.N9e=3}wyi(){this.Xr=new zg.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.pBg();return this.Xr.task}pBg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.oLa);this.$f.o8a(h,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,this.gHm,this.eHm,void 0,void 0,void 0,void 0,"21")}}Object(u.a)(mi,"OneDriveForBusinessEndpointHelper",null,[673]);var Ek=e(780);class Ml{constructor(){this.Z=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Ec(b){this.Z=
b;this.Z.register(td,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().fe(()=>new td(Ek.a.instance,y.AFrameworkApplication.J,y.AFrameworkApplication.Wga,y.AFrameworkApplication.awa,y.AFrameworkApplication.mHg,()=>new Od));y.AFrameworkApplication.wWb?this.Z.register(673,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().fe(()=>new nh):this.Z.register(673,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().fe(()=>
new mi(y.AFrameworkApplication.pe));this.Z.register(kh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().fe(()=>new kh(y.AFrameworkApplication.J,y.AFrameworkApplication.Wga,y.AFrameworkApplication.awa,()=>new Od,this.Z.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Z.register(eg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().fe(()=>new eg(y.AFrameworkApplication.J,y.AFrameworkApplication.Wga,y.AFrameworkApplication.awa,
()=>new Od));this.Z.register(Ll,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().fe(()=>new Ll(y.AFrameworkApplication.J,y.AFrameworkApplication.Wga,y.AFrameworkApplication.awa,()=>new Od))}static main(){F.a.instance.Rc(new Ml)}}Object(u.a)(Ml,"PackageManager",null,[0,1]);class Qk{constructor(b,h,r,A,L,ba){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=
b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=A;this.WasServiceDown=L;this.AffinitizedUrl=ba}}Object(u.a)(Qk,"SafeLinksData",null,[]);class km{constructor(b,h){this.JFe=b;this.gB=h}}Object(u.a)(km,"SafeLinksGetUrlReputationRequestData",null,[]);class $l{constructor(b,h,r,A){this.v5n=L=>{let ba="OnGetUrlReputationSuccessCallback: ",ra=10;const Ia=L.data.state;try{const Ta=H.b(L.data.responseData).reputationResults[0],ob=Ta.navigateUrl.length,nb=Ia.JFe.length,Eb=Ta.navigateUrl===
Ia.JFe;Ta.navigateUrl&&0<Ta.navigateUrl.length&&(Ia.JFe=Ta.navigateUrl);ba+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",L.data.Xe,Ta.verdict,nb.toString(),ob.toString(),Eb.toString());ra=50}catch(Ta){ba+=String.format("Exception {0}",Ta.message)}this.rRi(Ia,ba,ra)};this.u5n=L=>{let ba="OnGetUrlReputationFailureCallback: ";const ra=L.data.state;try{ba+=String.format("HttpStatus {0}",L.data.Xe)}catch(Ia){ba+=String.format("Exception {0}",
Ia.message)}this.rRi(ra,ba,10)};this.za=b;this.$f=h;this.EDk=r;$l.qe=A}wDc(b,h,r){try{var A=null;$l.qe&&(A=$l.qe.rg("WebServiceCall","SafeLinksGetUrlReputation"));const L=new km(h,A);A={};A.AffinitizedUrl=b;A.TargetUrl=h;A.PolicyCookie=r;const ba=H.c(A);this.$f.addRequest(this.EDk,2,ba,null,!1,2,this.v5n,this.u5n,L,void 0,void 0,3E3,3E3,"36");return!0}catch(L){v.ULS.sendTraceTag(588788033,378,10,L.message)}return!1}rRi(b,h,r){b.gB&&(b.gB.stop(),b.gB=null);v.ULS.sendTraceTag(588788034,378,r,h);ed.a.Zm(b.JFe,
void 0,"noopener,noreferrer","SafeLinksNav")}}$l.qe=null;Object(u.a)($l,"SafeLinksNavigationHelper",null,[]);var ll;(function(b){b[b.S6p=0]="enabledByPolicy";b[b.lli=1]="disabledByPolicy";b[b.r5p=2]="disabled_GetPolicyFailure";b[b.s5p=3]="disabled_PendingGetPolicyRequest"})(ll||(ll={}));Object(u.b)("SafeLinksNavigationState",ll);class tk{constructor(b,h,r,A=!1,L=null,ba=null){this.IGb=this.HGb=0;this.vbd=this.CFd=!1;this.tmb=null;this.W$b=!0;this.xPd=null;this.UPm=Ta=>{let ob=pa.a.rZn,nb="";try{this.CFd=
this.vbd=!1;var Eb=Ta.data.state;const Sd=({gB:Eb}=this.xEe(Eb)).returnValue,cf=Object.assign(new Sa.a,{durationMs:Sd});Ca.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",cf);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",Ta.data.Xe,Ta.data.responseData.length,Sd);if(Ta.data.Xe!==pa.a.jB)nb="Unexpected httpStatus: "+Ta.data.Xe.toString();else{Eb=null;try{Eb=H.b(Ta.data.responseData)}catch(sf){nb=
"Exception:"+sf.toString()+" deserializing response";return}if(Eb){var bc=Eb.IsSafeLinksEnabled;if(void 0===bc||null===bc||0>=bc.length)nb="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",bc);var Bc=tk.tng(bc);if(void 0===Eb.WebAffinitizedUrl||null===Eb.WebAffinitizedUrl||0>=Eb.WebAffinitizedUrl.length)nb="Invalid WebAffinitizedUrl";else if(void 0===Eb.PolicyCookie||null===Eb.PolicyCookie||0>=Eb.PolicyCookie.length)nb="Invalid PolicyCookie";
else if(void 0===Eb.PolicyCookieTTL||null===Eb.PolicyCookieTTL)nb="Invalid PolicyCookieTTL";else{var Yc=Eb.WebAffinitizedUrl,zd=Eb.PolicyCookie,Jd=Eb.AffinitizedUrl,ie=new Date;ie.setMinutes(ie.getMinutes()+(5<Eb.PolicyCookieTTL?Eb.PolicyCookieTTL-5:0));var re=ie.getTime(),me=new Qk(bc,Yc,zd,re,!1,Jd);this.CSj(me);ob=Ta.data.Xe;this.tmb&&(Bc?(this.P9j(this.tmb),this.IGb=this.HGb=0):(v.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Ca.Health.instance.recordKpiFailure("SafeLinksNavigations",
"disabledByPolicy",!0,!0,null),ed.a.wsb(this.tmb)),this.tmb=null)}}}else nb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Sd){nb="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Sd.toString()}finally{ob!==pa.a.jB&&this.qRi(ob,nb)}};this.TPm=Ta=>{this.CFd=!1;let ob=500,nb="";try{let Eb=Ta.data.state;const bc=({gB:Eb}=this.xEe(Eb)).returnValue,Bc=Object.assign(new Sa.a,{durationMs:bc});ob=Ta.data.Xe;Ca.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+ob.toString(),!1,!0,Bc);nb="Request Failed, Status="+mj.a[Ta.data.status]+" Duration: "+bc}catch(Eb){nb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Eb.toString()}finally{this.qRi(ob,nb)}};v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.za=b;this.$f=h;this.YH=r;tk.qe=ba;this.PYk=A?this.za.rb("SafeLinksHandlerWebServiceBase"):this.za.rb("WebServiceBase");this.lYk=this.za.rb("SafeLinksHashedUserId");this.gSp=this.za.rb("SafeLinksWorkloadIdHeaderValue");
this.bKd=this.za.sc("SafeLinksMaxGetPolicyBootRetries",2);this.cKd=this.za.sc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.LHd=this.oyn();this.KHd=this.nyn();tk.qPh=this.za.rb("UserPrincipalName")||"";tk.zTc=this.za.rb("TenantId")||"";v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.LHd,this.KHd);if(this.LHd&&this.KHd){h=(b=this.atb())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.x3f();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",
h,r);var ra=!b||"unknown"===h||b.WasServiceDown||r,Ia=ub.a.HI();Ia&&(Ia.set("shouldGetSafeLinksDataFromServer",ra.toString()),Ia.set("isSafeLinksEnabledCacheValue",h.toString()));L?(this.W$b=!1,L.execute(Ta=>{Ta.isFeatureEnabled("MsoUrlreputation",!0).then(ob=>{this.W$b=ob;Ia.set("isUserLicensedForSafeLinks",this.W$b.toString());Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ia);this.W$b&&ra&&this.ibe(!0);return null})})):(Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",
0,"jpittsdirects",Ia),ra&&this.ibe(!0))}}get appName(){return this.YH}get $Je(){return this.PYk}get userId(){return this.lYk}get QOi(){try{if(""===tk.KWe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=y.AFrameworkApplication.buildVersion;b.OS=this.za.rb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);tk.KWe=window.self.btoa(h)}}catch(b){v.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return tk.KWe}get rMm(){const b=this.$Je?this.$Je+
"/":"",h=new Ua.QueryStringBuilder("SafeLinksHandler.ashx");h.Me("app",this.appName);this.za.$("SafeLinksUseDebugHeader")&&h.Me("action","debug");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Me("s2satpop","1");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Me("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.lm)}get LWm(){const b=this.$Je?this.$Je+"/":"",h=new Ua.QueryStringBuilder("SafeLinksHandler.ashx");
h.Me("app",this.appName);this.za.$("SafeLinksUseDebugHeader")&&h.Me("action","debug");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Me("s2satpop","1");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Me("s2saat","1");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Me("s2se03","1");this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&
h.Me("sladpar",this.QOi);h.Me("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.lm)}get HXn(){tk.t$e||(tk.t$e=new $l(this.za,this.$f,this.LWm,tk.qe));return tk.t$e}wDc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.fsn(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.LHd,this.KHd,this.W$b);if(!(h&&this.LHd&&this.KHd&&this.W$b))return!1;h=0;const r=({state:h}=this.rcp()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",ll[h]);const A=ub.a.HI();A&&A.set("SafeLinksNavigationState",ll[h]);Ca.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",A);if(!r)return 2!==h&&3!==h||Ca.Health.instance.recordKpiFailure("SafeLinksNavigations",ll[h],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.Qcp())return this.x3f()?!1:this.HXn.wDc(this.bnm(),b,this.GJi());if(!this.x3f())return this.P9j(b),!0;this.tmb=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.vbd=!1;this.ibe();return!0}fsn(b){b=b.toLowerCase();const h=this.za.kF("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}ibe(b=!1){var h=ub.a.HI();h&&h.set("isOnBootRequest",b.toString());
Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.Hvf("SafeLinksGetPolicy");this.$f.addRequest(this.rMm,1,null,null,!0,2,this.UPm,this.TPm,h,void 0,void 0,void 0,void 0,"23");this.vbd=b;this.CFd=!0;b?this.HGb++:this.IGb++}qRi(b,h=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.HGb<this.bKd&&this.IGb<
this.cKd)this.ibe(this.vbd);else{this.vbd=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.HGb,this.IGb,b,h);h=null;const r=ub.a.HI();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new Sa.a,{extendedProperties:r}));Ca.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const A=new Qk("false","","",0,!0,"");this.CSj(A);this.tmb&&(v.ULS.sendTraceTag(26019603,
378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Ca.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),ed.a.wsb(this.tmb),this.tmb=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}P9j(b){const h=this.GJi(),r=this.XXm(),A={};A.Url=b;A.SafeLinksCookie=h;A.CorrelationId=qb.a.create().toString();A.WorkloadId=this.gSp;A.UserAgentInfo=X.a.aG+
"|"+this.appName;this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(A.User=tk.qPh,A.TenantId=tk.zTc,A.AdditionalProperties=this.QOi);v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",A.CorrelationId);ed.a.gue(ed.a.Fya(4),r,A)}oyn(){const b=this.za.rb("IsSafeLinksEnabledForUser");return b?tk.tng(b):!1}nyn(){const b=this.za.kF("SafeLinksDisabledBrowsers");if(X.a.r9){if(this.za.RA("SafeLinksForTeamsIsEnabled")&&this.za.$("SafeLinksForTeamsIsEnabled"))return!0;
if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,X.a.aG))return!1;return"officecomhwa"===(this.za.rb(y.AFrameworkApplication.Zja)||"").toLowerCase()?!1:!0}Qcp(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&X.a.Xbd?!0:X.a.r9||X.a.G9i}rcp(){let b;b=0;const h=this.atb(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),
{returnValue:!1,state:2}):"false"===r.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:tk.tng(r),state:b};if(this.CFd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.HGb>=this.bKd||this.IGb>=this.cKd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.HGb,this.bKd,this.IGb,
this.cKd),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.bKd+this.cKd-(this.HGb+this.IGb));return{returnValue:!0,state:b}}GJi(){const b=this.atb();return b?b.PolicyCookie:""}XXm(){const b=this.atb();return b?b.WebAffinitizedUrl:""}bnm(){const b=this.atb();return b?b.AffinitizedUrl:""}lym(){const b=new Date;try{const h=this.atb();
b.setTime(h?h.PolicyCookieTTL:0)}catch(h){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}x3f(){const b=this.lym();return!!b&&b.getTime()<Date.now()}atb(){if(!this.xPd){const b=Ja.a.instance.getItem(this.userId);if(!b||""===b)return null;this.xPd=JSON.parse(b)}return this.xPd}CSj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.xPd=b;b.WasServiceDown||this.vSp(b)}vSp(b){b=JSON.stringify(b);Ja.a.instance.setItem(this.userId,b)}Hvf(b){return void 0!==tk.qe&&null!==tk.qe?tk.qe.rg("WebServiceCall",b):null}xEe(b){if(void 0!==b&&null!==b){const h=b.qj;b.stop();return{returnValue:h,gB:null}}return{returnValue:null,gB:b}}static tng(b){return"false"!==b.toLowerCase()?!0:!1}}tk.qe=null;tk.t$e=null;tk.zTc="";tk.qPh="";tk.KWe="";Object(u.a)(tk,"SafeLinksManager",null,[685]);const am=b=>{switch(b){case 3:return"Word";case 1:return"Excel";
case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},bf=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Cj{constructor(){this.Z=null;this.Gz=()=>{y.AFrameworkApplication.J.$("WACSafeLinksIsEnabled")&&(this.Z.register(tk,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().fe(()=>new tk(y.AFrameworkApplication.J,y.AFrameworkApplication.pe,String.format("{0}-{1}",
am(y.AFrameworkApplication.ta.Pb.gl),bf(y.AFrameworkApplication.ta.Pb.Uoa)),!1,this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),y.AFrameworkApplication.ta.Kt)),this.Z.Wa("Common.App.SafeLinks.ISafeLinksManager"))}}get name(){return"Common.App.SafeLinks"}Ec(b){this.Z=b}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.lq(this.Gz)}dispose(){}static main(){F.a.instance.Rc(new Cj)}}Object(u.a)(Cj,"SafeLinksPackage",null,[0,1]);var Wh=e(228);class zk{constructor(b){this.sa=
new Nf.a;this.mi=b}Aob(b){this.sa.addHandler(zk.jGa,b)}ood(b){this.sa.removeHandler(zk.jGa,b)}HVa(b){this.sa.addHandler(zk.d3a,b)}S0b(b){this.sa.removeHandler(zk.d3a,b)}zjf(b){this.sa.addHandler(zk.UCc,b)}HGg(){this.sa.raiseEvent(zk.jGa)}MVf(){return Wh.a.instance.a_a(y.AFrameworkApplication.accessTokenTtl)}}zk.jGa="SE";zk.Qqd="SEP";zk.d3a="SER";zk.UCc="TRP";Object(u.a)(zk,"NullSessionExpirationManager",null,[447,448]);class Hl{constructor(){this.sSc=this.lnb=!1;this.Evc=()=>{Wh.a.instance.YJj(this.Evc);
v.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.cVf()};this.ajd=()=>{Wh.a.instance.wJo(this.ajd);this.sSc||this.lnb||(v.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.sSc=!0,this.oHg())};const b=y.AFrameworkApplication.accessTokenTtl;0>=b||(this.accessTokenTtl=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.eH}),
Wh.a.instance.qVh(this.Evc),Wh.a.instance.pVh(this.ajd))}cVf(){this.lnb||(y.AFrameworkApplication.pU(Vi.a.Pqd),this.lnb=!0,this.rDe())}}Object(u.a)(Hl,"ASessionExpirationManager",null,[]);var Xf=e(191),we=e(555);class Rk{constructor(b,h,r,A){this.YLg="";this.uzd=b;this.CJh=r;this.yJh=A;this.Wth=h;b=(new Date(this.uzd)).format(y.AFrameworkApplication.PXj);this.YLg=this.Wth?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}zzc(b){1===b?
this.CJh&&this.CJh(this.Wth):0===b&&y.AFrameworkApplication.va.Zb(wb.a.close,2,we.g)}dispose(){this.yJh&&this.yJh()}}Rk.id="SessionExpirationDialog";Object(u.a)(Rk,"SessionExpirationDialogSharedProperties",null,[]);class ml{}ml.Fh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(u.a)(ml,"SessionExpirationDialogHtml",null,[]);class Nl extends Xf.a{constructor(b,h,r,A){super(h);const L={};this.v7a=
new Rk(b,h,r,A);this.$g=Rk.id;y.AFrameworkApplication.g4h?(this.Md=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.Md=0,this.hv=!1);h||1===y.AFrameworkApplication.ta.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Fh=ml.Fh;L.WACSessionExpirationText=this.v7a.YLg;this.ti(CommonUIStrings.l_DefaultDialogTitle,Object(E.a)(this,this.zzc,"sessionExpirationDialogHandler"),L);this.u$(this.Vj("WACSessionExpirationText"))}zzc(b){this.v7a.zzc(b)}gWf(){this.hide()}dispose(){super.dispose();
this.v7a&&this.v7a.dispose()}}Object(u.a)(Nl,"LegacySessionExpirationDialog",Xf.a,[532]);class kk extends wg.StandardDialog{constructor(b,h,r,A){super(h);this.v7a=new Rk(b,h,r,A);this.$g=Rk.id;y.AFrameworkApplication.g4h?(this.Md=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.Md=0,this.hv=!1);h||1===y.AFrameworkApplication.ta.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Yx(CommonUIStrings.l_DefaultDialogTitle,
this.v7a.YLg,0,Object(E.a)(this,this.zzc,"sessionExpirationDialogHandler"))}zzc(b){this.v7a.zzc(b)}gWf(){this.hide()}dispose(){super.dispose();this.v7a&&this.v7a.dispose()}}Object(u.a)(kk,"SessionExpirationDialog",wg.StandardDialog,[532]);const Sn=(b,h,r,A)=>y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.J.$("ReactStandardSessionExpirationDialogIsEnabled")?new kk(b,h,r,A):new Nl(b,h,r,A);var kg=e(209);class gb extends Hl{constructor(b){super();this.aQd=this.Tcc=
!0;this.P3=null;this.sa=new Nf.a;this.ojc=()=>{this.P3=null};this.Azc=h=>{(h||this.mi.PWd())&&this.mi.Yda(null)};this.mi=b}Aob(b){this.sa.addHandler(gb.jGa,b)}ood(b){this.sa.removeHandler(gb.jGa,b)}HVa(b){this.sa.addHandler(gb.d3a,b)}S0b(b){this.sa.removeHandler(gb.d3a,b)}zjf(b){this.sa.addHandler(gb.UCc,b)}MVf(){return Wh.a.instance.a_a(y.AFrameworkApplication.accessTokenTtl)}HGg(b){this.Tcc=b}oHg(){this.P3||kg.a.SQ||(this.aQd&&(this.P3=Sn(this.accessTokenTtl,!1,this.Azc,this.ojc)),this.sa.raiseEvent(gb.Qqd))}rDe(){this.P3&&
(this.P3.toa&&this.P3.gWf(),this.P3=null);this.Tcc&&(this.P3=Sn(this.accessTokenTtl,!0,this.Azc,this.ojc));this.sa.raiseEvent(gb.jGa)}}gb.jGa="SE";gb.Qqd="SEP";gb.d3a="SER";gb.UCc="TRP";Object(u.a)(gb,"SessionExpirationManager",Hl,[447,448]);class Fb{}Fb.uZk="Aborting";Fb.$Td="ActivityDuration";Fb.error="Error";Fb.yEf="Errors";Fb.zC="Failed";Fb.BRb="FirstActivity";Fb.initialized="Initialized";Fb.q$i="KickedOut";Fb.xEn="LastActivity";Fb.hNj="RetryOverride";Fb.uye="RequestGroups";Fb.requests="Requests";
Fb.responses="Responses";Fb.oAe="SessionDuration";Fb.status="Status";Fb.success="Success";Fb.hnp="Successful";Fb.tokens="Tokens";Fb.Jog="PollingDuration";Object(u.a)(Fb,"SessionExpirationStrings",null,[]);class Wb{constructor(b){this.LF={};this.Jqa={};this.F6a={};this.Xej=15;this.Zvh=!1;this.NSk=new Date;this.XId=new Date;this.yik=()=>{v.ULS.sendTraceTag(41964821,217,50,v.ULS.Mdd({["Aggregate"]:this.Jqa,["Current"]:this.LF}))};this.Sb=b;this.wS=new Md.a(2,2,6E4*this.Xej,this.yik,135,"SL",!1);this.Sb.pc(this.wS);
this.ren()}ren(){this.Jqa[Fb.uye]=0;this.Jqa[Fb.requests]=0;this.Jqa[Fb.responses]=0;this.Jqa[Fb.status]=Fb.initialized;this.Jqa[Fb.BRb]=new Date;this.Jqa[Fb.oAe]=0;this.Jqa[Fb.$Td]=0;this.Jqa[Fb.oAe]=0;this.LF[Fb.oAe]=0;this.Jqa[Fb.$Td]=0;this.LF[Fb.$Td]=0}get dko(){this.F6a[Fb.Jog]=+new Date-+this.F6a[Fb.BRb];return this.F6a}VXf(b,h){var r=b[h];r=r?r:0;r++;b[h]=r;this.oDg(b)}oDg(b){const h=new Date;b[Fb.$Td]=+h-+this.XId;this.XId=h;b[Fb.oAe]=+this.XId-+this.NSk;b[Fb.xEn]=this.XId}jea(b,h){this.LF[b]=
h;this.oDg(this.LF)}ECg(b,h){this.LF[b]=h;this.oDg(this.LF)}Zoc(b){this.VXf(this.LF,b);this.VXf(this.Jqa,b);this.VXf(this.F6a,b)}flush(){this.Zvh||(this.Jqa[Fb.status]=this.LF[Fb.status],this.yik(this.wS),this.Sb.Z5(this.wS,6E4*this.Xej))}INo(){const b=this.LF[Fb.status];b&&(this.Jqa[Fb.status]=b);this.LF={}}UNo(){this.F6a={};this.F6a[Fb.Jog]=0;this.F6a[Fb.BRb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Zvh=!0;this.Sb.Kf(this.wS)}}
Object(u.a)(Wb,"SessionLogger",null,[443]);class Cc{constructor(b,h){this.YRd=b;this.jIa=h}get tokens(){return this.YRd}get errors(){return this.jIa}}Object(u.a)(Cc,"TokenRefreshArgs",null,[488]);var id=e(266);class Ad extends Sys.EventArgs{constructor(b,h,r,A,L,ba,ra){super();this.F6a=b;this.Ujo=h;this.uye=A;this.zC=L;this.requests=ba;this.responses=ra}}Object(u.a)(Ad,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Cd=e(25);class qe{constructor(b,h=null,r=null){this.sSc=this.lnb=!1;this.aQd=
this.Tcc=!0;this.sa=new Nf.a;this.vSc=this.eNc=this.QNd=!1;this.IJb=null;this.cFh=10;this.oId=!1;this.Pzo=()=>{this.D8c(!1);return!Wh.a.instance.a_a(y.AFrameworkApplication.accessTokenTtl)};this.mZk=(A,L)=>{Wh.a.instance.qje?this.Evc(A,L):this.S0e?(this.eNc=!1,this.D8c(!1)):(this.lnb||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.Evc(A,L))};this.nZk=(A,L)=>{Wh.a.instance.pje?this.ajd(A,L):(Cd.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),
this.eNc=!1,this.D8c(!0))};this.Ggf=(A,L)=>{Wh.a.instance.pje?this.ajd(A,L):this.D8c(!0)};this.Evc=()=>{this.S0e||Wh.a.instance.YJj(this.Evc);v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.cVf(Wh.a.instance.qje)};this.Rtp=()=>{const A=this.Tc.dko;v.ULS.sendTraceTag(555255521,217,50,"{0}",H.c(A));this.sa.raiseEvent(qe.UCc,new Ad(A,A[Fb.Jog],A[Fb.BRb],A[Fb.uye],A[Fb.zC],A[Fb.requests],A[Fb.responses]))};this.amo=()=>{3E5<+new Date-+this.wxh?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),
this.D8c(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.Udf=b;this.S0e=y.AFrameworkApplication.uCn;this.Sb=vb.TaskManager.instance;v.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:y.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.eH});this.Tc=h||new Wb(vb.TaskManager.instance);this.yla=r;Wh.a.instance.qVh(this.mZk);
Wh.a.instance.pVh(this.Ggf);id.SessionStatusManager.instance.xjf(this.Ggf);id.SessionStatusManager.instance.F8k(this.amo);this.wxh=new Date;y.AFrameworkApplication.tCn&&(Wh.a.instance.Cqf=this.Pzo);b=!1;y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.cFh=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),b=y.AFrameworkApplication.J.$("WopiTokenRefreshWhenNetworkResumed"));b?id.SessionStatusManager.instance.xjf(this.nZk):id.SessionStatusManager.instance.xjf(this.Ggf)}Aob(b){this.sa.addHandler(qe.jGa,b)}ood(b){this.sa.removeHandler(qe.jGa,b)}HVa(b){this.sa.addHandler(qe.d3a,b)}S0b(b){this.sa.removeHandler(qe.d3a,b)}zjf(b){this.sa.addHandler(qe.UCc,b)}MVf(){return Wh.a.instance.a_a(y.AFrameworkApplication.accessTokenTtl)}D8c(b){if(!this.QNd&&!this.eNc)if(this.yla&&this.yla.nq)this.vSc=!0,this.Tc.jea(Fb.status,
Fb.q$i),this.Tc.flush(),this.Tc.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.vSc),this.vSc)this.rDe();else{this.Tc.flush();this.Tc.INo();this.Tc.Zoc(Fb.uye);this.QNd=!0;this.oId||(this.Tc.UNo(),this.oId=!0,this.NJl());const h=this.Udf.hAo(b);h.continueWith(()=>{if(this.Udf.mqo(h))this.Tc.Zoc(Fb.hnp),this.Tc.jea(Fb.status,Fb.success),this.aQd=!1,this.S0e&&(this.Tcc=!1),this.eNc=!1,this.wxh=new Date,this.Olp(),this.sa.raiseEvent(qe.d3a,
new Cc(h.result.tokens,null));else{const r=h.result.errors;this.Tc.Zoc(Fb.zC);this.Tc.jea(Fb.status,Fb.zC);b||(this.vSc=this.Udf.rcd(r));this.vSc&&(this.Tc.jea(Fb.uZk,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.eNc=!0;this.sa.raiseEvent(qe.d3a,new Cc(null,r))}this.Tc.flush();this.QNd=!1})}}ajd(){this.sSc||this.lnb||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.sSc=!0,this.oHg(Wh.a.instance.pje))}cVf(b){if(!this.lnb){var h=
b?Vi.a.AYo:Vi.a.Pqd;const r=Object.assign(new Sa.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));y.AFrameworkApplication.pU(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(y.AFrameworkApplication.eH),v.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&Ca.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&
Ca.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.lnb=!0;this.rDe()}}Olp(){this.oId&&(this.Sb.Kf(this.IJb),this.oId=!1)}NJl(){this.IJb=new Md.a(2,2,1E3*this.cFh,this.Rtp,135);this.Sb.pc(this.IJb)}}qe.jGa="SE";qe.Qqd="SEP";qe.d3a="SER";qe.UCc="TRP";Object(u.a)(qe,"ASessionExpirationManagerWithRefresh",null,[]);class df extends qe{constructor(b,h,r=null,A=null){super(h,r,A);this.P3=null;this.ojc=()=>{this.P3=null};this.Azc=L=>{(L||
this.mi.PWd())&&this.mi.Yda(null)};this.mi=b}HGg(b){this.Tcc=b}oHg(b){if(!this.P3&&!kg.a.SQ){if(b)this.P3=Sn(y.AFrameworkApplication.kja,!1,this.Azc,this.ojc);else if(this.aQd){if(this.QNd)return;this.P3=Sn(y.AFrameworkApplication.accessTokenTtl,!1,this.Azc,this.ojc)}v.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",qe.Qqd,b);this.sa.raiseEvent(qe.Qqd)}}rDe(){this.P3&&(this.P3.toa&&this.P3.gWf(),this.P3=null);if(this.Tcc){this.Tc.stop();if(this.yla&&this.yla.nq)return;
this.P3=Sn(y.AFrameworkApplication.accessTokenTtl,!0,this.Azc,this.ojc)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",qe.jGa);this.sa.raiseEvent(qe.jGa)}}Object(u.a)(df,"SessionExpirationManagerWithRefresh",qe,[447,448]);class Ef{constructor(b,h,r=null,A=null){this.ZOh=!1;this._instance=null;this._frame=b;this.vq=h;this.Tc=r||new Wb(vb.TaskManager.instance);this.yla=A}create(){this.ZOh=y.AFrameworkApplication.jia;if(!this.ZOh)return new gb(this._frame);v.ULS.sendTraceTag(39408088,217,50,
"App has requested custom Session Expiration Manager");if(!this._instance)switch(y.AFrameworkApplication.EOp){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new zk(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new df(this._frame,this.vq,this.Tc,this.yla);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=
new gb(this._frame)}v.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(u.a)(Ef,"SessionExpirationManagerFactory",null,[446]);class Sf{}Object(u.a)(Sf,"Error",null,[]);class Je{}Object(u.a)(Je,"NamedResult",null,[]);class Ug extends Je{}Object(u.a)(Ug,"ErrorInfo",Je,[]);var Kf=e(1082);class fl{constructor(b,h,r,A=null,L=!1,ba=null,ra=!1,Ia=!1,Ta=!1,ob=!1,nb=!1){this.lJa=0;this.Ala=this.wq=
null;this.YRd=new Cb.a;this.jIa=new Cb.a;this.Xr=null;this.OMc=!1;this.ITc=this.JTc=null;this.bNo=()=>{this.OLj()};this.Sb=b;this.gFh=h;this.gFh.execute(Eb=>{Eb.DG(J.a.MWf,Object(E.a)(this,this.N5n,"onHostResponseReceived"))});this.J7=r;this.ENh=new Kf.a("WebServiceCall","TokenRefresh");this.Tc=A||new Wb(b);this.FSk=L;this.qf=ba?ba:id.SessionStatusManager.instance;this.Tlh=ra;this.XDd=Ia;this.$Sk=Ta;this.aTk=ob;this.ZJh=nb}N5n(b){if(b.MessageId!==J.a.MWf)Cd.b(39408099,306,15,"Unexpected message.");
else{var h=new Cb.a,r=new Cb.a;this.Tc.Zoc(Fb.responses);var A=b.Values[G.a.cSj];if(!A||0>=A.length)Cd.b(40122317,306,15,"Found no tokens in the dictionary"),A=b.Values;Cd.b(40122318,306,100,"The Tokens array contains {0} tokens",A.length);this.Tc.jea("Correlation",b.CorrelationId);var L="";for(let Ia=0;Ia<A.length;Ia++){this.Tc.ECg(Fb.tokens,A.length);var ba=A[Ia],ra=ba;if(!ra||!ra.Name)continue;this.Tc.Zoc(ra.Name);const Ta=ba;if(Ta&&Ta.Value)Cd.b(39408128,306,100,"Received token with name: {0}",
Ta.Name),h.add(Ta),this.YRd.add(Ta),this.XDd||this.Tc.jea(Fb.status,Fb.success),this.Tlh&&this.qf&&this.qf.kOo();else if(ba=this.dQm(ba),Cd.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ra.Name,JSON.stringify(ba),this.Ala),r.add(ba),this.XDd||(this.jIa.add(ba),L=JSON.stringify(ba),this.Tc.jea(Fb.error,JSON.stringify(ba)),this.Tc.jea(Fb.status,Fb.zC)),this.Tlh)for(const ob of ba.Errors)ra=this.Yxm(ob),this.qf&&this.qf.M5k(ra)}this.XDd?(0<r.count?this.ITc?
this.ITc(new Cc(h,r)):Cd.b(512267295,306,15,"Received errors but the promise has completed"):this.JTc?this.JTc(new Cc(h,r)):Cd.b(512267294,306,15,"Received valid tokens but the promise has completed"),Cd.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.Ala)):(0<r.count&&""!==L?(A=Object.assign(new Sa.a,{extendedProperties:new Map}),A.extendedProperties.set("Errors",L),A.extendedProperties.set("RetryCount",
this.lJa.toString()),A.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),A.extendedProperties.set("IsTokenExpiring",this.OMc.toString()),this.Z3f()&&A.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.isShuttingDown.toString()),Ca.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,A)):Ca.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Cd.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,r.count,b.CorrelationId,this.Ala),0<r.count&&!this.rcd(r)?(b=this.J7.VKi(r),b!==this.J7.Dyc&&(this.Tc.ECg(Fb.hNj,b),this.Sb.Z5(this.wq,b))):(this.Tc.flush(),this.wq&&(Cd.b(39408131,306,100,"Deleting task {0} from task manager",this.wq.name),this.Sb.Kf(this.wq)),this.Xr&&!this.Xr.task.isCompleted?this.Xr.setResult(new Cc(h,r)):Cd.b(512267293,306,15,"Received results but the task has completed")))}}dQm(b){if(!b)return null;const h=Object.assign(new Ug,{Name:b.Name,Errors:[],SPCorrelationId:b.SPCorrelationId});
for(const r of b.Errors)b=new Sf,b.Id=r.Id,b.Details=ua.a.xTb(r.Details,500),h.Errors.push(b);return h}OLj(){y.AFrameworkApplication.ud("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.lJa>=this.J7.Xme?(Cd.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Ala),this.ILl(this.Xr)):(Ca.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.kRj())}kRj(){const b={};b[G.a.cSj]=this.J7.tokens;this.$Sk&&(b[G.a.EYo]=this.aTk);const h=
qb.a.create().toString();Cd.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.J7.tokens),this.lJa+1,h,this.Ala);this.gFh.execute(r=>{r.sendMessage(J.a.jlf,b,h)});this.lJa++;this.Tc.Zoc(Fb.requests)}ILl(b){const h=new Cb.a;for(let r=0;r<this.J7.tokens.length;r++){const A=Object.assign(new Ug,{Name:this.J7.tokens[r],Errors:[Object.assign(new Sf,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(A);this.jIa.add(A)}this.Sb.Kf(this.wq);this.Tc.jea(Fb.yEf,JSON.stringify(this.jIa));this.Tc.jea(Fb.status,Fb.zC);b&&!b.task.isCompleted&&b.setResult(new Cc(new Cb.a,this.jIa))}Z3f(){return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}hAo(b){y.AFrameworkApplication.ud("ej4if276;fheca743");y.AFrameworkApplication.ud("5d4fi128;abe10395");zi.a.rx("7db39907;cegi0367;ijicc640");this.ENh.start();this.Z3f()&&this.Sb.uub&&(Cd.b(508351137,
306,15,"Restarting taskmanager, is shutting down {0}",y.AFrameworkApplication.isShuttingDown),this.Sb.restart());this.OMc=b;this.Ala=qb.a.create().toString();Cd.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Ala,this.OMc);this.lJa=0;this.jIa.clear();this.YRd.clear();this.Xr=new zg.a;this.XDd?this.PLj(this.J7.Xme).then(h=>{this.Xr&&!this.Xr.task.isCompleted&&this.Xr.setResult(h);this.ITc=this.JTc=null;this.Tc.jea(Fb.yEf,JSON.stringify(this.jIa));this.Tc.jea(Fb.status,
Fb.success);this.Tc.flush()}).catch(h=>{this.Xr&&!this.Xr.task.isCompleted&&this.Xr.setResult(Object(ya.a)(488,h));this.ITc=this.JTc=null;this.Tc.jea(Fb.yEf,JSON.stringify(this.jIa));this.Tc.jea(Fb.status,Fb.zC);this.Tc.flush()}):(this.wq=new Md.a(this.J7.priority,2,this.J7.Dyc,this.bNo,98,J.a.jlf,!0),this.FSk&&this.OLj(),this.Sb.pc(this.wq));return this.Xr.task}PLj(b){const h=this,r=new Promise((Ia,Ta)=>{h.JTc=Ia;h.ITc=Ta;Ca.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.kRj()}),
A=this,L=new Promise((Ia,Ta)=>{window.setTimeout(()=>{Ta(A.eei("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},A.J7.Dyc)});let ba=b;const ra=this;return new Promise((Ia,Ta)=>{ba--;Promise.race([r,L]).then(ob=>{Ca.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ia(ob)}).catch(ob=>{var nb=ra.J7.Dyc;if(Object(Pb.a)(488,ob)&&(ob=Object(ya.a)(488,ob),0<ob.errors.count)){ra.ZKn(ob.errors);ra.xSh(ob.errors);if(ra.rcd(ob.errors)){Ta(ob);return}const Eb=
ra.J7.VKi(ob.errors);Eb!==ra.J7.Dyc?(ra.Tc.ECg(Fb.hNj,Eb),nb=Eb):ra.PAn(ob.errors)&&(nb=0)}ba?window.setTimeout(()=>{ra.PLj(ba).then(Ia).catch(Ta)},nb):(nb=ra.eei("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ra.xSh(nb.errors),Ta(nb),Cd.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",ra.Ala))})})}xSh(b){for(const h of b)this.jIa.add(h)}PAn(b){if(!b.count)return!1;b=b.K(b.count-1);return b.Errors.length?
"TIMEOUT"==b.Errors[0].Id:!1}eei(b,h){const r=new Cb.a;for(let A=0;A<this.J7.tokens.length;A++){const L=this.JLl(this.J7.tokens[A],b,h);r.add(L)}return new Cc(new Cb.a,r)}JLl(b,h,r){return Object.assign(new Ug,{Name:b,Errors:[Object.assign(new Sf,{Id:h,Details:r})]})}ZKn(b){if(b.count){b=b.K(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Sa.a,{extendedProperties:new Map});h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.lJa.toString());h.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.OMc.toString());this.Z3f()&&h.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.isShuttingDown.toString());Ca.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.Tc.jea(Fb.error,b);this.Tc.jea(Fb.status,Fb.zC)}}mqo(b){this.ENh.stop();const h=this.h4m(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.Ala,this.OMc,this.lJa,this.jIa.count,0<b.result.errors.count?b.result.errors.K(0).Name:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Details:"");return h?!1:this.lqo(b.result.tokens)}rcd(b){return this.J7.rcd(b)}lqo(b){for(let h=0;h<b.count;h++){const r=b.K(h);if(r.Name===G.a.accessToken){const A=(new Date).getTime();r.Expiry>y.AFrameworkApplication.accessTokenTtl?
(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.eH},"PreviousAccessTokenTtl",y.AFrameworkApplication.accessTokenTtl),y.AFrameworkApplication.accessToken=r.Value,y.AFrameworkApplication.accessTokenTtl=Math.floor(r.Expiry),y.AFrameworkApplication.J5b=A,y.AFrameworkApplication.Nla=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.eH},"PreviousAccessTokenTtl",y.AFrameworkApplication.accessTokenTtl)}}return!0}h4m(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const A=b.K(r);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",A.Name,JSON.stringify(A.Errors),this.Ala,A.SPCorrelationId)}return h}K8i(b){return b.includes("aadInteractionRequired")||b.includes("sessionRevocation")||b.includes("blockAccessForTenantRestrictions")||
b.includes("revoked")||b.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}Yxm(b){let h=Vi.a.Pqd;const r=parseInt(b.Id);b=b.Details.toString();if(isNaN(r))h=Vi.a.yhk;else{switch(r){case 401:h=Vi.a.vEc;this.ZJh&&this.K8i(b)&&(h=Vi.a.uEc);break;case 403:h=Vi.a.gKe;this.ZJh&&this.K8i(b)&&(h=Vi.a.uEc);break;case 500:h=Vi.a.xhk;break;case 503:h=Vi.a.Ahk}h===Vi.a.Pqd&&(h=500<r?Vi.a.zhk:Vi.a.whk)}return h}}Object(u.a)(fl,"TokenRefreshManager",null,
[445]);class Ji{constructor(){this.Dyc=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.WopiTokenRefreshRetryInterval",y.AFrameworkApplication.HOp);this.Xme=y.AFrameworkApplication.FOp;this.tokens=y.AFrameworkApplication.kZm();this.priority=y.AFrameworkApplication.IOp;this.HHh=this.T4o();this.mgf=y.AFrameworkApplication.jZm()}rcd(b){b=JSON.stringify(b);if(this.mgf&&0<this.mgf.length)for(const h of this.mgf)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}VKi(b){try{if(b)for(const h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in
this.HHh)return Number.parseInvariant(this.HHh[r.Id].toString())}catch(h){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Dyc}T4o(){const b={};try{if(!y.AFrameworkApplication.oce()||0>=y.AFrameworkApplication.oce().length||""===y.AFrameworkApplication.oce()[0])return b;for(const h of y.AFrameworkApplication.oce())0<h.length&&(b[h]=y.AFrameworkApplication.GOp)}catch(h){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(u.a)(Ji,"TokenRefreshPolicy",null,[444]);class lk{constructor(){this.Z=null}get name(){return"Common.App.SessionExpiration"}init(){y.AFrameworkApplication.J.lq(()=>{this.Wbb()})}Wbb(){this.Z.resolve("Common.ISessionExpirationManagerFactory");this.Z.resolve("Common.ISessionExpirationManager");this.Z.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Ec(b){this.Z=b;b.register(443,"Common.App.SessionExpiration.ISessionLogger").ha().fe(()=>new Wb(vb.TaskManager.instance));
b.register(444,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().fe(()=>new Ji);b.register(445,"Common.App.SessionExpiration.ITokenRefreshManager").ha().fe(()=>new fl(vb.TaskManager.instance,y.AFrameworkApplication.NL(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),y.AFrameworkApplication.J.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Wa("Common.ISessionStatus"),y.AFrameworkApplication.J.$("WopiAllowTokenRefreshErrorTracking"),
y.AFrameworkApplication.J.$("WopiTokenRefreshSyncMessageWithTimeout"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",!1)&&y.AFrameworkApplication.J.$("ShowTokenRevocationErrorMessage")));b.register(446,"Common.ISessionExpirationManagerFactory").ha().fe(()=>
new Ef(y.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Wa("Common.ISessionStatus")));b.register(447,"Common.ISessionExpirationManagerWithDialog").ha().fe(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(448,"Common.ISessionExpirationManager").ha().fe(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){F.a.instance.Rc(new lk)}}Object(u.a)(lk,"SessionExpirationPackage",
null,[0,1]);var Sj=e(784),dk=e(422),Zd=e(352),qg=e(219);class sh extends qg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(u.a)(sh,"PersonaButtonProps",qg.a,[]);class qi{lic(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new Zd.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.aMl(b,r.ControlList);h.push(r)}}aMl(b,h){const r=Object.assign(new Sj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new dk.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new Zd.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.iPl(b,h.ControlList)}iPl(b,h){for(let r=0;r<b.length;r++){const A=Object.assign(new sh,{ExternalId:String.format("CoauthorPersona_{0}",r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});
Array.add(h,A)}}}Object(u.a)(qi,"PresenceContextMenuSectionBuilder",null,[811]);var Dm=e(113);class Ci{constructor(b,h,r,A){this.Sya=this.pv=this.wq=this.Xi=this.dSa=null;this.qhl=()=>{this.gQd.w_h()};this.Uta=L=>{1===L?(Ek.a.xte(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),y.AFrameworkApplication.va.Vb(wb.a.X6f,2)):(this.jdp(),y.AFrameworkApplication.va.Vb(wb.a.G4h,2))};this.Pol=()=>{this.N_l();y.AFrameworkApplication.va.Vb(wb.a.F4h,2)};this.gQd=b;this.WTk=A;this.gQd.wad&&
(this.wq=new Md.a(3,2,5E3,this.qhl,2),y.AFrameworkApplication.zc.pc(this.wq),this.mc(h,r));this.gQd.w6k(()=>{this.$Yb()});this.gQd.oUh(()=>{this.aZb()})}get IS(){return this.pv||(this.pv=Xa.a.instance.Wa("CommonUI.IBusinessBar"))}get s2h(){return this.Sya||(this.Sya=Xa.a.instance.Wa("CommonUI.IBusinessBarEntryFactory"))}mc(b,h){const r=y.AFrameworkApplication.va;r.nb(wb.a.x_h,dd.a.frame,b,96);r.nb(wb.a.y_h,dd.a.frame,h,96);r.qa(wb.a.F4h,dd.a.frame,qf.ActionManager.UV);r.qa(wb.a.G4h,dd.a.frame,qf.ActionManager.UV);
r.qa(wb.a.X6f,dd.a.frame,qf.ActionManager.UV)}$Yb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);y.AFrameworkApplication.va.Vb(wb.a.x_h,2)}aZb(){this.Gqp();y.AFrameworkApplication.va.Vb(wb.a.y_h,2)}Gqp(){this.Xi&&(this.Xi.hide(),this.Xi.dispose(),this.Xi=null);this.dSa&&this.IS&&(y.AFrameworkApplication.isShuttingDown||this.IS.removeEntry(this.dSa),this.dSa.dispose(),this.dSa=null)}showDialog(b){Dm.a.BF(this.Xi);this.Xi=new wg.StandardDialog;this.WTk||(this.Xi.hv=!1,this.Xi.Md=0);
this.Xi.Ue(1,CommonUIStrings.l_SignIn);this.Xi.tU(CommonUIStrings.l_DefaultDialogTitle,b,this.Uta)}jdp(){this.IS&&this.s2h&&(this.dSa=this.s2h.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.dSa.closeable=!0,this.dSa.addButton(CommonUIStrings.l_SignIn,Ci.W8a,""),this.dSa.rma=this.Pol,this.IS.yB(this.dSa,!1))}N_l(){this.wq&&(y.AFrameworkApplication.zc.Kf(this.wq),this.wq=null)}dispose(){this.wq=this.Xi=this.dSa=null}static W8a(){Ek.a.xte();y.AFrameworkApplication.va.Vb(wb.a.X6f,
2)}}Object(u.a)(Ci,"SignOutResponseUI",null,[11]);class nj{get name(){return"Common.App.UI"}Ec(b){b.register(qi,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Dm.a.BF(nj.CAa);nj.CAa=null}static main(){F.a.instance.Rc(new nj)}static Ccn(b,h,r){nj.Rcp()&&(nj.CAa=new Ci(Ek.a.instance,b,h,r))}static Rcp(){return y.AFrameworkApplication.koe&&!y.AFrameworkApplication.Yha}}nj.CAa=null;Object(u.a)(nj,"CommonAppUIPackage",null,
[0,1]);class mk{get name(){return"Common.App.DialogWithLinkToResource"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new mk)}}Object(u.a)(mk,"CommonAppDialogWithLinkToResourcePackage",null,[0,1]);var Jc=e(89);class Ha{constructor(b){this.wB=b;this.nB=Array.indexOf(this.wB,this.hna)}dispose(){this.wB=null}get Kta(){return this.wB[this.nB]}eC(b){this.Wqd(b,!1);return!0}mlc(b){this.Wqd(b,!0)}Wqd(b,h){b&&(this.Kta!==b||h)&&(b.tabIndex=0,Jc.FocusManager.LP(b));Array.contains(this.wB,b)&&(this.nB=
Array.indexOf(this.wB,b))}get VAj(){let b=this.nB;do if(b)if(0<b&&b<this.wB.length)b--;else break;else b=this.wB.length-1;while(!Ig.DOMFocusListing.A$a(this.wB[b])&&b!==this.nB);return this.wB[b]}get kmj(){let b=this.nB;do if(b===this.wB.length-1)b=0;else if(0<=b&&b<this.wB.length-1)b++;else break;while(!Ig.DOMFocusListing.A$a(this.wB[b])&&b!==this.nB);return this.wB[b]}get hna(){let b=0;for(;!Ig.DOMFocusListing.A$a(this.wB[b])&&b<this.wB.length;)b++;return Ig.DOMFocusListing.A$a(this.wB[b])?this.wB[b]:
null}get Isc(){let b=this.wB.length-1;for(;!Ig.DOMFocusListing.A$a(this.wB[b])&&0<b;)b--;return Ig.DOMFocusListing.A$a(this.wB[b])?this.wB[b]:null}}Object(u.a)(Ha,"DialogFocusListing",null,[97]);var eb=e(82);class rc extends wg.StandardDialog{constructor(b,h,r,A=null){super();this.jla=this.Zz=this.zkb=null;this.wB=[];this.Y$n=L=>{this.Zz&&(this.Zz.target="_blank",this.Zz.submit());L.preventDefault()};this.kni=()=>{v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};this.Uno=()=>{v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Sn&&this.Sn.stop()};this.AMd=h;this.Rn=b;this.wEk=r;this.tPd=A;this.Sn=new Kf.a("LoadResource","LoadPrintablePdf")}LLa(){this.Md=5;this.width=40;const b=document.createElement("span");b.id=this.Vj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.jla=document.createElement("iframe");
this.jla.name="pdfObjectFrame";this.jla.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.jla.onload=this.Uno;if(this.tPd&&0<this.tPd.count){var r=db.a.uae(this.AMd,this.tPd);const A=db.a.Gxe(this.AMd,this.tPd);this.Zz=document.createElement("form");this.Zz.id="printPreviewPostForm";this.Zz.method="POST";this.Zz.target=this.jla.name;this.Zz.action=A;for(const L of r)r=document.createElement("input"),r.type="hidden",r.name=L.key,r.value=L.value,this.Zz.appendChild(r)}else this.jla.setAttribute("src",
this.AMd);Sys.UI.DomElement.addCssClass(this.jla,kg.a.QBh);this.wEk?(Sys.UI.DomElement.addCssClass(this.jla,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,le.a.ju(this.jla,le.a.pz,le.a.Zp)):(Sys.UI.DomElement.addCssClass(this.jla,"DirectPrintPdfObject"),this.wB.push(this.jla));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.jla);this.Zz&&b.appendChild(this.Zz);b.appendChild(document.createElement("br"));b.appendChild(this.cFl(this.Zz?
"#":this.AMd));this.Sn.start();this.Gxb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.u$(this.Vj("DirectPrintHeaderContent"));this.Zz&&this.Zz.submit();this.cMl();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}cFl(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);y.AFrameworkApplication.J&&(2===y.AFrameworkApplication.ta.Pb.gl&&y.AFrameworkApplication.J.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===y.AFrameworkApplication.ta.Pb.gl&&y.AFrameworkApplication.J.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===y.AFrameworkApplication.ta.Pb.gl?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===y.AFrameworkApplication.ta.Pb.gl&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.zkb=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.zkb=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.Zz&&Re.a.addHandler(r,"click",this.Y$n),this.Rn.Cb(Fd.a.click,this.zkb,this.kni,null));this.wB.push(this.zkb);return h}cMl(){if(0<this.wB.length){const b=new Ha(this.wB),h=Jc.FocusManager.instance().Cv();h&&(this.zkb.focus(),h.Al=b,h.nR=!0)}}ifd(){v.ULS.sendTraceTag(21031114,
328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.zkb&&(this.Rn.Gc(Fd.a.click,this.zkb,this.kni),this.zkb=null);eb.a.yF(this.jla);this.jla=null;super.dispose()}}Object(u.a)(rc,"DirectPrintDialog",wg.StandardDialog,[517]);class Uc{constructor(b){this.Rn=b}Awm(b,h,r=null){return new rc(this.Rn,b,h,r)}}Object(u.a)(Uc,"DirectPrintDialogFactory",null,[509]);class bd{constructor(b,h){this._url=b;this.NNk=h}Yli(){this.NNk?ed.a.A3l(this._url):ed.a.Zm(this._url,"_blank",void 0,
"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(bd,"OpenUrlInTabDialogDownloadBehavior",null,[535,11]);class Hd extends wg.StandardDialog{constructor(b,h=!0,r=!1,A=null,L=null,ba=!1,ra=null,Ia=!1){super();this.H9b=this.G9b=this.Zz=this.E7=null;this.R0n=bc=>{this.eri(bc);return!0};this.S0n=bc=>this.Odd(bc,this.eri);this.eri=bc=>{this.Zz&&this.Zz.submit();this.cRb(bc.Ff)};this.Uta=bc=>{1===bc?(this.ifd(),this.Zz?Hd.OP&&this.xEj():this.RTe.Yli()):2===bc&&(this.Uad?this.Aci():
(this.lhe||this.ebd)&&this.F5l());this.dispose()};var Ta=this.tMg?this.tMg:CommonUIStrings.l_DefaultDialogTitle;Hd.poc=ba;this.Qvk=ra;this.RAk=Ia;this.RTe=A||new bd(b,!0);const ob=[],nb=[];Hd.OP&&(this.jVd&&this.jVd.forEach(bc=>{Array.add(ob,bc)}),this.GVh&&this.GVh.forEach(bc=>{Array.add(nb,bc)}));h?r?this.Uad?(this.Md=12,this.Ue(1,this.buttonText),this.Ue(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.Ue(3,CommonUIStrings.l_DialogClose)):this.ebd?(this.Md=12,this.Ue(1,this.buttonText),
this.Ue(2,CommonUIStrings.l_DownloadAsPdfDialog_EmailALinkButton),this.Ue(3,CommonUIStrings.l_DialogClose)):this.lhe?(this.Md=12,this.Ue(1,this.buttonText),this.Ue(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ue(3,CommonUIStrings.l_DialogClose)):(this.Md=4,this.Ue(1,this.buttonText),this.Ue(2,CommonUIStrings.l_DialogClose)):(this.Md=6,this.Ue(0,CommonUIStrings.l_DialogClose)):this.Md=5;ba=document.createElement("span");this.S_c&&(ba.className=this.S_c);A=document.createElement("a");
A.innerText=this.gtc;A.href=b;A.target="_blank";A.id=this.Jed;A.className=Df.AFrame.Gkf;if(ra=!X.a.r9&&!X.a.G9i&&!!L&&0<L.count){Ia=db.a.uae(b,L);L=db.a.Gxe(b,L);A.href="#";A.target="_self";this.Zz=document.createElement("form");this.Zz.id="printPreviewPostForm1";this.Zz.method="post";this.Zz.target="_blank";this.Zz.action=L;for(var Eb of Ia)L=document.createElement("input"),L.type="hidden",L.name=Eb.key,L.value=Eb.value,this.Zz.appendChild(L)}else this.Zz=null;this.Zz||Hd.poc?Hd.poc||Array.add(nb,
{["type"]:"AppLinkProps",["id"]:this.Jed,["text"]:this.gtc,["onExecute"]:()=>{this.xEj()}}):Array.add(nb,{["type"]:"AppLinkProps",["id"]:this.Jed,["text"]:this.gtc,["handler"]:{["href"]:ra?"#":b,["target"]:ra?"_self":"_blank"}});this.Tdb&&Array.add(ob,this.Tdb);r?(b=document.createElement("span"),b.innerText=this.Tdb.replace("{0}",""),ba.appendChild(b)):this.vjj?(b=document.createElement("span"),b.id=this.Vj("message"),Eb=document.createElement("span"),L=document.createElement("span"),ra=this.Tdb.split("{0}"),
Eb.innerText=ra[0],L.innerText=ra[1],b.appendChild(Eb),b.appendChild(A),b.appendChild(L),ba.appendChild(b)):(b=document.createElement("span"),b.innerText=this.Tdb,ba.appendChild(b),ba.appendChild(document.createElement("br")),ba.appendChild(document.createElement("br")),ba.appendChild(A),Hd.poc||Array.add(ob,"{0}"));this.Zz&&ba.appendChild(this.Zz);Hd.OP&&(this.axb&&(this.ued?this.ASh(this.axb,this.ued):(Array.add(ob,"{0}"),Array.add(nb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.axb,
["onExecute"]:()=>{}}))),this.dUd(ob,nb));this.Gxb(Ta,null,this.aXf,null,this.Uta,Hd.OP?null:ba);this.u$(this.Vj("message"));!Hd.OP&&this.ued&&this.axb&&(Ta=document.createElement("div"),Ta.className="WACDialogLearnMoreLinkContainer",this.E7=document.createElement("a"),this.E7.innerText=this.axb,this.E7.href=this.ued,this.E7.target="_blank",this.E7.id=this.Vj("LearnMoreLinkId"),this.E7.className=Df.AFrame.Gkf,Ta.appendChild(this.E7),h?this.Yc.insertBefore(Ta,this.Yc.lastChild):this.Yc.appendChild(Ta),
this.u$(String.format("{0} {1}",this.Vj("message"),this.Vj("LearnMoreLinkId"))));this.vJc=A;r?this.e6(this.YK):this.e6(this.vJc);this.Ile();y.AFrameworkApplication.ta.J$.Cb(Fd.a.click,this.vJc,Object(E.a)(this,this.jni,"downloadLinkClicked"),null);this.E7&&y.AFrameworkApplication.ta.J$.Cb(Fd.a.click,this.E7,Object(E.a)(this,this.Waj,"learnMoreLinkClicked"),null);this.S_=!1}get aXf(){return null}get tMg(){return null}get Tdb(){return null}get eqf(){return this.Qvk}get $qi(){return this.RAk}get ued(){return null}get axb(){return null}get vjj(){return!1}get buttonText(){return CommonUIStrings.l_Open}get S_c(){return null}get jVd(){return null}get GVh(){return null}get Uad(){return!1}get ebd(){return!1}get lhe(){return!1}Aci(){const b=
{SourceControlId:"CopyLink"};this.Uad&&(b.shareOverrideDefaultPermission=!0);this.wca(b,{ControlId:"CopyLink"})}F5l(){const b={SourceControlId:"Share"};this.ebd&&(b.shareOverrideDefaultPermission=!0);this.wca(b,{ControlId:"Share"})}wca(b,h){const r=y.AFrameworkApplication.va;r.JD=8;r.Zb(wb.a.wca,2,b,h)}cta(){this.Zz&&(this.G9b||(this.G9b=this.R0n,this.Ws.Cb(Fd.a.click,this.YK,this.G9b)),this.H9b||(this.H9b=this.S0n,this.Ce.Cb(Fd.a.zi,this.YK,this.H9b)));super.cta()}ifd(){}jni(){this.K9f();this.Zz?
this.Zz.submit():this.RTe.Yli();return!0}Waj(){return!1}dispose(){this.RTe.dispose();this.vJc&&(y.AFrameworkApplication.ta.J$.Gc(Fd.a.click,this.vJc,Object(E.a)(this,this.jni,"downloadLinkClicked")),this.vJc=null);this.E7&&(y.AFrameworkApplication.ta.J$.Gc(Fd.a.click,this.E7,Object(E.a)(this,this.Waj,"learnMoreLinkClicked")),this.E7=null);this.Ws&&this.G9b&&(this.Ws.Gc(Fd.a.click,this.YK,this.G9b),this.G9b=null);this.Ce&&this.H9b&&(this.Ce.Gc(Fd.a.zi,this.YK,this.H9b),this.H9b=null);super.dispose()}xEj(){this.Zz&&
(document.body.appendChild(this.Zz),this.Zz.submit(),document.body.removeChild(this.Zz))}static get OP(){return y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.ta.Pb.u6i}static get poc(){return Hd.yqh}static set poc(b){Hd.yqh=b}}Hd.yqh=!1;Object(u.a)(Hd,"ADialogWithLinkToResource",wg.StandardDialog,[]);class Pe extends Hd{constructor(b,h,r=null,A=!0,L=!1,ba=null,ra=!1){super(b,!0,!(Pe.aDb&&A),new bd(b,h),r,L,ba,ra);Pe.aDb=Pe.aDb&&A;if(Pe.aDb){h=document.createElement("iframe");A=null;L=
this.vki;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){ba=db.a.uae(b,r);b=db.a.Gxe(b,r);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=h.name;A.action=b;for(const Ia of ba)b=document.createElement("input"),b.type="hidden",b.name=Ia.key,b.value=Ia.value,A.appendChild(b)}else h.src=b;L.appendChild(h);A&&(L.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");le.a.ju(h,le.a.pz,le.a.Zp)}}get aXf(){return"Print_32x32x32"}get tMg(){return Pe.aDb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Tdb(){return Pe.aDb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get jVd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Hd.poc){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==y.AFrameworkApplication.ta.Pb.rhi&&(h=y.AFrameworkApplication.ta.Pb.rhi);Array.add(b,h)}return Pe.aDb?b:null}get gtc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Jed(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get S_c(){return y.AFrameworkApplication.k$a?
"UIFontDialogTextLarge":null}Ile(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}K9f(){y.AFrameworkApplication.uo.Sbb(9540);v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}ifd(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get aDb(){return!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(X.a.r9||X.a.Zt||X.a.Hj||X.a.WT)&&!y.AFrameworkApplication.vdd&&
y.AFrameworkApplication.J.$("ShouldHostDefaultToNativeBrowserPrintExperience")&&Pe.dPh}static set aDb(b){Pe.dPh=b}}Pe.dPh=!1;Object(u.a)(Pe,"PrintDialogWithLinkToPdf",Hd,[]);class Le{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.Wwn=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.dtn=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.J3b=(b.DirectPrintSupportedMimeTypes||"").split(Le.AAf);this.NBb=(b.DirectPrintSupportedPlugins||"").split(Le.AAf);
this.Ban=(b.DirectPrintImmersivePreviewPlugins||"").split(Le.AAf);this.K1i=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.enn=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.Ywl=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Qbg=14;this.Fjj=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.Qbg=parseInt(h[0]),this.Fjj=parseInt(h[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",
b)}else v.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Le.AAf=",";Object(u.a)(Le,"DirectPrintBrsSettings",null,[]);class De{constructor(b,h){this.SJg=b;this.NBb=h}}Object(u.a)(De,"DirectPrintProbeResults",null,[]);var lf=e(189);class Af{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.USd=null;this.qNm=()=>{var nb=this.dTm();const Eb=this.jto(),bc={},Bc={};for(let Yc=0;Yc<this.TV.J3b.length;Yc++)bc[this.TV.J3b[Yc]]=nb[Yc];for(nb=
0;nb<this.TV.NBb.length;nb++)Bc[this.TV.NBb[nb]]=Eb[nb];return new De(bc,Bc)};this.vzk=b;this.NOc=h;this.m4e=r;this.cHk=A;this.oIk=L;this.HQc=new xe.a(this.qNm);this.$Ic=ba;this.Ayh=Ta;this.nY=ra;this.MMc=Ia;this.JIk=ob}get TV(){return this.vzk}start(){}qoo(){this.TV.Wwn&&this.gNn()}ito(){const b=Array(this.TV.J3b.length);if(void 0!==this.NOc&&null!==this.NOc)for(let h=0;h<this.TV.J3b.length;h++)b[h]=this.TV.J3b[h]in this.NOc&&this.cHk(this.NOc[this.TV.J3b[h]]);return b}jto(){const b=Array(this.TV.NBb.length),
h=!(void 0===this.m4e||null===this.m4e);for(let r=0;r<this.TV.NBb.length;r++){const A=this.TV.NBb[r];b[r]=h&&A in this.m4e?!0:this.oIk(A)}return b}dTm(){const b=this.ito(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.Mam(this.NOc[this.TV.J3b[r]]):null;return h}Mam(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}gNn(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.HQc.value.SJg,this.HQc.value.NBb)}Kcp(){return this.JIk||
!this.TV.isEnabled||y.AFrameworkApplication.vdd?!1:this.rnp()}Pcp(){if(null!=this.USd)return this.USd;const b=Af.J1i(this.TV);return this.USd=this.TV.K1i&&b||this.cnn()}cnn(){return X.a.zt&&this.TV.enn&&X.a.Xwl>=this.TV.Ywl?!0:!1}rnp(){if(!this.MMc(this.TV))return!1;var b=sb.a.tbb(this.HQc.value.SJg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=sb.a.tbb(this.HQc.value.NBb);for(const h of b)if(h)return!0;return!1}u4m(){const b=sb.a.tbb(this.HQc.value.SJg);for(const h of b)if(lf.a.contains(this.TV.Ban,
h))return!0;return!1}sfp(b,h=null){y.AFrameworkApplication.ta&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.Ayh(b,h):this.Kcp()?this.S0l(b,this.u4m()&&!0,h):this.Ayh(b,h)}S0l(b,h,r=null){const A=this.nY.rg("UserAction","OpenDirectPrintDialog");this.$Ic.Awm(b,h,r).LLa();A.stop()}static Vzn(b){try{return new ActiveXObject(b),!0}catch(h){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static aqn(b){return void 0===b||
null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Le(y.AFrameworkApplication.J.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(ob){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let A=null;try{A=window.navigator.plugins}catch(ob){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const L=Af.aqn,ba=Af.Vzn;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ra=y.AFrameworkApplication.ta.Kt,
Ia=Af.Wzn,Ta=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.$I&&!y.AFrameworkApplication.J.$("PrintDialogFallbackLinkEnabled");return new Af(h,r,A,L,ba,b,ra,Ia,(ob,nb)=>new Pe(ob,!1,nb,!0,Ta),y.AFrameworkApplication.Yha)}static Wzn(b){return X.a.zt||X.a.Zt&&b.dtn||b.K1i&&Af.J1i(b)?!0:!1}static J1i(b){var h=X.a.Ljc;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.Qbg||h===b.Qbg&&r>=b.Fjj}return!1}}Object(u.a)(Af,"DirectPrintManager",null,[486]);class mg{constructor(){this.GFb=
this.Z=null}get name(){return"Common.App.DirectPrint"}Ec(b){this.Z=b;b.register(Uc,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().fe(()=>new Uc(y.AFrameworkApplication.ta.J$));b.register(486,"Common.App.DirectPrint.IDirectPrintManager").ha().fe(()=>Af.create(this.Z))}init(){this.GFb=this.Z.resolve("Common.App.DirectPrint.IDirectPrintManager");this.GFb.start()}dispose(){}}Object(u.a)(mg,"PackageManager",null,[0,1]);class hi{constructor(b,h=3E4){this.JMg=9E5;this.LMg=1E4;this.Fgj=this.Stc=
null;this.V$f=0;this.Xqb=Date.now;this.mVm=b;this.zhb=h;this.h8d()}fOi(b=!0){const h=this.Xqb();if(h<this.V$f+this.JMg)return h>this.V$f+this.LMg&&this.h8d(),this.Fgj;b&&this.h8d();return null}getToken(b=!0){return(b=this.fOi(b))?Promise.resolve(b):this.h8d()}h8d(){return this.Stc=this.Stc||new Promise(b=>{this.mVm().then(h=>{this.Stc=null;""!==h&&h&&(this.Fgj=h,this.V$f=this.Xqb(),b(h));b(null)}).catch(()=>{this.Stc=null;b(null)});window.setTimeout(()=>{this.Stc=null;b(null)},this.zhb)})}}Object(u.a)(hi,
"OAuthCacheManager",null,[]);var Uh=e(129),nk=e(306);class fi{constructor(){this.vda=null;this.amh={};this.tokenCache=new Ma.a(Ea.a.Oh())}getToken(b,h){if(this.tokenCache.Bb(h))return this.tokenCache.K(h).getToken();const r=new hi(()=>this.gOi(b,h));this.tokenCache.W(h,r);return r.getToken()}lVm(b,h){if(this.tokenCache.Bb(h))return this.tokenCache.K(h).fOi();const r=new hi(()=>this.gOi(b,h));this.tokenCache.W(h,r);return null}gOi(b,h){if(!this.vda)try{this.vda=Xa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){v.ULS.sendTraceTag(51689675,
1300,10,"Unable to resolve IOAuthManager: "+r)}return this.vda?new Promise(r=>{const A=Date.now();this.vda.kX(b,h).then(L=>{const ba=L.Token;!L.IsSuccess||this.RAn(ba)?(this.ozc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,L.ErrorCode,L.ErrorMessage,h),r(null)):(this.ozc("GetTokenInternalImplicitJS",!0,Date.now()-A,b,L.ErrorCode,L.ErrorMessage,h),r(ba))}).catch(L=>{L=L?H.c(L):"";this.ozc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,"Caught Exception",L,h);r(null)})}):new Promise(r=>{this.ozc("GetTokenInternalImplicitJS",
!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}ozc(b,h,r,A,L="",ba="",ra=""){var Ia="Search"===A;const Ta=[];b=Uh.a.Fca(Ia?"Event":"EventName",b,2);A=Uh.a.Fca("AppName",A,2);Array.add(Ta,b);Array.add(Ta,A);Ia&&(A=Uh.a.Fca("LatencyType","FetchToken",2),Array.add(Ta,A));L&&""!==L&&(L=Uh.a.Fca("ErrorCode",L,2),Array.add(Ta,L));ba&&""!==ba&&(ba=Uh.a.Fca("ErrorMessage",ba,2),Array.add(Ta,ba));ra&&""!==ra&&(ba=!(ra in this.amh),this.amh[ra]=ba,ba=Uh.a.Fca("WarmUpCall",ba.toString(),1),Array.add(Ta,
ba),ra=Uh.a.Fca("Service",this.dRm(ra),2),Array.add(Ta,ra));Ia=Ia?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new nk.a,{name:Ia,samplingPolicy:2,dataFields:Ta,succeeded:h,durationMs:r});ka.a.sendActivityEvent(h)}dRm(b){return b===y.AFrameworkApplication.E$f?"Loki":b===y.AFrameworkApplication.IJg?"Substrate":y.AFrameworkApplication.J&&b===y.AFrameworkApplication.J.rb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}RAn(b){return!b||!b.length}}
Object(u.a)(fi,"SearchOAuthManager",null,[440]);class kc{constructor(){this.Z=null}get name(){return"Common.App.SearchOAuthManager"}Ec(b){this.Z=b;this.Z.register(440,"Common.App.SearchCommon.ISearchOAuthManager").ha().fe(()=>new fi)}init(){}dispose(){}static main(){F.a.instance.Rc(new kc)}}Object(u.a)(kc,"SearchOAuthPackage",null,[0,1]);var Ze=e(126),Fg=e(54),ii=e(231),te=e(6),pe=e(133),Ee=e(39),rd=e(7);class wj{constructor(b,h,r){this.a5e=this.gKb=this.Y4e=this.fKb=this.d2e=null;this.L0m=A=>{try{this.K0m(A)}catch(L){A=
String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",L.message,L.stack),v.ULS.sendTraceTag(5285580,334,10,A)}};this.Tq=b;this.iAk=h;this.pb=r;this.init()}init(){this.iAk.Cb(this.L0m);this.fKb=new de.a;this.Y4e=new de.a;this.gKb=new de.a;this.a5e=new ii.a}SW(b){this.fKb.add(b.key,b)}E0b(b){this.gKb.add(b.key,b)}K0m(b){let h;const r=this.pb.ob.currentSelection;({gyf:h}=wj.Mxp(r)).returnValue&&(b=wj.bum(b,this.d2e,h),this.Loo(b,h,r),this.d2e=h)}Loo(b,
h,r){b=this.fnm(b,h,r);let A;({notification:A}=wj.Cxp(b)).returnValue&&this.Tq.sendNotification(A,!1)}fnm(b,h,r){const A=new de.a;A.W(1,new ii.a);A.W(0,new ii.a);b.forEach(L=>{3===L?(wj.RFg(h.node)||this.rNo(h,r),this.WKm(A,h)):L||this.Cum(A,h);return!0});return A}rNo(b,h){this.fKb.forEach((r,A)=>{A.reset(b,h);return!0})}Cum(b,h){let r=new de.a;wj.RFg(h.node)||(r=this.Aum(h.cpBegin));this.Bum(b,this.Y4e,r,wj.VQj(this.d2e,h));this.Y4e=r}Aum(b){const h=new de.a;this.fKb.forEach((r,A)=>{r=null;({vI:r}=
A.NGa(b)).returnValue&&h.W(A.key,r);return!0});return h}Bum(b,h,r,A){const L=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ba,ra)=>{const Ia=this.fKb.K(ba).hx||ra.title;let Ta;({value:Ta}=r.Nc(ba)).returnValue?A&&Ta.contentObject!==ra.contentObject&&(Ia&&b.K(1).add(Ia),ba=this.fKb.K(ba).hx,ba=String.format(L,Ta.title,ba),Ta.description&&(ba+=", "+Ta.description),b.K(0).add(ba)):Ia&&b.K(1).add(Ia);return!0});r.forEach((ba,ra)=>{h.Bb(ba)||(ba=this.fKb.K(ba).hx,ba=String.format(L,
ra.title,ba),ra.description&&(ba+=", "+ra.description),b.K(0).add(ba));return!0})}WKm(b,h){h=this.ySm(h.node);h=this.FAl(h);this.zSm(b,this.a5e,h);this.a5e=h}ySm(b){const h=new te.a;h.set(b);if(!h.Ib(1))return null;const r=new ii.a;for(;1!==h.Jf;)this.gKb.forEach((A,L)=>{let ba;({Fga:ba}=L.F4b(h)).returnValue&&r.add(ba);return!0}),h.Ac();r.reverse();return r}FAl(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.NH===b[h+1].NH&&(this.gKb.K(r.NH),({JAl:r}={returnValue:!1,JAl:null}).returnValue)){b.splice(h,
2,r);continue}h++}return new ii.a(b)}zSm(b,h,r){var A;for(A=0;A<Math.min(r.length,h.length)&&r.K(A).contentId.equals(h.K(A).contentId);A++){var L=this.gKb.K(r.K(A).NH).htb(r.K(A),h.K(A));L&&(r.K(A).description&&(L+=", "+r.K(A).description),b.K(0).add(L))}for(L=A;L<r.length;L++){let ba=this.gKb.K(r.K(L).NH).htb(r.K(L),null);ba&&(r.K(L).description&&(ba+=", "+r.K(L).description),b.K(0).add(ba))}for(r=A;r<h.length;r++)(A=this.gKb.K(h.K(r).NH).hx)&&b.K(1).add(A)}static bum(b,h,r){const A=new ii.a;(b=
b||wj.XVo(h,r))?(A.add(3),A.add(0)):wj.VQj(h,r)&&A.add(0);return A}static XVo(b,h){return!b||!b.node.id.equals(h.node.id)}static VQj(b,h){return!b||!b.equals(h)}static Mxp(b){let h=null;if(!b||!(Ee.a.qn(b)||(b=Ee.a.Xk(b,!0,!1),Ee.a.qn(b)||b.Ya&&wj.RFg(b.Ya.node))))return{returnValue:!1,gyf:h};h=b.Ya;return{returnValue:!!h,gyf:h}}static Cxp(b){const h=new ii.a;b.K(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.K(0).forEach(r=>{r=
String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static RFg(b){return pe.a.nr(b)||rd.ParagraphReader.WBa(b)}}Object(u.a)(wj,"AccessibilityContextManager",null,[436]);class ui{constructor(b,h){this.Dvh=!1;this.WRc=null;this.pPd=this.KSd=!1;this.vlh=null;this.pVd=(r,A)=>{(A.YR||A.mja)&&this.$Zn(A.YR,A.mja)};this.Sb=b;this.L_=h}get p5m(){return!!this.WRc}Cb(b){this.Dvh||(this.L_.EUh(this.pVd),
this.Dvh=!0);this.vlh=b}$Zn(b,h){this.p5m&&this.Sb.Kf(this.WRc);this.KSd=this.KSd||b;this.pPd=this.pPd||h;this.WRc=new Md.a(5,1,ui.D9l,()=>{this.vlh(this.KSd,this.pPd);this.reset()},126);this.Sb.pc(this.WRc)}reset(){this.WRc=null;this.pPd=this.KSd=!1}}ui.D9l=100;Object(u.a)(ui,"EditingViewOnAfterValidateEventsConsolidator",null,[433]);class Ch{constructor(){this.Z=null}get name(){return"Box4.Accessibility"}init(){Ze.a.CZh&&this.Z.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Ec(b){this.Z=
b;b.ja("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new ui(y.AFrameworkApplication.zc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();b.ja("Box4.Accessibility.AccessibilityContextManager",()=>new wj(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Fg.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){F.a.instance.Rc(new Ch)}}
Object(u.a)(Ch,"Box4AccessibilityPackage",null,[0,1]);var $g=e(218),fa=e(1071),Ya=e(1626),Hb=e(923),Yb=e(267),qa=e(1446),hb=e(38),Tb=e(23),Mc=e(110),vc=e(26),fb=e(3);class xd extends qa.a{get UDa(){return null!=this.g3g?this.g3g:this.g3g=Xa.a.instance.Wa("Box4.IInternalLinkManager")}get Mzj(){return null!=this.T7g?this.T7g:this.T7g=Xa.a.instance.Wa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get QC(){return!0}get commandId(){return fb.a.zhl}Sma(b){Yb.a.mark(7012);const h=new hb.GraphTransaction(15);
h.Eb(b);var r=this.HH,A=this.GZ,L=rd.ParagraphReader.text(b),ba=L.substring(r,A);const ra=({Afg:Ia}=D.a.sJg(ba)).returnValue;ba!==ra&&(r+=Ia,A=r+ra.length);ba=vc.a.createTextRange(b,r,A);var Ia=L.substring(r,A);xd.Xsn(L,r,A)&&(this.ee.lf(vc.a.createTextRange(b,r-1,A+1),Ia,!0,!1),--r,--A,ba=vc.a.createTextRange(b,r,A),r=Tb.SelectionFactory.Ie(b,A),Fg.a.instance.Uc(r));r=Mc.a.Qua(Ia);xd.Gs.SJ(ba,r,!1);L=Ia="";A=!1;this.UDa&&({avg:Ia,kab:L}=this.UDa.NNg(r)).returnValue&&(r=Ia,A=!0,Ia=Mc.a.VD(ba,!1),
xd.Gs.YZ(Ia[0].paragraph,Ia[0].hyperlink),""!==L&&(this.ee.lf(ba,L,!0,!1),ba=vc.a.createTextRange(b,this.HH,this.HH+L.length),b=Tb.SelectionFactory.Ie(b,this.HH+this.HH+L.length),Fg.a.instance.Uc(b)),xd.Gs.SJ(ba,r,!1));h.dispose();!A&&this.Mzj&&this.Mzj.zlo(ba,r);Yb.a.mark(7013)}set QC(b){super.QC=b}static get Gs(){return null!=xd.f1g?xd.f1g:xd.f1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static Xsn(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-
1)||"\u201c"===b.charAt(h-1))&&r}}Object(u.a)(xd,"HyperlinkAction",qa.a,[]);class We{constructor(b){this.ee=b}JMl(b,h,r){return new xd(null,b,h,r,this.ee)}}Object(u.a)(We,"HyperlinkActionFactory",null,[435]);var Ke=e(258);class Qd{constructor(){this.Z=null}get name(){return"Box4.AutoCorrect"}Ec(b){this.Z=b;b.ja("Box4.AutoCorrect.AutoCorrectRules",()=>new Ya.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),Ke.a.instance,y.AFrameworkApplication.va,y.AFrameworkApplication.J,
b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ja("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new fa.a(b.resolve("Box4.IRoamingServiceRequestManager"),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ja("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Hb.a(b.resolve("Box4.IAutoCorrectRules"),Fg.a.instance,$g.a.instance,y.AFrameworkApplication.J,
b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),b.Za("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();b.ja("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new We(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.Z.resolve("Box4.IAutoCorrectRules").jIn();
const b=y.AFrameworkApplication.J;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.Z.resolve("Box4.IAutoCorrectOptionsInfo").Qom()}dispose(){}static main(){F.a.instance.Rc(new Qd)}}Object(u.a)(Qd,"Box4AutoCorrectPackage",null,[0,1]);class Gg{get name(){return"Box4.Clipboard"}init(){}dispose(){}Ec(){}static main(){F.a.instance.Rc(new Gg)}}Object(u.a)(Gg,"Box4ClipboardPackage",null,[0,1]);class Xh{get name(){return"Box4.ImageEditors"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new Xh)}}
Object(u.a)(Xh,"Box4ImageEditorsPackage",null,[0,1]);var lh=e(631),Ge=e(907),sg=e(690),Yf=e(660),Um=e(1133);class gl{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,r,A,L){const ba=new gl;ba.DocumentId=L;ba.UserId=r;ba.WACSessionId=A;ba.Revision=b;ba.ChangeStateList=Um.a.RRj(h);return ba}}Object(u.a)(gl,"LocalUnsavedChange",null,[]);class ah{constructor(){this.tle=null}EIe(b){return new Promise((h,r)=>{this.Ldi().then(A=>{const L=A.transaction(ah.afd,"readwrite");L.objectStore(ah.afd).put(b);
L.oncomplete=()=>h();L.onerror=()=>r(L.error.message)}).catch(r)})}oZd(b,h,r){return new Promise((A,L)=>{this.Ldi().then(ba=>{const ra=ba.transaction(ah.afd,"readwrite");ra.objectStore(ah.afd).delete([b,h,r]);ra.oncomplete=()=>A();ra.onerror=()=>L(ra.error.message)}).catch(L)})}static isSupported(){return"indexedDB"in window}Ldi(){return new Promise((b,h)=>{if(ah.isSupported())if(this.tle)b(this.tle);else{var r=window.indexedDB.open(ah.vJn,ah.wJn);r.onsuccess=()=>{this.tle=r.result;b(r.result)};r.onerror=
()=>{h(r.error.message)};r.onupgradeneeded=()=>{const A=r.result,L=A.createObjectStore(ah.afd,{keyPath:["DocumentId","UserId","WACSessionId"]});L.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});L.createIndex("UserId",["UserId"],{unique:!1});this.tle=A;b(A)}}else h("This browser does not support IndexedDB.")})}}ah.vJn="LocalUnsavedChangeDatabase";ah.wJn=1;ah.afd="LocalUnsavedChange";Object(u.a)(ah,"LocalUnsavedChangeStore",null,[]);class Qg{constructor(b,h,r,A,L,ba){this.cej=
b;this.Rfb=h;this.XIm=r;this.g6c=A;this.nul=L;this.YFa=ba}initialize(){const b=Ge.a.zQf(this.XIm());this.M1d=this.W_c=b;this.YFa.a8k(this.ktj.bind(this));this.YFa.b8k(this.ltj.bind(this))}dispose(){this.YFa.bJo(this.ktj.bind(this));this.YFa.cJo(this.ltj.bind(this))}ktj(b,h){this.LFp(h.oE)}ltj(b,h){this.yCp(h.oE)}yCp(b){b.equals(this.W_c)||(this.W_c=b,b.equals(this.M1d)?this.oZd():this.EIe())}LFp(b){b.equals(this.M1d)||(this.M1d=b,b.equals(this.W_c)?this.oZd():this.EIe())}ENl(){const b=Object(Yf.b)({oE:this.M1d,
ko:this.W_c,fileId:this.g6c().Kr,Yia:this.g6c().Yia,contextId:this.g6c().contextId,G5d:this.W_c.id,Rfb:this.Rfb,Ahe:sg.a.NVb(this.g6c()),Mee:!1,cellId:this.g6c().Hd.id},!1);return gl.construct(b,this.nul.C5c(),Qg.userId,Qg.sessionId,Qg.documentId)}EIe(){const b=this.ENl();this.cej.EIe(b).then(()=>{v.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{v.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",
h)})}oZd(){this.cej.oZd(Qg.documentId,Qg.userId,Qg.sessionId).then(()=>{v.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{v.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return ah.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Qg.bZg?Qg.bZg:Qg.bZg=y.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=
Qg.Xah?Qg.Xah:Qg.Xah=y.AFrameworkApplication.J.rb("LoggableUserId")}static get sessionId(){return null!=Qg.H8g?Qg.H8g:Qg.H8g=y.AFrameworkApplication.J.rb("SessionId")}}Object(u.a)(Qg,"LocalUnsavedChangeManager",null,[430]);class xh{get name(){return"Box4.LocalUnsavedChange"}init(){this.u1i()&&Qg.isSupported()&&(this.u9f=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.u9f.initialize())}dispose(){this.u9f&&this.u9f.dispose()}Ec(b){this.container=b;if(this.u1i()){b.ja("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",
()=>new ah).ha();var h=(r,A,L)=>new lh.a(r,A,L);b.ja("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Qg(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd,()=>Db.StaticActiveAppFrame.Aa().tb.rd,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){F.a.instance.Rc(new xh)}u1i(){return y.AFrameworkApplication.J.$("DisconnectedScenarioIsEnabled")}}Object(u.a)(xh,
"LocalUnsavedChangePackage",null,[0,1]);class je{get name(){return"Box4.NotebookLevelEditors"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new je)}}Object(u.a)(je,"Box4NotebookLevelEditorsPackage",null,[0,1]);var He=e(1472);class Bf{get name(){return"Box4.Search"}Ec(b){b.ja("Box4.Search.FindManagerHelper",()=>He.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(u.a)(Bf,"PackageManager",null,[0,1]);class uk{get name(){return"Box4.TextLevelEditors"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new uk)}}
Object(u.a)(uk,"Box4TextLevelEditorsPackage",null,[0,1]);var bm=e(135),Ai=e(323),Pd=e(156),ai=e(433),Pg=e(321);class Vl{constructor(b,h,r){this.gz=this.QSa=this.aVa=null;this.XH=this.kSe=this.JHa=0;this.Lra=this.WHd=this.o5a=this.n5a=!1;this.JGd=this.Drh=this.Hrh=0;this.AIa=b;this.ga=h;this.vv=r}UL(b){return!Db.StaticActiveAppFrame.Aa().tb.isEditingAllowed||id.SessionStatusManager.instance.zk?!1:""!==this.h6c(b.Ff)}eJ(b){if(!this.UL(b))return!1;this.O1o(b);this.XH=this.AIa.dmc();this.N4o(b);this.O4o();
({Dqc:this.WHd,fsc:this.Lra}=this.gVj(this.kSe));this.P4o();this.aVa=b.kM;this.gz=new Sys.UI.Point(0,0);[this.Hrh,this.Drh]=this.AIa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}wP(b){this.QSa=b.kM;this.Kpl();this.JGd=Pg.d(this.gz.x,this.gz.y,this.Hrh,this.Drh,this.WHd,this.Lra,this.JGd,y.AFrameworkApplication.J.$("SmoothImageHelperGetScaleIsEnabled"));this.AIa.bQg(this.JGd,this.WHd,this.Lra);return!0}$C(){this.setSize();v.ULS.sendTraceTag(16802336,322,
50,"Image resize drag succeeded")}qR(){this.AIa.nyg();v.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}O1o(b){this.AIa=bm.a.Mb(b.Ff,ai.a)}O4o(){this.kSe=(Math.floor((this.XH+22)/45)%8+this.JHa)%8}gVj(b){let h,r;if(this.XH&&90!==this.XH&&180!==this.XH&&270!==this.XH&&360!==this.XH||this.atn(b))return{Dqc:!0,fsc:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{Dqc:r,fsc:h}}P4o(){this.o5a=this.n5a=!1;switch(this.kSe){case 0:this.o5a=this.n5a=!0;break;case 1:case 2:this.o5a=
!0;break;case 7:case 6:this.n5a=!0}}atn(b){return!(b%2)}h6c(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}N4o(b){switch(this.h6c(b.Ff)){case "WACImageResizeHandleNW":this.JHa=0;break;case "WACImageResizeHandleN":this.JHa=1;break;case "WACImageResizeHandleNE":this.JHa=2;break;
case "WACImageResizeHandleE":this.JHa=3;break;case "WACImageResizeHandleSE":this.JHa=4;break;case "WACImageResizeHandleS":this.JHa=5;break;case "WACImageResizeHandleSW":this.JHa=6;break;case "WACImageResizeHandleW":this.JHa=7}}Kpl(){var b=1;this.vv.instance&&(b=this.vv.instance.Ql);const h=(this.QSa.x-this.aVa.x)/b;b=(this.QSa.y-this.aVa.y)/b;this.gz.x=this.n5a?-h:h;this.gz.y=this.o5a?-b:b}setSize(){const b=new Ai.DictionaryPropertySet;b.setValue(Pd.a.b$c,100*this.JGd);b.setValue(Pd.a.oVi,!0);if(90===
this.XH||270===this.XH){let h,r;({Dqc:h,fsc:r}=this.gVj(this.JHa));b.setValue(Pd.a.vXf,h);b.setValue(Pd.a.wXf,r)}else b.setValue(Pd.a.vXf,this.WHd),b.setValue(Pd.a.wXf,this.Lra);b.setValue(Pd.a.hVi,this.JHa);this.ga.Zb(fb.a.Soc,2,b)}}Object(u.a)(Vl,"ImageResizeDragAdapter",null,[98]);var fg=e(142),um=e(655);class oj{constructor(b,h,r,A){this.HYe=this.QSa=this.aVa=this.KOd=null;this.QLd=this.pTd=0;this.Lb=null;this.ga=b;this.pb=h;this.vv=r;this.Oyh=this.pJa=0;this.zd=A}UL(b){return Db.StaticActiveAppFrame.Aa().tb.isEditingAllowed&&
!id.SessionStatusManager.instance.zk&&b&&this.fyn(b.Ff)?(this.KOd=this.pb.hh)?!0:!1:!1}a7d(){}AQf(){return null}eJ(b){if(!this.UL(b))return!1;this.AIa=bm.a.Mb(b.Ff,ai.a);if(!this.AIa)return!1;this.hPd=this.AIa.fea;if(!this.hPd)return!1;this.KOd=this.pb.hh;this.Lb=pe.a.Io(this.KOd);if(!this.Lb)return!1;this.aVa=this.WXa(b);this.HYe=Sys.UI.DomElement.getBounds(this.hPd);this.pTd=0<pe.a.h$d(this.Lb)?pe.a.h$d(this.Lb):0;this.QLd=pe.a.LNf(this.Lb);return!0}wP(b){this.QSa=this.WXa(b);this.Rpl();if(this.AIa)return this.AIa.PIe(this.pJa,
this.Oyh),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}$C(){this.pTd=this.pJa=Pg.e(this.pJa);this.y$()}qR(){this.AIa.PIe(this.QLd,0)}fyn(b){return b.classList.contains(um.c)||b.classList.contains(um.b)||b.classList.contains(um.a)||!!b.parentElement&&b.parentElement.classList.contains(um.a)}WXa(b){return this.zd.Pd.vab(b)}Rpl(){var b=1;this.vv&&this.vv.instance&&(b=this.vv.instance.Ql);var h=new Sys.UI.Point(this.HYe.x+this.hPd.clientWidth/
2*b,this.HYe.y+this.hPd.clientHeight/2*b);b=Pg.a(this.aVa,h);h=Pg.a(this.QSa,h);this.pJa=Math.round(fg.a.Oto(h-b));0<this.pTd&&(this.pJa+=this.pTd-this.QLd);this.Oyh=this.pJa;this.pJa+=this.QLd}y$(){const b=new Ai.DictionaryPropertySet;b.setValue(Pd.a.Z9c,0);b.setValue(Pd.a.mZ,this.pJa);this.ga.Zb(fb.a.k9,2,b)}}Object(u.a)(oj,"ImageRotateDragAdapterSimplified",null,[425,98]);class Dd{constructor(){this.Z=null}get name(){return"Box4.Images"}Ec(b){this.Z=b;this.Z.ja("Box4.Images.ImageResizeDragAdapter",
()=>new Vl(null,y.AFrameworkApplication.va,Xa.a.instance.Za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.Z.ja("Box4.Images.ImageRotateDragAdapterUpdated",()=>new oj(y.AFrameworkApplication.va,Fg.a.instance,Xa.a.instance.Za("Common.IZoomManager"),Object(Vb.a)())).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.Z.resolve("Box4.Images.IImageResizeDragAdapter");this.Z.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){F.a.instance.Rc(new Dd)}}
Object(u.a)(Dd,"Box4ImagesPackage",null,[0,1]);var pj=e(70),Kh=e(114),Rc=e(5),ri=e(457),Wi=e(472),lm=e(596),Sk=e(269),kf=e(256),tp=e(1786),jn=e(1689),Em=e(1183);class Vm extends jn.a{constructor(b,h,r){super(b,h,r);this.OMd=this.Vnb=null}get dX(){return y.AFrameworkApplication.ta.Kt}C9d(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}xJe(b){return Vm.yqa(b,this.TOi())}TOi(){return Vm.yff}yqa(b,
h=null){b=this.xJe(b);return 0!==b?(h&&h.nUd(),2===b&&(h=this.C9d(b),this.Pq(this.JCi(b),h)),!1):!0}PCa(b,h){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.olg=h;Yb.a.mark(5576);this.OMd=this.dX.rg("LoadResource","PictureUploadTime");this.Afe()?this.Dod(b):this.Kvc()}Pq(b,h){const r=new wg.StandardDialog;r.Md=0;r.zA(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}Kvc(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.Kvc();this.OMd&&(this.OMd.stop(),
this.OMd=null)}Rgb(){this.Vnb=(new Em.a).create();this.Vnb.message=CommonUIStrings.l_ImageUploadWait;this.Vnb.Md=5;this.Vnb.hv=!1;this.Vnb.nM(null,null,null)}qhc(){this.Vnb&&(this.Vnb.close(),this.Vnb=null)}static E5m(b,h){b=D.a.Ph(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static yqa(b,h=null){h||(h=Vm.yff);return b?Vm.E5m(b,h)?0:2:1}}Vm.yff=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(Vm,"PictureUploader",jn.a,[]);var Rg;(function(b){b[b.vJe=0]="validPicture";
b[b.jhd=1]="noPictureSpecified";b[b.jZi=2]="invalidExtension";b[b.Cte=3]="pictureTooLarge"})(Rg||(Rg={}));Object(u.b)("PictureValidationResult",Rg);var rb=e(57),Sb=e(13),Tc=e(41),pd=e(720);class Ae{constructor(){this.mT=null}}Object(u.a)(Ae,"ImageData",null,[]);var ne=e(146),Oe=e(198),Of=e(45),Yg=e(303),If=e(69),Ph=e(884),Se=e(1581),Cg=e(1636);class Vg extends Xf.a{constructor(b,h=!0){super(!1,!1,Vg.OP);this.Nbc=null;this.jnh=!1;this.wB=[];this.ps=null;this.h5n=r=>{this.VSk&&(this.ps=this.gWj(r,this.Xnb))};
this.$ao=()=>{this.ps&&this.ps.mT&&(this.jnh||(this.ps.aDo(this.Hig),this.jnh=!0),this.ps.Ssi())};this.Hig=r=>{this.Nbc.uploadStatusLabel=r;this.U$(this.titleText,Object(E.a)(this,this.rfe,"insertDialogHandler"),this.Nbc)};this.plg=()=>{this.GBj()};this.onKeyDown=r=>{4!==Jc.FocusManager.instance().MBj(r)&&r.preventDefault()};this.Xnb=b;this.VSk=h;this.rfa=this.vMh=!1;this.Y7a=null;this.wVe=!1;this.Fh=this.EZl;this.$g="InsertFileDialog";this.Ue(1,this.HTd);Vg.OP?(this.Nbc={["id"]:this.$g,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,
["onExecute"]:this.$ao}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.h5n},this.ti(this.titleText,Object(E.a)(this,this.rfe,"insertDialogHandler"),this.Nbc),this.S_=!0):(this.showDialog(this.titleText,Object(E.a)(this,this.rfe,"insertDialogHandler")),h&&this.a7o(),(b=this.t8d(1))&&this.wB.push(b),(b=this.t8d(0))&&this.wB.push(b),this.Sck(),this.S_=!1)}get Oek(){return this.Xnb}validate(){this.ps.mT||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");
return this.ps.mT.value?!0:(Vg.zA(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}rfe(b){1===b&&this.isEnabled()?Vg.OP&&this.ps.mT&&!this.ps.mT.value?(this.Nbc.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.U$(this.titleText,Object(E.a)(this,this.rfe,"insertDialogHandler"),this.Nbc)):(this.Kde(),this.Xnb.PCa(this.ps,Object(E.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}a7o(){this.wVe=!1;this.ps=this.gWj(document.getElementById("uploadFrameContainer"),this.Xnb);y.AFrameworkApplication.J.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.Y7a=this.plg,Re.a.addHandler(this.ps.OL,"load",this.Y7a));this.ps.mT||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.GBj()}GBj(){if(this.ps&&!this.wVe){var b=this.ps.mT;b&&(Re.a.addHandler(b,Fd.a.Bj,this.onKeyDown),b=[b],this.wB=b.concat.apply(b,this.wB),this.Sck(),this.wVe=!0)}}dispose(){if(this.ps&&!Vg.OP){const b=this.ps.mT;b&&Re.a.removeHandler(b,Fd.a.Bj,this.onKeyDown);this.Y7a&&Re.a.removeHandler(this.ps.OL,"load",this.Y7a)}this.ps=null;super.dispose()}Sck(){if(0<
this.wB.length){const b=new Ha(this.wB),h=Jc.FocusManager.instance().Cv();h&&(this.wB[0].focus(),h.Al=b,h.nR=!0)}}static get OP(){return y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.ta.Pb.w6i}static zA(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(u.a)(Vg,"InsertFileDialog",Xf.a,[]);class qj{static get Fh(){return Xf.a.iA(qj.pp,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}qj.pp="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(u.a)(qj,"InsertImageDialogHtml",null,[]);class Tn extends Vg{constructor(b,h=!0){super(b,h)}get HTd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get EZl(){return qj.Fh}validate(){this.ps.mT||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(ya.a)(Vm,this.Oek);const h=b.xJe(this.ps.mT.value);return 0!==h?(b=b.C9d(h),Vg.zA(b),!1):!0}}Object(u.a)(Tn,"InsertImageDialog",Vg,[]);class Wp extends Tn{constructor(b){super(b)}gWj(b,
h){const r=y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.ta.Pb.w6i;return new Cg.a(b,Object(E.a)(h,h.Myb,"onUploadFrameInitialized"),Object(E.a)(h,h.wqa,"uploadResponseReceived"),y.AFrameworkApplication.J,!r)}isEnabled(){return Wp.OT.kma(this.Oek.context)}static get OT(){return null!=Wp.r1g?Wp.r1g:Wp.r1g=Xa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(u.a)(Wp,"Box4InsertImageDialog",Tn,[]);class bj{jHl(b){return new Promise((h,r)=>{this.kHl(b).then(A=>{h(A)},A=>{r(A)})})}Nbi(b){return new Promise((h,
r)=>{const A=new FileReader;A.addEventListener("load",()=>{h(A.result)},!1);A.addEventListener("error",()=>{r("FileReader exception ("+A.error.name+")")});A.readAsDataURL(b)})}kHl(b){return new Promise((h,r)=>{this.Nbi(b).then(A=>{this.bvf(A,"image/jpeg").then(L=>{h(L)},L=>{r(L)})},A=>{r(A)})})}bvf(b,h){return new Promise((r,A)=>{const L=new Image;L.addEventListener("load",()=>{const ba=document.createElement("canvas"),ra=ba.getContext("2d");ba.width=L.width;ba.height=L.height;ra.drawImage(L,0,0);
r(ba.toDataURL(h))});L.addEventListener("error",()=>{A("Image failed to load")});L.src=b})}}Object(u.a)(bj,"ImageFormatConverter",null,[]);var Kj=e(240),Tj=e(1067);const oh=["ImageInsertFailed"];class Fc extends Vm{constructor(b,h,r,A,L,ba,ra,Ia=!0){var Ta;super(b,h,r);this.ap=ra;this.xIa=this.xn=this.XK=this.ng=null;this.$5d="wwpicturesfc";this.kpiName="ImageFileExtension";this.aNc="LocalDeviceUpload";this.D9=new Map;this.Ysi=0;this.Wnb=null;this.uVe="";this.xza=0;this.Tq=null;this.QLc="";this.Lzh=
50;this.Joh=this.YJc=this.OSc=this.gPc=!1;this.zKk=19922944;this.OBh=0;this.yVe=[];this.inh=[];this.PBh=0;this.o8n=()=>{Oe.a.cX&&this.ap.gM([25],this.$d)};this.ikg=ob=>{v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(ob){var nb={},Eb=this.XK?this.XK.properties.yc.toString():this.ng.yc.toString();nb[Wi.a.nodeId]=this.XK?this.XK.id.toString():this.ng.id.toString();nb[Wi.a.classId]=Eb;this.hg.hasProperty(Rc.a.imageType)&&(nb[ri.a.imageType]=this.hg.getValue(Rc.a.imageType));
this.hg.hasProperty(Rc.a.lZ)&&(nb[ri.a.lZ]=this.hg.getValue(Rc.a.lZ));this.hg.hasProperty(Kh.a.Wma)&&(nb[ri.a.Wma]=this.hg.getValue(Kh.a.Wma));this.hg.hasProperty(Rc.a.nxb)&&(nb[ri.a.nxb]=this.hg.getValue(Rc.a.nxb));Se.d(ob,this.ng,this.xn,nb)&&(this.Ytd(ob),Fc.Puc++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.O4n=ob=>{if(!this.iZf){var nb=this.fDi(this.ps);nb&&(this.uVe=nb.name,this.xza=nb.size);if(!this.yqa(ob,this.ps)||!this.qRg(nb,this.ps)){nb=Object.assign(new Sa.a,
{extendedProperties:new Map});nb.extendedProperties.set("type",this.yqa(ob,this.ps)?"Image too large":"FileType invalid");this.Nle(nb);this.Jle();return}}this.PCa(this.ps,null)};this.hg=A;this.yo=L;this.ga=ba;this.$d=Oe.a.ur||Oe.a.cX?ej.a.getInstance(ne.a):ej.a.getInstance(Kj.a);this.Qyh=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.cAh=r.sc("ImageUploadMaxByteSize",Number.MAX_VALUE);Ia&&this.showDialog();null===(Ta=Yg.a.pbb())||void 0===Ta?void 0:Ta.addHandler(this);Tj.a.Aug(this.o8n)}get Q3i(){return this.J.$("JfifImageInsertIsEnabled")}get YT(){return this.aNc}get fileExtension(){return this.uVe}get fileSize(){return this.xza}get Nek(){return this.Wnb}get ry(){return this.Tq||
(this.Tq=Xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get iZf(){return this.YT===this.aNc}showDialog(){Se.a(this.J)?(this.krb=!1,this.ps=new Cg.a(document.body,Object(E.a)(this,this.Myb,"onUploadFrameInitialized"),Object(E.a)(this,this.wqa,"uploadResponseReceived"),this.J,!1,void 0,!0)):Se.b()||this.Qxb&&X.a.BH?(this.krb=!1,this.ps=new Cg.a(document.body,Object(E.a)(this,this.Myb,"onUploadFrameInitialized"),Object(E.a)(this,this.wqa,"uploadResponseReceived"),this.J,!1)):(this.krb=!0,this.ps=
(new Wp(this)).ps)}JCi(b){switch(b){case Rg.jhd:return Of.a.jhd;case Rg.jZi:return Of.a.Vhn;case Rg.Cte:return Of.a.l9f}return Vi.a.unknown}Dod(b){this.iZf||(this.ng.hk()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Ph.a.instance.BQg(this.ng.hk()),this.ng.hk().Jg.lG(this.ikg,Object(E.a)(this,this.C_b,"processFailure"),b)):this.C_b(b,157))}Gwn(){return Se.c(this.ng)}Ytd(b){b.Ytd();this.Wnb=b.Wnb}wqa(b){this.Ysi=+new Date-+this.Nek;this.Jle();v.ULS.sendTraceTag(36783364,
322,50,"Box4PictureUploader.UploadResponseReceived");Se.e(this,b,this.ng)}yQg(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.Kvc();Fc.Puc--;this.ga.Vb(wb.a.aib,2);this.ng?Ph.a.instance.SDc(this.ng.hk(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.ry.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}C_b(b,h){var r;if(this.WPo(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,h.toLocaleString());else{b=Object.assign(new Sa.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());Oe.a.ur?this.$d.logKpiFailure({kpiName:ne.d.TMa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(Pg.c)(ne.d.Vnc,b,null,!1)}):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.$d.logKpiFailure({kpiName:Kj.c.lNa,
errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Kj.c.Qoc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):Ca.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",oh,!1,!0,!1,!1,b);r=this.xEf(h);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.ng.bK();var A=
new hb.GraphTransaction(15,fb.a.qZ);A.Eb(this.ng);Fc.OT.d2a(this.hg,r);Fc.OT.KIj(this.ng,this.XK);pe.a.cUj(this.hg,pd.a.zC);A.dispose();this.v_j(r);this.yo.nhc(b,!1);this.Kvc();Fc.Puc--;Ph.a.instance.SDc(this.ng.hk(),h)}}v_j(b){const h=new wg.StandardDialog;h.Md=0;h.zA(Of.a.lZi,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}xEf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}emk(){if(this.QLc&&0<this.QLc.length){const b=
new Ai.DictionaryPropertySet;b.setValue(Pd.a.PZ,this.QLc);b.setValue(Pd.a.$ha,!0);this.ga.Zb(fb.a.o8,2,b)}this.$dp()}$dp(){let b="";this.Joh?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.gPc&&this.YJc&&this.OSc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.gPc&&this.YJc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.gPc&&this.OSc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.OSc&&this.YJc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.OSc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.YJc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.gPc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.v_j(b),this.gnk())}B5k(b){this.QLc+=String.format('<img src="{0}"></img>',b);this.PBh++}ULn(){this.OSc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Sa.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Image too large");this.Nle(b)}TLn(){this.YJc=!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Sa.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.Nle(b)}Nej(b){this.Joh=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}fkp(b){const h=new bj;if(this.xJe(b.name)===Rg.vJe)return h.Nbi(b);if(Vm.yqa(b.name,Cg.a.zff)===Rg.vJe)return h.jHl(b)}uHl(b){return new Promise(h=>
{const r=this.fkp(b);void 0===r&&(this.Nej("Failed starting conversion work"),h());r.then(A=>{A.length>this.zKk?this.ULn():this.B5k(A);h()},A=>{this.Nej(A);h()})})}CBn(b){return this.xJe(b.name)===Rg.vJe||Vm.yqa(b.name,Cg.a.zff)===Rg.vJe}hhn(){const b=[];if(this.ps.mT.files){this.OBh=this.ps.mT.files.length;this.ps.mT.files.length>this.Lzh&&(this.gPc=!0);this.Rgb();for(let h=0;h<this.ps.mT.files.length&&this.Lzh;h++){const r=this.ps.mT.files[h];this.yVe.push(r.name);this.inh.push(r.size);r&&(this.CBn(r)?
b.push(this.uHl(r)):this.TLn())}}Promise.all(b).then(()=>{this.qhc();this.emk()});return!0}Xhn(){this.xn=qb.a.create();this.hg||(this.hg=new Ai.DictionaryPropertySet);this.Qyh&&this.xIa&&this.hg.setValue(Kh.a.$dj,this.xIa);var b=480;let h=320;const r=this.context.view.hj.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.hg.setValue(Kh.a.Wma,r));this.hg.setValue(Sb.a.Zva,rb.a.Zn(b,0));this.hg.setValue(Sb.a.zEa,rb.a.Zn(h,1));this.hg.setValue(Tc.a.S1,pd.a.YGa);this.hg.setValue(Pd.a.$ha,
!0);this.hg.setValue(Rc.a.nxb,Box4Intl.Box4Strings.l_Picture);b=Fc.OT.cmi(this.context,this.hg,this.xn);if(!b)return!1;this.ng=b.node;this.hg=(this.XK=b.blob)?this.XK.properties:this.ng.properties;If.a.Gd().pn&&If.a.Gd().Qk.uI(this.ng);return!0}Afe(){return this.iZf?this.hhn():this.Xhn()}gnk(){this.D9.set("FileExtensions",this.mtm());this.D9.set("FileSizeInBytes",this.inh.toString());this.D9.set("Source",this.YT);this.D9.set("NumberOfImagesAttemptedToInsert",this.OBh.toString());this.D9.set("NumberOfImagesPasted",
this.PBh.toString());if(Oe.a.ur){this.D9.set("ErrorLevel","warning");var b=Object.assign(new Sa.a,{extendedProperties:this.D9});this.$d.logKpiFailure({kpiName:ne.d.TMa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})}else(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.D9.set("ErrorLevel","warning"),b=Object.assign(new Sa.a,{extendedProperties:this.D9}),this.$d.logKpiFailure({kpiName:Kj.c.lNa,errorName:"MultipleImageInsertFailed",
optionalProperties:{additionalValues:b}})):Ca.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.$5d,this.D9)}mtm(){let b="";for(let h=0;h<this.yVe.length;++h)b=b+this.eDi(this.yVe[h])+",";return b}PCa(b,h){Oe.a.cX&&this.ap.RW([25]);this.Qyh&&(this.xIa=new Ae,this.xIa.mT=b.mT);super.PCa(b,h)}Myb(b){this.ps=b;if(!this.krb){if(this.Wwd){if(Se.a(this.J)||this.Qxb&&X.a.BH){b.o1c(this.O4n);return}const h=b.o1c(null),r=this.fDi(b);r&&(this.uVe=r.name,this.xza=r.size);if(!this.yqa(h,b)||!this.qRg(r,
b)){b=Object.assign(new Sa.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.yqa(h,this.ps)?"Image too large":"FileType invalid");this.Nle(b);this.Jle();return}}this.PCa(b,null)}}vde(){return!!Fc.Puc}Jle(){var b;this.D9.set("FileExtension",this.eDi(this.fileExtension));this.D9.set("Source",this.YT);this.D9.set("FileSizeInBytes",this.fileSize.toString());this.D9.set("RequestTimeInMs",this.Ysi.toString());Oe.a.ur?this.$d.logKpiUsage({kpiName:ne.d.TMa,kpiType:0,optionalProperties:{extendedProperties:this.D9}}):
(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.$d.logKpiUsage({kpiName:Kj.c.lNa,kpiType:0,optionalProperties:{extendedProperties:this.D9}}):Ca.Health.instance.recordKpiUsage(this.kpiName,0,this.$5d,this.D9)}eDi(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}TOi(){return this.Q3i?Cg.a.vPh:Vm.yff}fDi(b){return(b=b.mT)?b.files[0]:null}qRg(b,h){return b&&b.size>this.cAh?(h&&h.nUd(),b=this.C9d(Rg.Cte),this.Pq(this.JCi(Rg.Cte),
b),!1):!0}C9d(b){switch(b){case Rg.jhd:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Rg.jZi:return this.Q3i?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Rg.Cte:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.cAh/1E6));default:return""}}Nle(b){var h;Oe.a.ur?(b.extendedProperties.set("ErrorLevel","info"),this.$d.logKpiFailure({kpiName:ne.d.TMa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:b},optionalVeto:Object(Pg.c)(ne.d.Vnc,b)})):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Kj.c.Qoc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.$d.logKpiFailure({kpiName:Kj.c.lNa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):
Ca.Health.instance.recordQosError("PictureFromLocalInvalid",oh,!0,!0,!1,!1,b)}static get OT(){return null!=Fc.q1g?Fc.q1g:Fc.q1g=Xa.a.instance.resolve("Box4.Images.IImageEditor")}}Fc.Puc=0;Object(u.a)(Fc,"Box4PictureUploader",Vm,[515,513]);var Io=e(865),Rl=e(95);class tg{constructor(){this.ly=this.Wt=this.OJb=this.lNh=this.P6b=this.xwk=null;this.E9e=0;this.oza=this.N4e=this.$Jb=null;this.Lhh=0;this.hOe=this.nAa=this.z1e=null;this.fth=!1;this.sNe=this.nNe=this.tNe=null}get assetId(){return this.P6b}get thumbnailUrl(){return this.lNh}get previewUrl(){return this.OJb}get displayName(){return this.oza}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Wt,this.ly)}get B9k(){if(this.nNe&&this.sNe&&this.tNe){const b=document.createElement("a");b.setAttribute("href",this.tNe);b.setAttribute("target","_blank");b.innerText=this.sNe;return b}return null}get FVh(){return this.nNe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.Lhh)}get ovo(){const b=document.createElement("span");var h=0;if(this.$Jb&&0<this.$Jb.length){var r=this.$Jb.indexOf("."),A=0>r?this.$Jb:this.$Jb.substring(0,r);for(A=Number.parseInvariant(A);h<
A&&5>h;h++)b.appendChild(Ye.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Rl.a.kh("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.$Jb.substr(r+1)),3>r?b.appendChild(Ye.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Rl.a.kh("box42.png"),"","",!0,"")):8>r?b.appendChild(Ye.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Rl.a.kh("box42.png"),"","",!0,"")):b.appendChild(Ye.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Rl.a.kh("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Ye.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Rl.a.kh("box42.png"),"","",!0,""));this.N4e&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.N4e),b.appendChild(h));return b}get yOo(){return 0<this.E9e?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.E9e):""}get lhl(){if(this.fth){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.hOe&&this.nAa)return tg.tNl(this.hOe,this.nAa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.z1e){const h=this.z1e.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static rkm(b){const h=new tg;for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];if(1===A.nodeType)try{const L=A.firstChild.nodeValue;switch(A.nodeName){case "src":h.xwk=L;break;case "assetid":h.P6b=
L;break;case "thumb":"64x64"===A.attributes.getNamedItem("size").nodeValue?h.lNh=tg.M8j(L):"192x192"===A.attributes.getNamedItem("size").nodeValue&&(h.OJb=tg.M8j(L));break;case "imagedim":if(L){const ra=L.indexOf("x");0<ra&&ra<L.length&&(h.Wt=L.substr(0,ra),h.ly=L.substr(ra+1))}break;case "resolution":h.E9e=Number.parseInvariant(L);break;case "rating":h.$Jb=L;break;case "numofratings":h.N4e=L;break;case "displayname":h.oza=L;break;case "contentlength":h.Lhh=Number.parseInvariant(L)/1024;break;case "subject":h.z1e=
L;break;case "provider":h.nAa=L;break;case "attributionlink":h.hOe=L;break;case "iscsc":h.fth=1===Number.parseInvariant(L);break;case "additional":const ba=A.firstChild;if(A.hasChildNodes()&&ba&&"id"===ba.nodeName&&1===Number.parseInvariant(ba.text))for(let ra=0;ra<A.childNodes.length;ra++){const Ia=A.childNodes[ra];switch(Ia.nodeName){case "caption":h.nNe=Ia.text;break;case "value":h.tNe=Ia.text;break;case "string":h.sNe=Ia.text}}}}catch(L){}}return h}static tNl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static M8j(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(u.a)(tg,"ClipArtSearchResult",null,[]);class Dq{static get Fh(){return Xf.a.iA(Dq.pp,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Dq.pp="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(u.a)(Dq,"InsertClipartDialogHtml",null,[]);class Gp extends Xf.a{constructor(b){super();this.vIa=this.UGb=0;this.xFh=null;this.P7e=!1;this.Abc=this.N6a=this.qS=null;this.Etj=h=>{const r=this.A0.value;r&&0<r.trim().length&&(this.search(this.A0.value),this.Dxa(1,!1));h.preventDefault();h.stopPropagation()};this.l$n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.Etj(h),h.preventDefault(),h.stopPropagation())};this.Ftj=h=>{100<=this.A0.value.length&&(h.preventDefault(),h.stopPropagation())};
this.J8n=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.QAj(h);this.SCg(h)};this.v2=()=>{if(this.ou&&this.ou.children&&!(2>this.ou.children.length)){var h=this.ou.children[0].children[0],r=this.ou.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.ou.scrollTop,A=h.clientHeight+2,L=parseInt(String(this.ou.scrollTop/A));h=parseInt(String(r/A));var ba=parseInt(String(this.ou.clientWidth/A));h<r/A&&h<parseInt(String(this.qS.length/ba))&&h++;for(r=L;r<h;r++)for(A=0;A<ba;A++){var ra=
r*ba+A;L=this.qS[ra];(ra=document.getElementById("clip"+ra))&&!ra.childNodes.length&&(L=this.pgi(L),ra.appendChild(L))}}};this.rao=h=>{h.target.setAttribute("src",Rl.a.kh("phthumb.64x64x32.png"))};this.K8n=h=>{h.target.setAttribute("src",Rl.a.kh("phpreview.96x96x32.png"))};this.Mqj=h=>{ed.a.Zm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.Q5n=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.Mqj(h)};this.frj=h=>{const r=h.target.innerText;this.A0&&(this.A0.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.Dxa(1,!1)};this.x6n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.frj(h)};this.Htj=h=>{this.qS&&(this.LUo(this.qS[this.UGb]),h.stopPropagation(),h.preventDefault(),this.A0.value="",this.Dxa(1,!1))};this.m$n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Htj(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.vIa=this.vIa+r<this.ou.children.length-1?0>this.vIa+r?0:this.vIa+r:this.ou.children.length-1;this.SCg(this.vIa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.ou.children.length&&this.AQj(h)):h.keyCode===Sys.UI.Key.tab&&(this.vIa=h.shiftKey?
Math.max(0,this.vIa-1):Math.min(this.vIa+1,this.ou.children.length-1))};this.onError=()=>{this.ou&&(this.ou.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.cCj=h=>{if(this.ou)if(h.data.xpa){var r=h.data.xpa.lastChild.childNodes;this.qS||(this.qS=[]);for(h=0;h<r.length&&100>this.qS.length;h++){var A=r[h];1===A.nodeType&&"image"===A.nodeName&&(A=tg.rkm(A),this.qS.push(A))}this.Jli();this.qS.length||(this.ou.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.responseData){h=
D.a.C3j(h.data.responseData);try{r=parseInt(h)}catch(L){r=14}this.ou.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.Jli=()=>{if(this.qS){eb.a.FV(this.ou);this.N6a&&(this.N6a.dispose(),this.N6a=null);this.ou.focus();this.ou.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.qS.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const A=document.createElement("span");A.id="clip"+r;A.classList.add("ClipartImageContainer");
h.appendChild(A);this.ou.appendChild(h);r<parseInt(String(this.ou.clientHeight/A.clientHeight))*parseInt(String(this.ou.clientWidth/A.clientWidth))&&(h=this.pgi(this.qS[r]),A.appendChild(h))}this.P7e&&(this.AQj(this.UGb),this.SCg(this.UGb))}};this.vgn=h=>{1===h&&this.qS&&Gp.OT.kma(this.Jgh.context)&&(h=this.qS[this.UGb])&&this.Jgh.zGa(h)};this.Jgh=b;this.Fh=Dq.Fh;this.$g="InsertClipartDialog";this.Ue(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.vgn);this.ou=document.getElementById("clipartsearchresults");this.cPd=this.onKeyDown;Re.a.addHandler(this.ou,"keydown",this.cPd);this.bPd=this.v2;Re.a.addHandler(this.ou,"scroll",this.bPd);this.A0=document.getElementById("textInput");this.DRd=this.l$n;Re.a.addHandler(this.A0,"keydown",this.DRd);this.ERd=this.Ftj;Re.a.addHandler(this.A0,"keypress",this.ERd);this.FRd=this.Ftj;Re.a.addHandler(this.A0,"paste",this.FRd);this.NGc=document.getElementById("btnSearch");this.NGc.setAttribute("src",Rl.a.kh("search.16x16x32.png"));
this.aPd=this.Etj;Re.a.addHandler(this.NGc,"click",this.aPd);this.L8b=document.getElementById("clipartpreviewimage");this.wTe=document.getElementById("clipartattributedisplayname");this.ikb=document.getElementById("clipartseesimilar");this.vTe=document.getElementById("clipartdimensions");this.mJc=document.getElementById("clipartadditionalvalue");this.xTe=document.getElementById("clipartratingvalue");this.T4a=document.getElementById("clipartattributionvalue");this.U4a=document.getElementById("clipartkeywords");
this.tTe=document.getElementById("clipartadditionalname");this.yTe=document.getElementById("clipartratingname");this.uTe=document.getElementById("clipartattributionname");this.R7e=this.J8n;this.xdf=this.rao;this.pGd=this.Mqj;this.qGd=this.Q5n;this.x1e=this.frj;this.y1e=this.x6n;this.ePd=this.Htj;this.fPd=this.m$n;this.A0.focus();this.Dxa(1,!1)}dispose(){this.ou&&this.s7h();this.ou&&this.cPd&&(Re.a.removeHandler(this.ou,"keydown",this.cPd),this.cPd=null);this.ou&&this.bPd&&(Re.a.removeHandler(this.ou,
"scroll",this.bPd),this.bPd=null);this.ou=null;this.A0&&this.DRd&&(Re.a.removeHandler(this.A0,"keydown",this.DRd),this.DRd=null);this.A0&&this.ERd&&(Re.a.removeHandler(this.A0,"keypress",this.ERd),this.ERd=null);this.A0&&this.FRd&&(Re.a.removeHandler(this.A0,"paste",this.FRd),this.FRd=null);this.A0=null;this.NGc&&this.aPd&&(Re.a.removeHandler(this.NGc,"click",this.aPd),this.NGc=this.aPd=null);this.uTe=this.yTe=this.tTe=this.U4a=this.T4a=this.xTe=this.mJc=this.vTe=this.ikb=this.wTe=this.L8b=this.fPd=
this.ePd=this.y1e=this.x1e=this.qGd=this.pGd=this.Abc=this.xdf=this.R7e=null;this.N6a&&(this.N6a.dispose(),this.N6a=null);super.dispose()}JP(){super.JP();document.getElementById(this.Vj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.R1b(b,!1,this.cCj)}R1b(b,h,r){this.vIa=this.UGb=0;this.s7h();if(this.qS&&b===this.xFh&&this.P7e===h)window.setTimeout(this.Jli,500);else{this.qS&&(Array.clear(this.qS),this.qS=null);this.xFh=b;this.P7e=h;var A=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');
A.append("<query>");A.append(D.a.Mf(b));A.append("</query>");A.append("<mediatype>Illustration</mediatype>");A.append("<mediatype>Photo</mediatype>");A.append("<filetype>jpg</filetype>");A.append("<filetype>jpeg</filetype>");A.append("<filetype>gif</filetype>");A.append("<filetype>bmp</filetype>");A.append("<filetype>tif</filetype>");A.append("<filetype>tiff</filetype>");A.append("<filetype>png</filetype>");A.append("</search>");b=y.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let L=
b.length;4>L;L++)b="0"+b;y.AFrameworkApplication.pe.addRequest(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Ze.a.webServiceBase,b,ri.a.Lgp,h.toString()),2,A.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}LUo(b){this.R1b(b.assetId,!0,this.cCj);this.qS||(this.qS=[],this.qS.push(b))}pgi(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",b.thumbnailUrl);b=b.displayName?b.displayName:
Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Re.a.addHandler(h,"click",this.R7e);Re.a.addHandler(h,"error",this.xdf);return h}sXl(b){1===b.childNodes.length&&(b=b.childNodes[0],Re.a.removeHandler(b,"click",this.R7e),Re.a.removeHandler(b,"error",this.xdf))}QAj(b){const h=this.qS[b];var r=h.previewUrl;this.q7h();this.Abc=this.K8n;var A=document.createElement("img");A.setAttribute("src",r);if(h.displayName)r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,
h.displayName);else{r=new Sys.StringBuilder;for(let L=0;L<h.keywords.length&&5>L;L++)L&&r.append(", "),r.append(h.keywords[L]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}A.setAttribute("title",r);A.setAttribute("alt",r);Re.a.addHandler(A,"error",this.Abc);this.L8b.appendChild(A);A=document.getElementById("clip"+this.UGb);A.classList.remove("ClipartSelectedImage");A=document.getElementById("clip"+b);A.classList.add("ClipartSelectedImage");this.UGb=b;h.displayName&&
(this.wTe.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Re.a.addHandler(b,"click",this.ePd);Re.a.addHandler(b,"keydown",this.fPd);this.ikb.appendChild(b);this.vTe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.yOo,h.fileSize);(b=h.B9k)&&h.FVh?(this.mJc.parentNode.style.display="block",this.tTe.innerText=h.FVh,this.mJc.appendChild(b)):this.mJc.parentNode.style.display="none";this.xTe.appendChild(h.ovo);
eb.a.FV(this.T4a);if(b=h.lhl)this.T4a.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Re.a.addHandler(b,"click",this.pGd),Re.a.addHandler(b,"keydown",this.qGd));this.U4a.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)A=h.keywords[b],r=document.createElement("a"),r.innerText=A,r.setAttribute("href",'""'),Re.a.addHandler(r,"click",this.x1e),Re.a.addHandler(r,"keydown",this.y1e),this.U4a.appendChild(r),b<h.keywords.length-1&&(A=document.createElement("span"),A.innerText=
", ",this.U4a.appendChild(A));this.yTe.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.uTe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Dxa(1,!0)}q7h(){this.L8b&&1===this.L8b.childNodes.length&&(this.Abc&&(Re.a.removeHandler(this.L8b.childNodes[0],"error",this.Abc),this.Abc=null),eb.a.FV(this.L8b));this.T4a&&0<this.T4a.childNodes.length&&"a"===this.T4a.childNodes[0].nodeName.toLowerCase()&&(this.pGd&&Re.a.removeHandler(this.T4a.childNodes[0],"click",this.pGd),this.qGd&&Re.a.removeHandler(this.T4a.childNodes[0],
"keydown",this.qGd));this.ikb&&0<this.ikb.children.length&&"a"===this.ikb.children[0].nodeName.toLowerCase()&&(this.ePd&&Re.a.removeHandler(this.ikb.children[0],"click",this.ePd),this.fPd&&Re.a.removeHandler(this.ikb.children[0],"keydown",this.fPd),eb.a.FV(this.ikb));if(this.U4a){for(let b=0;b<this.U4a.childNodes.length;b++){const h=this.U4a.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Re.a.removeHandler(h,"click",this.x1e),Re.a.removeHandler(h,"keydown",this.y1e))}eb.a.FV(this.U4a)}this.wTe.innerText=
"";this.vTe.innerText="";eb.a.FV(this.mJc);eb.a.FV(this.xTe);eb.a.FV(this.T4a);this.U4a.innerText="";this.tTe.innerText="";this.yTe.innerText="";this.uTe.innerText=""}AQj(b){if(!(this.ou.children.length<=b||0>b)){var h=this.ou.children[b],r=this.ou.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.ou.scrollTop+this.ou.clientHeight<h.offsetTop+h.clientHeight?this.ou.scrollTop=h.offsetTop-3*h.clientHeight-r:this.ou.scrollTop>h.offsetTop&&(this.ou.scrollTop=h.offsetTop-r/2);this.QAj(b)}}validate(){return!0}s7h(){if(Jc.FocusManager.kO()){var b=
Jc.FocusManager.instance().getRegion(this.ZO);b&&b.Al.eC(this.A0)}else this.A0.focus();for(b=0;b<this.ou.childNodes.length;b++){const h=this.ou.childNodes[b];1===h.childNodes.length&&this.sXl(h.childNodes[0])}eb.a.FV(this.ou);this.q7h();this.Dxa(1,!1);this.N6a=new Io.a(Box4Intl.Box4Strings.l_ClipartSearching);this.N6a.C7i=!1;this.ou.appendChild(this.N6a.element);this.ou.classList.add("ClipartSearchInProgress")}SCg(b){this.vIa=b;b=this.ou.children[this.vIa];Jc.FocusManager.kO()?Jc.FocusManager.instance().getRegion(this.ZO).Al.eC(b):
b.focus()}static get OT(){return Gp.ll=Gp.ll||Xa.a.instance.resolve("Box4.Images.IImageEditor")}}Gp.ll=null;Object(u.a)(Gp,"InsertClipartDialog",Xf.a,[]);class Hp extends Fc{constructor(b,h,r,A,L,ba,ra){super(b,h,r,A,L,ba,ra,!1);this.r8n=Ia=>{if(this.Gwn()){var Ta=this.ng.hk(),ob=Ta.Jg.Au.toString(),nb=new Sys.Net.WebRequest;nb.set_url("ClipArtUpload.ashx");nb=new Sys.StringBuilder(nb.getResolvedUrl());this.I0(nb,ri.a.assetId,Ia.assetId,!0);this.I0(nb,Wi.a.lcid,y.AFrameworkApplication.lcid.toString());
this.I0(nb,Wi.a.nodeId,this.XK?this.XK.id.toString():this.ng.id.toString());this.I0(nb,Wi.a.cellId,Ta.Wl.toString());this.I0(nb,Wi.a.fileId,Ta.Kr);this.I0(nb,Wi.a.uBa,ob);this.I0(nb,Wi.a.g1,this.xn.toString());Ia=this.ng.ka(Kh.a.YL,kf.a.jw);this.I0(nb,Wi.a.YL,Ia.toString());this.I0(nb,Wi.a.rDb,"1");Ta.MI&&this.I0(nb,Wi.a.MI,Ta.MI);this.I0(nb,Wi.a.classId,this.XK?this.XK.properties.yc.toString():this.ng.yc.toString());this.hg.hasProperty(Rc.a.imageType)&&this.I0(nb,ri.a.imageType,this.hg.getValue(Rc.a.imageType).toString());
Sk.a.instance.K5k(nb);y.AFrameworkApplication.pe.addRequest(nb.toString(),2,"",{},!1,2,this.oJp,this.Jek,null);Fc.Puc++}};this.oJp=Ia=>{if(({group:Ta}=lm.a.A6(Ia.data.responseData)).returnValue){var Ta=Ta.Responses[0];Ta.Gfb=Ia.data.ZI;Ta.Cm=Ia.data.Pi?Ia.data.Pi[pj.a.u4]:"";this.wqa(Ta)}else this.Jek(null)};this.Jek=()=>{const Ia=new tp.a;Ia.StatusCode=14;this.wqa(Ia)};new Gp(this)}zGa(b){this.Afe()&&this.ng.hk().Jg.lG(this.r8n,null,b)}I0(b,h,r,A){b.append(A?"?":"&");b.append(D.a.nj(h));b.append("=");
b.append(D.a.nj(r))}xEf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.xEf(b)}}wqa(b){super.wqa(b);Fc.Puc--}}Object(u.a)(Hp,"ClipartUploader",Fc,[]);var ic=e(11),Dj=e(420);class Fm{constructor(b,h,r){this.wgn=(A,L,ba,ra,Ia)=>{if(!this.ll||!this.ll.value)return v.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;A=this.ll.value.kma(L);return 2===ba&&A?(new Hp(L,vb.TaskManager.instance,
y.AFrameworkApplication.J,Ia,this.yo,this.ga,new Dj.b),32):1===ba?A&&Ze.a.t8h?32:8:2};this.ll=b;this.yo=h;this.ga=r}mc(){this.ga.nb(fb.a.BXi,ic.a.view,this.wgn,260)}}Object(u.a)(Fm,"ClipArtActor",null,[]);class Il{constructor(){this.Z=null}get name(){return"Box4.ClipArt"}Ec(b){this.Z=b;b.ja("Box4.ClipArt.ClipArtActor",()=>new Fm(b.zf("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.va)).ha()}init(){this.Z.resolve("Box4.ClipArt.ClipArtActor").mc();const b=Db.StaticActiveAppFrame.Aa();
b&&b.Ne()}dispose(){}}Object(u.a)(Il,"ClipartPackage",null,[0,1]);class Mk{constructor(b){this.j7a=this.U6a=this.p7a=this.o7a=null;this.bqh=this.Bkh=this.cqh=this.pxh=this.vi=this.Pza=!1;this.s9e=this.Vxh=null;this.Fxh=0;this.za=this.Qxh=null;this.Bka=b;this.bS=3;this.t$b=!0}initialize(b,h,r){this.o7a=this.IQf(b,h);this.p7a=CommonUIStrings.l_SavingStatus;this.U6a=CommonUIStrings.l_ReadOnlyStatus;this.j7a=CommonUIStrings.l_ReviewModeStatus;this.Bka&&this.Bka.execute(A=>{A.TMb(Object(E.a)(this,this.Kwd,
"updateToSavingStatus"))});this.vi=!0;this.za=r;this.Bkh=this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}XCb(b,h){this.Pza=b;this.bS=h;this.t3a(this.t$b)}t3a(b){!this.t$b&&b&&(this.Qxh=new Date);this.t$b=b;this.bqh=!1;b=null;3===this.bS&&(b=this.t$b?this.o7a:this.p7a);this.J0l(b)}IQf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}Kwd(){this.t3a(!1)}QGm(){switch(this.bS){case 1:return this.U6a;
case 2:return this.j7a;default:return null}}PGm(){if(3!==this.bS)switch(this.bS){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.bqh?"FailedToSave":this.t$b?"Saved":"Saving"}lpn(b){return this.pxh===this.Pza&&this.Fxh===this.bS&&this.Vxh===b}UAf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Pza,b,this.QGm(),this.Qxh,this.t$b,this.Bkh?h.getHeaderSaveStatusIconProps(this.PGm()):null);this.cqh=!0;return null});this.s9e=null}J0l(b){this.vi&&mh.c()&&
!this.lpn(b)&&(!this.cqh&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.UAf(b):ed.a.nyc()?(this.s9e&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.s9e=window.requestIdleCallback(()=>{this.UAf(b)})):window.requestAnimationFrame(()=>{this.UAf(b)}),this.pxh=this.Pza,this.Vxh=b,this.Fxh=this.bS)}}Object(u.a)(Mk,"ReactSaveStatusUIHandler",null,[500]);class Eq{constructor(b,h){this.L1=
null;this.o7a=CommonUIStrings.l_SavedStatus;this.p7a=CommonUIStrings.l_SavingStatus;this.U6a=CommonUIStrings.l_ReadOnlyStatus;this.j7a=CommonUIStrings.l_ReviewModeStatus;this.Zkb=h;this.Bka=b;this.bS=3;this.bnb=!0}EG(){this.Bka&&this.Bka.execute(b=>{b.TMb(Object(E.a)(this,this.Kwd,"updateToSavingStatus"))});this.Zkb.execute(b=>{this.L1=b})}XCb(b,h){this.bS=h;3===h?this.t3a(this.bnb):2===h?this.gOg(this.j7a):this.gOg(this.U6a)}Kwd(){this.t3a(!1)}t3a(b){this.bnb=b;this.gOg(this.bnb?this.o7a:this.p7a)}gOg(b){this.L1&&
this.L1.sendMessage(J.a.pzp,this.oFl(b))}oFl(b){const h={};h.StatusText=b;return h}}Object(u.a)(Eq,"SaveStatusPostMessageHandler",null,[500]);var ge=e(1041),Lj=e(169);class Xp{constructor(b,h,r,A){this.j7a=this.U6a=this.p7a=this.o7a=null;this.xIb=0;this.O3=this.z$e=this.gEb=this.XNe=this.Mdf=null;this.Yg=b;this.Ukb=h;this.Bka=r;this.zn=A;this.guh=!0;this.Pza=!1;this.bS=3;this.bnb=!0}initialize(b,h){if(!this.Yg)return!1;this.o7a=this.IQf(b,h);this.p7a=CommonUIStrings.l_SavingStatus;this.U6a=CommonUIStrings.l_ReadOnlyStatus;
this.j7a=CommonUIStrings.l_ReviewModeStatus;this.EG();return!0}IQf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}EG(){this.Ukb&&this.Ukb.execute(b=>{b.q8k(Object(E.a)(this,this.Xfi,"createStatusAndModeElements"));b.X7k(Object(E.a)(this,this.Bep,"showHideSaveStatusElement"));b.mup&&this.Xfi(null,null)});this.Bka&&this.Bka.execute(b=>{b.TMb(Object(E.a)(this,this.Kwd,
"updateToSavingStatus"))})}s_(){this.O3&&this.Yg&&this.Yg.SGa(this.O3)}Bep(b,h){this.XCb("true"===h,this.bS)}XCb(b,h){this.Pza=b;this.bS=h;this.XNe&&(this.XNe.style.display=this.Pza||3===this.bS||!this.Mdf?"none":"");this.gEb&&(this.gEb.style.display=this.Pza||3===this.bS?"none":"",this.gEb.innerText=1===this.bS?this.U6a:this.j7a,this.gEb.title=1===this.bS?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.z$e&&(this.z$e.style.display=this.Pza||1===this.bS||!this.Mdf&&
!this.gEb?"none":"");this.O3&&(this.O3.style.display=this.Pza||1===this.bS?"none":"",this.t3a(this.bnb),this.O3.title=CommonUIStrings.l_SaveStatusTooltip)}Xfi(b,h){b=document.getElementById(ge.a.T5m);h&&h.yOp||!b||""===this.o7a||""===this.p7a||""===this.U6a||""===this.j7a||(this.Mdf=document.getElementById(ge.a.Uof),this.XNe=ge.a.R0d(b,"BreadcrumbAppModeDash","-"),this.gEb=ge.a.R0d(b,"BreadcrumbAppModeStatus",1===this.bS?this.U6a:this.j7a),this.Pbk(this.gEb),this.z$e=ge.a.R0d(b,"BreadcrumbSaveStatusDash",
"-"),this.O3=ge.a.R0d(b,"BreadcrumbSaveStatus",this.o7a),this.Pbk(this.O3),this.XCb(this.Pza,this.bS))}Kwd(){this.t3a(!1)}t3a(b){this.bnb=b;this.CHp(this.bnb?this.o7a:this.p7a)}CHp(b){!this.O3||3!==this.bS&&2!==this.bS||(this.guh&&!this.bnb?(this.xIb=this.O3.offsetWidth<this.xIb?this.xIb:this.O3.offsetWidth,this.iCp(this.p7a),this.guh=!1):this.O3.innerText=b)}Pbk(b){b.style.direction=this.zn?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.zn?"right":"left";b.style.display=this.Pza?"none":
"";b.setAttribute("Unselectable","on")}iCp(b){this.O3&&(this.O3.style.width="",this.O3.innerText=b,this.xIb=this.O3.offsetWidth<this.xIb?this.xIb:this.O3.offsetWidth,b=Lj.a.JB(this.O3),this.O3.style.width=this.xIb-eb.a.LW(b.paddingLeft)-eb.a.LW(b.paddingRight)+1+"px")}}Object(u.a)(Xp,"SaveStatusUIHandler",null,[500]);var Cl=e(116);class Yp{constructor(){this.A$e=this.E8e=this.TUa=this.Z=null;this.Gz=()=>{const b=y.AFrameworkApplication.J,h=!!y.AFrameworkApplication.ta.Pb&&4===y.AFrameworkApplication.ta.Pb.gl;
if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.J1?(this.A$e=this.Z.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.A$e.EG():y.AFrameworkApplication.ta.Pb.N4f||y.AFrameworkApplication.hideHeader||(y.AFrameworkApplication.ta.Pb.JN?(this.E8e=
this.Z.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.E8e.initialize(b.$("IsSkyDrive"),b.rb("HostNameToIncludeInSavedStatus"),y.AFrameworkApplication.J):(this.TUa=this.Z.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.TUa.initialize(b.$("IsSkyDrive"),b.rb("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}Ec(b){this.Z=b;y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.J1?this.Z.register(Eq,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().fe(()=>
new Eq(this.Z.Za("Common.App.HostNotification.EditNotificationEventSource"),this.Z.Za("Postmessage.IHostPostmessenger"))):y.AFrameworkApplication.ta.Pb.N4f||(y.AFrameworkApplication.ta.Pb.JN?this.Z.register(Mk,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().fe(()=>new Mk(this.Z.Za("Common.App.HostNotification.EditNotificationEventSource"))):this.Z.register(Xp,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().fe(()=>
new Xp(Cl.EventHandlerManager.instance,this.Z.Za("Common.App.Header.HeaderEventSource"),this.Z.Za("Common.App.HostNotification.EditNotificationEventSource"),y.AFrameworkApplication.isRtl)))}init(){y.AFrameworkApplication.J.lq(this.Gz)}dispose(){this.TUa&&this.TUa.s_()}}Object(u.a)(Yp,"PackageManager",null,[0,1]);var Qo=e(1632);class oq{get name(){return"Common.App.EventsCachePackage"}Ec(){}init(){Qo.a.instance.init()}dispose(){}static main(){F.a.instance.Rc(new oq)}}Object(u.a)(oq,"EventsCachePackage",
null,[0,1]);var Fk=e(134),Di=e(265),tn=e(1387),vk=e(1263),bg=e(465),Ri=e(1444),vm=e(1410),ef=e(1376),xj=e(288),Sg=e(1380);class Zj{constructor(b){this.mth=!1;this.zzd=this.ho=null;this.WMe=!1;this.dI=b}get control(){return this.dI}get ie(){return this.control.ie}get root(){return this.control.root}get eM(){return this.control.eM}get e8a(){return this.control.e8a}get Rl(){return this.control.Rl}get GI(){return this.control.GI}WM(){}initialize(){}fA(b,h,r){this.control.E1l(b,h,r)}qo(){ef.c(this.control.yi.Command)||
this.Lw(this.control.yi.Command,null,null)}Lw(b,h,r){let A=0;this.root&&(A=this.root.Twa(b,h,r));this.control.enabled=0<(A&1);return A}cib(){let b=this.control.visible;this.root.P2a&&(b=this.ie[xj.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Auc=!0));return b}KPg(){const b=Sg.a.zya(this.ie[xj.a.labelText],this.control.yi.LabelText);this.jBe(b)}jBe(b){this.control.labelText!==b&&(this.GI.forEach(h=>{h.jBe(b)}),this.control.labelText=b,this.root.Zdb=!0)}b5b(){const b=Sg.a.zya(this.ie[xj.a.alt],
this.control.yi.Alt);this.cAc(b)}cAc(b){this.control.tooltip!==b&&(this.GI.forEach(h=>{h.cAc(b)}),this.control.tooltip=b)}uqa(){const b=Sg.a.zya(this.ie[vk.a.Image16by16Class],this.control.yi.Image16by16Class),h=Sg.a.zya(this.ie[vk.a.Image32by32Class],this.control.yi.Image32by32Class);var r=Sg.a.zya(this.ie[vk.a.Image48by48Class],this.control.yi.Image48by48Class);r=ef.b(r)?h:r;this.jWc(this.GI.small,b);this.jWc(this.GI.eu,b);this.jWc(this.GI.DZ,h);this.jWc(this.GI.Thp,b);this.jWc(this.GI.Fsc,r)}jWc(b,
h){!b||ef.c(b.WV)||ef.c(h)||b.WV.className===h||(b.WV.className=h)}WDp(b){if(!ef.b(b)&&this.root.WJg){for(const h of this.control.Jtf){const r=h.QY===b;r&&(this.control.hhf=h);this.control.visible&&(h.DE=r)}this.control.visible&&(this.root.Zdb=!0)}}T9k(){if(this.GI.Fsc&&this.GI.Fsc.iT&&this.GI.Fsc.Frb){const b=this.GI.Fsc.iT,h=Sg.a.zya(this.ie[bg.a.Description],this.control.yi.Description);ef.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding=
"0px")}}onFocus(){const b=this.Rl;Object(Pb.a)(Ri.a,b)?this.eM.RCb(b):this.root.UOb=this.control;return!1}onBlur(){const b=this.Rl;this.control.yWb()&&Sg.a.Kz(b.fd,"cui-ctl-menu-hovered-without-focus");this.root.UOb=null;return!1}eU(b){if(this.control.yWb()){var h=this.eM.Wxa;const r=h===this.root.jYb-1;h=r?null:this.root.uG[h+1];this.Bsf(!1);r||this.control===h||Sg.a.Kz(h.kXb,vm.MenuLauncher.ugd);this.control.enabled&&this.control.lx?r?this.control.N2():(Sg.a.Gg(this.Rl.fd,"cui-ctl-menu-hovered-without-focus"),
h.Yma=this.control.lx):r?this.eM.setFocus(b.Og):(h.Yma=this.eM.fd,this.eM.pxa())}return!1}RN(){this.control.yWb()&&Sg.a.Kz(this.Rl.fd,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!ef.c(b.Yb)&&!ef.c(b.Yb.rawEvent)){const r=b.Yb.keyCode;b=b.Yb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Pb.a)(Ri.a,this.Rl)){const A=this.eM;if(!ef.c(A)){const L=A.Wxa,ba=0===this.root.textDirection,ra=!ef.c(this.control.ngo);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&
r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;ed.a.Xrf();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(A.YO(1),h=!0):r===Sys.UI.Key.left&&ba||r===Sys.UI.Key.right&&!ba?(ra?A.YO(2):0<L&&this.root.u9a(L,!0,!1),h=!0):r===Sys.UI.Key.right&&ba||r===Sys.UI.Key.left&&!ba?(ra&&A.YO(4),h=!0):r===Sys.UI.Key.up?(A.YO(5),h=!0):r===Sys.UI.Key.down?(A.YO(6),h=!0):r===Sys.UI.Key.esc&&(this.root.u9a(L,!0,!1),h=!0):(A.YO(0),h=!0)}}}return h}WB(b){let h=!1;if(!ef.c(b.Yb)&&!ef.c(b.Yb.rawEvent)){const r=
b.Yb.keyCode;lc.KeyInputManager.FSi(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.OUf(b),h||(this.fA(b.Ff,1,b.Yb),h=!0))}return h}rA(b){this.ytf();if(this.e8a){let h=!0;2===b.Og&&(h=b.sia===Sys.UI.MouseButton.leftButton);h&&this.Rl&&this.UTd(this.Rl.fd)}(b.Yb.type.toLowerCase()!==Fd.a.HU||this.e8a)&&b.Yb.preventDefault();return!1}get g0f(){return this.mth}i6l(){this.mth=!0}ytf(){this.g0f&&this.control.root.dqb()}Eda(b){Object(Pb.a)(Ri.a,this.Rl)&&!this.e8a&&2===b.Og&&b.sia===Sys.UI.MouseButton.leftButton?
(this.fA(b.Ff,b.Og,b.Yb),b=!0):b=this.control.sCa(b);return b}onClick(b){let h=!1;Object(Pb.a)(Ri.a,this.Rl)&&!this.e8a&&3===b.Og&&(this.fA(b.Ff,b.Og,b.Yb),h=!0);return X.a.Yi?!1:h}Lyb(b){return this.ipe(b)}hPa(b){this.sCa(b);return!1}ipe(b){return ef.c(this.ho)?!1:(this.gCg(ed.a.mrc(this.zRh,b.clientPoint)),!0)}pvc(b){let h=!1;this.sCa(b)&&(h=!0);3!==b.Og&&(b=!0,!this.root&&Zj.wgg&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.r8(),h=!0);return h}svc(b){return this.sCa(b)}qvc(b){return this.ipe(b)}rvc(b){return this.sCa(b)}nvc(b){return 3===
b.Og?(this.root.r8(),!0):!1}ovc(){return!1}get zRh(){!ef.c(this.ho)&&ef.c(this.zzd)&&(this.zzd=ed.a.getElementBounds(this.ho));return this.zzd}gCg(b){this.WMe!==b&&(this.WMe=b,this.ihf(this.WMe))}ihf(b){ef.c(this.ho)||Sg.a.O$(this.ho,tn.a.XTd,b)}UTd(b){this.control.enabled&&(this.ho=b,this.root.VUc=this.control,this.gCg(!0),this.root.ema(this.control,!1))}sCa(b){if(!ef.c(this.ho)){this.gCg(!1);let h=!!this.root;if(Zj.wgg){const r=qf.ActionManager.yba(parseInt(this.control.yi.Command))||"";v.ULS.sendTraceTag(588084885,
207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.Vga(this.control,!1);ef.c(b)||ed.a.mrc(this.zRh,b.clientPoint)&&this.fA(this.ho,b.Og,b.Yb);h=!!this.root;Zj.wgg&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.VUc=null);this.zzd=this.ho=null;return!0}return!1}YO(b){return Object(Pb.a)(Ri.a,this.Rl)&&2!==b&&4!==b&&!ed.a.Ipc(this.control.lx)?this.N2():!1}N2(){try{if(this.control.visible){const b=this.control.lx;if(!ef.c(b))return b.focus(),!0}}catch(b){}return!1}Bsf(b){const h=
this.eM;ef.c(h)||this.root.u9a(h.Wxa+1,b)}zwa(){}OUf(){return!1}bR(b){let h=null;b&&b.rawEvent&&(h={},h[Zj.triggerTime]=b.rawEvent.timeStamp);return h}static get wgg(){null==Zj.I4e&&(Zj.I4e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Zj.I4e}}Zj.triggerTime="TriggerTime";Zj.I4e=null;Object(u.a)(Zj,"ControlBehavior",null,[537]);var hl=e(188);class Ao extends Zj{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.yi}WM(b){const h=
b.Do;b=b.QY;ef.c(h)||(Fe.a.instance.Cb(Fd.a.focus,h,Object(E.a)(this,this.onFocus,"onFocus")),Fe.a.instance.Cb(Fd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur")),Di.a.instance.Cb(Fd.a.WN,h,Object(E.a)(this,this.eU,"onPointerOver")),Di.a.instance.Cb(Fd.a.kJ,h,Object(E.a)(this,this.RN,"onPointerOut")),lc.KeyInputManager.instance.wK(Fd.a.Bj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"),b),lc.KeyInputManager.instance.wK(Fd.a.Jw,h,Object(E.a)(this,this.qK,"onKeyPress"),b),lc.KeyInputManager.instance.wK(Fd.a.zi,
h,Object(E.a)(this,this.WB,"onKeyUp"),b),Di.a.instance.Cb(Fd.a.Lu,h,Object(E.a)(this,this.rA,"onPointerDown")),Di.a.instance.Cb(Fd.a.zR,h,Object(E.a)(this,this.Eda,"onPointerUp")),Wf.a.instance.Cb(Fd.a.click,h,Object(E.a)(this,this.onClick,"onClick")),hl.a.instance.Cb(Fd.a.GU,h,Object(E.a)(this,this.Lyb,"onTouchMove")),hl.a.instance.Cb(Fd.a.gO,h,Object(E.a)(this,this.hPa,"onTouchEnd")))}fA(b,h,r){this.control.enabled&&(b=null,this.Rl&&this.Rl.Ubd()&&this.eM&&(b=this.root.uG[this.eM.Wxa])&&!this.g0f&&
(b.W1a(this.button),b=null),this.executeCommand(this.control.yi.Command,h,!0,r),b&&b.W1a(this.button))}executeCommand(b,h,r,A){if(!ef.c(b)){const L=this.ie;L.CommandValueId=this.button.nSb();L.MenuItemId=this.button.yi.MenuItemId;L.SourceControlId=this.control.id;this.root.executeCommand(b,L,this.Rl,h,r,null,this.bR(A))}}qo(){ef.c(this.control.yi.Command)||0<(this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie)&2)&&this.cib()&&this.q3a()}q3a(){this.KPg();this.b5b();this.uqa()}onFocus(b){super.onFocus(b);
this.mEe();return!1}onBlur(b){super.onBlur(b);this.D4d();return!1}onKeyDown(b){let h=super.onKeyDown(b);ef.c(b.Yb)||this.tFg(b.er,b.Yb.keyCode)&&(h=!1);return h}qK(b){let h=!1;ef.c(b.Yb)||ef.c(b.Yb.rawEvent)||(this.tFg(b.er,b.Yb.rawEvent.keyCode)?(this.fA(b.Ff,b.Og,b.Yb),h=!0):b.Yb.preventDefault());return h}tFg(b,h){if(X.a.Zt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}WB(b){let h=!1;ef.c(b.Yb)||this.tFg(b.er,b.Yb.keyCode)||
(h=super.WB(b));return h}mEe(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}D4d(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(u.a)(Ao,"ButtonBehavior",Zj,[]);var Bn=e(1575);class Ol{}Ol.Color="Color";Ol.IndexColorSelected="ColorSelected";Object(u.a)(Ol,"ColorPickerCommandProperties",null,[]);var Jo=e(1519);class eo extends Zj{constructor(b){super(b);this.dSc=this.jy=-1}get AOb(){return this.control}get sWa(){return this.AOb.kBl.sWa}get properties(){return this.AOb.yi}fA(b,
h,r){if(this.control.enabled){const A=this.ie;A.Color=eo.Y$d(b)[Bn.ColorPicker.TZd];b=null;Sg.a.zu(this.properties.Stateful)&&this.Rl&&this.Rl.Ubd()&&this.eM&&(b=this.root.uG[this.eM.Wxa]);this.root.executeCommand(this.properties.Command,A,this.Rl,h,!0,null,this.bR(r));b&&b.W1a(this.AOb)}}qo(){var b=this.ie;b.SourceControlId=this.properties.Id;if(0<(this.Lw(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Ol.IndexColorSelected in this.ie&&(b=this.ie[Ol.IndexColorSelected]),b!==this.dSc)){const h=
this.sWa;0<=b&&b<h.length&&this.gbk(h[b],!0);0<=this.dSc&&this.dSc<h.length&&this.gbk(h[this.dSc],!1);this.dSc=b}}gbk(b,h){h?Sg.a.Gg(b,"cui-colorpicker-selected"):Sg.a.Kz(b,"cui-colorpicker-selected")}WM(b){for(let h=0;h<b.Hgf.length;++h){const r=b.Hgf[h];Fe.a.instance.Cb(Fd.a.focus,r,Object(E.a)(this,this.Phg,"onCellFocus"));Fe.a.instance.Cb(Fd.a.blur,r,Object(E.a)(this,this.C2n,"onCellBlur"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,r,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.zi,
r,Object(E.a)(this,this.WB,"onKeyUp"));Wf.a.instance.Cb(Fd.a.click,r,Object(E.a)(this,this.D2n,"onCellClick"));Di.a.instance.Cb(Fd.a.zR,r,Object(E.a)(this,this.Rhg,"onCellPointerUp"));Di.a.instance.Cb(Fd.a.WN,r,Object(E.a)(this,this.Qhg,"onCellPointerOver"));Di.a.instance.Cb(Fd.a.Lu,r,Object(E.a)(this,this.E2n,"onCellPointerDown"))}}Phg(b){b=eo.Y$d(b.Ff);this.eM.RCb(this.Rl);this.nIe(b,!0);return!0}C2n(b){this.nIe(eo.Y$d(b.Ff),!1);return!0}nIe(b,h){h?(this.jy=parseInt(b.getAttribute("arrayPosition")),
Sg.a.Gg(b,"cui-colorpicker-hoveredOver"),this.mEe(b)):(this.jy=-1,this.D4d(b),Sg.a.Kz(b,"cui-colorpicker-hoveredOver"))}D2n(b){3===b.Og&&this.fA(b.Ff,b.Og,b.Yb);return!0}Rhg(b){3!==b.Og&&this.fA(b.Ff,b.Og,b.Yb);return!0}Qhg(b){this.Bsf(!1);b=parseInt(eo.Y$d(b.Ff).getAttribute("arrayPosition"));this.brd(b);return!0}E2n(){return!1}mEe(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!ef.b(h)){const r=this.ie;r.Color=b[Bn.ColorPicker.TZd];this.root.executeCommand(h,r,this.Rl,0,!1)}}}D4d(b){if(this.control.enabled){const h=
this.properties.CommandRevert;if(!ef.b(h)){const r=this.ie;r.Color=b[Bn.ColorPicker.TZd];this.root.executeCommand(h,r,this.Rl,0,!1)}}}YO(b){b=Jo.a.FHf(this.jy,this.AOb.width,this.sWa.length,b);if(b!==this.jy&&this.brd(b))return!0;this.nIe(this.sWa[this.jy],!1);return!1}N2(){return this.brd(0)}brd(b){return this.sWa&&this.sWa.length>b&&(b=this.sWa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}zwa(){-1!==this.jy&&this.nIe(this.sWa[this.jy],!1)}static Y$d(b){return eo.zHm(b)}static zHm(b){var h=["td"];
const r=h.length;if(!b)return null;for(var A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;for(b=b.parentNode;b;){for(A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;b=b.parentNode}return null}}Object(u.a)(eo,"ColorPickerBehavior",Zj,[]);var tl=e(355),Ro=e(383),vr=e(1690),up=e(713),kn=e(1421),ip=e(1676);class mm{constructor(b,h){this.oWk=b;this.Xsh=h}SAe(b,h,r,A){if(ef.c(b)||ef.c(h))return null;const L=new ip.a;const ba=A.x,ra=A.y,Ia=A.width;var Ta=A.height;
let ob;mm.hjc(h,"flyoutWidth");A=mm.hjc(h,"flyoutRealHeight");const nb=mm.hjc(h,"viewportWidth"),Eb=mm.hjc(h,"viewportHeight"),bc=mm.hjc(h,"viewableLeft"),Bc=mm.hjc(h,"viewableTop"),Yc=this.oWk;let zd=!1,Jd=!1;const ie=1===r,re=4===r,me=this.Xsh;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";ob=this.Mij(b);L.Agk=Eb;L.PRg=nb;if(ie)Yc?h=ba+Ia:(h=ba-ob,L.Ywb=!0),Ta=ra;else{var Sd="";Ia>ob&&(ob=Ia,Sd=(ob-2*kn.Menu.cne).toString());Yc?h=ba:(h=ba+Ia-ob,L.Ywb=
!0);Ta=ra+Ta;""!==Sd&&(b.style.minWidth=Sd+"px")}me&&(Ta+=Bc,h+=bc);b.style.top=Ta+"px";b.style.left=h+"px";let cf=Sd=!1;ob<=nb?h+ob>bc+nb?(ie&&Yc&&ba-ob>bc||re&&ba-ob>bc?(h=ba-ob,me&&(h+=bc),cf=L.Ywb=!0):(h=bc+nb-ob,zd=!0),Sd=!0):h<bc&&(ie&&!Yc&&ba+Ia+ob<bc+nb?(h=ba+Ia,me&&(h+=bc),L.Ywb=!1,cf=!0):(h=bc,Jd=!0,L.Ywb=!0),Sd=!0):Yc?(h=bc,Sd=!0,L.Ywb=!0):(h=bc+nb-ob,Sd=!0,L.Ywb=!1);Sd&&(b.style.left=h+"px");L.blc=Ta;if(!(Ta+A<=Bc+Eb)||3===r){L.a7f=!0;const {fYn:sf,Dhm:yh,Wqn:si,wyn:cl}=this.cHf(r,Ta,
A,ra,Bc,Eb);Ta!==sf&&(b.style.top=sf+"px",L.blc=sf);-1<yh&&(b.style.maxHeight=yh+"px");si&&(b.style.bottom="0px",b.style.height="auto");cl&&this.RPn(b,Yc,ie,cf,Jd,zd,nb,ba,Ia)}L.Z3c=h;L.BHf=ob;L.xHf=A;return L}cHf(b,h,r,A,L,ba){let ra,Ia,Ta;ra=-1;Ta=Ia=!1;const ob=h,nb=L+ba-h;h=A-r;const Eb=this.Xsh;let bc=!1;0>h&&(h=L);Eb||(A-=L);r<=A&&1!==b||(4===b||1===b?r<ba?(h=ba-r,Ia=!0):(h=L,bc=Ta=Ia=!0):(A<nb&&3!==b?(h=ob,Ia=!0):ra=A,Ta=!0));Eb&&(Ia=!1,bc?ra=ba:h+=L);return{fYn:h,Dhm:ra,Wqn:Ia,wyn:Ta}}RPn(b,
h,r,A,L,ba,ra,Ia,Ta){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ba||A)b.style.left="",b.style.right=(ba?0:ra-Ia)+"px"}else L||A||(b.style.left="",b.style.right=(r?ra-Ia:ra-Ia-Ta)+"px")}ywm(b){const h={};if(ef.c(b))return h;h.viewportWidth=eb.a.aub();h.viewportHeight=eb.a.G1();ef.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);ef.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=
document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;ef.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);ef.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*kn.Menu.cne:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Mij(b);b.style.overflowY=
r;return h}Mij(b){return b.offsetWidth}static hjc(b,h){return ef.c(b)?0:b[h]}}Object(u.a)(mm,"MenuPositioner",null,[]);var Fq=e(1462),br=e(1503),xi=e(1679),bh=e(1677),Dl=e(1674),cr=e(1675),ul=e(1682),oa=e(1434),Za=e(1571);class xb extends Zj{constructor(b){super(b);this.F3e=0;this.kxh=null;this.V6e=-1;this.HDd=null;this.Iog=this.Jph=!1;this.S_k=()=>{this.fh&&this.fh.fd&&(document.body.appendChild(this.K_h),this.jlo())};this.skf=h=>{h.element&&(h.element.style.filter="",h.element.style.opacity="",
this.fh&&this.fh.fd===h.element&&Object(Pb.a)(Dl.a,this.fh)&&Ro.a.Qal(this.aAi()))};this.UKk=new mm(0===this.root.textDirection,Sg.a.zu(this.root.properties.DivSyndicated))}get djj(){return this.UKk}get wx(){return this.control}get properties(){return this.control.yi}get fh(){return this.wx.fh}set fh(b){this.wx.fh=b}get rP(){return this.wx.rP}set rP(b){this.wx.rP=b}get K_h(){ef.c(this.HDd)&&(this.HDd=xb.lwf());return this.HDd}get YYj(){let b=!this.root.IXf;Object(Pb.a)(214,this.root)&&1===this.root.jYb&&
(b=!0);return b}fA(b,h){Object(Pb.a)(214,this.root)&&this.root.LDf();this.wx.t5(h)}t5(b){if(this.wx.enabled&&!this.rP){var h=$g.a.instance.vr(wb.a.t5);h.properties.add("Id",this.wx.yi.Id);h.properties.add("InputMethod",tl.a[b]);h.end();Yb.a.mark(10326);ed.a.ane(this.wx.yi.Id,"MenuOpen");this.wx.lx&&(this.wx.Yma=ed.a.Nsb(this.wx.lx.ownerDocument));this.F3e=b;this.tzj(b);this.fAe();this.wx.Uhb(this.wx.lx,!0)}}fAe(){ef.c(this.properties.PopulateAsyncTriggerCommand)||this.Jph||(this.SZn(),this.Jph=!0)}SZn(){const b=
{};b[vr.a.Callback]=Object(E.a)(this,this.$Fj,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.Rl,0,!1)}$Fj(){this.wx.o1a()}o1a(){this.rP&&this.tzj(this.F3e,!0)}tzj(b,h=!1){var r=!0;if(Sg.a.zu(this.properties.PopulateDynamically)){r=!1;const A=this.Ekd(b);A!==this.kxh&&(r=this.Yog(A,h));r=r||!this.rP}r&&(h=y.AFrameworkApplication.ta.Kt,r=null,h&&(r=h.rg("LoadResource","Menu Initialization")),this.Nha(b),r&&r.stop(),this.Eqe())}Nha(b){if(!ef.c(this.fh)){if(this.wx.Oeb){var h=
this.wx.Rl;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.fh.Y3o(String.format("{0} {1}",this.wx.Oeb,h.keytip.QCf),this.wx.P0a&&""!==this.wx.P0a?String.format("{0}-{1}",this.wx.P0a,r):r)}}this.fh.kua();Sg.a.Gg(this.fh.fd,this.wx.hkf);Sg.a.O$(this.fh.fd,"cui-touch",3===b||this.root.UGe);if(this.fh.hasItems()){this.fh.WM();h=this.Rl;h.Api();h.I9c=!0;h.pg(this.fh);h.I9c=!1;this.fh.nzj();r=Object(Pb.a)(Za.a,this.root);var A=null,L=!1;r&&(A=this.root,L=A.Kgb,A.Kgb=!1);var ba=this.fh.fd;ba.style.visibility=
"hidden";ba.style.position="absolute";ba.style.top="0px";ba.style.left="0px";X.a.Zt&&!X.a.MZa&&(ba.style.maxHeight="100px",ba.style.overflowY="scroll");document.body.appendChild(ba);this.W9k();this.olo(ba);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.R_k();Sg.a.Gg(this.wx.kXb,vm.MenuLauncher.ugd);var ra=this.root.jYb;this.L$o&&this.root.ema(this.control,!0);ba.style.zIndex=String(y.AFrameworkApplication.ta.aBa);this.root.a3k(this.wx);this.fh.Wxa=ra;ba.style.visibility="visible";ra=this.aAi();
if(Object(Pb.a)(cr.a,this.fh)){ba.style.position="fixed";const Ia=this.root.uG[0];Ia&&Ia.fh&&Ia.fh.fd?100!==ed.a.V6c(this.root.uG[0].fh.fd)&&Ro.a.ZGg(ba,ra,this.skf):Ro.a.ZGg(ba,ra,this.skf)}else Ro.a.ZGg(ba,ra,this.skf);this.rP=!0;this.fh.$6f=!0;!X.a.Yi&&this.wx.KWo&&this.fh.setFocus(b);r&&(A.Kgb=L);r=this.properties.CommandMenuOpen;ef.b(r)||this.root.executeCommand(r,null,h,b,!1)}}Yb.a.mark(10327)}Eqe(){}R_k(){this.V6e=Sg.a.iOb(this.V6e);this.V6e=window.setTimeout(this.S_k,50)}jlo(){const b=this.K_h;
var h=this.fh.fd;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;X.a.MZa&&(r-=4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get L$o(){return this.root.jYb?!1:!0}aAi(){const b=this.fh.children,h=[];if(Object(Pb.a)(Dl.a,this.fh))for(let r=0;r<b.count;r++){const A=b.K(r);Array.add(h,A.separator);
for(let L=0;L<A.children.count;L++){const ba=A.children.K(L);Array.add(h,ba.fd)}}return h}W9k(){var b=this.fh.children;for(let r=0;r<b.count;r++){const A=b.K(r).children;for(let L=0;L<A.count;L++){var h=A.K(L);if(Object(Pb.a)(Ri.a,h)){const ba=h;if("Menu32"===ba.QY||"Menu48"===ba.QY)h=h.control,h.behavior&&(Object(Pb.a)(br.a,h)||Object(Pb.a)(bh.a,h))&&h.behavior.T9k()}}}0<b.count&&(b=b.K(0),ef.c(b.separator)||(b.separator.style.display="none"),ef.c(b.xGe)||Sg.a.Gg(b.xGe,"cui-menusection-titleAtTop"))}olo(b){if(!ef.c(b)){b.style.top=
"0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=up.a.create();try{const r=this.djj.ywm(b),A=this.z6c();let L=this.root.SAe(b,r,this.wx.dne,A);L||(L=this.djj.SAe(b,r,this.wx.dne,A));this.root.ejj=L}finally{h&&h.dispose()}}}z6c(){const b=ed.a.getElementBounds(this.wx.kXb);var h=this.eM;ef.c(h)||ef.c(h.fd)||(h=ed.a.getElementBounds(h.fd),b.x=h.x+kn.Menu.cne,b.width=h.width-2*kn.Menu.cne);Object(Pb.a)(oa.a,this.wx.Kke)&&(b.height=0);return b}MBa(){if(this.wx.rP){v.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.wx.yi.Id});this.fh.zwa();this.CIj();this.rP=!1;this.fh.$6f=!1;this.root.Vga(this.control,!0);this.YYj?y.AFrameworkApplication.ta.ipd(this.wx.Yma,this.F3e):this.iPo();this.wx.Yma=null;var b=this.wx.kXb;Sg.a.Kz(b,vm.MenuLauncher.ugd);this.wx.Uhb(this.wx.lx,!1);Sg.a.Kz(b,"cui-ctl-menu-hovered-without-focus");this.fh.pxa();ef.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.Rl,0,!1);this.BIj()}}iPo(){const b=
this.wx.Yma;if(b)try{b.focus()}catch(h){}}BIj(){eb.a.yF(this.fh.fd);eb.a.yF(this.HDd);Sg.a.SGa(this.fh.fd)}Ekd(b){if(this.Iog&&Sg.a.zu(this.properties.PopulateOnlyOnce)||ef.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.wx.eLf();return 0<(this.root.Twa(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}Yog(b,h=!1){if(this.Iog&&Sg.a.zu(this.properties.PopulateOnlyOnce))return!0;let r=null;this.kxh=b;ef.c(b)||
(r=this.QNl(b));ef.c(r)||(this.Iog=!0);if(h){this.root.kyl(this.wx);if(ef.c(r)||!r.hasItems())return this.MBa(),!1;this.CIj();this.BIj()}this.Y2o(r);return!0}cqj(){}QNl(b){b=Fq.Builder.lci(b);if(!ef.c(b)){const h=new ul.a;h.A8h=!0;h.parentId=this.control.id;let r;r=Object(Pb.a)(xi.a,this.control);return this.root.HS.U8a(b,h,r)}return null}Y2o(b){ef.c(b)||(ef.c(this.fh)||this.fh.dispose(),this.fh=b,this.cqj())}CIj(){const b=this.fh.parent;b?(b.I9c=!0,b.removeChild(this.fh.id),b.I9c=!1):v.ULS.sendTraceTag(572330335,
207,10,"Parent not found for the Menu component {0}",this.fh.id)}onKeyDown(b){let h=!1;ef.c(b.Yb)||ef.c(b.Yb.rawEvent)||Object(Pb.a)(Ri.a,this.Rl)||!b.Yb.rawEvent.altKey||b.Yb.keyCode!==Sys.UI.Key.down||(this.fA(b.Ff,1,b.Yb),h=!0);h||(h=super.onKeyDown(b));return h}rA(b){this.ytf();2===b.Og&&b.sia!==Sys.UI.MouseButton.leftButton||this.fA(b.Ff,b.Og,b.Yb);b.Yb.preventDefault();return!1}OUf(b){if(!this.eM||!this.eM.inKeytipMode||!this.wx.qrj)return!1;this.wx.qrj(this.Rl,b);return!0}static lwf(){const b=
Sg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(u.a)(xb,"MenuLauncherBehavior",Zj,[541,537]);var Zb=e(1680);class sc extends xb{constructor(b){super(b)}get Kv(){return this.J1c.properties}get J1c(){return this.control}get gXa(){return this.J1c.gXa}WM(){Di.a.instance.Cb(Fd.a.Lu,this.gXa.Do,Object(E.a)(this,this.rA,"onPointerDown"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,this.gXa.Do,Object(E.a)(this,this.onKeyDown,"onKeyDown"));
lc.KeyInputManager.instance.Cb(Fd.a.zi,this.gXa.Do,Object(E.a)(this,this.WB,"onKeyUp"))}qo(){const b=this.ie[Zb.a.SelectedItemId];if(0<(this.Lw(this.Kv.Command,this.Kv.QueryCommand,this.ie)&2)){const h=this.ie[Zb.a.SelectedItemId];ef.c(h)||b===h||this.J1c.sqd(h)||(this.ie[Zb.a.SelectedItemId]=null)}}}Object(u.a)(sc,"DropDownBehavior",xb,[]);var $c=e(630),Ed=e(1463);class Ud extends sc{constructor(b){super(b);this.c5a=null;this.n4e=this.jHb=this.PIa=!1;this.kQc=null;this.iQc=-1;this.Ejg=h=>{let r=
!1;if(2!==h.Og||h.sia===Sys.UI.MouseButton.leftButton)this.fA(h.Ff,h.Og,h.Yb),this.wAe(),r=!0;r&&h.Yb.preventDefault();return!1};this.e6n=h=>{let r=!1;if(!ef.c(h.Yb)&&!ef.c(h.Yb.rawEvent)){const A=h.Yb.keyCode;h=h.Yb.rawEvent.shiftKey;Sg.a.zu(this.sL.AutoComplete);if(A===Sys.UI.Key.enter)this.HY(),this.Cyg(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),r=!0;else if(A===Sys.UI.Key.tab){if(this.HY(),this.Cyg(),Object(Pb.a)(Ed.Ribbon,this.root)&&(r=this.root.wKe(this.Rl.fd,!h)),Object(Pb.a)(214,
this.root))return!0}else A===Sys.UI.Key.backspace||A===Sys.UI.Key.del?this.control.enabled?(this.zqf(),this.kQc=null):r=!0:A===Sys.UI.Key.esc?(this.Gyg(),this.Cyg(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),r=!0):A===Sys.UI.Key.down&&(this.t5(1),this.wAe(),r=!0)}return r};this.f6n=h=>{if(!this.control.enabled)return!0;!ef.c(h.Yb)&&h.Yb.charCode&&this.EVl();return!1};this.hjg=()=>this.PIa?!1:this.PIa=!0}get s8(){return this.control}get IV(){return this.s8.IV}get sL(){return this.s8.sL}get Ehe(){return this.ie[$c.a.IsFreeForm]}set Ehe(b){this.ie[$c.a.IsFreeForm]=
b}WM(b){Di.a.instance.Cb(Fd.a.Lu,b.Do,Object(E.a)(this,this.rA,"onPointerDown"));const h=b.Xt;Fe.a.instance.Cb(Fd.a.focus,h,Object(E.a)(this,this.zyb,"onInputFocus"));Fe.a.instance.Cb(Fd.a.blur,h,Object(E.a)(this,this.XEa,"onInputBlur"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,h,this.e6n);lc.KeyInputManager.instance.Cb(Fd.a.Jw,h,this.f6n);qd.a.instance.Cb(Fd.a.yda,h,this.hjg);Di.a.instance.Cb(Fd.a.Lu,h,Object(E.a)(this,this.h6n,"onInputPointerDown"));Di.a.instance.Cb(Fd.a.Lu,b.$ni,this.Ejg)}qo(){0<
(this.Lw(this.sL.Command,this.sL.QueryCommand,this.ie)&2)&&(this.jHb||this.wek(),this.AEp())}cqj(){this.s8.menuItems=null;var b;var h=b=null;if(!ef.c(this.fh)){this.wAe();for(const A of this.fh.children)for(const L of A.children)if(Object(Pb.a)(Ri.a,L)){var r=L;r=r.control;Object(Pb.a)(519,r)&&(b=r,b=b.yi.MenuItemId);Object(Pb.a)(518,r)&&(h=r,h=h.obb());ef.c(b)||ef.c(h)||(this.s8.menuItems[h]=b,b=h=null)}}}h6n(b){Object(Pb.a)(214,this.root)&&2===b.Og&&(this.c5a=ed.a.Nsb(this.control.lx.ownerDocument),
this.control.lx.focus());return!1}rA(b){this.ytf();let h=!1;3===b.Og&&(h=super.rA(b),this.wAe());h&&b.Yb.preventDefault();return!1}L9l(){this.iQc=-1;const b=this.IV.Xt,h=b.value,r=this.pzm(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const A=b.createTextRange();A.moveStart("character",h.length);A.moveEnd("character",b.value.length);A.select()}this.kQc=r.value}else this.kQc=null}pzm(b){const h=this.s8.menuItems;for(const r in h){const A=
{key:r,value:h[r]};if(A.key.toLowerCase().startsWith(b.toLowerCase()))return A}return null}EVl(){Sg.a.zu(this.sL.AutoComplete)&&-1===this.iQc&&(this.n4e&&(this.Ekd(0),this.n4e=!1),this.iQc=window.setTimeout(Object(E.a)(this,this.L9l,"executeAutoComplete"),this.s8.uhl))}zqf(){Sg.a.zu(this.sL.AutoComplete)&&(this.iQc=Sg.a.iOb(this.iQc))}zyb(b){if(this.rP)return this.fh.setFocus(0),!0;Object(Pb.a)(214,this.root)&&(Jc.FocusManager.instance().scopeChanged("ribbon"),this.root.Z8c=!1);this.onFocus(b);this.jHb=
!0;Sg.a.Gg(this.IV.Do,"cui-cb-focus");Sg.a.zu(this.sL.PopulateDynamically)&&(this.n4e=!0);ed.a.oqd(this.IV.Xt);ef.c(this.fh)||this.fh.ro();return this.PIa=!1}XEa(){this.jHb=!1;this.HY();Sg.a.Kz(this.IV.Do,"cui-cb-focus");return!1}Cyg(){Object(Pb.a)(214,this.root)&&(void 0!==this.c5a&&null!==this.c5a&&y.AFrameworkApplication.ta.ipd(this.c5a,2),this.c5a=null)}HY(){if(this.control.enabled){this.zqf();var b=this.IV.Xt;if(void 0===this.ie[$c.a.Value]||null===this.ie[$c.a.Value]||b.value!==this.ie[$c.a.Value].toString())if(this.s8.sqd(this.kQc))this.Ehe=
!1,this.ie[$c.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.s8.xqd.nSb(),["MenuItemId"]:this.s8.xqd.yi.MenuItemId},this.root.executeCommand(this.sL.Command,b,this.Rl,0,!1);else{if(!Sg.a.zu(this.sL.AutoComplete)){var h=this.s8.menuItems[b.value];if(!ef.b(h)&&this.s8.sqd(h)){this.Ehe=!1;this.ie[$c.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.s8.xqd.nSb(),["MenuItemId"]:h};this.root.executeCommand(this.sL.Command,b,this.Rl,0,!1);return}}h=!ef.b(b.value)&&""!==D.a.LFa(b.value);
this.s8.rWh&&h?(this.Ehe=!0,this.ie[$c.a.Value]=b.value,this.root.executeCommand(this.sL.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.Rl,0,!1)):this.Gyg()}}else this.Gyg()}Gyg(){this.zqf();this.kQc=null;this.wek()}wek(){const b=this.ie[$c.a.Value]||"";b!==this.IV.Xt.value&&(this.IV.Xt.value=b);this.s8.sqd(this.s8.menuItems[b])}AEp(){const b=this.ie[$c.a.FontStyle]||"normal";b!==this.IV.Xt.style.fontStyle&&(this.IV.Xt.style.fontStyle=b)}wAe(){this.control.lx&&this.fh&&this.control.lx.setAttribute(le.a.EZh,
this.fh.id)}}Object(u.a)(Ud,"ComboBoxBehavior",sc,[]);class Vd extends xb{constructor(b){super(b)}get d0d(){return this.control}z6c(){let b=0;this.fh&&this.fh.fd&&2===this.fh.horizontalAlignment&&(b=this.fh.fd.clientWidth);return new Sys.UI.Bounds(this.d0d.x-b,this.d0d.y,this.d0d.c7f,this.d0d.b7f)}}Object(u.a)(Vd,"ContextMenuLauncherBehavior",xb,[]);class Ie extends xb{constructor(b){super(b)}get X2d(){return this.control}z6c(){return new Sys.UI.Bounds(this.X2d.x,this.X2d.y,this.X2d.c7f,this.X2d.b7f)}}
Object(u.a)(Ie,"DialogMenuLauncherBehavior",xb,[]);var Ue=e(1255);class dg extends xb{constructor(b){super(b);this.q4e=!1;this.NTk=!Sg.a.eoa(this.Kv.ShouldRefreshWhenDropped)}get mMa(){return this.control}get Kv(){return this.control.yi}WM(b){b=b.Do;ef.c(b)||(Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus")),Fe.a.instance.Cb(Fd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur")),Di.a.instance.Cb(Fd.a.WN,b,Object(E.a)(this,this.eU,"onPointerOver")),lc.KeyInputManager.instance.Cb(Fd.a.Bj,
b,Object(E.a)(this,this.onKeyDown,"onKeyDown")),lc.KeyInputManager.instance.Cb(Fd.a.zi,b,Object(E.a)(this,this.WB,"onKeyUp")),Di.a.instance.Cb(Fd.a.Lu,b,Object(E.a)(this,this.rA,"onPointerDown")))}qo(){ef.c(this.control.yi.Command)||(this.mMa.rP&&!this.NTk?this.q4e=!0:(0<(this.Lw(this.Kv.Command,this.Kv.QueryCommand,this.ie)&2)&&this.cib()&&this.q3a(),Sg.a.zu(this.Kv.RefreshableMenu)&&this.rP&&this.fh.Yjo()))}q3a(){this.xEp();this.uqa();this.jFp();this.mMa.rXf=this.ie[Ue.a.ImageIsVisible]}xEp(){const b=
Sg.a.zya(this.ie[Ue.a.LabelText],this.Kv.LabelText),h=this.ie[Ue.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.Kv.LabelTextUserGeneratedPlaceholderReplacements!==h)this.GI.eu&&this.yEp(this.GI.eu.iT,b,h),this.root.Zdb=!0,this.control.labelText=b,this.Kv.LabelTextUserGeneratedPlaceholderReplacements=h}yEp(b,h,r){const A=b.lastChild;Sg.a.dTj(b,h+" ",r);h=ef.c(A);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",
h?"":A.nodeType.toString());h||b.appendChild(A)}jFp(){const b=this.ie[Ue.a.ImageBackColor];this.GI.forEach(h=>{dg.edl(h.WV,b)})}t5(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&y.AFrameworkApplication.va.Vb(wb.a.$2d,2);"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||y.AFrameworkApplication.va.Vb(wb.a.$2d,2);Object(Pb.a)(Ri.a,this.Rl)&&(this.rP||this.Bsf(!0),this.control.enabled&&this.N2());
super.t5(b)}MBa(){super.MBa();this.q4e&&(this.q4e=!1,this.qo())}eU(b){return this.control.yWb()?(this.mMa.rP?(this.root.A4h(),Sg.a.Gg(this.mMa.kXb,vm.MenuLauncher.ugd),this.mMa.Yma=this.control.lx):(super.eU(b),this.fA(b.Ff,b.Og,b.Yb)),!1):super.eU(b)}onKeyDown(b){let h=!1;if(!ef.c(b.Yb)&&!ef.c(b.Yb.rawEvent)){if(Object(Pb.a)(Ri.a,this.Rl)){const r=b.Yb.rawEvent,A=b.Yb.keyCode,L=0===this.root.textDirection;r.shiftKey||r.ctrlKey||!(A===Sys.UI.Key.right&&L||A===Sys.UI.Key.left&&!L)||(h=this.OUf(b),
h||(this.fA(b.Ff,1,b.Yb),h=!0))}h||(h=super.onKeyDown(b))}return h}static edl(b,h){ef.c(b)||ef.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(u.a)(dg,"FlyoutAnchorBehavior",xb,[]);var Pf=e(1258);class pc extends Zj{constructor(b){super(b)}get xlc(){return this.control}get properties(){return this.xlc.properties}get xma(){return this.xlc.xma}WM(b){b=b.JQb;Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,b,Object(E.a)(this,this.onBlur,
"onBlur"));Di.a.instance.Cb(Fd.a.WN,b,Object(E.a)(this,this.eU,"onPointerOver"));Di.a.instance.Cb(Fd.a.kJ,b,Object(E.a)(this,this.RN,"onPointerOut"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.zi,b,Object(E.a)(this,this.WB,"onKeyUp"));Di.a.instance.Cb(Fd.a.Lu,b,Object(E.a)(this,this.rA,"onPointerDown"));Di.a.instance.Cb(Fd.a.zR,b,Object(E.a)(this,this.Eda,"onPointerUp"));hl.a.instance.Cb(Fd.a.GU,b,Object(E.a)(this,this.Lyb,
"onTouchMove"));hl.a.instance.Cb(Fd.a.gO,b,Object(E.a)(this,this.hPa,"onTouchEnd"))}qo(){const b=this.ie[Pf.a.On],h=this.ie[Pf.a.IsRtl];this.$dk();if(0<(this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie)&2)){var r=!ef.c(this.ie[Pf.a.InnerHTML])||!ef.c(this.properties.InnerHTML),A=!ef.c(this.properties.Image);r||A||(this.control.enabled=!1);A=this.xma.JQb;if(!ef.c(A)){if(r){r=Sg.a.zya(this.ie[Pf.a.InnerHTML],this.properties.InnerHTML);if(null===A.innerHTML||null===r||D.a.Ph(A.innerHTML)!==
D.a.Ph(r))A.innerHTML=r;""===r&&(this.control.enabled=!1)}r=A.title;const L=Sg.a.zya(this.ie[Pf.a.Alt],this.properties.Alt);L===r||this.control.FFg||(A.title=L)}A=this.ie[Pf.a.IsRtl];b===this.ie[Pf.a.On]&&h===A||this.control.wZb()}}$dk(){const b=this.ie;b[Pf.a.CommandValueId]=this.control.nSb();b.MenuItemId=this.control.yi.MenuItemId;b.SourceControlId=this.properties.Id}fA(b,h,r){if((b=this.Rl)&&this.control.enabled){const A=this.root;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelBorderMenuCompactionEnabled")&&
b.Ubd()&&this.eM){const L=A.uG[this.eM.Wxa];L?L.W1a(this.xlc):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.$dk();this.ie[Pf.a.On]||(this.ie[Pf.a.On]=!0,this.control.wZb());"Menu"===b.QY&&Sg.a.Kz(this.xma.Do,"cui-gallerybutton-focused");A.executeCommand(this.properties.Command,this.ie,b,h,!0,null,this.bR(r))}}onFocus(b){super.onFocus(b);Sg.a.Gg(this.xma.Do,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);
Sg.a.Kz(this.xma.Do,"cui-gallerybutton-focused");return!1}}Object(u.a)(pc,"GalleryButtonBehavior",Zj,[]);var yi=e(1683),Ei=e(1272),ok=e(1470);class ji extends Zj{constructor(b){super(b);this.s6a=-1}get opc(){return this.control}get properties(){return this.opc.yi}get SYc(){return this.opc.SYc}get IWf(){var b=null;if(this.Rl&&(b=this.Rl.parent,!Object(Pb.a)(ok.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get TUb(){return this.opc.Dfe.TUb}get Bjd(){return this.opc.Dfe.Bjd}fA(b,
h,r){if(this.control.enabled){b=this.PNf(this.Plc(b));const A=this.H8d(b);this.SYc[Ei.a.Rows]=this.fbe(b)+1;this.SYc[Ei.a.Columns]=A+1;this.root.executeCommand(this.properties.Command,this.SYc,this.Rl,h,!0,null,this.bR(r))}}WM(b){var h=b.Do;const r=b.o5h;b=b.cells;Di.a.instance.Cb(Fd.a.kJ,h,Object(E.a)(this,this.A3n,"onControlPointerOut"));hl.a.instance.Cb(Fd.a.GU,h,Object(E.a)(this,this.C3n,"onControlTouchMove"));hl.a.instance.Cb(Fd.a.gO,h,Object(E.a)(this,this.B3n,"onControlTouchEnd"));for(h=0;h<
b.length;++h)this.Rgl(r[h],b[h])}Rgl(b,h){Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.Phg,"onCellFocus"));Di.a.instance.Cb(Fd.a.WN,h,Object(E.a)(this,this.Qhg,"onCellPointerOver"));Di.a.instance.Cb(Fd.a.zR,h,Object(E.a)(this,this.Rhg,"onCellPointerUp"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.zi,h,Object(E.a)(this,this.WB,"onKeyUp"));hl.a.instance.Cb(Fd.a.HU,h,Object(E.a)(this,this.F2n,"onCellTouchStart"))}PNf(b){return parseInt(b.id.substr(this.opc.id.length+
1))}tRi(b){this.sRi(this.PNf(b))}fbe(b){return Math.floor(b/yi.a.vhd)}H8d(b){return b%yi.a.vhd}sRi(b){if(b!==this.s6a){var h=this.H8d(b),r=this.fbe(b),A=-1;let L=-1;-1!==this.s6a&&(A=this.fbe(this.s6a),L=this.H8d(this.s6a));for(;A!==r||L!==h;)A<r?this.lVj(++A,L,!0):A>r?(this.lVj(A,L,!1),A--):L<h?this.PSj(++L,A,!0):L>h&&(this.PSj(L,A,!1),L--);this.IWf?this.IWf.YVj(this.Jzi(r+1,h+1)):(r=(h=this.control.Jtf)&&0<h.length?h[0]:null,A=this.Rl,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!A,["DispCompPar"]:!!A&&!!A.parent}));this.s6a=b}}lVj(b,h,r){for(let A=0;A<=h;A++)this.GSj(b,A,r)}PSj(b,h,r){for(let A=0;A<=h;A++)this.GSj(A,b,r)}GSj(b,h,r){h=b*yi.a.vhd+h;b=this.TUb[h];h=this.Bjd[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}Rhg(b){this.fA(b.Ff,b.Og,b.Yb);return!0}Plc(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return ef.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}ZVj(b){const h=this.PNf(b);b.childNodes[0].childNodes[0].title=this.Jzi(this.fbe(h)+1,this.H8d(h)+1)}Jzi(b,h){let r=this.properties.Alt;ef.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}qyc(){if(this.Rl){for(var b=0;b<yi.a.Muc;b++)this.TUb[b].className="cui-it-inactiveCell",this.Bjd[b].className="cui-it-inactiveCellOuter";this.s6a=-1;b=this.properties.MenuSectionInitialTitle;
ef.c(b)&&(b="");this.IWf.YVj(b)}}Qhg(b){this.control.enabled&&(b=this.Plc(b.Ff),this.brd(b),this.oBf(b));return!1}oBf(b){this.ZVj(b);this.tRi(b)}Phg(b){if(!this.control.enabled)return!1;b=this.Plc(b.Ff);this.ZVj(b);this.tRi(b);return!1}A3n(b){ed.a.w3f(this.opc.Dfe.Do,b.clientPoint)||this.qyc();return!1}F2n(b){if(!this.control.enabled)return!1;b=this.Plc(b.Ff);this.oBf(b);return!0}C3n(b){if(!this.control.enabled)return!1;b=ed.a.w9d(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Plc(b))?this.oBf(b):this.qyc();return!0}B3n(b){if(!this.control.enabled)return!1;var h=ed.a.w9d(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.qyc(),!0;(h=this.Plc(h))?this.fA(h,3,b.Yb):this.qyc();return!0}YO(b){b=Jo.a.FHf(this.s6a,yi.a.vhd,yi.a.Muc,b);if(b!==this.s6a)return this.TUb[b].firstChild.focus(),this.sRi(b),!0;this.qyc();this.s6a=-1;return!1}N2(){const b=this.TUb[0];if(ef.c(b))return!1;b.firstChild.focus();return!0}brd(b){if(ef.c(b))return!1;b.firstChild.firstChild.focus();
return!0}zwa(){this.qyc()}}Object(u.a)(ji,"InsertTableBehavior",Zj,[]);class hk extends xb{constructor(b){super(b)}qo(){this.control.enabled=!!this.fh}fA(b,h,r){y.AFrameworkApplication.va.Zb(wb.a.v_a,2,h,this.bR(r))}}Object(u.a)(hk,"JewelMenuLauncherBehavior",xb,[]);var Sl=e(1264);class Ko extends Zj{constructor(b){super(b)}get properties(){return this.control.yi}qo(){0<(this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie)&2)&&this.cib()&&this.q3a()}q3a(){this.yIp();this.uqa();this.b5b()}yIp(){const b=
this.control.labelText;let h=this.ie[Sl.a.Value];ef.c(h)&&(h=this.properties.LabelText,ef.c(h)&&(h=""));h!==b&&this.jBe(h)}WM(b){b=b.Do;ef.c(b)||(Di.a.instance.Cb(Fd.a.Lu,b,Object(E.a)(this,this.rA,"onPointerDown")),Di.a.instance.Cb(Fd.a.WN,b,Object(E.a)(this,this.eU,"onPointerOver")),Di.a.instance.Cb(Fd.a.kJ,b,Object(E.a)(this,this.RN,"onPointerOut")))}}Object(u.a)(Ko,"LabelBehavior",Zj,[]);var cm=e(1522),Lo=e(1404),nm=e(1678);class pq extends xb{constructor(b){super(b);this.IYe=this.zQe=!1;this.e$b=
this.v6b=null;if(this.J$b=y.AFrameworkApplication.J.$("TellMeRedesignIsEnabled"))this.v6b=this.Nw.zpa.LightImage16by16Class,this.e$b=this.Nw.zpa.DarkImage16by16Class}get Nw(){return this.control}Ioe(b,h,r,A){h&&(this.Nw.Yma=r,y.AFrameworkApplication.ta.IAb());if(Object(Pb.a)(Lo.a,b)&&A){r=new cm.a;r.CommandLocation=this.root.cea;r.InvocationMethod=0;const L={};(b=b.control)&&b.yi&&(L.CommandId=b.yi.Command,L.ControlId=b.yi.Id,L.CloseAllMenus=h,b.eM&&b.eM.parent&&b.eM.parent.id&&(L.ParentControlId=
b.eM.parent.id.split("-")[0]),this.root.nJ&&this.root.nJ.wXa(A,L,r))}}MBa(){this.Nw.Yma||(this.Nw.Yma=this.Nw.MB);!this.Nw.DVn&&this.J$b&&(Sg.a.Kz(this.Nw.MB,"cui-sb-focus"),Sg.a.Kz(this.Nw.z6,"cui-sb-focus"),Sg.a.Kz(this.Nw.dGa,this.v6b),Sg.a.Gg(this.Nw.dGa,this.e$b));this.zQe=!0;super.MBa();this.zQe=!1;this.atg()}get YYj(){return!this.Nw.Y0a}Eqe(){this.Nw.Eqe()}Bwe(){this.IYe||this.zQe||(this.IYe=!0,this.Nw.raiseEvent(nm.a.icb,null))}atg(){this.rP||this.Nw.TYf||(this.IYe=!1,this.Nw.raiseEvent(nm.a.nVb,
null))}fjg(b){Sg.a.Kz(this.Nw.MB,"cui-sb-focus");Sg.a.Kz(this.Nw.z6,"cui-sb-focus");this.J$b&&!this.Nw.rP&&(Sg.a.Kz(this.Nw.dGa,this.v6b),Sg.a.Gg(this.Nw.dGa,this.e$b));this.Nw.raiseEvent(nm.a.blur,b);this.atg();this.Nw.Yma=this.Nw.MB;return!1}gjg(b){Sg.a.Gg(this.Nw.MB,"cui-sb-focus");Sg.a.Gg(this.Nw.z6,"cui-sb-focus");this.J$b&&(Sg.a.Kz(this.Nw.dGa,this.e$b),Sg.a.Gg(this.Nw.dGa,this.v6b));this.Nw.raiseEvent(nm.a.focus,b);this.Bwe();return!1}Fkg(){this.J$b&&(Sg.a.Gg(this.Nw.z6,"cui-sb-hover"),Sg.a.Gg(this.Nw.MB,
"cui-sb-hover"),Sg.a.Kz(this.Nw.dGa,this.e$b),Sg.a.Gg(this.Nw.dGa,this.v6b));return!1}Ekg(){this.J$b&&(Sg.a.Kz(this.Nw.z6,"cui-sb-hover"),Sg.a.Kz(this.Nw.MB,"cui-sb-hover"),this.Nw.rP||this.Nw.TYf||(Sg.a.Kz(this.Nw.dGa,this.v6b),Sg.a.Gg(this.Nw.dGa,this.e$b)));return!1}}Object(u.a)(pq,"SearchBoxBehavior",xb,[539,537]);class vl{}vl.Value="value";vl.MinValue="MinValue";vl.MaxValue="MaxValue";vl.Text="Text";Object(u.a)(vl,"SliderCommandProperties",null,[]);class Gk extends Zj{constructor(b){super(b);
this.pR=()=>{this.pDl(this.C$.Xt.value);return!0}}get OHg(){return this.control}get C$(){return this.OHg.C$}get properties(){return this.control.yi}initialize(){}fA(){}WM(b){b=b.Xt;Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));Fe.a.instance.Cb(Fd.a.UXc,b,this.pR);Fe.a.instance.Cb(Fd.a.input,b,this.pR)}onFocus(b){this.C$.Do&&Sys.UI.DomElement.addCssClass(this.C$.Do,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.C$.Do&&
Sys.UI.DomElement.removeCssClass(this.C$.Do,"cui-sldr-onfocus");return super.onBlur(b)}pDl(b){this.ie[vl.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.ie,this.Rl,0,!1)}qo(){const b=this.ie[vl.Value],h=this.ie[vl.MaxValue],r=this.ie[vl.Text];var A=this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie);this.C$&&this.C$.Xt&&(this.C$.Xt.disabled=!this.control.enabled);if(0<(A&2)){A=this.ie[vl.Value];const L=this.ie[vl.MaxValue],ba=this.ie[vl.Text];(L!==h||A!==
b||r!==ba)&&this.C$&&this.C$.Xt&&(this.C$.Xt.setAttribute(le.a.qWd,String.format("{0}",L)),this.C$.Xt.setAttribute("max",String.format("{0}",L)),this.C$.Xt.value=A,this.C$.iT.innerText=this.ie[vl.Text])}}}Object(u.a)(Gk,"SliderBehavior",Zj,[]);var vi=e(1262);class so extends Zj{constructor(b){super(b);this.fLd=0;this.Tnb=null;this.CId=!1;this.xPh=null;this.xbf=!1;this.cOd=this.CMd=-1;this.PIa=!1;this.qK=()=>!this.control.enabled;this.pR=()=>{this.HY();return!1};this.hjg=()=>this.PIa?!1:this.PIa=!0;
this.Hoj=h=>{var r=!1;let A=!0;2===h.Og&&(A=h.sia===Sys.UI.MouseButton.leftButton);A&&(r=h.Ff,this.E2j(r===this.CK.Xjc||r===this.CK.koi||r===this.CK.joi,h.Og),r=!0);return r};this.Ioj=h=>this.sCa(h);this.hLo=()=>{this.B4h();-1===this.cOd&&(this.bEe(),this.cOd=window.setInterval(Object(E.a)(this,this.bEe,"spin"),50))}}get r3b(){return this.control}get CK(){return this.r3b.CK}get properties(){return this.control.yi}initialize(){const b=this.r3b.kRg;this.xPh=this.rAp(b);this.fLd=b[0].min;this.Tnb=b[0];
this.CId=!1}fA(){}WM(b){const h=b.Xt,r=b.Xjc;b=b.U1c;Fe.a.instance.Cb(Fd.a.focus,h,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.Jw,h,this.qK);lc.KeyInputManager.instance.Cb(Fd.a.zi,h,Object(E.a)(this,this.WB,"onKeyUp"));Fe.a.instance.Cb(Fd.a.UXc,h,this.pR);qd.a.instance.Cb(Fd.a.yda,h,this.hjg);Di.a.instance.Cb(Fd.a.Lu,
r,this.Hoj);Di.a.instance.Cb(Fd.a.Lu,b,this.Hoj);Di.a.instance.Cb(Fd.a.zR,r,this.Ioj);Di.a.instance.Cb(Fd.a.zR,b,this.Ioj);hl.a.instance.Cb(Fd.a.GU,r,Object(E.a)(this,this.Koj,"onArrowTouchMove"));hl.a.instance.Cb(Fd.a.GU,b,Object(E.a)(this,this.Koj,"onArrowTouchMove"));hl.a.instance.Cb(Fd.a.gO,r,Object(E.a)(this,this.Joj,"onArrowTouchEnd"));hl.a.instance.Cb(Fd.a.gO,b,Object(E.a)(this,this.Joj,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Sg.a.Gg(this.CK.Do,"cui-spn-focus");this.control.enabled&&
ed.a.oqd(this.CK.Xt);return this.PIa=!1}onBlur(b){super.onBlur(b);Sg.a.Kz(this.CK.Do,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!ef.c(b.Yb)&&!ef.c(b.Yb.rawEvent)){const r=b.Yb.keyCode,A=b.Yb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.D0f(this.control)||this.E2j(r===Sys.UI.Key.up,b.Og),h=!0;else if(r===Sys.UI.Key.enter)this.HY(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),h=!0;else if(r===Sys.UI.Key.tab)this.HY(),Object(Pb.a)(Ed.Ribbon,this.root)&&(h=this.root.wKe(this.Rl.fd,
!A));else if(r===Sys.UI.Key.esc)this.tyc(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}WB(){this.RTl();return!1}Koj(b){return this.ipe(b)}Joj(b){return this.sCa(b)}Uan(b){if(this.control.enabled){var h=!1;if(!this.CId){var r=this.TCm(b);r=b?r+this.Tnb.step:r-this.Tnb.step;r=Math.min(r,this.Tnb.max);r=Math.max(r,this.Tnb.min);r!==this.fLd&&(this.xtf(r,this.Tnb),this.root.executeCommand(this.properties.Command,
this.ie,this.Rl,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.ie,r.Increment=b,ef.c(h)||this.root.executeCommand(h,r,this.Rl,0,!1))}}TCm(b){const h=Math.pow(10,y.AFrameworkApplication.numberFormat.Roe),r=Math.round(this.Tnb.step*h);let A=Math.round(this.fLd*h)/r;A=b?Math.floor(A):Math.ceil(A);return A*r/h}E2j(b,h){if(this.control.enabled){this.HY();const r=b?this.CK.Xjc:this.CK.U1c;switch(h){case 2:case 3:this.xbf=b;this.UTd(r);break;case 1:this.xbf=b,this.q_k(r)}}}j3j(){this.B4h();this.Dsl()}Sii(){-1===
this.CMd&&(this.CMd=window.setTimeout(this.hLo,500))}B4h(){this.CMd=Sg.a.iOb(this.CMd)}Dsl(){this.cOd=Sg.a.zsl(this.cOd)}bEe(){this.Uan(this.xbf)}q_k(b){this.root.ema(this.control,!1);Sg.a.Gg(b,tn.a.XTd);this.bEe();this.Sii()}RTl(){this.root.Vga(this.control,!1);this.j3j();Sg.a.Kz(this.CK.Xjc,tn.a.XTd);Sg.a.Kz(this.CK.U1c,tn.a.XTd)}Pzc(b){this.CK.Xt.value!==b&&(this.CK.Xt.value=b)}tyc(){this.Pzc(this.ie[vi.a.Text])}gTj(b){this.Pzc(b);this.ie[vi.a.Text]=b;this.CId=!0}s_o(b,h,r){this.Pzc(r);this.ie[vi.a.Text]=
r;this.ie[vi.a.Number]=b;this.ie[vi.a.UnitType]=h.type;this.fLd=b;this.Tnb=h;this.CK.Xt.setAttribute(le.a.Bmf,r);this.CK.Xt.setAttribute(le.a.LZh,String.format("{0}",h.min));this.CK.Xt.setAttribute(le.a.qWd,String.format("{0}",h.max));this.CId=!1}o$h(b){var h;if(({qZn:h}=this.xzn(b)).returnValue)this.gTj(h);else{({number:b,Qhb:h}=D.a.Bxj(b,this.xPh,y.AFrameworkApplication.numberFormat));let r=this.ZHe(h);0===h&&ef.c(r)&&(r=this.ZHe(this.ie[vi.a.UnitType]));this.xtf(b,r)}}xtf(b,h){b=this.Yfg(b,h);
if(isNaN(b)||ef.c(h))this.tyc();else{const r=y.AFrameworkApplication.numberFormat;let A;A=D.a.tMa(b,h.type,r);A=A.replace(6===h.type?r.Soe:r.Yng,"");this.s_o(b,h,A)}}xzn(b){let h,r=!1;h="";b=b.trim();const A=this.r3b.Jfk;if(!ef.c(A))for(let L=0;L<A.length;L++)if(A[L].toLowerCase()===b.toLowerCase()){h=A[L];r=!0;break}return{returnValue:r,qZn:h}}Yfg(b,h){return isNaN(b)||ef.c(h)?Number.NaN:h.Yfg(b)}ZHe(b){let h=null;const r=this.r3b.kRg;for(let A=0;A<r.length;A++)if(r[A].type===b){h=r[A];break}return h}rAp(b){const h=
b.length,r=Array(h);for(let A=0;A<h;A++)r[A]=b[A].type;return r}HY(){if(this.control.enabled){const b=this.ie[vi.a.Text],h=this.CK.Xt.value;h!==b&&(this.o$h(h),this.ie[vi.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.ie,this.Rl,0,!1))}else this.tyc()}qo(){var b=this.ie[vi.a.Text],h=this.ie[vi.a.Number];const r=this.ie[vi.a.UnitType],A=this.ie[vi.a.MaxValue];if(0<(this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie)&2)){const L=this.ie[vi.a.Text],ba=this.ie[vi.a.Number],
ra=this.ie[vi.a.UnitType],Ia=this.ie[vi.a.MaxValue];Ia!==A&&(this.ZHe(ra).max=Ia,this.CK.Xt.setAttribute(le.a.qWd,String.format("{0}",Ia)));L!==b?""===L?this.gTj(L):this.o$h(L):isNaN(ba)||ba===h&&ra===r||this.xtf(ba,this.ZHe(ra));b=this.CK.Do.title;h=Sg.a.zya(this.ie[vi.a.Alt],this.properties.Alt);h!==b&&(this.CK.Xt.title=h,this.CK.Xjc.title=h,this.CK.U1c.title=h)}}ihf(b){super.ihf(b);b?(this.bEe(),this.Sii()):this.j3j()}}Object(u.a)(so,"SpinnerBehavior",Zj,[538,537]);var Zp=e(427),El=e(1187);class Lm extends xb{constructor(b){super(b);
this.Iac=!0;this.AEb=!1}get F$(){return this.control}get Kv(){return this.F$.properties}WM(b){const h=b.Do,r=b.Erb;b=b.W1c;Fe.a.instance.Cb(Fd.a.focus,h,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.zi,h,Object(E.a)(this,this.WB,"onKeyUp"));X.a.Fv&&16>this.mxm()&&(Di.a.instance.Cb(Fd.a.Lu,h,Object(E.a)(this,this.cuj,
"onSplitbuttonPointerDownPointerUp")),Di.a.instance.Cb(Fd.a.zR,h,Object(E.a)(this,this.cuj,"onSplitbuttonPointerDownPointerUp")));Di.a.instance.Cb(Fd.a.WN,r,Object(E.a)(this,this.p2n,"onButtonPointerOver"));Di.a.instance.Cb(Fd.a.kJ,r,Object(E.a)(this,this.o2n,"onButtonPointerOut"));Di.a.instance.Cb(Fd.a.Lu,r,Object(E.a)(this,this.Zoj,"onButtonPointerDown"));Di.a.instance.Cb(Fd.a.zR,r,Object(E.a)(this,this.$oj,"onButtonPointerUp"));hl.a.instance.Cb(Fd.a.GU,r,Object(E.a)(this,this.r2n,"onButtonTouchMove"));
hl.a.instance.Cb(Fd.a.gO,r,Object(E.a)(this,this.q2n,"onButtonTouchEnd"));Di.a.instance.Cb(Fd.a.Lu,b,Object(E.a)(this,this.Ejg,"onMenuButtonPointerDown"));Di.a.instance.Cb(Fd.a.WN,b,Object(E.a)(this,this.b7n,"onMenuButtonPointerOver"));Di.a.instance.Cb(Fd.a.kJ,b,Object(E.a)(this,this.a7n,"onMenuButtonPointerOut"))}fA(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.AEb&&(this.F$.on=!this.F$.on,b=this.ie,b.CommandValueId=this.control.nSb(),this.root.executeCommand(this.Kv.Command,b,this.Rl,
h,!0,null,this.bR(r))):this.Iac&&super.fA(b,h,r)}WB(b){const h=b.Yb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.ie,b.CommandValueId=this.control.nSb(),this.root.executeCommand(this.Kv.Command,b,this.Rl,1,!0),!0):super.WB(b)}qo(){const b=this.root.Twa(this.Kv.Command,this.Kv.QueryCommand,this.ie),h=0<(b&1);let r=!0;r=ef.c(this.Kv.CommandMenuOpen)?h:0<(this.root.Twa(this.Kv.CommandMenuOpen,null,null)&1);if(r!==this.Iac||h!==this.AEb||(r||h)!==this.control.enabled)this.control.enabled=
r||h,h!==this.AEb&&this.x4n(h),r!==this.Iac&&this.y4n(r),this.Iac=r,this.AEb=h;if(0<(b&2)){this.uqa();const A=Sg.a.zya(this.ie[El.a.LabelText],this.Kv.LabelText);this.ie[El.a.ApplyLabelTextToControlOnly]?this.F$.ilc(L=>{L.Do.title=A;L.Erb.removeAttribute("title");L.W1c.removeAttribute("title")}):this.F$.ilc(L=>{L.Erb.title=A});this.ie[El.a.EnsureControlRoleIsButton]&&this.F$.ilc(L=>{le.a.ju(L.Do,le.a.fi,le.a.i4)});ef.c(this.ie[El.a.Visible])||this.cib()&&this.q3a()}this.F$.setState(this.F$.on&&h)}q3a(){this.KPg();
this.b5b();this.uqa()}y4n(b){this.F$.ilc(h=>{Sg.a.HAb(h.W1c,b)});this.Wnd();this.Iac=b}x4n(b){this.F$.ilc(h=>{Sg.a.HAb(h.Erb,b)});this.Wnd();this.AEb=b}Wnd(){const b=this.F$.ltb();ef.c(b)||(Sg.a.Kz(b.childNodes[0],"cui-ctl-split-hovered-primary"),Sg.a.Kz(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Sg.a.Kz(b.childNodes[1],"cui-ctl-split-hovered-primary"),Sg.a.Kz(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}cuj(b){if(0!==Zp.a(b.Yb))return!1;let h=!1;b.eventName===Fd.a.Lu?h=this.Zoj(b):
b.eventName===Fd.a.zR&&(h=this.$oj(b));return h}Zoj(b){let h=!1;const r=b.Og;switch(r){case 3:this.Mcp()?this.fA(this.Rl.fd,r,b.Yb):this.UTd(this.F$.Lli);h=!0;break;case 2:b.sia===Sys.UI.MouseButton.leftButton&&(this.UTd(this.F$.Lli),h=!0)}h&&b.Yb.preventDefault();return!1}Mcp(){const b=this.Rl.QY;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}$oj(b){return this.sCa(b)}r2n(b){return this.ipe(b)}q2n(b){return this.sCa(b)}onFocus(b){super.onFocus(b);this.sWf(!0,!0);return!1}onBlur(b){super.onFocus(b);
this.Wnd();return!1}p2n(){this.control.enabled&&this.AEb&&this.sWf(!0,this.F$.on);return!1}o2n(){this.control.enabled&&this.AEb&&this.Wnd();return!1}Ejg(b){let h=!1;if(2!==b.Og||b.sia===Sys.UI.MouseButton.leftButton)this.fA(b.Ff,b.Og,b.Yb),h=!0;h&&b.Yb.preventDefault();return!1}b7n(){this.control.enabled&&this.Iac&&this.sWf(this.F$.on,!0);return!1}a7n(){this.Wnd();return!1}sWf(b,h){const r=this.control.ltb();ef.c(r)||(Sg.a.Gg(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),
Sg.a.Gg(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}mxm(){var b=X.a.Ljc;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(u.a)(Lm,"SplitButtonBehavior",xb,[]);var Nk=e(1271);class wl extends Zj{constructor(b){super(b);this.jHb=this.PIa=!1;this.QAk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelTableRenameEnabled");this.qK=()=>!this.control.enabled;this.pR=()=>{this.HY();return!1};this.$Ea=()=>this.Rja.isEditable?this.PIa?!1:
this.PIa=!0:(ed.a.oqd(this.Rja.Xt),!0)}get Iud(){return this.control}get Rja(){return this.Iud.Rja}get lLg(){return this.Iud.yi}WM(b){b=b.Xt;Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.Jw,b,this.qK);lc.KeyInputManager.instance.Cb(Fd.a.zi,b,Object(E.a)(this,this.WB,"onKeyUp"));Fe.a.instance.Cb(Fd.a.UXc,
b,this.pR);qd.a.instance.Cb(Fd.a.yda,b,this.$Ea)}onFocus(b){super.onFocus(b);this.jHb=!0;Sg.a.Gg(this.Rja.Do,"cui-tb-focus");this.control.enabled&&ed.a.oqd(this.Rja.Xt);return this.PIa=!1}onBlur(b){this.jHb=!1;super.onBlur(b);Sg.a.Kz(this.Rja.Do,"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!ef.c(b.Yb)&&!ef.c(b.Yb.rawEvent)){const r=b.Yb.keyCode,A=b.Yb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.HY(),Object(Pb.a)(Ed.Ribbon,this.root)&&(h=this.root.wKe(this.Rl.fd,!A))):r===Sys.UI.Key.enter?
this.QAk&&(this.HY(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),h=!0):r===Sys.UI.Key.esc?(this.tyc(),Object(Pb.a)(Ed.Ribbon,this.root)&&this.root.z4(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.NBa&&(Re.a.y4h(b.Yb),h=!1)}return h}WB(){return!1}Pzc(b){this.Rja.Xt.value!==b&&(this.Rja.Xt.value=b)}tyc(){this.Pzc(this.ie[Nk.a.Text])}HY(){if(this.control.enabled&&this.Rja.isEditable){const b=this.Rja.Xt.value;b!==this.ie[Nk.a.Text]&&(this.ie[Nk.a.Text]=b,this.root.executeCommand(this.lLg.Command,
this.ie,this.Rl,0,!1))}else this.tyc()}qo(){const b=this.ie[Nk.a.Text];if(0<(this.Lw(this.lLg.Command,this.lLg.QueryCommand,this.ie)&2)&&!this.jHb){const h=this.ie[Nk.a.Text];h!==b&&this.Pzc(h)}}}Object(u.a)(wl,"TextBoxBehavior",Zj,[536,537]);var ln=e(1443);class wr extends Zj{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.yi}fA(b,h,r){this.control.enabled&&(Sg.a.eoa(this.properties.TogglesWhenExecuted)||this.toggle(),this.ie.CommandValueId=this.toggleButton.nSb(),
this.ie.MenuItemId=this.toggleButton.yi.MenuItemId,this.ie.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.ie,this.Rl,h,!Sg.a.eoa(this.properties.CloseMenuWhenExecuted),A=>{Sg.a.zu(this.properties.UpdateHtmlPostToggle)&&(32===A?this.f7j():this.d7j())},this.bR(r)))}d7j(){this.ie[bg.a.On]=!this.ie[bg.a.On]}f7j(){this.toggleButton.setState(this.ie[bg.a.On]);(this.toggleButton.$Ga&&this.toggleButton.iJe||Sg.a.zu(this.properties.UpdateHtmlPostToggle))&&this.q3a()}toggle(){this.d7j();
Sg.a.zu(this.properties.UpdateHtmlPostToggle)||this.f7j()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!ef.c(b.Yb)&&this.eM){const r=b.Yb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Yb.preventDefault()}return h}qo(){ef.c(this.properties.MenuItemId)||(this.ie.MenuItemId=this.properties.MenuItemId);0<(this.Lw(this.properties.Command,this.properties.QueryCommand,this.ie)&2)&&this.cib()&&this.q3a()}q3a(){this.toggleButton.setState(this.ie[bg.a.On]);this.WDp(Sg.a.zya(this.ie[bg.a.DisplayMode],
""));this.KPg();this.uqa();this.FFp();bg.a.Alt in this.ie&&this.b5b()}FFp(){const b=this.GI.Fsc;if(b&&b.Frb){var h=Sg.a.zya(this.ie[bg.a.Description],this.properties.Description);h!==b.Frb.innerText&&(b.Frb.innerText=h,b.iT&&!Object(Pb.a)(ln.Jewel,this.root)&&(h=!ef.b(h),Sg.a.O$(b.iT,"UIFontBold",h),Sg.a.O$(b.iT,"cui-ctl-mediumlabel-nodescription",!h)))}}WM(b){b=b.Do;Fe.a.instance.Cb(Fd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));Fe.a.instance.Cb(Fd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));
Di.a.instance.Cb(Fd.a.WN,b,Object(E.a)(this,this.eU,"onPointerOver"));Di.a.instance.Cb(Fd.a.kJ,b,Object(E.a)(this,this.RN,"onPointerOut"));lc.KeyInputManager.instance.Cb(Fd.a.Bj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));lc.KeyInputManager.instance.Cb(Fd.a.zi,b,Object(E.a)(this,this.WB,"onKeyUp"));Di.a.instance.Cb(Fd.a.Lu,b,Object(E.a)(this,this.rA,"onPointerDown"));Di.a.instance.Cb(Fd.a.zR,b,Object(E.a)(this,this.Eda,"onPointerUp"));Wf.a.instance.Cb(Fd.a.click,b,Object(E.a)(this,this.onClick,
"onClick"));hl.a.instance.Cb(Fd.a.GU,b,Object(E.a)(this,this.Lyb,"onTouchMove"));hl.a.instance.Cb(Fd.a.gO,b,Object(E.a)(this,this.hPa,"onTouchEnd"))}}Object(u.a)(wr,"ToggleButtonBehavior",Zj,[]);class un{constructor(b){this.exk=b;this.fVe={["Button"]:h=>new Ao(h),["FileMenuButton"]:h=>new Ao(h),["ColorPicker"]:h=>new eo(h),["ComboBox"]:h=>new Ud(h),["ContextMenuControl"]:h=>new Vd(h),["ContextMenuLauncher"]:h=>new Vd(h),["DialogMenuLauncher"]:h=>new Ie(h),["DropDown"]:h=>new sc(h),["FlyoutAnchor"]:h=>
new dg(h),["GalleryButton"]:h=>new pc(h),["StatefulColorFlyoutAnchor"]:h=>new dg(h),["JewelMenuLauncher"]:h=>new hk(h),["Label"]:h=>new Ko(h),["Placeholder"]:h=>new Zj(h),["SearchBox"]:h=>new pq(h),["Separator"]:h=>new Zj(h),["SplitButton"]:h=>new Lm(h),["StatefulColorSplitButton"]:h=>new Lm(h),["StatefulImageSplitButton"]:h=>new Lm(h),["TextBox"]:h=>new wl(h),["ToggleButton"]:h=>new wr(h)}}Goi(){this.fVe[tn.a.iYi]=b=>new ji(b)}lDf(){this.fVe[tn.a.B1j]=b=>new so(b)}gpm(b){const h=this.fVe[b.controlType];
(b=h?h(b):null)&&this.exk&&b.i6l();return b}static get instance(){return un._instance||(un._instance=new un(!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CUICommitChangeFixIsEnabled")))}}un._instance=null;Object(u.a)(un,"ControlBehaviorFactory",null,[521]);var Rr=e(1573),dr=e(1393);class qq extends vm.MenuLauncher{constructor(b,h,r,A){super(b,h,r,A);this.pyh=null;this.wVa=this.GUc=0;this.nJ=null;this.zNc=this.yNc=0;this.Sh("Menu");this.enabled=!0}get x(){return this.GUc}get y(){return this.wVa}get b7f(){return this.yNc}get c7f(){return this.zNc}get controlType(){return"DialogMenuLauncher"}tgb(){}Uhb(){}eLf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Kv.DialogMoveCommand;b.DialogCloseCommand=this.Kv.DialogCloseCommand;return b}jFn(b,h){this.GUc=b.x;this.wVa=b.y;this.yNc=b.height;this.zNc=b.width;this.t5(h)}NV(b){this.pyh=Sg.a.createElement("span");return new dr.a(b,this.pyh)}get Kv(){return this.yi}VBa(b,h,r){return new qq(b,this.id,h,r)}}Object(u.a)(qq,"DialogMenuLauncher",vm.MenuLauncher,[]);var Yh=e(1574);class ek extends Rr.a{constructor(b,h){super(b,h);this.Nib=null}get khf(){return this.Nib}get uki(){return this.properties}get cea(){return 20}ro(){super.ro();
ef.c(this.fd)&&this.kG();this.fd=Sg.a.w1a(this.fd);this.N0(this.fd);this.dirty=!1}kT(b){if(!Object(Pb.a)(Yh.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}$vf(b,h,r,A){r=new kn.Menu(this,h,r,A,null);b||(b={});b.CommandMenuOpen=this.uki.CommandMenuOpen;b.CommandMenuClose=this.uki.CommandMenuClose;b=new qq(this,h,b,r);this.ric[h]=b;h=new Yh.a(this,"dock"+h);h.pg(b.KY("Menu"));this.pg(h);this.refresh()}GGg(b,h,r,A){const L=this.ric[b];if(ef.c(L))throw Error.create('The dialog menu "'+
b+'" does not exist');L.jFn(new Sys.UI.Bounds(h,r,0,0),A);this.Nib=L.fh}Csf(b){b=this.ric[b];ef.c(b)||(b.MBa(),this.Nib=null)}Fqe(){this.Nib=null}dispose(){const b=this.ric;for(const h in b)b[h].dispose();super.dispose()}}Object(u.a)(ek,"DialogMenuRoot",Rr.a,[]);class Ok{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(u.a)(Ok,"RootProperties",null,[]);class Fi extends Ok{constructor(){super()}}Object(u.a)(Fi,"StandaloneRootProperties",Ok,[]);class ls extends Fi{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(u.a)(ls,"DialogMenuRootProperties",Fi,[]);class Wm{constructor(){this.Rog=(h,r,A,L,ba)=>{if(1===A)return 32;h=new Sys.StringBuilder;h.append('<Menu Id="dialogMenu">');h.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');h.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',ba.DialogMoveCommand,CommonUIStrings.l_DialogMove));h.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',ba.DialogCloseCommand,
CommonUIStrings.l_DialogClose));h.append("</Controls></MenuSection>");h.append("</Menu>");ba.PopulationXML=h.toString();return 32};const b=new ls;b.ImageSideArrow=y.AFrameworkApplication.mr;b.ImageSideArrowClass=Ye.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.Od=new ek("DialogMenuRootId",b);this.Od.nJ=this;this.Od.refresh();y.AFrameworkApplication.va.nb(wb.a.Rog,dd.a.frame,this.Rog,96)}get K$(){return this.Od}wXa(b,h,r,A,L=null){b=parseInt(b);
A=y.AFrameworkApplication.va;r&&(A.JD=r.CommandLocation,A.f5=r.InvocationMethod);h=A.Zb(b,2,h,L);this.Od.refresh();return 32===h}$Na(b){return b?32===y.AFrameworkApplication.va.Vb(parseInt(b),1):!0}Lw(){this.K$.root.qo()}$vf(b,h,r){const A={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};A.DialogMoveCommand=h;A.DialogCloseCommand=r;this.K$.$vf(A,b,"","")}GGg(b,h,r,A){this.K$.GGg(b,h,r,A)}Csf(b){this.K$.Csf(b)}dispose(){this.Od&&(this.Od.dispose(),
this.Od=null)}}Object(u.a)(Wm,"DialogMenuRootUser",null,[184,11,427]);class Fs{constructor(b,h,r){this.lFb=this.xQd=this.HOc=this.Xl=null;this.NYe=this.NPd=!1;this.Jwc=A=>{if(!this.JXf)return!1;A.Yb.preventDefault();this.XEf();return!0};this.GKc=b;this.Ce=h;this.hz=r;this.I$b=y.AFrameworkApplication.isRtl}get JXf(){return this.NYe}V8l(b){b?(this.Xl=b,this.NYe=!0,this.NPd=!1,this.Ce.capture(Object(E.a)(this,this.JDn,"keyEventHandler"),null),this.hz.Cb(Fd.a.Lu,this.GKc,this.Jwc),this.HOc||this.bOl(),
this.Xl.appendChild(this.HOc),this.Bdn()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}XEf(){this.NYe=!1;this.xQd=this.lFb=null;this.dHo();this.cvg();this.Xl=null}cvg(){this.Ce.releaseCapture();this.hz.Gc(Fd.a.Lu,this.GKc,this.Jwc)}Bdn(){if(this.Xl.style.left.endsWith("px")&&this.Xl.style.right.endsWith("px"))this.lFb=new Sys.UI.Point(Lj.a.D2(this.I$b?this.Xl.style.right:this.Xl.style.left),Lj.a.D2(this.Xl.style.top));else{const b=this.I$b?this.GKc.offsetWidth-(this.Xl.offsetLeft+
this.Xl.offsetWidth+Lj.a.D2(this.Xl.style.marginRight)):this.Xl.offsetLeft-Lj.a.D2(this.Xl.style.marginLeft),h=this.Xl.offsetTop-Lj.a.D2(this.Xl.style.marginTop);this.GVj(b,h);this.lFb=new Sys.UI.Point(b,h)}this.xQd=this.lFb}bOl(){this.HOc=Ye.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}dHo(){this.HOc.parentNode===this.Xl&&this.Xl.removeChild(this.HOc)}JDn(b){if(!this.JXf)return!1;b.Yb.preventDefault();if(b.eventName===Fd.a.Bj){const h=b.Yb.ctrlKey?1:10;let r;switch(b.Yb.keyCode){case pg.a.aaa:this.puc(0,
-1*h);break;case pg.a.bka:this.puc(0,1*h);break;case pg.a.gDb:r=this.I$b?1:-1;this.puc(r*h,0);break;case pg.a.hDb:r=this.I$b?-1:1;this.puc(r*h,0);break;case pg.a.iib:this.okj(this.xQd.x,this.xQd.y);this.NPd=!0;break;case pg.a.vw:this.NPd=!0}}b.eventName===Fd.a.zi&&this.NPd&&this.XEf();return!0}puc(b,h){this.okj(this.lFb.x+b,this.lFb.y+h)}okj(b,h){b=this.X9k(b,h);this.GVj(b.x,b.y);this.lFb=b}GVj(b,h){this.I$b?this.Xl.style.right=b+"px":this.Xl.style.left=b+"px";this.Xl.style.top=h+"px"}X9k(b,h){const r=
this.I$b?Lj.a.D2(this.Xl.style.marginRight):Lj.a.D2(this.Xl.style.marginLeft),A=Lj.a.D2(this.Xl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.GKc.offsetWidth-this.Xl.offsetWidth-r),Math.min(Math.max(-A,h),this.GKc.offsetHeight-this.Xl.offsetHeight-A))}}Object(u.a)(Fs,"KeyMoveAdapter",null,[428]);var Gq=e(1665),Hq=e(1485);class rj{get name(){return"CUI.Behavior"}Ec(b){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&(b.register(427,"Common.UI.IDialogMenuRootUser").ha().fe(()=>
new Wm),b.register(428,"Common.IKeyMoveAdapter").ha().fe(()=>new Fs(y.AFrameworkApplication.ta.Cua(),lc.KeyInputManager.instance,Di.a.instance)));b.register(Hq.a,"CommandUI.RootManager").as("Common.IRootManager").ha().fe(()=>Hq.a.instance)}init(){Gq.a.Wuf=un.instance;const b=Hq.a.instance.dze;for(let h=0;h<b.length;++h){const r=Object(ya.a)(429,b[h]);r&&r.pXa()}Fk.a.get_instance().AK(6)}dispose(){}static main(){F.a.instance.Rc(new rj,5)}}Object(u.a)(rj,"CuiBehaviorPackage",null,[0,1]);class om{constructor(b){const h=
new Fi;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Ye.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Ye.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Ye.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=Ye.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Ye.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Ye.getImageClass("CheckboxChecked_16x16x32");
h.ImageUncheckMarkClass=Ye.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.Anb=Rr.a.JQl(h);this.Anb.refresh()}get yja(){return this.Anb}dispose(){this.Anb.dispose()}}Object(u.a)(om,"StandaloneRootController",null,[1777,11]);var Iq=e(1774),Zh=e(236);class $m{constructor(b){this.nRc=b}create(b,h){const r=new Sys.StringBuilder;this.L_c(r,b,h);this.swf(r,b);return r.toString()}nPb(b,h){const r=[];this.fxf(r,b,h);this.twf(r,b);return r}L_c(b,h,
r){switch(h.errorType){case 0:b.append(this.nRc.build());break;case 1:case 2:b.append(this.jpf(h,r))}}fxf(b,h,r){switch(h.errorType){case 0:b.push(this.nRc.X1h());break;case 1:case 2:b.push(this.yml(h,r))}}swf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Zh.a("btnIgrnoreSpellingError",(2===h.errorType?fb.a.nRa:fb.a.IDa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}twf(b,h){const r=Object.assign(new Zd.a,
{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new qg.a,{ExternalId:h}));b.push(r)}jpf(b,h){b=this.Flm(b.suggestions,h);return 0<b.length?Zh.g("msUnknownWord",Zh.d(null,b),"Menu16"):Zh.g("msUnknownWord",Zh.d(null,[Zh.a("btnNoSuggestions",fb.a.nRa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}Flm(b,h){const r=[];if(b){const A=Math.min(h.length,b.length);for(let L=0;L<A;++L)b[L]&&r.push(Zh.a("btnCorrectWord"+L,h[L].toString(),
b[L]))}return r}yml(b,h){const r=Object.assign(new Zd.a,{Id:"Suggestions",ControlList:[]});this.Elm(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new qg.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}Elm(b,h,r){if(b){const A=Math.min(h.length,b.length);for(let L=0;L<A;++L){if(!b[L])continue;const ba=Object.assign(new qg.a,{ExternalId:"btnCorrectWord"+L,Command:h[L].toString(),LabelText:b[L]});r.push(ba)}}}}Object(u.a)($m,"DefaultProofingContextMenuCreator",
null,[]);var to=e(730);class Ip{constructor(b,h){this.qjh=b;this.ylh=h;this.wsa=[fb.a.aCb,fb.a.bCb,fb.a.cCb,fb.a.V3b,fb.a.W3b]}create(b,h){return h?Object(Pb.a)(to.a,h)?this.ylh.create(b,h,this.wsa):this.qjh.create(h,this.wsa):""}lic(b,h){return h?Object(Pb.a)(to.a,h)?this.ylh.nPb(b,h,this.wsa):this.qjh.nPb(h,this.wsa):null}}Object(u.a)(Ip,"ProofingContextMenuSectionFactory",null,[456]);class Km{build(){const b=[Zh.a("btnDeleteRepeatedWord",fb.a.CLa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,
null)];return Zh.g("msRepeatedWord",Zh.d(null,b),"Menu16")}X1h(){const b=Object.assign(new Zd.a,{ControlList:[]}),h=Object.assign(new qg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(u.a)(Km,"ProofingRepeatedWordSectionBuilder",null,[455]);class Cn{static get Fh(){return Xf.a.iA(Cn.pp,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Cn.pp="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(u.a)(Cn,"AutoCorrectOptionsDialogHTML",null,[]);class mn{static get Fh(){return Xf.a.iA(mn.pp,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}mn.pp="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(u.a)(mn,"AutoCorrectOptionsDialogHTML2",null,[]);class Mo extends Xf.a{constructor(b,h){super();this.mZo=(r,A)=>{1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):A.ReplaceTextAsYouType!==this.D_.F1a||A.CapitalizeFirstLetterOfSentences!==this.D_.fYd||A.ReplaceOrdianalsWithSuperscript!==this.D_.jye||A.ReplaceHyphensWithDash!==this.D_.zod||A.ReplaceFractionsWithFractionCharacter!==this.D_.iye||this.pla&&A.ReplaceQuoteWithSmartQuote!==
this.D_.pxg?(r={},r.ReplaceTextAsYouType=A.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=A.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=A.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=A.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=A.ReplaceFractionsWithFractionCharacter,this.pla&&(r.ReplaceQuoteWithSmartQuote=A.ReplaceQuoteWithSmartQuote),this.D_.DSo(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:A.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:A.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:A.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:A.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:A.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.pla,["ReplaceQuoteWithSmartQuote"]:this.pla&&A.ReplaceQuoteWithSmartQuote}),Db.StaticActiveAppFrame.Aa().Ne(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.D_=b;this.pla=h;this.$g="AutoCorrectOptionsDialog"}YGg(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Fh=this.pla?mn.Fh:Cn.Fh;const b={};b.ReplaceTextAsYouType=this.D_.F1a;b.CapitalizeFirstLetterOfSentences=this.D_.fYd;b.ReplaceOrdianalsWithSuperscript=this.D_.jye;b.ReplaceHyphensWithDash=this.D_.zod;b.ReplaceFractionsWithFractionCharacter=this.D_.iye;this.pla&&(b.ReplaceQuoteWithSmartQuote=
this.D_.pxg);this.ti(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.mZo,b)}}Object(u.a)(Mo,"AutoCorrectOptionsDialog",Xf.a,[449]);class rq{static get Fh(){return Xf.a.iA(rq.pp,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}rq.pp="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(rq,"AltTextDialogWithDescriptionHtml",null,[]);class er{static get Fh(){return Xf.a.iA(er.pp,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}er.pp="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(er,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Dn extends Xf.a{constructor(b=!1,h=!1){super(!1,!1,b);this.STi=!1;h?(this.STi=!0,this.Fh=er.Fh):this.Fh=rq.Fh;this.$g=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Fvf(b){this.ti(CommonUIStrings.l_AlternativeTextDialogTitle,Object(E.a)(this,this.Bal,"altTextDialogHandler"),this.hMf(b));b=document.getElementById(Dn.Lkf)||document.getElementById(Dn.yVd);b.focus();b.select()}hMf(b){const h={};this.STi?h[Dn.a7m]=!0:h[Dn.Lkf]=
this.XJf(b);h[Dn.yVd]=this.iwm(b)||"";return h}wCa(b){return b.Ff.id===Dn.yVd?!1:super.wCa(b)}}Dn.Lkf="titleText";Dn.yVd="descriptionText";Dn.a7m="hideTitleField";Object(u.a)(Dn,"BaseAltTextDialogWithDescription",Xf.a,[]);var Qh=e(27);class vn extends Dn{constructor(b,h,r,A,L){super();this.Kj=h;this.Un=r;this.Bq=A;this.Yd=L;this.ZBb=this.s4=null;this.Fvf(b)}iwm(b){this.s4=b.node;this.ZBb=Qh.TableReader.kNi(b);return Qh.TableReader.HRf(this.ZBb)}XJf(b){this.s4=b.node;this.ZBb=Qh.TableReader.kNi(b);
return Qh.TableReader.IRf(this.ZBb)}Bal(b,h){if(1===b){b=Qh.TableReader.IRf(this.ZBb);const r=Qh.TableReader.HRf(this.ZBb),A=h[Dn.Lkf];h=h[Dn.yVd];this.hide();const L=this.Bq.Vc(15);try{L.Eb(this.s4),this.Kj.hEg(this.ZBb,A),this.Kj.LVj(this.ZBb,h)}finally{L&&L.dispose()}A===b&&h===r||this.Yd.Vv(16)}this.Un.pn&&this.Un.Qk.uI(this.s4)}}Object(u.a)(vn,"TableAltTextDialog",Dn,[]);class $k{constructor(b,h,r){this.tI=b;this.Zc=h;this.me=r}create(b){return new vn(b,this.tI,If.a.Gd(),this.Zc,this.me)}}Object(u.a)($k,
"TableAltTextDialogFactory",null,[]);const Jp=()=>{Ze.a.tWh=!0;return 32},hu=(b,h,r,A,L)=>{if(1===r)return 32;if(!({zG:b,aB:h}=og(L)).returnValue)return 16;Db.StaticActiveAppFrame.Aa().HAc(b,h);return 32},cj=(b,h,r,A,L)=>{if(1===r)return 32;if(!({zG:b,aB:h}=og(L)).returnValue)return 16;Db.StaticActiveAppFrame.Aa().Qpa(b,h);return 32},og=b=>{let h=null,r=0;if(!b)return{returnValue:!1,zG:h,aB:r};b=b.split(",");if(3>b.length)return{returnValue:!1,zG:h,aB:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));
r=parseInt(b[2]);return{returnValue:!0,zG:h,aB:r}};var pm=e(1859);class nl extends Sys.EventArgs{constructor(b,h,r,A,L,ba=0,ra=0,Ia=null){super();this.controlId=b;this.qwc=r;this.commandId=A;this.time=L;this.commandSurface=ba;this.aB=ra;this.contentType=Ia}}Object(u.a)(nl,"CommandClickEventArgs",Sys.EventArgs,[]);class an{constructor(b,h){this.Gza=b.PLf();this.iIc=b;this.Hib=h}wXa(b,h,r,A=null,L=null){r&&(this.Hib.JD=r.CommandLocation,this.Hib.f5=r.InvocationMethod,this.Hib.vWa=r.CommandTabName);
b=parseInt(b);let ba=this.iIc.NCi(b,h,r);ba.Seg&&(ba=this.iIc.NCi(ba.zQ,h,r));if(void 0!==ba.z$a&&null!==ba.z$a)return ba.z$a;if(ba.kUb)L=32;else{var ra=null;this.Gza&&this.Gza.npg&&(ra=this.Gza.npg(ba,L));ba.roa||ba.Bcd?ba.cMa?L=16:(L=this.Hib.Zb(ba.zQ,ba.orc?2:1,ba.Ed,L),2===L&&(L=32)):ba.cMa?L=this.Hib.Oia(null,ba.zQ,ba.Ed,Ia=>{A&&A(Ia.response)},L):(L=this.Hib.Zb(ba.zQ,2,ba.Ed,L),A&&A(L));this.Gza&&this.Gza.ipg&&this.Gza.ipg(ba,L,ra);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;
if(void 0===r||null===r)r="";ra=h.ParentMenuId;void 0!==ra&&null!==ra||!h.MenuId||(ra=h.MenuId);let Ia=h.SqmControlId;void 0!==Ia&&null!==Ia||!h.SourceControlId||(Ia=h.SourceControlId);(void 0!==Ia&&null!==Ia||void 0!==ra&&null!==ra)&&pm.a.buo(new nl(Ia,r,ra,qf.ActionManager.yba(b),Date.now()))}}ba.roa&&32===L&&this.Gza&&this.Gza.qKa&&this.Gza.qKa(ba,h);ba.Bcd&&32===L&&this.Gza&&this.Gza.z8a&&this.Gza.z8a(ba,h);return 32===L||1===L}$Na(b,h=null){if(y.AFrameworkApplication.isShuttingDown||vb.TaskManager.instance.UB)return!1;
null!=h&&null!=h.UILocation&&(this.Hib.JD=h.UILocation);const r=parseInt(b);if(!b||r===qf.ActionManager.bDf)return!0;b=this.iIc.CCi(r,h);b.Seg&&(b=this.iIc.CCi(b.zQ,h));if(void 0!==b.z$a&&null!==b.z$a)return b.z$a;r===wb.a.Nec&&h&&(b.Ed=h);return 32===this.Hib.Zb(b.zQ,1,b.Ed)}clearCache(){this.iIc.clearCache()}}Object(u.a)(an,"GeneralCuiUser",null,[183,184]);var Zf=e(207),Wj=e(60),Hg=e(53),al=e(731);class yj{get nO(){return null!=this.gbh?this.gbh:this.gbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,r,A){this.Lkh="DocumentProofingFailed";this.pdf=b;this.RMh=h;this.pAd=r;this.MM=A}oQm(){const b=this.MM.wNm(this.pdf);return{returnValue:this.MM.KMa(this.pdf),Iqo:b}}EFp(b,h){const r=Wj.a.Pp();if(r){var A=new Zf.ScriptSharpLegacyMap;A.add(Sb.a.bE,b);A.add(Rc.a.noProof,h);b=new hb.GraphTransaction(15);b.Eb(r);this.nO.IEa(Hg.a.wordStyleIdNormal,A,r)?al.a.s8j():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),al.a.recordQosError(this.Lkh,[al.a.NQc],"Style could not be modified"));
b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),al.a.recordQosError(this.Lkh,[al.a.NQc],"PageContentNode not found")}O_o(b,h){this.EFp(b,h)}o5o(b,h){if(this.RMh){var r=new Ai.DictionaryPropertySet;this.pAd.execute(A=>{A.q2c(b)});r.setValue(Sb.a.bE,b);r.setValue(Rc.a.noProof,h);h=new hb.GraphTransaction(15);h.set(Ze.a.wf.Um);this.RMh.w$(r);h.dispose()}}Df(){return Ee.a.Df(this.pdf)}}Object(u.a)(yj,"LanguageEditor",null,[442]);var ki=e(622),tj=e(259),Mm=e(119);class dm{constructor(b=
!1,h=0){this.languages=dm.kMi(Wg.a.$um());this.zJd=new tj.a;this.i1a=[];this.Qbc=new ki.a;this.UEj=b;this.xGh=0>=h?7:h;this.wGh=this.M8e=0;this.Vph=!1;b&&(this.Men(),y.AFrameworkApplication.IG(()=>{this.nNn()}))}Men(){for(var b of this.languages)this.zJd.W(b.LCID,b);b=[];try{const A=yc.a.get("RecentlyUsedLcids");if(A&&""!==A){const L=decodeURIComponent(A).split(",").slice(0,this.xGh);for(const ba of L){let ra;({value:ra}=this.zJd.Nc(parseInt(ba),ra)).returnValue&&b.push(ra)}}}catch(A){v.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",A.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.Qbc.contains(r)||(this.i1a.push(h),this.Qbc.add(r))}else h=y.AFrameworkApplication.lcid,({value:r}=this.zJd.Nc(h,r)).returnValue&&(this.i1a.push(r),this.Qbc.add(h));this.bPj()}bPj(){const b=Mm.toArray(Mm.select(Mm.asEnumerable(this.i1a),h=>h.LCID)).join(",");yc.a.p2a("RecentlyUsedLcids",b,180)}hEm(b){let h,r=-1,A=null;var L=dm.kMi(this.i1a);
this.UEj&&0<L.length&&(A=Mm.toArray(Mm.Si(Mm.asEnumerable(L),(Ia,Ta)=>{b===Ia.LCID&&-1===r&&(r=Ta);return{["key"]:Ta,["text"]:Ia.displayName,["value"]:Ia.LCID.toString()}})));let ba=0;A&&(ba=A.length);L=ba;const ra=Mm.toArray(Mm.Si(Mm.asEnumerable(this.languages),(Ia,Ta)=>{b===Ia.LCID&&-1===r&&(r=ba+Ta);return{["key"]:ba+Ta,["text"]:Ia.displayName,["value"]:Ia.LCID.toString()}}));h=r;return 0<ba?{returnValue:A.concat.apply(A,ra),selectedIndex:h,iBc:L}:{returnValue:ra,selectedIndex:h,iBc:L}}e2o(b,
h){if(this.UEj&&({value:r}=this.zJd.Nc(b,r)).returnValue){h=b!==h;if(this.Qbc.contains(b))b=Array.indexOf(this.i1a,r),0<=b&&(Array.removeAt(this.i1a,b),this.i1a.push(r)),h&&this.M8e++;else{this.Qbc.add(b);this.i1a.push(r);if(this.i1a.length>this.xGh){var r=this.i1a.shift();this.Qbc.remove(r.LCID)}h&&this.wGh++}this.bPj()}}nNn(){const b=this.M8e+this.wGh;!this.Vph&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.M8e/b),this.Vph=!0)}static kMi(b){b=Array.clone(b);
b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(u.a)(dm,"LanguageListHelper",null,[434]);var bl=e(197);class Un extends bl.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(u.a)(Un,"NumberButtonProps",bl.a,[]);var ak=e(175);class Gj{static get D$(){return null!=Gj.l9g?Gj.l9g:Gj.l9g=Xa.a.instance.Wa("Box4.ISpacingCommands")}static get sdb(){return null!=Gj.q5g?Gj.q5g:Gj.q5g=Xa.a.instance.Wa("Box4.ILineSpacingHelper")}static get MYj(){return!!Gj.D$}static mc(){const b=
y.AFrameworkApplication.va;b.qa(fb.a.Mwc,ic.a.view,Gj.Mwc);b.Oc(fb.a.Mwc,1124);b.qa(fb.a.Mwc,ic.a.paragraph,Gj.MFp)}static Mwc(b,h,r,A,L){if(1===r||!Gj.MYj)return Gj.MYj?32:8;if(!Gj.A4i){var ba=[];ba.push(Object.assign(new Un,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ba.push(Object.assign(new Un,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ba.push(Object.assign(new Un,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ba.push(Object.assign(new Un,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ba.push(Object.assign(new Un,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ba.push(Object.assign(new Un,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));L.MenuItems=Zh.e(ba);Gj.A4i=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.ub;ba=null;h&&h.ob.currentSelection&&(ba=h.ob.currentSelection);h=Object(ak.a)().Wwi(ba.Ya);y.AFrameworkApplication.va.Sf(h,b,r,!0,A,L);return 32}static MFp(b,h){let r=b=!0;h=Gj.sdb.uYa(h.node);var A=h.beforeSpacing;let L=!1;1===
A.unit&&(L=!0);if(L||0<A.value)b=!1;h=h.afterSpacing;A=!1;1===h.unit&&(A=!0);if(A||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Gj.Z4k,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Gj.SHo,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Gj.Y4k,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Gj.RHo,r));return 32}}Gj.Z4k="AddSpaceBeforeParagraph";Gj.Y4k="AddSpaceAfterParagraph";Gj.SHo="RemoveSpaceBeforeParagraph";
Gj.RHo="RemoveSpaceAfterParagraph";Gj.A4i=!1;Object(u.a)(Gj,"LineSpacingRibbonMenu",null,[]);var Tk=e(205),ms=e(1877),Sr=e(1565),Uk=e(68);const vp=(b,h,r)=>{if(1===r)return 32;b=Db.StaticActiveAppFrame.Aa().$L.Hma("Automation test",!1);b.image=3;Db.StaticActiveAppFrame.Aa().$L.yB(b);return 32},ns=(b,h,r,A,L)=>{let ba;if(!({cfk:ba}=Kp(L)).returnValue)return 16;Tk.UISurfaces.tN().then(ra=>{let Ia=null;var Ta=Object.assign(new ms.a,{label:"OK",onExecute:()=>{Ia&&ra.removeNotification(Ia)}});Ta=Object.assign(new Sr.a,
{target:"#"+Uk.a.qzg,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:Ta,useTeachingStyles:ba});Ta=ra.callout(Ta);Ia=ra.addNotification(Ta);return null},ra=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ra);return null});return 32},Kp=b=>{let h=!1;if(!b)return{returnValue:!1,cfk:h};h=Boolean.parse(b);return{returnValue:!0,cfk:h}};class En{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(En,"ColorCellProps",
null,[]);let Vn,em,uo,So,Bo,nn,$p;class zj{constructor(){this.lba=new Cb.a;this.Cvh=!1}bKa(b){const h=this.lba.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.lba.removeAt(h)}this.lba.insert(0,b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.lba.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.lba.K(10)),this.lba.removeAt(10));this.iHp();return r}YCb(b){let h="#";for(let A=0;A<this.lba.count;A++){var r=
"#"+this.lba.K(A).substring(4,6)+this.lba.K(A).substring(2,4)+this.lba.K(A).substring(0,2);r=Object.assign(new En,{Color:this.lba.K(A),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const A of zj.tGh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(A,h))}iHp(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.lba.count;r++){var h="#"+this.lba.K(r).substring(4,
6)+this.lba.K(r).substring(2,4)+this.lba.K(r).substring(0,2);h=Object.assign(new En,{Color:this.lba.K(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of zj.tGh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.Cvh||this.jGp();this.Cvh=!0}jGp(){for(const b of Object.keys(zj.kAh)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=zj.kAh[b],r=[];for(const A of h)r.push(appChrome.api.menuSection(A,
A[0]in zj.H3e?zj.H3e[A[0]].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,zj.H3e[b].toString()))}}}zj.kAh={["FontColor"]:($p=new Cb.a,$p.add(["AutomaticFontColor"]),$p.add(["ThemeFontColorPickerMCU"]),$p.add(["ThemeFontColorPicker"]),$p.add(["StandardFontColorPicker"]),$p.add(["RecentFontColorPicker"]),$p.add(["MoreFontColors"]),$p),["CellShading"]:(nn=new Cb.a,nn.add(["ThemeShadingColorPickerMCU"]),nn.add(["ThemeShadingColorPicker"]),nn.add(["StandardShadingColorPicker"]),
nn.add(["RecentCellShadingColorPicker"]),nn.add(["ClearShadingColor"]),nn.add(["MoreCellShadingColors"]),nn),["PictureBorders"]:(Bo=new Cb.a,Bo.add(["ThemePictureBorderColorPickerMCU"]),Bo.add(["ThemePictureBorderColorPicker"]),Bo.add(["StandardPictureBorderColorPicker"]),Bo.add(["RecentPictureBorderColorPicker"]),Bo.add(["MorePictureBorderColors"]),Bo.add(["NoPictureBorder"]),Bo.add(["PictureBorderWeightOptions"]),Bo.add(["PictureBorderStyleOptions"]),Bo),["PageColor"]:(So=new Cb.a,So.add(["ThemePageColorPickerMCU"]),
So.add(["ThemePageColorPicker"]),So.add(["StandardPageColorPicker"]),So.add(["RecentPageColorPicker"]),So.add(["NoPageColor"]),So.add(["MorePageColors"]),So),["ParagraphShading"]:(uo=new Cb.a,uo.add(["ThemeParagraphShadingColorPickerMCU"]),uo.add(["ThemeParagraphShadingColorPicker"]),uo.add(["StandardParagraphShadingColorPicker"]),uo.add(["RecentParagraphShadingColorPicker"]),uo.add(["NoParagraphShadingColor","MoreParagraphShadingColors"]),uo),["ParagraphBorderColorOptions"]:(em=new Cb.a,em.add(["ThemeParagraphBorderColorPickerMCU"]),
em.add(["ThemeParagraphBorderColorPicker"]),em.add(["StandardParagraphBorderColorPicker"]),em.add(["RecentParagraphBorderColorPicker"]),em.add(["MoreParagraphBorderColors"]),em)};zj.H3e={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardParagraphBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentParagraphBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["ParagraphBorderColorOptions"]:Box4Intl.Box4Strings.L_ParagraphBorderColor,["ParagraphShading"]:Box4Intl.Box4Strings.L_ParagraphShading,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};zj.tGh=(Vn=new Cb.a,Vn.add("RecentFontColorPicker"),Vn.add("RecentCellShadingColorPicker"),Vn.add("RecentPictureBorderColorPicker"),
Vn.add("RecentPageColorPicker"),Vn.add("RecentParagraphShadingColorPicker"),Vn.add("RecentParagraphBorderColorPicker"),Vn);Object(u.a)(zj,"RecentColorsSectionHandler",null,[]);var xr=e(1876),fm=e(1513);class To{constructor(b){this.COk=b}H5(){}F5(b){this.COk.OZn(b)}}Object(u.a)(To,"DataBuddyActionListener",null,[113]);class Co{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(u.a)(Co,"DataBuddyTaskPaneProps",null,[]);class fo{constructor(b){this.isVisible=
!1;this.eaa=new Cb.a;this.RMe=null;this.qY=b;this.kC=new xr.a;this.oc=Jc.FocusManager.instance()}initialize(){this.RMe=new To(this);this.qY.iLa();this.kC.BP(this.g4k());this.kC.BP(this.A0k())}toggle(){this.isVisible?this.hide():this.show()}OZn(b){if(2===b.behavior){const h=qf.ActionManager.yba(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.eaa.add(h+": "+fo.smm(b.response)),this.ao())}}hide(){Tk.UISurfaces.aw().then(b=>{b.hideTaskPane(fo.CF,2);return null})}show(){Tk.UISurfaces.aw().then(b=>
{b.showTaskPane(fo.CF,this.AB());return null});this.isVisible&&Tk.UISurfaces.aw().then(b=>{b.setSelectedTaskPane(fo.CF);return null})}g4k(){return b=>{b.actions=this.eaa.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}A0k(){return b=>{b.onClearClick=()=>{this.eaa.clear();this.ao()}}}mc(){y.AFrameworkApplication.va.WZ(this.RMe)}lRa(){y.AFrameworkApplication.va.M4b(this.RMe)}AB(){const b=new Co;this.kC.Dgb(b);return Object.assign(new fm.a,{title:"Data Buddy",hideHeader:!1,
width:fo.width,location:2,contentProps:b,onOpen:()=>{this.ZW();this.mc();this.isVisible=!0;y.AFrameworkApplication.ta.Ne()},onClose:()=>{this.qja();this.lRa();this.isVisible=!1;this.ao();y.AFrameworkApplication.ta.Ne()},isModernPane:!0})}ao(){Tk.UISurfaces.aw().then(b=>{b.updateTaskPane(fo.CF,this.AB());return null})}ZW(){this.oc.Rg(fo.CF)}qja(){this.ddb()&&this.oc.Rg(this.oc.NY)}ddb(){return!!this.oc.currentScope&&this.oc.currentScope.name===fo.CF}static smm(b){switch(b){case 0:return"Unattempted";
case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}fo.CF="DataBuddyTaskPane";fo.width=300;Object(u.a)(fo,"Box4DataBuddyTaskPane",null,[426]);class Jq{constructor(b){this.mi=b}rRa(b){this.mi&&this.mi.UH(b)}nwd(){this.mi&&this.mi.Fwd(void 0)}}Object(u.a)(Jq,"RibbonButtonUpdater",null,[424]);var gm=e(350);class Lp{constructor(){this.Cbf=this.Z=
null}get name(){return"Box4.UI"}Ec(b){this.Z=b;b.ja("Box4.IGeneralCuiUser",()=>new an(b.resolve("Box4.UI.CuiActionBridge"),y.AFrameworkApplication.va)).ha();b.ja("Box4.UI.TableAltTextDialogFactory",()=>new $k(b.resolve("Box4.ITableEditor"),new gm.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ja("Box4.UI.ILanguageEditor",()=>new yj(Fg.a.instance.hh,b.Wa("Box4.ITextFormattingCommands"),b.Za("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ja("CommandUI.StandaloneRootController",
()=>new om(y.AFrameworkApplication.mr)).as("Common.IStandaloneRootController").ha();b.ja("Box4.UI.IAutoCorrectOptionsDialog",()=>new Mo(b.resolve("Box4.IAutoCorrectOptionsInfo"),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ja("Box4.UI.LanguageListHelper",()=>new dm(y.AFrameworkApplication.J.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(Km,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();
b.ja("Box4.UI.DefaultProofingContextMenuCreator",()=>new $m(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();b.ja("Box4.UI.ProofingContextMenuSectionFactory",()=>new Ip(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ja("Box4.RibbonButtonUpdater",()=>new Jq(this.Z.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ja("Box4.UI.RecentColorsSectionHandler",
()=>new zj).ha();b.ja("Common.IDataBuddyTaskPane",()=>new fo(Iq.a.instance)).ha()}init(){var b=Db.StaticActiveAppFrame.Aa();const h=b.Pb;nj.Ccn(Object(E.a)(h,h.$Yb,"onAuthenticationLost"),Object(E.a)(h,h.aZb,"onAuthenticationRestored"),b.osl);b=y.AFrameworkApplication.va;b.qa(fb.a.zno,ic.a.application,Jp);b.nb(fb.a.Cdp,ic.a.application,hu,96);b.nb(fb.a.kep,ic.a.application,cj,96);b=y.AFrameworkApplication.va;b.nb(fb.a.cgp,ic.a.application,vp,96);b.nb(fb.a.rdp,ic.a.application,ns,96);Gj.mc();this.Ten();
this.Cbf=this.Z.resolve("Common.IStandaloneRootController")}Ten(){this.Z.Za("Box4.IGeneralCuiUser").execute(b=>{this.Z.Za("Common.IStandaloneRootController").execute(h=>{h.yja.nJ=b})})}dispose(){this.Cbf.dispose();this.Cbf=null}static main(){F.a.instance.Rc(new Lp,6)}}Object(u.a)(Lp,"Box4UIPackage",null,[0,1]);var Mp=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",
Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},fr=e(1878);class Xm{get name(){return"Box4.Insights"}init(){}dispose(){}Ec(b){b.ja("Box4.Insights.Box4InsightsSelection",()=>new fr.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(u.a)(Xm,"Box4InsightsPackage",null,[0,1]);const bn=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+
b)};var sq=e(421),Ak=e(563),Nm=e(724),Qs=e(1837);class Rs{Txb(){return!1}reset(){}update(){}}Object(u.a)(Rs,"NullTaskYieldStrategy",null,[342]);var It=e(1276);class lt{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(u.a)(lt,
"CatchUpConfiguration",null,[]);class dn{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(u.a)(dn,"SharedControllerFactoryParameters",null,[]);var Pk=e(610),Lc=e(19);class pk{constructor(b,h,r,A){this.Aao=(L,ba)=>{(this.rHd=!this.rHd)&&
ba.Pk&&ba.Pk.contextId===ic.a.kd&&this.w6h(ba.Pk.node,ba.Pk.Uj);return 32};this.mB=b;this.Tq=h;this.ga=r;this.oc=A;this.YId=this.ZId=null;this.rHd=!1;this.ga.qa(Lc.a.P6j,ic.a.view,this.Aao);this.oc.te(Df.AFrame.rr).bindAction(lc.KeyInputManager.xc(pg.a.CFc,6),Lc.a.P6j)}sR(b,h){this.rHd&&this.Tq&&h&&h.Pn&&h.Pn.currentSelection&&h.Pn.currentSelection.Ya&&h.Pn.currentSelection.Ya.node&&h.Pn.currentSelection.Ya.contextId===ic.a.kd&&this.w6h(h.Pn.currentSelection.Ya.node,h.Pn.currentSelection.Ya.Uj)}w6h(b,
h){b&&(this.Dmj(b)?(this.ZId&&this.ZId.id.equals(b.id)||(this.Tq.sendNotification(WacWordeditorStrings.CatchUpActivityParagraphAnnouncementTemplate,!1),this.ZId=b),this.OPn(b,h)):this.YId=this.ZId=null)}Dmj(b){return 0<this.mB.bTb(b).count}OPn(b,h){if(b){var r=-1,A=null,L=null;for(let ba=0;ba<b.ra.length;ba++){const ra=b.ra.jc(ba);if(!(null==L||ra.changeStart&&ra.changeStart.equals(A))&&h>=r&&h<=ra.cp&&!A.equals(this.YId))if(this.mB.ZVb(A)){(b=this.mB.F4c(A,b.id))&&0<b.actors.length&&b.displayTimestamp&&
(b=String.format(WacWordeditorStrings.CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Tq.sendNotification(b,!1),this.YId=A);break}else this.YId=null;ra.changeStart&&!ra.changeStart.equals(A)&&(r=ra.cp,A=ra.changeStart);L=ra.changeStart}}}}Object(u.a)(pk,"ActivityAnnouncementManager",null,[]);var Fn=e(1566),Wl=e(557),Mj=e(793),bk=e(529);class go{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=
this.displayTimestamp=this.location=this.actors=null}}Object(u.a)(go,"Activity",null,[]);var ng=e(329);class Np extends go{constructor(){super();this.vy=this.objectId=null}static FU(b){const h=new bk.a(new ng.a);if(b.vy)for(const r of b.vy)h.add(r);return h}}Object(u.a)(Np,"RevisionSetActivity",go,[]);class jp{constructor(b,h,r,A=!1){this.kRe=null;this.dismiss=()=>{this.bnj.then(L=>{L.removeNotification(this.kRe);return this.kRe=null})};this.U0=b;this.Tb=h;this.bnj=r;this.brc=A}kyp(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:this.Tb.Zb(wb.a.feb,
2,null);break;default:this.TZn()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}TZn(){this.bnj.then(b=>{var h=Object.assign(new Sr.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new Fn.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new Wl.a,{expirationOptions:Object.assign(new Mj.a,{displayTimeoutSeconds:10,
onExpire:this.dismiss})});this.kRe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Tb.Zb(wb.a.M3d,2,h))return!1;break;case 1:return this.b2l(b)}return!0}b2l(b){b=
Np.FU(b);return b?0<this.U0.Y9d(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(u.a)(jp,"ActivityContentManager",null,[531]);var aq=e(1367),ho=e(2102),Hk=e(413),io=e(726);class bq{constructor(){this.vy=this.K1=null}compare(b){if(!b)return!1;if(this.K1&&b.K1){if(this.K1.count!==b.K1.count)return!1;for(const h of this.K1)if(!b.K1.contains(h))return!1}else if(!b.K1&&this.K1||!this.K1&&b.K1)return!1;if(b.vy&&this.vy){if(b.vy.count!==this.vy.count)return!1;
for(const h of this.vy)if(!b.vy.contains(h))return!1}else if(!this.vy&&b.vy||!b.vy&&this.vy)return!1;return!0}}Object(u.a)(bq,"ActivityHighlightableObject",null,[]);class os extends aq.a{constructor(b,h){super();this.U7e=this.Dbc=null;this.Dzd=b;this.mB=h;this.w7=[new ho.a(Hk.a.$4h,Hk.a.Z4h),new ho.a(Hk.a.X4h,Hk.a.W4h),new ho.a(Hk.a.jYd,Hk.a.kYd),new ho.a(Hk.a.lYd,Hk.a.Nqf)]}get Cub(){return 1}get Kbb(){return this.w7}get Fha(){return!0}fbb(b,h){if(b=Object(ya.a)(bq,b))if(b.K1)for(const r of b.K1)h.add(r);
else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}$Oa(b,h){if(this.Yt.pLa){var r=this.Dzd.igb,A=this.Dzd.Eub,L=!!r&&r.compare(A),ba=this.Yt.pLa,ra=ba.action,Ia=this.P$o(ba,b),Ta=!1;2!==ra&&ra&&(Ta=(Ta=this.Yt.ced)?1===Ta.type:!!r||!!A);h=h.DPa("*");for(let ob=0,nb=h.length;ob<nb;ob++){const Eb=h[ob],bc=this.Axm(Eb,Hk.a.NXc);if(bc&&bc.gx)if(this.EGo(Eb),1===ba.type)switch(ra){case 0:Ia&&r.vy.contains(bc.gx)&&this.YVd(Eb,2,bc,!1);break;case 2:Ia&&A.vy.contains(bc.gx)&&
this.YVd(Eb,L?2:1,bc,!1);break;default:this.soc(b,Eb,bc,!1)}else Ta?this.soc(b,Eb,bc,!1):this.soc(b,Eb,bc,!0)}this.Dbc&&(this.Dbc.classList.add(Hk.a.lYd),this.U7e=this.Dbc=null)}}Axm(b,h){return bm.a.Mb(b,h)}P$o(b,h){if(b&&b.ZD){const r=b.ZD,A=b.action;if(1===b.type&&(2===A||!A)&&r.K1)return r.K1.contains(h);if(r.vy)for(const L of r.vy){b=this.mB.e6c(L);for(const ba of b)if(ba===h)return!0}}return!1}soc(b,h,r,A){const L=this.Dzd.igb,ba=this.Dzd.Eub;L&&L.vy.contains(r.gx)&&(!L.K1||L.K1.contains(b))?
this.YVd(h,2,r,A):ba&&ba.vy.contains(r.gx)&&(!ba.K1||ba.K1.contains(b))&&this.YVd(h,1,r,A)}YVd(b,h,r,A){b&&io.a(b)&&(b.classList.add(this.QBm(2===h,A)),this.q1o(b,r,A))}q1o(b,h,r){this.Dbc?-1!==h.cpEnd&&this.U7e.cpEnd!==h.cpBegin&&(this.Dbc.classList.add(r?Hk.a.Nqf:Hk.a.lYd),b.classList.add(r?Hk.a.kYd:Hk.a.jYd)):b.classList.add(r?Hk.a.kYd:Hk.a.jYd);b.classList.add(Hk.a.Y4h);this.Dbc=b;this.U7e=h}EGo(b){this.Yt.t1a(b);this.BFo(b)}BFo(b){b.classList.remove(Hk.a.jYd,Hk.a.kYd,Hk.a.Y4h,Hk.a.lYd,Hk.a.Nqf)}QBm(b,
h){return h?b?Hk.a.W4h:Hk.a.Z4h:b?Hk.a.X4h:Hk.a.$4h}}Object(u.a)(os,"ActivityHighlightActor",aq.a,[]);var ti=e(2103),Fl=e(174);class Kq{constructor(b,h,r,A,L,ba,ra,Ia){this.$_=b;this.vS=h;this.mB=r;this.yOk=L;this.pb=ba;this.Tq=Ia;this.oc=ra;this.vS.Qie=!1}Jtj(b,h,r){b?this.k7m(b,h,r):this.vS.igb&&(b=Object.assign(new ti.a,{action:1,type:1,ZD:null,XN:this.vS.igb}),this.vS.igb=null,this.$_.pJ(b))}k7m(b,h,r){if(h){b=new bk.a(new ng.a);for(L of h){var A=this.mB.g5c(L);for(let ba=0;ba<A.length;ba++){const ra=
A[ba];this.mB.ZVb(ra)&&b.add(ra)}}var L=this.mB.Y9d(b);L=this.edi(L,b);A=this.vS.igb;this.vS.igb=L;L=Object.assign(new ti.a,{action:0,type:1,ZD:this.vS.igb,XN:A});this.$_.pJ(L);r&&!this.sUo(h.K(0),b)||this.nWo(h.K(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}sUo(b,h){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,
377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.Eum(b,h);return this.yOk.H1b(b.id,h)?this.Uc(b,h)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}nWo(b,h){b=this.RBm(b,h);h=new Sys.StringBuilder;for(let r=0;r<b.count;r++)h.append(String.format(WacWordeditorStrings.CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.K(r)));this.Tq.sendNotification(h.toString(),!0)}Uc(b,h){if(!b||!rd.ParagraphReader.lc(b))return v.ULS.sendTraceTag(579396806,
377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.vS.Qie=!0;b=vc.a.jd(b,h);b=new Fl.Selection([b],!0);this.pb.Uc(b);Jc.FocusManager.kO()&&this.oc.Rg(Df.AFrame.Co);return!0}Eum(b,h){if(h&&0<h.count)for(let r=0;r<b.ra.length;r++){const A=b.ra.jc(r);if(A.changeStart&&h.contains(A.changeStart))return A.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");
return 0}RBm(b,h){const r=new Cb.a;if(h&&0<h.count&&b){let A=-1;for(let L=0;L<b.ra.length;L++){const ba=b.ra.jc(L);if(-1!==A&&ba.jv)if(ba.changeStart&&h.contains(ba.changeStart))continue;else r.add(b.characterData.substring(A,ba.cp)),A=-1;ba.changeStart&&h.contains(ba.changeStart)&&(A=ba.cp)}}return r}Dsj(b,h){if(b)switch(b.type){case 1:if(h){b=new bk.a(new ng.a);for(var r of h){h=this.mB.g5c(r);for(let A=0;A<h.length;A++){const L=h[A];this.mB.ZVb(L)&&b.add(L)}}}else b=Np.FU(b);h=this.mB.Y9d(b);this.vS.Eub=
this.edi(h,b);r=Object.assign(new ti.a,{action:2,type:1,ZD:this.vS.Eub,XN:null});this.$_.pJ(r)}else this.vS.Eub&&(r=Object.assign(new ti.a,{action:3,type:1,ZD:null,XN:this.vS.Eub}),this.vS.Eub=null,this.$_.pJ(r))}edi(b,h){var r=null;if(b){r=new Ka.a;for(const A of b)12===A.type&&r.add(A)}b=new bq;b.K1=r;b.vy=h?h:this.HHm(r);return b}HHm(b){const h=new bk.a(new ng.a);if(!b)return h;for(const r of b)for(const A of this.mB.bTb(r))h.add(A);return h}}Object(u.a)(Kq,"ActivityHighlightManager",null,[]);
var Tl=e(886),Om=e(722),cq=e(1365),on=e(61),Jl=e(94),Uo=e(47);class Vo{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(u.a)(Vo,"CreateIndicatorTooltipParameters",null,[]);class dq{constructor(){this.clearSticky=!1}}Object(u.a)(dq,"DismissIndicatorTooltipParameters",null,[]);class gr{constructor(){this.target=null;this.isSticky=!1}}Object(u.a)(gr,"UpdateIndicatorTooltipParameters",null,[]);class Pm extends Sys.EventArgs{constructor(b,h,r){super();
this.BRb=b;this.$Vi=h;this.$ap=r}}Object(u.a)(Pm,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Wo{constructor(){this.aWi=new Map;this.bWi=new Set}hvp(b,h){this.bWi.add(b);this.aWi.set(b,h)}Jsn(b){return ed.a.R1i(b.htmlElement)}LXm(){const b=new Set;for(const h of this.bWi){const r=this.aWi.get(h);r&&this.Isn(r)&&b.add(h)}return b}Isn(b){return b.parentElement&&ed.a.R1i(b.parentElement)}}Object(u.a)(Wo,"IndicatorVisibilityTracker",null,[]);class vo extends cq.a{constructor(b,h,r,A,L,ba,ra,Ia,
Ta,ob){super();this.sa=new Nf.a;this.gHb=this.xfa=null;this.H2m=(nb,Eb,bc,Bc,Yc)=>{if(!Yc)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Eb=Np.FU(Yc.Activity);nb=null;if(Yc.NodeId&&(Yc=Jl.b(Yc.NodeId),!V.a.Kx(Yc,V.a.nil)&&(Yc=this.mB.aEi(Yc),this.$Ng(Yc,!1))))return 32;for(const zd of Eb)if(this.mB.ZVb(zd)){Yc=this.mB.mmc(zd);if(this.$Ng(Yc,!0))return 32;Yc&&!nb&&(nb=Yc)}if(this.$Ng(nb,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");
return 8};this.F2m=(nb,Eb,bc,Bc,Yc)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Yc&&Eb&&Eb.nm&&(nb=Eb.node)&&((nb=this.XFc.l$d(nb))?this.TTd(nb,!1,!1):v.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.egp=nb=>{(nb=this.XFc.l$d(nb.customData))&&this.TTd(nb,!1,!1)};this.Xoa=nb=>this.Drj(nb.uy,!0);this.Yoa=nb=>{nb=nb.uy;if(nb===this.xfa)return!0;
this.XHj(nb);return!0};this.xwa=nb=>{this.gHb=null;return this.Drj(nb.uy,!1)};this.IZ=()=>{this.BHg();this.mZd(!0);return!1};this.Jv=()=>{this.Cwj()};this.Ise=()=>{this.xfa&&this.yck(this.xfa);this.gHb&&this.XHj(this.gHb);this.a6n()};this.Cwj=()=>{this.xfa?this.yck(this.xfa):this.Orf()};this.mB=b;this.bNe=h;this.ash=r;this.DFk=A;this.qUa=L;this.Eaa=null;this.Sb=ra;this.XFc=Ia;this.RYe=new Wo;this.VF=Ta;this.eba=ob;this.N5&&(this.N5.d8(this.Ise),this.N5.z7k(this.Cwj));ba&&ba.execute(nb=>{nb.UW(this.Jv)})}get N5(){return this.qUa&&
this.qUa.Aj?this.qUa:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Jga(b,h,r){if(this.xfa){var A=Uo.a(this.xfa);if(b===A)return this.xfa}const L=b.Gh.ownerDocument;A=Tl.a.createElement(L,Om.a.div);A.className=Hk.a.mYd;A.style.left=h+"px";A.style.top=r+"px";h=Tl.a.createElement(L,Om.a.div);h.className=this.VF?Hk.a.f5h:Hk.a.a5h;A.style.cursor="pointer";h.style.cursor="pointer";h.style.backgroundColor=this.eba.Vqm();h.style.outlineWidth="1px";h.style.outlineStyle="solid";
h.style.outlineColor=this.eba.Wqm();A.appendChild(h);qd.a.instance.Cb(Fd.a.sP,A,this.Xoa);qd.a.instance.Cb(Fd.a.pK,A,this.Yoa);Wf.a.instance.Cb(Fd.a.click,A,this.xwa);qd.a.instance.Cb(Fd.a.contextMenu,A,this.IZ);v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.XLn(b);h=this.AIm(b);this.RYe.hvp(h,A);this.RYe.Jsn(b)&&this.Sqj(h);return A}s2a(b){return this.L9o(b)}JWa(b){const h=this.qql(b),r=[];r.push(this.Jga(b.z2,h,b.nEc[0].y-b.l9[0].y));return r}qql(b){let h=Hk.a.Hbn+
(0>b.ved?-b.ved:0);const r=rb.a.Zj(b.zoa,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<Hk.a.b5h?Hk.a.b5h:h;return y.AFrameworkApplication.isRtl?b.l9[0].width/this.zoom+h:-h}YXj(b){if(b&&b.yc===on.a.paragraphNode||b.yc===on.a.fqa){const h=this.mB.bTb(b);if(h)for(const r of h)if(b===this.mB.mmc(r))return!0}return!1}L9o(b){for(const h of rd.ParagraphReader.ox(b.Jb,!0,!1))if(this.YXj(h))return!0;return!1}mc(b){b.qa(Lc.a.GZj,ic.a.kd,this.F2m);b.qa(Lc.a.UGg,
ic.a.kd,this.H2m)}$Ng(b,h){if(!b)return!1;const r=this.XFc.l$d(b);if(r)return this.TTd(r,!1,!0),!0;if(!h){let A;this.Cmd((A=new Cb.a,A.add(b),A),!1,!0,!0);h=new Md.a(3,1,0,this.egp,181);h.customData=b;this.Sb.pc(h);return!0}return!1}SMl(b,h=!1){h&&this.mZd(!0);if(b&&b.parentNode){var r=this.URf(b);r=this.Emm(r);this.Eaa||(this.Eaa=document.createElement("Div"),document.getElementById(y.AFrameworkApplication.fWc).appendChild(this.Eaa));this.bNe.createActivityIndicatorTooltip(Object.assign(new Vo,{target:b,
container:this.Eaa,activityIds:r,isSticky:h,dirHint:9}));h&&(this.xfa=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}$6l(b){b&&b.classList.add(Hk.a.nYd)}Drj(b,h){return this.TTd(b,h,!1)}TTd(b,h,r){if(h&&b===this.xfa)return!0;const A=this.URf(b);h||this.BHg();this.SMl(b,!h);this.$6l(b.getElementsByClassName(this.VF?Hk.a.f5h:Hk.a.a5h)[0]);this.Cmd(A,h,!0,r);this.Sej(A,h?1:2);this.DFk.Yle();
h&&(this.gHb=b);return!0}mZd(b=!1){this.bNe.dismissActivityIndicatorTooltips(Object.assign(new dq,{clearSticky:b}));this.gHb=null;b&&(this.xfa=null)}i0j(b){b&&b.classList.remove(Hk.a.nYd)}BHg(){this.xfa&&this.i0j(this.xfa.getElementsByClassName(Hk.a.nYd)[0])}XHj(b){const h=this.URf(b);this.Cmd(h,!0,!1,!1);this.i0j(b.getElementsByClassName(Hk.a.nYd)[0]);this.mZd(!1);this.gHb=null}URf(b){let h=null;(b=(b=Uo.a(b))?b.Jb:null)&&11===b.type&&(h=rd.ParagraphReader.ox(b,!0,!1));return h}Orf(){const b=!!this.gHb;
if(this.xfa||b)this.BHg(),this.mZd(!0),this.Cmd(null,!1,!1,!1),this.Cmd(null,!0,!1,!1)}k6k(b){this.sa.addHandler(vo.IRh,b)}l6k(b){this.sa.addHandler(vo.JRh,b)}Cmd(b,h,r,A){let L=null;if(r&&b){for(const ba of b)if(r=this.mB.g5c(ba))for(let ra=0;ra<r.length;ra++){const Ia=r[ra];if(this.mB.ZVb(Ia)){L=this.mB.F4c(Ia,ba.id);break}}if(!L){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(vo.IRh,new Pm(L,
b,!1)):this.sa.raiseEvent(vo.JRh,new Pm(L,b,A))}Emm(b){const h=[];if(b)for(const A of b){var r=this.mB.bTb(A);for(const L of r)(r=this.mB.F4c(L,A.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return h}yck(b){b&&b.parentNode?(this.bNe.updateActivityIndicatorTooltip(Object.assign(new gr,{target:b,isSticky:!0})),this.xfa=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}a6n(){const b=
this.RYe.LXm();for(const h of b)this.Sqj(h)}Sqj(b){this.ash.Rej(b,3)}AIm(b){return(b=rd.ParagraphReader.ox(b.Jb,!0,!1))&&b.count?b.K(0).id:null}XLn(b){b=rd.ParagraphReader.ox(b.Jb,!0,!1);this.Sej(b,0)}Sej(b,h){b&&b.count&&this.WLn(b.K(0).id,h)}WLn(b,h){this.ash.Rej(b,h)}}vo.IRh="ActivityIndicatorPreviewed";vo.JRh="ActivityIndicatorSelected";Object(u.a)(vo,"ActivityIndicatorActor",cq.a,[]);var hg=e(30);class co{constructor(b,h,r){this.mB=b;this.VRd=h;this.qUa=r}get N5(){return this.qUa&&this.qUa.Aj?
this.qUa:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}l$d(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const h=this.gFi(b);if(!h){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.mB.bTb(b);for(const r of b)if(b=this.mB.mmc(r),b=this.gFi(b))return b}return h}gFi(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var h=this.VRd.HTb(b);if(!h||11!==h.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.ug(this.N5.Lc);if(!h||!h.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),
null;var r=eb.a.h5c(h.htmlElement,co.HRh);if(r)return r;h=h.F6d();if(!h)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;h=eb.a.Qrm(h,co.HRh);if(!h)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const A=Uo.a(h[r]),L=hg.a.kn(b);if(A&&A.Jb&&L&&A.Jb.id.equals(L.id))return h[r]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");
return null}dDm(b){b=this.mB.aEi(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),V.a.nil;b=this.l$d(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),V.a.nil;b=Uo.a(b);return b?b.Jb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),
V.a.nil)}}co.HRh="CatchUpActivityIndicatorContainer";Object(u.a)(co,"ActivityIndicatorHelper",null,[]);class tq{constructor(b,h,r,A,L,ba){this.ODa=b;this.Kh=h;this.phf=r;this.Tb=A;this.U0=L;this.Ef=ba;this.A9i=!1;this.LQn=(ra,Ia,Ta)=>{if(1===Ta)return this.IVf?32:8;2===Ta&&(this.IVf&&(this.phf.Orf(),this.Axl()),v.ULS.sendTraceTag(38138719,377,50,H.c({["MarkAsRead invoked"]:!0})));Db.StaticActiveAppFrame.Aa().Ne();return 8};this.ODa.LPa(this.phf)}initialize(){this.Tb.qa(Lc.a.Ohj,dd.a.frame,this.LQn)}get IVf(){return!!this.U0.AW&&
0<this.U0.AW.count||!!this.U0.Cuc&&0<this.U0.Cuc.count}get DCn(){return this.A9i}ulg(b){const h=b&&b.wywaActivities?b.wywaActivities.length:0;if(0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.Ef.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.V0n(b.wywaActivities),this.A9i=!0):(v.ULS.shipAssertTag(36538305,377,!1),this.Ef.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}V0n(b){b?
(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.$7o(b),b=this.U0.D5k(b),this.a8o(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}$7o(b){if(b){var h=new Cb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.qxj:r.contentId,h.add(b),this.U0.Cuc.add(b)}0<h.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Tb.Zb(wb.a.Xlj,2,h.toArray()))}}a8o(b){const h=new bk.a(new ng.a),r=new hb.GraphTransaction(3);
try{r.Eb(this.Kh);for(const A of b){const L=this.U0.mmc(A);L&&this.phf.YXj(L)&&(h.add(L.id),this.ODa.qVb(L,!0))}}finally{r&&r.dispose()}0<b.count&&Db.StaticActiveAppFrame.Aa().Ne();b={};b.highlightedNodeCount=h.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",H.c(b))}Axl(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.U0.Cuc.count&&(this.Tb.Zb(wb.a.vli,2,this.U0.Cuc.toArray()),this.U0.Cuc.clear());const b=this.uzl(this.U0.AW);this.tFo(b)}tFo(b){v.ULS.sendTraceTag(36509259,
377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new hb.GraphTransaction(3);try{h.Eb(this.Kh);for(const r of b){this.U0.AW.remove(r);for(const A of this.U0.e6c(r))this.ODa.qVb(A,!0)}this.U0.j7h()}finally{h&&h.dispose()}}uzl(b){const h=new bk.a(new ng.a);for(const r of b)h.add(r);return h}}Object(u.a)(tq,"ActivityIndicatorManager",null,[]);class iu{constructor(){this.Eub=this.igb=null;this.isFirstDocumentOpen=this.Qie=!1}}Object(u.a)(iu,"ActivityStateManager",null,[529]);
class Qm{constructor(b,h){this.ZAd={};this.p7b=b;this.DO=h;this.Cuc=new Cb.a}get AW(){return this.p7b.AW}bTb(b){const h=new bk.a(new ng.a);if(!b)return h;b=this.p7b.z8d(b);for(let r=0;r<b.length;r++){const A=b[r];this.ZVb(A)&&h.add(A)}return h}e6c(b){return this.p7b.e6c(b)}Y9d(b){const h=new Cb.a;if(b)for(const r of b)h.addRange(this.e6c(r));return h}D5k(b){const h=new bk.a(new ng.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const A of b.vy){h.add(A);this.AW.add(A);const L=A.toString();this.ZAd[L]||
(this.ZAd[L]=new Cb.a);this.ZAd[L].add(b)}this.j7h();return h}ZVb(b){return this.AW&&b?this.AW.contains(b):!1}F4c(b,h){if(b&&(b=this.ZAd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.K(0)}return null}mmc(b){return this.p7b.mmc(b)}j7h(){this.p7b.mxl()}g5c(b){return this.p7b.g5c(b)}aEi(b){if(!this.DO)return null;const h=this.DO.ed;return h?h.Mb(b):null}}Object(u.a)(Qm,"ChangeIdCache",null,[]);var Ik=e(533),zh=e(241);class jo extends Ik.a{constructor(){super();
this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new zh.a,{T_:jo.getTypeName(),B_:jo.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(jo,"ChangeSummariesResponse",Ik.a,[]);var ps=e(1418);class qs extends ps.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new zh.a,{T_:qs.getTypeName(),
B_:qs.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)(qs,"ChangeSummariesRequest",ps.a,[]);var ko=e(1385),La=e(892),$a=e(319),Jb=e(891);class uc{constructor(){this.Sxc=this.bpd=null}}Object(u.a)(uc,"ActionPair",null,[]);class Sc{constructor(b,h,r,A){this.S6l=L=>{L=L.customData;const ba=this.yHj(L);ba&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",
this.VOf(L)),ba.Sxc("Request timeout"))};this.WE=b;this.A_=h;this.ff=r;this.Sb=A;this.TYe=null;this.e8e=new kb.a;this.nHh=new kb.a}$mp(b){const h=Object.assign(new ko.a,{parentPath:["Signal",qs.getTypeName()],items:[Object.assign(new La.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((A,L)=>{this.e8e.W(b.requestId,Object.assign(new uc,{bpd:A,Sxc:L}))});this.nHh.W(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",
Sc.requestTimeoutMs);this.A_.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jb.a,{operation:h}));this.L4o(b.requestId);return r})}initialize(){this.TYe||(this.TYe=this.WE.Km().then(()=>{this.ff.Cb(this,jo.getTypeName())}));return this.TYe}XI(b,h){if(b&&$a.a.getTypeNameFor(b.content)===jo.getTypeName())if(b=b.content){var r=this.yHj(b.correspondingRequest);r?h!==ko.a.getTypeName()?r.Sxc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",
this.VOf(b.correspondingRequest)),r.bpd(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.VOf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}L4o(b){const h=
new Md.a(3,1,Sc.requestTimeoutMs,this.S6l,176);h.FTd=0;h.customData=b;this.Sb.pc(h)}yHj(b){if(!b)return null;let h;if(!({value:h}=this.e8e.Nc(b,h)).returnValue)return null;this.e8e.remove(b);return h}VOf(b){if(!b)return-1;let h;return({value:h}=this.nHh.Nc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return y.AFrameworkApplication.J.sc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(u.a)(Sc,"ChangeSummariesAugloopProvider",null,[365]);class nd{constructor(){this.activityGroups=
null}}Object(u.a)(nd,"FeaturedActivityGroupPayload",null,[]);class O{constructor(b,h,r,A,L){this.nRk=b;this.vuk=h;this.iwk=r;this.Uzk=A;this.UDb=L}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.Uzk.SJb.then(()=>this.Fym(b)):O.cDf}e0m(b,h,r){if(!h)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;bn("TranslateFeaturedActivityGroups");r=this.iwk.Lvp(b,h,r.wywaActivities);v.ULS.sendTraceTag(542942800,
377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.UDb.set(h.correspondingRequest,r);return Object.assign(new nd,{activityGroups:r})}Fym(b){bn("BuildFeaturedActivityGroupRequest");const h=this.nRk.mml();if(!h||!h.documentContent||!h.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
O.cDf;if(!h.documentContent.length||!h.activityChanges.length)return O.cDf;v.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);bn("SubmitFeaturedActivityGroupRequest");return this.vuk.$mp(h).then(r=>this.e0m(h,r,b))}}O.cDf=Promise.resolve(Object.assign(new nd,{activityGroups:[]}));Object(u.a)(O,"ChangeSummariesDataProvider",null,[530]);class la{constructor(b,h){this.mB=b;this.aWk=h}mml(){const b=new Cb.a,h=
new Cb.a,r=new bk.a(new ng.a);var A=this.mB.AW;if(!A||!A.count)return la.fDf;A=this.mB.Y9d(A);if(!A||!A.count)return v.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),la.fDf;for(const L of A)r.contains(L.id)||(r.add(L.id),this.ypo(L,b,h));return h.count&&b.count?Object.assign(new qs,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Jl.a(V.a.create())}):la.fDf}ypo(b,h,r){if(rd.ParagraphReader.lc(b)){var A=
rd.ParagraphReader.U5(b);if(A&&A.length){h.add(A);A=this.mB.bTb(b);A=this.n_m(A);for(const L of A){A=new Cb.a;const ba=this.getTextRanges(b,L);for(const ra of ba)A.add({changeEnd:ra.endIndex,changeSpanId:ra.qYo,changeStart:ra.startIndex,contentIndex:h.count-1,locationId:Jl.a(b.id)});(A=this.vJl(L,A.toArray()))&&r.add(A)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}n_m(b){const h=
new kb.a;for(const r of b)(b=this.rJi(r))?(h.Bb(b)||h.W(b,new bk.a(new ng.a)),h.K(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}vJl(b,h){const r=[];let A=null;for(const L of b)if(b=this.mB.F4c(L,V.a.nil)){if(!A){const ba=this.rJi(L);if(!ba||!ba.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}A=
ba}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return r.length?A?h.length?{activityId:r[0].activityId,changes:h,personId:A,timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}rJi(b){b=this.mB.F4c(b,V.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new Cb.a;if(!h||!h.count||!b)return r;let A=-1,L=new bk.a(new ng.a);for(let ba=0;ba<b.ra.length;ba++){const ra=b.ra.jc(ba);if(-1!==A&&ra.jv){if(ra.changeStart&&h.contains(ra.changeStart)){L.add(ra.changeStart);continue}r.add({startIndex:A,endIndex:ra.cp,qYo:this.aWk.QRj(L)});A=-1;L=new bk.a(new ng.a)}ra.changeStart&&h.contains(ra.changeStart)&&(A=ra.cp,L.add(ra.changeStart))}return r}}la.fDf=Object.assign(new qs,{activityChanges:[],
documentContent:[],requestId:Jl.a(V.a.nil)});Object(u.a)(la,"ChangeSummariesRequestBuilder",null,[]);class cb{constructor(){this.changes=this.content=null}}Object(u.a)(cb,"ContentChange",null,[]);class Nb{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(u.a)(Nb,"FeaturedActivityGroup",null,[]);class fc{constructor(){this.end=this.start=0}}Object(u.a)(fc,"TextRange",null,[]);class Hc{constructor(b){this.XFc=b}Lvp(b,h,r){if(!h)return v.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Hc.r4d;if(!h.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Hc.r4d;if(!h.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Hc.r4d;if(!h.inferences.length||!h.activityClassifications.length)return v.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Hc.r4d;const A=[],L=new Ma.a(new ng.a);for(const ba of h.inferences){const ra=this.Kvp(ba,b,h,r);if(!ra)continue;const Ia=this.XFc.dDm(Jl.b(ra.locationId));Ia.equals(V.a.nil)?A.push(ra):L.Bb(Ia)?L.K(Ia).ranking>ra.ranking&&L.W(Ia,ra):L.add(Ia,ra)}b=[...Array.from(L.values),...A];b.sort((ba,ra)=>ba.ranking-ra.ranking);return b.slice(0,Hc.aSn)}Kvp(b,h,r,A){if(!b||lf.a.jg(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const L=new Cb.a,ba=new kb.a;let ra=null;for(const Ta of b.activitiesInGroup){if(!Ta){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>Ta.activityIndex||Ta.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const ob=r.activityClassifications[Ta.activityIndex];if(!ob||lf.a.jg(ob.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ia=this.Adm(A,ob.activityId);if(Ia){L.add(Ia);for(const nb of Ta.changes){if(!nb){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ia=nb.value;if(0>Ia||Ia>=ob.contents.length){v.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ia=ob.contents[Ia];if(!Ia){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const Eb=h.documentContent[Ia.contentIndex],bc=Object.assign(new fc,{start:Ia.changeStart,end:Ia.changeEnd});if(ba.Bb(Eb))ba.K(Eb).add(bc);else{let Bc;ba.W(Eb,(Bc=new Cb.a,Bc.add(bc),Bc))}ra||(ra=Ia.locationId)}}else v.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!L.count)return v.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.cWm(ba);return h.count?Object.assign(new Nb,{ranking:b.ranking.value,reasons:[1],activities:L.toArray(),contentChanges:h.toArray(),locationId:ra}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}Adm(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}cWm(b){const h=new Cb.a;for(const A of b){b=A.key;const L=A.value;L.Sc((ba,ra)=>ba.start-ra.start);var r=L.K(0).start;if(r>Hc.sij){r-=Hc.sij;b=b.substring(r,b.length);for(const ba of L)ba.start-=r,ba.end-=r}h.add(Object.assign(new cb,{content:b,changes:L.toArray()}))}return h}}Hc.r4d=[];Hc.sij=10;Hc.aSn=4;Object(u.a)(Hc,"ChangeSummariesResponseTranslator",null,[]);class Qc{constructor(){this.UDb=new kb.a;this.r9e=
new kb.a}set(b,h){if(h.length&&b){this.UDb.W(b,h);for(const r of h)if(r.activities)for(const A of r.activities)A&&A.activityId?this.r9e.W(A.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.UDb.Bb(b)?this.UDb.K(b):null}OOn(b){return b&&this.r9e.Bb(b)?this.r9e.K(b):null}}Object(u.a)(Qc,"FeaturedActivityGroupCache",null,
[]);class ud{constructor(b){this.wle=(h,r,A,L,ba)=>{if(!ba)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ba.Activity;if(!h)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.UDb.OOn(h.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;A=Np.FU(h);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,this.QRj(A));return 32};this.UDb=b;this.Yfh=new Map}mc(b){b.qa(Lc.a.wle,dd.a.frame,this.wle)}QRj(b){let h=0;const r=Array(b.count);for(const A of b)b=this.CJm(A),r[h]=Jl.a(b),h++;return r.join(",")}CJm(b){let h=this.Yfh.get(b);if(h&&h!=V.a.nil)return h;h=V.a.create();this.Yfh.set(b,h);return h}}Object(u.a)(ud,"FeaturedActivityGroupTelemetryActor",
null,[]);var Xd=e(86);class $e extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(u.a)($e,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class oe{constructor(b,h,r){this.mV=null;this.Ovp=A=>{this.b8a.reset();A=this.UVm(A.customData);let L=null;for(;A.moveNext();){const ba=A.currentNode;if(ba&&(rd.ParagraphReader.lc(ba)&&this.sa.raiseEvent("OPV",new $e(ba)),this.b8a.update(),this.b8a.Txb())){L=ba;break}}L?this.eUh(L):this.mV(!0)};this.Sb=b;this.b8a=h;this.DO=r;this.sa=new Nf.a;this.SJb=new Promise(A=>
{this.mV=A})}O7k(b){this.sa.addHandler("OPV",b)}$il(){this.eUh(null)}eUh(b){const h=new Md.a(3,1,0,this.Ovp,182);h.customData=b;this.Sb.pc(h)}UVm(b){if(!b)return Xd.a.Mp(this.DO);b=te.a.kb(b);b.Ib(7);return Xd.a.$u(b,this.DO)}}Object(u.a)(oe,"DocumentTraverser",null,[]);class ea{constructor(b){this.Tb=b}shouldShowEmptyExperienceButton(){return y.AFrameworkApplication.$je()}getExplanationText(){return""}getCommandName(){return WacWordeditorStrings.FileHistory}onButtonClick(){this.Tb.Zb(wb.a.xDe,2,
null)}onInviteOthersButtonClick(){this.Tb.Zb(wb.a.wca,2,null)}}Object(u.a)(ea,"EmptyCatchUpBehaviorManager",null,[527]);class Pa{constructor(b,h){this.Phm=()=>{const r=document.getElementById("flyoutItem0");r&&(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.hr=b;this.oc=h}initialize(){const b=this.oc.te(Df.AFrame.Ugc);b.LN=!0;b.parent=Df.AFrame.rr;b.Rla(this.Phm);this.hr.vY(Df.AFrame.Ugc)}enableF6Focus(){this.hr.RM(Df.AFrame.Ugc)}disableF6Focus(){this.hr.wz(Df.AFrame.Ugc)}}
Object(u.a)(Pa,"FlyoutFocus",null,[525]);class Bb{constructor(b,h,r){this.$eh=this.Lph=this.uMc=this.RHd=!1;this.QVe=this.EAd=null;this.P8n=(A,L,ba,ra,Ia)=>{Ia[bg.a.Visible]=!0;Ia[bg.a.On]=this.uMc&&this.RHd;return 32};this.Bao=(A,L,ba)=>{if(1===ba)return this.RHd?(this.Lph||(this.Lph=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.EAd)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.$eh=!0;this.EAd();return 32};this.ga=b;this.Qnh=h;this.oc=r}get zHf(){return this.QVe?this.QVe:(v.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set zHf(b){this.QVe=b}initialize(){this.mc()}registerButtonClickedEvent(b){this.EAd&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.EAd=b.buttonClickedCallback}onFlyoutInitialized(){this.RHd&&v.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.zHf.getTime();v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.RHd=!0;$d.c(wb.a.ctl,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.uMc!==b.flyoutIsVisible&&(this.uMc=b.flyoutIsVisible,Db.StaticActiveAppFrame.Aa()&&Db.StaticActiveAppFrame.Aa().Ne(!0),this.uMc&&this.$eh&&this.oc.Rg(Df.AFrame.Ugc),this.uMc||this.Qnh&&this.Qnh.nKn())}logFlightTriggers(b){b.hasFlyoutData&&
y.AFrameworkApplication.ud("WoCha187;WoCha187cf")}mc(){this.ga.qa(wb.a.T6j,dd.a.frame,this.Bao);this.ga.nb(wb.a.nDj,dd.a.frame,this.P8n,96)}}Object(u.a)(Bb,"FlyoutRibbonButton",null,[526]);var ac=e(159);class Gc{constructor(b,h){this.AW=null;this.qge=this.K5i=!1;this.U0=b;this.Ef=h;this.pvb=new ac.a;this.Rfe=new Map;this.pvb.W(1,new bk.a(new ng.a));this.pvb.W(0,new bk.a(new ng.a));this.pvb.W(2,new bk.a(new ng.a));this.pvb.W(3,new bk.a(new ng.a));this.Rfe.set(3,"CatchUpIndicatorVisible");this.Rfe.set(1,
"CatchUpIndicatorPreviewed");this.Rfe.set(2,"CatchUpIndicatorSelected");this.bye=0}Rej(b,h){if(this.pvb.K(h).add(b)){this.YLn(h);switch(h){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.o6h()}}e8n(b){this.f8l();
b=this.U0.bTb(b);for(const h of b)if(this.AW.remove(h)){this.bye++;break}}f8l(){if(!this.AW){this.AW=new bk.a(new ng.a);for(const b of this.U0.AW)this.AW.add(b)}}dal(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.bye);this.o6h()}o6h(){this.bye&&(this.pvl(),this.avl())}pvl(){!this.K5i&&.5<=this.pvb.K(0).count/this.bye&&(this.K5i=!0,$d.c(wb.a.etl),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}avl(){if(!this.qge){var b="";1<=this.pvb.K(1).count&&
(this.qge=!0,b="previews");1<=this.pvb.K(2).count&&(this.qge=!0,b="selections");this.qge&&($d.c(wb.a.Xsl),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}YLn(b){(b=this.Rfe.get(b))&&this.Ef.logKpiUsage(b,0)}}Object(u.a)(Gc,"IndicatorTelemetryActor",null,[]);var ld=e(728);e(1080);class Gd{constructor(b,h){this.esd=b;this.OXc=h}OXm(){return this.OXc.promise.then(b=>b.getWywaActivitiesResponse)}KJf(b,h){return ld.b(this.esd.requestActivities(b,h))}pQf(b,h){return this.OXc.promise.then(r=>
r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):ld.b(this.esd.requestRelevantActivities(b,h)))}updateActivityState(b){return ld.b(this.esd.updateActivityState(b))}LJf(){return this.OXc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):ld.b(this.esd.requestActivityFeed()))}Nwd(){return ld.b(this.esd.eNo())}}Object(u.a)(Gd,"ActivityRepository",null,[]);var ue=e(1081),Ce=e(580);class tf{constructor(b){this.qk=b}get N5(){return this.qk&&
this.qk.Aj?this.qk:null}H1b(b,h){return this.N5?this.N5.pqf(b,!0)?this.N5.H1b(b,h,!0,!0,!1,!1,Ce.a.Wsl):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(u.a)(tf,"PageViewWrapper",null,[]);class Zg{constructor(b,h,r,A,L,ba=!1){this.activityContentManager=b;this.Tb=h;this.Y2l=r;this.Ef=A;this.Ibn=L;this.brc=ba}x$f(b){const h=new Map;h.set("activityType",b.type.toString());this.Ef.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}M9f(b){this.Ef.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}wXn(b){try{const h=b.activity;this.x$f(b.activity);1==h.type&&this.Ibn.Yle();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.kyp(h),this.M9f("Content does not exist"),Promise.resolve(2);const r={};let A=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);A=this.Tb.Zb(wb.a.htf,2,r);break;
case 1:r.Activity=h,r.NodeId=b.locationId,A=this.Tb.Zb(Lc.a.UGg,2,r),r.NodeId&&this.Tb.Zb(Lc.a.wle,2,r)}8==A&&this.M9f("Action failed")}catch(h){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.M9f("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.Y2l.SJb.then(()=>this.wXn(b))}}Object(u.a)(Zg,"WordActivityNavigationManager",null,[483]);var Xi;(function(b){b[b.default=0]="default";b[b.wUp=
1]="D48X48";b[b.zUp=2]="D64X64";b[b.AUp=3]="D96X96";b[b.sUp=4]="D120X120";b[b.tUp=5]="D240X240";b[b.uUp=6]="D360X360";b[b.vUp=7]="D432X432";b[b.xUp=8]="D504X504";b[b.yUp=9]="D648X648"})(Xi||(Xi={}));Object(u.b)("ProfilePhotoDimension",Xi);var ph=e(807),Dh=e(1366);class qk{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(u.a)(qk,"ActivityFeedEntry",null,[]);const Wn=(b,h)=>h.Cdd?Mm.toArray(Mm.select(Mm.asEnumerable(b),
r=>{if(!r||!r.activityFeedItemPayload)return r;const A=JSON.parse(r.activityFeedItemPayload);var L=A.actor;if(!L||L.pictureUrl)return r;const ba=L.userPrincipalName||L.email;if(!ba)return r;L=h.APb(ba,L.provider,y.AFrameworkApplication.lm,0);if(!L)return r;A.actor.pictureUrl=L;return Object.assign(new qk,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(A),timestamp:r.timestamp})})):b,wn=(b,h)=>{const r=new Map,A=new Map;for(const L of b){if(!L||
!L.activityFeedItemPayload)continue;b=JSON.parse(L.activityFeedItemPayload).actor;if(!b)continue;const ba=b.email||b.userPrincipalName;ba&&!A.has(ba)&&A.set(ba,new ph.a(ba,null,b.name))}A.forEach(L=>{const ba=h.Knc(L,6);r.set(L.UserId,ba)});return r};var hr=e(381);class Ss{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(u.a)(Ss,"ActivityRequestPayload",null,[]);class ev{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(u.a)(ev,"Person",null,[]);class Sv extends go{constructor(){super();this.relationship=0}}Object(u.a)(Sv,"TaskActivity",go,[]);class mt extends go{constructor(){super();this.contentId=null}}Object(u.a)(mt,"CommentActivity",go,[]);class Tv extends mt{constructor(){super()}}Object(u.a)(Tv,"CommentReplyActivity",mt,[]);class rs extends mt{constructor(){super();this.qxj=null}}Object(u.a)(rs,"MentionActivity",mt,[]);class fv{constructor(b,
h,r,A){this.VDb=b;this.uUa=h;this.KQc=r;this.vS=A;this.vS.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.VDb.OXm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Hwf("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.vS.isFirstDocumentOpen=!0);const h=this.xNg(b.People);return Object.assign(new Ss,{activities:this.$Ge(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.VDb.KJf(b,h).then(r=>{if(!r||r.StatusCode)throw this.Hwf("GetActivities",r);const A=this.xNg(r.People);return Object.assign(new Ss,{activities:this.$Ge(r.Activities,A),actors:A,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.VDb.pQf(b,this.vS.isFirstDocumentOpen).then(h=>{if(!h||
h.StatusCode)throw this.Hwf("GetRelevantActivities",h);const r=this.xNg(h.People),A=this.$Ge(h.NewActivities,r,2);h=this.$Ge(h.OutstandingActivities,r,3);for(const L of h)A.push(L);return Object.assign(new Ss,{activities:A,actors:r})})}updateActivityState(b){return this.VDb.updateActivityState(b)}requestActivityFeed(){return this.VDb.LJf().then(b=>({activityFeedItems:this.Afn(b),personaColorMap:this.Enl(b)}))}$Ge(b,h,r=1){const A=[];if(!b)return A;for(const ra of b){var L=null;b=[];b.push(h[ra.CreatorIndex]);
switch(ra.ActivityType){case 1:L=ra;var ba=new Np;ba.vy=new Cb.a;for(const Ia of L.ChangeIds)ba.vy.add(Jl.b(Ia));ba.objectId=Jl.b(L.ObjectId);L=ba;break;case 2:L=ra;ba=new mt;ba.contentId=L.ContentId;ba.navigationId=L.NavigationId;L=ba;break;case 4:L=ra;ba=new rs;b.push(h[L.MentioneeIndex]);ba.qxj=L.ParentContentId;ba.navigationId=L.NavigationId;L=ba;break;case 3:case 10:L=ra;ba=new Tv;b.push(h[L.RepliedIndex]);ba.contentId=L.ContentId;ba.navigationId=L.NavigationId;L=ba;break;case 6:case 7:case 8:case 9:L=
ra,ba=new Sv,b.push(h[L.MentioneeIndex]),ba.navigationId=L.NavigationId,ba.relationship=L.Relationship,L=ba}L&&(L.actors=b,L.displayTimestamp=new Date(ra.DisplayTimestamp),L.activityId=Jl.b(ra.ActivityId).toString(),L.type=ra.ActivityType,1!==r&&(L.relevancy=r),A.push(L))}return A}GPo(b,h,r){return this.KQc&&this.KQc.Cdd?this.KQc.APb(h,r,y.AFrameworkApplication.lm,Xi.default):b}xNg(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const A=new ev;A.id=b[r].Id;
A.provider=b[r].Provider;A.displayName=b[r].DisplayName;A.email=b[r].Email;A.imageUrl=this.GPo(b[r].PictureUrl,b[r].Email,b[r].Provider);this.uUa&&(A.color=this.uUa.Knc(new ph.a(A.email,void 0,A.displayName),Dh.a.btl));h[r]=A}return h}Hwf(b,h){let r="null";h&&(r=hr.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}Afn(b){return this.KQc?Wn(b,this.KQc):b}Enl(b){return this.uUa?wn(b,this.uUa):new Map}}Object(u.a)(fv,"WordActivityRequestManager",null,[482]);
class nt{constructor(b,h,r){this.MKd=0;this.WQc=!1;this.qxh=null;this.Nwd=()=>{if(Ze.a.FZ)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.WQc||3>=this.MKd){this.WQc?this.WQc=!1:this.MKd++;const A=Math.max(this.za.sc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.qxh),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",A);Fj.Task.delay(A).continueWith(()=>{this.VDb.Nwd().then(()=>{this.Bze();
return null}).catch(()=>{this.Bze();this.WQc=!0;this.MKd=0})})}else this.Bze()};this.za=b;this.VDb=r;h.YUd(()=>{this.WQc=!0;this.qxh=new Date;this.MKd=0})}start(){this.Bze()}Bze(){window.setTimeout(this.Nwd,6E4)}}Object(u.a)(nt,"WordEditorActivityScheduler",null,[]);class ir{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}FZo(b){this.resolve(b)}}Object(u.a)(ir,"CatchUpNetworkRequestWorkerCache",null,[]);class Jg{constructor(b,h,r){this.$Sl=b;this.J=h;this.Ef=r}ulg(b){b&&
b.authors&&this.SLn(b.authors)}SLn(b){for(const h of b)h&&h.displayName===this.$Sl&&(this.Ef.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.J.rb("PresenceUserId"),h.email===this.J.rb("UserPrincipalName")))}}Object(u.a)(Jg,"WywaAuthorComparator",null,[]);class Pl{constructor(b){this.vE=
b}Yle(){this.vE&&this.vE.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(u.a)(Pl,"IndicatorSurveyActor",null,[]);var Ln=e(1054),Xo=e(1047);class Vk{constructor(){}shouldShowDisplayChangesCheckbox(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayRecentChangesEnabled",!1)}shouldDisplayChangesBeInitiallyChecked(){return Promise.resolve(!0)}toggleShowingChanges(){return Promise.resolve(!0)}}Object(u.a)(Vk,"WordRecentChangesManager",
null,[475]);class Do{constructor(){this.ftl={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get Zsl(){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")}get F1i(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get W0i(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get rge(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get rBn(){return y.AFrameworkApplication.J.$("IsUserFromDifferentTenant")}get brc(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}Ec(b){bn("Configure");this.container=b;b.ja("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new ir).ha()}init(){bn("Init");this.Zsl&&(F.a.instance.registerOnPackageInit("WordEditor.Workers",
()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,y.AFrameworkApplication.rootQuerySignature,Ze.a.webServiceBase+"OneNote.ashx",Nm.a.word,this.rge)}),bn("HotStore"),Ze.a.Hea.Xbb.execute(()=>{bn("ChromeReady");Fk.a.get_instance().Zk(7,()=>{bn("ScriptDownload");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,
377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.B2n()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}B2n(){bn("CreateObjectsAndInitializeState");this.iLn();this.JJl();return this.Mdn()}iLn(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,
3012,50,"Tasks and outstanding data is enabled");this.F1i&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.W0i&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.rBn);this.rge&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Mdn(){this.ten();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").zHf=new Date;bn("InitializeCatchUpApp");return this.Tgc.initialize(Object.assign(new lt,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.F1i,customDynamicEntryPointEnabled:this.W0i,activityFeedDataEnabled:this.rge})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}JJl(){this.container.ja("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Qm(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Pk.a.Xm.tb.Xc.Fd)).ha();this.container.ja("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Ln.a(Ca.Health.instance,new Xo.a,this.ftl)).ha();this.container.ja("WordEditor.CatchUpActivity.IActivityStateManager",()=>new iu).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityContentManager",()=>new jp(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),y.AFrameworkApplication.va,Tk.UISurfaces.tN(),this.brc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ja("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new Gd(new ue.a(Kb.a.O6j(this.container.Za("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),
()=>y.AFrameworkApplication.rootQuerySignature,Ze.a.webServiceBase+"OneNote.ashx",Nm.a.word,Kb.a.O6j(this.container.Za("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();this.container.ja("Common.App.CatchUpActivity.IActivityRequestManager",()=>new fv(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),
this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.brc)).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Kq(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),Pk.a.Xm.tb.Xc,new tf(Pk.a.Xm.tb.Xc),Fg.a.instance,Jc.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();
this.container.ja("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Qs.a(50,ed.a.We):new Rs;return new oe(y.AFrameworkApplication.zc,b,Pk.a.Xm.tb.Xc.Fd)}).ha();this.container.ja("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Pl(this.container.Za("Common.ISystemInitiatedFeedback"))).ha();this.container.ja("Common.App.CatchUpActivity.IActivityNavigationManager",
()=>new Zg(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),y.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.brc)).ha();this.container.ja("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Bb(y.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),
Jc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ja("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Pa(sq.a.instance,Jc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();this.container.ja("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Qc).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new co(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
Pk.a.Xm.tb.Xc)).ha();this.container.ja("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new ud(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();this.container.ja("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new O(new la(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Sc(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),y.AFrameworkApplication.zc),new Hc(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.brc)).ha();this.container.ja("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new ea(y.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();
this.container.ja("WordEditor.CatchUpActivity.RecentChangesManager",()=>new Vk).as("Common.App.CatchUpActivity.IRecentChangesManager").ha();this.Tgc=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new dn,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
appColorUpdateIsEnabled:y.AFrameworkApplication.J.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:y.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.rge?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),
uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new Ak.a,recentChangesManager:this.container.resolve("Common.App.CatchUpActivity.IRecentChangesManager")}));this.Tgc.setWebpackPublicPath(y.AFrameworkApplication.G$);this.container.ja("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new os(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();this.container.ja("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new nt(y.AFrameworkApplication.J,It.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ja("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Gc(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new vo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.Tgc.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Pk.a.Xm.tb.Xc,this.container.Za("Common.IZoomManager"),y.AFrameworkApplication.zc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Ze.a.instance&&Ze.a.instance.jEa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityIndicatorManager",
()=>new tq(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Pk.a.Xm.tb.Xc.Fd,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),y.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ja("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new pk(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("Common.Utils.IAriaNotifier"),y.AFrameworkApplication.va,Jc.FocusManager.instance())).ha();this.container.ja("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Jg(y.AFrameworkApplication.userName,y.AFrameworkApplication.J,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}ten(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.xfb(h);const r=
this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const A=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const L=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ba=Fg.a.instance,ra=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ba.BD(()=>
{L.Qie?L.Qie=!1:(L.igb&&r.Jtj(null,null,!1),L.Eub&&r.Dsj(null,null),A.Orf())});ba.BD(Object(E.a)(h,h.sR,"onSelectionChanged"));this.Tgc.getWywaEvent().addListener(Object(E.a)(b,b.ulg,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.Tgc.getWywaEvent().addListener(Object(E.a)(b,b.ulg,"onWywaActivityReady"));const Ia=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");ra.O7k((Ta,ob)=>{ob&&Ia.e8n(ob.node)});ra.SJb.then(()=>
{Ia.dal()});this.Tgc.getWywaEvent().addListener(()=>{ra.$il()});A.k6k((Ta,ob)=>{ob&&r.Dsj(ob.BRb,ob.$Vi)});A.l6k((Ta,ob)=>{ob&&r.Jtj(ob.BRb,ob.$Vi,ob.$ap)});A.mc(y.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.Dfp()}Dfp(){mh.c()&&(v.ULS.sendTraceTag(591673372,3012,
50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(u.a)(Do,"WordEditorCatchUpActivityPackageManager",null,[0,1]);var en=e(190),eq=e(893),Uv=e(1405),Bz=e(1490),Tr=e(1582),Jt=e(1417),Cz=e(1691),TA=e(1692),UA=e(645),Dz=e(1693),lx=e(896),Kt=e(149),yr=e(1427);class ry{constructor(){this.operationType=this.annotation=null}}Object(u.a)(ry,"AnnotationChangedData",null,[]);class sy{constructor(b,
h,r,A,L,ba,ra,Ia=!1,Ta){this.annotationType=b;this.ax=h;this.Eq=r;this.E3b=A;this.gxd=L;this.TKp=ba;this.tb=ra;this.WXj=Ia;this.J=Ta;this.gB=null;this.P5i=!1;this.vd=new Nf.a;this.zhd=0}IJ(b){this.vd.addHandler("AnnotationChangedEvent",b)}iM(b){this.vd.removeHandler("AnnotationChangedEvent",b)}register(){return this.gxd().then(()=>{0===this.zhd&&(this.WXj&&(this.gB=this.Eq.rg("WebServiceCall",this.annotationType)),this.ax.Cb(this,this.annotationType));this.zhd++})}unregister(){return this.gxd().then(()=>
(new Promise(b=>setTimeout(b,this.J.sc(Kt.a.AYl,3E3)))).then(()=>{0<this.zhd&&(this.zhd--,0===this.zhd&&this.ax.Gc(this,this.annotationType))}))}getAnnotations(){return this.gxd().then(()=>this.ax.getAnnotationsByType(this.annotationType))}tyi(b){b=eq.a.QI(b);return(b=this.ax.i8d(b))&&0<b.count?b.toArray().filter(h=>$a.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.TKp(this.tb.rd.Hd,b.parentPath):null:(v.ULS.shipAssertTag(575930380,
3016,!1),null)}GCa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new lx.a,{parentPath:["Signal",$a.a.getTypeNameFor(b)],items:[Object.assign(new La.a,{body:b})]});this.E3b.submitOperation(b)}R5l(b,h){b=Object.assign(new ko.a,{parentPath:["Signal",h],items:b});this.E3b.submitOperation(b)}XI(b,h){b?h?(this.WXj&&!this.P5i&&(this.gB.stop(),this.P5i=!0),this.vd.Cha&&(b=new yr.a(Object.assign(new ry,{annotation:b,operationType:h})),this.vd.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,
3016,!1):v.ULS.shipAssertTag(575930381,3016,!1)}}Object(u.a)(sy,"AnnotationManager",null,[553,365]);class ol{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.gN=b;this.cze=h;this.URb=r;this.jab=A;this.pca=L;this.d6j=ba;this.x6=ra;this.f4b=Ia;this.yjc=Ta;this.I_b=ob;this.Qpp=nb}}Object(u.a)(ol,"AnnotationManagerHolder",null,[552]);class xn{constructor(b,h){this.Vla=b;this.gxd=h}submitOperation(b){return this.gxd().then(()=>{this.Vla.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jb.a,{operation:b}))})}}
Object(u.a)(xn,"SubmitOperationHelper",null,[]);var mx=e(1078),Vv=e(1694),Nu=e(1583),nf=e(42),wm=e(117),kp=e(80),ss=e(1096);class ju{constructor(b,h,r){this.pca=b;this.Wn=h;this.Heb=r;this.NLa={};this.smi=!1;this.ryb=(A,L)=>{var ba;L.data.operationType!==ko.a.getTypeName()&&L.data.operationType!==ss.o.getTypeName()||!L.data.annotation||L.data.annotation.annotationType!==Vv.a.getTypeName()||(A=L.data.annotation.content)&&null!==(ba=A.documentTypeConfidences)&&void 0!==ba&&ba.length&&(this.rmi=A.documentTypeConfidences[0].documentTypeLabel,
v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.rmi))};this.pca.IJ(this.ryb);this.pca.register();this.NLa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}m$d(){this.smi||(this.pca.GCa(new Nu.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.smi=!0);this.sBf();this.NLa.docType=this.rmi;this.NLa.characterCount=
this.characterCount;this.NLa.paragraphCount=this.KW;this.NLa.imageCount=this.xN;this.NLa.tableCount=this.Cea;this.NLa.listElementsCount=this.sbj;this.NLa.blobsCount=this.NWc;this.NLa.pageCount=this.Heb.getTotalPageCount();this.NLa.currentPage=this.Heb.HIi();return this.NLa}sBf(){this.KW=this.NWc=this.sbj=this.Cea=this.xN=this.characterCount=0;var b=this.Wn.Gua(Pk.a.Xm.tb.Xc.Fd,7,7).currentNode,h=te.a.kb(b);for(b=Xd.a.$u(h,b);b.moveNext();)if(h=b.currentNode)if(pe.a.nr(h))this.xN++;else if(Qh.TableReader.pP(h))this.Cea++;
else if(nf.a.Wg(h))this.sbj++;else if(rd.ParagraphReader.lc(h)){var r=kp.e(h);for(let A=0;A<r.length;A++)5===r[A].xi?this.xN++:this.NWc++;r=wm.AParagraphNode.DR(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!rd.ParagraphReader.AZ(h)&&!rd.ParagraphReader.zZ(h)&&this.KW++}}}Object(u.a)(ju,"LoggingDocumentInfo",null,[473]);class Wv{constructor(){this.sa=new Nf.a}m8k(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}hJo(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}e7k(b){this.sa.addHandler("BlueDotClickedEvent",b)}NIo(b){this.sa.removeHandler("BlueDotClickedEvent",b)}t7k(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}v7k(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}s7k(b){this.sa.addHandler("OnFormattingAccept",b)}u7k(b){this.sa.addHandler("OnFormattingReject",b)}$7k(b){this.sa.addHandler("OnReviewInvalidated",b)}hVh(b){this.sa.addHandler("OnTraigeAction",b)}wjf(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}aJo(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}b7k(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}W7k(b){this.sa.addHandler("OnRegisterEnhancement",b)}p8k(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}iJo(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}Fmd(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new yr.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}Auo(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new yr.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}Duo(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new yr.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}PDj(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new yr.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}Cuo(b){b?this.sa.raiseEvent("OnFormattingAccept",new yr.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}Euo(b){b?this.sa.raiseEvent("OnFormattingReject",new yr.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}Fuo(b){b?this.sa.raiseEvent("OnReviewInvalidated",new yr.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}ftg(b){b?this.sa.raiseEvent("OnTraigeAction",
new yr.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}QDj(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new yr.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}zuo(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new yr.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}Dxc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new yr.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}fEj(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new yr.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(u.a)(Wv,"ReviewEvents",
null,[472]);class Rm{constructor(b){this.LA=b;if(!b)throw en.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}Ec(b){this.Z=b;b.ja("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new xn(this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),eq.a.Km)).ha();b.ja("WordEditor.Designer.IDesignerControl",()=>new mx.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.uiCulture)).ha();b.ja("WordEditor.Designer.Common.Review.IReviewEvents",
()=>new Wv).ha();b.ja("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new ol(this.dLa(Jt.DocumentRoleDetectionAnnotation.getTypeName()),this.dLa(Jt.RoleDetectionAnnotation.getTypeName()),this.dLa(Uv.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.dLa(Uv.FormattingSuggestionsAnnotation.getTypeName()),this.dLa(Bz.DocumentTypeClassifierAnnotation.getTypeName()),this.dLa(TA.ThemeExtractorAnnotation.getTypeName()),this.dLa(UA.ThemeGeneratorAnnotation.getTypeName()),this.dLa(Cz.TextToImageAnnotation.getTypeName()),
this.dLa(Tr.DocumentPullQuoteAnnotation.getTypeName()),this.dLa(Tr.PullQuoteAnnotation.getTypeName()),this.dLa(Dz.TableTypeAnnotation.getTypeName()))).ha();b.ja("WordEditor.Designer.DocumentInfo",()=>new ju(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pca,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}dLa(b,h=!1){return new sy(b,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),eq.a.Km,eq.a.cbb,this.LA,h,this.Z.resolve("Common.IAppSettingsManager"))}}Object(u.a)(Rm,"PackageManager",null,[0,1]);var Xv=e(1424),fq=e(1401),ku=e(1695);class ty extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.yfg=h}}Object(u.a)(ty,"RoleChangeArgs",Sys.EventArgs,[]);class ot{constructor(b){this.Bi=!1;this.oba=b;this.oba.pHd++}dispose(){this.Bi||(this.Bi=!0,this.oba.pHd--)}}Object(u.a)(ot,"InvalidationSuspension",
null,[11]);class ts{constructor(){this.iud=null;this.role=this.vne=0;this.kNb=this.Zie=this.joa=this.Yrc=!1;this.Eme=this.Rfd=this.LXa=null;this.B1a=this.placeholder=!1;this.UVd=this.yxf=null;this.TVd=0}get Acb(){return!this.role||!this.LXa||!this.LXa.length}Sjn(){this.kNb=this.Zie=!0}FBn(){return!!this.role||!!this.LXa||!!this.iud}}Object(u.a)(ts,"RoleState",null,[499]);class zr{constructor(b,h,r,A,L){this.vi=!1;this.age=null;this.Bag=new de.a;this.Dqh=0;this.YQo=(ba,ra)=>{ra.data.operationType===
ko.a.getTypeName()&&(ra=ra.data.annotation,(ba=ra.content)?(ra=this.jcc.getParent(ra))&&this.prd(ra,fq.f(ba.roleType),!1,void 0,null!=ba.listID?ba.listID:0,ba.listItemlevel,ba.listItemPrefix):v.ULS.shipAssertTag(575813856,3016,!1))};this.K2l=(ba,ra)=>{if(ra.data.operationType===ko.a.getTypeName())if(ba=ra.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,ba.confidence.toString()),this.Bag=new de.a,ra=0;ba.listInfos&&ra<ba.listInfos.length;ra++){const Ia=ba.listInfos[ra];this.Bag.W(Ia.listID,
Ia)}else v.ULS.shipAssertTag(556323522,3016,!1)};this.w4i=(ba,ra)=>{ba=ba.ZR;if(!ba||ba.ka(Rc.a.aF,!1))return!1;ba=ba.getValue(Rc.a.na);if(!ba)return!1;ba=fq.g(ba);return 1!=ba&&ba!=ra.role};this.Gjm=(ba,ra)=>{ba=ra.data.annotation;const Ia=this.hFd.getParent(ba);if(Ia)if(ra.data.operationType===ko.a.getTypeName()){const Ta=ra.data.annotation.content;Ta?this.sja(Ia,ob=>{this.age&&ob.yxf&&this.age>ob.yxf&&!ob.kNb||ob.role!==ob.vne||this.w4i(Ia,ob)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.age,ob.kNb,ob.role===ob.vne),ob.iud=Ta.suggestions):(ob.LXa=Ta.suggestions,ob.kNb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else ra.data.operationType===Xv.a.getTypeName()&&this.sja(Ia,Ta=>{Ta.LXa=null;Ta.iud=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ba.id} parentPath: ${ba.parentPath}`)};this.d5n=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.sja(ba,Ia=>{ra.data.tfk?(Ia.UVd=Ia.LXa,Ia.TVd=Ia.role):(Ia.UVd=null,Ia.TVd=0);Ia.joa=!0}):v.ULS.shipAssertTag(575930368,
3016,!1)};this.f5n=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.sja(ba,Ia=>{Ia.joa=!1;Ia.UVd=null;Ia.TVd=0;5!==ra.data.state&&(Ia.LXa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.b5n=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.sja(ba,Ia=>{Ia.joa=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.e5n=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.prd(ba,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.glg=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.prd(ba,ra.data.yfg,!0,!0):v.ULS.shipAssertTag(575484484,
3016,!1)};this.LZm=(ba,ra)=>{if(ra.node){var Ia=ra.node;ba=this.YD(Ia);27==ba.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ba.joa&&27!==ba.role&&28!==ba.role&&this.QWj(this.r1b-1);ba.Acb||27===ba.role||28===ba.role||this.JWj(this.inconsistenciesCount-1);this.sja(Ia,Ta=>{Ta.B1a=!0});setTimeout(()=>this.removeNode(Ia),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ba=>{let ra;({value:ra}=this.Uw.Nc(ba.id));(null===ra||void 0===ra?0:ra.B1a)&&this.Uw.remove(ba.id)};
this.KZm=(ba,ra)=>{ra.node?(ba=ra.node,this.p3f(ba)?this.sja(ba,Ia=>{Ia.B1a=!1}):this.sja(ba,Ia=>{Ia.kNb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.MZm=(ba,ra)=>{ra.node?this.CFg(ra.property,ra.node)&&(ba=ra.node,this.pHd||ba.que?this.sja(ba,Ia=>{Ia.kNb=!1}):this.sja(ba,Ia=>{Ia.Sjn();Ia.iud&&(Ia.LXa=Ia.iud,Ia.role=Ia.vne)}).joa&&this.i7a.Fuo(new ku.a(ra.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.f9n=(ba,ra)=>{switch(ra.data.role){case 27:const Ia=ra.data;this.sja(ra.data.paragraphNode,
ob=>{ob.role=27;ob.Yrc=!0;ob.placeholder=Ia.placeholder});break;case 28:const Ta=ra.data;this.sja(ra.data.paragraphNode,ob=>{ob.role=28;ob.Yrc=!0;ob.placeholder=Ta.placeholder;ob.N9c=Ta.N9c});break;case 2:this.sja(ra.data.paragraphNode,ob=>{ob.role=2})}};this.hFd=b;this.jcc=h;this.FTe=r;this.Rt=A;this.i7a=L;this.Uw=new de.a;this.sa=new Nf.a;this.pHd=this.EOd=this.TGd=0}get nkn(){return this.pHd}x7k(b){this.sa.addHandler(zr.Rqj,b)}d8k(b){this.sa.addHandler(zr.ptj,b)}c8k(b){this.sa.addHandler(zr.otj,
b)}get inconsistenciesCount(){return this.TGd}JWj(b){this.TGd!==b&&(this.TGd=b,this.sa.raiseEvent(zr.Rqj,new yr.a(this.TGd)))}get r1b(){return this.EOd}QWj(b){this.EOd!==b&&(this.EOd=b,this.sa.raiseEvent(zr.ptj,new yr.a(this.EOd)))}get qWf(){return this.Dqh}p3f(b){return this.Uw.Bb(b.id)}fGm(b){var h,r;return null===(r=null===(h=this.Bag)||void 0===h?void 0:h.Nc(b))||void 0===r?void 0:r.value}$Ii(b,h){var r,A,L;const ba=new Map;for(const ra of h)if(h=ra){const Ia=null!==(L=null===(A=null===(r=this.Uw.Nc(h.id))||
void 0===r?void 0:r.value)||void 0===A?void 0:A.role)&&void 0!==L?L:1;b.has(Ia)&&(ba.has(Ia)?ba.get(Ia).add(h):ba.set(Ia,new Cb.a([h])))}return ba}YD(b){if(!b)return v.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Uw.Nc(b.id)).returnValue?h:Object.assign(new ts,{role:1,Yrc:!1})}QMo(){this.age=new Date;return new ot(this)}register(){this.hFd.register();this.jcc.register();this.FTe.register()}unregister(){this.hFd.unregister();this.jcc.unregister();this.FTe.unregister()}initialize(){if(!this.vi){const b=
this.Rt.Hf(12);b.bA(this.LZm);b.wv(this.KZm);b.yq(this.MZm);this.hFd.IJ(this.Gjm);this.jcc.IJ(this.YQo);this.FTe.IJ(this.K2l);this.i7a.u7k(this.e5n);this.i7a.s7k(this.b5n);this.i7a.t7k(this.d5n);this.i7a.v7k(this.f5n);this.i7a.hVh(this.glg);this.i7a.W7k(this.f9n);this.vi=!0}}he(){}prd(b,h,r,A=!1,L=0,ba=0,ra){let Ia=0,Ta=!1;this.sja(b,ob=>{const nb=ob.Zie||!ob.role||1==ob.role;r||(ob.vne=h);if(A||nb)Ta=ob.role!==h,Ia=ob.role,ob.role=h,ob.Yrc=r,ob.Zie=!1,ob.Rfd=L,ob.Eme=ba,ob.listItemPrefix=ra,ob.yxf=
new Date});if(Ta){const ob=h-4;ob>this.qWf&&8>ob&&(this.Dqh=ob);1===h&&this.sja(b,nb=>{nb.LXa=null});this.sa.raiseEvent(zr.otj,new yr.a(new ty(b,h,Ia)))}}sja(b,h){let r;if(({value:r}=this.Uw.Nc(b.id)).returnValue){b=r.Acb;const A=r.joa;h(r);if(27!==r.role&&28!==r.role){if(r.B1a)return r;b!==r.Acb&&this.JWj(this.inconsistenciesCount+(b?1:-1));A!==r.joa&&this.QWj(this.r1b+(A?-1:1))}}else h(r=new ts),r.FBn()&&this.Uw.add(b.id,r);return r}CFg(b,h){({value:h}=this.Uw.Nc(h.id));return 28===(null===h||void 0===
h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Sb.a.so:!(null===h||void 0===h?0:h.placeholder)&&(b===Sb.a.so||b===Sb.a.Qq||Array.contains(wm.AParagraphNode.yha(),b))}}zr.Rqj="OnInconsistenciesChanged";zr.ptj="OnRoleReviewCount";zr.otj="OnRoleChanged";Object(u.a)(zr,"RoleLifecycleManager",null,[477,478,479]);class uy{constructor(b,h,r,A,L){this.i7a=b;this.jcc=h;this.ff=r;this.Rt=A;this.oba=L;this.vi=!1;this.glg=(ba,ra)=>{(ba=ra.data.paragraphNode)?this.Fbk(ba,()=>!0,Ia=>Ia.userSetRole=
fq.e(ra.data.yfg)):v.ULS.shipAssertTag(557057378,3016,!1)};this.$7n=(ba,ra)=>{0<this.oba.nkn||this.CFg(ra.property)&&this.Fbk(ra.node,Ia=>!(Ia&&Ia.isInvalidated),Ia=>Ia.isInvalidated=!0)}}initialize(){this.vi||(this.i7a.hVh(this.glg),this.Rt.Hf(12).yq(this.$7n),this.vi=!0)}he(){}Fbk(b,h,r){if(b=(b=this.jcc.tyi(b))&&1===b.length&&b[0]){var A=b.content;A=A&&A.M_&&A.M_.customMetadata;h(A)&&(h=new Jt.RoleDetectionCustomMetadata,h.isInvalidated=A&&A.isInvalidated,h.userSetRole=A&&A.userSetRole,r(h),this.ff.lCp(b,
h))}}CFg(b){return b===Sb.a.so||b===Sb.a.Qq||Array.contains(wm.AParagraphNode.yha(),b)}}Object(u.a)(uy,"RoleDetectionMetadataUpdater",null,[476]);class lo{constructor(b,h){this.E3b=b;this.sQb=h;this.Zhd=(r,A)=>{r=A.data;if(r.operationType==ss.a.getTypeName()||r.operationType==ss.o.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.sQb.IJ(this.Zhd)}he(){this.sQb.iM(this.Zhd)}L1n(){if(void 0===this.runId)Promise.resolve();else{var b=new Jt.RoleDetectionSettings({acceptedRunId:this.runId});
b=new ss.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.E3b.submitOperation(b)}}}Object(u.a)(lo,"RoleDetectionSettingsUpdater",null,[]);class nx{constructor(b,h,r){this.Uin=b;this.ax=h;this.oe=r;this.uYi=this.initialized=!1;this.Doj=()=>{this.yYj()&&(this.SWi(),this.ax.EIo(this.Doj))}}initialize(){this.initialized||(this.CYf(),this.initialized=!0)}he(){}CYf(){this.yYj()?this.SWi():this.ax.Q6k(this.Doj)}yYj(){return!this.uYi&&
(this.oe.l1i()||this.ax.Mpc(Jt.DocumentRoleDetectionAnnotation.getTypeName())||this.ax.Mpc(Jt.RoleDetectionAnnotation.getTypeName()))}SWi(){for(const b of this.Uin)b.initialize();this.uYi=!0}}Object(u.a)(nx,"RLMInitializer",null,[]);class vy{constructor(b,h,r){this.f3=b;this.LA=h;this.dAd=r;this.Z=null;this.j_=()=>{this.had();this.LA.z1a(this.j_)};if(!b)throw en.a.argument("AppLifecycleManager is null");if(!h)throw en.a.argument("Workspace is null");if(!r)throw en.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>this.Sp())}Ec(b){this.Z=b;b.ja("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new lo(this.Z.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN)).ha();b.ja("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new uy(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cze,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ja("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new zr(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").jab,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cze,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").gN,
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ja("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ja("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new nx([this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}Sp(){this.dAd.JN?this.f3.Zk(16,()=>this.dvb()):this.dvb()}dvb(){this.LA.uva?this.had():this.LA.gga(this.j_)}had(){this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.Z.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(u.a)(vy,"PackageManager",null,[0,1]);class Ou{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
h){const r=new Ou;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(u.a)(Ou,"DocumentSwayPreviewContent",null,[]);class Da{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static fHl(b,h,r,A){const L=new Da;L.RawText=b;L.ParagraphFormatting=h;L.TextRuns=r;L.IsRTL=A;L.ParagraphIndex=0;return L}}Object(u.a)(Da,"ParagraphContent",null,[]);var Qa=e(91),R=e(1160);class aa{constructor(){this.Name=null;this.Size=0}static construct(b,
h){const r=new aa;r.Name=b;r.Size=h;return r}}Object(u.a)(aa,"FontData",null,[]);class ta{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,A,L,ba){const ra=new ta;ra.IsBold=b;ra.IsUnderline=h;ra.IsUppercase=r;ra.Font=A;ra.Alignment=L;ra.LeftIndent=ba;return ra}}Object(u.a)(ta,"TextFormatting",null,[]);class Ra{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new Ra;r.RawText=b;r.RunFormatting=
h;return r}}Object(u.a)(Ra,"TextRunContent",null,[]);var pb=e(83),Mb=e(93);class jc{constructor(b,h){this.Mjb=null;this.vJk=b;this.mS=h||""}get Reo(){return this.vJk.value}Cam(){var b=Date.now();const h=Ou.construct(2,this.mS);h.Paragraphs=this.Bnm();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}Bnm(){const b=new Cb.a;var h=0;let r=0,A=!1;var L=new te.a;L.set(this.Reo);L=Xd.a.Mp(L.currentNode);const ba=new de.a(0);for(;L.moveNext()&&
2100>r&&25>h;){var ra=L.currentNode;if(rd.ParagraphReader.lc(ra)&&!rd.ParagraphReader.AZ(ra)){!A&&rd.ParagraphReader.zZ(ra)&&(A=!0);let Ia=wm.AParagraphNode.DR(ra.characterData);Ia=Ia.trim();if(0<Ia.length){const Ta=this.uN(ra);Ta.ParagraphIndex=h;h++;r+=Ia.length;b.add(Ta);this.DFp(ba,rd.ParagraphReader.language(ra))}}}this.Mjb=this.Zum(ba);h={};h.documentHasList=A;v.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}Zum(b){let h=-1,r=1033;for(const A of b.keys.toArray())A&&b.K(A)>h&&(h=
b.K(A),r=A);return Wg.a.Vg(r)}DFp(b,h){b.Bb(h)?b.W(h,b.K(h)+1):b.W(h,1)}uN(b){const h=wm.AParagraphNode.DR(b.characterData),r=this.RKm(b),A=this.QUm(b);b=this.ewn(b);return Da.fHl(h,r,A,b)}RKm(b){const h=rd.ParagraphReader.rh(b,Sb.a.bold,!1),r=rd.ParagraphReader.rh(b,Sb.a.underline,!1);var A=rd.ParagraphReader.rh(b,Sb.a.fontSize,Qa.a.AL);const L=rd.ParagraphReader.rh(b,Sb.a.font,Qa.a.zL);var ba=rd.ParagraphReader.VA(b);ba=this.PJf(ba);const ra=!!rd.ParagraphReader.rh(b,Tc.a.capitalization,0);b=(new R.a).cZ(b).value/
20;A=aa.construct(L,A);return ta.construct(h,r,ra,A,ba,b)}QUm(b){const h=new Cb.a;for(let L=0;L<b.ra.length-1;L++){var r=b.ra.jc(L),A=b.ra.jc(L+1);r.formatting&&(A=wm.AParagraphNode.DR(b.characterData.substr(r.cp,A.cp-r.cp)),r=this.RUm(r.formatting),r=Ra.construct(A,r),h.add(r))}return h.toArray()}RUm(b){const h=pb.a.z7c(b,Sb.a.bold,!1),r=pb.a.z7c(b,Sb.a.underline,!1);var A=pb.a.z7c(b,Sb.a.fontSize,Qa.a.AL);const L=pb.a.z7c(b,Sb.a.font,Qa.a.zL);A=aa.construct(L,A);b=!!pb.a.z7c(b,Tc.a.capitalization,
0);return ta.construct(h,r,b,A,5,0)}PJf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}ewn(b){const h=new te.a;h.set(b);h.Ib(11);return(b=h.xd(11))?Mb.a.Rp(b):!1}}Object(u.a)(jc,"DocumentContentExtractor",null,[419]);class tc{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}Ec(b){b.ja("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new jc(new xe.a(()=>Pk.a.Xm.tb.Xc.Fd),y.AFrameworkApplication.dv.sC)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){F.a.instance.Rc(new tc)}}
Object(u.a)(tc,"DocumentContentExtractorPackage",null,[0,1]);class Zc{}Zc.Fh="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(u.a)(Zc,"EmbedDialogHtml",null,[]);class gd{constructor(b,h,r,A){this.Rvc=b;this.xH=h;this.lse=r;this.value=A}}Object(u.a)(gd,"OptionInfo",null,[]);class od{constructor(b,h,r){this.HAg=b;this.Poc=h;this.xH=r}}Object(u.a)(od,"SectionInfo",null,[]);
var vd=e(309);class Ld extends Xf.a{constructor(b,h=!1){super(!1,!1,h);this.TDd=476;this.b9b=288;this.YSe=798;this.DPk=476;this.CPk=288;this.$jd={};this.uAb=[];this.W_=this.I6a=this.hJb=this.FFb=this.OLd=this.Bbc=null;this.ugl=r=>{this.y5h(r);return!0};this.vgl=r=>this.Odd(r,this.y5h);this.y5h=r=>{r=r.er;"visible"===r.HAg.style.visibility?(r.HAg.style.visibility="hidden",r.xH.className=Ye.getImageClass(Ld.Vkh),r.xH.title=CommonUIStrings.l_Expand,r.Poc.title=CommonUIStrings.l_Expand):(r.HAg.style.visibility=
"visible",r.xH.className=Ye.getImageClass(Ld.HXk),r.xH.title=CommonUIStrings.l_Collapse,r.Poc.title=CommonUIStrings.l_Collapse)};this.Tco=r=>{this.Gvj(r);return!0};this.Uco=r=>this.Odd(r,this.Gvj);this.Gvj=r=>{const A=this.$jd[r.er.toString()];A.value?(A.value=0,A.xH.className=Ye.getImageClass(Ld.Ief),A.lse.setAttribute(le.a.sKa,le.a.VM)):(A.value=1,A.xH.className=Ye.getImageClass(Ld.$Pe),A.lse.setAttribute(le.a.sKa,le.a.Zp));this.vIe(r.er.toString(),A.value.toString())};this.mrp=()=>{this.W_.select()};
this.GJc=y.AFrameworkApplication.s9c;this.OJb=b;this.Q5e=this.Tco;this.KPc=this.Uco;this.dOe=this.ugl;this.O6b=this.vgl;this.CRd=this.mrp;this.WHk=h;this.Fh=Zc.Fh;this.Md=0;this.$g="EmbedDialog"}get ly(){return this.b9b}set ly(b){this.b9b=b}M_j(b){const h={["id"]:this.$g,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,
["initialPreviewUrl"]:db.a.Kq(this.OJb,"wdPreview","1"),["initialEmbedUrl"]:this.GJc,["getEmbedCode"]:Ld.ACi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Md=1;this.Ue(1,CommonUIStrings.l_CopyAction);this.Ue(0,CommonUIStrings.l_Close);this.ti(CommonUIStrings.l_Embed,null,h)}KAc(){if(this.WHk)this.M_j({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.Bbc=document.getElementById("embedpreviewpane");this.OLd=document.getElementById("embedoptionpane");
this.Bbc.style.width=String.format("{0}px",this.DPk);this.I6a=document.createElement("iframe");this.I6a.className=Ld.BPk;this.I6a.frameBorder="0";this.I6a.style.height=String.format("{0}px",this.CPk);this.I6a.tabIndex=-1;this.Bbc.appendChild(this.t1d(CommonUIStrings.l_Preview,this.I6a,Ld.AFh,Ld.zFh,Ld.AFh,!0));this.W_=document.createElement("textarea");this.W_.className=Ld.oAk;Sys.UI.DomElement.addCssClass(this.W_,vd.a.Hkf);this.W_.id=Ld.Jlh;X.a.Yi||(this.W_.readOnly=!0);this.W_.rows=4;this.W_.style.fontFamily=
CommonUIStrings.l_UserInterfaceFontName;this.W_.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.W_.setAttribute(le.a.Iba,String.format("{0} {1}",Ld.Ilh,Ld.Hlh));this.Bbc.appendChild(this.t1d(CommonUIStrings.l_EmbedCode,this.W_,Ld.Ilh));Re.a.addHandler(this.W_,"focus",this.CRd);var b=document.createElement("span");b.className=Ld.kCk;b.innerText=CommonUIStrings.l_CopyText;b.id=Ld.Hlh;this.Bbc.appendChild(b);this.FFb=document.createElement("div");this.FFb.className=Ld.uzk;this.OLd.appendChild(this.t1d(CommonUIStrings.l_Dimensions,
this.FFb));this.hJb=document.createElement("div");this.OLd.appendChild(this.zKl(Ld.rDh,this.hJb));this.Md=0;this.Ue(1,CommonUIStrings.l_Close);this.oPg();this.ydk();X.a.Yi||this.W_.focus()}}dispose(){if(this.$jd){var b=this.$jd;for(const h in b){const r=b[h];this.Ws.Gc(Fd.a.click,r.Rvc,this.Q5e);this.Ce.Gc(Fd.a.Bj,r.Rvc,this.KPc);this.Ce.Gc(Fd.a.zi,r.Rvc,this.KPc)}this.KPc=this.Q5e=this.$jd=null}if(this.uAb){for(b=0;b<this.uAb.length;++b)this.Ws.Gc(Fd.a.click,this.uAb[b].Poc,this.dOe),this.Ce.Gc(Fd.a.Bj,
this.uAb[b].Poc,this.O6b),this.Ce.Gc(Fd.a.Jw,this.uAb[b].Poc,this.O6b),this.Ce.Gc(Fd.a.zi,this.uAb[b].Poc,this.O6b);this.Ce=this.dOe=this.uAb=null}this.CRd&&this.W_&&(Re.a.removeHandler(this.W_,"focus",this.CRd),this.CRd=null);this.W_=this.I6a=this.hJb=this.FFb=this.OLd=this.Bbc=null;super.dispose()}Ria(){super.Ria();this.Yc.style.width=String.format("{0}px",this.YSe);this.CKa()}fEp(b,h){const r=db.a.Kq(this.GJc,b,h);return this.GJc!==r?(this.GJc=r,this.OJb=db.a.Kq(this.OJb,b,h),!0):!1}oPg(){this.W_&&
(this.W_.innerText=Ld.ACi(this.GJc,this.TDd,this.b9b))}ydk(){this.I6a&&this.I6a.contentWindow.location.replace(db.a.Kq(this.OJb,"wdPreview","1"))}vIe(b,h){this.fEp(b,h)&&(this.oPg(),this.ydk())}t1d(b,h,r=null,A=null,L=null,ba=!1){const ra=document.createElement("div");ra.className=Ld.pSk;A&&(ra.id=A);L&&ra.setAttribute(le.a.Iba,L);ba&&(ra.tabIndex=0);A=document.createElement("span");A.className=Ld.qSk;A.innerText=b;r&&(A.id=r);ra.appendChild(A);ra.appendChild(h);return ra}zKl(b,h){const r=this.t1d(CommonUIStrings.l_Interaction,
h),A=this.nk.createElement("div");A.className=Ld.auk;A.id=Ld.Idh+b;A.setAttribute(le.a.fi,le.a.i4);A.tabIndex=0;r.insertBefore(A,h);b=Ye.createClusteredImage(16,16,Ld.buk,Ld.cuk,!0,"");A.appendChild(b);b=b.childNodes[0];b.className=Ye.getImageClass(Ld.Vkh);b.title=CommonUIStrings.l_Expand;A.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new od(h,A,b);Array.add(this.uAb,h);this.Ws.wK(Fd.a.click,A,this.dOe,h);this.Ce.wK(Fd.a.Bj,A,this.O6b,h);this.Ce.wK(Fd.a.Jw,A,this.O6b,h);this.Ce.wK(Fd.a.zi,
A,this.O6b,h);return r}Adi(b,h){const r=document.createElement("div");r.className=Ld.oDh;r.id=b+Ld.pDh;var A=this.nk.createElement("div");A.tabIndex=0;A.className=Ld.cgh;A.id=b+Ld.nHc;A.setAttribute(le.a.fi,le.a.smf);A.setAttribute(le.a.sKa,le.a.Zp);A.setAttribute(le.a.Iba,b+Ld.A8b);r.appendChild(A);r.setAttribute(le.a.fi,le.a.NA);var L=Ye.createClusteredImage(16,16,Ld.kgh,Ld.jgh,!0,"");A.appendChild(L);L=L.childNodes[0];L.id=b+Ld.qDh;L.className=Ye.getImageClass(Ld.$Pe);A=new gd(r,L,A,1);this.$jd[b]=
A;this.Ws.wK(Fd.a.click,r,this.Q5e,b);A=document.createElement("span");A.className=Ld.A8b;A.innerText=h;A.id=b+Ld.A8b;r.appendChild(A);this.Ce.wK(Fd.a.Bj,r,this.KPc,b);this.Ce.wK(Fd.a.zi,r,this.KPc,b);return r}static ACi(b,h,r){if(!Ld.y4e){const A=String.format('<a target="_blank" href="{0}">{1}</a>',D.a.Goc("https://office.com"),CommonUIStrings.l_Office),L=String.format('<a target="_blank" href="{0}">{1}</a>',D.a.Goc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Ld.y4e=String.format(CommonUIStrings.l_NoFrames,
A,L)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',D.a.Goc(b),h,r,Ld.y4e)}}Ld.y4e=null;Ld.$Pe="CheckboxChecked_16x16x32";Ld.Ief="CheckboxUnchecked_16x16x32";Ld.HXk="OutlookSearchChevronUp_16x16x32";Ld.Vkh="OutlookSearchChevronDown_16x16x32";Ld.kgh="CommentChecked";Ld.buk="UpArrowServer";Ld.A8b="EmbedDescription";Ld.pSk="EmbedSectionHeader";Ld.qSk="EmbedSectionName UIFontBold";Ld.kCk="EmbedCodeFooter";Ld.jgh="EmbedOptionImage";Ld.BPk="EmbedPreviewFrame";
Ld.oAk="EmbedCodeTextArea";Ld.oDh="EmbedOption";Ld.uzk="EmbedDimensionSection";Ld.cuk="EmbedArrowIcon";Ld.auk="WACGlyph EmbedArrowHolder";Ld.cgh="EmbedCheckBoxHolder";Ld.pDh="Option";Ld.qDh="OptionImage";Ld.Jlh="EmbedCode";Ld.Ilh="EmbedCodeHeader";Ld.AFh="Preview";Ld.zFh="PreviewHeader";Ld.rDh="Options";Ld.Idh="Arrow";Ld.nHc="Check";Ld.Hlh="EmbedCodeFooter";Object(u.a)(Ld,"EmbedDialog",Xf.a,[]);class ae extends gd{constructor(b,h,r,A,L){super(b,h,r,A);this.hva=L}}Object(u.a)(ae,"OptionInputInfo",
gd,[]);class ee extends Ld{constructor(b,h){super(b,ee.OP);this.Vfa=null;this.eJc=[];this.wQd=Object(E.a)(this,this.Gkp,"startOnOptionClickHandler");this.edc=Object(E.a)(this,this.Hkp,"startOnOptionKeyHandler");this.gMd=Object(E.a)(this,this.Q7n,"onPageNumberChanged");this.jTe=Object(E.a)(this,this.e4n,"onDimensionChanged");this.bL=h}KAc(){if(ee.OP){var b=ee.Vvo,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.bL.aBj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",
["checkboxInitialValue"]:!0,["checkboxLabel"]:this.bL.NFj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.bL.t2j,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.bL.v2j}});this.M_j({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.TDd,["defaultHeight"]:this.b9b,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.bL.ohk,["heightLabel"]:this.bL.CTi},["interactionOptions"]:h})}else super.KAc(),this.sSh(this.bL.ohk,
"EmbedWidthInput",this.TDd),this.sSh(this.bL.CTi,"EmbedHeightInput",this.b9b),this.hJb.appendChild(this.Adi("wdPrint",this.bL.aBj)),this.hJb.appendChild(this.Adi("wdEmbedCode",this.bL.NFj)),this.v0k(this.bL.t2j),this.CKa(),Jc.FocusManager.kO()&&(b=Jc.FocusManager.instance(),h=[document.getElementById(Ld.Jlh),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Ld.Idh+Ld.rDh),document.getElementById("wdPrint"+Ld.nHc),document.getElementById("wdEmbedCode"+
Ld.nHc),document.getElementById("wdStartOn"+Ld.nHc),document.getElementById("wdStartOnText"),document.getElementById(kg.a.xzd),document.getElementById(Ld.zFh)],h=new Ha(h),b.Cv().Al=h,X.a.Yi?this.e6(document.getElementById(kg.a.xzd)):this.W_.select())}dispose(){if(!ee.OP){if(this.eJc){for(let b=0;b<this.eJc.length;++b)Re.a.removeHandler(this.eJc[b],"change",this.jTe);this.eJc=this.jTe=null}this.gMd&&(Re.a.removeHandler(this.Vfa.hva,"change",this.gMd),this.gMd=null);this.wQd&&(this.Ws.Gc(Fd.a.click,
this.Vfa.Rvc,this.wQd),this.wQd=null);this.edc&&(this.Ce.Gc(Fd.a.Bj,this.Vfa.Rvc,this.edc),this.Ce.Gc(Fd.a.zi,this.Vfa.Rvc,this.edc),this.edc=null);this.Vfa=null}super.dispose()}sSh(b,h,r){const A=document.createElement("label");A.className="EmbedInputPrefix";A.innerText=b;this.FFb.appendChild(A);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");A.setAttribute("for",h);this.FFb.appendChild(b);this.eJc.push(b);Re.a.addHandler(b,
"change",this.jTe);this.FFb.appendChild(document.createElement("br"))}e4n(b){"EmbedWidthInput"===b.target.id?this.TDd=this.W4d(b.target,375):this.b9b=this.W4d(b.target,250);this.oPg()}W4d(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}Q7n(b){b=this.W4d(b.target,1);1===this.Vfa.value&&this.vIe("wdStartOn",b.toString())}v0k(b){const h=document.createElement("div");h.className=Ld.oDh+" EmbedInlineOption";h.id="wdStartOn"+Ld.pDh;const r=this.nk.createElement("div");r.tabIndex=
0;r.className=Ld.cgh;r.id="wdStartOn"+Ld.nHc;r.setAttribute(le.a.fi,le.a.smf);r.setAttribute(le.a.sKa,le.a.VM);r.setAttribute(le.a.Iba,"wdStartOn"+Ld.A8b);h.appendChild(r);h.setAttribute(le.a.fi,le.a.NA);var A=Ye.createClusteredImage(16,16,Ld.kgh,Ld.jgh,!0,"");r.appendChild(A);A=A.childNodes[0];A.id="wdStartOn"+Ld.qDh;A.className=Ye.getImageClass(Ld.Ief);const L=document.createElement("span");L.className=Ld.A8b;L.innerText=b;L.id="wdStartOn"+Ld.A8b;h.appendChild(L);this.hJb.appendChild(h);b=document.createElement("input");
b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.bL.v2j;b.setAttribute("data-lpignore","true");this.hJb.appendChild(b);Re.a.addHandler(b,"change",this.gMd);this.Vfa=new ae(h,A,r,0,b);this.vIe("wdStartOn","1");this.Ws.Cb(Fd.a.click,h,this.wQd);this.Ce.Cb(Fd.a.Bj,h,this.edc);this.Ce.Cb(Fd.a.zi,h,this.edc)}Gkp(b){this.r2j(b);return!0}Hkp(b){return this.Odd(b,Object(E.a)(this,this.r2j,"startOnOptionHandler"))}r2j(){let b=1;this.Vfa.value?(this.Vfa.value=0,this.Vfa.xH.className=
Ye.getImageClass(Ld.Ief),this.Vfa.lse.setAttribute(le.a.sKa,le.a.VM)):(this.Vfa.value=1,this.Vfa.xH.className=Ye.getImageClass(Ld.$Pe),b=this.W4d(this.Vfa.hva,1),this.Vfa.lse.setAttribute(le.a.sKa,le.a.Zp));this.vIe("wdStartOn",b.toString())}static get OP(){return y.AFrameworkApplication.ta.Pb.$I}static Vvo(b,h,r,A=null){if("wdPrint"===h||"wdEmbedCode"===h)return db.a.Kq(b,h,r?"1":"0");if("wdStartOn"===h){let L="1";r&&A&&(A=parseInt(A),!isNaN(A)&&1<=A&&(L=A.toString()));return db.a.Kq(b,h,r?L:"1")}return b}}
Object(u.a)(ee,"WordEmbedDialog",Ld,[]);class Be{constructor(b,h,r,A,L){this.Oka=null;this.ga=b;this.Zkb=h;this.OU=r;this.bL=A;this.jka=L}mc(){this.ga.qa(this.OU,dd.a.frame,Object(E.a)(this,this.Udp,"showEmbedCode"));this.Zkb.execute(Object(E.a)(this,this.$ig,"onHostPostmessengerCreated"))}$ig(b){v.ULS.shipAssertTag(4994850,332,!!b);this.Oka=b;y.AFrameworkApplication.Yha||(this.Oka.$w(J.a.f4h),this.Oka.DG(J.a.f4h,Object(E.a)(this,this.KAc,"showEmbedDialog")))}KAc(b){b=b.Values.HostEmbeddedViewUrl.toString();
y.AFrameworkApplication.s9c=b;this.jka.YCf=b;(new ee(b,this.bL)).KAc()}Udp(b,h,r){if(2===r)if(y.AFrameworkApplication.s9c)(new ee(this.jka.YCf,this.bL)).KAc();else return y.AFrameworkApplication.uo.Sbb(Be.Ukk),y.AFrameworkApplication.KQg&&this.Oka.sendMessage(J.a.Bcm,null)?32:y.AFrameworkApplication.ta.HZ(!0,y.AFrameworkApplication.YFf);return 32}}Be.Ukk=10381;Object(u.a)(Be,"EmbedActor",null,[]);class Ve{}Object(u.a)(Ve,"WordEmbedDialogStrings",null,[]);var ve=e(239);class Jf extends Be{constructor(b,
h){super(b,h,Lc.a.MGg,Object.assign(new Ve,{ohk:WacWordeditorStrings.Width,CTi:WacWordeditorStrings.Height,aBj:WacWordeditorStrings.PrintOption,NFj:WacWordeditorStrings.ReembedOption,t2j:WacWordeditorStrings.StartOnOption,v2j:WacWordeditorStrings.StartPage}),ve.WoncaApp.instance)}}Object(u.a)(Jf,"EmbedActor",Be,[]);class rg{constructor(){this.Z=null}get name(){return"WordEditor.Embed"}Ec(b){this.Z=b;b.ja("WordEditor.Embed.EmbedActor",()=>new Jf(y.AFrameworkApplication.va,b.Za("Postmessage.IHostPostmessenger"))).ha()}init(){this.Z.resolve("WordEditor.Embed.EmbedActor").mc()}dispose(){}}
Object(u.a)(rg,"EmbedPackage",null,[0,1]);class gg{constructor(b,h,r){this.gz=this.QSa=this.aVa=null;this.ISa=0;this.M$b=this.E$b=this.q$b=this.U$b=this.o5a=this.n5a=!1;this.ll=b;this.vv=r}UL(b){return Db.StaticActiveAppFrame.Aa().tb.isEditingAllowed?""!==this.h6c(b.Ff):!1}eJ(b){if(!this.UL(b))return!1;this.m_o(b);this.n_o();this.o_o();this.aVa=b.kM;this.gz=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}wP(b){this.QSa=b.kM;this.Ypl();this.ll.vck(this.gz.x,
this.gz.y,this.U$b,this.q$b,this.E$b,this.M$b,!1);return!0}$C(){this.ll.vck(this.gz.x,this.gz.y,this.U$b,this.q$b,this.E$b,this.M$b,!0);v.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}qR(){this.ll.Esl();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}n_o(){this.M$b=this.E$b=this.q$b=this.U$b=!1;switch(this.ISa){case 1:this.U$b=!0;break;case 5:this.q$b=!0;break;case 3:this.M$b=!0;break;case 7:this.E$b=!0;break;case 0:this.E$b=this.U$b=!0;break;case 2:this.M$b=this.U$b=
!0;break;case 6:this.E$b=this.q$b=!0;break;case 4:this.M$b=this.q$b=!0}}o_o(){this.o5a=this.n5a=!1;switch(this.ISa){case 0:this.o5a=this.n5a=!0;break;case 1:case 2:this.o5a=!0;break;case 7:case 6:this.n5a=!0}}h6c(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}m_o(b){switch(this.h6c(b.Ff)){case "WACImageCropHandleNW":this.ISa=
0;break;case "WACImageCropHandleN":this.ISa=1;break;case "WACImageCropHandleNE":this.ISa=2;break;case "WACImageCropHandleE":this.ISa=3;break;case "WACImageCropHandleSE":this.ISa=4;break;case "WACImageCropHandleS":this.ISa=5;break;case "WACImageCropHandleSW":this.ISa=6;break;case "WACImageCropHandleW":this.ISa=7}}Ypl(){var b=1;this.vv.instance&&(b=this.vv.instance.Ql);const h=(this.QSa.x-this.aVa.x)/b;b=(this.QSa.y-this.aVa.y)/b;this.gz.x=this.n5a?-h:h;this.gz.y=this.o5a?-b:b}}Object(u.a)(gg,"ImageCropDragAdapter",
null,[98]);class Tf{constructor(b,h){this.ga=b;this.vv=h}ACm(b){return new gg(b,this.ga,this.vv)}}Object(u.a)(Tf,"ImageCropDragAdapterFactory",null,[621]);var fh=e(316),of=e(226),Me=e(33),Kg=e(417),Og=e(723),pf=e(85),uf=e(65),Li=e(161),Yi=e(488),xm=e(915),Mn=e(540),ij=e(746),fn=e(137),yf=e(369),bi=e(773),wp=e(659),hm=e(187),il=e(72),Lh=e(15),Yo=e(261),Nn=e(804),Lq=e(384),Oi=e(128);class ym{constructor(b,h,r,A,L,ba,ra,Ia){this.$$c=null;this.hV=b;this.ni=h;this.Zc=r;this.Ww=A;this.ee=L;this.pb=ba;this.Qo=
ra;this.rI=Ia}get V0(){return null!=this.kXg?this.kXg:this.kXg=Xa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get kc(){return null!=this.Cbh?this.Cbh:this.Cbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Jj(){return fn.a.instance}G1o(b,h,r){const A=this.Zc.Vc(15);A.Eb(h.node);this.d2a(b,r);A.dispose()}F1o(b,h,r){const A=this.Zc.Vc(15);A.Eb(h.node);this.d2b(b,r);A.dispose()}d2a(b,h){b.setValue(Sb.a.imageAltText,h)}d2b(b,h){b.setValue(Rc.a.P1,h)}N1o(b,h){b.setValue(Sb.a.Gub,
h)}bUj(b,h){if(Object(Li.d)(b)){const r=b.ka(Me.a.Zoe,null);h=Nn.a.JOl(h,r);b.setValue(Me.a.Zoe,h)}else b.setValue(Rc.a.R1,h)}J1o(b,h,r,A,L){let ba=0;var ra=0;({width:ba,height:ra}=pe.a.Pab(b));ra-=(h+r)/1E5*ra;this.kQa(b,ba-(A+L)/1E5*ba);this.jQa(b,ra);this.tUj(b);b.setValue(Rc.a.see,h);b.setValue(Rc.a.pee,r);b.setValue(Rc.a.qee,A);b.setValue(Rc.a.ree,L)}M5o(b,h,r,A){const L=this.Zc.Vc(15);L.Eb(h.node);this.MAe(b,r,A);L.dispose()}MAe(b,h,r){this.kQa(b,h);this.jQa(b,r);this.tUj(b);b.removeProperty(Pd.a.Jte);
b.removeProperty(Pd.a.Ite)}kQa(b,h){b.setValue(Sb.a.Zva,h);b.setValue(Pd.a.kNa,-1)}jQa(b,h){b.setValue(Sb.a.zEa,h);b.setValue(Pd.a.jNa,-1)}qJ(b,h){b.setValue(Rc.a.yoc,h);b.setValue(Sb.a.Ki,h);b.setValue(Sb.a.au,h)}C6o(b,h){b.setValue(Rc.a.jCb,h)}qZo(b,h){b.setValue(Rc.a.TWd,h)}H6o(b){if(!pe.a.v9(b)&&b.nm){var h=b.node;if(pe.a.Wca(h)){const L=this.Zc.Vc(15);L.Eb(b.node);b=te.a.kb(h);b.Ib(12);b=b.parentNode;var r=b.properties.Uf(Rc.a.qU),A=h.properties.getValue(Rc.a.runId);h.ka(Rc.a.qd,kf.a.rX);const ba=
b.ra;if(!y.AFrameworkApplication.J||!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveAnchoredProperties",!1)){const ra=[Rc.a.yoc,Sb.a.Ki,Sb.a.au,Rc.a.TWd,Rc.a.jCb,Rc.a.MVa];Object(Li.d)(h)&&ra.push(Me.a.Cce,Me.a.Bce);h.fg.apply(h,ra)}r=this.HLf(A,r,ba);A=vc.a.jd(b,r);this.Ww.Lbi(h,A);(h=this.rI.eN(b,r,r+1))&&this.pb.Uc(h);this.V0.Exa(b,r,r+1);L.dispose()}}}lCg(b,h){if(b.properties.hasProperty(Rc.a.f8)){const r=b.properties.Uf(Rc.a.f8);r.push(h);b.properties.setValue(Rc.a.f8,
Array.clone(r))}else b.properties.setValue(Rc.a.f8,[h])}UBe(b,h,r=0,A=!1){if(b.nm){var L=this.Zc.Vc(15),ba=b.node;L.Eb(ba);if(pe.a.v9(b)){const ob=Object(Li.c)()?new ij.a:new Mn.a;ob.Yu(pe.a.Io(b));var ra=ba.ra,Ia=this.qem(b.cpBegin,ra);this.Hfl(b.cpEnd,ra,Ia)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ra=ra.jc(Ia).blob;Ia=ra.Re;var Ta=ba.properties.Uf(Rc.a.qU);Ta=this.uvo(Ta);Ia=Ta[Ia];Ta=ba.ka(Rc.a.qd,kf.a.rX);if(ra=Object(ya.a)(xm.a,ra))ra.O2b=!1;this.ee.lf(b,
"");ra&&(ra.O2b=!0);ob.properties.setValue(Rc.a.runId,Ia);ob.properties.setValue(Rc.a.qd,Ta);b=te.a.kb(ba);b.Ib(12);b.pg(ob,6);this.lCg(b.currentNode,ob.anchor.node.id);ba=ob}r&&this.qJ(ba.properties,r);this.qZo(ba.properties,A);this.C6o(ba.properties,h);this.V0.Hzc(ba);(h=this.rI.ot(ba))&&this.pb.Uc(h);L.dispose()}}lAg(b,h){if(!(0>=h)){var r=rb.a.Zn(h,0),A=pe.a.XD(b),L=pe.a.iF(b);A>r&&(L*=r/A,this.kQa(b,r),this.jQa(b,L),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",
h))}}Hfl(b,h,r){const A=h.length;if(r>=A||!h.jc(r).Nf)return!1;const L=new ki.a;for(;r<A;r++){const ba=h.jc(r);if(ba.cp>b||!ba.Nf)break;for(let ra=0;ra<ba.Nf.length;ra++){if(L.contains(ba.Nf.K(ra).Lk))return!0;L.add(ba.Nf.K(ra).Lk)}}return!1}uvo(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var A=b[h];r=h-1;for(var L=A-1;0<=r;)b[r]=L,r--,L--;L=0;for(r=h+1;r<b.length;)(h=b[r])?h<A?(A=h+L,b[r]=A):A=h:(L+=2,A++,b[r]=A),r++}return b}JGf(b,h){let r=0;for(;r<
h.length&&!(b<h[r]);)r++;return r}HLf(b,h,r){let A=0;const L=this.JGf(b,h);let ba=0;if(L===h.length)ba=r.length-1;else for(;ba<r.length;){h=r.jc(ba);if(h.formatting&&h.formatting.Re===L)break;ba++}ba<r.length?A=r.jc(ba).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ba,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return A}qem(b,h){let r=0;for(;r<h.length&&h.jc(r).cp!==b;)r++;r===h.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}tUj(b){b.setValue(Sb.a.dEa,!0)}mue(b,h,r,A=!1){h&&r?(h=Math.max(h,Og.a.Ijj),r=Math.max(r,Og.a.Ijj)):r=h=Og.a.lii;b.setValue(Sb.a.Zva,rb.a.Zn(h,0));b.setValue(Sb.a.zEa,rb.a.Zn(r,1));b.setValue(Sb.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Tc.a.S1,pd.a.YGa);b.setValue(Rc.a.ioa,A)}zfe(){return null}cmi(b,h,r){let A=null;h=({HYb:A}=this.dmi(b,h,r)).returnValue;A&&b.view.ub.Uc(A);return h}dmi(b,h,r){var A=null;
if(!this.kma(b))return{returnValue:null,HYb:A};var L=b.view;const ba=this.Zc.Vc(15,fb.a.cVb);ba.Eb(L.Fd);h||(h=new Ai.DictionaryPropertySet);h.setValue(Pd.a.t3l,!0);let ra=L.ub.hh;var Ia=new wp.a;if(!Ee.a.Df(ra)){if(2===y.AFrameworkApplication.va.Vb(fb.a.Rta,2))return ba.dispose(),{returnValue:null,HYb:A};ra=L.ub.hh}else if(ra.nm&&rd.ParagraphReader.lc(ra.node)){If.a.Gd().pn&&If.a.Gd().Qk.uI(ra.node);L=pb.a.uu(ra);if(!L)return ba.dispose(),{returnValue:null,HYb:A};L.cache.tG&&(L=L.og(null),ym.Qj.j$(L));
Ia.formatting=L.ol;Ia.languageId=pb.a.language(L);Ia.Cqa=this.kc.Lr(ra.node)}if(!ra.nm)return ba.dispose(),{returnValue:null,HYb:A};if(!this.sZf(b.Pk,h))return ba.dispose(),this.$$c=null,{returnValue:null,HYb:A};b=this.$$c;this.$$c=null;1===b.location?(A=b.node,h=Lq.a.instance.BSf(A),hg.a.Fu(h,!1,!1)||(hm.OutlineNavigator.Tye(h),this.hV.Yla(h,!0,Ia)),hg.a.Ze(h),Qh.TableReader.isTable(h)&&(Object(Pb.a)(Oi.a,h)||Object(Pb.a)(yf.a,h)?(Ia=new te.a,Ia.set(h.currentNode),Lh.h(Ia,0,0),h.set(Ia.currentNode)):
Lh.h(h,0,0),Mb.a.ji(h)?hg.a.Ze(h):h=Lq.a.instance.BSf(A)),A=rd.ParagraphReader.Xv(h.currentNode)?this.rI.Ie(h.currentNode,0):this.rI.ot(h.currentNode)):b.location||(Ia=b.blob.Rb.cp+1,A=this.rI.eN(b.node,Ia-1,Ia));ba.sOa(r,1);ba.Bh=fb.a.cVb;ba.dispose();return{returnValue:b,HYb:A}}sZf(){return!1}kma(b){b.contextId===ic.a.view&&b.view.Ee&&b.view.ub&&(b=b.view.ub.hh);if(!b)return ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.Mo}),!1;if(ym.Ig.t4(b))return ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),!1;if(ym.Ig.koa(b))return ym.Jc.qc(pf.a.$e,
{["Reason"]:uf.a.QXi}),!1;if(this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(b))return ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.R$a}),!1;if(this.Jj.i5)return ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.compatMode}),!1;if(b.nm)return il.a.Aie(b)?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.tuf}),!1):pe.a.yhe(b)?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.luf}),!1):Yo.c(b)?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.muf}),!1):bi.a.u1f(b)?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.kuf}),!1):rd.ParagraphReader.uZ(b)||pe.a.Hln(b)?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),
!1):!0;if(Yi.a.Q2f(b)){let h=!0;for(let r=0;r<b.length;++r){const A=b.getContext(r);if(!A.nm)return!1;h&&!rd.ParagraphReader.uZ(A)&&(h=!1)}return h?(ym.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),!1):!0}return!1}KIj(b,h){const r=this.Zc.Vc(7);r.Eb(b);if(12===b.type){h=h.Rb.cp;var A=rd.ParagraphReader.textLength(b);A=vc.a.OV(h,h+1,h+1===A?!0:!1,b);this.ee.lf(A,"");b=vc.a.jd(b,h);this.pb.Uc(Tb.SelectionFactory.aq(b))}else this.ni.hxa(b);r.dispose()}static get Qj(){return null!=ym.r0g?ym.r0g:ym.r0g=Xa.a.instance.resolve("Box4.IFormattingEditor")}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}}
Object(u.a)(ym,"ImageEditor",null,[414]);class uq{constructor(b,h,r,A=0){this.node=b;this.blob=h;this.location=r;this.lZ=A}}Object(u.a)(uq,"InsertPictureResult",null,[]);var Ts=e(855),Ar=e(292),yn=e(578),zm=e(120),xp=e(531),jr;(function(b){b[b.other=0]="other";b[b.picture=1]="picture"})(jr||(jr={}));Object(u.b)("ImageType",jr);var pt=e(1157);class Op extends ym{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){var Bc,Yc;super(b,h,r,A,L,ba,ra,Ia);this.uyk="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.Ljb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.tO=this.wTa=this.$Ha=null;this.Zqa=Array(8);this.GGd=this.zIa=null;this.xTa=!1;this.FGd=this.BYe=null;this.nCd=this.xDd=!1;this.$X=this.ZX=this.YX=this.aY=this.Q_=this.P_=this.O_=this.R_=this.k0=this.l0=0;this.sR=()=>{this.xTa&&
this.tDf()};this.TEa=zd=>{this.xTa&&zd.Yb.keyCode!==pg.a.vw&&this.tDf(!0);return!1};this.Arh=bc;ba.BD(this.sR);this.Ce=Eb;this.m7=fh.a.instance;this.ga=y.AFrameworkApplication.va;this.me=ob;this.lr=Ta;this.z_f=null!==(Yc=null===(Bc=y.AFrameworkApplication.J)||void 0===Bc?void 0:Bc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AppendSpacersToDataUrlForSafari",!1))&&void 0!==Yc?Yc:!1}dBe(b,h,r,A,L){b.hasProperty(Pd.a.C_a)&&b.removeProperty(Pd.a.C_a);const ba=Array(4);ba[zm.a.left]=h;ba[zm.a.right]=
r;ba[zm.a.top]=A;ba[zm.a.bottom]=L;b.setValue(Rc.a.Nia,ba)}nGo(b){b.setValue(Rc.a.mNa,xp.a.agg);b.setValue(Rc.a.c_b,"");this.dBe(b,0,0,0,0)}fDg(b,h,r,A,L){b.setValue(Rc.a.see,h);b.setValue(Rc.a.pee,r);b.setValue(Rc.a.qee,A);b.setValue(Rc.a.ree,L)}fBe(b,h,r,A){b.setValue(Rc.a.mZ,h);b.setValue(Rc.a.zVf,r);b.setValue(Rc.a.VVf,A);b.setValue(Pd.a.mZ,-1)}xfe(b,h){b=b.node;const r=te.a.kb(b);if(rd.ParagraphReader.lc(b)&&rd.ParagraphReader.isEmpty(r)){var A=b.properties.Uf(Rc.a.qd);h.setValue(Rc.a.qd,A);
h.setValue(Rc.a.runId,1);A=new pt.a;h&&A.Yu(h);r.pg(A,6);this.lCg(b,A.anchor.node.id);this.V0.Hzc(A);return new uq(A,null,3)}return null}zfe(b,h){var r=Ts.a.instance.Kyd;h&&r.Yu(h);r.setValue(Rc.a.imageType,jr.picture);let A=0;A=of.a.BG();r.setValue(Rc.a.lZ,A);const L=b.node.ed.Mv(r,r.id);r=this.ee.Vna(b,ba=>new xm.a(ba,L));Ar.a.instance.Iig(b.node);if(this.me.Zg){const ba=new hb.GraphTransaction(15);ba.Eb(b.node);this.lr.Kpa(b.node,b.cpBegin,b.cpBegin+1,1,null);ba.dispose()}this.V0.fWa&&!h.ka(Rc.a.ioa,
!1)&&this.V0.Exa(b.node,b.cpBegin,b.cpBegin+1);return new uq(b.node,r,0,A)}sZf(b,h){if(!this.kma(b))return!1;const r=this.Zc.Vc(7);r.Eb(b.node);y.AFrameworkApplication.J.$("ContentAppIsEnabled")&&h.ka(Rc.a.f_i,!1)?this.$$c=this.xfe(b,h):this.$$c=this.zfe(b,h);r.dispose();return!0}Wxc(b,h,r,A){if(!r.lc(b))return!1;r=this.Zc.Vc(7,fb.a.d_m);r.Eb(b);var L=b.properties.ka(Sb.a.sw,[]);L.push(0);for(const ba of L)if((L=A.pKf(b,ba))&&5===L.xi&&L.id.equals(h))return this.ee.lf(vc.a.createTextRange(b,ba,ba+
1),""),r.dispose(),!0;r.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}DFo(b,h,r,A){if(!pe.a.Wca(b))return!1;h.set(b);h.Ib(12);const L=h.Gq(12);if(!L)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.mcd(L))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;A(b);r=this.Zc.Vc(7);r.Eb(b);h.qh();r.dispose();return!0}BLo(b,h,r,A){return pe.a.lcb(b)?this.nLo(b,r):pe.a.v9(b)?this.FLo(b,h,r,A):null}FLo(b,h,r,A){const L=Ts.a.instance.Kyd;r&&L.Yu(r);r=0;r=of.a.BG();L.setValue(Rc.a.lZ,r);r=b.node.ed;b=b.node;A=A.V4c(b,5);for(const ba of A)if(ba.id.equals(h)){this.ee.lf(vc.a.createTextRange(b,ba.Rb.cp,ba.Rb.cp+1),"");const ra=r.Mv(L,L.id);h=vc.a.jd(b,ba.Rb.cp);this.ee.Vna(h,Ia=>new xm.a(Ia,ra));return L}return null}nLo(b,h){if(!pe.a.lcb(b))return null;h.setValue(Rc.a.lZ,
of.a.BG());b=b.node;var r=b.anchor.node.id;b=te.a.kb(b);b.Ib(12);const A=b.parentNode;let L;A.properties.hasProperty(Rc.a.f8)?(L=A.properties.Uf(Rc.a.f8),r=V.a.indexOf(L,r),-1!==r&&Array.removeAt(L,r)):L=[];A.properties.setValue(Rc.a.f8,Array.clone(L));b.qh();r=Object(Li.c)()?new ij.a:new Mn.a;r.Yu(h);b.pg(r,6);this.lCg(A,r.anchor.node.id);return r}SCc(b,h){this.xTa?this.tDf():this.ikp(b,h)}P1o(b,h){b.setValue(Pd.a.mZ,h)}ECm(b){let h=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),
{returnValue:null,view:h,fl:r};if(!Object(Vb.a)().Pd)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,fl:r};const A=b.node;if(!A)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,fl:r};r=A.ed;var L=Object(Vb.a)().Pd.Lc;L=A.ug(L);if(!L)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),
{returnValue:null,view:h,fl:r};h=L.Gh;if(b.nm&&pe.a.v9(b)){b=pe.a.HMa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,fl:r};b=b.jDa(h,L);if(!b)return v.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,fl:r};b=b.element}else if(pe.a.nr(A))b=L.htmlElement;else return v.ULS.sendTraceTag(22381059,
322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,fl:r};return{returnValue:b,view:h,fl:r}}d8o(b){for(let A=0;A<this.Zqa.length;A++){this.Zqa[A]=b.Zl(Om.a.span);this.Zqa[A].className="WACImageCropHandles "+this.uyk[A];if(2>=A){var h=b.Zl(Om.a.span);h.className=this.Ljb[0];var r=b.Zl(Om.a.span);r.className=this.Ljb[1];this.Zqa[A].appendChild(h);this.Zqa[A].appendChild(r)}else 4<A&&(h=b.Zl(Om.a.span),h.className=this.Ljb[2],
r=b.Zl(Om.a.span),r.className=this.Ljb[3],this.Zqa[A].appendChild(h),this.Zqa[A].appendChild(r));if(!A||3===A||5===A)h=b.Zl(Om.a.span),h.className=this.Ljb[4],r=b.Zl(Om.a.span),r.className=this.Ljb[5],this.Zqa[A].appendChild(h),this.Zqa[A].appendChild(r);else if(2===A||4===A||7===A)h=b.Zl(Om.a.span),h.className=this.Ljb[6],r=b.Zl(Om.a.span),r.className=this.Ljb[7],this.Zqa[A].appendChild(h),this.Zqa[A].appendChild(r)}}ikp(b,h){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.xTa)v.ULS.sendTraceTag(22381061,
322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,A=null;if((this.zIa=({view:r,fl:A}=this.ECm(h)).returnValue)&&r){this.zIa.classList.add("ImageCropMode");this.$Ha=r.Zl(Om.a.div);this.$Ha.className="WACImageCropMode";this.wTa=r.Zl(Om.a.Rub);this.wTa.className="WACImageCropBase";this.tO=r.Zl(Om.a.span);this.tO.className="WACImageCropSrcRect";this.d8o(r);this.$Ha.appendChild(this.tO);for(r=0;r<this.Zqa.length;r++)this.tO.appendChild(this.Zqa[r]);this.$Ha.appendChild(this.wTa);
this.wTa.style.visibility="";this.wTa.style.display="";this.zIa.appendChild(this.$Ha);this.nlo(b);A=pe.a.NMa(b,A);r=pe.a.R$(b,Pd.a.X9,null);this.wTa.src=r?this.z_f&&X.a.Kva?Object(yn.a)(r):r:pe.a.Qab(A);this.Arh&&this.Arh.execute(L=>{this.GGd||(this.GGd=L.ACm(this))});this.xDd||(this.m7.hM(this.zIa,this.GGd),this.xDd=!0);this.Ce&&this.Ce.Cb(Fd.a.XM,Object(Vb.a)().Ve.editingElement,this.TEa);this.xTa=!0;this.BYe=b;this.FGd=h;this.nCd=!1;b=new hb.GraphTransaction(4);b.Eb(this.FGd.node);this.BYe.setValue(Pd.a.hoa,
this.xTa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}nlo(b){const h=rb.a.Rf(pe.a.XD(b),0),r=rb.a.Rf(pe.a.iF(b),1);var A=pe.a.oha(b);const L=Math.max(A.top,0),ba=Math.max(A.bottom,0),ra=Math.max(A.left,0);A=Math.max(A.right,0);this.l0=1E5*h/(1E5-(ra+A));this.k0=1E5*r/(1E5-(L+ba));this.R_=Math.floor(L*this.k0/1E5);this.O_=Math.floor(ba*this.k0/1E5);this.P_=Math.floor(ra*this.l0/1E5);this.Q_=Math.floor(A*
this.l0/1E5);this.tO.style.top=this.R_+"px";this.tO.style.bottom=this.O_+"px";this.tO.style.left=this.P_+"px";this.tO.style.right=this.Q_+"px";this.wTa.style.width=this.l0+"px";this.wTa.style.height=this.k0+"px";pe.a.QB(b)&&(this.$Ha.style.width=this.l0+"px",this.$Ha.style.height=this.k0+"px");this.aY=this.R_;this.YX=this.O_;this.ZX=this.P_;this.$X=this.Q_}tDf(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.xTa?(b||this.kDl(),this.wTa?eb.a.fH(this.wTa):v.ULS.sendTraceTag(23961793,
322,15,"Unable to clear imageCropBase dom element because it was already null."),this.zIa?(this.$Ha?this.$Ha.parentNode===this.zIa?this.zIa.removeChild(this.$Ha):v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.zIa.classList.remove("ImageCropMode"),this.xTa=!1,b=new hb.GraphTransaction(4),b.Eb(this.FGd.node),
this.BYe.setValue(Pd.a.hoa,this.xTa),b.dispose(),this.xDd&&(this.m7.rM(this.zIa,this.GGd),this.xDd=!1),this.Ce&&this.Ce.Gc(Fd.a.XM,Object(Vb.a)().Ve.editingElement,this.TEa),this.zIa=this.$Ha=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}vck(b,h,r,A,L,ba,ra){if(r){r=Math.max(this.R_-h,0);const Ia=Math.floor(this.k0)-
this.O_-r;5<=Ia?(this.aY=r,this.YX=this.O_):5>Ia&&0<=Ia||0>Ia&&!this.O_?(this.aY=r-(5-Ia),this.YX=this.O_):0>Ia&&5>=Math.abs(Ia)?(this.aY=Math.floor(this.k0)-this.O_,this.YX=Math.max(this.O_-(r-(this.k0-this.O_))-(5-Math.abs(Ia)),0)):(this.aY=Math.floor(this.k0)-this.O_,this.YX=Math.max(this.O_-(r-(this.k0-this.O_)),0));this.tO.style.top=this.aY+"px";this.tO.style.bottom=this.YX+"px";ra&&(this.R_=this.aY,this.O_=this.YX)}A&&(h=Math.max(this.O_-h,0),A=Math.floor(this.k0)-this.R_-h,5<=A?(this.YX=h,
this.aY=this.R_):5>A&&0<=A||0>A&&!this.R_?(this.YX=h-(5-A),this.aY=this.R_):0>A&&5>=Math.abs(A)?(this.YX=Math.floor(this.k0)-this.R_,this.aY=Math.max(this.R_-(h-(this.k0-this.R_))-(5-Math.abs(A)),0)):(this.YX=Math.floor(this.k0)-this.R_,this.aY=Math.max(this.R_-(h-(this.k0-this.R_)),0)),this.tO.style.top=this.aY+"px",this.tO.style.bottom=this.YX+"px",ra&&(this.R_=this.aY,this.O_=this.YX));L&&(L=Math.max(this.P_-b,0),h=Math.floor(this.l0)-this.Q_-L,5<=h?(this.ZX=L,this.$X=this.Q_):5>h&&0<=h||0>h&&
!this.Q_?(this.ZX=L-(5-h),this.$X=this.Q_):0>h&&5>=Math.abs(h)?(this.ZX=Math.floor(this.l0)-this.Q_,this.$X=Math.max(this.Q_-(L-(this.l0-this.Q_))-(5-Math.abs(h)),0)):(this.ZX=Math.floor(this.l0)-this.Q_,this.$X=Math.max(this.Q_-(L-(this.l0-this.Q_)),0)),this.tO.style.left=this.ZX+"px",this.tO.style.right=this.$X+"px",ra&&(this.P_=this.ZX,this.Q_=this.$X));ba&&(b=Math.max(this.Q_-b,0),ba=Math.floor(this.l0)-this.P_-b,5<=ba?(this.$X=b,this.ZX=this.P_):5>ba&&0<=ba||0>ba&&!this.P_?(this.$X=b-(5-ba),
this.ZX=this.P_):0>ba&&5>=Math.abs(ba)?(this.$X=Math.floor(this.l0)-this.P_,this.ZX=Math.max(this.P_-(b-(this.l0-this.P_))-(5-Math.abs(ba)),0)):(this.$X=Math.floor(this.l0)-this.P_,this.ZX=Math.max(this.P_-(b-(this.l0-this.P_)),0)),this.tO.style.left=this.ZX+"px",this.tO.style.right=this.$X+"px",ra&&(this.P_=this.ZX,this.Q_=this.$X));ra&&(this.nCd=!0,Db.StaticActiveAppFrame.Aa().Ne())}Esl(){this.aY=this.R_;this.YX=this.O_;this.ZX=this.P_;this.$X=this.Q_;this.tO.style.top=this.aY+"px";this.tO.style.bottom=
this.YX+"px";this.tO.style.left=this.ZX+"px";this.tO.style.right=this.$X+"px"}kDl(){if(this.nCd){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.R_/this.k0),h=Math.floor(1E5*this.O_/this.k0),r=Math.floor(1E5*this.P_/this.l0),A=Math.floor(1E5*this.Q_/this.l0),L=new Ai.DictionaryPropertySet;L.setValue(Pd.a.Qub,b);L.setValue(Pd.a.Nub,h);L.setValue(Pd.a.Oub,r);L.setValue(Pd.a.Pub,A);this.ga.Sf(this.FGd,Lc.a.gVi,2,!1,null,L)}else v.ULS.sendTraceTag(23070481,
322,50,"No New Cropping Properties To Commit.")}hoa(){return this.xTa}evm(){return{top:this.aY,bottom:this.YX,left:this.ZX,right:this.$X}}lFp(b,h){if(0>b)v.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.R_=this.aY=Math.min(Math.floor(this.k0)-this.YX-5,b);this.tO.style.top=this.aY+"px";break;case 1:this.O_=this.YX=Math.min(Math.floor(this.k0)-this.aY-5,b);this.tO.style.bottom=this.YX+"px";break;case 2:this.P_=this.ZX=Math.min(Math.floor(this.l0)-
this.$X-5,b);this.tO.style.left=this.ZX+"px";break;case 3:this.Q_=this.$X=Math.min(Math.floor(this.l0)-this.ZX-5,b),this.tO.style.right=this.$X+"px"}this.nCd=!0}}}Object(u.a)(Op,"ImageEditor",ym,[413,414]);class Zo{constructor(){this.Z=null}get name(){return"WordEditor.ImageEditors"}Ec(b){this.Z=b;this.Z.ja("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Tf(y.AFrameworkApplication.va,Xa.a.instance.Za("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.Z.ja("WordEditor.ImageEditors.ImageEditor",
()=>new Op(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Za("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
lc.KeyInputManager.instance,b.Za("WordEditor.IImageCropDragAdapterFactory"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.Z.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){F.a.instance.Rc(new Zo)}}Object(u.a)(Zo,"WordEditorImageEditorsPackage",null,[0,1]);class lu{}Object(u.a)(lu,"FolderContentEditor",null,[1450]);class jh{}Object(u.a)(jh,"PageEditor",null,[1584]);class Lt extends jh{constructor(){super()}}Object(u.a)(Lt,"PageEditor",jh,
[]);class fk{get name(){return"WordEditor.NotebookLevelEditors"}Ec(b){b.ja("Box4.NotebookLevelEditors.FolderContentEditor",()=>new lu).as("Box4.Folder.IFolderContentEditor").ha();b.ja("WordEditor.NotebookLevelEditors.PageEditor",()=>new Lt).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){F.a.instance.Rc(new fk)}}Object(u.a)(fk,"WordEditorNotebookLevelEditorsPackage",null,[0,1]);class Bk{get z_b(){return y.AFrameworkApplication.privacyUrl}HBa(){v.ULS.sendTraceTag(37034014,342,50,
"User clicked on the Privacy statement.");ed.a.Zm(this.z_b,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(u.a)(Bk,"PrivacyLinkHandler",null,[795]);class Ym{constructor(b,h){this.k5e=null;this.HSk=b;this.GSk=h}showDialog(b){this.k5e=b;this.GSk.create().ti(Object(E.a)(this,this.F0m,"handleDialog"))}F0m(b){1===b&&this.HSk.ERj();this.k5e();this.k5e.prototype}}Object(u.a)(Ym,"SendUsYourFileController",null,[763]);class mo extends wg.StandardDialog{constructor(b,h,r){super();this.Gbc=
null;this.xh=b;this.GQc=h;this.bL=r}ti(b){this.Md=1;this.Ue(1,this.bL.send);this.Ue(0,this.bL.LYn);v.ULS.shipAssertTag(37034013,342,!this.Gbc,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.Gxb(this.bL.bcl,null,"CancelRequest_32x32x32",null,b,h);this.u$(this.Vj(mo.MRj))}dialogContent(){const b=document.createElement("span");b.innerText=this.bL.roo;const h=document.createElement("span");h.innerText=this.bL.Uqp;h.style.fontWeight=this.bL.LKp;const r=document.createElement("span");
r.innerText=this.bL.YXo;const A=this.pFl(),L=document.createElement("span");L.id=this.Vj(mo.MRj);L.appendChild(b);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(h);L.appendChild(document.createElement("br"));L.appendChild(r);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(A);return L}pFl(){const b=document.createElement("span"),h=document.createElement("a");
h.innerText=this.bL.$no;h.href=this.GQc.z_b||"";b.appendChild(h);this.Gbc=h;this.xh.Cb(Fd.a.click,this.Gbc,Object(E.a)(this.GQc,this.GQc.HBa,"clickHandler"));return b}dispose(){this.Gbc&&(this.xh.Gc(Fd.a.click,this.Gbc,Object(E.a)(this.GQc,this.GQc.HBa,"clickHandler")),this.Gbc=null);super.dispose()}}mo.MRj="sendUsYourFileId";Object(u.a)(mo,"SendUsYourFileDialog",wg.StandardDialog,[794]);class kj{create(){return Xa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(u.a)(kj,
"Factory",null,[793]);var $f=e(527);class Kl extends $f.a{constructor(){super();this.FileId=null}Hn(){return 38}static construct(b){const h=new Kl;h.FileId=b;return h}}Object(u.a)(Kl,"CreateSendUsYourFileRequest",$f.a,[]);var No=e(1085);class Pp{constructor(b,h,r){this.QU=b;this.ZU=h;this.iKk=r}ERj(b=!1){if(this.ZU){const h=Kl.construct(this.ZU()),r=new No.a;r.Ls=h;r.status=1;r.MH="BootErrorReport";b=b?this.QU(null):this.QU(A=>{this.fpd(r,A)});b.yI(r);b.h1();this.iKk()}}fpd(b){5===b.statusCode&&this.ERj(!0)}}
Object(u.a)(Pp,"SendUsYourFileManager",null,[762]);class $o{constructor(b,h){this.Z=null;this.bL=b;this.ZU=h}Ec(b){this.Z=b;this.Z.ja("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.bL).ha();this.Z.ja("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new mo(Wf.a.instance,new Bk,this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.Z.ja("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Pp(h=>this.Bca(0,h),this.ZU,()=>{v.ULS.sendTraceTag(42022664,
342,50,"send us your file request is now sent.")}));this.Z.ja("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new kj;return new Ym(this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.Z.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(u.a)($o,"SendUsYourFilePackageManager",null,[]);var Bi=e(582),ik=e(1038);class qm{get bcl(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get LYn(){return CommonUIStrings.l_NoThanks}get roo(){return WacWordeditorStrings.ProblemOpeningDocument}get Uqp(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get LKp(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get YXo(){return WacWordeditorStrings.SendUsYourFileDialogText}get $no(){return CommonUIStrings.l_PrivacyStatement}}
Object(u.a)(qm,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class wo extends $o{constructor(){super(new qm,()=>y.AFrameworkApplication.rootQuerySignature)}Bca(b,h){return new ik.a(b,h,"SendUsYourFile.ashx",Nm.a.word,Ze.a.webServiceBase,Bi.a.Yq,Bi.a.hpd,Bi.a.Tod)}get name(){return"WordEditor.SendUsYourFile"}static main(){F.a.instance.Rc(new wo)}}Object(u.a)(wo,"PackageManager",$o,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var dj=e(565),Ul=e(650),wk=e(1879),Ej=e(111),ih=e(22),pl=e(164),Xl=e(75),Sm=e(1052),Eh=e(178);class no{constructor(){this.color=0;this.weight=Eh.a.dof;this.style=Eh.a.npb}}Object(u.a)(no,"BorderPropertyValue",null,[]);class vq{constructor(b,h,r,A,L,ba){this.T7d=b;this.gallerySectionId=h;this.tFf=r;this.Ckf=A;this.commandId=L;this.queryCommandId=ba}}Object(u.a)(vq,"BorderStyleMenuPropsArguments",null,[]);class Qj{constructor(b,h,r,A,L,ba,ra){this.N8a=b;this.Ptd=h;this.width=r;this.yhd=A;this.height=
L;this.Fed=ba;this.altText=ra}}Object(u.a)(Qj,"TableBorderStyleProperties",null,[]);var Mt=e(406),Te=e(799),Us;(function(b){b[b.automatic=1]="automatic";b[b.clear=2]="clear";b[b.thb=3]="themeColors";b[b.rwq=4]="standardColors";b[b.vK=5]="recentColors";b[b.vgq=6]="moreColors";b[b.RYa=7]="highContrastColors"})(Us||(Us={}));Object(u.b)("ColorMenuControls",Us);var Oo=e(1053);class lp{constructor(b){this.pOc=null;this.sBd={};this.sVb=()=>{this.pOc=null};this.qQ=b;this.U$e=""}get dea(){return this.U$e}set dea(b){b=
b||"";this.U$e!==b&&(this.U$e=b,this.sVb())}Gsb(b,h){if(this.pOc)return this.pOc;if(!b)return null;const r=Object.assign(new dk.a,{Id:String.format("menu{0}Color",this.qQ),ExternalId:String.format("{0}Color",this.qQ)});r.MenuSectionList=[];Object(Oo.a)()&&r.MenuSectionList.push(this.f2k());r.MenuSectionList.push(this.$_k());r.MenuSectionList.push(this.z0k());r.MenuSectionList.push(this.u5k(b,h));r.MenuSectionList.push(this.b5k());return this.pOc=r}bH(b,h){Us[b]in this.sBd||(this.sBd[Us[b]]=h)}q8a(b,
h){b.Bhf(this.sVb,h)}f2k(){if(!({actionId:h}=this.Nvd(7)).returnValue)return null;const b=Object.assign(new Zd.a,{Id:String.format("{0}Color",this.qQ),ControlsId:String.format("{0}.Color.Menu.Controls",this.qQ),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new qg.a,{Command:h.toString(),LabelText:D.a.Mf(Box4Intl.Box4Strings.L_HighContrastColorPicker),Image16by16:y.AFrameworkApplication.mr,Image16by16Class:Ye.getImageClass("Automatic_16x16x32"),Id:String.format("HighContrast{0}ColorPicker",
this.qQ),ExternalId:String.format("HighContrast{0}ColorPicker",this.qQ),KeyTip:CommonUIStrings.l_HighContrastColorPickerKeytip,QueryCommand:fb.a.Wld.toString()});b.ControlList.push(h);return b}$_k(){if(!({actionId:h}=this.Nvd(1)).returnValue)return null;const b=Object.assign(new Zd.a,{Id:String.format("{0}Color",this.qQ),ControlsId:String.format("{0}.Color.Menu.Controls",this.qQ),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new qg.a,{Command:h.toString(),LabelText:D.a.Mf(Box4Intl.Box4Strings.L_Automatic),
Image16by16:y.AFrameworkApplication.mr,Image16by16Class:Ye.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});b.ControlList.push(h);return b}z0k(){if(!({actionId:h}=this.Nvd(2)).returnValue)return null;const b=Object.assign(new Zd.a,{Id:String.format("{0}Color",this.qQ),ControlsId:String.format("{0}.Color.Menu.Controls",this.qQ),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new qg.a,{Command:h.toString(),LabelText:D.a.Mf(Box4Intl.Box4Strings.L_BtnClearShading),
Image16by16:y.AFrameworkApplication.mr,Image16by16Class:Ye.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});b.ControlList.push(h);return b}u5k(b,h){if(!({actionId:A}=this.Nvd(3)).returnValue)return null;const r=Object.assign(new Zd.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.qQ),ControlList:[]});var A=Object.assign(new Te.a,{Id:String.format("Theme{0}ColorPicker",this.qQ),ExternalId:String.format("Theme{0}ColorPicker",this.qQ),
McuExternalId:String.format("Theme{0}ColorPickerMCU",this.qQ),McuLayout:!0,Command:A.toString(),Width:10});const {eBl:L,Srp:ba}=lp.WUm(b,h);A.Colors=L;this.tVj(A,ba);r.ControlList.push(A);return r}b5k(){if(!({actionId:h}=this.Nvd(4)).returnValue)return null;const b=Object.assign(new Zd.a,{Id:String.format("{0}Colors",this.qQ),ControlsId:String.format("{0}.Color.Menu.Controls",this.qQ),Title:D.a.Mf(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var h=Object.assign(new Te.a,{Id:String.format("Standard{0}ColorPicker",
this.qQ),ExternalId:String.format("Standard{0}ColorPicker",this.qQ),Command:h.toString(),Width:10,Colors:[]});h.Colors=lp.gSm();this.tVj(h);b.ControlList.push(h);return b}tVj(b,h){if(b){var r="";"object"===typeof this.dea?void 0!==h&&(r=this.DQm(h,this.dea)):r=this.nQm(b.Colors,this.dea);b.Stateful=!0;b.SelectedColorId=""!==r?r:"NoColor"}}DQm(b,h){var r,A;let L="";for(const ba of b)if(ba.iGe===h.Wwc&&ba.gAc===(null===(r=h.NKa)||void 0===r?void 0:r.gAc)&&ba.whb===(null===(A=h.NKa)||void 0===A?void 0:
A.whb)){L=ba.fBl;break}return L}nQm(b,h){let r="";if(!b)return r;for(let A=0;A<b.length;A++)if(b[A].DisplayColor.toLowerCase()===h.toLowerCase()){r=b[A].Color;break}return r}Nvd(b){b=Us[b];return b in this.sBd?{returnValue:!0,actionId:this.sBd[b]}:{returnValue:!1,actionId:0}}static gSm(){const b=[];b.push(Object.assign(new En,{Color:"0000C0",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));b.push(Object.assign(new En,{Color:"0000FF",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorRed),
DisplayColor:"#FF0000"}));b.push(Object.assign(new En,{Color:"00C0FF",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));b.push(Object.assign(new En,{Color:"00FFFF",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));b.push(Object.assign(new En,{Color:"50D092",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));b.push(Object.assign(new En,{Color:"50B000",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));
b.push(Object.assign(new En,{Color:"F0B000",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));b.push(Object.assign(new En,{Color:"C07000",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));b.push(Object.assign(new En,{Color:"602000",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));b.push(Object.assign(new En,{Color:"A03070",Alt:D.a.Mf(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return b}static WUm(b,
h){const r=b.properties.ka(Rc.a.thb,null);b=b.properties.getValue(Rc.a.lGe).split(" ");const A=[],L=[];for(let Ta=0;6>Ta;Ta++)for(let ob=0;10>ob;ob++){var ba=10*Ta+ob,ra=r[ba];ra=ra&4278190080|(ra&255)<<16|ra&65280|(ra&16711680)>>>16;ba=D.a.yL(ba+1<<24,8);var Ia=h[b[ob]];const nb=this.Axi(Ta,ob,r[ob]);nb.fBl=ba;L.push(nb);Ia=lp.Xtp(Ia,nb);A.push(Object.assign(new En,{Color:ba,DisplayColor:"#"+D.a.yL(ra,6),Alt:D.a.Mf(Ia)}))}return{eBl:A,Srp:L}}static Xtp(b,h){if(void 0===h.gAc&&void 0===h.whb)return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
b,h.bMg);const r=void 0!==h.whb;return String.format(r?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,b,h.bMg,r?h.whb:h.gAc)}static Axi(b,h,r){if(b){var A=r&255,L=(r&65280)>>>8;r=(r&16711680)>>>16;L=Math.floor((Math.min(Math.min(A,L),r)+Math.max(Math.max(A,L),r))/2);A=b-1;L?255===L?(b=!1,A=[242,217,191,166,128][A]):204<L?(b=!1,A=[230,191,128,64,26][A]):51>L?(b=!0,A=[26,64,128,191,230][A]):(L=[51,102,153],r=[191,128],A=(b=A<L.length)?L[A]:r[A-L.length]):
(b=!0,A=[128,166,191,217,242][A]);A=255-A;h={iGe:lp.hGe[h].name,bMg:lp.hGe[h].label};b?h.whb=Math.round(100*A/255):h.gAc=Math.round(100*A/255);return h}return{iGe:lp.hGe[h].name,bMg:lp.hGe[h].label}}static Kxp(b,h){if((h=h.properties.ka(Rc.a.thb,null))&&0<=b&&b<h.length){const r=b%10;return lp.Axi(Math.floor(b/10),r,h[r])}}}lp.hGe={0:{name:"background1",label:Box4Intl.Box4Strings.l_ThemeLabel1},1:{name:"text1",label:Box4Intl.Box4Strings.l_ThemeLabel2},2:{name:"background2",label:Box4Intl.Box4Strings.l_ThemeLabel3},
3:{name:"text2",label:Box4Intl.Box4Strings.l_ThemeLabel4},4:{name:"accent1",label:Box4Intl.Box4Strings.l_ThemeLabel5},5:{name:"accent2",label:Box4Intl.Box4Strings.l_ThemeLabel6},6:{name:"accent3",label:Box4Intl.Box4Strings.l_ThemeLabel7},7:{name:"accent4",label:Box4Intl.Box4Strings.l_ThemeLabel8},8:{name:"accent5",label:Box4Intl.Box4Strings.l_ThemeLabel9},9:{name:"accent6",label:Box4Intl.Box4Strings.l_ThemeLabel10}};Object(u.a)(lp,"ColorMenu",null,[495]);var oo=e(903),Qp=e(248),mu=e(367);class Vs extends Xf.a{constructor(b,
h){super(!1,!1,!0);this.lBl=(r,A)=>{1===r?(r=A.selectedColorText,6!==r.length?v.ULS.sendTraceTag(595345436,340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",r,this.qQ):(r=r.substring(4,6)+r.substring(2,4)+r.substring(0,2),y.AFrameworkApplication.va.Zb(this.IQe,2,r),v.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",this.qQ))):v.ULS.sendTraceTag(595345434,340,50,"Color picker dialog closed without selecting any color. Menu: {0}",
this.qQ)};this.qQ=b;this.IQe=h}pBb(b=0){const h={};h.initColor=Xl.a.zB(b);h.redLabel=Box4Intl.Box4Strings.L_FontColorRed;h.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue;h.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen;h.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;this.ti(Box4Intl.Box4Strings.L_MenuCustomColors,this.lBl,{["id"]:"ColorPickerDialog",["bodyControls"]:h});v.ULS.sendTraceTag(595345437,340,50,"Color picker dialog is opened. Menu: {0}",this.qQ)}}Object(u.a)(Vs,"ColorPickerDialog",Xf.a,
[]);var Mi=e(685),nu=e(425),kr=e(970);class wq{constructor(){this.lineStyle=Eh.a.NJ;this.etc=Eh.a.OJ;this.borderColor=Eh.a.l4}}Object(u.a)(wq,"TableBorderFormattingData",null,[]);class ag{static get oya(){return null!=ag.J$g?ag.J$g:ag.J$g=Sm.a.instance}static get Yd(){return null!=ag.pah?ag.pah:ag.pah=Xa.a.instance.Wa("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get K4j(){ag.aI||(ag.aI=new lp("TableBorder"),ag.Nha(ag.aI));return ag.aI}static get Oz(){ag.LAa||(ag.LAa=Xa.a.instance.Wa("WordEditor.ITableBorderManager"),
ag.LAa.initialize());return ag.LAa}static get pud(){if(null!=ag.a$g)var b=ag.a$g;else{var h;zi.a.rx("3g04j550;e0bc2179");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableBorderUx",!1);b=ag.a$g=b}return b}static mc(){const b=y.AFrameworkApplication.va,h=Ze.a.Z2a.k_c(r=>ag.Mkm(r));ag.pud?(b.qa(fb.a.aya,ic.a.view,ag.egb),b.qa(fb.a.aya,ic.a.table,ag.dgb),b.qa(fb.a.aya,ic.a.QH,ag.Nxa),b.Oc(fb.a.aya,4),b.qa(fb.a.Zpa,ic.a.view,ag.egb),b.qa(fb.a.Zpa,
ic.a.table,ag.dgb),b.qa(fb.a.Zpa,ic.a.QH,ag.Nxa),b.Oc(fb.a.Zpa,4),b.qa(fb.a.aqa,ic.a.view,ag.egb),b.qa(fb.a.aqa,ic.a.table,ag.dgb),b.qa(fb.a.aqa,ic.a.QH,ag.Nxa),b.Oc(fb.a.aqa,4),b.qa(fb.a.gya,ic.a.view,ag.egb),b.qa(fb.a.gya,ic.a.table,ag.dgb),b.qa(fb.a.gya,ic.a.QH,ag.Nxa),b.Oc(fb.a.gya,4),b.qa(fb.a.cya,ic.a.view,ag.egb),b.qa(fb.a.cya,ic.a.table,ag.dgb),b.qa(fb.a.cya,ic.a.QH,ag.Nxa),b.Oc(fb.a.cya,4),b.qa(fb.a.eya,ic.a.view,ag.egb),b.qa(fb.a.eya,ic.a.table,ag.dgb),b.qa(fb.a.eya,ic.a.QH,ag.Nxa),b.Oc(fb.a.eya,
4),b.qa(fb.a.fya,ic.a.view,ag.egb),b.qa(fb.a.fya,ic.a.table,ag.dgb),b.qa(fb.a.fya,ic.a.QH,ag.Nxa),b.Oc(fb.a.fya,4),b.qa(fb.a.bya,ic.a.view,ag.egb),b.qa(fb.a.bya,ic.a.table,ag.dgb),b.qa(fb.a.bya,ic.a.QH,ag.Nxa),b.Oc(fb.a.bya,4),b.qa(fb.a.Wla,ic.a.view,ag.egb),b.qa(fb.a.Wla,ic.a.table,ag.dgb),b.qa(fb.a.Wla,ic.a.QH,ag.Nxa)):(b.qa(fb.a.aya,ic.a.view,ag.hgb),b.qa(fb.a.aya,ic.a.table,ag.ggb),b.Oc(fb.a.aya,4),b.qa(fb.a.Zpa,ic.a.view,ag.hgb),b.qa(fb.a.Zpa,ic.a.table,ag.ggb),b.Oc(fb.a.Zpa,4),b.qa(fb.a.aqa,
ic.a.view,ag.hgb),b.qa(fb.a.aqa,ic.a.table,ag.ggb),b.Oc(fb.a.aqa,4),b.qa(fb.a.gya,ic.a.view,ag.hgb),b.qa(fb.a.gya,ic.a.table,ag.ggb),b.Oc(fb.a.gya,4),b.qa(fb.a.cya,ic.a.view,ag.hgb),b.qa(fb.a.cya,ic.a.table,ag.ggb),b.Oc(fb.a.cya,4),b.qa(fb.a.eya,ic.a.view,ag.hgb),b.qa(fb.a.eya,ic.a.table,ag.ggb),b.Oc(fb.a.eya,4),b.qa(fb.a.fya,ic.a.view,ag.hgb),b.qa(fb.a.fya,ic.a.table,ag.ggb),b.Oc(fb.a.fya,4),b.qa(fb.a.bya,ic.a.view,ag.hgb),b.qa(fb.a.bya,ic.a.table,ag.ggb),b.Oc(fb.a.bya,4),b.qa(fb.a.Wla,ic.a.view,
ag.hgb),b.qa(fb.a.Wla,ic.a.table,ag.ggb));b.Oc(fb.a.Wla,4);b.qa(fb.a.$te,ic.a.view,ag.$te);b.qa(fb.a.pea,ic.a.view,ag.QBe);b.qa(fb.a.pea,ic.a.m_,ag.PBe);b.qa(fb.a.pea,ic.a.QH,ag.Nxa);b.Oc(fb.a.pea,4);b.qa(fb.a.Zxb,ic.a.view,ag.QBe);b.qa(fb.a.Zxb,ic.a.m_,ag.PBe);b.qa(fb.a.Zxb,ic.a.QH,ag.Nxa);b.Oc(fb.a.Zxb,4);b.qa(fb.a.Klg,ic.a.view,ag.K5);b.Oc(fb.a.Klg,4);b.qa(fb.a.m2a,ic.a.view,ag.QBe);b.qa(fb.a.m2a,ic.a.m_,ag.PBe);b.qa(fb.a.m2a,ic.a.QH,ag.Nxa);b.Oc(fb.a.m2a,4);b.nb(fb.a.Nwc,ic.a.view,ag.Nwc,1124);
b.qa(fb.a.n2a,ic.a.view,ag.QBe);b.qa(fb.a.n2a,ic.a.m_,ag.PBe);b.qa(fb.a.n2a,ic.a.QH,ag.Nxa);b.Oc(fb.a.n2a,4);b.nb(fb.a.Owc,ic.a.view,ag.Owc,1124);b.qa(fb.a.EPa,ic.a.view,h);b.qa(fb.a.EPa,ic.a.m_,ag.EPa);b.qa(fb.a.EPa,ic.a.QH,ag.EPa);b.Oc(fb.a.EPa,97)}static UK(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport",
"WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}static hgb(b,h,r,A){if(1===r)return 32;if(!h.view.Ee)return 2;const L=h.view;if(!L.ub||!L.ub.ob)return 8;h=L.ub.ob;if(2===r){v.ULS.sendTraceTag(578027873,306,50,"Selecting table border using border gallery");if((r=Tb.SelectionFactory.zDc(h))&&Qh.TableReader.pP(r))return y.AFrameworkApplication.va.Sf(vc.a.create(r),b,2,!1,A,null);r=L.ub.hh;if(!r)return 8;A=Object(ak.a)().tT(r,16);r=Object(ak.a)().zV(r,14);if(!r)return oo.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],uf.a.pva),8;if(!ag.nHe(r.node,A,h))return 8;b=kr.getTableCellBorderContext(Qp.TableBorderSelectionCache.q$,Qp.TableBorderSelectionCache.RMa(),b);if(!b||0>=b.length)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;Qp.TableBorderSelectionCache.Igb(b);b=Tb.SelectionFactory.Kqb(b,!0);h=null;b&&(h=Tb.SelectionFactory.kca(b));if(!h||0>=h.currentSelection.length)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],
uf.a.pva),8;Fg.a.instance.$W(h)}return 32}static ggb(b,h,r){if(1===r)return 32;if(2!==r||14!==h.node.type)return 2;b=kr.getTableBorderContext(h.node,b);if(!b)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;b=Tb.SelectionFactory.wPb(b,!0);h=null;b&&(h=Tb.SelectionFactory.kca(b));if(!h||0>=h.currentSelection.length)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;Fg.a.instance.$W(h);return 32}static $te(b,
h,r,A,L){if(1===r)return 32;b=h.contextId===ic.a.view?fn.a.instance.lTb(h):mu.a.yPf(h);if(!b)return 8;h=new wq;r="";32===y.AFrameworkApplication.va.Zb(fb.a.EPa,2,h)&&h&&(r=h.borderColor);ag.K4j.dea=r;b=ag.K4j.Gsb(b,Ze.a.tWa);if(!b)return 8;L.MenuItems=b;v.ULS.sendTraceTag(578027874,340,50,"Table border color dropdown menu is opened.");return 32}static egb(b,h,r,A,L){if(!ag.Oz)return 2;if(1===r)return 32;if(!h.view.Ee)return 2;var ba=h.view;if(!ba.ub||!ba.ub.ob)return 8;h=ba.ub.ob;if(2===r){v.ULS.sendTraceTag(507892416,
306,50,"Selecting and setting table border using border gallery menu");$d.a("SetTableBorderWithSelection");if((r=Tb.SelectionFactory.zDc(h))&&Qh.TableReader.pP(r))return y.AFrameworkApplication.va.Sf(vc.a.create(r),b,2,!1,A,null);ba=ba.ub.hh;if(!ba)return 8;r=Object(ak.a)().tT(ba,16);ba=Object(ak.a)().zV(ba,14);if(!ba)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;if(!ag.nHe(ba.node,r,h))return 8;h=kr.getTableCellBorderContext(Qp.TableBorderSelectionCache.q$,
Qp.TableBorderSelectionCache.RMa(),b);if(!h||0>=h.length)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;Qp.TableBorderSelectionCache.Igb(h);ba=Tb.SelectionFactory.Kqb(h,!0);r=null;ba&&(r=Tb.SelectionFactory.kca(ba));if(!r||0>=r.currentSelection.length)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;const ra=Mt.a.iCa(h);if(!ra)return 8;ag.UK();ba=new hb.GraphTransaction(15);ba.Eb(h[0].node);ba.Bh=b;Fg.a.instance.$W(r);
b=y.AFrameworkApplication.va.Sf(ra,b,2,!0,A,L);ba.dispose();return b}return 32}static dgb(b,h,r,A,L){if(!ag.Oz)return 2;if(1===r)return 32;if(2!==r||14!==h.node.type)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.Dkc),2;r=kr.getTableBorderContext(h.node,b);if(!r)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8;r=Tb.SelectionFactory.wPb(r,!0);A=null;r&&(A=Tb.SelectionFactory.kca(r));return!A||0>=A.currentSelection.length?
(oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.pva),8):ag.KAg(b,h,L,A,!0)?32:(oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.Dkc),8)}static QBe(b,h,r,A,L){if(!ag.Oz)return 2;if(1===r)return 32;if(!h.view.Ee)return 2;var ba=h.view;if(!ba.ub||!ba.ub.ob)return 8;h=ba.ub.ob;if(2===r){v.ULS.sendTraceTag(578027875,306,50,"Setting table border property for the command: {0} with action data {1}",b,ag.E4c(b,L));r=Tb.SelectionFactory.o$j(h);
if(!r){const ra=Tb.SelectionFactory.zDc(h);ra&&14===ra.type&&(r=pl.TableNodeBorderContext.Lma(ra,4))}$d.a("SetTableBorder");if(r)return y.AFrameworkApplication.va.Sf(r,b,2,!0,A,L);r=Tb.SelectionFactory.iOg(h);if(!r||0>=r.length){r=ba.ub.hh;if(!r)return 8;ba=Object(ak.a)().tT(r,16);r=Object(ak.a)().zV(r,14);if(!r||!ag.nHe(r.node,ba,h))return 8;r=kr.getTableCellBorderContext(Qp.TableBorderSelectionCache.q$,Qp.TableBorderSelectionCache.RMa(),fb.a.Wla);if(!r||0>=r.length)return 8}ba=Mt.a.iCa(r);if(!ba)return 8;
ag.pud?b=y.AFrameworkApplication.va.Sf(ba,b,2,!0,A,L):(ag.UK(),h=new hb.GraphTransaction(15),h.Eb(r[0].node),h.Bh=b,b=y.AFrameworkApplication.va.Sf(ba,b,2,!0,A,L),h.dispose());return b}return 32}static PBe(b,h,r,A,L){if(!ag.Oz)return 2;if(1===r)return 32;if(2!==r||h.contextId!==ic.a.m_)return oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.Dkc),2;v.ULS.sendTraceTag(578027904,306,50,"Setting table border property for the table border for the command: {0} with action data {1}",
b,ag.E4c(b,L));A=!0;if(ag.pud)A=ag.KAg(b,h,L);else{r=h.node;A=new no;let ba=0;({yKg:A,property:ba}=ag.jxf(r,b,L,A,ba));ag.UK();L=new hb.GraphTransaction(15);L.Eb(r);L.Bh=b;if(A=ag.Oz.ySj(h,A,ba))b=new te.a,b.set(r),Lh.b(b,ra=>{ra.currentNode.vm(4,!0);return!0});L.dispose();A&&ag.Yd&&ag.Yd.Vv(16)}return A?32:(oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.Dkc),8)}static Nxa(b,h,r,A,L){if(!ag.Oz)return 2;if(1===r)return 32;if(2!==r||h.contextId!==ic.a.QH)return oo.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],uf.a.Dkc),2;v.ULS.sendTraceTag(578027905,306,50,"Setting table border property for the cell border for the command: {0} with action data {1}",b,ag.E4c(b,L));if(ag.pud)b=ag.KAg(b,h,L);else{r=h.node;A=new no;let ba=0;({yKg:A,property:ba}=ag.jxf(r,b,L,A,ba));(b=ag.Oz.yAe(Ej.a.cW(h),h,A,ba))&&ag.Yd&&ag.Yd.Vv(16)}return b?32:(oo.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],uf.a.Dkc),8)}static K5(b,h,r){if(1===r)return 32;Db.StaticActiveAppFrame.Aa().dismissFloatie();
ag.MHa=new Vs("TableBorder",fb.a.pea);ag.MHa.pBb(0);return 32}static Nwc(b,h,r,A,L){if(!ag.Oz)return 8;if(1===r)return 32;b=ag.Oz.jJf();L.MenuItems=b;return 32}static Owc(b,h,r,A,L){if(!ag.Oz)return 8;if(1===r)return 32;b=ag.Oz.kJf();L.MenuItems=b;return 32}static EPa(b,h,r,A,L){if(!ag.Oz)return 2;if(!Ee.a.hdd(h)&&!Ee.a.idd(h))return 8;b=Object(ya.a)(wq,L);if(!b)return 8;Ee.a.hdd(h)?ag.Oz.kto(h,b):ag.Oz.Hro(h,b);return 32}static nHe(b,h,r){if(!b||14!==b.type)return v.ULS.sendTraceTag(578027906,306,
15,"Table node must be present"),!1;if(!h)return v.ULS.sendTraceTag(578027907,306,15,"Cell context must be present"),!1;if(r&&r.currentSelection&&r.currentSelection.pf&&r.currentSelection.pf.Ya&&r.currentSelection.pf.Ya.contextId===ic.a.QH&&Qp.TableBorderSelectionCache.RMa()&&0<Qp.TableBorderSelectionCache.RMa().length)return!0;Qp.TableBorderSelectionCache.B$c(b);r=Qp.TableBorderSelectionCache.q$;for(let L=0;L<h.length;L++){if(h.getContext(L).contextId!==ic.a.Vy)return!1;const ba=h.getContext(L).node;
if(!ih.TableCellReader.Js(ba)){var A=new te.a;A.set(ba);if(A.Ib(14)&&Lh.c(A)===b){A.xd(14);A=ih.TableCellReader.Bua(A,ba);if(!A)return!1;Array.add(Qp.TableBorderSelectionCache.RMa(),new Mi.a(ba,A.rowIndex,A.lo,ba.rowSpan,ba.colSpan));r.leftMostColumnSelected=Math.min(r.leftMostColumnSelected,A.lo);r.rightMostColumnSelected=Math.max(r.rightMostColumnSelected,A.lo);r.topMostRowSelected=Math.min(r.topMostRowSelected,A.rowIndex);r.bottomMostRowSelected=Math.max(r.bottomMostRowSelected,A.rowIndex)}}}Qp.TableBorderSelectionCache.q$=
r;return!0}static Nha(b){b.bH(3,fb.a.pea);b.bH(4,fb.a.pea);b.q8a(nu.a.instance,1)}static Mkm(b){const h=b.ob;var r=Tb.SelectionFactory.o$j(h);if(!r){const A=Tb.SelectionFactory.zDc(h);A&&14===A.type&&(r=pl.TableNodeBorderContext.Lma(A,4))}if(r)return Mt.a.iCa([r]);r=Tb.SelectionFactory.iOg(h);if(!r||0>=r.length){r=b.hh;if(!r)return null;b=Object(ak.a)().tT(r,16);r=Object(ak.a)().zV(r,14);if(!r||!ag.nHe(r.node,b,h))return null;r=kr.getTableCellBorderContext(Qp.TableBorderSelectionCache.q$,Qp.TableBorderSelectionCache.RMa(),
fb.a.Wla);if(!r||0>=r.length)return null}return Mt.a.iCa(r)}static jxf(b,h,r,A,L){switch(h){case fb.a.Wla:case fb.a.aya:case fb.a.gya:case fb.a.Zpa:case fb.a.aqa:case fb.a.fya:case fb.a.bya:case fb.a.cya:case fb.a.eya:A.weight=Eh.a.pfk;A.style=Eh.a.rfk;A.color=Eh.a.qfk;break;case fb.a.pea:A.color=ag.oya.sma(b,r);L=3;break;case fb.a.Zxb:A.style="none";L=2;break;case fb.a.m2a:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.style=ag.Oz.hzi(b.MenuItemId));L=2;break;case fb.a.n2a:(b="object"===typeof r?
r:null)&&"MenuItemId"in b&&(A.weight=ag.Oz.izi(b.MenuItemId)),L=1}return{yKg:A,property:L}}static E4c(b,h){let r="";if(!h)return r;switch(b){case fb.a.pea:r=h;break;case fb.a.Zxb:r="none";break;case fb.a.m2a:case fb.a.n2a:(b="object"===typeof h?h:null)&&"MenuItemId"in b&&(r=b.MenuItemId)}return r}static KAg(b,h,r,A=null,L=!1){const ba=h.node;let ra;ra=L?kr.getTableBorderContext(ba,b):h;let Ia=new no,Ta=0;({yKg:Ia,property:Ta}=ag.jxf(ba,b,r,Ia,Ta));ag.UIp(b,Ia);r=!0;const ob=new hb.GraphTransaction(15);
ob.Eb(ba);ob.Bh=b;A&&L&&Fg.a.instance.$W(A);h.contextId===ic.a.m_||h.contextId===ic.a.table?r=ag.Oz.ySj(ra,Ia,Ta):h.contextId===ic.a.QH&&(r=ag.Oz.yAe(Ej.a.cW(h),ra,Ia,Ta));h.contextId!==ic.a.m_&&h.contextId!==ic.a.table||!r||(b=new te.a,b.set(ba),Lh.b(b,nb=>{nb.currentNode.vm(4,!0);return!0}));ob.dispose();r&&ag.Yd&&ag.Yd.Vv(16);ag.UK();return r}static UIp(b,h){switch(b){case fb.a.pea:Eh.a.qfk=h.color;break;case fb.a.m2a:Eh.a.rfk=h.style;break;case fb.a.n2a:Eh.a.pfk=h.weight}}}ag.aI=null;ag.MHa=null;
ag.LAa=null;Object(u.a)(ag,"TableBorderActor",null,[]);class Vf{constructor(){this.eXd=[new Qj(Vf.p3b,"","2",1,8,0,"Solid Line"),new Qj(Vf.UPb,"5,3","1",1,8,0,"Dashed Line"),new Qj(Vf.vQb,"1,1","1",1,8,0,"Dotted Line"),new Qj(Vf.xQb,"","1",2,8,3,"Double Line")];this.fXd=[new Qj(Vf.ENb,"","1",1,8,0,"0.25pt"),new Qj(Vf.CNb,"","1",1,8,0,"0.5pt"),new Qj(Vf.HNb,"","2",1,8,0,"0.75pt"),new Qj(Vf.DNb,"","2",1,8,0,"1pt"),new Qj(Vf.BNb,"","3",1,8,0,"1.5pt"),new Qj(Vf.INb,"","4",1,8,0,"2.25pt"),new Qj(Vf.GNb,
"","4",1,8,0,"3pt"),new Qj(Vf.ANb,"","5",1,8,0,"4.5pt"),new Qj(Vf.FNb,"","6",1,8,0,"6pt")]}initialize(){this.wnd()}jJf(){const b=new vq("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.eXd,fb.a.m2a,fb.a.Hsg);return this.Blc(b)}kJf(){const b=new vq("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.fXd,fb.a.n2a,fb.a.Isg);return this.Blc(b)}hzi(b){switch(b){case Vf.p3b:return Eh.a.npb;case Vf.UPb:return Eh.a.lpb;case Vf.vQb:return Eh.a.ZWc;
case Vf.xQb:return Eh.a.n8;default:return Eh.a.yBa}}izi(b){switch(b){case Vf.ENb:return Eh.a.XWc;case Vf.CNb:return Eh.a.dof;case Vf.HNb:return Eh.a.L8a;case Vf.DNb:return Eh.a.xBa;case Vf.BNb:return Eh.a.l8;case Vf.INb:return Eh.a.gma;case Vf.GNb:return Eh.a.m8;case Vf.ANb:return Eh.a.wBa;case Vf.FNb:return Eh.a.fma;default:return Eh.a.OJ}}Blc(b){const h=new dk.a,r=new Zd.a,A=Object.assign(new Ul.a,{Id:b.T7d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.tFf,Type:4,Width:1,GalleryItems:[]});for(const ba of b.Ckf){var L=
{};const ra={};ra.width=Vf.$Gn;ra.height=Vf.ZGn;L.root=ra;L=Object.assign(new wk.a,{Id:ba.N8a,ExternalId:String.format("{0}_GalleryButton",ba.N8a),Icon:ba.N8a,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ba.N8a,FullIconStyle:L,ShouldSetTitle:"true",Alt:ba.altText});A.GalleryItems.push(L)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(A);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}wnd(){const b={};for(const h of this.eXd)b[h.N8a]=appChrome.buildBorderStyleIcon(h.Ptd,
h.width,h.yhd,h.height,h.Fed);for(const h of this.fXd)b[h.N8a]=appChrome.buildBorderStyleIcon(h.Ptd,h.width,h.yhd,h.height,h.Fed);appChrome.api.registerIconProvider(()=>b)}ySj(b,h,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==ic.a.m_)return v.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.h6(Ej.a.cW(b),b.node,5,r,h);break;case 0:this.h6(Ej.a.cW(b),
b.node,3,r,h);break;case 1:this.h6(Ej.a.cW(b),b.node,4,r,h);break;case 3:this.h6(Ej.a.cW(b),b.node,0,r,h);break;case 7:this.h6(Ej.a.cW(b),b.node,1,r,h);break;case 8:this.h6(Ej.a.cW(b),b.node,2,r,h);break;case 6:this.h6(Ej.a.cW(b),b.node,1,r,h);this.h6(Ej.a.cW(b),b.node,2,r,h);break;case 5:this.h6(Ej.a.cW(b),b.node,3,r,h);this.h6(Ej.a.cW(b),b.node,5,r,h);this.h6(Ej.a.cW(b),b.node,4,r,h);this.h6(Ej.a.cW(b),b.node,0,r,h);break;case 4:this.h6(Ej.a.cW(b),b.node,3,r,h),this.h6(Ej.a.cW(b),b.node,5,r,h),
this.h6(Ej.a.cW(b),b.node,4,r,h),this.h6(Ej.a.cW(b),b.node,0,r,h),this.h6(Ej.a.cW(b),b.node,1,r,h),this.h6(Ej.a.cW(b),b.node,2,r,h)}return!0}yAe(b,h,r,A){if(!h)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==ic.a.QH)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var L=h.node;const ba=new te.a;ba.set(L);ba.Ib(14);L=ih.TableCellReader.VXa(ba);switch(h.border){case 2:this.$1a(b,
h.node,5,A,r,L);this.vBe(h.node,5,r);this.vAe(b,h.pab(),3,r,A,L);break;case 0:this.$1a(b,h.node,3,A,r,L);this.vBe(h.node,3,r);this.vAe(b,h.pab(),1,r,A,L);break;case 1:this.$1a(b,h.node,4,A,r,L);this.vBe(h.node,4,r);this.vAe(b,h.pab(),0,r,A,L);break;case 3:this.$1a(b,h.node,0,A,r,L),this.vBe(h.node,0,r),this.vAe(b,h.pab(),2,r,A,L)}return!0}kto(b,h){if(Ee.a.hdd(b)&&h)switch(b=Object(ya.a)(pl.TableNodeBorderContext,b),b.border){case 2:this.BT(b.node,Vf.Lq.$Q(5),h);break;case 0:this.BT(b.node,Vf.Lq.$Q(3),
h);break;case 3:this.BT(b.node,Vf.Lq.$Q(0),h);break;case 1:this.BT(b.node,Vf.Lq.$Q(4),h);break;case 7:this.BT(b.node,Vf.Lq.$Q(1),h);break;case 8:this.BT(b.node,Vf.Lq.$Q(2),h);break;case 5:h=this.BT(b.node,Vf.Lq.$Q(5),h);h=this.BT(b.node,Vf.Lq.$Q(3),h);h=this.BT(b.node,Vf.Lq.$Q(0),h);this.BT(b.node,Vf.Lq.$Q(4),h);break;case 6:h=this.BT(b.node,Vf.Lq.$Q(1),h);this.BT(b.node,Vf.Lq.$Q(2),h);break;case 4:h=this.BT(b.node,Vf.Lq.$Q(5),h),h=this.BT(b.node,Vf.Lq.$Q(3),h),h=this.BT(b.node,Vf.Lq.$Q(0),h),h=this.BT(b.node,
Vf.Lq.$Q(4),h),h=this.BT(b.node,Vf.Lq.$Q(1),h),this.BT(b.node,Vf.Lq.$Q(2),h)}}Hro(b,h){if(Ee.a.idd(b)&&h)switch(b=Object(ya.a)(pl.TableNodeBorderContext,b),b.border){case 2:this.BT(b.node,Vf.Lq.wT(5),h);break;case 0:this.BT(b.node,Vf.Lq.wT(3),h);break;case 3:this.BT(b.node,Vf.Lq.wT(0),h);break;case 1:this.BT(b.node,Vf.Lq.wT(4),h)}}Y4c(b,h,r){r=null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(h.size)&&(r=new no,r.weight=b.properties.ka(h.size,
Eh.a.OJ),r.style=b.properties.ka(h.style,Eh.a.yBa),r.color=b.properties.ka(h.color,0));return r}tCg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}L0b(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):v.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}h6(b,h,r,A,L){ag.pud||(L=this.mIp(b,h,r,A,L));this.Czc(h,Vf.Lq.$Q(r),L);switch(r){case 5:this.Lzb(h,2,A,L);break;case 4:this.Lzb(h,1,A,L);break;case 0:this.Lzb(h,3,A,L);break;case 3:this.Lzb(h,0,A,L);break;case 1:this.Lzb(h,7,A,L);break;case 2:this.Lzb(h,8,A,L)}}mIp(b,h,r,A,L){if(3!==A){var ba=Vf.th.u9d(b,h,r,3);void 0!==ba&&null!==ba&&ba!==Eh.a.l4&&(ba=Xl.a.Myc(ba),L.color=Vf.oya.sma(h,ba))}1!==A&&(ba=Vf.th.u9d(b,h,r,1),void 0!==ba&&null!==ba&&ba!==Eh.a.NJ&&(L.weight=
parseFloat(ba)*Eh.a.YWc));2!==A&&(b=Vf.th.u9d(b,h,r,2),void 0!==b&&null!==b&&b!==Eh.a.NJ&&(L.style=b));return L}$1a(b,h,r,A,L,ba){A&&(L=this.VCp(b,h,ba,r,A,L));this.Czc(h,Vf.Lq.wT(r),L)}VCp(b,h,r,A,L,ba){if(3!==L){var ra="",Ia=Vf.th.zSb(b,h,A,!1,!0,r,3);Ia&&(ra=Ia.KNb);void 0!==ra&&null!==ra&&ra!==Eh.a.l4&&(ra=Xl.a.Myc(ra),ba.color=Vf.oya.sma(h,ra))}if(1!==L){ra="";if(Ia=Vf.th.zSb(b,h,A,!1,!0,r,1))ra=Ia.KNb;void 0!==ra&&null!==ra&&ra!==Eh.a.NJ&&(ba.weight=parseFloat(ra)*Eh.a.YWc)}if(2!==L){L="";if(b=
Vf.th.zSb(b,h,A,!1,!0,r,2))L=b.KNb;void 0!==L&&null!==L&&L!==Eh.a.NJ&&(ba.style=L)}return ba}vVn(b){let h=0,r=0;({XUn:h,ASn:r}=this.LGm(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}LGm(b,h,r){switch(b){case Eh.a.npb:case Eh.a.lpb:case Eh.a.ZWc:h=2;r=48;break;case Eh.a.n8:h=2;r=24;break;default:h=2,r=48}return{XUn:h,ASn:r}}vAe(b,h,r,A,L,ba){if(h)if(A)for(let ra=0;ra<h.length;ra++)switch(r){case 2:this.$1a(b,h[ra],5,L,A,ba);break;case 0:this.$1a(b,h[ra],3,L,A,ba);break;case 1:this.$1a(b,
h[ra],4,L,A,ba);break;case 3:this.$1a(b,h[ra],0,L,A,ba)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}vBe(b,h,r){const A=new te.a;A.set(b);A.Ib(14);const L=ih.TableCellReader.tha(b);b=ih.TableCellReader.IL(b);Lh.a(A,L,b,(ba,ra,Ia)=>{ba=ba.currentNode;ih.TableCellReader.Js(ba)&&0==Ia&&0<ra&&this.Czc(ba,Vf.Lq.wT(h),r)})}Czc(b,h,r){b?(r=this.vVn(r),b.properties.setValue(h.color,
r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}Lzb(b,h,r,A){if(b){var L=Qh.TableReader.Hg(b),ba=Qh.TableReader.Nh(b),ra=new te.a,Ia=[];for(let Ta=0;Ta<L;Ta++)for(let ob=0;ob<ba;ob++)if(ra.set(b),Lh.f(ra,Ta,ob),ra&&ra.currentNode&&!ih.TableCellReader.eh(ra))switch(h){case 2:ih.TableCellReader.foa(ra)&&Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,2));break;case 0:ih.TableCellReader.goa(ra)&&
Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,0));break;case 3:ih.TableCellReader.r2f(b,ra.currentNode)&&Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,3));break;case 1:ih.TableCellReader.s2f(b,ra.currentNode)&&Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,1));break;case 7:ih.TableCellReader.s2f(b,ra.currentNode)||Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,1));break;case 8:ih.TableCellReader.r2f(b,ra.currentNode)||Ia.push(pl.TableNodeBorderContext.gca(ra.currentNode,
3))}for(b=0;b<Ia.length;b++)switch(h=Ia[b],h.border){case 2:this.Rnd(h.node,Vf.Lq.wT(5),r,A);this.vxe(h.pab(),Vf.Lq.wT(0),r,A);break;case 0:this.Rnd(h.node,Vf.Lq.wT(3),r,A);this.vxe(h.pab(),Vf.Lq.wT(4),r,A);break;case 1:this.Rnd(h.node,Vf.Lq.wT(4),r,A);this.vxe(h.pab(),Vf.Lq.wT(3),r,A);break;case 3:this.Rnd(h.node,Vf.Lq.wT(0),r,A),this.vxe(h.pab(),Vf.Lq.wT(5),r,A)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}vxe(b,h,r,A){if(b)for(let L=0;L<b.length;L++)this.Rnd(b[L],
h,r,A);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}Rnd(b,h,r,A){if(b){var L=b.ka(h.color,Vf.r0c),ba=b.ka(h.size,Vf.Qic),ra=b.ka(h.style,Vf.Pic),Ia=new no;Ia.weight=A.weight;Ia.style=A.style;Ia.color=A.color;2!==r||L===Vf.r0c&&ba===Vf.Qic?3!==r||ra===Vf.Pic&&ba===Vf.Qic?1!==r||L===Vf.r0c&&ra===Vf.Pic?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ia.color=L,Ia.style=ra,this.Czc(b,h,Ia)):(Ia.style=
ra,Ia.weight=ba,this.Czc(b,h,Ia)):(Ia.color=L,Ia.weight=ba,this.Czc(b,h,Ia))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}BT(b,h,r){var A=b.properties.ka(h.style,Eh.a.NJ);A!==Eh.a.NJ&&(r.lineStyle!==Eh.a.NJ?r.lineStyle!==A&&(r.lineStyle=Eh.a.Xkl):r.lineStyle=A);A=b.properties.ka(h.size,Eh.a.OJ);A!==Eh.a.OJ&&(r.etc!==Eh.a.OJ?r.etc!==A&&(r.etc=Eh.a.Lkl):r.etc=A);b=b.properties.ka(h.color,0);b=Xl.a.zB(b);b!==Eh.a.l4&&(r.borderColor!==Eh.a.l4?r.borderColor!==b&&(r.borderColor=
Eh.a.Dkl):r.borderColor=b);return r}static get Lq(){return null!=Vf.eXg?Vf.eXg:Vf.eXg=Eh.a.instance}static get th(){return null!=Vf.Wbh?Vf.Wbh:Vf.Wbh=Xa.a.instance.Wa("WordEditor.IWACTableStyleReader")}static get oya(){return null!=Vf.L$g?Vf.L$g:Vf.L$g=Sm.a.instance}}Vf.$Gn="110px";Vf.ZGn="20px";Vf.p3b="SolidLineStyle";Vf.UPb="DashedLineStyle";Vf.vQb="DottedLineStyle";Vf.xQb="DoubleLineStyle";Vf.ENb="BorderPointSizeOneQuarter";Vf.CNb="BorderPointSizeOneHalf";Vf.HNb="BorderPointSizeThreeQuarters";
Vf.DNb="BorderPointSizeOne";Vf.BNb="BorderPointSizeOneAndHalf";Vf.INb="BorderPointSizeTwoAndQuarter";Vf.GNb="BorderPointSizeThree";Vf.ANb="BorderPointSizeFourAndHalf";Vf.FNb="BorderPointSizeSix";Vf.Pic="single";Vf.Qic=4;Vf.r0c=0;Object(u.a)(Vf,"TableBorderManager",null,[620]);var Gs=e(890),yp=e(55),ou=e(220);class gv{constructor(b,h){this.DGh=this.zBh=null;this.gWa=b;this.NDh=h}get Vvj(){return this.NDh}get uwa(){return this.zBh}get eug(){return this.DGh}dVj(b,h){this.DGh=b;this.zBh=h}J3o(b){this.NDh=
b}}Object(u.a)(gv,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var Gi=e(58),zp=e(201),yl=e(371),xq=e(155),Ap=e(237),Ws=e(482),wy=e(78),xy=e(499),BC=e(1065);class Oh extends Gs.a{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb=null,Eb=null){super(b,h,r,Eb,nb);this.yjb=BC.a.instance;this.sa=new Nf.a;this.p5h=[Rc.a.XBc,Rc.a.XBb,Rc.a.S3b,Rc.a.VBc,Rc.a.VBb,Rc.a.Q3b,Rc.a.UBc,Rc.a.UBb,Rc.a.P3b,Rc.a.WBc,Rc.a.WBb,Rc.a.R3b];this.gwk=[Rc.a.ya,Rc.a.xa,Sb.a.Ki,Sb.a.au];this.oj=A;this.rLb=L;this.td=ba;this.pb=
ra;this.Daa=Ia;this.wn=Ta;this.MKc=ob;this.RNh=nb;this.$Wk=Eb;this.zqo=this.irg.bind(this)}get fl(){return this.oj.value}get Bv(){return this.Daa?this.Daa.instance:null}vjf(b){this.sa.addHandler("OnParagraphDelete",b)}get ii(){return!!this.MKc.instance&&this.MKc.instance.ii}W$c(b,h,r,A,L){h.setValue(Rc.a.qd,of.a.BG());h.setValue(Rc.a.Dnn,L);Ws.c(A,h,[Rc.a.t6]);super.W$c(b,h,r,A,L)}nfe(b,h,r,A,L){const ba=this.w8c(h,r,A,L);this.v0d(ba,h,!1);return super.nfe(b,h,r,A,L)}eUd(b,h,r,A,L){const ba=this.w8c(h,
r,A,L);this.v0d(ba,h,!0);super.eUd(b,h,r,A,L);return ba}mvf(b,h,r,A){h=this.w8c(b,h,r,A);this.v0d(h,b,!0);return h}insertRows(b,h,r,A){const L=yp.a.fv(b),ba=new te.a;ba.Ad(b);const ra=ba.currentNode;ba.ic(1);let Ia;Ia=h?b.dR(1):b.currentNode;const Ta=b.Ac();if(!Ta)throw Error.create("table row insertion cannot be performed on a null tableNode");const ob=Qh.TableReader.Hg(Ta),nb=Ta.r4.th;let Eb=!1;try{Ta.XFa=1;const bc=this.yjb.btb(Ta,nb.VI(Ta));this.l2a(b.currentNode);this.vya(b);this.o3k(r,b,Ia,
ba,ra,h,A);const Bc=this.yjb.btb(Ta,nb.VI(Ta));this.Egb(Ta,Qh.TableReader.Hg(Ta)+r);Eb=!0;this.Zfe(Ta,bc,Bc)}finally{Ta.XFa=0,Eb||this.Egb(Ta,Qh.TableReader.Hg(Ta)+r)}L+1!==ob||h?!L&&h&&Oh.$Zf(Ta,r):Oh.$Zf(Ta,L);h=L+r+(h?0:1);h<ob+r&&this.zZi(Ta,h);return b.currentNode}o3k(b,h,r,A,L,ba,ra){let Ia=null,Ta=null;for(var ob=0;ob<b;++ob){var nb=ou.a.instance.createInstance(on.a.fqa);Ta||(Ta=nb);Ia=nb;this.W$c(h,nb,r,L,ba)}b=Qh.TableReader.Nh(h.currentNode);r=!0;do{r?(h.yk(Ia),r=!1):h.gg(1);L=Array(b);
for(ob=0;ob<b;++ob){nb=this.NWa();const Eb=this.mvf(nb,A.currentNode,ba,!0);let bc=null;Eb.eh||(bc=ra(Eb));L[ob]=new gv(nb,bc);L[ob].dVj(Eb,null);A.gg(1)}for(ob=0;ob<b;++ob)nb=L[ob].gWa,h.a8(nb,1,Gs.a.kTa?Gs.a.kTa():null),ih.TableCellReader.Js(nb)||(this.aNb(h,nb,L[ob].Vvj),this.vci(L[ob].eug,nb,!0));A.Ina(1)}while(h.currentNode!==Ta)}insertColumns(b,h,r,A,L){let ba=b.currentNode,ra=!1,Ia=Qh.TableReader.Nh(b.currentNode);const Ta=Ia;try{this.l2a(b.currentNode);this.vya(b);const ob=ba.r4.th;ba.XFa=
1;const nb=this.yjb.btb(ba,ob.VI(ba));Ia=Qh.TableReader.Nh(b.currentNode);-1===h&&(h=Ia);this.m3k(b,A,r,h,L);ba=b.currentNode;Ia+=A;this.Ktg(b,Ia,A,h);ra=!0;const Eb=this.yjb.btb(ba,ob.VI(ba));this.Zfe(ba,nb,Eb)}finally{ba.XFa=0,ra||this.Ktg(b,Ia,A,h)}h!==Ta||r?!h&&r&&Oh.ZZf(ba,A):Oh.ZZf(ba,h-1)}m3k(b,h,r,A,L){var ba=b.currentNode;A=r?A:A-1;b.ic(1);var ra=new Cb.a;do{var Ia=b.xp(A,1);b.Ac();var Ta=Array(h);for(let nb=0;nb<h;++nb){var ob=this.NWa();const Eb=this.CIm(b,Ia,r),bc=this.mvf(ob,Ia,r,!1);
ob=new gv(ob,null);ob.dVj(bc,Eb);Ta[nb]=ob}ra.add(Ta)}while(b.Di(1));r=ra.toArray();for(A=0;A<r.length;A++)for(ra=0;ra<h;ra++)Ia=r[A][ra],Ta=Ia.eug,Ta.eh||Ia.J3o(L(Ta));b.set(ba);b.ic(1);L=0;do{for(ba=0;ba<h;++ba)A=r[L][ba],ra=A.gWa,b.XUb(ra,A.uwa,1,Gs.a.kTa?Gs.a.kTa():null),ih.TableCellReader.Js(ra)||(this.aNb(b,ra,A.Vvj),this.vci(A.eug,ra,!1));L++}while(b.Di(1))}Zfe(b,h,r){if(h){var A=2===b.XFa,L=[],ba=new te.a;ba.set(b);for(var ra=ba.ic(1);ra;){for(ra=ba.ic(1);ra;){const Ia=ra.id.toString();Ia in
h&&h[Ia]===r[Ia]&&(!A||!ih.TableCellReader.goa(ba)&&!ih.TableCellReader.foa(ba))||L.push(ra);ra=ba.Di(1)}ra=ba.Di(1)}if(0<L.length){h=new hb.GraphTransaction(3);try{h.set(b.ml);for(const Ia of L)Ia.b_f()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=yp.a.fv(b),A=r+h;let L=b.Ac();const ba=L.r4.th;let ra=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",L.id.toString(),L.type,r,h);const Ia=Qh.TableReader.Hg(L);
try{L.XFa=2;const Ta=this.yjb.btb(L,ba.VI(L));this.l2a(b.currentNode);this.vya(b);for(let nb=A-1;nb>=r;--nb){b.xp(nb,1);let Eb=b.ic(1);for(;Eb;)this.Vhd(Eb,!0),Eb=b.Di(1);this.IYa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Jf);b.qh()}L=b.currentNode;const ob=this.yjb.btb(L,ba.VI(L));this.Egb(L,Qh.TableReader.Hg(L)-h);this.Mpe(b);ra=!0;this.Zfe(L,Ta,ob)}finally{L.XFa=0,ra||(this.Egb(b.currentNode,Qh.TableReader.Hg(b.currentNode)-
h),this.Mpe(b))}Ia===A&&0<=r-1&&Oh.$Zf(L,r-1);r<Ia-h&&this.zZi(L,r)}deleteColumns(b,h,r){b=Object(ya.a)(te.a,b);let A=Object(ya.a)(xy.a,b.currentNode),L=Qh.TableReader.Nh(b.currentNode);const ba=A.r4.th;let ra=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",A.id.toString(),A.type,h,r);const Ia=L;try{A.XFa=2;const Ta=this.yjb.btb(A,ba.VI(A));this.l2a(b.currentNode);this.vya(b);-1===h&&(h=L-r);
b.ic(1);do for(let nb=h+r-1;nb>=h;--nb)b.xp(nb,1),this.Vhd(b.currentNode,!1),this.IYa(b),b.qh();while(b.Di(1));L-=r;this.Jtg(b,L,h,r);ra=!0;A=Object(ya.a)(xy.a,b.currentNode);const ob=this.yjb.btb(A,ba.VI(A));this.Zfe(A,Ta,ob);this.Lpe(b)}finally{A&&(A.XFa=0),ra||(this.Jtg(b,L,h,r),this.Lpe(b))}Ia===h+r&&0<=h-1&&Oh.ZZf(A,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var A=new te.a;A.Ad(b);A.Ib(14);this.Gwf(A,h,r);this.CCp(A,h,r);A.Ac();A.Ac();this.rrj(A)}}N1j(b,h,r){if(b&&(1!==h||1!==r)){var A=new te.a;
A.Ad(b);A.Ib(14);this.HQl(A,h,r);A.Ac();A.Ac();this.buj(A)}}Vhd(b,h){v.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.x0m(b,h,this.zqo)}irg(b,h){const r=b.currentNode;r.eh=!1;this.v0d(h.currentNode,b.currentNode,!0);r.removeProperty(Rc.a.skippedCell);r.removeProperty(Rc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.nYc();Gs.a.hV.Yla(b,!0,Gs.a.yIi(h.currentNode));Lh.z(b);this.AIl(h,b)}QUf(b,h,r){super.QUf(b,h,r);1===h.OQ.colSpan&&1===h.OQ.rowSpan?
h.OQ.nYc():!r&&h.gze&&(b.LYa?1<b.colSpan&&(h=new te.a,h.set(b),h.Ib(15),Lh.q(h),h.currentNode.colSpan=b.colSpan-1):(r=new te.a,r.set(h.OQ),r.Ib(15),h=wy.a(r),r=new te.a,r.set(b),r.Ib(15),Lh.i(r,h),--r.currentNode.colSpan))}w8c(b,h,r,A){const L=super.w8c(b,h,r,A);if(b.eh&&!A){var ba=h.HEa;ba.gze&&(A=Gs.a.Qlc(ba.OQ,A),!ba.KZd&&r||ba.KZd===A-1&&!r?b.colSpan=1:(r=new te.a,r.set(ba.OQ),r.Ib(15),ba=wy.a(r),r=new te.a,r.set(h),r.Ib(15),Lh.i(r,ba),r.currentNode.colSpan+=1))}L.ka(Rc.a.skippedCell,!1)&&(b.eh=
!0,b.A9=!0,b.mBb=!0);return L}Mpe(b){this.U4b(b,Rc.a.complexTable)}Lpe(b){this.U4b(b,Rc.a.complexTable)}rrj(b){this.U4b(b,Rc.a.complexTable)}buj(b){this.U4b(b,Rc.a.complexTable)}AIl(b,h){if(b&&h){let r;b=te.a.kb(b.currentNode);hm.OutlineNavigator.zda(b)&&(b.ic(2),b=b.currentNode,12==b.type&&(r=b.Uf(Sb.a.Ki)));r&&(b=new te.a,b.Ad(h),hm.OutlineNavigator.zda(b)&&b.ic(2)&&(h=b.currentNode,12==h.type&&h.Xg(Sb.a.Ki,r)))}}v0d(b,h,r){b&&(Ws.c(b,h,this.p5h),Ws.c(b,h,[Sb.a.YE]),r&&Ws.c(b,h,[Rc.a.xU,Rc.a.fX,
Rc.a.LQa,Rc.a.JQa,Rc.a.MQa,Rc.a.skippedCell,Rc.a.renderCell]))}vci(b,h,r){b&&(b=te.a.kb(b),b.Wd(),b.ue(),h=te.a.kb(h),h.Wd(),h.ue(),Mb.a.ji(b)&&hg.a.Ze(b)&&Mb.a.ji(h)&&hg.a.Ze(h)&&Ws.c(b.currentNode,h.currentNode,this.gwk),r&&(hg.a.xe(b),hg.a.xe(h),nf.a.Wg(b)&&(r=Oh.OHn.Fy(b),r.zF=Gi.a.sl,{Tna:r}=Oh.om.Vsa(r.kf,h,r))))}IYa(b){this.ii&&this.wn.cFo(b.currentNode);for(b=zp.a.Zr(b);b.moveNext();)if(rd.ParagraphReader.lc(b.currentNode)){const h=kp.e(b.currentNode);for(const r of h)r.Bda();this.sa.raiseEvent("OnParagraphDelete",
b.currentNode)}else nf.a.Wg(b.iterator)&&this.Bv&&this.Bv.aja(b.iterator)}qJ(b,h){let r=null;if(this.RNh.Zg){const A=Object(ya.a)(xy.a,b);A&&(r=A.SZ())}Qh.TableReader.Rp(b)&&(1===h?h=3:3===h&&(h=1));super.qJ(b,h);this.RNh.Zg&&this.$Wk.o2a(b,r);Object(Pb.a)(xy.a,b)&&Gs.a.ni.PVj(Object(ya.a)(xy.a,b),(new yl.a(1,0)).ww)}zDg(b,h){const r=Array(h),A=this.qNi(b)/h;for(let L=0;L<h;L++)r[L]=Math.max(rb.a.Zn(xq.a.Lja,0),A);b.setValue(Sb.a.iD,r)}KUj(b){b.setValue(Rc.a.tableLayout,0)}OVh(b,h,r,A,L){const ba=
Array(r);for(var ra=0,Ia=0;ra<A;++ra)ba[ra]=h[ra],Ia+=ba[ra];for(;ra<r;++ra)ba[ra]=0>ra-L?h[0]:h[ra-L],Ia+=ba[ra];ra=this.qNi(b.currentNode);if(Ia>ra)for(Ia=ra/Ia,ra=0;ra<r;++ra)ba[ra]=Math.max(rb.a.Zn(xq.a.Lja,0),ba[ra]*Ia);return ba}qNi(b){var h=te.a.kb(b);b=rb.a.Zn(rb.a.Zj(Qh.TableReader.eNi(h),0),0);if(h.Ib(16))return Lh.z(h),h=xq.a.ZCc(h.currentNode),rb.a.Zn(rb.a.Zj(h,0),0)-b;h=Ap.a.$Cc(h);return rb.a.Zn(rb.a.Zj(h,0),0)-b}IL(b,h,r){const A=new te.a;A.set(b);Lh.f(A,h,r);return A.currentNode.ka(Rc.a.colSpan,
1)}Jzc(b){var h=Db.StaticActiveAppFrame.Aa().tb.py;if(h.Ee&&(h=b.ug(h.Lc))){var r=!1,A=Qh.TableReader.Nh(b),L=b.ka(Sb.a.iD,Array(A));for(var ba of L)if(!ba){r=!0;break}if(r){L=lf.a.clone(L);ba=b.ka(Rc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",A,L,ba);r=1;var ra=0;for(let Ta=0;Ta<A;)if(ba&&(r=this.IL(b,0,Ta)),1<r){for(var Ia=0;Ia<r;Ia++)L[Ta]||(L[Ta]=this.$Gi(0)),Ta++;ra+=r-1}else(Ia=h.dvm(Ta-ra))||
v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",Ta,ra),L[Ta]||(L[Ta]=this.$Gi(Ia)),Ta++;b.setValue(Sb.a.iD,L)}}}$Gi(b){return rb.a.Zn(Math.max(b,xq.a.Lja),0)}l2a(b){b=te.a.kb(b);this.Jzc(b.currentNode);b.Ib(14)&&(Lh.C(b),this.Jzc(b.currentNode))}LVj(b,h){h&&b.setValue(Rc.a.Dea,h)}hEg(b,h){h&&b.setValue(Rc.a.SBc,h)}I7h(b,h){const r=Qh.TableReader.Nh(b);Gs.a.Oxl(b,h,r)}z_o(b,h,r){let A;if(!({Fq:A}=this.Nrc(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.y1l(A,
h))return!1;for(let L=0;L<h.length;++L){const ba=this.rLb.Zqd(b,h[L],r[L]);if(ba)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ba),!1}this.Hne(A);return!0}return!1}Bcl(b,h){let r;if(!({Fq:r}=this.Nrc(b)).returnValue||Qh.TableReader.sF(r))return!1;var A=Object(ya.a)(te.a,this.td.Ag(r));Lh.p(A);var L=Qh.TableReader.Hg(r);if(h&&0<h.length){this.insertRows(A,!1,h.length,()=>null);A=Qh.TableReader.Hg(r);var ba=this.td.Ag(r);
L=this.aNi(ba,L,A-1);for(A=0;A<L.length;++A){ba=L[A];const ra=h[A];for(let Ia=0;Ia<ba.length;++Ia){let Ta;if(Ta=ra&&ra[Ia]?this.rLb.Zqd(b,ba[Ia],ra[Ia].toString()):this.rLb.Zqd(b,ba[Ia],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",Ta),!1}}}this.Hne(r);return!0}icl(b,h){let r;if(!({Fq:r}=this.Nrc(b)).returnValue||Qh.TableReader.sF(r))return!1;var A=this.td.Ag(r),L=Qh.TableReader.Nh(r);if(h&&0<h.length){this.insertColumns(Object(ya.a)(te.a,
A),L,!1,h[1].length,()=>null);var ba=Qh.TableReader.Nh(r);A=this.BTm(A,L,ba-1);for(L=0;L<A.length;++L){ba=h[L];const ra=A[L];for(let Ia=0;Ia<ra.length;++Ia){let Ta;if(Ta=ba&&ba[Ia]?this.rLb.Zqd(b,ra[Ia],ba[Ia].toString()):this.rLb.Zqd(b,ra[Ia],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",Ta),!1}}}this.Hne(r);return!0}dWl(b){let h;if(!({Fq:h}=this.Nrc(b)).returnValue)return!1;let r=this.Nab(h);const A=Qh.TableReader.Hg(h);
var L=this.td.Ag(h);L=this.aNi(L,r,A-1);for(let ba=0;ba<L.length;++ba){const ra=L[ba];for(let Ia=0;Ia<ra.length;++Ia){const Ta=this.rLb.mHj(b,ra[Ia]);if(Ta)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",Ta),!1}}r=r?r:1;b=this.td.Ag(h);b.Gy(r)&&15===b.Jf&&this.deleteRows(Object(ya.a)(te.a,b),A-r);this.Hne(h);return!0}Nab(b){let h=0;const r=this.td.Ag(b);let A=r.ue();for(;A&&A.ka(Rc.a.Awb,!1);)h++,A=r.px();return!h&&Gs.a.KA.Q4(b)&
32?1:h}CCp(b,h,r){var A,L;const ba=b.currentNode,ra=new te.a;ra.Ad(b);let Ia=null,Ta=null,ob=null;const nb=Eh.a.instance.wT(3),Eb=Eh.a.instance.wT(4),bc=Eh.a.instance.wT(5),Bc=Eh.a.instance.wT(0);Lh.a(ra,h,r,(Yc,zd,Jd)=>{Yc=Yc.currentNode;zd||Jd||(Ia=Oh.Oz.Y4c(Yc,nb,Ia));zd||Jd!==r-1||(Ta=Oh.Oz.Y4c(Yc,Eb,Ta));0<zd&&!Jd&&(Ia?Oh.Oz.tCg(Yc,nb,Ia):Oh.Oz.L0b(Yc,nb),Ta?Oh.Oz.tCg(Yc,Eb,Ta):Oh.Oz.L0b(Yc,Eb),Oh.Oz.L0b(Yc,bc),zd!==h-1&&Oh.Oz.L0b(Yc,Bc));Jd||zd!==h-1||(ob=Oh.Oz.Y4c(Yc,Bc,ob))});b=null===(L=
null===(A=Db.StaticActiveAppFrame.Aa())||void 0===A?void 0:A.tb)||void 0===L?void 0:L.py;Ta?(A=pl.TableNodeBorderContext.gca(ba,1),Oh.Oz.yAe(Ej.a.Ho(b),A,Ta,0)):Oh.Oz.L0b(ba,Eb);A=pl.TableNodeBorderContext.gca(ba,0);if(Ia)Oh.Oz.yAe(Ej.a.Ho(b),A,Ia,0);else for(A=Object(ya.a)(pl.TableNodeBorderContext,A).pab(),L=0;L<A.length;L++)Oh.Oz.L0b(A[L],Eb);ob?Oh.Oz.tCg(ba,Bc,ob):Oh.Oz.L0b(ba,Bc)}y1l(b,h){for(let A=0;A<h.length;++A){var r=this.td.Ag(h[A]);if(r.Ib(14)&&(r=r.xd(14),b.id===r.id))continue;return!1}return!0}Nrc(b){let h=
null;if(b&&b.ow.toString()!==b.EB.toString())return{returnValue:!1,Fq:h};h=this.fl.Mb(b.ow);return 14===h.type&&this.rLb.Nrc(b)?{returnValue:!0,Fq:h}:{returnValue:!1,Fq:h}}aNi(b,h,r){const A=[];Lh.b(Object(ya.a)(te.a,b),(L,ba,ra)=>{if(ba>=h&&ba<=r)ra||A.push([]),ih.TableCellReader.eh(L)||Array.add(A[ba-h],L.currentNode);else if(ba>r)return!1;return!0});return A}BTm(b,h,r){const A=[];Lh.b(Object(ya.a)(te.a,b),(L,ba,ra)=>{ra>=h&&ra<=r&&(ra===h&&A.push([]),ih.TableCellReader.eh(L)||Array.add(A[ba],L.currentNode));
return!0});return A}Hne(b){if(b&&14===b.type){b=Object(ya.a)(te.a,this.td.Ag(b));const h=new Cb.a;rd.ParagraphReader.oTb(b,!0,!1,h);b=Tb.SelectionFactory.Ie(h.K(h.count-1),0);this.pb.Uc(b)}}static get Oz(){Oh.LAa||(Oh.LAa=Xa.a.instance.Wa("WordEditor.ITableBorderManager"));return Oh.LAa}static get OHn(){return null!=Oh.E5g?Oh.E5g:Oh.E5g=Xa.a.instance.resolve("Box4.List.IListReader")}static get om(){return null!=Oh.x5g?Oh.x5g:Oh.x5g=Xa.a.instance.resolve("Box4.List.IListEditor")}zZi(b,h){const r=new te.a;
r.set(b);Lh.l(r);Lh.y(r,h);do r.currentNode.vm(4,!0);while(Lh.t(r))}static $Zf(b,h){if(b){var r=Qh.TableReader.Hg(b),A=Qh.TableReader.Nh(b);if(!(!Db.StaticActiveAppFrame.Aa().tb.py.Ee||0>h||h>=r))for(r=new te.a,r.set(b),b=0;b<A;b++){b?Lh.q(r):Lh.f(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let L=r.currentNode;ih.TableCellReader.Js(L)&&(L=ih.TableCellReader.O8(L));L&&L.vm(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static ZZf(b,
h){if(b){var r=Qh.TableReader.Hg(b),A=Qh.TableReader.Nh(b),L=new te.a;if(!(!Db.StaticActiveAppFrame.Aa().tb.py.Ee||0>h||h>=A))for(A=0;A<r;A++){L.set(b);Lh.f(L,A,h);if(!L||!L.currentNode)continue;let ba=L.currentNode;ih.TableCellReader.Js(ba)&&(ba=ih.TableCellReader.O8(ba));ba&&ba.vm(4,!0)}}else v.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Oh.LAa=null;Object(u.a)(Oh,"TableEditor",Gs.a,[417,418]);class Nt{get name(){return"WordEditor.TableEditors"}Ec(b){y.AFrameworkApplication.J.$("TableEditorsDelayInitializationEnabled")&&
(b.ja("WordEditor.TableEditors.TableEditor",()=>new Oh(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new dj.a,Fg.a.instance,b.Za("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.Za("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ja("WordEditor.TableEditors.TableBorderManager",()=>new Vf).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){F.a.instance.Rc(new Nt)}}Object(u.a)(Nt,"WordEditorTableEditorsPackage",null,[0,1]);class ox{get name(){return"WordEditor.TextLevelEditors"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new ox)}}Object(u.a)(ox,"WordEditorTextLevelEditorsPackage",
null,[0,1]);var VA=e(2E3),rm=e(387),Br=e(653),Xn=e(223),Ur=e(229);class On{constructor(b){this.dOk=b}POl(){const b=ou.a.instance.createInstance(on.a.GZb);b.setValue(Sb.a.UN,Xn.a.first);b.setValue(Sb.a.t0h,0);b.setValue(Sb.a.Zva,il.a.YUl);(new Br.a(!0)).kPj(b);return b}Yla(b,h,r=null){const A=b.currentNode;if(!b.vN(1))return this.bVb(b,null,h,r);Mb.a.oP(b)&&hg.a.Hcg(b,!0);return Mb.a.ji(b)?On.Yf.mA(b,!1,h,r):(b.npd(A),null)}Mrl(b){return il.a.l3f(b.currentNode)||Mb.a.ji(b)||Mb.a.oP(b)||ih.TableCellReader.isTableCell(b)}bVb(b,
h=null,r=!1,A=null){if(!this.Mrl(b))return null;const L=On.Yf.Jqb();this.g5o(L,b);b.XUb(L,h,1,null);b.yk(L);r&&(On.Yf.dN(b,A),hg.a.xe(b));return L}g5o(b,h){if(h=this.GPm(h))switch(h.type){case 11:On.Yf.jCf(h,b,!0);break;case 8:h=On.Jj.isRtl(h),On.Yf.u2b(b,h)}}GPm(b){return this.dOk.HPm(b)}t2b(b,h){b.setValue(Sb.a.au,h?11:9)}H_o(b,h){const r=Ur.a.instance.zW(b);return r?il.a.u1(b)!==h?(r.setValue(Rc.a.Xyf,h),!0):!1:null}static get Jj(){return fn.a.instance}static get Yf(){return On.ni||(On.ni=Xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Yf(b){On.ni=
b}}On.ni=null;On.Pe=null;Object(u.a)(On,"OutlineEditor",null,[726]);const gq=b=>{b.ja("Box4.OutlineLevelEditors.OutlineEditor",()=>new On(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();b.ja("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new VA.a(b.zf("Box4.IOutlineEditor"),b.zf("Box4.List.IListEditor"),b.zf("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").ha()};class Pu{HYj(){return{GYj:!0,qhk:!1}}}Object(u.a)(Pu,"CursorMovementValidator",null,[416]);class gn{get name(){return"Box4.OutlineLevelEditors"}Ec(b){b.ja("Box4.ListEditors.CursorMovementValidator",()=>new Pu).as("Box4.List.ICursorMovementValidator").ha();gq(b)}init(){}dispose(){}static main(){F.a.instance.Rc(new gn)}}Object(u.a)(gn,
"Box4OutlineLevelEditorsPackage",null,[0,1]);class Yn{constructor(b){this.U1d=null;this.Vnj=b.rb("OfficeOnlineChromeExtensionId");this.foj=b.rb("ChromeClipboardAccessExtensionId");this.Jmn=b.$("OfficeOnlineChromeExtensionIsEnabled");this.aKh=!this.svn();this.U1d=this.Q2b?this.foj:this.Vnj}aMj(){this.U1d===this.Vnj&&this.j4i&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.U1d=this.foj;this.aKh=!0}get Q2b(){return this.aKh}svn(){if(this.Jmn&&
this.j4i){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get j4i(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){v.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(u.a)(Yn,
"ChromeExtensionHelper",null,[1886]);var dh=e(1324),gx=e(695),NG=e(1278);class zJ{create(b){return new NG.a(b)}}Object(u.a)(zJ,"Factory",null,[715]);var sl=e(535),px=e(1044),HJ=e(408),Ez=e(464),qx=e(949);class po extends qx.a{constructor(b,h,r,A,L,ba,ra=null,Ia=null){super(b,ba,ra,Ia);this._formatting=null;this.eTa=!1;this.tGb=y.AFrameworkApplication.J.$("FollowDestinationFormattingPasteIsEnabled");this.LIb=0;this.rTc=new Cb.a;Cd.a(8128527,307,Mb.a.ji(b));this.xQ=h;this.xQ.fgc(this);this.Hs=r;this.om=
A;this.Vd=L;this.Oof=Ia;this.S6e=nf.a.Wg(this.Kc)}get gm(){return null!=this.t7g?this.t7g:this.t7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}get K1d(){return null}get Vhc(){return this.S6e&&!this.xQ.vLa}get NPb(){return 0<this.LIb}Dia(b,h){if(!this.i3.TNg(this.Kc,h,!0)){Cd.a(8701077,307,rd.ParagraphReader.Wh(this.Kc));var r=this.Kc.currentNode,A=vc.a.uz(r);this.tGb&&this._formatting.$V&&(r=r.ra.last,this.eTa&&(r.formatting=this._formatting.$V.og(r),this.eTa=!1),b=this.i3.ZUf(b,h),this.i3.kea(this.Kc.currentNode,
this._formatting.Jia,h));this.Ug.lf(A,b)}}Dda(){Cd.a(8701078,307,rd.ParagraphReader.Wh(this.Kc));const b=vc.a.uz(this.Kc.currentNode);this.Ug.Vna(b,h=>new Ez.a(h))}Iyb(){this.i3.eVf(this.Kc)}TOa(){this.tGb&&(this.eTa=!0)}f0a(){Cd.a(8701079,307,rd.ParagraphReader.Wh(this.Kc))}e0a(){Cd.a(8701080,307,rd.ParagraphReader.Wh(this.Kc))}JH(b){this.xQ.vLa||(this.tGb?(this.plf(b),this._formatting.Jvd(this.Kc.currentNode),b&&"P"===b.Mda.Yde&&this.Oof.tja(this.Kc.currentNode,this._formatting.xR),this.i3.kea(this.Kc.currentNode,
this._formatting.Jia,b)):this.bjl(b))}gJ(){this.xQ.vLa||this.ZLa()}l0a(){}teb(){}ZEa(){Cd.a(8701081,307,Mb.a.ji(this.Kc)||il.a.nA(this.Kc)||rd.ParagraphReader.Wh(this.Kc)&&this.xQ.vLa);let b=!1;this.NPb||(b=this.Vhc||!0);b||(this.QZ+=1);this.LIb++}ywa(){this.LIb--;let b=!1;this.NPb||(b=this.Vhc||!0,this.om.zIj(this.rTc));b||--this.QZ}XOa(b){Cd.a(8701082,307,Mb.a.ji(this.Kc)||il.a.nA(this.Kc)||rd.ParagraphReader.Wh(this.Kc)&&this.xQ.vLa);Cd.a(8701083,307,!!b.listStyleType)}YEa(){Cd.a(8701084,307,Mb.a.ji(this.Kc)||
rd.ParagraphReader.Wh(this.Kc)&&this.xQ.vLa);this.xQ.vLa||Cd.a(8701085,307,this.Kc.dw(2))}Jda(b){this.xQ.Jda(b)}Hda(){this.xQ.Hda()}wvd(b){this.rTc.add(b)}W9(b){this.xQ.W9(b)}Ida(){this.xQ.Ida()}Gda(b){this.xQ.Gda(b)}Fda(){this.xQ.Fda()}bjl(b){this.uuc(!1);(new te.a).Ad(this.Kc);b=qx.a.Yf.dN(this.Kc,this.M6c(b));Cd.a(8128534,307,b===this.Kc.currentNode);Cd.a(8128535,307,rd.ParagraphReader.lc(b))}ZLa(){Cd.a(8128536,307,rd.ParagraphReader.Wh(this.Kc));hg.a.xe(this.Kc)}reset(){this.tGb&&(super.reset(),
this._formatting=this.bMf(!0))}plf(b){this.uuc(!1);(new te.a).Ad(this.Kc);b=qx.a.Yf.dN(this.Kc,this.M6c(b));Cd.a(36577367,307,b===this.Kc.currentNode);Cd.a(36577368,307,rd.ParagraphReader.lc(b));-1!==this._formatting.Dz&&this.gm.qJ(b,this._formatting.Dz);this._formatting.lineSpacing&&this.Oof.HG(b,this._formatting.lineSpacing);this._formatting.E$&&this.Oof.MBe(b,this._formatting.E$);this.eTa=!0;this._formatting.paragraph=b}static hvf(b,h){let r=0;switch(h){case 3:r=fg.a.pF(b);break;case 7:r=rb.a.YB(b,
0);break;case 1:r=fg.a.Wqf(b);break;case 5:r=fg.a.pF(fg.a.Bog(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}Object(u.a)(po,"TextOnlyBox4PasteSteward",qx.a,[]);class IJ extends po{constructor(b,h,r,A,L,ba,ra,Ia=null,Ta=null){super(h,r,A,L,ba,ra,Ia,Ta);this.AMc=!1;this.nHb=[];this.UMh=b;h={};h.textOnlyPasteFlags=b;v.ULS.sendTraceTag(509088282,307,50,H.c(h))}reset(){super.reset();this.AMc=
!1;this.nHb.length=0;this.sHd=!1}JH(b){this.AMc||(super.JH(b),this.AMc=!0)}gJ(){this.sHd?this.sHd=!1:this.Dda(null)}Dda(b){this.UMh&2||super.Dda(b)}ZEa(){}ywa(){}XOa(){}YEa(){}Jda(){}Hda(){}W9(b){this.AMc||(super.W9(b),this.AMc=!0);this.nHb.push(!1)}Ida(){this.UMh&1&&this.Dda(null);0<this.nHb.length?this.nHb.pop():Cd.a(509088281,307,!1)}Gda(){var b=this.nHb.length-1;0<=b?this.nHb[b]?(b=vc.a.uz(this.Kc.currentNode),this.Ug.lf(b,", ")):this.nHb[b]=!0:Cd.a(509088280,307,!1);this.sHd=!0}Fda(){this.sHd=
!1}wvd(){}}Object(u.a)(IJ,"StrictTextOnlyBox4PasteSteward",po,[]);class JJ{constructor(b,h,r,A){this.d6e=b;this.AO=h;this.zg=r;this.i3=A}create(b,h,r,A,L=null,ba=null,ra=null,Ia=null){return 1===b?null!==Ia&&0!==Ia?new IJ(Ia,h,A,this.d6e,this.AO,this.zg,L,ba,this.i3):new po(h,A,this.d6e,this.AO,this.zg,L,ba,this.i3):new HJ.Box4PasteSteward(h,r,A,this.d6e,this.AO,this.zg,L,new Dj.b,ba,this.i3,ra)}}Object(u.a)(JJ,"Box4PasteStewardFactory",null,[714]);var rx=e(166),Yv=e(353),Vr=e(1068);class UG{constructor(b,
h,r){this.hC=null;this.MIb=0;this.Kc=b;this.Kj=r}fgc(b){this.hC=b}get vLa(){return 0<this.MIb}Jda(b){Cd.a(7869459,307,!!this.hC);Cd.a(7869460,307,Mb.a.ji(this.Kc)||il.a.nA(this.Kc));Cd.b(38563978,307,50,"Table pasting started");this.hC.uuc(!0);const h=new te.a;h.Ad(this.Kc);var r=Vr.a.D9m[b.styleId];r||(y.AFrameworkApplication.ud("gdea6103;0df65435"),b.T_f?(v.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),r=Vr.a.dZn):r=Vr.a.Hii);r=this.Kj.Gzo(this.Kc,b.rowCount,b.Xpb,
r,b.tableLook,this.hC.M6c(b),b.T_f);b.xKg&&(Cd.b(573691298,3022,100,"Applying table border properties"),Vr.a.ZXh(b.xKg,this.Kc,!1,!0));b.Uee&&(Cd.b(573691299,3022,100,"Applying indentation properties"),Vr.a.ydl(this.Kc,b.Uee.spaceBefore,b.Uee.spaceAfter));b.LZd&&(Cd.b(573691328,3022,100,"Applying column widths"),Vr.a.fdl(b.LZd,this.Kc,Object(ya.a)(Yv.a,r),b.Ucb));this.hC.aWd(h,!1);this.MIb++;nf.a.Wg(h)&&this.hC.wvd(h.currentNode);Cd.a(7869461,307,Qh.TableReader.isTable(this.Kc))}Hda(){Cd.a(7869462,
307,!!this.hC);Cd.a(7869463,307,yp.a.isTableRow(this.Kc));Cd.b(38563979,307,50,"Table pasting finished");this.Kc.Mu(14)&&Vr.a.pPj(this.Kc.Jr);hg.a.xe(this.Kc);this.MIb--}W9(b){Cd.a(7869464,307,!!this.hC);Cd.b(573691329,3022,100,"Table row pasting started");Qh.TableReader.isTable(this.Kc)?Lh.l(this.Kc):yp.a.isTableRow(this.Kc)&&Lh.t(this.Kc);b.height&&(Cd.b(573691330,3022,100,"Applying table row height"),Vr.a.xel(this.Kc,b.height));Cd.a(7869465,307,yp.a.isTableRow(this.Kc))}Ida(){Cd.a(7869466,307,
!!this.hC);Cd.a(7869467,307,ih.TableCellReader.isTableCell(this.Kc));Lh.B(this.Kc)}Gda(b){Cd.a(7869468,307,!!this.hC);Cd.a(7869469,307,!this.hC.QZ);yp.a.isTableRow(this.Kc)?Lh.k(this.Kc):ih.TableCellReader.isTableCell(this.Kc)?Lh.q(this.Kc):Cd.a(7869471,307,!1);if(this.Kc.currentNode){Cd.b(573691331,3022,100,"Table cell pasting started");var h=Object(ya.a)(rx.TableCellNode,this.Kc.currentNode);Cd.a(50689760,307,!h&&16!==this.Kc.currentNode.type||!!h&&16===this.Kc.currentNode.type);if(h){var r=new te.a;
r.Ad(this.Kc);if(b.Hrc)Cd.b(573691332,3022,100,"Processing skipped cell"),Vr.a.Zpo(r,b);else{if(1<b.colSpan||1<b.rowSpan){const A=Lh.C(r);if(!A)return;A.setValue(Rc.a.complexTable,!0);r.Ad(this.Kc);Cd.b(573691333,3022,100,"Processing merged cell");Vr.a.opo(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}Vr.a.Bel(this.Kc,b.shadingColor);Vr.a.tfl(this.Kc,b.verticalAlignment);Vr.a.Vcl(this.Kc,b.sFe);Vr.a.ZXh(b.dqa,this.Kc,!b.colSpan&&!b.rowSpan,!1);(new te.a).Ad(this.Kc);Lh.a(r,b.rowSpan,b.colSpan,(A,L,
ba)=>{Cd.b(573691334,3022,100,"Setting ghost cell borders");Vr.a.PTj(A,b.dqa,L,ba,b.rowSpan,b.colSpan)});Vr.a.vfl(this.Kc,b.width,b.Ucb);Cd.a(7869472,307,il.a.nA(this.Kc))}}}}Fda(){Cd.a(7869473,307,!!this.hC);Cd.a(7869474,307,Mb.a.ji(this.Kc)||ih.TableCellReader.isTableCell(this.Kc));Lh.z(this.Kc);Cd.a(7869475,307,0>=this.hC.QZ);this.hC.Vrf()}}Object(u.a)(UG,"Box4TableSteward",null,[731,204]);class yy{constructor(b,h,r){this.hC=null;this.MIb=0;this.Kc=b;this.Kj=r}fgc(b){this.hC=b}get vLa(){return 0<
this.MIb}Jda(){this.vLa&&(Cd.a(8787101,307,rd.ParagraphReader.Wh(this.Kc)),hg.a.xe(this.Kc));Cd.a(8701086,307,!!this.hC);Cd.a(8701087,307,Mb.a.ji(this.Kc)||il.a.nA(this.Kc));this.MIb++}Hda(){Cd.a(8701088,307,!!this.hC);hg.a.xe(this.Kc);this.MIb--;if(this.vLa){this.hC.uuc(!0);const b=yy.Yf.dN(this.Kc);Cd.a(8787102,307,b===this.Kc.currentNode);Cd.a(8787103,307,rd.ParagraphReader.Wh(this.Kc))}}W9(b){Cd.a(8701089,307,!!this.hC);this.hC.uuc(!0);const h=new te.a;h.Ad(this.Kc);this.hC.aWd(h,!1);nf.a.Wg(h)&&
this.hC.wvd(h.currentNode);b=yy.Yf.dN(this.Kc,this.hC.M6c(b));Cd.a(8701090,307,b===this.Kc.currentNode);Cd.a(8701091,307,rd.ParagraphReader.Wh(this.Kc))}Ida(){Cd.a(8701120,307,!!this.hC);Cd.a(8701121,307,rd.ParagraphReader.Wh(this.Kc));hg.a.xe(this.Kc)}Gda(){Cd.a(8701122,307,!!this.hC);Cd.a(8701123,307,rd.ParagraphReader.Wh(this.Kc));Cd.a(8701124,307,!this.hC.QZ);var b=this.Kc.currentNode;rd.ParagraphReader.textLength(b)&&(b=vc.a.uz(b),this.hC.Ug.lf(b,", "))}Fda(){Cd.a(8701125,307,!!this.hC);Cd.a(8701126,
307,rd.ParagraphReader.Wh(this.Kc));Cd.a(8701127,307,0>=this.hC.QZ);this.hC.Vrf()}static get Yf(){return null!=yy.C6g?yy.C6g:yy.C6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(u.a)(yy,"TextOnlyBox4TableSteward",null,[731,204]);class WA{constructor(b,h,r=!1,A=!1){this.AO=b;this.tI=h;this.KOk=r;this.ROk=A}create(b,h){return 1===b?new yy(h,this.AO,this.tI):new UG(h,this.AO,this.tI,this.KOk,this.ROk)}}Object(u.a)(WA,"Box4TableStewardFactory",null,[713]);class VG{create(){return new Oi.a}}
Object(u.a)(VG,"Factory",null,[712]);class qt{constructor(){this.Bqh=!1}get Ode(){return this.Bqh}set Ode(b){this.Bqh=b}}Object(u.a)(qt,"HighContrastColorPickerState",null,[711]);class XA{constructor(b){this.ga=b}get Tb(){return this.ga}Nol(b,h,r=null){const A=new Ai.DictionaryPropertySet;A.setValue(Pd.a.dE,b);A.setValue(Pd.a.z_a,h);r&&A.Yu(r);A.CommandSource="autobulleting";this.Tb.Zb(fb.a.FF,2,A)}$_n(b,h,r,A,L){const ba=new Ai.DictionaryPropertySet;ba.setValue(Pd.a.dE,b);ba.setValue(Pd.a.z_a,h);
ba.setValue(Pd.a.mOa,r);L&&ba.setValue(Kh.a.AV,L);A&&ba.setValue(Rc.a.Qy,A);ba.setValue(Kh.a.bwa,"autocorrect");L&&ba.setValue(Kh.a.Aoa,L);ba.CommandSource="autonumbering";return 32===this.Tb.Zb(fb.a.KP,2,ba)}}Object(u.a)(XA,"ListCommands",null,[710]);var Wr=e(123);class sx{constructor(b,h,r,A,L){this.om=b;this.m0n=h;this.lk=r;this.Yd=A;this.Ug=L}get Mnj(){return this.m0n.value}execute(b,h,r,A){const L=$g.a.instance.vr(fb.a.E2o);Mb.a.isEmpty(b,!1)?this.l$l(b):this.m$l(b,h,r,A);L.end()}l$l(b){this.Mnj.mqf(b,
-1)?this.Mnj.Z0a(b,-1,0):this.om.k$(b,{qIj:!0})}m$l(b,h,r,A){h=A(b,h,r);b=rd.ParagraphReader.Vn(b.currentNode);!this.om.Vgb&&this.YAn(b)&&this.N5k(h);this.om.X2();(null===b||void 0===b?0:b.ra)&&!b.ra.last.formatting&&this.Ug.J$a(b)}YAn(b){return b.Ej&&!b.Hz.hasProperty(Rc.a.listID)}N5k(b){hg.a.Ze(b);b=b.currentNode;const h=new Wr.a;b.ed.Mv(h);this.lk.MR(b,h,this.Yd.Zg)}}Object(u.a)(sx,"ListNewLineStrategy",null,[]);class HE{constructor(b){this.ga=b}OVn(b){if(4===b)b=fb.a.AEa;else if(2===b)b=fb.a.hja;
else if(1===b)b=fb.a.OCb;else if(3===b)b=fb.a.fXa;else return;this.ga.Vb(b,2)}Q$a(){this.ga.Vb(fb.a.Q$a,2)}}Object(u.a)(HE,"SelectionCommands",null,[709]);var CC=e(238),IE=e(1097),tx=e(138),Aw=e(501);class zy{constructor(){this.Idd=!1;this.bNp=y.AFrameworkApplication.J.rb("WordEditorVisiFontFileUri");this.dNp=y.AFrameworkApplication.J.rb("WordEditorVisiRtlFontFileUri");this.cNp=y.AFrameworkApplication.J.rb("WordEditorVisiPilcrowFontFileUri");this.ZMp=y.AFrameworkApplication.J.rb("WordEditorVisiCarriageReturnFontFileUri");
this.aNp=y.AFrameworkApplication.J.rb("WordEditorVisiCarriageReturnRtlFontFileUri")}Ntp(){this.Idd=!this.Idd}Mtp(b){this.Ntp();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],A=b.getElementsByClassName("VisiFontPilcrowStyle")[0],L=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ba=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",eb.a.Mz(h,""),b.appendChild(h));
r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",eb.a.Mz(r,""),b.appendChild(r));A||(A=document.createElement("Style"),A.className="VisiFontPilcrowStyle",eb.a.Mz(A,""),b.appendChild(A));L||(L=document.createElement("Style"),L.className="VisiFontCarriageReturnStyle",eb.a.Mz(L,""),b.appendChild(L));ba||(ba=document.createElement("Style"),ba.className="VisiFontCarriageReturnRtlStyle",eb.a.Mz(ba,""),b.appendChild(ba));if(this.Idd)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),
this.mWc(h)&&this.mWc(r)&&this.mWc(A)&&this.mWc(L)&&this.mWc(ba);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.jod(h)&&this.jod(r)&&this.jod(A)&&this.jod(L)&&this.jod(ba)}mWc(b){return""===eb.a.HC(b)?("VisiFontStyle"===b.className?eb.a.Mz(b,this.V5c("WordVisi_MSFontService",this.bNp)):"VisiFontRtlStyle"===b.className?eb.a.Mz(b,this.V5c("WordVisiRtl_MSFontService",this.dNp)):"VisiFontPilcrowStyle"===b.className?eb.a.Mz(b,this.V5c("WordVisiPilcrow_MSFontService",
this.cNp)):"VisiFontCarriageReturnStyle"===b.className?eb.a.Mz(b,this.V5c("WordVisiCarriageReturn_MSFontService",this.ZMp)):"VisiFontCarriageReturnRtlStyle"===b.className&&eb.a.Mz(b,this.V5c("WordVisiCarriageReturnRtl_MSFontService",this.aNp)),!0):!1}jod(b){return""!==eb.a.HC(b)?(eb.a.Mz(b,""),!0):!1}V5c(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(u.a)(zy,"VisiMarkersOperation",null,[706]);var JE=e(1469),
Ot=e(964);class Bw extends JE.a{constructor(b,h){super(b,h);this.WYe=-1;this.qGb=0;this.OVe=null;this.Prh=!1;this.XWe=[];this.iId=!1;this.aBh=!0;this.p5e=this.bGd=null;this.preventDismissOnScroll=this.sue=this.Ywc=!1;this.dca=null;this.hSd=!1;this.Z8c=!0;this.Vw=!1;this.juh=y.AFrameworkApplication.J.$("FloatieLightDismissIsEnabled");Bw.JGh||(y.AFrameworkApplication.va.qa(wb.a.showFloatie,dd.a.frame,qf.ActionManager.qg),Bw.JGh=!0)}get Iui(){return this.HS}set Iui(b){this.HS=b}get B7j(){return this.hSd}get c$c(){return this.Prh}set c$c(b){this.Prh=
b;this.qGb=0}get DE(){return!0}get cssClass(){return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.ida?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Vw}b2a(){for(const b of this.children)if(b.b2a())return!0;return!1}get cea(){return 9}pg(b){this.XWe[this.XWe.length]=b;super.pg(b)}ro(){super.ro();ef.c(this.fd)&&this.kG();this.fd=Sg.a.w1a(this.fd);this.N0(this.fd);this.dirty=!1}pvc(b){3===b.Og||this.sue||this.dismissFloatie(b);return!1}svc(){return!1}qvc(b){3!==
b.Og&&this.Z8c&&!this.Ywc&&this.DGp(b);return!1}rvc(){return!1}nvc(b){3===b.Og&&this.dismissFloatie(b);return!1}ovc(b){void 0!==this.dca&&null!==this.dca||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}rA(){this.LDf();return!1}Fqe(){this.c$c=!0}DGp(b){if(b=of.a.qjc(b.clientPoint,this.OVe)){if(this.c$c){if(!this.qGb||b<this.qGb)this.qGb=b;b-=this.qGb}b-=this.WYe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():X.a.setOpacity(this.fd,Math.max(h/255,0))}else this.c$c=!1,
this.qGb=0,X.a.setOpacity(this.fd,1)}VEp(b){let h=null;void 0!==this.bGd&&null!==this.bGd&&(h=this.bGd(b));b=null;for(const r of this.XWe){let A=!this.B7j&&r.M8i;if(!A&&void 0!==h&&null!==h)for(let L=0;L<h.length;L++)if(r.id===h[L]){A=!0;break}r.fd.style.display=A?"none":"";r.njc=!A;A||(b=r)}b&&(b.njc=!1)}BDi(){const b=this.fd.style.top,h=this.fd.style.left;this.fd.style.top="0px";this.fd.style.left="0px";const r=this.DSb();this.fd.style.top=b;this.fd.style.left=h;return r}DSb(){const b=this.fd.style.visibility,
h=this.fd.style.display;this.fd.style.visibility="hidden";this.fd.style.display="";const r=ed.a.getElementBounds(this.fd);this.fd.style.display=h;this.fd.style.visibility=b;return r}WFj(b){3===b||this.UGe?(Sys.UI.DomElement.addCssClass(this.fd,Ot.a.v4b),this.hSd=!0):(Sys.UI.DomElement.removeCssClass(this.fd,Ot.a.v4b),this.hSd=!1);this.VEp(b)}Ogb(b,h,r,A=!1){this.isVisible||(this.dca||!this.aBh&&this.preventDismissOnScroll||(this.aBh=!1,ed.a.ane("ShowLegacyFloatie",""),y.AFrameworkApplication.va.Vb(wb.a.showFloatie,
2)),this.WFj(r),this.Z8c=!0,this.qGb=0,this.c$c=!1,!this.juh||void 0!==this.dca&&null!==this.dca?(this.iId=!1,this.ema(this,!1)):(this.iId=!0,this.ajl(this)),h=A?b:this.klo(b,h),this.fd.style.top=h.y.toString()+"px",this.fd.style.left=h.x.toString()+"px",this.Lw(),this.OVe=this.DSb(),this.WYe=of.a.qjc(b,this.OVe),X.a.setOpacity(this.fd,1),this.fd.style.zIndex=String(y.AFrameworkApplication.ta.aBa),this.fd.style.display="",this.Vw=!0)}klo(b,h){const r=this.B7j?30:17,A=this.BDi(),L=eb.a.aub(),ba=eb.a.G1();
b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=A.height:3===h?(b.y-=A.height,b.x-=A.width):2===h&&(b.x-=A.width);b.x+A.width>L&&(b.x=Math.floor(L-A.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+A.height>ba&&(b.y=ba-A.height);return b}llo(b,h){const r=b.ejj;if(r){this.WFj(h);var A=this.BDi();this.dca=b;b=r.PRg-r.Z3c>A.width;var L=r.Z3c+r.BHf>A.width,ba=r.blc>A.height+17,ra=r.Agk-(r.blc+r.xHf)>A.height+17;A=new Sys.UI.Point(r.Z3c,r.blc);L||b||(L=!0,A.x=r.PRg);b=r.Ywb?r.a7f?ra?L?2:0:
L?3:1:ba?L?3:1:L?2:0:r.a7f?ra?b?0:2:b?1:3:ba?b?1:3:b?0:2;if(3===b||2===b)A.x=r.Z3c+r.BHf;if(2===b||0===b)A.y=r.blc+r.xHf;this.Ogb(A,b,h);this.Z8c=!1;h=this.dca.khf.fd;void 0!==h&&null!==h&&(h.style.zIndex=String(y.AFrameworkApplication.ta.aBa))}}B8(){let b=super.B8();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.VUc&&null!==this.VUc&&this.VUc.sCa(null);void 0!==this.dca&&null!==this.dca&&this.dca.r8();this.r8();this.juh&&this.iId?this.L6l(this):
this.Vga(this,!1);this.iId=!1;this.WYe=-1;this.dca=null;this.fd.style.display="none";this.Vw=!1;this.p5e&&this.p5e(b);return!0}LDf(){void 0!==this.dca&&null!==this.dca&&(this.dca.f8a=null,this.dca.r8(),this.dca=null,this.tne.style.zIndex=String(y.AFrameworkApplication.ta.XJa),this.fd.style.zIndex=String(y.AFrameworkApplication.ta.aBa))}lCo(b){this.bGd=b}cDo(b){this.p5e=b}set DE(b){super.DE=b}}Bw.JGh=!1;Object(u.a)(Bw,"Floatie",JE.a,[507,214,215]);class us{constructor(b,h){this.iy=this.bTa=null;this.lgj=
b;this.oOj=h}get Kui(){return this.bTa}G7o(b){this.bTa=b}DSb(){return this.iy.DSb()}k5(){return this.iy?this.iy.isVisible:!1}d0h(b){this.G7o(b)}showFloatie(b,h){this.Ogb(h.location,h.aB,h.isRtl)}Ogb(b,h,r){r=r?this.oOj:this.lgj;this.V4d();this.iy&&this.iy.Ogb(b,r,h)}dismissFloatie(){this.iy&&this.iy.dismissFloatie()}V4d(){this.bTa&&!this.iy&&(this.iy=Object(ya.a)(Bw,this.bTa()))}F5d(){}}Object(u.a)(us,"AFloatieManager",null,[730]);class Fz extends us{constructor(){super(1,3);this.L5j=!1;this.aki=
""}Ogb(b,h,r){r=r?this.oOj:this.lgj;this.V4d();this.iy&&(this.iy.isVisible&&this.iy.dismissFloatie(),this.L5j||this.iy.qo(),this.iy.Ogb(b,r,h,!0))}V4d(){this.Kui&&!this.iy&&(this.iy=this.bTa())}F5d(){if(this.iy&&this.iy.isVisible){const b=Object(ya.a)(tn.a,this.iy.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.fA(b.ltb(),1,null)}}aEg(b){this.aki=b}XJo(b){b=b.YLf("Menu16",null);mh.a("renderIcon")&&b&&appChrome.api.renderIcon(Fz.jzk,b.firstElementChild)}PDc(b,h,r){if(this.iy){const A=this.iy.controls[this.aki];
A&&(Fz.Gth||(this.XJo(A),Fz.Gth=!0),A.ie[xj.a.labelText]=b,A.ie[xj.a.alt]=h,r&&A.behavior.qo())}}}Fz.Gth=!1;Fz.jzk="Designer_20";Object(u.a)(Fz,"PasteFloatieManager",us,[]);var YA=e(1055);class Ay{constructor(){this.Xd=null}get hx(){return null}getTitle(){return null}cCi(){return null}reset(b){this.Xd=b.node}NGa(b){b=kp.d(this.Xd,b);let h=null;if(!b||b.xi!==this.xi)return{returnValue:!1,vI:h};h=Object.assign(new YA.a,{NH:this.key,contentObject:b,title:this.getTitle(b),description:this.cCi(b)});return{returnValue:!0,
vI:h}}}Object(u.a)(Ay,"BlobDetailsProvider",null,[376,377]);class ux extends Ay{constructor(){super()}get key(){return"EQUATION"}get xi(){return 11}get hx(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(u.a)(ux,"EquationDetailsProvider",Ay,[]);class KE{constructor(){this.prh=null}get key(){return"LINK"}get hx(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.prh=Mc.a.vmc(b.node)}NGa(b){let h=null;for(const r of this.prh)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new YA.a,
{NH:this.key,contentObject:r.hyperlink}),{returnValue:!0,vI:h};return{returnValue:!1,vI:h}}}Object(u.a)(KE,"HyperlinkDetailsProvider",null,[376,377]);var DC=e(1256),ZA=e(934);class $A{constructor(){this.zwh=!1}get key(){return"IFRAMENODE"}get hx(){return this.zwh?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}F4b(b){let h=null;b=b?rd.ParagraphReader.GMa(b.currentNode):null;if(!b)return{returnValue:!1,Fga:h};h=Object.assign(new DC.a,{NH:this.key,contentId:b.id,
contentObject:b});return{returnValue:!0,Fga:h}}htb(b,h){b=b?Object(ya.a)(ZA.a,b.contentObject):null;h=h?Object(ya.a)(ZA.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.zwh=b.fdb,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.hx,this.hx));return r}}Object(u.a)($A,"IFrameDetailsProvider",null,[729,377]);class EC extends Ay{constructor(){super()}get key(){return"IMAGE"}get xi(){return 5}reset(b,h){super.reset(b,h);this.VHk=!Ee.a.qn(h)}get hx(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return pe.a.z1(b.properties)}cCi(b){b=
pe.a.nYa(b.properties);return this.VHk&&(y.AFrameworkApplication.ud("51a6c128;f7eb8687"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageSelectionAnnouncement",!1))?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(u.a)(EC,"ImageDetailsProvider",Ay,[]);class WG{get key(){return"IMAGENODE"}get hx(){return Box4Intl.Box4Strings.l_ImageContentTitle}F4b(b){let h=null;if(!b||!pe.a.nr(b.currentNode))return{returnValue:!1,
Fga:h};h=Object.assign(new DC.a,{NH:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Fga:h}}htb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let A="";h&&b.id===h.contentObject.id||(A=String.format(r,pe.a.z1(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return A}}Object(u.a)(WG,"ImageNodeDetailsProvider",null,[729,377]);var FC=e(781);let Zv,aB;class hv{constructor(b,h){this.jmh=null;this.jp=h;this.l8e=b;this.key=
hv.keys.K(b);this.hx=hv.Muf.K(b)}reset(b){this.jmh=this.jp.X8(b.node);FC.a.z4e++}NGa(b){var h=hv.YGf(this.jmh||[],r=>this.kon(b,r));h=this.QKl(h);return{returnValue:!!h,vI:h}}kon(b,h){return h.Mc<=b&&b<h.end&&(!h.errorDetails||this.l8e===h.errorDetails.proofingType)}QKl(b){return b?Object.assign(new YA.a,{NH:this.key,contentObject:b.errorDetails,description:this.$Xa()}):null}$Xa(){return al.a.VNa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static YGf(b,h){for(const r of b)if(h(r))return r;
return null}}hv.keys=(aB=new ac.a,aB.add(1,"SPELLINGERROR"),aB.add(2,"GRAMMATICALERROR"),aB.add(3,"ADVANCEDERROR"),aB);hv.Muf=(Zv=new ac.a,Zv.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Zv.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Zv.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Zv);Object(u.a)(hv,"ProofingDetailsProvider",null,[376,377]);class LE{constructor(){this.Fq=null;this.JZd=this.eze=this.columns=this.rows=0}}Object(u.a)(LE,"TableInfo",null,[]);
class ME{get key(){return"TABLE"}get hx(){return Box4Intl.Box4Strings.l_TableContentTitle}F4b(b){var h=null;if(!ih.TableCellReader.isTableCell(b))return{returnValue:!1,Fga:h};h=new te.a;h.Ad(b);b=new LE;b.eze=yp.a.fv(h)+1;b.JZd=wy.a(h)+1;Lh.C(h);b.Fq=h.currentNode;b.columns=Qh.TableReader.Nh(b.Fq);b.rows=Qh.TableReader.Hg(b.Fq);h=Object.assign(new DC.a,{NH:this.key,contentId:b.Fq.id,contentObject:b});return{returnValue:!0,Fga:h}}htb(b,h){b=b.contentObject;const r=new ii.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,
b.columns,b.rows));h&&h.contentObject.JZd===b.JZd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.JZd));h&&h.contentObject.eze===b.eze||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.eze));return r.toArray().join(" ")}}Object(u.a)(ME,"TableDetailsProvider",null,[729,377]);class UL{constructor(b,h){this.gTa=b;this.jp=h}get e5b(){return null!=this.Sah?this.Sah:this.Sah=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",
!1)}tug(){this.gTa.execute(b=>{b.SW(new KE);al.a.C_f()||(this.e5b||(b.SW(new hv(1,this.jp)),b.SW(new hv(2,this.jp))),b.SW(new hv(3,this.jp)));b.SW(new ux);b.SW(new EC);b.E0b(new ME);b.E0b(new WG);b.E0b(new $A)})}}Object(u.a)(UL,"AccessibilityActor",null,[]);class GC{constructor(b,h,r){this.Pbo=(A,L,ba)=>{if(1===ba)return 32;this.Euk().YGg();return 32};this.N7a=b;this.Euk=r}mc(){this.N7a.nb(fb.a.gvj,ic.a.view,this.Pbo,1028)}}Object(u.a)(GC,"AutoCorrectActor",null,[]);class KJ{constructor(){this.Wme=
!0}WEa(){}zeb(){}fgc(){}bkg(){}eBe(){}get Ewc(){return!1}get gyb(){return 0}get vij(){return!1}get g1(){return qb.a.nil}}Object(u.a)(KJ,"TextOnlyBox4ImageSteward",null,[523]);class LJ{constructor(b,h,r,A,L,ba,ra=!1){this.OT=b;this.jj=h;this.Dh=r;this.san=A;this.$L=L;this.Dc=ba;this.PJn=ra}create(b,h,r,A){return 1===b?new KJ:new Tj.a(h,this.OT,this.jj,this.Dh,this.Dc,this.san,this.$L,this.PJn,r,A)}}Object(u.a)(LJ,"Box4ImageStewardFactory",null,[707]);var Eo=e(34);class Cw{constructor(b){this.Kie=b}Svn(b){if(!b||
!b.nF||1>b.nF.count)return!1;const h=[Eo.a.Mgi,Eo.a.Lgi];return!!this.G8d(b.nF,1,r=>this.O_d(r,h))}G1i(b){return!b||!b.nF||1>b.nF.count?!1:!!this.G8d(b.nF,1,h=>this.O_d(h,[Eo.a.ZJ]))}Dsn(b){return!b||!b.nF||1>b.nF.count?!1:!!this.G8d(b.nF,2,h=>this.O_d(h,[Eo.a.sXb]))}Wh(b){return!b||!b.nF||1>b.nF.count?!1:!!this.G8d(b.nF,1,h=>this.O_d(h,[Eo.a.epa]))}Dhe(b){if(!b||!b.nF)return!1;b=b.nF;for(let h=0;h<b.count;++h)if(!b.K(h)||0<b.K(h).khl)return!1;return!0}q9l(b,h){return this.G1i(h)||this.Dsn(h)?"":
b}G8d(b,h,r){if(b&&0<b.count)for(let A=b.count-1;0<=A;--A){if(r(b.K(A)))return b.K(A);if(b.count-A>=h)break}return null}O_d(b,h){b=b&&b.xUi?b.xUi.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(u.a)(Cw,"Box4PasteStewardUtils",null,[705]);var rt=e(753);class Pn{constructor(){this.EDc=0;this.ktc=Array(9)}}Object(u.a)(Pn,"FullListMetadata",null,[]);class XG{constructor(b,h,r){this.EDc=this.level=0;this.CFf=null;this.uwc=!1;this.level=b;this.rKe=h;this.Zco=
r}}Object(u.a)(XG,"ListItemMetadata",null,[]);var Dw=e(1257);class MJ{constructor(){this.level=0;this.tagName="UL";this.Ixb=null;this.ignore=!1;this.O_n=0;this.listStyle="BulletListStyle1";this.jxb=new Dw.a;this.font=this.levelText=""}}Object(u.a)(MJ,"ListLevelMetadata",null,[]);class NJ{constructor(){}}Object(u.a)(NJ,"LevelLists",null,[]);class YG{constructor(b){this.nodes=b;this.OWa=0;this.lists={};this.jxb=[];this.T$i=null;this.OSl=[];this.OSl[0]=new NJ}}Object(u.a)(YG,"WordConverterArguments",
null,[]);var mp=e(382),Gz=e(721);class Ki{}Ki.JTl="data-ccp-timestamp";Ki.c2d="data-clipservice-ccpid";Ki.MTl="data-shapeids";Ki.zZm="docs-internal-guid-";Ki.Abo="SCXO";Ki.Llo="SCXP";Ki.xPp="SCXW";Ki.MWn="MsoListParagraphCxSpFirst";Ki.NWn="MsoListParagraphCxSpLast";Ki.Fyf="data-pkey";Ki.Gyf="data-clipservice-type";Ki.Dyf="data-clipservice-count";Ki.Eyf="data-clipservice-dc";Ki.g0c="data-clipservice-client";Ki.Hyf="data-clipservice-version";Object(u.a)(Ki,"HtmlContentMetadataConstants",null,[]);class By{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(u.a)(By,"AbsolutePosition",null,[]);var Rp=e(895);class Xs{constructor(b,h,r="",A=0){this.HA=!1;this.crh=this.drh=null;let L=!1;Xs.Krn(b)&&(L=!0,this.drh=b);Xs.dsn(h)&&(this.crh=h);this.LEk=r;this.muk=A;this.HA=L&&this.Yde?!0:!1}get isValid(){return this.HA}get AUi(){return this.drh}get Yde(){return this.crh}get xUi(){return this.LEk}get khl(){return this.muk}static Krn(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static dsn(b){return b?-1===b.indexOf(" ")&&
0<b.length:!1}}Object(u.a)(Xs,"HtmlElementInfo",null,[]);class vx{constructor(b){this.next=null;this.data=b}}Object(u.a)(vx,"StackNode",null,[]);class HC{constructor(){this.Zw=null;this.ul=0}get count(){return this.ul}get isEmpty(){return!this.count||!this.Zw}push(b){b=new vx(b);b.next=this.Zw;this.Zw=b;this.ul=this.count+1}MW(){return this.count&&this.Zw?this.Zw.data:null}pop(){if(!this.count||!this.Zw)return null;const b=this.Zw;this.Zw=b.next;this.ul=this.count-1;return b.data}clear(){this.Zw=
null;this.ul=0}toArray(){const b=Array(this.count);let h=this.Zw;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(u.a)(HC,"Stack",null,[]);class Uj{constructor(b){this.Wj=b;this.EKc=this.oLd=null;this.GDd=!1}get K1d(){return this.EKc.MW()}reset(){this.Wj.reset();this.oLd=new HC;this.EKc=new HC;this.EKc.push(this.Wj.v0c);this.GDd=!1}ppe(){this.GDd=!1}$N(b){this.GDd||(this.oLd.push(null),this.GDd=!0);this.oLd.push(b)}onClose(){for(;;){const b=this.oLd.pop();if(!b)break;b()}}NTj(){return!1}g_n(){this.Rx(()=>
!0)}Rx(b){const h=this.K1d.clone();return b(h)?(this.EKc.push(h),this.Wj.TOa(h),this.$N(Object(E.a)(this,this.c5n,"onFormattingEnd")),!0):!1}MUf(b){if(sl.a.hwb){let h=2;mp.a.instance.Ae(()=>{h=this.cRi(b)},"AHT:HCA");return h}return this.cRi(b)}cRi(b){return b.style?this.Rx(h=>this.NTj(h,b))?1:2:2}c5n(){this.EKc.pop();this.Wj.TOa(this.K1d)}Dia(){}gpe(){return 2}$gg(){return 2}ahg(){return 2}ehg(){return 2}rhg(){return 3}thg(){}ope(){return 2}uhg(){}vhg(){}whg(){return 2}rpe(){return 2}spe(){return 2}Lhg(){return 2}tpe(){}Nhg(){return 2}vpe(){return 2}wpe(){return 2}zpe(){return 2}Ape(){return 2}Zhg(){}$hg(){return 2}Jpe(){return 2}Kpe(){return 2}Npe(){return 2}Ope(){return 2}Qpe(){return 2}Rpe(){return 2}Spe(){return 2}Upe(){return 2}Gig(){return 2}cqe(){return 2}Nig(){return 2}Qig(){}Rig(){return 2}fqe(){return 2}gqe(){return 2}hqe(){return 2}iqe(){return 2}jqe(){return 2}kqe(){return 2}Yig(){return 3}lqe(){}bjg(){return 2}mqe(){return 2}djg(){return 3}qqe(){}ijg(){}rqe(){return 2}njg(){return 3}uqe(){return 2}xqe(){return 2}Aqe(){return 2}Bqe(){return 2}yjg(){}Cjg(){return 3}Dqe(){return 2}onMenuOpen(){return 2}Ijg(){}Qjg(){return 2}Rjg(){return 2}Tjg(){return 3}Mqe(){return 2}Vjg(){return 2}Oqe(){return 2}Sqe(){return 2}akg(){}$qe(){return 2}mkg(){return 2}ire(){return 2}jre(){return 2}Ckg(){return 3}Ikg(){return 2}ure(){return 2}vre(){return 2}xre(){return 2}yre(){return 2}Mkg(){return 3}zre(){return 2}Bre(){return 2}Dre(){return 2}Skg(){return 2}cjd(){return 2}Wkg(){return 2}Xkg(){return 2}Gre(){return 2}Ykg(){return 2}blg(){return 3}Lre(){return 2}Mre(){return 2}Nre(){return 2}Ore(){return 2}Ure(){return 2}Rre(){return 2}static vYa(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(D.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static $Pf(b){if(!b||""===b)return-1;const h=D.a.Ph(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(D.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(D.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static YGi(b){const h=Uj.$Pf(b);return-1===h?(v.ULS.sendTraceTag(508678240,307,50,`Unhandled unit or blank string , is blankstring => ${!b}`),-1):0>h?(v.ULS.sendTraceTag(508925786,
307,50,"Negative margin in px or pt"),-1):h}static ZGi(b){b=Uj.$Pf(b);return fg.a.fM(b)}static HRm(b){return Uj.$Pf(b)}static KJi(b){return b&&""!==b?Uj.vYa(b):null}static LH(b){let h=null,r=null,A=null,L=null;b&&b.Vf&&(h=Uj.getField(b.Vf,"id"),r=Uj.getField(b.Vf,"lang"),A=b.Vf.tagName,b.Scl&&(L=Object.assign(new By,{x:Uj.vYa(b.Vf.style.left),y:Uj.vYa(b.Vf.style.top),left:Uj.KJi(b.Vf.style.left),top:Uj.KJi(b.Vf.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new Rp.a(new Xs(h,A),b.nF,
null,r,L)}static getField(b,h){return b[h]}}Object(u.a)(Uj,"AHtmlTranslator",null,[264]);class ZG extends Rp.a{constructor(b,h,r,A=0,L=0,ba=null){super(ba?ba.Mda:null,ba?ba.nF:null,ba?ba.iFa:null,ba?ba.cultureName:null,ba?ba.VJa:null);this.width=A;this.height=L}}Object(u.a)(ZG,"AugmentationSemanticArgs",Rp.a,[]);var $G=e(1269);class aH{constructor(){this.stop=this.color=null}}Object(u.a)(aH,"ColorStopPair",null,[]);var Sp=e(2008);class $v{constructor(){this.direction=null;this.OYc=new Dw.a}uSi(){return!!this.direction&&
0<this.direction.length}}Object(u.a)($v,"LinearGradient",null,[]);class np{constructor(){this.hqc=!1}}Object(u.a)(np,"HtmlTranslatorContext",null,[]);var VL=e(1882);class NE{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(u.a)(NE,"IndentationProperties",null,[]);var Hs=e(1265);class OE extends Rp.a{constructor(b,h,r,A,L=null,ba=0,ra=null,Ia=null,Ta=!1,ob=!1,nb=69905,Eb=null){super(Eb?Eb.Mda:null,Eb?Eb.nF:null,Eb?Eb.iFa:null,Eb?Eb.cultureName:null,Eb?Eb.VJa:null);this.colSpan=b;this.rowSpan=
h;this.width=r;this.Hrc=ob;this.height=A;this.Ucb=Ta;this.shadingColor=L;this.verticalAlignment=ba;this.dqa=ra;this.sFe=Ia;this.Qba=nb}}Object(u.a)(OE,"TableCellSemanticArgs",Rp.a,[]);class aw extends Rp.a{constructor(b,h=null){super(h?h.Mda:null,h?h.nF:null,h?h.iFa:null,h?h.cultureName:null,h?h.VJa:null);this.height=b}}Object(u.a)(aw,"TableRowSemanticArgs",Rp.a,[]);class bH extends Rp.a{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob=null,nb=-1,Eb=null){super(Eb?Eb.Mda:null,Eb?Eb.nF:null,Eb?Eb.iFa:null,Eb?
Eb.cultureName:null,Eb?Eb.VJa:null);this.LZd=null;this.rowCount=b;this.Xpb=h;this.width=r;if(L)for(this.LZd=Array(L.length),b=0;b<L.length;++b)this.LZd[b]=L[b];this.T_f=ba;this.xKg=Ia;this.Amn=ra;this.Ucb=A;this.Uee=Ta;this.styleId=ob;this.tableLook=nb}}Object(u.a)(bH,"TableSemanticArgs",Rp.a,[]);var Pt=e(1279);let bw;class Gn extends Uj{constructor(b,h,r=new np,A=null,L=null){super(b);this.settings=h;this.context=r;this.Ted=A;this.qUb=L;this.lIb=null;this.VJk=sb.a.M$("none",1,"disc",3,"circle",4,
"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Abj=0;this.RHn=new Set(["LI","OL","UL","MENU"]);this.v3o=new Set("DIV P H1 H2 H3 H4 H5 H6".split(" "))}get Jbj(){return this.VJk}FGi(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.Jbj[D.a.Ph(r)])||(r=Uj.getField(b,"type"))&&""!==r&&(r=this.Jbj[r]))return r;
if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=b.className))if("ul"===r)switch(b=Gn.$be(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Gn.$be(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}wGi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===
r||"ul"===r){b=eb.a.kDi(b,"li");if(!b)return h;r="li"}if("li"===r){h=(h=this.o8d(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=eb.a.kDi(b,"p"))return Gn.kFm(b)-1}return h}o8d(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}L6n(){this.lIb.pop();this.Wj.ywa()}y8c(b,h){this.Rx(L=>L.tja(0,0));const r=this.FGi(b.Vf,h?6:2);let A=1;h&&(A=this.o8d(b.Vf,"start",1));h=!1;h=b.Vf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.Vf.removeAttribute("data-pasteFromRc");(X.a.w9||X.a.Hj)&&
Gn.pZd(b.Vf);this.w$o(b)&&this.j1d();b=new Hs.a(r,A,Uj.LH(b),this.Abj,-1,h);this.lIb.push(b);this.Wj.ZEa(b);this.$N(Object(E.a)(this,this.L6n,"onListElementClose"));return 1}w$o(b){var h,r;return sl.a.C2f?(b=null===(r=null===(h=b.Vf)||void 0===h?void 0:h.parentElement)||void 0===r?void 0:r.tagName)&&this.RHn.has(b)?!1:!0:!1}j1d(){this.Abj=Date.now()}OQl(b,h,r){return(h=h.getAttribute(r))?b.hxf(h):!1}reset(){super.reset();this.lIb=new HC}NTj(b,h){if(sl.a.hwb){let r=!1;mp.a.instance.Ae(()=>{r=this.OTj(b,
h)},"DHT:SFFA");return r}return this.OTj(b,h)}OTj(b,h){var r,A,L,ba,ra,Ia,Ta;let ob=!1;try{var nb=h.getAttribute("xml:lang")||Uj.getField(h,"lang")}catch(Bc){nb=null}nb&&""!==nb&&(ob=b.nDg(nb)||ob);(nb=Uj.getField(h,"dir"))&&(ob=b.bAc(nb)||ob);if(this.settings.E$o(this.context)&&h.getAttribute)for(nb=0;nb<Gn.E3j.length;nb++)ob=this.OQl(b,h,Gn.E3j[nb])||ob;nb=h.style;const Eb=window.performance.now();var bc;sl.a.yva?bc=null===(r=this.qUb)||void 0===r?void 0:r.Sbm(h):sl.a.krc&&(bc=getComputedStyle(h));
Pt.a.RGe+=window.performance.now()-Eb;Pt.a.Boe+=1;sl.a.pmk&&(nb=getComputedStyle(h));if(nb){if(nb.fontWeight||h instanceof HTMLHeadingElement&&sl.a.Rhe&&sl.a.yva)r=D.a.BE(null!==(A=null===bc||void 0===bc?void 0:bc.fontWeight)&&void 0!==A?A:nb.fontWeight),A=parseInt(r),isNaN(A)?"BOLD"===r?ob=b.GP(!0)||ob:"NORMAL"===r&&(ob=b.GP(!1)||ob):ob=600<=A?b.GP(!0)||ob:b.GP(!1)||ob;if(this.settings.lYj&&nb.fontSize||h instanceof HTMLHeadingElement&&sl.a.Rhe&&sl.a.yva)A=null!==(L=null===bc||void 0===bc?void 0:
bc.fontSize)&&void 0!==L?L:nb.fontSize,L=Uj.HRm(A),0<L&&(ob=b.VAe(Math.floor(2*L))||ob);this.v9o(h)&&(L=Uj.YGi(null!==(ba=null===bc||void 0===bc?void 0:bc.marginTop)&&void 0!==ba?ba:nb.marginTop),ba=Uj.YGi(null!==(ra=null===bc||void 0===bc?void 0:bc.marginBottom)&&void 0!==ra?ra:nb.marginBottom),-1!==L||-1!==ba)&&(ob=b.tja(L,ba)||ob);sl.a.B5i&&this.S_f(h)&&(ra=Uj.ZGi(null!==(Ia=null===bc||void 0===bc?void 0:bc.marginLeft)&&void 0!==Ia?Ia:nb.marginLeft),Ia=Uj.ZGi(null!==(Ta=null===bc||void 0===bc?
void 0:bc.marginRight)&&void 0!==Ta?Ta:nb.marginRight),ra||Ia)&&(ob=b.HDg(ra,Ia)||ob);this.settings.I$o(this.context)&&(this.settings.pYj&&h.getAttribute?(Ta=h.getAttribute("data-indent"))&&0<Ta.length&&(Ta=rb.a.Zj(parseInt(Ta),0)+"px",ob=b.SBe(Ta)||ob):nb.textIndent&&(ob=b.SBe(nb.textIndent)||ob));this.settings.D$o(this.context)&&nb.marginLeft&&(this.settings.pYj&&h.getAttribute?(Ta=h.getAttribute("data-margin"))&&0<Ta.length&&(ob=b.Hpa(nb.marginLeft)||ob):"TABLE"!==h.tagName&&(ob=b.Hpa(nb.marginLeft)||
ob));if(this.settings.G$o(this.context)&&(Ta=h.getAttribute("style"))&&""!==Ta)for(Ta=Ta.split(";"),Ia=0;Ia<Ta.length;Ia++)bc=Ta[Ia].trim(),bc.startsWith("tab-stops")&&(ob=b.gEg(bc.replace("tab-stops:",""))||ob);this.settings.C$o(this.context)&&nb.lineHeight&&(ob=b.HG(nb.lineHeight)||ob);this.settings.z$o&&(Ta=nb.textTransform?D.a.Ph(nb.textTransform):null,Ia=nb,Ia=Ia.fontVariantCaps?D.a.Ph(Ia.fontVariantCaps):null,bc=nb.fontVariant?D.a.Ph(nb.fontVariant):null,"uppercase"===Ta?ob=b.Srd("uppercase")||
ob:"small-caps"===Ia||bc&&0<=bc.indexOf("small-caps")?ob=b.Srd("small-caps")||ob:this.settings.Msl&&"none"===Ta&&(ob=b.Srd("none")||ob));this.settings.H$o(this.context)&&nb.textAlign&&(ob=b.B2b(D.a.Ph(nb.textAlign))||ob);nb.fontStyle&&(Ta=D.a.BE(nb.fontStyle),"ITALIC"===Ta||"OBLIQUE"===Ta?ob=b.OAb(!0)||ob:"NORMAL"===Ta&&(ob=b.OAb(!1)||ob));Ta=Gn.HUm(h);if(nb.textDecoration||Ta)Ia=D.a.Ph(nb.textDecoration||""),Ta=D.a.Ph(Ta||""),h.parentNode&&h.parentNode.tagName&&"a"===D.a.Ph(h.parentNode.tagName)?
(bc=(h.querySelector(".TextRun")||h).className)&&-1<bc.indexOf("Underlined")&&(ob=b.z$(!0)||ob):nb.yxq||Gn.isUnderline(Ia)||Gn.isUnderline(Ta)?ob=b.z$(!0)||ob:this.settings.uZj&&(ob=b.z$(!1)||ob),nb.xxq||Gn.b4i(Ia)||Gn.b4i(Ta)?ob=b.Jpa(!0)||ob:this.settings.uZj&&(ob=b.Jpa(!1)||ob);if(nb.verticalAlign){Ta=D.a.BE(nb.verticalAlign);Ia=this.lwo(Ta);if("SUB"===Ta||this.settings.oYj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>Ia&&this.settings.VYj)ob=b.oQa(!0)||ob;else if("SUPER"===
Ta||this.settings.oYj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<Ia&&this.settings.VYj)ob=b.Mxa(!0)||ob;this.settings.lYj&&("SUB"===Ta||"SUPER"===Ta)&&h.getAttribute&&(Ta=parseFloat(h.getAttribute("data-fontsize")),isNaN(Ta)||(ob=b.VAe(Math.floor(2*Ta))||ob))}Ta=!1;y.AFrameworkApplication.J&&(Ta=y.AFrameworkApplication.J.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.B$o&&nb.fontFamily&&(this.settings.K$o&&h.getAttribute?(Ia=h.getAttribute("data-usefontface"))&&"true"===
Ia&&(Ta&&v.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),ob=this.LTj(b,nb.fontFamily,ob)):ob=this.LTj(b,nb.fontFamily,ob));Ia=null;this.settings.A$o&&nb.color&&(Ia=Sp.a.Eta(nb.color));bc=!!Ia;this.settings.J$o(this.context)&&h.getAttribute&&(Ia=h.getAttribute("data-scheme-color"),Ia=null!==Ia?Ia:"",bc=""!==Ia||!this.context.hqc||Gn.KAn(h));bc&&(ob=b.Uy(Ia)||ob);!this.settings.x$o||!nb.backgroundColor||h.tagName&&Gn.Ppp.contains(D.a.BE(h.tagName))||(Ia=nb.backgroundColor,ob=sl.a.Omn&&this.S_f(h)?
b.lea(Sp.a.Eta(Ia))||ob:b.lGa(Sp.a.Eta(Ia))||ob);if(this.settings.y$o&&nb.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(nb=Gn.qXm(nb.backgroundImage))&&0<nb.OYc.count){Ia=nb.OYc.K(0).color;bc=!0;for(ra=0;ra<nb.OYc.count&&(bc=bc&&Ia===nb.OYc.K(ra).color,bc);ra++);bc&&(Ta&&v.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),ob=b.lGa(Sp.a.Eta(Ia))||ob)}}this.settings.nYj(this.context)&&h.getAttribute&&(nb=h.getAttribute("data-ccp-props"))&&(ob=b.kea(nb)||ob);h.getAttribute&&
((nb=h.getAttribute("data-ccp-charstyle"))&&this.settings.kBb&&(ob=b.Vqd(nb)||ob),(nb=h.getAttribute("data-ccp-parastyle"))&&this.settings.kBb&&(ob=b.Brd(nb)||ob));return ob=this.b6o(b,h.className)||ob}v9o(b){const h=sl.a.fwn&&this.S_f(b);return b instanceof HTMLHeadingElement?h&&sl.a.Rhe&&sl.a.yva:h}S_f(b){const h=this.v3o.has(b.tagName);return sl.a.v1i?h&&"inline"!==b.style.display:h}b6o(b,h){if(!D.a.jg(h)&&sl.a.Lzn){var r=this.FKm(h);if(r)return b.Brd(r);if(h=this.yrm(h))return b.Vqd(h)}}FKm(b){switch(b){case "MsoTitle":return"Title";
case "MsoSubtitle":return"Subtitle";case "MsoNoSpacing":return"No Spacing";case "MsoQuote":return"Quote";case "MsoIntenseQuote":return"Intense Quote";default:return null}}yrm(b){switch(b){case "TitleChar":return"Title Char";case "SubtitleChar":return"Subtitle Char";case "QuoteChar":return"Quote Char";case "IntenseQuoteChar":return"Intense Quote Char";case "MsoSubtleReference":return"Subtle Reference";case "MsoIntenseReference":return"Intense Reference";case "MsoListParagraph":return"List Paragraph";
case "MsoBookTitle":return"Book Title";default:return null}}Obp(b){if(this.settings.Pbp)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<D.a.BE(b.className).indexOf("MSOCOM"))return!0;if("DIV"===D.a.BE(b.tagName))break;b=b.parentNode}return!1}LTj(b,h,r){h=Gn.rnm(h);let A=!1,L=0;if(!h)return r;for(const ba of h){if(A=b.sgb(ba,this.settings.qnp))break;L++}1<h.length&&(A?v.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",
L+1,h.length):v.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return A||r}lwo(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Dia(b,h){"\u200b"===b&&(b="\u00a0");h&&h.Vf&&this.Obp(h.Vf)&&(b="");this.Wj.Dia(b,Uj.LH(h))}gpe(b){const h=Uj.getField(b.Vf,"href");return h&&""!==h?(this.Wj.f0a(h,Uj.LH(b)),this.$N(Object(E.a)(this.Wj,this.Wj.e0a,"onAnchorEnd")),1):2}ope(){return this.Rx(b=>b.GP(!0))?1:2}rpe(){return this.Rx(b=>
b.FUf())?1:2}spe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}tpe(b){this.Wj.Dda(Uj.LH(b))}vpe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}zpe(){return this.Rx(b=>b.OAb(!0))?1:2}wpe(b){this.Rx(h=>h.B2b("center"));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Ape(){return this.Rx(b=>b.sgb("consolas"))?1:2}Kpe(){return this.Rx(b=>b.Jpa(!0))?1:2}Jpe(b){return this.y8c(b,
!1)}Npe(){return this.Rx(b=>b.OAb(!0))?1:2}Ope(b){return this.y8c(b,!1)}Qpe(b){var h=b.Vf.getAttribute("data-render-src");const r=b.Vf.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const ra=b.Vf.getAttribute("data-render-fallback");let Ia=0,Ta=0;if(b.Vf.currentStyle){var A=b.Vf.currentStyle.width,L=b.Vf.currentStyle.height;A&&-1!==A.indexOf("px")&&(A=parseInt(D.a.substring(A,0,A.indexOf("px"))),isNaN(A)||(Ia=A));L&&-1!==L.indexOf("px")&&(L=parseInt(D.a.substring(L,0,L.indexOf("px"))),
isNaN(L)||(Ta=L))}b=new ZG(h,r,ra,Ia,Ta,Uj.LH(b));this.Wj.zeb(b);return 2}(X.a.w9||X.a.Hj)&&(h=b.Vf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Gn.pZd(b.Vf);const ba=b.Vf.getAttribute("align");h=this.Rx(ra=>ra.B2b(ba));if(!this.oBb(b))return h?1:2;this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Rpe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Spe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,
"onParagraphEnd"));return 1}Upe(){return this.Rx(b=>b.OAb(!0))?1:2}cqe(b){return this.Rx(h=>{var r=Gn.Zzm(b.Vf.getAttribute("face"));r=h.sgb(r);h=h.Uy(Sp.a.Eta(b.Vf.getAttribute("color")));return r||h})?1:2}fqe(b){if(!this.oBb(b))return 2;this.Rx(h=>this.settings.kBb?h.SAb(1):h.UAb(1));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}oBb(b){var h;return"inline"===(null===(h=b.Vf)||void 0===h?void 0:h.style.display)&&sl.a.v1i?!1:!0}gqe(b){if(!this.oBb(b))return 2;
this.Rx(h=>this.settings.kBb?h.SAb(2):h.UAb(2));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}hqe(b){if(!this.oBb(b))return 2;this.Rx(h=>this.settings.kBb?h.SAb(3):h.UAb(3));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}iqe(b){if(!this.oBb(b))return 2;this.Rx(h=>this.settings.kBb?h.SAb(4):h.UAb(4));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}jqe(b){if(!this.oBb(b))return 2;
this.Rx(h=>this.settings.kBb?h.SAb(5):h.UAb(5));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}kqe(b){if(!this.oBb(b))return 2;this.Rx(h=>this.settings.kBb?h.SAb(6):h.UAb(6));this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}lqe(b){this.Wj.Dda(Uj.LH(b))}qqe(b){var h=b.Vf;const r=h.src,A=h.alt,L=h.mfq,ba=h.getAttribute("data-external-content-url");let ra=0,Ia=0;h.style&&(ra=Uj.vYa(h.style.width),Ia=Uj.vYa(h.style.height));
ra&&Ia||(ra=h.width,Ia=h.height);let Ta=0,ob=0;b.Vf.currentStyle&&(ra||Ia||(ra=Uj.vYa(b.Vf.currentStyle.width),Ia=Uj.vYa(b.Vf.currentStyle.height)),Ta=Uj.vYa(b.Vf.currentStyle.maxWidth),ob=Uj.vYa(b.Vf.currentStyle.maxHeight));!sl.a.msn||ra&&Ia||(Ia=ra=0);let nb=null;const Eb=h.getAttribute(Ki.c2d);if(Eb&&(v.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChartsPasteFromXLOIsEnabled",!1))){const bc=
h.getAttribute(Ki.Fyf),Bc=h.getAttribute(Ki.Gyf),Yc=h.getAttribute(Ki.Dyf),zd=h.getAttribute(Ki.Eyf),Jd=h.getAttribute(Ki.g0c);h=h.getAttribute(Ki.Hyf);bc&&zd&&(nb=new $G.a(Eb,bc,Bc,Yc,zd,Jd,h))}b=new VL.a(r,A,ra,Ia,Uj.LH(b),Ta,ob,L,null,ba,nb);this.Wj.WEa(b)}mqe(){return this.Rx(b=>b.OAb(!0))?1:2}rqe(){return this.Rx(b=>b.z$(!0))?1:2}uqe(){return this.Rx(b=>b.sgb("consolas"))?1:2}xqe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Aqe(b){this.Wj.JH(Uj.LH(b));
this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Bqe(b){let h;const r=this.FGi(b.Vf,0);let A=this.o8d(b.Vf,"value",0);0<this.lIb.count?h=this.lIb.MW():(h=new Hs.a(2,1,Uj.LH(b)),A||(A=1));var L=Gn.uFm(b.Vf,Hs.a.x$j);3!==L&&(h.Cu=L);L=h.listLevel;let ba=h.listId;this.settings.mYj?(L=this.wGi(b.Vf),L=0>L&&0>h.listLevel&&0<this.lIb.count?h.listLevel=this.lIb.count-1:h.listLevel=0<=L?L:h.listLevel,this.Ted&&this.Ted.b<L&&(this.Ted.b=L)):0>L&&(L=h.listLevel=this.wGi(b.Vf));1>ba&&(ba=h.listId=
this.o8d(b.Vf,Hs.a.Led,0));b.Vf.getAttribute(Hs.a.Oed)&&(h.levelText=b.Vf.getAttribute(Hs.a.Oed));var ra=b.Vf.getAttribute(Hs.a.P7f);ra&&(h.font=ra);ra=!1;y.AFrameworkApplication.J&&(ra=y.AFrameworkApplication.J.$("FollowDestinationThemePasteIsEnabled"));if(ra){var Ia=b.Vf.getAttribute("data-charcodes");ra=[];if(Ia&&""!==Ia)if(-1<Ia.indexOf(",")){Ia=Ia.split(",");for(var Ta=0;Ta<Ia.length;Ta++)ra.push(parseInt(Ia[Ta]))}else ra.push(parseInt(Ia));if(ra&&0<ra.length){Ia=Array(ra.length);for(Ta=0;Ta<
ra.length;Ta++)Ia[Ta]=ra[Ta];h.jrf=Ia}(ra=b.Vf.getAttribute("data-buAutoNum"))&&0<ra.length&&(h.buAutoNum=parseInt(ra))}(L=0<=L&&0<ba)&&Gn.pZd(b.Vf);h.Tdl(r,A,L);h.N7f=this.$Em(b.Vf);this.Wj.XOa(h.clone());this.$N(Object(E.a)(this.Wj,this.Wj.YEa,"onListItemEnd"));return 1}$Em(b){var h=b.getAttribute(Hs.a.tbj);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{v.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;
h=new Ai.DictionaryPropertySet;for(const r in b)h.pWj(+r,b[r]);return h}onMenuOpen(b){return this.y8c(b,!1)}Dqe(b){if(this.Rx(h=>h.Szc(!0))){const h=b.Vf.getAttribute("OuterHtml");this.Wj.l0a(h,Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.teb,"onMathEnd"))}return 1}Mqe(b){return this.y8c(b,!0)}Oqe(b){this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}Sqe(b){const h=b.Vf.getAttribute("align");this.Rx(A=>A.B2b(h));const r=b.Vf.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&
Gn.pZd(b.Vf,X.a.w9||X.a.Hj);if(!this.oBb(b))return 2;this.Wj.JH(Uj.LH(b));this.$N(Object(E.a)(this.Wj,this.Wj.gJ,"onParagraphEnd"));return 1}$qe(){this.Rx(b=>b.sgb("consolas"));this.Wj.Eyb();this.$N(Object(E.a)(this.Wj,this.Wj.Dyb,"onPreFormattedTextEnd"));return 1}ire(){return this.Rx(b=>b.Jpa(!0))?1:2}jre(){return this.Rx(b=>b.sgb("consolas"))?1:2}ure(){return this.Rx(b=>b.zHg())?1:2}vre(b){var h=b.Vf.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=Sp.a.Tgo(r);if(0<h&&this.settings.Xfn){for(r=
0;r<h;r++)this.Wj.Iyb(Uj.LH(b));return 3}return 2}xre(){return this.Rx(b=>b.Jpa(!0))?1:2}yre(){return this.Rx(b=>b.GP(!0))?1:2}zre(){return this.Rx(b=>b.oQa(!0))?1:2}Bre(){return this.Rx(b=>b.Mxa(!0))?1:2}Dre(b){this.Rx(nb=>nb.dG()&&nb.jyg());Sp.a.Kce(b.Vf,this);const h=Sp.a.mPi(b.Vf),r=Sp.a.Fzi(b.Vf),A=Sp.a.eP(b.Vf),L=Sp.a.fP(b.Vf),ba=!parseInt(Uj.getField(b.Vf,"border")),ra=Sp.a.jAn(b.Vf);let Ia=-1,Ta="";var ob=-1;b.Vf.attributes.hasOwnProperty("style")&&-1!==(ob=b.Vf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?
Ia=parseInt(b.Vf.attributes.getNamedItem("style").value.substr(ob+17)):b.Vf.attributes.hasOwnProperty(Gz.a.d2d.toString())&&(Ia=parseInt(b.Vf.attributes.getNamedItem(Gz.a.d2d.toString()).value));ob=-1;b.Vf.attributes.hasOwnProperty("class")&&-1!==(ob=b.Vf.attributes.getNamedItem("class").value.indexOf("Mso"))?Ta=b.Vf.attributes.getNamedItem("class").value.substr(ob).split(" ")[0]:b.Vf.attributes.hasOwnProperty(Gz.a.h0c.toString())&&(Ta=b.Vf.attributes.getNamedItem(Gz.a.h0c.toString()).value);this.Wj.Jda(new bH(0,
0,h.value,h.E6i,null,ba,ra,r,new NE(A.value,L.value),Ta,Ia,Uj.LH(b)));this.$N(Object(E.a)(this.Wj,this.Wj.Hda,"onTableEnd"));return 1}cjd(b){const h=Sp.a.tEi(b.Vf),r=Sp.a.mPi(b.Vf);if(!r.value&&r.Ghe&&this.settings.Jxj)return 3;let A=parseInt(Uj.getField(b.Vf,"colSpan"));if(void 0===A||null===A||""===A+"")A=r.value?1:0;let L=parseInt(Uj.getField(b.Vf,"rowSpan"));if(void 0===L||null===L||""===L+"")L=h.value?1:0;let ba=!1;b.Vf.attributes.hasOwnProperty("style")&&(ba=-1!==b.Vf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||
-1!==b.Vf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ba&&b.Vf.attributes.hasOwnProperty("class")&&(ba=-1!==b.Vf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ra=69905;if(b.Vf.attributes.hasOwnProperty(Gz.a.Cyf.toString())){var Ia=parseInt(b.Vf.attributes.getNamedItem(Gz.a.Cyf.toString()).value);isNaN(Ia)||(ra=Ia)}Ia=Sp.a.Eta(b.Vf.style.backgroundColor);const Ta=Sp.a.vXm(b.Vf);this.Rx(Eb=>Eb.tja(0,0));Sp.a.Kce(b.Vf,this);const ob=Sp.a.Fzi(b.Vf),
nb=this.settings.Dho?Sp.a.drm(b.Vf):null;b=new OE(A,L,r.value,h.value,Ia,Ta,ob,nb,r.E6i,ba,ra,Uj.LH(b));this.Wj.Gda(b);this.$N(Object(E.a)(this.Wj,this.Wj.Fda,"onTableCellEnd"));this.g_n();return 1}Gre(b){const h=this.cjd(b);if(3===h)return h;this.Rx(r=>{const A=r.GP(!0);r=r.B2b("center");return A||r});Sp.a.Kce(b.Vf,this);return 1}Lre(b){Sp.a.Kce(b.Vf,this);const h=Sp.a.tEi(b.Vf);if(h.Ghe&&!h.value&&this.settings.Jxj)return 3;this.Wj.W9(new aw(h.value,Uj.LH(b)));this.$N(Object(E.a)(this.Wj,this.Wj.Ida,
"onTableRowEnd"));return 1}Mre(){return this.Rx(b=>b.sgb("consolas"))?1:2}Nre(){return this.Rx(b=>b.z$(!0))?1:2}Ore(b){return this.y8c(b,!1)}Rre(){return 2}Ure(){return this.Rx(b=>b.z$(!0))?1:2}static sxm(b){if(!b)return null;b=b.split(",");1<b.length&&v.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static pnm(b){return b?b.split(","):null}static J8j(b){if(!b)return null;b=D.a.ewg(b.trim(),'"');return b=D.a.ewg(b,"'")}static Zzm(b){if(!b)return null;b=Gn.sxm(b);
return b=Gn.J8j(b)}static rnm(b){var h;if(!b)return null;b=null===(h=Gn.pnm(b))||void 0===h?void 0:h.map(r=>Gn.J8j(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static QTh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.uSi())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<r.length){if(b.uSi())return!1;b.direction=h;return!0}var A=(r=h.match(RegExp("^rgb\\(.*\\)")))&&
0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===A?h:Sp.a.Eta(h.substr(0,A).trim());if(!r||""===r)return!1;h=-1===A?"":h.substr(A).trim();A=new aH;A.color=r;A.stop=h;b.OYc.add(A);return!0}static qXm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new $v;for(;0<h.trim().length;){let A=h.indexOf(",");const L=h.indexOf("(");if(0<L&&L<A){const ba=h.indexOf(")");if(ba<L)return null;A=h.indexOf(",",
ba)}if(-1===A){if(!Gn.QTh(r,h))return null;h=""}else{const ba=h.substr(0,A);h=h.substr(A+1);if(!Gn.QTh(r,ba))return null}}return r}catch(h){return null}}static $be(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static pZd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Gn.G7h(b,h))}static G7h(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&Gn.G7h(b,h)),b=b.nextSibling}static kFm(b){if("p"!==b.tagName.toLowerCase())return-1;
if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static uFm(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static KAn(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static HUm(b){b=
b.style.textDecorationLine;return void 0===b||null===b?null:b}static b4i(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Gn.Ppp=(bw=new Cb.a,bw.add("TABLE"),bw.add("THEAD"),bw.add("TBODY"),bw.add("TFOOT"),bw.add("TR"),bw.add("TH"),bw.add("TD"),bw);Gn.E3j=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(u.a)(Gn,"DefaultHtmlTranslator",Uj,[]);var Mq=e(1048);class pn{constructor(b=
null){this.V7=b||Mq.a.qPi("");this.qBh=Number.parseInvariant((new Date).format("HHmmss"))}get Wc(){return this.V7}process(b,h){if(b&&b.querySelectorAll){const ba=b.querySelectorAll("p");if(ba&&0<ba.length){for(var r=0,A=!1,L=ba[0].parentNode;5>r&&L&&L!==b;){r++;const ra=L.id.toLowerCase();if(ra&&ra.length&&-1!==ra.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(L,"WACEditing")&&Sys.UI.DomElement.containsCssClass(L,"EditingSurfaceBody")){A=!0;break}L=L.parentNode}if(A&&L!==b){r=b.firstChild;
for(A=!1;0<L.children.length&&L.children[0]!==r;)b.insertBefore(L.children[0],r),A=!0;if(A)for(;r;)L=r.nextSibling,b.removeChild(r),r=L}b=new rt.a(h,Object(E.a)(this,this.rpo,"processNodesDiscovery"),new YG(ba));b.$m("Word Converter Operation");b.Ei=!h||h.Ei;b.run()}}}rpo(b,h){const r=h.nodes[h.OWa];var A=pn.fFm(r);if(A){let ba=A.rKe.replace(RegExp("level[0-9]"),"").trim();ba=ba&&ba.length?ba:A.rKe;let ra=h.lists[ba];ra||(ra=new Pn,ra.EDc=this.qBh++);let Ia=ra.ktc[A.level-1];Ia||(Ia=new MJ,Ia.level=
A.level);var L=r.parentNode;if(L&&"li"===L.tagName.toLowerCase()){if(L=L.parentNode)!(L=L.tagName.toUpperCase())||"OL"!==L&&"UL"!==L||(Ia.tagName=L)}else Ia.Ixb=pn.XCi(r,5),Ia.Ixb&&Ia.Ixb.length||(Ia.Ixb=pn.BRf(r,5)),Ia.ignore=!Ia.Ixb||!Ia.Ixb.length,Ia.tagName=pn.WCi(Ia.Ixb),"UL"===Ia.tagName&&(Ia.font=this.HDi(r,5));A.EDc=ra.EDc;Ia.O_n++;Ia.ignore||"li"===r.parentNode.tagName.toLowerCase()||(L=(L=pn.BRf(r,5))?L:Ia.Ixb)&&L.length&&(A.CFf=L,(L=pn.N2o(r,L,Ia.listStyle,A.level-1))&&L.length&&(Ia.listStyle=
L));h.jxb[h.jxb.length]=A;Ia.jxb.contains(A)||Ia.jxb.add(A);if(void 0===ra.ktc[A.level-1]||null===ra.ktc[A.level-1]||ra.ktc[A.level-1]!==Ia)ra.ktc[A.level-1]=Ia;h.lists[ba]&&h.lists[ba]===ra||(h.lists[ba]=ra);h.T$i=r}else if((A=h.T$i)&&pn.kOm(r)===A&&r.tagName===A.tagName&&r.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));r.firstChild;)A.appendChild(r.firstChild);r.parentNode.removeChild(r)}h.OWa++;if(h.nodes.length<=
h.OWa){if(!h.jxb.length)return!1;h.OWa=0;b.fj(Object(E.a)(this,this.qpo,"processNodeConvert"))}return!0}qpo(b,h){var r;b=h.jxb[h.OWa];var A=b.Zco,L=b.rKe.replace(RegExp("level[0-9]"),"").trim();L=L&&L.length?L:b.rKe;L=h.lists[L];const ba=L.ktc[b.level-1];var ra=A.parentNode.tagName.toLowerCase();if(!ba.ignore&&A.parentNode&&"li"!==ra){if(ra=pn.wNl(A,ba)){pn.p7h(A,5);const Ia=A.ownerDocument.createElement("LI");Ia.setAttribute("data-aria-level",String.format("{0}",b.level));Ia.setAttribute(Hs.a.Led,
String.format("{0}",L.EDc));if("UL"===ba.tagName)Ia.setAttribute(Hs.a.Oed,String.format("{0}",b.CFf)),Ia.setAttribute(Hs.a.P7f,String.format("{0}",ba.font));else if("OL"===ba.tagName&&sl.a.qmk){L=RegExp("[0-9]+|[a-zA-Z]+");const Ta=null===(r=b.CFf)||void 0===r?void 0:r.replace(L,"%"+b.level);Ia.setAttribute(Hs.a.Oed,String.format("{0}",Ta));v.ULS.sendTraceTag(508101642,307,50,"Passed level text information")}for(;A.firstChild;)Ia.appendChild(A.firstChild);ra.appendChild(Ia);A.parentNode.removeChild(A);
"UL"===ba.tagName?this.Wc.b++:this.Wc.c++}}else"li"===ra&&(r=ba.tagName,A=A.parentNode,b.uwc&&(b=A.parentNode)&&b.tagName.toUpperCase()===r&&b.setAttribute("data-pasteFromRc","true"),A.setAttribute(Hs.a.Led,String.format("{0}",L.EDc)),"UL"===r?this.Wc.b++:this.Wc.c++);h.OWa++;return h.OWa<h.jxb.length}HDi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const L=b.childNodes[A];r=pn.$zm(L);!r&&1===L.nodeType&&1<h&&(r=this.HDi(L,h-1))}return r}static wNl(b,h){b=pn.vNl(b,h.tagName);return pn.LHl(b,
h)}static LHl(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static vNl(b,h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));sl.a.Nmn&&(r=b.getAttribute("align")||b.style.textAlign)&&(h.style.textAlign=r);(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Gn.$be(r,
"NumberListStyle"):Gn.$be(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static p7h(b,h){for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];1===A.nodeType&&1<h&&pn.p7h(A,h-1);if(pn.Tpn(A)||pn.k3i(A))b.removeChild(A),r--}}static fFm(b){if(1===b.nodeType){var h=pn.vRf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const A=Number.parseInvariant(r[1].substr(5)),L=new XG(A,
h,b);L.uwc=!0;return L}}catch(A){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+le.a.wmf),r=r.getAttribute(Hs.a.Led),h&&r&&0<h.length&&0<r.length))return b=new XG(Number.parseInvariant(h),r+" level"+h,b),b.uwc=!1,b}return null}static N2o(b,h,r,A){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===pn.WCi(h))return r=pn.pqm(h),Sys.UI.DomElement.addCssClass(b,r),r;var L=h.match(RegExp("^[0-9]+"));return L&&L.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,
r),b.setAttribute("start",L[0]),r):(L=h.match(RegExp("^[a-zA-Z]+")))&&L.length&&(L=L[0],A=(h=L.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?pn.qPm(r,A):1,1!==A&&((r=pn.l0d(b,L,RegExp("^[ivxlcdm]+"),D.a.Ubi,"NumberListStyle3"))||(r=pn.l0d(b,L,RegExp("^[IVXLCDM]+"),D.a.Ubi,"NumberListStyle5")))||A&&((r=pn.l0d(b,L,RegExp("^[a-z]+"),D.a.Sbi,"NumberListStyle2"))||(r=pn.l0d(b,L,RegExp("^[A-Z]+"),D.a.Sbi,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static pqm(b){switch(b){case "o":return"BulletListStyle2";
case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static qPm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static l0d(b,h,r,A,L){return(h=h.match(r))&&h.length?(A=A(h[0]),A=1>A?1:A,Sys.UI.DomElement.addCssClass(b,L),b.setAttribute("start",A+""),L):null}static WCi(b){return pn.Kmn(b)?
"UL":"OL"}static Kmn(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static BRf(b,h){let r=null;var A;let L,ba;for(let ra=-1;!r&&ra<b.childNodes.length;ra++){const Ia=-1===ra?b:b.childNodes[ra];if(Ia)if((A=Ia.innerHTML)&&0<A.length){if(L=A.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=L&&(ba=A.indexOf("\x3c!--[endif]--\x3e"),0<=ba)){A=A.substring(L,ba+14);Ia.innerHTML=Ia.innerHTML.replace(A,"");if(A.length){b=b.ownerDocument.createElement("span");
b.innerHTML=A;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=ra&&1===Ia.nodeType&&1<h&&(r=pn.BRf(Ia,h-1))}return r}static $zm(b){let h=null;1===b.nodeType&&((h=pn.GDi(b,"font-family"))||(h=pn.GDi(b,"mso-ascii-font-family")));return h}static GDi(b,h){return(b=pn.vRf(b,h))&&0<b.length?b.trim():null}static XCi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const L=b.childNodes[A];pn.k3i(L)?(r="string"===typeof L.innerText?L.innerText.trim():L.textContent.trim(),r.length||(r="o"),
L.parentNode.removeChild(L)):1===L.nodeType&&1<h&&(r=pn.XCi(L,h-1))}return r}static k3i(b){return 1===b.nodeType&&(b=pn.vRf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Tpn(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static vRf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const A=b[r].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static kOm(b){do b=
b.previousSibling;while(b&&pn.W1i(b));return b}static W1i(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(pn.NJk,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:pn.W1i(b.firstChild):!0}}pn.NJk=RegExp("[\n|\r]","gi");Object(u.a)(pn,"WacAndRichClientWordConverter",null,[205]);class Cy{constructor(){}create(b=null){return new pn(b)}}Object(u.a)(Cy,"Box4WordConverterFactory",null,[704]);var Ew=e(1880),Qt=e(50),IC=e(275),Zn=e(1266),iv=e(550),
op=e(313),JC=e(1322),KC=e(1095);class Rt{constructor(b,h,r,A,L,ba=null,ra="",Ia=!0,Ta=!1){this.fMa=this.oEe=this.iAb=this.tCj=this.mye=null;this.Dbd=!1;this.pNa=null;this.Fgg=0;this.$Fe=null;this.context=b;this.ke=b.view;this.nz=h;this.Ed=L;this.HW=r;this.bea=A;this.aQa=this.zC=!1;this.nse=null;this.xcb=this.grc=!1;this.nhp=Rt.Quf(b);this.browserName=ra;this.bfk=Ia;this.qdd=Ta;this.y3a=!1;this.Zhc=0;if(b=Object(Pb.a)(66,L)?L:null){this.tCj=new Ai.DictionaryPropertySet;this.tCj.Yu(b);r=b.ka(Pd.a.ikd,
V.a.nil);this.DYc=r!=V.a.nil?r.toString():V.a.create().toString();if(b.ka(Pd.a.eyj,!1)){this.grc=!0;this.xcb=b.ka(Pd.a.xcb,!1);this.nse=ba;for(ba=this.ke.ub.hh;ba.My;)ba=ba.getContext(0);if(L=Object(ya.a)(wm.AParagraphNode,ba.node)){r=0;A=rd.ParagraphReader.textLength(L);switch(ba.contextId){case ic.a.Nd:r=ba.cpBegin;A=ba.cpEnd;break;case ic.a.od:r=A}this.mye=pb.a.O9d(ba.node,r,ba.Ob);v.ULS.shipAssertTag(6305503,307,!!this.mye);L=Mc.a.vmc(L);for(const ob of L)ob.cpEnd<=r||ob.cpBegin>=A||Rt.Gs.YZ(ba.node,
ob.hyperlink)}}this.aQa=b.ka(Pd.a.aQa,!1);this.y3a=b.ka(Pd.a.y3a,!1);this.iAb=b.ka(Pd.a.iAb,null)}else this.DYc=V.a.create().toString();h&64&&(this.aQa=!0)}static get Gs(){return null!=Rt.$0g?Rt.$0g:Rt.$0g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static Quf(b){if(b){if(b.My){for(let h=0;h<b.length;h++)if(Rt.Quf(b.getContext(h)))return!0;return!1}if(Object(Pb.a)(iv.a,b))return Rt.Quf(b.Pk);if(rd.ParagraphReader.lc(b.node)&&b.node.QS)return!0}return!1}}Object(u.a)(Rt,"ClipboardActionArguments",
null,[]);var bB;(function(b){b[b.paste=1]="paste";b[b.Bxq=2]="textOnly";b[b.dwj=4]="overtype";b[b.fG=16]="copy";b[b.V4p=32]="deleteSelection";b[b.move=64]="move";b[b.Fzq=256]="useSystemClipboard";b[b.F9p=512]="forceInternalClipboard";b[b.m1a=4096]="reformatPastedContent";b[b.qpq=8192]="pasteAsPlainText";b[b.Rsd=65536]="showPlaceholderGlossary";b[b.erq=131072]="reformatPastedContentWithDesignerPaste";b[b.zmq=262144]="noSpacesAdjustment";b[b.Ufq=524288]="mergeAfterPasteForInsertHtmlAPI"})(bB||(bB={}));
Object(u.b)("ClipboardActionFlags",bB);var zn=e(385);class Qu extends op.a{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re,me,Sd,cf,sf,yh,si,cl,Pj,cn=!0){super();this.Sqa=this.mz=null;this.oO=this.jC=0;this.Knb=this.Y$e=this.Dfa=this.Rh=null;this.Raa=!1;this.iY=!0;this.Zph=!1;this.init(b);this.$m("ClipboardOperation");this.bvb(Ta,h,L,ba,ra);this.Jd=ob;this.gf=nb;this.jf=Eb;this.Zc=bc;this.Mgh=Bc;this.Ogh=Yc;this.Ngh=zd;this.uQe=Jd;this.D7b=ie;this.vQe=re;this.pHc=Ia;this.eHc=me;this.ZUa=
Sd;this.fYk=cn;this.VE=cf;this.me=sf;this.yo=yh;this.L3=si;this._context=A;this.Bla=cl;this.snb=Pj;this.$d=ej.a.getInstance(zn.a.f9a);ra&&Object(Pb.a)(66,ra)&&(this.Dfa=Object(ya.a)(684,ra.ka(Pd.a.KBa,null)));this.Dfa||(this.Dfa=this.Bla.Dtd());this.SDb=void 0===r||null===r?"NotAvailable":Object(JC.a)(bB,r);this.Dfa.vcl(this.SDb.split(", "));b=this._context;if(this.snb){if(!Qu.e4h(b,this.uQe,this.Jd,this.Dfa,cn)){this.Vt=8;this.finish();return}this.Rh=b.view;this.Raa=3===this.Rh.$Wb;this.jC=0;this.oO=
r;this.Knb=Jd.Q0a}else{if(!b.view.Ee){this.Jd.qc(pf.a.$e,{["Reason"]:uf.a.NYb});this.Dfa.fail("Not in interactive view",!0);this.Vt=8;this.finish();return}this.Rh=b.view;if(!this.Rh.ub){this.Jd.qc(pf.a.$e,{["Reason"]:uf.a.Mo});this.Dfa.fail("No selection manager",!0);this.Vt=8;this.finish();return}this.Raa=3===this.Rh.$Wb;this.jC=0;this.oO=r;this.Knb=Jd.Q0a;if(cn&&!(this.Knb&&this.Knb.currentSelection&&this.Knb.length)){this.Jd.qc(pf.a.$e,{["Reason"]:uf.a.Mo});this.Dfa.fail("No selection when one required",
!0);this.Vt=8;this.finish();return}}Jd=Ee.a.qn(this.Knb.currentSelection);Jd=!(this.oO&16&&Jd);Jd=re.inn(r,this.hh)&&Jd;1!==this.behavior&&Jd||(Jd||this.Dfa.fail("Clipboard operation disabled for selection",!0),this.Vt=Jd?32:8,this.Kxa());!this.Zph&&this.jf.Yi&&($d.b("IPadCCP"),this.Zph=!0)}get hh(){this.Y$e||(this.Y$e=Fg.a.zgc(this.Knb));return this.Y$e}Wia(){super.Wia();this.Knb=null}run(){this.jC||this.setup();1===this.jC&&this.process();2===this.jC&&this.Fqp();3===this.jC&&this.Cqp();4===this.jC&&
this.finish()}setup(){if(this.oO&256&&this.pHc){this.ZE||this.D7b.uwl(this,this.oO,this.SDb);this.ZE.run();if(this.ZE.Gha)return;this.iY=this.ZE.Cwa;this.fZd();if(!this.iY){this.Dfa.fail("No access to system clipboard",!0);this.Vt=8;this.jC=4;this.Gle();return}}else v.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.oO,this.SDb,this.jf.aG,this.actionId);this.oO&32&&!this.gf.ghe(this.Rh.ub.hh)?(v.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.Jd.qc(pf.a.$e,
{["Reason"]:uf.a.wyf}),this.Dfa.fail("Cut not allowed",!0),this.eHc.show(),this.Vt=8,this.jC=4):(this.oO&16||this.oO&32)&&this.VE.hje(this.Rh.ub.ob.currentSelection)?(this.Dfa.fail("Selected content deleted in coauthoring",!0),this.me.f3b(),this.Vt=8,this.jC=4):(this.oO&4096&&(this.L3.Exc(Object.assign(new KC.a,{mbd:!0,OZ:this.SDb})),this.yo.undo()),this.vQe.Hmo(this.oO),this.Rh.Fd?(this.mz=this.Zc.Vc(15),this.mz.Bh=this.actionId,this.mz.Eb(this.Rh.Fd),this.jC=1):(this.Dfa.fail("Interactive view has null target node",
!0),this.Vt=8,this.jC=4))}process(){if(!this.ZE){v.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.oO,this.SDb,this.jf.aG);v.ULS.shipAssertTag(6305507,307,!this.Sqa);this.Sqa=new Rt(this._context,this.oO,this.Dfa,this.bea,this.ZP,void 0,this.jf.aG,this.fYk,this.Raa);let b;this.oO&65536?b=Object(E.a)(this.Mgh,this.Mgh.process,"process"):this.oO&64?b=Object(E.a)(this.Ogh,this.Ogh.process,"process"):this.oO&1?(this.$d.logKpiUsage({kpiName:zn.a.DBa}),b=Object(E.a)(this.uQe,
this.uQe.process,"process")):b=Object(E.a)(this.Ngh,this.Ngh.process,"process");this.oO&16&&this.Rh.ub.nya.Uvi();this.ZUa.create(this,b,this.Sqa).$m("ClipboardAction")}v.ULS.shipAssertTag(6305536,307,!!this.ZE);this.ZE.run();this.ZE.Gha||(this.fZd(),this.jC=this.Ei?2:3)}Fqp(){this.Sqa.grc&&(this.mz.Bh=fb.a.W2);this.Sqa.Dbd&&this.mz.sOa(this.Sqa.pNa,this.Sqa.Fgg);this.mz.dispose();this.Vt=this.Sqa.zC?8:32;this.jC=4}Cqp(){if(this.ZE){if(this.ZE.run(),this.ZE.Gha)return}else if(this.Sqa.grc&&(this.mz.Bh=
fb.a.W2),this.mz.gQa(this),this.Sqa.Dbd&&this.mz.sOa(this.Sqa.pNa,this.Sqa.Fgg),this.mz.dispose(),this.ghf)return;this.Vt=this.Sqa.zC?8:32;this.jC=4}finish(){this.L3.Exc(Object.assign(new KC.a,{mbd:!1}));this.Kxa();32===this.response?(v.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.oO,this.SDb,this.jf.aG),this.oO&1&&this.$d.logKpiSuccess({kpiName:zn.a.DBa})):v.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",
+this.endTime-+this.startTime,this.oO,this.SDb,this.jf.aG);this.Bla.Uga(this.Dfa);Qu.Xwo&&this.HKn()}Gle(){const b=!!(this.oO&1),h=this._context.view;h&&zn.a.Gle(b,h.ub,this.jf.aG)}HKn(){if(!(this.oO&4||this.oO&64)){var b=new Map;b.set("isCopy",String.format("{0}",!!(this.oO&16)));b.set("isIPad",String.format("{0}",this.jf.Yi));b.set("SkipAria","false");b.set("ErrorLevel","info");this.$d.logKpiUsage({kpiName:zn.a.m5h,kpiType:0,optionalProperties:{extendedProperties:b},blockFutureEmissionDurationInMs:0});
this.iY||(b.set("SkipAria","false"),b.set("ErrorLevel","info"),this.$d.logKpiFailure({kpiName:zn.a.m5h,errorName:zn.a.mtl,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:b}},blockFutureEmissionDurationInMs:0}))}}static get Xwo(){null==Qu.P8e&&(Qu.P8e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("RecordCcpErrorDialogKpiIsEnabled"));return Qu.P8e}static Ntg(b,h,r,A){b&&b.qc(pf.a.$e,{["Reason"]:r});h&&h.fail(A,!0)}static e4h(b,h,r=null,A=null,L=!0){return b.view.Ee?
b.view.ub?!L||h.Q0a&&h.Q0a.currentSelection&&h.Q0a.length?!0:(Qu.Ntg(r,A,uf.a.Mo,"Paste target is invalid"),!1):(Qu.Ntg(r,A,uf.a.Mo,"No selection manager"),!1):(Qu.Ntg(r,A,uf.a.NYb,"Not in interactive view"),!1)}}Qu.P8e=null;Object(u.a)(Qu,"ClipboardOperation",op.a,[]);class Dy{constructor(b,h,r,A,L,ba,ra){this.mE=ra;this.M6e=null;this.oFh=0;this.Jd=A;this.jf=h;this.m3=L;this.YXe=r;this.pHc=y.AFrameworkApplication.qGg();this.iQe=b.appSettings.ChromeClipboardAccessOperationTimeout;this.DM=0;this.zwk=
ba;this.eBk=b.$("EnableExternalPasteSupportOnMobileIsEnabled");this.$d=ej.a.getInstance(zn.a.f9a)}get Q0a(){return this.m3.Q0a}process(b,h){if(!this.DM)return this.zho(h);if(1===this.DM)return this.t_b(b,h);if(2===this.DM)return this.DM=3,this.M6e(b,h);3===this.DM&&this.m3.WDg(b,h);return!1}zho(b){let h=!0;this.eBk&&(h=!(b.nz&1));this.jf.x9&&h||b.nz&512?(this.M6e=b.nz&2?Object(E.a)(this.m3,this.m3.paste,"paste"):Object(E.a)(this.m3,this.m3.Qxj,"pasteInternal"),this.DM=2):(this.pHc?(this.DM=1,this.oFh=
Date.now()):this.DM=2,this.M6e=Object(E.a)(this.m3,this.m3.paste,"paste"));zn.a.TMn(b);return!0}t_b(b,h){var r;b=!0;if(this.YXe.value.oAj())this.DM=2;else{const A=Date.now()-this.oFh;A>this.iQe&&(v.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",A),this.Jd.qc(pf.a.pua,{["Reason"]:uf.a.Cvj}),h.HW&&(h.HW.fail("Prepare for paste timed out",!1),null===(r=this.mE)||void 0===r?void 0:r.iQb(),this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"PreparePasteTimedOut",optionalVeto:{name:zn.a.ote,isIntentional:!1,
isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}})),h.zC=!0,b=!1,this.zwk.hOo())}return b}}Object(u.a)(Dy,"ClipboardOperationPasteProcessor",null,[678]);class PE extends op.a{constructor(b,h,r,A,L,ba){super();this.init(b);this.$m("DummyClipboardOperation");this.bvb(y.AFrameworkApplication.va,h,A,L,ba);this._context=r;this.Vt=8;this.Kxa()}run(){this.plb=!0;this.Xqd(this._context);this.efb();this.Vt=32}}Object(u.a)(PE,"DummyClipboardOperation",op.a,[]);var wx=e(1523);class LC extends wx.a{constructor(b,
h,r,A,L){super(b,h,L);this.Gk=r;this.Eaf=A}xDc(b){let h;if(this.rV&&!b)return v.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Vma:null};h=null;if(this.Eaf&&!this.rV){const r=this.properties.ka(Pd.a.Xxj,"");r&&(h=this.Gk.Peb(r))}h||(h=this.Gk.Peb(b));return{returnValue:!0,Vma:h}}}Object(u.a)(LC,"HtmlStringImportStrategy",wx.a,[]);var OJ=e(1881);class Xr extends OJ.a{constructor(b,h,r,A,L){super(b,h,r,A,L)}mJi(){return this.properties.ka(Pd.a.ywc,
"")}xDc(b){if(this.BKh){if(this.Gk)return b=this.Gk.qng(b,!0),{returnValue:!0,Vma:b};v.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.xDc(b)}Ged(b){b=super.Ged(b);return b.length&&" "!==b?b:"\u00a0"}}Object(u.a)(Xr,"MultiLinePlainTextImportStrategy",OJ.a,[]);class xx extends wx.a{constructor(b,h,r){super(b,h,r)}xDc(b){if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorPlainTextImportStrategy",!1))return this.qyp(b);let h;
if(this.rV&&!b)return v.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Vma:null};h=IC.a.s7c("Box4PasteScratchPad");h.innerText=b;return{returnValue:!0,Vma:h}}qyp(b){let h;if(this.rV&&!b)return v.ULS.sendTraceTag(508379359,307,10,"No htmlDomContent"),{returnValue:!1,Vma:null};h=Cr.Aho;h.innerText=b;return{returnValue:!0,Vma:h}}}Object(u.a)(xx,"PlainTextImportStrategy",wx.a,[]);class MC{constructor(b){this.isReady=this.A3f=!1;this.zla=b}oAj(){this.A3f||(this.A3f=!0,this.isReady=
!1,this.zla.t_b(()=>{this.isReady=!0}));return this.isReady}o9j(){this.A3f=!1;const b=this.zla.paste();return b?b.hasChildNodes()?{returnValue:!0,Y_d:b}:(v.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),MC.Jc.qc(pf.a.C6,{["Reason"]:uf.a.cFf}),{returnValue:!1,Y_d:b}):(v.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),MC.Jc.qc(pf.a.kRb,{["Reason"]:uf.a.sKg}),{returnValue:!1,Y_d:b})}static get Jc(){return $g.a.instance}}Object(u.a)(MC,"SystemClipboardImportStrategy",null,[728]);
class Cr{get R$i(){return this.OTa}set R$i(b){this.OTa=b}constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re,me=null){this.mE=re;this.L5d=me;this.HAd=null;this.OTa=0;this.LFd=this.iUc=!1;this.yEb=bg.a.On;this.Qsd=()=>{const Sd=Array(1);Sd.push("PasteRecoveryFloatie");var cf=this.MOk.kYa();cf=Object.assign(new Ew.a,{x:cf.x,y:cf.y});this.eQ.showFloatie(cf,Sd,1);return 32};this.sUb=()=>{this.eQ.k5&&this.eQ.dismissFloatie();return 32};this.hDj=(Sd,cf,sf,yh,si)=>{if(1===sf)return 32;si[Pf.a.On]=
!1;return 32};this.X3l=(Sd,cf,sf,yh,si,cl)=>{v.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Pj=cl.DataTransfer;cl=Pj.getData("text/html");Pj=Pj.getData("text/plain");let cn=!1;const Mu=new Ai.DictionaryPropertySet;0<cl.length?(v.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Mu.setValue(Pd.a.PZ,cl),cn=!0):0<Pj.length&&(v.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Mu.setValue(Pd.a.ywc,Pj),cn=!0);if(cn){const dv=
this.pB.K(cf);return this.zZd.create(Sd,cf,dv,new xe.a(()=>this.N0c(dv,Mu)),sf,yh,si,Mu)}return null};this.xsg=(Sd,cf,sf,yh,si)=>{if(cf="object"===typeof si?si:null)this.tnb?this.DZo(Sd,this.OTa,cf):Sd===fb.a.Kve?(Sd=this.OTa!==fb.a.m1a&&this.OTa!==fb.a.n1a&&this.OTa!==fb.a.EFa,cf[this.yEb]=this.OTa===fb.a.m1a||Sd):Sd===fb.a.Lve?cf[this.yEb]=this.OTa===fb.a.n1a:Sd===fb.a.tsg&&(cf[this.yEb]=this.OTa===fb.a.EFa);return 32};this.X0=(Sd,cf,sf,yh,si,cl)=>{if((y.AFrameworkApplication.AR||y.AFrameworkApplication.nE)&&
!y.AFrameworkApplication.XLa||bi.a.bda(sf)&&bi.a.Ovb())return new PE(Sd,cf,sf,yh,si,cl);let Pj=this.pB.K(cf);1!==yh&&Pj&1&&(this.OTa=cf);if(1!==yh){var cn=Object(Pb.a)(66,cl)?cl:null;cl?(Pj&1&&(this.HAd=cn),cn=cn?cn.ka(Pd.a.OZ,0):0,cf===fb.a.paste&&cn===fb.a.zKa?Pj=this.pB.K(fb.a.o8):cf===fb.a.S5&&cn===fb.a.Z8a&&(Pj=this.pB.K(fb.a.pte))):!cl&&Pj&4096&&(cl=this.HAd,cn=Object(Pb.a)(66,cl)?cl:null)&&(cn=cn.ka(Pd.a.ikd,V.a.nil),v.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",
cn))}return this.zZd.create(Sd,cf,Pj,new xe.a(()=>this.N0c(Pj,cl)),sf,yh,si,cl)};this.Goo=(Sd,cf,sf,yh,si)=>this.bqf(Sd,cf,sf,si);this.Eoo=(Sd,cf,sf,yh,si)=>this.bqf(Sd,cf,sf,si);this.Doo=(Sd,cf,sf,yh,si)=>this.bqf(Sd,cf,sf,si);this.Nne=(Sd,cf,sf,yh,si,cl)=>{cl=vc.a.jd(Fg.a.instance.ob.currentSelection.Ya.node,cl);return this.X0(Sd,cf,sf,yh,si,cl)};this.Dwk=b;this.zla=h;this.Jd=r;this.Gk=A;this.ga=ba;this.jBd=ob;this.D7b=nb;this.yf=Eb;this.Mg=bc;this.oc=Ta;this.snb=Bc;this.tnb=Yc;this.MOk=zd;this.eQ=
Jd;this.d0e=ie;this.$d=ej.a.getInstance(zn.a.f9a);Ia&&(this.iUc=Ia.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.LFd=this.tnb&&Ia.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.pB=new lb.a;this.pB.W(fb.a.paste,257);this.pB.W(fb.a.S5,8449);this.pB.W(fb.a.o8,1);this.pB.W(fb.a.Zbb,1);this.pB.W(fb.a.bNb,1);this.pB.W(fb.a.nKa,1);this.pB.W(fb.a.Tfe,513);this.pB.W(fb.a.m1a,4097);this.pB.W(fb.a.n1a,12289);this.pB.W(fb.a.EFa,131073);this.pB.W(fb.a.zng,7);this.pB.W(fb.a.Oxj,1);this.pB.W(fb.a.pte,
8193);this.pB.W(fb.a.fG,272);this.pB.W(fb.a.dXc,16);this.pB.W(fb.a.cut,304);this.pB.W(fb.a.Xof,48);this.pB.W(fb.a.Mne,64);this.pB.W(fb.a.Nne,64);this.pB.W(fb.a.Rsd,327680);this.pB.W(fb.a.XBf,1);this.LFd&&this.pB.W(fb.a.azb,this.pB.K(fb.a.pte))}get S2a(){return null!=this.Y9g?this.Y9g:this.Y9g=Xa.a.instance.Wa("Box4.Clipboard.ISystemClipboardAccessManager")}get qLg(){return null!=this.u$g?this.u$g:this.u$g=Xa.a.instance.Wa("Common.Utils.Telemetry.ITelemetry")}get zZd(){return this.Dwk.value}get Cop(){return this.zla}mc(){if(y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePasteQueryAtBoot",!1)){this.L5d.addCommandToMaps(new Qt.a(Zn.a.jkd,this.snb?fb.a.zKa.toString():fb.a.paste.toString()));let b;this.L5d.addCommandToMaps((b=new Qt.a(Zn.a.xng,this.tnb?fb.a.Z8a.toString():fb.a.S5.toString()),b.legacyControlId="fseaNewPaste",b));this.L5d.addCommandToMaps(new Qt.a(Zn.a.hkd,this.tnb?fb.a.Z8a.toString():fb.a.S5.toString()));let h;this.L5d.addCommandToMaps((h=new Qt.a("PasteStandalone",this.snb?
fb.a.zKa.toString():fb.a.paste.toString()),h.legacyControlId="fseaPaste",h))}this.ga.nb(fb.a.oso,ic.a.application,this.hDj,97);this.ga.nb(fb.a.pso,ic.a.application,this.hDj,97);this.ga.nb(fb.a.Kve,ic.a.application,this.xsg,97);this.ga.nb(fb.a.Lve,ic.a.application,this.xsg,97);this.ga.nb(fb.a.tsg,ic.a.application,this.xsg,97);this.ga.uY(fb.a.Xof,ic.a.view,this.X0,1028);this.ga.qob(fb.a.dXc,ic.a.view,this.X0);this.ga.uY(fb.a.XBf,ic.a.view,this.X3l,1028);this.ga.uY(fb.a.o8,ic.a.view,this.X0,1028);this.ga.uY(fb.a.Zbb,
ic.a.view,this.X0,1028);this.ga.uY(fb.a.bNb,ic.a.view,this.X0,1028);this.ga.uY(fb.a.nKa,ic.a.view,this.X0,1028);this.snb&&this.ga.nb(fb.a.zKa,ic.a.view,this.Doo,1028);this.tnb&&this.ga.nb(fb.a.Z8a,ic.a.view,this.Eoo,1028);this.ga.uY(fb.a.paste,ic.a.view,this.X0,1028);this.ga.uY(fb.a.S5,ic.a.view,this.X0,1028);this.ga.uY(fb.a.pte,ic.a.view,this.X0,1028);this.ga.uY(fb.a.Oxj,ic.a.view,this.X0,1028);this.ga.uY(fb.a.zng,ic.a.view,this.X0,1028);this.ga.uY(fb.a.m1a,ic.a.view,this.X0,1028);this.ga.uY(fb.a.n1a,
ic.a.view,this.X0,1028);this.ga.qa(fb.a.$0b,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.dyj,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.ayj,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.byj,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.cyj,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.$xj,ic.a.view,qf.ActionManager.qg);this.ga.qob(fb.a.Mne,ic.a.view,this.X0);this.ga.qob(fb.a.Nne,ic.a.view,this.Nne);this.ga.qob(fb.a.Tfe,ic.a.view,this.X0);this.ga.qob(fb.a.Rsd,ic.a.view,this.X0);this.LFd&&
(this.ga.nb(fb.a.AXc,ic.a.view,this.Goo,1028),this.ga.uY(fb.a.azb,ic.a.view,this.X0,1028));this.ga.qa(fb.a.Tgi,ic.a.view,qf.ActionManager.qg);this.ga.qa(fb.a.yhi,ic.a.view,qf.ActionManager.qg);this.d0e&&(this.ga.nb(fb.a.Qsd,ic.a.view,this.Qsd,96),this.ga.nb(fb.a.sUb,ic.a.view,this.sUb,96))}i$(){if(this.oc){const b=this.oc.te(Uk.a.LI);this.LFd&&b.bindAction(lc.KeyInputManager.xc(pg.a.NDb,lc.KeyInputManager.Ji|4),fb.a.AXc)}else v.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}DZo(b,
h,r){switch(h){case fb.a.n1a:case fb.a.S5:case fb.a.azb:h=fb.a.Lve;break;case fb.a.EFa:h=fb.a.tsg;break;default:h=fb.a.Kve}r[this.yEb]=b===h}MLm(){const b=Object(Pb.a)(66,this.HAd)?this.HAd:null;return b?b.ka(Pd.a.ikd,V.a.nil):V.a.nil}bqf(b,h,r,A){if(1===r){if(!Object(Pb.a)(iv.a,h))return this.Ble("No valid view context",b),8;if(!this.jBd)return this.Ble("No paste factory",b),8;if(bi.a.bda(h)&&bi.a.Ovb())return this.Ble("Paragraph has iframe with no focus inside",b),8;r=new xe.a(()=>this.N0c(this.pB.K(fb.a.o8),
A));const L=this.jBd.create(r,Object(ya.a)(66,A));r=new Dy(y.AFrameworkApplication.J,dh.a.instance,r,$g.a.instance,L,this.D7b,this.mE);if(Qu.e4h(h,r))return 32;this.Ble("ClipboardOperation does not allow creating paste operation",b);return 8}if(2===r){if(this.m$o(Ze.a.d8a))return this.zKa(b);Ze.a.Oxc(()=>{this.zKa(b)});return 32}return 2}Ble(b,h){v.ULS.sendTraceTag(508040481,307,15,"Paste is not enabled. {0}. command: {1}",b,h)}zKa(b){var h;if(!this.yf)return v.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),
8;var r=this.yf.ntb();if(!r)return v.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;r=r.Op;if(!r)return v.ULS.sendTraceTag(592454659,307,10,"No document"),8;v.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",b);this.$d.logKpiUsage({kpiName:zn.a.DBa});this.Mg.g6l(b);b=ed.a.dRb(r,"paste");r=this.Mg.w_l();v.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",r);if(b)return v.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.$d.logKpiSuccess({kpiName:zn.a.DBa}),
32;this.U0m();v.ULS.sendTraceTag(592454662,307,10,"execCommand failed");null===(h=this.mE)||void 0===h?void 0:h.iQb();this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"ExecCommandFailed"});return 8}U0m(){this.S2a&&(this.S2a.g3b(),zn.a.Gle(!0,Fg.a.instance,X.a.aG));if(this.qLg){const b=this.qLg.Dtd();b.Gfc("CallExecCommandPasteOperation");b.fail("call to execCommand('paste') failed",!0);this.qLg.Uga(b)}}m$o(b){let h=!1;this.oc?this.oc.currentScope?h=!this.oc.W0f(this.oc.currentScope.name):v.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):v.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(h){v.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.oc.currentScope.name);if(1>b)return v.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.oc.DHf();return!1}return!0}N0c(b,h){return b&256?new MC(this.Cop):b&2?b&4096?new LC(h,this.Jd,this.Gk,Ze.a.instance.zbd,Ze.a.instance.t2a):new xx(h,this.Jd,Ze.a.instance.t2a):h.hasProperty(Pd.a.ywc)?new Xr(h,this.Jd,this.Gk,this.iUc,Ze.a.instance.t2a):
new LC(h,this.Jd,this.Gk,Ze.a.instance.zbd,Ze.a.instance.t2a)}static get Aho(){return IC.a.s7c("Box4PasteScratchPad")}d4h(b,h,r,A){return!y.AFrameworkApplication.AR&&!y.AFrameworkApplication.nE||y.AFrameworkApplication.XLa?(b=this.X0(null,b?fb.a.cut:fb.a.fG,h,1,r,A))?b.response:8:8}}Object(u.a)(Cr,"ClipboardActor",null,[]);class Hz{constructor(b,h,r,A,L){this.cmh=0;this.FNp=ba=>{let ra=!0;const Ia=this.zla.j8l;null!=Ia?(ba.Cwa=Ia,ra=!1):Date.now()-this.cmh>this.iQe&&(v.ULS.sendTraceTag(18354843,307,
50,null),this.Jd.qc(pf.a.pua,{["Reason"]:uf.a.Cvj}),ra=ba.Cwa=!1);return ra};this.Jd=b;this.jf=h;this.iQe=L;this.zla=r;this.ZUa=A}uwl(b,h,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.jf.aG);b.Ei&&this.jf.zt&&window.chrome&&v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.zla.z2c(!!(h&16));this.ZUa.create(b,this.FNp,null).$m("ClipboardPreProcess");this.cmh=Date.now()}hOo(){this.zla.reset()}}
Object(u.a)(Hz,"ClipboardOperationClipboardAccessHelper",null,[672]);class cH{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd){this.J5a=null;this.ga=b;this.Jd=h;this.rD=r;this.ni=A;this.pb=L;this.zla=ba;this.qb=ra;this.gf=Ia;this.Hp=Ta;this.td=ob;this.lmb=nb;this.b9e=Eb;this.rI=bc;this.Gk=Yc;this.d$b=Bc?Bc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.nId=Bc?Bc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Qd=zd;this.$d=ej.a.getInstance(zn.a.f9a)}get Yf(){return this.ni}get Jc(){return this.Jd}get Tad(){if(null==
this.J5a)if(this.Qd)if(this.Qd.Fs.isCompleted)this.J5a=this.Qd.isFeatureEnabled(2);else return!1;else this.J5a=!1;return this.J5a}yNp(b){b.SK();return!0}yci(b,h){b=h.nz;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let A=!1,L;this.Tad&&h.ke&&h.ke.hj&&(A=this.Gk.TSh(h.ke.hj.editingElement));L=this.Gk.hVf(h.ke.hj.editingElement,!1);var r=h.ke.hj.editingElement;this.Gk.n_f(r,!1,1);this.d$b&&X.a.Kva?(r=h.ke.hj.editingElement,this.Gk.nxg(r,"data-src","data-srcurl"),b=this.zla.fG(),this.Gk.nxg(r,
"data-srcurl","data-src")):this.nId&&h.ke&&h.ke.hj?(r=this.Gk.$qf(h.ke.hj.editingElement,h.ke.xC,!0),b=this.zla.fG(),r&&this.Gk.$qf(h.ke.hj.editingElement,h.ke.xC,!1)):(this.Gk.qJj(h.ke.hj.editingElement),b=this.zla.fG());this.Tad&&A&&this.Gk.UHo(h.ke.hj.editingElement);L&&this.Gk.hVf(h.ke.hj.editingElement,!0);r=h.ke.hj.editingElement;this.Gk.n_f(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.$d.logKpiFailure({kpiName:zn.a.sYd,
errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Jc.qc(pf.a.kRb,{["Reason"]:uf.a.sKg}),h.HW&&h.HW.fail("SystemClipboard did not copy",!1),h.zC=!0,!1}return!0}ovf(b,h){const r=h.ke;v.ULS.shipAssertTag(18130961,307,!!(h.nz&16));h.nhp?this.rD.R7h():this.rD.B0d(r,b);return!0}nji(b,h){var r=h.context,A=h.Ed;const L=h.bea;var ba=!1;b=this.pb.ob.currentSelection.hd;if(this.qb.Xn(b)||this.gf.em(b)){const ra=this.td.Ag(b.node),Ia=ra.Wd();v.ULS.shipAssertTag(18130962,
307,Ia);this.Hp.xe(ra);this.lmb.Xvb(ra)&&(ba=!0)}A=h.nz&64?new Ai.DictionaryPropertySet:A||new Ai.DictionaryPropertySet;A.setValue(Pd.a.s1c,!1);this.$d.logKpiUsage({kpiName:zn.a.tYd});r=this.ga.Sf(r,fb.a.WJ,2,!0,L,A);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Jc.qc(pf.a.pua,{["Reason"]:uf.a.mji}),h.HW&&h.HW.fail("DeleteKey failed",!1),this.$d.logKpiFailure({kpiName:zn.a.tYd,errorName:"DeleteForCutFailed"}),h.zC=!0);32===r&&this.$d.logKpiSuccess({kpiName:zn.a.tYd});32===r&&
ba&&(h=this.pb.ob.currentSelection,this.gf.qn(h)&&h.Ya.node===b.node&&!this.qb.textLength(h.Ya.node)&&(h=this.td.Ag(h.Ya.node),b=this.gf.uw(h),v.ULS.shipAssertTag(18130964,307,b),this.Hp.xe(h),this.lmb.uhe(h)||(b=this.b9e.create(),b.Ad(h),this.Hp.D5(b,!1,!1),ba=this.Hp.Ze(b),this.qb.lc(ba)&&(this.Hp.xe(b),this.Yf.merge(b,h,!1,!1),this.pb.Uc(this.rI.Ie(ba,this.qb.textLength(ba)))))));return!0}}Object(u.a)(cH,"ClipboardOperationCutCopy",null,[680]);class PJ{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,
bc,Bc,Yc,zd){this.ga=b;this.Jd=h;this.rD=r;this.zla=ba;this.pb=L;this.ni=A;this.qb=ra;this.gf=Ia;this.Hp=Ta;this.td=ob;this.lmb=nb;this.b9e=Eb;this.rI=bc;this.za=Bc;this.Gk=Yc;this.Qd=zd}create(){return new cH(this.ga,this.Jd,this.rD,this.ni,this.pb,this.zla,this.qb,this.gf,this.Hp,this.td,this.lmb,this.b9e,this.rI,this.za,this.Gk,this.Qd)}}Object(u.a)(PJ,"Factory",null,[671]);var hq=e(312);class QJ{constructor(b,h){this.XHc=null;this.tIl=(r,A)=>{let L;if(hq.a.gia){if(!A.Ed)return!1;L=A.Ed.Z7c;if(!L)return!1}else{if(!Object(Pb.a)(66,
A.Ed))return!1;const Ia=Object(ya.a)(66,A.Ed);if(!Ia.hasProperty(Pd.a.Z7c))return!1;L=Ia.getValue(Pd.a.Z7c)}const ba=A.ke,ra=ba.ub;this.rD.efk();ra.y1b(()=>{ra.Uc(L,void 0,!0);this.rD.B0d(ba,r)},!0);return!0};this.rD=b;this.m3=h;this.DM=0}process(b,h){this.DM||(this.XHc=[this.tIl,Object(E.a)(this.m3,this.m3.who,"pasteGlossaryPlaceholder")],hq.a.gia&&this.XHc.push(Object(E.a)(this.m3,this.m3.WDg,"setSelectionAfterPaste")));let r=!0;this.DM<this.XHc.length&&(r=this.XHc[this.DM++](b,h));return r?this.DM<
this.XHc.length:!1}}Object(u.a)(QJ,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[683]);class Ey{constructor(b){this.rFb=null;this.Y6=b;this.DM=-1}process(b,h){-1===this.DM&&(this.tTl(b,h),this.DM=0);let r=!1;this.DM<this.rFb.length&&(r=this.rFb[this.DM++](b,h));return r?this.DM<this.rFb.length:!1}tTl(b,h){X.a.x9||h.nz&512?(this.rFb=[Object(E.a)(this.Y6,this.Y6.ovf,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!b.Ei&&h.nz&256?(this.rFb=[Object(E.a)(this.Y6,this.Y6.yNp,"waitBeforeCopy"),Object(E.a)(this.Y6,this.Y6.yci,"copyExternal"),Object(E.a)(this.Y6,this.Y6.ovf,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.rFb=[Object(E.a)(this.Y6,this.Y6.yci,"copyExternal"),Object(E.a)(this.Y6,this.Y6.ovf,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
h.nz&32&&(b=Object(E.a)(this.Y6,this.Y6.nji,"deleteForCut"),this.rFb.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));zn.a.GKn(h)}}Object(u.a)(Ey,"ClipboardOperationCutCopyProcessor",null,[682]);class dH{constructor(b,h,r,A){this.GKd=null;this.wIl=(L,ba)=>{ba=ba.ke;this.rD.iKp();this.rD.B0d(ba,L);return!0};this.Ogd=(L,ba)=>{ba=new Fl.Selection([ba.Ed],!0);this.pb.Uc(ba,L);return!0};this.rD=b;this.pb=h;this.Y6=r;this.m3=A;this.DM=
0}process(b,h){this.DM||(this.GKd=[this.wIl,Object(E.a)(this.Y6,this.Y6.nji,"deleteForCut"),this.Ogd,Object(E.a)(this.m3,this.m3.Qxj,"pasteInternal"),Object(E.a)(this.m3,this.m3.WDg,"setSelectionAfterPaste")]);let r=!0;this.DM<this.GKd.length&&(r=this.GKd[this.DM++](b,h));return r?this.DM<this.GKd.length:!1}}Object(u.a)(dH,"ClipboardOperationMoveProcessor",null,[681]);class RJ{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re){this.mE=re;this.rD=b;this.ga=h;this.pHc=r;this.Jd=A;this.gf=
L;this.jf=ba;this.Zc=ra;this.jBd=Ia;this.Cwk=Ta;this.D7b=ob;this.vQe=nb;this.eHc=Eb;this.ZUa=bc;this.VE=Bc;this.me=Yc;this.yo=zd;this.L3=Jd;this.Bla=ie}create(b,h,r,A,L,ba,ra,Ia,Ta=!0){const ob=this.jBd.create(A,Object(ya.a)(66,Ia));var nb=this.Cwk.create();const Eb=new QJ(this.rD,ob),bc=new dH(this.rD,Fg.a.instance,nb,ob);nb=new Ey(nb);A=new Dy(y.AFrameworkApplication.J,dh.a.instance,A,$g.a.instance,ob,this.D7b,this.mE);return new Qu(b,h,r,L,ba,ra,Ia,this.pHc,this.ga,this.Jd,this.gf,this.jf,this.Zc,
Eb,bc,nb,A,this.D7b,this.vQe,this.eHc,this.ZUa,this.VE,this.me,this.yo,this.L3,this.Bla,y.AFrameworkApplication.uGg(),Ta)}}Object(u.a)(RJ,"Factory",null,[670]);class Fw{constructor(b,h){this.UTb=b.rNf(h);this.zvf=b.Gum(h);this.rOb=b.TKf(h);this.epb=b.qKf(h)}static OI(b){return Fw.tu(b)}static tu(b){return new Fw(Aw.a.instance,b)}}Object(u.a)(Fw,"CpUsageHelper",null,[]);class Fy{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){this.mE=bc;this.Jd=b;this.rD=h;this.gQc=r;this.TAa=A;this.pb=L;this.ga=ba;
this.YXe=ra;this.Jef=Ta;this.P6e=Ia;this.ITe=ob;this.tQe=nb;this.me=Eb;this.$d=ej.a.getInstance(zn.a.f9a)}get Dh(){return this.Jef.value}get wya(){return this.TAa}get Jc(){return this.Jd}get Q0a(){return this.P6e.Q0a}paste(b,h){let r=!1;return sl.a.hwb?(mp.a.instance.Ae(()=>{r=this.Mxj(b,h)},"COP:P"),r):this.Mxj(b,h)}Mxj(b,h){var r,A;const L=this.me.I8a();try{const ba=h.ke,ra=h.nz;this.pb&&this.pb.ob&&this.pb.ob.currentSelection&&Qp.TableBorderSelectionCache.J7o(this.pb.ob.currentSelection.Oy||this.pb.ob.currentSelection.cdb);
Vr.a.z5o(this.pb);v.ULS.shipAssertTag(18131010,307,!!(ra&1));Object(Pb.a)(66,h.Ed)&&h.Ed.setValue(Kh.a.Wma,ba.hj.editingElement.clientWidth);this.tQe.Lyp(b,h);let Ia;if(!({Y_d:Ia}=this.YXe.value.o9j()).returnValue)return this.nfd(h,"HTML import strategy failed",!1),null===(r=this.mE)||void 0===r?void 0:r.iQb(),this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:zn.a.ote,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;this.Dh.eK();
let Ta=!0,ob=null;const nb=this.ITe.create(Ia),Eb=h.bfk;if(!ba||!ba.ub)return this.nfd(h,"Fail to set selection.",!1),null===(A=this.mE)||void 0===A?void 0:A.iQb(),this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"SetSelectionFailed",optionalVeto:{name:zn.a.ote,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;ba.ub.y1b(()=>{Eb&&2===this.ga.Vb(fb.a.Rta,2)?Ta=!1:(ob=Eb?this.pb&&this.pb.ob&&this.pb.ob.currentSelection?this.pb.ob.currentSelection.Ya:null:h.Ed)?(v.ULS.shipAssertTag(18158338,
307,Ee.a.Df(ob)),this.ffj(ob,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Eb)},this.P6e.N5i);if(!Ta)return this.nfd(h,"fail to deleteForReplace.",!0),!1;if(!ob)return this.nfd(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!ob.node||!ob.node.isConnected)return this.nfd(h,"node is null or not connected in ip context.",!0),!1;ba.Ve.disable(!0,25);nb.restore();this.gQc.rho(Ia,ob,b);return!0}finally{L&&L.dispose()}}nfd(b,h,r){b.zC=!0;b.HW&&
b.HW.fail(h,r)}who(b,h){var r,A;let L;if(hq.a.gia){L=h.Ed;var ba=L.pce}else ba=Object(ya.a)(66,h.Ed).getValue(Pd.a.pce);v.ULS.shipAssertTag(20492440,307,Ee.a.Df(ba));if(!this.O6h(ba,h))return!1;this.Dh.eK();const ra=(new gm.a).Vc(15);ra.Eb(this.rD.kqa);const Ia=hq.a.gia?this.pb.ob.currentSelection:null;this.gQc.$Yi(ba,b);hq.a.gia&&(b=null!==(A=null===(r=L.placeholderText)||void 0===r?void 0:r.length)&&void 0!==A?A:0,r=h.fMa,ba=Ia&&Ee.a.Df(Ia.Ya)&&r&&Ee.a.Df(r.Ya)&&Ia.Ya.node===r.Ya.node&&Ia.Ya.cpBegin>
ba.cpBegin?Tb.SelectionFactory.Ie(Ia.Ya.node,Ia.Ya.cpBegin+b):Ia,h.fMa=ba);this.rD.R7h();ra.dispose();return!0}Qxj(b,h){const r=this.pb.ob.currentSelection.Ya;if(!this.O6h(r,h))return!1;this.Dh.eK();this.ga.Vb(fb.a.Rta,2);this.ffj(r,"intPaste");this.gQc.$Yi(r,b);return!0}O6h(b,h){var r,A;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.qdd),
h.HW&&(h.HW.fail("Invalid ipContext before InternalPasteAtIp",!0),h.zC=!0),h=new Map,h.set("ErrorLevel","warning"),null===(r=this.mE)||void 0===r?void 0:r.iQb(),this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Ee.a.Df(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.qdd,
b.contextId,!!b.node,!!b.node&&!!b.node.anchor),r=new Map,r.set("ErrorLevel","warning"),null===(A=this.mE)||void 0===A?void 0:A.iQb(),this.$d.logKpiFailure({kpiName:zn.a.DBa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:r}}}),h.HW&&(h.HW.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.zC=!0),!1}return!0}ffj(b,h){h=Fw.OI(h);this.wya.mxo(h,b.node,b.cpBegin);this.wya.IKn(h.zvf);this.wya.U9f(h.UTb);this.wya.G9f(h.rOb);
this.wya.E9f(h.epb)}WDg(b,h){if(!h.bfk)return!1;h.nz&64&&this.rD.dfk();if(!h.fMa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.pva}),h.HW&&h.HW.fail("No selection after paste",!1),h.zC=!0,!1;this.P6e.jJp(h);this.Dh.eK();return!1}}Object(u.a)(Fy,"ClipboardOperationPaste",null,[679]);class Nq{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb){this.mE=Eb;this.Jd=b;this.rD=h;this.gQc=r;this.TAa=A;this.pb=L;this.ga=ba;this.Jef=Ia;this.POk=ra;this.ITe=
Ta;this.tQe=ob;this.me=nb}create(b,h){h=this.POk.create(this.pb,h);return new Fy(this.Jd,this.rD,this.gQc,this.TAa,this.pb,this.ga,b,h,this.Jef,this.ITe,this.tQe,this.me,this.mE)}}Object(u.a)(Nq,"Factory",null,[669]);class Gw{constructor(b,h){this.Fmp=b;this.qgo=h}}Object(u.a)(Gw,"ParagraphFormatStore",null,[]);class eH{constructor(b,h,r){this.pb=b;this.qb=h;this.Ge=r}Lyp(b,h){if(h.grc){h=b.Cwa;var r=this.pb.ob.currentSelection.Ya.node,A=null;this.qb.lc(r)&&(A=this.Ge.Lr(r),r=this.qb.ebb(r),A=new Gw(A,
r));h=new Rt(h.context,h.nz,h.HW,h.bea,h.Ed,A);b.Cwa=h}}}Object(u.a)(eH,"ClipboardOperationPasteOvertypeStrategy",null,[668]);class NC{constructor(b){this.P2e=null;this.pb=b;b.y1b(h=>{this.P2e=h},!1)}get N5i(){return!1}jJp(b){b=this.pkf(b);this.Uc(this.pb,b)}pkf(b){let h=b.fMa;(b.y3a||b.aQa)&&b.oEe&&(h=Tb.SelectionFactory.SA(b.oEe,h.Ya));return h}Uc(b,h){b.Uc(h)}}Object(u.a)(NC,"AClipboardOperationPasteStrategy",null,[703]);class st extends NC{constructor(b){super(b)}get Q0a(){return this.P2e}}Object(u.a)(st,
"ClipboardOperationPasteToLiveSelectionStrategy",NC,[]);class Is extends NC{constructor(b,h){super(b);this.Qff=null;this.YKk=h;b.y1b(r=>{this.Qff=r},!0)}get N5i(){return!0}get Q0a(){return this.Qff}pkf(b){let h=super.pkf(b);b.Ed.setValue(Pd.a.Vxj,h);return h=this.YKk.mHi(this.P2e.currentSelection,this.Qff.currentSelection,h)}}Object(u.a)(Is,"ClipboardOperationPasteToVirtualSelectionStrategy",NC,[]);class yx{constructor(b){this.Pff=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&
h.ka(Pd.a.y3a,!1)&&this.Pff?new Is(b,this.XMp):new st(b)}get XMp(){return null!=this.fbh?this.fbh:this.fbh=Xa.a.instance.Wa("Box4.Actors.IVirtualSelectionMerger")}}Object(u.a)(yx,"ClipboardOperationPasteStrategyFactory",null,[667]);class Hw{constructor(b,h,r,A){this.Jc=b;this.ub=h;this.Un=r;this.Ig=A}Hmo(b){(b&1||b&32)&&this.Un.pn&&this.ub.wMb()}inn(b,h){return b&1&&this.Ig.t4(h,!0)?(this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),!1):!0}}Object(u.a)(Hw,"ClipboardOperationWordStrategy",null,[]);class Rj{constructor(){}eci(b,
h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var A=h=0,L=0,ba=0;for(const Ia of r){r=Ia.style;var ra=Ia.selectorText;r=r?r.cssText:null;ra=ra?ra.split(","):null;if(r&&ra&&Ia.type===Ia.STYLE_RULE){ba+=ra.length;for(const Ta of ra){0<=Ta.indexOf("#")&&h++;0<=Ta.indexOf(".")&&A++;0>Ta.indexOf("#")&&0>Ta.indexOf(".")&&L++;ra=null;try{ra=b.querySelectorAll(Ta)}catch(ob){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",
Ta,ob.message)}if(ra)for(let ob=0;ob<ra.length;ob++)ra[ob].setAttribute("style",r+(ra[ob].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ba,h,A,L)}else this.Ffj();else this.Ffj()}Ffj(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",X.a.aG)}}Object(u.a)(Rj,"ExternalPasteCssConverter",null,
[666]);class cB{constructor(b){this.OWa=0;this.s8h=null;this.node=b}}Object(u.a)(cB,"ChartConverterArguments",null,[]);class fH{constructor(b=null){this._imgNodesConverted=0;this.V7=b||Mq.a.Uzi("")}get Wc(){return this.V7}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new rt.a(h,this.yam.bind(this),new cB(b[0])),b.$m("Chart Converter Operation"),b.Ei=!h||h.Ei,b.run())))}yam(b,h){var r=h.node;if(1<h.OWa)return!1;if(1===r.nodeType&&"DIV"===
r.tagName){const A=r.getAttribute(Ki.c2d);if(A){const L=r.getAttribute(Ki.Fyf),ba=r.getAttribute(Ki.Gyf),ra=r.getAttribute(Ki.Dyf),Ia=r.getAttribute(Ki.Eyf),Ta=r.getAttribute(Ki.g0c);r=r.getAttribute(Ki.Hyf);L&&Ia&&ba&&"chart"===ba&&Ta&&"XLO"===Ta&&(h.s8h=new $G.a(A,L,ba,ra,Ia,Ta,r))}}b.fj(this.oVn.bind(this));return!0}oVn(b,h){var r=h.node;if(b=h.s8h)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Ki.c2d,b.ccpId),r.setAttribute(Ki.Fyf,
b.pKey),r.setAttribute(Ki.Gyf,b.type),r.setAttribute(Ki.Eyf,b.dc),r.setAttribute(Ki.g0c,b.client),b.version&&r.setAttribute(Ki.Hyf,b.version),b.count&&r.setAttribute(Ki.Dyf,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.V7._imgNodesConverted=this._imgNodesConverted;h.OWa++;return!1}}Object(u.a)(fH,"ChartConverter",null,[]);class qn{constructor(b,h=null,r=null){this.Tf=b;this.V7=h||Mq.a.LLi("");this.NVk=r||Mq.a.MLi("")}get Wc(){return this.V7}get ZKg(){return this.NVk}Jda(b){this.ZKg.b++;
this.Tf.Jda(b)}Hda(){this.Tf.Hda()}W9(b){this.ZKg.c++;this.Tf.W9(b)}Ida(){this.Tf.Ida()}Gda(b){this.ZKg.d++;this.Tf.Gda(b)}Fda(){this.Tf.Fda()}reset(){this.Tf.reset()}get v0c(){return this.Tf.v0c}Dia(b,h){this.Wc.b++;this.Tf.Dia(b,h)}Dda(b){this.Wc.c++;this.Tf.Dda(b)}Iyb(b){this.Wc.b++;this.Tf.Iyb(b)}WEa(b){this.Wc.d++;this.Tf.WEa(b)}TOa(b){this.Wc.f++;this.Tf.TOa(b)}f0a(b,h){this.Wc.g++;this.Tf.f0a(b,h)}e0a(){this.Tf.e0a()}JH(b){this.Wc.h++;this.Tf.JH(b)}gJ(){this.Tf.gJ()}Eyb(){this.Tf.Eyb()}Dyb(){this.Tf.Dyb()}l0a(b,
h){this.Wc.i++;this.Tf.l0a(b,h)}teb(){this.Tf.teb()}ZEa(b){this.Wc.j++;this.Tf.ZEa(b)}ywa(){this.Tf.ywa()}XOa(b){this.Wc.k++;this.Tf.XOa(b)}YEa(){this.Tf.YEa()}zeb(b){this.Wc.l++;this.Tf.zeb(b)}}Object(u.a)(qn,"SemanticEventUsageCollector",null,[203,204]);class xo{constructor(b=null){this.hn=b}$Al(b,h){var r;if(this.hn&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const A of h){h=A.replace(/[0-9]+/,"");this.hn.KEe.has(b)||this.hn.KEe.set(b,new Map);const L=this.hn.KEe.get(b);null===L||void 0===L?void 0:L.set(h,
(null!==(r=L.get(h))&&void 0!==r?r:0)+1)}}ij(b){const h=b.Vf;if(h&&this.hn&&("font"===h.tagName.toLowerCase()&&this.fho(b),b=h.style)){0===b.length&&this.hn.i$c(h.tagName,"no style present");for(let r=0;r<b.length;r++){const A=b[r];A&&0<A.length&&(this.hn.i$c(h.tagName,A),this.$Al(A,b.getPropertyValue(A)))}}}fho(b){if((b=b.Vf)&&"font"===b.tagName.toLowerCase()&&this.hn){var h=b.getAttribute("face");h&&0<h.length&&this.hn.i$c(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.hn.i$c(b.tagName,
"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.hn.i$c(b.tagName,"font-attr-size")}}}Object(u.a)(xo,"HtmlEventUsageCollectorHelper",null,[]);class QE{constructor(b,h,r=null,A=null){this.gj=h;this.jxk="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.Tf=b;this.V7=r||Mq.a.EEi(X.a.ONb,"");this.hy=A;this.kxk=new bk.a(Ea.a.Oh());for(const L of this.jxk)this.kxk.add(L)}get Wc(){return this.V7}get hn(){return this.hy}si(b){return b?
b+1:1}reset(){this.Tf.reset()}ppe(){this.Tf.ppe()}MUf(b){if(b&&this.hn&&(b.getAttribute&&(b.getAttribute(Ki.JTl)&&(this.hn.swi=!0),b.getAttribute(Ki.c2d)&&(this.hn.Ijm=!0),b.getAttribute(Ki.g0c)&&(this.hn.qsf=b.getAttribute(Ki.g0c)),b.getAttribute(Ki.MTl)&&(this.hn.twi=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Ki.zZm)&&(this.hn.uwi=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Ki.Abo)&&(this.hn.ywi=!0);h.startsWith(Ki.Llo)&&(this.hn.zwi=!0);h.startsWith(Ki.xPp)&&
(this.hn.Awi=!0);if(h.startsWith(X.a.Wof)&&h.length===X.a.Wof.length+1){const r=parseInt(D.a.substring(h,h.length-1,h.length));isNaN(r)||(this.hn.VZc=r)}if(h===Ki.MWn||h===Ki.NWn)this.hn.j4c=!0}return this.Tf.MUf(b)}onClose(){this.Tf.onClose()}evn(b){for(const h of b)if("\n"!==h)return!0;return!1}Dia(b,h){this.hn&&(this.hn.Kjm=!0);this.hn&&!this.hn.CIf&&b&&(this.hn.CIf=this.evn(b));this.Wc.d=this.si(this.Wc.d);this.Tf.Dia(b,h)}gpe(b){this.hn&&(this.hn.wwi=!0);this.Wc.e=this.si(this.Wc.e);this.gj.ij(b);
return this.Tf.gpe(b)}$gg(b){this.Wc.f=this.si(this.Wc.f);this.gj.ij(b);return this.Tf.$gg(b)}ahg(b){this.Wc.g=this.si(this.Wc.g);this.gj.ij(b);return this.Tf.ahg(b)}ehg(b){this.Wc.h=this.si(this.Wc.h);this.gj.ij(b);return this.Tf.ehg(b)}rhg(b){this.Wc.i=this.si(this.Wc.i);this.gj.ij(b);return this.Tf.rhg(b)}thg(b){this.Wc.j=this.si(this.Wc.j);this.gj.ij(b);this.Tf.thg(b)}ope(b){this.Wc.k=this.si(this.Wc.k);this.gj.ij(b);return this.Tf.ope(b)}uhg(b){this.Wc.l=this.si(this.Wc.l);this.gj.ij(b);this.Tf.uhg(b)}vhg(b){this.Wc.m=
this.si(this.Wc.m);this.gj.ij(b);this.Tf.vhg(b)}whg(b){this.Wc.n=this.si(this.Wc.n);this.gj.ij(b);return this.Tf.whg(b)}rpe(b){this.Wc.o=this.si(this.Wc.o);this.gj.ij(b);return this.Tf.rpe(b)}spe(b){this.Wc.p=this.si(this.Wc.p);this.gj.ij(b);return this.Tf.spe(b)}Lhg(b){this.Wc.q=this.si(this.Wc.q);this.gj.ij(b);return this.Tf.Lhg(b)}tpe(b){this.Wc.r=this.si(this.Wc.r);this.gj.ij(b);this.Tf.tpe(b)}Nhg(b){this.Wc.s=this.si(this.Wc.s);this.gj.ij(b);return this.Tf.Nhg(b)}vpe(b){this.Wc.t=this.si(this.Wc.t);
this.gj.ij(b);return this.Tf.vpe(b)}wpe(b){this.Wc.u=this.si(this.Wc.u);this.gj.ij(b);return this.Tf.wpe(b)}zpe(b){this.Wc.v=this.si(this.Wc.v);this.gj.ij(b);return this.Tf.zpe(b)}Ape(b){this.Wc.w=this.si(this.Wc.w);this.gj.ij(b);return this.Tf.Ape(b)}Zhg(b){this.Wc.x=this.si(this.Wc.x);this.gj.ij(b);this.Tf.Zhg(b)}$hg(b){this.Wc.y=this.si(this.Wc.y);this.gj.ij(b);return this.Tf.$hg(b)}Jpe(b){this.Wc.z=this.si(this.Wc.z);this.gj.ij(b);return this.Tf.Jpe(b)}Kpe(b){this.Wc.ba=this.si(this.Wc.ba);this.gj.ij(b);
return this.Tf.Kpe(b)}Npe(b){this.Wc.bb=this.si(this.Wc.bb);this.gj.ij(b);return this.Tf.Npe(b)}Ope(b){this.Wc.bc=this.si(this.Wc.bc);this.gj.ij(b);return this.Tf.Ope(b)}Qpe(b){this.Wc.bd=this.si(this.Wc.bd);this.gj.ij(b);return this.Tf.Qpe(b)}Rpe(b){this.Wc.be=this.si(this.Wc.be);this.gj.ij(b);return this.Tf.Rpe(b)}Spe(b){this.Wc.bf=this.si(this.Wc.bf);this.gj.ij(b);return this.Tf.Spe(b)}Upe(b){this.Wc.bg=this.si(this.Wc.bg);this.gj.ij(b);return this.Tf.Upe(b)}Gig(b){this.Wc.bh=this.si(this.Wc.bh);
this.gj.ij(b);return this.Tf.Gig(b)}cqe(b){this.Wc.bi=this.si(this.Wc.bi);this.gj.ij(b);return this.Tf.cqe(b)}Nig(b){this.Wc.bj=this.si(this.Wc.bj);this.gj.ij(b);return this.Tf.Nig(b)}Qig(b){this.Wc.bk=this.si(this.Wc.bk);this.gj.ij(b);this.Tf.Qig(b)}Rig(b){this.Wc.bl=this.si(this.Wc.bl);this.gj.ij(b);return this.Tf.Rig(b)}fqe(b){this.Wc.bm=this.si(this.Wc.bm);this.gj.ij(b);return this.Tf.fqe(b)}gqe(b){this.Wc.bm=this.si(this.Wc.bm);this.gj.ij(b);return this.Tf.gqe(b)}hqe(b){this.Wc.bm=this.si(this.Wc.bm);
this.gj.ij(b);return this.Tf.hqe(b)}iqe(b){this.Wc.bm=this.si(this.Wc.bm);this.gj.ij(b);return this.Tf.iqe(b)}jqe(b){this.Wc.bm=this.si(this.Wc.bm);this.gj.ij(b);return this.Tf.jqe(b)}kqe(b){this.Wc.bm=this.si(this.Wc.bm);this.gj.ij(b);return this.Tf.kqe(b)}Yig(b){this.Wc.bn=this.si(this.Wc.bn);return this.Tf.Yig(b)}lqe(b){this.Wc.bo=this.si(this.Wc.bo);this.gj.ij(b);this.Tf.lqe(b)}bjg(b){this.Wc.bp=this.si(this.Wc.bp);return this.Tf.bjg(b)}mqe(b){this.Wc.bq=this.si(this.Wc.bq);this.gj.ij(b);return this.Tf.mqe(b)}djg(b){this.Wc.br=
this.si(this.Wc.br);this.gj.ij(b);return this.Tf.djg(b)}qqe(b){this.hn&&(this.hn.vwi=!0);this.gj.ij(b);this.Wc.bs=this.si(this.Wc.bs);this.Tf.qqe(b)}ijg(b){this.Wc.bt=this.si(this.Wc.bt);this.gj.ij(b);this.Tf.ijg(b)}rqe(b){this.Wc.bu=this.si(this.Wc.bu);this.gj.ij(b);return this.Tf.rqe(b)}njg(b){this.Wc.bv=this.si(this.Wc.bv);this.gj.ij(b);return this.Tf.njg(b)}uqe(b){this.Wc.bw=this.si(this.Wc.bw);this.gj.ij(b);return this.Tf.uqe(b)}xqe(b){this.Wc.bx=this.si(this.Wc.bx);this.gj.ij(b);return this.Tf.xqe(b)}Aqe(b){this.Wc.by=
this.si(this.Wc.by);this.gj.ij(b);return this.Tf.Aqe(b)}Bqe(b){this.hn&&(this.hn.j4c=!0);this.Wc.bz=this.si(this.Wc.bz);this.gj.ij(b);return this.Tf.Bqe(b)}yjg(b){this.Wc.ca=this.si(this.Wc.ca);this.gj.ij(b);this.Tf.yjg(b)}Cjg(b){this.Wc.cb=this.si(this.Wc.cb);this.gj.ij(b);return this.Tf.Cjg(b)}Dqe(b){this.hn&&(this.hn.Jjm=!0);this.Wc.cc=this.si(this.Wc.cc);this.gj.ij(b);return this.Tf.Dqe(b)}onMenuOpen(b){this.Wc.cd=this.si(this.Wc.cd);this.gj.ij(b);return this.Tf.onMenuOpen(b)}Ijg(b){this.Wc.ce=
this.si(this.Wc.ce);this.Tf.Ijg(b)}Qjg(b){this.Wc.cf=this.si(this.Wc.cf);this.gj.ij(b);return this.Tf.Qjg(b)}Rjg(b){this.Wc.cg=this.si(this.Wc.cg);this.gj.ij(b);return this.Tf.Rjg(b)}Tjg(b){this.Wc.ch=this.si(this.Wc.ch);this.gj.ij(b);return this.Tf.Tjg(b)}Mqe(b){this.hn&&(this.hn.j4c=!0);this.Wc.ci=this.si(this.Wc.ci);this.gj.ij(b);return this.Tf.Mqe(b)}Vjg(b){this.Wc.cj=this.si(this.Wc.cj);this.gj.ij(b);return this.Tf.Vjg(b)}Oqe(b){this.Wc.ck=this.si(this.Wc.ck);this.gj.ij(b);return this.Tf.Oqe(b)}Sqe(b){this.Wc.cl=
this.si(this.Wc.cl);this.gj.ij(b);return this.Tf.Sqe(b)}akg(b){this.Wc.cm=this.si(this.Wc.cm);this.gj.ij(b);this.Tf.akg(b)}$qe(b){this.Wc.cn=this.si(this.Wc.cn);this.gj.ij(b);return this.Tf.$qe(b)}mkg(b){this.Wc.co=this.si(this.Wc.co);this.gj.ij(b);return this.Tf.mkg(b)}ire(b){this.Wc.cp=this.si(this.Wc.cp);this.gj.ij(b);return this.Tf.ire(b)}jre(b){this.Wc.cq=this.si(this.Wc.cq);this.gj.ij(b);return this.Tf.jre(b)}Ckg(b){this.Wc.cr=this.si(this.Wc.cr);return this.Tf.Ckg(b)}Ikg(b){this.Wc.cs=this.si(this.Wc.cs);
this.gj.ij(b);return this.Tf.Ikg(b)}ure(b){this.Wc.ct=this.si(this.Wc.ct);this.gj.ij(b);return this.Tf.ure(b)}vre(b){this.Wc.cu=this.si(this.Wc.cu);this.gj.ij(b);return this.Tf.vre(b)}xre(b){this.Wc.cv=this.si(this.Wc.cv);this.gj.ij(b);return this.Tf.xre(b)}yre(b){this.Wc.cw=this.si(this.Wc.cw);this.gj.ij(b);return this.Tf.yre(b)}Mkg(b){this.Wc.cx=this.si(this.Wc.cx);return this.Tf.Mkg(b)}zre(b){this.Wc.cy=this.si(this.Wc.cy);this.gj.ij(b);return this.Tf.zre(b)}Bre(b){this.Wc.cz=this.si(this.Wc.cz);
this.gj.ij(b);return this.Tf.Bre(b)}Dre(b){this.hn&&(this.hn.UCa=!0);this.Wc.da=this.si(this.Wc.da);this.gj.ij(b);return this.Tf.Dre(b)}Skg(b){this.hn&&(this.hn.UCa=!0);this.Wc.db=this.si(this.Wc.db);this.gj.ij(b);return this.Tf.Skg(b)}cjd(b){this.hn&&(this.hn.UCa=!0);this.Wc.dc=this.si(this.Wc.dc);this.gj.ij(b);return this.Tf.cjd(b)}Wkg(b){this.Wc.dd=this.si(this.Wc.dd);this.gj.ij(b);return this.Tf.Wkg(b)}Xkg(b){this.Wc.de=this.si(this.Wc.de);this.gj.ij(b);return this.Tf.Xkg(b)}Gre(b){this.hn&&(this.hn.UCa=
!0);this.Wc.df=this.si(this.Wc.df);this.gj.ij(b);return this.Tf.Gre(b)}Ykg(b){this.hn&&(this.hn.UCa=!0);this.Wc.dg=this.si(this.Wc.dg);this.gj.ij(b);return this.Tf.Ykg(b)}blg(b){this.Wc.dh=this.si(this.Wc.dh);this.gj.ij(b);return this.Tf.blg(b)}Lre(b){this.hn&&(this.hn.UCa=!0);this.Wc.di=this.si(this.Wc.di);this.gj.ij(b);return this.Tf.Lre(b)}Mre(b){this.Wc.dj=this.si(this.Wc.dj);this.gj.ij(b);return this.Tf.Mre(b)}Nre(b){this.Wc.dk=this.si(this.Wc.dk);this.gj.ij(b);return this.Tf.Nre(b)}Ore(b){this.hn&&
(this.hn.j4c=!0);this.Wc.dl=this.si(this.Wc.dl);this.gj.ij(b);return this.Tf.Ore(b)}Ure(b){this.Wc.dm=this.si(this.Wc.dm);this.gj.ij(b);return this.Tf.Ure(b)}Rre(b){this.Wc.dn=this.si(this.Wc.dn);this.gj.ij(b);return this.Tf.Rre(b)}}Object(u.a)(QE,"HtmlEventUsageCollector",null,[264]);class Iz{constructor(b,h,r=!1){this.Vf=b;this.nF=h;this.Scl=r}}Object(u.a)(Iz,"TagEventParam",null,[]);class tt{constructor(b,h=null){this.sDd=this._prunedElements=this.xef=this._voidElements=null;this.Ld=b;this.V7=
h||Mq.a.FEi("");this.$6o()}get Wc(){return this.V7}w_n(b,h,r){this.xef[h]?this.nnj():(this.Wc.e++,(h=this.sDd[h])&&h(new Iz(b,r,!1)),this.Wc.b++)}nnj(){this.Wc.d++}p_n(){this.Wc.c++}a_n(b,h,r){if(this.xef[h])this.nnj();else{if(h=this.sDd[h])return this.Wc.b++,h(new Iz(b,r,!1));this.Wc.f++;return this.Ld.Rre(new Iz(b,null))}return 2}$6o(){this._voidElements=sb.a.M$("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.xef=sb.a.M$("ABBR",
!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=sb.a.M$("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.Ld,h=this.Ld,r=this.Ld,A=this.Ld,L=this.Ld,ba=this.Ld,ra=this.Ld,Ia=this.Ld,Ta=this.Ld,
ob=this.Ld,nb=this.Ld,Eb=this.Ld,bc=this.Ld,Bc=this.Ld,Yc=this.Ld,zd=this.Ld,Jd=this.Ld,ie=this.Ld,re=this.Ld,me=this.Ld;this.sDd=sb.a.M$("A",Object(E.a)(this.Ld,this.Ld.gpe,"onAOpen"),"ABBR",Object(E.a)(this.Ld,this.Ld.$gg,"onAbbrOpen"),"ACRONYM",Object(E.a)(this.Ld,this.Ld.ahg,"onAcronymOpen"),"ADDRESS",Object(E.a)(this.Ld,this.Ld.ehg,"onAddressOpen"),"APPLET",Object(E.a)(this.Ld,this.Ld.rhg,"onAppletOpen"),"AREA",Object(E.a)(this.Ld,this.Ld.thg,"onAreaTag"),"B",Object(E.a)(this.Ld,this.Ld.ope,
"onBOpen"),"BASE",Object(E.a)(this.Ld,this.Ld.uhg,"onBaseTag"),"BASEFONT",Object(E.a)(this.Ld,this.Ld.vhg,"onBasefontTag"),"BDO",Object(E.a)(this.Ld,this.Ld.whg,"onBdoOpen"),"BIG",Object(E.a)(this.Ld,this.Ld.rpe,"onBigOpen"),"BLOCKQUOTE",Object(E.a)(this.Ld,this.Ld.spe,"onBlockquoteOpen"),"BODY",Object(E.a)(this.Ld,this.Ld.Lhg,"onBodyOpen"),"BR",Object(E.a)(this.Ld,this.Ld.tpe,"onBrTag"),"BUTTON",Object(E.a)(this.Ld,this.Ld.Nhg,"onButtonOpen"),"CAPTION",Object(E.a)(this.Ld,this.Ld.vpe,"onCaptionOpen"),
"CENTER",Object(E.a)(this.Ld,this.Ld.wpe,"onCenterOpen"),"CITE",Object(E.a)(this.Ld,this.Ld.zpe,"onCiteOpen"),"CODE",Object(E.a)(this.Ld,this.Ld.Ape,"onCodeOpen"),"COL",Object(E.a)(this.Ld,this.Ld.Zhg,"onColTag"),"COLGROUP",Object(E.a)(this.Ld,this.Ld.$hg,"onColgroupOpen"),"DD",Object(E.a)(this.Ld,this.Ld.Jpe,"onDdOpen"),"DEL",Object(E.a)(this.Ld,this.Ld.Kpe,"onDelOpen"),"DFN",Object(E.a)(this.Ld,this.Ld.Npe,"onDfnOpen"),"DIR",Object(E.a)(this.Ld,this.Ld.Ope,"onDirOpen"),"DIV",Object(E.a)(this.Ld,
this.Ld.Qpe,"onDivOpen"),"DL",Object(E.a)(this.Ld,this.Ld.Rpe,"onDlOpen"),"DT",Object(E.a)(this.Ld,this.Ld.Spe,"onDtOpen"),"EM",Object(E.a)(this.Ld,this.Ld.Upe,"onEmOpen"),"FIELDSET",Object(E.a)(this.Ld,this.Ld.Gig,"onFieldsetOpen"),"FONT",Object(E.a)(this.Ld,this.Ld.cqe,"onFontOpen"),"FORM",Object(E.a)(this.Ld,this.Ld.Nig,"onFormOpen"),"FRAME",Object(E.a)(this.Ld,this.Ld.Qig,"onFrameTag"),"FRAMESET",Object(E.a)(this.Ld,this.Ld.Rig,"onFramesetOpen"),"H1",Object(E.a)(this.Ld,this.Ld.fqe,"onH1Open"),
"H2",Object(E.a)(this.Ld,this.Ld.gqe,"onH2Open"),"H3",Object(E.a)(this.Ld,this.Ld.hqe,"onH3Open"),"H4",Object(E.a)(this.Ld,this.Ld.iqe,"onH4Open"),"H5",Object(E.a)(this.Ld,this.Ld.jqe,"onH5Open"),"H6",Object(E.a)(this.Ld,this.Ld.kqe,"onH6Open"),"HEAD",Object(E.a)(this.Ld,this.Ld.Yig,"onHeadOpen"),"HR",Object(E.a)(this.Ld,this.Ld.lqe,"onHrTag"),"HTML",Object(E.a)(this.Ld,this.Ld.bjg,"onHtmlOpen"),"I",Object(E.a)(this.Ld,this.Ld.mqe,"onIOpen"),"IFRAME",Object(E.a)(this.Ld,this.Ld.djg,"onIframeOpen"),
"IMG",Object(E.a)(this.Ld,this.Ld.qqe,"onImgTag"),"INPUT",Object(E.a)(this.Ld,this.Ld.ijg,"onInputTag"),"INS",Object(E.a)(this.Ld,this.Ld.rqe,"onInsOpen"),"ISINDEX",Object(E.a)(this.Ld,this.Ld.njg,"onIsindexOpen"),"KBD",Object(E.a)(this.Ld,this.Ld.uqe,"onKbdOpen"),"LABEL",Object(E.a)(this.Ld,this.Ld.xqe,"onLabelOpen"),"LEGEND",Object(E.a)(this.Ld,this.Ld.Aqe,"onLegendOpen"),"LI",Object(E.a)(this.Ld,this.Ld.Bqe,"onLiOpen"),"LINK",Object(E.a)(this.Ld,this.Ld.yjg,"onLinkTag"),"MAP",Object(E.a)(this.Ld,
this.Ld.Cjg,"onMapOpen"),"MATH",Object(E.a)(this.Ld,this.Ld.Dqe,"onMathOpen"),"MENU",Object(E.a)(this.Ld,this.Ld.onMenuOpen,"onMenuOpen"),"META",Object(E.a)(this.Ld,this.Ld.Ijg,"onMetaTag"),"NOFRAMES",Object(E.a)(this.Ld,this.Ld.Qjg,"onNoframesOpen"),"NOSCRIPT",Object(E.a)(this.Ld,this.Ld.Rjg,"onNoscriptOpen"),"OBJECT",Object(E.a)(this.Ld,this.Ld.Tjg,"onObjectOpen"),"OL",Object(E.a)(this.Ld,this.Ld.Mqe,"onOlOpen"),"OPTGROUP",Object(E.a)(this.Ld,this.Ld.Vjg,"onOptgroupOpen"),"OPTION",Object(E.a)(this.Ld,
this.Ld.Oqe,"onOptionOpen"),"P",Object(E.a)(this.Ld,this.Ld.Sqe,"onPOpen"),"PARAM",Object(E.a)(this.Ld,this.Ld.akg,"onParamTag"),"PRE",Object(E.a)(this.Ld,this.Ld.$qe,"onPreOpen"),"Q",Object(E.a)(this.Ld,this.Ld.mkg,"onQOpen"),"S",Object(E.a)(this.Ld,this.Ld.ire,"onSOpen"),"SAMP",Object(E.a)(this.Ld,this.Ld.jre,"onSampOpen"),"SCRIPT",Object(E.a)(this.Ld,this.Ld.Ckg,"onScriptOpen"),"SELECT",Object(E.a)(this.Ld,this.Ld.Ikg,"onSelectOpen"),"SMALL",Object(E.a)(b,b.ure,"onSmallOpen"),"SPAN",Object(E.a)(h,
h.vre,"onSpanOpen"),"STRIKE",Object(E.a)(r,r.xre,"onStrikeOpen"),"STRONG",Object(E.a)(A,A.yre,"onStrongOpen"),"STYLE",Object(E.a)(L,L.Mkg,"onStyleOpen"),"SUB",Object(E.a)(ba,ba.zre,"onSubOpen"),"SUP",Object(E.a)(ra,ra.Bre,"onSupOpen"),"TABLE",Object(E.a)(Ia,Ia.Dre,"onTableOpen"),"TBODY",Object(E.a)(Ta,Ta.Skg,"onTbodyOpen"),"TD",Object(E.a)(ob,ob.cjd,"onTdOpen"),"TEXTAREA",Object(E.a)(nb,nb.Wkg,"onTextareaOpen"),"TFOOT",Object(E.a)(Eb,Eb.Xkg,"onTfootOpen"),"TH",Object(E.a)(bc,bc.Gre,"onThOpen"),"THEAD",
Object(E.a)(Bc,Bc.Ykg,"onTheadOpen"),"TITLE",Object(E.a)(Yc,Yc.blg,"onTitleOpen"),"TR",Object(E.a)(zd,zd.Lre,"onTrOpen"),"TT",Object(E.a)(Jd,Jd.Mre,"onTtOpen"),"U",Object(E.a)(ie,ie.Nre,"onUOpen"),"UL",Object(E.a)(re,re.Ore,"onUlOpen"),"VAR",Object(E.a)(me,me.Ure,"onVarOpen"))}}Object(u.a)(tt,"AHtmlProcessor",null,[]);class zx{constructor(b,h){this.childNodes=b.childNodes;this.nF=h;this.Txf=0;this.dhe=!1}}Object(u.a)(zx,"HtmlProcessorArguments",null,[]);class cw extends tt{constructor(b,h,r=null){super(b,
r);this.mE=h;this.V_e=null}get qwn(){null==this.V_e&&(this.V_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.V_e}process(b,h=null){b&&(this.Ld.reset(),this.vBj(new zx(b,new Dw.a),h))}vBj(b,h){b.childNodes.length&&(b=new rt.a(h,Object(E.a)(this,this.Joo,"processChild"),b),b.$m("HTML Processing Operation"),h||(b.Ei=!0),b.run())}Joo(b,h){var r;const A=h.childNodes[h.Txf];if(3===A.nodeType)return this.Ld.ppe(),this.Ld.Dia(A.nodeValue,
new Iz(A,h.nF.oBi())),cw.ADc(h);if(1!==A.nodeType)return cw.ADc(h);if(!h.dhe){const ba=D.a.BE(A.tagName);if(!cw.L3m(A))if(this._prunedElements[ba])this.p_n();else{cw.IQn(A);null===(r=this.mE)||void 0===r?void 0:r.kbn();this.Ld.ppe();var L=A.id;const ra=A.tagName;r=h.nF.oBi();const Ia=A.getAttribute?A.getAttribute("class"):null;L=new Xs(L,ra,Ia?Ia:"",A.attributes?A.attributes.length:0);L.isValid&&r.add(L);if(this._voidElements[ba])return this.w_n(A,ba,r),cw.ADc(h);L=!1;switch(this.a_n(A,ba,r)){case 1:L=
!0;break;case 3:return cw.ADc(h)}switch(this.Ld.MUf(A)){case 1:L=!0}h.dhe=L;this.vBj(new zx(A,r),b);if(!b.Ei)return!0}}if(h.dhe){if(this.qwn&&!this.sDd[D.a.BE(A.tagName)])return cw.ADc(h);this.Ld.onClose()}return cw.ADc(h)}static IQn(b){3!==b.nodeType&&bm.a.un(b,"alreadyPasted",!0)}static L3m(b){return 3!==b.nodeType&&bm.a.Mb(b,"alreadyPasted")}static ADc(b){b.Txf++;b.dhe=!1;return b.Txf<b.childNodes.length}}Object(u.a)(cw,"HtmlProcessor",tt,[]);var SJ=e(561);const TJ={["font-size"]:0,["box-sizing"]:1,
["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,
["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,
["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,
["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,
["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,
["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,
["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,
["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,
["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,
["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,
["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,
["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,
["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,
["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,
["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,
["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,
["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,
["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},OC={["a"]:1,["b"]:2,["big"]:3,
["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,
["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,
["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,
["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class Ax{constructor(){this.nz=0;this.VZc=6;this.Ijm=this.swi=!1;this.qsf=null;this.Awi=this.zwi=this.ywi=this.uwi=this.twi=!1;this.progId=null;this.CIf=this.wwi=this.vwi=this.UCa=this.j4c=this.Jjm=this.Kjm=!1;this.Yxj=this.twc=0;this.Avj=this.platform=null;this.K_i=this.Xrc=!1;this.KEe=new Map;this.DUk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,
["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.mBf=[1,3,4,2,5];this.SGb={}}get RHg(){if(null!==this.qsf)switch(this.qsf){case "XLO":return"Excel Online"}if(this.Awi)return"Word Online";if(this.zwi||this.twi)return"PowerPoint Online";if(this.swi)return"Excel Online";if(this.uwi)return"Google Docs";if(this.ywi)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}PV(b,
h){const r=new ma.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}Eqd(b,h,r){const A=new SJ.a;A.name=b;A.dataFields=h;A.dnmInterval=r;A.dnmAllowedPartA=this.mBf;ka.a.sendDirectNumericEvent(A)}MNn(){for(const [b,h]of this.KEe)for(const [r,A]of h){const L=[this.PV("style",b),this.PV("unit",r),this.PV("frequency",A)];Object($d.a)("StylesAndUnitsFrequency",!0,0,L)}}KLn(){const b=this.bnl(),h=[],r=[this.PV("isUserConsumer",this.Xrc),this.PV("isDocumentBlank",
this.K_i),this.PV("FoundText",this.CIf),this.PV("FoundTable",this.UCa),this.PV("FoundImage",this.vwi),this.PV("FoundList",this.j4c),this.PV("FoundLink",this.wwi),this.PV("Browser",this.twc),this.PV("SourceApp",this.DUk[this.RHg])];for(const A of r)h.push(A);this.Eqd("Office.DNM.Word.Online.ExternalPasteEvent2",h,2);v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}WKl(b,h){var r,A;const L=[];b=this.PV("tag",null!==(r=OC[b])&&void 0!==r?r:OC.OTHERS);h=this.PV("style",null!==(A=TJ[h])&&void 0!==
A?A:TJ.OTHERS);A=this.PV("IsUserConsumer",this.Xrc);L.push(b);L.push(h);L.push(A);this.Eqd("Office.DNM.Word.Online.ExternalPasteEvent1",L,2)}XKl(b){var h;const r=[];b=this.PV("tag",null!==(h=OC[b])&&void 0!==h?h:OC.OTHERS);h=this.PV("IsUserConsumer",this.Xrc);r.push(b);r.push(h);this.Eqd("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}LLn(){const b=this.SGb;for(const A in b){var h=A,r=b[A];this.XKl(h);for(const L of Object.keys(r))this.WKl(h,L)}}i$c(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),
h=h.toLowerCase(),b in this.SGb||(this.SGb[b]={}),this.SGb[b][h]=this.DSm(b,h)+1)}DSm(b,h){if(!(b&&b.length&&h&&h.length&&this.SGb&&b in this.SGb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.SGb[b])&&h in b?b[h]:0}bnl(){const b={};b.ActionIdFlags=this.nz;b.SourceApp=this.RHg;b.CopySourceBrowser=this.VZc;b.PasteBrowser=this.twc;b.IsSameBrowserPaste=this.pyn(this.VZc,this.twc);b.IsCrossBrowserPaste=this.ton(this.VZc,this.twc);b.IsUncategorizedBrowserPaste=this.dBn(this.VZc,this.twc);
b.Platform=this.platform;b.OperationId=this.Avj;return b}pyn(b,h){return 5===b||6===b?!1:b===h}ton(b,h){return 6===b?!1:b!==h}dBn(b,h){return 5===b&&5===h}}Object(u.a)(Ax,"HtmlContentMetadata",null,[]);var jv=e(264),gH=e(1072),Yr=e(356),qh=e(48),ap=e(88),dB;(function(b){b[b.olk=0]="EmptyPara";b[b.jpk=1]="StartingOfPara";b[b.Dnk=2]="MiddleOfPara";b[b.qlk=3]="EndOfPara"})(dB||(dB={}));Object(u.b)("PasteContext",dB);class Fo{constructor(b,h,r,A,L,ba,ra){this.Kkc=ra;this.I0e=!1;this.o7j=this.c_e=null;
this.uho=Ia=>{let Ta=!1;return sl.a.hwb?(mp.a.instance.Ae(()=>{Ta=this.Kxj(Ia)},"APEM:PE"),Ta):this.Kxj(Ia)};this.Kxj=Ia=>{Yb.a.mark(5568);this.kri(Ia);let Ta=this.aTn;if(this.B4i){const ob=this.jZj();ob&&(Ta=this.$yb);v.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",ob)}Ia.fj(Ta);return!0};this.aTn=Ia=>{Yb.a.mark(5569);var Ta=new te.a;this.afb.restore(Ta);var ob=new te.a;this.LHf.restore(ob);this.LHf=null;v.ULS.shipAssertTag(6305489,307,Mb.a.ji(Ta));v.ULS.shipAssertTag(6305490,
307,Mb.a.ji(ob));hg.a.Ze(Ta);const nb=rd.ParagraphReader.Wh(Ta)?rd.ParagraphReader.textLength(Ta.currentNode):0;hg.a.xe(Ta);hg.a.Ze(ob);v.ULS.shipAssertTag(6305491,307,rd.ParagraphReader.Wh(ob));const Eb=rd.ParagraphReader.textLength(ob.currentNode);hg.a.xe(ob);var bc=y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8111697_MergeParagraphsAfterCCPlaceholderPaste")&&this.S2i();let Bc=this.tsd||bc;var Yc=new Oi.a;Yc.Ad(Ta);hg.a.Fu(Yc,!1,!1);var zd=Yc.currentNode===
ob.currentNode,Jd=!!this.sj&&!!(this.sj.nz&8192);let ie=!1;!Jd&&this.sj.Ed&&Object(Pb.a)(Ai.DictionaryPropertySet,this.sj.Ed)&&(Jd=(bc=this.sj.Ed.Uf(Pd.a.ywc))&&""!==bc?!0:!1);bc=!1;this.sj.Ed instanceof jv.a&&(bc=this.sj.Ed.ka(Pd.a.$ha,!1));if(zd){Yc=te.a.kb(Ta.currentNode);rd.ParagraphReader.Xv(hg.a.Ze(Yc))||(Ta=ob);Ta.currentNode.id!==ob.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",nf.a.Wg(Ta),nf.a.Wg(ob)),
Jd=Fo.Yf.merge(Ta,ob,!0,Jd),v.ULS.shipAssertTag(6305492,307,Jd));ob=Ta;var re=!0}else{zd=!!(this.sj.nz&4);re=this.Yd.Zg&&zd&&this.sj.xcb;var me=!!(this.sj.nz&262144);this.Hng&&this.sj&&!zd&&!me&&(this.Hng.ORi(Ta,!1),this.Hng.ORi(ob,!0));hg.a.Ze(Yc);zd=rd.ParagraphReader.Wh(Yc)?rd.ParagraphReader.textLength(Yc.currentNode):0;hg.a.xe(Yc);this.S2i()||this.nfl(Yc,Ta,ob);me=new Oi.a;me.Ad(Yc);hg.a.Fu(me,!1,!1);me.currentNode.id===ob.currentNode.id&&(this.I0e=!0);if(this.V0.fWa||this.F$o)if(me.Jr.id!==
ob.Jr.id){for(;Yc.currentNode.id!==ob.currentNode.id;)hg.a.Ze(Yc,!1),this.V0.hQa(vc.a.create(Yc.currentNode)),Yc.Ac(),hg.a.Fu(Yc,!1,!1);Yc.Ad(Ta);hg.a.Fu(Yc,!1,!1)}else ie=!0;this.hfa&&({tsd:Bc,RCa:Yc}=this.hfa.Lqg(Ta,ob,Bc,Yc));ap.a.kN&&this.Kkc&&(Yc=this.Kkc.Lqg(Ta,ob,Yc));if(this.sj.mye&&(v.ULS.shipAssertTag(6305493,307,this.sj.grc),me=new te.a,me.Ad(Yc),me=hg.a.Ze(me))){var Sd=this.sj.mye.og(me.ra.jc(0));me.ra.jc(0).formatting=Sd}me=0;Jd&&this.Q6e&&(me=1);Sd=this.iap(Ta,Yc,me);this.sj.oEe=null;
if(this.sj.aQa||this.sj.y3a)this.sj.oEe=this.kSm(Sd?Ta.currentNode:Yc.currentNode,Sd);var cf=!1;Sd&&(cf=nf.a.Wg(Ta),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",cf,nf.a.Wg(ob)),this.c_e=cf=Fo.Yf.merge(Ta,Yc,!0,Jd,ob,void 0,ie,re,this.Q6e),this.jap(Ta,me)&&this.yTn(Ta,ob,me,Jd));me=Fo.Iho.Cen(Ta,Yc,ob,nb,cf,this.KVb);var sf=!1;if(Bc){const yh=new Oi.a;yh.Ad(ob);hg.a.D5(yh,!1,!1);sf=nf.a.Wg(yh);const si=nf.a.Wg(ob),cl=bc;v.ULS.sendTraceTag(509661707,
307,50,"preserve EOP formatting : {0}",cl);const Pj=!!(this.sj.nz&524288);re=Fo.Yf.merge(yh,ob,!0,Jd,void 0,!0,void 0,re,this.Q6e,cl,!Pj,!Pj);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",sf,si,re?"True":"False, will cause IP to reset to zero.");ob=(sf=re)?yh:ob}else re=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.V0.fWa&&ie&&(Sd&&!this.Tqn(me,cf)?(Yc=new te.a,
Yc.Ad(Ta),Ta=hg.a.Ze(Yc),this.V0.Exa(Ta,nb,nb+zd)):Bc&&!this.Ctn(me,sf)?(Ta=new te.a,Ta.Ad(Yc),Ta=hg.a.Ze(Ta),this.V0.Exa(Ta,0,zd)):(Ta=new te.a,Ta.Ad(Yc),Ta=hg.a.Ze(Ta),this.V0.hQa(vc.a.create(Ta))));this.Blo(me);Jd||this.fF.Gpo(me)}v.ULS.shipAssertTag(6305494,307,ob.isValid);Jd=hg.a.Ze(ob);Ta=re?rd.ParagraphReader.textLength(Jd)-Eb:0;this.sj.fMa=bc?Tb.SelectionFactory.eN(Jd,Ta-1,Ta):Tb.SelectionFactory.Ie(Jd,Ta);this.sj&&this.sj.grc&&rd.ParagraphReader.lc(Jd)&&this.sj.nse&&((bc=this.sj.nse.Fmp)&&
this.nO.IP(bc,Jd,!0),(bc=this.sj.nse.qgo)&&this.gm.zYh(Jd,bc));sl.a.omk&&this.Z0k(this.LLm(nb,Eb));Ia.fj(this.$yb);return!0};this.x5o=Ia=>{const Ta=te.a.kb(this.o7j);Ta.vN(1);this.sj.fMa=Tb.SelectionFactory.zq(Ta.currentNode,!1);Ia.fj(this.$yb);return!0};this.$yb=()=>{var Ia=void 0===this.sj.nz||null===this.sj.nz?"not available":Object(JC.a)(bB,this.sj.nz);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.sj.nz,Ia);v.ULS.shipAssertTag(6305497,307,!!this.sj.fMa);this.KVb?Object($d.a)("ExternalPasteAction",
!0):Object($d.a)("InternalPasteAction",!0);this.afb&&(Ia=new te.a,this.afb.restore(Ia),this.afb=null,this.Z2m(Ia));this.transaction.dispose();this.KVb&&Pt.a.UMn();Ia=this.LA.py;if(!Ia.Ee||!Ia.Ve.ql)return!1;Ia.Ve.Bqp();return!1};this.GNa=b;this.LHf=this.afb=null;this.sj=h;this.transaction=r;this.hfa=A;this.LA=L;this.Haa=ba}get J(){return y.AFrameworkApplication.J}get Q6e(){return!!this.J&&this.J.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get fF(){return null!=this.W_g?this.W_g:this.W_g=Xa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get nO(){return null!=
this.jbh?this.jbh:this.jbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get kc(){return null!=this.Hbh?this.Hbh:this.Hbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get gm(){return null!=this.A7g?this.A7g:this.A7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}get Vd(){return null!=this.Q5g?this.Q5g:this.Q5g=Xa.a.instance.resolve("Box4.List.IListReader")}get om(){return null!=this.C5g?this.C5g:this.C5g=Xa.a.instance.resolve("Box4.List.IListEditor")}get U4(){return null!=this.Q0g?
this.Q0g:this.Q0g=Xa.a.instance.resolve("Box4.IBox4GraphWriter")}get ftd(){return null!=this.d9g?this.d9g:this.d9g=Xa.a.instance.Wa("Box4.List.ISingleLevelListEditor")}get lk(){return null!=this.cah?this.cah:this.cah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ni(){return null!=this.Jah?this.Jah:this.Jah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Yd(){return null!=this.oah?this.oah:this.oah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get V0(){return null!=
this.lXg?this.lXg:this.lXg=Xa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get Hng(){return null!=this.P7g?this.P7g:this.P7g=Xa.a.instance.Wa("Box4.IPastedParagraphSpaceHandler")}get fyj(){return!1}mri(){}get KVb(){return!1}Txj(b){let h=!1;return sl.a.hwb?(mp.a.instance.Ae(()=>{h=this.Uxj(b)},"APEM:PS"),h):this.Uxj(b)}Uxj(b){var h=void 0===this.sj.nz||null===this.sj.nz?"not available":Object(JC.a)(bB,this.sj.nz);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.sj.nz,h);
v.ULS.shipAssertTag(6305487,307,Ee.a.Df(this.GNa));if(this.Hoe)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.sj.fMa=Tb.SelectionFactory.aq(this.GNa),b.fj(this.$yb),!0;if(!this.GNa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new te.a;h.set(this.GNa.node);Ee.a.uw(h);hg.a.xe(h);this.o7j=h.origin;if(this.fyj)return h.Mu(10),this.mri(h,b),b.fj(this.x5o),!0;this.hfa&&this.hfa.c2n(this.GNa);if(!this.Fjp(this.GNa))return this.sj.HW&&
(this.sj.HW.fail("SplitLine Failed",!0),this.sj.zC=!0),this.sj.fMa=Tb.SelectionFactory.aq(this.GNa),b.fj(this.$yb),!0;const r=new Oi.a;r.Ad(h);hg.a.Fu(r,!1,!1);this.afb=new gH.a(h);this.LHf=new gH.a(r);b.fj(this.uho);return!0}jZj(){return!1}get B4i(){return this.J.$("PptCcpFix2IsEnabled")}get F$o(){return this.J.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}LLm(b,h){if(0==b&&0==h)return dB.olk;if(0==b&&0!=h)return dB.jpk;if(0!=b&&0!=h)return dB.Dnk;if(0==h&&0!=b)return dB.qlk}Z0k(b){b=[Object.assign(new ma.a,
{name:"isExternalPaste",bool:this.KVb}),Object.assign(new ma.a,{name:"Single OE",bool:this.I0e}),Object.assign(new ma.a,{name:"Context",string:b})];Object($d.a)("ContextualTelemetryForPaste",!0,void 0,b)}Tqn(b,h){return!h&&!!b&&Mb.a.ji(b.RCa)&&Mb.a.kqb(b.RCa)}Ctn(b,h){return!h&&!!b&&Mb.a.ji(b.Swb)&&Mb.a.kqb(b.Swb)}Blo(b){Fo.Vzj&&b&&Fo.Vzj.Cpo(b)}iap(b,h,r){var A;nf.a.Wg(b)?(null===(A=this.ftd)||void 0===A?void 0:A.bYf(b),h=nf.a.Wg(h)?this.FYj:!0):Mb.a.isEmpty(b,!0)&&!r?(Fo.Yf.q$a(b),h=!1):h=!0;this.hfa&&
(h=this.hfa.mwl(b,h));return h}jap(b,h){return nf.a.Wg(b)||1===h?!0:!1}yTn(b,h,r,A){const L=nf.a.Wg(b);if(L){if(A=new Oi.a,A.Ad(b),hg.a.Fu(A,!1,!1),A.Jr.id!==h.Jr.id){r=this.Vd.Fy(b);if(nf.a.Qe)({listId:ba}=nf.a.wna(b,{Qta:0}));else{this.Vd.s2(b);var ba=b.currentNode.ka(Rc.a.listID,0);b.Ac()}var ra=this.Vd.M0j,Ia=!0;for(r.zF=Gi.a.sl;A.currentNode.id!==h.currentNode.id;){if(!ra||!Mb.a.Vbp(A))if(!nf.a.Wg(A))qh.a.getInstance().Gv?(Mb.a.koc(A)||({Tna:r}=this.om.Vsa(r.kf,A,r)),this.om.X2()):{Tna:r}=this.om.Vsa(r.kf,
A,r),Ia=!1;else if(L){Ia=nf.a.Qe?nf.a.wna(A,{SWa:-1}).listLevel:this.Vd.uOf(A);var Ta=this.Vd.XA(b.currentNode,ba,Ia);Ta=Ta?Yr.a.hca(Ta,null):r;Ia=Yr.a.LY(Ta.listType,r.listStyle,null,0,Ia,"","");Ia.jyb=b.currentNode;this.om.c4o(Ia);this.om.oBe(A,!0);Ia=!1}hg.a.Fu(A,!1,!1)}ra&&Ia&&this.om.Bhl()}}else if(1===r)for(r=new Oi.a,r.Ad(b),hg.a.Ze(r),b=rd.ParagraphReader.Wh(r)?r.currentNode:null,ba=this.kc.rRf(r),hg.a.xe(r),hg.a.Fu(r,!1,!1);r.currentNode.id!==h.currentNode.id;)hg.a.Ze(r),ra=rd.ParagraphReader.Wh(r)?
r.currentNode:null,hg.a.xe(r),ra&&b&&A&&(ba&&this.nO.IP(ba,ra,!0),this.Haa.qjj(b,ra,L),this.Haa.owa(b,ra,1,!0)),hg.a.Fu(r,!1,!1)}nfl(b,h,r){if(this.Yd.Zg){for(;b.currentNode!==r.currentNode;){hg.a.Ze(b,!1);const A=this.Ni.std(vc.a.create(b.currentNode));let L;({type:L}=A.bce()).returnValue&&this.Yd.Vv(L);for(let ba=0;ba<A.length;ba++){let ra;const Ia=({Qje:ra}=A.getContext(ba)).returnValue;ra&&(Fo.Gs.cyb(Ia,1),this.lk.bBb(Ia,1,null,!0))}b.Ac();hg.a.Fu(b,!1,!1)}b.Ad(h);hg.a.Fu(b,!1,!1)}}kSm(b,h){b=
te.a.kb(b);hg.a.Ze(b);return rd.ParagraphReader.lc(b.currentNode)?(h=h?rd.ParagraphReader.textLength(b.currentNode):0,Tb.SelectionFactory.Ie(b.currentNode,h)):Qh.TableReader.pP(b.currentNode)?Tb.SelectionFactory.ot(b.currentNode):null}Z2m(b){if(b){if(this.KVb&&Qh.TableReader.Cz(b)&&this.I0e){if(null!=this.c_e&&0==this.c_e){var h=new Oi.a;h.Ad(b);hg.a.Fu(h,!1,!1);b.Ad(h)}h=Vr.a.MLo(b);const r=rd.ParagraphReader.Vn(h);h&&r&&(this.sj.fMa=Tb.SelectionFactory.Ie(r,0),b=te.a.kb(h))}else Vr.a.Cho(b);b&&
Qh.TableReader.Cz(b)&&Lh.A(b)&&Vr.a.N9k(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}G9o(b,h){const r=new te.a;r.Ad(b);b=hg.a.Ze(r);h=rd.ParagraphReader.lc(b)&&h===rd.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}Fjp(b){var h;v.ULS.shipAssertTag(6305498,307,Ee.a.Df(b));if(null===(h=this.U4)||void 0===h?0:h.E2a)return!!this.U4.E2a(b.node,b.cpBegin,{okm:!0,Ob:b.Ob,nc:b.nc});h=te.a.kb(b.node);
var r=h.Wd();hg.a.xe(h);r&&b.isValid||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Mb.a.ji(h)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.J.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;r=Fo.Yf.kva(h,!0);const A=this.G9o(h,b.cpBegin);Fo.Yf.wea(h,r,b,!1,!1,!0,A);return!0}S2i(){return!!(this.sj.nz&65536)}static get Gs(){return null!=
Fo.a1g?Fo.a1g:Fo.a1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Jj(){return fn.a.instance}static get Yf(){return null!=Fo.G6g?Fo.G6g:Fo.G6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get du(){return qh.a.getInstance()}static get Dc(){return null!=Fo.f_g?Fo.f_g:Fo.f_g=Xa.a.instance.Wa("Box4.IFeatureHelper")}static get Vzj(){return null!=Fo.U7g?Fo.U7g:Fo.U7g=Xa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get Iho(){return null!=
Fo.O7g?Fo.O7g:Fo.O7g=Xa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}}Object(u.a)(Fo,"APasteExecutionManager",null,[]);class Ru{constructor(b){this.Ek=b}reset(){this.Ek.reset()}get v0c(){return this.Ek.v0c}Dia(b,h){this.Ek.Dia(b,h)}Dda(b){this.Ek.Dda(b)}Iyb(b){this.Ek.Iyb(b)}WEa(b){this.Ek.WEa(b)}TOa(b){this.Ek.TOa(b)}f0a(b,h){this.Ek.f0a(b,h)}e0a(){this.Ek.e0a()}JH(b){this.Ek.JH(b)}gJ(){this.Ek.gJ()}Eyb(){this.Ek.Eyb()}Dyb(){this.Ek.Dyb()}ZEa(b){this.Ek.ZEa(b)}ywa(){this.Ek.ywa()}XOa(b){this.Ek.XOa(b)}YEa(){this.Ek.YEa()}zeb(b){this.Ek.zeb(b)}Jda(b){this.Ek.Jda(b)}Hda(){this.Ek.Hda()}W9(b){this.Ek.W9(b)}Ida(){this.Ek.Ida()}Gda(b){this.Ek.Gda(b)}Fda(){this.Ek.Fda()}l0a(b,
h){this.Ek.l0a(b,h)}teb(){this.Ek.teb()}}Object(u.a)(Ru,"AHtmlNormalizer",null,[203,204]);class lr extends Ru{constructor(b){super(b);this.YN=!1}Dia(b,h){this.YN?this.CR.XQ(()=>{this.Yqg(b,h)}):this.Yqg(b,h)}Yqg(b,h){this.Ek.Dia(b,h)}Dda(b){this.YN?this.CR.XQ(()=>{this.Aqg(b)}):this.Aqg(b)}Aqg(b){this.Ek.Dda(b)}WEa(b){this.YN?this.CR.XQ(()=>{this.rld(b)}):this.rld(b)}rld(b){this.Ek.WEa(b)}TOa(b){this.YN?this.CR.XQ(()=>{this.yqg(b)}):this.yqg(b)}yqg(b){this.Ek.TOa(b)}f0a(b,h){this.YN?this.CR.XQ(()=>
{this.rqg(b,h)}):this.rqg(b,h)}rqg(b,h){this.Ek.f0a(b,h)}e0a(){this.YN?this.CR.XQ(Object(E.a)(this,this.qqg,"processAnchorEnd")):this.qqg()}qqg(){this.Ek.e0a()}JH(b){this.YN?this.CR.XQ(()=>{this.Kqg(b)}):this.Kqg(b)}Kqg(b){this.Ek.JH(b)}gJ(){this.YN?this.CR.XQ(Object(E.a)(this,this.Jqg,"processParagraphEnd")):this.Jqg()}Jqg(){this.Ek.gJ()}Eyb(){this.YN?this.CR.XQ(Object(E.a)(this,this.Nqg,"processPreFormattedTextStart")):this.Nqg()}Nqg(){this.Ek.Eyb()}Dyb(){this.YN?this.CR.XQ(Object(E.a)(this,this.Mqg,
"processPreFormattedTextEnd")):this.Mqg()}Mqg(){this.Ek.Dyb()}ZEa(b){this.YN?this.CR.XQ(()=>{this.Eqg(b)}):this.Eqg(b)}Eqg(b){this.Ek.ZEa(b)}ywa(){this.YN?this.CR.XQ(Object(E.a)(this,this.Bqg,"processListEnd")):this.Bqg()}Bqg(){this.Ek.ywa()}XOa(b){this.YN?this.CR.XQ(()=>{this.Dqg(b)}):this.Dqg(b)}Dqg(b){this.Ek.XOa(b)}YEa(){this.YN?this.CR.XQ(Object(E.a)(this,this.Cqg,"processListItemEnd")):this.Cqg()}Cqg(){this.Ek.YEa()}Jda(b){this.YN?this.CR.XQ(()=>{this.Xqg(b)}):this.Xqg(b)}Xqg(b){this.Ek.Jda(b)}Hda(){this.YN?
this.CR.XQ(Object(E.a)(this,this.Uqg,"processTableEnd")):this.Uqg()}Uqg(){this.Ek.Hda()}W9(b){this.YN?this.CR.XQ(()=>{this.Wqg(b)}):this.Wqg(b)}Wqg(b){this.Ek.W9(b)}Ida(){this.YN?this.CR.XQ(Object(E.a)(this,this.Vqg,"processTableRowEnd")):this.Vqg()}Vqg(){this.Ek.Ida()}Gda(b){this.YN?this.CR.XQ(()=>{this.Tqg(b)}):this.Tqg(b)}Tqg(b){this.Ek.Gda(b)}Fda(){this.YN?this.CR.XQ(Object(E.a)(this,this.Sqg,"processTableCellEnd")):this.Sqg()}Sqg(){this.Ek.Fda()}l0a(b,h){this.YN?this.CR.XQ(()=>{this.Gqg(b,h)}):
this.Gqg(b,h)}Gqg(b,h){this.Ek.l0a(b,h)}teb(){this.YN?this.CR.XQ(Object(E.a)(this,this.RBj,"processMathEnd")):this.RBj()}RBj(){this.Ek.teb()}}Object(u.a)(lr,"AQueuingHtmlNormalizer",Ru,[]);var UJ=e(2015);class PC{constructor(){this.w8e=new UJ.a}XQ(b){this.w8e.enqueue(b)}flush(b=!1){for(b&&this.JAe();!this.w8e.isEmpty;)this.w8e.dequeue()();b&&this.Aye()}JAe(){}Aye(){}}Object(u.a)(PC,"QueuedEventManager",null,[]);class Nv extends PC{constructor(b){super();this.id=void 0;this.eyf=null;this.Fbd=!1;this.Oda=
"";this.Whe=this.Oie=!1;this.Xxf=this.Bic=null;this.dhd=0;this.Qbd=this.tdd=this.l5f=!1;this.table=null;this.ifg=0;this.K3=b}get OVc(){return!!this.table}JAe(){this.K3.Vvc.push(this.K3.currentState);this.K3.currentState=this}Aye(){this.K3.currentState=this.K3.Vvc.pop()}}Nv.nextId=void 0;Object(u.a)(Nv,"ContentState",PC,[]);class hH{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.Ucb=b.Ucb;this.shadingColor=b.shadingColor;this.verticalAlignment=
b.verticalAlignment;this.dqa=b.dqa;this.sFe=b.sFe;this.Hrc=b.Hrc;this.Qba=b.Qba;this.contents=r;this.pZm=h}}Object(u.a)(hH,"TableCell",null,[]);var VJ=e(1696),qo=e(1697);class pu extends PC{constructor(b,h){super();this.K3=b;this.DMh=new Dw.a;this.Vqa=new Dw.a;this.I3e=[];this.LOd=[];this.BSa=-1;this.C4a=0;this.GGk=h.T_f;this.FGk=h.Amn;this.CVk=h.xKg;this.Wt=h.width;this.Evh=h.Ucb;this.KDk=new Rp.a(new Xs(h.Mda.AUi,h.Mda.Yde),h.nF,h.iFa,h.cultureName,h.VJa);this.zFk=h.Uee;this.pRd=h.styleId;this.HVk=
h.tableLook}get Ek(){return this.K3.Ek}Xmo(b){this.BSa++;this.DMh.add(b);this.LOd[this.BSa]=b.height;this.C4a=0}get HSl(){for(;this.C4a>=this.Vqa.count;)this.Vqa.add(Array(this.BSa+1));return this.Vqa.K(this.C4a)}addCell(b,h,r,A,L,ba,ra){if(0>this.BSa)return!1;for(;this.I3e[this.C4a]>=this.BSa;)this.C4a++;b=new hH(b,new Rp.a(h,r,A,L,ba),ra);this.HSl[this.BSa]=b;if(1<b.rowSpan)for(h=this.BSa+b.rowSpan-1,A=this.C4a,r=this.C4a+b.colSpan-1;A<=r;A++)this.I3e[A]>=h||(this.I3e[A]=h);this.C4a+=b.colSpan;
this.LOd[this.BSa]<b.height&&(this.LOd[this.BSa]=b.height);return!0}JAe(){this.K3.currentState.table=this}Aye(){this.K3.currentState.table=null}Vui(){y.AFrameworkApplication.ud("fd8b6402;j6e17681");this.flush(!0);const b=this.BSa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.Vqa.count);r=!0;var A=0;for(var L=0;L<this.Vqa.count;L++){var ba=this.Vqa.K(L),ra=!0;for(var Ia=0;Ia<b;Ia++){var Ta=ba[Ia];Ta&&(ra=!1,h[Ia][L+A]=new OE(Ta.colSpan,Ta.rowSpan,Ta.width,Ta.height,void 0,void 0,void 0,void 0,
Ta.Ucb,Ta.Hrc))}ra?(this.Vqa.removeAt(L),L--,++A):r=!1}if(!r){(h=this.Evh?this.K3.M3h(h,this.Wt/100):this.K3.M3h(h,1,this.Wt))&&h.length!==this.Vqa.count&&(h=null);this.K3.Rrb(!0);this.K3.DZd();this.Ek.Jda(new bH(b,this.Vqa.count,this.Wt,this.Evh,h,this.GGk,this.FGk,this.CVk,this.zFk,this.pRd,this.HVk,this.KDk));for(h=0;h<b;h++){r=this.DMh.K(h);this.Ek.W9(new aw(this.LOd[h],new Rp.a(r.Mda,r.nF,r.iFa,r.cultureName,r.VJa)));for(r=0;r<this.Vqa.count;r++){A=this.Vqa.K(r)[h];var ob=!!this.pRd&&""!==this.pRd&&
"Custom"!==this.pRd;L=A?A.colSpan:0;ba=A?A.rowSpan:0;A&&(L=Math.min(A.colSpan,this.Vqa.count-r),ba=Math.min(A.rowSpan,b-h));ra=A?A.width:0;Ia=A?A.height:0;Ta=A?A.Qba:0;const nb=A?A.Ucb:!1,Eb=A&&(65536&Ta||!ob)?A.shadingColor:"",bc=A?A.verticalAlignment:0,Bc=A?A.Hrc:!1;ob=A?this.K3.KIm(A.dqa,r,h,this.Vqa,ob,A.Qba):new VJ.a;const Yc=A?A.sFe:new qo.a,zd=A?A.pZm:null;this.Ek.Gda(new OE(L,ba,ra,Ia,Eb,bc,ob,Yc,nb,Bc,Ta,new Rp.a(zd?zd.Mda:null,zd?zd.nF:null,zd?zd.iFa:null,zd?zd.cultureName:null,zd?zd.VJa:
null)));A&&!A.Hrc&&(A.contents.JAe(),A.contents.flush(),this.K3.Rrb(!1),this.K3.DZd(),A.contents.Aye());this.Ek.Fda()}this.Ek.Ida()}this.Ek.Hda();this.K3.currentState.Qbd=!1;this.K3.Vpi(!1)}}}Object(u.a)(pu,"NormalizedTable",PC,[]);class QC{constructor(b=!1,h=!1){this.vHk=b;this.qsa=h}get Nsn(){return this.vHk}get bhb(){return this.qsa}}Object(u.a)(QC,"HtmlNormalizerSettings",null,[263]);class Iw extends lr{constructor(b,h=null){super(b);this.Vvc=new HC;this.a$b=h||new QC}reset(){super.reset();this.currentState=
new Nv(this);this.Vvc.clear();this.YN=!1}get CR(){return this.currentState&&this.currentState.OVc?this.currentState.table:this.currentState}x2c(b=!1){this.currentState.Fbd||(this.DZd(),this.Ek.JH(this.currentState.eyf),this.currentState.Fbd=!0,this.currentState.Qbd=!1);b||!this.currentState.Bic||this.currentState.Whe||(this.Ek.f0a(this.currentState.Bic,this.currentState.Xxf),this.currentState.Whe=!0)}w2c(){this.currentState.Whe&&(this.Ek.e0a(),this.currentState.Whe=!1)}Wpi(){this.currentState.Fbd&&
(this.Ek.gJ(),this.currentState.Fbd=!1,this.currentState.Oda="")}Vpi(b){this.currentState.tdd&&(this.currentState.Qbd?b||(this.Ek.JH(null),this.Ek.gJ(),this.Ek.YEa(),this.currentState.tdd=!1):(this.Ek.YEa(),sl.a.rmk&&this.Ek.ywa(),this.currentState.tdd=!1,this.currentState.Qbd=!0))}Rrb(b){this.w2c();this.Wpi();this.Vpi(b)}Aco(b){this.Ek.ZEa(new Hs.a(2,1,b));this.currentState.dhd++;this.currentState.l5f=!0}DZd(){!this.currentState.tdd&&this.currentState.l5f&&(this.Ek.ywa(),this.currentState.dhd--,
this.currentState.l5f=!1)}Yqg(b,h){b=this.pZn(b);if(""!==b)if(this.x2c(),this.currentState.Oie)this.Zqg(b,h);else{b=b.split(Iw.ppl);for(let r=0;r<b.length-1;r++)this.Zqg(b[r],h),this.Ek.Iyb(h);this.Zqg(b[b.length-1],h)}}Gqg(b,h){""!==b&&(this.x2c(),this.Ek.l0a(b,h))}Aqg(b){this.a$b.bhb||this.w2c();if(sl.a.Sun){const h=this.currentState.Fbd;this.x2c(!0);h?this.Ek.Dda(b):this.Wpi()}else this.x2c(!0),this.Ek.Dda(b)}yqg(b){this.currentState.OVc||this.Ek.TOa(b)}rld(b){this.currentState.Bic&&(b.href=this.currentState.Bic);
super.rld(b)}rqg(b,h){this.w2c();this.currentState.Bic=b;this.currentState.Xxf=h}qqg(){this.w2c();this.currentState.Bic=null;this.currentState.Xxf=null}Kqg(b){this.currentState.eyf=b;this.Rrb(!0)}Jqg(){this.currentState.eyf=null;this.Rrb(!0)}Nqg(){this.currentState.Oie=!0}Mqg(){this.currentState.Oie=!1}Eqg(b){this.Rrb(!1);this.DZd();this.Ek.ZEa(b);this.currentState.dhd++}Bqg(){this.Rrb(!1);this.Ek.ywa();this.currentState.dhd--}Dqg(b){this.Rrb(!1);this.currentState.dhd||this.Aco(b);this.Ek.XOa(b);
this.currentState.tdd=!0;this.currentState.Qbd=!0}Cqg(){this.Rrb(!1)}Jda(b){this.currentState.OVc||(this.YN=!0,this.currentState.table=new pu(this,b))}Xqg(){}Hda(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.Vvc.isEmpty?(this.YN=!1,b.Vui()):this.CR.XQ(Object(E.a)(b,b.Vui,"flushTable"))}}Uqg(){}W9(b){this.currentState.OVc&&this.currentState.table.Xmo(b)}Wqg(){}Ida(){}Vqg(){}Gda(b){let h=!1;if(this.currentState.OVc){const r=new Nv(this);this.currentState.table.addCell(b,
new Xs(b.Mda.AUi,b.Mda.Yde),b.nF,b.iFa,b.cultureName,b.VJa,r)?(this.Vvc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.ifg++}Tqg(){}Fda(){0<this.currentState.ifg?this.currentState.ifg--:this.currentState=this.Vvc.pop()}Sqg(){}M3h(b,h=1,r=0){if(!b)return null;const A=b.length;if(!A)return null;const L=b[0].length;for(var ba=1;ba<A;ba++)if(b[ba].length!==L)return null;ba=Array(L+1);ba[0]=0;const ra=Array(L+1);for(var Ia=0;Ia<ra.length;Ia++)ra[Ia]=!1;Ia=new Cb.a;for(let ob=
0;ob<L;ob++){for(var Ta=0;Ta<A;Ta++){const nb=b[Ta][ob];if(nb&&0<nb.width){const Eb=Math.min(ob+nb.colSpan,L);ba[Eb]=ba[ob]+nb.width*(nb.Ucb?h:1);ra[Eb]=!0}}if(ra[ob+1]){Ta=ba[ob+1]-ba[ob];if(0>=Ta)return null;Ia.add(Ta)}else ba[ob+1]=ba[ob]}return sl.a.S4f&&ba[L]<r?null:Ia.toArray()}rRn(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}KIm(b,h,r,A,L,ba){if(!b)return null;L&&(b=this.rRn(b,ba));if(0>r||0>h||h>A.count-
1)return b;0<=h-1&&r<=A.K(h-1).length-1&&1===b.borderLeftStyle&&(L=A.K(h-1)[r])&&1!==L.dqa.borderRightStyle&&(b.borderLeftStyle=L.dqa.borderRightStyle,b.borderLeftColor=L.dqa.borderRightColor,b.borderLeftWidth=L.dqa.borderRightWidth);0<=r-1&&r<=A.K(h).length-1&&1===b.borderTopStyle&&(h=A.K(h)[r-1])&&1!==h.dqa.borderBottomStyle&&(b.borderTopStyle=h.dqa.borderBottomStyle,b.borderTopColor=h.dqa.borderBottomColor,b.borderTopWidth=h.dqa.borderBottomWidth);return b}pZn(b){this.currentState.Oie||(b=this.a$b.Nsn?
b.replace(Iw.P9m," "):b.replace(Iw.O9m," "));b.startsWith(" ")&&(this.currentState.Oda.endsWith(" ")||""===this.currentState.Oda)&&(b=D.a.substring(b,1,b.length));return b}Zqg(b,h){""!==b&&(this.Ek.Dia(b,h),this.currentState.Oda+=b)}}Iw.O9m=RegExp("[ \t\f\u200b\r\n]+","g");Iw.P9m=RegExp("[ \f\u200b\r\n]+","g");Iw.ppl="\t";Object(u.a)(Iw,"DefaultHtmlNormalizer",lr,[]);class eB extends Iw{constructor(b,h,r){super(b,r);this.nqh=!1;this.YGb=h}static Xon(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",
!1)&&b?(b=eB.gYl.exec(b))&&0<b.length:!1}rld(b){this.YGb.Ewc&&(y.AFrameworkApplication.awa?this.nqh||(b=new wg.StandardDialog,b.Md=0,b.Ue(1,CommonUIStrings.l_DialogClose),b.Yx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.nqh=!0):this.YGb.vij?this.YGb.Wme=!0:b.src&&""!==b.src?db.a.getOrigin(b.src)!==db.a.getOrigin(window.location.href)||eB.Xon(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?y.AFrameworkApplication.va.Vb(fb.a.ayj,2):b.src.startsWith("webkit-fake-url")?
y.AFrameworkApplication.va.Vb(fb.a.$xj,2):(this.w2c(),this.x2c(!0),this.Ek.WEa(b)):y.AFrameworkApplication.va.Vb(fb.a.cyj,2):y.AFrameworkApplication.va.Vb(fb.a.byj,2))}}eB.gYl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(u.a)(eB,"Box4HtmlNormalizer",Iw,[]);class ci{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.BUi=b;this.xXf=h;this.xul=r;this.Fhk=A;this.Fjm=L;this.fWo=ba;this.gWo=ra;this.w9c=Ia;this.G9m=Ta;this.J9m=ob;this.Ted=nb}}Object(u.a)(ci,"ExecutePasteArguments",null,
[]);class RE extends Fo{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re=null){super(h,r,A,ob,Eb,Yc,Jd);this.mE=ie;this.qUb=re;this.A7=null;this.iZn=me=>{this.OTk&&this.ZXe.Cwp(this.gba);me.fj(this.bno);return!0};this.bno=me=>{if(this.dTk){const Sd=this.gba.getElementsByTagName("style");if(Sd&&0<Sd.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let cf=0;cf<Sd.length;cf++)this.wkb.eci(this.gba,Sd[cf]),Sd[cf]&&
(Sd[cf].parentNode.removeChild(Sd[cf]),cf--)}}me.fj(this.eIl);return!0};this.eIl=(me,Sd)=>{this.ngf.value.create(Sd.Fhk).process(this.gba,me);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChartsPasteFromXLOIsEnabled",!1)?me.fj(this.mHl):me.fj(this.JBj);return!0};this.mHl=(me,Sd)=>{(new fH(Sd.xul)).process(this.gba,me);me.fj(this.JBj);return!0};this.JBj=(me,Sd)=>{var cf;y.AFrameworkApplication.ud("j6cj2207;gfehe251");if(sl.a.yva){var sf=window.performance.now();
this.gba=this.qUb.xcl(this.gba);Pt.a.fye=window.performance.now()-sf}else if(sl.a.krc&&!document.getElementById("FrameContainingPastedDOM")){sf=window.performance.now();var yh=document.createElement("iframe");yh.style.visibility="hidden";yh.style.zIndex="-100";yh.style.position="absolute";yh.style.width=window.screen.width+"px";yh.style.height=window.screen.height+"px";yh.style.contain="strict";yh.setAttribute("sandbox","allow-same-origin");yh.id="FrameContainingPastedDOM";document.body.appendChild(yh);
(yh=yh.contentDocument)&&sl.a.dzn&&(yh.documentElement.style.fontSize="62.5%",yh.body.style.fontSize="1.6rem");Pt.a.y1d=window.performance.now()-sf}yh=null;!sl.a.yva&&sl.a.krc&&(yh=document.getElementById("FrameContainingPastedDOM"));!sl.a.yva&&sl.a.krc&&yh instanceof HTMLIFrameElement?(sf=window.performance.now(),yh=null===(cf=yh.contentDocument)||void 0===cf?void 0:cf.querySelector("body"),null===yh||void 0===yh?void 0:yh.appendChild(this.gba),Pt.a.fye=window.performance.now()-sf,cf=null===yh||
void 0===yh?void 0:yh.children,1!==(null===cf||void 0===cf?void 0:cf.length)&&v.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),Sd.BUi.process(1===(null===cf||void 0===cf?void 0:cf.length)?cf[0]:this.gba,me)):Sd.BUi.process(this.gba,me);me.fj(Sd.xXf&&Sd.xXf.Ewc?this.$0b:this.Zoi);return!0};this.$0b=(me,Sd)=>{if(Sd=Sd.xXf){let sf=!1,yh=!1,si=!1,cl=!1;var cf=-1;const Pj=new Ai.DictionaryPropertySet,cn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Pb.a)(66,
this.sj.Ed)?(sf=this.sj.Ed.ka(Rc.a.ioa,!1),cf=this.sj.Ed.ka(Pd.a.PZ,""),si=this.sj.Ed.ka(Pd.a.$ha,!1),cl=this.sj.Ed.ka(Sb.a.dEa,!1),cn.test(cf)&&(yh=!0),cf=this.sj.Ed.ka(Kh.a.Wma,-1)):this.sj.nz&256&&this.gba&&(sf=!0,cn.test(this.gba.innerHTML)&&(yh=!0));Pj.setValue(Rc.a.ioa,sf);Pj.setValue(Pd.a.ydd,yh);Pj.setValue(Pd.a.$ha,si);Pj.setValue(Kh.a.Wma,cf);Pj.setValue(Sb.a.dEa,cl);Sd.eBe(Pj);Sd.bkg();Sd.gyb&&(this.sj.Dbd=!0,this.sj.pNa=Sd.g1,this.sj.Fgg=Sd.gyb,sf&&!si&&$d.c(fb.a.ram),y.AFrameworkApplication.va.Vb(fb.a.$0b,
2))}me.fj(this.Zoi);return!0};this.Zoi=(me,Sd)=>{var cf;me=window.performance.now();if(sl.a.yva)this.qUb.uHo();else if(sl.a.krc){var sf=document.getElementById("FrameContainingPastedDOM");sf instanceof HTMLIFrameElement&&(sf=null===(cf=sf.contentDocument)||void 0===cf?void 0:cf.querySelector("body"),(null===sf||void 0===sf?0:sf.firstElementChild)?(v.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===sf||void 0===sf?void 0:sf.removeChild(null===sf||void 0===sf?
void 0:sf.firstElementChild)):v.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}Pt.a.Owg=window.performance.now()-me;Mq.a.xOn(Sd.Fhk);Mq.a.NLn(Sd.J9m);Mq.a.yNn(Sd.fWo);Mq.a.zNn(Sd.gWo);Mq.a.nMn(Sd.Ted);cf="Others";Sd.w9c&&(Sd.w9c.KLn(),Sd.w9c.LLn(),Sd.w9c.MNn(),cf=Sd.w9c.RHg);Mq.a.MLn(Sd.G9m,cf);Mq.a.wLn(Sd.Fjm,cf);return!1};this.gba=b;this.WOe=L;this.FYe=ba;this.Qcf=ra;this.ngf=Ia;this.wLc=Ta;this.a$b=Bc;this.za=nb;this.frh=Object.assign(new np,{hqc:2===this.sj.Zhc||
3===this.sj.Zhc});this.wkb=bc;this.ZXe=zd;this.Qcc=nb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.dTk=nb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.OTk=nb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get Hoe(){return!1}get KVb(){return!0}kri(b){sl.a.hwb?mp.a.instance.Ae(()=>{this.lri(b)},"EPEM:EP"):this.lri(b)}lri(b){this.A7=new te.a;this.afb.restore(this.A7);v.ULS.shipAssertTag(6305550,307,Mb.a.ji(this.A7));this.sj.HW&&this.sj.HW.Gfc("external");var h=this.sj.nz&8192?1:0,r=this.FYe.value.create(h,
this.A7,this.sj.DYc,this.sj.iAb),A=this.Qcf.value.create(h,this.A7);const L=Mq.a.Uzi(y.AFrameworkApplication.userSessionId),ba=Mq.a.qPi(y.AFrameworkApplication.userSessionId),ra=Mq.a.lNf(X.a.ONb,this.sj.DYc),Ia=Mq.a.LLi(y.AFrameworkApplication.userSessionId),Ta=Mq.a.MLi(y.AFrameworkApplication.userSessionId),ob=this.Qcc?this.fen():null,nb=Mq.a.EEi(X.a.ONb,this.sj.DYc),Eb=Mq.a.FEi(y.AFrameworkApplication.userSessionId),bc=this.wLc.mYj?Mq.a.FFm(y.AFrameworkApplication.userSessionId):null;h=this.WOe.value.create(h,
this.A7,r,A,null,ra,this.Nal,this.sj.$Fe);h=new qn(h,Ia,Ta);h=new eB(h,r,this.a$b);h=new Gn(h,this.wLc,this.frh,bc,sl.a.yva?this.qUb:null);A=new xo(ob);h=new QE(h,A,nb,ob,this.za);h=new cw(h,this.mE,Eb);r=new ci(h,r,L,ba,ra,Ia,Ta,ob,nb,Eb,bc);r=new rt.a(b,this.iZn,r);r.$m("paste and request pictures");r.Ei=!b||b.Ei;r.run()}get Nal(){return this.gba.getElementsByTagName("a").length}fen(){const b=new Ax;b.twc=X.a.ONb;this.sj&&(b.nz=this.sj.nz,b.Avj=this.sj.DYc,this.sj.Ed&&(b.progId=this.sj.Ed.ka(Pd.a.Zxj,
"")));this.gba&&this.gba.innerHTML&&(b.Yxj=this.gba.innerHTML.length,Pt.a.Eng=b.Yxj);y.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=y.AFrameworkApplication.sessionStartInfoSettings.Platform,b.Xrc=y.AFrameworkApplication.J.$("IsO365ConsumerHost"),b.K_i=rd.ParagraphReader.ama(Db.StaticActiveAppFrame.Aa().tb.Xc.Fd));return b}get FYj(){return!0}get tsd(){v.ULS.shipAssertTag(6305551,307,!!this.A7);if(this.wLc.nYj(this.frh)){var b=!1;Mb.a.ji(this.A7)&&(this.A7.g9(),b=!0);var h=rd.ParagraphReader.Wh(this.A7)&&
!this.A7.currentNode.ka(Pd.a.$1i,!1);b&&this.A7.Ac();return h}return this.sj.nz&524288?(b=!1,Mb.a.ji(this.A7)&&(this.A7.g9(),b=!0),h=rd.ParagraphReader.Wh(this.A7),b&&this.A7.Ac(),h):rd.ParagraphReader.Wh(this.A7)}}Object(u.a)(RE,"ExternalPasteExecutionManager",Fo,[]);class gh{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc=null){this.Kkc=Eb;this.mE=bc;this.qUb=Bc;this.WOe=b;this.FYe=h;this.Qcf=r;this.ngf=A;this.wLc=L;this.hfa=ba;this.za=ra;this.wkb=Ia;this.a$b=Ta;this.Haa=ob;this.ZXe=nb}create(b,
h,r,A){return new RE(b,h,r,A,this.WOe,this.FYe,this.Qcf,this.ngf,this.wLc.value,this.hfa,this.za,Db.StaticActiveAppFrame.Aa().tb,this.wkb,this.a$b,this.Haa,this.ZXe,this.Kkc,this.mE,sl.a.yva?this.qUb.value:null)}}Object(u.a)(gh,"Factory",null,[665]);class RC{constructor(b=null){var h;this.PH=b;b=window.performance.now();sl.a.R_i&&(null===(h=this.PH)||void 0===h?void 0:h.execute(r=>{r.logActivity("CCPUsage","CCPFloodgateSurvey")}));this.lwf();Pt.a.y1d=window.performance.now()-b}xcl(b){if(this.Eha.contentDocument){const h=
this.Eha.contentDocument.body;b=h.appendChild(b);1!==h.children.length&&v.ULS.sendTraceTag(508624975,307,15,`Found Non-One Pasted Containers ${h.children.length}`);return b}v.ULS.sendTraceTag(508624974,307,15,"iframe not loaded when append method was called");return b}uHo(){if(this.Eha.contentDocument){var b=this.Eha.contentDocument.body;b?b.lastElementChild?(v.ULS.sendTraceTag(508624930,307,50,"iframe body first element child was not null"),b.removeChild(b.lastElementChild)):v.ULS.sendTraceTag(508624929,
307,15,"iframe body first element child was null"):v.ULS.sendTraceTag(508101854,307,15,"iframe body itself is null")}}Sbm(b){var h;const r=null===(h=this.Eha.contentDocument)||void 0===h?void 0:h.body;return(null===r||void 0===r?0:r.contains(b))?getComputedStyle(b):b.style}lwf(){var b=document.getElementById(Uk.a.kDb);this.Eha=document.createElement("iframe");this.Eha.style.visibility="hidden";this.Eha.style.zIndex="-100";this.Eha.style.position="absolute";this.Eha.style.contain="strict";sl.a.czn&&
(this.Eha.style.width=window.screen.width+"px",this.Eha.style.height=window.screen.height+"px");this.Eha.setAttribute("sandbox","allow-same-origin");this.Eha.id="FrameContainingPastedDOM";b?(b.appendChild(this.Eha),b=this.Eha.contentDocument,sl.a.u7i&&b?(b.documentElement.style.fontSize="62.5%",b.body.style.fontSize="1.6rem"):sl.a.u7i&&v.ULS.sendTraceTag(508441186,307,15,"Iframe not loaded when setting root fontSize")):v.ULS.sendTraceTag(508624973,307,15,"View Panel not found")}}Object(u.a)(RC,"HiddenExternalPasteView",
null,[664]);class iH{zEn(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.cqn(b.childNodes[h-2])&&this.oCn(b.childNodes[h-1])}Cwp(b){this.zEn(b)&&(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}ynn(b){return!!b&&8===b.nodeType}GAn(b){return!!b&&3===b.nodeType}cqn(b){return this.ynn(b)&&"EndFragment"===b.nodeValue}oCn(b){if(!this.GAn(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(u.a)(iH,"HtmlNormalizerHelper",
null,[663]);var dw=e(1010),SE=e(644);class jH extends Fo{constructor(b,h,r,A,L,ba,ra,Ia,Ta){super(b,h,r,L,ba,Ia,Ta);this.rD=A;this.eIb=ra}get ym(){return this.eIb.value}get Hoe(){return this.rD.Hoe()}get fyj(){const b=this.rD;return b.uuf&&!b.TYi()}mri(b,h){v.ULS.shipAssertTag(6305616,307,il.a.nA(b));const r=SE.a(b.currentNode);if(il.a.isEmpty(b)){var A=vc.a.create(b.currentNode);b.Mu(8);y.AFrameworkApplication.va.Sf(A,fb.a.WJ,2,!0,null,null)}else b.Mu(8);(A=b.vN(1))&&b.Ac();this.rD.Nxj(this.sj.ke,
b.currentNode,A,-1,r,h)}kri(b){const h=new te.a;this.afb.restore(h);v.ULS.shipAssertTag(6305618,307,Mb.a.ji(h));this.sj.HW&&this.sj.HW.Gfc("internal");let r=-1;if(Object(Pb.a)(66,this.sj.Ed))r=this.sj.Ed.ka(Kh.a.Wma,-1);else{const A=this.Dvm(h.currentNode);r=A?A.clientWidth:r}this.rD.Nxj(this.sj.ke,h.parentNode,h.currentNode,r,null,b);this.B4i&&(this.afb.restore(h),Mb.a.ji(h)&&this.rD.f8i(h)&&(b=hg.a.Ze(h)))&&(this.sj.fMa=Tb.SelectionFactory.Ie(b,0))}Dvm(b){return b?(b=b?b.ug(this.ym.Lc):null)?b.htmlElement:
null:null}jZj(){const b=new te.a;this.afb.restore(b);return this.rD.f8i(b)}get FYj(){return!0}get tsd(){return!this.rD.JCa&&!this.rD.uuf}}Object(u.a)(jH,"InternalPasteExecutionManager",Fo,[]);class kH{constructor(b,h,r,A,L){this.Kkc=L;this.rD=b;this.hfa=h;this.eIb=r;this.Haa=A}create(b,h,r){return new jH(b,h,r,this.rD,this.hfa,Db.StaticActiveAppFrame.Aa().tb,this.eIb,this.Haa,this.Kkc)}}Object(u.a)(kH,"Factory",null,[662]);var SC;(function(b){b[b.unknown=0]="unknown";b[b.l5p=1]="differentBox4App";
b[b.Ysq=2]="sameBox4AppDifferentSession";b[b.Zsq=3]="sameBox4AppSameSession"})(SC||(SC={}));Object(u.b)("CopySource",SC);class kv{constructor(b,h,r,A,L){this.mE=L;this.rD=b;this.Fsh=h;this.dBk=r;this.sm=A}rho(b,h,r){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,307,Ee.a.Df(h));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(Pb.a)(Rt,r.Cwa));const A=r.Cwa;A.Zhc=this.rD.qBi(b);this.ZLn(b,A);let L=!1;this.sm.koa(h,Ia=>L=Ia)&&(A.nz|=8192,A.$Fe=1,L||(A.$Fe|=
2));const ba=this.ctn(A);var ra=new hb.GraphTransaction(7,fb.a.paste);ra.Eb(h.node);h.node.bK().qG.k4(8);ba?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",A.nz,A.browserName),this.mE?this.mE.Xzc("isExternal",!1):this.Qfj(),b=this.Fsh.create(h,A,ra)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",A.nz,A.Zhc,A.browserName),this.mE?this.mE.Xzc("isExternal",!0):this.Qfj(),kv.QLn(b),b=this.dBk.create(b,h,A,ra));r=new rt.a(r,Object(E.a)(b,
b.Txj,"pasteSetup"),null);r.$m("Paste");r.run()}ctn(b){return!this.rwn(b)&&3===b.Zhc}Qfj(){v.ULS.sendTraceTag(508143509,307,15,"PastePerformanceE2ETracker instance is nullish")}rwn(b){return 1===(b.nz&8192?1:0)}$Yi(b,h){v.ULS.shipAssertTag(6305624,307,Ee.a.Df(b));v.ULS.shipAssertTag(6305625,307,!!h);v.ULS.shipAssertTag(6305626,307,Object(Pb.a)(Rt,h.Cwa));const r=new hb.GraphTransaction(7,fb.a.Tfe);r.Eb(b.node);b=this.Fsh.create(b,h.Cwa,r);h=new rt.a(h,Object(E.a)(b,b.Txj,"pasteSetup"),null);h.$m("InternalPasteAtIp");
h.run()}ZLn(b,h){if(b){let r=!1,A=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?A=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||A)&&v.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",SC[h.Zhc],r,A)}}static QLn(b){b&&kv.QYk.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}kv.QYk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(u.a)(kv,"PasteCoordinator",null,[]);var Bx=e(820),Jz=e(1093),Gy=e(1092);class TE{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc=null){this.Kwa=b;this.Pda=h;this.wu=r;this.LAj=A;this.ta=L;this.Qeb=ba;this.J=ra;this.vho=Ia;this.Iia=Ta;this.VTb=ob;this.ZBa=nb;this.ub=Eb;this.soa=bc;this.Khi=100;this.Vrc=!1;this.XRe=null;this.D_e=!1;this.xMd=null;this.NId=this.HTa=!1;this.dhm=(Bc,Yc)=>{this.dismissFloatie(Yc.wdm)};this.lep=(Bc,Yc)=>{this.YLl(Bc,Yc)};this.FW=(Bc,Yc)=>{Yc.property===Sb.a.lastModifiedTime?
(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.VTb.chi.contains(fb.a.aQg)||this.Xsg(Yc)):v.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.m0a=(Bc,Yc)=>{this.Xsg(Yc)};this.ZOa=(Bc,Yc)=>{Yc.hhe||this.Xsg(Yc)};this.Rrj=()=>{Bx.a.instance.keyCode===pg.a.dHa&&this.Pda.JDj()};this.qkp()}qkp(){this.Pda.fVh(this.lep);this.Pda.RUh(this.dhm)}YLl(b,h){var r,A,L;(null===(A=null===(r=this.ub.ob)||
void 0===r?void 0:r.currentSelection)||void 0===A?0:A.nbd)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.Qeb.XZf(),1===this.vho.oMl(h.kkd)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.HTa?this.HTa=!1:this.EEo(),this.tnd(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",fb.a.sN(h.OZ)||"Unknown",h.correlationId),
v.ULS.sendTraceTag(40379588,307,50,b),$d.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ma.a,{name:"PasteCommand",int64:fb.a.sN(h.OZ)||"Unknown"}),Object.assign(new ma.a,{name:"CorrelationId",string:null===(L=h.correlationId)||void 0===L?void 0:L.toString()})]),this.R4b()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.D_e&&(this.HTa||(this.soa?null===(h=this.ZBa)||void 0===h?0:h.k5:this.Kwa.k5()))&&
(b&&(this.Qeb.XZf(),this.jak(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.xMd)),this.HTa=!b,this.cIe(),this.soa?y.AFrameworkApplication.va.Vb(fb.a.sUb,2):this.Kwa.dismissFloatie())}EEo(){this.NId||(this.XRe=this.wu.Pd,Re.a.addHandler(this.XRe.container,"scroll",Object(E.a)(this,this.G1b,"scrollHandler")),this.ta.f4(Object(E.a)(this,this.wpa,"resizeHandler")),this.NId=!0)}jak(){this.NId&&(Re.a.removeHandler(this.XRe.container,"scroll",
Object(E.a)(this,this.G1b,"scrollHandler")),this.ta.bja(Object(E.a)(this,this.wpa,"resizeHandler")),this.NId=!1)}R4b(){if(this.soa)this.ZBa.k5&&y.AFrameworkApplication.va.Vb(fb.a.sUb,2),y.AFrameworkApplication.va.Vb(fb.a.Qsd,2),this.Vrc=!1;else{const b=new Gy.a(0,y.AFrameworkApplication.isRtl);b.location=this.Qeb.kYa();this.Qeb.Xqn(b.location)?this.showFloatie(null,b):this.Pda.GPa(new Jz.a(!1))}}wpa(){this.soa?(y.AFrameworkApplication.va.Vb(fb.a.sUb,2),this.k0c()):this.R4b()}G1b(){this.soa?(y.AFrameworkApplication.va.Vb(fb.a.sUb,
2),this.k0c()):this.R4b()}tnd(){this.LAj.A7k(this.Rrj);this.Pda.WUh(Object(E.a)(this.Kwa,this.Kwa.F5d,"expandFloatie"));this.Pda.dVh(Object(E.a)(this,this.Wxj,"pastedFloatieStatusChange"));this.Iia.wv(this.ZOa);this.Iia.bA(this.m0a);this.Iia.yq(this.FW)}cIe(){this.LAj.VIo(this.Rrj);this.Pda.LJj(Object(E.a)(this.Kwa,this.Kwa.F5d,"expandFloatie"));this.Pda.TJj(Object(E.a)(this,this.Wxj,"pastedFloatieStatusChange"));this.Iia.VW(this.ZOa);this.Iia.jxa(this.m0a);this.Iia.nU(this.FW)}Wxj(b,h){this.D_e=
h.mbd;h.OZ&&(this.xMd=h.OZ);h.nGg&&this.Kwa.k5()&&this.R4b()}Xsg(b){b.node.kR||this.Pda.GPa(new Jz.a(!0))}showFloatie(b,h){h||(h=new Gy.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.Qeb.kYa());if(!h.location)return!1;this.HTa&&(this.HTa=!1,this.tnd());this.soa?y.AFrameworkApplication.va.Vb(fb.a.Qsd,2):this.Kwa.showFloatie(b,h);return!0}k0c(){if(!this.Vrc){const b=new Md.a(3,1,this.Khi,()=>{this.R4b()},215);vb.TaskManager.instance.pc(b);this.Vrc=!0}}}Object(u.a)(TE,"PasteFloatieEventManager",
null,[]);class ew{constructor(b,h){this.Gk=b;this.zM=h}oMl(b){return Mm.any(Mm.where(Mm.asEnumerable(ew.snp),h=>this.zM.Lcd(h)))?(b=this.Gk.Peb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}ew.snp=[fb.a.m1a.toString(),fb.a.n1a.toString(),fb.a.EFa.toString()];Object(u.a)(ew,"PasteFloatieFeatureSetBuilder",null,[]);class $n{constructor(){this.pFa=null;this.wwc=0}}Object(u.a)($n,"PasteFloatieAnchorData",null,[]);class Jw{constructor(b,h,r,A,L,ba=!1){this.zJb=null;this.pb=b;this.Mnb=h;this.zd=r;this.QCk=
A;this.N6e=L;this.d0e=ba}XZf(){this.zJb=null}kYa(){const b=this.$Mf(this.zJb)||this.A3h();if(!b){let h="null",r="null";if(this.zJb&&this.zJb.pFa){if(!this.zd.Pd)return v.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.zJb.pFa).getName();const A=this.zd.Pd.Dm(this.zJb.pFa);A&&(r=Object.getType(A).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}Xqn(b){if(!b)return!1;
const h=this.N6e.DSb(),r=this.QCk(this.zd.Pd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}A3h(){if(!this.pb||!this.pb.ob||!this.pb.ob.currentSelection)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.pb.ob.currentSelection.Ya,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.VJi(r);while(r&&Object(Pb.a)(wm.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";
const L=Object(ya.a)(wm.AParagraphNode,r);L&&(A=L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?A.length:b.cpBegin;b=Object.assign(new $n,{pFa:Object(ya.a)(89,(L?Object(ya.a)(89,L):Object(ya.a)(89,r))||b.node),wwc:h});return this.$Mf(b)}VJi(b){const h=new te.a;if(!b.anchor)return null;h.set(b);if(!h.Wd())return null;h.xd(11);return h.cR()?h.ic(2):null}$Mf(b){if(!b||!b.pFa)return null;this.zJb=b;const h=this.zd.Pd;if(!h)return v.ULS.sendTraceTag(51143188,
307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.HEi(b,h);if(!b)return null;y.AFrameworkApplication.isRtl&&this.N6e.k5()&&(b.x-=this.N6e.DSb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}HEi(b,h){h=h.ug(b.pFa);if(!h)return null;let r=null;if(Object(Pb.a)(wm.AParagraphNode,b.pFa)){const A=Object(ya.a)(50,h);if(!A)return null;try{r=this.Mnb.m4(b.wwc,A,0<b.wwc,!1,!1,!1),r.height+=this.d0e?Jw.Gvo:Jw.ghm}catch(L){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
L),r=null}}else Object(Pb.a)(Yv.a,b.pFa)&&(r=Object(ya.a)(143,h).NRf());r||(r=h.getBounds());return r}}Jw.ghm=2;Jw.Gvo=60;Object(u.a)(Jw,"PasteFloatiePositionProvider",null,[]);class Hh{constructor(b,h,r,A,L){this.RCa=b;this.Swb=h;this.Hho=r;this.Gho=A;this.KVb=L}}Object(u.a)(Hh,"PastedContentsPostProcessorParams",null,[]);class AJ{Cen(b,h,r,A,L,ba){b=this.Czm(b,h,L);r=this.tEm(r);if(!b||!r)return null;A=this.RLm(b,A,L);L=this.QLm(r);return new Hh(b,r,A,L,ba)}Czm(b,h,r){b=r?b:h;if(!Mb.a.ji(b))return null;
h=new Oi.a;h.Ad(b);return h}tEm(b){if(!Mb.a.ji(b))return null;const h=new Oi.a;h.Ad(b);hg.a.D5(h,!1,!1);return h}RLm(b,h,r){hg.a.Ze(b);let A=-1;rd.ParagraphReader.Wh(b)&&(A=r?h:0);hg.a.xe(b);return A}QLm(b){hg.a.Ze(b);const h=rd.ParagraphReader.Wh(b)?rd.ParagraphReader.textLength(b.currentNode):-1;hg.a.xe(b);return h}}Object(u.a)(AJ,"PastedContentsPostProcessorHelper",null,[]);class Ys{constructor(b,h){this.aJc=b;this.ywk=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get qwi(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get xyf(){return CommonUIStrings.l_ClipboardCut}get uag(){return CommonUIStrings.l_ClipboardCut_Mac}get qvf(){return CommonUIStrings.l_ClipboardCopy}get sag(){return CommonUIStrings.l_ClipboardCopy_Mac}get Dng(){return CommonUIStrings.l_ClipboardPaste}get vag(){return CommonUIStrings.l_ClipboardPaste_Mac}get S5(){return CommonUIStrings.l_ClipboardPasteText}get wag(){return CommonUIStrings.l_ClipboardPasteText_Mac}get rsf(){return this.ywk}get u8h(){return CommonUIStrings.l_ClipboardExtensionLink}get Upb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}Gri(){v.ULS.sendTraceTag(8716421,
307,50,null);ed.a.Zm(this.rsf,"_blank",void 0,"ClipboardAccessExtensionLink")}dja(b,h){let r=X.a.fm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=X.a.Yi||r);return r?String.format(h,"\u2318"):b}dispose(){this.aJc=null}vtg(b){this.Fci(b)}uGn(b){this.Fci(b)}Fci(b){this.aJc&&this.aJc(b)}}Ys.id="CopyPasteShortcutDialog";Ys.O5j="CopyPasteText";Object(u.a)(Ys,"ACopyPasteShortcutDialog",null,[11]);class Hy extends Ys{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Ys.O5j;var A=document.createElement("span");A.innerText=this.qwi;var L=document.createElement("span");L.className="UIFontBold";L.innerText=this.dja(this.xyf,this.uag);const ba=document.createElement("span");ba.className="UIFontBold";ba.innerText=this.dja(this.qvf,this.sag);const ra=document.createElement("span");ra.className="UIFontBold";ra.innerText=this.dja(this.Dng,this.vag);h.appendChild(A);h.appendChild(document.createElement("br"));
h.appendChild(L);h.appendChild(ba);h.appendChild(ra);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.zt||X.a.Hj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.dja(this.S5,this.wag),h.appendChild(r));b.appendChild(h);this.rsf?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.u8h,Re.a.addHandler(h,"click",Object(E.a)(this,this.Gri,"extensionLinkHandler")),r.appendChild(h),L=this.Upb.indexOf("{0}"),
-1!==L&&(A=this.Upb.substring(0,L),L=this.Upb.substring(L+3,this.Upb.length),A=document.createTextNode(A),L=document.createTextNode(L),r.insertBefore(A,h),r.appendChild(L)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new wg.StandardDialog;r.Md=0;r.$g=Ys.id;r.Yx(this.titleText,null,0,Object(E.a)(this,this.uGn,"legacyCopyPasteShortcutDialogHandler"),b);r.u$(Ys.O5j)}}Object(u.a)(Hy,"CopyPasteShortcutDialog",Ys,[]);class OG extends Ys{constructor(b,
h){super(b,h);h={};b=this.Sin;h.extensionStartText=this.dam;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.o9o;h.cutText=this.dja(this.xyf,this.uag);h.copyText=this.dja(this.qvf,this.sag);h.pasteText=this.dja(this.Dng,this.vag);4!==y.AFrameworkApplication.ta.Pb.gl&&(h.pasteTextOnly=this.dja(this.S5,this.wag));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Xf.a(!1,!1,!0);r.$g="CopyPasteInstallDialog";r.Md=0;r.Ue(1,this.Rin);r.YW(1);r.ti(b,Object(E.a)(this,
this.vtg,"reactCopyPasteShortcutDialogHandler"),h)}get o9o(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get Rin(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get Sin(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get dam(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Ncp(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(u.a)(OG,"ReactCopyPasteInstallDialog",Ys,[]);class oy extends Ys{constructor(b){super(b,null);this.Vaj="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.AYn;var r="";let A="";this.messageText&&(r=this.messageText.split(" {")[0],A=this.messageText.split("} ")[1]);h.startText=r;h.endText=A;h.cutText=this.uTl;h.copyText=this.vIl;h.pasteText=this.yho;
h.cutShortcutText=this.dja(this.vTl,this.DPn);h.copyShortcutText=this.dja(this.GIl,this.CPn);h.pasteShortcutText=this.dja(this.Bho,this.FPn);h.imageSrc=Wd.a.Bga("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.Qno;this.Vaj&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.axb,["onExecute"]:()=>{this.mGn()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Xf.a(!1,!1,!0);r.Md=0;r.$g="CopyPasteNoClipboardAccessDialog";r.ti(b,Object(E.a)(this,this.vtg,"reactCopyPasteShortcutDialogHandler"),h)}get AYn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get axb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get Qno(){return CommonUIStrings.l_DialogOk}get uTl(){return CommonUIStrings.l_CutString}get vTl(){return CommonUIStrings.l_CutShortcut}get DPn(){return CommonUIStrings.l_CutShortcut_Mac}get vIl(){return CommonUIStrings.l_CopyString}get GIl(){return CommonUIStrings.l_CopyShortcut}get CPn(){return CommonUIStrings.l_CopyShortcut_Mac}get yho(){return CommonUIStrings.l_PasteString}get Bho(){return CommonUIStrings.l_PasteShortcut}get FPn(){return CommonUIStrings.l_PasteShortcut_Mac}mGn(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");ed.a.Zm(this.Vaj,"_blank",void 0,"learnMoreLink")}}Object(u.a)(oy,"ReactCopyPasteNoClipboardAccessDialog",Ys,[]);class TC extends Ys{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.qwi;b.cutText=this.dja(this.xyf,this.uag);b.copyText=this.dja(this.qvf,this.sag);b.pasteText=this.dja(this.Dng,this.vag);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.zt||X.a.Hj)&&(b.pasteTextOnly=this.dja(this.S5,this.wag));this.rsf?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.u8h,["onExecute"]:A=>{this.Gri(A)}},r=this.Upb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.Upb.substring(0,r),b.suggestionSuffixElement=this.Upb.substring(r+3,this.Upb.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:Ys.id,["bodyControls"]:b};b=new Xf.a(!1,!1,!0);b.Md=0;b.$g=Ys.id;b.ti(this.titleText,Object(E.a)(this,this.vtg,"reactCopyPasteShortcutDialogHandler"),r)}}Object(u.a)(TC,"ReactCopyPasteShortcutDialog",
Ys,[]);class Cx{constructor(){this.ITa=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.$I}Wvf(b,h,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.ITa,r));this.ITa?r?new OG(b,h):new TC(b,h,y.AFrameworkApplication.J):new Hy(b,h,y.AFrameworkApplication.J)}static get instance(){return Cx._instance||(Cx._instance=new Cx)}}Cx._instance=null;Object(u.a)(Cx,"CopyPasteShortcutDialogFactory",null,[1171]);class lH{constructor(b,h,r,A,
L,ba,ra,Ia){this.jKh=this.Cuh=this.Vbf=!1;this.vVk=b;this.zd=h;this.LA=r;this.oc=A;this.yf=L;this.Mg=ba;this.jf=ra;Ia&&(this.jKh=Ia.$("ShouldLogExecCommandCopySuccess"))}get S2a(){return this.vVk}get Lcb(){return this.Cuh}set Lcb(b){this.Cuh=b;this.Mg.kXf=b}z2c(b){this.S2a.z2c(b);b||this.Fud(!0)}get j8l(){return this.S2a.Iyg}t_b(b){this.Lcb=!0;this.S2a.t_b(b,this.dLg)}reset(){this.Lcb=!1}paste(){var b=null;let h=null;if(!this.S2a.I5b){(b=this.zd.Pd)&&this.oc.Rg(b.lN);var r=this.LA.py;if(!r.Ee||!r.Ve.ql)return null;
h=r.Ve;b=this.yf.yz();this.Lcb=!0;r.jib()}r=null;try{h&&h.Emo(),r=b=this.S2a.Q2c(this.dLg,b)}catch(A){v.ULS.shipAssertTag(6305672,307,!1),this.aRi()}this.Lcb=!1;return r}fG(){var b=this.zd.Pd;b&&this.oc.Rg(b.lN);b=this.LA.py;if(!b.Ee||1!==b.Ve.mode)return!1;this.Lcb=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");Ca.Health.instance.recordKpiUsage(zn.a.rYd,0,zn.a.n5h,r);const A=this.S2a.PEf(this.dLg);h=!0;this.jKh&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
A,this.jf.aG);if(!A){const L=Object.assign(new Sa.a,{extendedProperties:r});Ca.Health.instance.recordKpiFailure(zn.a.rYd,zn.a.l5h,!0,!0,L)}}catch(r){v.ULS.shipAssertTag(6305673,307,X.a.Hj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",X.a.aG),h=!1}this.Lcb=!1;return h?!0:!1}Fud(){if(this.Vbf)return!0;var b=this.LA.py;if(!b.Ee||!b.Ve.ql)return!1;const h=b.Ve;b=this.yf.yz();this.Lcb=!0;const r=new NG.a(b);let A=!1;try{A=this.S2a.Fud(b,()=>{h.mhc()},
()=>{h.eGa()})}catch(L){}r.restore();this.Lcb=!1;A?this.Vbf=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",X.a.aG),this.aRi());return A}aRi(){this.Vbf=!1;if(y.AFrameworkApplication.nNp)Cx.instance.Wvf(null,null);else{const b=new wg.StandardDialog;b.Md=0;b.tU(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get dLg(){const b=this.yf.ntb();return b?b.Op:null}}Object(u.a)(lH,"SystemClipboard",null,
[660]);class lv{constructor(b,h,r){this.TSd=!1;this.qTd=this.iY=this.Exh=this.sQe=this.iBd=null;this.qHh=!1;this.elo=A=>{1===A?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.hQe)),this.gec&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.gec)),ed.a.Zm(this.PWe+this.W4e,"_blank",void 0,"ChromeCCPInstallDialog"))):A||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.hQe))};this.hQe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.PWe=b.rb("ChromeClipboardAccessExtensionLink");this.i5a=h;this.Gk=r;this.W4e=b.rb("ChromeClipboardAccessExtensionId");this.bYk=b.$("UseGetClipboardDataIsEnabled");this.AGh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.gec=!1;b.$("CcpInstallDialogIsEnabled")&&y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.$I&&(this.gec=OG.Ncp()||b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.gec));this.qHh=null===b||void 0===b?void 0:
b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ResetExtensionIdForMSFTExtensionFailure",!1);this.XJc=null}z2c(b){b?this.iY=!0:(this.iY=null,chrome.runtime&&chrome.runtime.sendMessage?(this.XJc=this.i5a.U1d,this.i5a.Q2b?(this.TSd=this.bYk,this.l6h()):(this.TSd=!0,this.l6h(),v.ULS.sendTraceTag(19256732,307,50,V.a.create().toString()))):(this.g3b(),this.iY=!1))}get Iyg(){return this.iY}get I5b(){return this.qTd}Fud(){return!0}PEf(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=
ed.a.dRb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}XKf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const A=this.Gk.tQj(!!h,!!r,b);let L=null;if(3===A){if(!b)return null;h=this.Gk.wFf(b);(h=this.Gk.Wri(h))&&(b+=h);L=this.Gk.Peb(b)}else 2===A?L=this.Gk.qng(r,!0):1===A&&(L=this.Gk.Peb(h));return L}Q2c(b,h){if(this.I5b)h=this.XKf(this.sQe),this.sQe=null;else{if(!this.iBd)return h;
b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.iBd;h=b.body;this.iBd=null}return h}t_b(b){const h=V.a.create();this.Exh=h;this.i5a.Q2b?v.ULS.sendTraceTag(7377737,307,50,h.toString()):v.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.I5b?"getClipboardData":"paste";chrome.runtime.sendMessage(this.XJc,r,A=>{h.equals(this.Exh)?this.I5b?this.sQe=A:this.iBd=A:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&
(this.Z3l(),this.i5a.Q2b?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}g3b(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.gec?b=this.PWe+this.W4e:this.hQe&&(b=this.PWe+this.XJc);Cx.instance.Wvf(this.elo,b,this.gec)}Z3l(){this.i5a.aMj();this.g3b()}KRj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}Lul(){const b=V.a.create();this.i5a.Q2b?v.ULS.sendTraceTag(592491466,307,
50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.XJc,{command:"getAvailableCommands"},h=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Pb.a)(Array,h)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.qTd=-1!==Array.indexOf(h,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.qTd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.qHh&&this.i5a.aMj(),this.qTd=!1)})}l6h(){const b=V.a.create();this.i5a.Q2b?v.ULS.sendTraceTag(7726105,307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.TSd&&this.Lul();this.KRj(this.XJc,h=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.iY=!0:(h?"ping"!==h&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:
null):v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.g3b(),this.iY=!1);this.TSd&&!this.I5b&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}Wej(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.AGh&&(b&&Ca.Health.instance.recordKpiSuccess(lv.YBh,
null),h&&Ca.Health.instance.recordKpiSuccess(lv.VBh,null))}dLn(){this.AGh&&(Ca.Health.instance.recordKpiUsage(lv.YBh,1,lv.zmh,null),Ca.Health.instance.recordKpiUsage(lv.VBh,1,lv.zmh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.i5a.Q2b;this.KRj(this.W4e,h=>{this.Wej(b,!!h)})}else this.Wej(!1,!1)}}lv.YBh="OfficeOnlineExtensionInstallationStatus";lv.VBh="OfficeClipboardExtensionInstallationStatus";lv.zmh="wwccp";Object(u.a)(lv,"ChromeSystemClipboardAccessManager",null,[675]);class Ov{constructor(b,
h){this.iY=null;this.jf=b;this.za=h;this.Xuk=!this.za.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.za.$("BlockCopyCutOnFirefoxIsEnabled");this.USk=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}z2c(b){this.Xuk&&b&&this.jf.Hj?(this.g3b(),this.iY=!1):this.iY=!0}get Iyg(){return this.iY}get I5b(){return!1}PEf(b){return ed.a.dRb(b,"copy")}Q2c(b,h){ed.a.dRb(b,"paste");return h}t_b(b){b()}Fud(b,h,r){if(this.jf.r9)return this.USk&&(this.iY=!1),!1;h();r();b=this.Q2c(b.ownerDocument,b);
h=b.innerHTML;b.innerHTML=qb.a.create().toString();r();b=this.Q2c(b.ownerDocument,b);return this.iY=b=h===b.innerHTML}g3b(){Cx.instance.Wvf(null,null)}}Object(u.a)(Ov,"DefaultSystemClipboardAccessManager",null,[675]);class fB{constructor(b,h,r){this.iY=this.vfa=this.rbc=this.$ra=this.D6a=this.eBd=null;this.Gk=h;this.M6a=r;this.DKk=b.sc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.ATk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}z2c(b){this.ATk&&
b&&(this.iY=!0)}get Iyg(){return this.iY}get I5b(){return!1}PEf(b){return b?ed.a.dRb(b,Fd.a.fG):!1}Q2c(b,h){this.D6a&&(h=this.D6a,this.D6a=null);return h}t_b(b,h=null){if(b&&h){this.eBd=b;this.rbc=h;$addHandler(this.rbc,Fd.a.paste,Object(E.a)(this,this.lsj,"onPasteEvent"));this.vfa=this.$ra=null;if(this.W9j(this.rbc)){if(this.vfa&&0<this.vfa.length&&(!this.$ra||this.Gk.fJe(this.$ra))){this.M6a.Vbi(this.vfa,Object(E.a)(this,this.S5n,"onImageConverted"));this.D6a&&!this.D6a.hasChildNodes()&&v.ULS.sendTraceTag(42592151,
307,50,"pastedContentDom has no child nodes.");return}this.$ra&&this.$ra.innerHTML&&((this.D6a=this.CUi(this.$ra.innerHTML))&&!this.D6a.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),eb.a.fH(this.$ra))}this.hui()}else b&&b()}Fud(b){return this.iY=b=this.W9j(b.ownerDocument)}lsj(b){try{b&&b.rawEvent&&((this.$ra=b.rawEvent.target)&&this.$ra.id&&-1<this.$ra.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.$ra.id),this.$ra=null):this.vfa=this.xCm(b.rawEvent))}catch(h){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+h.toString())}}S5n(b){b&&(this.M6a.LYj&&(b=String.format('<img src="{0}">',b)),this.D6a=this.CUi(b));this.hui()}hui(){this.rbc&&($removeHandler(this.rbc,Fd.a.paste,Object(E.a)(this,this.lsj,"onPasteEvent")),this.rbc=null);this.eBd&&(this.eBd(),this.eBd=null)}xCm(b){let h=null;(b=this.Gk.kAi(b))&&({oXf:h}=this.Gk.v9j(b,this.DKk,this.M6a.qij));
return h}W9j(b){return ed.a.dRb(b,Fd.a.paste)}CUi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}g3b(){}}Object(u.a)(fB,"EdgeSystemClipboardAccessManager",null,[675]);class WJ{constructor(b,h,r,A){this.za=b;this.mwk=h;this.Gk=r;this.jf=A}create(){let b=null;y.AFrameworkApplication.qGg()&&this.jf.zt&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new lv(this.za,this.mwk,this.Gk),this.za.$("LogChromeExtensionInstallationStatusIsEnabled")&&
b.dLn()):this.za.$("EdgeContextMenuPasteFixIsEnabled")&&this.jf.Fv?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),b=new fB(this.za,Xa.a.instance.resolve("Box4.IClipboardDataHelper"),Xa.a.instance.resolve("Box4.IProcessImageStrategy"),Xa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new Ov(this.jf,this.za));return b}}Object(u.a)(WJ,"SystemClipboardAccessManagerFactory",
null,[659]);class Iy{I9l(b){return b}}Object(u.a)(Iy,"DeleteTableSegmentStrategy",null,[658]);var Rh=e(462),Bp=e(1043);class Zi{get Hs(){return px.a.hTb}get gm(){return null!=this.s7g?this.s7g:this.s7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}get Q5(){return this.gm.Hs}get Jc(){return $g.a.instance}get lE(){return null!=this.D7g?this.D7g:this.D7g=Xa.a.instance.resolve("Box4.IParagraphIndentationReader")}lWc(b,h,r,A,L,ba,ra){let Ia=2;if(!b.Ee)return 2;const Ta=b.ub;if(!Ta)return this.Jc.qc(pf.a.$e,
{["Reason"]:uf.a.xia}),8;if(y.AFrameworkApplication.J.$("Box4PartialPromoteDemoteIsEnabled")){b=this.n4h(h===fb.a.uK,r,!0);if(1===A)return b?32:8;b&&(Ia=Bp.a.Cwc(h,r,A,L,ba,ra))}else Ia=Bp.a.Cwc(h,r,1,L,ba,ra),1!==A&&32===Ia?(b.ub.nre(),b=new hb.GraphTransaction(15),b.Eb(r.view.Fd),Ia=this.n4h(h===fb.a.uK,r,!1)?Bp.a.Cwc(h,r,A,L,ba,ra):8,b.dispose()):1!==A&&8===Ia&&(b.ub.nre(),this.MDl(h,r,Ta));return Ia}n4h(b,h,r){h=h.view.ub;if(!h||!h.ob.currentSelection)return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NYb}),
!1;if(h.ob.IN)return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.tuf}),!1;h=Rh.OutlineElementGeneralizer.lna(h.ob,!1);if(!h)return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.R5d}),!1;let A=!1;for(let L=0;L<h.length;L++){const ba=h.getContext(L),ra=new te.a;ra.set(ba.node);Ee.a.uw(ra);if(!Mb.a.ji(ra))if(r)continue;else return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.tQb}),!1;if(b?!this.Hs.fOb(ra):!this.Hs.Kgc(ra))if(r)continue;else return this.Jc.qc(pf.a.tjc,{["Reason"]:uf.a.Eqf}),!1;A=!0}return r?A:!0}MDl(b,h,r){const A=
new hb.GraphTransaction(15);try{A.Eb(h.view.Fd);h=!0;const L=Rh.OutlineElementGeneralizer.lna(r.ob,!1);for(let ba=0;ba<L.length;ba++){const ra=L.getContext(ba),Ia=new te.a;Ia.set(ra.node);Ee.a.uw(Ia);if(!Mb.a.ji(Ia))h=!1;else if(b===fb.a.uK?this.Hs.fOb(Ia):this.Hs.Kgc(Ia))switch(h=!1,b){case fb.a.uK:this.Hs.Z0a(Ia,-1,0);break;case fb.a.dT:this.Hs.H0c(Ia,1)}}if(h){const ba=r.ob.currentSelection;for(r=0;r<ba.length;r++){const ra=ba.K(r);if(ra.nm){const Ia=this.lE.wtb(ra.node),Ta=Ia.Bja;if(b===fb.a.uK?
Ia.NC>Ta:Ia.NC<18*Ta){const ob=new te.a;ob.set(ra.node);this.Q5.Jxa(ob,1,b===fb.a.uK?Ia.NC>=2.5*Ta?Ia.NC-2*Ta:Ta:Ia.NC<16*Ta?Ia.NC+2*Ta:18*Ta)}}}}}finally{A&&A.dispose()}}}Object(u.a)(Zi,"IndentationActorExtension",null,[657]);var ut=e(772),gB=e(1192);class UE{constructor(b,h){this.Vp=new Ai.DictionaryPropertySet;this.lNd=new Ai.DictionaryPropertySet;this.sHb=!1;this.dJa=this.zjb=null;this.Faa=b;this.Znh=h}get hCb(){return null!=this.z$g?this.z$g:this.z$g=Xa.a.instance.Wa("Box4.ITextFormattingCommands")}get Qj(){return null!=
this.o0g?this.o0g:this.o0g=Xa.a.instance.resolve("Box4.IFormattingEditor")}get kc(){return null!=this.Fbh?this.Fbh:this.Fbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Yzb(){this.sHb||(0<this.sZa.bN()&&(this.lNd=this.Vp.clone()),this.Vp.xxe(),this.zjb=null,this.PGo())}FIl(b){var h;const r=null!==(h=pb.a.uu(b))&&void 0!==h?h:pb.a.O9d(b.node,b.cpBegin,-1);!r.cache.tG&&(b=r.qp)&&(h=new Ai.DictionaryPropertySet,h.Yu(b),h.Yu(this.Vp),h.hasProperty(Tc.a.wy)&&(this.zjb=r.paragraph.ed),this.Vp=h)}hasProperty(b){return this.Vp.hasProperty(b)}V8c(){return 0<
this.Vp.bN()}get sZa(){return this.Vp}freeze(){this.sHb=!0}RQa(){this.sHb=!1}dK(b,h){return this.sZa.ka(b,h)}tE(b){this.Vp.setValue(Sb.a.fontSize,this.Qj.Hhc(b));this.f6();Qa.a.Ttg(this.lNd,this.Vp)}fontSize(){return this.Vp.ka(Sb.a.fontSize,Qa.a.AL)}UAe(b){this.Vp.setValue(Sb.a.font,b);this.Znh&&this.Znh.execute(h=>{null==h?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.UAe(this.Vp)});this.Faa&&this.Faa.enabled&&(Cd.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.Faa.V0o(this.Vp,b));this.f6();Qa.a.Ttg(this.lNd,this.Vp)}nEg(b){this.Vp.setValue(Rc.a.mf,b);this.Faa&&this.Faa.enabled&&(Cd.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.Faa.E6o(this.Vp,b));this.f6()}Uy(b){b=Sm.a.instance.sma(Fg.a.instance.ob.currentSelection.Ya.node,b);this.Vp.setValue(Sb.a.fontColor,b);this.f6();Qa.a.Ttg(this.lNd,this.Vp)}pma(){this.Vp.setValue(Sb.a.fontColor,Xl.a.auto);this.f6()}fontColor(){return this.Vp.ka(Sb.a.fontColor,Xl.a.nil)}lGa(b){this.Vp.setValue(Sb.a.highlight,
parseInt(b,16));this.f6()}kZd(){this.Vp.setValue(Sb.a.highlight,Xl.a.auto);this.f6()}isBold(){return this.Vp.ka(Sb.a.bold,!1)}GP(b){this.Vp.setValue(Sb.a.bold,b);this.f6()}isItalic(){return this.Vp.ka(Sb.a.italic,!1)}cC(b){this.Vp.setValue(Sb.a.italic,b);this.f6()}isUnderline(){return this.Vp.ka(Sb.a.underline,!1)}z$(b){this.Vp.setValue(Sb.a.underline,b);this.Vp.setValue(Sb.a.underlineType,b?Qa.a.JCb:Qa.a.oX);this.f6()}underlineType(){return this.Vp.ka(Sb.a.underlineType,Qa.a.oX)}Lpa(b){b<Qa.a.JCb||
b>Qa.a.oX||(this.Vp.setValue(Sb.a.underline,b!==Qa.a.oX),this.Vp.setValue(Sb.a.underlineType,b),this.f6())}isSuperscript(){return this.Vp.ka(Sb.a.superscript,!1)}Mxa(b){this.Vp.setValue(Sb.a.superscript,b);b&&this.isSuperscript()&&this.Vp.setValue(Sb.a.subscript,!1);this.f6()}isSubscript(){return this.Vp.ka(Sb.a.subscript,!1)}oQa(b){this.Vp.setValue(Sb.a.subscript,b);b&&this.isSubscript()&&this.Vp.setValue(Sb.a.superscript,!1);this.f6()}isStrikethrough(){return this.Vp.ka(Sb.a.strikethrough,!1)}Jpa(b){this.Vp.setValue(Sb.a.strikethrough,
b);this.f6()}isDoubleStrikethrough(){return this.Vp.ka(Tc.a.Ew,!1)}PAe(b){this.Vp.setValue(Tc.a.Ew,b);this.f6()}Tzi(){return this.Vp.ka(Tc.a.wy,null)}Hgb(b,h){this.Vp.xxe();this.Vp.setValue(Tc.a.wy,b.id);this.zjb=h.ed;this.f6()}w$(b){let h=Sb.a.bE;const r=ut.a.ted(b);switch(r){case 1:h=Rc.a.UWb;break;case 2:h=Rc.a.VWb}this.Vp.setValue(Rc.a.r_a,r);this.Vp.setValue(h,b);this.f6()}language(){let b=Sb.a.bE;switch(this.Vp.ka(Rc.a.r_a,0)){case 1:b=Rc.a.UWb;break;case 2:b=Rc.a.VWb}return this.Vp.ka(b,0)}q3o(b){this.Vp.setValue(Rc.a.noProof,
b);this.f6()}aWb(){return this.Vp.ka(Rc.a.noProof,!1)}Zun(){return this.Vp.hasProperty(Rc.a.noProof)}ytn(){return this.Vp.hasProperty(Sb.a.bE)||this.Vp.hasProperty(Rc.a.UWb)||this.Vp.hasProperty(Rc.a.VWb)}f6(){if(X.a.LBc){Object(Vb.a)();var b=Fg.a.instance.ob.currentSelection.Ya,h=b.node;if(h===this.dJa)this.dJa.vm(16,!0);else{this.dJa=h;h=this.dJa.R2();try{this.dJa.m1(b.cpBegin).NZa=!0}finally{h&&h.dispose()}}}}PGo(){if(X.a.LBc&&this.dJa){var b=0,h=this.dJa.R2();try{for(let r=this.dJa.ra.length-
1;0<=r;r--){const A=this.dJa.ra.jc(r);A.NZa&&(A.NZa=!1,b++,A.isEmpty&&this.dJa.ra.gxa(r))}}finally{h&&h.dispose()}this.dJa=null}}GGl(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.ra.Vh(b.cpBegin);return!!b&&b.NZa}Ilf(b){if(this.hCb){this.freeze();var h=new hb.GraphTransaction(7);h.Eb(b.node);this.hCb.WAe(b);this.RQa();this.Yzb();h.dispose()}}WQf(b){const h=rd.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!D.a.Py(h.charCodeAt(b.cpBegin))&&gB.a.instance.Lab(h,b.cpBegin-1)!==b.cpBegin&&
Ee.a.twb(b)?(b=Ee.a.M8(b,!1))?1<b.length||Ee.a.Rm(b.Ya)?b:null:null:null}}Object(u.a)(UE,"InsertionPointFormatting",null,[656]);class UC{constructor(b,h,r,A,L,ba){this.OSn=b;this.Ewa=h;this.oya=r;this.Bq=A;this.vK=L;this.lmg=ba;this.s5i=!1;this.qjd=(ra,Ia,Ta)=>{if(1===Ta)return 32;ra=this.Kh.ka(Sb.a.hU,Xl.a.gC);(new Vs(UC.Ypb,fb.a.Wzc)).pBb(ra);return 32};this.Qwc=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;ra=this.Kh.ka(Sb.a.hU,Xl.a.gC);ra=Xl.a.zB(ra);this.Nha(this.lmg);this.lmg.dea=ra;this.vK.YCb(ra);
ra=this.lmg.Gsb(this.Kh,Ze.a.tWa);if(!ra)return 8;nb.MenuItems=ra;v.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.Qlf=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;Ia=this.Bq.Vc(15);Ia.Eb(this.Kh);switch(ra){case fb.a.qZd:this.Kh.hasProperty(Sb.a.hU)&&this.Kh.setValue(Sb.a.hU,Xl.a.gC);break;case fb.a.e2a:nb=this.oya.sma(this.Kh,nb);this.Kh.setValue(Sb.a.hU,nb);break;case fb.a.Wzc:ra=this.oya.sma(this.Kh,nb),this.Kh.setValue(Sb.a.hU,ra),this.vK.bKa(nb)}Ia.dispose();
return 32}}Nha(b){this.s5i||(b.bH(2,fb.a.qZd),b.bH(3,fb.a.e2a),b.bH(4,fb.a.e2a),b.bH(5,fb.a.Wzc),b.bH(6,fb.a.qjd),b.q8a(this.OSn,1),this.s5i=!0)}mc(){const b=y.AFrameworkApplication.va;b.nb(fb.a.qjd,ic.a.view,this.qjd,1028);b.nb(fb.a.Qwc,ic.a.view,this.Qwc,1028);b.nb(fb.a.e2a,ic.a.view,this.Qlf,1028);b.nb(fb.a.qZd,ic.a.view,this.Qlf,1028);b.nb(fb.a.Wzc,ic.a.view,this.Qlf,1028);b.Oc(fb.a.Qwc,1127)}get Kh(){return this.Ewa.value}}UC.Ypb="Page";Object(u.a)(UC,"PageColorActor",null,[]);var Tp=e(480);
class hB extends op.a{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){super();this.Jbc=this.Wo=this.zSa=null;this.Poo=(Eb,bc)=>{bc=this.mAa.Fue(this.zSa,bc);Eb.fj(this.lkm);return bc};this.lkm=(Eb,bc)=>{if(this.Wo.moveNext())return Eb=this.Wo.currentNode,12!==Eb.type||Eb===this.zSa.node?!0:this.mAa.tld(Eb,bc);this.bol();Eb.fj(this.qkm);return!0};this.qkm=(Eb,bc)=>{if(this.Wo.moveNext()){const Bc=this.Wo.currentNode;return 12!==Bc.type?!0:Bc===this.zSa.node?(Eb.fj(this.Qoo),!0):this.mAa.tld(Bc,bc)}return!1};
this.Qoo=(Eb,bc)=>{this.mAa.Gue(this.zSa,bc);return!1};this.init(b);this.$m(nb);this.bvb(Ia,h,A,L,ba);this.ZP=ba;this._context=r;this.pb=Ta;this.gf=ob;this.mAa=ra;this.jC=0}run(){this.rrf();this.jC||this.v8o();1===this.jC&&this.$po();2===this.jC&&this.Eqp();3===this.jC&&this.Ifm()}rrf(){this.pb.ob&&this.pb.ob.currentSelection?1===this.behavior&&(this.mAa.rrf(this._context)?this.Vt=32:this.Vt=2,this.jC=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.Vt=2,this.jC=3)}v8o(){this.Gnl();
this.mAa.PEg(this.zSa)?(this.$ml(),this.jC=1):(this.Vt=8,this.jC=3)}$po(){this.ZE||new rt.a(this,this.Poo,this.ZP);do if(this.ZE.run(),this.ZE.Gha&&!this.Ei)return;while(this.ZE.Gha);this.fZd();this.jC=2}Eqp(){this.mAa.oLg(this)?this.Vt=32:this.Vt=8;this.jC=3}Ifm(){this.Kxa()}Gnl(){let b=this.pb.ob.currentSelection;if(b=this.gf.Xk(b,!0,!1))this.zSa=b.Ya;this.zSa&&this.zSa.node&&(this.Jbc=this.mAa.iKi(this.zSa.node))}$ml(){if(!this.Jbc)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=
new Oi.a;b.set(this.zSa.node);b.Ib(this.Jbc.type);this.Wo=zp.a.$u(b,this.Jbc);this.Wo.Oq(Object(E.a)(this.mAa,this.mAa.gBc,"spellErrorFilter"),null)}bol(){if(!this.Jbc)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Oi.a;b.set(this.Jbc);this.Wo=zp.a.Zr(b);this.Wo.Oq(Object(E.a)(this.mAa,this.mAa.gBc,"spellErrorFilter"),null)}}Object(u.a)(hB,"ProofingWholeDocumentOperation",op.a,[]);var VE=e(284);class mH extends Fi{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=
null}}Object(u.a)(mH,"ContextMenuRootProperties",Fi,[]);var XJ=e(2007);class nH{constructor(b){const h=new mH;h.ImageSideArrow=y.AFrameworkApplication.mr;h.ImageSideArrowClass=Ye.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=fb.a.Xte.toString();this.bNh=new XJ.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.K$.nJ=r});this.K$.refresh();y.AFrameworkApplication.va.qa(wb.a.showContextMenu,dd.a.frame,qf.ActionManager.qg);
y.AFrameworkApplication.va.qa(wb.a.IAc,dd.a.frame,qf.ActionManager.qg)}get K$(){return this.bNh}dispose(){this.K$&&(this.K$.dispose(),this.bNh=null)}showContextMenu(b,h){this.e3b(b,h.clientPoint,h.Og)}Mgb(b,h,r){ed.a.ane(this.K$.f8a?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Db.StaticActiveAppFrame.Aa().hjm();this.Lw();this.K$.Mgb(b,h,r);this.K$.f8a?y.AFrameworkApplication.va.Vb(wb.a.IAc,2):y.AFrameworkApplication.va.Vb(wb.a.showContextMenu,2)}e3b(b,h,r){this.Mgb(b,new Sys.UI.Bounds(h.x,
h.y,0,0),r)}Lw(){this.K$.root.qo()}B8(){return this.K$.B8()}IAc(b,h,r,A){const L=this.K$;let ba=!1;r=Object(ya.a)(Bw,r);L.f8a=r;A.sGa(b,h);L.khf?r&&(r.llo(L,h),ba=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",A.VSl()),L.f8a=null);return ba}}Object(u.a)(nH,"AContextMenuController",null,[676,11]);class Kz{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=Kz.Z5l;this.Suggestions=this.TypeId=this.TraceId=
null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Kz.Z5l=[];Object(u.a)(Kz,"Critique",null,[]);class iB{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(u.a)(iB,"Suggestion",null,[]);var oH=e(621);class pH extends Sys.EventArgs{constructor(b,h,r,A,L,ba){super();
this.QDk=b;this.WFk=h;this.XFk=r;this.QMe=A;this.lD=L;this.Iib=ba}}Object(u.a)(pH,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var Jy=e(325);class qu{constructor(b,h,r){this.JUe=b;this.xo=h;this.sa=r}Wbi(b){const [h,r,A]=this.UOi(b);return this.KCi(h,r,A)}pon(b){return $a.a.getTypeNameFor(b.content)===Jy.a.getTypeName()}KCi(b,h,r){if(r&&this.pon(r)){if(this.tfc(r.content))return null;const L=r.content;var A=new Kz;A.ExplanationTitle=L.explanationTitle;A.Suggestions=this.ZSm(r);A.CategoryTitle=
L.categoryName;A.TypeId=L.typeId;A.CritiqueActions=L.critiqueActions;A.Priority=L.priority;r=this.JUe.create(A);A=L.context;r.token=A.substring(L.range.start,L.range.start+L.range.length);r.lcid=Wg.a.Vg(L.language).LCID;r.originalText=A;return new oH.a(b,h,r)}return null}ZSm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new iB,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}tfc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===
b||70===b}UOi(b){const h=this.xo.u6c(b,0),r=b.cpBegin,A=b.cpEnd,L=Ee.a.Df(b);b=rd.ParagraphReader.text(b.node,0);for(const ba of h)if(L){if(ba.Mc<=r&&ba.end>=A)return[ba.Mc,ba.end,ba.intent]}else if(ba.Mc<=r&&ba.end>=r&&D.a.Qai(b,ba.end,A))return[ba.Mc,ba.end,ba.intent];return[null,null,null]}static rF(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}NUf(b,h,r){const [A,L,ba]=this.UOi(b);ba&&this.sa.raiseEvent(qu.s_h,
new pH(b,A,L,h,ba,r))}U6k(b){this.sa.addHandler(qu.s_h,b)}acm(b,h,r){b=this.xo.zmc(b,0,0,b.characterData.length);for(let A=0;A<b.count;A++){const L=b.K(A);if(L.intent){const ba=L.intent;if(ba.content&&(0==ba.content.priority||1==ba.content.priority)&&L.Mc>=h&&(!r||r(L.intent)))return this.KCi(L.Mc,L.end,L.intent)}}return null}}qu.s_h="augloopProofingContextMenuActionEventKey";Object(u.a)(qu,"AugLoopProofingErrorDetailHelper",null,[]);class mv{}mv.cxc="faProofing";mv.Nni="EditorMenuSection";Object(u.a)(mv,
"ContextMenuControlId",null,[]);class Ky{constructor(b){this.gf=b}rrf(b){b=Object(ya.a)(iv.a,b);return!!b&&!!b.view&&b.view.Ee}PEg(){return!0}Fue(){return!0}tld(){return!0}Gue(){}oLg(){return!0}gBc(b){if(b.yt)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}iKi(b){if(!b||!this.gf)return b;const h=new Oi.a;h.set(b);if(this.gf.uw(h)){for(;!h.yt;)h.Ac();return h.currentNode}return b}}Object(u.a)(Ky,"SimpleProofingWholeDocumentCallBacks",null,[494]);class VC{constructor(b){this.value=b}}Object(u.a)(VC,
"RefBool",null,[]);class Lz{constructor(){this.I2c=this.JYb=null;this.L$j=new VC(!1)}}Object(u.a)(Lz,"FindNextErrorOperationParam",null,[]);class WE extends Ky{constructor(b,h,r,A){super(h);this.jp=b;this.ySc=r;this.tuk=A}Fue(b,h){return!this.w9f(b.node,b.cpBegin,h)}tld(b,h){return!this.w9f(b,0,h)}Gue(b,h){this.w9f(b.node,0,h);Object(ya.a)(Lz,h)}w9f(b,h,r){r=Object(ya.a)(Lz,r);if(rd.ParagraphReader.lc(b)&&!b.zN)if(pb.a.uu(vc.a.jd(b,h)).cache.aWb)r.L$j.value=!0;else{if(qu.rF())return h=this.tuk.acm(b,
h,this.ySc),null!=h?(r.JYb=h,r.I2c=b,!0):!1;const A=this.jp.X8(b);for(let L=0;L<A.length;L++){const ba=A[L];if(ba.Mc>=h&&!ba.errorDetails.Icb()&&(!this.ySc||this.ySc(ba.errorDetails)))return r.JYb=ba,r.I2c=b,!0}return!1}}}Object(u.a)(WE,"FindNextErrorCallbackSteps",Ky,[]);class WC{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd){this.EAl=(Jd,ie,re,me,Sd)=>{ie=this.pb.ob.currentSelection;if(!ie)return this.Jd.qc(pf.a.$e,{["Reason"]:uf.a.Mo}),2;ie=this.gf.Xk(ie,!0,!1);return this.ga.Sf(ie.Ya,
Jd,re,!1,me,Sd)};this.uco=(Jd,ie,re)=>{if(1===re)return this.ga.Vb(fb.a.w$,1);this.ZIk().YGg();return 32};this.CLa=(Jd,ie,re)=>{if(1===re)return 32;Yb.a.mark(4670);re=this.jp.Eua(ie);if(this.uHe(re))return 8;ie=ie.node;const me=this.Zc.Vc(15);let Sd=re.Mc;" "===rd.ParagraphReader.text(ie).charAt(Sd-1)&&Sd--;me.Eb(ie);const cf=this.ee.lf(vc.a.createTextRange(ie,0<re.Mc?re.Mc-1:0,re.end),"",!0,!1);this.pb.Uc(Tb.SelectionFactory.Ie(ie,cf+Sd));me.dispose();re.errorDetails.vCb(Jd);Yb.a.mark(4671);return 32};
this.IDa=(Jd,ie,re)=>{if(1===re)return 32;v.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(qu.rF())return this.Xib.NUf(ie,null,Tp.b.IgnoreOnce),32;Yb.a.mark(4670);re=this.jp.Eua(ie);if(this.uHe(re))return 8;ie=ie.node;const me=this.Zc.Vc(15);me.Eb(ie);this.jp.Nzb(ie,[re],!0);ie.setValue(Sb.a.quf,!0);me.dispose();re.errorDetails.vCb(Jd);Yb.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.pNn(re);this.R6a.aVi(re,ie,!0);return 32};
this.TIl=(Jd,ie,re)=>{var me,Sd=!this.sm.cda(ie);this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(ie)&&(Sd=!1);if(1===re||!Sd)return Sd?32:8;this.ga.Vb(fb.a.iya,2);Yb.a.mark(4670);Sd=this.xum(Jd);if(0>Sd)return 8;if(qu.rF())return this.Xib.NUf(ie,Sd,Tp.b.Apply),32;re=this.jp.Eua(ie);if(this.uHe(re))return 8;ie=ie.node;var cf=re.errorDetails.suggestions;if(!cf)return this.Jd.qc(pf.a.kRb,{["Reason"]:"NoSuggestionsFound"}),Yb.a.mark(4671),8;Sd=Sd<cf.length?cf[Sd]:null;if(!Sd)return this.Jd.qc(pf.a.kRb,
{["Reason"]:"RequestedSuggestionIsNull"}),Yb.a.mark(4671),8;(null===(me=If.a.Gd())||void 0===me?0:me.pn)&&If.a.Gd().Qk.uI(ie);Sd=Sd.replace("  "," \u00a0");me=this.Zc.Vc(15);me.Eb(ie);cf=this.ee.lf(vc.a.createTextRange(ie,re.Mc,re.end),Sd,!0,!1,fb.a.iya);this.pb.Uc(Tb.SelectionFactory.Ie(ie,re.Mc+Sd.length+cf));me.dispose();re.errorDetails.vCb(Jd);Yb.a.mark(4671);this.MJn(re);return 32};this.qWo=(Jd,ie)=>{ie=this.jp.Eua(ie);if(this.uHe(ie))return 8;ie.errorDetails.vCb(Jd);return 32};this.Lem=(Jd,
ie,re,me,Sd)=>{if(!ie.view.Ee)return 2;const cf=ie.view;if(!this.pb.ob.currentSelection)return this.Jd.qc(pf.a.$e,{["Reason"]:uf.a.Mo}),2;if(1===re)return 32;const sf=new Lz,yh=new WE(this.jp,this.gf,this.ySc,this.Xib);ie=new hB(null,Jd,ie,re,me,sf,yh,this.ga,this.pb,this.gf,null);ie.Ei=!0;ie.run();if(ie.isCompleted&&sf.JYb){if(ie=Tb.SelectionFactory.Ie(sf.I2c,sf.JYb.Mc),ie=Tb.SelectionFactory.SA(ie,vc.a.jd(sf.I2c,sf.JYb.end)),!this.UFh.instance||!this.UFh.instance.kno(sf.JYb,ie,cf)){this.pb.Uc(ie);
let si=0;Sd&&(si=Sd.aB);cf.yAc=!1;vb.TaskManager.instance.pc(new Md.a(1,1,1,()=>{this.oUo(cf,si,sf.I2c,sf.JYb)}))}}else{const si=new wg.StandardDialog;si.Md=0;Ze.a.VR.Ycd?si.Rxa(CommonUIStrings.l_DefaultDialogTitle,sf.L$j.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(si.Rxa(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Ze.a.VR.BUd(()=>{si.toa&&(si.hide(),this.ga.Vb(Jd,2))}))}return 32};
this.Xte=(Jd,ie,re)=>{if(1===re)return 32;this.vka&&this.vka.K$&&(Jd=this.vka.K$.OSf(mv.cxc))&&!Jd.rP&&(Jd.t5(0),Jd.fh.YO(0));return 32};this.ga=h;this.jp=b;this.ZIk=r;this.ee=A;this.Zc=L;this.pb=ba;this.Qo=ra;this.gf=Ia;this.ySk=Ta;this.sm=ob;this.Jd=nb;this.Xib=zd;this.vka=Object(ya.a)(nH,Eb);this.H$b=bc.zcd;this.UFh=Bc;this.R6a=Yc;this.HFc=new Map;this.HFc.set(1,fb.a.lIg);this.HFc.set(2,fb.a.rTf);this.HFc.set(3,fb.a.tJg);this.hRc=new Map;this.hRc.set(1,fb.a.mIg);this.hRc.set(2,fb.a.sTf);this.hRc.set(3,
fb.a.uJg)}mc(){const b=this.ga,h=this.TIl,r=this.EAl;b.nb(fb.a.cse,ic.a.view,this.uco,1028);b.qa(fb.a.CLa,ic.a.kd,this.CLa);b.qa(fb.a.IDa,ic.a.kd,this.IDa);b.qa(fb.a.aCb,ic.a.kd,h);b.qa(fb.a.bCb,ic.a.kd,h);b.qa(fb.a.cCb,ic.a.kd,h);b.qa(fb.a.V3b,ic.a.kd,h);b.qa(fb.a.W3b,ic.a.kd,h);b.qa(fb.a.CLa,ic.a.view,r);b.qa(fb.a.IDa,ic.a.view,r);b.qa(fb.a.aCb,ic.a.view,r);b.qa(fb.a.bCb,ic.a.view,r);b.qa(fb.a.cCb,ic.a.view,r);b.qa(fb.a.V3b,ic.a.view,r);b.qa(fb.a.W3b,ic.a.view,r);b.Oc(fb.a.CLa,1028);b.Oc(fb.a.IDa,
1028);b.Oc(fb.a.aCb,1028);b.Oc(fb.a.bCb,1028);b.Oc(fb.a.cCb,1028);b.Oc(fb.a.V3b,1028);b.Oc(fb.a.W3b,1028);b.qa(fb.a.iya,dd.a.frame,qf.ActionManager.qg);this.H$b&&b.nb(fb.a.Xte,ic.a.view,this.Xte,1124);b.nb(fb.a.ghd,ic.a.view,this.Lem,1028);b.nb(fb.a.krg,ic.a.Nd,this.qWo,1124);this.NCo([fb.a.aEe,fb.a.lIg,fb.a.mIg,fb.a.vce,fb.a.rTf,fb.a.sTf,fb.a.GEe,fb.a.tJg,fb.a.uJg,fb.a.nCj,fb.a.mXn,fb.a.z1j])}NCo(b){for(let h=0;h<b.length;h++)this.ga.nb(b[h],ic.a.view,qf.ActionManager.UV,1028)}cEo(b){this.ySc=b}uHe(b){return b?
b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.Jd.qc(pf.a.kRb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Yb.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.Jd.qc(pf.a.kRb,{["Reason"]:"RequestedErrorRangeNotFound"}),Yb.a.mark(4671),!0)}pNn(b){b=b.errorDetails.proofingType;if(this.hRc.has(b)){const h=this.hRc.get(b);this.ga.Vb(h,2);v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
h,b)}}xum(b){switch(b){case fb.a.aCb:return 0;case fb.a.bCb:return 1;case fb.a.cCb:return 2;case fb.a.V3b:return 3;case fb.a.W3b:return 4;default:return-1}}MJn(b){b=b.errorDetails.proofingType;if(this.HFc.has(b)){const h=this.HFc.get(b);this.ga.Vb(h,2);v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}oUo(b,h,r,A){b.c6();(b=r.ug(b.Lc))?(A=VE.a.fx(b,y.AFrameworkApplication.isRtl?A.Mc:A.end),this.ySk.sGa(new Sys.UI.Point(A.x,A.y+A.height),h)):v.ULS.sendTraceTag(5902807,
324,50,"Failed to pop up proofing context menu")}}Object(u.a)(WC,"ProofingActor",null,[]);var Mz=e(326),ru=e(1492),jB=e(1883);class Dx{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.BBc=null;this.ohm="StyleUsageActivity";this.phm="StylesFloodgateSurveyIsEnabled";this.RVa=(Eb,bc,Bc,Yc)=>{Eb=this.CSm(Eb);return 0>Eb||Eb>this.BBc.length?2:(Eb=this.BBc[Eb])?y.AFrameworkApplication.va.Sf(bc,fb.a.FQ,Bc,!0,Yc,Eb):2};this.hzb=(Eb,bc,Bc,Yc,zd)=>{Eb=!0;bc.contextId!==ic.a.paragraph&&bc.contextId!==ic.a.Nd&&
bc.contextId!==ic.a.kd&&(Eb=!1);if(1===Bc||!Eb)return Eb?32:8;if(2===Bc&&!zd)return 8;bc=this.kc.pG(bc.node);zd.MenuItems=Mz.a.iHm(bc);return 32};this.fto=(Eb,bc,Bc,Yc,zd)=>{Eb=!0;bc.contextId!==ic.a.paragraph&&(Eb=!1);if(1===Bc&&!Eb)return 8;bc=bc.node;Bc=this.kc.Lr(bc);if(!Bc||!zd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",zd,bc,Bc),8;Wj.a.Zf.zl?zd.Zxa.rj().Yu(Bc.rj()):zd.Zxa.Yu(Bc.rj());return 32};this.Nel=(Eb,bc,Bc,Yc,zd)=>{if(bc.contextId!==
ic.a.paragraph)return 8;if(this.Ig.Rcb(bc,!1))return this.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),8;if(1===Bc)return 32;const Jd=bc.node;if(rd.ParagraphReader.WBa(Jd)||!zd)return 8;const ie=this.uRf(zd,Jd);if(!ie)return this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.lRb}),8;if(2!==this.kc.wH(ie))return 2;Bc=new hb.GraphTransaction(15);this.fF.TAc(zd);Bc.Eb(Jd);this.Ok.Yzb();const re=[];Eb!=fb.a.dG&&re.push(Me.a.kib);this.Q2.IP(ie,Jd,!1,void 0,void 0,void 0,new jB.a(re,!1,!0));(Eb=this.kc.pG(Jd))&&this.kc.ye(ie,
Eb)&&Cd.b(593078098,3017,50,"Custom linked style applied by user");Jd.pr&&(Eb=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})],$d.a("TOCFormatting",!0,void 0,Eb));Bc.dispose();zd=D.a.DV(zd);Yc.Av=zd>>>16^zd&65535;Yc&&ru.a.fCb&&(Yc.hG|=ru.a.gtb(bc.node));return 32};this.gto=(Eb,bc,Bc,Yc,zd)=>{Eb=!0;bc.contextId!==ic.a.Nd&&(Eb=!1);if(1===Bc&&!Eb)return 2;bc=pb.a.uu(bc);bc=pb.a.Wua(bc);if(!bc)return 2;if(!zd)return 8;Wj.a.Zf.zl?zd.Zxa.rj().Yu(bc.rj()):zd.Zxa.Yu(bc.rj());return 32};this.Oel=
(Eb,bc,Bc,Yc,zd)=>{if(bc.contextId!==ic.a.Nd)return 8;this.Ig.Rcb(bc);if(1===Bc)return 32;Eb=bc;(bc=this.Iq.Dae(Eb))&&(Eb=bc);bc=Eb.node;if(!zd)return 8;const Jd=this.uRf(zd,Eb.node);if(!Jd)return this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.lRb}),8;if(1!==this.kc.wH(Jd))return 2;Bc=this.kc.pG(bc);if(!Bc)return this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.dsi}),8;if(!Bc.Qg(this.kc.Je(Jd)))return this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.lRb}),8;const ie=new hb.GraphTransaction(7);try{if(this.fF.TAc(zd),ie.Eb(bc),this.Q2.mQg(bc,
Bc),this.DF.zY(Eb,re=>{this.Qj.ota(re);this.Qj.Hgb(re,Jd)}),bc.pr){const re=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})];$d.a("TOCFormatting",!0,void 0,re)}}finally{ie&&ie.dispose()}Bc&&this.kc.ye(Jd,Bc)&&Cd.b(593078097,3017,50,"Custom linked style applied by user");zd=D.a.DV(zd);Yc.Av=zd>>>16^zd&65535;Yc&&ru.a.fCb&&(Yc.hG|=ru.a.gtb(Eb.node));return 32};this.eto=(Eb,bc,Bc,Yc,zd)=>{Eb=!0;bc.contextId!==ic.a.kd&&(Eb=!1);if(1===Bc&&!Eb)return 2;bc=this.Q2.ISm(bc);if(!bc)return 2;if(!zd)return 8;
Wj.a.Zf.zl?zd.Zxa.rj().Yu(bc.rj()):zd.Zxa.Yu(bc.rj());return 32};this.Mel=(Eb,bc,Bc,Yc,zd)=>{if(bc.contextId!==ic.a.kd)return 8;if(this.Ig.Rcb(bc,!1))return this.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),8;if(1===Bc)return 32;var Jd=bc.node;if(!zd)return 8;Bc=this.uRf(zd,bc.node);if(!Bc)return this.Jc.qc(pf.a.C6,{["Reason"]:uf.a.lRb}),8;const ie=this.kc.wH(Bc);if(1!==ie&&2!==ie)return 2;(bc=this.Ok.WQf(bc))?(bc=Fg.a.oPb(bc),Eb=y.AFrameworkApplication.va.Sf(bc,Eb,2,!1,Yc,zd)):(Eb=new hb.GraphTransaction(7),
this.fF.TAc(zd),Eb.Eb(Jd),this.Q2.d6o(Bc,Jd),Eb.dispose(),Eb=32);Jd.pr&&(bc=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})],$d.a("TOCFormatting",!0,void 0,bc));(Jd=this.kc.pG(Jd))&&this.kc.ye(Bc,Jd)&&Cd.b(593078096,3017,50,"Custom linked style applied by user");zd=D.a.DV(zd);Yc.Av=zd>>>16^zd&65535;return Eb};this.hto=(Eb,bc,Bc,Yc,zd)=>{const Jd=this.sxd.Nwa(Eb,bc,Bc,Yc,zd,null,0);return 2!==Jd?Jd:this.sxd.Nwa(Eb,bc,Bc,Yc,zd,null,12)};this.Pel=(Eb,bc,Bc,Yc,zd)=>{const Jd={};Jd[this.sxd.FRa]=
6168;Jd[this.sxd.ERa]=6169;let ie=12;if(!bc.view.Ee)return 2;var re=bc.view.ub,me=re?re.hh:null;if(!me)return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.Mo}),8;if(this.zy.YKa(pe.a.lcb,me))return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.sZc}),8;if(this.zy.eHa(rd.ParagraphReader.uZ,me))return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),8;if(this.Ig.gqc(me,!1))return this.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),8;me=this.kc.Il();if(zd&&me){const Sd=me.Qg(zd);if(Sd){const cf=this.kc.ytb(Sd,me);let sf=this.kc.wH(Sd);cf&&
(re=re.ob.K(0),re.xy&&re.Ya.contextId===ic.a.Nd||2===re.length&&re.Ya.contextId===ic.a.Nd&&re.hd.contextId===ic.a.od)&&(sf=1,zd=cf.getValue(Tc.a.la));1===sf?ie=0:3===sf&&(ie=14);!this.kc.ye(Sd,me)&&this.kc.Rd(Sd)&&(re=this.kc.Je(Sd),Cd.b(562317522,3017,50,String.format("{0}: style applied by user",re)));this.Wja(this.ohm,this.phm)}}return this.sxd.Nwa(Eb,bc,Bc,Yc,zd,Jd,ie)};this.Gr=h;this.Pe=r;this.gS=A;this.pD=L;this.sm=ba;this.Jd=ra;this.z0=Ia;this.EYk=Ta;this.Ge=ob;this.Iq=nb}get Q2(){return this.Gr}get zy(){return this.gS}get Ok(){return this.pD}get Qj(){return this.Pe}get Ig(){return this.sm}get Jc(){return this.Jd}get DF(){return this.z0}get sxd(){return this.EYk}get kc(){return this.Ge}mc(){const b=
y.AFrameworkApplication.va,h=Ze.a.Z2a.Odi(12);b.qa(fb.a.FQ,ic.a.Nd,this.Oel);b.qa(fb.a.Zwa,ic.a.Nd,this.gto);b.qa(fb.a.FQ,ic.a.kd,this.Mel);b.qa(fb.a.Zwa,ic.a.kd,this.eto);b.qa(fb.a.FQ,ic.a.paragraph,this.Nel);b.qa(fb.a.FQ,ic.a.view,this.Pel);b.Oc(fb.a.FQ,1036);b.qa(fb.a.Zwa,ic.a.view,this.hto);b.qa(fb.a.Zwa,ic.a.paragraph,this.fto);b.Oc(fb.a.Zwa,99);b.qa(fb.a.hzb,ic.a.view,h);b.qa(fb.a.hzb,ic.a.paragraph,this.hzb);b.Oc(fb.a.hzb,1127);b.nb(fb.a.Ulf,ic.a.view,this.RVa,4);b.nb(fb.a.Vlf,ic.a.view,this.RVa,
4);b.nb(fb.a.Wlf,ic.a.view,this.RVa,4);b.nb(fb.a.Xlf,ic.a.view,this.RVa,4);b.nb(fb.a.Ylf,ic.a.view,this.RVa,4);b.nb(fb.a.Zlf,ic.a.view,this.RVa,4);b.nb(fb.a.$lf,ic.a.view,this.RVa,4);b.nb(fb.a.KYh,ic.a.view,this.RVa,4);b.nb(fb.a.LYh,ic.a.view,this.RVa,4);b.nb(fb.a.MYh,ic.a.view,this.RVa,4);this.BBc=Array(10);this.kc.a6o(this.BBc)}CSm(b){switch(b){case fb.a.Ulf:return 0;case fb.a.Vlf:return 1;case fb.a.Wlf:return 2;case fb.a.Xlf:return 3;case fb.a.Ylf:return 4;case fb.a.Zlf:return 5;case fb.a.$lf:return 6;
case fb.a.KYh:return 7;case fb.a.LYh:return 8;case fb.a.MYh:return 9;default:return-1}}Wja(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");r&&r.execute(A=>{A.logActivity(b,h)})},Dx.tCa)}uRf(b,h){if(b&&h&&rd.ParagraphReader.lc(h))h=this.kc.pG(h);else return null;return h.Qg(b)}get fF(){return null!=this.Y_g?this.Y_g:this.Y_g=Xa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}Dx.tCa=5E3;Object(u.a)(Dx,
"StyleActor",null,[]);var Up=e(140);class Ex{constructor(b,h,r){this.SXk=b;this.Ge=h;this.N7a=r}mc(){this.N7a.nb(fb.a.Zte,ic.a.application,this.Zte.bind(this),96);this.N7a.qa(fb.a.Y4b,ic.a.view,this.dIp.bind(this));this.N7a.nb(fb.a.Lsg,ic.a.view,this.fIp.bind(this),96)}Zte(b,h,r,A,L){if(1===r)return 32;b=Object.assign(new dk.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new Zd.a,{ControlList:[]});r.ControlList.push(Object.assign(new qg.a,{ExternalId:"UpdateStyle",
QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);L.MenuItems=b;return 32}fIp(b,h,r,A,L){if(1===r)return 32;b=Wj.a.I3j();null==b&&8;b=this.Ge.ML(b);L[vk.a.LabelText]=String.format(D.a.Mf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}dIp(b,h,r,A,L){var ba;b=Wj.a.zWb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");Ca.Health.instance.recordKpiUsage(Up.a.jHa,0,Up.a.GB,r);r=null;if(null===(ba=y.AFrameworkApplication.J)||
void 0===ba?0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontStylesGalleryImprovementIsEnabled",!1))r=Mz.a.x7c(L.CommandValueId,this.Ge.Il());this.SXk.nQg(h,r)?Cd.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Sa.a,{extendedProperties:h}),Ca.Health.instance.recordKpiFailure(Up.a.jHa,"UpdateStyleFailed",!1,!0,h),Cd.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));
return 32}}Object(u.a)(Ex,"StyleContextMenuActor",null,[]);var XC=e(2011);class fw{constructor(b){this.ga=b}get Tb(){return this.ga}WAe(b,h=!1){this.Tb.Sf(b,fb.a.sZa,2,!0,null,h)}w$(b){this.Tb.Zb(fb.a.w$,2,b)}}Object(u.a)(fw,"TextFormattingCommands",null,[653]);class Po{constructor(b,h,r,A){this.jef=this.NNh=!1;this.Aup=(L,ba,ra)=>{if(2!==ra)return 2;this.NNh||(this.NNh=!0);return 32};this.epo=(L,ba,ra,Ia,Ta)=>{if(2!==ra)return 2;this.KBj(Ta,!0);return 32};this.dpo=(L,ba,ra,Ia,Ta)=>{if(2!==ra)return 2;
this.KBj(Ta,!1);return 32};this.aqo=(L,ba,ra)=>{if(2!==ra)return 2;if(!this.Skb)return 8;this.Skb.P6m();return 32};this.Xoo=(L,ba,ra)=>{if(2!==ra)return 2;if(!this.Skb)return 8;this.Skb.jPo();return 32};this.p0a=(L,ba)=>{3===ba.aB&&Ee.a.qn(ba.Pn.currentSelection)&&($d.c(fb.a.vup),this.jef=!0)};this.ga=b;this.za=h;this.Skb=r;this.pb=A}get zup(){return this.jef}mc(){var b;this.ga.nb(wb.a.HU,ic.a.view,this.Aup,4);this.ga&&this.za&&(this.za.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.nb(fb.a.cNg,
ic.a.view,this.epo,4),this.ga.nb(fb.a.eNg,ic.a.view,this.dpo,4)),this.ga.nb(wb.a.y2j,ic.a.application,this.aqo,4),this.ga.nb(wb.a.xDf,ic.a.application,this.Xoo,4),Cl.EventHandlerManager.instance.iDo(()=>{this.Hao()}));(null===(b=Db.StaticActiveAppFrame.Aa().tb.Xc)||void 0===b?0:b.Ee)&&Db.StaticActiveAppFrame.Aa().tb.Xc.d8(()=>{this.wUo()});this.pb&&this.pb.BD(this.p0a)}lvo(){$d.c(fb.a.yup);this.jef=!0}wUo(){const b=window.performance.now();Po.l2e&&250>b-Po.l2e&&1E3<b-Po.Rxh&&($d.c(fb.a.xup),Po.Rxh=
b);this.Skb&&Po.Dc&&Po.Dc.sG(108)&&this.Skb.showFloatie()}Tkn(b,h){if(h){var r=null;X.a.cO&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.Skb&&this.Skb.TEp(b.getBoundingClientRect(),h)}}Hao(){Po.l2e=window.performance.now()}KBj(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Po.nan)){for(b=b.firstChild;b;)this.S9k(b,h),b=b.nextSibling;break}b=b.nextSibling}}S9k(b,h){if(b.classList.contains(Po.mVi)){const r="WACImageResizeHandleTouch"+this.hBm(b);
h?b.classList.add(Po.nVi,r):b.classList.remove(Po.nVi,r)}}hBm(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Po.mVi)return D.a.substring(h,20,h.length);return""}static get Dc(){return null!=Po.TZg?Po.TZg:Po.TZg=Xa.a.instance.Wa("Box4.IFeatureHelper")}}Po.mVi="WACImageResizeHandles";Po.nVi="WACImageResizeHandlesTouch";Po.nan="WACImgSelection";Po.l2e=0;Po.Rxh=0;Object(u.a)(Po,"TouchInputActor",null,[652]);class gw{get FRa(){return Bp.a.FRa}get ERa(){return Bp.a.ERa}get mEc(){return Bp.a.mEc}Nwa(b,
h,r,A,L,ba,ra){return Bp.a.Nwa(b,h,r,A,L,ba,ra)}Cwc(b,h,r,A,L,ba){return Bp.a.Cwc(b,h,r,A,L,ba)}static get instance(){gw._instance||(gw._instance=new gw);return gw._instance}}gw._instance=null;Object(u.a)(gw,"ViewActionHandlerProxy",null,[651]);class qH{constructor(b,h,r){this.Djo=r;this.kpiName="VisiMarkersUsage";this.uca="wwaengidc";this.Owb=new Map;this.ugp=(A,L,ba,ra,Ia)=>{var Ta;if(1===ba)return 32;if(!Ia)return 2;this.Owb.set("Source",tl.a[this.ga.f5]);this.Rff.Idd?this.Owb.set("Action","Removed"):
this.Owb.set("Action","Applied");Ca.Health.instance.recordKpiUsage(this.kpiName,1,this.uca,this.Owb);A=document.getElementsByTagName("head")[0];if(!this.Rff.Mtp(A))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;y.AFrameworkApplication.ud("PlaceholderTextBugFix;PlaceholderTextBugFixCf");(null===(Ta=y.AFrameworkApplication.J)||void 0===Ta?0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.PlaceholderTextBugFixIsEnabled",!1))&&this.Djo.AHo();Db.StaticActiveAppFrame.Aa().UH({ShowVisiMarkers:"ToggleButtonModel"});
return 32};this.xso=(A,L,ba,ra,Ia)=>{if(1===ba)return 32;Ia[bg.a.On]=this.Rff.Idd;return 32};this.ga=b;this.Rff=h}mc(){this.ga.nb(fb.a.yDe,ic.a.application,this.ugp,1);this.ga.nb(fb.a.iDj,ic.a.application,this.xso,96)}}Object(u.a)(qH,"VisiMarkersActor",null,[]);var YC=e(1354),St;(function(b){b[b.none=0]="none";b[b.Wrq=1]="requiresProperties";b[b.uwq=2]="stopOnFirst";b[b.vCf=4]="editOnly";b[b.n4p=8]="customDataReporting";b[b.H1p=16]="canBeThrottled";b[b.jmq=32]="noActivitiesReporting";b[b.Amq=64]=
"noSqmReporting";b[b.Ofg=96]="noReporting";b[b.R1p=128]="causesShutdown";b[b.Q$p=256]="givesCookieConsent";b[b.Vrq=512]="requiresCookieConsent";b[b.bzg=1024]="review";b[b.U6p=2048]="enabledInOffline";b[b.correlationId=4096]="correlationId";b[b.sessionOrigin=8192]="sessionOrigin";b[b.P6p=16384]="enableDocumentAssemblyReadOnly";b[b.Lmq=32768]="notRepeatable"})(St||(St={}));Object(u.b)("ActionFlags",St);class Ly{constructor(b){this.YEf=b;this.W2c=(h,r,A,L,ba)=>{(h=null===ba||void 0===ba?void 0:ba.getValue(Pd.a.targetObject))&&
this.YEf.expand(h);return YC.a.succeeded};this.NZd=(h,r,A,L,ba)=>{(h=null===ba||void 0===ba?void 0:ba.getValue(Pd.a.targetObject))&&this.YEf.collapse(h);return YC.a.succeeded};this.V2c=(h,r,A,L,ba)=>{(h=null===ba||void 0===ba?void 0:ba.getValue(Pd.a.targetObject))&&this.YEf.x$l(h);return YC.a.succeeded}}mc(){const b=y.AFrameworkApplication.va;b.nb(fb.a.W2c,ic.a.view,this.W2c.bind(this),St.vCf|St.bzg|St.Ofg);b.nb(fb.a.NZd,ic.a.view,this.NZd.bind(this),St.vCf|St.bzg|St.Ofg);b.nb(fb.a.V2c,ic.a.view,
this.V2c.bind(this),St.vCf|St.bzg|St.Ofg)}}Object(u.a)(Ly,"ExpandCollapseActor",null,[]);var Fx=e(898);class Nz{Ec(b){b.ja("Box4.Actors.Box4PasteStewardFactory",()=>new JJ(px.a.hTb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ja("Box4.Actors.Box4PasteStewardUtils",()=>new Cw(y.AFrameworkApplication.J.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();
b.ja("Box4.Actors.ClipboardActor",()=>new Cr(b.zf("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),$g.a.instance,b.resolve("Box4.IClipboardDataHelper"),Fg.a.instance,y.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.J,Jc.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),
y.AFrameworkApplication.uGg(),y.AFrameworkApplication.yZj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Xa.a.instance.resolve("Common.IReactContextualUILauncher"),!!Ze.a.instance&&Ze.a.instance.soa,b.Wa("Box4.Actors.PastePerformanceE2ETracker"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ja("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Yn(y.AFrameworkApplication.J)).ha();b.ja("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new WJ(y.AFrameworkApplication.J,
b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),dh.a.instance)).ha();b.ja("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ja("Box4.Actors.ISystemClipboard",()=>new lH(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Object(Vb.a)(),Db.StaticActiveAppFrame.Aa().tb,Jc.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),
dh.a.instance,y.AFrameworkApplication.J)).ha();b.ja("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Iy).ha();b.ja("Box4.ISelectionFactory",()=>new IE.a).ha();b.ja("Box4.IRenderOrderGraphIteratorFactory",()=>new VG).ha();b.ja("Common.IDomElementContentStateFactory",()=>new zJ).ha();b.ja("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new eH(Fg.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ja("Box4.Actors.PastedContentsPostProcessorHelper",
()=>new AJ).ha();b.ja("Box4.Actors.PasteFloatiePositionProvider",()=>new Jw(Fg.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Object(Vb.a)(),ed.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Ze.a.instance&&Ze.a.instance.soa)).ha();b.ja("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new ew(b.resolve("Box4.IClipboardDataHelper"),Ze.a.HD.tL)).ha();b.ja("Box4.Actors.PasteFloatieEventManager",()=>new TE(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),
Object(Vb.a)(),gx.a.instance(),y.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ze.a.wf.Um.Hf(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Ze.a.instance&&Ze.a.instance.soa)).ha();b.ja("Box4.Actors.IClipboardOperationPasteFactory",()=>new Nq($g.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.PasteCoordinator"),Aw.a.instance,Fg.a.instance,y.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.zf("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.Wa("Box4.Actors.PastePerformanceE2ETracker"))).ha();b.ja("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new PJ(y.AFrameworkApplication.va,
$g.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),Fg.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),CC.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Wa("Box4.IFeatureHelper"))).ha();
b.ja("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Hz($g.a.instance,dh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),y.AFrameworkApplication.J.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ja("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new yx(y.AFrameworkApplication.J)).ha();b.ja("Box4.Actors.IClipboardOperationFactory",()=>new RJ(b.resolve("Box4.Actors.InternalClipboard"),y.AFrameworkApplication.va,y.AFrameworkApplication.qGg(),
$g.a.instance,CC.a.instance,dh.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"),b.Wa("Box4.Actors.PastePerformanceE2ETracker"))).ha();sl.a.yva&&b.ja("Box4.Actors.IHiddenExternalPasteView",()=>new RC(sl.a.R_i?b.Za("Common.ISystemInitiatedFeedback"):null)).ha();b.ja("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new gh(b.zf("Box4.Actors.IBox4PasteStewardFactory"),b.zf("Box4.Actors.IBox4ImageStewardFactory"),b.zf("Box4.Actors.IBox4TableStewardFactory"),
b.zf("Box4.Actors.IBox4WordConverterFactory"),b.zf("HtmlImport.IHtmlTranslatorSettings"),b.Wa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"),b.Wa("Box4.Actors.PastePerformanceE2ETracker"),sl.a.yva?b.zf("Box4.Actors.IHiddenExternalPasteView"):
null)).ha();b.ja("Box4.Actors.InternalClipboard",()=>new dw.a(b.resolve("Box4.Images.IImageEditor"),b.zf("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Ze.a.wf,b.resolve("Box4.IParagraphIndentationReader"),y.AFrameworkApplication.J,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Wa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.IConstantsProvider").PRj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ja("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new kH(b.resolve("Box4.Actors.InternalClipboard"),b.Wa("Box4.IContentControlCopyPasteHelper"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ja("Box4.List.IListCommands",()=>new XA(y.AFrameworkApplication.va)).ha();b.ja("Box4.List.ListNewLineStrategy",
()=>new sx(b.resolve("Box4.List.IListEditor"),b.zf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ja("Box4.Actors.PasteCoordinator",()=>new kv(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),Ke.a.instance,
b.Wa("Box4.Actors.PastePerformanceE2ETracker"))).ha();b.ja("Box4.Actors.Box4ImageStewardFactory",()=>new LJ(b.resolve("Box4.Images.IImageEditor"),y.AFrameworkApplication.zc,b.resolve("Box4.IUndoManager"),b.Wa("Box4.Actors.IImageStewardBridge"),Db.StaticActiveAppFrame.Aa().$L,b.Wa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();b.ja("Box4.Actors.Box4TableStewardFactory",()=>new WA(Xa.a.instance.resolve("Box4.List.IListEditor"),
Xa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();b.ja("Box4.Actors.ClipboardOperationWordStrategy",()=>new Hw($g.a.instance,Fg.a.instance,If.a.Gd(),Ke.a.instance)).ha();b.ja("Box4.Actors.Box4WordConverterFactory",()=>new Cy(y.AFrameworkApplication.J)).as("Box4.Actors.IBox4WordConverterFactory").ha();
b.ja("Box4.Actors.IExternalPasteCssConverter",()=>new Rj(y.AFrameworkApplication.J)).ha();b.ja("Box4.Actors.IHtmlNormalizerHelper",()=>new iH).ha();b.ja("Box4.ISelectionCommands",()=>new HE(y.AFrameworkApplication.va)).ha();b.ja("Box4.ITextFormattingCommands",()=>new fw(y.AFrameworkApplication.va)).ha();b.ja("Box4.Actors.AccessibilityActor",()=>new UL(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();b.ja("Box4.Actors.InsertionPointFormatting",
()=>new UE(b.Wa("Box4.IFontSlotProvider"),b.Za("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ja("Box4.UI.PasteFloatieManager",()=>new Fz).as("Box4.UI.IFloatieManager").ha();b.ja("Box4.Actors.ProofingActor",()=>new WC(Xa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),y.AFrameworkApplication.va,()=>Xa.a.instance.resolve("Box4.UI.ILanguageDialog"),Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Fg.a.instance,Xa.a.instance.Za("Box4.IExternalSelectionManager"),CC.a.instance,Xa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Ke.a.instance,$g.a.instance,Xa.a.instance.resolve("Box4.IContextMenuController"),Xa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Xa.a.instance.Za("Box4.Actors.IProofingErrorPresenter"),Xa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ja("Box4.Actors.StyleActor",
()=>new Dx(Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Xa.a.instance.resolve("Box4.IFormattingEditor"),Object(ak.a)(),Xa.a.instance.resolve("Box4.IInsertionPointFormatting"),Ke.a.instance,$g.a.instance,Xa.a.instance.resolve("Box4.TextFormattingHelper"),gw.instance,Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Xa.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ja("Box4.Actors.StyleContextMenuActor",()=>new Ex(Xa.a.instance.resolve("Box4.IUpdateStyleManager"),
Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.va)).ha();b.ja("Box4.Actors.TextFormattingActor",()=>new XC.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Wa("Box4.IFontSlotProvider"),b.Wa("Box4.IContentControlChpHelper"),Xa.a.instance.resolve("Box4.IFormattingEditor"),Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.resolve("Box4.IParagraphEditor"),Xa.a.instance.resolve("Box4.ILineSpacingHelper"),
Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Xa.a.instance.resolve("Box4.IOutlineElementEditor"),Xa.a.instance.resolve("Box4.List.IListFormattingEditor"),Xa.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ja("Box4.Actors.AutoCorrectActor",()=>new GC(y.AFrameworkApplication.va,$g.a.instance,()=>Xa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ja("Box4.Actors.TouchInputActor",()=>new Po(y.AFrameworkApplication.va,
y.AFrameworkApplication.J,tx.a.instance,Fg.a.instance)).as("Box4.ITouchInputActor").ha();b.register(zy,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ja("Box4.Actors.VisiMarkersActor",()=>new qH(y.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"),b.resolve("Box4.PlaceholderText.PlaceholderTextProvider"))).ha();b.ja("Box4.Actors.IndentationActorExtension",()=>new Zi).as("Box4.Actors.IIndentationActorExtension").ha();Object(Oo.a)()&&b.register(qt,"Box4.HighContrastColorPickerState").as("Box4.IHighContrastColorPickerState").ha();
b.ja("Box4.Actors.PageColorActor",()=>new UC(nu.a.instance,new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc.Fd),Sm.a.instance,gm.a.instance,Xa.a.instance.Wa("Box4.UI.RecentColorsSectionHandler"),new lp(UC.Ypb))).ha();Fx.a.QNa&&b.ja("Box4.Actors.ExpandCollapseActor",()=>new Ly(Xa.a.instance.resolve("Box4.IExpandCollapseManager"))).ha()}}Object(u.a)(Nz,"Box4ActorsComponentConfiguration",null,[1]);var Su=e(214),YJ=e(1094);const ZC=()=>{const b=ZJ;y.AFrameworkApplication.va.qa(fb.a.TBf,ic.a.Jrb,b);y.AFrameworkApplication.va.qa(fb.a.TBf,
ic.a.alc,b);y.AFrameworkApplication.va.qa(fb.a.SBf,ic.a.Jrb,Kw);y.AFrameworkApplication.va.qa(fb.a.SBf,ic.a.alc,Kw)},ZJ=(b,h,r)=>Ze.a.d3d?8:2===r?(b=new wg.StandardDialog,b.Md=4,b.YW(1),b.Ue(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ue(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.jHg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,nv),32):2,nv=b=>{1===b&&y.AFrameworkApplication.va.Vb(fb.a.SBf,2)},Kw=(b,h,r)=>{if(Ze.a.d3d)return 8;
if(1===r)return h.node.hasProperty(Sb.a.Z1c)?32:2;if(2===r&&(h.contextId===ic.a.view&&h.view.ub&&(h=h.view.ub.hh),Su.h(h))){b=YJ.a.Tym(h.node);yc.a.u7o();try{rH(b)}catch(A){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",A)}}return 32},rH=b=>{ed.a.Zm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var sH=e(810);class su{constructor(b){this.aI=null;this.iWc=(h,r,A,L,ba)=>{if(1===A)return 32;if(2===A&&!ba)return 8;this.LXe.Ode=!this.LXe.Ode;h=su.Jj.lTb(r);r=new sH.a;A=null;32===
y.AFrameworkApplication.va.Zb(fb.a.c1a,2,r)&&r&&(A=r.fontColor);L="";A&&!r.NRb&&(L=Xl.a.zB(A)||"");this.o7d.dea=L;this.vK.YCb(L);h=this.o7d.Gsb(h,Ze.a.tWa);if(!h)return 8;ba.MenuItems=h;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Wld=(h,r,A,L,ba)=>{if(1===A)return 32;if(!ba)return 8;ba[bg.a.On]=this.LXe.Ode;return 32};this.K5=(h,r,A,L,ba)=>{if(1===A)return 32;y.AFrameworkApplication.va.Zb(fb.a.c1a,2,ba);h=ba&&0<=ba.fontColor&&16777215>=ba.fontColor?ba.fontColor:
0;Db.StaticActiveAppFrame.Aa().dismissFloatie();(new Vs(su.Ypb,fb.a.Ixa)).pBb(h);return 32};this.k_b=(h,r,A,L,ba)=>{if(1===A)return 32;if(2===A&&!ba)return 8;h=su.Jj.lTb(r);r=new sH.a;A=null;32===y.AFrameworkApplication.va.Zb(fb.a.c1a,2,r)&&r&&(A=r.fontColor);L="";A&&!r.NRb&&(L=Xl.a.zB(A)||"");this.o7d.dea=L;this.vK.YCb(L);h=this.o7d.Gsb(h,Ze.a.tWa);if(!h)return 8;ba.MenuItems=h;v.ULS.sendTraceTag(508421139,340,50,"Font color dropdown menu is opened.");return 32};this.D3e=b}get o7d(){this.aI||(this.aI=
new lp(su.Ypb),this.Nha(this.aI));return this.aI}Nha(b){Object(Oo.a)()&&b.bH(7,fb.a.iWc);b.bH(1,fb.a.pma);b.bH(3,fb.a.Uy);b.bH(4,fb.a.Uy);b.bH(5,fb.a.Ixa);b.bH(6,fb.a.K5);b.q8a(this.D3e,1)}mc(b){const h=y.AFrameworkApplication.va;Object(Oo.a)()&&(this.LXe=b,h.qa(fb.a.iWc,ic.a.view,this.iWc),h.nb(fb.a.Wld,ic.a.view,this.Wld,96));h.qa(fb.a.K5,ic.a.view,this.K5);h.qa(fb.a.k_b,ic.a.view,this.k_b);h.Oc(fb.a.k_b,1127)}static Wzm(){return new su(nu.a.instance)}static get instance(){return null!=su.i2g?su.i2g:
su.i2g=su.Wzm()}get vK(){return null!=this.e8g?this.e8g:this.e8g=Xa.a.instance.Wa("Box4.UI.RecentColorsSectionHandler")}static get Jj(){return fn.a.instance}}su.Ypb="Font";Object(u.a)(su,"FontColorActor",null,[]);class Oz{constructor(b){this.K5=(h,r,A,L,ba)=>{if(1===A)return 32;y.AFrameworkApplication.va.Zb(fb.a.c1a,2,ba);h=ba&&0<=ba.highlight&&16777215>=ba.highlight?ba.highlight:0;Db.StaticActiveAppFrame.Aa().dismissFloatie();(new Vs("Highlighter",fb.a.hea)).pBb(h);return 32};this.ga=b}mc(){this.ga.qa(fb.a.wvj,
ic.a.view,this.K5)}static SBm(){return new Oz(y.AFrameworkApplication.va)}static get instance(){return null!=Oz.U2g?Oz.U2g:Oz.U2g=Oz.SBm()}}Object(u.a)(Oz,"HighlighterColorActor",null,[]);var Pz;(function(b){b.FVp="Heading";b.Bookmark="Bookmark";b.Url="Url";b.uXp="RecentLinks"})(Pz||(Pz={}));Object(u.b)("InsertLinkUserActivitySource",Pz);class XE{constructor(b,h,r,A,L){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=A;this.paragraphNode=L}}Object(u.a)(XE,"HeadingDataForLinkDialog",null,
[]);class kB{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(u.a)(kB,"BookmarkDataForLinkDialog",null,[]);class ov{constructor(b,h,r,A,L,ba){this.key=b;this.name=h;this.startIndex=r;this.count=A;this.level=L;this.isCollapsed=ba}}Object(u.a)(ov,"GroupHeaderDataForLinkDialog",null,[]);class Am{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(u.a)(Am,"SelectedItemFromLinkDialogGroupedList",null,[]);class My{static get Nqc(){var b;My.uHb||(My.uHb=null===(b=y.AFrameworkApplication.J)||
void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.insertLinkDialogRefactorEnabled",!1));return My.uHb}constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.$q=b;this.Ed=h;this.w2l=r;this.bookmarkManager=A;this.O1=L;this.Gs=ba;this.Ug=ra;this.Yd=Ia;this.lk=Ta;this.Om=ob;this.UDa=nb;this.kab=null;this.O0f=!1;this.ufe=(bc,Bc)=>{var Yc;if(this.ke.Ly){var zd=Mc.a.pnc(this.$q),Jd=this.ke.ub.ob.currentSelection;if(Jd){Jd=Jd.Ya;rd.ParagraphReader.Xn(Jd)&&(Jd=vc.a.createTextRange(Jd.node,0,rd.ParagraphReader.textLength(Jd.node)));
var ie=Ee.a.C4b(Jd);Ee.a.Rm(ie)&&(Jd=ie);if(0!==bc&&32===y.AFrameworkApplication.va.Sf(Jd,fb.a.PT,1,!0,null,null)&&this.$q.equals(Jd))if(My.Nqc)Bc.UILocation=this.Ed&&this.Ed.UILocation,y.AFrameworkApplication.va.Sf(this.$q,fb.a.dNb,2,!0,null,Bc);else{Yb.a.mark(5562);(null===(Yc=If.a.Gd())||void 0===Yc?0:Yc.pn)&&this.ke.ub.wMb();bc=new hb.GraphTransaction(15);bc.Eb(this.$q.node);this.$q.node.bK().qG.k4(4);Yc=Bc.txtDisplay;Jd=!1;if(null!=Bc.linkurl)if(Jd=!0,Bc.isHeading){m(this.Ed,"Heading");ie=Bc.paragraphNode;
const re=Bc.startCp,me=Bc.endCp;Bc=this.bookmarkManager.dzi(ie);this.bookmarkManager.Eec(Bc,re,me,ie,ie,!1)}else m(this.Ed,"Bookmark"),Bc=Bc.linkurl;else m(this.Ed,"Url"),Bc=Bc.txtLink.trim();this.ccb(Yc,Bc,zd,Jd);bc.Bh=fb.a.PT;bc.dispose();Yb.a.mark(5563);this.$q.node.XQb()}else this.ke.I$()}else v.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ke=Object(Vb.a)().Pd;this.$q=b;r=Ee.a.C4b(this.$q);Ee.a.Rm(r)&&(this.$q=r);if(!My.Nqc){const bc=
new Xf.a(!1,!1,!0);r=this.jEi();A={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};L=this.kab="";L=rd.ParagraphReader.text(this.$q.node);ra=this.$q.cpBegin;Ia=this.$q.cpEnd;({Uze:L,D5d:ra,E5d:Ia,cee:ba}=this.iCi(L));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.ccb(h.DisplayText,h.Url,ba);else{ba[0]&&this.Ari(ra,Ia,ba[0].paragraph);h=""===L.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;bc.Ue(1,h);(null===L||void 0===L?0:L.startsWith(D.a.K8a))?(h=this.DLi(L,r))?r.selectedItem=h:A.txtLink=L:A.txtLink=L;A.txtDisplay=this.kab;1>=ba.length&&this.O1.Cai(b,ba[0],1===ba.length)&&(this.O0f=!0,A.textDisplayDisabled=!0);var Eb={["id"]:"InsertLinkDialog",["bodyControls"]:A};
this.Om.Ae(()=>{bc.ti(Box4Intl.Box4Strings.l_InsertLinkTitle,this.ufe,Eb)},"RILD:IAS")}}}p_j(){const b=new Xf.a(!1,!1,!0),h=this.jEi(),r={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:h};var A=this.kab="";A=rd.ParagraphReader.text(this.$q.node);var L=
this.$q.cpBegin;let ba=this.$q.cpEnd,ra;({Uze:A,D5d:L,E5d:ba,cee:ra}=this.iCi(A));const Ia="object"===typeof this.Ed?this.Ed:null;if(Ia&&(Ia.Source&&"CommandingInterface"===Ia.Source||Ia.Url&&Ia.DisplayText))this.ccb(Ia.DisplayText,Ia.Url,ra);else{ra[0]&&this.Ari(L,ba,ra[0].paragraph);L=""===A.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;b.Ue(1,L);(null===A||void 0===A?0:A.startsWith(D.a.K8a))?(L=this.DLi(A,h))?h.selectedItem=L:r.txtLink=A:r.txtLink=A;r.txtDisplay=
this.kab;1>=ra.length&&this.O1.Cai(this.$q,ra[0],1===ra.length)&&(this.O0f=!0,r.textDisplayDisabled=!0);var Ta={["id"]:"InsertLinkDialog",["bodyControls"]:r};this.Om.Ae(()=>{b.ti(Box4Intl.Box4Strings.l_InsertLinkTitle,this.ufe,Ta)},"RILD:IAS")}}iCi(b){const h=Mc.a.pnc(this.$q);let r=this.$q.cpBegin,A=this.$q.cpEnd,L="";if(!h.length)return this.kab=b.substring(this.$q.cpBegin,this.$q.cpEnd),{returnValue:!0,Uze:L,D5d:r,E5d:A,cee:h};if(h[0].hyperlink){let ba,ra=0,Ia=Math.max(0,b.length-1),Ta=0;for(let ob=
0;ob<h.length;ob++)h[ob].cpBegin>=ra&&({cpBegin:ba,cpEnd:ra}=this.O1.vna(this.$q,h[ob]),Ia=Math.min(ba,Ia),Ta=Math.max(ra,Ta));r=Math.min(Ia,r);A=Math.max(Ta,A);this.kab=b.substring(r,A);r===Ia&&(L=h[0].hyperlink.url);return{returnValue:!0,Uze:L,D5d:r,E5d:A,cee:h}}return{returnValue:!1,Uze:L,D5d:r,E5d:A,cee:h}}Ari(b,h,r){if(h!==this.$q.cpEnd||b!==this.$q.cpBegin)b=Tb.SelectionFactory.eN(r,b,h),this.ke.ub.Uc(b),this.$q=Ee.a.C4b(b.Ya.clone())}dvp(b,h,r,A,L,ba=!1){A?(A=vc.a.createTextRange(this.$q.node,
this.$q.cpBegin,this.$q.cpBegin+b.length),this.Gs.I4l(A,r,h),b=Tb.SelectionFactory.Ie(this.$q.node,this.$q.cpBegin+b.length)):(this.Gs.cyb(this.$q,2),this.lk.bBb(this.$q,2),r=vc.a.jd(this.$q.node,this.$q.cpEnd),this.Ug.lf(r,b,!0),A=vc.a.createTextRange(this.$q.node,this.$q.cpEnd,this.$q.cpEnd+b.length),this.Gs.SJ(A,h,L,!1,!0,ba),b=Tb.SelectionFactory.Ie(this.$q.node,this.$q.cpEnd+b.length));b&&this.ke.ub.Uc(b)}ccb(b,h,r,A=!1){var L=null;b||(b=h,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",
!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!A){h=Mc.a.Qua(h);var ba="";this.UDa&&({avg:ba}=this.UDa.NNg(h)).returnValue&&(h=ba)}this.O0f||(b=this.Gs.RLo(b));ba=!1;if(h){L=0<r.length;const ra=rd.ParagraphReader.text(this.$q.node).substring(this.$q.cpBegin,this.$q.cpEnd)!==b,Ia=this.Yd.Zg;if(Ia&&1===r.length&&!r[0].hyperlink.hK&&!(r[0].cpBegin>this.$q.cpBegin&&r[0].cpEnd<=this.$q.cpEnd)){this.dvp(b,h,r[0].hyperlink,!ra,L,A);return}if(L)for(let Ta=0;Ta<r.length;Ta++)r[Ta].hyperlink.hK&&
(ba=!0),this.Gs.YZ(this.$q.node,r[Ta].hyperlink,!1);ra?this.Ug.lf(this.$q,b,!ba):Ia&&!ba&&this.lk.bBb(this.$q,1);r=vc.a.createTextRange(this.$q.node,this.$q.cpBegin,this.$q.cpBegin+b.length);this.Gs.SJ(r,h,L,ba,!0,A);L=Tb.SelectionFactory.Ie(this.$q.node,this.$q.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.hK&&(ba=!0),this.Gs.YZ(b.paragraph,b.hyperlink));ba&&this.Yd.Vv(ba?2:7);L&&this.ke.ub.Uc(L);Ze.a.swp()}DLi(b,h){h=h.items;const r=b.substring(D.a.K8a.length),A=this.bookmarkManager.BPf(r);
b=-1;let L=0;for(let ba=0;ba<h.length;ba++)if(h[ba].isHeading&&0!=A.count&&h[ba].paragraphNode.id==A.K(0).id){b=ba;break}else if(!h[ba].isHeading&&h[ba].linkurl==r){b=ba;L=1;break}h=new Am(b,L);return-1!=b?h:null}jEi(){const b={};let h=[],r=0,A=0;var L=this.w2l.DBm();L&&(r=L.count,h=h.concat(this.IBm(L)));if(L=this.bookmarkManager.d8d(!1))A=L.count,h=h.concat(this.Gpm(L));b.groups=this.xBm(r,A);b.items=h;return b}xBm(b,h){const r=[],A=new ov("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,
0,b,0,!0);r.push(A);b=new ov("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);r.push(b);return r}IBm(b){const h=[],r=/\uFFFC/;for(const A of b)b=A.characterData.replace(r," "),b=new XE(b,!0,A.Mc,A.end,A.paragraphNode),h.push(b);return h}Gpm(b){const h=[];for(const r of b)b=r.Uf(Rc.a.Wv).toString(),b=new kB(b,!1),h.push(b);return h}}My.uHb=null;Object(u.a)(My,"ReactInsertLinkDialog",null,[]);class tH{static get Fh(){return Xf.a.iA(tH.pp,Box4Intl.Box4Strings.l_InsertLinkDisplayText,
Box4Intl.Box4Strings.l_InsertLinkAddress)}}tH.pp="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(tH,"InsertLinkDialogHtml",null,[]);class bp extends Xf.a{constructor(b){super();
this.Cqe=()=>{const h=document.getElementById("txtLink");this.Dxa(1,!h||!h.value.length||Mc.a.i_a(h.value))};this.ufe=(h,r)=>{if(this.Rh.Ly){var A=this.Rh.ub.ob.currentSelection;if(A)if(A.equals(this.JA)&&0!==h){h=new hb.GraphTransaction(15);h.Eb(this.mY[0].node);for(A=0;A<this.mY.length;A++)this.mY[A].node.bK().qG.k4(4);A=r.txtLink.trim();r=this.eWl();A=this.ehn(A);(r||A)&&bp.Yd.Vv(7);this.hide();h.dispose()}else this.Rh.I$()}};this.mY=b;this.Rh=Object(Vb.a)().Pd;this.JA=this.Rh.ub.ob.currentSelection;
this.TGf=b[0].cpBegin;this.z6f=b[b.length-1].cpEnd;this.$g="InsertMultiParagraphLinkDialog";b=this.oEp();this.showDialog("",b)}showDialog(b,h){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Fh=tH.Fh;""===h.trim()&&this.Ue(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.ti(Box4Intl.Box4Strings.l_InsertLinkTitle,this.ufe,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;bp.U1f&&
(b=document.getElementById("txtLink"),Re.a.addHandler(b,Fd.a.input,this.Cqe),Re.a.addHandler(b,Fd.a.UXc,this.Cqe))}hide(){if(bp.U1f){const b=document.getElementById("txtLink");b&&(Re.a.removeHandler(b,Fd.a.UXc,this.Cqe),Re.a.removeHandler(b,Fd.a.input,this.Cqe))}super.hide()}wCa(b){return bp.U1f?this.sqm(this.GIc)?super.wCa(b):!1:super.wCa(b)}oEp(){let b;var h="";const r=this.mY.length,A=Mc.a.VD(this.mY[0],!1);0<A.length&&({cpBegin:L,cpEnd:b}=bp.O1.vna(this.mY[0],A[0]),L<=this.mY[0].cpBegin&&(h=A[0].hyperlink.url),
this.TGf=Math.min(this.TGf,L));var L=Mc.a.VD(this.mY[r-1],!1);0<L.length&&({cpBegin:L,cpEnd:b}=bp.O1.vna(this.mY[r-1],L[L.length-1]),this.z6f=Math.max(this.z6f,b));this.fxp(this.TGf,this.z6f);return h}fxp(b,h){const r=this.mY.length;if(b!==this.mY[0].cpBegin||h!==this.mY[r-1].cpEnd){b=vc.a.jd(this.mY[0].node,b);b=Tb.SelectionFactory.aq(b);h=vc.a.jd(this.mY[r-1].node,h);h=Tb.SelectionFactory.SA(b,h);b=this.ONi(h.Ya.clone());const A=this.ONi(h.hd.clone());b&&A&&(this.mY[0]=b,this.mY[r-1]=A,this.Rh.ub.Uc(h),
this.JA=h)}}ehn(b){if(!b)return!1;b=Mc.a.Qua(b);for(let r=0;r<this.mY.length;r++){var h=this.mY[r];if(bp.fBa&&Ee.a.Rm(h)&&(h=Ee.a.INg(h),!Ee.a.Rm(h)))continue;h=vc.a.createTextRange(this.mY[r].node,h.cpBegin,h.cpEnd);this.Fwp(h);bp.Gs.SJ(h,b,!1)}return!0}Fwp(b){bp.Yd.P8j(b)}ONi(b){return rd.ParagraphReader.Xn(b)&&!Ee.a.Zca(b)&&rd.ParagraphReader.textLength(b.node)?vc.a.createTextRange(b.node,0,rd.ParagraphReader.textLength(b.node)):Ee.a.Rm(b)?b:null}eWl(){let b=!1;for(const h of this.mY){const r=
Mc.a.VD(h,!1);r&&(b=bp.O1.nIj(h,r)||b)}return b}static get O1(){return null!=bp.n1g?bp.n1g:bp.n1g=Xa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Yd(){return null!=bp.qah?bp.qah:bp.qah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Gs(){return null!=bp.d1g?bp.d1g:bp.d1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static get fBa(){null==bp.Sea&&(bp.Sea=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return bp.Sea}static get U1f(){null==bp.q_e&&(bp.q_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkUrlValidationIsEnabled"):!1);return bp.q_e}}bp.Sea=null;bp.q_e=null;Object(u.a)(bp,"InsertMultiParagraphLinkDialog",Xf.a,[]);class mf{static get Ig(){return Ke.a.instance}static get v8(){return null!=mf.TXg?mf.TXg:mf.TXg=Xa.a.instance.Wa("Box4.IContentControlChpHelper")}static get O1(){return null!=mf.o1g?mf.o1g:mf.o1g=Xa.a.instance.resolve("Box4.IHyperlinkStrategy")}static lA(){return mf.Qo||
(mf.Qo=Xa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Yd(){return null!=mf.Aah?mf.Aah:mf.Aah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ni(){return null!=mf.Hah?mf.Hah:mf.Hah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get czi(){return null!=mf.H0g?mf.H0g:mf.H0g=Xa.a.instance.zf("WordEditor.Bookmark.FullBookmarkManager").value}static get Jc(){return $g.a.instance}static get Tgd(){null==mf.ODb&&(mf.ODb=
y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return mf.ODb}static get fBa(){null==mf.Sea&&(mf.Sea=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return mf.Sea}static get Gs(){return null!=mf.j1g?mf.j1g:mf.j1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ug(){return null!=mf.CXg?mf.CXg:mf.CXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Qcb(){mf.P_e||(mf.P_e=
y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"):!1);return mf.P_e}static get Nqc(){var b;mf.uHb||(mf.uHb=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.insertLinkDialogRefactorEnabled",!1));return mf.uHb}static get rsp(){mf.oNh||(mf.oNh=y.AFrameworkApplication.J?y.AFrameworkApplication.J.sc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return mf.oNh}static mc(){const b=
y.AFrameworkApplication.va;b.qa(fb.a.PT,ic.a.view,mf.BUb);b.qa(fb.a.PT,ic.a.kd,mf.ccb);b.qa(fb.a.PT,ic.a.Nd,mf.ccb);b.Oc(fb.a.PT,1028);mf.Nqc&&(b.qa(fb.a.dNb,ic.a.Nd,mf.dNb),b.qa(fb.a.dNb,ic.a.kd,mf.dNb));b.qa(fb.a.GQb,ic.a.view,mf.BUb);b.qa(fb.a.GQb,ic.a.kd,mf.ccb);b.qa(fb.a.GQb,ic.a.Nd,mf.ccb);b.Oc(fb.a.GQb,1028);b.qa(fb.a.YZ,ic.a.view,mf.BUb);b.qa(fb.a.YZ,ic.a.kd,mf.xIj);b.qa(fb.a.YZ,ic.a.Nd,mf.xIj);b.Oc(fb.a.YZ,1028);b.qa(fb.a.Oze,ic.a.view,mf.BUb);b.qa(fb.a.Oze,ic.a.kd,mf.wQj);b.qa(fb.a.Oze,
ic.a.Nd,mf.wQj);b.qa(fb.a.Beb,ic.a.view,mf.BUb);b.qa(fb.a.Beb,ic.a.kd,mf.yvj);b.qa(fb.a.Beb,ic.a.Nd,mf.yvj);b.qa(fb.a.Beb,ic.a.image,mf.Glg);b.qa(fb.a.Beb,ic.a.GRb,mf.Glg);b.qa(fb.a.Beb,ic.a.Fba,mf.Glg);b.qa(fb.a.yYc,ic.a.application,mf.yYc);b.qa(fb.a.UZc,ic.a.view,mf.BUb);mf.Qcb&&(b.nb(wb.a.rfb,ic.a.view,this.BUb.bind(this),1028),b.qa(wb.a.rfb,ic.a.kd,this.rfb.bind(this)),b.qa(wb.a.rfb,ic.a.Nd,this.rfb.bind(this)),b.Oc(wb.a.rfb,1028),b.qa(wb.a.jZf,ic.a.kd,this.rfb.bind(this)),b.qa(wb.a.jZf,ic.a.Nd,
this.rfb.bind(this)),b.Oc(wb.a.jZf,1028),b.qa(wb.a.apg,ic.a.view,this.apg.bind(this)),b.qa(wb.a.Uog,ic.a.view,this.Uog.bind(this)),b.nb(wb.a.hvb,ic.a.kd,this.hvb.bind(this),1028),b.nb(wb.a.hvb,ic.a.Nd,this.hvb.bind(this),1028))}static yYc(){return 32}static rfb(b,h,r){if(!mf.Qcb)return 2;b=mf.Sfk(h);if(32!=b)return b;if(!mf.h_a(h,!0).returnValue||mf.Khc(h))return 8;1!==r||mf.qui||(mf.MIe(!0),mf.qui=!0);return 32}static apg(b,h,r,A,L){if(!mf.Qcb)return 2;if(1===r)return 32;mf.Ywe(mf.oPk,mf.pPk,mf.vGh);
mp.a.instance.Ae(()=>{mf.MIe();L.MenuItems=Object.assign(new dk.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ba=this.Cfi();ba?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),L.MenuItems.MenuSectionList.push(ba)):mf.yzj(L,mf.vGh)},"HA:PRLF");return 32}static Uog(b,h,r,A,L){if(!mf.Qcb)return 2;if(1===r)return 32;mf.Ywe(mf.mPk,mf.nPk,mf.uGh);mp.a.instance.Ae(()=>{mf.MIe();L.MenuItems=Object.assign(new dk.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],
UpdateDynamically:!0});L.MenuItems.MenuSectionList.push(this.YMl());const ba=this.Cfi(!0);ba?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),L.MenuItems.MenuSectionList.push(ba)):mf.yzj(L,mf.uGh)},"HA:PILF");return 32}static yzj(b,h){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);mf.Ywe(mf.PLk,mf.QLk,h);b.MenuItems.MenuSectionList.push(this.GPl());mf.MIe(!0)}static GPl(){const b=this.Ywf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new qg.a,
{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static YMl(){const b=this.Ywf("InsertLinkSection");b.ControlList.push(Object.assign(new qg.a,{ExternalId:"InsertLink"}));return b}static Cfi(b=!1){if(Oj.instance.NNd){var h=this.Ywf("RecentLinksSection",b);b=JSON.parse(Oj.instance.NNd);this.MNd.clear();b.forEach((r,A)=>{this.MNd.set(A,[r.FileName,r.DocumentUrl]);const L=mf.lOm(r.FileName);var ba=mf.wAm(r.TimeStamp),ra=h.ControlList,Ia=ra.push,
Ta=Object,ob=Ta.assign,nb=new qg.a,Eb=wb.a.hvb,bc=wb.a.hvb;ba=L!==r.FileName?r.FileName+"\n"+ba:ba;var Bc=r.FileName;let Yc="SaveAsWordDocx_32";switch(r.App){case "Word":Yc="SaveAsWordDocx_32";break;case "PowerPoint":Yc="SaveAsPowerPointPptx_32";break;case "Excel":Yc="SaveAsExcelXlsx_32"}Ia.call(ra,ob.call(Ta,nb,{ExternalId:A,Command:Eb,CommandValueId:bc,LabelText:L,Alt:ba,AriaDescription:Bc,ExternalImageId:Yc,KeyTip:r.FileName}))});return h}}static Ywf(b,h=!1){return Object.assign(new Zd.a,{Title:h?
Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static hvb(b,h,r,A,L){if(!mf.Qcb)return 2;if(!L||L.CommandValueId!=wb.a.hvb)return 32;mf.Ywe(mf.PFk,mf.QFk,mf.CQk);r=h;h=new hb.GraphTransaction(15);h.Bh=b;h.Eb(r.node);A=mf.h_a(r,!0).hyperlink;r=Ee.a.C4b(r);if(A)mf.Zvg(r),b=Tb.SelectionFactory.eN(r.node,Math.min(r.cpBegin,A.cpBegin),Math.max(r.cpEnd,A.cpEnd)),Fg.a.instance.Uc(b),r=b.Ya;else if(Ee.a.Df(r)){var ba;Ee.a.twb(r)&&
(ba=Ee.a.M8(r,!1));ba||(ba=this.MNd.get(L.SourceControlId)[0],mf.Ug.lf(r,ba,!0,void 0,b),ba=Tb.SelectionFactory.eN(r.node,r.cpBegin,r.cpBegin+ba.length));if(ba&&(Fg.a.instance.Uc(ba),r=ba.Ya,mf.Khc(r)))return mf.Yd.f3b(!1),8}try{mf.Gs.SJ(r,this.MNd.get(L.SourceControlId)[1],0<Mc.a.pnc(r).length);const ra=Tb.SelectionFactory.Ie(r.node,r.cpEnd);ra&&Fg.a.instance.Uc(ra);m(L,"RecentLinks")}finally{h&&h.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static BUb(b,h,r,A,
L){if(mf.Tgd)return mf.Z9m(b,h,r,A,L);if(!h.view.Ee)return 2;var ba=h.view.ub;if(!ba||!ba.ob||!ba.ob.length)return 8;var ra=ba.ob.currentSelection;let Ia=ra.Ya.clone();if(2===ra.length){if(ra=ra.K(1),!Ee.a.Rm(Ia)||!Ee.a.em(ra)||Ia.node!==ra.node)return 8}else if(2<ra.length)return 8;if(ba.ob.IN)return 8;if(Object(ak.a)().eHa(rd.ParagraphReader.uZ,ba.hh))return mf.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),8;rd.ParagraphReader.Xn(Ia)&&!Ee.a.Zca(Ia)&&(ba=Ia.node,Ia=vc.a.createTextRange(ba,0,rd.ParagraphReader.textLength(ba)));
return b===fb.a.UZc?mf.Eci(h,Ia,r,A):y.AFrameworkApplication.va.Sf(Ia,b,r,!0,A,L)}static Z9m(b,h,r,A,L){if(!h.view.Ee)return 2;var ba=h.view.ub;if(!ba||!ba.ob||!ba.ob.length||ba.ob.IN)return 8;var ra=ba.ob.currentSelection;if(ba=mf.x4f(ra))ra=mf.aSf(ra.Ya.clone(),!0);else{let Ia=ra.K(0).clone(),Ta=1;for(;Ta<ra.length&&(!rd.ParagraphReader.textLength(Ia.node)||Ee.a.em(Ia)||mf.fBa&&kp.l(Ia));)Ia=ra.K(Ta).clone(),Ta++;ra=mf.aSf(Ia,!1)}return mf.fBa&&Ee.a.Rm(ra)&&kp.l(ra)||!Ee.a.Rm(ra)&&!ba?8:b===fb.a.UZc?
mf.Eci(h,ra,r,A):y.AFrameworkApplication.va.Sf(ra,b,r,!0,A,L)}static x4f(b){if(1===b.length)return!0;if(2===b.length){const h=b.Ya.clone();b=b.K(1);return Ee.a.Rm(h)&&Ee.a.em(b)&&h.node===b.node?!0:!1}return!1}static J$h(b){let h=null;const r=[];for(let A=0;A<b.length;A++){const L=mf.aSf(b.K(A).clone(),!1);if(Ee.a.Rm(L))mf.fBa&&kp.l(L)||r.push(L);else if(!Ee.a.em(L)&&!rd.ParagraphReader.Xn(L))return{returnValue:!1,YBa:h}}h=r;return{returnValue:!mf.fBa||0<h.length?!0:!1,YBa:h}}static dNb(b,h,r,A,L){var ba;
Yb.a.mark(5562);b=Mc.a.pnc(h);r=Object(Vb.a)().Pd;(null===(ba=If.a.Gd())||void 0===ba?0:ba.pn)&&r.ub.wMb();ba=new hb.GraphTransaction(15);ba.Eb(h.node);h.node.bK().qG.k4(4);r=L.txtDisplay;let ra=!1;if(null!=L.linkurl)if(ra=!0,L.isHeading){m(L,"Heading");const Ia=L.paragraphNode,Ta=L.startCp,ob=L.endCp;A=mf.czi.dzi(Ia);mf.czi.Eec(A,Ta,ob,Ia,Ia,!1)}else m(L,"Bookmark"),A=L.linkurl;else m(L,"Url"),A=L.txtLink.trim();a(h,L).ccb(r,A,b,ra);ba.Bh=fb.a.dNb;ba.dispose();Yb.a.mark(5563);h.node.XQb();return 32}static ccb(b,
h,r,A,L){if(mf.Tgd)return mf.ohn(h,r,L);A=mf.Sfk(h);if(32!==A)return A;let ba;if(!({hyperlink:ba}=mf.h_a(h,!0)).returnValue||mf.Khc(h)||!ba&&b==fb.a.GQb)return 8;if(1===r)return 32;if(!ba&&Ee.a.Df(h)&&Ee.a.twb(h)&&(b=Ee.a.M8(h,!1))&&(Fg.a.instance.Uc(b),h=b.Ya,mf.Khc(h)))return mf.Yd.f3b(!1),8;ba&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");L=a(h,L);mf.Nqc&&L.p_j();return 32}static Sfk(b){return!mf.UXd(b)||b.node.pr||Fg.a.instance.ob.IN?8:Ee.a.v9(b)||bi.a.w1f(b)?2:32}static ohn(b,h,r){var A=
Fg.a.instance.ob.currentSelection;const L=mf.x4f(A);if(L)b=[b];else if(!({YBa:b}=mf.J$h(A)).returnValue)return 8;for(A=0;A<b.length;A++)if(!mf.UXd(b[A]))return 8;if(Fg.a.instance.ob.IN)return 8;A=Array(b.length);let ba=null;for(let ra=0;ra<b.length;ra++)if(A[ra]=b[ra],!({hyperlink:ba}=mf.h_a(A[ra],!0)).returnValue||mf.Khc(A[ra]))return 8;if(1===h)return 32;if(!ba&&1===A.length&&L&&Ee.a.Df(A[0])&&Ee.a.twb(A[0])&&(h=Ee.a.M8(A[0],!1))&&(Fg.a.instance.Uc(h),A[0]=h.Ya,mf.Khc(A[0])))return mf.Yd.f3b(!1),
8;L?(r=a(A[0],r),mf.Nqc&&r.p_j()):new bp(A,r);return 32}static xIj(b,h,r){if(mf.Tgd)return mf.RGo(b,h,r);if(!mf.UXd(h)||Ee.a.v9(h))return 2;let A;if(!({hyperlink:A}=mf.h_a(h,!1)).returnValue)return 2;if(2===r){r=new hb.GraphTransaction(15);try{r.Bh=b,r.Eb(A.paragraph),mf.Zvg(h)}finally{r&&r.dispose()}A.hyperlink.hK&&mf.Yd.Vv(2)}return 32}static RGo(b,h,r){var A=Fg.a.instance.ob.currentSelection;if(mf.x4f(A))h=[h];else if(!({YBa:h}=mf.J$h(A)).returnValue)return 8;for(A=0;A<h.length;A++)if(!mf.UXd(h[A]))return 8;
if(1===r&&!mf.h_a(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!mf.h_a(h[r],!0).returnValue)return 2;r=new hb.GraphTransaction(15);try{const L=h[0];r.Bh=b;r.Eb(L.node);for(b=0;b<h.length;b++)mf.Zvg(h[b])}finally{r&&r.dispose()}mf.Yd.Vv(7)}return 32}static Zvg(b){const h=Mc.a.pnc(b);let r=0;for(let A=0;A<h.length;A++)if(h[A].cpBegin>=r){const L=({cpEnd:r}=mf.O1.vna(b,h[A])).returnValue;mf.O1.nIj(b,L)}}static wQj(b,h,r){if(pe.a.mcb(h)||!({hyperlink:b}=mf.h_a(h,!1)).returnValue)return 2;
if(2===r){const {cpBegin:A,cpEnd:L}=mf.O1.vna(h,b);Fg.a.instance.Uc(Tb.SelectionFactory.eN(b.paragraph,A,L))}return 32}static yvj(b,h,r){if(({hyperlink:b}=mf.IBn(h)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=mf.h_a(h,!1)).returnValue)return 2;2===r&&Ze.a.MRb(b.hyperlink.url);return 32}static Glg(b,h,r){b=pe.a.vna(h.node);if(!b)return 2;2===r&&Ze.a.MRb(b);return 32}static Eci(b,h,r,A){if(pe.a.mcb(h)||!Object(Vb.a)().Ve.ql)return 2;
let L;if(!({hyperlink:L}=mf.h_a(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:ba,cpEnd:ra}=mf.O1.vna(h,L);Fg.a.instance.Uc(Tb.SelectionFactory.eN(L.paragraph,ba,ra));h=Object(Vb.a)().qma.ownerDocument.createElement("span");h.innerText=L.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return y.AFrameworkApplication.va.Sf(b,fb.a.z0d,2,!0,A,h)}static h_a(b,h){if(Ee.a.Rm(b)){const r=kp.g(b),A=lf.a.all(r,L=>6===L.xi);if(0<r.length&&(!mf.fBa||!A)||mf.Ig.ii&&mf.v8&&0<mf.v8.Y8d(b).count)return{returnValue:!1,
hyperlink:null}}return mf.xBn(b,h)}static IBn(b){let h=null;return pe.a.mcb(b)&&(h=Mc.a.wmc(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static xBn(b,h){let r=null;const A=Mc.a.pnc(b);return A.length?A[0].hyperlink?(r=A[0],b.cpBegin<A[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static Khc(b){b=mf.Ni.sDa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.K(h).Sd.changeType)return!0;return!1}static UXd(b){return mf.Ig.t4(b)||
mf.Ig.koa(b)||mf.lA()&&mf.lA().instance&&mf.lA().instance.wZ(b)?!1:!0}static aSf(b,h){return rd.ParagraphReader.Xn(b)&&!Ee.a.Zca(b)&&(rd.ParagraphReader.textLength(b.node)||h)?vc.a.createTextRange(b.node,0,rd.ParagraphReader.textLength(b.node)):b}static lOm(b){return b&&b.length<=mf.TEj?b:b.substring(0,mf.TEj)+"..."}static wAm(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",
minute:"numeric"}))}catch(h){return""}}static MIe(b=!1){const h=Date.now();if(b||h-mf.P$i>mf.rsp)Oj.instance.TPn(),mf.P$i=h}static Ywe(b,h,r){const A=new Map;A.set("Source",r);A.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.k5a,A)}}mf.Qo=null;mf.ODb=null;mf.uHb=null;mf.Sea=null;mf.MNd=new Map;mf.P_e=null;mf.TEj=35;mf.P$i=Date.now();mf.qui=!1;mf.k5a="wwaengidc";mf.CQk="RecentLinks";mf.vGh="RecentLinksRibbonOptions";mf.uGh="RecentLinksContextMenuOptions";mf.oPk="PopulateRecentLinksRibbon";
mf.pPk="PopulateRecentLinksRibbonAction";mf.mPk="PopulateRecentLinksContextMenu";mf.nPk="PopulateRecentLinksContextMenuAction";mf.PLk="PopulateRecentLinksContextMenu";mf.QLk="PopulateRecentLinksContextMenuAction";mf.PFk="InsertRecentLinks";mf.QFk="InsertRecentLinksAction";Object(u.a)(mf,"HyperlinkActor",null,[]);class YE{}YE.hOa=Object.freeze({sbn:"WordIndentationShortcutUsage"});YE.GB="wwaengidc";Object(u.a)(YE,"IndentationConstants",null,[]);class pv{static get WEn(){return pv.tJd}static QJl(b,
h,r){try{pv.tJd=pv.dOl(b,h,r)}catch(A){pv.tJd=null,v.ULS.yA(539787540,393,10,A,"Error in creating autoTriggerTextContext: {0}",A instanceof Error?A.message:"Unknown Error")}}static dMj(){pv.tJd=null}static dOl(b,h,r){if(!nf.a.Wg(h))throw v.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const A=nf.a.a9(h);if(null===A||void 0===A||!A.id)throw v.ULS.sendTraceTag(539787542,393,10,"No list item node with id found under outline element"),
Error("No list item node with id found under outline element");h=r.Fy(h);if(!h)throw v.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new pv(b,A.id,h)}constructor(b,h,r){this.E8j=b;this.KHn=h;this.fvg={listType:r.listType,listStyle:r.listStyle,hle:r.Ez}}Bxn(b,h){return h&&b&&this.KHn===b.id&&h.listType===this.fvg.listType&&h.listStyle===this.fvg.listStyle&&h.Ez===this.fvg.hle}}pv.tJd=null;Object(u.a)(pv,"AutoTriggerTextContext",
null,[]);var Tt;(function(b){b[b.none=0]="none";b[b.Amp=1]="style1";b[b.Bmp=2]="style2";b[b.Cmp=3]="style3";b[b.Dmp=4]="style4";b[b.Emp=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Tt||(Tt={}));Object(u.b)("ListStyle",Tt);const $C={[Tt.Amp]:{[1]:"disc",[0]:"decimal"},[Tt.Bmp]:{[1]:"circle",[0]:"lower-alpha"},[Tt.Cmp]:{[1]:"square",[0]:"lower-roman"},[Tt.Dmp]:{[0]:"upper-alpha"},[Tt.Emp]:{[0]:"upper-roman"},[Tt.bullet]:{[1]:"bullet"}};var Zs;(function(b){b[b.number=0]="number";b[b.bullet=
1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.smq=16]="noList";b[b.invalid=42]="invalid"})(Zs||(Zs={}));Object(u.b)("ListType",Zs);class Oq{constructor(b,h){this.ZC=this.Ced=null;this.levelText=b;this.font=h}get tue(){return this.levelText}get listStyle(){return 6}get Dz(){return"left"}}Object(u.a)(Oq,"ListMarkerBullet",null,[471]);class Ih{static get om(){return null!=Ih.u5g?Ih.u5g:Ih.u5g=Xa.a.instance.resolve("Box4.List.IListEditor")}static get QXj(){if(null!=Ih.I8g)var b=
Ih.I8g;else{var h;y.AFrameworkApplication.ud("2g5eb101;d5ebj317");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.addActionIdInTransaction",!1);b=Ih.I8g=b}return b}static get Vd(){return Ih.zg||(Ih.zg=Xa.a.instance.resolve("Box4.List.IListReader"))}static set Vd(b){Ih.zg=b}static get Ok(){return null!=Ih.D1g?Ih.D1g:Ih.D1g=Xa.a.instance.resolve("Box4.IInsertionPointFormatting")}static lA(){return Ih.Qo||(Ih.Qo=Xa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}static get du(){return qh.a.getInstance()}static get ftd(){return null!=
Ih.c9g?Ih.c9g:Ih.c9g=Xa.a.instance.Wa("Box4.List.ISingleLevelListEditor")}static mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.FF,ic.a.view,Ih.gWc);b.qa(fb.a.FF,ic.a.gU,Ih.Vsa);b.Oc(fb.a.FF,1036);b.qa(fb.a.KP,ic.a.view,Ih.gWc);b.qa(fb.a.KP,ic.a.gU,Ih.Vsa);b.Oc(fb.a.KP,1036);b.qa(fb.a.tia,ic.a.view,Ih.gWc);b.qa(fb.a.tia,ic.a.gU,Ih.Vsa);b.Oc(fb.a.tia,1036);b.qa(fb.a.Mlf,ic.a.view,qf.ActionManager.qg);b.qa(fb.a.U7h,ic.a.view,qf.ActionManager.qg);b.qa(fb.a.T5f,ic.a.view,Ih.vNo);b.qa(fb.a.xlf,ic.a.view,
qf.ActionManager.qg);b.qa(fb.a.Plf,ic.a.view,qf.ActionManager.qg);b.qa(fb.a.lKg,ic.a.view,qf.ActionManager.qg);b.qa(fb.a.t4j,ic.a.view,qf.ActionManager.qg);b.qa(fb.a.NHe,ic.a.view,qf.ActionManager.qg)}static vNo(){pv.dMj();return 32}static gWc(b,h,r,A,L){var ba,ra,Ia;if(!h.view.Ee)return 2;const Ta=Ih.Jc.vr(fb.a.gWc);A.Av=42;A.hG=42;const ob={[Bp.a.FRa]:5796,[Bp.a.ERa]:5797};var nb=h.view;if(Object(ak.a)().YKa(Ih.O$m,nb.ub.hh))return Ih.Jc.qc(pf.a.$e,{["Reason"]:uf.a.ruf}),Ta.end(),8;if(Object(ak.a)().YKa(Ih.Qkf,
nb.ub.hh))return Ih.Jc.qc(pf.a.$e,{["Reason"]:uf.a.sZc}),Ta.end(),8;if(Object(ak.a)().eHa(rd.ParagraphReader.uZ,nb.ub.hh))return Ih.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),Ta.end(),8;if(Ih.Ig.gqc(nb.ub.hh))return Ih.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),Ta.end(),8;if(null===(ra=null===(ba=Ih.lA())||void 0===ba?void 0:ba.instance)||void 0===ra?0:ra.wZ(h))return Ih.Jc.qc(pf.a.$e,{["Reason"]:uf.a.R$a}),Ta.end(),8;if(1===r)return Ta.end(),32;L||(L=new Ai.DictionaryPropertySet);if(qh.a.kmn&&2===r){h=new hb.GraphTransaction(15);
h.Eb(nb.Fd);Ih.QXj&&(h.Bh=b);const {Tna:Eb,zsb:bc}=Ih.pAj(b,L);Ih.om.Itp(nb.ub.ob.currentSelection,Eb,bc);h.dispose();Ta.end();return 32}ba=null;if(2===r){ba=new hb.GraphTransaction(15);Ih.QXj&&(ba.Bh=b);ba.Eb(h.view.Fd);Ih.edd=!1;ra=Rh.OutlineElementGeneralizer.lna(nb.ub.ob,!1);if(!ra)return ba.dispose(),Ih.Jc.qc(pf.a.pua,{["Reason"]:uf.a.R5d}),Ta.end(),8;1<ra.length&&L.setValue(Pd.a.Clj,null);const Eb=L.ka(Pd.a.MN,-1),bc=L.ka(Pd.a.dE,-1);null===(Ia=Ih.ftd)||void 0===Ia?void 0:Ia.wwl(ra);if(Ia=Ih.C9o(Eb,
bc,ra))L.setValue(Pd.a.dE,16),L.setValue(Pd.a.z_a,0);if(!Ee.a.Df(nb.ub.hh)&&!Ia&&0<ra.length&&Eb){nb=new te.a;Ia=Array(ra.length);for(let Bc=0;Bc<ra.length;Bc++)nb.set(ra.getContext(Bc).node),Ia[Bc]=Ih.Vd.Fy(nb);Ih.B9o(Ia,L)&&(nb=new Ai.DictionaryPropertySet,nb.setValue(Pd.a.dE,16),nb.setValue(Pd.a.z_a,0),nb.setValue(Kh.a.bwa,"clean-list-before-apply-new-list-style"),nb.setValue(Kh.a.Aoa,L.ka(Kh.a.bwa,"unknown")+"@"+L.ka(Kh.a.Aoa,"undefined")),Bp.a.Nwa(b,h,r,A,nb,ob,11),y.AFrameworkApplication.va.Vb(fb.a.t4j,
2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Ih.edd=!0)}nb=new te.a;nb.set(ra.getContext(0).node);nb=Ih.Vd.Fy(nb);Ih.mMn(Eb,bc,nb,ra.length)}b=Bp.a.Nwa(b,h,r,A,L,ob,11);32===b&&L.ka(Pd.a.D_h,!1)&&(b=Bp.a.Nwa(fb.a.dT,h,r,A,L,ob,11));ba&&ba.dispose();Ta.end();return b}static B9o(b,h){let r=null;var A=!1;for(let L=b.length-1;0<=L&&(r?(A=b[L],A=-1!==h.ka(Pd.a.MN,-3)?A?r.listType!==A.listType||r.listStyle!==A.listStyle:!0:A?r.listType!==A.listType:!0):r=b[L],
!A);L--);return r&&(b=!1,A||(b=h.ka(Pd.a.dE,42),h=h.ka(Pd.a.MN,-3),b=b!==r.listType||0<h),A||b)?!0:!1}static mMn(b,h,r,A){0>=A||Ih.edd||(b?r?(r=r.listType,-1===b&&h===r?(y.AFrameworkApplication.va.Vb(fb.a.NHe,2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(y.AFrameworkApplication.va.Vb(h?fb.a.xlf:fb.a.Plf,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(y.AFrameworkApplication.va.Vb(h?
fb.a.xlf:fb.a.Plf,2),Ih.twp(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(y.AFrameworkApplication.va.Vb(fb.a.NHe,2),v.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static C9o(b,h,r){if(-1!==b&&b||!r.length)return!1;b=new te.a;let A=null;for(let L=r.length-1;0<=L&&!(b.set(r.getContext(L).node),A=Ih.Vd.Fy(b));L--);return A&&h===A.listType?!0:!1}static Vsa(b,h,r,A,L){var ba;if(h.contextId!==ic.a.gU)return 2;
var ra=h.clone().hIg();if(Ih.Ig.Rcb(ra))return Ih.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),2;ra=new te.a;ra.set(h.node);Ee.a.uw(ra);Ih.W8f&&ih.TableCellReader.lda(ra)&&(h=new Map,h.set(Gi.a.Rbd,(!0).toString()),Ih.nFj(h));if(!Mb.a.ji(ra))return 2;if(1===r)switch(b){case fb.a.FF:return 32;case fb.a.KP:return 32;case fb.a.tia:return 32;default:return 2}if(Mb.a.LV(ra))return Ih.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.NS}),2;h=Ih.Vd.Fy(ra);const Ia=Object.freeze(null===h||void 0===h?void 0:h.clone());if(!L)return 8;
const {kf:Ta,Tna:ob,zsb:nb}=Ih.pAj(b,L);Ih.C4o(Ta,ra);var Eb=Ih.om.Vsa(Ta,ra,ob,nb);if(!Eb.returnValue)return Ih.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.T7f}),2;Eb=Eb.Tna;Ih.kyo(ra,L,Ia,Eb);2===r&&(r=L.ka(Pd.a.dE,-1),Eb&&-1!==r&&((ra=L.ka(Rc.a.Cu,"Invalid MultiLevel Type"),b===fb.a.KP&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===L||void 0===L?void 0:L.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Tt[null==(null===
h||void 0===h?void 0:h.listStyle)?null===Eb||void 0===Eb?void 0:Eb.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Zs[null==(null===h||void 0===h?void 0:h.listType)?null===Eb||void 0===Eb?void 0:Eb.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===Eb||void 0===Eb?void 0:Eb.listType)})),h)?Eb.listType&&1!==Eb.listType||Ih.edd||(y.AFrameworkApplication.va.Vb(fb.a.lKg,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":
"Numbering",ra)):16===Eb.listType?(y.AFrameworkApplication.va.Vb(fb.a.U7h,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",ra)):Eb.listType&&1!==Eb.listType||Ih.edd||(y.AFrameworkApplication.va.Vb(fb.a.Mlf,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",ra))),b=Jc.FocusManager.instance(),(null===(ba=null===b||void 0===b?void 0:b.currentScope)||void 0===ba?void 0:ba.name)===Uk.a.uxa&&b.scopeChanged(Df.AFrame.Co));
A.Av=Eb.listType;A.hG=Eb.listStyle;return 32}static get W8f(){if(null!=Ih.W5g)var b=Ih.W5g;else{var h;y.AFrameworkApplication.ud("534af766;70gef585");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.listWithinTablesLoggingEnabled",!1);b=Ih.W5g=b}return b}static nFj(b){const h=b.has(Gi.a.Rbd)?b.get(Gi.a.Rbd):"false";b=b.has(Gi.a.Tee)?b.get(Gi.a.Tee):"unknown";const r=new Map;r.set(Gi.a.Rbd,h);r.set(Gi.a.Tee,b);Ca.Health.instance.recordKpiUsage(Gi.a.hOa.THn,
0,Gi.a.GB,r)}static pAj(b,h){let r;b===fb.a.KP||b===fb.a.FF||b===fb.a.tia?(h=Ih.om.A2c(b,h),r=Yr.a.LY(h.getValue(Pd.a.dE),h.getValue(Pd.a.z_a))):r=null;Ih.v5(b,h);let A=!1;if(!r)return v.ULS.sendTraceTag(508155328,393,50,"Returning null list info from prepareArgsForApplyBulletsNumbering"),{kf:h,Tna:r,zsb:A};Ih.K2o(r,h);b===fb.a.FF&&h&&(h.hasProperty(Rc.a.Qy)&&(r.levelText=h.getValue(Rc.a.Qy)),h.hasProperty(Sb.a.font)&&(r.font=h.getValue(Sb.a.font)),h.hasProperty(Pd.a.fIf)&&(A=h.getValue(Pd.a.fIf)));
return{kf:h,Tna:r,zsb:A}}static kyo(b,h,r,A){var L,ba,ra,Ia,Ta,ob,nb,Eb;const bc=new Map;bc.set("actionCallSource",h.ka(Kh.a.bwa,"unknown"));bc.set("actionCallSourceTrigger",h.ka(Kh.a.Aoa,"undefined"));bc.set("fromListType",Zs[null!==(L=null===r||void 0===r?void 0:r.listType)&&void 0!==L?L:16]);bc.set("fromListStyle",Tt[null!==(ba=null===r||void 0===r?void 0:r.listStyle)&&void 0!==ba?ba:0]);bc.set("fromListMarkerType",null!==(Ta=l(null!==(ra=null===r||void 0===r?void 0:r.listStyle)&&void 0!==ra?ra:
0,null!==(Ia=null===r||void 0===r?void 0:r.listType)&&void 0!==Ia?Ia:16))&&void 0!==Ta?Ta:"undefined");bc.set("fromLevelText",(null===r||void 0===r?0:r.CDa)?r.levelText:"undefined");bc.set("toListType",null!==(ob=Zs[null===A||void 0===A?void 0:A.listType])&&void 0!==ob?ob:"undefined");bc.set("toListStyle",null!==(nb=Tt[null===A||void 0===A?void 0:A.listStyle])&&void 0!==nb?nb:"undefined");bc.set("toListMarkerType",null!==(Eb=l(null===A||void 0===A?void 0:A.listStyle,null===A||void 0===A?void 0:A.listType))&&
void 0!==Eb?Eb:"undefined");bc.set("toLevelText",(null===A||void 0===A?0:A.CDa)?A.levelText:"undefined");qh.a.zxn&&bc.set("underHeaderFooterKind",this.Vd.nEi(b.currentNode));Ca.Health.instance.recordKpiUsage(Gi.a.hOa.WHn,0,Gi.a.GB,bc)}static C4o(b,h){var r=new te.a;r.Ad(h);(h=r.ic(2))&&rd.ParagraphReader.lc(h)&&(r=Fg.a.instance.ob.currentSelection)&&r.Ya&&r.Ya.node===h&&Ee.a.jje(r)&&(Ih.U0o(b),Ih.S0o(b))}static K2o(b,h){h.hasProperty(Rc.a.Cu)&&b.qBe(h.getValue(Rc.a.Cu));h.hasProperty(Kh.a.AV)&&(b.AV=
h.getValue(Kh.a.AV));h.hasProperty(Rc.a.Qy)&&(b.levelText=h.getValue(Rc.a.Qy));b.MN=h.ka(Pd.a.MN,-1);let r=null;b.Ova&&(r=Ih.mFm(b,h));b.Ova&&r?Ih.w4o(b,r):(b.Ova?v.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.MN,b.Cu,b.NB):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Ih.F_o(b))}static F_o(b){if(b.NB)b.jde&&-1===b.MN||(b.levelText="%1.",
b.kf.hasProperty(Sb.a.O9)||b.iea(0,1));else if(1===b.listType)b.jde&&-1===b.MN||(b.font=Gi.a.s0c,b.levelText=Gi.a.i2d,b.kf.hasProperty(Sb.a.O9)||b.iea(1,6));else return;b.Dz="left"}static w4o(b,h){1===b.Cu?Ih.h3o(b,h):Ih.w1o(b,h)}static h3o(b,h){(b.ZC=h.ZC)?b.S$=h.ZC.S$:h.ZC||v.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.MN,b.Cu,b.NB)}static w1o(b,h){b.levelText=h.levelText;b.NB?b.iea(0,h.listStyle):
(b.font=h.font,b.iea(1,1));b.Dz=h.Dz}static mFm(b,h){let r=null;2===b.Cu?r=b.NB?Xa.a.instance.Wa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Xa.a.instance.Wa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Cu&&(r=Xa.a.instance.Wa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let A=r.yXb.value;const L=b.MN+"";L in A||(A=r.oda,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
L,b.Cu,b.NB));if(!(L in A)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",L,b.Cu,b.NB);if(h.hasProperty(Sb.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",L,b.Cu,b.NB),b=h.getValue(Sb.a.font),new Oq(D.a.fromCharCode(parseInt(L)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
L,b.Cu,b.NB)}return A[L]}static S0o(b){Ih.Ok.hasProperty(Sb.a.fontColor)&&b.setValue(Sb.a.fontColor,Ih.Ok.fontColor())}static U0o(b){Ih.Ok.hasProperty(Sb.a.fontSize)&&b.setValue(Sb.a.fontSize,Ih.Ok.fontSize())}static v5(b,h){b=b===fb.a.FF?0:b===fb.a.KP?1:b===fb.a.tia?2:-1;h=h.ka(Pd.a.MN,-1);v.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static twp(){const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");if(b){var h=y.AFrameworkApplication.J.sc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Ih.O$m=pe.a.Cbd;Ih.Qkf=pe.a.lcb;Ih.zg=null;Ih.Qo=null;Ih.edd=!1;Object(u.a)(Ih,"ListActor",null,[]);class Gm{static get Hs(){return px.a.hTb}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}static get wu(){return Object(Vb.a)()}static lA(){return Gm.Qo||
(Gm.Qo=Xa.a.instance.Za("Box4.IExternalSelectionManager"))}static get rbn(){return null!=Gm.v1g?Gm.v1g:Gm.v1g=Xa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.uK,ic.a.view,Gm.lWc);b.qa(fb.a.uK,ic.a.gU,Gm.FYh);b.Oc(fb.a.uK,1036);b.qa(fb.a.dT,ic.a.view,Gm.lWc);b.qa(fb.a.dT,ic.a.gU,Gm.FYh);b.Oc(fb.a.dT,1036)}static dyo(b){const h=new Map;b=b?b.ka(Kh.a.Vee,"Unknown"):"tab";h.set("actionCallSource",b);Ca.Health.instance.recordKpiUsage(YE.hOa.sbn,
1,YE.GB,h)}static lWc(b,h,r,A,L){const ba=h.view;if(!ba.Ee)return 2;var ra=ba.ub;if(!ra)return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.xia}),8;ra=ra.hh;if(!ra)return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.Mo}),8;if(bi.a.bda(h))return 8;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Gm.Ig.gqc(ra))return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),8;if(1===r)return 32;if(Object(ak.a)().YKa(Gm.Qkf,ra))return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.sZc}),8;if(Object(ak.a)().eHa(rd.ParagraphReader.uZ,
ra))return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),8;if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Gm.Ig.gqc(ra))return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.EI}),8;if(Gm.lA()&&Gm.lA().instance&&Gm.lA().instance.wZ(ra))return Gm.Jc.qc(pf.a.$e,{["Reason"]:uf.a.R$a}),8;ra={};ra[Bp.a.FRa]=5794;ra[Bp.a.ERa]=5795;return Gm.rbn.lWc(ba,b,h,r,A,L,ra)}static FYh(b,h,r,A,L){var ba,ra;if(h.contextId!==ic.a.gU)return 2;var Ia=h.clone().hIg();if(Qh.TableReader.i8i(Ia)){if(Gm.Ig.j8i(Ia))return Gm.Jc.qc(pf.a.Lo,
{["Reason"]:uf.a.EI}),8}else if(Gm.Ig.Rcb(Ia))return Gm.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),2;Ia=new te.a;Ia.set(h.node);Ee.a.uw(Ia);if(!Mb.a.ji(Ia))return 2;Ih.W8f&&Gm.yzo(L,Ia);let Ta;switch(b){case fb.a.uK:Ta=Gm.Hs.fOb(Ia);break;case fb.a.dT:Ta=Gm.Hs.Kgc(Ia);break;default:return 2}if(1===r||!Ta)return Ta?32:8;r=0;b===fb.a.dT&&L&&L.ka(Pd.a.D_h,!1)&&(r|=2);if(Mb.a.LV(Ia))return Gm.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.NS}),2;(null===(ra=null===(ba=Gm.wu)||void 0===ba?void 0:ba.Pd)||void 0===ra?0:ra.xZ)&&
Gm.wu.Ve&&(Gm.wu.Ve.mM=!0);switch(b){case fb.a.uK:Gm.Hs.Z0a(Ia,-1,r);break;case fb.a.dT:Gm.Hs.H0c(Ia,1)}A&&ru.a.fCb&&(A.Av|=ru.a.gtb(h.node,!0));Gm.dyo(L);return 32}static yzo(b,h){ih.TableCellReader.lda(h)&&nf.a.Wg(h)&&(b=b?b.ka(Kh.a.Vee,"Unknown"):"Ribbon",h=new Map,h.set(Gi.a.Tee,b),h.set(Gi.a.Rbd,"true"),Ih.nFj(h))}}Gm.Qo=null;Gm.Qkf=pe.a.lcb;Object(u.a)(Gm,"IndentationActor",null,[]);var hn=e(1524);class ql{static get gm(){return null!=ql.q7g?ql.q7g:ql.q7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}static get Kj(){return null!=
ql.n$g?ql.n$g:ql.n$g=Xa.a.instance.resolve("Box4.ITableEditor")}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}static lA(){return ql.Qo||(ql.Qo=Xa.a.instance.Za("Box4.IExternalSelectionManager"))}static mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.KLg,ic.a.view,(h,r)=>bi.a.bda(r)?8:32);b.qa(fb.a.G9,ic.a.view,hn.a.oz);b.qa(fb.a.G9,ic.a.paragraph,ql.pKa);b.qa(fb.a.G9,ic.a.table,ql.amf);b.Oc(fb.a.G9,1036);b.qa(fb.a.Rba,ic.a.view,hn.a.oz);b.qa(fb.a.Rba,ic.a.paragraph,ql.pKa);
b.qa(fb.a.Rba,ic.a.table,ql.amf);b.Oc(fb.a.Rba,1036);b.qa(fb.a.p$,ic.a.view,hn.a.oz);b.qa(fb.a.p$,ic.a.paragraph,ql.pKa);b.qa(fb.a.p$,ic.a.table,ql.amf);b.Oc(fb.a.p$,1036);b.qa(fb.a.vMa,ic.a.view,hn.a.oz);b.qa(fb.a.vMa,ic.a.paragraph,ql.pKa);b.Oc(fb.a.vMa,1036);b.qa(fb.a.m1c,ic.a.view,hn.a.oz);b.qa(fb.a.m1c,ic.a.paragraph,ql.pKa);b.Oc(fb.a.m1c,1036);b.qa(fb.a.RWb,ic.a.view,hn.a.oz);b.qa(fb.a.RWb,ic.a.paragraph,ql.pKa);b.Oc(fb.a.RWb,1036);b.qa(fb.a.Trd,ic.a.view,hn.a.oz);b.qa(fb.a.Trd,ic.a.paragraph,
ql.pKa);b.Oc(fb.a.Trd,1036);b.qa(fb.a.$sc,ic.a.view,hn.a.oz);b.qa(fb.a.$sc,ic.a.paragraph,ql.pKa);b.Oc(fb.a.$sc,1036);b.qa(fb.a.ahc,ic.a.view,hn.a.oz);b.qa(fb.a.ahc,ic.a.paragraph,ql.pKa);b.Oc(fb.a.ahc,1036);b.qa(fb.a.Oyc,ic.a.view,hn.a.oz);b.qa(fb.a.Oyc,ic.a.paragraph,ql.pKa);b.Oc(fb.a.Oyc,1036);b.qa(fb.a.wlc,ic.a.view,hn.a.oz);b.qa(fb.a.wlc,ic.a.paragraph,ql.pKa);b.Oc(fb.a.wlc,1036)}static amf(b,h,r,A){let L=!0;if(!h)return 8;Qh.TableReader.i8i(h)?ql.Ig.j8i(h)?(ql.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),
L=!1):ql.lA()&&ql.lA().instance&&ql.lA().instance.wZ(h)&&(ql.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.R$a}),L=!1):(ql.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.MBf}),L=!1);if(1===r||!L)return L?32:8;h=h.node;switch(b){case fb.a.G9:ql.Kj.qJ(h,1);break;case fb.a.Rba:ql.Kj.qJ(h,2);break;case fb.a.p$:ql.Kj.qJ(h,3)}A&&ru.a.fCb&&(A.Av|=2);return 32}static pKa(b,h,r,A,L){let ba=!0;h.contextId!==ic.a.paragraph?ba=!1:ql.Ig.Rcb(h)?(ql.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),ba=!1):ql.lA()&&ql.lA().instance&&ql.lA().instance.wZ(h)&&
(ql.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.R$a}),ba=!1);if(1===r||!ba)return ba?32:8;h=h.node;r=rd.ParagraphReader.VA(h);switch(b){case fb.a.G9:case fb.a.$sc:ql.gm.qJ(h,1===r&&ql.Nje(L)?6:1);break;case fb.a.Rba:case fb.a.ahc:ql.gm.qJ(h,2===r&&ql.Nje(L)?1:2);break;case fb.a.p$:case fb.a.Oyc:ql.gm.qJ(h,3===r&&ql.Nje(L)?1:3);break;case fb.a.vMa:case fb.a.wlc:ql.gm.qJ(h,6===r&&ql.Nje(L)?1:6);break;case fb.a.RWb:ql.gm.qJ(h,11);break;case fb.a.m1c:ql.gm.qJ(h,7);break;case fb.a.Trd:ql.gm.qJ(h,13)}A&&ru.a.fCb&&(A.Av|=
ru.a.gtb(h));return 32}static Nje(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}ql.Qo=null;Object(u.a)(ql,"JustificationActor",null,[]);const $J=()=>{const b=y.AFrameworkApplication.va;b.qa(fb.a.save,dd.a.frame,Lw);b.qa(fb.a.sync,dd.a.frame,ZE)},ZE=(b,h,r)=>{if(1===r)return 32;y.AFrameworkApplication.va.Vb(fb.a.Pgc,2);Ze.a.wf.mFe();return 32},Lw=(b,h,r)=>{if(1===r)return 2===Db.StaticActiveAppFrame.Aa().mode?32:8;y.AFrameworkApplication.va.Vb(fb.a.Pgc,
2);if(2!==Db.StaticActiveAppFrame.Aa().mode)return 32;Ze.a.wf.$Oj(null,null);return 32};class Ny{constructor(){this.activateRibbonTab=(b,h,r,A,L)=>{Ze.a.HD.tL.vpd(L.toString());return 32};this.CFn=(b,h,r,A,L)=>{Ze.a.HD.tL.c$i(1,L.toString());return 32};this.Fao=(b,h)=>{if(h.contextId!==dd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.activateRibbonTab,ic.a.view,this.activateRibbonTab);b.Oc(fb.a.activateRibbonTab,5);b.qa(fb.a.d$i,ic.a.view,
this.CFn);b.qa(fb.a.GMg,dd.a.frame,this.Fao)}static get instance(){return null!=Ny.$1g?Ny.$1g:Ny.$1g=Ny.In()}static In(){return new Ny}}Object(u.a)(Ny,"RibbonActor",null,[]);class qv{constructor(b,h,r){this.yo=null;this.Zzp=(A,L,ba,ra,Ia)=>{var Ta;let ob;ra=this.Yfk(L);if(!ra)return 8;ob=A===fb.a.undo?this.Dh.Y4:this.Dh.EDa;if(1===ba)return(null===(Ta=y.AFrameworkApplication.J)||void 0===Ta?0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))&&this.Cdk(),bi.a.bda(L)&&
bi.a.Ovb()?8:ob?32:8;if(!ob)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",A===fb.a.undo?"undo":"redo"),this.nSa.value.P$j(),qv.Jc.qc(pf.a.$e,{["Reason"]:uf.a.Tzp}),2;L=new hb.GraphTransaction(3);L.Eb(ra.Fd);L.xAe();A=A===fb.a.undo?this.Dh.undo():this.Dh.Xia();L.dispose();Ia&&tx.a.instance.c5b(Ia.aB);if(A)return 32;qv.Jc.qc(pf.a.tjc,{["Reason"]:uf.a.wmj});return 8};this.gLo=(A,L,ba)=>{if(!this.Yfk(L))return 8;A=this.Rmb.T3f();return 1===ba?(this.Cdk(),bi.a.bda(L)&&
bi.a.Ovb()?8:A?32:8):A?this.Rmb.repeat():(v.ULS.sendTraceTag(508127130,365,50,"User attempted Repeat without a last repeatable action stored"),qv.Jc.qc(pf.a.$e,{["Reason"]:uf.a.fLo}),2)};this.Izo=(A,L,ba,ra,Ia)=>{A=this.Rmb.T3f();const Ta=this.Dh.EDa;if(1===ba)return bi.a.bda(L)&&bi.a.Ovb()?8:A||Ta?32:8;A?L=y.AFrameworkApplication.va.Sf(L,fb.a.repeat,ba,!0,ra,Ia):Ta?L=y.AFrameworkApplication.va.Sf(L,fb.a.Xia,ba,!0,ra,Ia):(L=2,this.Rmb.kMn());return L};this.Hsa=b;this.nSa=h;this.Rmb=r}get Dh(){return this.yo||
(this.yo=this.Hsa())}mc(){var b;const h=y.AFrameworkApplication.va,r=this.Zzp;h.nb(fb.a.undo,ic.a.view,r,1028);h.nb(fb.a.Xia,ic.a.view,r,1028);if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))h.nb(fb.a.repeat,ic.a.view,this.gLo,1028),h.nb(fb.a.bxe,ic.a.view,this.Izo,1124)}Cdk(){const b=this.Dh.EDa;this.Rmb.T3f()?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Repeat",!1)),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("Repeat",
!1)),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Redo",!0))):b&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Repeat",!0)),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Redo",!1)),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("Redo",!1)))}Yfk(b){b=b.view;return b.Ee?b:(qv.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NYb}),null)}static get instance(){return null!=qv.I1g?qv.I1g:qv.I1g=qv.In()}static In(){var b;const h=
Xa.a.instance;return new qv(()=>h.resolve("Box4.IUndoManager"),h.zf("Box4.ICoauthCashTelemetry"),(null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))&&h.resolve("Box4.UndoRedo.IRepeatManager"))}static get Jc(){return $g.a.instance}}Object(u.a)(qv,"UndoActor",null,[]);var rh=e(606),uH=e(335);class iq{constructor(){this.Z=null}get name(){return"Box4.Actors"}Ec(b){this.Z=b;(new Nz).Ec(b)}init(){var b=this.Z.resolve("Box4.Actors.ClipboardActor");
this.Z.resolve("Box4.Actors.PageColorActor").mc();b.mc();b.i$();ZC();su.instance.mc(Object(Oo.a)()?this.Z.resolve("Box4.HighContrastColorPickerState"):null);mf.mc();Gm.mc();ql.mc();Fx.a.QNa&&this.Z.resolve("Box4.Actors.ExpandCollapseActor").mc();this.Z.resolve("Box4.Actors.TouchInputActor").mc();Oz.instance.mc();this.Z.resolve("Box4.ISelectAllHandlers").mc();$J();this.Z.resolve("Box4.Actors.ProofingActor").mc();Ny.instance.mc();(b=this.Z.Wa("Box4.IFeatureHelper"))?b.Fs.continueWith(()=>{this.WGj()}):
this.WGj();oo.a.mc(Ze.a.Z2a);this.Z.resolve("Box4.Actors.TextFormattingActor").mc();qv.instance.mc();this.Z.resolve("Box4.Actors.AccessibilityActor").tug();this.Z.resolve("Box4.IClipboardCommands");this.Z.resolve("Box4.Actors.PasteFloatieEventManager");Db.StaticActiveAppFrame.Aa().Ne()}WGj(){this.Z.resolve("Box4.Actors.StyleContextMenuActor").mc();this.Z.resolve("Box4.Actors.StyleActor").mc()}dispose(){}static main(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerIsEnabled",
!1)&&(ka.a.RYi=b=>{if(b&&window.event){var h=Object(rh.b)(b);if(h.track){b=Object(uH.b)(window.event,`OtelUserAction - ${b}`);var r=Xa.a.instance.Wa("Box4.WordActionContextCapturer");h.Kqf&&r&&r.LTh(b);h.Hqf&&r&&r.f1k(b)}}});F.a.instance.Rc(new iq)}}Object(u.a)(iq,"Box4ActorsPackage",null,[0,1]);class vH extends Ky{constructor(b,h,r,A){super(b);this.mua=r;this.Ufb=A;this.SSg=0;this.gB=h.O_a("UserAction","WordOnlineAddToDictionary")}PEg(b){this.i5d=this.mua.Eua(b);if(!this.Yul())return!1;const h=this.i5d.errorDetails.token;
this.Ufb.kUh(h);if(!this.Ufb.Gud(h))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.gB.start();this.transaction=new hb.GraphTransaction(15);this.transaction.Eb(b.node);return!0}Fue(b){this.D_b(b.node);return!0}tld(b){this.D_b(b);return!0}Gue(b){this.D_b(b.node)}oLg(b){this.transaction.dispose();this.i5d.errorDetails.vCb(b.actionId);
this.Ufb.jAg("unused corelation id.");this.gB.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.SSg,this.gB.qj,this.i5d.errorDetails.proofingType));return!0}gBc(b,h){const r=b.role;return super.gBc(b,h)||9===r||10===r||13===r||7===r||8===r}D_b(b){if(b){var h=this.mua.X8(b,r=>this.Ufb.Gud(r.errorDetails.token));this.mua.Nzb(b,h,!0);this.SSg+=h.length}}Yul(){var b,h;return null!==(h=null===(b=this.i5d)||
void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(u.a)(vH,"AddToDictionaryCallbackSteps",Ky,[]);class Qz{constructor(b,h,r,A,L,ba,ra){this.Tb=b;this.ub=h;this.Dpa=r;this.mua=A;this.Eq=L;this.Ufb=ba;this.Dqo=ra;this.I_m=(Ia,Ta,ob,nb,Eb,bc)=>{const Bc=new vH(this.Dpa,this.Eq,this.mua,this.Ufb);return new hB(Ia,Ta,ob,nb,Eb,bc,Bc,this.Tb,this.ub,this.Dpa,"AddToDictionaryThroughProofingWholeDocumentOperation")}}mc(){this.Tb.uY(fb.a.addToDictionary,
ic.a.view,this.I_m,1124);this.Dqo.VDo(this.Ufb)}}Object(u.a)(Qz,"PersonalDictionaryOrchestrator",null,[]);class Pq{get name(){return"Box4.PersonalDictionary"}Ec(b){this.container=b;b.register(Qz,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().fe(()=>new Qz(y.AFrameworkApplication.va,Fg.a.instance,CC.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").mc()}dispose(){}static main(){Fk.a.get_instance().Zk(7,
()=>{F.a.instance.Rc(new Pq)})}}Object(u.a)(Pq,"PersonalDictionaryPackage",null,[0,1]);var ao=e(112);class $s{constructor(b,h,r,A,L,ba){this.MHa=this.aI=null;this.RXc=(ra,Ia,Ta,ob,nb)=>this.v7i(Ia,Ta,nb,!1)?32:8;this.YE=(ra,Ia,Ta,ob,nb)=>{if(!({xB:ra}=this.gYj(Ia,Ta,nb,!0)).returnValue)return ra;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");nb=this.AWk.sma(Ia.node,nb);this.qio(Ia.node,nb);this.UK();return 32};this.Opb=(ra,Ia,Ta,ob,nb)=>{if(!({xB:ra}=
this.gYj(Ia,Ta,nb,!1)).returnValue)return ra;this.mio(Ia.node);return 32};this.Iro=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;if(!Ia||!Ia.view.Ee)return 2;ra=Ia.view.ub;if(!ra)return 2;ra=ra.hh;if(!ra)return 2;ra=Object(ak.a)().tT(ra,16);if(!ra||!ra.length)return 2;Ia=null;for(Ta=0;Ta<ra.length;Ta++){ob=ra.getContext(Ta);if(!ob||ob.contextId!==ic.a.Vy)return 2;const Eb={};this.IRi(ob,Eb);if(Eb.CellShading)if(Ia&&Ia!==Eb.CellShading){Ia=null;break}else Ia=Eb.CellShading;else{Ia=null;break}}nb.CellShading=
Ia;return 32};this.uzb=(ra,Ia,Ta,ob,nb)=>1===Ta?32:this.IRi(Ia,nb);this.i_b=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;ra=Ia.contextId===ic.a.view?this.omb.lTb(Ia):this.yPf(Ia);Ta={};Ia=null;32===y.AFrameworkApplication.va.Zb(fb.a.uzb,2,Ta)&&Ta&&(Ia=Ta.CellShading);Ta="";Ia&&(Ta=Xl.a.zB(Ia)||"");this.dXj.dea=Ta;this.vK.YCb(Ta);ra=this.dXj.Gsb(ra,Ze.a.tWa);if(!ra)return 8;nb.MenuItems=ra;v.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.K5=(ra,Ia,Ta,ob,nb)=>{if(1===
Ta)return 32;Db.StaticActiveAppFrame.Aa().dismissFloatie();y.AFrameworkApplication.va.Zb(fb.a.uzb,2,nb);this.MHa=new Vs("Shading",fb.a.Gzc);this.MHa.pBb(nb&&nb.CellShading?nb.CellShading:0);return 32};this.ztl=(ra,Ia,Ta,ob,nb)=>{if(1===Ta)return 32;y.AFrameworkApplication.va.Zb(fb.a.t$,2,nb);this.vK.bKa(nb)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.AWk=h;this.D3e=r;this.omb=A;this.me=L;this.lr=ba}get vK(){return null!=
this.d8g?this.d8g:this.d8g=Xa.a.instance.Wa("Box4.UI.RecentColorsSectionHandler")}get dXj(){this.aI||(this.aI=new lp("Shading"),this.Nha(this.aI));return this.aI}Nha(b){b.bH(2,fb.a.Opb);b.bH(3,fb.a.t$);b.bH(4,fb.a.t$);b.q8a(this.D3e,1)}mc(){this.ga.qa(fb.a.i_b,ic.a.view,this.i_b);this.ga.qa(fb.a.i_b,ic.a.Vy,this.i_b);this.ga.Oc(fb.a.i_b,1126);this.ga.qa(fb.a.RXc,ic.a.view,oo.a.A4c);this.ga.qa(fb.a.RXc,ic.a.Vy,this.RXc);this.ga.Oc(fb.a.RXc,1028);this.ga.qa(fb.a.t$,ic.a.view,oo.a.A4c);this.ga.qa(fb.a.t$,
ic.a.Vy,this.YE);this.ga.Oc(fb.a.t$,1028);this.ga.qa(fb.a.Opb,ic.a.view,oo.a.A4c);this.ga.qa(fb.a.Opb,ic.a.Vy,this.Opb);this.ga.Oc(fb.a.Opb,1028);this.ga.qa(fb.a.uzb,ic.a.view,this.Iro);this.ga.qa(fb.a.uzb,ic.a.Vy,this.uzb);this.ga.Oc(fb.a.uzb,1124);this.ga.qa(fb.a.Gzc,ic.a.view,oo.a.A4c);this.ga.qa(fb.a.Gzc,ic.a.Vy,this.ztl);this.ga.Oc(fb.a.Gzc,1028);this.ga.qa(fb.a.Hlg,ic.a.view,this.K5);this.ga.Oc(fb.a.Hlg,1028)}UK(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}gYj(b,h,r,A){return this.v7i(b,h,r,A)?{returnValue:2===h,xB:32}:(2==h&&oo.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],uf.a.dbm),{returnValue:!1,xB:8})}v7i(b,h,r,A){return b.contextId!==ic.a.Vy||2===h&&(A&&!r||!b.node)?!1:!0}qio(b,h){const r=new hb.GraphTransaction(15);
r.Eb(b);this.NVj(b);b.properties.setValue(Sb.a.YE,h);r.dispose()}mio(b){const h=new hb.GraphTransaction(15);h.Eb(b);this.NVj(b);b.properties.removeProperty(Sb.a.YE);h.dispose()}yPf(b){return b.contextId!==ic.a.Vy?null:(b=Object(ao.a)().kw(b.node))?b:null}NVj(b){if(this.me&&this.me.Zg&&(b=Object(ya.a)(rx.TableCellNode,b))){const h=b.SZ();this.lr.Prd(b,h)}}IRi(b,h){if(b.contextId!==ic.a.Vy)return 8;(b=b.node)&&b.hasProperty(Sb.a.YE)&&(h.CellShading=b.getValue(Sb.a.YE));return 32}static jrm(){return new $s(y.AFrameworkApplication.va,
Sm.a.instance,nu.a.instance,fn.a.instance,Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get instance(){return null!=$s.b3g?$s.b3g:$s.b3g=$s.jrm()}}Object(u.a)($s,"CellShadingActor",null,[]);class $E{constructor(){this.Z=null}get name(){return"Box4.CellShading"}Ec(b){this.Z=b}init(){const b=this.Z.Wa("Box4.IFeatureHelper");b?b.Fs.continueWith(()=>{this.Sp()}):this.Sp()}Sp(){$s.instance.mc();
Db.StaticActiveAppFrame.Aa().Ne()}dispose(){}}Object(u.a)($E,"CellShadingPackage",null,[0,1]);class Oy{constructor(){this.yXb=new xe.a(()=>this.Awf());this.oda={}}Bxi(b){return b}}Object(u.a)(Oy,"AListMarkerGalleryLoader",null,[554]);var hw=e(1260),vt=e(351);class Hn extends Oy{constructor(){super();this.mIb=new bk.a(Ea.a.Oh())}Bxi(b){Hn.BV||this.CZo();b in Hn.BV&&(b=Hn.BV[b]);return b}Awf(){const b={};b["0"]=new Oq(Box4Intl.Box4Strings.L_ListStyleNone,hw.a.kZi);b["1"]=new Oq(String.fromCharCode(61623),
"Symbol");b["2"]=new Oq(String.fromCharCode(111),"Courier New");b["3"]=new Oq(String.fromCharCode(61607),"Wingdings");b["4"]=new Oq(String.fromCharCode(9643),"Courier New");b["5"]=new Oq(String.fromCharCode(61611),"Wingdings");b["6"]=new Oq(String.fromCharCode(61614),"Symbol");b["7"]=new Oq(String.fromCharCode(61483),"Symbol");b["8"]=new Oq(String.fromCharCode(61485),"Symbol");b["9"]=new Oq(String.fromCharCode(9830),"Courier New");b["10"]=new Oq(String.fromCharCode(61664),"Symbol");b["11"]=new Oq(String.fromCharCode(61558),
"Wingdings");b["12"]=new Oq(String.fromCharCode(61656),"Wingdings");b["13"]=new Oq(String.fromCharCode(61514),"Wingdings");b["14"]=new Oq(String.fromCharCode(61516),"Wingdings");b["15"]=new Oq(String.fromCharCode(61692),"Wingdings");b["16"]=new Oq(String.fromCharCode(61691),"Wingdings");b["17"]=new Oq(String.fromCharCode(61553),"Wingdings");return b}DIe(b){b&&b.length&&this.npf(b)}Cpg(){if(this.oda){var b=vt.a(this.oda),h=b.length;for(let r=0;r<h;r++){const A=this.oda[b[r]];this.mIb.add(A.levelText+
"_"+A.font)}}}npf(b){this.Cpg();for(const h of b)if(h&&!h.NB&&h.CDa&&h.N8c&&(b=h.levelText+"_"+h.font,!this.mIb.contains(b))){const r=vt.a(this.oda).length+vt.a(this.yXb.value).length+"";this.oda[r]=new Oq(h.levelText,h.font);this.mIb.add(b)}}CZo(){Hn.BV={};Hn.BV["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Hn.BV["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Hn.BV["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Hn.BV["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;
Hn.BV["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Hn.BV["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Hn.BV["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Hn.BV["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Hn.BV["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;Hn.BV["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Hn.BV["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Hn.BV["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Hn.BV["Wingdings 0x004a"]=
Box4Intl.Box4Strings.L_SmilingFace;Hn.BV["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Hn.BV["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Hn.BV["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Hn.BV["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}Hn.BV=null;Object(u.a)(Hn,"ListMarkerBulletLoader",Oy,[]);class Dr{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(u.a)(Dr,"InfoAtLevel",null,[]);class Tg{constructor(b){this.ZC=b}get font(){return"Calibri"}get listStyle(){return 42}get Dz(){return"left"}get tue(){return this.ZC?
this.Fno():this.Hno()}get Ced(){return this.ZC?this.Gno():null}get levelText(){return""}szm(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Fno(){let b="";for(let h=0;3>h;h++)b+=this.j7c(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Tg.MLf(),b)}Gno(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Dr,{textAtLevel:this.TJi(h),styleAtLevel:this.FSm(h)}));return b}Hno(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Tg.NLf(),Box4Intl.Box4Strings.L_ListStyleNone)}TJi(b){b=this.ZC.Ded[b];for(let h=0;9>h;h++)b=D.a.replaceAll(b,"%"+(h+1),this.szm(this.ZC.BXb[h]));return b}FSm(b){const h={};h.fontFamily=6===this.ZC.BXb[b]?this.ZC.pMa[b]:this.font;return h}j7c(b){const h=this.TJi(b),r=new Sys.StringBuilder;6===this.ZC.BXb[b]&&r.append(String.format("font-family:{0};",this.ZC.pMa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static MLf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static NLf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Tg,"ListMarkerMultilevel",null,[471]);var aF=e(1277);class Tu extends Oy{constructor(){super()}Awf(){const b=new aF.a,h={};h["0"]=new Tg(null);h["1"]=new Tg(b.Yvf());h["2"]=new Tg(b.Owf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Tg(b.tdi([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}DIe(){}}Object(u.a)(Tu,"ListMarkerMultilevelLoader",Oy,[]);var cp=e(203);class yo{constructor(b,h){this.ZC=null;this.levelText=b;this.FJd=h}get font(){return"Calibri"}get listStyle(){return this.FJd}get Dz(){switch(this.FJd){case 3:case 5:return"right";default:return"left"}}get tue(){switch(this.FJd){case 1:return this.Zwc("1",
"2","3");case 2:return this.Zwc("a","b","c");case 3:return this.Zwc("i","ii","iii");case 4:return this.Zwc("A","B","C");case 5:return this.Zwc("I","II","III");case 0:return this.Ino();default:return this.Zwc("1","2","3")}}get Ced(){const b=[],h={};h.fontFamily=cp.a.$Ba(this.font);switch(this.FJd){case 1:return b.push(Object.assign(new Dr,{textAtLevel:this.D1("1"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("2"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Dr,{textAtLevel:this.D1("a"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("b"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Dr,{textAtLevel:this.D1("i"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("ii"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Dr,
{textAtLevel:this.D1("A"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("B"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Dr,{textAtLevel:this.D1("I"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("II"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Dr,{textAtLevel:this.D1("1"),
styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("2"),styleAtLevel:h})),b.push(Object.assign(new Dr,{textAtLevel:this.D1("3"),styleAtLevel:h})),b}}Zwc(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',yo.MLf(),this.j7c(b),this.j7c(h),this.j7c(r))}Ino(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',yo.NLf(),Box4Intl.Box4Strings.L_ListStyleNone)}j7c(b){b=this.D1(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}D1(b){return D.a.replaceAll(this.levelText,"%1",b)}static MLf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static NLf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(yo,"ListMarkerNumbering",null,[471]);class aD extends Oy{constructor(){super();this.mIb=new bk.a(Ea.a.Oh())}pzn(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Awf(){const b=
{};b["0"]=new yo(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new yo("%1.",5);b["2"]=new yo("%1.",4);b["3"]=new yo("%1.",1);b["4"]=new yo("%1.",2);b["5"]=new yo("%1.",3);b["6"]=new yo("%1)",5);b["7"]=new yo("%1)",4);b["8"]=new yo("%1)",1);b["9"]=new yo("%1)",2);b["10"]=new yo("%1)",3);b["11"]=new yo("(%1)",5);b["12"]=new yo("(%1)",4);b["13"]=new yo("(%1)",1);b["14"]=new yo("(%1)",2);b["15"]=new yo("(%1)",3);return b}DIe(b){b&&b.length&&this.npf(b)}Cpg(){if(this.oda){var b=vt.a(this.oda),h=b.length;
for(let r=0;r<h;r++){const A=this.oda[b[r]];this.mIb.add(A.levelText+"_"+A.listStyle)}}}npf(b){this.Cpg();for(const h of b)if(h&&h.NB&&h.CDa&&this.pzn(h.levelText)&&h.listStyle&&(b=hw.a.YIf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.mIb.contains(r)){const A=vt.a(this.oda).length+vt.a(this.yXb.value).length+"";this.oda[A]=new yo(b,h.listStyle)}this.mIb.add(r)}}}Object(u.a)(aD,"ListMarkerNumberingLoader",Oy,[]);class bD{constructor(){this.Z=null}get name(){return"Box4.ListMarker"}init(){Ih.mc()}dispose(){}Ec(b){this.Z=
b;this.Z.ja("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Hn).ha();this.Z.ja("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new aD).ha();this.Z.ja("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new Tu).ha()}static main(){F.a.instance.Rc(new bD)}}Object(u.a)(bD,"Box4ListMarkerPackage",null,[0,1]);class wt{static get Fh(){return Xf.a.iA(wt.pp,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}wt.pp="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(u.a)(wt,"DefineNewBulletDialogHtml",null,[]);class Zr extends Xf.a{constructor(b,h,r,A){super();this.FNc=this.N2e=this.mac=this.eac=null;this.XIb=0;this.AWc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.yWi=!0;this.zVl=L=>{if(this.eac&&L.target!==this.eac){const ba=this.focusManager.Cv();ba&&ba.Al&&(ba.Al.eC(L.target),this.eac=L.target)}this.p$n(L.target.id)};this.GHn=L=>{L=L.Ff;if(!this.o9i(L))return!1;this.focusManager.Cv().Al.eC(L);L.focus();return!0};this.HHn=L=>{var ba=
L.Ff;if(!this.o9i(ba))return!1;var ra=ba.id;ra=parseInt(ra.substr(ra.lastIndexOf("_")+1))-this.XIb;if(L.Yb.ctrlKey||L.Yb.altKey||L.Yb.keyCode>=pg.a.i6b&&L.Yb.keyCode<=pg.a.j6b)return!1;const Ia=L.Yb.keyCode;if(L.eventName===Fd.a.Bj){L=-1;if(Ia===Sys.UI.Key.enter)return this.focusManager.Cv().Al.eC(ba),ba.focus(),this.Wqj(ba.id),this.hide(),!0;Ia===Sys.UI.Key.up?L=ra-17:Ia===Sys.UI.Key.down?L=ra+17:Ia===Sys.UI.Key.left?L=y.AFrameworkApplication.isRtl?ra+1:ra-1:Ia===Sys.UI.Key.right&&(L=y.AFrameworkApplication.isRtl?
ra-1:ra+1);0<=L&&(ba=this.zGi(Zr.Wic+"_"+(L+this.XIb)))&&ba.focus()}return!0};this.yVl=L=>{1===L&&this.Wqj(this.mac);this.hide()};this.Yw=b;this.focusManager=h;this.ga=r;this.MX=!1;A&&(b=A.indexOf(","),-1!==b&&(A=A.substring(0,b)));this.fontName=A;this.$g="DefineNewBulletDialog";this.Fh=wt.Fh;this.Ue(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ue(0,CommonUIStrings.l_DialogClose);this.ti(Box4Intl.Box4Strings.L_SymbolSingle,this.yVl,null);this.rfa=!1;this.IPa();document.getElementById(Zr.t7d).focus()}IPa(){this.focusManager.Cv().scope.Pu(Jc.FocusManager.instance().w0);
this.focusManager.Cv().scope.Pu(Jc.FocusManager.instance().x0);this.focusManager.Cv().scope.bindAction(Jc.FocusManager.instance().w0,fb.a.u2d);this.focusManager.Cv().scope.bindAction(Jc.FocusManager.instance().x0,fb.a.t2d)}Cda(){this.qXd(Zr.t7d,"DefineNewBulletFontPlaceholder",fb.a.s2d.toString(),fb.a.Q_b.toString(),fb.a.Ikd.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.Aml()}JP(){super.JP();document.getElementById(this.Vj("WACDialogPanel")).style.width="auto"}qXd(b,h,r,A,L,ba,ra){r=Zh.c(b,
r,!0,!0,A,L,D.a.Mf(ba),!0,ra);this.W0d(b,h,r,"Medium")}Aml(){const b=document.getElementById(Zr.Wic);b&&(b.innerHTML=this.XBi(),this.FGj(b))}FGj(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Re.a.addHandler(b[h],Fd.a.focus,this.zVl)}zEp(){var b=document.getElementById(Zr.Wic);if(b){let h=this.fontName;const r=hw.a.K_f(this.fontName);r&&61472!==this.XIb||!r&&32!==this.XIb?(b.innerHTML=this.XBi(),this.FGj(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.rTh(h),b[0].style.fontFamily=h)}}p$n(b){this.DUj(this.mac,!1);this.mac=b;this.DUj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.mac){let h=parseInt(this.mac.substr(this.mac.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.XIb?61440:0,b.innerText=D.a.yL(h,4))}}DUj(b,h){(b=this.zGi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}zGi(b){const h=document.getElementById(Zr.Wic);return h?h.querySelector("#"+b):null}cta(){const b=document.getElementById(Zr.Wic);
b&&(this.N2e||(this.N2e=this.GHn,this.Ws.Cb(Fd.a.click,b,this.N2e)),this.FNc||(this.FNc=this.HHn,this.Ce.Cb(Fd.a.Bj,b,this.FNc),this.Ce.Cb(Fd.a.Jw,b,this.FNc),this.Ce.Cb(Fd.a.zi,b,this.FNc)));super.cta()}o9i(b){return b.classList.contains("DefineNewBulletTableCell")}Wqj(b){if(b){b=b.split("_");const h=new Ai.DictionaryPropertySet;h.setValue(Pd.a.MN,parseInt(b[1]));h.setValue(Sb.a.font,this.fontName);h.setValue(Pd.a.dE,1);h.setValue(Kh.a.bwa,"command-ui");h.setValue(Kh.a.Aoa,"define-new-bullet-dialog");
this.ga.Zb(fb.a.FF,2,h)}this.focusManager.zP(this.ZO,!0)}XBi(){const b=new Sys.StringBuilder,h=hw.a.K_f(this.fontName);let r=this.fontName;r=this.rTh(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.XIb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.XIb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}rTh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}W0d(b,h,r,A){h=document.getElementById(h);this.Yw.h8a(b,r);r=this.Yw.xSb(b,A);h.appendChild(r);this.Yw.Uwa(b)}dispose(){this.MX||(this.Yw.I2(Zr.t7d),this.MX=!0);super.dispose()}}Zr.t7d="DefineNewBulletFontStyleComboBox";Zr.Wic="DefineNewBulletTableContainer";Object(u.a)(Zr,"DefineNewBulletDialog",Xf.a,[]);class Qq{D6c(){return fb.a.BHn}i7c(){return fb.a.Vog}}Object(u.a)(Qq,"ListMarkerGalleryBulletCommands",
null,[555]);class Mw{D6c(){return fb.a.DHn}i7c(){return fb.a.Kko}}Object(u.a)(Mw,"ListMarkerGalleryMultilevelCommands",null,[555]);class Uu{D6c(){return fb.a.EHn}i7c(){return fb.a.Wog}}Object(u.a)(Uu,"ListMarkerGalleryNumberingCommands",null,[555]);class cD{constructor(b,h,r,A,L){this.YHa=this.STa=null;this.Mii=ba=>{if(!this.YHa)return 2;if(this.YHa.focusManager.Cv().Al.Kta.id.startsWith(Zr.Wic)){let ra=null;ba===fb.a.u2d?ra=this.YHa.S8a:ba===fb.a.t2d&&(ra=document.getElementById(Zr.t7d));if(!ra)return 2;
this.YHa.focusManager.Cv().Al.eC(ra);ra.focus()}else if(ba===fb.a.u2d)this.YHa.focusManager.Cv().quc();else if(ba===fb.a.t2d)this.YHa.focusManager.Cv().ouc();else return 2;return 32};this.Ebj=(ba,ra)=>{ba=null;ra.view.Ee&&(ba=ra.view);return ba&&ba.ub?32:(Cd.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ra.toString()),8)};this.hFn=(ba,ra,Ia)=>1===Ia?32:2===Ia?(ba=this.onc(ra),ba=pb.a.uu(ba).cache.aK,this.YHa=new Zr(this.JUk,
Jc.FocusManager.instance(),y.AFrameworkApplication.va,ba),32):8;this.Ikd=(ba,ra,Ia,Ta,ob)=>{if(1===Ia)return 32;if(2===Ia&&!ob)return 8;if(this.YHa.yWi){for(ba=0;ba<hw.a.AWc.length;ba++)cp.a.h$j(hw.a.AWc[ba]);this.YHa.yWi=!1}Qa.a.gfe(ra);ob.PopulationXML=cp.a.hxi(Qa.a.LCe,Qa.a.uIf,fb.a.s2d);return 32};this.Jko=(ba,ra,Ia,Ta,ob)=>{ba=ra.contextId===ic.a.gU;if(1===Ia||!ba)return ba?32:8;if(2===Ia&&!ob)return 8;ob.MenuItems=this.SJk.qFm();return 32};this.xVl=(ba,ra,Ia,Ta,ob)=>{if(1===Ia)return 32;if(2===
Ia){ba=Object(ya.a)(410,ob);if(!ba||!ba.Ed)return 8;this.YHa.fontName=ba.Ed.fontName;this.YHa.zEp();return 32}return 8};this.ga=b;this.zg=A.resolve("Box4.List.IListReader");this.Uaa=h;this.JUk=r;switch(this.Uaa){case 0:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.STa=new Qq;break;case 1:b=A.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.STa=new Uu;break;case 2:b=A.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.STa=new Mw;break;default:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),
this.STa=new Qq}L=this.zg?this.zg.dFm(L):null;b.DIe(L);this.SJk=new hw.a(h,b,L,!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.vWb)}mc(){this.ga.qa(this.STa.i7c(),ic.a.view,Ze.a.Z2a.Odi(11));this.ga.qa(this.STa.i7c(),ic.a.gU,this.Jko);this.ga.Oc(this.STa.i7c(),1124);this.Uaa||(this.ga.nb(fb.a.S6f,ic.a.view,this.hFn,1028),this.ga.nb(fb.a.Ikd,ic.a.view,this.Ikd,1124),this.ga.nb(fb.a.s2d,ic.a.view,this.xVl,1028),this.ga.nb(fb.a.u2d,dd.a.frame,this.Mii,64),this.ga.nb(fb.a.t2d,dd.a.frame,this.Mii,
64));this.ga.qa(this.STa.D6c(),ic.a.view,this.Ebj);this.ga.qa(this.STa.D6c(),ic.a.gU,this.Ebj);this.ga.Oc(this.STa.D6c(),1124)}onc(b){return this.I8d(b).Ya}I8d(b){let h=null;b=b.view;return b?h=Ee.a.Xk(b.ub.ob.K(0),!1,!1):h}}Object(u.a)(cD,"ListMarkerGalleryActor",null,[411]);class tu{constructor(){this.ng=this.Z=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Object(Vb.a)()){var b=Object(Vb.a)();b.Ve&&(this.ng=b.Ve.Fd,this.LCo())}}dispose(){}Ec(b){this.Z=b}LCo(){(new cD(y.AFrameworkApplication.va,
1,this.Z.resolve("Common.IStandaloneRootController").yja,this.Z,this.ng)).mc();(new cD(y.AFrameworkApplication.va,0,this.Z.resolve("Common.IStandaloneRootController").yja,this.Z,this.ng)).mc();(new cD(y.AFrameworkApplication.va,2,this.Z.resolve("Common.IStandaloneRootController").yja,this.Z,this.ng)).mc()}static main(){F.a.instance.Rc(new tu)}}Object(u.a)(tu,"Box4ListMarkerGalleryPackage",null,[0,1]);var bF=e(510),dD=e(649),Py=e(569),vs=e(199);const wH=b=>{b.element.style.top=""};var Rz=e(733);class xH{constructor(b,
h,r){this.oL=!1;this.Rjb=0;this.wka=this.BDh=null;this.q1n=A=>{A.element.style.top="";y.AFrameworkApplication.ta.uhd()};this.i1n=A=>{A.element.parentNode.removeChild(A.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);y.AFrameworkApplication.ta.uhd()};this.zx=()=>{const A=this.pv.entries.length,L=Sys.UI.DomElement.getBounds(this.htmlElement).height;let ba;for(let ra=0;ra<A;++ra)ba=this.pv.entries[ra],ba.htmlElement&&ba.sMj();this.Rjb=Sys.UI.DomElement.getBounds(this.htmlElement).height;
L!==this.Rjb&&this.$4b()};this.$Ka=()=>!0;this.Xl=b;this.QVk=h;this.pv=r;this.Laa=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.qB=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.z9)&&!this.pv.dBf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";X.a.Hj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.Laa}get visible(){return this.oL}set_visible(b){if(this.oL!==
b)return(this.oL=b)?this.Omf():this.M0c(),b}dispose(){this.visible&&this.M0c();eb.a.FV(this.htmlElement);this.Xl=this.Laa=null}SZj(b,h){const r=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.sMj();this.Rjb+=b.htmlElement.clientHeight;var A=this.htmlElement.childNodes,L=b.EWh,ba=this.q1n;vs.WacAirSpace.f_(r,"Shared_BasicClass");var ra=new Py.a(r);ra.lBa(0,1);const Ia=new dD.a(r);
Ia.kKa(r.clientTop-30,r.clientTop);L?(vs.WacAirSpace.Kxb(ra,null,null),vs.WacAirSpace.Kxb(Ia,null,ba)):(vs.WacAirSpace.animate(ra,null,null),vs.WacAirSpace.animate(Ia,null,ba));for(h+=1;h<A.length;h++)ba=A[h],vs.WacAirSpace.f_(ba,"Shared_BasicClass"),ra=new dD.a(ba),ra.kKa(ba.clientTop-r.clientHeight,ba.clientTop),L?vs.WacAirSpace.Kxb(ra,null,null):vs.WacAirSpace.animate(ra,null,null);b.Xdp();this.set_visible(!0)}OTi(b){const h=b.htmlElement;if(eb.a.Kqc(h)){this.Rjb-=b.htmlElement.clientHeight;var r=
h.parentNode.children;b=b.EWh;var A=this.i1n;vs.WacAirSpace.f_(h,"Shared_BasicClass");var L=new bF.a(h);L.lBa(1,0);b?vs.WacAirSpace.Kxb(L,null,A):vs.WacAirSpace.animate(L,null,A);A=!1;for(L=0;L<r.length;L++){if(A){const ba=r[L];vs.WacAirSpace.f_(ba,"Shared_BasicClass");const ra=new dD.a(ba);ra.kKa(ba.clientTop,-h.clientHeight);b?vs.WacAirSpace.Kxb(ra,null,wH):vs.WacAirSpace.animate(ra,null,wH)}A||r[L]!==h||(A=!0)}}}Omf(){""===this.Xl.style.top.trim()&&(this.Xl.style.top=this.Xl.offsetTop+"px");this.htmlElement.style.left=
this.Xl.style.left;this.htmlElement.style.top=this.Xl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.BDh=this.Xl.style.top;this.Rjb=b.height;this.$4b();y.AFrameworkApplication.ta.f4(this.zx);Re.a.addHandler(this.htmlElement,Fd.a.Rze,Re.a.Ogc);this.wka=this.$Ka;y.AFrameworkApplication.ta.HGa.Cb(this.htmlElement,this.wka,null);if(Jc.FocusManager.kO()){var h=Jc.FocusManager.instance();b=h.te(Rz.a.cWa);
b.parent=Df.AFrame.rr;const r=new Ig.DOMFocusListing(()=>this.htmlElement);r.jo(1);r.jo(2);r.jo(8);h.jta(()=>this.htmlElement,b,r);h=h.getRegion(Rz.a.cWa);h.s1a();h.nR=!0;h.B9a=!0;const A=y.AFrameworkApplication.ta.BA;b.GMb(()=>{A.wz(Rz.a.cWa)});A.vY(Rz.a.cWa);(r.hna||y.AFrameworkApplication.J.$("ReactBusinessBarIsEnabled"))&&A.RM(Rz.a.cWa)}}M0c(){this.wZj()&&(this.Xl.style.top=this.BDh);this.htmlElement.style.visibility="hidden";y.AFrameworkApplication.ta&&(Jc.FocusManager.kO()&&Jc.FocusManager.instance().Ozb(Rz.a.cWa),
this.wka&&(y.AFrameworkApplication.ta.HGa.Gc(this.htmlElement,this.wka),this.wka=null));Re.a.removeHandler(this.htmlElement,Fd.a.Rze,Re.a.Ogc)}$4b(){if(this.wZj()&&this.visible){var b=this.Xl,h=this.Rjb+this.QVk;const r=eb.a.LW(b.style.top);vs.WacAirSpace.f_(b,"Shared_BasicClass");b=new dD.a(b);b.kKa(r,h);vs.WacAirSpace.animate(b,null,null)}}wZj(){return!this.qB&&!this.pv.dBf}}Object(u.a)(xH,"BusinessBarDom",null,[1951,11]);var Qy;(function(b){b[b.none=0]="none";b[b.V3p=1]="corruptPage";b[b.k4p=2]=
"currentPageStatus";b[b.E5p=3]="documentMarkedAsFinal";b[b.L5p=4]="documentSigned";b[b.B8p=5]="fileAccess";b[b.Qdq=6]="kickoutWithDataLoss";b[b.FZ=7]="lostSession";b[b.ufq=8]="malformedHyperlinkUris";b[b.Knj=9]="odt";b[b.Qqq=10]="readonlyRecommended";b[b.ftq=11]="saveReplaySuccess";b[b.etq=12]="saveReplayFailed";b[b.RBp=13]="unsupportedObjects";b[b.qAq=14]="word11Compat";b[b.gzq=15]="unsupportedBrowser";b[b.q0p=16]="applicationNotification";b[b.xvq=17]="skypeDocChatFailed";b[b.Tuq=18]="showDialogInNewWindowInfo";
b[b.zYo=19]="sessionExpired";b[b.Vkn=20]="irmPolicyDescription";b[b.Lpq=21]="policyWarningMessage";b[b.Pxq=22]="thirdPartyAddinDisabled";b[b.T9p=23]="gdprPrivacyNotice";b[b.D4p=24]="datacenterDecommissionWarning";b[b.X$p=25]="graphMergePrompt";b[b.Lqq=26]="readOnlyDocument";b[b.i5p=27]="dictationSilence";b[b.G0p=28]="autoSensitivityLabel";b[b.Zqq=29]="recommendedSensitivityLabel";b[b.h5p=30]="dictationDebugInfo";b[b.roq=31]="oneNoteCovid19Message";b[b.l2p=32]="citationStylePrompt";b[b.xoq=33]="oneNoteViewModeMessage";
b[b.woq=34]="oneNotePrintImagesDownloading";b[b.voq=35]="oneNotePagePrintReady";b[b.rdq=36]="irmPolicyCausedFeatureDisabled";b[b.wfq=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.kgq=39]="minorVersionLimit";b[b.mxq=40]="testEntry1";b[b.nxq=41]="testEntry2";b[b.oxq=42]="testEntry3";b[b.pxq=43]="testEntry4";b[b.qxq=44]="testEntry5";b[b.rxq=45]="testEntry6";b[b.sxq=46]="testEntry7"})(Qy||(Qy={}));Object(u.b)("BusinessBarId",Qy);class iw{constructor(b,h=0,r=null,A=null){this.Avh=this.Akh=!1;
this.Ebc=null;this.KE=[];this.c4a=A||new xH(b,h,this);this.Een(r)}Een(b){if(b){this.Ebc={};b=b.ranking;for(let h=0;h<b.length;h++)this.Ebc[Qy[b[h]]]=h}}dispose(){this.c4a.dispose();Dm.a.Vzg(this.KE);this.KE=null}get htmlElement(){return this.c4a.htmlElement}get visible(){return this.c4a.visible}get dBf(){return this.Akh}set dBf(b){this.Akh=b}get M3f(){return this.Avh}set M3f(b){this.Avh=b}get entries(){return this.KE}set entries(b){this.KE=b}s9(b){for(let h=0;h<this.KE.length;h++)if(this.KE[h].id===
b)return!0;return!1}yB(b,h=!1,r=null,A=null,L=null){b.IS=this;let ba=this.WCm(b.id);h&&!this.Ebc&&(ba=0);ba<iw.fYb&&(this.c4a.SZj(b,ba),this.KE.length>=iw.fYb&&this.c4a.OTi(this.KE[iw.fYb-1]),this.c4a.$4b());Array.insert(this.KE,ba,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Qy[b.id],void 0===b.C9a||null===b.C9a?"":b.C9a);b.errorCode&&y.AFrameworkApplication.pU(b.errorCode,r,A,L)}removeEntry(b){const h=Array.indexOf(this.KE,b);-1!==h&&h<iw.fYb&&(this.KE.length>
iw.fYb&&this.c4a.SZj(this.KE[iw.fYb],iw.fYb),this.c4a.OTi(b),this.c4a.$4b());Array.remove(this.KE,b);b.IS=null;b.dispose()}WCm(b){if(!this.Ebc||0===b)return this.KE.length;b=this.Ebc[Qy[b]];if(void 0===b||null===b)return this.KE.length;for(let h=0;h<this.KE.length;h++)if(b<this.Ebc[Qy[this.KE[h].id]])return h;return this.KE.length}}iw.fYb=2;Object(u.a)(iw,"BusinessBar",null,[1933,11,1934]);class lB{create(b,h,r){return new Td.a(b,h,r)}}Object(u.a)(lB,"Factory",null,[1950]);class eD{static wEl(b,h){b.register(iw,
"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().fe(()=>new iw(h.value,0,b.Wa("CommonUI.IBusinessBarRankProvider")));b.register(lB,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(u.a)(eD,"CommonUIComponentConfiguration",null,[]);var Sz=e(1663);class jw extends Sz.a{constructor(){super()}static get instance(){return jw._instance||jw.FYf()}static FYf(){jw._instance=new jw;return jw._instance}}jw._instance=null;Object(u.a)(jw,"ReactRootManager",Sz.a,
[276,277]);class cF extends qg.a{constructor(){super()}get ControlType(){return 3}}Object(u.a)(cF,"CompoundButtonProps",qg.a,[]);class yH{constructor(b,h,r,A,L,ba,ra){this.p0=h;this.nRc=b;this.Ith=h.mpn;this.H$b=h.zcd;this.t_e=ba;this.DGd=A;this.EGd=L;this.yGd=r;this.xO=ra;this.elb=new ac.a;this.elb.W(1,"SpellingIssue_16x16x32");this.elb.W(2,"GrammarIssue_16x16x32");this.elb.W(3,"WritingIssue_16x16x32");this.elb.W(4,null);this.elb.W(0,null)}create(b,h,r){h=Object(ya.a)(to.a,h);if(!h)return v.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const A=new Sys.StringBuilder;b=this.UFi(b);this.L_c(A,h,r,b);this.swf(A,h);this.wPl(A,h,b);return A.toString()}nPb(b,h,r){const A=Object(ya.a)(to.a,h);if(!A)return v.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.UFi(b);this.fxf(h,A,r,b);this.twf(h,A);this.xPl(h,A,b);for(r=0;r<h.length;r++)h[r].Id=`${mv.Nni}_${r}`;return h}L_c(b,h,r,A=null){h.errorType?1===h.errorType&&(this.pkc(h)||b.append(this.jpf(h,r,A))):b.append(this.nRc.build())}fxf(b,
h,r,A=null){h.errorType?1===h.errorType&&(this.pkc(h)||b.push(this.wml(h,r,A))):b.push(this.nRc.X1h())}swf(b,h){const r=new Sys.StringBuilder;this.L_j(h)?r.append(Zh.a("btnIgnoreAllSpellingError",(2===h.errorType?fb.a.nRa:fb.a.bva).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.pkc(h)||r.append(Zh.a("btnIgrnoreSpellingError",this.MEi(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.R_j(h)&&(this.p0.w1i&&r.append(Zh.a("btnDoNotCheckForThisIssue",
fb.a.oQb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Zh.a("btnGrammarOptions",fb.a.Nyb.toString(),D.a.Mf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),b.append("</Controls></MenuSection>"))}twf(b,h){const r=Object.assign(new Zd.a,{ControlList:[]});if(this.L_j(h)){var A=qu.rF()?Object.assign(new qg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:fb.a.bva,
LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new qg.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(A)}else this.pkc(h)||(A=Object.assign(new qg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.MEi(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(A));this.R_j(h)&&(this.p0.w1i&&(h=Object.assign(new qg.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),
h=Object.assign(new qg.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}UFi(b){if(!this.xO)return null;b=this.xO.language(this.xO.uu(b.Ya));return Wg.a.Vg(b)?Wg.a.Vg(b).name:null}MEi(b){return 2===b?fb.a.nRa:this.p0.psn?fb.a.x$m:fb.a.IDa}wPl(b,h,r=null){if(this.rFg(h)){var A=D.a.Mf(h.Yv.CategoryTitle);A=Zh.m(mv.cxc,wb.a.Ssa,this.elb.K(h.proofingType),""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.DGd,this.EGd);A=Zh.d("cgProofingOuter",
[A]);b.clear();b.append(Zh.g("msProofingOuter",A,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}xPl(b,h,r=null){if(this.rFg(h)){var A=D.a.Mf(h.Yv.CategoryTitle);r=Object.assign(new Sj.a,{ExternalId:String.format("{0}_{1}",mv.cxc,h.proofingType),Command:wb.a.Ssa.toString(),Image16by16Class:this.elb.K(h.proofingType),LabelText:""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
Lang:r,Menu:Object.assign(new dk.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Hom(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);A=Object.assign(new Zd.a,{ControlList:[]});A.ControlList.push(r);b.push(A);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}jpf(b,h,r=null){const A=this.Kxm(b);
var L=[];let ba=!1;var ra=b.Yv.Suggestions;if(ra)if(ra=ra.slice(0,Math.min(3,ra.length)),this.Ith&&(ba=!lf.a.any(ra,Ia=>!Ia||!Ia.Description)),1!==ra.length||ra[0].Action){let Ia=0,Ta=null;ba&&(Ta="font-weight: bold;");for(const ob of ra){if(!ob)continue;ra=null;let nb="";const Eb=D.a.Mf(ob.Text);ba&&(ra=this.szi(ob.Description),nb=this.rzi(ob.Description));L.push(Zh.a("btnCorrectWord"+Ia,h[Ia].toString(),Eb,null,null,null,null,null,Ta,null,ra,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,
A,Eb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.cci(b.token)),"ariaDescribedById",nb));Ia++}}else h=D.a.Mf(ra[0].Text),L.push(Zh.a("btnCorrectWord0",fb.a.nRa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,A,h)));h="Menu16";0<L.length?ba&&(h="Menu16DescriptionEnabled"):L=[Zh.a("btnNoSuggestions",fb.a.nRa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)];return Zh.g("msUnknownWord",Zh.d(null,L),h,A,this.sGm(b),r,"ariaLabelledById")}wml(b,h,r=null){var A=1!==b.proofingType&&0!==b.proofingType?b.Yv.ExplanationTitle:"";A=Object.assign(new Zd.a,{Title:A,Lang:r,ControlList:[]});let L=!1;var ba=b.Yv.Suggestions;if(ba)if(ba=ba.slice(0,Math.min(3,ba.length)),this.Ith&&(L=!lf.a.any(ba,ra=>!ra||!ra.Description)),1!==ba.length||ba[0].Action){let ra=0;for(const Ia of ba){if(!Ia)continue;ba=null;let Ta="";L&&(ba=this.szi(Ia.Description),Ta=this.rzi(Ia.Description));
if(ra>=h.length)break;ba?(ba=Object.assign(new cF,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),LabelText:Ia.Text,Description:ba,Lang:r,AriaDescription:Ta}),A.ControlList.push(ba)):(ba=Object.assign(new qg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),LabelText:Ia.Text,Lang:r,RoleInMenu:"menuitem"}),A.ControlList.push(ba));ra++}}else b=ba[0],b=Object.assign(new qg.a,
{ExternalId:"NoSuggestion",Command:fb.a.nRa.toString(),LabelText:b.Text}),A.ControlList.push(b);0>=A.ControlList.length&&A.ControlList.push(Object.assign(new qg.a,{ExternalId:"btnNoSuggestions",Command:fb.a.nRa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return A}Kxm(b){return D.a.Mf(0!==b.proofingType?b.Yv.ExplanationTitle:"")}sGm(b){return this.rFg(b)?null:this.elb.K(b.proofingType)}rFg(b){return this.H$b&&2!==b.errorType&&(1!==b.errorType||!this.pkc(b))}L_j(b){return this.t_e&&
!!b.errorType&&1===b.proofingType&&!this.pkc(b)}Hom(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.cci(b.token)):""}R_j(b){return this.p0.Rie&&this.H$b&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}pkc(b){return!!b.errorType&&!!this.yGd&&this.yGd.contains(b.token,b.lcid)}szi(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}rzi(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
b):""}cci(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(u.a)(yH,"EditorServiceProofingContextMenuCreator",null,[]);class aK{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(u.a)(aK,"BusinessBarRankProvider",null,[400]);class rv{constructor(){this.Z=null}get name(){return"Wonca.UI"}Ec(b){this.Z=b;b.ja("CommonUI.IBusinessBarRankProvider",()=>
new aK).ha();eD.wEl(b,new xe.a(()=>Db.StaticActiveAppFrame.Aa().Uma));b.ja("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new yH(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),y.AFrameworkApplication.Q1,y.AFrameworkApplication.mr,y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).ha();b.ja("CommandUI.ReactRootManager",()=>jw.instance).as("Common.IReactRootManager").ha()}init(){this.Z.resolve("Wonca.IRibbonUserFactory");
this.Z.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){F.a.instance.Rc(new rv)}}Object(u.a)(rv,"WoncaUIPackage",null,[0,1]);class fD{constructor(b){this.hS=this.rPc=null;this.Tp=b}get key(){return"BOOKMARK"}get hx(){return WacWordeditorStrings.Bookmark}get TQ(){return this.hS}reset(b){this.hS=b.node}NGa(b){let h=null;if(this.rPc&&this.Tp.Q0i(b,this.TQ,this.rPc))return h=Object.assign(new YA.a,{NH:this.key,contentObject:this.rPc}),{returnValue:!0,vI:h};this.rPc=null;if(!this.TQ.hasBookmark)return{returnValue:!1,
vI:h};const r=new te.a;r.set(this.TQ.hk());this.Tp.Pgd(r);if(this.Tp.vmn(r)){let A=r.ue();for(;A;){if(this.Tp.Q0i(b,this.TQ,A))return this.rPc=A,h=Object.assign(new YA.a,{NH:this.key,contentObject:A,description:this.$Xa()}),{returnValue:!0,vI:h};A=r.xl()}}return{returnValue:!1,vI:h}}$Xa(){return null}}Object(u.a)(fD,"BookmarkDetailsProvider",null,[376,377]);class zH{constructor(b,h,r,A,L=null){this.eth=this.vi=!1;this.KKd=this.kMd=null;this.Woj=(ba,ra)=>{ba=ra.node;ba.yc!==on.a.vBa?v.ULS.sendTraceTag(24155018,
324,10,"node.RuntimeClassId = {0}",ba.yc):(v.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.upi(!0))};this.nI=r;this.Tk=A;this.rB=h;this.Feh=b;this.xX=L}get Kw(){return this.rB.value}initialize(){this.xug();this.vi=!0}upi(b=!1){if(!this.vi)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.eth)return!0;let h=!1;this.Tk.Ae(()=>{this.kMd={};this.KKd={};if(this.Kw){const r=new te.a;r.set(this.Kw);
if(this.mWn(r)){if(r.ic(1)){do this.q3k(r.currentNode);while(r.gg(1))}h=this.eth=!0}}},"BGM:EBGL");return h}XCa(b){return this.upi()?b in this.KKd?this.KKd[b]:null:null}dispose(){this.vi?this.RAp():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}mWn(b){if(this.nI.bU(b))return(b=b.ic(30))||v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}xug(){v.ULS.sendTraceTag(24691923,
324,50,"Registering OnBookmarkContainerNodeLoaded");this.Feh.cVh(this.Woj)}RAp(){v.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.Feh.PJj(this.Woj)}q3k(b){var h,r,A,L;b?(this.dTh(null!==(r=this.xX.kpb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:V.a.nil,b),this.dTh(null!==(L=this.xX.jgc.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==L?L:V.a.nil,b),(h=b.properties.ka(Rc.a.Wv,null))&&(this.KKd[h]=b)):v.ULS.sendTraceTag(24155022,
324,50,"Node is null")}dTh(b,h){b===V.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.kMd||(this.kMd[b]=new Cb.a),b=this.kMd[b],b.contains(h)||b.add(h))}}Object(u.a)(zH,"BookmarkGraphManager",null,[645]);var mB=e(828),bK=e(1109);class dF{create(){return new bK.a}}Object(u.a)(dF,"BookmarkContainerNodeFactory",null,[265]);class AH{constructor(b,h,r,A=null){this.a8n=(L,ba)=>{this.Tp.fsj(ba)};this.Gid=(L,ba)=>{var ra=this.lti(ba.clone);L=ba.original.ed;const Ia=
new kb.a;for(const Ta of ra)ra=Ta.Ap.toString(),Ia.Bb(ra)||(Ia.add(ra,!0),(ra=L.Mb(Ta.Ap))&&!ra.anchor&&(ra=this.Tp.fSb(Ta.Ap)),ra?ra.anchor?this.xIl(ra,ba.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ra.id,ra.ka(Rc.a.yNb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.$jg=(L,ba)=>{L=ba.clone;ba=this.lti(L);this.Tp.Pnd(L,ba)};this.tI=h;this.Tp=r;this.avk=A||new dF}init(){mB.a.BAo(Object(E.a)(this.Tp,this.Tp.ghg,"onAfterFullBookmarkRangeDeleted"));
this.tI.vjf(this.a8n);dw.a.WUd(this.Gid);dw.a.XUd(this.$jg)}lti(b){const h=new Cb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.jc(r);if(A.Oi)for(let L=0;L<A.Oi.length;L++)h.add(A.Oi.K(L))}return h}xIl(b,h){var r=h.hk().Hd;r=Ws.b(b,r,!0);h=te.a.kb(h);this.j7l(h);h.ic(30);h.a8(r,1,b.id);h.yk(r)}j7l(b){if(b.Ib(25)&&b.xd(25)&&!b.dw(30)){const h=this.avk.create(on.a.vBa);b.pg(h,30)}}}Object(u.a)(AH,"BookmarksEventHandler",null,[]);var Js=e(246),cK=e(1073),SM=e(343),XL=e(1162),Bm=e(124),nB=e(1075);class BH{create(){return new nB.a}}
Object(u.a)(BH,"BookmarkNodeFactory",null,[265]);class Tz{constructor(b,h){this.oga=b;this.gvk=h}get f0b(){return this.gvk}}Object(u.a)(Tz,"FoundBookmarkRangeObject",null,[459]);class oB{constructor(b,h,r,A,L,ba,ra,Ia=null,Ta,ob=null){this.Lka="_";this.v5a="OLE_LINK";this.Ieh=40;this.FUk=" ";this.rB=b;this.nI=h;this.ee=r;this.B2e=A;this.Zc=L;this.qb=ba;this.pb=ra;this.fvk=Ia||new BH;this.xX=ob}$6c(b,h){return b?this.xX.kpb.get(null===h||void 0===h?void 0:h.toString()):this.xX.jgc.get(null===h||void 0===
h?void 0:h.toString())}get Kw(){return this.rB.value}get I3a(){return this.B2e.value}xhf(b,h){if(!h||!h.Ya||!h.hd)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Ya.node,A=h.hd.node,L=Js.a.itb(h,!0);h=Js.a.itb(h,!1);return this.Eec(b,L,h,r,A)}Eec(b,h,r,A,L,ba=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ba));const ra=this.XCa(b);if(ra)if(ba)this.GHj(ra);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),
!1;if(!A||!L)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;ba=this.Zc.Vc(15);ba.Eb(this.I3a);cK.a.ksd&&(ba.Bh=Lc.a.eLa);b=this.j0k(b);if(!b)return!1;this.g0k(A,h,b,L,r);ba.dispose();return!0}XCa(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.oti(h=>b===h.properties.ka(Rc.a.Wv,null))}fSb(b){return b&&b!==V.a.nil?this.oti(h=>b.equals(h.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}ghg(b){const h=
this.fSb(b);h?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.FHj(h),this.Ond(h)):v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}YCa(b,h){var r;const A=null!==(r=this.$6c(h,b.id))&&void 0!==r?r:V.a.nil;if(A===V.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Tz(null,2);r=this.Kw.Hd.Mb(A);return r?r.isConnected?this.getBookmarkRange(r,b,h):(v.ULS.sendTraceTag(36766421,
3029,50,"Paragraph not loaded"),new Tz(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Tz(null,2))}fsj(b){const h=this.kfm(b);h[Symbol.iterator]().next().done||this.gWn(b,h)}Pnd(b,h){const r=new Cb.a;let A=0,L=!1;for(const ba of h)ba&&ba.Rb.Oi?(A++,ba.Rb.Oi.remove(ba),0<=ba.Re&&ba.Re<b.Bf.length&&(ba.Rb.cp||(L=!0),r.add(ba.Re))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.tpa(r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",
A,r.count));L&&!b.Bf.length&&b.Bf.append(SM.a.woe,1024)}d8d(b=!1){var h;v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");h=new Cb.a;const A=te.a.kb(this.Kw);if(null!==this.Pgd(A)){var L=A.Bs();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",L);if(0<L)for(L=A.ue();null!==L;){const ba=L.ka(Rc.a.Wv,"");D.a.jg(ba)||(b?h.add(L):ba.startsWith(this.Lka)||
r&&ba.startsWith(this.v5a)||h.add(L));L=A.xl()}}!b&&0<h.count&&v.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}N3m(){return this.Kw?this.FFl():!1}FFl(){var b;v.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",!1);const h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.$("HideBookMarkStartingWithOleLink");b=te.a.kb(this.Kw);if(null!==this.Pgd(b)&&0<b.Bs())for(var r=b.ue();null!==r;){r=r.ka(Rc.a.Wv,"");if(!(D.a.jg(r)||r.startsWith(this.Lka)||
h&&r.startsWith(this.v5a)))return!0;r=b.xl()}return!1}BPf(b){var h=this.XCa(b);b=new Cb.a;if(h){var r=this.$6c(!0,h.id);h=this.$6c(!1,h.id);var A=this.Kw.Hd.Mb(r);A&&b.add(A);if(r.equals(h))return b;r=A;do(r=A=this.qb.Cg(r,!1,!1,!0))&&b.add(A);while(A&&!A.id.equals(h))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist");return b}EHj(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.fSb(b);return this.GHj(b)}dzi(b){let h="";const r=
b.id;b=b.characterData.split(this.FUk);for(let A=0;3>A&&A<b.length;A++)h+=this.Lka+b[A];h.length>this.Ieh&&(h=h.substring(0,this.Ieh));return this.Yjk(h,r)}Yjk(b,h){const r=this.d8d(!0),A=[];let L;for(let ra=0;ra<r.count;ra++){var ba=r.K(ra);L=ba.ka(Rc.a.Wv,"");ba=this.$6c(!0,ba.id);L.startsWith(b)&&!h.equals(ba)&&A.push(L)}return 0<A.length?(A.sort((ra,Ia)=>ra.localeCompare(Ia,void 0,{numeric:!0})),(h=A[A.length-1].substring(b.length+1))?b+this.Lka+(parseInt(h)+1):b+this.Lka+1):b}rZm(b){D.a.jg(b)?
v.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.XCa(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.YCa(b,!0))?(b=Tb.SelectionFactory.Ie(b.oga.paragraph,b.oga.Rb.cp))&&this.pb.Uc(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}GHj(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,
50,String.format("Removing bookmark {0}",b.id));const h=this.Zc.Vc(15);h.Eb(this.I3a);this.FHj(b);this.Ond(b);h.dispose();return!0}Epm(b,h){const r=b.ra;for(let L=0;L<r.length;L++){var A=r.jc(L);if(A.cp===h&&A.Oi&&(A=A.Oi,0<A.length))return b.ed.Mb(V.a.Of(A.K(0).Ap.toString()))}return null}A9d(b,h){var r;if(!b||0>h)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;const A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("HideBookMarkStartingWithOleLink");
r=null;const L=new Cb.a,ba=new Cb.a;var ra=b.ra;for(var Ia=0;Ia<ra.length;Ia++){var Ta=ra.jc(Ia);if(Ta.cp>h||Ta.cp===h&&0<L.count)break;if(Ta.Oi){var ob=Ta.Oi;if(2===ob.length&&ob.K(0).Ap.equals(ob.K(1).Ap)&&Ta.cp===h){L.add(ob.K(0).Ap.toString());break}for(let nb=0,Eb=ob.length;nb<Eb;nb++){Ta=ob.K(nb);const bc=b.ed.Mb(Ta.Ap).ka(Rc.a.Wv,"");D.a.jg(bc)||bc.startsWith(this.Lka)||A&&bc.startsWith(this.v5a)||(Ta.ld?L.add(Ta.Ap.toString()):L.contains(Ta.Ap.toString())?L.remove(Ta.Ap.toString()):ba.add(Ta.Ap.toString()))}}}0<
L.count&&(r=b.ed.Mb(V.a.Of(L.K(L.count-1))));if(!r)for(h=rd.ParagraphReader.Cg(b,!0);h&&!r;){for(ra=0;ra<h.ra.length;ra++)if(Ia=h.ra.jc(ra),Ia.Oi){Ia=Ia.Oi;for(let nb=0,Eb=Ia.length;nb<Eb;nb++)ob=Ia.K(nb),Ta=b.ed.Mb(ob.Ap).ka(Rc.a.Wv,""),D.a.jg(Ta)||Ta.startsWith(this.Lka)||A&&Ta.startsWith(this.v5a)||(ob.ld?ba.contains(ob.Ap.toString())?ba.remove(ob.Ap.toString()):L.add(ob.Ap.toString()):L.contains(ob.Ap.toString())?L.remove(ob.Ap.toString()):ba.add(ob.Ap.toString()))}0<L.count?r=h.ed.Mb(V.a.Of(L.K(L.count-
1))):h=rd.ParagraphReader.Cg(h,!0)}return r}ACp(b,h){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.wmn(h)||this.f3l(h))return!1;const r=this.Zc.Vc(15);r.Eb(this.I3a);this.zCp(b,h);r.dispose();return!0}oti(b){if(!this.Kw)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new te.a;h.set(this.Kw);if(!this.Pgd(h))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.ic(1))return null;do{const r=
h.currentNode;if(b(r))return r}while(h.gg(1));return null}getBookmarkRange(b,h,r){for(let A=0;A<b.ra.length;A++){const L=b.ra.jc(A);if(L.Oi)for(let ba=0;ba<L.Oi.length;ba++){const ra=L.Oi.K(ba);if(ra.Ap.equals(h.id)&&r===ra.ld)return new Tz(ra,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ka(Rc.a.yNb,-1),r,h.id,b.ra.length,this.QI(b));return new Tz(null,1)}Pgd(b){if(this.nI.bU(b))return b=b.ic(30),v.ULS.shipAssertTag(34936513,
3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}kfm(b){const h=new kb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.jc(r);if(A.Oi)for(let L=0;L<A.Oi.length;L++){const ba=A.Oi.K(L),ra=ba.Ap.toString();h.Bb(ra)?(v.ULS.shipAssertTag(36218379,3029,ba.ld!==h.K(ra).ld),h.remove(ra)):h.add(ra,ba)}}return h.values}gWn(b,h){this.Pnd(b,h);this.HVn(b,h)}HVn(b,h){let r=rd.ParagraphReader.Cg(b,!1,!0);b=rd.ParagraphReader.Cg(b,
!0,!0);r||b?(r||this.y0h(h,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||this.y0h(h,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.ikj(r,h,0,!0),this.ikj(b,h,b.ra.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}y0h(b,h){for(const r of b)if(h===r.ld)return!0;return!1}ikj(b,h,r,A){const L=
new Cb.a;r=this.RKf(b,r);for(const ba of h)ba.ld===A&&(r?(h=this.l0k(b,A,r,ba.Ap))&&L.add(h):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",A));L.count&&(b.eo(),this.XIe(b,L),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",L.count,A)))}l0k(b,h,r,A){const L=this.fSb(A);return L?this.yhf(b,h,r,L):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",A)),null)}yhf(b,h,r,A){var L;if(!A)return v.ULS.sendTraceTag(591730834,
3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),null;r.Oi||r.Yee();const ba=new XL.a(r,null,A.id,h);r.Oi.add(ba);(h?this.xX.kpb:this.xX.jgc).set(null===(L=A.id)||void 0===L?void 0:L.toString(),b.id);return ba}XIe(b,h){if(h){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,A)=>r.Re-A.Re);for(let r=0;r<h.count;r++){const A=h.K(r);A.Re?b.Bf.pZ(A.Re-
1,1024):b.Bf.iva(A.Re,1024);b.Bf.rU(A.Re)}}else v.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}RKf(b,h){if(!b||!b.ra||!b.ra.last)return null;v.ULS.shipAssertTag(36471766,3029,h<=b.ra.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.ra.last.cp===h){var r=b.ra.length-1;if(!b.ra.jc(r).formatting)for(var A=r-1;0<=A;A--){var L=b.ra.jc(A);if(L.formatting){this.ee.P2(b,r,h,L.formatting);break}}return b.ra.last}r=null;for(A=0;A<b.ra.length;A++){L=b.ra.jc(A);if(L.cp>=h){if(L.cp>
h||!L.formatting)this.ee.P2(b,A,h,r),L=b.ra.jc(A);L.Oi||L.Yee();v.ULS.shipAssertTag(36471768,3029,L!==b.ra.last);return L}L.formatting&&(r=L.formatting)}return null}j0k(b){const h=new te.a;h.set(this.Kw);if(!this.Pgd(h))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.fKl(b);h.a8(b,1,null);h.yk(b);return b}fKl(b){const h=this.fvk.create(on.a.ipb);h.setValue(Rc.a.Wv,b);h.setValue(Rc.a.yNb,of.a.BG());return h}Ond(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,
3029,100,"Removed bookmark with id:{0}, ({1})",b.ka(Rc.a.yNb,-1),b.id);var h=new te.a;h.set(b);h.Ib(64);h.qh()}}QI(b){const h=[];let r=0;for(;b.anchor.rt&&7!==b.type;)h[r]=Bm.a[b.type],b=b.anchor.rt.Ku.node,r++;h[r]=Bm.a[b.type];return h.join(" ")}zCp(b,h){b.setValue(Rc.a.Wv,h)}FHj(b){const h=this.YCa(b,!0).oga;b=this.YCa(b,!1).oga;if(h&&b&&h.paragraph===b.paragraph){let r;this.Pnd(h.paragraph,(r=new Cb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.Pnd(h.paragraph,(r=new Cb.a,r.add(h),r))}if(b){let r;
this.Pnd(b.paragraph,(r=new Cb.a,r.add(b),r))}}}g0k(b,h,r,A,L){var ba;if(h=this.yhf(b,!0,this.RKf(b,h),r)){b.eo();var ra;this.XIe(b,(ra=new Cb.a,ra.add(h),ra));(r=this.yhf(A,!1,this.RKf(A,L),r))?(A.eo(),L=null===(ba=y.AFrameworkApplication.J)||void 0===ba?void 0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldFixBookmarkRunForEndPara",!1),zi.a.rx("eei77703;b54j9475"),L?this.XIe(A,(ra=new Cb.a,ra.add(r),ra)):this.XIe(b,(ra=new Cb.a,ra.add(r),ra))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,
3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}MIi(b,h){var r;if(!b)return null;h=null!==(r=this.$6c(h,b.id))&&void 0!==r?r:V.a.nil;return b.ed.Mb(h)?b.ed.Mb(h):null}vmn(b){return!!b&&64===b.Jf}Tmg(b){var h,r;if(0===b.yGa)return!1;const A=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const L=b.ra.jc(h);if(null!=L.Oi)for(let ba=0;ba<L.Oi.length;ba++){const ra=
L.Oi.K(ba),Ia=b.ed.Mb(ra.Ap).Xsb();if(!(D.a.jg(Ia)||Ia.startsWith(this.Lka)||A&&Ia.startsWith(this.v5a))&&ra.ld)return!0}}return!1}vKf(b){var h,r;const A=[];if(0===b.yGa)return A;const L=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const ba=b.ra.jc(h);if(null!=ba.Oi)for(let ra=0;ra<ba.Oi.length;ra++){const Ia=ba.Oi.K(ra),Ta=b.ed.Mb(Ia.Ap),ob=Ta.Xsb();D.a.jg(ob)||ob.startsWith(this.Lka)||
L&&ob.startsWith(this.v5a)||!Ia.ld||A.push(Ta)}}return A}Qbp(b){return b.ka(Rc.a.iK,!1)}wmn(b){return D.a.jg(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}f3l(b){return null!==this.XCa(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}ezi(b,h,r){return this.getBookmarkRange(b,h,r).oga}Q0i(b,h,r){if(this.Qbp(r)||this.Urn(r))return!1;const A=this.MIi(r,!0),L=this.MIi(r,!1);if(A&&L&&this.qb.ncd(h,
A,L)){if(h!==A&&h!==L)return!0;const ba=this.ezi(A,r,!0);if(ba&&(A!==h||ba.Rb.cp<=b)&&(r=this.ezi(L,r,!1))&&(L!==h||r.Rb.cp>=b))return!0}return!1}Urn(b){var h;b=null===b||void 0===b?void 0:b.ka(Rc.a.Wv,"");const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");return!D.a.jg(b)&&(b.startsWith(this.Lka)||r&&b.startsWith(this.v5a))?!0:!1}}Object(u.a)(oB,"FullBookmarkManager",null,[401]);class Ry{constructor(){this.QOe=this.Rt=this.Z=null}get name(){return"WordEditor.Bookmark"}Ec(b){this.Z=
b;this.Rt=this.Z.resolve("Box4.INotebookManager").Um;const h=new oB(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),Object(ao.a)(),this.Z.resolve("Box4.ICharacterPropertiesEditor"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc.Fd),gm.a.instance,this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("Box4.SelectionManager"),null,null,this.Z.resolve("Box4.BookmarkParagraphMapping"));this.Z.ja("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.Z.ja("WordEditor.Bookmark.BookmarksEventHandler",
()=>new AH(this.Rt.Hf(12),this.Z.resolve("WordEditor.ITableEditor"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();Pk.a.Shk&&(this.QOe=new zH(this.Rt.Hf(64),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),Object(ao.a)(),mp.a.instance,this.Z.resolve("Box4.BookmarkParagraphMapping")),this.Z.ja("WordEditor.Bookmark.BookmarkGraphManager",()=>this.QOe).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}dispose(){this.QOe.dispose()}Sp(){v.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.Z.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.IAo(this.Z.Za("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager"))}IAo(b,h){b&&b.execute(r=>{r.SW(new fD(h))})}static main(){F.a.instance.Rc(new Ry)}}Object(u.a)(Ry,"BookmarkPackage",null,[0,1]);var CH=e(908),pB=e(1064),gD=e(1474),at=e(1287);class DH extends at.a{constructor(b){super();
this.IXk=b}get index(){return 3}run(){this.IXk()}BK(){this.t2()}}Object(u.a)(DH,"FootnoteEndnoteGraphUpdateTracker",at.a,[]);class EH{constructor(){this.JFd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}Ec(){}init(){EH.Dc.Fs.continueWith(()=>{this.Sp()})}Sp(){CH.a.xsb=gD.a.instance;this.yWf()}dispose(){}yWf(){this.JFd=new DH(()=>{gD.a.instance.Dx()});pB.a.lxe(Object(E.a)(this.JFd,this.JFd.BK,"setUpdateNeeded"));Ar.a.instance.Cxa(this.JFd,3)}static get Dc(){return Xa.a.instance.resolve("Box4.IFeatureHelper")}}
Object(u.a)(EH,"PackageManager",null,[0,1]);var dK=e(794),eF=e(251),qB=e(553),rB=e(491),Sy=e(1630);class sB extends Ay{constructor(){super()}get hx(){return null}getTitle(b){b=b.Hua();if(!b||!qB.a.instance.xva(b))return"";const h=new Sys.StringBuilder,r=qB.a.instance.Ica(b);h.append(1===r?WacWordeditorStrings.FootnoteContentTitle:WacWordeditorStrings.EndnoteContentTitle);h.append(" ");h.append(qB.a.instance.pmc(b));return h.toString()}}Object(u.a)(sB,"FootnoteEndnoteBaseDetailsProvider",Ay,[]);class FH extends sB{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get xi(){return 7}}
Object(u.a)(FH,"FootnoteEndnoteDetailsProvider",sB,[]);var fF=e(1551),gF=e(1585),eK=e(1700);class hD extends sB{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get xi(){return 10}}Object(u.a)(hD,"FootnoteEndnoteRefMarkDetailsProvider",sB,[]);class tB{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie){this.LXi=(re,me,Sd,cf,sf)=>{cf=me.view;if(!cf.features.WEe||this.SG.L0i)return 8;const yh=cf.ub.hh;if(!yh)return 2;if(this.sm.t4(yh))return 8;cf=re===Lc.a.insertFootnote?1:
0;var si=this.I8d(me);if(!si)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;me=!0;si=si.Ya;sf&&sf.vrc&&sf.GNa&&(si=sf.GNa,me=!sf.keepCurrentFocus);if(1===Sd&&bi.a.bda(yh)||!si||!Ee.a.Df(si)||this.Ghh.instance&&this.Ghh.instance.ktn(si)||Mc.a.aEa(si,!0))return 8;if(1===Sd)return 32;2===Sd&&(Sd=this.nY.rg("UserAction","InsertFootnoteEndnote"),re=this.lCk.whn(si,cf,re),sf&&sf.vrc&&(sf.Umj=re),me&&this.ase(re,!0,!0),Sd.stop(),this.me.Vv(6));return 32};this.Huc=(re,me,Sd)=>
{const cf=me.view;if(re===Lc.a.Pgb||re===Lc.a.qBb){if(!cf.features.WEe)return 8}else if(!cf.features.YJg)return 8;if(!cf.ub.hh)return 2;me=this.onc(me);return me?re!==Lc.a.Pgb&&re!==Lc.a.qBb||this.dTa.o4m(me.node,re===Lc.a.Pgb?1:0)?1===Sd?32:2===Sd&&32===this.ga.Zb(Lc.a.C8,2,!0)?(this.ga.Zb(Lc.a.Weg,2,re),32):8:8:2};this.Dim=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;if(2===Sd){re=this.NQm(me);if(!re)return 8;Sd=me=null;switch(sf){case Lc.a.foe:Sd=re.hd;me=this.E9b.uce(Sd,1);break;case Lc.a.eoe:Sd=re.hd;
me=this.E9b.uce(Sd,0);break;case Lc.a.hoe:Sd=re.Ya;me=this.E9b.nQi(Sd,1);break;case Lc.a.goe:Sd=re.Ya;me=this.E9b.nQi(Sd,0);break;case Lc.a.Pgb:Sd=re.Ya;(me=this.E9b.uce(Sd,1,!0))||(me=this.dTa.mDi(Sd.node,1));break;case Lc.a.qBb:Sd=re.Ya,(me=this.E9b.uce(Sd,0,!0))||(me=this.dTa.mDi(Sd.node,0))}if(me)this.ase(me);else{if(!this.LA.Xc)return 8;(sf=kp.d(Sd.node,Sd.cpBegin))&&7===sf.xi&&this.dTa.vQj(sf)}}return 32};this.qep=(re,me,Sd,cf,sf)=>1===Sd?32:2===Sd?(v.ULS.shipAssertTag(4520066,308,!!sf),v.ULS.shipAssertTag(4520067,
308,!!sf.G9a),re=sf.G9a,v.ULS.shipAssertTag(4520068,308,this.hI.xva(re)),this.ase(re,sf.pCe)?32:8):32;this.rep=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;2===Sd&&(re=sf.yca,sf=sf.Gim)&&(this.Cza.lkc(),me=this.hI.Pvb(re),sf.title=this.hI.uAm(re)+(me?WacWordeditorStrings.FootnoteTooltipInstruction:WacWordeditorStrings.EndnoteTooltipInstruction));return 32};this.Aeb=(re,me,Sd,cf,sf)=>2===Sd?(v.ULS.shipAssertTag(4520069,308,!!sf),v.ULS.shipAssertTag(4520070,308,!!sf.G9a),v.ULS.shipAssertTag(4520071,308,rd.ParagraphReader.lc(sf.G9a)),
re=this.hI.Kab(sf.G9a),this.ase(re,sf.pCe)?32:8):32;this.E0o=(re,me,Sd)=>{2===Sd&&this.SG.N2();return 32};this.n0l=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;if(2===Sd)return void 0!==sf&&null!==sf?this.SG.OAf(sf,sf):this.SG.OAf(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.uFn=(re,me,Sd)=>{re=this.onc(me);return re&&Ee.a.Df(re)?1===Sd?32:2===Sd?(Sd=0<this.Vq.M4(re.node).ww,this.SG.ewf(),this.SG.dialog.oub=Sd,32):8:(v.ULS.sendTraceTag(4743179,
308,10,"Expected an IP context here."),8)};this.Bim=(re,me,Sd)=>1===Sd?32:2===Sd?(this.SG.dialog.oub=!1,32):8;this.Tro=(re,me,Sd,cf,sf)=>this.Gvi(re,Sd,sf);this.Rro=(re,me,Sd,cf,sf)=>1===Sd?32:this.SG.dialog&&this.SG.dialog.fontName?(sf[$c.a.Value]=this.SG.dialog.fontName,32):this.vyk.wXa(fb.a.Q_b.toString(),sf,null)?32:8;this.Aim=(re,me,Sd)=>1===Sd?32:2===Sd?(this.SG.dialog.oub=!0,32):8;this.Sro=(re,me,Sd,cf,sf)=>this.Gvi(re,Sd,sf);this.yim=(re,me,Sd)=>{if(1===Sd)return 32;if(2===Sd){re=this.onc(me);
if(!re)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;me=this.hI.Kab(re.node);this.hI.xva(me)&&(Sd=this.Zc.Vc(15),Sd.Eb(me),this.Xbk(re),this.dTa.iYh(me,this.SG.dialog),Sd.dispose());this.SG.Yod();return 32}return 8};this.xim=(re,me,Sd)=>{if(1===Sd)return 32;if(2===Sd){re=this.onc(me);if(!re)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;me=this.hI.Kab(re.node);this.hI.xva(me)&&(Sd=this.Zc.Vc(15),Sd.Eb(me),this.Xbk(re),this.dTa.udl(me,
this.SG.dialog),Sd.dispose());this.SG.Yod();return 32}return 8};this.zim=(re,me,Sd)=>1===Sd?32:2===Sd?(this.SG.Yod(),32):8;this.vim=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;if(2===Sd){re=Object(ya.a)(410,sf);if(!re||!re.Ed)return 8;this.SG.dialog.fontName=re.Ed.fontName;return 32}return 8};this.wim=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;if(2===Sd){re=Object(ya.a)(410,sf);if(!re||!re.Ed)return 8;this.SG.dialog.D9b=re.Ed;return 32}return 8};this.ga=b;this.LA=h;this.vyk=r;this.zd=A;this.hI=L;this.lCk=
ba;this.dTa=ra;this.Cza=Ia;this.SG=Ta;this.Vq=ob;this.E9b=nb;this.Zc=Eb;this.sm=bc;this.Sb=Bc;this.nY=Yc;this.me=zd;this.ksk=Jd;this.Ghh=ie}Xbk(b){(b=pb.a.uu(b))?(this.SG.dialog.fontName||(this.SG.dialog.fontName=b.cache.aK),-1===this.SG.dialog.fontSize&&(this.SG.dialog.D9b=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Gvi(b,h,r){return 1===h&&this.SG.dialog?32:2===h&&this.SG.dialog?(r[Pf.a.On]=b===Lc.a.Xrg?this.SG.dialog.oub:!this.SG.dialog.oub,
32):8}mc(){Ze.a.instance.YUi([Lc.a.foe,Lc.a.eoe,Lc.a.hoe,Lc.a.goe,Lc.a.Weg,Lc.a.Pgb,Lc.a.qBb,Lc.a.C8]);this.ga.nb(Lc.a.insertFootnote,ic.a.view,this.LXi,4);this.ga.nb(Lc.a.insertEndnote,ic.a.view,this.LXi,4);this.ga.qa(Lc.a.foe,ic.a.view,this.Huc);this.ga.qa(Lc.a.Weg,ic.a.view,this.Dim);this.ga.qa(Lc.a.eoe,ic.a.view,this.Huc);this.ga.qa(Lc.a.hoe,ic.a.view,this.Huc);this.ga.qa(Lc.a.goe,ic.a.view,this.Huc);this.ga.qa(Lc.a.Pgb,ic.a.view,this.Huc);this.ga.qa(Lc.a.qBb,ic.a.view,this.Huc);this.ga.qa(Lc.a.b_j,
ic.a.view,this.qep);this.ga.nb(Lc.a.Evi,ic.a.view,this.Aim,4);this.ga.nb(Lc.a.Xrg,ic.a.view,this.Sro,100);this.ga.nb(Lc.a.Fvi,ic.a.view,this.Bim,4);this.ga.nb(Lc.a.TCj,ic.a.view,this.Tro,100);this.ga.qa(Lc.a.c_j,ic.a.view,this.rep);this.ga.nb(Lc.a.Aeb,ic.a.view,this.Aeb,96);this.ga.nb(Lc.a.y7d,ic.a.view,this.E0o,96);this.ga.qa(Lc.a.C8,ic.a.view,this.n0l);this.ga.nb(Lc.a.Baj,ic.a.view,this.uFn,4);this.ga.nb(Lc.a.Bvi,ic.a.view,this.yim,4);this.ga.nb(Lc.a.Cvi,ic.a.view,this.xim,4);this.ga.nb(Lc.a.Dvi,
ic.a.view,this.zim,4);this.ga.nb(Lc.a.w7d,ic.a.view,this.vim,4);this.ga.nb(Lc.a.SCj,ic.a.view,this.Rro,100);this.ga.nb(Lc.a.x7d,ic.a.view,this.wim,4);this.ga.nb(Lc.a.Lkd,ic.a.view,tB.Lkd,100);this.ga.nb(Lc.a.Mkd,ic.a.view,tB.Mkd,100)}sug(){this.ksk.execute(b=>{b.SW(new FH);b.SW(new hD)})}onc(b){b=this.I8d(b);return b?b.Ya:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}I8d(b){let h=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),
h;b=b.ub;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.ob;if(!b||!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.K(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=Ee.a.Xk(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}NQm(b){return(b=b.view)?b.ub.ob.K(0):null}ase(b,h=!0,
r=!1){if(b){this.Cza.lkc();var A=b.tua;if(A){var L=A.Rb,ba=Tb.SelectionFactory.eN(L.paragraph,L.cp,L.cp+1);L=this.LA.Xc;if(!L)return!1;this.zd.xja(L,ba);L.pAb=150;L.c6();b=new rB.a(b,h);ba=eF.a.umc(A,L);A=A.jDa(L,ba);if(!A)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||A.element?this.SG.DGg(b):(this.SG.DGg(new rB.a(b.G9a,!1)),h&&(h=new Md.a(2,1,10,()=>{this.SG.N2()}),this.Sb.pc(h)));return!0}}return!1}static lAm(){return new tB(y.AFrameworkApplication.va,Db.StaticActiveAppFrame.Aa().tb,
Xa.a.instance.resolve("Box4.IGeneralCuiUser"),Object(Vb.a)(),qB.a.instance,gF.a.instance,fF.a.instance,gD.a.instance,Sy.FootnoteEndnoteControlManager.instance,Xa.a.instance.resolve("Box4.IParagraphIndentationReader"),eK.a.instance,new gm.a,Ke.a.instance,vb.TaskManager.instance,y.AFrameworkApplication.ta.Kt,Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Xa.a.instance.Za("Box4.IContentControlReader"))}static kAm(){return tB.lAm()}static Lkd(b,
h,r,A,L){if(1===r)return 32;if(2===r&&!L)return 8;Qa.a.gfe(h);L.PopulationXML=cp.a.hxi(Qa.a.LCe,Qa.a.uIf,Lc.a.w7d);return 32}static Mkd(b,h,r,A,L){if(1===r)return 32;if(2===r&&!L)return 8;L.PopulationXML=cp.a.ixi(Lc.a.x7d);return 32}}Object(u.a)(tB,"FootnoteEndnoteActor",null,[557]);class fK extends at.a{constructor(b){super();this.bff=b}get index(){return 1}run(){this.bff()}BK(){this.t2()}}Object(u.a)(fK,"FootnoteEndnoteControlUpdateTracker",at.a,[]);var hF=e(365);class gK extends hF.a{constructor(b,
h,r,A,L,ba,ra){super(b,h,r,A);this.Jv=()=>{this.mwd(this.Jb)};this.AM=b.container;this.az=document.createElement("div");b.container.appendChild(this.az);this.LR(this.az);this.mRk=L;this.Zo.execute(Ia=>{Ia.UW(this.Jv)});this.hTa=ba;this.eba=ra;this.hTa.execute(Ia=>{Ia.OEg(this.rc,this.AM)});this.AM.style.backgroundColor=this.eba.Vmc()}dispose(){super.dispose();this.Zo.instance&&this.Zo.instance.NPa(this.Jv)}get Zo(){return null!=this.F0g?this.F0g:this.F0g=Xa.a.instance.Za("Common.IZoomManager")}OD(b){this.AM.classList.add("FootnoteEndnoteViewElement");
this.mwd(b.currentNode)}mwd(b){this.Zo.instance&&(this.Zo.instance.byd(this.az),this.az.style.width=Math.round(100/this.Zo.instance.Ql)+"%");this.mRk(b)}}Object(u.a)(gK,"FootnoteEndnoteViewElement",hF.a,[]);class hK{constructor(){this._initialized=!1;this.bCd=this.UVe=this.Z=null;this.Iim=(b,h,r,A)=>b.Gcb?new gK(b,h,r,A,L=>{Sy.FootnoteEndnoteControlManager.instance.FMo(L)},this.Z.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.Z.resolve("WordEditor.PageBackground.PageBackgroundColorHandler")):
null}get name(){return"WordEditor.FootnoteEndnote"}Ec(b){this.Z=b}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){Ur.a.instance.Zeg=Object(E.a)(fF.a.instance,fF.a.instance.FXn,"navigateToWordSectionNodeWithFootnoteEndnote");dK.a.DEg(this.Iim);Sy.FootnoteEndnoteControlManager.instance.bind(Db.StaticActiveAppFrame.Aa().VH);this.UVe=tB.kAm();this.UVe.mc();this.UVe.sug();Db.StaticActiveAppFrame.Aa().Ne();this.yWf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=
!1,Sy.FootnoteEndnoteControlManager.instance.dispose())}yWf(){this.bCd=new fK(()=>{Sy.FootnoteEndnoteControlManager.instance.nwd()});pB.a.lxe(Object(E.a)(this.bCd,this.bCd.BK,"setUpdateNeeded"));Ar.a.instance.Cxa(this.bCd,3)}}Object(u.a)(hK,"PackageManager",null,[0,1]);class uB{constructor(b,h,r,A){this.pb=h;this.Vka=A}get bookmarkManager(){return this.Vka.value}btn(b){return Pk.a.Shk?b.startsWith(D.a.K8a):!1}u1m(b){try{this.v1m(b)}catch(h){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",
h.message))}}NNg(b){return{returnValue:!1,avg:b,kab:""}}v1m(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.XCa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.YCa(h,!0).oga,h=this.bookmarkManager.YCa(h,!1).oga,b||h?b?this.xVj(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.xVj(h)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.f$i(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),
this.f$i(!0))}}f$i(b){b=Tb.SelectionFactory.zq(Db.StaticActiveAppFrame.Aa().tb.rd.eBi(),b);this.pb.Uc(b)}xVj(b){b.paragraph&&b.Rb?(b=Tb.SelectionFactory.Ie(b.paragraph,b.Rb.cp),b.O_i=!0,this.pb.Uc(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(u.a)(uB,"InternalLinkManager",null,[409]);class GH{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}Ec(b){b.ja("WordEditor.InternalLinks.InternalLinkManager",()=>new uB(new xe.a(()=>
b.Wa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new xe.a(()=>b.Wa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){F.a.instance.Rc(new GH)}}Object(u.a)(GH,"WordEditorInternalLinksPackage",null,[0,1]);class Ty{constructor(b){this.NTa=null;this.Eul=h=>{h=h.customData;if(h.anchor){Yb.a.mark(4763);var r=te.a.kb(h);if(r.Ib(8)&&r.xd(8)&&r.SNg(h)===
h){if(il.a.isEmpty(r)){let A=!1;for(let L=0;L<Fg.a.instance.ob.length;L++){const ba=Fg.a.instance.ob.K(L);for(let ra=0;ra<ba.length;ra++)if(ba.K(ra).node===h){A=!0;break}}A||this.sji(r)}Yb.a.mark(4764)}}};Ty.hV=b}k1d(b){if(!Ty.Jj.Fie(b))return null;b.ic(1)&&(b.currentNode.vm(8,!0),b.Ac());const h=Ty.hV.POl();Ty.Jj.isRtl(b.currentNode)?h.setValue(Sb.a.au,11):h.setValue(Sb.a.au,9);b.pg(h,1);b.yk(h);return h}h2o(b){if(this.NTa&&b!==this.NTa){const h=new Md.a(2,1,0,this.Eul,120);h.customData=this.NTa;
y.AFrameworkApplication.zc.pc(h)}this.NTa=b}sji(b){this.NTa===b.currentNode&&(this.NTa=null);const h=new hb.GraphTransaction(7);h.nw(b);b.qh();h.dispose()}h7h(){if(this.NTa&&this.NTa.anchor){const b=te.a.kb(this.NTa);b.ku()&&il.a.gbd(b)&&this.sji(b);this.NTa=null}}static get Jj(){return fn.a.instance}}Ty.hV=null;Object(u.a)(Ty,"PageContentEditor",null,[1438]);var HH=e(1159),uu=e(536);class iK extends Pu{constructor(){super()}HYj(b,h,r,A,L){let ba=!1,ra=!0;Ee.a.Df(L)&&(h=nf.a.Wg(b)&&h,L=Mb.a.RC(b,
L,!1)&&!Mb.a.RC(b,L,!0),h&&r.mqf(b,A)&&(ba=!0),If.a.Gd().pn&&(L||h&&!ba)&&(ra=!1));return{GYj:ra,qhk:ba}}}Object(u.a)(iK,"CursorMoveValidator",Pu,[]);var jK=e(224);class dl{constructor(b,h,r,A,L){this.kK=L;this.A6e=b;this.Daa=A;this.Aza=h;this.ni=r}get Yd(){return null!=this.nah?this.nah:this.nah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lk(){return null!=this.X$g?this.X$g:this.X$g=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get kc(){return null!=
this.Lbh?this.Lbh:this.Lbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Zf(){return null!=this.V9g?this.V9g:this.V9g=Xa.a.instance.Wa("Box4.Styles.StyleSettings")}get Bv(){return this.Daa.value}get Yf(){return this.ni.value}get su(){return this.Aza}p_m(b){const h=window.performance.now(),r=new Zf.ScriptSharpLegacyMap,A=new ki.a,L=new Zf.ScriptSharpLegacyMap;if(b&&b.My){var ba=null;for(let ra=0;ra<b.length;ra++){const Ia=b.getContext(ra);ba=ba||Object(ao.a)().kw(Ia.node);let Ta;if(!({groupId:Ta}=
this.yxp(Ia.node,ba)).returnValue)continue;let ob;r.Bb(Ta)||(ob=[],r.add(Ta,ob));ob=r.K(Ta);ob.push(Ia)}for(const ra of Mm.toArray(r.keys))b=r.K(ra),ba=new te.a,ba.set(b[0].node),({QMj:b,Bu:ba}=this.Aza.Xwp(ba)).returnValue?(r.W(ra,b),L.add(ra,ba)):A.add(ra)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,s_m:A,r_m:L}}fOb(b){return this.asl(b)}Kgc(b){return this.wrl(b)}WXd(b,h,r=!0){return te.a.Yga(()=>
{var A=!1;if(nf.a.Wg(b))return this.mqf(b,h,r);A||(hg.a.Ze(b),A=rd.ParagraphReader.Wh(b)||Qh.TableReader.isTable(b),hg.a.xe(b),A=A&&this.$rl(b,h));return A})}mqf(b,h,r=!0){return te.a.Yga(()=>{const A=Mb.a.eDa(b),L=il.a.u1(b.currentNode);if(r?!this.Oun(b,h):!this.Pun(b,h))return!1;var ba=te.a.kb(b.currentNode);if(0<h&&ba.Ib(14)){ba.xd(16);var ra=ba.currentNode;const Ia=ih.TableCellReader.KRf(ba);ba.xd(14);const Ta=ba.currentNode;ba=xq.a.aR(ra,Ta,Rc.a.xU,Rc.a.Ba,0);ra=xq.a.aR(ra,Ta,Rc.a.fX,Rc.a.Ea,
0);ba=rb.a.YB(ba,0);ra=rb.a.YB(ra,0);return A+L<Ia-ba-ra}return!0})}$rl(b,h){const r=Mb.a.eDa(b);var A=Mb.a.cK(b);if(0<h){h=il.a.u1(b.currentNode);A=0;const {pageWidth:Ia,marginLeft:Ta,marginRight:ob}=dl.kae(b.currentNode);var L=te.a.kb(b.currentNode);hg.a.Ze(b);if(Qh.TableReader.isTable(b)){A=Qh.TableReader.Dca(b);var ba=0;for(var ra of A)ba+=ra;A=rb.a.YB(rb.a.Rf(ba,0),0)}hg.a.xe(b);return L.Ib(14)?(L.xd(16),ra=L.currentNode,b=ih.TableCellReader.KRf(L),L.xd(14),ba=L.currentNode,L=xq.a.aR(ra,ba,Rc.a.xU,
Rc.a.Ba,0),ra=xq.a.aR(ra,ba,Rc.a.fX,Rc.a.Ea,0),L=rb.a.YB(L,0),ra=rb.a.YB(ra,0),r+h<b-L-ra-A):r+h<Ia-Ta-ob-A}return 0<r-A}Z0a(b,h){this.Wvj(b,-1*Math.abs(h))}H0c(b,h){this.Wvj(b,Math.abs(h))}eZl(b,h,r,A,L){let ba=dl.Djj;if(h>=dl.Djj){ba=h-=r;const ra=A*L,Ia=Math.abs(ra),Ta=Math.abs(h)%Ia;Ta&&(ba=0>ba?0>A?ba+Ta:ba-(Ia-Ta):0<A?ba-Ta:ba+(Ia-Ta));ba+=ra;ba+=r;dl.Use&&(r=Mb.a.M4(b),ba=dl.Use.lAi(b.currentNode,h+r,ba+r,L,ba<h)-r)}return ba}Yrl(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.bCi(b[0].node,
h);return this.Zrl(b,h,r)}Ddo(b,h,r){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),
8;const A=b[0].node;h=this.bCi(A,h);if(!this.pVn(A,r[0],h)||!this.mVn(b,h))return 8;this.Bv.X2();return 32}mVn(b,h){for(let r=0;r<b.length;r++){const A=new te.a;A.set(b[r].node);let L=null;hg.a.Ze(A);if(rd.ParagraphReader.Wh(A)){if(L=A.currentNode,!L)return v.ULS.shipAssertTag(589592461,338,!L,"The paraNode is null for the list OE node"),!1}else if(!rd.ParagraphReader.Wh(A)&&!Qh.TableReader.isTable(A))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),
!1;A.Ac();if(L){if(this.v4m(L)){const ba=L.GC(),ra=Mb.a.eDa(A);this.Yf.Jxa(A,1,ra+h);ba&&this.lk.MR(L,ba,this.Yd.Zg)}qh.a.getInstance().Gv||L.setValue(Sb.a.qW,new Date)}}return!0}pVn(b,h,r){for(let A=0;A<Gi.a.nK;A++){const L=this.Aza.XA(b,h,A);if(!L)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ba=L.getValue(Rc.a.ve);ba&&L.setValue(Rc.a.ve,ba+r)}return!0}v4m(b){return b.hasProperty(Rc.a.ve)||b.hasProperty(Rc.a.lv)||b.hasProperty(Rc.a.vF)}wrl(b){return this.WXd(b,
1,!0)}asl(b){return this.WXd(b,-1,!0)}bCi(b,h){var r=new te.a;r.set(b);const A=Mb.a.eDa(r),L=Mb.a.cK(r),ba=Mb.a.M4(r);r=il.a.u1(b);dl.kae(b);b=(L?A-L:ba)%r;return h?-1*(b?b:r):r-b>dl.mii?dl.mii:r-b}yxp(b,h){if(nf.a.Qe)return h=nf.a.wna(b),h=jK.a.Pmc(null===h||void 0===h?void 0:h.listId),{groupId:h,returnValue:null!=h};let r;const A=new te.a;A.set(b);b=A.ic(4).getValue(Rc.a.listID);return({id:r}=this.Aza.tDc(b,h)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}Zrl(b,h,r){var A=!1;
for(let L=0;L<b.length;L++){A=b[L];const ba=new te.a;ba.set(A.node);Ee.a.uw(ba);if(!Mb.a.ji(ba))return dl.Jc.qc(pf.a.$e,{["Reason"]:uf.a.tQb}),!1;if(this.WXd(ba,h,r))A=!0;else return dl.Jc.qc(pf.a.tjc,{["Reason"]:uf.a.Eqf}),!1}return A}Wvj(b,h){if(this.WXd(b,h,!0)){var r=!1;if(nf.a.Wg(b)){var A=new te.a;A.Ad(b);this.su.s2(A);var L=A.currentNode;A.Ac();r=!0;const {listId:ra,listLevel:Ia}=nf.a.wna(b);var ba=this.ASm(ra,Ia+h);if(ba)hg.a.Ze(A),rd.ParagraphReader.Wh(A)&&dl.nO.IP(ba,A.currentNode,!1),A.Ac();
else{ba=null;let Ta;hg.a.Ze(A);rd.ParagraphReader.Wh(A)&&(ba=A.currentNode);A.Ac();Ta=ba?ba.GC():null;ba||(hg.a.Ze(A),rd.ParagraphReader.Wh(A)&&(ba=A.currentNode),A.Ac());ba&&(ba.hasProperty(Rc.a.ve)&&ba.removeProperty(Rc.a.ve),ba.hasProperty(Rc.a.lv)&&ba.removeProperty(Rc.a.lv));qh.a.getInstance().xu||L.setValue(Rc.a.listLevel,Ia+h);qh.a.getInstance().Gv&&this.kK.f2b(ba,ra,Ia+h);qh.a.getInstance().xu||L.removeProperty(Rc.a.k2);ba&&Ta&&(this.lk.MR(ba,Ta,this.Yd.Zg),this.Bv.X2());this.qop(b,nf.a.Qe?
ba:L)}}r||(r=Mb.a.eDa(b),A=Mb.a.cK(b),L=il.a.u1(b.currentNode),h=this.eZl(b,r,A,h,L),this.Yf.Jxa(b,1,h))}}Pun(b,h){const r=Mb.a.eDa(b),A=Mb.a.cK(b),L=Mb.a.M4(b),{pageWidth:ba,marginLeft:ra,marginRight:Ia}=dl.kae(b.currentNode);if(0<h){if(b=ba-ra-Ia,L&&L+h+Ze.a.iHa>b||r+h+Ze.a.iHa>b)return!1}else if(L&&0>r+h||0>r-A+h)return!1;return!0}Oun(b,h){var r=this.Bv.mG(b);const A=r.level+h;if(Xn.a.YEn<A||A<Xn.a.kgm)return!1;r=this.su.XA(b.currentNode,r.listID,A);if(!r)return v.ULS.shipAssertTag(590700875,338,
!!r),!1;if(0<h&&r.hasProperty(Rc.a.ve)){h=r.getValue(Rc.a.ve);const {pageWidth:L,marginLeft:ba,marginRight:ra}=dl.kae(b.currentNode);if(h+Ze.a.iHa>L-ba-ra)return!1}return!0}ASm(b,h){const r=this.kc.Il();let A,L;this.Zf.zl?(A=r.Ev(),L=A.ix):L=r.ix;for(let ra=0;ra<L;ra++){var ba=void 0;this.Zf.zl?(ba=A.uha(ra),ba=r.Qg(this.kc.Je(ba))):ba=r.nDa(ra);if(this.su.prb(ba)&&ba.ka(Rc.a.listID,this.Bv.nda+1)===b&&ba.ka(Rc.a.listLevel,-1)===h)return ba}return null}qop(b,h){hg.a.Ze(b);if(rd.ParagraphReader.Wh(b)&&
b.currentNode.hasProperty(Rc.a.ve)&&(h=this.su.Emc(h))){if(h.hasProperty(Rc.a.lv)){var r=h.getValue(Rc.a.lv);this.A6e.JAb(b.currentNode,r)}h.hasProperty(Rc.a.ve)&&(r=h.getValue(Rc.a.ve),this.A6e.Jxa(b,1,r));h.hasProperty(Rc.a.vF)&&(h=h.getValue(Rc.a.vF),this.A6e.pja(b.currentNode,h))}hg.a.xe(b)}static get nO(){return null!=dl.kbh?dl.kbh:dl.kbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Use(){return null!=dl.H7g?dl.H7g:dl.H7g=Xa.a.instance.Wa("WordEditor.ParagraphIndentationUtility")}static get gm(){return dl.Ww||
(dl.Ww=Xa.a.instance.resolve("Box4.IParagraphEditor"))}static set gm(b){dl.Ww=b}static get Jc(){return $g.a.instance}static get wg(){return Ap.a.instance}static kae(b){var h=Ur.a.instance.zW(b);b=dl.wg.nx(h);const r=dl.wg.eP(h);h=dl.wg.fP(h);return{pageWidth:b,marginLeft:r,marginRight:h}}}dl.mii=fg.a.pF(.25);dl.Ww=null;dl.Djj=fg.a.pF(-11);Object(u.a)(dl,"OutlineElementIndentationEditor",null,[623,624]);var Uz=e(268),IH=e(1886);class Uy{constructor(b,h){this.uV=null;this.AO=h;this.zg=b}get gm(){return null!=
this.p7g?this.p7g:this.p7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}get fF(){return null!=this.Z_g?this.Z_g:this.Z_g=Xa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Qj(){return null!=this.q0g?this.q0g:this.q0g=Xa.a.instance.resolve("Box4.IFormattingEditor")}get kc(){return null!=this.Mbh?this.Mbh:this.Mbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get c3(){return this.uV||(this.uV=new uu.a)}set c3(b){this.uV=b}get Dc(){return null!=this.x_g?this.x_g:this.x_g=Xa.a.instance.Wa("Box4.IFeatureHelper")}get om(){return this.AO.value}get Ok(){return null!=
this.F1g?this.F1g:this.F1g=Xa.a.instance.Wa("Box4.IInsertionPointFormatting")}get Sed(){return this.zg||(this.zg=Xa.a.instance.resolve("Box4.List.IListReader"))}get Ug(){return null!=this.BXg?this.BXg:this.BXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Yd(){return null!=this.Eah?this.Eah:this.Eah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lk(){return null!=this.bah?this.bah:this.bah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get U4(){return null!=
this.R0g?this.R0g:this.R0g=Xa.a.instance.resolve("Box4.IBox4GraphWriter")}ISm(b){const h=b.node;var r=this.Ok?this.Ok.Tzi():null;if(r&&!r.equals(V.a.nil)){if(b=h.ed,!b||(r=this.c3.Fna(r,b))&&1!==this.kc.wH(r))return null}else r=pb.a.uu(b),r=pb.a.Wua(r);return r}d6o(b,h){const r=this.kc.pG(h);r&&r.Qg(this.kc.Je(b))&&(this.mQg(h,r),this.Ok&&(this.Ok.Yzb(),this.Ok.Hgb(b,h)))}Wcl(b,h){if(h)if(h.VRb&&0<h.VRb.length){let L=new Ka.a;for(var r of h.VRb)L.add(r);if(h.k$i){r=pb.a.$xi(b);const ba=[];for(var A of r)A.formatting&&
A.formatting.qp&&ba.push(A.formatting.qp);if(0<ba.length){A=jv.a.EFi(ba);r=new Ka.a;for(const ra of L)(!A.hasProperty(ra)||h.BDn&&ra===Me.a.kib)&&r.add(ra);L=r}}this.gm.vOb(b,!0,L)}else this.gm.vOb(b,!0);else Cd.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}IP(b,h,r,A=!1,L=!1,ba=!1,ra=null,Ia=!1){var Ta,ob,nb;if(rd.ParagraphReader.lc(h))if(b)if(this.kc.i2(b.rj()))if(2!==this.kc.wH(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Eb=
this.kc.pG(h);if(Eb){var bc=this.kc.Je(b);if(!bc)v.ULS.shipAssertTag(593506377,324,!1);else if(Eb.Qg(bc)){var Bc=null,Yc=A?null:h.GC();r||((null===ra||void 0===ra?0:ra.lrl)&&(null===(Ta=this.Dc)||void 0===Ta?0:Ta.isFeatureEnabled(94))?(this.Wcl(h,ra),qh.a.getInstance().xu||1!=ra.VRb.length||ra.VRb[0]!=Me.a.kib?this.$Dp(h,b,ra):Bc=this.om.QEj(Bc,h)):(qh.a.getInstance().xu||(Bc=this.om.QEj(Bc,h)),this.gm.vOb(h,!0)));this.mQg(h,Eb);L&&(null===Yc||void 0===Yc?0:Yc.hasProperty(Tc.a.uA))&&Yc.removeProperty(Tc.a.uA);
nf.a.Qe&&!qh.a.getInstance().xu&&this.tYh(b,h,Bc,Ia);(null===(ob=this.U4)||void 0===ob?0:ob.kea)?this.U4.kea(h,Tc.a.uA,b.id):h.properties.setValue(Tc.a.uA,b.id);(Ia||(nf.a.Qe?nf.a.isListItem(h):this.Sed.pha(h)))&&(null===(nb=this.Dc)||void 0===nb?0:nb.isFeatureEnabled(94))&&this.Mbk(h,b,ra);h.ZR=b;h.FQa=null;for(r=0;r<h.ra.length;r++)h.ra.jc(r).formatting&&h.ra.jc(r).formatting.pVb();nf.a.Qe||this.tYh(b,h,Bc,Ia);null!=this.fF&&this.fF.TAc(bc);A||!Yc||ba||this.lk.MR(h,Yc,this.Yd.Zg);nf.a.Qe&&this.Sed.prb(b)&&
this.om.X2()}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,324,!1)}tYh(b,h,r,A){this.Sed.prb(b)&&(r||(r=new te.a,r.set(h),r.Wd(),hg.a.xe(r)),A||nf.a.Wg(r)||(h.fg(Rc.a.ve,Rc.a.IW,Rc.a.vF,Rc.a.d$,Rc.a.D0a,Rc.a.tA),this.ZVd(r,b)))}$Dp(b,h,r){let A;qh.a.getInstance().xu||(A=this.Sed.pha(b));const L=this.Sed.prb(h);if(!qh.a.getInstance().xu&&A||nf.a.Qe&&nf.a.isListItem(b))this.Mbk(b,h,
r),qh.a.getInstance().xu||!A||L||A.removeProperty(Rc.a.k2)}Mbk(b,h,r){const A=b.ed;if(b=this.Ug.J$a(b)){var L=null==b.qp?new Uz.a:b.qp.clone();Wj.a.eHp(L,h,r&&!r.k$i&&r.VRb?r.VRb:null,!qh.a.B2f);L.cOa?h=A.mU(L,!0):(A.Mv(L,null),h=L);b.ol=h.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}ZVd(){}Ord(b,h){if(h){v.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.kc.pG(h);r?(Wj.a.Zf.zl?(b=r.Ev().Ena(b),r=r.Qg(this.kc.Je(b))):
r=r.Rua(b),r?this.kc.i2(r.rj())?this.IP(r,h,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.kc.i2(r.rj())):v.ULS.shipAssertTag(593506369,324,!!r)):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}wYc(b,h=!1,r=!1){const A=this.kc.pG(b).Qg(Hg.a.wordStyleIdNormal);this.IP(A,b,h,void 0,r)}mQg(b,h){(b=Object(ao.a)().kw(b))&&(Wj.a.Zf.F6i&&Wj.a.Zf.zl?h.Ev().zze(b):h.fEg(b))}iji(b){var h=null;if(!b||!b.count)return v.ULS.sendTraceTag(592221652,
3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Wj.a.Pp(),!h))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.c3.pna(h);if(!r)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var A=new Map;A.set("NumberOfStyles",b.count.toString());A.set("Source","DeleteStyleAPI");Ca.Health.instance.recordKpiUsage(Up.a.iKe,0,Up.a.GB,A);A=0;const L=(new Date).getTime();var ba=null;let ra=null,Ia=null,Ta=null;
const ob=this.Dc.isFeatureEnabled(30)&&!0;ob&&(ba=new Cb.a,ra=new Cb.a,Ia=new Cb.a,Ta=new Cb.a);for(var nb of b){if(!nb)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Eb=r.Nca(nb);if(!Eb||!this.kc.ye(Eb,r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Eb,!!Eb&&this.kc.ye(Eb,r)),!1;const bc=this.kc.wH(Eb);if(2!==bc&&1!==bc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",bc),!1;const Bc=
this.kc.Cmc(Eb,r);let Yc=0;if(Bc){if(!this.kc.ye(Bc,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;Yc=this.kc.wH(Bc);if(2!==Yc&&1!==Yc)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",bc,Yc),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let zd=this.bQb(Eb,r);if(!zd)return!1;A++;ob&&(1===bc?(ra.add(nb),Ta.add(Eb.id)):(ba.add(nb),
Ia.add(Eb.id)));if(Bc){zd=this.bQb(Bc,r);if(!zd)return!1;A++;ob&&(1===Yc?(ra.add(this.kc.Je(Bc)),Ta.add(Bc.id)):(ba.add(this.kc.Je(Bc)),Ia.add(Bc.id)))}}Mz.a.Dpc();r=Wj.a.tRf(r);nb=new hb.GraphTransaction(15);nb.Eb(h);ob&&this.XHo(ba,ra,Ia,Ta,h);h.setValue(Tc.a.Hja,r);Cd.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));nb.NAe();nb.dispose();h=(new Date).getTime();ba=new Map;ba.set("Source","DeleteStyleAPI");ba.set("NumberOfStyles",b.count.toString());ba.set("TrueStyleCount",A.toString());
ba.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Sa.a,{extendedProperties:ba,durationMs:h-L});Ca.Health.instance.recordKpiSuccess(Up.a.iKe,b);return!0}XHo(b,h,r,A,L){if(b&&b.count||h&&h.count)if(L){var ba=(new Date).getTime();if(L=this.Wwm(L)){for(;L.moveNext();){if(!rd.ParagraphReader.Wh(L.iterator))continue;const ra=L.currentNode;this.FHo(ra,b,r);this.GHo(ra,h,A)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
r-ba));A=new Map;A.set("Source","DeleteStyleRemoveStylesReferences");A.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Sa.a,{extendedProperties:A,durationMs:r-ba});Ca.Health.instance.recordKpiSuccess(Up.a.iKe,b)}}else Cd.b(577520338,3018,50,"PageContentNode not provided.");else Cd.b(577520337,3018,50,"No style IDs provided")}FHo(b,h,r){if(h&&h.count&&b){var A=b.Hz;A&&A.hasProperty(Tc.a.uA)&&r.contains(A.getValue(Tc.a.uA))&&(A.removeProperty(Tc.a.uA),b.Hz=A,b.GC()&&this.lk.MR(b,
b.GC(),this.Yd.Zg));(r=this.kc.Lr(b))&&(r=this.kc.Je(r))&&h.contains(r)&&this.wYc(b,!0,!0)}}GHo(b,h,r){if(b&&b.ra&&b.ra.length&&h&&h.count)for(let ra=0;ra<b.ra.length;ra++){var A=b.ra.jc(ra);if(A&&A.formatting&&(A=A.formatting)&&A.Rb){var L=pb.a.Wua(A);L&&(L=this.kc.Je(L))&&h.contains(L)&&this.Qj.Srf(A);if(L=A.Rb.Dq){var ba=L.qp;ba&&(ba=ba.clone(),ba.hasProperty(Tc.a.wy)&&r.contains(ba.getValue(Tc.a.wy))&&this.RFo(b,ba,L,A));ba=ra===b.ra.length-1?b.characterData.length:b.ra.jc(ra+1).cp;this.lk.c2b(b,
A.Rb,A.Rb.cp,ba,L,A,this.Yd.Zg)}}}}RFo(b,h,r,A){b&&h&&r&&A&&(b=b.ed)&&(h.removeProperty(Tc.a.wy),h.cOa?h=b.mU(h,!0):b.Mv(h,null),r.ol=h.id,A.Rb.Dq=r)}Wwm(b){if(!b)return null;b=te.a.kb(b);return b.ku()?Xd.a.$u(b,b.origin):null}bQb(b,h){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.rj();return this.kc.i2(r)?h.dwg(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",IH.a[this.kc.wH(b)]),r.set("IsCustomStyle",this.kc.ye(b,h).toString()),
r.set("IsLinkedStyle",(!!this.kc.Cmc(b,h)).toString()),b=Object.assign(new Sa.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(Up.a.iKe,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}IEa(b,h,r,A,L){if(this.Dc&&this.Dc.isFeatureEnabled(74)){if(!b)return v.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=
Wj.a.Pp(),!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ra=this.c3.pna(r);if(!ra)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ra.Nca(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var ba=this.kc.wH(b);if(2!==ba&&1!==ba)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",ba),!1;Ca.Health.instance.recordKpiUsage(Up.a.ISg,
0,Up.a.GB,new Map([["Source","ModifyStyleAPI"]]));ba=Date.now();L=new hb.GraphTransaction(L?L:15);let Ia,Ta;try{L.Eb(r);if(!(A&&0!=A.length||h&&0!=h.count))return!1;if(A&&0!=A.length&&(Ia=Wj.a.C6c(b),!ra.zzf(b,A)))return this.sda("ModifyStyleAPI",b,ra,ba,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Bc=ra.lQg(b,h);Ta=Wj.a.C6c(b);if(!Bc)return this.sda("ModifyStyleAPI",b,ra,ba,"UnableToModifyStyle"),!1}this.rVn(b,r,Ta,Ia);Mz.a.Dpc();const ob=Wj.a.tRf(ra);r.setValue(Tc.a.Hja,ob);Cd.b(572302818,
3018,50,String.format("Style Object Ids - {0}",ob));const nb=Date.now(),Eb=new Map([["Source","ModifyStyleAPI"]]),bc=Object.assign(new Sa.a,{extendedProperties:Eb,durationMs:nb-ba});Ca.Health.instance.recordKpiSuccess(Up.a.ISg,bc);return!0}finally{L&&L.dispose()}}return!1}rVn(b,h,r,A){var L,ba;if(null!==b){var ra;A&&((ra=null===(L=this.om)||void 0===L?void 0:L.zwd(h,A,b,!0))||Cd.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((ra=null===(ba=this.om)||
void 0===ba?void 0:ba.zwd(h,r,b,!1))||Cd.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}sda(b,h,r,A,L){const ba=Date.now(),ra=!!this.kc.Cmc(h,r);b=new Map([["Source",b],["StyleType",IH.a[this.kc.wH(h)]],["IsCustomStyle",this.kc.ye(h,r).toString()],["IsLinkedStyle",ra.toString()]]);A=Object.assign(new Sa.a,{extendedProperties:b,durationMs:ba-A});Ca.Health.instance.recordKpiFailure(Up.a.ISg,L,!1,!0,A)}}Object(u.a)(Uy,"WACStyleEditor",null,[1474]);
class Vp extends Uy{constructor(b,h,r){super(b,r);this.Daa=h}get Bv(){return this.Daa.value}ZVd(b,h){this.Bv.ZVd(b,h)}}Object(u.a)(Vp,"WACStyleEditor",Uy,[]);class iD{ygb(b,h){b.properties.setValue(Rc.a.marginTop,h)}wgb(b,h){b.properties.setValue(Rc.a.marginBottom,h)}Hpa(b,h){b.properties.setValue(Rc.a.marginLeft,h)}xgb(b,h){b.properties.setValue(Rc.a.marginRight,h)}DDg(b,h){b.properties.setValue(Rc.a.pageWidth,h)}CDg(b,h){b.properties.setValue(Rc.a.pageHeight,h)}nUj(b,h){b.properties.setValue(Rc.a.B$i,
h)}X1b(b,h){b.properties.setValue(Me.a.columnCount,h)}XZo(b,h){b.properties.setValue(Me.a.uta,h)}Jzc(b,h){b.properties.setValue(Me.a.CI,h)}E5o(b,h){b.properties.setValue(Me.a.separator,h)}w2o(b,h){-1==h||0==h?(-1==h&&b.properties.removeProperty(Me.a.Vke),b.properties.removeProperty(Me.a.G7f)):b.properties.setValue(Me.a.G7f,h);-1==h||Ap.a.instance.mGi(b)||b.properties.setValue(Me.a.Vke,1)}}Object(u.a)(iD,"WordSectionEditor",null,[408]);class vB{get name(){return"WordEditor.OutlineLevelEditors"}Ec(b){b.ja("WordEditor.OutlineLevelEditors.WordSectionEditor",
()=>new iD).as("Box4.IWordSectionEditor").ha();y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ja("Box4.OutlineLevelEditors.PageContentEditor",()=>new Ty(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ja("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new dl(px.a.dbb,b.resolve("WordEditor.List.IFlatListReader"),b.zf("Box4.IOutlineElementEditor"),b.zf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ja("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new dl(px.a.dbb,b.resolve("WordEditor.List.IFlatListReader"),b.zf("Box4.IOutlineElementEditor"),b.zf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ja("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new iK).as("Box4.List.ICursorMovementValidator").ha(),b.ja("Box4.Styles.WACStyleReader",()=>new HH.a(new uu.a)).as("Box4.Styles.IWACStyleReader").ha(),
b.ja("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new Vp(b.resolve("Box4.List.IListReader"),b.zf("WordEditor.IFlatListEditor"),b.zf("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){F.a.instance.Rc(new vB)}}Object(u.a)(vB,"WordEditorOutlineLevelEditorsPackage",null,[0,1]);var wB=e(614),bt=e(213);class Hm{constructor(b,h){this.Vd=b;this.ni=h;this.eJa=null}L2o(b,h,r,A){sl.a.Ttn||({listId:h,listLevel:r}=nf.a.qOf(b,{Qta:0,SWa:-1}));if(0<h&&0<=r)this.eJa=
b;else{let L=1;const ba=b.listStyle;42!==ba&&0<ba&&(L=ba);this.eJa=Yr.a.LY(b.listType,L,null,h,r,void 0,"")}h=new aF.a;switch(b.S$){case 0:this.eJa.ZC=h.Yvf();break;case 2:this.eJa.ZC=h.tdi(h.k2h,h.j2h);break;case 1:this.eJa.ZC=h.Owf(h.Jgg,h.Kgg)}sl.a.$3i&&A&&(this.eJa=null)}c4o(b){b&&(this.eJa=b)}Nei(b){var h=$g.a.instance.vr(fb.a.uNl);Mb.a.ji(b)||(v.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),$g.a.instance.qc("PossiblyIncorrectListCreation",
{["Reason"]:uf.a.tQb}));nf.a.Wg(b)&&(v.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),$g.a.instance.qc("PossiblyIncorrectListCreation",{["Reason"]:uf.a.LFl}));const r=Mb.a.uN(b);r&&!r.hasProperty(Rc.a.hua)&&v.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");if(nf.a.Qe&&b.ic(4))return v.ULS.sendTraceTag(508412242,393,15,"PossiblyIncorrectListCreation - createList called when OE already has numberListNode"),
h=b.currentNode,b.Ac(),h;nf.a.Qe&&b.ic(31)&&b.qh();const A=this.yNl();b.pg(A,4);r&&(r.eG=A);h.end();return A}yNl(){return ou.a.instance.createInstance(on.a.peb)}aja(b){const h=$g.a.instance.vr(fb.a.aja);Mb.a.ji(b)||$g.a.instance.qc("PossiblyIncorrectListRemoval",{["Reason"]:uf.a.tQb});nf.a.Wg(b)&&(qh.a.getInstance().Gv?this.k$(b):this.EIj(b));h.end()}EIj(b){this.Vd.s2(b);b.qh()}Y4i(b){let h=!1;1===b.Cu&&b.Ova&&!b.MN&&(h=!0);const r=b.kf.ka(Rc.a.Qy,null);r&&r===Box4Intl.Box4Strings.L_ListStyleNone&&
(1===b.listType?h=b.Ova&&!b.MN:b.listType||(h=!b.listStyle));return h}Vsa(b,h,r,A=!1){const L=$g.a.instance.vr(fb.a.bdl);this.iVj(b,r,A);const ba=b.hasProperty(Pd.a.Clj);var ra=b.ka(Pd.a.Hge,!1);const Ia=this.Y4i(r);if(ra)Ia&&(r.iea(16,0),b.setValue(Pd.a.dE,16),b.setValue(Pd.a.z_a,0));else{ra=this.Vd.Fy(h);this.hGg(r,ra,ba,Ia)&&(L.properties.W("ToggledOff","true"),r.iea(16,0),this.O2o(b));if(!this.ute(b,h,r,A))return L.end(),v.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),
{returnValue:!1,Tna:r};!r.listType&&b.hasProperty(Pd.a.mOa)&&(r.zF=b.getValue(Pd.a.mOa),b.removeProperty(Pd.a.mOa))}if(ba&&(L.properties.W("MultipleOESelection","true"),this.iZj(h,r)))return L.end(),v.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,Tna:r};this.I9k(h,r,b,A);pv.dMj();b.hasProperty(Kh.a.AV)&&pv.QJl(b.getValue(Kh.a.AV),h,this.Vd);b.setValue(Pd.a.Hge,!0);L.end();return{returnValue:!0,Tna:r}}hGg(b,h,r,A){if(A)return!0;if(h){A=b.listType===
h.listType;const L=!b.listStyle&&b.zF===Gi.a.sl;let ba=b.listStyle===h.listStyle&&b.zF===h.zF;b=(!b.Ova||this.Yzg(h,b))&&!r;ba=ba&&b;return A&&(L||ba)}return!1}O2o(b){b.setValue(Pd.a.dE,16);b.setValue(Pd.a.z_a,0)}Yzg(){return!0}iVj(){}ute(){return!0}iZj(b,h){return h&&16!==h.listType&&Mb.a.isEmpty(b,!0)}rYc(b){const h=$g.a.instance.vr(fb.a.rYc);rd.ParagraphReader.lc(b)||$g.a.instance.qc("ClearingListFromNonParagraph",{["Reason"]:uf.a.LBf});const r=new te.a;r.set(b);r.Wd();r.Mu(12);hg.a.xe(r);this.k$(r);
h.end()}merge(b,h,r){const A=$g.a.instance.vr(fb.a.IHn);Mb.a.ji(h)||$g.a.instance.qc("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Mb.a.ji(b)||$g.a.instance.qc("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});nf.a.Wg(h)&&(A.properties.W("UseSourceListWithNonlistDestination",r.toString()),r&&nf.a.Wg(b)&&this.aja(b),nf.a.Wg(b)&&!r?this.SBj(h,b):r&&(r=this.uGi(h),1===r.Cu&&r.Brf(!0),this.fNb(b,r),A.properties.W("MoveListInfoFromSrcToDestOE","true")),this.aja(h),A.properties.W("RemoveListFromSrcOE",
"true"));A.end();return!0}SBj(){}uGi(b){return this.Vd.Fy(b)}A2c(b,h){h.hasProperty(Pd.a.dE)||(b===fb.a.FF?h.setValue(Pd.a.dE,1):(b===fb.a.KP||b===fb.a.tia)&&h.setValue(Pd.a.dE,0));h.hasProperty(Pd.a.z_a)||h.setValue(Pd.a.z_a,0);return h}Xfc(b,h,r,A,L,ba,ra,Ia){const Ta=$g.a.instance.vr(fb.a.Xfc),ob=this.Vd.Fy(h);r=Yr.a.LY(0,r,void 0,void 0,void 0,ra);r.zF=A;r.AV=ba;ob&&r.EVf(ob)&&r.zF===ob.Ez||(A=new hb.GraphTransaction(15),A.nw(h),Ia.$_n(r.listType,r.listStyle,r.zF,r.levelText,r.AV)&&(Hm.Ug.lf(L,
""),!nf.a.Qe&&rd.ParagraphReader.lc(b)&&bt.a.ooa(b)&&(h=this.Vd.pha(b))&&Hm.Ug.E7l(b,h)),A.dispose());Ta.end()}zwd(b,h,r,A=!1){if(null===r||null===b||null===h)return!1;b=this.Vd.XA(b,h.listId,h.listLevel);if(!b)return v.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(A){if(b.hasProperty(Tc.a.uA)){b.getValue(Tc.a.uA)instanceof V.a||v.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");if(!V.a.Kx(b.getValue(Tc.a.uA),
r.id))return v.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(Tc.a.uA);return!0}}else{r=r.id;r instanceof V.a||v.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(Tc.a.uA))return v.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(Tc.a.uA,r);return!0}return!1}static get elc(){return null!=
Hm.T_g?Hm.T_g:Hm.T_g=Xa.a.instance.Wa("Box4.IFontSlotProvider")}static get Ug(){return null!=Hm.tXg?Hm.tXg:Hm.tXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get du(){return qh.a.getInstance()}}Object(u.a)(Hm,"ListEditor",null,[655]);var Ut=e(826),Ks=e(338);class vu{constructor(b,h,r,A,L,ba){this.zg=L;this._pageContent=r;this.PIb=Array(vu.nK);this.ddc=Array(vu.nK);this.qLh=Array(vu.nK);this.I9e=Array(vu.nK);this.BHh=Array(vu.nK);this.nba=A;this.lUc=ba;for(A=0;A<vu.nK;A++){var ra=
this.B6c(b,A,r,L);ra?(ba=ra.ka(Sb.a.uW,Gi.a.sl),ra=ra.ka(Rc.a.e1b,Gi.a.sl)):ra=ba=Gi.a.sl;this.ddc[A]=ba!==Gi.a.sl?ba:Gi.a.d$a;this.I9e[A]=ra===Gi.a.sl?A-1:ra-1;vu.pda(h)&&(this.qLh[A]=Gi.a.sl,this.BHh[A]=Gi.a.sl);this.PIb[A]=this.ddc[A]}}B6c(b,h,r,A){A.J8(r);return qh.a.getInstance().Jad&&this.lUc?this.zg.BOf(b,h,this.nba,r):this.zg.E6c(b,h,r.ed,r)}restart(b){this.PIb[b]=this.ddc[b]}zoe(b){for(var h=0;h<b;h++)this.PIb[h]===this.ddc[h]&&this.PIb[h]++;for(h=b+1;h<vu.nK;h++)this.I9e[h]>=b&&this.restart(h);
return this.PIb[b]++}static pda(b){return!!b&&b.isFeatureEnabled(64)}}vu.nK=9;Object(u.a)(vu,"AWordList",null,[1617]);class kK{constructor(b,h,r,A){this.Klb=new Zf.ScriptSharpLegacyMap;this.zg=b;this.DO=h;this.nba=r;this.lUc=A}Fy(b,h){this.Klb.Bb(b)||this.Klb.W(b,new vu(b,h,this.DO,this.nba,this.zg,this.lUc));return this.Klb.K(b)}Guc(b,h,r){return this.Fy(b,r).zoe(h)}}Object(u.a)(kK,"AListNumberingMap",null,[1616]);class kw extends vu{constructor(b,h,r,A,L,ba){super(b,h,r,A,L,ba)}wPf(b,h,r,A){A.J8(r);
return qh.a.getInstance().Jad&&this.lUc?this.zg.yFm(b,h,this.nba):this.zg.xFm(b,h,this._pageContent.ed)}pwd(b,h,r){var A=this.wPf(b,h,this._pageContent,this.zg);A?(b=A.ka(Sb.a.uW,Gi.a.d$a),A=A.ka(Rc.a.e1b,Gi.a.sl),this.PIb[h]=this.qLh[h]=this.ddc[h]=b,A!==Gi.a.sl&&(this.BHh[h]=this.I9e[h]=A-1)):r&&(A=this.B6c(b,h,this._pageContent,this.zg),b=Gi.a.d$a,A&&(b=A.ka(Sb.a.uW,Gi.a.d$a)),this.PIb[h]=this.ddc[h]=b)}}Object(u.a)(kw,"WordList",vu,[]);class xB extends kK{constructor(b){super(b.Vd,b.Kh,b.oE,b.$ek);
this.RFh=new Cb.a}rOf(b,h,r){let A;qh.a.getInstance().h2?{value:A}=this.zg.EH.Nc(b,A):{value:A}=this.zg.u5.Nc(b,A);this.Klb.Bb(A)||this.Klb.W(A,new kw(b,r,this.DO,this.nba,this.zg,this.lUc));if(!this.RFh.contains(b))for(this.RFh.add(b);h<Gi.a.nK;h++)this.Klb.K(A).pwd(b,h,!1);else if(!h)for(h+=1;h<Gi.a.nK;h++)this.Klb.K(A).pwd(b,h,!0);return this.Klb.K(A)}Guc(b,h,r){return vu.pda(r)?this.rOf(b,h,r).zoe(h):super.Guc(b,h,r)}}Object(u.a)(xB,"ListNumberingMap",kK,[]);class lK{constructor(){this.eyb=0;
this.Vgk=!1}}Object(u.a)(lK,"LastNumber",null,[]);var JH=e(392);class dp{constructor(b,h,r,A){this.qhd=!1;this.Bv=b;this.R3i=r;this.uVb=A;this.Mw=this.Bv.mG(h);this.gU=new te.a;this.gU.Ad(h)}static get Vd(){return dp.zg||(dp.zg=Xa.a.instance.resolve("Box4.List.IListReader"))}static set Vd(b){dp.zg=b}static get du(){return qh.a.getInstance()}static uem(b,h,r,A=!1,L=!1){var ba=h.currentNode;let ra=null,Ia=!1,Ta=!1;h=h.bDb();const ob=Xd.a.Mp(h);ob.moveNext();for(h=ob.iterator;h.currentNode!==ba;){let Eb=
Ta=Ia=!1;var nb=dp.Omi(h);if(Mb.a.ji(h)&&!nb){nb=!1;if(h.dw(4))if(dp.Nnj(h,r,!0,A,L)){if(Eb=!0,ra=new dp(b,h,!1,!1),ob.moveNext(),ob.iterator===ba&&(Ia=!0),A)break}else Mb.a.isEmpty(h,!1)||(nb=!0),Ta=!0;else!Mb.a.isEmpty(h,!1)&&h.Dbb(12)&&(Mb.a.LV(h)||(nb=!0));!A&&nb&&ra&&(r.kf.hasProperty(Rc.a.listLevel)?ra.Mw.level=0:ra=null)}Eb||ob.moveNext();h=ob.iterator}ra&&(ra.uVb=Ia);if(!ra&&h.gg(1))for(ba=!0;h.currentNode;){if(Mb.a.ji(h)){if(h.dw(4)&&dp.Nnj(h,r,!1,A,L)){ra=new dp(b,h,!0,ba);break}if(!Mb.a.isEmpty(h,
!1))break}if(!h.gg(1))break;ba=!1}ra&&(ra.qhd=Ta);return ra}static wem(b,h){const r=h.currentNode;let A=null,L=!1,ba=!1;h=h.bDb();h=Xd.a.Mp(h);h.moveNext();let ra=h.iterator,Ia=!1;for(;ra.currentNode!==r;){let Ta=ba=L=!1;const ob=dp.Omi(ra);Mb.a.ji(ra)&&!ob&&(ra.dw(4)?(Ta=!0,Ia=!1,A=new dp(b,ra,!1,!1),h.moveNext(),h.iterator===r&&(L=!0)):Mb.a.isEmpty(ra,!1)?(Ia&&(A=null),Ia=!0):(A=null,Ia=!1));Ta||h.moveNext();ra=h.iterator}A&&(A.uVb=L,A.qhd=ba);return A}static Omi(b){var h=b.ic(2);if(!h)return!1;
h=rd.ParagraphReader.Wh(b)&&dp.dwn(h);b.Ac();return h}static dwn(b){return kp.a(b,8)}static Nnj(b,h,r,A=!1,L=!1){if(!nf.a.Wg(b)&&(v.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),nf.a.Qe))return!1;if(nf.a.Qe)var ba=nf.a.a9(b);else dp.Vd.s2(b),ba=b.currentNode,b.Ac();const ra=dp.Vd.P4(ba);(b=h.NB===ra.NB)&&h.listStyle&&1!==h.Cu&&(b=h.listStyle===ra.listStyle);b&&(h.Ova&&1!==h.Cu||h.ulc||L)&&(b=dp.Ltn(h,ra),h.NB||(b=b&&h.font===ra.font));if(1===h.Cu)if(1===ra.Cu&&
ra.kf.hasProperty(Kh.a.lxb))b=h.S$===ra.S$;else return!1;b&&h.NB&&h.zF!==Gi.a.sl&&(b=ra.Ez,r&&(A&&1===h.zF&&1===b||b++),b=h.zF===b);b&&(A||h.ulc)&&(h=nf.a.qOf(h,{Qta:0}).listId,ba=nf.a.ut(ba,{Qta:0}).listId,0<h&&0<ba&&(b=h===ba));return b}static Ltn(b,h){h=h.fbj;b.Ova&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.fbj.toLocaleLowerCase()}static vem(b,h,r){var A=h.currentNode;let L=null;const ba=new te.a,ra=b.lDa(A,r);var Ia=!1;let Ta=!1;ba.Ad(h);ba.Ac();for(ba.ic(1);ba.currentNode!==
A;)Ta=Ia=!1,Mb.a.ji(ba)&&ba.dw(4)&&(h=b.mG(ba),dp.Onj(h,r,!0)?(L=new dp(b,ba,!1,!1),Ia=!0):(Ta=!0,h.listID===r.listID&&h.level<=ra.Mfb&&(L=null))),ba.gg(1);L&&(L.uVb=Ia);if(!L&&ba.gg(1))for(A=!0;ba.currentNode;){if(Mb.a.ji(ba)&&ba.dw(4)){Ia=b.mG(ba);if(Ia.listID===r.listID&&Ia.level<=ra.Mfb)break;if(dp.Onj(Ia,r,!1)){L=new dp(b,ba,!0,A);break}}if(!ba.gg(1))break;A=!1}L&&(L.qhd=Ta);return L}static Onj(b,h,r){let A=b.listID===h.listID&&b.level===h.level;A&&h.Ez!==Gi.a.sl&&(b=b.Ez,r&&b++,A=h.Ez===b);
return A}}dp.zg=null;Object(u.a)(dp,"JoinTargetInfo",null,[]);class mr{constructor(b,h){this.Mw=null;this.action=b;h&&(this.Mw=h)}static ceb(){return new mr(0)}static X7f(){return new mr(1)}static jHn(b){return new mr(3,b)}static AHn(b){return new mr(2,b)}static mHn(b){return new mr(4,b)}}Object(u.a)(mr,"ApplyListInfoResult",null,[]);class KH{constructor(){this.startAt=this.Mfb=0}}Object(u.a)(KH,"WordListRestartInfo",null,[]);var iF=e(920);class yB{constructor(b,h,r){this.Etd=r;this.wjd=h.listID}}
Object(u.a)(yB,"ListTransferInfo",null,[]);class Er extends Hm{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){super(b,r,Ta);this.kK=bc;this.TKh=!1;this.IIc=this.VCd=this.w8b=null;this.CDe=(Bc,Yc)=>Yc.listID===Bc.listID&&Yc.level===Bc.level;this.Cgp=(Bc,Yc,zd)=>Yc.listID!==Bc.listID&&Yc.listID!==zd.wjd||Yc.level!==Bc.level?!1:!0;this.FRn=(Bc,Yc,zd)=>Yc.listID===Bc.listID||zd&&Yc.listID===zd.wjd?!0:!1;this.m0j=(Bc,Yc,zd,Jd)=>{qh.a.yu||this.l0j(Bc,Yc,zd,Jd)};this.l0j=(Bc,Yc,zd,Jd)=>{if(!qh.a.yu){if(nf.a.Qe){const {listId:ie}=
nf.a.ut(Yc);ie!==zd&&v.ULS.sendTraceTag(508347426,393,15,`siblingRenumberAndUpdateSublists: existingListId:${ie} newListId:${zd}`)}qh.a.getInstance().xu||this.kK.WCb(Bc,zd);Yc=nf.a.Qe?Yc:Bc;Bc=this.Fmc(Yc);Yc=te.a.kb(Yc);Yc.Wd();Yc.Ac();this.Nim(Yc,Bc,this.FRn,this.Zmp,Jd)}};this.Egp=(Bc,Yc,zd,Jd)=>{if(!qh.a.yu){var {Mw:ie,iterator:re}=this.ujc(Yc,()=>{if(nf.a.Qe){var {listId:me}=nf.a.ut(Yc);me!==zd&&v.ULS.sendTraceTag(508347424,393,15,`siblingRenumberAndUpdateListID: existingListId:${me} newListId:${zd}`)}qh.a.getInstance().xu||
this.kK.WCb(Bc,zd);qh.a.getInstance().Gv&&this.kK.WCb(Yc,zd);var Sd=nf.a.Qe?Yc:Bc;me=this.Fmc(Sd);Sd=te.a.kb(Sd);Sd.Wd();Sd.Ac();return{Mw:me,iterator:Sd}});this.C7d(re,ie,this.M3j,this.MEe,Jd)}};this.Xmp=(Bc,Yc,zd,Jd)=>{qh.a.yu||this.sEj(Bc,Yc,zd,Jd)};this.MEe=(Bc,Yc,zd,Jd)=>{zd.listID=Yc.listID;Jd.ic(4);const ie=this.su.pYa(Jd.currentNode);this.ujc(ie,()=>{this.kWc(Jd.currentNode,zd,ie);Jd.Ac()})};this.Zmp=(Bc,Yc,zd,Jd)=>{!qh.a.yu&&nf.a.Wg(Jd)&&(Bc=new te.a,Bc.Ad(Jd),Bc.Wd(),this.Vd.s2(Bc),this.Rjn(Jd.currentNode,
Bc.currentNode))};this.Ymp=(Bc,Yc,zd,Jd)=>{zd.listID=Yc.listID;this.sEj(Bc,Yc,zd,Jd);this.MEe(Bc,Yc,zd,Jd)};this.L3j=(Bc,Yc)=>Yc.listID===Bc.listID;this.Wmp=(Bc,Yc)=>Yc.level<=Bc.level;this.M3j=(Bc,Yc,zd)=>Yc.listID===zd.wjd;this.Vq=L;this.Aza=b;this.UGd=h;this.Zc=A;this.Fng={};this.PJk=ba;this.me=ra;this.lr=Ia;this.Qd=ob;this.Vk=nb;this.Gr=Eb}get pda(){return this.Aza.noa}get Vgb(){return this.TKh}set Vgb(b){this.TKh=b}get su(){return this.Aza}get Q2(){return this.Gr}get kc(){return this.Vk}get Bu(){return this.su.Bu}get hs(){return this.su.hs}get $Aa(){return this.su.$Aa}get nda(){return this.su.nda}set nda(b){this.su.nda=
b}get s_a(){return this.su.s_a}set s_a(b){this.su.s_a=b}get ftd(){return null!=this.b9g?this.b9g:this.b9g=Xa.a.instance.Wa("Box4.List.ISingleLevelListEditor")}I9k(b,h,r,A){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const L=r.ka(Pd.a.Hge,!1);let ba=!1,ra=-1;!L||h.listStyle&&1!==h.Cu||(ba=!r.ka(Pd.a.U5f,!1),ra=r.ka(Pd.a.A7f,-1));b=this.fNb(b,h,{dWi:ba,FGn:ra,zsb:A,kf:r});L||r.setValue(Pd.a.U5f,2===b.action);3===b.action&&!r.hasProperty(Pd.a.A7f)&&b.Mw&&r.setValue(Pd.a.A7f,
b.Mw.level)}merge(b,h,r,A=null){const L=nf.a.Wg(b)||nf.a.Wg(h);b=super.merge(b,h,r,A);L&&this.X2();return b}SBj(b,h){this.Ssl(b,h)}Ssl(b,h){b=nf.a.Qe?nf.a.wna(b,{SWa:-1}).listLevel:this.Vd.uOf(b);const r=nf.a.Qe?nf.a.wna(h,{SWa:-1}).listLevel:this.Vd.uOf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.UGd.value.H0c(h,b):0>b&&this.UGd.value.Z0a(h,b,0))}EIj(b){this.Vd.s2(b);b.qh();this.X2()}tNg(b,h,r,A){var L=te.a.kb(r);L=this.mG(L);const ba=this.g2b(b,L,!qh.a.getInstance().Gv);if(!qh.a.yu){b=this.su.Wab(b.currentNode,
L);b.listType||(ba.setValue(Hm.du.Gqa,L.Ez),ba.setValue(Hm.du.nHa,L.A1c),this.FKj(ba,L,h?r:A));switch(b.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}y.AFrameworkApplication.va.Vb(fb.a.T5f,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);qh.a.getInstance().xu||this.kK.f2b(ba,L.listID,L.level)}}mG(b){if(!nf.a.Wg(b)&&(v.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),nf.a.Qe))return null;let h;
nf.a.Qe?h=nf.a.a9(b):(this.Vd.s2(b),h=b.currentNode,b.Ac());return this.Fmc(h)}m3o(b,h){this.Vd.s2(b);const r=b.currentNode;b.Ac();qh.a.getInstance().xu||this.kK.WCb(r,h);b=Mb.a.uN(b);qh.a.getInstance().Gv&&this.kK.WCb(b,h);this.Fmc(nf.a.Qe?b:r)}Fmc(b){var h;const r=new Ut.a;nf.a.Qe&&(b&&rd.ParagraphReader.lc(b)||v.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=nf.a.Qe?
nf.a.ut(b)||nf.a.Cna(b):this.Vd.B1(b,!1,!0);r.listID=h.listId;r.level=h.listLevel;r.k2=nf.a.ide(b);h=this.L$d(b);r.R0o(h);r.Ez=nf.a.lce(b);r.A1c=nf.a.cTf(b);return r}g2b(b,h,r=!1){const A=Mb.a.uN(b);b=qh.a.getInstance().xu?null:this.Nei(b);this.kWc(b,h,A,r);return b}kWc(b,h,r=null,A=!1){qh.a.getInstance().xu||b||$g.a.instance.qc("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!qh.a.getInstance().Gv||A||r||Cd.b(509364259,393,15,"Apply list ref info called without para node");h||$g.a.instance.qc("CrashWhenApplyingList",
{["Reason"]:"RefInfoIsNull"});qh.a.getInstance();qh.a.getInstance().Gv&&r&&(qh.a.Hv?!h.k2:!A)&&this.kK.f2b(r,h.listID,h.level);qh.a.getInstance().fda&&(r=r||this.Vd.pYa(b),this.kK.kIo(r));qh.a.getInstance().xu||(this.kK.f2b(b,h.listID,h.level),h.k2&&b.setValue(Rc.a.k2,!0),qh.a.getInstance().Gv||null==h.levelText||b.setValue(Rc.a.Qy,h.levelText))}Rck(b){this.su.J8(b);b=Object(ao.a)().kw(b);let h=b.ka(Rc.a.hs,null);h=h?Array.clone(h):[];b.setValue(Rc.a.hs,h);this.su.Cpc()}Imp(b){switch(b){case 0:return 0;
case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}jFm(b){b=b.view;if(!b.ub||!b.ub.ob)return null;b=Rh.OutlineElementGeneralizer.lna(b.ub.ob,!1);if(1!==b.length)return null;b=te.a.kb(b.getContext(0).node);if(!nf.a.Wg(b))if(14===b.ue().type){const h=nf.a.pDi(b.currentNode);h&&b.set(h)}else Cd.b(589177753,393,15,"Encountered an OE of non list type."),b.Ac();b.Wd();return b}hOl(b,h,r,A){const L=b.bK(),ba=new Ut.a;ba.listID=this.j1d(b);this.pda?(ba.$ke=Hm.du.h2?
this.efi(b):this.Wei(b),this.oFj(b,ba.listID,ba.$ke)):this.qFj(b,ba.listID);ba.wUj(h.kf,this.Bed(r));this.P4d(b);r=this.rGi(b,h);for(let Ia=0;9>Ia;Ia++){const Ta=new Wr.a;L.Hd.Mv(Ta);this.pFj(b,this.pda?V.a.nil:Ta.id,this.pda?Ta.id:V.a.nil);this.m1k(Ta,h.NB,Ia);this.kTh(Ta,r,Ia);var ra=A.BXb[Ia];ra=6===ra?Yr.a.LY(1,1):Yr.a.LY(0,ra);ra.Boa&&Ta.setValue(Sb.a.O9,ra.Boa);h.zF!==Gi.a.sl&&Ia===ba.level&&Ta.setValue(Sb.a.uW,h.zF);A.pMa&&A.pMa[Ia]&&Ta.setValue(Sb.a.font,A.pMa[Ia]);ra=A.Ded[Ia];v.ULS.shipAssertTag(22127636,
338,!!ra);Ta.setValue(Rc.a.Qy,ra);Ta.setValue(Rc.a.oia,A.ike[Ia]);Ks.a.$Be(A.S$,Ta)}return ba}fOl(b,h,r){const A=b.bK(),L=new Ut.a;L.listID=this.j1d(b);this.pda?(L.$ke=Hm.du.h2?this.efi(b):this.Wei(b),this.oFj(b,L.listID,L.$ke)):this.qFj(b,L.listID);L.wUj(h.kf,this.Bed(r));if(!h.listStyle)switch(L.level%3){case 0:h.iea(h.listType,1);break;case 1:h.iea(h.listType,2);break;case 2:h.iea(h.listType,3)}this.P4d(b);r=this.rGi(b,h);for(let ba=0;9>ba;ba++){const ra=new Wr.a;A.Hd.Mv(ra);this.pFj(b,this.pda?
V.a.nil:ra.id,this.pda?ra.id:V.a.nil);this.l1k(ra,h.NB,ba);this.kTh(ra,r,ba);2===ba%3&&h.NB?ra.setValue(Rc.a.oia,"right"):ra.setValue(Rc.a.oia,"left");ba===L.level&&(h.Boa&&ra.setValue(Sb.a.O9,h.Boa),h.zF!==Gi.a.sl&&ra.setValue(Sb.a.uW,h.zF),h.NB?this.AUj(h,ra,ba):(Er.xUj(h,ra),Er.zUj(h,ra)),Er.yUj(h,ra),h.ulc&&ra.aCa(h.kf,Rc.a.listID,Rc.a.listLevel))}return L}AUj(b,h,r){b.Ova?(b=b.levelText,b=D.a.replaceAll(b,"%1","%"+(r+1))):b=b.tad||b.CDa?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,
338,!!b);h.setValue(Rc.a.Qy,b)}hGg(b,h,r,A){if(b.tad)return!1;if(1===b.Cu)return A;if(A)return!0;if(h){A=b.listType===h.listType;const L=!b.listStyle&&b.zF===Gi.a.sl;let ba=b.listStyle===h.listStyle&&b.zF===h.zF;b=(!b.Ova||this.Yzg(h,b))&&!r;ba=ba&&b;return A&&(L||ba)}return!1}P4d(b){this.w8b||(this.w8b=b.ka(Rc.a.LUl,null));this.VCd||(this.VCd=b.ka(Rc.a.KUl,null));this.IIc||(this.IIc=b.ka(Rc.a.MUl,null))}Bed(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}YEi(b){return b?this.Vq.cZ(b).ww-
this.Vq.cK(b).ww:-1}qFj(b,h){const r=b.ka(Rc.a.Bu,null),A=r?r.length:0,L=Array(A+1);let ba=0;for(;ba<A;ba++)L[ba]=r[ba];L[ba]=h;b.setValue(Rc.a.Bu,L);this.su.Cpc()}oFj(b,h,r){this.dif(Rc.a.Bu,b,h);if(Hm.du.h2){this.dif(Me.a.c0a,b,r);var A=this.su.J$d(b);A.add(h,r);b.setValue(Me.a.EH,JH.d(wB.a.QCc(A)))}else this.dif(Rc.a.$Aa,b,r),A=this.su.I$d(b),A.add(h,r),b.setValue(Rc.a.u5,JH.d(wB.a.QCc(A)))}pFj(b,h,r){this.pda?(this.bTh(Rc.a.hs,b,r),this.bTh(Rc.a.a$,b,h)):(r=(r=b.ka(Rc.a.hs,null))?Array.clone(r):
[],r.push(h),b.setValue(Rc.a.hs,r),this.su.Cpc())}dif(b,h,r){const A=h.ka(b,null),L=A?A.length:0,ba=Array(L+1);let ra=0;for(;ra<L;ra++)ba[ra]=A[ra];ba[ra]=r;h.setValue(b,ba)}bTh(b,h,r){let A=h.ka(b,null);A=A?Array.clone(A):[];A.push(r);h.setValue(b,A)}l1k(b,h,r){var A=r%3+1;const L=h?this.IIc:this.VCd;L&&r<L.length?b.setValue(Rc.a.lv,L[r]):b.setValue(Rc.a.lv,360);A=Yr.a.LY(h?0:1,this.Imp(A),null,0,r);b.Yu(A.kf);b.setValue(Rc.a.rnf,h?-1:-2);h?b.setValue(Rc.a.Qy,"%"+(r+1)+"."):(b.setValue(Sb.a.font,
this.bwm(r)),b.setValue(Rc.a.Qy,String.fromCharCode(this.Tvm(r))));Ks.a.Rzc(2,b)}m1k(b,h,r){const A=h?this.IIc:this.VCd;A&&r<A.length?b.setValue(Rc.a.lv,A[r]):b.setValue(Rc.a.lv,360);b.setValue(Rc.a.rnf,h?-1:-2);Ks.a.Rzc(1,b)}Tvm(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}bwm(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}j1d(b){if(this.pda)this.nda<Gi.a.Med&&this.su.J8(b),this.nda=
this.AHi(this.Bu,this.nda,Gi.a.Med);else{if(this.nda<Gi.a.Med&&(this.su.J8(b),this.Bu&&this.hs)){b=this.Bu.length;for(let h=0;h<b;h++)this.Bu[h]>=this.nda&&(this.nda=this.Bu[h])}this.nda+=1}return this.nda}Wei(b){this.s_a<Gi.a.BTd&&this.su.J8(b);return this.s_a=this.AHi(this.$Aa,this.s_a,Gi.a.BTd)}efi(b){var h;this.su.J8(b);do b=Math.floor(Math.random()*(Er.jSn-Er.Jjj))+Er.Jjj;while(null===(h=this.su.RYb)||void 0===h?0:h.includes(b));return b}AHi(b,h,r){if(h<r&&b){r=b.length;for(let A=0;A<r;A++)b[A]>
h&&(h=b[A])}h++;return h}dLo(b,h){qh.a.yu||this.Lvi(b,h,this.CDe,this.m0j,null,!1)}cLo(b,h){qh.a.yu||this.Oim(b,h,this.CDe,this.l0j)}Bhl(){qh.a.yu||this.X2()}X2(b=null){var h,r;if(!qh.a.yu){var A=new te.a;if(b)if(8===b.type)A.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else A.set(Db.StaticActiveAppFrame.Aa().tb.rd),Object(ao.a)().ZNg(A),b=Object(ao.a)().kw(A.currentNode);if(A.Ib(7)||A.xd(7)){A=Xd.a.$u(A,A.origin);
var L=new xB({Vd:this.su,Kh:b,oE:null,$ek:!1});for(b=new xB({Vd:this.su,Kh:b,oE:null,$ek:!1});A.moveNext();){var ba=A.iterator;let Ia;if(!qh.a.getInstance().xu){if(!ba.dw(4)&&!ba.dw(31))continue;this.Vd.xYb(ba);Ia=ba.currentNode;ba.Ac();if(!Ia){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ba.isValid);continue}}const Ta=nf.a.Qe?nf.a.$$d(ba):Ia;if(!this.pda&&!nf.a.A2f(Ta)&&this.Vd.P4(Ta).listType)continue;var ra=void 0;if(nf.a.Qe){if(!Ta){v.ULS.sendTraceTag(509141473,
393,50,"Skipping updating list numbers because paraNode not found");continue}ra=nf.a.ut(Ta)}else ra=this.Vd.B1(Ia,!1,!1);if(this.pda&&ra&&this.Vd.Yhe(ra.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ra.listId);continue}const ob=nf.a.Qe?Ta:Mb.a.uN(ba);ob&&(ob.ra?(null==ob.ra.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.pda&&this.su.J8(ba.currentNode),12===ob.type&&(ob.Ej&&ob.Hz.hasProperty(Rc.a.listID)||
null===(h=ob.ra.last)||void 0===h||!h.Dj)&&((ba=nf.a.Qe?ob.Ej?nf.a.Cna(Ta):nf.a.ut(Ta):this.Vd.B1(Ia,!0,!0))?this.CUj(Ia,Ta,b,Hm.du.Syd,ba):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ia.type)),!ra||null!==(r=ob.ra.last)&&void 0!==r&&r.Gi||!this.CUj(Ia,Ta,L,Hm.du.Gqa,ra)||(ra=Ia.getValue(Hm.du.Gqa),this.pda&&this.Vd.P4(Ta).listType||Ia.setValue(Hm.du.nHa,ra))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,
376,7===A.Jf,"Couldnt reach to page manifest node")}}CUj(b,h,r,A,L){if(!qh.a.yu)return A||v.ULS.shipAssertTag(571757918,393,!!A,"Prop definition is null"),r=r.Guc(L.listId,L.listLevel,this.Qd),L=-1,b.hasProperty(A)&&(L=b.getValue(A)),r===L||this.pda&&!nf.a.A2f(h)&&this.Vd.P4(h).listType&&(A!==Hm.du.Syd||1!==this.Vd.P4(h).listType)?!1:(b.setValue(A,r),!0)}wsn(b,h){if(!qh.a.yu){var r=!1,A=!0,L=0,ba=this.mG(b),ra=b.currentNode;b=b.bDb();b=Xd.a.Mp(b);for(b.Oq(iF.a.ile,null);b.moveNext();){var Ia=b.iterator.currentNode;
if(Ia===ra)break;nf.a.Wg(Ia)&&(Ia=this.mG(b.iterator),Ia.listID===ba.listID&&(Ia.level>ba.level?(r=!0,L++):Ia.level===ba.level?(A=!1,L=0):Ia.level<=h.Mfb&&(A=!0,L=0)))}return r&&A&&!0}}dul(b){if(!qh.a.yu){this.Vd.s2(b);var h=b.currentNode;b.Ac();var r=this.mG(b);r&&this.su.cle(h,r.listID,r.level)&&this.cLo(b.currentNode,r)}}uGi(b){var h;const r=this.Vd.Fy(b);r.ulc=!0;nf.a.Qe?(b=nf.a.wna(b),r.kf.setValue(Rc.a.listID,null!==(h=null===b||void 0===b?void 0:b.listId)&&void 0!==h?h:0)):(this.Vd.s2(b),h=
b.currentNode.ka(Rc.a.listID,0),r.kf.setValue(Rc.a.listID,h),b.xd(11));return r}E6f(b,h,r){if(!qh.a.yu){var A=new te.a,L=h.currentNode,ba=Gi.a.sl,ra=!1,Ia=!1,Ta=!1,ob=null,nb=h.bDb();nb=Xd.a.Mp(nb);for(nb.Oq(iF.a.ile,null);nb.moveNext();){A.Ad(nb.iterator);if(A.currentNode===L)break;ra=!1;if(nf.a.Wg(A)){var Eb=this.mG(A);Eb.listID===b.listID&&(Eb.level===b.level?(this.Vd.s2(A),ba=A.currentNode,A.Ac(),ba=ba.ka(Hm.du.Gqa,Gi.a.sl),ra=!0,ob=A.VDc(1),Ia=!0):Eb.level>b.level?Ta=!0:Eb.level<=r.Mfb&&(ba=
Gi.a.sl,Ta=Ia=!1))}}!Ia&&Ta&&(ba=r.startAt);ra&&(ra=h.VDc(1)===ob);b=new lK;b.eyb=ba;b.Vgk=ra;return b}}SFp(b,h){var r=nf.a.a9(b);b=this.Fmc(r);const A=new te.a;A.set(r);if(A.Wd()&&(r=A.Pfb())){r=Xd.a.Mp(r);for(r.Oq(iF.a.ile,b);r.moveNext();)nf.a.Wg(r.iterator.currentNode)&&this.mG(r.iterator).listID===h&&this.m3o(r.iterator,b.listID);v.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Rjn(b,h){qh.a.yu||(v.ULS.shipAssertTag(22819227,338,!!b&&!!h),h.setValue(Kg.a.R7f,
V.a.create().toString()))}lDa(b,h){const r=$g.a.instance.vr(fb.a.lDa),A=new KH;(b=this.su.XA(b,h.listID,h.level))?(A.Mfb=b.ka(Rc.a.e1b,h.level-1),A.startAt=b.ka(Sb.a.uW,1)):$g.a.instance.qc("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return A}qQl(b){const h=ou.a.instance.createInstance(on.a.csd);b.pg(h,31)}NHo(b){b.ic(31)&&b.qh()}yIj(b){var h=this.kc.Lr(b);h?this.kc.Je(h)===Hg.a.wordStyleIdListParagraph&&(h=this.kc.pG(b),this.Q2.IP(h.Qg(Hg.a.wordStyleIdNormal),b,!0,
!1,!1,this.Vgb)):v.ULS.shipAssertTag(8271188,315,!1)}EUj(b){if(this.kc.Je(this.kc.Lr(b))===Hg.a.wordStyleIdNormal){const h=this.kc.pG(b);this.Q2.IP(h.Qg(Hg.a.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.fg(Rc.a.ve,Rc.a.IW,Rc.a.vF,Rc.a.d$,Rc.a.lv,Rc.a.Fwa);b.setValue(Rc.a.D0a,0)}gul(b,h){var r=nf.a.ut(b);if(!r)return null;const A=r.listId;r=r.listLevel;for(let ba=0;9>ba;ba++){const ra=this.su.XA(b,A,ba);if(!ra)return $g.a.instance.qc("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),
null;var L=h.BXb[ba];L=6===L?Yr.a.LY(1,1):Yr.a.LY(0,L);L.Boa&&ra.setValue(Sb.a.O9,L.Boa);ra.hasProperty(Sb.a.font)&&ra.removeProperty(Sb.a.font);h.pMa&&h.pMa[ba]&&ra.setValue(Sb.a.font,h.pMa[ba]);L=h.Ded[ba];v.ULS.shipAssertTag(22127641,338,!!L);ra.setValue(Rc.a.Qy,L);ra.setValue(Rc.a.Cu,Ks.a.zuc);Ks.a.$Be(h.S$,ra);ra.setValue(Rc.a.oia,h.ike[ba]);ra.fg(Rc.a.e1b,Sb.a.uW);this.Rck(b)}b=new Ut.a;b.listID=A;b.level=r;return b}cul(b,h,r,A){if(A)return this.gul(b,A);var L=nf.a.ut(b);if(!L)return null;A=
L.listId;L=L.listLevel;const ba=this.su.XA(b,A,L);if(!ba)return $g.a.instance.qc("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,A,L),null;h.ulc&&(ba instanceof jv.a?ba.aCa(h.kf,Rc.a.listID,Rc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ba||void 0===ba?void 0:
ba.constructor.name));var ra=ba.ka(Rc.a.Cu,null);ra&&ra===Ks.a.zuc&&this.bul(b,A);if(!h.listStyle){ra=0;if(-1!==r){for(ra+=L-r;0>ra;)ra+=3;ra%=3}switch(ra){default:r=1;break;case 1:r=2;break;case 2:r=3}h.iea(h.listType,r)}h.Boa&&ba.setValue(Sb.a.O9,h.Boa);h.NB?(this.AUj(h,ba,L),ba.hasProperty(Sb.a.font)&&ba.removeProperty(Sb.a.font)):(Er.xUj(h,ba),Er.zUj(h,ba));Er.yUj(h,ba);ba.fg(Rc.a.e1b,Sb.a.uW,Rc.a.ucd);this.Rck(b);b=new Ut.a;b.listID=A;b.level=L;return b}bul(b,h){let r;for(let A=0;9>A;A++){r=
this.su.XA(b,h,A);if(!r){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,A);break}r.setValue(Rc.a.Cu,Ks.a.aee);r.removeProperty(Kh.a.lxb)}}oBe(b,h){const r=$g.a.instance.vr(fb.a.oBe);this.UGd.value||$g.a.instance.qc("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.eJa?(r.properties.W("PendingListInfo","true"),nf.a.Wg(b)&&(r.properties.W("RemoveCurrentListInfo","true"),this.Vgb=!0,this.k$(b),this.UGd.value.Z0a(b,
-1,0),this.Vgb=!1),16!==this.eJa.listType&&this.fNb(b,this.eJa,{dWi:!0,Akm:!0}),this.eJa=null):h||(r.properties.W("CurrentlyUnderPastedList","true"),this.k$(b,{qIj:!0}));r.end()}lCe(b,h){var r;if(nf.a.Wg(b))return!1;b.ic(2);var A=Ya.a.dil;const L=[!0,!1].map(ba=>rd.ParagraphReader.Cg(b.currentNode,ba,void 0,!1));b.Ac();for(let ba=0;ba<L.length;ba++){const ra=L[ba];if(ra&&!bt.a.ooa(ra))for(const Ia of A)if(Ia.test(ra.characterData))return A=null===(r=Ia.exec(ra.characterData))||void 0===r?void 0:r[0],
this.Cyo(h,ba?"nextPara":"prevPara",A),!1}return!0}Cyo(b,h,r){const A=new Map;A.set("CurrentAutoListPreventedAutoListText",b);A.set("UndoAutoListPreferenceFoundIn",h);A.set("UndoAutoListPreferenceAutoListText",r);Ca.Health.instance.recordKpiUsage(Gi.a.hOa.oFo,0,Gi.a.GB,A)}kcp(b,h){return b&&h}zIj(b){for(let h=0;h<b.count;h++){const r=te.a.kb(b.K(h));r.ku();this.aja(r)}b.clear()}bLo(b){qh.a.yu||nf.a.Wg(b)&&this.X2()}QEj(b,h){b=new te.a;b.set(h);b.Wd();hg.a.xe(b);b.nub(h)||$g.a.instance.qc("PossibleLossOfDirectFormatting",
{["Reason"]:"OeDoesNotContainParagraph"});this.k$(b);return b}o2o(b,h,r){this.ni.Jxa(b,h,r,!0)}z2o(b){b.iea(1,1)}ZVd(b,h){const r=$g.a.instance.vr(fb.a.Pdl);if(this.kc.i2(h.rj())){if(nf.a.Wg(b)&&this.k$(b),h=this.su.DGi(h)){if(qh.a.yu)var A=this.g2b(b,h,!0);else if(this.su.Wab(b.currentNode,h),A=dp.vem(this,b,h))A=this.BUj(b,A,!0);else{A=this.Nei(b);var L=this.C7d(b,h,this.L3j,this.Xmp);if(L){const ba=this.mG(L);if(ba.listID===h.listID&&ba.level<h.level&&this.Vd.Fy(L).NB){const ra=this.lDa(L.currentNode,
ba);ba.Ez===(ra.startAt===Gi.a.sl?1:ra.startAt)&&(ba.A1c=ba.Ez,this.FKj(A,ba,L.currentNode))}}L=this.lDa(A,h);b=this.E6f(h,b,L);b=b.eyb!==Gi.a.sl?b.eyb+1:L.startAt===Gi.a.sl?1:L.startAt;qh.a.getInstance().xu||this.kWc(A,h,null,!0);A.setValue(Hm.du.Gqa,b);A.setValue(Hm.du.nHa,b)}qh.a.getInstance().xu||A.setValue(Rc.a.k2,!0);r.end()}}else $g.a.instance.qc("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}FKj(b,h,r){qh.a.yu||this.su.cle(b,h.listID,h.level)&&this.dLo(r,h)}cel(b,h,r){if(!nf.a.Wg(h)&&
(v.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),nf.a.Qe))return;let A=null;qh.a.getInstance().xu||(A=h.ic(4),h.Ac());(h=Mb.a.uN(h))||Cd.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.Mwf(b,r,0,null);this.kWc(A,b,h);return b}Mwf(b,h,r,A=null){b=A?this.hOl(b,h,r,A):this.fOl(b,h,r);Hm.du.Gv||(h.CDa?(h=h.levelText,A||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(v.ULS.sendTraceTag(22127642,338,15,
"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}NPg(b,h,r,A=null){if(nf.a.Wg(b)){var L=b.ic(4);b.Ac();var ba=Mb.a.uN(b);this.ujc(ba,()=>{this.kWc(L,h.Mw,ba,r);qh.a.yu||this.Zli(L,h,r,A)})}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}BUj(b,h,r,A=null){const L=Mb.a.uN(b);return this.ujc(L,()=>{const ba=this.g2b(b,h.Mw,r);if(!qh.a.yu)return this.Zli(ba,h,r,A),ba})}Zli(b,h,r,A=null){if(!qh.a.yu&&
this.su.Wab(b,h.Mw).NB){const L=new te.a;L.set(b);L.Wd();L.Ac();const ba=this.Sgm(L,h,A);b=this.Kgm(L,b,h,r,A,ba);this.Pgm(h,r,A,ba,b)}}Sgm(b,h,r){if(!qh.a.yu){if(h.R3i)h=h.gU;else{let A,L;r?(A=this.M3j,L=this.MEe):h.uVb?(A=this.L3j,L=this.MEe):(A=this.Wmp,L=this.Ymp);h=this.C7d(b,h.Mw,A,L,r)}!h&&r&&(r=new te.a,r.Ad(b),r.tce()&&nf.a.Wg(r)&&(h=r));return h}}Kgm(b,h,r,A,L,ba){if(!qh.a.yu)return A?(L?b=L.Etd:(ba=this.lDa(h,r.Mw),r=this.E6f(r.Mw,b,ba),b=r.eyb!==Gi.a.sl?r.eyb+1:ba.startAt===Gi.a.sl?1:
ba.startAt),h.setValue(Hm.du.Gqa,b),h.setValue(Hm.du.nHa,b)):(b=Gi.a.sl,this.s3o(h,ba,r)),b}Pgm(b,h,r,A,L){if(!qh.a.yu&&A){var ba=!1;const Ta=this.mG(A);var ra=Ta.level===b.Mw.level,Ia=!!r&&Ta.listID===r.wjd;(Ta.listID===b.Mw.listID||Ia)&&ra&&(ra=this.lDa(A.currentNode,Ta),Ia=ra.startAt===Gi.a.sl?1:ra.startAt,Ta.Ez===Ia+1&&(ba=h?L===Ia:this.wsn(A,ra)));if(!ba||r)r?(h=this.Cgp,L=this.Egp):(h=this.CDe,L=this.m0j),ba=new te.a,ba.set(A.currentNode),ba.Wd(),this.Vd.s2(ba),ba.Ac(),this.Lvi(A.currentNode,
b.Mw,h,L,r)}}s3o(b,h,r){if(!qh.a.yu){var A=null;h&&(A=this.mG(h));if(A&&A.listID===r.Mw.listID&&A.level===r.Mw.level){const L=this.Vd.Fy(h),ba=L.Ez;b.setValue(Hm.du.Gqa,ba);b.setValue(Hm.du.nHa,ba);L.kf.setValue(Rc.a.listID,A.listID);L.kf.setValue(Rc.a.listLevel,A.level);if(!r.uVb||r.qhd)r.R3i&&!r.qhd&&(this.Vd.s2(h),b=h.currentNode,hg.a.xe(h)),b.setValue(Hm.du.nHa,b.getValue(Hm.du.Gqa))}else h=r.Mw.Ez+1,b.setValue(Hm.du.Gqa,h),b.setValue(Hm.du.nHa,h)}}Itp(b,h,r=!1){let A,L=!1;const ba=[];for(const Ta of b){if(!rd.ParagraphReader.lc(Ta.node))continue;
const ob=Ta.node;L||(L=Ee.a.Df(Ta));if(h&&16!==h.listType){var ra=te.a.kb(ob);ra.Ib(8);ra.Ac();if(1<b.length&&this.iZj(ra,h))continue;if(!Ia){var Ia=this.Vd.Fy(ra);ra=this.Y4i(h);ra=this.hGg(h,Ia,!0,ra);Ia=!ra;null!==A&&void 0!==A?A:A=ra}}ba.push(ob)}L?Ia?this.Q_h(ba,h,{zsb:r,Kck:!0}):this.R_h(ba):Ia?this.Q_h(ba,h,{zsb:r,Kck:A}):this.R_h(ba)}Q_h(b,h,{zsb:r=!1,Kck:A=!1}={}){const L=[];for(const Ia of b){(b=Ia.GC())&&L.push([Ia,b]);b=te.a.kb(Ia);b.Ib(8);b.Ac();let Ta;var ba=this.YEi(Ia);const ob=this.infoAtLevel(b,
h),nb=nf.a.Qe?null:b.ic(4);if(nf.a.Qe?nf.a.isListItem(Ia):nb)if(nf.a.Qe||b.Ac(),!A||ra)({listLevel:Ta}=nf.a.wna(b)),this.k$(b,void 0,!0);else{var ra=this.Nlf(ob,nf.a.Qe?Ia:nb,-1,h.ZC).Mw;continue}this.EUj(Ia);ra||(ra=this.PFi(h,b,ob,!1,r),this.JTj(ra,ob),null==ra||r||ob.NB!==this.Vd.Wab(b.currentNode,ra.Mw).NB?(ra=Mb.a.M4(b),0<ra&&(ba+=ra),ra=this.Mwf(Ia.ed.Pp(),h,ba,h.ZC)):ra=ra.Mw);ba=ra.level;null!=Ta&&(ra.level=Ta);this.g2b(b,ra);null!=Ta&&(ra.level=ba)}if(!this.Vgb)for(const [Ia,Ta]of L)Ia&&
Ta&&this.lr.MR(Ia,Ta,this.me.Zg);this.X2()}R_h(b){for(const h of b)b=te.a.kb(h),b.Ib(8),b.Ac(),this.k$(b,void 0,!0);this.X2()}fNb(b,h,{dWi:r=!1,FGn:A=-1,zsb:L=!1,Akm:ba=!1}={}){return h&&16!==h.listType?te.a.Yga(()=>{if(!Mb.a.ji(b))return v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),mr.ceb();const ra=Mb.a.uN(b);return nf.a.Qe&&!ra&&(v.ULS.sendTraceTag(508441813,393,15,"No paraNode was found while trying to applyListInfo"),nf.a.Qe)?mr.ceb():ra&&kp.a(ra,
8)?(v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),mr.ceb()):(null===ra||void 0===ra?0:ra.ra.last.Gi)?(v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),mr.ceb()):this.ujc(ra,()=>{var Ia=Object(ao.a)().kw(b.currentNode);const Ta=h.ZC,ob=this.infoAtLevel(b,h);var nb=nf.a.Qe?null:b.ic(4);if(nf.a.Qe?nf.a.isListItem(ra):nb)return nf.a.Qe||b.Ac(),Ia=this.Nlf(ob,nf.a.Qe?ra:nb,A,Ta),Ia.Mw=this.mG(b),Ia;this.NHo(b);({listId:nb}=
nf.a.qOf(h,{Qta:-1}));const Eb=this.cFm(nb,ba),bc=this.YEi(ra),Bc=this.PFi(h,b,ob,ba,L,r);this.JTj(Bc,ob);ra&&this.EUj(ra);return null!=Bc&&!L&&(ob.NB===this.Vd.Wab(b.currentNode,Bc.Mw).NB||sl.a.C2f&&h.GIf)?(ob.listStyle||(Bc.uVb=!0),this.Sdl(Eb,Bc,b)):this.j3l(ob,Eb,Bc,b.currentNode)?this.Rdl(b,ob,Eb,bc,Ta):this.Qdl(b,ob,Ia,bc,Ta,Eb,nb)})}):(h||v.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.k$(b))}Rdl(b,h,r,A,L){r=this.AFm(h,r,A);r=this.g2b(b,r);b=nf.a.Qe?nf.a.a9(b):
r;return this.Nlf(h,b,-1,L)}PFi(b,h,r,A,L,ba){var ra;L=b.jyb?new dp(this,te.a.kb(b.jyb),!1,!0):b.GIf&&sl.a.C2f?dp.wem(this,h):dp.uem(this,h,r,A,L);if(!L)return null;ba?(L.Mw.level=this.eDm(h,r,A),this.xgm(h,L)):L.Mw&&(null===(ra=b.kf)||void 0===ra?0:ra.hasProperty(Rc.a.listLevel))&&(L.Mw.level=b.kf.getValue(Rc.a.listLevel));return L}cFm(b,h){return h&&0<b&&b+""in this.Fng?this.Fng[b+""]:-1}AFm(b,h,r){var A,L;const ba=new Ut.a;ba.listID=h;ba.level=null!==(L=null===(A=b.kf)||void 0===A?void 0:A.Uf(Rc.a.listLevel))&&
void 0!==L?L:this.Bed(r);b.kf&&b.CDa&&!Hm.du.Gv&&(ba.levelText=b.levelText.replace("%1","%"+(ba.level+1)));return ba}Nlf(b,h,r,A){b=this.cul(h,b,r,A);return mr.jHn(b)}Sdl(b,h,r){let A=null;0<b&&(A=new yB(0,h.Mw,-1),A.wjd=b);qh.a.yu?this.g2b(r,h.Mw):this.BUj(r,h,!1,A);return mr.AHn(h.Mw)}Qdl(b,h,r,A,L,ba,ra){const Ia=Mb.a.M4(b);0<Ia&&(A+=Ia);r=this.Mwf(r,h,A,L);this.RFp(ba,ra,r);b=this.g2b(b,r);qh.a.yu||h.listType||(h=h.zF,h===Gi.a.sl&&(h=1),b.setValue(Hm.du.Gqa,h),b.setValue(Hm.du.nHa,h));return mr.mHn(r)}mPo(b,
h){const r=Mb.a.uN(b),A=this.kc.pG(r);this.Q2.IP(A.Qg(Hg.a.wordStyleIdListParagraph),r,!0,!1,!1,this.Vgb);this.ni.Jxa(b,1,h)}k$(b,{qIj:h=!1}={},r=!1){return te.a.Yga(()=>{if(!Mb.a.ji(b))return v.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),mr.ceb();const A=Mb.a.uN(b);if(qh.a.getInstance().Gv&&!A&&(this.ni.wHo(b.currentNode),qh.a.getInstance().xu))return mr.ceb();if(null===A||void 0===A?0:A.ra.last.Gi)return v.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),
mr.ceb();const L=b.ic(4);qh.a.getInstance().Gv&&!qh.a.getInstance().xu&&!A&&L&&v.ULS.sendTraceTag(508432897,393,15,"OutlineElement has listNode but no paraNode during removeListInfo [setter flight ON]");return qh.a.Hv||L?qh.a.Hv&&!nf.a.isListItem(A)?L?(L.CAc=!1,b.qh(),mr.X7f()):mr.ceb():A?this.ujc(A,()=>{var ba;this.yIj(A);this.UGo(A);nf.a.Qe||(A.eG=null);this.Vd.Yhe(nf.a.Qe?nf.a.ut(A,{Qta:0}).listId:L.ka(Rc.a.listID,0))?(L&&(L.CAc=!1),this.kK.aja(A,b),nf.a.Qe&&!qh.a.getInstance().xu&&(A.eG=null)):
L&&b.Ac();h||this.E_o(b);if(b.ic(4)||qh.a.Hv&&nf.a.isListItem(A))L&&(L.CAc=!1),this.kK.aja(A,b),nf.a.Qe&&!qh.a.getInstance().xu&&(A.eG=null);!qh.a.getInstance().xu&&(this.me.Zg&&!this.Vgb||!this.me.Zg&&A.Ej)&&(!A.Ej||(null===(ba=A.Hz)||void 0===ba?0:ba.hasProperty(Rc.a.listID)))&&this.qQl(b);return mr.X7f()},{zhp:r}):(v.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),L&&(L.CAc=!1,b.qh()),mr.X7f()):mr.ceb()})}E_o(b){const h=Object(ao.a)().kw(b.currentNode),
r=Mb.a.eDa(b),A=Mb.a.cK(b),L=Mb.a.M4(b);this.P4d(h);this.ni.Jxa(b,1,Math.max(0,r+(L||-1*A)-this.IIc[0]))}ujc(b,h,{zhp:r=!1}={}){let A=null;b&&(A=b.GC());h=h();this.Vgb||(b&&A&&this.lr.MR(b,A,this.me.Zg),r||this.X2());return h}UGo(b){b.hasProperty(Rc.a.ve)&&b.removeProperty(Rc.a.ve);b.hasProperty(Rc.a.vF)&&b.removeProperty(Rc.a.vF);b.hasProperty(Rc.a.lv)&&b.removeProperty(Rc.a.lv)}infoAtLevel(b,h){if(!h)return null;const r=h.ZC;if(1===h.Cu){if(h.Ova&&!h.MN||!h.Brf(!1))return h;b=Mb.a.eDa(b);const A=
this.Bed(b),L=r.BXb[A];b=Yr.a.hca(h.kf,h.kf);6===L?b.iea(1,1):b.iea(0,L);b.qBe("multilevel");b.levelText=r.Ded[A];r.pMa&&r.pMa[A]&&(b.font=r.pMa[A]);b.Dz=r.ike[A];b.S$=r.S$;b.ale=h.ale}else b=h;return b}JTj(b,h){null!==b&&void 0!==b&&b.Mw&&(h.levelText=b.Mw.levelText,h.NB||(h.font=b.Mw.font))}eDm(b,h,r){let A=Mb.a.eDa(b);const L=Mb.a.M4(b);0<L?A+=L:(b=Mb.a.cK(b),0<b&&(A-=b));h=h.kf.ka(Rc.a.listLevel,-1);return r&&0<=h?h:this.Bed(A)}xgm(b,h){if(!qh.a.yu&&!this.su.Wab(b.currentNode,h.Mw).listType){const r=
this.lDa(b.currentNode,h.Mw);b=this.E6f(h.Mw,b,r);h.Mw.A1c=h.Mw.Ez=b.eyb===Gi.a.sl?r.startAt-1:b.eyb;h.uVb=b.Vgk}}RFp(b,h,r){0>=b?this.Fng[h+""]=r.listID:r.listID=b}j3l(b,h,r,A){if(0>=h)return!1;const L=(ba,ra)=>ba.length!==ra.length||ba.some((Ia,Ta)=>Ia!==ra[Ta]);if(r)return h=this.Vd.Wab(A,r.Mw),b.NB!==h.NB||L(b.Boa,h.Boa);r=b.kf.ka(Rc.a.listLevel,-1);return 0<=r&&(h=this.su.XA(A,h,r))&&(h=h.ka(Sb.a.O9,null))&&b.Boa?L(h,b.Boa):!1}SGo(b,h){var r;const A=!!h&&rd.ParagraphReader.lc(h);let L=0,ba=0;
A&&(L=this.Vq.cZ(nf.a.Qe?h:this.Vd.CGi(b)).ww,ba=this.Vq.cK(h).ww);A&&this.yIj(h);(null===(r=qh.a.getInstance())||void 0===r?0:r.xu)||b.ic(4);this.kK.aja(h,b);A&&this.ni.Jxa(b,1,L-ba)}Gga(b,h,r,A=-1,L=!1,ba=null,ra=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ia=$g.a.instance.vr(fb.a.Gga),Ta=this.Zc.Vc(15);Ta.nw(b);let ob=null,nb=0;({gDn:ob,D_n:nb,returnValue:A}=this.Xem(b,h,A,ob,nb,L,ba));if(!ob||ra&&(1===r||0>r-ob.Mw.Ez||2<r-ob.Mw.Ez))return Ta.dispose(),
Ia.end(),!1;for(;0<nb;)b.tce(),nb--;this.NFp(b,h,A,ob);Ta.dispose();Ia.end();return!0}NFp(b,h,r,A){for(;b.tce();){var L=nf.a.a9(b);if(L&&(L=this.Fmc(L),L.listID===h.listID)){h=new yB(0,h,r);qh.a.getInstance().Gv?this.NPg(b,A,L.k2,h):this.NPg(b,A,!0,h);break}}}Xem(b,h,r,A,L,ba=!1,ra=null){for(var Ia;b.jQi();){if(b.dw(4)){const Ta=this.mG(b),ob=this.Vd.Fy(b);if(ob.listType!==ra.listType){L++;continue}if(ba&&ob.listStyle!==ra.listStyle||!ba&&h.level<Ta.level){L++;continue}-1===r&&(r=Ta.Ez+1);A=null;
if(h.level===Ta.level||ba)null===(Ia=this.ftd)||void 0===Ia?void 0:Ia.bYf(b),A=new dp(this,b,!1,!1);ba&&Ta.level!==h.level&&b.dw(4)&&(b.ic(4).setValue(Rc.a.listLevel,Ta.level),b.Ac());break}L++}return{returnValue:r,gDn:A,D_n:L}}zFm(b){b=nf.a.a9(b);return this.L$d(b)}L$d(b){let h;h=nf.a.Qe?nf.a.ut(b)||nf.a.Cna(b):this.Vd.B1(b,!1,!0);return this.Vd.XA(b,h.listId,h.listLevel)}startNewList(b,h,r){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var A=$g.a.instance.vr(fb.a.startNewList),
L=this.Zc.Vc(15);L.nw(b);var ba=Yr.a.LY(0,h.listStyle,null,0,h.kf.ka(Rc.a.listLevel,-1));if(nf.a.Qe)({listId:ra,listLevel:Ia}=nf.a.wna(b,{Qta:0,SWa:-1}));else{b.ic(4);var ra=b.currentNode.ka(Rc.a.listID,0);var Ia=b.currentNode.ka(Rc.a.listLevel,-1);b.Ac()}ba.ale=ra;var Ta=h.kf.ka(Rc.a.ve,0);0<Ta&&ba.kf.setValue(Rc.a.ve,Ta);-1===ba.kf.ka(Rc.a.listLevel,-1)&&ba.kf.setValue(Rc.a.listLevel,Ia);1===h.Cu&&((Ia=new aF.a,ra=h.IOi(b.currentNode,ra),ra)?1===ra&&(ba.qBe(Ks.a.zuc),ba.ZC=Ia.Owf(Ia.Jgg,Ia.Kgg),
ba.S$=ba.ZC.S$):(ba.qBe(Ks.a.zuc),ba.ZC=Ia.Yvf(),ba.S$=ba.ZC.S$));h.Nua()&&1>r&&(r=1);ba.zF=r;Ia=new Ai.DictionaryPropertySet;Ia=this.A2c(fb.a.KP,Ia);ra=Mb.a.uN(b);h=this.mG(b);if(Ta=this.zFm(b))ba.levelText=Ta.ka(Rc.a.Qy,""),ba.MN=42,ba.Dz=Ta.ka(Rc.a.oia,"left");this.SGo(b,ra);({Tna:ba}=this.Vsa(Ia,b,ba,!0));b.ic(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);qh.a.getInstance().xu||b.currentNode.setValue(Rc.a.listLevel,
h.level);qh.a.getInstance().Gv&&({listId:ba}=nf.a.ut(qh.a.getInstance().fda?ra:b.currentNode),this.kK.f2b(ra,ba,h.level));b.Ac();ba=new dp(this,b,!1,!1);r=new yB(1,h,r);this.NPg(b,ba,!!qh.a.getInstance().Gv,r);L.dispose();A.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}n3f(b){if(!b)return!1;const h=b.ic(2);h&&b.Ac();return h&&12===h.type&&h.ra&&h.ra.last&&h.ra.last.Gi?!0:!1}ute(b,h,r,A){return this.PJk.ute(b,h,r,A)}Yzg(b,h){if(!b||!h)return!1;const r=b.kf.ka(Rc.a.Qy,
null);h=h.kf.ka(Rc.a.Qy,null);if(!r||!h)return!1;const A=b.kf.ka(Sb.a.font,null);b=b.kf.ka(Sb.a.font,null);return r===h&&A===b}iVj(b,h,r){r||h.listType||(h.zF=b.ka(Sb.a.uW,Gi.a.sl))}rGi(b,h){if(!h)return null;const r=Array(9),A=h.ale;if(!this.Utn(h,b)||1>A)return null;for(h=0;9>h;h++){const L=this.Vd.XA(b,A,h);if(null===L||void 0===L?0:L.hasProperty(Rc.a.ve))r[h]=L.getValue(Rc.a.ve);else return null}return r}Utn(b,h){if(!b)return!1;const r=b.kf.ka(Rc.a.listLevel,-1);b=b.kf.ka(Rc.a.ve,-1);if(0>r||
0>b)return!1;this.P4d(h);return b!==this.w8b[r]}kTh(b,h,r){b&&b.setValue(Rc.a.ve,h?h[r]:this.w8b&&r<this.w8b.length?this.w8b[r]:720*(r+1))}Lvi(b,h,r,A,L=null,ba=!1){if(!qh.a.yu){var ra=new te.a,Ia=this.lDa(b,h);ra.set(b);ra.Wd();b=zp.a.$u(ra,ra.bDb());b.Oq(iF.a.ile,null);for(var Ta=-1;b.moveNext();){if(!nf.a.Wg(ra))continue;const ob=this.mG(ra),nb=Mb.a.uN(ra);this.Vd.s2(ra);const Eb=ra.currentNode;ra.Ac();if(r!==this.CDe||ob.listID===h.listID){if(ba){if(-1!==Ta&&Ta>ob.level)break;if(-1===Ta)Ta=ob.level;
else if(ob.level!==Ta)continue}else{if(ob.level<=Ia.Mfb)break;if(!r(h,ob,L))continue}A(Eb,nb,h.listID,L)}}}}Oim(b,h,r,A){if(!qh.a.yu){var L=new te.a,ba=this.lDa(b,h);L.set(b);L.Wd();if(nf.a.Wg(L)){b=this.mG(L);var ra=Mb.a.uN(L);this.Vd.s2(L);var Ia=L.currentNode;L.Ac();b.level<=ba.Mfb||r(h,b,null)&&A(Ia,ra,h.listID,null)}}}Nim(b,h,r,A,L=null){const ba=new te.a;ba.Ad(b);A(b,h,this.mG(ba),ba,0);this.C7d(b,h,r,A,L)}C7d(b,h,r,A,L=null){let ba=new te.a;const ra=this.lDa(b.currentNode,h);let Ia=null,Ta=
0;var ob=new te.a;ob.Ad(b);ob.Ib(10);const nb=Xd.a.$u(ob,ob.origin);for(nb.moveNext();nb.moveNext();)if(Ia=null,ba=nb.iterator,1===ba.role&&(Ia=nb.currentNode,ba.dw(4)&&(ob=this.mG(ba),r(h,ob,L))))if(ob.level>h.level)A(b,h,ob,ba,Ta),Ta++;else if(ob.level===h.level||ob.level<=ra.Mfb)break;return Ia?ba:null}sEj(b,h,r,A){qh.a.yu||this.lDa(b.currentNode,r).Mfb>=h.level&&this.dul(A)}static xUj(b,h){h.setValue(Sb.a.font,b.Ova||b.tad||b.N8c?b.font:"Symbol")}static zUj(b,h){b=b.Ova||b.tad||b.CDa?b.levelText:
Gi.a.i2d;v.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Rc.a.Qy,b)}static yUj(b,h){b=b.kf.ka(Rc.a.oia,"left");h.setValue(Rc.a.oia,b)}}Er.jSn=2147450879;Er.Jjj=1;Object(u.a)(Er,"FlatListEditorCssVersion",Hm,[654,655]);class $r{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){this.su=b;this.Edo=h;this.Yf=r;this.Bq=A;this.lE=L;this.gHn=ba;this.Yd=ra;this.lk=Ia;this.rHn=Ta;this.Dc=ob;this.kc=nb;this.nO=Eb;this.kK=bc}create(){return new Er(this.su,this.Edo,this.Yf,this.Bq,this.lE,this.gHn,this.Yd,this.lk,
this.rHn,this.Dc,this.kc,this.nO,this.kK)}}Object(u.a)($r,"FlatListEditorFactory",null,[]);class YL{constructor(){this.startAt=this.listLevel=this.listId=0;this.jyb=null}}Object(u.a)(YL,"ListAutoCorrectionRefInfo",null,[]);class LH{constructor(b,h){this.lJk=b;this.zg=h}ute(b,h,r,A){if(!b.hasProperty(Pd.a.mOa))return!0;h=te.a.kb(h.currentNode);Ee.a.uw(h);let L=!0;if(!r.listType&&!A){23===h.Jf&&h.vN(1);A=b.ka(Pd.a.mOa,1);if(1<A){var ba=new te.a;ba.Ad(h);ba.Ib(10);ba=Xd.a.Mp(ba.origin);A=this.Wem(ba,
A,r,h.currentNode);r.jyb||(L=!1)}b.setValue(Pd.a.mOa,A)}return L}Wem(b,h,r,A){const L=new Cb.a;for(;b.moveNext()&&b.iterator.currentNode!==A;){const ba=b.iterator;if(!ba.dw(4))continue;const ra=this.lJk.value.mG(ba),Ia=this.zg.Fy(ba);this.xro(L,ra);Ia.listType===r.listType&&Ia.listStyle===r.listStyle&&(0>h-ra.Ez||2<h-ra.Ez||L.add(Object.assign(new YL,{listId:ra.listID,listLevel:ra.level,jyb:ba.currentNode,startAt:ra.Ez+1})))}0<L.count&&(h=L.K(L.count-1).startAt,r.jyb=L.K(L.count-1).jyb);return h}xro(b,
h){let r=0;for(;r<b.count;){const A=b.K(r);A.listId===h.listID&&A.listLevel>=h.level?b.removeAt(r):r++}}}Object(u.a)(LH,"ListAutoCorrector",null,[622]);class MH{constructor(b,h,r,A,L){this.ehb=(ba,ra,Ia)=>{var Ta;ba=nf.a.Qe?nf.a.S5c(ra):this.y_c(ra);if(!ba||this.Bv.n3f(ba))return 8;ra=this.Bv.mG(ba);if(1===ra.Ez||this.Jbd(ra.level))return 8;ra=null===(Ta=this.Vd)||void 0===Ta?void 0:Ta.Fy(ba);if(!ra||this.f4i(ra))return 8;if(1===Ia)return 32;this.Bv.startNewList(ba,ra,1);return 32};this.dhb=(ba,ra,
Ia)=>{ba=nf.a.Qe?nf.a.S5c(ra):this.y_c(ra);if(!ba||this.Bv.n3f(ba))return 8;ra=this.Bv.mG(ba);if(this.Jbd(ra.level))return 8;const Ta=this.Vd.Fy(ba);if(!Ta||this.f4i(Ta))return 8;if(1===Ia)return 32;this.R0c.NHm(ba.currentNode,ra.Ez,this.Vd,this.Bv,this.$2a);return 32};this.Gga=(ba,ra,Ia)=>{ba=nf.a.Qe?nf.a.S5c(ra):this.y_c(ra);if(!ba||this.Bv.n3f(ba))return 8;ra=this.Bv.mG(ba);if(1!==ra.Ez||this.Jbd(ra.level))return 8;if(1===Ia)return 32;Ia=this.Vd.Fy(ba);return this.Bv.Gga(ba,ra,Ia.zF,-1,!1,Ia)?
32:8};this.DBb=(ba,ra,Ia,Ta,ob)=>{ba=nf.a.Qe?nf.a.S5c(ra):this.y_c(ra);if(!ba)return 8;ra=this.Bv.mG(ba);if(this.Jbd(ra.level))return 8;if(1===Ia)return 32;Ia=this.Vd.Fy(ba);this.Bv.startNewList(ba,Ia,ob);return 32};this.sqb=(ba,ra,Ia,Ta,ob)=>{ba=nf.a.Qe?nf.a.S5c(ra):this.y_c(ra);if(!ba)return 8;ra=this.Bv.mG(ba);return this.Jbd(ra.level)?8:1===Ia?32:this.Bv.Gga(ba,ra,ra.Ez,ob)?32:8};this.Tb=b;this.Vd=r;this.Bv=A;this.R0c=L}Jbd(b){return 0>b}mc(){this.Tb.qa(fb.a.ehb,ic.a.gU,this.ehb);this.Tb.qa(fb.a.ehb,
ic.a.kd,this.ehb);this.Tb.qa(fb.a.ehb,ic.a.view,this.ehb);this.Tb.Oc(fb.a.ehb,12);this.Tb.qa(fb.a.dhb,ic.a.gU,this.dhb);this.Tb.qa(fb.a.dhb,ic.a.kd,this.dhb);this.Tb.qa(fb.a.dhb,ic.a.view,this.dhb);this.Tb.Oc(fb.a.dhb,12);this.Tb.qa(fb.a.Gga,ic.a.gU,this.Gga);this.Tb.qa(fb.a.Gga,ic.a.kd,this.Gga);this.Tb.qa(fb.a.Gga,ic.a.view,this.Gga);this.Tb.Oc(fb.a.Gga,12);this.Tb.qa(fb.a.DBb,ic.a.gU,this.DBb);this.Tb.qa(fb.a.DBb,ic.a.kd,this.DBb);this.Tb.qa(fb.a.DBb,ic.a.view,this.DBb);this.Tb.Oc(fb.a.DBb,12);
this.Tb.qa(fb.a.sqb,ic.a.gU,this.sqb);this.Tb.qa(fb.a.sqb,ic.a.kd,this.sqb);this.Tb.qa(fb.a.sqb,ic.a.view,this.sqb);this.Tb.Oc(fb.a.sqb,12)}get $2a(){return Xa.a.instance.resolve("Common.IStandaloneRootController").yja}y_c(b){return this.Bv.jFm(b)}f4i(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(u.a)(MH,"ListContextMenuSectionActor",null,[]);var Yl=e(617);class jD{static get qHn(){return Xf.a.iA(jD.pp,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,
Box4Intl.Box4Strings.l_SetValueTo)}}jD.pp="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(jD,"ListSetStartValueDialogHtml",null,[]);class Nw extends Xf.a{constructor(b,h,r,A,L){super();this.pLd=this.tRe=this.HLd=this.Gbf=null;this.kTe=!0;this.MX=!1;this.Vlb=0;this.A1j=[fb.a.tDg,fb.a.oIg,fb.a.gsg];this.S5o=(ba,ra)=>{ba=ra[vi.a.Number];this.jfa=Number.isInteger(ra[vi.a.Number])&&ba>=this.Vlb?ba:this.Vlb};this.WRm=(ba,ra)=>{this.jfa=this.jfa>=this.Vlb?this.jfa:this.Vlb;ra[vi.a.Number]=this.jfa;ra[vi.a.UnitType]=0};this.M2o=(ba,ra)=>{if(1===ba){var Ia=ra.ListRadioStartNew,Ta=ra.ListRadioContinue,
ob=te.a.kb(this.ng);ob.Wd();ra=this.Bv.mG(ob);ba=this.zg.Fy(ob);if(Ia)this.Bv.startNewList(ob,ba,this.jfa);else if(Ta)if(this.kTe)this.Bv.Gga(ob,ra,this.W5e,-1,!1,ba);else{Ia=!0;for(Ta=null;ob.cR();)if(nf.a.Wg(ob)){Ta=new dp(this.Bv,ob,!1,!1);break}if(!Ta||this.Bv.mG(ob).Ez>=this.jfa)Ia=!1;Ia?(ob=te.a.kb(this.ng),ob.Wd(),this.Bv.Gga(ob,ra,this.W5e,this.jfa,!1,ba)):(this.dispose(),this.iQa(CommonUIStrings.l_ErrorDialogMessage,this.pHn))}}};this.pHn=()=>{new Nw(this.ng,this.W5e,this.zg,this.Bv,this.Od)};
this.R$n=()=>{document.getElementById(Nw.Hbj).style.visibility="visible"};this.x3n=()=>{document.getElementById(Nw.Hbj).style.visibility="hidden"};this.$g="ListSetStartValueDialog";this.Fh=jD.qHn;this.ng=b;this.jfa=h;this.zg=r;this.W5e=h;this.Daa=A;h=new te.a;b?(h.set(b),h.Wd(),Mb.a.ji(h)||hg.a.xe(h),nf.a.Wg(h)&&(b=null,nf.a.Qe?b=this.zg.Fy(h):(h.ic(4),h=h.currentNode,22===h.type&&(b=this.zg.P4(h))),b&&(b.Nua()?this.Vlb=1:this.Vlb=0))):this.Vlb=1;this.Od=L;this.ti(Box4Intl.Box4Strings.l_SetNumberingValueList,
this.M2o,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.kTe&&(this.Gbf=document.getElementById("ListRadioStartNew"),this.HLd=this.R$n,this.tRe=document.getElementById("ListRadioContinue"),this.pLd=this.x3n,Re.a.addHandler(this.Gbf,"click",this.HLd),Re.a.addHandler(this.tRe,"click",this.pLd));for(const ba of this.A1j)Object(Yl.a)(ba,this.S5o,this.WRm);this.Od.qo()}get Bv(){return this.Daa}dispose(){if(!this.MX){for(const b of this.A1j)Object(Yl.b)(b);this.kTe&&(this.HLd&&Re.a.removeHandler(this.Gbf,
"click",this.HLd),this.pLd&&Re.a.removeHandler(this.tRe,"click",this.pLd));this.Od.I2("ListStartSpinner");super.dispose();this.MX=!0}}jnl(){const b=Zh.l("none",this.Vlb+"","100","1");return Zh.j(Nw.Ibj,fb.a.tDg,fb.a.gsg,Box4Intl.Box4Strings.l_SetValueTo,[b],null,fb.a.oIg)}oNb(b){const h=document.getElementById(Nw.Ibj);this.Od.h8a("ListStartSpinner",b);b=this.Od.xSb("ListStartSpinner","Medium");h.appendChild(b)}Cda(){const b=this.jnl();this.oNb(b)}}Nw.Ibj="SetListStartSpinnerContainer";Nw.Hbj="ListStartAtSpinnerBox";
Object(u.a)(Nw,"ListSetStartValueDialog",Xf.a,[]);class Vz{NHm(b,h,r,A,L){new Nw(b,h,r,A,L)}static get instance(){return Vz._instance||(Vz._instance=new Vz)}}Vz._instance=null;Object(u.a)(Vz,"ListDialogFactory",null,[415]);class kD{constructor(b,h,r){this.Daa=b;this.zg=h;this.Zc=r}bYf(b){v.ULS.shipAssertTag(40420184,393,Mb.a.ji(b));if(nf.a.Wg(b)){const h=this.zg.Fy(b);h.Cu||this.Jbn(b,h)}}wwl(b){for(let h=0;h<b.length;h++){const r=new te.a;r.set(b.getContext(h).node);this.bYf(r)}}Jbn(b,h){const r=
Object(ao.a)().kw(b.currentNode),A=this.Daa.mG(b),L=this.Zc.Vc(15);L.nw(b);h=this.Daa.cel(r,b,h);this.Daa.SFp(b,A.listID);L.dispose();this.zg.Wab(b.currentNode,h)}}Object(u.a)(kD,"SingleLevelListEditor",null,[412]);class yq{zBj(b,h,r,A,L,ba){return b?y.AFrameworkApplication.va.Sf(b,h,r,!0,L,ba):8}}Object(u.a)(yq,"ListContextManager",null,[1621]);class Ow extends yq{constructor(b){super();Ow.SLc=b}zBj(b,h,r,A,L,ba){if(!b||!b.length)return 8;let ra;const Ia=({s_m:b,r_m:ra}=Ow.Hs.p_m(b)).returnValue;
let Ta=1;for(const nb of Ia.keys){var ob=b.contains(nb);const Eb=Ia.K(nb);Ow.Hs.Yrl(Ia.K(nb),this.dYc(h),ob)?ob?(v.ULS.sendTraceTag(508350475,393,50,"List Actions: {0} lists, with change in level",this.dYc(h)?"Promote":"Demote"),ob=y.AFrameworkApplication.va.Sf(Mt.a.iCa(Eb),h,r,A,L,ba)):(v.ULS.sendTraceTag(508350474,393,50,"List Actions: {0} lists, without change in level",this.dYc(h)?"Promote":"Demote"),ob=Ow.Hs.Ddo(Ia.K(nb),this.dYc(h),ra.K(nb))):(v.ULS.sendTraceTag(508350476,393,50,"List Actions: Tried to {0} lists, but unable to indent",
this.dYc(h)?"Promote":"Demote"),ob=8);Ta=qf.ActionManager.Bgd(Ta,ob)}return Ta}dYc(b){return b===fb.a.uK?!0:!1}static get Hs(){return Ow.SLc||(Ow.SLc=Xa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Ow.SLc=null;Object(u.a)(Ow,"WordEditorListContextManager",yq,[]);class sv{get name(){return"WordEditor.ListEditors"}Ec(b){y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ja("WordEditor.ListEditors.IListAutoCorrector",()=>new LH(b.zf("WordEditor.IFlatListEditor"),
b.resolve("Box4.List.IListReader"))).ha(),b.ja("WordEditor.IFlatListEditor",()=>(new $r(b.resolve("WordEditor.List.IFlatListReader"),b.zf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new gm.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ja("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ja("Box4.List.ISingleLevelListEditor",()=>new kD(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ja("Box4.ListEditors.WordEditorListContextManager",()=>new Ow(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new MH(y.AFrameworkApplication.va,
new dj.a,sv.Vd,sv.Bv,Vz.instance)).mc();const b=y.AFrameworkApplication.va;b.nb(fb.a.gsg,ic.a.view,Yl.d,96);b.nb(fb.a.oIg,ic.a.view,Yl.c,96);b.nb(fb.a.tDg,ic.a.view,Yl.c,96)}dispose(){}static get Vd(){return null!=sv.K5g?sv.K5g:sv.K5g=Xa.a.instance.resolve("Box4.List.IListReader")}static get Bv(){return null!=sv.L_g?sv.L_g:sv.L_g=Xa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){F.a.instance.Rc(new sv)}}Object(u.a)(sv,"WordEditorListEditorsPackage",null,[0,1]);var ZL=e(1701),Pw=e(534),
mK=e(459),NH=e(262);class OH extends NH.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=null}Hn(){return mK.a.Kwj}static yma(b,h){const r=new OH;r.FileId=b;r.LastKnownPaginationRevision=Jl.a(h);return r}}Object(u.a)(OH,"PaginationRequest",NH.a,[]);class zB extends cd.a{constructor(b,h,r,A,L,ba){super(b,h);this.styleId=null;this.Ft=0;this.cwa=null;this.characterData=r;this.paragraphNode=A;this.listMarker=L;this.oUb=ba}}Object(u.a)(zB,"HeadingText",cd.a,[]);var Wz=e(363),lD=e(1023);
class Gx{constructor(b,h,r,A,L,ba){this.JVi=!0;this.Mtc=0;this.TDc=8;this.r6m=ra=>{if(ra.yt)return!0;ra=ra.role;return 1===ra||2===ra||4===ra};this.gJk=b;this.nI=h;this.Ge=r;this.zg=A;this.hL=L;this.QU=ba}get Kw(){return this.gJk.value}async CBm(){const b=await this.kKm();return this.tAj(b,!0)}DBm(){return this.tAj([],!1)}tAj(b,h){const r=window.performance.now(),A=this.rEi();if(!A)return null;const L=new Cb.a;let ba=0;for(;A.moveNext();){var ra=A.iterator;if(11===ra.Jf){const Ia=nf.a.a9(ra),Ta=hg.a.Ze(ra,
!0);h&&b[ba]&&b[ba].ParaId===rd.ParagraphReader.fW(Ta)&&ba++;hg.a.xe(ra);if(!Ta||!rd.ParagraphReader.lc(Ta)||Ta.pr||""===Ta.characterData||"\ufffc"===Ta.characterData)continue;const ob=this.b$d(Ta);ob&&(Ia&&(ob.listMarker=this.hL.A_a(Ia,!1).tW,ra=this.zg.Fy(ra),1===ra.listType&&ra.N8c&&(ob.cwa=ra.font)),h&&(b[ba-1]&&b[ba-1].ParaId===rd.ParagraphReader.fW(Ta)?ob.Ft=ba:ob.Ft=ba+1),L.add(ob))}}v.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-
r));return L}kKm(){const b=new zg.a;var h=OH.yma(y.AFrameworkApplication.rootQuerySignature,null);const r=new No.a;r.Ls=h;r.status=lD.a.xK;this.RNk=window.performance.now();h=this.QU.Bca(0,()=>{if(2!=r.statusCode||null==r.rl||0==r.rl.length||null==r.rl[0]){const A=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(A));v.ULS.sendTraceTag(543802465,3019,10,A)}else b.setResult(r.rl[0].PageEnds),v.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",
window.performance.now()-this.RNk))});h.yI(r);h.h1();return ld.b(b.task)}qEi(){const b=this.rEi();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.Jf){const A=hg.a.Ze(r,!0);hg.a.xe(r);A&&rd.ParagraphReader.lc(A)&&!A.pr&&""!==A.characterData&&"\ufffc"!==A.characterData&&this.b$d(A)&&h++}}return h}rEi(){if(!this.Kw)return v.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.nI.DT(this.Kw);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),
null;b=te.a.kb(b);if(!b.ku())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Xd.a.$u(b,b.origin);b.Oq(this.r6m,null);return b}b$d(b){var h;return null!==(h=this.$Xm(b))&&void 0!==h?h:this.EKm(b)}$Xm(b){if(!this.pCn(b))return null;var h=Object(Wz.c)(9);h=Object(Wz.a)(h);h=[...rd.ParagraphReader.hGf(b,h)];if(0===h.length)return null;const r=rd.ParagraphReader.yna(b)+1;return this.oai(b,h,r)}EKm(b){var h,r,A,L,ba=Object(Wz.c)(9);ba=Object(Wz.a)(ba);const ra=rd.ParagraphReader.o7c(b),
Ia=this.Ge.pG(b),{s6m:Ta,hgm:ob}=this.nTm(ra,Ia,ba);ba=null!==(L=null!==(r=null===(h=ob.linkedStyle)||void 0===h?void 0:h.oUb)&&void 0!==r?r:null===(A=ob.wy)||void 0===A?void 0:A.oUb)&&void 0!==L?L:10;return this.lcd(ba-1)?this.oai(b,Ta,ba):null}oai(b,h,r){var A;if(!this.lcd(r-1))return null;const {T8j:L,S8j:ba}=this.Dwp(b,h);return 0===L.length?null:(h=null===(A=rd.ParagraphReader.Nbe(b,L))||void 0===A?void 0:A.trim())&&""!=h?new zB(ba.Kd,ba.endCp,h,b,null,r):null}nTm(b,h,r){const A=[];let L={linkedStyle:null,
wy:null},ba=null,ra=null;for(const Ia of b)if(ba=Ia.q8.formatting?this.zBm(h,Ia.q8):ba,b=r(Ia)){if(!ra&&b){ra=ba;if(!ra)break;L=ba}else if(!this.Qrn(ba,ra))break;A.push(Ia)}return{s6m:A,hgm:L}}Dwp(b,h){var r;let A=-1,L;for(L=0;L<h.length;L++){var ba=h[L],ra=b.characterData.substring(ba.q8.cp,ba.cpEnd),Ia=null===ra||void 0===ra?void 0:ra.trimStart();if(Ia){A=ba.q8.cp+(ra.length-Ia.length);break}}if(-1===A)return{T8j:[],S8j:{Kd:-1,endCp:-1}};ba=-1;for(ra=h.length;0<ra;ra--){Ia=h[ra-1];const Ta=b.characterData.substring(Ia.q8.cp,
Ia.cpEnd),ob=null===Ta||void 0===Ta?void 0:Ta.trimEnd();if(ob){ba=Ia.cpEnd-(Ta.length-ob.length);break}}return{T8j:null!==(r=h.slice(L,ra))&&void 0!==r?r:[],S8j:{Kd:A,endCp:ba}}}Qrn(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.oUb===b.linkedStyle.oUb||h.wy&&b.wy&&h.wy.N5h==b.wy.N5h?!0:!1}zBm(b,h){h=pb.a.Wua(h.formatting);b=this.BBm(b,h);h=this.yBm(h);return b||h?{linkedStyle:b,wy:h}:null}BBm(b,h){b=this.Ge.ytb(h,b);if(!b)return null;h=b.ka(Rc.a.jk,
9);return this.SYj(h)?{Seq:b.id,oUb:h+1}:null}yBm(b){var h;b=this.Ge.Je(b);if(!b||!Wj.a.m9i(b))return null;const r=null!==(h=Wj.a.l6c(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.lcd(h-1)?{N5h:b,oUb:h}:null}pCn(b){const h=rd.ParagraphReader.yna(b);if(!this.lcd(h))return!1;if(this.SYj(h))return!0;b=this.Ge.Lr(b);b=this.Ge.Je(b);return Wj.a.asc(b)?!0:!1}SYj(b){return this.JVi&&this.lcd(b)}lcd(b){return b>=this.Mtc&&b<=this.TDc}}Object(u.a)(Gx,"StyleBasedDocumentHeadings",null,[560]);
var jF=e(1012);class nK{constructor(){this.startTime=0}}Object(u.a)(nK,"TocCallbackData",null,[]);class Vu{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.oQg=(Eb,bc,Bc)=>{const Yc=bc.node;if(!Yc)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==Yc.type)return v.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!Yc.pr)return 2;if(1===Bc)return id.SessionStatusManager.instance.zk?8:32;this.Qd&&
this.Qd.isFeatureEnabled(113)?this.HTc.sEp(Yc).then(zd=>{zd||this.oek(Yc)}):this.oek(Yc);return 32};this.LIp=Eb=>{Eb=window.performance.now()-Eb.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",Eb));Eb=Object.assign(new Sa.a,{durationMs:Eb});Ca.Health.instance.recordKpiSuccess(Vu.nik,Eb);Vu.Khb()};this.kYi=(Eb,bc,Bc,Yc,zd)=>{if(rd.ParagraphReader.lc(bc.node)&&bc.node.pr)return 2;if(1===Bc)return id.SessionStatusManager.instance.zk?8:32;if(bc.contextId!==ic.a.kd||
this.sm.cda(bc)||!rd.ParagraphReader.lc(bc.node))return 32;this.me.Vv(17);(null===zd||void 0===zd?0:zd.resolve)?this.HTc.Fdi(bc,zd.resolve):this.HTc.Fdi(bc);return 32};this.gwg=(Eb,bc,Bc)=>{Eb=bc.node;if(!Eb)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Eb.type)return v.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!Eb.pr)return 2;if(1===Bc)return id.SessionStatusManager.instance.zk?
8:32;Bc=null;Eb.isConnected&&(Bc=jF.a.Omc(Eb,!0),Bc.eDc(Eb));bc=new te.a;bc.set(Eb);bc.Ib(8);bc.xd(8);const Yc=this.Zc.Vc(15);Yc.nw(bc);this.HTc.uGo(Eb)?(Yc.dispose(),Bc&&Bc.normalize(),Vu.Khb()):(Bc&&Bc.cancel(),Yc.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.tAd=h;this.td=A;this.Zc=L;this.sm=ba;this.HTc=ra;this.me=Ia;this.Qd=Ta;this.Coh=ob;this.rQ=nb}mc(){this.ga.qa(fb.a.Z4b,ic.a.paragraph,this.oQg);this.ga.qa(fb.a.Z4b,ic.a.Nd,this.oQg);this.ga.qa(fb.a.Z4b,
ic.a.kd,this.oQg);this.ga.Oc(fb.a.Z4b,1028);this.ga.qa(Lc.a.xZf,ic.a.kd,this.kYi);this.ga.Oc(Lc.a.xZf,1028);this.ga.qa(Lc.a.fod,ic.a.paragraph,this.gwg);this.ga.qa(Lc.a.fod,ic.a.Nd,this.gwg);this.ga.qa(Lc.a.fod,ic.a.kd,this.gwg);this.ga.Oc(Lc.a.fod,1028)}oek(b){Ca.Health.instance.recordKpiUsage(Vu.nik,1,Vu.GB,null);const h=this.Som(b),r=new nK;r.startTime=window.performance.now();this.tAd.FRj(h,Rc.a.tPg,this.DWm(this.AKm(b)),this.LIp,null,r);this.HTc.Xul()}hnk(b){if(null!=b&&b.pr)if(null==this.Coh.instance)v.ULS.sendTraceTag(539628835,
3019,10,"Page Number Finder instance is null.");else{var h=this.Coh.instance.HIi();b=this.Pem(b);var r=!1;1===this.rQ.vz&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ma.a,{name:"TOCPageNo",string:b}),Object.assign(new ma.a,{name:"HeadingPageNo",string:h}),Object.assign(new ma.a,{name:"isMainView",string:r})],$d.a("TOCPageNoMismatch",!0,void 0,h))}}Pem(b){for(let h=0;h<b.ra.length;h++){const r=b.ra.jc(h);if(null!=r.Fc)for(let A=0;A<r.Fc.length;A++){const L=r.Fc.K(A);if(1===L.ze&&L.rZ.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,
b.characterData.length-r.cp))}}return 0}AKm(b){return b?b.ka(Rc.a.XR,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Som(b){return this.td.Gua(b,7,7).ic(35)}DWm(b){const h=[];h.push(b+",TOC,0");return h}static Khb(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
Vu.tCa)}}Vu.tCa=5E3;Vu.nik="WordUpdateTOC";Vu.GB="wwaengidc";Object(u.a)(Vu,"TableOfContentsActor",null,[559]);class mD{}Object(u.a)(mD,"FieldData",null,[]);class oK extends mD{constructor(){super();this.nCb=null}}Object(u.a)(oK,"TOCFieldData",mD,[]);class Xz{constructor(b,h,r,A,L,ba=null){this.u6m=b;this.Wv=h;this.Ft=r;this.G3j=A;this.listMarker=L;this.cwa=ba}}Object(u.a)(Xz,"TOCHeadingData",null,[]);class Yz{constructor(b,h){this.W4a=b;this.Tp=h}async sEi(b){this.W4a.JVi=b.QXf;this.W4a.Mtc=b.Mtc;
this.W4a.TDc=b.TDc;return this.W4a.CBm()}Dpm(b){if(b=this.Cpm(b))return this.Tp.XCa(b)}Cpm(b){const h=b.ra.length;for(let r=0;r<h;r++){const A=b.ra.jc(r);if(A.hyperlink&&A.hyperlink.aoa&&A.hyperlink.url.startsWith(D.a.K8a))return A.hyperlink.url.substr(A.hyperlink.url.indexOf("_Toc"))}return null}yxe(b){(b=this.Dpm(b))&&this.Tp.ghg(b.id)}oTm(){return this.W4a.qEi()}wAj(b,h){const r=new oK,A=new Cb.a;for(const L of b){b=this.mTm(L,h);if(!b)return null;A.add(b)}r.nCb=A;return r}mTm(b,h){let r;if(h&&
(r=this.eKl(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=wm.AParagraphNode.DR(b.characterData.trim());const A=this.iVm(b.oUb);return new Xz(h,r,b.Ft,A,b.listMarker,b.cwa)}eKl(b){const h=String.format("{0}{1}","_Toc",of.a.BG());return this.Tp.Eec(h,b.Mc,b.end,b.paragraphNode,b.paragraphNode)?h:null}iVm(b){return String.format("toc {0}",b)}}Object(u.a)(Yz,"TOCDataManager",null,[558]);class Zz{dHg(){const b=Object.assign(new wg.StandardDialog,
{hv:y.AFrameworkApplication.Uha,Md:0,tGa:!1});b.YW(1);b.Rxa(WacWordeditorStrings.EmptyTOCDialogTitle,WacWordeditorStrings.EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Zz.N2g?Zz.N2g:Zz.N2g=new Zz}}Object(u.a)(Zz,"TOCDialogHelper",null,[]);var pK=e(177),$z=e(519),kF=e(154);class lF{constructor(b,h,r,A,L,ba,ra){this.eHg=b;this.Rvb=h;this.QXf=r;this.Mtc=A;this.TDc=L;this.FMb=ba;this.iwd=[];this.rZ=ra}toString(){return"showPageNumber:"+this.eHg+"  isHyperlink:"+this.Rvb+" includeOutlineLevels:"+
this.QXf+" lowerOutlineLevel:"+this.Mtc+" upperOutlineLevel:"+this.TDc+" addContentControl:"+this.FMb+" unsupportedSwitches:"+this.iwd.toString()}}Object(u.a)(lF,"TOCSettings",null,[]);class fj{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re){this.Csh="TOC";this.isb=this.dSe=this.Rdf=null;this.xhb=b;this.ni=h;this.VG=r;this.Gr=A;this.Vk=L;this.sm=ba;this.pb=ra;this.ee=Ia;this.BNh=Ta;this.Pe=ob;this.Odf=nb;this.gr=bc;this.sQ=Bc;this.Hp=Yc;this.Zc=zd;this.Sb=Jd;this.Lh=ie;this.qb=re}get bad(){return this.Csh}set bad(b){this.Csh=
b}get oCb(){this.Rdf||(this.Rdf=this.WBi());return this.Rdf}WBi(){return new lF(!0,!0,!0,0,8,!0,this.Bmo())}async Fdi(b,h){$d.a(fj.oRl);const r=window.performance.now();if(this.qb.lc(b.node))if(this.sm.cda(b))v.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),fj.H_a("IP is in locked range");else{var A=await this.xhb.sEi(this.oCb);if(A){var L=new Md.a(2,1,0,()=>{this.qRl(b,A,this.oCb.Rvb,r);h&&h()});this.Sb.pc(L)}else v.ULS.sendTraceTag(592233795,
3019,10,"Failed to create table of contents."),fj.H_a("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),fj.H_a("Context should be paragraph")}qRl(b,h,r,A=0){let L;try{if(0==A&&(A=window.performance.now()),this.Fsi(b.node)){var ba=new te.a;ba.set(b.node);ba.Ib(7);ba.xd(7);L=this.Zc.Vc(15);L.nw(ba);var ra=this.xhb.wAj(h,r);ra||fj.H_a("Failed to prepare TOC Field data");var Ia=ra.nCb?ra.nCb.count:0;if(Ia){h=
null;var Ta;for(r=0;r<Ia;r++){const bc=ra.nCb.K(r);if(!({IPb:Ta}=this.gYi(b,h,r,Ia,bc,nb?nb.toString():void 0)).returnValue){fj.H_a("Failed to populate new TOC paragraph");return}if(0==r){var ob=Ta.currentNode;var nb=rd.ParagraphReader.fW(ob)}h=Ta}if(this.oCb.FMb&&!this.Svf(ob.id,h.Jr.id))fj.H_a("Failed to add content control block");else{var Eb=window.performance.now()-A;$d.a(fj.oxf,!0,Eb)}}else if(this.Odf.dHg(),this.ELl(b)){const bc=window.performance.now()-A;$d.a(fj.oxf,!0,bc)}}else fj.H_a("Failed to fetch style set")}catch(bc){fj.H_a(String.format("{0} {1}",
bc.message,bc.stack))}finally{L&&L.dispose()}}Fsi(b){this.dSe=this.Vk.pG(b);return this.dSe?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static rOa(b){b=[Object.assign(new ma.a,{name:fj.JIp,string:b})];$d.a(fj.qQg,!1,void 0,b)}static q$f(b){b=[Object.assign(new ma.a,{name:fj.eIo,string:b})];$d.a(fj.kJj,!1,void 0,b)}static H_a(b){b=[Object.assign(new ma.a,{name:fj.pRl,string:b})];$d.a(fj.oxf,!1,void 0,b)}async sEp(b){const h=this.ZMi(b);if(null==h)fj.rOa("Cannot update TOC when firstTocPara = null");
else{var r=this.qTm(h);if(0<r.iwd.length)return this.kOn(r.iwd),!1;$d.a(fj.IIp);var A=window.performance.now(),L=await this.xhb.sEi(r);if(!L)return v.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),fj.rOa("Failed to fetch TOC data"),!1;b=new Md.a(1,1,0,()=>{this.KIp(h,L,r,A)});this.Sb.pc(b);return!0}}KIp(b,h,r,A=0){let L;try{if(null==b)fj.rOa("Attempt to update TOC when firstTocPara = null");else{0==A&&(A=window.performance.now());var ba=new te.a;ba.set(b);ba.Ib(7);ba.xd(7);
L=this.Zc.Vc(15);L.nw(ba);var ra=this.xhb.wAj(h,r.Rvb);if(null==ra)fj.rOa("Attempt to update TOC when tocFieldData = null");else{var Ia;if(({Pqf:Ia}=this.FIj(b,r)).response){v.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var Ta=ra.nCb?ra.nCb.count:0;if(this.Fsi(b)){var ob;this.y5i(b)&&(this.jJj(b),(b=this.qb.Cg(b,!1,!0))&&(ob=b.ka(Rc.a.qd,null).toString()));var nb=b.ka(Rc.a.XR,null);h=nb;ob=null!==ob&&void 0!==ob?ob:nb;if(Ta){for(var Eb=
0,bc;b.pr&&h==nb&&Eb<Ta;){const zd=ra.nCb.K(Eb);r.Rvb&&this.xhb.yxe(b);if(!this.lIp(b,Eb,Ta,zd,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");fj.rOa("Failed to update TOC paragraph");return}b.setValue(Rc.a.XR,ob);Eb++;bc=b;b=this.qb.Cg(bc,!1,!0);if(!b){h=null;break}this.G5i(b)&&this.iJj(b);h=b.ka(Rc.a.XR,null)}h==nb&&this.Uvg(b);var Bc;if(({Ydd:Bc}=this.k4k(ra,Eb,Ta,bc,ob)).response)if(r.FMb&&!this.Svf(Ia,Bc.id))fj.rOa("Failed to add content control block");else{var Yc=
window.performance.now()-A;$d.a(fj.qQg,!0,Yc)}else fj.rOa("Failed to add new paragraph")}else this.Odf.dHg(),this.FIp(b,r.FMb,Ia,r.rZ,ob)&&(Eb=window.performance.now()-A,$d.a(fj.qQg,!0,Eb))}else fj.rOa("Failed to fetch style set")}else fj.rOa("Failed to remove Content Control")}}}catch(zd){fj.rOa(String.format("{0} {1}",zd.message,zd.stack))}finally{L&&L.dispose()}}k4k(b,h,r,A,L){let ba=new te.a;for(ba.set(A);h<r;){A=b.nCb.K(h);if(!({IPb:A}=this.gYi(null,ba,h,r,A,L)).returnValue)return{Ydd:ba.currentNode,
response:!1};ba=A;h++}return{Ydd:ba.currentNode,response:!0}}FIj(b,h){var r;let A,L;const ba=null===(r=null===b||void 0===b?void 0:b.ra)||void 0===r?void 0:r.first.Qb;if(ba&&0<ba.length)if(b=b.ra.first.Qb.K(0),b.Pg){r=b.je.getValue(Rc.a.yy);A=this.Lh.Ds(b.je.id,!0);L=this.Lh.Ds(b.je.id,!1);if(0!=this.gr.J0b(r))return v.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,Pqf:A,k5h:L};h.FMb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),
h.FMb=!1;else h.FMb=!1;return{response:!0,Pqf:A,k5h:L}}FIp(b,h,r,A,L){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.xhb.yxe(b);const ba=this.b9d(b);if(!this.zzj(ba,h,r,A))return fj.rOa("Failed to populate empty TOC."),!1;if(h=this.qb.Cg(b,!1,!0))r=b.ka(Rc.a.XR,null),A=h.ka(Rc.a.XR,null),r==A&&this.Uvg(h);b.setValue(Rc.a.XR,L);return!0}zzj(b,h,r,A){this.ee.lf(b,WacWordeditorStrings.EmptyTOCText);b=b.node;this.xkj(b);const L=b.ra.first;this.Pe.GP(L.formatting,!0);this.bwf(b,
0,1,A);L.jFg&&b.Bf.rU(L.formatting.Re);return h&&r&&!this.Svf(r,b.id)?!1:!0}b9d(b){b.ra.reset();b.mWa();const h=new pK.a(b,0);h.formatting=new kF.a(h,V.a.nil);h.Ui=!0;b.ra.add(h);return vc.a.createTextRange(b,0,b.characterData.length)}y5i(b){if(rd.ParagraphReader.MT(b)){var h=b.ra.last.Fc;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.K(h.length-4).ze;const r=1===h.K(h.length-3).ze&&h.K(h.length-3).rZ.trim().startsWith(this.bad),A=2===h.K(h.length-2).ze;h=5===h.K(h.length-1).ze;return b&&r&&A&&
h}}return!1}G5i(b){if(rd.ParagraphReader.MT(b)){var h=b.ra.first.Fc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.K(0).ze,h=3===h.K(1).ze,b&&h}return!1}jJj(b){const h=b.ra.last.Fc,r=h.K(h.length-4),A=h.K(h.length-3),L=h.K(h.length-2),ba=h.K(h.length-1);h.aO(r);h.aO(A);h.aO(L);h.aO(ba);b.removeProperty(Rc.a.XR)}iJj(b){const h=b.ra.first.Fc,r=h.K(0),A=h.K(1);h.aO(r);h.aO(A);b.removeProperty(Rc.a.XR)}Uvg(b){if(b){var h=b.ka(Rc.a.XR,null),r=b.ka(Rc.a.qd,null).toString(),A=h;r==h&&this.y5i(b)&&
(this.jJj(b),(b=this.qb.Cg(b,!1,!0))&&(A=b.ka(Rc.a.XR,null)));r=new te.a;r.set(b);r.Ib(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var L;b&&b.pr&&A==h&&L!=b;){if(this.G5i(b)){this.iJj(b);break}this.xhb.yxe(b);this.Hp.xe(r);A=this.Hp.Fu(r,!1,!0);this.ni.hxa(b);if(!A)return null;L=b;r.ic(2);A=(b=r.currentNode)?b.ka(Rc.a.XR,null):null}return b}}qTm(b){var h=b.ra,r=h?h.length:0,A=null;b=new lF(!0,!1,!1,0,8,!0,void 0);for(let L=0;L<r&&(A=this.pTm(h.jc(L)),b.rZ=A,
A=this.kQm(A),A[0]!==this.bad);L++);h=A?A.length:0;for(r=1;r<h;r++)switch(A[r]){case "\\h":b.Rvb=!0;break;case "\\u":b.QXf=!0;break;case "\\o":this.L3o(A[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.eHg=!1;b.iwd.push(A[r]);break;default:b.iwd.push(A[r])}return b}L3o(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.Mtc=Number.parseInvariant(b[1])-1,h.TDc=Number.parseInvariant(b[2])-1,!0):!1}uGo(b){try{$d.a(fj.dIo);const h=window.performance.now(),r=this.ZMi(b);if(null==
r){fj.q$f("Attempt to remove TOC when firstTocPara = null");return}let A,L,ba;const ra=this.WBi();if(!({Pqf:A,k5h:L}=this.FIj(r,ra)).response)return fj.q$f("Failed to remove content control"),!1;if(void 0==A&&void 0==L)ba=this.Uvg(r);else{ba=r.ed.Mb(A);const Ta=new te.a;Ta.set(ba);Ta.Ib(8);b=!1;let ob;for(;!b&&ba&&ob!=ba;){ba.id.equals(L)&&(b=!0);ba&&ba.pr&&this.xhb.yxe(ba);this.Hp.xe(Ta);const nb=this.Hp.Fu(Ta,!1,!0);this.ni.hxa(ba);if(!nb){ba=null;break}Ta.ic(2);ob=ba;ba=Ta.currentNode}}ba&&this.Ogd(ba);
const Ia=window.performance.now()-h;$d.a(fj.kJj,!0,Ia)}catch(h){fj.q$f(String.format("{0} {1}",h.message,h.stack))}return!0}Ogd(b){b=vc.a.jd(b,0);b=new Fl.Selection([b],!0);this.pb.Uc(b)}Svf(b,h){return this.gr.Msa(b,h,null,fj.pmi,!0,11).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}Xul(){this.xhb.oTm()||this.Odf.dHg()}ZMi(b){if(!b.pr)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),
null;b=b.ka(Rc.a.XR,null);return this.sQ.OKm(b)}kOn(b){b.length&&(b=[Object.assign(new ma.a,{name:"UnsupportedSwitches",string:b.toString()})],$d.a("UnsupportedTocInstruction",void 0,void 0,b))}pTm(b){const h=(b=b.Fc)?b.length:0;for(let r=0;r<h;r++)if(1===b.K(r).ze&&b.K(r).rZ.trim().startsWith(this.bad))return b.K(r).rZ.trim();return null}kQm(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}ELl(b){b=this.ffi(b,null,!0,void 0).returnValue;if(!b)return fj.H_a("Failed to create paragraph"),
!1;const h=vc.a.jd(b,0);if(!this.zzj(h,!0,b.id,this.oCb.rZ))return fj.H_a("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}ffi(b,h,r,A){let L,ba;r&&b?(L=this.VLl(b),ba=L.currentNode,A=rd.ParagraphReader.fW(ba).toString()):h&&(L=this.PHm(h),ba=this.ni.dN(L));if(!ba)return v.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,IPb:L};ba.setValue(Rc.a.XR,A);return{returnValue:ba,
IPb:L}}Bmo(){const b=new Sys.StringBuilder(this.bad);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}Qmo(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.oCb.Rvb&&h.append(" \\h");return h.toString()}PHm(b){b.Wd();this.Hp.xe(b);return this.ni.kva(b,!1)}VLl(b){const h=new te.a;h.set(b.node);h.Wd();this.Hp.xe(h);let r=this.BHi(h);const A=!b.cpBegin;if(Mb.a.isEmpty(h,!0))return this.SXi(r);if(A)return this.ni.mA(r,!0,!1),this.ni.wea(h,r,b,!1,!1,!1),b=this.BHi(r),this.SXi(b);
r=this.ni.kva(h);this.ni.wea(h,r,b,!1,!1,!0);b=this.ni.kva(h);this.ni.u2b(b.currentNode,!1);this.ni.dN(b);this.Hp.Ze(b);return b}BHi(b){const h=new te.a;h.Ad(b);h.Wd();return h}SXi(b){this.ni.mA(b,!0,!0);this.ni.u2b(b.currentNode,!1);this.Hp.Ze(b);return b}xkj(b){const h=b.ra;1===h.length&&(h.first.Ui=!1,b.N4d().Ui=!0)}lIp(b,h,r,A,L){const ba=this.b9d(b);this.ee.lf(ba,"");this.Gzj(b,A,L);this.bwf(b,h,r,L.rZ);return L.Rvb&&!this.SJ(b,A.Wv)?!1:!0}gYi(b,h,r,A,L,ba){h=({IPb:b}=this.ffi(b,h,0==r,ba)).returnValue;
if(!h)return{returnValue:!1,IPb:b};this.Gzj(h,L,this.oCb);this.bwf(h,r,A,this.oCb.rZ);return this.oCb.Rvb&&!this.SJ(h,L.Wv)?{returnValue:!1,IPb:b}:{returnValue:!0,IPb:b}}Gzj(b,h,r){this.Ygn(b,h.u6m,h.listMarker,h.G3j,h.cwa);this.BNh.Gin(b,b.characterData.length);r.eHg&&this.Rhn(b,h);this.xkj(b);this.k6o(b,h.G3j)}rFm(b,h){if(!b)return 0;const r=fj.jVm();return 4<b.length?r.K(h)+.5*Math.floor(b.length/3):r.K(h)}Ygn(b,h,r,A,L){r&&this.phn(b,r,A);r=vc.a.jd(b,b.characterData.length);this.ee.lf(r,h);L&&
(b=b.ra.Vh(0),this.Pe.rja(b.formatting,L))}phn(b,h,r){r=this.rFm(h,r);const A=vc.a.jd(b,0);this.ee.lf(A,h);this.BNh.qhn(b,h.length,r)}Rhn(b,h){var r=vc.a.jd(b,b.characterData.length);this.ee.lf(r,h.Ft.toString());r=b.ra.Vh(b.characterData.length-h.Ft.toString().length);h=this.Qmo(h.Wv);this.gZa(b,r,0,2,h);this.gZa(b,r,1,2,h);this.gZa(b,r,2,2,h);r=b.ra.Vh(b.characterData.length);this.gZa(b,r,3,2,h)}k6o(b,h){h=this.dSe.Qg(h);this.Gr.IP(h,b,!0)}bwf(b,h,r,A){const L=b.ra.first,ba=b.ra.last;h?this.gZa(b,
L,4,1,A):(this.gZa(b,L,0,1,A),this.gZa(b,L,1,1,A),this.gZa(b,L,2,1,A));h===r-1?this.gZa(b,ba,3,1,A):this.gZa(b,ba,5,1,A)}gZa(b,h,r,A,L=null){r=new $z.a(h,null,r,A,!0,!1,!1,L);h.Fc||h.aZa();h.Fc.Osa(r);b.eo();this.TRl(r,b)}TRl(b,h){b.Re?h.Bf.pZ(b.Re-1,2):h.Bf.iva(b.Re,2);h.Bf.rU(b.Re)}SJ(b,h){b=vc.a.createTextRange(b,0,b.characterData.length);return this.VG.SJ(b,h,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static jVm(){fj.QAa||
(fj.QAa=new kb.a,fj.QAa.W("toc 1",1),fj.QAa.W("toc 2",1.5),fj.QAa.W("toc 3",2),fj.QAa.W("toc 4",2.5),fj.QAa.W("toc 5",3),fj.QAa.W("toc 6",3.5),fj.QAa.W("toc 7",4),fj.QAa.W("toc 8",4.5),fj.QAa.W("toc 9",5));return fj.QAa}}fj.QAa=null;fj.pmi="Table of Contents";fj.oRl="CreateTocClient";fj.oxf="CreateTocSuccess";fj.pRl="CreateTocFailureCause";fj.IIp="UpdateTocClient";fj.qQg="UpdateTocSuccess";fj.JIp="UpdateTocFailureCause";fj.dIo="RemoveTocClient";fj.kJj="RemoveTocSuccess";fj.eIo="RemoveTocFailureCause";
Object(u.a)(fj,"TOCField",null,[467,468]);var AB=e(646);class qK{constructor(b,h){this.WHa=b;this.aSa=h}Gin(b,h){if(rd.ParagraphReader.lc(b)&&!(0>h)){var r=Ap.a.Hgc(b);r=new AB.a(r,4,1,1);this.WHa.pfe(b,r);b=vc.a.jd(b,h);this.aSa.Cfe(b)}}qhn(b,h,r){var A=Qa.a.AL/2;const L=b.ra.ptb(h);A=pb.a.rh(L.formatting,Sb.a.fontSize,2*A)/2;r=new AB.a(fg.a.pF(A/36)*r,1,0,1);this.WHa.pfe(b,r);b=vc.a.jd(b,h);this.aSa.Cfe(b)}}Object(u.a)(qK,"TOCTabUtility",null,[463]);class nD{constructor(){this.Z=null}get name(){return"WordEditor.TableOfContents"}Ec(b){this.Z=
b;this.Z.ja("WordEditor.AutoSaveParamsUpdateService",()=>new ZL.a(this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),Pw.a.rT)).ha();this.Z.ja("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new Gx(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),Object(ao.a)(),this.Z.resolve("Box4.Styles.IWACStyleReader"),this.Z.resolve("Box4.List.IListReader"),this.Z.resolve("Box4.IListMarkerUtility"),new Bi.a)).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.Z.ja("WordEditor.TableOfContents.TOCDataManager",
()=>new Yz(this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.Z.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();this.Z.ja("WordEditor.TableOfContents.TOCTabUtility",()=>new qK(this.Z.resolve("WordEditor.ICustomTabStopUtility"),this.Z.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.Z.ja("WordEditor.TableOfContents.TOCField",()=>new fj(this.Z.resolve("Box4.ITOCDataManager"),this.Z.resolve("Box4.IOutlineElementEditor"),
this.Z.resolve("Box4.IHyperlinkEditor"),this.Z.resolve("Box4.Styles.IWACStyleEditor"),this.Z.resolve("Box4.Styles.IWACStyleReader"),Ke.a.instance,this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("Box4.ICharacterPropertiesEditor"),this.Z.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.Z.resolve("Box4.IFormattingEditor"),Zz.instance,this.Z.resolve("Box4.IFeatureHelper"),this.Z.resolve("WordEditor.ContentControl.IContentControlManager"),this.Z.Wa("WordEditor.ParagraphWordIdMapping"),
this.Z.resolve("Box4.IOutlineElementNavigator"),gm.a.instance,y.AFrameworkApplication.zc,this.Z.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();this.Z.ja("WordEditor.TableOfContents.TableOfContentsActor",()=>new Vu(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.AutoSaveParamsUpdateService"),this.Z.resolve("Box4.IOutlineElementEditor"),this.Z.resolve("Box4.Graph.IGraphIteratorFactory"),gm.a.instance,Ke.a.instance,
this.Z.resolve("WordEditor.TableOfContents.ITOCField"),this.Z.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.Z.resolve("Box4.IFeatureHelper"),this.Z.Za("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.Z.resolve("WordEditor.TableOfContents.ITableOfContentsActor").mc()}dispose(){}}Object(u.a)(nD,"PackageManager",null,[0,1]);class pp{constructor(b,h,r,A,L,ba,ra,Ia){this.e1a=(Ta,
ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!0,!0)).returnValue)return Ta;this.qRd.oei(bc,ob.node);return 32};this.AFa=(Ta,ob,nb,Eb,bc)=>this.URi(ob,nb,Eb,bc,!0);this.l_b=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!1,!0)).returnValue)return Ta;this.qRd.RNl(bc,ob.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Ysa=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Eb}=this.iBb(ob,nb,bc,!1,!0)).returnValue)return 2==nb&&8==Eb&&oo.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],
uf.a.lRb),Eb;const Bc=ob.node;let Yc=null;(Yc=Ta===fb.a.Ysa?this.qRd.C5b(bc[bg.a.SourceControlId],Bc):this.KA.xbe(Bc,bc))?(this.tte(Bc,()=>{this.kTd.z2b(Yc,Bc)}),this.UK(),Eb=32):(oo.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],uf.a.lRb),Eb=8);Ta===fb.a.Ysa&&32===Eb&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,324,32===Eb);return Eb};this.pBa=(Ta,ob,nb,Eb,bc)=>this.URi(ob,nb,Eb,bc,!1);this.EFe=(Ta,ob,nb,Eb,bc)=>Bp.a.Nwa(Ta,
ob,nb,Eb,bc,{},14);this.wOb=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!1,!1)).returnValue)return Ta;const Bc=ob.node;this.tte(Bc,()=>{this.kTd.Myl(Bc)});return 32};this.KA=b;this.qRd=h;this.ga=r;this.kTd=A;this.Zc=L;this.pD=ba;this.tIk=Ia}mc(){this.Nxc(Ze.a.Z2a.Pdi())}Nxc(b){this.ga.qa(fb.a.e1a,ic.a.view,b);this.ga.qa(fb.a.e1a,ic.a.table,this.e1a);this.ga.Oc(fb.a.e1a,1127);this.ga.qa(fb.a.Ysa,ic.a.view,this.EFe);this.ga.qa(fb.a.Ysa,ic.a.table,this.Ysa);this.ga.Oc(fb.a.Ysa,1030);this.ga.qa(fb.a.FQ,
ic.a.table,this.Ysa);this.ga.qa(fb.a.pBa,ic.a.view,this.EFe);this.ga.qa(fb.a.pBa,ic.a.table,this.pBa);this.ga.Oc(fb.a.pBa,1038);this.ga.qa(fb.a.AFa,ic.a.view,b);this.ga.qa(fb.a.AFa,ic.a.table,this.AFa);this.ga.Oc(fb.a.AFa,1127);this.ga.qa(fb.a.l_b,ic.a.view,b);this.ga.qa(fb.a.l_b,ic.a.table,this.l_b);this.ga.Oc(fb.a.l_b,1126);this.ga.qa(fb.a.wOb,ic.a.view,this.EFe);this.ga.qa(fb.a.wOb,ic.a.table,this.wOb);this.ga.Oc(fb.a.wOb,1028)}UK(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}URi(b,h,r,A,L){if(!({xB:ba}=this.iBb(b,h,A,L,!0)).returnValue)return 2==h&&8==ba&&oo.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],uf.a.ebm),ba;b=b.node;h=this.KA.Q4(b);var ba=A[bg.a.On];const ra=pp.KTm(A.MenuItemId);L?A[bg.a.On]=pp.mbp(h,ra):(this.Tel(h,ra,ba,b),r.Av=
ra,r.hG=ba?0:1,v.ULS.shipAssertTag(0,324,!!ra));return 32}tte(b,h){const r=this.Zc.Vc(15);try{r.Eb(b),this.pD.Yzb(),h()}finally{r&&r.dispose()}}iBb(b,h,r,A,L){return this.tAn(b,h,r,A,L)?{returnValue:A||2===h,xB:32}:{returnValue:!1,xB:8}}tAn(b,h,r,A,L){if(b.contextId!==ic.a.table)return!1;if(A||2===h)if(L&&!r||!Object(Pb.a)(Yv.a,b.node)||this.tIk(b.node))return!1;return!0}Tel(b,h,r,A){const L=(512===h||1024===h?!r:r)?b|h:b&~h;L!==b&&this.tte(A,()=>{this.kTd.oGa(L,A)})}static NG(){pp.Enb[pp.$fm]=32;
pp.Enb[pp.Qfm]=128;pp.Enb[pp.MEn]=64;pp.Enb[pp.BEn]=256;pp.Enb[pp.Cil]=512;pp.Enb[pp.Bil]=1024}static mbp(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static KTm(b){let h=0;b in pp.Enb&&(h=pp.Enb[b]);return h}}pp.$fm="buttonFirstRow";pp.Qfm="buttonFirstColumn";pp.MEn="buttonLastRow";pp.BEn="buttonLastColumn";pp.Cil="buttonBandedRow";pp.Bil="buttonBandedColumn";pp.Enb={};Object(u.a)(pp,"TableStyleActor",null,[]);pp.NG();var BB=e(424);class mF extends BB.a{constructor(){super();this.TableStyles=
this.TableCellStyles=null;this.columns=0}}Object(u.a)(mF,"TableGalleryButtonProps",BB.a,[]);class Wu extends mF{constructor(){super()}get Type(){return 6}}Object(u.a)(Wu,"TableStyleGalleryButtonProps",mF,[]);class nF{}nF.uZn=2147483647;Object(u.a)(nF,"TableStyleUtil",null,[]);class xt{constructor(b,h,r){this.bsf="Clear";this.iRb=null;this.LVk=b;this.Ge=h;this.KA=r;this.Q1=y.AFrameworkApplication.Q1;this.mr=y.AFrameworkApplication.mr}I$a(){}X1k(b,h){this.I$a(b);const r=this.kyi(b),A=r.length;if(!(0>=
A)){var L=nF.uZn,ba=null;for(let Ta=0;Ta<A;Ta++){var ra=r[Ta],Ia=this.KA.$Tm(ra);L!==Ia&&(L=Object.assign(new Zd.a,{Id:"msMoreTableStyles"+Ia,Title:this.aUm(Ia),ControlList:[]}),ba=Object.assign(new Ul.a,{Type:6,Id:"galleryMoreTableStyles"+Ia,ExternalGalleryId:"TableStylesGallery",Width:xt.BJg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.iRb&&(ba.ExternalId=this.iRb[Ia.toString()]),L.ControlList.push(ba),h.MenuSectionList.push(L),L=Ia);Ia=this.Ge.ML(ra);ra=xt.WKg+Ta;Ia=Object.assign(new Wu,
{Id:ra,ExternalId:ra,Command:fb.a.Ysa.toString(),QueryCommand:fb.a.e1a.toString(),LabelText:Ia?D.a.Mf(Ia):"",Alt:Ia,VerticalCenterAlign:"true"});Ia.TableCellStyles=this.Dbe(ra,b);Ia.TableStyles=this.D7c(ra,b);ba&&ba.GalleryItems.push(Ia)}}}V1k(b){const h=Object.assign(new Zd.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),r=Object.assign(new qg.a,{Id:"fseaClearTableFormatting",Command:fb.a.wOb.toString(),LabelText:D.a.Mf(this.bsf),Alt:D.a.Mf(this.bsf),
Image16by16:this.mr,Image16by16Class:Ye.getImageClassWithCluster(this.Q1,xt.Lyl),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}oei(b,h){this.I$a(h);const r=b[bg.a.SourceControlId];var A=this.C5b(r,h);if(A){var L=this.KA.VI(h);L=L?this.Ge.Je(L):null;var ba=this.Ge.ML(A);A=this.Ge.Je(A);b[Pf.a.Alt]=ba;b[Pf.a.On]=A===L;h=Object.assign(new Wu,{Id:r,ExternalId:r,Command:fb.a.Ysa.toString(),QueryCommand:fb.a.e1a.toString(),TableCellStyles:this.Dbe(r,
h),TableStyles:this.D7c(r,h),Alt:ba});b[Pf.a.GalleryButtonProps]=h}else b[Pf.a.InnerHTML]=null,b[Pf.a.Alt]=null,b[Pf.a.On]=!1,b[Pf.a.GalleryButtonProps]=null}Dbe(b,h){this.I$a(h);return(b=this.C5b(b,h))?this.LVk.Lzi(b,h):null}D7c(b,h){this.I$a(h);return this.C5b(b,h),null}RNl(b,h){b.MenuItems=this.jHm(h)}jHm(b){const h=Object.assign(new dk.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.X1k(b,h);this.V1k(h);return h}C5b(b,h){return b?b.startsWith(xt.WKg)?this.$Sf(parseInt(b.substr(xt.WKg.length)),
h):this.LOo(parseInt(b.substr(xt.Lpp.length)),h):null}}xt.WKg="buttonTableStyleMenu";xt.Lpp="buttonTableStyleRibbon";xt.BJg=7;xt.Lyl="ClearTableStyle_16x16x32";Object(u.a)(xt,"ATableStyleRibbonControl",null,[563]);class wu extends xt{constructor(b,h,r){super(null,h,r);this.FMh=b}oei(b,h){this.I$a(h);const r=b[bg.a.SourceControlId];var A=this.C5b(r,h);if(A){var L=this.KA.VI(h);L=L?this.Ge.Je(L):null;var ba=this.Ge.ML(A);A=this.Ge.Je(A);b[Pf.a.Alt]=ba;b[Pf.a.On]=A===L;h=Object.assign(new Wu,{Id:r,ExternalId:r,
Command:fb.a.Ysa.toString(),QueryCommand:fb.a.e1a.toString(),TableCellStyles:this.Dbe(r,h),TableStyles:this.D7c(r,h),Alt:ba});b[Pf.a.GalleryButtonProps]=h}else b[Pf.a.InnerHTML]=null,b[Pf.a.Alt]=null,b[Pf.a.On]=!1,b[Pf.a.GalleryButtonProps]=null}Dbe(b,h){this.I$a(h);return(b=this.C5b(b,h))?this.FMh.Lzi(b,h,5,5):null}D7c(b,h){this.I$a(h);return this.C5b(b,h),null}}Object(u.a)(wu,"ATableStyleRibbonControlVariableSizePreviews",xt,[]);var oF=e(1361),rK=e(1126);class Hx{constructor(b,h,r,A){this.Wpm=(L,
ba)=>this.getBorder(L,this.T6.$Q(ba));this.Vpm=(L,ba)=>this.getBorder(L,this.T6.wT(ba));this.Vk=b;this.vB=h;this.sLb=r;this.T6=A;this.jvk=new xe.a(()=>this.Upm());this.hjb=new xe.a(()=>this.Tpm())}Upm(){const b={},h=y.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}Tpm(){const b={};b[Eh.a.zBa]=Eh.a.mpb;b[Eh.a.mpb]=
Eh.a.mpb;b[Eh.a.M8a]=Eh.a.M8a;return b}FKl(b,h,r,A){const L=new rK.a;L.rowCount=r;L.Xpb=A;L.N2a=this.sLb.eTm(b);L.Oa=b.ka(Rc.a.Oa,1);L.Na=b.ka(Rc.a.Na,1);L.tableLook=h;L.yFe=1;return L}Lzi(b,h,r,A){if(!this.Vk.Je(b)||!Object(Pb.a)(124,b)||!Object(Pb.a)(xy.a,h))return null;const L=this.vB.Q4(h);r=this.FKl(b,L,r,A);A=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.A4k(b,h,r,A);return A}D7c(){return null}invalidate(){}A4k(b,h,r,A){r.Voc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.Xpb;r.cellIndex++)this.s0k(b,
h,r,A)}s0k(b,h,r,A){h=this.sLb.HDl(r,this.sLb.lLf(r),h,b);const L={};var ba=this.vB.aLf(b,h,Sb.a.fontColor,!0,Ej.a.YQ(),"None");L.color=ba?ba:"inherit";ba=this.vB.aLf(b,h,Sb.a.YE,!0,Ej.a.YQ(),"None");L["background-color"]=ba?ba:"inherit";this.e5k(r,b,h,L);A.push(L)}e5k(b,h,r,A){b=this.sLb.VXa(b);this.kUd(5,b,h,r,A);this.kUd(3,b,h,r,A);this.kUd(0,b,h,r,A);this.kUd(4,b,h,r,A)}kUd(b,h,r,A,L){h=this.qxm(b,h,r,A);h!==Eh.a.NJ&&(L[this.jvk.value[oF.a[b]]]=h)}qxm(b,h,r,A){let L=Eh.a.NJ;if(({fta:L}=this.eRa(A,
b,1,h,this.Vpm,L)).returnValue)return L;({fta:L}=this.eRa(r,b,3,h,this.Wpm,L));return L}eRa(b,h,r,A,L,ba){return this.T6.iYj(r,h,A)&&(ba=L(b,h))!==Eh.a.NJ||!h&&({fta:ba}=this.eRa(b,1,r,A,L,ba)).returnValue||4===h&&({fta:ba}=this.eRa(b,2,r,A,L,ba)).returnValue?{returnValue:!0,fta:ba}:{returnValue:ba!==Eh.a.NJ,fta:ba}}getBorder(b,h){let r="",A,L;({borderStyle:A,borderWidth:L}=this.$pm(b,h));if(A===Eh.a.M8a)return r;r=String.format(Eh.a.dXd,L,A,this.Lpm(b,h));return r.trim()}Lpm(b,h){if(!h)return Eh.a.l4;
b=this.vB.g3c(b,h.color,Xl.a.auto);return b!==Xl.a.auto?Xl.a.zB(b):Eh.a.l4}$pm(b,h){var r=Eh.a.yBa;let A=Eh.a.OJ+Eh.a.pgc;if(!h)return{borderStyle:r,borderWidth:A};r=this.vB.g3c(b,h.style,Eh.a.M8a);b=this.vB.g3c(b,h.size,Eh.a.OJ);A=this.Xpm(r,b)+Eh.a.pgc;r=this.Npm(r);return{borderStyle:r,borderWidth:A}}Xpm(b,h){let r=2;b===Eh.a.npb&&h<Eh.a.l8&&(r=1);return r}Npm(b){return this.hjb.value[b]||Eh.a.ngc}static dUm(){return new Hx(Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
BC.a.instance,Eh.a.instance)}static get instance(){return null!=Hx.W1g?Hx.W1g:Hx.W1g=Hx.dUm()}}Object(u.a)(Hx,"TableStylePreviewGenerator",null,[564]);var Ix;(function(b){b[b.J0p=0]="background1";b[b.txq=1]="text1";b[b.K0p=2]="background2";b[b.uxq=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.t9p=11]="followedHyperlink";b[b.v4p=12]="dark1";b[b.Geq=13]=
"light1";b[b.w4p=14]="dark2";b[b.Heq=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Ix||(Ix={}));Object(u.b)("ThemeColor",Ix);class aA{constructor(b){this.Sac=b}Nnm(b,h,r){let A;({oEj:h,O_h:A}=this.dOm(h));b=[];const L=[];for(let ra=0;16>ra;ra++){if(!(Ix[ra]in r.DLb))continue;const Ia=ra,Ta=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[A[Ia]],this.cEm(ra));var ba=h[Ia];ba=ba&4278190080|(ba&255)<<16|ba&65280|(ba&16711680)>>>16;L.push(Object.assign(new En,
{Color:Ia.toString(),DisplayColor:"#"+D.a.yL(ba,6),Alt:D.a.Mf(Ta)}));b[b.length]=ra}return{returnValue:L,Vrp:b}}cEm(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;
case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}dOm(b){let h=null,r=null;b=this.Sac(b);if(!b)return{oEj:h,O_h:r};h=b.properties.ka(Rc.a.thb,null);r=b.properties.getValue(Rc.a.lGe).split(" ");return{oEj:h,O_h:r}}static fUm(){return new aA(Object(E.a)(Object(ao.a)(),Object(ao.a)().kw,"navigateToPageContentNode"))}static get instance(){return null!=aA.o2g?aA.o2g:aA.o2g=aA.fUm()}}Object(u.a)(aA,"TableStyleThemeHelper",null,[602]);var pF=
e(922);class oD{get Zf(){return null!=this.E9g?this.E9g:this.E9g=Xa.a.instance.Wa("Box4.Styles.StyleSettings")}constructor(b,h){this.Rcf={};this.DLb={};this.Ge=b;this.KA=h}hEf(b,h){const r=this.Rcf[Ix[h]];return r&&r.length?r:this.Glm(b,h)}fFi(b,h,r){if(h=this.hEf(h,r))for(b=this.Ge.Je(b),r=0;r<h.length;r++)if(this.Ge.Je(h[r])===b)return r;return-1}invalidate(){this.Rcf={};this.DLb={}}Glm(b,h){const r=[];this.DLb={};b=this.KA.y7c(b);this.QVd(r,this.DLb,0,h,b);this.QVd(r,this.DLb,1,h,b);this.QVd(r,
this.DLb,2,h,b);this.QVd(r,this.DLb,3,h,b);return this.Rcf[Ix[h]]=r}QVd(b,h,r,A,L){let ba;const ra=L.Ev();ba=this.Zf.zl?ra.ix:L.ix;for(let Ta=0;Ta<ba;Ta++){var Ia=void 0;this.Zf.zl?(Ia=ra.uha(Ta),Ia=L.Qg(this.Ge.Je(Ia))):Ia=L.nDa(Ta);if(3!==this.Ge.wH(Ia))continue;const ob=this.KA.ZTm(Ia),nb=this.KA.Jbe(Ia);h[Ix[nb]]=!0;ob!==r||nb!==A&&16!==nb||this.Ge.Je(Ia)===pF.a.OYb||(b[b.length]=Ia)}}static NXm(){return new oD(Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Xa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static NRl(){return oD.NXm()}}
Object(u.a)(oD,"WACTableStyleRibbonList",null,[601]);class Qw extends wu{constructor(b,h,r,A,L){super(b,h,r);this.l8b=4;this.KRd=[];this.jkn=()=>{this.lec.invalidate();this.FMh.invalidate()};this.MVk=L;this.lec=A;this.bsf=WacWordeditorStrings.BtnClearTableFormatting;this.zko()}AKl(b,h){b.MenuItems=this.Skm(h)}zko(){this.iRb={};this.iRb["0"]="CustomTableStyles";this.iRb["1"]="PlainTableStyles";this.iRb["2"]="GridTableStyles";this.iRb["3"]="ListTableStyles"}Skm(b){const h=Object.assign(new dk.a,{Id:"menuTableTheme"});
h.MenuSectionList=[];if(this.Kzn(b))return h;const r=Object.assign(new Zd.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),A=Object.assign(new Te.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Lc.a.Pob.toString(),QueryCommand:Lc.a.$_b.toString(),Width:Qw.Wrp});A.Colors=({Vrp:this.KRd}=this.MVk.Nnm(this.KRd,b,this.lec)).returnValue;r.ControlList.push(A);h.MenuSectionList.push(r);return h}I$a(b){if(b=this.KA.VI(b))b=this.KA.Jbe(b),16!==b&&
(this.l8b=b)}kyi(b){return this.lec.hEf(b,this.l8b)}$Sf(b,h){h=this.lec.hEf(h,this.l8b);return 0>b||b>=h.length?null:h[b]}LOo(b,h){var r=this.KA.VI(h);r=this.lec.fFi(r,h,this.l8b);r=-1!==r?Math.floor(r/xt.BJg)*xt.BJg:0;return this.$Sf(r+b,h)}aUm(b){switch(b){case 0:return WacWordeditorStrings.LabelTableStylesCustom;case 2:return WacWordeditorStrings.LabelTableStylesGrid;case 3:return WacWordeditorStrings.LabelTableStylesList;case 1:return WacWordeditorStrings.LabelTableStylesPlain;default:return""}}Kzn(b){this.I$a(b);
return 0>=this.kyi(b).length}DIp(b,h){if(!b||!h)return null;b=parseInt(b[Ol.Color]);var r=this.KA.VI(h);const A=this.KA.Jbe(r);if(A===b)return null;if(16===A)return this.l8b=b,null;r=this.lec.fFi(r,h,A);this.l8b=b;return this.$Sf(r,h)}kZl(b){b=this.KA.VI(b);b=this.KA.Jbe(b);if(16!==b)for(let h=0;h<this.KRd.length;h++)if(this.KRd[h]===b)return h;return-1}q8a(b){b.Bhf(this.jkn,2)}static eUm(){return new Qw(Hx.instance,Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
oD.NRl(),aA.instance)}static get instance(){return null!=Qw.T2g?Qw.T2g:Qw.T2g=Qw.eUm()}}Qw.Wrp=4;Object(u.a)(Qw,"TableStyleRibbonControls",wu,[562,563]);var qF=e(1493);class Vy extends pp{constructor(b,h,r,A,L,ba,ra,Ia){super(b,h,r,A,L,ba,ra,Ia);this.Pwc=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!1,!0)).returnValue)return Ta;this.YKg.AKl(bc,ob.node);return 32};this.Pob=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!1,!0)).returnValue)return 2==nb&&8==Ta&&oo.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],uf.a.fbm),Ta;const Bc=ob.node,Yc=this.YKg.DIp(bc,Bc);Yc&&this.tte(Bc,()=>{this.kTd.z2b(Yc,Bc)});return 32};this.$_b=(Ta,ob,nb,Eb,bc)=>{if(!({xB:Ta}=this.iBb(ob,nb,bc,!0,!0)).returnValue)return Ta;bc[Ol.IndexColorSelected]=this.YKg.kZl(ob.node);return 32}}Nxc(b){super.Nxc(b);this.ga.qa(Lc.a.Pob,ic.a.view,this.EFe);this.ga.qa(Lc.a.Pob,ic.a.table,this.Pob);this.ga.Oc(Lc.a.Pob,1030);this.ga.qa(Lc.a.Pwc,ic.a.view,b);this.ga.qa(Lc.a.Pwc,ic.a.table,this.Pwc);this.ga.Oc(Lc.a.Pwc,
1126);this.ga.qa(Lc.a.$_b,ic.a.view,b);this.ga.qa(Lc.a.$_b,ic.a.table,this.$_b);this.ga.Oc(Lc.a.$_b,1127)}get YKg(){return this.qRd}static YTm(){return new Vy(Xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Qw.instance,y.AFrameworkApplication.va,qF.a.instance,new gm.a,Xa.a.instance.resolve("Box4.IInsertionPointFormatting"),Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(E.a)(Ke.a.instance,Ke.a.instance.Bwb,"isTableNodeInLockedRange"))}static get instance(){return null!=
Vy.d2g?Vy.d2g:Vy.d2g=Vy.YTm()}}Object(u.a)(Vy,"TableStyleActor",pp,[]);class rF{constructor(){this.Z=null}get name(){return"WordEditor.TableStyle"}Ec(b){this.Z=b;this.Z.ja("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Hx.instance).ha();this.Z.ja("Box4.TableEditors.IWACTableStyleEditor",()=>qF.a.instance).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(103)&&(Vy.instance.mc(),Qw.instance.q8a(nu.a.instance),
Db.StaticActiveAppFrame.Aa().Ne())}dispose(){}}Object(u.a)(rF,"TableStylePackage",null,[0,1]);var sK=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",
Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",
PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",
Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",
MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",
attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},tK=e(1340);class sF{constructor(b,h){this.U9b=b;this.RBd=h}eDo(b){this.U9b.QUh(b)}z_d(b){this.RBd.z_d(b)}vCe(b,h){return this.RBd.vCe(b,h)}uCe(b,h){return this.RBd.uCe(b,h)}eHe(b,h,r){this.RBd.eHe(b,h,r)}}Object(u.a)(sF,
"ClientPaginationHeaderFooterBridge",null,[588]);class Jx{constructor(b,h){this.tq=b;this.ga=h;this.mJb=new tj.a;this.nJb=new tj.a}z_d(b){b=te.a.kb(b);if(b.ku()&&b.Bs()){b.ue();do 10===b.Jf&&this.Gko(b.currentNode),b.px();while(8!==b.Jf)}}vCe(b,h){var r=this.OQf(h);if(!this.mJb.Bb(r))return v.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.mJb.K(r);v.ULS.shipAssertTag(573400389,336,this.nJb.Bb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
r=this.nJb.K(r);return this.b6m(h,b,r)}uCe(b,h){var r=this.OQf(h);if(!this.mJb.Bb(r))return v.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.mJb.K(r);v.ULS.shipAssertTag(573400391,336,this.nJb.Bb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.nJb.K(r);return this.qim(h,b,r)}eHe(b,h,r){h=this.DUm(h,r);this.ga.Zb(b?Lc.a.KRg:Lc.a.KJe,
2,h)}DUm(b,h){h=this.tq.j6c(h);if(!h)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.tq.rDa(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}Gko(b){if(10===b.type){var h=new tj.a,r=this.tq.j6c(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var A=this.tq.rDa(r);b=this.OQf(b);this.HHp(b,A);this.GHp(b,
h);r=te.a.kb(r);if(r.Bs()){r.ue();do b=r.currentNode,A=this.tq.a$d(b),b=this.tq.Z5m(b),h.add(A,b),r.px();while(36===r.Jf)}}}HHp(b,h){this.nJb.Bb(b)?this.nJb.W(b,h):this.nJb.add(b,h)}GHp(b,h){this.mJb.Bb(b)?this.mJb.W(b,h):this.mJb.add(b,h)}OQf(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ka(Rc.a.Axa,0)}b6m(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.Bb(2))return b.K(2)}else if(b.Bb(0))return b.K(0);break;
case 3:if(h){if(b.Bb(1))return b.K(1)}else if(b.Bb(0))return b.K(0);break;case 4:if(A){if(b.Bb(2))return b.K(2)}else if(h){if(b.Bb(1))return b.K(1)}else if(b.Bb(0))return b.K(0);break;case 1:if(b.Bb(0))return b.K(0)}return!1}qim(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.Bb(5))return b.K(5)}else if(b.Bb(3))return b.K(3);break;case 3:if(h){if(b.Bb(4))return b.K(4)}else if(b.Bb(3))return b.K(3);break;case 4:if(A){if(b.Bb(5))return b.K(5)}else if(h){if(b.Bb(4))return b.K(4)}else if(b.Bb(3))return b.K(3);
break;case 1:if(b.Bb(3))return b.K(3)}return!1}}Object(u.a)(Jx,"ClientPaginationPageAdornmentContentManager",null,[586]);class tF{constructor(b,h,r,A,L,ba){this.HEl=ra=>{1===ra&&this.dI.kI&&(ra=this.td.Gua(this.dI.kI,8,8),this.tq.srl(ra)?this.RWl(ra):this.tdp())};this.Izp=ra=>{1===ra&&this.ga.Zb(fb.a.KZ,2,!1)};this.dI=b;this.tq=h;this.td=r;this.Zc=A;this.gLc=L;this.ga=ba}Idp(){const b=new wg.StandardDialog;b.Md=1;b.Ue(1,WacWordeditorStrings.HeaderToolbarDeleteDialogRemoveAllButton);b.YW(0);b.Yx(CommonUIStrings.l_DefaultDialogTitle,
WacWordeditorStrings.HeaderToolbarDeleteDialogMessage,0,this.HEl)}RWl(b){b.xd(8);const h=this.Zc.Vc(15);h.set(b.Jr.ml);this.gLc.zFo(b);this.dI.dismiss();h.dispose();v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}tdp(){const b=new wg.StandardDialog;b.Md=1;b.Ue(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ue(0,CommonUIStrings.l_Close);b.YW(0);b.Yx(CommonUIStrings.l_DefaultDialogTitle,WacWordeditorStrings.HeaderToolbarCantDeleteContent,0,this.Izp);v.ULS.sendTraceTag(4214793,317,
50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(u.a)(tF,"DeleteHeaderFooterDialog",null,[]);class uK{constructor(b,h,r,A,L){this.tq=b;this.td=h;this.Zc=r;this.gLc=A;this.ga=L}create(b){return new tF(b,this.tq,this.td,this.Zc,this.gLc,this.ga)}}Object(u.a)(uK,"DeleteHeaderFooterDialogFactory",null,[587]);class pD{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb){this.Tia=nb;this.vE=Eb;this.qfa=null;this.EMg=(bc,Bc,Yc,zd,Jd)=>{var ie=this.dTf(Bc);return ie?1===Yc?32:(Yc=this.control)?(Bc=this.Zc.Vc(15),
Bc.Eb(ie),Bc.Bh=bc,Yc.Qga?this.ga.Vb(Lc.a.PY,2):(ie=this.bqi(ie),zd.Av=ie?1:0,zd=bc!==Lc.a.KJe,(bc=this.wNf(bc,Jd))&&Yc.kGa(bc),this.ga.Zb(Lc.a.m3d,2,zd)),Bc.dispose(),32):8:8};this.izf=(bc,Bc,Yc)=>{if(1===Yc)return 32;this.czk.create(this.control).Idp();return 32};this.dso=(bc,Bc,Yc,zd,Jd)=>1===Yc?32:(bc=this.control)?(Jd[bg.a.On]=bc.Qga,32):8;this.aBb=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc||!this.control.Qga)return 32;Bc=this.pEi(bc,Jd);Yc=pD.tPi(this.control.kI);zd=this.Zc.Vc(15);zd.Eb(Yc);zd.Bh=bc;bc=this.td.Lm();
bc.set(Yc);this.rTa.fEf(bc.currentNode,Bc);this.tq.vYb(bc);this.gLc.SVj(bc,Bc);zd.dispose();return 32};this.kGa=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc)return 32;bc=this.wNf(bc,Jd);this.control.Qga&&this.control.kGa(bc);return 32};this.tAe=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc)return 32;bc=this.xLi(bc,Jd);zd.Av=bc;Bc=this.dTf(Bc);if(!Bc)return 8;zd=this.td.Lm();zd.set(Bc);zd.Ib(8);zd.Mu(8);if(!this.km.tWn(zd,bc))return 8;this.tq.vYb(zd);this.control.cna(zd.currentNode);return 32};this.Tog=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc)return 32;
bc=this.TWk.jQl(this.dTf(Bc));Jd.PopulationXML=bc;return 32};this.Zve=(bc,Bc,Yc,zd,Jd)=>{bc=this.pEi(bc,Jd);Bc=this.control.kI;Yc=this.tq.rDa(Bc);Jd[bg.a.On]=bc===Yc;1===bc&&(Jd[bg.a.LabelText]=this.xQi(Bc)?WacWordeditorStrings.HeaderToolbarEntireSection:WacWordeditorStrings.HeaderToolbarAllPages);return 32};this.$ue=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc||!this.control.Qga)return 32;Bc=this.control.kI;void 0!==Bc&&null!==Bc&&(Bc=this.tq.rDa(Bc),bc=this.wNf(bc,Jd),Yc=this.control.n8b,Jd[bg.a.Visible]=this.Vqp(bc,
Bc),Jd[bg.a.On]=bc===Yc);return 32};this.uso=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc||!this.control.Qga)return 32;bc=this.control.kI;void 0!==bc&&null!==bc&&this.Yko(bc,Jd);return 32};this.Dro=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc||!this.control.Qga)return 32;bc=this.xLi(bc,Jd);Bc=this.control.kI;Yc=0;void 0!==Bc&&null!==Bc&&(Yc=Bc.getValue(Rc.a.Axa));Jd[bg.a.On]=bc===Yc;return 32};this.PY=(bc,Bc,Yc)=>{if(1===Yc)return 32;this.control.dismiss();return 32};this.zde=()=>32;this.rZj=!0;this.m3d=(bc,Bc,Yc,zd,Jd)=>{if(1===
Yc)return 32;this.control.show(Jd);this.iwp();return 32};this.Xwb=(bc,Bc,Yc,zd,Jd)=>{if(1===Yc)return 32;if(!Jd)return 8;Bc=Jd.G9a;if(!Bc||!Bc.isConnected)return 8;bc=this.tq.Wgd(Bc);if(!({isHeader:Yc,HLg:Bc}=this.tq.INi(Bc)).returnValue)return 8;this.control.cna(bc);this.control.kGa(Bc);this.control.show(Yc,Jd.pCe);return 32};this.ga=b;this.tq=h;this.gLc=r;this.rTa=A;this.km=L;this.td=ba;this.Zc=ra;this.TWk=Ia;this.IDk=Ta;this.czk=ob}get control(){return this.qfa}set control(b){this.qfa=b}mc(){this.ga.qa(Lc.a.cZf,
ic.a.view,this.EMg);this.ga.nb(Lc.a.bsg,ic.a.application,this.dso,96);this.ga.qa(Lc.a.KRg,ic.a.view,this.EMg);this.ga.qa(Lc.a.KJe,ic.a.view,this.EMg);this.ga.nb(Lc.a.zde,ic.a.view,this.zde,64);this.ga.qa(Lc.a.m3d,ic.a.view,this.m3d);this.ga.nb(Lc.a.PY,ic.a.application,this.PY,96);this.ga.nb(Lc.a.Xwb,ic.a.application,this.Xwb,96);this.ga.nb(Lc.a.OYo,ic.a.view,this.kGa,96);this.ga.qa(Lc.a.fSj,ic.a.view,this.kGa);this.ga.qa(Lc.a.hSj,ic.a.view,this.kGa);this.ga.qa(Lc.a.gSj,ic.a.view,this.kGa);this.ga.qa(Lc.a.iSj,
ic.a.view,this.kGa);this.ga.nb(Lc.a.l1o,ic.a.view,this.aBb,100);this.ga.nb(Lc.a.VTj,ic.a.view,this.aBb,4);this.ga.nb(Lc.a.UTj,ic.a.view,this.aBb,4);this.ga.nb(Lc.a.STj,ic.a.view,this.aBb,4);this.ga.nb(Lc.a.TTj,ic.a.view,this.aBb,4);this.ga.qa(Lc.a.tAe,ic.a.view,this.tAe);this.ga.qa(Lc.a.iCg,ic.a.view,this.tAe);this.ga.nb(Lc.a.Tog,ic.a.view,this.Tog,96);this.ga.nb(Lc.a.izf,ic.a.view,this.izf,4);this.ga.nb(Lc.a.ECj,ic.a.view,this.$ue,97);this.ga.nb(Lc.a.GCj,ic.a.view,this.$ue,97);this.ga.nb(Lc.a.FCj,
ic.a.view,this.$ue,97);this.ga.nb(Lc.a.HCj,ic.a.view,this.$ue,97);this.ga.nb(Lc.a.XCj,ic.a.view,this.Zve,97);this.ga.nb(Lc.a.WCj,ic.a.view,this.Zve,97);this.ga.nb(Lc.a.UCj,ic.a.view,this.Zve,97);this.ga.nb(Lc.a.VCj,ic.a.view,this.Zve,97);this.ga.nb(Lc.a.Yro,ic.a.view,this.uso,97);this.ga.nb(Lc.a.xrg,ic.a.view,this.Dro,97)}bqi(b){const h=this.tq.j6c(b),r=this.tq.rDa(h);b=this.rTa.fEf(b,r);this.control.cna(h);return b}pEi(b,h){switch(b){case Lc.a.VTj:case Lc.a.XCj:b=1;break;case Lc.a.UTj:case Lc.a.WCj:b=
2;break;case Lc.a.STj:case Lc.a.UCj:b=3;break;case Lc.a.TTj:case Lc.a.VCj:b=4;break;default:b=h}return b}wNf(b,h){switch(b){case Lc.a.fSj:case Lc.a.ECj:b=1;break;case Lc.a.hSj:case Lc.a.GCj:b=2;break;case Lc.a.gSj:case Lc.a.FCj:b=3;break;case Lc.a.iSj:case Lc.a.HCj:b=4;break;case Lc.a.KRg:case Lc.a.KJe:b=h;break;case Lc.a.cZf:b=0;break;default:b=h}return b}xLi(b,h){return b===Lc.a.iCg||b===Lc.a.xrg?parseInt(h.MenuItemId):h}dTf(b){return this.km.f9(b.Pk)}Vqp(b,h){switch(h){case 1:return!1;case 2:return 1===
b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}Yko(b,h){const r=this.xQi(b);if(h[Ue.a.Visible]=r)b=this.km.uPi(this.IDk(b)),b=String.format(WacWordeditorStrings.HeaderToolbarSectionButtonLabel,b),h[Ue.a.LabelText]=b}xQi(b){const h=this.td.Lm();h.set(b);h.Ib(8);h.Mu(8);return 1<this.km.vSf(h)}get Tdo(){return null!=this.N6g?this.N6g:this.N6g=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OverlayHeaderFooterSurveyIsEnabled",!1)}iwp(){!this.Tia&&
this.rZj&&this.Tdo&&(this.rZj=!1,window.setTimeout(()=>{this.vE&&this.vE.execute(b=>{b.logActivity("OverlayHeaderFooterFPS",null)})},5E3))}static tPi(b){const h=new te.a;h.set(b);h.Ib(10);return Ur.a.fQo(h)}}Object(u.a)(pD,"HeaderFooterActor",null,[]);var Fr=e(818),CB=e(729);class bA{constructor(b,h,r,A,L){this.SLk=b;this.tq=h;this.km=r;this.td=A;this.ga=L}Npi(b,h){this.tq.vYb(b);h=this.T7l(b,h);b.Ac();return h}fEf(b,h){b=this.td.Gua(b,8,8);let r=!1;this.km.HXa(b,A=>{const L=this.td.Lm();L.set(A);
r=(A=this.Npi(L,h))||r;return A});return r}T7l(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=CB.a.bAf(h);for(let A=0;A<h.length;++A)r=this.SLk.S7l(b,h[A])||r;return r}}bA.nVl=1;Object(u.a)(bA,"HeaderFooterInserter",null,[579]);class Kx{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.JJh=this.Ckh=!1;this.kI=null;this.m_e=!1;this.n8b=0;this.Fpe=()=>{this.m_e=!0};this.saa=b;b.bind(this);this.$ef=A;this.Czk=Ta;this.uCh=L;this.LMk=ba;this.Pkb=ra;this.kP=h;this.footer=r;this.kP.sRl();this.saa.bD();this.ddf=
bA.nVl;this.rTa=Ia;Kx.ga=ob;this.L_=nb}get Qga(){return this.Ckh}show(b=!0,h=!0){this.Qga||(this.jek(),this.rTj(!0),this.kP.iAo(),this.Czk(),this.Akp(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.oEa&&(mh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Fr.a,{state:0,disablePopover:!0}))):v.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.JJh=h)&&this.uCh(b)}dismiss(b=!1){this.Qga&&(this.LMk(b),this.rTj(!1),
this.gQb(),this.n8b=0,this.Mlp(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.oEa&&(mh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Fr.a,{disablePopover:!1}))):v.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}rTj(b){this.Ckh=b;Kx.ga.Vb(fb.a.qIf,2);this.saa.d6(b);this.kP.d6(b);this.footer.d6(b);this.$ef()}cna(b){this.kI!==b&&(this.kI=b,this.kP.cna(b),this.footer.cna(b),this.n8b=0,this.aBb(this.Pkb.rDa(b)))}gQb(){this.kI&&
(this.kP.irb(),this.footer.irb(),this.kI=null)}update(){this.Qga&&this.T4b()}T4b(){this.kI&&(this.Pkb.h3l(this.kI)&&this.Pkb.X5m(this.kI)?this.jek():this.dismiss())}jek(){const b=this.Pkb.rDa(this.kI);b!==this.ddf&&this.aBb(b)}aBb(b){this.ddf=b;this.kGa(this.CUm(b))}CUm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}kGa(b,h=!0){this.n8b!==b&&(this.rTa.fEf(this.kI,this.ddf),this.kP.eSj(b),this.kP.g_h(Uk.a.Dha),this.footer.eSj(b),this.footer.g_h(Uk.a.fha),this.n8b=b,this.Qga&&
this.JJh&&this.x8l(h))}x8l(b){this.uCh(b);b?this.kP.MAb():this.footer.MAb()}dispose(){this.saa.Mea();this.kP.dispose();this.footer.dispose()}Akp(){this.L_.UUd(this.Fpe);this.m_e=!1}Mlp(){this.L_.vwg(this.Fpe);this.m_e&&Kx.ga.Vb(Lc.a.zde,2)}static s0l(){Kx.ga.Zb(wb.a.yub,2,!0);Kx.ga.Vb(Lc.a.C8,2)}}Kx.ga=null;Object(u.a)(Kx,"HeaderFooterControl",null,[615,11]);class uF{constructor(b,h,r,A,L){this.$ef=b;this.Pkb=h;this.rTa=r;this.ga=A;this.L_=L}create(b,h,r,A,L){return new Kx(b,h,r,this.$ef,A,L,this.Pkb,
this.rTa,Kx.s0l,this.ga,this.L_)}}Object(u.a)(uF,"Factory",null,[585]);class Lx{constructor(){this.qfa=null}get control(){return this.qfa}set control(b){this.qfa=b}hJf(b){return this.iJf(this.control.kI,this.control.n8b,b.isHeader,b)}iJf(b,h,r,A){return()=>{if(!b.isConnected)return null;this.control.cna(b);this.control.kGa(h);this.control.show(r);return A}}dismiss(){this.qfa.Qga&&this.qfa.dismiss()}}Object(u.a)(Lx,"HeaderFooterControlLauncher",null,[]);var TM=e(1139),Mx=e(798),Rw=e(834);class Nx{constructor(b,
h,r){this.VCc=null;const A=h?"Header":"Footer";this.mu=b.ownerDocument.createElement("div");this.mu.id=h?"HeaderPane":"FooterPane";this.mu.classList.add(Nx.a6m,A);this.cMb=(new Rw.a(this.mu,"WACViewPanel_"+A)).uM;this.mu.appendChild(this.cMb);b.appendChild(this.mu);h&&(this.VCc=b.ownerDocument.createElement("div"),this.VCc.classList.add(Nx.h6m),this.mu.appendChild(this.VCc));this.kdh=r.wKm(this.mu)}bind(){}d6(b){b?this.kdh.Pal():this.kdh.Ral()}Ajl(b){b.egc(this.cMb)}}Nx.h6m="HeaderToolbarContainer";
Nx.a6m="HeaderFooterPane";Object(u.a)(Nx,"PaneControlDom",null,[631]);class tv{constructor(b,h,r,A,L){this.dI=this.Zs=null;this.Xrj=()=>{this.dI.dismiss(!0);if(this.n9b){const ba=new Jz.a(!0);this.n9b.GPa(ba)}return!0};this.fJ=ba=>{ba.Yb.preventDefault();return!1};this.mu=b.ownerDocument.createElement("div");this.mu.id=tv.Ebi;this.mu.className=tv.Ebi;this.L3=A;this.n9b=L;this.sTi=new Nx(this.mu,!0,h);this.ROl(this.mu);this.Avi=new Nx(this.mu,!1,h);this.d6(!1);b.appendChild(this.mu)}ROl(b){this.Zs=
b.ownerDocument.createElement("div");this.Zs.id=tv.Udo;this.Zs.className=tv.Rdo;this.Zs.tabIndex=0;this.Zs.setAttribute(le.a.fi,le.a.i4);this.Zs.setAttribute(le.a.bma,WacWordeditorStrings.HeaderFooterOverlayAccessibleText);b.appendChild(this.Zs)}bind(b){this.dI=b}d6(b){if(!b&&this.L3){var h=new Jz.a(!0);this.L3.GPa(h)}!b&&this.n9b&&(h=new Jz.a(!0),this.n9b.GPa(h));this.mu.style.display=b?"":"none";this.sTi.d6(b);this.Avi.d6(b)}F0o(){this.Zs.focus()}bD(){Wf.a.instance.Cb(Fd.a.click,this.Zs,this.Xrj);
qd.a.instance.Cb(Fd.a.eE,this.mu,this.fJ)}Mea(){Wf.a.instance.Gc(Fd.a.click,this.Zs,this.Xrj);qd.a.instance.Gc(Fd.a.eE,this.mu,this.fJ)}}tv.Ebi="HeaderFooterControl";tv.Udo="HeaderFooterOverlay";tv.Rdo="EditingSurfaceOverlay HeaderFooterOverlay";Object(u.a)(tv,"HeaderFooterControlDom",null,[611]);var ws=e(165);class PH{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.saa=null;this.sa=new Nf.a;this.dI=this.$Od=null;this.F5n=nb=>{this.ZW(nb);this.sa.raiseEvent("OnShowEventKey")};this.E5n=nb=>{this.N5&&(this.$Od=
new TM.a(this.N5));this.oc.j0c(Uk.a.Dha);this.oc.j0c(Uk.a.fha);this.qja(nb);this.sa.raiseEvent("OnDismissEventKey")};this.Ise=()=>{this.$Od&&(this.$Od.dispose(),this.$Od=null)};this.oc=b;this.hr=h;this.fEh=r;this.kEk=A;this.DOk=L;this.ga=ba;this.Uhh=Mx.a.create();this.dmh=lc.KeyInputManager.xc(pg.a.vw,0);this.y3=lc.KeyInputManager.xc(pg.a.H6,0);this.GUk=lc.KeyInputManager.xc(pg.a.B3a,0);this.eIb=ra;this.za=Ia;this.L3=Ta;this.n9b=ob;this.N5&&this.N5.d8(this.Ise)}g8k(b){this.sa.addHandler("OnShowEventKey",
b)}dJo(b){this.sa.removeHandler("OnShowEventKey",b)}QUh(b){this.sa.addHandler("OnDismissEventKey",b)}RIo(b){this.sa.removeHandler("OnDismissEventKey",b)}get N5(){const b=this.eIb.value;return b?b.Aj?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.dI}get $Gl(){return this.Uhh}bind(b){this.dI=this.iFl(b);this.Uhh.instance=
this.dI}iFl(b){this.saa=new tv(b,this.DOk.value,this.za,this.L3,this.n9b);b=this.fEh.value.create(this.ga,this.saa.sTi,!0,Uk.a.Dha);const h=this.fEh.value.create(this.ga,this.saa.Avi,!1,Uk.a.fha);this.dI=this.kEk.value.create(this.saa,b,h,this.F5n,this.E5n);this.zYf();this.vY();return this.control}zYf(){var b=3===this.ga.mode?Uk.a.LI:Uk.a.Ixc;const h=this.oc.te(Uk.a.Dha);h.parent=b;this.oc.Phf(Uk.a.Dha);const r=this.oc.te(Uk.a.fha);r.parent=b;this.oc.Phf(Uk.a.fha);b=this.oc.te(ws.a.nUb);b.parent=
Df.AFrame.rr;b.Rla(()=>{this.saa.F0o()});b.bindAction(this.dmh,Lc.a.PY);b.bindAction(this.y3,Lc.a.PY);b.bindAction(this.GUk,Lc.a.PY);h.bindAction(this.y3,Lc.a.PY);r.bindAction(this.y3,Lc.a.PY)}vY(){this.hr.vY(Uk.a.Dha);this.hr.vY(ws.a.Gbb);this.hr.vY(Uk.a.fha);this.hr.vY(ws.a.nUb)}ZW(b){this.hr.RM(Uk.a.Dha);this.hr.RM(ws.a.Gbb);this.hr.RM(Uk.a.fha);this.hr.RM(ws.a.nUb);this.hr.wz(Df.AFrame.Co);this.oc.RUc(Uk.a.Dha);this.oc.RUc(Uk.a.fha);b?this.oc.Rg(Uk.a.Dha):this.oc.Rg(Uk.a.fha)}qja(b){this.hr.wz(Uk.a.Dha);
this.hr.wz(ws.a.Gbb);this.hr.wz(Uk.a.fha);this.hr.wz(ws.a.nUb);this.hr.RM(Df.AFrame.Co);(b||this.oc.currentScope&&(this.oc.currentScope.name===Uk.a.Dha||this.oc.currentScope.name===ws.a.Gbb||this.oc.currentScope.name===Uk.a.fha||this.oc.currentScope.name===ws.a.nUb))&&this.oc.Rg(Df.AFrame.Co)}dispose(){const b=this.oc.te(ws.a.nUb);b.Pu(this.dmh);b.Pu(this.y3);this.oc.te(Uk.a.Dha).Pu(this.y3);this.oc.te(Uk.a.fha).Pu(this.y3);this.N5&&this.N5.T0b(this.Ise);this.control.dispose()}}Object(u.a)(PH,"HeaderFooterControlOwner",
null,[583,584]);var qD=e(1124);class Cp{constructor(b,h,r,A,L,ba,ra,Ia){this.Asa=b;this.FVk=h;this.LPe=r;this.zn=A;this.eOk=L;this.cUk=ba;this.ZDk=ra;Cp.ni=Ia}Ign(b,h){this.FVk(b,1,3,null,!1);this.Asa.FVj(pF.a.OYb,1696,b.currentNode);this.LPe(b,0,this.zn?3:1,h);this.LPe(b,1,2,h);this.LPe(b,2,this.zn?1:3,h);this.eOk(b);this.cUk(b,!1,!0,null);this.ZDk(b,h)}static get nO(){return null!=Cp.ibh?Cp.ibh:Cp.ibh=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get gm(){return null!=Cp.x7g?Cp.x7g:
Cp.x7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}static KZo(b,h,r){Lh.h(b,0,h);hg.a.Ze(b);Cp.nO.Ord(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Cp.gm.qJ(b.currentNode,r);h||Cp.gm.Hs.Jxa(b,1,-115);2===h&&Cp.gm.Hs.LAb(b.currentNode,1,-115);Lh.C(b)}static j1o(b,h){hg.a.Ze(b);Cp.nO.Ord(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);hg.a.xe(b)}static irm(){return(b,h,r)=>{Cp.KZo(b,h,r)}}static fBm(){return(b,h)=>{Cp.j1o(b,h)}}static GTm(b){return(h,
r,A,L,ba)=>b.jCa(h,r,A,L,ba)}static ARm(){return(b,h,r,A,L)=>Cp.ni.mA(b,h,r,A,L)}}Cp.ni=null;Object(u.a)(Cp,"HeaderFooterDefaultTableInserter",null,[582]);class vF{constructor(b,h,r,A){this.tq=b;this.dMd=h;this.td=r;this.km=A}SVj(b,h){b.Jr.properties.setValue(Rc.a.vVf,2===h||4===h);b.Ib(8);b.Xwd(8).properties.setValue(Rc.a.fde,3===h||4===h)}zFo(b){this.km.HXa(b,h=>{const r=this.td.Lm();r.set(h);this.tq.vYb(r);this.SVj(r,1);this.AFo(r);return!0})}AFo(b){for(;b.ue();)b.qh()}}Object(u.a)(vF,"HeaderFooterEditor",
null,[581]);var QH=e(1102);class DB extends at.a{constructor(b){super();this.bff=b}get index(){return 0}run(){this.bff()}W5m(b,h){h.property===Rc.a.vVf&&this.BK()}reo(b,h){h.property===Rc.a.fde&&this.BK()}BK(){this.t2()}}Object(u.a)(DB,"ControlUpdateNeededTracker",at.a,[]);class vK{constructor(b,h,r,A,L,ba){this.Djb=null;this.lEk=r;this.WFd=h;this.T9b=b;this.tOk=A;this.pUa=ba}start(){this.T9b.bind(Db.StaticActiveAppFrame.Aa().VH);this.WFd.control=this.T9b.control;this.WFd.mc();this.lEk.control=this.T9b.control;
this.tOk.value.create(this.T9b.control,Object(E.a)(this.WFd,this.WFd.bqi,"ensureSectionHeaderFooterAttachedToControl")).mc();this.W8m()}W8m(){this.Djb=new DB(()=>{this.T9b.control.update()});const b=Ze.a.wf.Um;b.Hf(35).yq(Object(E.a)(this.Djb,this.Djb.W5m,"headerFooterContainerNodePropertyChanged"));b.Hf(8).yq(Object(E.a)(this.Djb,this.Djb.reo,"pageContentNodePropertyChanged"));QH.a.lxe(Object(E.a)(this.Djb,this.Djb.BK,"setUpdateNeeded"));Ar.a.instance.Cxa(this.Djb,3)}dispose(){this.T9b.dispose();
this.pUa.sli()}}Object(u.a)(vK,"HeaderFooterManager",null,[]);class Ls{constructor(b,h,r,A){this.km=b;this.tq=h;this.Vac=r;this.ySe=A}S7l(b,h){let r=!1;const A=CB.a.gPf(h);b.dw(A)||(this.Xgn(b,h),this.ySe.Hgn(b.currentNode,h),r=!0);return r}Xgn(b,h){const r=this.Vac.create(on.a.noc),A=b.currentNode.ka(Rc.a.Axa,0);r.properties.setValue(Rc.a.Axa,A);r.properties.setValue(Rc.a.moc,h);h=CB.a.gPf(h);b.pg(r,h)}}Object(u.a)(Ls,"HeaderFooterNodeLevelInserter",null,[578]);var Wy=e(1409),RH=e(1445);class EB extends Wy.a{constructor(b,
h,r){super(b,h,"","");this.pJb=null;this.FTi=EB.kii;this.f9c=[];this.FXe=r}get DE(){return!0}get cssClass(){return"cui-herodock"}ro(){this.cAo();super.ro()}pXa(){for(const b of this.f9c)b.M4d();super.pXa()}Djp(){const b=[],h=[],r=[];for(let A=0;A<this.f9c.length;A++){const L=this.f9c[A];L.visible?b.length<this.FTi?b.push(L):Object(Pb.a)(RH.FlyoutAnchor,L)?Array.addRange(h,L.num()):h.push(L):r.push(L)}return{gup:b,Pdo:h,pkn:r}}QOl(b){if(!b||!b.length)return null;const h=new kn.Menu(this.root,this.id+
"OverflowMenu",null,null,null),r=new ok.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const A of b)r.pg(A.KY("Menu20"));h.pg(r);return h}cAo(){this.fxa();this.fd=Sg.a.w1a(this.fd);this.kG();const {gup:b,Pdo:h,pkn:r}=this.Djp();for(var A of b){var L=A.KY("Medium20");L.enabled=!0;this.Fec(L,this.children.count);this.fd.appendChild(L.fd);L.kua()}if(A=this.QOl(h)){if(this.pJb)this.pJb.fh=A;else{L=this.id+"OverflowMenuLauncher";
const ba={};ba.Image20by20=this.FXe.OverflowMenuImage20by20;ba.Image20by20Class=this.FXe.OverflowMenuImage20by20Class;ba.PopulateDynamically="false";ba.HideDefaultArrow="true";ba.Alt=this.FXe.OverflowMenuTooltip;ba.Command="798637440";ba.Id=L;this.pJb=new RH.FlyoutAnchor(this.root,L,ba,A)}A=this.pJb.KY("Small20");A.enabled=!0;this.Fec(A,this.children.count);this.fd.appendChild(A.fd);A.kua()}if(y.AFrameworkApplication.J.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const ba of r)A=ba.KY("Medium20"),
this.pg(A),A.kua()}dispose(){this.pJb&&(this.pJb.dispose(),this.pJb=null);for(const b of this.f9c)b.dispose();this.fxa();super.dispose()}set DE(b){super.DE=b}}EB.kii=4;Object(u.a)(EB,"HeroDock",Wy.a,[]);var wF=e(1487);class wK extends wF.a{constructor(){super();this.VEe=this.xvn=this.olp=!1;this.XRn=y.AFrameworkApplication.M2f?1:EB.kii}}Object(u.a)(wK,"ToolbarBuildOptions",wF.a,[]);var jj=e(1442),Rq=e(1521),SH=e(1546);class rD extends Wy.a{constructor(b,h,r){super(b,h,"","");this.dGc=r.Alignment;
this.jlh=r.ScalingDirection===jj.a.zlk}ro(){this.KCa();this.N0(this.fd);super.ro()}N0(b){for(const h of this.children){h.kG();switch(this.dGc){case jj.a.oLe:Sg.a.Gg(h.fd,"cui-toolbar-button-left");break;case jj.a.wib:Sg.a.Gg(h.fd,"cui-toolbar-button-center");break;case jj.a.b6b:Sg.a.Gg(h.fd,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.dGc);}h.visible&&b.appendChild(h.fd);h.kua()}}kT(b){if(!Object(Pb.a)(Lo.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.dGc){case jj.a.oLe:return"cui-toolbar-buttondock alignleft";case jj.a.wib:return"cui-toolbar-buttondock aligncenter";case jj.a.b6b:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.dGc);}}get DE(){return!0}get alignment(){return this.dGc}Nnc(){let b=0;if(this.alignment===jj.a.wib)for(const h of this.children){const r=h;r.visible&&(b+=r.fd.offsetWidth)}else b=this.fd.offsetWidth;return b}ube(){let b=null;if(this.alignment===jj.a.wib)for(const h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.fd);break}}else b=Sys.UI.DomElement.getBounds(this.fd);return b?0===this.root.textDirection?b.x:b.x+b.width:0}B9d(){let b=null;if(this.alignment===jj.a.wib){if(0<this.children.count){const h=this.children.CMf(this.children.count-1);for(;h.Nxb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.fd);break}}}}else b=Sys.UI.DomElement.getBounds(this.fd);return b?0===this.root.textDirection?b.x+b.width:b.x:0}ZDf(){for(const b of this.children){const h=
b;if(!Object(Pb.a)(Lo.a,h)||h.control.visible)h.visible=!0}}qTo(b){const h=this.children.toArray(),r=new SH.a;let A=this.jlh?0:h.length-1;const L=this.children.count,ba=this.root.P2a;for(;this.Nnc()>=b&&!(A>=L||0>A);){const ra=h[A];ba&&Object(Pb.a)(Lo.a,ra)&&ra.control.visible&&(r.add(ra),ra.lYh());A+=this.jlh?1:-1}for(const ra of r)ra.mIj(),ra.visible=!1}set DE(b){super.DE=b}}Object(u.a)(rD,"ButtonDock",Wy.a,[]);class Sq extends Za.a{constructor(b,h,r,A,L,ba,ra=!1){super(b,h,ba);this.sza=this.k3=
this.ssa=null;this.i4e=!1;this.adb=A;this.VEe=L;this.ZRd=0;ef.c(h.Size)||(h.Size===jj.a.RUg||r.options.xvn?this.ZRd=0:h.Size===jj.a.Jok&&(this.ZRd=1));this.UWk=ra}get P2a(){return!0}pg(b){super.pg(b);Object(Pb.a)(rD,b)&&!this.i4e&&(b.alignment===jj.a.oLe?(this.ssa&&this.yDg(),this.ssa=b):b.alignment===jj.a.wib?(this.k3&&this.yDg(),this.k3=b):b.alignment===jj.a.b6b&&(this.sza&&this.yDg(),this.sza=b))}yDg(){this.i4e=!0;this.sza=this.k3=this.ssa=null}FAb(b,h){b=this.v5c(b);ef.c(b)||b.visible===h||(b.visible=
h,this.refresh())}ro(){super.ro();this.XFj(!0)}XFj(b){const h=this.root.UOb;ef.c(this.fd)&&this.tRl();this.fd=Sg.a.w1a(this.fd);this.h9c&&this.fd.appendChild(this.h9c);for(const r of this.children)r.visible&&(r.kG(),this.fd.appendChild(r.fd),r.kua());this.k3&&b&&this.o7l();h&&h.N2();this.dirty=!1}o7l(){if(this.k3.visible&&this.k3.children.count&&(this.wYh(0,0),this.g3l(this.ssa,this.k3,this.sza))){let b=0,h=0;const r=this.ssa?this.ssa.Nnc():0,A=this.sza?this.sza.Nnc():0;if(0<A||0<r)A>r?(b=0,h=A-r):
(b=r-A,h=0);this.wYh(b,h)}}g3l(b,h,r){let A=!1;0===this.root.textDirection?(b&&(A=b.B9d()>h.ube()),!A&&r&&(A=h.B9d()>r.ube())):(b&&(A=b.B9d()<h.ube()),!A&&r&&(A=h.B9d()<r.ube()));return A}wYh(b,h){0===this.textDirection?(this.k3.fd.style.marginLeft=b+"px",this.k3.fd.style.marginRight=h+"px"):(this.k3.fd.style.marginRight=b+"px",this.k3.fd.style.marginLeft=h+"px")}tRl(){this.kG()}Lw(){this.mmi(()=>{JE.a.prototype.Lw.call(this)})}Uwa(b){b=this.v5c(b);ef.c(b)||this.mmi(Object(E.a)(b,b.qo,"pollForStateAndUpdate"))}mmi(b){this.Auc=
this.Zdb=!1;b();if(this.Zdb||this.Auc)this.UWk||this.refresh(),this.scale()}kT(b){if(!Object(Pb.a)(EB,b)&&!Object(Pb.a)(rD,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Pb.a)(rD,b)&&b.alignment===jj.a.wib)for(const h of this.children)if(h.alignment===jj.a.wib)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.ZRd?(b+="cui-toolbar-onerow ",y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.ida||(b+="UITextTranformUpperCase ")):1===this.ZRd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get BCa(){return"div"}get cea(){return 26}get j7j(){return this.HS}set j7j(b){this.HS=b}lKl(b){b=b[jj.a.Qz];return new rD(this.root,b.Id,b)}kG(){super.kG();this.fd.setAttribute("role","toolbar");this.properties.Title&&this.fd.setAttribute("title",this.properties.Title)}uRa(b){return this.root&&this.root.Mxc(b)?!0:!1}I0o(){this.b2a()}scale(){super.scale();if(!Sg.a.zu(this.properties.Scale)||
this.i4e)return!1;ef.c(this.ssa)||(this.ssa.visible=!0,this.ssa.ZDf());ef.c(this.k3)||(this.k3.visible=!0,this.k3.ZDf());ef.c(this.sza)||(this.sza.visible=!0,this.sza.ZDf());this.XFj(!1);const b=this.fd.offsetWidth,h=ef.c(this.ssa)?0:this.ssa.Nnc(),r=ef.c(this.k3)?0:this.k3.Nnc(),A=ef.c(this.sza)?0:this.sza.Nnc();A+r+h>=b&&(A+h>=b?(this.LTi(this.k3),A>=b?(this.LTi(this.ssa),this.kAg(this.sza,b)):this.kAg(this.ssa,b-A)):this.kAg(this.k3,b-A-h));this.Zdb=!1;this.ro();return!1}LTi(b){b&&(b.visible=!1)}kAg(b,
h){b&&b.qTo(h)}}Object(u.a)(Sq,"Toolbar",Za.a,[1775]);class TH extends Sq{constructor(b,h,r,A,L=!1){super(b,h,r,!1,!1,A,L);this.oyh=!0}get cea(){return 7}get cssClass(){return TH.plp+" "+super.cssClass}static get plp(){let b="cui-statusbar";y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.ida||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(u.a)(TH,"StatusBar",Sq,[]);var xF=e(1471);class $L extends xF.a{constructor(){super();this.toolbar=null;this.tje=!1}}Object(u.a)($L,"ToolbarBuildContext",
xF.a,[]);class uv extends Fq.Builder{constructor(b,h,r,A){super(b,h,Fj.Task.T8(r),A);this.J9n=L=>{this.KEg(this.wol(L.Rld,L.EZc));this.toolbar.j7j=this;this.toolbar.ro();this.placeholder.appendChild(this.toolbar.fd);Sg.a.Gg(this.placeholder,"loaded");this.BBa.continueWith(()=>{this.BBa.result.eZb(this.toolbar)},11)};if(ef.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}KEg(b){this.root=b}get PMg(){return this.options}tol(){const b=new $L,
h=new Rq.a;h.id="toolbar";h.ymd=1;h.handler=this.J9n;h.data=b;this.rCa.oze(h)}wol(b,h){var r=jj.a.tna(b,jj.a.Epk);ef.c(r)&&(r=jj.a.tna(b,jj.a.Rok),h.tje=!0);if(ef.c(r))throw Error.create("No toolbar element was present in the data");b=new jj.a(r);r=y.AFrameworkApplication.J.$("ToolbarScalingRedundancyEliminationIsEnabled");h.tje?this.KEg(new TH(b.attributes[jj.a.id],b.attributes,this,this.Pfa,r)):this.KEg(new Sq(b.attributes[jj.a.id],b.attributes,this,this.PMg.olp,this.PMg.VEe,this.Pfa,r));this.toolbar.JBa=
this.options.JBa;this.toolbar.cJe=!0;this.toolbar.ro();b=jj.a.zz(jj.a.tna(b.node,jj.a.blk));h=this.Zll(b,h);for(const A of h)this.toolbar.pg(A);return this.toolbar}Zll(b,h){const r=[];for(let A=0;A<b.length;A++)this.SZa(b[A])||Array.add(r,this.Dml(b[A],h));return r}Dml(b,h){const r=jj.a.T6c(b);let A=null;r===jj.a.xjk?A=this.iml(b,h):r===jj.a.Mlk&&(A=this.anl(b,h));return A}anl(b,h){var r=new jj.a(b);r=new EB(this.root,r.attributes[jj.a.id],b[jj.a.Qz]);r.FTi=this.PMg.XRn;b=jj.a.tna(b,jj.a.DDb);b=jj.a.zz(b);
const A=[];for(let ba=0;ba<b.length;ba++){var L=b[ba];this.SZa(L)||(L=this.ima(L,h),Array.add(A,L))}r.f9c=A;return r}iml(b,h){new jj.a(b);const r=this.toolbar.lKl(b);b=jj.a.tna(b,jj.a.DDb);b=jj.a.zz(b);for(let A=0;A<b.length;A++){if(this.SZa(b[A]))continue;const L=this.uol(b[A],h);r.pg(L)}return r}uol(b,h){var r=new jj.a(b);const A=r.name;r=r.attributes[jj.a.VEc];let L;L=h.tje?"Small14":"Small";switch(A){case jj.a.button:return b=this.ima(b,h),b.KY(ef.b(r)?L:r);case jj.a.mMa:return L=h.tje?"Medium14":
"Medium",b=this.ima(b,h),b.KY(ef.b(r)?L:r);case jj.a.label:return b=this.ima(b,h),b.KY(ef.b(r)?L:r);case jj.a.separator:return b=this.ima(b,h),b.KY("Small");case jj.a.toggleButton:return b=this.ima(b,h),b.KY(ef.b(r)?L:r);default:throw Error.create("Invalid control type.");}}}Object(u.a)(uv,"ToolbarBuilder",Fq.Builder,[]);var yF=e(2104);class Ag{constructor(b,h,r,A,L,ba){this.pyb=()=>{this.toolbar.qo()};this.AM=b;b=new ge.a(Rl.a.Q8a,WacWordeditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);
A=new wK;A.KK={};ba=3!==ba.mode;A.KK.HeaderToolbarControlsRight=ba;A.KK.HeaderToolbarButtonDockRight=ba;A.KK.HeaderToolbarButtonRemovePageNumbers=ba;L=new uv(A,this.AM,this,L);L.rCa=new yF.a(Ag.i6m,b);L.tol();this.Fsa=L.toolbar;r.execute(ra=>{this.toolbar.nJ=ra});this.toolbar.refresh();this.toolbar.qo();this.mi=h;h.GVa(this.pyb)}get toolbar(){return this.Fsa}dispose(){this.mi.cyc(this.pyb);this.toolbar&&(this.toolbar.dispose(),this.Fsa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.I0o()}r0l(){this.toolbar.B8()}eZb(){}}
Ag.i6m="WordEditorHeaderToolbarData";Object(u.a)(Ag,"HeaderFooterToolbar",null,[172,607]);class Ms{constructor(b,h,r,A,L){this.mi=b;this.ORe=h;this.Qd=r;this.Pfa=A;this.ga=L}create(b){return new Ag(b,this.mi,this.ORe,this.Qd,this.Pfa,this.ga)}}Object(u.a)(Ms,"Factory",null,[577]);class sD{constructor(b,h){this.td=b;this.km=h}jQl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.iQl(b)+
"</Controls></MenuSection></Menu>"}RAm(b){const h=this.td.Lm();h.set(b);h.Ib(8);h.xd(8);return h}iQl(b){if(!b)return"";let h="";b=this.RAm(b);this.km.HXa(b,r=>{const A=this.km.uPi(r);r=r.getValue(Rc.a.Axa);h+=Zh.k(r.toString(),r.toString(),Lc.a.iCg.toString(),Lc.a.xrg.toString(),String.format(WacWordeditorStrings.HeaderToolbarSectionButtonLabel,A));return!0});return h}}Object(u.a)(sD,"HeaderFooterToolbarGenerator",null,[576]);var xK=e(139);class zF extends hF.a{constructor(b,h,r,A,L,ba,ra){super(b,
h,r,A);this.Jv=()=>{this.mwd(this.Jb)};this.AM=b.container;this.az=document.createElement("div");this.LR(this.az);this.gJa=L;this.hTa=ba;this.Zo.execute(Ia=>{Ia.UW(this.Jv)});this.eba=ra;this.AM.style.backgroundColor=this.eba.Vmc()}dispose(){super.dispose();this.Zo.instance&&this.Zo.instance.NPa(this.Jv)}get Zo(){return null!=this.B0g?this.B0g:this.B0g=Xa.a.instance.Za("Common.IZoomManager")}OD(b){this.AM.classList.add("HeaderFooterViewElement");this.az.classList.add("HeaderFooterViewContent");this.mwd(b.currentNode)}E8(b){this.az.parentNode&&
this.az.parentNode===this.AM||(this.AM.appendChild(this.az),this.hTa.instance&&this.hTa.instance.OEg(this.rc,this.AM));super.E8(b)}mQb(b){xK.a.Ae(()=>{xK.a.prototype.mQb.call(this,b);this.wbk();this.hTa.instance&&this.hTa.instance.zak(this.rc,this.az.style.paddingLeft,this.az.style.paddingTop)},"HFVE:UFO")}mwd(b){this.Zo.instance&&this.Zo.instance.byd(this.az);this.wbk();b=this.gJa.rnc(b);this.az.style.paddingLeft=b.Shc+"px";this.az.style.width=b.DZc+"px";this.hTa.instance&&this.hTa.instance.zak(this.rc,
this.az.style.paddingLeft,this.az.style.paddingTop)}wbk(){if(this.Zo.instance){this.az.style.paddingTop="";var b=Lj.a.JB(this.az);b.paddingTop&&(b=eb.a.LW(b.paddingTop),this.az.style.paddingTop=Math.round(b/this.Zo.instance.Ql)+"px")}}}Object(u.a)(zF,"HeaderFooterViewElement",hF.a,[]);class Tq{constructor(b,h,r){this.gJa=b;this.hTa=h;this.eba=r}create(b,h,r,A){return new zF(b,h,r,A,this.gJa,this.hTa,this.eba)}}Object(u.a)(Tq,"Factory",null,[575]);var Vt=e(333),tD=e(208),AF=e(832),uD=e(602);class cA extends Vt.a{constructor(b,
h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie){super(h,ba,ra,Ia,Ta,tD.a.DUi,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie);this.isHeader=this.isHeader=b;this.a7a=L;this.a7a.yud=this;A(this);this.XBd=r;this.iIa=document.createElement("div");this.iIa.setAttribute("Unselectable","on");this.iIa.setAttribute("hideselection","hideselection");this.iIa.setAttribute("style","outline:none;");this.iIa.innerText=WacWordeditorStrings.HeaderFooterNoContentAvailableMessage;this.iIa.tabIndex=0;this.features.gZj=!0;this.features.rqf=
!0}get P1f(){return!0}WSf(){const b=this.XBd.hJf(this);return AF.a.OI(this,b)}RAf(b){Object(Pb.a)(cA,b)||this.XBd.dismiss()}get cWf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}t7c(){return uD.a.Vjj}zx(){super.zx();this.a7a.aqi()}qC(b,h=null){this.iIa.parentNode&&this.iIa.parentNode.removeChild(this.iIa);super.qC(b,h);this.a7a.Mpi(this.Fd.ml)}detach(){this.a7a.$pi();super.detach();this.iIa.parentNode||this.container.insertBefore(this.iIa,this.container.firstChild)}Jrd(){this.Ly?
super.Jrd():this.iIa.focus()}H7d(){this.zx()}}Object(u.a)(cA,"HeaderFooterView",Vt.a,[605,130,131,90,11,132,133,134,135]);class vD{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd){this.XBd=b;this.HYk=h;this.GYk=r;this.LA=A;this.zd=L;this.Hsa=ba;this.ga=ra;this.E5a=Ia;this.OAa=Ta;this.pba=ob;this.iZk=nb;this.Qv=Eb;this.$H=bc;this.yg=Bc;this.Ii=Yc;this.OBd=zd}create(b,h){return new cA(b,h,this.XBd,this.HYk,this.GYk(),this.LA,this.zd,this.Hsa,this.ga,this.E5a,this.OAa,this.pba,this.iZk,this.Qv,
this.$H,this.yg,this.Ii,this.OBd)}}Object(u.a)(vD,"Factory",null,[574]);class wD{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie){this.ZDh=!1;this.eLh="SourceControlId";this.nsp=1;this.osp=1E3;this.xve=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;this.BFd(sf[this.eLh]);sf[Pf.a.Text]=this.s6e.Qeo(this.nmb.LUb);return 32};this.cso=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;sf[bg.a.On]=this.nmb.LUb;return 32};this.Yan=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;this.nmb.sFp(sf[bg.a.On]);return 32};this.HIj=
(re,me,Sd)=>{if(1===Sd)return 32;if(this.qfa){me=Object(ao.a)().kw(me.view.Fd);Sd=te.a.kb(me);const cf=this.me.I8a();try{const sf=this.Zc.Vc(15);try{sf.Eb(me),sf.Bh=re,Ap.a.instance.HXa(Sd,yh=>{this.mbc.bod(yh,this.ovm,this.Z1o);return!0})}finally{sf&&sf.dispose()}}finally{cf&&cf.dispose()}}return 32};this.Nkd=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;sf.MenuItems=this.vOk.value;this.ZDh?this.nmb.JNo():this.ZDh=!0;return 32};this.Shn=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;const yh=this.BFd(sf[this.eLh]);
if(this.qfa){me=Object(ao.a)().kw(me.view.Fd);Sd=te.a.kb(me);cf=this.Zc.Vc(15);try{cf.Eb(me);cf.Bh=re;let si=null;const cl=this.qe.rg("UserAction","InsertPageNumber");Ap.a.instance.HXa(Sd,Pj=>{this.qfa.Qga||this.DAk(Pj);si=this.r6e.Qhn(Pj,yh,this.nmb.LUb)||si;return!0});cl.stop();if(!si)return 8;this.xep(si,yh)}finally{cf&&cf.dispose()}this.me.Vv(12)}return 32};this.Peo=()=>32;this.hfp=(re,me,Sd,cf,sf)=>{if(1===Sd)return 32;2===Sd&&this.pUa.showCallout(sf);return 32};this.gfp=(re,me,Sd,cf,sf,yh)=>
this.Qaf.create(re,me,Sd,cf,sf,yh);this.u0l=(re,me,Sd)=>{if(1===Sd)return 32;this.pUa.sli();return 32};this.mdp=re=>{y.AFrameworkApplication.va.Oia(null,Lc.a.H_j,re.customData,null)};this.ovm=re=>{const me=Fg.a.instance.ob.currentSelection;let Sd=-1;for(const cf of me)if(cf.node===re){Sd=cf.cpBegin;break}return{returnValue:Sd,bie:Ee.a.qn(me)}};this.Z1o=(re,me)=>{re=Tb.SelectionFactory.Ie(re,me);Fg.a.instance.Uc(re)};this.ga=b;this.Zc=h;this.Sb=r;this.nmb=A;this.qfa=L;this.tq=ba;this.s6e=ra;this.r6e=
Ia;this.mbc=Ta;this.pUa=ob;this.pb=nb;this.Qaf=Eb;this.qe=bc;this.me=Bc;this.BFd=Yc;this.DAk=ie;this.vOk=new xe.a(()=>this.nmb.qKm())}mc(){this.ga.nb(Lc.a.Nkd,ic.a.view,this.Nkd,100);this.ga.nb(Lc.a.vwj,ic.a.view,this.Peo,68);this.ga.nb(Lc.a.XXi,ic.a.view,this.Shn,4);this.ga.nb(Lc.a.LUb,ic.a.view,this.Yan,4);this.ga.nb(Lc.a.bod,ic.a.view,this.HIj,4);this.ga.nb(Lc.a.qHo,ic.a.view,this.HIj,4);this.ga.nb(Lc.a.$rg,ic.a.application,this.cso,97);this.ga.nb(Lc.a.xve,ic.a.application,this.xve,97);this.ga.nb(Lc.a.G_j,
ic.a.view,this.hfp,4);this.ga.uY(Lc.a.H_j,ic.a.view,this.gfp,100);this.ga.nb(Lc.a.t0l,ic.a.view,this.u0l,4)}xep(b,h){const r=b.Rb.paragraph;if(r){var A=this.tq.Wgd(r);A&&this.qfa.cna(A)}A=this.qfa.Qga;this.qfa.show(4>h);r&&this.k1o(r)&&(this.y5o(b,r),this.o5k(b,A))}k1o(b){let h;if(!({isHeader:h,HLg:b}=this.tq.INi(b)).returnValue)return!1;this.qfa.kGa(b,h);return!0}y5o(b,h){b=Tb.SelectionFactory.Ie(h,b.Rb.cp);this.pb.Uc(b)}o5k(b,h){h=new Md.a(2,1,h?this.nsp:this.osp,this.mdp);h.customData=b;this.Sb.pc(h)}}
Object(u.a)(wD,"PageNumbersActor",null,[606]);class lw{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){this.ga=b;this.Sb=h;this.nmb=r;this.s6e=A;this.r6e=L;this.mbc=ba;this.pUa=ra;this.Qaf=Ia;this.tq=Ta;this.me=ob;this.BFd=nb;this.RXk=Eb;this.Ela=bc}create(b,h){return new wD(this.ga,new gm.a,this.Sb,this.nmb,b,this.tq,this.s6e,this.r6e,this.mbc,this.pUa,Fg.a.instance,this.Qaf,Db.StaticActiveAppFrame.Aa().Kt,this.me,this.BFd,this.RXk,this.Ela,h)}}Object(u.a)(lw,"Factory",null,[573]);var mw=e(2003),
Xy;(function(b){b[b.small=0]="small";b[b.Mfq=1]="mediumSmall";b[b.eu=2]="medium";b[b.DZ=3]="large"})(Xy||(Xy={}));Object(u.b)("ModalCalloutSize",Xy);var Yy;(function(b){b[b.PGe=0]="topCenter";b[b.iyq=1]="topJustified";b[b.jyq=2]="topLeft";b[b.kyq=3]="topRight";b[b.Iof=4]="bottomCenter";b[b.t1p=5]="bottomLeft";b[b.u1p=6]="bottomRight"})(Yy||(Yy={}));Object(u.b)("BeakLocation",Yy);class BF{constructor(b,h,r){this.msp=1;this.X8e=!1;this.Ecc=null;this.NBo=()=>{this.pb.BD(this.Wwa);this.X8e=!0;this.Ecc=
null};this.Wwa=(A,L)=>{if(A=L.Pn.currentSelection)1<A.length||!A.length?A=!0:(A=A.Ya,A=A.cpEnd-A.cpBegin,A=1<A||!A),A&&this.Bzk()};this.Sb=b;this.pb=h;this.Bzk=r}bD(){this.n5k()}Mea(){this.X8e?(this.pb.vpa(this.Wwa),this.X8e=!1):this.Ecc&&(this.Sb.Kf(this.Ecc),this.Ecc=null)}n5k(){this.Ecc=new Md.a(2,1,this.msp,this.NBo);this.Sb.pc(this.Ecc)}}Object(u.a)(BF,"CalloutDismissManager",null,[]);class dA{constructor(b,h,r,A){this.dismiss=()=>{this.RL&&(this.iJc.Mea(),this.Jgd.dismiss())};this.Jgd=b;this.Tq=
A;this.iJc=new BF(h,r,this.dismiss)}get RL(){return this.Jgd.RL}show(){if(!this.RL){const b=document.createElement("div");b.classList.add(dA.Oeo);b.innerText=WacWordeditorStrings.PageNumbersCalloutText;this.Jgd.content=b;this.Jgd.show();this.Tq&&this.Tq.sendNotification(WacWordeditorStrings.PageNumbersCalloutText,!0);this.iJc.bD()}}dispose(){this.dismiss();this.Jgd.dispose()}static XNl(b,h){h=mw.a.Tei(ed.a.getElementBounds(b.targetElement),h,Db.StaticActiveAppFrame.Aa().VH,Xy.small);h.dma=dA.IKf(b);
h.hv=!1;return h}static IKf(b){let h=Yy.Iof;Object(Pb.a)(605,b.view)&&b.view.isHeader&&(h=Yy.PGe);return h}}dA.Oeo="PageNumbersCalloutControl";Object(u.a)(dA,"PageNumbersCallOutControl",null,[604]);class yK{constructor(b,h,r){this.dY=null;this.WX=!1;this.dismiss=()=>{this.RL&&this.dY&&Tk.UISurfaces.tN().then(A=>{this.iJc.Mea();A.removeNotification(this.dY);this.WX=!1;return null},A=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",A);return null})};this.Xl=b;this.iJc=
new BF(h,r,this.dismiss)}get RL(){return this.WX}show(){this.RL||Tk.UISurfaces.tN().then(b=>{const h=b.callout(Object.assign(new Sr.a,{target:this.Xl,content:WacWordeditorStrings.PageNumbersCalloutText})),r=Object.assign(new Wl.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.WX=!0},expirationOptions:Object.assign(new Mj.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.dY=b.addNotification(h,r);this.iJc.bD();return null},b=>{v.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",
b);return null})}}Object(u.a)(yK,"ReactPageNumbersCallOutControl",null,[604]);class CF{constructor(b,h,r){this.pb=h;this.Sb=b;this.Tq=r}create(b,h){if(y.AFrameworkApplication.ta.Pb&&y.AFrameworkApplication.ta.Pb.ZZa)return new yK(h.targetElement,this.Sb,this.pb);b=dA.XNl(h,b);return new dA(b,this.Sb,this.pb,this.Tq,y.AFrameworkApplication.ta.EU)}}Object(u.a)(CF,"Factory",null,[572]);class zK{constructor(b,h){this.dI=null;this.uOk=b;this.Fk=h}get control(){return this.dI}showCallout(b){this.control&&
this.control.RL&&this.control.dismiss();this.dI=this.Rmo(b);this.control.show()}sli(){this.control&&(this.control.dismiss(),this.dI=null)}Rmo(b){const h=this.Fk.Cua();this.dI=this.uOk.value.create(h,b);return this.control}}Object(u.a)(zK,"PageNumbersCalloutControlManager",null,[571]);var FB=e(790);class eA extends BB.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(u.a)(eA,"PageNumberGalleryButtonProps",BB.a,[]);const nw=(b,h,r)=>{b=b.Lm();b.set(r);h.vYb(b);return b};class xl{constructor(b,
h,r){this.QYe=!1;this.Ela=h;this.zn=r}get LUb(){return this.QYe}qKm(){const b=Object.assign(new dk.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.O2k());b.MenuSectionList.push(this.I3k());b.MenuSectionList.push(this.l4k());return b}sFp(b){this.QYe=b;this.UFj()}JNo(){this.QYe=!1;const b={};b[xl.KVi]="CheckboxModel";this.Ela(b);this.UFj()}O2k(){const b=Object.assign(new Zd.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:D.a.Mf(WacWordeditorStrings.PageNumbersSectionHeaderForAdd),
ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new FB.a,{Id:xl.Zan,Command:Lc.a.LUb.toString(),QueryCommand:Lc.a.$rg.toString(),LabelText:D.a.Mf(WacWordeditorStrings.IncludePageCount),Alt:D.a.Mf(WacWordeditorStrings.IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}I3k(){const b=Object.assign(new Zd.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
h=Object.assign(new Ul.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.zn){for(var r=3;1<=r;r--)h.GalleryItems.push(this.oNf(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.oNf(r))}else for(r=1;6>=r;r++)h.GalleryItems.push(this.oNf(r));b.ControlList.push(h);return b}l4k(){const b=Object.assign(new Zd.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",
ControlList:[]}),h=Object.assign(new qg.a,{Id:"btnRemovePageNumber",Command:Lc.a.bod.toString(),LabelText:D.a.Mf(WacWordeditorStrings.RemovePageNumbers),Alt:D.a.Mf(WacWordeditorStrings.RemovePageNumbersAlt),Image16by16:y.AFrameworkApplication.mr,Image16by16Class:Ye.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}oNf(b){const h=xl.xmg+b.toString();var r=Object,A=r.assign,L=new eA,ba=Lc.a.XXi.toString(),ra=Lc.a.xve.toString(),
Ia=D.a,Ta=Ia.Mf;let ob="";switch(b){case 1:ob=WacWordeditorStrings.PageNumbersOnTopLeftAlt;break;case 2:ob=WacWordeditorStrings.PageNumbersOnTopCenterAlt;break;case 3:ob=WacWordeditorStrings.PageNumbersOnTopRightAlt;break;case 4:ob=WacWordeditorStrings.PageNumbersOnBottomLeftAlt;break;case 5:ob=WacWordeditorStrings.PageNumbersOnBottomCenterAlt;break;case 6:ob=WacWordeditorStrings.PageNumbersOnBottomRightAlt}return A.call(r,L,{Id:h,Command:ba,QueryCommand:ra,Alt:Ta.call(Ia,ob)})}UFj(){const b={};for(let h=
1;6>=h;h++)b[xl.xmg+h.toString()]="PageNumberGalleryButtonModel";b[xl.KVi]="CheckboxModel";this.Ela(b)}static rKm(b){return b?parseInt(b.substr(xl.xmg.length)):1}}xl.Zan="btnIncludePageCount";xl.KVi="IncludePageCount";xl.xmg="btnPageNumbersPosition";Object(u.a)(xl,"PageNumbersControl",null,[570]);class ct{constructor(b,h,r,A,L=null,ba=null,ra=null,Ia=null){this.rBm=(Ta,ob)=>{const nb=new ii.a;Ta=4>Ta;switch(ob){case 1:case 2:nb.add(Ta?0:3);break;case 3:case 4:nb.add(Ta?0:3),nb.add(Ta?1:4)}return nb};
this.Qtm=(Ta,ob,nb)=>{var Eb=nw(this.td,this.tq,Ta);this.tq.wYb(Eb,nb);let bc=this.Qxk(Eb,ob);if(bc)this.mbc.lJj(bc);else{Eb=nw(this.td,this.tq,Ta);this.tq.wYb(Eb,nb);Eb.ue();if(Mb.a.ji(Eb)&&(hg.a.Ze(Eb),rd.ParagraphReader.Wh(Eb))){Eb=Eb.currentNode;const Bc=this.MNi(ob);rd.ParagraphReader.VA(Eb)===Bc&&this.mbc.lJj(Eb)&&(bc=Eb)}bc||(Eb=nw(this.td,this.tq,Ta),this.tq.wYb(Eb,nb),this.xP.bVb(Eb,null,!0),bc=hg.a.Ze(Eb),this.qJ(ob,bc))}return bc};this.Rtm=(Ta,ob)=>{let nb=null;Ta.ic(1);if(Mb.a.ji(Ta)&&
(Ta.ic(2),Qh.TableReader.isTable(Ta))){var Eb=Ta.currentNode;if(3===Qh.TableReader.Nh(Eb)){let bc=0;Eb=Qh.TableReader.Rp(Eb);switch(ob){case 1:case 4:bc=Eb?2:0;break;case 2:case 5:bc=1;break;case 3:case 6:bc=Eb?0:2}Lh.h(Ta,0,bc);Ta.currentNode&&Mb.a.ji(Ta)&&(Ta=hg.a.Ze(Ta),rd.ParagraphReader.lc(Ta)&&(nb=Ta))}}return nb};this.Lrn=(Ta,ob)=>{const nb=nw(this.td,this.tq,Ta);Ta=nb.currentNode.ka(Rc.a.Axa,0);this.tq.wYb(nb,ob);ob=nb.currentNode.ka(Rc.a.Axa,0);return Ta===ob};this.td=b;this.wOk=h;this.mbc=
r;this.tq=A;this.hLc=L||this.rBm;this.Rxk=ba||this.Qtm;this.Qxk=ra||this.Rtm;this.oHk=Ia||this.Lrn}get xP(){return null!=this.s6g?this.s6g:this.s6g=Xa.a.instance.resolve("Box4.IOutlineEditor")}Qhn(b,h,r){var A=nw(this.td,this.tq,b).Jr;A=this.tq.rDa(A);A=this.hLc(h,A);let L=null;for(let ra=0;ra<A.length;ra++){var ba=A.Lg(ra);this.oHk(b,ba)&&(ba=this.Rxk(b,h,ba),L=this.wOk.H3k(ba,r)||L)}return L}qJ(b,h){ct.Q2.Ord(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);ct.gm.qJ(h,
this.MNi(b))}MNi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get gm(){return null!=ct.v7g?ct.v7g:ct.v7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}static get Q2(){return null!=ct.u9g?ct.u9g:ct.u9g=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(u.a)(ct,"PageNumbersInserter",null,[569]);var xu=e(917),AK=e(921);class vv{constructor(b,h,r=null,A=null,L=null){this.IJl=(ba,ra)=>{ba=vc.a.jd(ba,rd.ParagraphReader.textLength(ba));
const Ia=ba.node.ed;return Ia?vv.Ug.Vna(ba,Ta=>{Ta=AK.a.getInstance(Ta,xu.a.KMf(ra));this.O0d(Ta,15,Ia,ra);this.O0d(Ta,47,Ia,ra);this.O0d(Ta,16,Ia);this.O0d(Ta,17,Ia);return Ta}):null};this.Ain=(ba,ra)=>{ba=vc.a.jd(ba,rd.ParagraphReader.textLength(ba));vv.Ug.lf(ba,ra)};this.Zc=b;this.eMd=r||WacWordeditorStrings.PageNumbersPreviewTextForIncludeCount;this.IRe=A||this.IJl;this.WMh=L||this.Ain}H3k(b,h){const r=this.Zc.Vc(15);r.Eb(b);var A=rd.ParagraphReader.text(b),L=!1;0<A.length&&" "!==A.charAt(A.length-
1)&&(L=!0);if(h){h=String.format(this.eMd,"#","$");L&&(h=" "+h);L=h.indexOf("#");A=h.indexOf("$");v.ULS.shipAssertTag(4256717,309,-1!==L,"{0}",{["PageNumberIndex"]:L});v.ULS.shipAssertTag(4256718,309,-1!==A,"{0}",{["PageCountIndex"]:A});v.ULS.shipAssertTag(4256719,309,L!==A,"{0}",{["PageNumberIndex"]:L,["PageCountIndex"]:A});let Ia;let Ta;if(L<A){var ba=L;Ia=A;var ra=xu.a.N5c(0);Ta=xu.a.N5c(1)}else ba=A,Ia=L,ra=xu.a.N5c(1),Ta=xu.a.N5c(0);this.yZf(b,h,0,ba);ra=this.IRe(b,ra);this.yZf(b,h,ba+1,Ia);
ba=this.IRe(b,Ta);this.yZf(b,h,Ia+1,h.length);b=L<A?ra:ba}else L&&this.WMh(b," "),b=this.IRe(b,xu.a.N5c(0));r.dispose();return b}O0d(b,h,r,A=null){const L=new Wr.a;L.setValue(Sb.a.Gea,!0);L.setValue(Rc.a.uRb,1);L.setValue(Rc.a.gu,h);switch(h){case 15:L.setValue(Rc.a.d_a,!0);L.setValue(Rc.a.G4,A);break;case 47:L.setValue(Rc.a.G4,A);break;case 17:L.setValue(Rc.a.AWb,!0)}h=r.Mv(L,V.a.create());this.D4k(b,h)}D4k(b,h){b.gBa(h,V.a.nil,wm.AParagraphNode.jG,null)}yZf(b,h,r,A){h=h.substring(r,A);0<h.length&&
this.WMh(b,h)}static get Ug(){return vv.ee||(vv.ee=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set Ug(b){vv.ee=b}}vv.ee=null;Object(u.a)(vv,"PageNumbersNodeLevelInserter",null,[568]);class ep{Qeo(b){return ep.WMm(b)}static WMm(b){return String.format(b?WacWordeditorStrings.PageNumbersPreviewTextForIncludeCount:WacWordeditorStrings.PageNumbersPreviewText,ep.mwj,ep.mwj)}}ep.mwj="1";Object(u.a)(ep,"PageNumbersPositionPreviewGenerator",null,[567]);class DF{constructor(){this.uhh=
String.format(WacWordeditorStrings.PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.nxk=this.uhh.length}t5m(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===rd.ParagraphReader.textLength(b)?{returnValue:!0,Qkd:h}:{returnValue:!1,Qkd:-1}}S3m(b){let h=b.characterData.lastIndexOf(this.uhh);return-1!==h&&h+this.nxk===rd.ParagraphReader.textLength(b)?{returnValue:!0,Qkd:h}:{returnValue:!1,Qkd:-1}}Q4m(b){return kp.a(b,9)?!0:!1}}Object(u.a)(DF,"PageNumbersReader",null,[566]);
class Ox{constructor(b,h,r,A,L,ba=null,ra=null){this.pHo=(Ia,Ta,ob,nb)=>{Ia=nw(this.td,this.tq,Ia);this.tq.wYb(Ia,Ta);Ta=zp.a.Zr(Ia);for(Ia=!1;Ta.moveNext();){const Eb=Ta.currentNode;if(rd.ParagraphReader.lc(Ta.currentNode)&&kp.a(Ta.currentNode,9)){Ia=!0;let bc;const Bc=({bie:bc}=ob(Eb,bc)).returnValue;let Yc=Bc;Yc=this.XFo(Eb,Yc);Yc=this.OHo(Eb,Yc);-1<Bc&&(Yc===Bc&&bc||nb(Eb,Yc))}}Ia&&this.me.Vv(12)};this.td=b;this.tq=h;this.t6e=r;this.me=A;this.pRc=L;this.hLc=ba||CB.a.bAf;this.PQk=ra||this.pHo;
this.eMd=WacWordeditorStrings.PageNumbersPreviewTextForIncludeCount;this.poh=String.format(this.eMd,"#","$");this.BFk=this.poh.indexOf("#");this.AFk=this.poh.indexOf("$");this.cWe=String.format(this.eMd,"\ufffc","\ufffc");this.ioh=this.cWe.length}bod(b,h,r){var A=nw(this.td,this.tq,b).Jr;A=this.tq.rDa(A);A=this.hLc(A);for(const L of A)this.PQk(b,L,h,r)}lJj(b){if(this.t6e.Q4m(b)){let h=-1;if(({Qkd:h}=this.t6e.S3m(b)).returnValue&&this.Z5h(b,h)||({Qkd:h}=this.t6e.t5m(b)).returnValue&&this.Gul(b,h))return!0}return!1}OHo(b,
h){var r=b.ra.length;for(let L=0;L<r;L++){var A=b.ra.jc(L);A.blob&&9===A.blob.xi&&(A=A.cp,r=vc.a.createTextRange(b,A,A+1),this.pRc(r,""),r=b.ra.length,L--,h=this.SVh(h,A,1))}return h}XFo(b,h){let r=b.characterData.indexOf(this.cWe);for(;-1!==r;)this.Z5h(b,r)&&(h=this.SVh(h,r,this.ioh)),r=b.characterData.indexOf(this.cWe);return h}Gul(b,h){const r=b.ra.Vh(h);return r&&r.blob&&9===r.blob.xi?(b=vc.a.createTextRange(b,h,h+1),this.pRc(b,""),!0):!1}Z5h(b,h){const r=b.ra.Vh(h+this.BFk),A=b.ra.Vh(h+this.AFk);
return r&&r.blob&&9===r.blob.xi&&A&&A.blob&&9===A.blob.xi?(b=vc.a.createTextRange(b,h,h+this.ioh),this.pRc(b,""),!0):!1}SVh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(u.a)(Ox,"PageNumbersRemover",null,[565]);class xD{constructor(b,h){this.fEb=this.eEb=null;this.mu=b;this.Sb=h}Pal(){this.mu.style.display="";this.eEb||(this.fEb&&(this.Sb.Kf(this.fEb),this.fEb=null),this.eEb=new Md.a(0,1,10,()=>{this.mu.classList.add("Displayed");this.eEb=null}),this.Sb.pc(this.eEb))}Ral(){this.mu.classList.remove("Displayed");
this.fEb||(this.eEb&&(this.Sb.Kf(this.eEb),this.eEb=null),this.fEb=new Md.a(0,1,200,()=>{this.mu.style.display="none";this.fEb=null}),this.Sb.pc(this.fEb))}}Object(u.a)(xD,"PaneControlAnimationHelper",null,[493]);class GB{constructor(b){this.Sb=b}wKm(b){return new xD(b,this.Sb)}}Object(u.a)(GB,"PaneControlAnimationHelperFactory",null,[462]);class UH{constructor(b,h,r,A,L,ba,ra,Ia,Ta=!1){this.och=this.Fsa=this.XFd=null;this.$5m=()=>{this.ry.sendNotification(this.och+" "+WacWordeditorStrings.EditingSurfaceAccessibilityDescribedByText,
!0)};this.ga=b;this.saa=h;this.saa.bind(this);this.l_e=r;this.pAa=L;this.Vdf=ra;this.oc=Ia;this.qHd=Ta;this.Ika=ba.value.create(r,A);this.saa.Ajl(this.Ika);this.y3=lc.KeyInputManager.xc(pg.a.H6,0)}get ry(){return null!=this.UWg?this.UWg:this.UWg=Xa.a.instance.resolve("Common.Utils.IAriaNotifier")}d6(b){this.saa.d6(b);this.Fsa&&!b&&this.Fsa.r0l()}cna(b){this.XFd!==b&&(this.irb(),this.XFd=b)}eSj(b){if(this.XFd){var h=this.pAa.FSb(this.XFd,CB.a.qBm(b,this.l_e));this.qHd?(this.och=this.Nxi(b,this.l_e),
this.Ika.b2b(le.a.kWd)):this.ZBp(b);h&&this.Pmf(h)}}g_h(b){this.qHd&&this.oc&&(b=this.oc.te(b))&&b.Eba(this.$5m)}Nxi(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WacWordeditorStrings.DefaultHeaderScreenReaderMessageForReadOnly:WacWordeditorStrings.DefaultFooterScreenReaderMessageForReadOnly:h?WacWordeditorStrings.DefaultHeaderScreenReaderMessage:WacWordeditorStrings.DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WacWordeditorStrings.FirstPageHeaderScreenReaderMessageForReadOnly:
WacWordeditorStrings.FirstPageFooterScreenReaderMessageForReadOnly:h?WacWordeditorStrings.FirstPageHeaderScreenReaderMessage:WacWordeditorStrings.FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WacWordeditorStrings.EvenPagesHeaderScreenReaderMessageForReadOnly:WacWordeditorStrings.EvenPagesFooterScreenReaderMessageForReadOnly:h?WacWordeditorStrings.EvenPagesHeaderScreenReaderMessage:WacWordeditorStrings.EvenPagesFooterScreenReaderMessage;break;case 4:r=3!==this.ga.mode?h?WacWordeditorStrings.OddPagesHeaderScreenReaderMessageForReadOnly:
WacWordeditorStrings.OddPagesFooterScreenReaderMessageForReadOnly:h?WacWordeditorStrings.OddPagesHeaderScreenReaderMessage:WacWordeditorStrings.OddPagesFooterScreenReaderMessage}return r}ZBp(b){this.Ika.vTj(this.Nxi(b,this.l_e),le.a.kWd)}MAb(){this.Ika.Jrd()}Pmf(b){this.irb();this.Ika.qC(b,b.ml)}irb(){this.Ika.detach()}sRl(){this.Fsa=this.Vdf.value.create(this.saa.VCc);this.B8o(this.Fsa)}B8o(b){if(this.oc){const h=this.oc.te(ws.a.Gbb);h.parent=Df.AFrame.rr;h.Rla(()=>{b.setFocus();this.K6o()});h.bindAction(this.y3,
Lc.a.PY)}}K6o(){if(this.oc){var b=this.oc.te(ws.a.Gbb);const h=new Ig.DOMFocusListing(()=>this.saa.VCc);h.$ia=!0;h.jo(1);this.oc.rpb(this.saa.VCc,b,h);b=this.oc.getRegion(ws.a.Gbb);b.s1a();b.nR=!0;h.hna&&h.eC(h.hna)}}dispose(){void 0!==this.Fsa&&null!==this.Fsa&&(this.oc.te(ws.a.Gbb).Pu(this.y3),this.Fsa.dispose())}iAo(){void 0!==this.Fsa&&null!==this.Fsa&&this.Fsa.refresh()}}Object(u.a)(UH,"PaneControl",null,[492]);class BK{constructor(b,h,r,A){this.tq=b;this.nEk=h;this.Vdf=r;this.oc=A}create(b,
h,r,A){return new UH(b,h,r,A,this.tq,this.nEk,this.Vdf,this.oc,y.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(u.a)(BK,"Factory",null,[461]);var CK=e(1122);class VH extends op.a{constructor(b,h,r,A,L,ba,ra,Ia,Ta){super();this.init(b);this.$m("ShowCalloutForPageNumberOperation");this.tsk=Ia;this.bvb(this.tsk,h,A,L,ba);this.jC=0;this.oUa=ba;this.pUa=ra;this.mi=Ta;1===this.behavior&&(this.Vt=32,this.Kxa())}run(){var b=this.mi.tb.py;if(!this.jC){var h=eF.a.umc(this.oUa,
b);this.oUa.U8c(h)?this.oUa.jDa(b,h).element&&(this.jC=1):this.jC=2}1===this.jC&&(h=eF.a.umc(this.oUa,b),h=this.oUa.jDa(b,h),b=new CK.a(h.element,b),this.pUa.showCallout(b),this.jC=2);2===this.jC&&(this.Vt=32,this.Kxa())}}Object(u.a)(VH,"ShowCalloutForPageNumberOperation",op.a,[]);class Px{constructor(b,h,r){this.pUa=b;this.ga=h;this.s6b=r}create(b,h,r,A,L,ba){return new VH(b,h,r,A,L,ba,this.pUa,this.ga,this.s6b)}}Object(u.a)(Px,"Factory",null,[460]);class Zy{get xP(){return null!=this.q6g?this.q6g:
this.q6g=Xa.a.instance.resolve("Box4.IOutlineEditor")}Ec(b){b.ja("WordEditor.HeaderFooter.HeaderFooterManager",()=>new vK(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.zf("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();
b.ja("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new vD(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),tK.a.Xtf,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Db.StaticActiveAppFrame.Aa().tb,Object(Vb.a)(),()=>b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Za("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Za("Common.IZoomManager"),b.Wa("Box4.IContentControlViewElementManager"),
b.Wa("Box4.CpConversionManagerImpl"),b.Wa("Box4.ContentControlConfigSettings"),b.Wa("Box4.IContentControlReader"),b.Wa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();b.ja("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Tq(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).as("WordEditor.IHeaderFooterViewElementFactory").ha();
b.ja("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new Ms(Pk.a.Xm,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Pk.a.Xm,y.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ja("WordEditor.HeaderFooter.PaneControl.Factory",()=>new BK(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.zf("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.zf("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),Jc.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();
b.ja("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new uF(()=>{Db.StaticActiveAppFrame.Aa().Ne()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),y.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ja("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new lw(y.AFrameworkApplication.va,vb.TaskManager.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),
b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,xl.rKm,Object(E.a)(Db.StaticActiveAppFrame.Aa(),
Db.StaticActiveAppFrame.Aa().Fwd,"updateRibbonControl"),Object(E.a)(Db.StaticActiveAppFrame.Aa(),Db.StaticActiveAppFrame.Aa().UH,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();b.ja("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new Lx).ha();b.ja("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new GB(vb.TaskManager.instance)).ha();b.ja("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new PH(Jc.FocusManager.instance(),Db.StaticActiveAppFrame.Aa().BA,
b.zf("WordEditor.HeaderFooter.IPaneControlFactory"),b.zf("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.zf("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),y.AFrameworkApplication.va,new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc),y.AFrameworkApplication.J,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ja("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new vF(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
fn.a.instance,new dj.a,Ap.a.instance)).ha();b.ja("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new sD(new dj.a,Ap.a.instance));b.ja("WordEditor.HeaderFooter.HeaderFooterActor",()=>new pD(y.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Ap.a.instance,new dj.a,new gm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),pD.tPi,
b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Tia,b.Za("Common.ISystemInitiatedFeedback"))).ha();b.ja("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Cp(qF.a.instance,Cp.GTm(b.resolve("Box4.ITableEditor")),Cp.irm(),y.AFrameworkApplication.isRtl,hg.a.xe,Cp.ARm(),Cp.fBm(),b.resolve("Box4.IOutlineElementEditor")));b.ja("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new qD.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
new dj.a,h=>this.xP.bVb(h,null,qD.a.HFg),y.AFrameworkApplication.isRtl,Object(E.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").u2b,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),b.resolve("Box4.Styles.IWACStyleEditor")));b.ja("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Ls(Ap.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();
b.ja("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new uK(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new dj.a,new gm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),y.AFrameworkApplication.va)).ha();b.ja("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new bA(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Ap.a.instance,new dj.a,y.AFrameworkApplication.va)).ha();b.ja("WordEditor.HeaderFooter.PageNumbersControl",
()=>new xl(Object(E.a)(Db.StaticActiveAppFrame.Aa(),Db.StaticActiveAppFrame.Aa().Fwd,"updateRibbonControl"),Object(E.a)(Db.StaticActiveAppFrame.Aa(),Db.StaticActiveAppFrame.Aa().UH,"updateRibbonControls"),y.AFrameworkApplication.isRtl)).ha();b.register(ep,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ja("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new vv(new gm.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ja("WordEditor.HeaderFooter.PageNumbersInserter",()=>new ct(new dj.a,
b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ja("WordEditor.HeaderFooter.PageNumbersReader",()=>new DF).ha();b.ja("WordEditor.HeaderFooter.PageNumbersRemover",()=>new Ox(new dj.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(E.a)(Zy.Ug,
Zy.Ug.lf,"replaceTextRange"))).ha();b.ja("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new zK(b.zf("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Db.StaticActiveAppFrame.Aa())).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();b.ja("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new CF(vb.TaskManager.instance,Fg.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();
b.ja("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new Px(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),y.AFrameworkApplication.va,Db.StaticActiveAppFrame.Aa())).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ja("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new Jx(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),y.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();
b.ja("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new sF(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get Ug(){return null!=Zy.sXg?Zy.sXg:Zy.sXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(u.a)(Zy,"HeaderFooterComponentConfiguration",null,[1]);class EF{constructor(){this.ZFd=this.Z=null}get name(){return"WordEditor.HeaderFooter"}Ec(b){this.Z=
b;(new Zy).Ec(b)}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(103)&&(this.ZFd=this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.ZFd.start(),this.Z.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.ZFd&&this.ZFd.dispose()}static main(){F.a.instance.Rc(new EF)}}Object(u.a)(EF,"PackageManager",null,[0,1]);var HB=e(523),DK=e(520);class FF{constructor(b,h){this.yg=b;this.wn=
h}create(){return new DK.a(this.yg.instance,this.wn.instance)}}Object(u.a)(FF,"ContentControlNodeFactory",null,[265]);var WH=e(1702),EK=e(404),FK=e(1074);class GF{create(){return new FK.a}}Object(u.a)(GF,"ContentControlContainerNodeFactory",null,[265]);var Ql=e(184),aM=e(412),$y=e(314),IB=e(227),XH=e(230),GK=e(1108);const HF=b=>b?(b=b.ka(Rc.a.FWa,null))&&b.includes(Ql.a.Aii):!1;class YH{constructor(b,h,r,A,L,ba,ra){this.Xua=b;this.Yf=h;this.Ug=r;this.Cma=A;this.DF=L;this.Qj=ba;this.iGl=ra;this.T1n=
(Ia,Ta)=>{hq.a.gia&&(Ia=Ta.node,Ta=te.a.kb(Ia),Ta.Ib(7)&&(Ta=Ta.xd(54)))&&(Ta=Ta.getValue(Rc.a.je),Ia=Ia.id,1==(null===Ta||void 0===Ta?void 0:Ta.length)&&Ia.equals(Ta[0])&&(Ia=this.Xua.RBi(),this.yji(Ia)))};this.nig=(Ia,Ta)=>{if(hq.a.gia)for(const ob of Ta.Fhi)HF(ob.je)||(Ia=ob.je.ka(Rc.a.FWa,null),this.yji(Ia))}}get G0f(){return y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Cma.vGj(this.nig);this.iGl.wY(this.T1n)}yji(b){const h=this.Xua.SSb();h&&
b&&this.Xua.QTb(h,b)&&(b=new hb.GraphTransaction(7),b.nw(h),h.qh(),b.dispose())}r_c(){const b=new GK.a;b.setValue(Rc.a.qZm,!0);var h=(h=qb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Rc.a.Qnc,h);b.setValue(Rc.a.bGl,this.G0f);h=qb.a.create();b.setValue(Rc.a.WPi,h);return b}Snl(b){const h=b.currentNode.getValue(Rc.a.WPi);b.pg(new aM.a,1);b.g9();b.currentNode.setValue(Rc.a.qmi,h);b.pg(this.Yf.Jqb(),1);b.g9();return this.Yf.dN(b)}e6o(b){var h=this.Xua.$Nf();h.Ib(7);
if(h.Ac()&&h.CYa(0,A=>8==A.type)){h=h.currentNode;const A=(new uu.a).Oca(h);if(A){var r=A.Qg(Ql.a.qog);if(!r&&(r=this.W3k(h),v.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=vc.a.createTextRange(b,0,rd.ParagraphReader.textLength(b));this.DF.zY(b,L=>{this.Qj.ota(L);this.Qj.Hgb(L,r)})}}}jOl(b){var h=this.Xua.$Nf();const r=this.r_c();h.pg(r,29);h.g9();h=this.Snl(h);this.Ug.lf(vc.a.jd(h,0),b,!1,!1);this.e6o(h);return r}Azl(b){const h=
this.Xua.SSb();this.Xua.QTb(h,b);b=this.r_c();const r=this.Xua.$Nf();r.pg(b,29);r.yk(b);Ws.a(h.currentNode,r.currentNode,!1);return b}VGp(b,h){const {Rse:r,ZSi:A}=this.Xua.Azm(b);if(r){var L=vc.a.createTextRange(r,0,rd.ParagraphReader.textLength(r));this.Ug.lf(L,h,!1,!1);A&&this.jXl(b);this.IFp(b)}}jXl(b){const h=this.Xua.SSb();if(h&&b&&this.Xua.QTb(h,b))for(h.ue(),b=h.Bs(),--b;0<b;b--)h.Gy(b),h.qh()}IFp(b){const h=this.Xua.SSb();this.Xua.QTb(h,b)&&h.currentNode.setValue(Sb.a.qW,new Date)}W3k(b){var h;
const r=null===(h=Wj.a.Zf)||void 0===h?void 0:h.zl;h=r?new $y.a(new IB.a):new XH.a(new IB.a);h.setValue(Tc.a.la,"Placeholder Text");h.setValue(Tc.a.ma,1);h.setValue(Rc.a.na,"PlaceholderText");h.setValue(Me.a.oa,99);h.setValue(Rc.a.pa,"Default Paragraph Font");h.setValue(Rc.a.ep,!0);h.setValue(Sb.a.fontColor,8421504);return Wj.a.fVc([h],b)?(r&&(b=Wj.a.kc.Il(),h=Wj.a.kc.Je(h),h=b.Qg(h)),h):null}}Object(u.a)(YH,"GlossaryEditor",null,[625]);class ZH{constructor(b,h,r,A,L){this.Cma=b;this.abi=h;this.ROb=
r;this.VN=A;this.lk=L;this.$Fl=new GF;this.Ahg=(ba,ra)=>{this.VN.Ae(()=>{if(ra){ra.Gn.selectedContentControls||(ra.Gn.selectedContentControls={});var Ia=ra.Gn.selectedContentControls,Ta=ra.bQa;if(Ta&&Ta.length){var ob=Ta[0];Ta=Ta[Ta.length-1];ob=this.Cma.yLf(vc.a.jd(ob.node,ob.Uj),vc.a.jd(Ta.node,Ta.Yp),!1);for(const nb of ob)nb.je.ka(Rc.a.BN,!1)||(Ia[nb.je.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.Gid=(ba,ra)=>{this.VN.Ae(()=>{if(ra){var Ia=ra.clone,Ta=ra.original;try{const ob=ra.Gn.selectedContentControls,
nb=this.Cma.EKf(Ta,0,Ta.characterData.length,!0,!0,!1);for(const Eb of nb){const bc=Eb.Fe.toString();ob[bc]?Eb.qr&&!this.pIl(Eb.je,Ia,ob)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",bc)),this.svg(Ia,Eb.Fe)):this.svg(Ia,Eb.Fe)}}catch(ob){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",ob.toString()),this.abi.vFo(Ia)}}},"CC:onParagraphCopy")};this.$jg=(ba,ra)=>{this.VN.Ae(()=>{if(ra){var Ia=ra.clone,
Ta=ra.original;try{const ob=this.Cma.EKf(Ia,0,Ta.characterData.length);ra.Gn.ccObjectIdMapping||(ra.Gn.ccObjectIdMapping={});const nb=ra.Gn.ccObjectIdMapping;for(let Eb=0;Eb<ob.count;Eb++){const bc=ob.K(Eb),Bc=bc.Fe.toString();if(this.uxn(bc))if(bc.ld){const Yc=Ta.hk().Hd.Mb(Bc),zd=this.PLm(bc),Jd=this.rzl(Yc,zd.oxj,zd.tXi,Ia.hk().Hd);nb[Bc]=Jd.id;this.ROb.vbk(nb[Bc],Ia.id,null);this.lk.Xtc(Jd)}else this.ROb.vbk(nb[Bc],null,Ia.id);nb[Bc]?(bc.Fe=nb[Bc],bc.mx=null):this.svg(Ia,bc.Fe)}}catch(ob){v.ULS.sendTraceTag(520414297,
307,10,"onParagraphPaste operation failed: {0}",ob.toString())}}},"CC:onParagraphPaste")}}init(){dw.a.pUh(this.Ahg);dw.a.WUd(this.Gid);dw.a.XUd(this.$jg)}hsm(b){if(!b.Ib(25)||!b.xd(25))return null;if(!b.dw(25)){const h=this.$Fl.create(on.a.Bta);b.pg(h,25)}return b.ic(25)}pIl(b,h,r){var A=b.ka(Rc.a.$ba,null);const L=te.a.kb(h);h=h.hk().Hd;r=A&&r[A.toString()]?h.Mb(A):this.hsm(L);if(!r)return v.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",
b.id.toString())),null;A=Ws.b(b,h,!0);te.a.kb(r).a8(A,26,b.id);54!==r.type&&A.setValue(Rc.a.$ba,r.id);EK.a.DZf(null,A);return A}svg(b,h){this.abi.zWl(new Cb.a([b]),h)}uxn(b){var h=b.Rb.paragraph.ed;if(!h)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.Fe.toString())),!1;h=h.Mb(b.mx);if(!h)return v.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",
b.Fe.toString())),!1;b=h.getValue(Rc.a.gu);return 38===b||39==b}Dqm(b,h){var r,A=b.ra.jc(b.ra.length-1);let L=b.characterData.length;A=(null===(r=null===A||void 0===A?void 0:A.Qb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Rb.paragraph.id)&&(L=h.Rb.cp,A=h.Rb.Qb.qN(h.Fe,h.ld));return this.Cma.FKf(b,0,L,0,A)}PLm(b){let h=null,r=b.Rb.paragraph;const A={};for(;r;){const L=this.Dqm(r,b);for(let ba=L.count-1;0<=ba;ba--){const ra=L.K(ba);if(!ra.qr)continue;const Ia=ra.Fe.toString();if(ra.ld){if(!A[Ia])return{oxj:ra.je,
tXi:h}}else A[Ia]=!0,h||(h=ra.je)}r=rd.ParagraphReader.Cg(r,!0,!0)}return{oxj:null,tXi:h}}rzl(b,h,r,A){let L;h?L=this.ROb.bDa(h):(L=this.ROb.cDa(),h=L.currentNode);A=Ws.b(b,A,!0);A.Xg(Rc.a.yy,of.a.BG());54!==h.type&&A.setValue(Rc.a.$ba,h.id);L.QL(A,r,26);hq.a.gia&&!HF(b)&&this.ROb.xzl(b,A);return A}}Object(u.a)(ZH,"ContentControlCCP",null,[]);var HK=e(741);class $H{constructor(b,h,r,A){this.ee=b;this.yg=h;this.qb=r;this.Lh=A}get o9(){return!!this.yg.instance&&this.yg.instance.o9}get FVb(){return!!this.yg.instance&&
this.yg.instance.FVb}cBa(b,h,r,A,L,ba=Ql.a.XPb,ra=Ql.a.Ric,Ia=null,Ta=Ql.a.Ryf,ob=-1){(b=this.Smc(b,r))?(b.Qb||b.dpc(),this.Y0k(h,b.Qb,A,L,ba,ra,Ia,Ta,ob)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}gji(b,h,r){if(b){new Cb.a;for(let L=0;L<b.count;L++){var A=this.vLf(b.K(L),h,!1);for(const ba of A)this.YFo(ba,r)}}}yWl(b,h){this.gji(b,h,!0)}zWl(b,h){this.gji(b,h,!1)}lf(b,h,r,A){this.ee.lf(b,h,r===fb.a.Isd||hq.a.Hpb&&8===A)}Smc(b,h){var r=vc.a.jd(b,
h);this.ee.ahb(r);for(r=0;r<b.ra.length;r++){const A=b.ra.jc(r);if(A.cp>h)break;if(A.cp===h)return A}return null}Y0k(b,h,r,A,L=Ql.a.XPb,ba=Ql.a.Ric,ra=null,Ia=Ql.a.Ryf,Ta=-1){const ob=h.Rb.paragraph;b=new HK.a(h.Rb,!0,!0,!0,null,b,A,r,L,ba,ra,Ia,null,this.Lh);if(!this.o9||-1>=Ta||Ta>h.length)Ta=h.length;h.insert(b,Ta);ob.eo();b.Re?ob.Bf.pZ(b.Re-1,512):ob.Bf.iva(b.Re,512);ob.Bf.rU(b.Re)}vLf(b,h,r){const A=new Cb.a;for(let L=0;L<b.ra.length;L++){const ba=b.ra.jc(L);if(ba.Qb)for(let ra=0;ra<ba.Qb.length;ra++)if(ba.Qb.K(ra).Fe.equals(h)&&
(A.add(ba.Qb.K(ra)),r))return A}return A}jwd(b,h,r){if(this.FVb&&b){var A=b.node,L=b.Uj,ba=b.Yp,ra=this.UAi(A,L,h,!0);h=this.UAi(A,ba,h,!1);r?-1!==ra&&ra++:-1!==h&&h++;L||-1===ra||(ra=Math.max(ra,this.qb.jA(A)));ba===this.qb.textLength(A)&&-1!==h&&(h=Math.min(h,this.qb.xz(A)));b.Ob=ra;b.nc=h}}UAi(b,h,r,A){return(b=(b=b.ra.Vh(h))?b.Qb:null)&&b.length?b.qN(r,A):-1}YFo(b,h){b&&b.Rb.Qb&&(h?b.Rb.Qb.remove(b):b.Rb.Qb.ixa(b),h=b.Rb.paragraph,0<=b.Re&&b.Re<h.Bf.length&&(b.Rb.cp||1!==h.Bf.length||(h.Bf.pZ(0,
512),h.Bf.rU(1)),h.Bf.removeAt(b.Re,512)),h.eo())}vFo(b){const h=b.ra;if(h){var r=new Cb.a;for(let A=0;A<h.length;A++){const L=h.jc(A);if(L&&L.Qb){for(let ba=0;ba<L.Qb.length;ba++)r.add(L.Qb.K(ba).Re);L.C7h()}}b.tpa(r)}}pAp(b,h,r){if(!(0>h||0>r))for(this.ee.ahb(vc.a.jd(b,h)),this.ee.ahb(vc.a.jd(b,r)),h=b.ra.Z8(h),r=b.ra.Z8(r),--r;r>h;r--){const A=b.ra.jc(r);A.S1i?b.ra.gxa(r):A.formatting=null}}}Object(u.a)($H,"ContentControlChpManager",null,[634]);class Ck{constructor(b,h,r,A,L){this.qb=b;this.Iq=
h;this.Ii=r;this.Qd=A;this.Lh=L}rKf(b){if(!b||!Ee.a.Df(b))return null;if(!b.cpBegin){const h=this.$yi(b.node,b.Ob,!0);if(h)return h}return b.cpBegin===this.qb.textLength(b.node)?this.$yi(b.node,b.Ob-1,!1):null}vpm(b,h){b=this.Hei(b,h);return this.rKf(b)}$yi(b,h,r){return b.ra&&b.ra.length?(b=r?b.ra.first.Qb:b.ra.last.Qb)&&0<=h&&h<b.length&&b.K(h).Pg&&b.K(h).ld===r&&this.o0f(b.K(h))?b.K(h):null:null}TNf(b){if(!b||!Ee.a.Ny(b))return null;var h=this.Iq.Z8d(b,b);b=0<h.count?h.K(h.count-1):null;return b&&
!b.Pg&&this.o0f(b)?(h=1<h.count?h.K(h.count-2):null)&&!h.Pg&&this.o0f(h)?null:b:null}o0f(b){if(!b)return!1;var h=this.JIi(b);if(!h)return!1;if(b.ld)var r=b;else r=h,h=b;var A=this.qb.textLength(b.Rb.paragraph);if(r.Rb.cp||h.Rb.cp!==A||!r.qr||r.qEa||!h.qr||h.qEa)return!1;r=r.Rb.Qb;h=h.Rb.Qb;for(A=0;A<r.length&&!r.K(A).Fe.equals(b.Fe);A++)if(!r.K(A).ld)return!1;for(r=h.length-1;0<=r&&!h.K(r).Fe.equals(b.Fe);r--)if(h.K(r).ld)return!1;return!0}Tvd(b){b=this.rKf(b);this.i0d(b,!1)}l$j(b,h){b=this.Hei(b,
h);this.Tvd(b)}fRa(b){b=this.TNf(b);return this.i0d(b,!0)?b:null}smn(b,h){b=this.rKf(b);return!!b&&b.Fe.equals(h)}Xpc(b,h,r){b=this.vpm(b,h);return!!b&&b.Fe.equals(r)}d2f(b,h){b=this.TNf(b);return!!b&&b.Fe.equals(h)}i0d(b,h){if(!b)return!1;const r=this.JIi(b);return this.Pbi(b,h)&&(!r||this.Pbi(r,h))}Pbi(b,h){if(!b||b.Pg===h)return!1;var r=this.Iq.FHe(b.Rb.paragraph,b.ld);const A=b.Rb.Qb;-1!==r||b.ld||(r=A.length);const L=h===b.ld?1:-1;r+=h?L:0;b=A.qN(b.Fe,b.ld)+L;if(r===b||0<L!==b>r)return v.ULS.shipAssertTag(24933847,
368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,L),v.ULS.shipAssertTag(24933848,368,0<L===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,L),!1;for(var ba=r;ba!==b;ba+=L){var ra=A.K(ba);A.ixa(ra);ra.Pg=h;A.Lin(ra,ba);this.uFp(A.K(ba))}if(this.q9)for(A.Rb.paragraph.eo(),ba=r;ba!==b;ba+=L)ra=A.K(ba),ra.paragraph.Bf.rU(ra.Re);h||this.YHp(A,
r,b,L);v.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}Bae(b){return b.ld&&this.Lh.Ds(b.je.id,!0).equals(b.Rb.paragraph.id)?38:!b.ld&&this.Lh.Ds(b.je.id,!1).equals(b.Rb.paragraph.id)?39:b.Pg&&b.ld?40:b.Pg&&!b.ld?41:!b.Pg&&b.ld?38:39}uFp(b){const h=b.Rb.paragraph.ed;if(h){var r=h.Mb(b.mx),A=b.je;if(r){r=r.clone();r.setValue(Rc.a.P4f,b.Pg);const L=this.Bae(b);r.setValue(Rc.a.gu,L);h.Mv(r,null);b.mx=r.id}A&&A.setValue(Rc.a.Yca,b.Pg)}}JIi(b){if(b.Rb.cp&&
b.Rb.cp!==this.qb.textLength(b.Rb.paragraph)||!b.Rb.paragraph.ra||!b.Rb.paragraph.ra.length)return null;const h=b.ld?b.Rb.paragraph.ra.last:b.Rb.paragraph.ra.first;if(!h.Qb)return null;b=h.Qb.qN(b.Fe,!b.ld);return-1===b?null:h.Qb.K(b)}YHp(b,h,r,A){var L=b.K(h).je;if(L){var ba=b.K(h).ld;L=this.Lh.Ds(L.id,ba);if(!L.equals(V.a.nil))if(b.Rb&&b.Rb.paragraph&&b.Rb.paragraph.id.equals(L)){for(h+=A;h!==r;h+=A){const ra=b.K(h).je;if(!ra)return;this.Lh.NK(ra.id,L,ba)}0<=r&&r<b.length&&b.K(r).Pg&&this.D4f(b.K(r))&&
(b=b.K(r).je)&&this.Lh.NK(b.id,L,ba)}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}D4f(b){return b.qr&&!b.qEa}Hei(b,h){if(!b||!this.Ii)return null;const r=h?vc.a.jd(b,0):vc.a.uz(b);b=this.Ii.wt(b,h);r.nc=r.Ob=b;return r}get q9(){return this.Qd.isFeatureEnabled(26)}}Object(u.a)(Ck,"ContentControlConverter",null,[633]);var Ah;(function(b){b[b.FTp=0]="BoundingBox";b[b.tYp=1]="Tags";b[b.IVp=2]="Hidden";
b[b.SWp=3]="NumberOfContentControlAppearance"})(Ah||(Ah={}));Object(u.b)("ContentControlAppearance",Ah);var yu=e(1586);class IF{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.tkb=this.Ufa=this.YDd=this.vQd=this.hLd=null;this.Mqa=this.wl=this.fQc=this._id=0;this.M8b=this.wmb=this.rRd=this._title=this.LHa=null;this.kId=this.jId=this.ewh=this.WNd=this.pMc=this.lMc=this.oDd=!1;this.zxh=null;this.Pg=!1;this.PBd=null;this.oj=r;this.rB=h;this.yh=A;this.Xs=L;this.wn=ba;this.c7=ra;this.Hka=Ia;this.Hla=Ta;this.nMb=
ob;this.Lh=nb;b?(this.hLd=b.id,this.PBd=b,this.VY(!1)):this._id=of.a.BG()}get fl(){return this.oj.value}get id(){this.VY();return this._id}set id(b){this._id=b;this.isValid()&&(this.je.setValue(Rc.a.yy,this._id),this.u_())}get parentId(){this.VY();return this.fQc}set parentId(b){this.fQc=b}get title(){this.VY();return this._title}set title(b){this._title=b;this.isValid()&&(this.je.setValue(Rc.a.lqb,this._title),this.u_(),this.lwd(h=>{h.title=this._title?this._title:Ql.a.XPb}))}get tag(){this.VY();
return this.rRd}set tag(b){this.rRd=b;this.isValid()&&(this.je.setValue(Rc.a.pqb,this.rRd),this.u_())}get type(){this.VY();return this.wl}set type(b){this.wl=b;this.isValid()&&(this.je.setValue(Rc.a.WKa,yu.a[this.wl]),this.u_())}get appearance(){this.VY();return this.Mqa}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Mqa=b;this.isValid()&&(this.je.setValue(Rc.a.mqb,Ah[this.Mqa].toLowerCase()),this.u_(),this.lwd(h=>{h.appearance=Ah[this.Mqa].toLowerCase()}))}get color(){this.VY();
return this.LHa}set color(b){if(b&&16777215>=b)this.LHa=b,this.isValid()&&(this.je.setValue(Rc.a.yZc,this.LHa),this.u_(),this.lwd(h=>{h.color=this.LHa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.VY();return this.wmb}set placeholderText(b){this.wmb=b;hq.a.gia&&this.yh.eck(b,this.PBd)&&(this.u_(),this.KN&&this.wn.gNb(this,!0))}get x3d(){this.VY();return this.M8b}set x3d(b){this.M8b=b;this.isValid()&&(this.je.setValue(Rc.a.QOb,this.M8b),this.u_())}get ABf(){this.VY();
return this.oDd}set ABf(b){b&&(this.oDd=b,this.isValid()&&(this.je.setValue(Rc.a.W_d,this.oDd),this.u_()))}get removeWhenEdited(){this.VY();return this.WNd}set removeWhenEdited(b){if(b&&!this.coa)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.WNd=b;this.isValid()&&(this.je.setValue(Rc.a.dbi,this.WNd),this.u_())}get coa(){this.VY();return this.lMc}set coa(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");
this.lMc=b;this.isValid()&&(this.je.setValue(Rc.a.Phc,this.lMc),this.lwd(h=>{h.WO=this.lMc}),this.u_())}get isEditable(){this.VY();return this.pMc}set isEditable(b){this.pMc=b;this.isValid()&&(this.je.setValue(Rc.a.oqb,this.pMc),this.lwd(h=>{h.editable=this.pMc}),this.u_())}get isSupported(){this.VY();return this.ewh}get Cxn(){return this.isSupported&&11!==this.type&&10!==this.type}get I8i(){this.VY();return this.M8b&&"table of contents"===this.M8b.toLowerCase()?!0:!1}get zie(){this.VY();return this.jId}set zie(b){this.jId=
b;this.isValid()&&(this.je.setValue(Rc.a.ibi,this.jId),this.u_())}get frc(){this.VY();return this.kId}set frc(b){this.kId=b;this.isValid()&&(this.je.setValue(Rc.a.jbi,this.kId),this.u_())}get KN(){return this.je.ka(Rc.a.aca,!1)}set KN(b){this.isValid()&&this.je.setValue(Rc.a.aca,b)}get isChecked(){return 8!==this.type?!1:this.je.ka(Me.a.Buf,!1)}set isChecked(b){8===this.type&&this.isValid()&&(this.je.setValue(Me.a.Buf,b),this.u_())}get ow(){this.VY();return this.vQd}set ow(b){this.vQd=b}get EB(){this.VY();
return this.YDd}set EB(b){this.YDd=b}get objectId(){return this.hLd}set objectId(b){this.hLd=b;this.PBd=this.fl.Mb(this.hLd)}get start(){this.Xdk();return this.Ufa}set start(b){this.Ufa=b}get end(){this.Xdk();return this.tkb}set end(b){this.tkb=b}get je(){return this.PBd}Ego(b){for(let h=0;3>h;++h)if(Ah[h].toLowerCase()===b)return h;return 0}u_(){const b=this.start.node;b&&b.setValue(Sb.a.qW,new Date)}Bwd(){this._id=this.je.ka(Rc.a.yy,0);this.Mqa=this.Ego(this.je.ka(Rc.a.mqb,null));this.LHa=this.je.ka(Rc.a.yZc,
null);this._title=this.je.ka(Rc.a.lqb,null);this.rRd=this.je.ka(Rc.a.pqb,null);this.Pg=this.je.ka(Rc.a.Yca,!1);this.lMc=this.je.ka(Rc.a.Phc,!1);this.pMc=this.je.ka(Rc.a.oqb,!1);this.ewh=this.je.ka(Rc.a.Bma,!1);this.M8b=this.je.ka(Rc.a.QOb,null);this.oDd=this.je.ka(Rc.a.W_d,!1);this.vQd=this.Lh.Ds(this.je.id,!0);this.YDd=this.Lh.Ds(this.je.id,!1);this.kId=this.je.ka(Rc.a.jbi,!1);this.jId=this.je.ka(Rc.a.ibi,!1);this.WNd=this.je.ka(Rc.a.dbi,!1);this.wl=Object(yu.b)(this.je.ka(Rc.a.WKa,"RichText"));
let b=null;try{const h=this.je.ka(Rc.a.$ba,V.a.nil);if(V.a.Kx(h,V.a.nil))this.fQc=0;else if(b=this.fl.Mb(h))this.fQc=b.ka(Rc.a.yy,0)}catch(h){this.fQc=0}this.UGp()}UGp(){if(this.nMb){var b=this.je.ka(Rc.a.FWa,"");if((b=this.Hka.iPi(b))&&0<b.length){this.wmb=this.iyi(b.Ya,b.hd);return}}this.wmb=(b=this.yh.cDa())&&b.currentNode?b.currentNode.ka(Rc.a.zZc,null):null}VY(b=!0){if(!b||this.isValid())b=this.je.ka(Sb.a.lastModifiedTime,new Date(0)),this.zxh!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.Bwd(),this.zxh=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}XHp(b,h){this.vQd=b;this.YDd=h;this.Lh.NK(this.je.id,b,!0);this.Lh.NK(this.je.id,h,!1)}Xdk(){if(this.je){var b=this.ow,h=this.EB;if(!b||!h||b.equals(V.a.nil)||h.equals(V.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.yh.iha(b,!0),h=this.yh.iha(h,!1),
b&&h)if(b.isConnected&&h.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Pg)b=vc.a.create(b),this.Xs.jwd(b,this.objectId,!0),this.start=b,b=vc.a.create(h),this.Xs.jwd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.ra){for(let A=0;A<b.ra.length&&(-1===h||-1===r);A++){const L=b.ra.jc(A);if(L.Qb)for(let ba=0;ba<L.Qb.length&&(-1===h||-1===r);ba++){const ra=L.Qb.K(ba);V.a.Kx(ra.Fe,this.objectId)&&(ra.ld?h=L.cp:r=L.cp)}}0<=h&&0<=r&&(b=vc.a.OV(h,
r,!1,b),this.Xs.jwd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.Pg?b=this.iyi(h,r):(h=rd.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=wm.AParagraphNode.DR(h));return b}isValid(){return!!this.je&&this.je.isConnected}RBe(b){return this.Hla?this.wn.mEg(this,b)?0:2:2}clear(){return this.Hla?this.wn.mEg(this,"")?0:2:2}fAi(){const b=new Cb.a;var h=this.je.ka(Rc.a.je,[]);for(const r of h)if(!V.a.Kx(r,V.a.nil)){h=
this.oj.value.Mb(r);try{b.add(this.c7.dPb(h,this.rB,this.oj,this.yh,this.Xs,this.wn,this.Hka,this.Hla,this.nMb))}catch(A){}}return b}RJf(){const b=new Cb.a;this.Zxi(this,b);return b}Zxi(b,h){b=b.fAi();if(b.count)for(const r of b)h.add(r),this.Zxi(r,h)}sH(b=!1){const h=new Cb.a;if(this.Pg){var r=this.wn.aZ(this.start,this.end);for(var A of r)r=vc.a.create(A),this.Xs.jwd(r,this.objectId,b),h.add(r)}else A=this.start.clone(),this.Xs.jwd(A,this.objectId,b),h.add(A);return h}lwd(b){const h=this.wn.aZ(this.start,
this.end);for(let r=0;r<h.count;r++){const A=this.Xs.vLf(h.K(r),this.objectId,!1);if(A){for(let L=0;L<A.count;L++)b(A.K(L));h.K(r).Bl()}}}iyi(b,h){const r=new Sys.StringBuilder;h=this.wn.aZ(b,h);for(const A of h)A.id.equals(b.node.id)||r.append("\r"),r.append(rd.ParagraphReader.U5(A));return r.toString()}}Object(u.a)(IF,"ContentControl",null,[661]);class aI{constructor(b){this.Lh=b}dPb(b,h,r,A,L,ba,ra,Ia,Ta){return new IF(b,h,r,A,L,ba,this,ra,Ia,Ta,this.Lh)}}Object(u.a)(aI,"ContentControlFactory",
null,[632]);class JF{constructor(b,h,r,A){this.oj=b;this.Xs=h;this.pWk=r;this.z0=A}ADp(b,h,r){var A;if(!(hq.a.Fuf&&b&&h&&r))return!1;const L=b.je;if(!L)return!1;const ba=L.ka(Rc.a.SOb,V.a.nil);ba&&!ba.equals(V.a.nil)?b=this.oj.value.Mb(ba):(b=this.Xs.Smc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(A=null===b||void 0===b?void 0:b.formatting)||void 0===A?void 0:A.qp,b||(b=new Uz.a,this.oj.value.Mv(b,null)),L.setValue(Rc.a.SOb,b.id));A=this.oj.value.Mb(b.id);h=this.pWk.kNf(L,A,h,r,"boolean"===
typeof r&&r);h=this.z0.Ofk(h);for(const [ra,Ia]of h)b.setValue(ra,Ia);return!0}}Object(u.a)(JF,"ContentControlFormattingManager",null,[630]);var bI=e(955);class ow{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){this.rB=b;this.oj=h;this.td=r;this.sJb=A;this.Jxk=L;this.hV=ba;this.ni=ra;this.qb=Ia;this.qMd=Ta;this.nFd=ob;this.Lh=nb;this.LWe=Eb;this.Hka=bc}get Kw(){return this.rB.value}cDa(){const b=this.td.Lm();b.set(this.Kw);this.sJb.bU(b);if(b.ic(25))return b;this.nFd.instance&&this.nFd.instance.wva&&
v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}f6c(b,h,r=!1){this.UQb();const A=new Cb.a;let L;if(b){L=b.ic(26);if(!L)return A;for(;L&&(!h(L)||(A.add(L),!r));){A.addRange(this.f6c(b,h));if(r&&0<A.count)break;L=b.gg(26)}b.Ac()}return A}oKm(){const b=this.td.Lm();b.set(this.rB.value);this.sJb.bU(b);return b.currentNode}WZa(b,h,r){let A;A=b.equals(h);A||(A=(b=this.iha(b,r))?
b.id.equals(h):!1);return A}OXa(b,h){b=this.Hw(b);if(!b)return null;let r=null;for(;55===b.type;){const A=this.Lh.Ds(b.id,h);if(A.equals(r)){b=null;break}else b=this.Hw(A);r=A}return b}iha(b,h){return(b=this.OXa(b,h))?rd.ParagraphReader.lc(b)?b:h?this.qb.Vn(b):this.qb.vH(b):null}eji(b,h=!1){this.HCp(b);this.fji(b,h)}HCp(b){var h=this.bDa(b);h=this.bDa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let r,A;r=this.Hw(this.Lh.Ds(b.id,!0));for(A=this.Hw(this.Lh.Ds(b.id,!1));r&&55===r.type;)r=
this.Hw(this.Lh.Ds(r.id,!0));for(;A&&55===A.type;)A=this.Hw(this.Lh.Ds(A.id,!1));r&&A&&this.ubk(r.id,A.id,h,L=>{L=L.ka(Rc.a.b1,V.a.nil);return!L||L.equals(V.a.nil)||b.id.equals(L)})}fji(b,h=!1){v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var r=this.bDa(b);const A=this.bDa(r.parentNode);let L=V.a.nil,ba=V.a.nil;var ra=A.currentNode.ka(Rc.a.je,[]);const Ia=new Cb.a;for(var Ta=0;Ta<ra.length;Ta++)Ia.add(ra[Ta]);if(h){if(54!==A.currentNode.type){L=this.Lh.Ds(A.currentNode.id,
!0);ba=this.Lh.Ds(A.currentNode.id,!1);ra=this.Hw(L);for(Ta=this.Hw(ba);ra&&55===ra.type;)L=this.Lh.Ds(ra.id,!0),ra=this.Hw(L);for(;Ta&&55===Ta.type;)ba=this.Lh.Ds(Ta.id,!1),Ta=this.Hw(ba)}ra=this.bDa(b);if(ra.ic(26)){Ta=new Cb.a;for(Ta.add(ra.currentNode);ra.gg(26);)Ta.add(ra.currentNode);for(var ob of Ta)this.fji(ob,h)}}else if(L=this.Lh.Ds(b.id,!0),ba=this.Lh.Ds(b.id,!1),h=this.ZCm(Ia,b.id),ob=this.bDa(b),ob.ic(26)){ra=this.bDa(ob.currentNode);Ta=ra.currentNode;let nb=b;for(;Ta;){const Eb=ob.currentNode;
Ia.insert(h++,Eb.id);Ta=ra.gg(26);const bc=this.bDa(Eb);54!==A.currentNode.type?Eb.setValue(Rc.a.$ba,A.currentNode.id):Eb.removeProperty(Rc.a.$ba);Ws.h(bc,A,nb,26);nb=bc.currentNode;Ta&&(ob.set(Ta),ob.B6(this.cDa().currentNode))}}54!==A.currentNode.type&&(h=this.Lh.Ds(A.currentNode.id,!0),ob=this.Lh.Ds(A.currentNode.id,!1),h.equals(b.id)&&this.Lh.NK(A.currentNode.id,L,!0),ob.equals(b.id)&&this.Lh.NK(A.currentNode.id,ba,!1));r.qh();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ia,
b.id);ra=Array(Ia.count);for(r=0;r<Ia.count;r++)ra[r]=Ia.K(r);A.currentNode.setValue(Rc.a.je,ra);bI.a.DEa(b.id)}X0k(b,h,r,A,L,ba,ra=null){let Ia;if(h){var Ta=this.Hw(h.objectId);Ia=this.bDa(Ta)}else Ia=this.cDa(),Ta=Ia.currentNode;const ob=this.Jxk.create(on.a.je);ra&&ob.properties.Yu(ra.properties);54!==Ta.type&&ob.setValue(Rc.a.$ba,Ta.id);ra?Ia.XUb(ob,r,26,ra.id):Ia.QL(ob,r,26);this.Ydk(b,ob.id,L,!0);this.Ydk(b,ob.id,ba,!1);b.Pg&&(h&&(r=this.Lh.Ds(Ta.id,!0),ra=this.Lh.Ds(Ta.id,!1),r.equals(L)&&
this.Lh.NK(Ta.id,ob.id,!0),ra.equals(ba)&&this.Lh.NK(Ta.id,ob.id,!1)),this.ubk(L,ba,ob.id,nb=>{nb=nb.ka(Rc.a.b1,V.a.nil);const Eb=h?h.objectId:null;return!nb||nb.equals(V.a.nil)||nb.equals(Eb)}));L=this.bDa(ob);ba=Array(A.count);for(Ta=A.count-1;0<=Ta;Ta--)ba[Ta]=A.K(Ta).objectId,r=this.Hw(A.K(Ta).objectId),r=this.bDa(r),r.currentNode.setValue(Rc.a.$ba,ob.id),Ws.h(r,L,null,26);0<ba.length&&ob.setValue(Rc.a.je,ba);ow.Dc.isFeatureEnabled(32)&&(b.x3d&&ob.setValue(Rc.a.QOb,b.x3d),b.ABf&&ob.setValue(Rc.a.W_d,
!0));return ob}Ydk(b,h,r,A){12===this.Hw(r).type?this.Lh.NK(h,r,A):(this.Lh.kQg(h,r,A),this.Lh.NK(h,A?b.start.node.id:b.end.node.id,A))}G_o(b,h,r,A,L){b.setValue(Rc.a.Yca,h);b.setValue(Rc.a.Phc,!0);b.setValue(Rc.a.oqb,!0);b.setValue(Rc.a.yy,r);b.setValue(Rc.a.mqb,Ah[0]);b.setValue(Rc.a.Bma,!0);b.setValue(Rc.a.WKa,yu.a[L]);A&&b.setValue(Rc.a.qCb,A);b.setValue(Rc.a.Qhc,0)}vbk(b,h=null,r=null){h&&this.Lh.NK(b,h,!0);r&&this.Lh.NK(b,r,!1)}wji(b){if(!b||!b.count||!b.K(0))return null;const h=this.dNm(b);
for(let r=0;r<b.count;r++)this.ni.hxa(b.K(r));return h}dNm(b){if(!b||!b.K(0))return null;const h=this.td.Lm();h.set(b.K(0));h.Wd();h.Ac();return h.cR()?h.currentNode:null}BLm(b){const h=this.td.Lm();h.set(b);h.Wd();h.Ac();h.Ac();return h}lTh(b,h,r){const A=new Cb.a;for(let L=0;L<r;L++){h=this.hV.bVb(b,h,!0,null);if(!h||!b.ue())return null;const ba=b.currentNode;b.Ac();b.Ac();A.add(ba)}return A}Gnc(b){const h=this.td.Lm();h.set(b);for(h.Ib(7);h.Ac();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}AIi(b){const h=
this.td.Lm();h.set(b);h.Wd();return(b=h.Pfb())?b.id:null}bOf(b){const h=this.td.Lm();h.set(b);return h.Ib(7)?h:null}Hw(b){return this.oj.value.Mb(b)}UQb(){if(!ow.wth){var b=this.cDa();b&&this.zNg(b);ow.wth=!0}}F2a(b){return this.qMd.F2a(b)}zrf(b,h,r,A){let L=null,ba=b.xd(16);for(;ba!==r;){if(h&&ih.TableCellReader.p1f(b)||!h&&ih.TableCellReader.die(b))L=b.xd(14);else return{returnValue:!1,Bz:A};ba=b.xd(16)}L&&(A=vc.a.create(L));return{returnValue:!0,Bz:A}}zNg(b){if(b.ic(26)){for(this.zNg(b);b.gg(26);)this.zNg(b);
b.Ac()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.K(r).toString()===h.toString()){b.removeAt(r);break}}bDa(b){const h=this.td.Lm();h.set(b);h.B6(this.cDa().currentNode);return h}ZCm(b,h){for(let r=0;r<b.count;r++)if(b.K(r).equals(h))return r;return-1}ubk(b,h,r,A){b=this.wtm(b,h);for(h=0;h<b.count;h++)A(b.K(h))&&(r?b.K(h).setValue(Rc.a.b1,r):b.K(h).removeProperty(Rc.a.b1),this.nFd.instance&&this.nFd.instance.y0i&&b.K(h).vm(16,!0))}wtm(b,h){const r=new Cb.a;var A=this.Hw(b);const L=this.Hw(h);if(!A||
!L)return r;const ba=({yed:ra}=this.e8d(A,L)).returnValue;A=ra[ba];if(14===A.type)r.add(A);else if(15===A.type&&1<=ba){const Ia=ra[ba-1];1===Qh.TableReader.Hg(Ia)&&r.add(Ia)}var ra=te.a.kb(ba>=ra.length-1?A:ra[ba+1]);ra.Ib(7);for(A=Xd.a.$u(ra,A);A.moveNext()&&A.currentNode!==L;)14===A.currentNode.type&&r.add(A.currentNode);if(!V.a.Kx(h,b)&&14===L.type)for(ra=te.a.kb(L),A=Xd.a.$u(ra,L);A.moveNext();)14===A.currentNode.type&&r.add(A.currentNode);return r}e8d(b,h){b=this.Qsb(b);h=this.Qsb(h);let r=0;
for(;r<b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,yed:b,szg:h}}Qsb(b){const h=[];h.push(b);b=te.a.kb(b);for(b.Ib(7);b.Ac();)h.push(b.currentNode);h.reverse();return h}static get Dc(){return null!=ow.RZg?ow.RZg:ow.RZg=Xa.a.instance.Wa("Box4.IFeatureHelper")}r_c(b,h,r=!1){b=this.LWe.instance.jOl(b);r?(r=Ql.a.ZUl,b.setValue(Rc.a.Qnc,r)):r=b.ka(Rc.a.Qnc,null);h.setValue(Rc.a.FWa,r)}xzl(b,h){this.czj(b)&&(b=b.ka(Rc.a.FWa,null),b=this.LWe.instance.Azl(b).ka(Rc.a.Qnc,null),h.setValue(Rc.a.FWa,
b))}eck(b,h){if(!this.czj(h))return!1;var r=h.ka(Rc.a.FWa,null);r?HF(h)?this.r_c(b,h):this.LWe.instance.VGp(r,b):(r=this.Hka.RBi())?h.setValue(Rc.a.FWa,r):this.r_c(b,h,!0);return!0}czj(b){if(!b)return!1;var h=b.getValue(Rc.a.WKa);if(!h)return!1;h=Object(yu.b)(h);b=b.getValue(Rc.a.QOb);return(0==h||1==h)&&b!==fj.pmi}}ow.wth=!1;Object(u.a)(ow,"ContentControlGraphManager",null,[629]);class pw{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.YHc=ob;this.Lqa=null;this.Evn=(nb,Eb)=>{if(this.o9)return this.Fvn(nb,
Eb);if(!nb||!nb.count)return v.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let bc=!0;switch(Eb){case 0:Eb=this.ZQ(nb.K(0),nb.K(nb.count-1),1);if((nb=this.ZQ(nb.K(0),nb.K(nb.count-1),3))&&0<nb.count){if(!nb.K(0).isSupported||!nb.K(0).isEditable){bc=!1;break}for(nb=nb.K(0);nb;)this.Vnd(Eb,nb.id),nb=this.getById(nb.parentId)}if(Eb)for(var Bc of Eb)if(!Bc.isSupported||!Bc.isEditable){bc=!1;break}break;case 1:if(nb.K(0).contextId!==ic.a.kd){v.ULS.sendTraceTag(17356049,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");bc=!1;break}(Eb=this.ZQ(nb.K(0),nb.K(0),1))&&0<Eb.count&&(bc=!1);break;case 2:if(nb.K(0).contextId!==ic.a.kd){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");bc=!1;break}(Eb=this.ZQ(nb.K(0),nb.K(0),3))&&0<Eb.count&&(bc=!1);break;case 3:case 4:Eb=this.r$d(nb.K(0),!0);Bc=this.r$d(nb.K(nb.count-1),!1);if(!Eb||!Bc){v.ULS.sendTraceTag(17356050,
368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");bc=!1;break}if((Eb=this.ZQ(Eb,Eb,3))&&0<Eb.count){bc=!1;break}if((Eb=this.ZQ(Bc,Bc,3))&&0<Eb.count){bc=!1;break}if(Eb=this.wn.ZQ(nb.K(0),nb.K(nb.count-1),1))for(const Yc of Eb)if(!Yc.coa){bc=!1;break}break;default:bc=!1}return bc};pw.rB=b;pw.oj=h;this.yh=r;this.Xs=A;this.wn=L;this.c7=ba;this.Hka=ra;this.yg=Ia;this.Iq=Ta}get wZa(){return!!this.yg.instance&&this.yg.instance.wZa}get wva(){return!!this.yg.instance&&
this.yg.instance.wva}get Tge(){return!!this.yg.instance&&this.yg.instance.Tge}get o9(){return!!this.yg.instance&&this.yg.instance.o9}get Vge(){return!!this.yg.instance&&this.yg.instance.Vge}FVb(){return!!this.yg.instance&&this.yg.instance.FVb}Msa(b,h,r=null,A=null,L=!1,ba=0){if(!this.wZa)return{returnValue:2,id:0};b=this.yh.iha(b,!0);h=this.yh.iha(h,!1);if(!b||!h)return{returnValue:2,id:0};b=vc.a.create(b);h=vc.a.create(h);return this.bSh(b,h,r,A,L,ba,!1)}f0k(b,h,r=0,A=!1){return this.wZa&&b&&h?this.bSh(b,
h,null,null,!1,r,A):{returnValue:2,id:0}}k8a(b,h=null,r=0,A=!1){let L=0;if(!this.wZa)return{returnValue:2,id:L};const ba=this.c7.dPb(h,pw.rB,pw.oj,this.yh,this.Xs,this.wn,this.Hka,this.wZa,this.Tge);ba.type=r;ba.start=b;ba.end=b;ba.ow=b.node.id;ba.EB=b.node.id;ba.Pg=!1;return this.wn.aTh(ba,h,A)?(L=ba.id,{returnValue:0,id:L}):{returnValue:2,id:L}}W0k(b,h=null){if(!this.wZa||!this.Brn(b))return{returnValue:2,id:0};var r=b.K(0).contextId===ic.a.od?b.K(1):b.K(0);const A=b.K(b.count-1);if(this.juf(b,
ic.a.paragraph)||this.juf(b,ic.a.od)){b=r.node.id;let L=A.node.id;const ba=b.equals(L);r=this.wn.R1j(r,!0);void 0!==r&&null!==r&&(b=r,L=ba?b:L);this.wn.R1j(A,!1);h.setValue(Rc.a.Yca,!0);return this.Msa(b,L,h)}return r!==A||r.contextId!==ic.a.Nd&&r.contextId!==ic.a.kd?{returnValue:2,id:0}:(h.setValue(Rc.a.Yca,!1),this.k8a(r,h))}getById(b){if(!this.wva)return null;const h=this.yh.f6c(this.yh.cDa(),r=>r.getValue(Rc.a.yy)===b,!0);return 0<h.count?this.wn.xT(h.K(0)):null}getByTitle(b){if(!this.wva)return null;
const h=this.yh.f6c(this.yh.cDa(),A=>A.ka(Rc.a.lqb,null)===b,!1),r=new Cb.a;for(const A of h)r.add(this.wn.xT(A));return r}getByTag(b){if(!this.wva)return null;const h=this.yh.f6c(this.yh.cDa(),A=>A.ka(Rc.a.pqb,null)===b,!1),r=new Cb.a;for(const A of h)r.add(this.wn.xT(A));return r}ZQ(b,h,r,A=!1){return this.wva?this.o9?this.wn.zua(b,h,r):this.wn.ZQ(b,h,r,A):null}aZ(b,h){return this.wn.aZ(b,h)}mnm(){if(!this.wva)return null;const b=this.yh.f6c(this.yh.cDa(),()=>!0,!1),h=new Cb.a;for(const r of b)h.add(this.wn.xT(r));
return h}J0b(b){if(!this.wZa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.wn.IFa(b)?0:2}nWl(b){if(!this.wZa)return 2;b=this.getById(b);return this.wn.deleteContentControl(b)?0:2}p1k(b){this.wn.vGj(b)}pjl(b){this.Lqa=b;this.Lqa.jDo(this.Evn)}Ktm(b){if(!this.FVb())return null;let h;var r=b.sH();h=this.r$d(r.K(r.count-1),!1);r=this.Xs.Smc(r.K(r.count-1).node,h.cpBegin).Qb;b=this.nUm(r,b);if(-1===b)return null;
h.Ob=b;h.nc=h.Ob;return h}Fvn(b,h){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.Fpn(b);case 3:case 4:case 6:return this.Mxn(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.K(0).contextId!==ic.a.kd?(v.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.B3i(b.K(0),5===h,!1);default:return!1}}Fpn(b){const h=this.wn.zua(b.K(0),
b.K(b.count-1),3);if(h&&0<h.count){var r=h.K(0);if(!r.isSupported||!r.isEditable)return!1}b=this.wn.zua(b.K(0),b.K(b.count-1),1);for(r=0;h&&r<h.count;r++)this.Vnd(b,h.K(r).id);if(b)for(const A of b)if(!A.isSupported||!A.isEditable)return!1;return!0}Mxn(b,h){var r=b.K(0),A=b.K(b.count-1),L=r.Uj,ba=A.Yp;if(-1===L||-1===ba)return!1;L=this.Iq.Eca(r.node,L,r.Ob);ba=this.Iq.Eca(A.node,ba,A.nc);var ra=-1,Ia=Math.min(L.count,ba.count);for(--Ia;0<=Ia;Ia--){const Ta=L.K(Ia).Fe,ob=ba.K(Ia).Fe;if(Ta.equals(ob)){ra=
Ia;break}}if(-1<ra&&(Ia=this.wn.xT(L.K(ra).je),!Ia.isEditable||!Ia.isSupported||Ia.KN&&!this.jpn(Ia,b)))return!1;r=this.wn.zua(r,A,1);for(A=0;A<=ra;A++)this.Vnd(r,this.wn.xT(L.K(A).je).id);for(A=ra+1;A<L.count;A++){Ia=this.wn.xT(L.K(A).je);if(!Ia.isEditable||!Ia.coa||!Ia.isSupported||Ia.KN)return!1;this.Vnd(r,Ia.id)}for(L=ra+1;L<ba.count;L++){ra=this.wn.xT(ba.K(L).je);if(!ra.isEditable||!ra.coa||!ra.isSupported||ra.KN)return!1;this.Vnd(r,ra.id)}if(r)for(const Ta of r)if(!Ta.isSupported||!Ta.coa)return!1;
return h&&(b=this.r$d(b.K(0),!0))?this.B3i(b,!0,!0):!0}jpn(b,h){h=this.Iq.yLm(h.K(0),h.K(h.count-1));return!!b&&!!h&&b.objectId.equals(h.Fe)}B3i(b,h,r){return(b=this.wn.zua(b,b,3))&&0<b.count&&(b=b.K(0),!b.isSupported||!b.isEditable||!this.Vge&&h&&!b.Pg||!r&&b.KN||h&&1===b.type)?!1:!0}r$d(b,h){if(!b)return null;let r=null;switch(b.contextId){case ic.a.paragraph:r=h?vc.a.jd(b.node,0):vc.a.uz(b.node);break;case ic.a.od:r=vc.a.uz(b.node);break;case ic.a.Nd:r=h?vc.a.jd(b.node,b.cpBegin):vc.a.jd(b.node,
b.cpEnd);break;case ic.a.kd:r=b}r&&(r.nc=r.Ob=h?b.Ob:b.nc);return r}Vnd(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}nUm(b,h){if(!b)return-1;let r=-1;for(let A=0;A<b.length;A++)if(b.K(A).Fe.equals(h.objectId)&&!1===b.K(A).ld){r=A;if(h.Pg&&0<A&&b.K(A-1).Pg&&!b.K(A-1).ld)return-1;break}return r}Brn(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.K(h).contextId;if(r!==ic.a.paragraph&&r!==ic.a.od&&r!==ic.a.Nd&&r!==ic.a.kd||0<h&&h<b.count-1&&r===ic.a.Nd&&(b.K(h).cpBegin||
b.K(h).cpEnd!==b.K(h).node.characterData.length))return!1}return b.K(0).contextId===ic.a.od&&1===b.count||this.juf(b,ic.a.kd)&&1<b.count?!1:!0}juf(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}bSh(b,h,r=null,A=null,L=!1,ba=0,ra=!1){let Ia=0;var Ta=h.node;let ob=vc.a.create(b.node);Ta=vc.a.create(Ta);if(!({kEe:ob,C4d:Ta}=this.YHc.Crf(ob,Ta)).success)return{returnValue:2,id:Ia};const nb=this.c7.dPb(r,pw.rB,pw.oj,this.yh,this.Xs,this.wn,this.Hka,this.wZa,this.Tge);nb.type=ba;nb.start=b;
nb.end=h;nb.ow=ob.node.id;nb.EB=Ta.node.id;nb.Pg=!0;nb.x3d=A;nb.ABf=L;return this.wn.aTh(nb,r,ra)?(Ia=nb.id,{returnValue:0,id:Ia}):{returnValue:2,id:Ia}}}pw.rB=null;pw.oj=null;Object(u.a)(pw,"ContentControlManager",null,[628]);var xs=e(637),yt=e(195),KF=e(151);class JB extends Sys.EventArgs{constructor(b){super();this.Fhi=b}}Object(u.a)(JB,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var qw=e(1379);class LF{constructor(){this.Gmj=0;this.uxj=null}}Object(u.a)(LF,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",
null,[]);const az=b=>!(null===b||void 0===b?0:b.length),cI=b=>null==b?!1:[...b].some(h=>h.ld),IK=b=>null==b?!1:[...b].some(h=>!h.ld);class zt{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re,me,Sd,cf,sf,yh,si){this.lk=yh;this.eGh=[];this.x8e=[];this.rB=b;this.oj=h;this.yh=r;this.Xs=A;this.c7=L;this.Pe=Ia;this.Vk=Ta;this.pb=ba;this.rI=ra;this.Hka=bc;this.nMb=Bc;this.Hla=ob;this.BM=nb;this.ga=Eb;this.Iq=Yc;this.yg=zd;this.Ii=Jd;this.qb=ie;this.Zc=re;this.HPh=me;this.Qd=Sd;this.Lh=cf;
this.YHc=sf;this.BM&&(this.BM.addHandler(xs.a.I0b,Object(E.a)(this,this.Ttj,"onShowingPlaceholder")),this.BM.addHandler(xs.a.Lxe,Object(E.a)(this,this.Usj,"onRemoveWhenEdited")),si.execute(cl=>{this.oI=cl}));this.lT=ej.a.getInstance(Ql.a.Mwl)}get Kw(){return this.rB.value}get fl(){return this.oj.value}get o9(){return!!this.yg.instance&&this.yg.instance.o9}get q9(){return!!this.Qd&&this.Qd.isFeatureEnabled(26)}dispose(){this.BM&&(this.BM.removeHandler(xs.a.I0b,Object(E.a)(this,this.Ttj,"onShowingPlaceholder")),
this.BM.removeHandler(xs.a.Lxe,Object(E.a)(this,this.Usj,"onRemoveWhenEdited")))}ZQ(b,h,r,A=!1){if(this.o9)return this.zua(b,h,r);if(!b||!h)return null;const L=this.yh.iha(b.node.id,!0);var ba=this.yh.iha(h.node.id,!1);if(!L||!ba)return null;b=b.contextId===ic.a.od?b:vc.a.jd(L,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===ic.a.od?h:vc.a.jd(ba,-1===h.cpEnd?ba.characterData.length:h.cpEnd);ba=null;switch(r){case 0:ba=this.gym(b,h);break;case 1:ba=this.ILm(b,h);break;case 3:ba=this.dJi(b,h,A);break;case 2:ba=
this.sVm(b,h);break;case 4:ba=this.yLf(b,h,!1)}return ba}zua(b,h,r){if(!b||!h||b.contextId!==ic.a.od&&(b=this.Qbi(b,!0),!b)||h.contextId!==ic.a.od&&(h=this.Qbi(h,!1),!h))return null;let A=null;switch(r){case 0:A=this.hym(b,h);break;case 1:A=this.JLm(b,h);break;case 3:A=this.eJi(b,h);break;case 2:A=this.tVm(b,h);break;case 4:A=this.yLf(b,h,!0)}return A}Qbi(b,h){var r=this.yh.iha(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Ob):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=
b.nc);r=vc.a.jd(r,h);r.Ob=b;r.nc=b;return r}gym(b,h){const r=new Cb.a;if(b.contextId===ic.a.od||h.contextId===ic.a.od||b.equals(h))return r;const A=new ki.a,L=this.jSb(b,b),ba=this.jSb(h,h);for(let ra=0;ra<L.count;ra++)if(L.K(ra).ld)for(let Ia=0;Ia<ba.count;Ia++)ba.K(Ia).ld||L.K(ra).Fe.equals(ba.K(Ia).Fe)&&(!L.K(ra).Pg||this.yh.WZa(L.K(ra).Fe,b.node.id,!0)&&this.yh.WZa(ba.K(Ia).Fe,h.node.id,!1))&&this.iUd(r,A,L.K(ra).Fe);return r}hym(b,h){const r=new Cb.a;if(b.contextId===ic.a.od||h.contextId===ic.a.od||
b.equals(h)&&b.Ob===b.nc||-1===b.Ob||-1===h.nc)return r;var A=b.node.ra.Vh(b.cpBegin),L=h.node.ra.Vh(h.cpEnd);A&&A.Qb&&0<A.Qb.length&&b.Ob<=A.Qb.length&&L&&L.Qb&&0<L.Qb.length&&h.nc<=L.Qb.length&&(b=b.Ob,h=h.nc,b===A.Qb.length&&b--,0<h&&h--,A=A.Qb.K(b),L=L.Qb.K(h),A.ld&&!L.ld&&V.a.Kx(A.Fe,L.Fe)&&A.qr&&L.qr&&(L=A.je)&&r.add(this.xT(L)));return r}ILm(b,h){const r=new Cb.a,A=new ki.a,L=this.jSb(b,h);for(let ba=0;ba<L.count;ba++)this.iUd(r,A,L.K(ba).Fe);b=this.dJi(b,h,!1,!1);for(const ba of b)A.contains(ba.objectId)||
(r.add(ba),A.add(ba.objectId));return r}JLm(b,h){const r=new Cb.a,A=new ki.a,L=this.DKf(b,h);for(let ba=0;ba<L.count;ba++)this.Ehf(r,A,L.K(ba));b=this.eJi(b,h);for(const ba of b)A.contains(ba.objectId)||(r.add(ba),A.add(ba.objectId));return r}dJi(b,h,r,A=!0){const L=new Cb.a;b.equals(h)&&(r=!1);const ba=new ki.a;let ra=!1;b=this.jSb(null,b,!0,r);h=this.jSb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Ia=0;Ia<h.count&&!(b.K(r).Fe.equals(h.K(Ia).Fe)&&(b.K(r),this.iUd(L,ba,b.K(r).Fe)&&(ra=!this.yh.Hw(b.K(r).Fe).ka(Rc.a.$ba,
null),A||ra)));Ia++);if(0<L.count&&(A||ra))break}return L}eJi(b,h){const r=new Cb.a,A=new ki.a,L=b.node;var ba=h.node;const ra=h.contextId===ic.a.od?ba.characterData.length:h.cpEnd;b=this.Iq.Eca(L,b.contextId===ic.a.od?L.characterData.length:b.cpBegin,b.Ob);h=this.Iq.Eca(ba,ra,h.nc);ba=b.count>h.count?h.count:b.count;for(--ba;0<=ba;ba--)b.K(ba).Fe.equals(h.K(ba).Fe)&&this.Ehf(r,A,b.K(ba));return r}sVm(b,h){const r=new Cb.a;let A=new ki.a;const L=this.jSb(b,h);let ba=0,ra=null;if(b.equals(h))return r;
for(b=0;b<L.count;b++)!L.K(b).ld||L.K(b).Pg&&!this.yh.WZa(L.K(b).Fe,L.K(b).Rb.paragraph.id,!0)?L.K(b).ld||L.K(b).Pg&&!this.yh.WZa(L.K(b).Fe,L.K(b).Rb.paragraph.id,!1)||(ba--,0>ba?(ba=0,A=new ki.a):!ba&&ra&&L.K(b).Fe.equals(ra)&&this.iUd(r,A,ra)):(ba||(ra=L.K(b).Fe),ba++);return r}tVm(b,h){const r=new Cb.a;if(b.equals(h)&&b.Ob===h.nc)return r;let A=new ki.a;b=this.DKf(b,h);h=0;let L=null;for(let ba=0;ba<b.count;ba++){const ra=b.K(ba);!ra.ld||ra.Pg&&!this.yh.WZa(ra.Fe,ra.Rb.paragraph.id,!0)?ra.ld||
ra.Pg&&!this.yh.WZa(ra.Fe,ra.Rb.paragraph.id,!1)||(h--,0>h?(h=0,A=new ki.a):!h&&L&&ra.Fe.equals(L.Fe)&&this.Ehf(r,A,L)):(h||(L=ra),h++)}return r}yLf(b,h,r){const A=new Cb.a;b=r?this.DKf(b,h):this.jSb(b,h);h=0;for(r=0;r<b.count;r++){var L=b.K(r);L.qr&&(L.ld?h++:(h--,0>h?h=0:(L=this.xT(L.je))&&A.add(L)))}return A}jSb(b,h,r=!0,A=!0){const L=new Cb.a,ba=this.aZ(b,h);if(!ba.count)return L;let ra,Ia,Ta,ob;for(let nb=0;nb<ba.count;nb++){ra=0;Ia=ba.K(nb).characterData.length;Ta=ob=!0;if(b&&ba.K(nb).id.equals(b.node.id)){if(b.contextId===
ic.a.od)continue;0<=b.cpBegin&&(ra=b.cpBegin)}h&&ba.K(nb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ia=h.cpEnd);nb||(Ta=r);nb!==ba.count-1||h&&h.contextId===ic.a.od||(ob=A);L.addRange(this.EKf(ba.K(nb),ra,Ia,Ta,ob))}return L}DKf(b,h){const r=new Cb.a,A=this.aZ(b,h);let L,ba,ra;for(let Ta=0;Ta<A.count;Ta++){const ob=A.K(Ta);if(ob.ra.length){var Ia=ob.ra.jc(ob.ra.length-1);L=0;ba=ob.characterData.length;ra=0;Ia=Ia&&Ia.Qb?Ia.Qb.length:0;b&&ob.id.equals(b.node.id)&&(L=b.Uj,ra=b.Ob);h&&ob.id.equals(h.node.id)&&
(ba=h.Yp,Ia=h.nc);r.addRange(this.FKf(ob,L,ba,ra,Ia))}}return r}EKf(b,h,r,A=!0,L=!0,ba=!0){const ra=new Cb.a;b=b.ra;for(let Ia=0;Ia<b.length;Ia++){if(b.jc(Ia).cp<h)continue;if(b.jc(Ia).cp>r)break;const Ta=b.jc(Ia);if(Ta.Qb&&0<Ta.Qb.length&&(Ta.cp!==h||A)&&(Ta.cp!==r||L))for(let ob=0;ob<Ta.Qb.length;ob++){const nb=Ta.Qb.K(ob);(ba||nb.ld)&&ra.add(nb)}}return ra}FKf(b,h,r,A,L){const ba=new Cb.a;b=b.ra;for(let ra=0;ra<b.length;ra++){if(b.jc(ra).cp<h)continue;if(b.jc(ra).cp>r)break;const Ia=b.jc(ra);if(Ia.Qb&&
0<Ia.Qb.length){let Ta=0,ob=Ia.Qb.length;Ia.cp===h&&-1!==A&&(Ta=A);for(Ia.cp===r&&-1!==L&&(ob=L);Ta<ob&&Ta<Ia.Qb.length;Ta++)ba.add(Ia.Qb.K(Ta))}}return ba}iUd(b,h,r){let A=null;if(h.contains(r)||!(A=this.fl.Mb(r)))return!1;b.add(this.xT(A));h.add(r);return!0}Ehf(b,h,r){let A=null;!h.contains(r.Fe)&&(A=r.je)&&(b.add(this.xT(A)),h.add(r.Fe))}h9j(b,h){let r,A=!1;r=({Eeb:h,Deb:b,psd:A}=this.i9j(b,h,!1,A)).returnValue||A;A&&(r=r||({Eeb:h,Deb:b,psd:A}=this.i9j(h,b,!0,A)).returnValue);return{returnValue:r,
Eeb:h,Deb:b}}i9j(b,h,r,A){let L,ba;if(r)return L=ba=null,{returnValue:!1,Eeb:ba,Deb:L,psd:!1};let ra=!1;ba=b;L=h;const Ia=b.cpBegin,Ta=h.cpEnd;A=!1;var ob=r?this.cyi(h):this.Cnm(b);let nb=!1,Eb=!1,bc=0,Bc=0;for(const Yc of ob)for(ob=0;ob<Yc.ra.length;ob++){const zd=Yc.ra.jc(ob);!Eb&&Yc.id.equals(h.node.id)&&(Eb=!0);if(!nb&&(Yc.id.equals(h.node.id)&&-1!==Ta&&zd.cp>Ta||Eb&&!Yc.id.equals(h.node.id)))if(nb=!0,bc!==Bc)ra=!0;else return{returnValue:!1,Eeb:ba,Deb:L,psd:A};if((!Yc.id.equals(b.node.id)||zd.cp>=
Ia||-1===Ia)&&zd.Qb)for(let Jd=0;Jd<zd.Qb.length;Jd++){const ie=zd.Qb.K(Jd),re=this.fl.Mb(ie.Fe);if(!re.getValue(Rc.a.Yca)||(!ie.ld||this.yh.WZa(this.Lh.Ds(re.id,!0),Yc.id,!0))&&(ie.ld||this.yh.WZa(this.Lh.Ds(re.id,!1),Yc.id,!1))){ie.ld?bc++:bc--;if(ra&&bc===Bc)return{Eeb:ba,Deb:L}=this.NKl(b.node,Yc,b.cpBegin,zd.cp),{returnValue:!0,Eeb:ba,Deb:L,psd:A};!r&&bc<Bc&&(A=!0,Bc--)}}}return{returnValue:ra,Eeb:ba,Deb:L,psd:A}}NKl(b,h,r,A){let L;h.id.equals(b.id)?b=0<r||A<rd.ParagraphReader.textLength(h)?
L=vc.a.createTextRange(h,r,A):L=vc.a.create(h):(L=0<r?vc.a.createTextRange(b,r,rd.ParagraphReader.textLength(b)):vc.a.create(b),b=A<rd.ParagraphReader.textLength(h)?vc.a.createTextRange(h,0,A):vc.a.create(h));return{Eeb:L,Deb:b}}AHm(b){const h=b.cpBegin,r=this.cyi(b);for(let L=r.count-1;0<=L;L--){const ba=r.K(L);for(let ra=ba.ra.length-1;0<=ra;ra--){const Ia=ba.ra.jc(ra);if((!ba.id.equals(b.node.id)||Ia.cp<=h||-1===h&&!Ia.cp)&&Ia.Qb){var A=Ia.Qb.length-1;for((Ia.cp===h||-1===h&&!Ia.cp)&&this.o9&&
ba.id.equals(b.node.id)&&(A=b.Ob-1);0<=A;A--){const Ta=Ia.Qb.K(A),ob=this.fl.Mb(Ta.Fe);if(Ta.ld){if(ob.getValue(Rc.a.Yca)&&!this.yh.WZa(this.Lh.Ds(ob.id,!0),ba.id,!0))continue;return null}if(!ob.getValue(Rc.a.Yca)||this.yh.WZa(this.Lh.Ds(ob.id,!1),ba.id,!1))return this.xT(ob)}}}}return null}xT(b){if(!b)return null;this.yh.UQb();return this.c7.dPb(b,this.rB,this.oj,this.yh,this.Xs,this,this.Hka,this.Hla,this.nMb)}onm(b,h){var r;const A=[];y.AFrameworkApplication.ud("DeleteTocUsingBackspace;DeleteTocUsingBackspaceCf");
const L=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsDeleteTocUsingBackspaceEnabled",!1);for(r=0;r<h.count;r++){let ba;if(12===h.K(r).type)ba=r!==h.count-1||L&&b.I8i?vc.a.create(h.K(r)):vc.a.createTextRange(h.K(r),0,rd.ParagraphReader.textLength(h.K(r))),this.Ii&&(ba.Ob=this.Ii.wt(ba.node,!0),ba.nc=this.Ii.wt(ba.node,!1));else if(15===h.K(r).type)ba=yt.TableNodeContext.create(h.K(r));else continue;A.push(ba)}return A}aZ(b,h){b=this.byi(b,
h,zt.xtb(12));if(!b)return null;h=new Cb.a;for(const r of b)h.add(r);return h}Anm(b,h){if(hq.a.Euf){var r=zt.xtb(14);if(r(b.node)){const A=new te.a;A.set(b.node);Lh.l(A);b=vc.a.create(A.currentNode)}r(h.node)&&(r=new te.a,r.set(h.node),Lh.p(r),h=vc.a.create(r.currentNode))}return this.byi(b,h,zt.MDm())}byi(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var A=b.node;if(A&&r(A)){var L;return L=new Cb.a,L.add(A),L}}A=Object.assign(new LF,{Gmj:35,uxj:r});b=b?b.node:
null;h=h?h.node:null;L=this.YPm(b,h);if(!L)return null;h=this.R9k(h,r,zt.B2h,A);return this.wnm(b,h,L,r,zt.B2h,A)}YPm(b,h){return(b=b?this.NFi(b):this.NFi(h))?b.xd(35):this.yh.oKm()}R9k(b,h,r,A){if(!b)return null;h(b)||(h=this.xnm(b,h,r,A),h.count&&(b=h.K(h.count-1)));return b}wnm(b,h,r,A,L,ba){b?(b=te.a.kb(b),b.Ib(7),r=Xd.a.$u(b,r)):r=Xd.a.Mp(r);L&&r.Oq(L,ba);for(L=new Cb.a;r.moveNext()&&(A(r.currentNode)&&L.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return L}xnm(b,h,r,A){b=Xd.a.Mp(b);
r&&b.Oq(r,A);for(r=new Cb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}NFi(b){b=te.a.kb(b);return b.Ib(35)?b:null}MSi(b,h){b=this.aZ(b,h);for(const r of b)if((b=this.yh.bOf(r))&&b.Ina(4))return!0;return!1}aTh(b,h=null,r=!1){if(!b)return!1;var A=b.start,L=b.end;if(!Ee.a.Ny(A)&&A.contextId!==ic.a.paragraph||!Ee.a.Ny(L)&&L.contextId!==ic.a.paragraph||!this.o9&&({Eeb:A,Deb:L}=this.h9j(b.start,b.end)).returnValue||this.o9&&!({start:A,end:L}=this.Krl(A,L)).returnValue)return!1;b.start=
A;b.end=L;const ba=this.Spn(A,L);if(this.o9){var ra=this.zua(b.start,b.end,3);var Ia=this.zua(b.start,b.end,2)}else ra=this.ZQ(b.start,b.end,3),Ia=this.ZQ(b.start,b.end,2);const Ta=ra&&0<ra.count?ra.K(0):null,ob=Ia&&0<Ia.count?Ia.K(0):null;if(r)return this.Sad(b,0,ra)?!0:!1;if(this.Sad(b,0,ra)){r=(r=Object(ya.a)(IF,this.AHm(b.start)))?this.yh.Hw(r.objectId):null;Ia=this.yh.X0k(b,Ta,r,Ia,b.ow,b.EB,h);this.lk.Xtc(Ia);if(b.Pg)for(L=this.aZ(b.start,b.end),r=0;r<L.count;r++)if(this.o9){ra=Ta?Ta.objectId:
null;const nb=this.rFi(ra,L.K(r),!0);this.Xs.cBa(L.K(r),Ia.id,0,!0,!0,void 0,void 0,void 0,void 0,nb);ra=this.rFi(ra,L.K(r),!1);this.Xs.cBa(L.K(r),Ia.id,L.K(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ra)}else this.Xs.cBa(L.K(r),Ia.id,0,!0,!0),this.Xs.cBa(L.K(r),Ia.id,L.K(r).characterData.length,!0,!1);else this.o9?(r=-1===A.Ob?0:A.Ob,this.Xs.cBa(b.start.node,Ia.id,A.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.Xs.cBa(b.end.node,Ia.id,L.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ba?
r+1:L.nc)):(this.Xs.cBa(b.start.node,Ia.id,b.start.cpBegin,!1,!0),this.Xs.cBa(b.start.node,Ia.id,b.start.cpEnd,!1,!1));h||this.yh.G_o(Ia,b.Pg,b.id,this.yh.Gnc(this.yh.Hw(b.ow)),b.type);1===b.type&&this.Xs.pAp(b.start.node,A.Uj,A.Yp);h=!(hq.a.Hpb&&8===b.type);b.objectId=Ia.id;A=this.yh.cDa().currentNode;h&&!A.hasProperty(Rc.a.zZc)&&A.setValue(Rc.a.zZc,WacWordeditorStrings.ContentControlPlaceholder);h&&hq.a.gia&&this.yh.eck(WacWordeditorStrings.ContentControlPlaceholder,Ia);Ta&&this.mdk(Ta.je,b);ob&&
this.mdk(Ia,ob);h&&ba&&this.ga.Zb(fb.a.Isd,2,b.id);hq.a.Hpb&&8===b.type&&this.MSj(!1,b,Ia);qw.a.bbi()&&this.oI&&this.oI.fireEvent(3,{node:Ia});return!0}return!1}deleteContentControl(b){if(!this.Sad(b,3))return v.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.lk.Qvd(b.je))return!0;b.KN&&(b.KN=!1);const h=this.pb.ob.currentSelection;b=b.sH();const r=new Fl.Selection(b.toArray(),!0);let A=!1;this.pb.y1b(()=>{this.pb.Uc(r);if(32===this.ga.Vb(fb.a.WJ,2)){if(this.HPh.instance){const L=
this.HPh.instance.mHi(h,r,this.pb.ob.currentSelection);this.pb.dCp(new KF.SelectionCollection([L],0))}A=!0}});return A}IFa(b,h=!1,r=!1){if(this.Sad(b,2)){if(b.KN)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const A=b.je;let L=new Cb.a;h&&(L=b.RJf());L.add(b);if(r||!this.lk.Qvd(b.je)){A&&A.anchor&&this.yh.eji(A,h);for(const ba of L)b=this.aZ(ba.start,ba.end),this.Xs.yWl(b,ba.objectId);this.GDj(L)}v.ULS.sendTraceTag(528537616,
368,50,"Successfully released content control.");return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}mEg(b,h){if(this.Sad(b,1)){let Ia=!1;h||(Ia=!0,{Aap:r,returnValue:h}=this.pTb(b),r&&this.yh.cDa().currentNode.setValue(Rc.a.zZc,h));var r=b.fAi().toArray();for(var A=0;A<r.length;A++)this.IFa(r[A],!0);r=this.zjp(h);if(b.Pg){A=this.aZ(b.start,b.end);if(!A.count)return!1;if(1===A.count&&y.AFrameworkApplication.$v)this.Xs.lf(vc.a.createTextRange(A.K(0),0,A.K(0).characterData.length),
h);else{var L=this.yh.BLm(A.K(0));h=A.K(0).eSb();A=this.yh.wji(A);A=this.yh.lTh(L,A,r.length);for(L=0;L<A.count;L++){this.Xs.lf(vc.a.createTextRange(A.K(L),0,0),r[L],void 0,b.type);for(var ba=0;ba<h.count;ba++)this.Xs.cBa(A.K(L),h.K(ba),0,!0,!0),this.Xs.cBa(A.K(L),h.K(h.count-ba-1),A.K(L).characterData.length,!0,!1)}b.XHp(A.K(0).id,A.K(A.count-1).id);r=this.rI.Ie(A.K(0),0);this.pb.Uc(r)}}else{L=0;1<r.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");
h=b.start;A=h.node;for(var ra=0;ra<A.ra.length&&h.contextId===ic.a.Nd;ra++)if(ba=A.ra.jc(ra),ba.cp===h.cpBegin&&ba.blob){L++;for(ra+=1;ra<A.ra.length;ra++)if(ba=A.ra.jc(ra),ba.cp>h.cpBegin&&ba.cp<=h.cpEnd)if(ba.blob)L++;else break;else if(ba.cp>h.cpEnd)break;break}if(0<L&&L+h.cpBegin<h.cpEnd)A=vc.a.createTextRange(h.node,h.cpBegin,h.cpBegin+L),h=vc.a.createTextRange(h.node,h.cpBegin+L,h.cpEnd),this.Xs.lf(h,r[0]),this.Xs.lf(A,"");else if(0<L&&L+h.cpBegin===h.cpEnd)for(this.Xs.lf(b.start,r[0]),r=0;r<
A.ra.length;r++){if(L=A.ra.jc(r),L.cp===h.cpBegin){L.blob=null;break}}else y.AFrameworkApplication.$v?(r=r.join(" "),this.Xs.lf(b.start,r)):this.Xs.lf(b.start,r[0],void 0,b.type)}this.gNb(b,Ia);let Ta;this.cuo((Ta=new Cb.a,Ta.add(b),Ta));return!0}return!1}gNb(b,h){const r=this.Xs.Smc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const L=this.yh.Hw(b.objectId);if(h){h=this.Vk.pG(b.start.node);var A=h.Qg(Ql.a.qog);A||(Wj.a.Zf.zl?(A=h.Ev().Ena(Ql.a.ezj),A=h.Qg(this.Vk.Je(A))):A=h.Rua(Ql.a.ezj));
A&&(this.Pe.ota(r.formatting),this.Pe.Hgb(r.formatting,A));L&&(b.KN=!0)}else L&&b.KN&&(this.lPo(b,r),b.KN=!1)}else v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}lPo(b,h){b=this.yh.Hw(b.objectId);let r=null;b&&(r=b.ka(Rc.a.SOb,V.a.nil));this.Pe.ota(h.formatting);r&&!r.equals(V.a.nil)&&(b=this.oj.value.Mb(r),h.formatting=b)}pTb(b){let h=!1;b=b.placeholderText;this.Jzn(b)&&(b=WacWordeditorStrings.ContentControlPlaceholder,h=!0);return{returnValue:b,Aap:h}}aFo(b,
h=!0){this.Hla&&(h&&this.WEo(b),this.hFo(b))}bFo(b){if(this.Hla&&(b=this.ZQ(b,b,4)))for(const h of b)this.IFa(h,!1)}t3n(b,h){if(h&&!b.ld&&(this.yh.UQb(),(b=b.Rb.paragraph.ed.Mb(b.Fe))&&b.anchor)){this.yh.eji(b);b=this.c7.dPb(b,this.rB,this.oj,this.yh,this.Xs,this,this.Hka,this.Hla,this.nMb);let r;this.GDj((r=new Cb.a,r.add(b),r))}}Usj(b,h){this.yh.UQb();b=this.yh.Hw(h.Fe);const r=this.xT(b);if(r&&r.isValid()&&r.removeWhenEdited){const A=this.Zc.Vc(7);A.Eb(b);this.IFa(r,!1);h.state=2;A.dispose()}}Ttj(b,
h){this.yh.UQb();b=this.yh.Hw(h.Fe);this.Qnn(b)&&(b=b.ka(Rc.a.yy,0),this.ga&&(this.ga.Zb(fb.a.Isd,2,b),zt.Yd.xkf()))}Qnn(b){return b&&b.isConnected&&!b.ka(Rc.a.aca,!1)?this.n0f(b)&&!b.Xy:!1}n0f(b){b=this.c7.dPb(b,this.rB,this.oj,this.yh,this.Xs,this,this.Hka,this.Hla,this.nMb);if(!b.isValid())return!1;if(b.Pg){if(b.ow.toString()===b.EB.toString()){var h=this.yh.Hw(b.ow);if(!h)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&
1===h.ra.length)return this.z0i(h.ra.jc(0),b.objectId)}}else{h=b.start;if(!h)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.yh.Hw(b.ow).ra.Vh(h.cpBegin),this.z0i(h,b.objectId)}return!1}z0i(b,h){b=b?b.Qb:null;if(!b)return!1;const r=b.qN(h,!0);return-1<r&&r+1<b.length&&b.K(r+1).Fe.toString()===h.toString()}vGj(b){this.x8e.push(b)}R1j(b,h){if(void 0===b||null===b||b.contextId!==ic.a.Nd)return null;
b=vc.a.jd(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<rd.ParagraphReader.textLength(b.node)?this.yh.F2a(b):null}select(b,h){if(b&&!b.equals(V.a.nil)){var r=this.yh.Hw(b);if(r&&55===r.type){r=this.xT(r);if(r.Pg)r=this.wpm(r);else{r=r.start;if(!r)return;r.contextId=ic.a.Nd;r=this.rI.aq(r)}if(r&&r.length)return this.$Sj(r.Ya,b,h,!0,!0),this.$Sj(r.hd,b,h,!1,!1),this.pb.Uc(r),r}}}aVo(b,h){if(!Ee.a.Df(b)||b.Ob!==b.nc)return!1;const r=b.Ob;return-1===r?!1:(b=this.Iq.yab(b.node,b.cpBegin,r,
!h))&&h===b.ld?(h=this.xT(b.je),this.select(b.Fe,!h.isEditable||hq.a.Hpb&&8===h.type),!0):!1}wpm(b){let h;if(hq.a.Euf){var r=this.yh.iha(b.ow,!0);h=this.yh.iha(b.EB,!1);if(r&&h){const {kEe:A,C4d:L,success:ba}=this.YHc.Crf(vc.a.create(r),vc.a.create(h));if(ba)r=A.node,h=L.node;else return v.ULS.sendTraceTag(508045132,368,15,"Could not get content control's start and end top level nodes correctly."),null}r&&h||v.ULS.sendTraceTag(508086488,368,15,`Could not select entire block content control -${r?"":
" <missing top level startObject>"} ${h?"":" <missing top level endObject>"}`)}else if(r=this.yh.OXa(b.ow,!0),h=this.yh.OXa(b.EB,!1),!r||!h)return null;r=this.Anm(vc.a.create(r),vc.a.create(h));if(!r||!r.count)return null;b=this.onm(b,r);return new Fl.Selection(b,!0)}c_o(b){if(b&&!b.equals(V.a.nil)&&(this.yh.UQb(),(b=this.yh.Hw(b))&&55===b.type&&b.isConnected)){var h=b.ka(Rc.a.aca,!1);b.setValue(Rc.a.aca,!1);h&&this.Nzo(b)}}evd(b){if(b&&!b.equals(V.a.nil)&&(this.yh.UQb(),(b=this.yh.Hw(b))&&55===b.type&&
b.isConnected)){var h=this.xT(b);h.isEditable&&8===h.type&&this.MSj(!h.isChecked,h,b)}}MSj(b,h,r){try{const {HQa:A,font:L}=this.Erm(b,r),ba=this.Zc.Vc(15);ba.Eb(r);h.isChecked=b;this.mEg(h,A);const ra=this.Xs.Smc(h.start.node,Math.max(h.start.cpBegin,0));this.Pe.rja(ra.formatting,L);ba.dispose();this.lT.logKpiSuccess({kpiName:Ql.a.P6h})}catch(A){throw this.lT.logKpiFailure({kpiName:Ql.a.P6h,errorName:"FailedToToggleCheckboxState"}),A;}}Erm(b,h){b?(b=h.ka(Me.a.$ai,Ql.a.oUl),h=h.ka(Me.a.Zai,Ql.a.nUl)):
(b=h.ka(Me.a.hbi,Ql.a.qUl),h=h.ka(Me.a.gbi,Ql.a.pUl));b=String.fromCodePoint(Number("0x"+b));return{HQa:b,font:h}}Nzo(b){var h=this.Lh.Ds(b.id,!0);h.equals(V.a.nil)||(h=this.yh.iha(h,!0))&&(b=this.Xs.vLf(h,b.id,!0))&&0<b.count&&(b=b.K(0),h=b.Rb,h.formatting=b.$V?b.$V.og(h):new kF.a(h,V.a.nil))}pHj(b){if(b=this.cBi(b))for(const h of b)this.lk.fFg()&&(h.KN=!1),this.IFa(h,!1)}ZAi(b){const h=new Cb.a;if(b=this.cBi(b))for(const r of b)h.add(r.je);return h}cFo(b){if(b&&(11===b.type||14===b.type||15===b.type||
16===b.type)){var h=this.qb.Vn(b),r=this.qb.vH(b);if(this.Ii&&h&&r){b=this.Ii.wt(h,!0);const A=this.Ii.wt(r,!1);h=vc.a.create(h);r=vc.a.create(r);h.Ob=b;r.nc=A;if(b=this.zua(h,r,4))for(const L of b)this.IFa(L,!1)}}}Dnm(b){var h=this.Lh.Ds(b.id,!0,b.kR);b=this.Lh.Ds(b.id,!1,b.kR);if(h.equals(V.a.nil)||b.equals(V.a.nil))return new Cb.a;h=this.yh.iha(h,!0);b=this.yh.iha(b,!1);return h&&b?this.aZ(vc.a.create(h),vc.a.create(b))||new Cb.a:new Cb.a}OXa(b,h){return this.yh.OXa(b,h)}HNf(b,h){if(b&&55===b.type&&
(b=this.xT(b),b=h?b.start:b.end)){const r=vc.a.jd(b.node,h?b.Uj:b.Yp);r.Ob=r.nc=(h?b.Ob:b.nc)+(h?-1:1);return r}return null}Htm(b){return(b=this.xT(b))?b.start:null}$Sj(b,h,r,A,L){if((b.contextId===ic.a.Nd||b.contextId===ic.a.kd||b.contextId===ic.a.paragraph)&&(L=b.node.ra.Vh(L?b.Uj:b.Yp))&&L.Qb)for(let ba=0;ba<L.Qb.length;ba++){const ra=L.Qb.K(ba);if(ra.Fe.equals(h)&&ra.qr)if(A&&ra.ld){b.Ob=r?ba:ba+1;break}else if(!A&&!ra.ld){b.nc=r?ba+1:ba;break}}}cuo(b){for(let h=0;h<this.eGh.length;++h)(0,this.eGh[h])(this,
new JB(b))}GDj(b){for(let h=0;h<this.x8e.length;++h)(0,this.x8e[h])(this,new JB(b))}hFo(b){b=vc.a.create(b);if(b=this.ZQ(b,b,4))for(const h of b)h.Pg||this.IFa(h,!1)}WEo(b){if(b=b.eSb())for(let r=0;r<b.count;r++){var h=this.yh.Hw(b.K(0));h=this.c7.dPb(h,this.rB,this.oj,this.yh,this.Xs,this,this.Hka,this.Hla,this.nMb);this.IFa(h)}}Cnm(b){return this.aZ(b,null)}Sad(b,h,r=null){let A=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,
50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.coa));if(this.Gvn(h)&&this.Hvn(h)&&!this.Rnn(b))return!1;if(!r){const ra=this.xLm(b);ra&&(r=new Cb.a,r.add(ra))}var L=this.yh.AIi(b.start.node);const ba=this.yh.AIi(b.end.node);if(L&&ba&&!L.equals(ba)||!L&&ba||L&&!ba)return!1;L=!0;if(r&&0<r.count){if(!r.K(0).isSupported)return!1;L=r.K(0).isEditable}switch(h){case 0:A=this.kln(b,L);break;case 1:A=(this.q9||!this.c2f(b))&&b.isSupported&&b.isEditable&&
this.eZh(b)&&this.C0i(b);y.AFrameworkApplication.$v||(A=A&&!this.MSi(b.start,b.end));break;case 2:const ra=b.I8i?!0:b.isSupported;A=(this.q9||!this.c2f(b))&&ra&&b.coa&&L;v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:A=b.isSupported&&b.coa&&L&&this.eZh(b)&&this.C0i(b)&&!this.MSi(b.start,b.end)}}catch(ba){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ba),A=!1}return A}Hvn(b){return!(y.AFrameworkApplication.$v&&1===b)}Gvn(b){return!(this.o9&&
(!b||2===b||3===b))}kln(b,h){return!this.q9&&this.c2f(b)||!this.lln(b)||!this.Drn(b)||!h||this.Ysn(b)?!1:this.rmn(b)?!0:(hq.a.AZf&&v.ULS.sendTraceTag(508074052,368,15,"Unexpected isBlockContentControlNotContainingEntireTableRowsOrCells = false"),!1)}Drn(b){var h;const r=b.start,A=r.contextId,L=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.Pg?A!==ic.a.paragraph&&A!==ic.a.od||L!==ic.a.paragraph&&L!==ic.a.od?!1:!0:Ee.a.Ny(r)||A===ic.a.od?!0:!1}cBi(b){if(!b||!b.length)return null;const h=b[0];
b=b[b.length-1];this.Ii&&(this.qb.Xn(h)&&12===h.node.type&&(h.Ob=this.Ii.wt(h.node,!0)),this.qb.Xn(b)&&12===b.node.type&&(b.nc=this.Ii.wt(b.node,!1)));return this.zua(h,b,4)}eZh(b){b=b.RJf();for(const h of b)if(!h.isSupported||!h.coa)return!1;return!0}Rnn(b){if(this.h9j(b.start,b.end).returnValue)return!1;const h=this.ZQ(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.Pg&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&
(-1===b.end.cpEnd||b.end.cpEnd===rd.ParagraphReader.textLength(r.end.node)))||!r.Pg&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===rd.ParagraphReader.textLength(b.end.node)))))return!1;return!0}C0i(b){if(b.Pg){var h=this.yh.Hw(b.ow),r=this.yh.Hw(b.EB);let A=null;if(12===h.type&&12===r.type){h=this.yh.Gnc(h);h=this.yh.Hw(h);r=this.yh.Gnc(r);
r=this.yh.Hw(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(A=h)}b=this.aZ(b.start,b.end);if(!b.count)return!1;for(const L of b)if(b=this.yh.Gnc(L),b=this.yh.Hw(b),!b||!(16!==b.type||A&&b.id.equals(A.id)))return!1}return!0}c2f(b){var h,r;return b.Pg?!1:(b=null===(h=b.start)||void 0===h?void 0:h.node)?b.ka(Rc.a.a2,!0)||(null!==(r=b.ka(Kh.a.Zia,null))&&void 0!==r?r:b.ka(Kh.a.DQ,null))?!1:!0:!0}lln(b){return 1!==b.type?!0:b.ow.equals(b.EB)&&rd.ParagraphReader.lc(b.start.node)&&!this.b5m(b)?
!0:!1}b5m(b){const h=b.start;var r=h.node;const A=r.ra;if(b.Pg){if(r.Iy||r.Rca||r.hasBookmark)return!0;for(var L of A)if(this.RSi(L))return!0;return!1}b=h.Uj;r=h.Yp;let ba=L=null;for(const ra of A.Z9i(b,r))if(!(ra.cp<b))if(ra.cp===b)L=ra;else if(ra.cp===r)ba=ra;else if(this.RSi(ra))return!0;return this.c5m(h,L,ba)?!0:!1}RSi(b){return az(b.Qb)&&az(b.Nf)&&az(b.Oi)&&az(b.Fc)&&null==b.hyperlink&&!b.Qp&&null==b.blob?!1:!0}c5m(b,h,r){var A,L,ba,ra,Ia,Ta;if(null==h&&null==r)return!1;const ob=b.Ob;b=b.nc;
return null!=h&&(h.Qb&&ob<h.Qb.length||null!=h.blob)||null!=r&&r.Qb&&0<b||null!=h&&null!=r&&(cI(null===(A=h.Nf)||void 0===A?void 0:A.getItems())&&IK(null===(L=r.Nf)||void 0===L?void 0:L.getItems())||cI(null===(ba=h.Oi)||void 0===ba?void 0:ba.getItems())&&IK(null===(ra=r.Oi)||void 0===ra?void 0:ra.getItems())||!az(h.Fc)&&!az(r.Fc)&&[...(null===(Ia=h.Fc)||void 0===Ia?void 0:Ia.getItems())].some(nb=>0===nb.ze)&&[...(null===(Ta=r.Fc)||void 0===Ta?void 0:Ta.getItems())].some(nb=>3===nb.ze)||null!=h.hyperlink&&
r.Qp)?!0:!1}Ysn(b){var h,r;return(null!==(r=null===(h=this.ZQ(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==r?r:[]).some(A=>1===A.type)?!0:!1}rmn(b){if(!b.Pg)return!0;var h=this.yh.Hw(b.ow);b=this.yh.Hw(b.EB);if(ih.TableCellReader.rEa(h)||ih.TableCellReader.rEa(b)||yp.a.B9(h)||yp.a.B9(b))return!1;h=this.yh.Gnc(h);h=this.yh.Hw(h);b=this.yh.Gnc(b);b=this.yh.Hw(b);if(!h||!b)return!1;if(hq.a.AZf){if(16===h.type&&16===b.type&&!h.id.equals(b.id))return!1}else if((16===h.type||16===b.type)&&
!h.id.equals(b.id))return!1;return!0}xLm(b){if(!b)return null;b=this.yh.Hw(b.objectId);if(!b)return null;b=b.ka(Rc.a.$ba,V.a.nil);return b.equals(V.a.nil)?null:(b=this.yh.Hw(b))?this.xT(b):null}cyi(b){return this.aZ(null,b)}zjp(b){return(b||"").split(RegExp("\r\n|\r|\n"))}Jzn(b){return b&&""!==b?!1:!0}rFi(b,h,r){h=h.ra.Vh(r?0:h.characterData.length);if(!h)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Qb||!h.Qb.length)return 0;if(!b)return r?
0:h.Qb.length;for(let A=0;A<h.Qb.length;A++){const L=h.Qb.K(A);if(V.a.Kx(L.Fe,b)&&L.ld===r)return r?A+1:A}return r?0:h.Qb.length}Krl(b,h){var r=b.node,A=h.node,L=b.contextId===ic.a.paragraph?0:b.cpBegin,ba=h.contextId===ic.a.paragraph?rd.ParagraphReader.textLength(A):h.cpEnd;r=this.Iq.Eca(r,L,b.Ob);A=this.Iq.Eca(A,ba,h.nc);ba=!r||!r.count;L=!A||!A.count;if(ba&&L)return{returnValue:!0,start:b,end:h};if(ba)return{returnValue:this.EHe(b,A.K(A.count-1).Fe,!0),start:b,end:h};if(L)return{returnValue:this.EHe(h,
r.K(r.count-1).Fe,!1),start:b,end:h};if(r.count===A.count)return r=r.K(r.count-1),A=A.K(A.count-1),{returnValue:r.Fe.equals(A.Fe),start:b,end:h};r=(ba=r.count<A.count)?A.K(A.count-1):r.K(r.count-1);return{returnValue:ba?this.EHe(b,r.Fe,!0):this.EHe(h,r.Fe,!1),start:b,end:h}}EHe(b,h,r){var A=b.node;let L;if(r){L=b.contextId===ic.a.paragraph?0:b.cpBegin;var ba=b.Ob}else L=b.contextId===ic.a.paragraph?rd.ParagraphReader.textLength(A):b.cpEnd,ba=b.nc;A=A.ra.Vh(L);if(-1===ba||!A||!A.Qb||!A.Qb.length)return!1;
A=A.Qb;if(r)for(r=ba;r<A.length;r++){ba=A.K(r);if(!ba.ld)break;if(ba.Fe.equals(h))return b.Ob=r+1,!0}else for(r=ba-1;0<=r;r--){ba=A.K(r);if(ba.ld)break;if(ba.Fe.equals(h))return b.nc=r,!0}return!1}Spn(b,h){return this.Mfl(b,h)&&b.Ob===b.nc&&(b.contextId===ic.a.kd||b.contextId===ic.a.paragraph&&!b.node.characterData.length)}Mfl(b,h){return b.equals(h)&&b.Ob===h.Ob&&b.nc===h.nc}mdk(b,h){if(b&&h.Pg){var r=this.Lh.Ds(b.id,!0),A=this.yh.iha(h.ow,!0);r.equals(A?A.id:null)&&this.Lh.NK(b.id,h.objectId,!0);
r=this.Lh.Ds(b.id,!1);A=this.yh.iha(h.EB,!1);r.equals(A?A.id:null)&&this.Lh.NK(b.id,h.objectId,!1)}}static get Yd(){return null!=zt.mah?zt.mah:zt.mah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static xtb(b){return h=>h.type===b}static MDm(){return b=>12===b.type||15===b.type}static B2h(b,h){return b.Jf===h.Gmj||b.parentNode&&h.uxj(b.parentNode)?!1:!0}}Object(u.a)(zt,"ContentControlOperator",null,[626,11,627]);class MF{constructor(b,h,r){this.td=b;this.rB=h;this.sJb=
r}iPi(b){const h=this.SSb();return h&&b&&this.QTb(h,b)?this.HXm(h):null}QTb(b,h,r=!1){if(!b||!h)return!1;do{var A=b.currentNode;if(!A)break;A=A.ka(Rc.a.Qnc,null);if(A===h||r&&A&&A.includes(h))return!0}while(b.gg(29));return!1}HXm(b){var h=b.ic(1);b.Ac();b=b.vN(1);if(!h||!b)return null;h=Tb.SelectionFactory.Nfi(h,b);b=Ee.a.Xk(h,!1,!1);return hq.a.gia&&!b?null:Tb.SelectionFactory.SA(h,b.hd)}SSb(){const b=this.td.Lm();b.set(this.rB.value);this.sJb.bU(b);return b.ic(28)&&b.ic(29)?b:null}$Nf(){const b=
this.td.Lm();b.set(this.rB.value);this.sJb.bU(b);return b.ic(28)?b:null}Azm(b){var h=this.SSb();if(!h||!b||!this.QTb(h,b,!1))return null;h.ue();b=1<h.Bs();h.ue();h.ue();h=h.currentNode;return rd.ParagraphReader.lc(h)?{Rse:h,ZSi:b}:{Rse:null,ZSi:b}}RBi(){const b=this.SSb();return this.QTb(b,Ql.a.Aii,!0)?b.currentNode.getValue(Rc.a.Qnc):null}}Object(u.a)(MF,"GlossaryNavigator",null,[407]);class JK{constructor(b,h,r,A,L,ba){this.Xs=b;this.yh=h;this.wn=r;this.qb=A;this.pi=L;this.Hla=ba}Zqd(b,h,r){if(!this.Hla)return 1;
if(!({Fq:L}=this.T4f(b)).returnValue||!this.pi.e8i(L,h)||this.mHj(b,h))return 2;var A=this.pi.dyi(h);var L=A.K(0).eSb();L&&L.count||(L=new Cb.a,L.add(b.objectId));b=this.yh.wji(A);r=r.split("\n");h=Object(ya.a)(te.a,this.yh.bOf(h));h=this.yh.lTh(h,b,r.length);for(b=0;b<h.count;++b){A=h.K(b);this.Xs.lf(vc.a.createTextRange(A,0,0),r[b]);for(let ba=0;ba<L.count;++ba)this.Xs.cBa(A,L.K(ba),0,!0,!0),this.Xs.cBa(A,L.K(L.count-ba-1),A.characterData.length,!0,!1)}return 0}mHj(b,h){if(!this.Hla)return 1;let r;
if(!({Fq:r}=this.T4f(b)).returnValue||!this.pi.e8i(r,h))return 2;h=this.pi.dyi(h);if(0<h.count&&(h=this.wn.ZQ(vc.a.create(h.K(0)),vc.a.create(h.K(h.count-1)),2)))for(const A of h)if(A.id!==b.id&&!this.wn.IFa(A,!0))return 2;return 0}Nrc(b){if(!this.Hla||!({Fq:r}=this.T4f(b)).returnValue)return!1;b=b.RJf();for(var h of b)if(!h.coa||!h.isSupported)return!1;if(this.pi.Hnn(r))return!1;var r=Object(ya.a)(te.a,this.yh.bOf(r));h=new Cb.a;this.qb.oTb(r,!0,!1,h);for(const A of h)if(0<A.ka(Rc.a.uRb,0)||this.qb.ebb(A).cB)return!1;
return!0}T4f(b){let h=null;return b&&b.ow.toString()===b.EB.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.yh.Hw(b.ow))&&14===h.type?{returnValue:!0,Fq:h}:{returnValue:!1,Fq:null}:{returnValue:!1,Fq:h}}}Object(u.a)(JK,"TableContentControlEditor",null,[406]);class Qn{Hnn(b){let h=!1;const r=new te.a;r.set(b);Lh.b(r,A=>{if(!ih.TableCellReader.eh(A)){let L=hm.OutlineNavigator.zda(A);for(;L;){if(Mb.a.koc(A))return h=!0,!1;L=A.Di(1)}}return!0});return h}e8i(b,h){const r=new te.a;r.set(h);
return ih.TableCellReader.rEa(h)&&r.Ib(14)&&r.xd(14).id===b.id?!0:!1}dyi(b){const h=new Cb.a,r=new te.a;r.set(b);b=new Cb.a;rd.ParagraphReader.oTb(r,!0,!1,b);for(const A of b)h.add(A);return h}}Object(u.a)(Qn,"TableReader",null,[405]);class dI{constructor(){this.wn=null}get name(){return"WordEditor.ContentControl"}init(){y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled")&&(HB.a.q1a(Object(E.a)(Xa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Xa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").t3n,
"onContentControlRangeChanged")),this.wn=Xa.a.instance.Wa("WordEditor.ContentControl.IContentControlOperator"),Xa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Xa.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.wn&&(this.wn.dispose(),this.wn=null)}Ec(b){b.ja("WordEditor.ContentControl.Perf.IPerfLogger",()=>new WH.a(ed.a.We)).ha();b.ja("WordEditor.ContentControl.ContentControlFactory",()=>new aI(Xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();
b.ja("WordEditor.ContentControlNodeFactory",()=>new FF(Xa.a.instance.Za("Box4.ContentControlConfigSettings"),Xa.a.instance.Za("Box4.ContentControl.IContentControlOperator"))).ha();b.ja("WordEditor.ContentControl.ContentControlGraphManager",()=>new ow(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),new dj.a,Object(ao.a)(),Xa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Xa.a.instance.resolve("Box4.IOutlineEditor"),Xa.a.instance.resolve("Box4.IOutlineElementEditor"),
Xa.a.instance.resolve("Box4.IParagraphReader"),Xa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Xa.a.instance.Za("Box4.ContentControlConfigSettings"),Xa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Xa.a.instance.Za("WordEditor.ContentControl.GlossaryEditor"),Xa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ja("WordEditor.ContentControl.GlossaryNavigator",()=>new MF(new dj.a,new xe.a(()=>
Db.StaticActiveAppFrame.Aa().tb.rd),Object(ao.a)())).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ja("WordEditor.ContentControl.ContentControlOperator",()=>new zt(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Xa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
Fg.a.instance,Xa.a.instance.resolve("Box4.ISelectionFactory"),Xa.a.instance.resolve("Box4.IFormattingEditor"),Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"),Xa.a.instance.Wa("Box4.IContentControlDataChangedManager"),y.AFrameworkApplication.va,Xa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Xa.a.instance.resolve("Box4.IContentControlChpHelper"),
Xa.a.instance.Za("Box4.ContentControlConfigSettings"),Xa.a.instance.Wa("Box4.IContentControlReader"),Xa.a.instance.resolve("Box4.IParagraphReader"),Xa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Xa.a.instance.Za("Box4.Actors.IVirtualSelectionMerger"),Xa.a.instance.resolve("Box4.IFeatureHelper"),Xa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Xa.a.instance.resolve("Box4.IContentControlAroundTableChecker"),Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Xa.a.instance.Za("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ja("WordEditor.ContentControl.ContentControlManager",()=>new pw(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Xa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Xa.a.instance.Za("Box4.ContentControlConfigSettings"),Xa.a.instance.resolve("Box4.IContentControlChpHelper"),Xa.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ja("WordEditor.ContentControl.ContentControlChpManager",()=>new $H(Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.Za("Box4.ContentControlConfigSettings"),Xa.a.instance.resolve("Box4.IParagraphReader"),Xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ja("WordEditor.ContentControl.GlossaryEditor",()=>new YH(Xa.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Xa.a.instance.resolve("Box4.IOutlineElementEditor"),Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Xa.a.instance.resolve("Box4.TextFormattingHelper"),Xa.a.instance.resolve("Box4.IFormattingEditor"),Ze.a.wf.Um.Hf(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ja("WordEditor.ContentControl.TableContentControlEditor",
()=>new JK(Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Xa.a.instance.resolve("Box4.IParagraphReader"),new Qn,y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();y.AFrameworkApplication.J.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ja("Box4.ContentControlConverter",()=>new Ck(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ja("WordEditor.ContentControl.ContentControlCCP",()=>new ZH(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ja("WordEditor.ContentControl.ContentControlFormattingManager",()=>new JF(new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),Xa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Xa.a.instance.resolve("Box4.Actors.TextFormattingActor"),Xa.a.instance.resolve("Box4.TextFormattingHelper"))).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){F.a.instance.Rc(new dI)}}
Object(u.a)(dI,"ContentControlPackage",null,[0,1]);var KK=e(1290),LK=e(1402),bM=e(1778),Xj=e(1527);class Dg{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(u.a)(Dg,"UxManagerMenuActionTelemetryData",null,[]);class eI extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.rDl=r}}Object(u.a)(eI,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class fI extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(u.a)(fI,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class gI{constructor(b,h,r,A,L,ba,ra=!1,Ia=null,Ta=null,ob=null,nb=!1,Eb=null,bc=!1,Bc=!0,Yc=null,zd=!1,Jd=10){this.target=this.container=this.fh=null;this.isDismissed=!1;this.did=this.Rhd=this.Kri=this.v2=this.zx=this.Bia=this.TEa=this.ePa=this.documentElement=this.Bxa=this.editingElement=null;this.isFocused=!1;this.e3d=null;this.Qng=this.i1f=!1;this.RIe=null;this.eue=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=A;this.j_k=
L;this.m_a=ba;this.$Wa=ra;this.EZj=Ia;this.Wta=Ta;this.hostServices=ob;this.Ldp=nb;this.bwj=Eb;this.QZj=bc;this.q0l=Bc;this.Kri=Yc;this.showDictationCommandUx=zd;this.source=Jd}}Object(u.a)(gI,"UxManagerState",null,[]);var yD=e(1587);class Go{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.oc=b;this.pb=h;this.nD=r;this.zd=A;this.Ce=L;this.Sb=ba;this.Fk=ra;this.Rn=Ia;this.L7=Ta;this.n7b=ob;this.Saf=!1;this._state=null;this.shouldIgnoreFocusEvent=nb=>{var Eb;return this.zd.Pd.ay&&!this.zd.Pd.xZ&&nb===(null===
(Eb=this.zd.Ve)||void 0===Eb?void 0:Eb.editingElement)};this.sa=new Nf.a;this.$Pd=new kb.a;this.jjf((nb,Eb)=>{Go.uMn(r,Eb.definition,Eb.source)});this.N6k((nb,Eb)=>{Go.tMn(r,Eb.definition,Eb.source,Eb.rDl)});this.oc.te(Go.l7d).LN=!0;y.AFrameworkApplication.va.qa(Lc.a.f1c,ic.a.view,this.f1c.bind(this))}jjf(b){this.sa.addHandler(Go.mbg,b)}AJj(b){this.sa.removeHandler(Go.mbg,b)}xuo(b,h){this.sa.raiseEvent(Go.mbg,new fI(b,h))}N6k(b){this.sa.addHandler(Go.Wij,b)}wuo(b,h,r){this.sa.raiseEvent(Go.Wij,new eI(b,
h,r))}vIp(b){var h;if(!b.isDismissed&&b.Bxa){var r=yD.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=yD.b(r);var A=ed.a.getElementBounds(b.Bxa);r.width||r.height?r.x+r.width<A.x||r.x>A.x+A.width||r.y+r.height<A.y||r.y>A.y+A.height?this.dismiss():(A=b.target,A.style.left=r.x+"px",A.style.top=r.y+"px",A.style.width=r.width+"px",A.style.height=r.height+"px",null===(h=b.fh)||void 0===h?void 0:h.updatePosition(),b.fh||v.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):
(v.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}zDj(b){b.isDismissed||b.RIe||(b.RIe=new Md.a(2,1,1,()=>{b.RIe=null;this.vIp(b)},147),this.Sb.pc(b.RIe))}ePa(b,h){!b.isDismissed&&b.q0l&&0<h.JR.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}ial(b){return!!b&&b.id===Go.m_k}TEa(b,h){if(b.isDismissed||
!h||!h.Yb)return!1;h=h.Yb;const r=h.keyCode,A=!b.isFocused&&!!b.fh,L=h.altKey||h.ctrlKey||h.shiftKey;let ba=!1;r===pg.a.H6?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ba=!0):r!==pg.a.vw&&r!==pg.a.iB||!A||L||!this.ial(b.definition)?r!==pg.a.t5b&&r!==pg.a.kxd||!A||L||(this.urg(b),b.fh?(b.fh.focus(),ba=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.fh.executeDefaultAction(),v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ba=!0);ba&&(h.preventDefault(),h.stopPropagation());return ba}Rhd(b,h){if(b.isDismissed||!b.fh)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.fh),!1;b.fh.invokeBadgeId(h);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}did(b,h){if(b.isDismissed||!b.fh)return v.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.fh),!1;b.fh.executeActionFromString(h);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}Bia(b,h){if(b.isDismissed||!h||!h.Yb||!b.fh)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?
0:h.Yb),!b.fh),!1;const r=b.target;b=b.fh.getElementBounds();var A=h.Yb;h=A.clientX;A=A.clientY;r&&Go.gzj(h,A,ed.a.getElementBounds(r),16)||b&&Go.gzj(h,A,Go.mll(b),4)||this.dismiss();return!1}j8o(b){var h=yD.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=yD.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=Go.Rvf();b.target=h;b.editingElement=this.zd.Ve.editingElement;b.Bxa=this.zd.Pd.container;b.documentElement=document.documentElement;b.ePa=(r,A)=>{this.ePa(b,A)};b.TEa=
r=>this.TEa(b,r);b.Bia=r=>this.Bia(b,r);b.v2=()=>{this.zDj(b)};b.zx=()=>{this.zDj(b)};b.showDictationCommandUx&&(b.Rhd=r=>this.Rhd(b,r),b.did=r=>this.did(b,r),this.n7b&&this.n7b.execute(r=>{r.y3o(b.Rhd);r.A3o(b.did)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.pb.BD(b.ePa);this.Fk.f4(b.zx);this.Ce.Cb(Fd.a.XM,b.editingElement,b.TEa);b.$Wa&&this.Rn.Cb(Fd.a.qwa,b.documentElement,b.Bia);Re.a.addHandler(b.Bxa,"scroll",b.v2);b.m_a||this.urg(b);return!0}ZTb(b,h){const r=
!!b.fh;this.wuo(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.oc.currentScope.name===Go.l7d&&this.oc.PW(Go.l7d);b.ePa&&this.pb.vpa(b.ePa);b.TEa&&b.editingElement&&this.Ce.Gc(Fd.a.XM,b.editingElement,b.TEa);this.n7b&&this.n7b.execute(A=>{b.showDictationCommandUx&&(A.PNo(),A.QNo());A.kUj(!1,b.showDictationCommandUx)});b.Bia&&b.documentElement&&b.$Wa&&this.Rn.Gc(Fd.a.qwa,b.documentElement,b.Bia);b.v2&&b.Bxa&&
Re.a.removeHandler(b.Bxa,"scroll",b.v2);b.zx&&this.Fk.bja(b.zx);b.fh=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.Bxa=null;b.ePa=null;b.TEa=null;b.Bia=null;b.v2=null;b.zx=null;b.Rhd=null;b.did=null;r&&b.Wta&&(b.i1f?b.Qng=!0:b.Wta(b.e3d))}zbb(b,h){var r;if(!h)return!1;switch(h.actionType){case Tp.b.Toggle:if(h.objectFulfillment===Go.xtp)return this.Saf=!this.Saf,this.QPg(),this.b1c(b),!0;if(h.objectFulfillment===Go.Btp)return{value:r}=this.$Pd.Nc(h.suggestionGroup.type,
!1),this.$Pd.W(h.suggestionGroup.type,!r),this.b1c(b),!0;break;case Tp.b.GiveFeedback:if(bM.a.Zon(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||Xj.a.Tzn(h.objectName))break;this.focus();this.QPg();this.b1c(b);return!0;case Tp.b.RevealSuggestions:this.b1c(b)}b.i1f=!0;h=b.j_k.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.i1f=!1;h&&this.b1c(b);b.Qng&&(b.Qng=!1,b.Wta(b.e3d),b.e3d=null);return h}b1c(b){b.Bia&&b.documentElement&&b.$Wa&&(this.Rn.Gc(Fd.a.qwa,b.documentElement,b.Bia),b.$Wa=
!1)}rbp(b,h){return b.id===LK.a.job?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}DHe(b){var h;if(this.j8o(b)){var r=1;y.AFrameworkApplication.J.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var A=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(A=b.definition.suggestionGroups[0].type,A=this.$Pd.Bb(A)?this.$Pd.K(A):b.Ldp);h=!1;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);r={containerElement:b.container,
targetElement:b.target,definition:b.definition,onAction:L=>this.zbb(b,L),onDismiss:L=>{this.ZTb(b,L)},keepCurrentFocus:b.m_a,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.Saf,showDescription:A,showEditorButton:b.QZj,showEditorBranding:this.rbp(b.definition,b.QZj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.Kri,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};
b.bwj&&b.bwj(r);this.nD.createContextualUi(r).then(L=>{this.xuo(b.definition,b.source);b.fh=L;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.EZj&&b.EZj();this.n7b&&9!==b.source&&this.n7b.execute(ba=>ba.kUj(!0,b.showDictationCommandUx))}).catch(L=>{this.ZTb(b,{h_p:KK.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",L)});0<b.eue&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.eue)}else 5<++b.eue?(v.ULS.sendTraceTag(50968330,
341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Sb.pc(new Md.a(2,1,Math.pow(3,b.eue),()=>{b.isDismissed||this.DHe(b)},146))}get jK(){return!!this._state&&!this._state.isDismissed}iPg(b,h){this.jK&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.jK?this._state.definition:null}set definition(b){this.jK&&(this._state.definition=b,this._state.fh&&this._state.fh.setDefinition(b))}focus(){this.jK&&this._state.fh&&(this._state.isFocused||
this.urg(this._state),this._state.fh.focus())}QPg(){this.jK&&this._state.fh&&this._state.fh.updatePosition()}urg(b){this.oc.zP(Go.l7d,!1);b.isFocused=!0}Spa(b,h,r,A,L,ba=null,ra=null,Ia=null,Ta=!1,ob=null,nb=!1,Eb=!0,bc=null,Bc=!1,Yc=10){if(!h||this._state&&!this._state.isDismissed)return!1;let zd,Jd;if(!({paragraphNode:Jd,start:b,end:zd}=Go.Zwp(b)).returnValue)return!1;this._state=new gI(Jd,b,zd,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc);this.DHe(this._state);return!0}a2b(b){this._state&&(this._state.e3d=
b)}f1c(b,h,r){if(1===r)return this.jK?32:0;this.jK&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.fh)||void 0===b?void 0:b.dismiss())}static uMn(b,h,r){r=new Dg(r);b.logAction({actionType:Tp.b.SessionStart,engagement:Tp.a.Try,objectName:Go.C5j,objectId:h.id,data:r});if(h.suggestionGroups)for(const A of h.suggestionGroups)b.logAction({actionType:Tp.b.Presented,engagement:Tp.a.See,objectName:A.type,objectId:A.id,data:r})}static tMn(b,h,r,A){r=
new Dg(r);b.logAction({actionType:Tp.b.SessionEnd,engagement:Tp.a.None,objectName:Go.C5j,objectId:h.id,data:r},A)}static Rvf(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static mll(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static gzj(b,h,r,A){const L=r.y-A,ba=r.x+r.width+A,ra=r.y+r.height+A;return r.x-A<=b&&b<=ba&&L<=h&&h<=ra}static Zwp(b){let h,r;if(!b||!rd.ParagraphReader.lc(b.node)||b.contextId!==ic.a.kd&&b.contextId!==ic.a.Nd&&b.contextId!==
ic.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==ic.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}Ctc(){this.L7&&this.L7.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Go.m_k="ActionSet";Go.C5j="IntentGroup";Go.l7d="CanvasContextualUxReact";Go.xtp="Context";Go.Btp="Description";Go.mbg="MenuDidOpen";Go.Wij="MenuDidClose";Object(u.a)(Go,"UxManager",null,[]);class hI{constructor(){this.Z=
null}get name(){return"WordEditor.CanvasContextualProvider"}Ec(b){this.Z=b}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){const b=y.AFrameworkApplication.J.$("EditorGoalsEnabled"),h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1);(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(55)||al.a.VNa||
y.AFrameworkApplication.J.$("RewriteIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("canvasContextual")).then(()=>{this.Z.ja("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:y.AFrameworkApplication.uiCulture,
dataCulture:y.AFrameworkApplication.dataCulture,isRightToLeft:y.AFrameworkApplication.isRtl,ulsLogger:new Ak.a,dimeCallback:async()=>{this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.Z.Za("Common.IInProductMessagingUIManager").execute(r=>{r.Tbj()})},getSoftPaywallData:()=>this.Z.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.Z.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
logSystemInitiatedFeedback:async r=>{this.Z.Za("Common.ISystemInitiatedFeedback").execute(A=>A.logActivity(r,null))}})).ha();this.Z.ja("WordEditor.CanvasContextualProvider.UxManager",()=>new Go(Jc.FocusManager.instance(),this.Z.resolve("Box4.ISelectionManager"),this.Z.resolve("CanvasContextual.ICanvasContextualController"),Object(Vb.a)(),lc.KeyInputManager.instance,y.AFrameworkApplication.zc,y.AFrameworkApplication.ta,y.AFrameworkApplication.ta.J$,this.Z.Za("Common.ISystemInitiatedFeedback"),this.Z.Za("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();
this.Z.resolve("CanvasContextual.ICanvasContextualController");this.Z.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.Z.ja("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new Ak.a})).ha(),this.Z.resolve("CanvasContextual.IEditorInitializer").init(),this.Z.ja("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new Ak.a})).ha(),
this.Z.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.Z.ja("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new Ak.a})).ha(),this.Z.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(r=>{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",r)})}dispose(){}static main(){F.a.instance.Rc(new hI)}}Object(u.a)(hI,"PackageManager",
null,[0,1]);class iI{constructor(b,h,r,A){this.ihn=(L,ba,ra)=>{L=null;ba.view.Ee&&(L=ba.view);if(!L||!L.ub)return 8;if(!this.LM.i2f())return 2;if(1===ra)return 32;this.YOk.lLl();return 32};this.Phj=(L,ba,ra)=>{let Ia=null;ba.view.Ee&&(Ia=ba.view);if(!Ia||!Ia.ub)return 8;if(!this.LM.i2f())return 2;if(1===ra)return 32;if(1!==this.LM.qnc(this.pb.ob,!0).count)return 2;ba=new hb.GraphTransaction(15);try{if(ba.Eb(Ia.Fd),!this.LM.cyp(L===Lc.a.Eag))return 8}finally{ba&&ba.dispose()}return 32};this.ga=b;this.pb=
h;this.LM=r;this.YOk=A}mc(){this.ga.qa(Lc.a.tfe,ic.a.view,this.ihn);this.ga.qa(Lc.a.Eag,ic.a.view,this.Phj);this.ga.qa(Lc.a.Qhj,ic.a.view,this.Phj)}}Object(u.a)(iI,"IntelligentPlaceholderActor",null,[]);class fA{constructor(){this.HGc=new kb.a;this.yBd=new kb.a}i0k(b,h){let r;({value:r}=this.HGc.Nc(b,r)).returnValue||this.HGc.W(b,r=new Ka.a);r.add(h)}M0k(b,h){this.yBd.Bb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.yBd.W(b,h)}h0k(b,h,r){this.i0k(b,h);this.M0k(h,
r)}Fpm(b){let h;return({value:h}=this.HGc.Nc(b,h)).returnValue?h:null}Usm(b){let h;return({value:h}=this.yBd.Nc(b,h)).returnValue?h:null}mIo(b){let h;if(({value:h}=this.HGc.Nc(b,h)).returnValue){for(const r of h)this.yBd.remove(r);this.HGc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(u.a)(fA,"IntelligentPlaceholderAtMentionManager",null,[640]);var dt=e(1687);class KB extends dt.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get hx(){return WacWordeditorStrings.IntelligentPlaceholder}hZj(b){return!b.ka(Rc.a.iK,
!1)}$Xa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(u.a)(KB,"IntelligentPlaceholderDetailsProvider",dt.a,[]);var qp=e(1845),MK=e(2096),NK=e(1849);class jI{constructor(){this.PHa=""}Xna(b){this.PHa+=b}uZf(b){this.PHa+=b}mfe(b){this.PHa+=b}mpc(b){this.PHa+=b}eZf(b){this.PHa+=b}}Object(u.a)(jI,"PlainTextFormatCreator",null,[1796]);var zD=e(1569),Qx=e(2095),gA=e(1568),NF=e(1412);class Gr{constructor(){this.cJc=new kb.a}contains(b){return this.cJc.Bb(Gr.g6f(b))}add(b){this.cJc.W(Gr.g6f(b),
b)}remove(b){this.cJc.remove(Gr.g6f(b))}qAp(b){for(const h of b.cJc)this.add(h.value)}Fri(){const b=new Cb.a;for(const h of this.cJc)b.add(h.value.Lk);return b}static g6f(b){return b.Lk.toString()}}Object(u.a)(Gr,"CommentRangeSet",null,[]);class LB extends Sys.EventArgs{constructor(b){super();this.vL=b}}Object(u.a)(LB,"OnFollowUpEventArgs",Sys.EventArgs,[]);class OF extends LB{constructor(b,h){super(b);this.zjo=h}}Object(u.a)(OF,"OnCreateEventArgs",LB,[]);class nr extends LB{constructor(b,h){super(b);
this.Exn=h}}Object(u.a)(nr,"OnResolveEventArgs",LB,[]);var AD=e(222);class bz{}bz.sLe="MentionExperienceDegraded";Object(u.a)(bz,"AtMentionsConstants",null,[]);class MB{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.tgd=b;this.Qgl=h;this.Lud=r;this.iYd=A;this.ub=L;this.wu=ba;this.Pfe=ra;this.JYi=Ia;this.ry=Ta;this.Qfc=ob;this.R0a=null;this.v9n=(nb,Eb,bc)=>{v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");nb=this.Pfe.ecb(nb,bc.displayName,bc.email,bc.id);this.ariaNotify(String.format(WacWordeditorStrings.AtMentionsSuggestionSelected,
Eb),!0);nb?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Qfc.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:bz.sLe,isInternal:!0})};this.j8n=(nb,Eb)=>{v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");Eb&&this.Qfc.Sy(Lc.a.Lsl);this.Pfe.$1m(nb.id,Eb)};this.i4n=()=>{this.wu.Pd.ay&&!this.wu.Pd.xZ&&this.wu.Ve.mCf?this.N4h=!0:(this.tgd.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};
this.H$n=()=>{v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Q3k()};this.i8n=(nb,Eb,bc,Bc=new Map)=>{Bc=Object.assign(new Sa.a,{extendedProperties:Bc});this.Qfc.logKpiFailure("LPPWordEditorKPI",nb,{isIntentional:Eb,isInternal:bc,additionalValues:Bc},{name:bz.sLe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:Eb,isInternal:bc,additionalValues:Bc})};(b=Xa.a.instance.Wa("Box4.IEditStateEventManager"))&&b.addHandler(AD.a.gKa,this.nPo.bind(this))}Lie(){return!!this.R0a}nPo(){this.Lie()&&
this.N4h&&(this.R0a.updateInputText(this.Vdd,!1),this.N4h=!1)}ariaNotify(b,h){this.ry.sendNotification(b,h)}Q3k(){const b=this.wu.Ve.editingElement;if(b){var h=b.getAttribute(le.a.uWc);b.setAttribute(le.a.uWc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}xHo(){const b=this.wu.Ve.editingElement;if(b){var h=b.getAttribute(le.a.uWc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?
b.setAttribute(le.a.uWc,h.join(" ")):b.removeAttribute(le.a.uWc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}jxl(){this.xHo();this.R0a&&this.R0a.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.R0a=null;this.JYi.xTj(!0)}jxe(){this.tgd.Qug(()=>{this.jxl()});this.tgd.Fug((b,h)=>{this.Vdd=b;if(this.R0a)1<this.Vdd.length&&"@"===this.Vdd.trimEnd()?
(this.Qfc.Sy(Lc.a.Ksl),this.tgd.reset()):this.R0a.updateInputText(this.Vdd,!1);else if(this.Qfc.logKpiUsage("LPPWordEditorKPI",0),this.Qfc.Sy(Lc.a.Ubo),(b=this.oCm(h))&&b.height){h=b.y;const r=b.height,A=document.createElement("div");A.id="PeoplePicker";A.style.position="absolute";A.style.top=h-5+"px";A.style.left=b.x+"px";A.style.height=r+10+"px";document.body.appendChild(A);this.Qgl.createPeoplePicker({editingElementId:this.wu.Ve.editingElement.id,containerElement:A,automationID:"PeoplePickerAutomationID",
onReplaceTextCallback:this.v9n,onPermissionsReceivedCallback:this.j8n,onDismiss:this.i4n,onShow:this.H$n,onFailure:this.i8n}).then(L=>{L.updateInputText(this.Vdd,!1);this.R0a=L;this.JYi.xTj(!1)})}});this.tgd.Gug(b=>{if(this.R0a)this.R0a.onKeyDown(b.Yb.rawEvent)})}oCm(b){var h=this.ub.ob;if(!h)return null;h=h.currentSelection;if(!h)return null;h=h.Ya;if(!h)return null;h=h.node;if(!h)return null;h=Object(ya.a)(89,h);if(!h)return null;h=Object(ya.a)(112,h.Dm(this.wu.Pd.Lc));if(!h)return null;h=Object(ya.a)(50,
h);if(!h)return null;let r=null;try{r=this.Lud.m4(this.iYd.Olc(2,b),h,!1,!1,!1,!1)}catch(A){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",A)}return r}}Object(u.a)(MB,"WordEditorAtMentionsHandler",null,[457]);var At=e(1395);class rp{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc){this.ga=b;this.td=h;this.rUa=r;this.pb=A;this.Yr=L;this.ee=ba;this.VG=ra;this.eHd=Ia;this.me=Ta;this.lr=ob;this.guk=Eb;this.oj=bc;this.Zc=nb;this.sa=new Nf.a;
this.uj=Bc;this.Odh=Yc;NF.a.njf((zd,Jd)=>{this.iK(Jd.vL,!0)&&this.sa.raiseEvent(rp.Yhd)})}OUh(b){this.sa.addHandler(rp.Cpj,b)}Y7k(b){this.sa.addHandler(rp.dtj,b)}F7k(b){this.sa.addHandler(rp.$6n,b)}njf(b){this.sa.addHandler(rp.Yhd,b)}iK(b,h){let r=b.ka(Rc.a.iK,!1);h&&(r=r&&!b.ka(Rc.a.zga,!1));return r}Wqc(b){return this.Yr.Wqc(b)}YIm(b){for(const h of b)for(const r of h)if(rp.s5f(r.contextId))return r.node.ed;return null}sQm(b,h,r){const A=new Gr,L=b.ed;for(let ba=0;ba<b.ra.length;ba++){const ra=
b.ra.jc(ba);if(ra.cp>=h)break;if(ra.Nf&&ra.Nf.length)for(let Ia=0;Ia<ra.Nf.length;Ia++){const Ta=ra.Nf.K(Ia);this.iK(L.Mb(Ta.Lk),r)&&(Ta.ld?A.add(Ta):A.remove(Ta))}}return A}tQm(b,h,r,A){const L=new Gr,ba=b.ed;for(let ra=0;ra<b.ra.length;ra++){const Ia=b.ra.jc(ra);if(Ia.cp>r)break;if(Ia.Nf&&Ia.Nf.length)for(let Ta=0;Ta<Ia.Nf.length;Ta++){const ob=Ia.Nf.K(Ta);this.iK(ba.Mb(ob.Lk),A)&&(ob.ld?Ia.cp<r&&L.add(ob):Ia.cp<=h&&L.remove(ob))}}return L}CLi(b,h){let r;const A=b.node;b.contextId!==ic.a.paragraph?
(r=b.cpBegin,b=b.cpEnd):(r=0,b=A.characterData.length);return r===b?this.sQm(A,r,h):this.tQm(A,r,b,h)}u7c(b,h){return rp.s5f(b.contextId)?this.CLi(b,h).Fri():new Cb.a}qnc(b,h){const r=new Gr;for(const A of b)for(const L of A)rp.s5f(L.contextId)&&r.qAp(this.CLi(L,h));return r.Fri()}i2f(){var b=this.pb.ob;if(!b||1!==b.length||1!==b.K(0).length)return!1;b=b.K(0).Ya.node;return rd.ParagraphReader.lc(b)&&!rd.ParagraphReader.WBa(b)&&this.Yr.Evb(this.ga,!0)?!0:!1}NXi(b,h){if(!this.i2f())return null;if(this.Yr.a4m())return v.ULS.sendTraceTag(592761861,
323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var A=this.pb.ob.K(0).Ya;A.contextId===ic.a.kd?(b=b?Ee.a.M8(A,!1):null)&&b.xy&&b.Ya.contextId===ic.a.Nd?this.pb.Uc(b):(this.ee.lf(A,WacWordeditorStrings.InsertIntelligentPlaceholderAnchorText+" ",!0),this.pb.Uc(Tb.SelectionFactory.eN(A.node,A.cpBegin,A.cpBegin+WacWordeditorStrings.InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.uj.$Pb||qp.a.instance.E$c();b=this.Yr.iic(this.pb.ob.currentSelection);if(!b)return null;
this.Wqc(b)&&this.Odh.Sy(wb.a.IOa,{succeeded:!0,Ohb:29});var L=this.td.Ag(b);const ba=L.ic(1);if(!ba||ba.yc!==on.a.MZ)return null;L=L.ic(2);if(!L||L.yc!==on.a.paragraphNode)return null;this.dPg(b.ed,b.id);this.sa.raiseEvent(rp.Cpj,new OF(b,h));r&&(h=A.node,A=A.contextId!==ic.a.paragraph?A.cpEnd:h.characterData.length,this.pb.Uc(Tb.SelectionFactory.eN(h,A,A)));return b}tfe(b){return!!this.NXi(!0,b)}S$c(b,h,r,A,L,ba){if(0>h)return!1;A="@"+A;const ra=A+" ",Ia=new hb.GraphTransaction(15);try{Ia.Eb(b);
this.ee.lf(vc.a.createTextRange(b,h,r),ra);this.me.Zg&&(this.lr.esf(b,h,h+A.length),this.lr.Kpa(b,h+A.length,h+ra.length,1));const Ta=this.VG.SJ(vc.a.createTextRange(b,h,h+A.length),"mailto:"+L,!1,!0,!1);if(!Ta)return!1;const ob=Ta.cA;if(!ob)return v.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.pb.Uc(Tb.SelectionFactory.eN(b,h,h+A.length));const nb=this.NXi(!1,2);if(!nb)return!1;ba&&this.eHd.h0k(ba,ob,nb.id);this.pb.Uc(Tb.SelectionFactory.Ie(b,
h+ra.length))}finally{Ia&&Ia.dispose()}return!0}ecb(b,h,r,A){const L=this.pb.hh;return Ee.a.Df(L)?this.S$c(L.node,L.cpBegin-b,L.cpBegin,h,r,A):!1}qMm(b){if(1===b.length&&b.K(0).xy&&(b=b.K(0).Ya,b.contextId===ic.a.kd&&rd.ParagraphReader.lc(b.node))){const h=b.node;for(let r=0;r<h.ra.length;r++){const A=h.ra.jc(r);if(A.cp===b.cpBegin){b=A.Gae(!0,!0);if(0<b.length)return b[0].Lk;break}}}return null}$Ob(b,h,r){return this.Yr.c_c(b,h,r).returnValue}g8d(b,h,r,A,L){let ba=!1;const ra=b.characterData;if(h>=
ra.length||r>ra.length||r<h)return{returnValue:!1,MXa:ba};let Ia=h,Ta=null;for(let nb=0;nb<b.ra.length;nb++){const Eb=b.ra.jc(nb),bc=Eb.cp;if(!(bc<h)){if(Eb.Qp&&Ta)try{const Bc=ra.substring(Ia,bc),Yc=new MK.a;Yc.fullName=Bc.startsWith("@")?Bc.substr(1):Bc;gA.a(Ta.url,Ta.cA,Yc);const zd=new NK.a;gA.b(Ta.cA,zd);L&&(zd.contentId=this.guk.$If());A.mfe(Bc,Yc,zd);ba=!0;Ta=null;Ia=bc}catch(Bc){var ob=Object.assign(new Sa.a,{extendedProperties:new Map});ob.extendedProperties.set("exception",Bc.message);this.Odh.logKpiFailure("LPPWordEditorKPI",
"FailedToRenderAtMention",{isInternal:!0,additionalValues:ob},{name:bz.sLe,isInternal:!0,additionalValues:ob})}bc<=r&&!Ta&&(ob=Math.min(bc,r),ob>Ia&&A.Xna(ra.substring(Ia,ob)),Ia=bc);Eb.hyperlink&&Eb.hyperlink.hK&&(Ta=Eb.hyperlink);if(bc>=r)break}}return{returnValue:!0,MXa:ba}}oyi(b,h,r,A,L=-1){var ba=!1,ra=b.Mb(h),Ia=b.Mb(At.l(ra));ra=b.Mb(At.i(ra));L=0<L?L:Number.MAX_VALUE;b=this.$Ob(Ia,h,!0);h=this.$Ob(ra,h,!1);if(-1===b||-1===h)return{returnValue:!1,MXa:ba};if(Ia===ra)return this.g8d(Ia,b,h,r,
A);const Ta=this.rUa.KWa(Ia,!1,!1);if(!Ta)return{returnValue:!1,MXa:ba};Ia=new Cb.a;let ob=0;do Ia.add(Ta.uC),ob+=Ta.uC.characterData.length;while(Ta.uC!==ra&&Ta.Jna()&&ob<L);for(L=0;L<Ia.count;L++)if(ba=Ia.K(L),ra=ba.characterData,L)if(L===Ia.count-1){if(!({MXa:ba}=this.g8d(ba,0,h,r,A)).returnValue)return{returnValue:!1,MXa:ba}}else{if(!({MXa:ba}=this.g8d(ba,0,ra.length,r,A)).returnValue)return{returnValue:!1,MXa:ba};r.Xna("\n")}else{if(!({MXa:ba}=this.g8d(ba,b,ra.length,r,A)).returnValue)return{returnValue:!1,
MXa:ba};r.Xna("\n")}return{returnValue:!0,MXa:ba}}f8d(b,h){const r=new jI;return this.oyi(b,h,r,!1,-1).returnValue?r.PHa:null}C5d(b,h){var r=b.Mb(h);if(!r)return null;b=b.Mb(At.i(r));if(!b)return null;h=this.$Ob(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!D.a.iia(r.charAt(h))){r=this.Zc.Vc(15);try{r.Eb(b),this.ee.lf(vc.a.jd(b,h)," ")}finally{r&&r.dispose()}}return Tb.SelectionFactory.Ie(b,h+1)}dPg(b,h){const r=b.Mb(h),A=new zD.a;this.oyi(b,h,A,!0).returnValue&&(A.Xna("\n"),this.Yr.nbk(r,
A.FSa),this.sa.raiseEvent(rp.Yao))}RVo(b,h){for(const r of b){if(r.contains(h))return!0;for(const A of r)for(const L of h)if(A.node===L.node&&A.Uj>=L.Uj)return!0}return!1}C0c(b,h,r,A,L){const ba=this.pb.ob.clone(),ra=new iv.a(Db.StaticActiveAppFrame.Aa().tb.Xc);b=Tb.SelectionFactory.Ie(b,h);r=vc.a.jd(r,A);b=Tb.SelectionFactory.SA(b,r);this.pb.Uc(b);r=!this.RVo(ba,b);return 32===this.ga.Sf(ra,fb.a.WJ,2,!0,null,null)?(r?this.pb.$W(ba):L!==V.a.nil&&(L=this.C5d(this.oj.value,L),this.pb.Uc(L)),!0):!1}dGo(b,
h){var r=b.Mb(h);const A=b.Mb(At.l(r));b=b.Mb(At.i(r));if(A===b){r=" "+WacWordeditorStrings.InsertIntelligentPlaceholderAnchorText;var L=A.characterData.indexOf(r);-1!==L&&this.C0c(A,L,b,L+r.length,h)}}oji(b,h,r){var A=b.Mb(h);if(!A)return!1;const L=b.Mb(At.l(A));b=b.Mb(At.i(A));A=this.$Ob(L,h,!0);const ba=this.$Ob(b,h,!1);if(-1===A||-1===ba||!this.C0c(L,A,b,ba,V.a.nil))return!1;r&&this.zji(h);return!0}zji(b){this.Yr.Pvg(b,!0)}cyp(b){var h=this.YIm(this.pb.ob);if(!h)return!1;const r=this.qnc(this.pb.ob,
!0);if(1!==r.count)return!1;const A=h.Mb(r.K(0));if(b)h=this.oji(h,r.K(0),!1);else{const L=At.l(A),ba=At.i(A);V.a.Kx(L,ba)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.JHl(r.K(0));h.Mb(L).vm(16,!0);h=!0}h&&(A.setValue(Rc.a.zga,!0),this.sa.raiseEvent(rp.dtj,new nr(A,b)));return h}V_h(b,h){b=this.qnc(this.pb.ob,!1);h.Gn[rp.eli]=!!b.count}Yqj(b,h){if(h.Gn[rp.eli]&&rd.ParagraphReader.lc(h.clone)&&(h=h.clone,b=h.ed)&&(h=vc.a.createTextRange(h,
0,h.characterData.length),h=this.u7c(h,!1),h.count))for(const r of h)(h=b.Mb(r))&&h.setValue(Rc.a.iK,!1)}Hum(b,h,r){let A;const L=({jYc:Ta}=this.Yr.c_c(h,r,!0)).returnValue;r=({jYc:A}=this.Yr.c_c(h,r,!1)).returnValue;let ba=null,ra=-1,Ia=-1;for(;Ta<A;Ta++){const ob=h.ra.jc(Ta);if(ob.hyperlink&&ob.hyperlink.hK&&ob.hyperlink.cA===b){ba=ob.hyperlink;ra=ob.cp;break}}if(!ba||ra<L)return{returnValue:!1,Zci:ra,Yci:Ia};for(b=Ta;b<h.ra.length;b++){var Ta=h.ra.jc(b);if(Ta.cp>r)break;if(Ta.a5){Ia=Ta.cp;break}}return{returnValue:-1!==
Ia,Zci:ra,Yci:Ia}}cHo(b){var h=this.eHd.Usm(b);if(h){var r=null;Db.StaticActiveAppFrame.Aa()&&(r=Db.StaticActiveAppFrame.Aa().tb.rd.Hd);if(r){var A=r.Mb(h);h=r.Mb(At.l(A));var L=r.Mb(At.i(A));if(h!==L)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({Zci:b,Yci:L}=this.Hum(b,h,A.id)).returnValue){var ba=new hb.GraphTransaction(7);try{ba.Eb(h);const ra=vc.a.createTextRange(h,b,L);this.ee.lf(ra,"");this.dPg(r,A.id)}finally{ba&&ba.dispose()}this.pb.ob&&0<this.pb.ob.length?
(r=this.pb.ob.K(0).Ya,r.node===h?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.pb.Uc(Tb.SelectionFactory.Ie(h,b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,
323,15,"Mention bookmark has no associated comments")}$1m(b,h){if(!h){h=this.eHd.Fpm(b);if(!h){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const r of h)this.cHo(r)}this.eHd.mIo(b)}tnm(){qp.a.instance.E$c();const b=new Cb.a;for(const r of this.Yr.Dkf)if(r.kt!==Qx.a.$F){var h=V.a.Of(r.objectId);h=this.oj.value.Mb(h);this.iK(h,!0)&&b.add(h)}return b}rVo(b){b=this.Yr.VQf(b);this.pb.Uc(b)}JHl(b){b?this.oj.value.Mb(b).setValue(Rc.a.iK,!1):v.ULS.sendTraceTag(594043491,
323,10,"The given intelligent placeholder guid is null")}static s5f(b){return b===ic.a.Nd||b===ic.a.kd||b===ic.a.paragraph}}rp.eli="DisableNestedIntelligentPlaceholder";rp.Cpj="CreateIntelligentPlaceholder";rp.dtj="ResolveIntelligentPlaceholder";rp.Yao="UpdateIntelligentPlaceholder";rp.Yhd="DeleteIntelligentPlaceholder";rp.$6n="MentionAddedToFollowUpEventKey";Object(u.a)(rp,"IntelligentPlaceholderEditor",null,[637,638,639]);class kI{constructor(b,h,r,A){this.Qza=!1;this._isEnabled=!0;this.Ce=null;
this.$ob=L=>{if(!this._isEnabled||!this.Brl(L,this.pb.ob))return!1;L.Yb.preventDefault();L.Yb.stopPropagation();this.zd.Pd&&this.zd.Pd.t2c(!1);L=this.C5d(this.pb.ob);if(!L)return!1;this.pb.Uc(L);return!0};this.zd=b;this.oj=h;this.pb=r;this.Paa=A}bgc(b,h){this.Qza||(b.uva?(this.apb(h),this.Qza=!0):b.gga(()=>{this.Qza||(this.apb(h),this.Qza=!0)}))}dispose(){this.Ce&&this.Ce.Gc(Fd.a.XM,this.zd.Ve.editingElement,this.$ob)}apb(b){this.Ce=b;this.zd.Pd.Aj&&this.Ce.Cb(Fd.a.XM,this.zd.Ve.editingElement,this.$ob)}Brl(b,
h){if(b.Yb.keyCode!==pg.a.iB&&b.Yb.keyCode!==pg.a.vw||1!==h.length||!h.K(0).xy)return!1;var r=this.Paa.qnc(h,!0);if(1!==r.count)return!1;const A=h.K(0).Ya.node;if(!rd.ParagraphReader.lc(A))return!1;b=this.Paa.$Ob(A,r.K(0),!0);r=this.Paa.$Ob(A,r.K(0),!1);return h.K(0).Ya.cpBegin<b||h.K(0).Ya.cpEnd>r?!1:!0}C5d(b){b=this.Paa.qnc(b,!0);if(1!==b.count)return null;b=b.K(0);return this.Paa.C5d(this.oj.value,b)}xTj(b){this._isEnabled=b}}Object(u.a)(kI,"IntelligentPlaceholderKeyboardListener",null,[635,11]);
class PF{constructor(b,h){this.kjn=r=>{1===r&&this.ga.Vb(wb.a.IOa,2);2===r&&(this.CIh.instance?this.CIh.instance.wDc("https://go.microsoft.com/fwlink/?linkid=2154656")&&D.a.BZ("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new ma.a,{name:"DialogResult",int64:r})];$d.d(Lc.a.mvi,void 0,void 0,void 0,
void 0,void 0,r)};this.ga=b;this.CIh=h}lLl(){const b=new wg.StandardDialog;b.Md=11;b.Ue(1,WacWordeditorStrings.TryIt);b.Ue(2,WacWordeditorStrings.LearnMore);b.Yx(WacWordeditorStrings.PhaseOutFollowUpsHeader,WacWordeditorStrings.PhaseOutFollowUpsContent,0,this.kjn);$d.a("FollowUpsPhaseOutDialogShown")}}Object(u.a)(PF,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var bo=e(1369);class BD{constructor(b,h,r,A,L,ba){this.iba=this.o7e=null;this.V9=()=>{this.iba||(this.iba=new Md.a(3,1,0,()=>{this.iba=
null;this.Wce(this.pb.ob)},130),this.Sb.pc(this.iba))};this.Zc=b;this.LM=h;this.pb=r;this.Sb=A;this.Lef=L;this.oj=ba;this.q7=new ng.a;this.Vs=new bo.a;this.sEh=new bk.a(this.q7);this.LM.OUh((ra,Ia)=>{this.X3k(Ia.vL)})}X3k(b){b=b.id;const h=this.DJi(this.oj.value,b);h&&this.Vs.W(b,h)}DJi(b,h){const r=b.Mb(h);return!r||this.LM.Wqc(r)?null:this.LM.f8d(b,h)}jml(b){const h=new bo.a;var r=this.LM.qnc(b,!0);if(!r)return h;b=this.oj.value;for(const A of r)(r=this.DJi(b,A))&&h.W(A,r);return h}Pvg(b){if(this.o7e){const h=
this.Zc.Vc(15);try{h.Eb(this.Lef()),this.LM.zji(this.o7e)}finally{h&&h.dispose()}}this.o7e=b?this.LM.qMm(b):null}A2m(b){const h=this.oj.value;if(b=b?this.jml(b):new bo.a){var r=new bk.a(this.q7),A=new bk.a(this.q7);BD.Sxm(this.Vs,b,r,A);for(var L of r)this.Vs.W(L,b.K(L));for(const ba of A)if(r=this.Vs.K(ba),A=this.LM.f8d(h,ba),this.Vs.remove(ba),A&&(b=L=!1,Ea.a.V7c().equals(A,WacWordeditorStrings.InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<A.indexOf(WacWordeditorStrings.InsertIntelligentPlaceholderAnchorText)?
L=!0:!Ea.a.V7c().equals(r,A),r||L||b)){A=this.Zc.Vc(15);try{A.Eb(this.Lef()),b?this.LM.oji(h,ba,!0):(L&&this.LM.dGo(h,ba),r&&this.LM.dPg(h,ba))}finally{A&&A.dispose()}}}}oLm(b){const h=new bk.a(this.q7);for(const r of b)for(const A of r)b=A.node,rd.ParagraphReader.lc(b)&&h.add(b.id);return h}V0m(b){var h=this.oj.value;const r=b?this.oLm(b):new bk.a(this.q7);if(r){b=new Cb.a;for(const ba of this.sEh)if(!r.contains(ba)){var A=h.Mb(ba);if(A){A=A.ra;for(let ra=0;ra<A.length;ra++){const Ia=A.jc(ra).Nf;
if(Ia)for(let Ta=0;Ta<Ia.length;Ta++){var L=Ia.K(Ta);L.ld&&(L=h.Mb(L.Lk))&&L.ka(Rc.a.Z8i,!1)&&V.a.Kx(ba,At.i(L))&&this.LM.Wqc(L)&&b.add(L)}}}}this.sEh=r;if(b.count){h=this.Zc.Vc(7);try{h.Eb(this.Lef());for(const ba of b)ba.fg(Rc.a.Z8i)}finally{h&&h.dispose()}}}}Wce(b){this.Pvg(b);this.A2m(b);this.V0m(b)}E4h(){this.iba&&(this.Sb.Kf(this.iba),this.iba=null)}bZb(){if(this.iba||this.oj.UVf)this.E4h(),this.Wce(null)}EG(){this.pb.BD(this.V9);y.AFrameworkApplication.IG(()=>{this.bZb()})}dispose(){this.pb.vpa(this.V9);
this.E4h()}static Sxm(b,h,r,A){for(const L of h){const ba=L.key;b.Bb(ba)||r.add(ba)}for(const L of b)b=L.key,h.Bb(b)||A.add(b)}}Object(u.a)(BD,"IntelligentPlaceholderSelectionCache",null,[11]);var CD;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.Ogl=2]="atMention";b[b.Axq=3]="textGesture";b[b.paste=4]="paste";b[b.dSp=5]="workItemIntent";b[b.$1p=6]="characterTrigger"})(CD||(CD={}));Object(u.b)("IntelligentPlaceholderCreation",CD);class ys{constructor(b,h,r,A){this.fIa=
b;this.yo=h;this.k7b=r;this.rB=A}yCe(b){return b&&b.ed&&b.ed.id.equals(this.rB.value.Hd.id)?!0:!1}CYj(b){return this.yCe(b)&&b.ka(Rc.a.iK,!1)?!0:!1}PMn(){this.k7b.execute(b=>{b.logAction({actionType:Tp.b.SessionStart,engagement:Tp.a.Offer,objectName:ys.mCc})})}Hle(b,h){const r=2==h&&this.yCe(b);if(this.CYj(b)||r){var A=b.getValue(Rc.a.KI);this.k7b.execute(L=>{L.logAction({actionType:Tp.b.Created,engagement:Tp.a.None,objectName:ys.mCc,objectId:A.toString(),objectFulfillment:CD[h]})})}}MKn(b){if(this.CYj(b)){var h=
b.getValue(Rc.a.KI);this.k7b.execute(r=>{r.logAction({actionType:Tp.b.Deleted,engagement:Tp.a.None,objectName:ys.mCc,objectId:h.toString()})})}}rNn(b,h){if(this.yCe(b)){var r=b.getValue(Rc.a.KI);this.k7b.execute(A=>{A.logAction({actionType:Tp.b.Resolved,engagement:Tp.a.None,objectName:ys.mCc,objectId:r.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}fOn(b){b===Lc.a.tfe&&this.k7b.execute(h=>{h.logAction({actionType:Tp.b.Deleted,engagement:Tp.a.None,objectName:ys.mCc,objectFulfillment:ys.Pqp})})}sMn(b){if(this.yCe(b)){var h=
b.getValue(Rc.a.KI);this.k7b.execute(r=>{r.logAction({actionType:Tp.b.Modified,engagement:Tp.a.None,objectName:ys.mCc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}Yil(){this.PMn();this.fIa.OUh((b,h)=>{this.Hle(h.vL,h.zjo)});this.fIa.Y7k((b,h)=>{this.rNn(h.vL,h.Exn)});this.fIa.F7k((b,h)=>{this.sMn(h.vL)});this.yo.ffc((b,h)=>{this.fOn(h.actionId)});NF.a.njf((b,h)=>{this.MKn(h.vL)})}}ys.mCc="IntelligentPlaceholder";ys.Pqp="Undo";Object(u.a)(ys,"IntelligentPlaceholderTelemetry",null,
[]);class Xu{constructor(){this.Paa=this.TId=this.oPd=this.Z=null}get name(){return"WordEditor.IntelligentPlaceholder"}Ec(b){this.Z=b;b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new PF(y.AFrameworkApplication.va,b.Za("Common.App.SafeLinks.ISafeLinksManager"))).ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new fA).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",
()=>new rp(y.AFrameworkApplication.va,new dj.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),b.resolve("WordEditor.Comments.CommentsSettings"),this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new iI(y.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new BD(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
y.AFrameworkApplication.zc,()=>Db.StaticActiveAppFrame.Aa().tb.Xc.Fd,new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd))).ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new kI(Object(Vb.a)(),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd.Hd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ja("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new ys(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Za("CanvasContextual.ICanvasContextualController"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd))).ha()}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()})}Sp(){const b=this.Z.resolve("Box4.IFeatureHelper");this.Z.Za("WordEditor.CanvasContextualProvider.UxManager");this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").mc();
this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").Yil();this.Paa=this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");dw.a.A6k(Object(E.a)(this.Paa,this.Paa.V_h,"beforeIntelligentPlaceholderPaste"));dw.a.XUd(Object(E.a)(this.Paa,this.Paa.Yqj,"onIntelligentPlaceholderPaste"));this.oPd=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(91)||this.oPd.EG();this.TId=this.Z.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.TId.bgc(Db.StaticActiveAppFrame.Aa().tb,lc.KeyInputManager.instance);this.ECo(this.Z.Za("Box4.Accessibility.IAccessibilityContextManager"),this.Z.resolve("Box4.IParagraphReader"),this.Z.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.oPd&&this.oPd.dispose();this.TId&&this.TId.dispose();this.Paa&&(dw.a.vIo(Object(E.a)(this.Paa,this.Paa.V_h,"beforeIntelligentPlaceholderPaste")),dw.a.ZIo(Object(E.a)(this.Paa,this.Paa.Yqj,"onIntelligentPlaceholderPaste")))}ECo(b,h,r){b&&
b.execute(A=>{A.SW(new KB(h,r))})}static main(){F.a.instance.Rc(new Xu)}}Object(u.a)(Xu,"PackageManager",null,[0,1]);var lI=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",
attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},
children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",
attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",
Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},OK=e(2157),DD=e(2149),as=e(2106);class Sw{}Sw.ujp="Search_16x16x32";Sw.mjp="ClosePaneGlyph_16x16x32";
Object(u.a)(Sw,"SearchBoxIcons",null,[]);var ED=e(2109),Tw=e(2110),rw=e(2108);class zu{constructor(){this.snh=null}get key(){return"FIND_HIT"}get hx(){return WacWordeditorStrings.FindHitContentTitle}reset(b){this.snh=b.node.lYa()}NGa(b){let h=null;for(const r of this.snh)if(r.Mc<=b&&b<r.end)return h=Object.assign(new YA.a,{NH:this.key,contentObject:r}),{returnValue:!0,vI:h};return{returnValue:!1,vI:h}}}Object(u.a)(zu,"FindHitDetailsProvider",null,[376,377]);var mI=e(1628),FD=e(1528),wv=e(1590),QF=
e(1635);class et{constructor(b,h,r,A,L,ba,ra,Ia=null,Ta=null){this.Sn=null;this.find=(ob,nb,Eb,bc,Bc)=>1===Eb?32:void 0===Bc||null===Bc?8:Bc.length?this.PIg(Bc):(this.xqf(as.a.initial),32);this.Pkc=(ob,nb,Eb,bc,Bc)=>this.I_j(Lc.a.rBb,ob,nb,Eb,bc,Bc);this.Gdm=(ob,nb,Eb,bc,Bc)=>this.I_j(Lc.a.sBb,ob,nb,Eb,bc,Bc);this.Vti=(ob,nb,Eb)=>1===Eb?32:this.PIg(this.uq.hYa());this.Sld=(ob,nb,Eb,bc,Bc)=>{ob=!this.uq.UJ;Bc[El.a.Image16by16Class]=ob?Ye.getImageClass(Sw.ujp):Ye.getImageClass(Sw.mjp);Bc[El.a.LabelText]=
ob?WacWordeditorStrings.SearchFilterTooltip:WacWordeditorStrings.SearchFilterCancelTooltip;Bc[El.a.ApplyLabelTextToControlOnly]=!0;Bc[El.a.EnsureControlRoleIsButton]=!0;Bc[El.a.On]=!1;return 32};this.Hem=(ob,nb,Eb)=>{if(1===Eb)return 32;this.eQi(!1);return 32};this.Tem=(ob,nb,Eb)=>{if(1===Eb)return 32;this.eQi(!0);return 32};this.jsg=(ob,nb,Eb,bc,Bc)=>{Bc[vk.a.Visible]=this.uq.P_j;return 32};this.usg=(ob,nb,Eb,bc,Bc)=>{Bc[vk.a.Visible]=this.uq.P_j;return 32};this.qce=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return 32;
this.LE.kpd.lQi(Bc);return 32};this.dYd=(ob,nb,Eb)=>{if(1===Eb)return 32;this.xqf(as.a.initial);return 32};this.GYc=(ob,nb,Eb)=>{if(1===Eb)return 32;this.xqf(as.a.initial);this.uq.dC(!1);return 32};this.JKa=(ob,nb,Eb)=>{if(1===Eb)return this.gnn(ob===wb.a.b8h);this.uq.JKa();return 32};this.wIe=(ob,nb,Eb)=>{if(1===Eb)return 32;switch(ob){case wb.a.uGf:this.uq.matchCase=!this.uq.matchCase;break;case wb.a.OGf:this.uq.matchWholeWord=!this.uq.matchWholeWord}return this.PIg(this.uq.hYa())};this.fve=(ob,
nb,Eb,bc,Bc)=>{Bc[bg.a.On]=this.uq.matchCase;return 32};this.hve=(ob,nb,Eb,bc,Bc)=>{Bc[bg.a.On]=this.uq.matchWholeWord;return 32};this.Trg=(ob,nb,Eb,bc,Bc)=>{ob=this.uq.matchCase;nb=this.uq.matchWholeWord;Eb="";ob&&nb?Eb=String.format(WacWordeditorStrings.FindMultipleFiltersLabelText,WacWordeditorStrings.MatchCase,WacWordeditorStrings.MatchWholeWord):ob?Eb=String.format(WacWordeditorStrings.FindFilterLabelText,WacWordeditorStrings.MatchCase):nb&&(Eb=String.format(WacWordeditorStrings.FindFilterLabelText,
WacWordeditorStrings.MatchWholeWord));Bc[Sl.a.Value]=Eb;Bc[Sl.a.Visible]=ob||nb;return 32};this.sxc=(ob,nb,Eb,bc,Bc)=>{ob=this.uq.x7;nb="";switch(this.uq.UJ){case as.a.C2j:nb=WacWordeditorStrings.SummarySearching;break;case as.a.cQj:nb=ob?this.uQf(WacWordeditorStrings.SummarySomeResults):WacWordeditorStrings.SummarySearching;break;case as.a.sAb:nb=this.uQf(WacWordeditorStrings.SummaryAllResults);break;case as.a.Vja:nb=this.uQf(this.uq.RNa?WacWordeditorStrings.SummaryAllResults:WacWordeditorStrings.SummarySomeResults);
break;case as.a.$_a:nb=WacWordeditorStrings.SummaryNoMatches;break;case as.a.kyc:nb=WacWordeditorStrings.ReplaceAllInProgress;break;case as.a.jyc:nb=WacWordeditorStrings.ReplaceAllComplete}Bc[Sl.a.Value]=nb;return 32};this.gve=(ob,nb,Eb,bc,Bc)=>{Bc&&(Bc.CommandValueId=this.uq.hYa());return 32};this.replace=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return this.U3f()?32:8;if(!this.U3f())return 8;ob=this.uq.rTb();"string"===typeof Bc&&Bc&&(ob=Bc);v.ULS.sendTraceTag(6033813,312,50,"Replace Called");$d.a("NavigationPaneReplace");
Bc=this.jKb.replace(ob);this.uq.jZo(Bc);return 32};this.replaceAll=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return this.Lxn()?32:8;ob=this.uq.rTb();"string"===typeof Bc&&Bc&&(ob=Bc);$d.a("NavigationPaneReplace");this.Sn=this.qe.rg("UserAction","ReplaceAll");this.uq.Sba(as.a.kyc);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");wv.a.lLo(this.uq.hYa(),this.uq.rTb());this.jKb.replaceAll(ob,this.t9n);return 32};this.t9n=(ob,nb)=>{this.Sn&&(this.Sn.stop(),this.Sn=null);v.ULS.sendTraceTag(4065349,
312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:ob,["TotalCount"]:nb});wv.a.iLo(ob,nb);this.uq.Sba(as.a.jyc)};this.RCj=(ob,nb,Eb,bc,Bc)=>{nb=!1;if(!Bc)return 8;this.uq.pk.isVisible&&(nb=ob===Lc.a.mmd===this.uq.p7c());ob!==Lc.a.mmd||this.Ivh||(nb=!1);Bc[bg.a.On]=nb;return 32};this.Urg=(ob,nb,Eb,bc,Bc)=>{if(!Bc||!this.uq.pk.isVisible)return 32;Bc[bg.a.On]=this.uq.RNa;return 32};this.Wrg=(ob,nb,Eb,bc,Bc)=>{if(!Bc)return 32;Bc.currentFindReplaceViewType=this.uq.UJ;return 32};this.kso=(ob,nb,Eb,bc,
Bc)=>{if(1===Eb)return 32;ob=Bc[bg.a.On];Bc&&(Bc[bg.a.On]=this.uq.pk.isVisible);ob&&!Bc[bg.a.On]&&(et.z8j(),$d.a("NavigationPaneCrossClick"));return 32};this.c3a=(ob,nb,Eb,bc,Bc)=>{const Yc=this.uq.pk.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",Yc);return Yc?this.GYc(ob,nb,Eb,bc,Bc):this.MAc(ob,nb,Eb,bc,Bc)};this.MAc=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return id.SessionStatusManager.instance.WC?32:8;if(2===Eb){et.z8j();this.i$();mI.FindReplaceUIManager.Dpl(ob,Bc,this.uq.pk.isVisible);
nb=!0;ob===Lc.a.RAc&&void 0!==Bc&&null!==Bc&&(nb=Bc);this.uq.dC(!0,nb);Bc=rw.a.initial;switch(ob){case Lc.a.NAc:v.ULS.sendTraceTag(42501022,367,50,"");Bc=rw.a.headings;break;case Lc.a.rBb:Bc=rw.a.find;break;case Lc.a.sBb:Bc=rw.a.replace;break;case Lc.a.RAc:Bc=rw.a.intelligentPlaceholder;break;case Lc.a.c3a:Bc=this.uq.Jic,Bc||(v.ULS.sendTraceTag(42501023,367,50,""),Bc=rw.a.headings)}Bc!==rw.a.find&&Bc!==rw.a.replace||et.$vp();this.uq.j3o(Bc,nb);QF.a.Pxp();return 32}return 8};this.OOa=()=>{this.uq.UJ&&
!this.uq.RNa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.uq=h;this.LE=r;this.jKb=A;this.Ivh=L;this.qe=ra;Ta&&Ta(1,this.OOa,null);this.gTa=Ia}i$(){}mc(){this.ga.nb(Lc.a.Ksg,ic.a.view,this.kso,96);this.ga.qa(Lc.a.c3a,ic.a.view,this.c3a);this.ga.qa(Lc.a.NAc,ic.a.view,this.MAc);this.ga.qa(Lc.a.rBb,ic.a.view,this.MAc);this.ga.qa(fb.a.zGf,ic.a.view,this.find);this.ga.qa(wb.a.Pkc,ic.a.view,this.Pkc);this.ga.qa(fb.a.yGf,ic.a.view,this.Vti);this.ga.nb(wb.a.Kro,
ic.a.view,this.Sld,97);this.ga.qa(fb.a.Hfg,ic.a.view,this.Hem);this.ga.qa(fb.a.Rpg,ic.a.view,this.Tem);this.ga.nb(fb.a.jsg,ic.a.view,this.jsg,97);this.ga.nb(fb.a.usg,ic.a.view,this.usg,97);this.ga.qa(Lc.a.qce,ic.a.view,this.qce);this.ga.qa(fb.a.Pgc,ic.a.view,this.dYd);this.ga.qa(wb.a.JKa,ic.a.view,this.JKa);this.ga.qa(wb.a.b8h,ic.a.application,this.JKa);this.ga.qa(Lc.a.GYc,ic.a.view,this.GYc);this.ga.qa(wb.a.uGf,ic.a.view,this.wIe);this.ga.qa(wb.a.OGf,ic.a.view,this.wIe);this.ga.nb(wb.a.fve,ic.a.view,
this.fve,97);this.ga.nb(wb.a.hve,ic.a.view,this.hve,97);this.ga.nb(Lc.a.Trg,ic.a.view,this.Trg,97);this.ga.nb(Lc.a.sxc,ic.a.view,this.sxc,97);this.ga.nb(Lc.a.Urg,ic.a.view,this.Urg,97);this.ga.nb(Lc.a.Wrg,ic.a.view,this.Wrg,97);this.ga.nb(Lc.a.Vrg,ic.a.view,this.RCj,97);Object(FD.b)()&&this.ga.nb(Lc.a.gve,ic.a.view,this.gve,96);this.Ivh&&(this.ga.nb(Lc.a.sBb,ic.a.view,this.MAc,1028),this.ga.nb(Lc.a.mmd,ic.a.view,this.RCj,97),this.ga.nb(Lc.a.replace,ic.a.view,this.replace,1028),this.ga.nb(Lc.a.replaceAll,
ic.a.view,this.replaceAll,1028),y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.nb(wb.a.GGf,ic.a.view,this.Gdm,1028));this.ga.qa(Lc.a.RAc,ic.a.view,this.MAc)}sug(){this.gTa&&this.gTa.execute(b=>{b.SW(new zu)})}I_j(b,h,r,A,L,ba){if(1===A)return id.SessionStatusManager.instance.WC?32:8;if(void 0===ba||null===ba)return 8;this.MAc(b,r,2,L,ba);b=this.uq;b.QCg(ba.CommandValueId);
Object(FD.b)()&&("MatchCase"in ba&&(b.matchCase=ba.MatchCase),"MatchWholeWord"in ba&&(b.matchWholeWord=ba.MatchWholeWord));return this.Vti(h,r,A,L,ba)}PIg(b){if(void 0===b||null===b||!b.length)return 32;b=ED.a.createQuery(b,this.Pro);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.LE.find(b);return 32}get Pro(){let b=Tw.a.none;this.uq.matchCase&&(b|=Tw.a.matchCase);this.uq.matchWholeWord&&(b|=Tw.a.rSg);return b}eQi(b){this.uq.Jic!==rw.a.headings&&this.uq.x7&&
(b?this.LE.kpd.vZm():this.LE.kpd.gQi())}xqf(b){this.uq.UJ&&(this.uq.RNa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.LE.b9a(),this.uq.Sba(b))}gnn(b){return this.uq.UJ===as.a.kyc||b&&!this.uq.UJ?8:32}uQf(b){return String.format(b,this.uq.uCd,this.uq.x7)}U3f(){return this.uq.p7c()&&0<this.uq.x7}Lxn(){return this.U3f()&&this.uq.RNa}static z8j(){null!=y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},et.tCa)}static $ym(b,h,r,A){return new et(y.AFrameworkApplication.va,b,h,r,A,Jc.FocusManager.instance(),Db.StaticActiveAppFrame.Aa().Kt,Xa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Object(E.a)(y.AFrameworkApplication.ta.EU,y.AFrameworkApplication.ta.EU.Cb,"registerHandler"))}static $vp(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)||window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("FindReplaceExperienceSurvey",null)})},et.tCa)}static Zym(b,h,r,A){return et.$ym(b,h,r,A)}}et.tCa=5E3;Object(u.a)(et,"FindReplaceActor",null,[]);var nI=e(933),PK=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.wO},set:function(h){this.wO=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.S5a},
enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,wF:this.S5a,next:void 0,data:r};this.first||(this.first=r);this.S5a&&(this.S5a.next=r);this.S5a=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,wF:h,next:h.next,data:A};var L=h.next;L&&(L.wF=A);h.next=A;this._map.set(r,A);return!0};b.prototype.insertBefore=
function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,wF:h.wF,next:h,data:A};var L=h.wF;L&&(L.next=A);h.wF=A;this._map.set(r,A);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.S5a===r&&(this.S5a=r.wF),r.wF&&(r.wF.next=r.next),r.next&&(r.next.wF=r.wF),this._map.delete(h))};return b}();class NB{constructor(){this.type="heading"}}Object(u.a)(NB,"NavPaneHeadingItem",null,[]);class GD{constructor(){this.type="bookmark"}}Object(u.a)(GD,
"NavPaneBookmarkItem",null,[]);class Au{constructor(b,h,r,A,L,ba,ra){var Ia,Ta;this.qb=b;this.pb=h;this.oc=r;this.Tp=A;this.sK=L;this.hL=ba;this.oEk=ra;this.S6a=0;this.cLd=new Map;this.rqh=!1;this.zHa=new Map;this.WGd=null===(Ia=y.AFrameworkApplication.J)||void 0===Ia?void 0:Ia.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1);this.UAk=null===(Ta=y.AFrameworkApplication.J)||void 0===Ta?void 0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandCollapseHighlightFix",
!1)}get headingsReady(){return this.rqh}set headingsReady(b){this.rqh=b}get K_b(){return this.S6a}get R5(){if(!this.sUa||0==this.sUa.length()){var b=window.performance.now();this.sUa=this.Kmo();b=window.performance.now()-b;$d.a("NavigationPanePrepareHeadingsList",!0,b)}return this.sUa}set R5(b){this.sUa=b}set Sde(b){this.Kqh&&(this.Kqh.isSelected=!1);b.isSelected=!0;this.Kqh=b}APg(){var b;if(this.vJa){for(var h=this.sUa.get(this.X$d(this.vJa));null===(b=null===h||void 0===h?void 0:h.data)||void 0===
b?0:b.isHidden;)h=h.wF;this.Sde=h.data}}X$d(b){switch(b.type){case "heading":return b.paragraphNode.id.toString();case "bookmark":return b.text}}Kmo(){const b=new PK;if(!this.sK)return b;this.cLd=new Map;let h;const r=[];for(const A of this.sK.paragraphs()){const L=this.yHi(A,r);null===L||void 0===L?void 0:L.forEach(ba=>{(h=this.iJi(ba,r))&&"heading"===h.type&&h.indentLevel<ba.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ba.isHidden=!1):(h.isCollapsed=!0,ba.isHidden=!0));b.insert(this.X$d(ba),
ba)})}return b}iJi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}SPg(b){var h,r,A;let L=rd.ParagraphReader.yna(b),ba=!1;9===L&&this.zHa.has(b.id.toString())&&(L=this.zHa.get(b.id.toString()),ba=!0);y.AFrameworkApplication.ud("InitialHeadingsInNavPaneFix-tf;InitialHeadingsInNavPaneFix-cf");const ra=this.WGd?null===(r=null===(h=this.sUa)||void 0===h?void 0:h.get(b.id.toString()))||void 0===r?void 0:r.data:null===(A=this.R5.get(b.id.toString()))||void 0===
A?void 0:A.data;if(ra){if(ra.indentLevel===L){h=wm.AParagraphNode.DR(b.characterData.trim());r=this.Tp.value.Tmg(b);this.WGd&&this.a3i(b)&&this.qji(b);if(h!==ra.text||ra.hasBookmark!==r)return ra.text=h,ra.hasBookmark=r,!0;!ba&&ra.isPurelyADH&&(ra.isPurelyADH=!1,--this.S6a);return!1}this.Ykd();return!0}if(9===L)return this.Kln(b)?(this.Ykd(),!0):!1;this.Ykd();return!0}Kln(b){var h;const r=this.Tp.value.vKf(b);b=null!==(h=this.cLd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=
0;h<b;++h)if(!this.R5.get(r[h].Xsb()))return!0;return!1}qji(b){var h;if((this.WGd?null===(h=this.sUa)||void 0===h?0:h.get(b.id.toString()):this.R5.get(b.id.toString()))||this.Tp.value.Tmg(b))return this.Ykd(),!0;this.zHa.has(b.id.toString())&&(this.zHa.delete(b.id.toString()),--this.S6a);return!1}Ykd(){const b=new PK;this.S6a=0;if(this.sK){this.cLd=new Map;var h=[],r,A;for(const L of this.sK.paragraphs()){const ba=this.yHi(L,h);null===ba||void 0===ba?void 0:ba.forEach(ra=>{var Ia=this.X$d(ra);A=this.iJi(ra,
h);this.zPo(Ia,ra,A);b.insert(Ia,ra);"heading"===(null===r||void 0===r?void 0:r.type)&&(Ia=r,Ia.indentLevel>=ra.indentLevel&&(Ia.isCollapsed=void 0));r=ra})}this.WGd?this.sUa=b:this.R5=b}else this.R5=b}zPo(b,h,r){var A,L;if(b=null===(A=this.sUa.get(b))||void 0===A?void 0:A.data)b.isSelected&&(h.isSelected=!0,this.Sde=h),h.isHidden=b.isHidden;if(r){if(A=null===(L=this.sUa.get(this.X$d(r)))||void 0===L?void 0:L.data)r.isCollapsed=A.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,
h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}yHi(b,h){var r=rd.ParagraphReader.yna(b),A=!this.a3i(b);const L=this.Prn(r)&&A?!0:!1;A=this.zHa.has(b.id.toString())&&A;const ba=[];if(L)ba.push(this.xei(b,r,!1,h));else if(A)this.S6a+=1,this.S2c&&(r=this.zHa.get(b.id.toString()),ba.push(this.xei(b,r,!0,h)));else{let ra=0;this.Tp.value.vKf(b).forEach(Ia=>{const Ta=new GD;Ta.text=Ia.Xsb();Ta.isSelected=!1;Ta.bookmarkManager=this.Tp;Ta.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ra+=1;ba.push(Ta)});
this.cLd.set(b.id.toString(),ra)}return ba}xei(b,h,r,A){var L,ba;const ra=new NB;ra.text=wm.AParagraphNode.DR(b.characterData.trim());ra.indentLevel=h;ra.paragraphNode=b;ra.isSelected=!1;ra.isPurelyADH=r;ra.listMarker=this.kPf(b);ra.hasBookmark=this.Tp.value.Tmg(b);for(b=null===(L=A[A.length-1])||void 0===L?void 0:L.indentLevel;b&&b>=h;)A.pop(),b=null===(ba=A[A.length-1])||void 0===ba?void 0:ba.indentLevel;(!b||b<h)&&A.push(ra);return ra}a3i(b){return this.qb.lc(b)&&0===this.qb.textLength(b,9)}DCi(b){for(b=
this.sK.Htb(b);b;){let h=this.R5.get(b.node.id.toString());for(;h;){const r=h.data;if("heading"===r.type)return r;h=h.wF}b=b.wF}}z$l(b){if(b=this.R5.get(b)){var h={value:!1};1==b.data.isCollapsed?this.U_j(b,h):this.X6m(b,h);zi.a.rx("ExpandCollapseHighlightFix-tf;ExpandCollapseHighlightFix-cf");this.UAk&&h.value&&this.APg()}}onClickHeading(b){var h;b=null===(h=this.R5.get(b))||void 0===h?void 0:h.data;Fx.a.QNa&&this.JZi(b.paragraphNode);this.Sde=this.vJa=b;h=Tb.SelectionFactory.Ie(b.paragraphNode,
0);this.pb.Uc(h);this.oc.Rg(Df.AFrame.Co)}onClickBookmark(b){var h;b=null===(h=this.R5.get(b))||void 0===h?void 0:h.data;Fx.a.QNa&&(h=this.Tp.value.BPf(b.text),h=null===h||void 0===h?void 0:h.K(0),this.JZi(h));this.Sde=this.vJa=b;this.Tp.value.rZm(b.text);this.oc.Rg(Df.AFrame.Co)}JZi(b){const h=y.AFrameworkApplication.va;if(b.Q1f){const r=new Ai.DictionaryPropertySet;r.Xg(Pd.a.targetObject,b);h.Zb(fb.a.V2c,2,r)}}r7m(b){var h,r;return(b=null===(r=null===(h=b.entries())||void 0===h?void 0:h.next())||
void 0===r?void 0:r.value)&&(h=this.DCi(b[0]))&&this.vJa!=h?(this.vJa=h,this.APg(),!0):!1}s7m(){var b,h;const r=this.pb.ob.last;if(null===(b=null===r||void 0===r?void 0:r.hd)||void 0===b?0:b.nm){if("bookmark"===(null===(h=this.vJa)||void 0===h?void 0:h.type)&&this.Tp.value.Epm(r.hd.node,r.hd.cpBegin))return!1;if((b=this.DCi(r.hd.node.id.toString()))&&this.vJa!=b)return this.vJa=b,this.APg(),!0}return!1}onShareHeadingClick(b){var h;$d.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.R5.get(b))||
void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Rc.a.qd),this.oEk.value.yei(h)}aPg(b,h){const r=b.id.toString(),A=this.zHa.has(r);if(!A||this.zHa.get(r)!==h){this.zHa.set(r,h);if(this.S2c)return this.SPg(b);A||this.R5.get(r)||(this.S6a+=1)}return!1}lWl(b){const h=b.id.toString(),r=this.zHa.has(h);if(r){this.zHa.delete(h);if(this.S2c)return this.SPg(b);r&&!this.R5.get(h)&&--this.S6a}return!1}stp(b){this.S2c=b;this.Ykd()}zPg(b){var h;const r=null===(h=this.R5.get(b.id.toString()))||void 0===h?void 0:
h.data;if(!r)return!1;b=this.kPf(b);if(r.listMarker===b)return!1;this.fCp();return!0}F2d(b){var h;b=null===(h=this.R5.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}U_j(b,h){var r=b.data;1==r.isCollapsed&&(r.isCollapsed=!1);r=r.indentLevel;b=b.next;let A;for(;b&&b.data.indentLevel>r;)A=b,b=A.next,A.data.isHidden=!1,A.data===this.vJa&&(h.value=!0),"heading"==A.data.type&&(b=A.data.isCollapsed?this.xhp(A,h):this.U_j(A,h));return b}X6m(b,
h){var r=b.data;r.isCollapsed=!0;r=r.indentLevel;b=b.next;let A;for(;b&&b.data.indentLevel>r;)A=b,b=A.next,A.data.isHidden=!0,A.data===this.vJa&&(h.value=!0)}xhp(b,h){const r=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>r;)b.data===this.vJa&&(h.value=!0),b=b.next;return b}Prn(b){return 0<=b&&8>=b}fCp(){let b=this.R5.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.kPf(h.paragraphNode)}b=b.next}}kPf(b){var h;if(b.eG instanceof nI.a)return this.fXm(null===(h=this.hL.A_a(b.eG))||
void 0===h?void 0:h.tW)}fXm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(u.a)(Au,"NavPaneHeadingsManager",null,[]);var RF=e(1529);class hA{constructor(){this.jKb=this.LE=this.nKc=this.FEd=this.Z=null}get name(){return"WordEditor.FindReplace"}Ec(b){var h;this.Z=b;y.AFrameworkApplication.ud("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",
!1))&&QF.a.initialize(b.Za("Common.IDynamicScriptLoaderProvider"),b.Za("Common.IZoomManager"),b.Za("WordEditor.IMainViewModeManager"),"WACViewPanelContainer");const r=new Au(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),Jc.FocusManager.instance(),b.zf("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.zf("WordEditor.Actors.HeadingsActor"));this.Z.ja("WordEditor.FindReplace.NavPaneHeadingsManager",()=>r).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){hA.Dc.Fs.continueWith(()=>
{this.Sp()})}Sp(){if(Ze.a.ASg){const b=Ze.a.lKe;this.nKc=mI.FindReplaceUIManager.getInstance(b);this.LE=DD.a.createInstance(this.nKc,OK.a.instance,RF.a.instance,!0);this.jKb=this.LE.U0b;this.FEd=et.Zym(this.nKc,this.LE,this.jKb,b);this.FEd.mc();this.FEd.i$();this.FEd.sug();Db.StaticActiveAppFrame.Aa().Ne()}}dispose(){this.nKc&&this.nKc.dispose()}static get Dc(){return null!=hA.MZg?hA.MZg:hA.MZg=Xa.a.instance.resolve("Box4.IFeatureHelper")}}Object(u.a)(hA,"FindReplacePackageManager",null,[0,1]);class OB{constructor(){}$If(){return"_@_"+
qb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}YEp(b,h,r,A){h.kZo(b,A);h.qm(b,Sb.a.Gea,!0);h.qm(b,Rc.a.d_a,!0);h.qm(b,Rc.a.G4,OB.Msi(r));h.qm(b,Rc.a.gu,15)}D9k(b,h,r,A){const L=b.N0d(A);h.qm(L,Sb.a.Gea,!0);h.qm(L,Rc.a.gu,47);h.qm(L,Rc.a.G4,OB.Msi(r));b=b.N0d(A);h.qm(b,Sb.a.Gea,!0);h.qm(b,Rc.a.gu,16);return[L.ol,b.ol]}flm(b,h,r){b=b.N0d(r);h.qm(b,Sb.a.Gea,!0);h.qm(b,Rc.a.AWb,!0);return b.ol}static Msi(b){return String.format(' HYPERLINK "{0}"',b)}}Object(u.a)(OB,"AtMentionHyperlinkConfigurator",
null,[458]);var HD=e(1547);class oI{constructor(b,h,r){this.Yka=b;this.pb=h;this.eSi=this.A_i=this.v_e=!1;this.nZb=this.nZb.bind(this);this.oZb=this.oZb.bind(this);this.uZb=this.uZb.bind(this);r&&r.execute(A=>{this.x4a=A});eq.a.BWd.SLf.then(A=>{this.eSi=!0;this.A_i=A.isSuccess})}jxe(){this.Yka.Fug(this.nZb);this.Yka.Gug(this.oZb);this.Yka.Qug(this.uZb)}Lie(){return!1}nZb(b,h,r){var A,L;h=Date.now();if(this.x4a)if(this.eSi&&!this.A_i)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");
else{var ba=null===(L=null===(A=this.pb.ob)||void 0===A?void 0:A.currentSelection)||void 0===L?void 0:L.hd;ba?(A=ba.node,rd.ParagraphReader.lc(A)?(L=rd.ParagraphReader.text(A),0>r||r>L.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the prefix was not within the bounds of the paragraph."):1<b.length&&("@"===b.trimEnd()||HD.a.xyd&&"/"===b.trimEnd())?($d.c(Lc.a.HGl,!0,void 0,void 0,void 0,void 0),this.Yka.reset()):(this.v_e?this.x4a.xFp():(this.v_e=
!0,this.x4a.qgp(ba)),this.x4a.iPg(r,r+b.length),b=L.substring(0,r)+b,this.x4a.tJf(A,b,r,h))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}oZb(b){if(this.x4a)this.x4a.onKeyDown(b)}uZb(){this.v_e=
!1;this.x4a&&this.x4a.N8h()}}Object(u.a)(oI,"ContextIQUserInitHandler",null,[457]);class Bu{constructor(){this.nD=null}get name(){return"WordEditor.AtMentions"}Ec(b){this.Z=b;b.ja("Box4.IAtMentionHyperlinkConfigurator",()=>new OB(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:Bu.Sjk,featureName:Bu.ylk,topLevelKpiName:Bu.Fpk,vetoPillar:7};b.ja("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Ln.a(Ca.Health.instance,new Xo.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>
{this.Sp()})}dispose(){}Sp(){this.Z.Za("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{y.AFrameworkApplication.J.$("ConsumerMentionsHostIsEnabled")&&(h=h&&y.AFrameworkApplication.J.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||HD.a.yyd())&&this.cIn()})});this.Z.resolve("Box4.IAtMentionHyperlinkConfigurator")}cIn(){(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.Z.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("canvasAtMentions")).then(()=>
{y.AFrameworkApplication.J.lq(()=>{this.YAo()})})}YAo(){const b={peopleAPI:this.Z.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:y.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.FAn()};this.nD=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.Z.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&HD.a.zyd()||
!r&&HD.a.yyd()?(HD.a.i0f=!r,this.Z.ja("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new oI(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.Z.resolve("Box4.ISelectionManager"),this.Z.Za("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):this.Z.ja("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new MB(this.Z.resolve("Box4.AtMentions.IAtMentionsListener"),this.nD,this.Z.resolve("Box4.ITextMetricsAdapter"),this.Z.resolve("Box4.ICaretPositionManager"),this.Z.resolve("Box4.ISelectionManager"),
Object(Vb.a)(),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.Z.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.Z.resolve("Common.Utils.IAriaNotifier"),this.Z.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.Z.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").jxe()})})}FAn(){var b,h;const r=null!==(b=y.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==
(h=y.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===Bu.ujk&&b===Bu.tjk}}Bu.ujk="-4";Bu.tjk="DC2";Bu.Sjk="webasynccollabeng";Bu.ylk="AtMentions";Bu.Fpk="AtMentionsFeatureUsage";Object(u.a)(Bu,"PackageManager",null,[0,1]);var Dp=e(1698);class QK{constructor(b,h,r,A){this.ga=b;this.ff=h;this._augLoopRuntimeManager=r;this.XYk=A;this.PAa=0;this.ATd=this.Pcc=!1;this.Hfh=this.jHh=this.G3e=this.kHh=0;this.cFb=null;this.Zzk=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",
!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0],["Rewrite",!0]]);this.Lyk=[{id:`${mv.cxc}_${1}`},{id:`${mv.cxc}_${2}`},{id:`${mv.cxc}_${3}`},{id:Zn.a.$1d},{id:Zn.a.x0d},{id:Zn.a.jkd},{id:Zn.a.hkd}];this.Usk=[{id:"OpenCopilotComposeDraftContent"},{id:"OpenCopilotComposeRewrite"},{id:"OpenCopilotComposeVisualizeAsTable"},{id:"OpenCopilotComposeSplitButton"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},
{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"Sort"},{id:"ResetPictureEdits"},{id:"ReviewDesignerSuggestion"}];this.vBd=new Map;this.Ssh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.NKk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.awk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",
!1);this.ff.Cb(this,Dp.SearchSuggestionAnnotation.getTypeName());(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"))&&this.vBd.set("InsertLink","InsertLinkFlyout");this.vBd.set("GraphicsEditor","");this.Rak();this.mc(this.ga)}Woo(b,h){if(this.Ssh){var r=Date.now();this.G3e&&1250>r-this.G3e||this.oJb||(this.G3e=r,this.cFb=b,this.rQd=this.hSm(h),this.pOo(),this.MMo())}}XI(b,h){if(b.annotationType===Dp.SearchSuggestionAnnotation.getTypeName()&&b.content&&
h===ss.a.getTypeName()&&(h=Date.now(),b=b.content,this.oJb&&this.oJb===b.correlationId)){window.clearTimeout(this.PAa);this.oJb=void 0;var r=this.Pcc,A=this.tGm(b),L=A&&0<A.length;L&&(this.kGp(A),this.ATd&&(r=!1));r&&this.AKj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.jHh,["canvasContextRetrievalTime"]:this.Hfh,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,
["latencyMs"]:h-this.kHh,["containsZTM"]:L,["shouldFallBack"]:this.Pcc,["fallBack"]:r};v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}tGm(b){const h=this.ARf(b.intentSuggestions,Dp.IntentIds.ZeroTermMenu,Dp.ObjectSemantic.GenericSuggestions,Dp.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}ARf(b,h,r,A){return Array.isArray(b)?b.filter(L=>L.intent===h&&L.result.semantic===r&&L.result.type===A).map(L=>L.result.value):[]}mc(b){b.nb(wb.a.rej,ic.a.application,this.NMo.bind(this),
96)}hSm(b){const h=[],r=new Map,A=Date.now();for(const L of b){if(!L)continue;b=[];const ba={itemsMetadata:new kb.a};for(let ra=0;ra<L.ControlList.length;ra++){const Ia=L.ControlList[ra];if(Ia&&!Ia.ExternalId)continue;b.push(Ia.ExternalId);const Ta={timeStamp:A,source:"FallbackZeroTermMenu",confidenceScore:-1};ba.itemsMetadata[Ia.ExternalId]=Ta;r.set(Ia.ExternalId,Ta)}h.push(appChrome.api.menuSection(b,L.Title,L.Lang,L.Id,ba))}return{sections:h,commands:r}}e8j(b){return this.vBd.has(b)?this.vBd.get(b):
b}rRa(b){const h={};for(const r of b)b=this.e8j(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Db.StaticActiveAppFrame.Aa().J7d(h)}vnn(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.Zzk.has(b)?this.rQd.commands.has(b):!0}Agi(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.cFb})}Lsb(b=!1){b=b?Qo.a.instance.kKc:Qo.a.instance.Lsb();const h=[],
r=Date.now();for(const A of b)A.commandId&&h.push({Id:A.commandId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.aB});return h}l5c(){const b=Qo.a.instance.l5c(),h=[],r=Date.now();for(const A of b)A.controlId&&h.push({Id:A.controlId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.aB});return h}KKf(){const b={semantic:Dp.ObjectSemantic.CanvasContext,type:Dp.ObjectSchemaType.WordCanvasContext,
value:{contentType:this.cFb}};if(this.awk){const h=Date.now(),r=this.XYk.KKf(Fg.a.instance.ob.currentSelection);r&&r.value.contentType&&(b.value=r.value);this.Hfh=Date.now()-h}return b}kBi(){const b=this.l5c(),h=this.Lsb(),r=this.Lsb(!0),A=[];A.push({semantic:Dp.ObjectSemantic.ControlIdHistory,type:Dp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Dp.SequenceType.ControlId,Sequence:b}});A.push({semantic:Dp.ObjectSemantic.CommandIdHistory,type:Dp.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:Dp.SequenceType.CommandId,Sequence:h}});A.push({semantic:Dp.ObjectSemantic.FilteredCommandIdHistory,type:Dp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Dp.SequenceType.CommandId,Sequence:r}});A.push(this.KKf());return A}Rak(){this._augLoopRuntimeManager.getSession().then(b=>this.nAd=b).catch(()=>{this.nAd=void 0})}MMo(){const b=Date.now(),h=this.kBi(),r=[Dp.IntentIds.ZeroTermMenu,Dp.IntentIds.Logging];this.jHh=Date.now()-b;this.P3j(r,h,"ContextualMenu")}NMo(b,
h,r){2===r&&(b=this.kBi(),this.P3j([Dp.IntentIds.Logging],b,"Floatie"));return 32}P3j(b,h,r){if(0===b.length||0===h.length)v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var A=new Dp.SearchSuggestionSignal({correlationId:this.y5c("ACM"),intents:b,contextObjects:h,entryPoint:r});this.Pcc=0<=b.indexOf(Dp.IntentIds.ZeroTermMenu);this.kHh=Date.now();this.oJb=A.correlationId;this.PAa=window.setTimeout(()=>{this.A9n(A.correlationId)},750);h=new ss.m({parentPath:["Signal",
Dp.SearchSuggestionSignal.getTypeName()],items:[{id:qb.a.create().toString(),body:A}]});this.nAd&&!this.nAd.isClosed?this.nAd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.Rak());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:A.correlationId,["shouldFallBack"]:this.Pcc,["intents"]:b}))}}y5c(b){const h=qb.a.create().toString();appChrome.api.setOfeCorrelationId(b,
h);return h}A9n(b){this.oJb&&this.oJb===b&&(this.oJb=void 0,this.Pcc&&this.AKj(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.Pcc})))}AKj(){const b=this.Agi(this.rQd.sections);appChrome.api.dispatch(b);this.B$h()}B$h(){this.ATd=!0}lGo(b){var h,r;const A=[],L=new Map;if(!b||0===b.length)return A;for(const ba of b){if(!ba||!ba.controlIds||0===ba.controlIds.length)continue;b={controlIds:[],
id:ba.id,title:ba.title,lang:ba.lang,data:{itemsMetadata:new kb.a}};const ra="CommandsZTM"===ba.id;for(const Ia of ba.controlIds){if(L.has(Ia))continue;if(ra&&b.controlIds.length>=this.NKk)break;const Ta=null===(r=null===(h=ba.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Ia];L.set(Ia,Ta);b.controlIds.push(Ia);Ta&&(b.data.itemsMetadata[Ia]=Ta)}0<b.controlIds.length&&A.push(b)}return A}pOo(){this.ATd=!1;if(this.Ssh){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",
!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}kGp(b){this.ATd||(b=this.Xlm(b),0<b.length&&appChrome.api.dispatch(b))}Xlm(b){const h=[];let r=[];var A=this.KLm();A&&0<A.length&&r.push(...A);(A=this.Xkm())&&r.push(A);Array.isArray(b)&&0<b.length&&(b=this.eCa(b))&&(b.id="CommandsZTM",r.push(b));(b=this.Okm())&&r.push(b);r=this.lGo(r);if(0===r.length)return[];h.push(this.Agi(r));this.B$h();return h}KLm(){var b,h;const r=null===(b=this.rQd)||
void 0===b?void 0:b.sections.filter(A=>{var L;return null===(L=A.id)||void 0===L?void 0:L.startsWith(mv.Nni)});for(const A of r)if(null===(h=A.data)||void 0===h?0:h.itemsMetadata)for(const L in A.data.itemsMetadata)A.data.itemsMetadata[L].source="PassThroughZeroTermMenu";return r}Xkm(){const b=this.gxi(this.Lyk,"DefaultZeroTermMenu");return this.eCa(b)}Okm(){const b=this.gxi(this.Usk,"AdvertizedZeroTermMenu");return this.eCa(b)}gxi(b,h){const r=[];for(const A of b)A&&this.vbp(A)&&this.rQd.commands.has(A.id)&&
r.push({suggestion:A.id,rankingScore:-1,suggestionSource:h});return r}vbp(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}eCa(b){const h=[],r={itemsMetadata:new kb.a},A=Date.now();this.rRa(b);for(const L of b)b=this.e8j(L.suggestion),this.vnn(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:A,source:L.suggestionSource,confidenceScore:L.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}}Object(u.a)(QK,"AugLoopSearchSuggestionManager",
null,[365,397]);class pI{constructor(){this.Z=null}get name(){return"WordEditor.ContextualSearch"}Ec(b){this.Z=b;this.Z.ja("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new QK(y.AFrameworkApplication.va,this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.Z.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>
{eq.a.Km().then(()=>{this.start()})})}start(){this.Z.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){F.a.instance.Rc(new pI)}}Object(u.a)(pI,"PackageManager",null,[0,1]);var RK=e(455),cz=e(973);class SK extends cz.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(u.a)(SK,"BootMessage",cz.a,[]);var SF=e(1069);class ID{constructor(){this.Y7=null;this.f7n=b=>{if(b.target===this.Y7)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=H.a(b.data);this.SEe(h.api)?this.$zd.K(h.api).Ibg(h.method,h):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.$zd=new ac.a}L5f(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let r=!1;try{this.Y7=new Worker(b);this.Y7.onmessage=this.f7n;const A=Object.assign(new SK,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(A);this.L5f()&&SF.a.xrk(this.Y7);r=!0}catch(A){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",A)}return r}postMessage(b){try{const h=H.c(b);this.Y7.postMessage(h)}catch(h){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}SEe(b){return this.$zd.Bb(b)}J_k(b,
h){this.SEe(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.$zd.W(b,h)}qom(b){return this.SEe(b)?this.$zd.K(b):null}}Object(u.a)(ID,"WebWorker",null,[1545]);class uj{constructor(){this.TSg=[]}PRl(b,h){if(h){var r=y.AFrameworkApplication.Lz(b.LPj,7),A=[];for(let L=0;L<b.HBc.length;L++){let ba;switch(b.HBc[L].format){case 5:case 6:ba=RK.a.wTb(b.HBc[L].name);break;default:ba=b.HBc[L].name}A.push(y.AFrameworkApplication.Lz(ba,
b.HBc[L].format))}try{const L=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ba=new ID;if(ba.create(L,A))for(this.TSg.push(ba),r=0;r<b.REe.length;r++){const ra=h.TJl(ba,b.REe[r]);ra&&ba.J_k(b.REe[r],ra)}}catch(L){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",L.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(u.a)(uj,"WebWorkerCollection",null,
[]);class In{constructor(b,h){this.wgf=new uj;if(b){b=b.create();for(let r=0;r<b.length;r++)this.wgf.PRl(b[r],h)}else v.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let A=!1;for(let ba=0;ba<this.wgf.TSg.length;ba++){var L=this.wgf.TSg[ba];L.SEe(b)&&((L=L.qom(b))?A=L.callMethod(h,r)||A:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}A||v.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(u.a)(In,"WebWorkerRouter",null,[1544]);class Wt extends cz.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(u.a)(Wt,"SettingsMessage",
cz.a,[]);class iA{constructor(b){this.Y7=b}}Object(u.a)(iA,"WebWorkerApiMain",null,[]);class Mg extends iA{constructor(b){super(b)}L5f(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.Yql(h);v.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}Ibg(b,h){switch(b){case 14:this.m1m(h);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Yql(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new Wt,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:y.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Sk.a.instance.FH,LocalCobaltMachineId:Sk.a.instance.Doa,LocalCobaltClusterId:Sk.a.instance.ewa,LocalCobaltSessionHasBackup:Sk.a.instance.fwa,WaciiEnabledRequests:Sk.a.instance.Dqa,SettingsRoutedToServer:Sk.a.instance.NEg,WacClusterId:y.AFrameworkApplication.pe.b3});this.Y7.postMessage(b);return!0}m1m(b){this.L5f()&&
b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.BKp())}async BKp(){try{const b=await new SF.a.yrk.WorkerUtilsTestClass(10);await b.si(5);15==await b.counter?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(u.a)(Mg,"InitializeWorkerApiMain",iA,[]);class qI extends cz.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=Nm.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(u.a)(qI,"CatchUpNetworkRequestWorkerRequestMessage",cz.a,[]);class rI extends iA{constructor(b,h){super(b);this.OXc=h}callMethod(b,h){if(4===b)return b=Object.assign(new qI,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.Y7.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}Ibg(b,h){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.OXc.FZo(h);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(u.a)(rI,"CatchUpNetworkRequestWorkerExternalApi",iA,[]);class jA extends iA{constructor(b){super(b);y.AFrameworkApplication.IG(()=>{this.bZb()})}callMethod(b){v.ULS.sendTraceTag(591689869,
3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Ibg(b){v.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}bZb(){const b=Object.assign(new cz.a,{api:3,method:6});this.Y7.postMessage(b)}}Object(u.a)(jA,"ShutdownWorkerApiMain",iA,[]);class TK{constructor(b){this.container=b}TJl(b,h){let r=null;switch(h){case 0:r=new Mg(b);break;case 2:r=new rI(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));
break;case 3:r=new jA(b);break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return r}}Object(u.a)(TK,"WordWebWorkerApiFactory",null,[398]);class Rd{constructor(b,h){this.name=b;this.format=h}}Object(u.a)(Rd,"ImportedScript",null,[]);class dz{constructor(){this.REe=this.HBc=this.LPj=null}}Object(u.a)(dz,"WebWorkerConfig",null,[]);class sI{constructor(){this.jMh=[];if(y.AFrameworkApplication.J){const h=y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||
y.AFrameworkApplication.J.$("IsCombinedBundleEnabled"),r=y.AFrameworkApplication.J.rb("ContentBaseUrl")?6:5;var b=y.AFrameworkApplication.J.rb("AppScriptBaseName");const A=h?"":".";if(b){const L=h?"":"{0}";b+=`${A}${L}worker.js`;this.jMh.push(new Rd(`MicrosoftAjax${h?"":"DS"}.${L}js`,r),new Rd(b,r))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new dz,{LPj:"workerboot",HBc:this.jMh,REe:[0,2,3]});b.push(h);return b}}Object(u.a)(sI,"WordWebWorkerConfigFactory",null,[396]);class PB{constructor(){this.za=this.Z=null}get name(){return"WordEditor.Workers"}init(){const b=this.Z.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.za.appSettings,y.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}Ec(b){this.Z=b;this.za=this.Z.resolve("Common.IAppSettingsManager");b.ja("Box4.Workers.WebWorkerRouter",
()=>new In(new sI,new TK(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){F.a.instance.Rc(new PB)}}Object(u.a)(PB,"WordEditorWorkersPackage",null,[0,1]);var cM=e(1155);class tI{constructor(){this.qOd=[]}SKi(b,h){let r=-1,A=null;A=L=>{L?h(this.qOd[r]):(++r,r<this.qOd.length?this.qOd[r].Mgc(b,A):h(null))};A(!1)}Mgc(b,h){this.SKi(b,r=>{h(!!r)})}uyc(b,h,r){this.SKi(b,A=>{if(!A)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");A.uyc(b,h,r)})}zTh(b){this.qOd.push(b)}}
Object(u.a)(tI,"CompositeExternalContentURLResolver",null,[399,389]);var uI=e(1323);class JD extends uI.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(u.a)(JD,"ExternalContentEmbedResponse",uI.a,[]);var vI=e(1350),UK=e(774),wI=e(1140),ez=e(1243),kA=e(734),fz=e(526),Xt=e(170),xv=e(897),yv;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.eam=1]="externalComponentPaste";b[b.qam=2]="externalHyperlinkPaste";
b[b.G7p=3]="externalContentFloatieConversion"})(yv||(yv={}));Object(u.b)("ExternalContentConversionContext",yv);class Fh{constructor(){this.dXb=this.cXb=null;this.oFf=new ez.ExternalContentEmbedRetriever;this.xSc=!0;this.ZJc=this.oq=this.KUi=this.JUi=this.xn=this.Tu=null;this.ykd=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Fwc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=Fh.oua&&Fh.oua.mBi()}get O2b(){return this.xSc}set O2b(b){this.xSc=
b}lqf(b,h){let r=!1;if(b){switch(b.contextId){case ic.a.kd:r=!h;break;case ic.a.Nd:r=!0}r&&!xv.a(b.node)&&(r=!1)}return r}XBn(b){const h=b.startsWith(Mc.a.exc),r=b.startsWith(Mc.a.Ild),A=b.startsWith(Mc.a.Xue);return(h||r||A)&&Mc.a.i_a(b)}rEj(){this.oq=V.a.create();Fh.Wf.pPb(this.oq,4);Fh.Wf.g$(this.oq,0,Fh.Wf.jq());this.$Ub(this.cXb,3,this.dXb,!0)}fZa(b,h,r){this.oq=V.a.create();Fh.Wf.pPb(this.oq,r?0:2);Fh.Wf.g$(this.oq,0,Fh.Wf.jq());this.ZJc();this.$Ub(b,r?0:2,h)}nte(b,h){this.oq=V.a.create();Fh.Wf.pPb(this.oq,
1);Fh.Wf.g$(this.oq,0,Fh.Wf.jq());this.$Ub(b,1,h)}sfe(b,h,r,A){if(!b||!b.isConnected||!pe.a.nr(b))return null;const L=new kA.a;L.setValue(Tc.a.Ioc,r);L.setValue(Tc.a.XYa,h);L.F9a=this.JUi;L.hx=this.KUi;L.providerName=A;L.fdb=1===r;L.creationTime=Date.now();te.a.kb(b).pg(L,2);this.Ufd(L);return L}jGj(b){this.ZJc=b}fMe(b,h){const r=Fh.n6.fjc(h)||0;h=Fh.n6.j$a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/A)}vUg(b,h,r){if(null!=b&&null!=h&&!D.a.jg(r)){var A=Fh.Bhd.Umc(r);
A.hideFloatie=!0;this.fMe(b,h.node);this.kpc(b,h,!1,A,r)}}Rtb(b){return b?b.Xe:0}lRg(b,h,r){let A=null;const L=b.node;if(!rd.ParagraphReader.lc(L)||!L.isConnected)return{returnValue:!1,xya:A};if(r)return{returnValue:!0,xya:b};r=b.cpBegin;const ba=b.cpEnd,ra=rd.ParagraphReader.text(L);if(0<=r&&ba<=ra.length&&ra.substring(r,ba)===h)return{returnValue:!0,xya:b};const Ia=ra.indexOf(h);return 0<=Ia?(A=vc.a.createTextRange(L,Ia,Ia+h.length),{returnValue:!0,xya:A}):0<=r&&ba<=ra.length&&this.joc(b)?{returnValue:!0,
xya:b}:{returnValue:!1,xya:A}}joc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=vc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Mc.a.VD(h,!1);if(1===h.length){h=h[0];const r=rd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}x5f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Khb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=
Xa.a.instance.Za("Common.ISystemInitiatedFeedback");r&&r.execute(A=>{A.logActivity(b,h)})},Fh.tCa)}GMf(b,h){const r=!D.a.Vba(h);switch(b){case 1:b=r?String.format(WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedWebContent}return b}$Ub(b,
h,r,A=!1){if(this.XBn(r)){var L=Fh.Bhd.Umc(r);L&&(this.x5f(L)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),b=Object(ya.a)(vc.a,b),this.lqf(b,!h)?this.obd(r)?(h=1===h,A=this.Szm(b),L.hideFloatie=!0,this.kpc(A,b,h,L,r)):this.zpg(b,h,L,r,A):Fh.Wf.ZV(this.oq,2,"URL inserted in Non-Embedable context",Fh.Wf.jq())):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Fh.Wf.ZV(this.oq,2,"Size provided is not valid for OEmbed",
Fh.Wf.jq())))}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Fh.Wf.ZV(this.oq,2,"URL inserted is not valid for ExternalContent",Fh.Wf.jq())}Szm(b){const h=new JD;h.Width=Fh.n6.fjc(b.node)||0;h.Height=Fh.n6.j$a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}obd(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Fh.w5&&Fh.w5.Y7i(b)}zpg(b,h,r,A,
L){const ba=1===h,ra=Fh.n6.fjc(b.node)||0,Ia=Fh.n6.j$a(b.node)||0,Ta=vI.a.fuf(r.DQg,!0,ra,Ia);this.ofd(b,A,h,!0);this.oFf.Y5h(Ta,ob=>{Fh.Wf.g$(this.oq,4,Fh.Wf.jq());Fh.Wf.frd(this.oq,this.Rtb(ob.data));if(ob=this.Fpg(ob)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var nb=Xt.r(ob.MediaType);Fh.Wf.Wwe(this.oq,7,nb);nb=b;({xya:nb}=this.lRg(b,A,ba)).returnValue?(this.ofd(nb,A,h,!1),null==r.width?0<ra&&ob.Width>ra&&(v.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),ob.Width=ra):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),ob.Width=this.lxd(r.width,ob.Width,ra)),null==r.height?0<Ia&&ob.Height>Ia&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),ob.Height=Ia):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
ob.Height=this.lxd(r.height,ob.Height,Ia)),Fh.oua.Ejb||L?this.kpc(ob,nb,ba,r,A):(this.cXb=b,this.dXb=A,this.o_c(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Fh.Wf.ZV(this.oq,2,"No conversion as the context is no longer valid for the external content conversion",Fh.Wf.jq()));ba&&this.p9a(nb.node)}else ba&&this.p9a(b.node),Fh.Wf.ZV(this.oq,1,"URL not oEmbedable",Fh.Wf.jq())},ob=>{Fh.Wf.g$(this.oq,
4,Fh.Wf.jq());Fh.Wf.frd(this.oq,this.Rtb(ob.data));ba&&this.p9a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl");Fh.Wf.ZV(this.oq,2,"ExternalContentEmbedRequest failed",Fh.Wf.jq())},ob=>{ba&&this.p9a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+ob)},this.oq)}lxd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}kpc(b,h,r,A,L){this.xn=qb.a.create();b.Width=b.Width/b.Height*(b.Height-(fz.a.Fde+fz.a.pga))+2*fz.a.pga;const ba=new hb.GraphTransaction(15);ba.Eb(h.node);ba.Bh=Lc.a.fZa;const ra=this.joc(h);if(h){r&&(h=this.nzf(h));var Ia=this.d1d(h,r);if(Ia){var Ta=Xt.r(b.MediaType),ob=this.Sae(b,Ta);this.JUi=b.IFrameHtml;this.KUi=b.Title;if(Ia=this.hZf(Ia,ob,ba,r,L,Ta,b.ProviderName))ba.sOa(this.xn,1),ba.dispose(),this.cXb=h,this.dXb=L,this.bmg(A,b,Ia),this.mpg(L,r||A.hideFloatie,
ra,Ta,b.Title,b.ProviderName)}else ba.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Fh.Wf.ZV(this.oq,2,"Could not create IP context on splitting the paragraph",Fh.Wf.jq())}else Fh.Wf.ZV(this.oq,2,"GraphNodeContext is null",Fh.Wf.jq())}Sae(b,h){const r=new Ai.DictionaryPropertySet;Fh.OT.mue(r,b.Width,b.Height);b=this.FMf(h,b.Title);r.setValue(Sb.a.imageAltText,b);r.setValue(Rc.a.lZ,of.a.BG());r.setValue(Rc.a.imageType,
jr.other);return r}hZf(b,h,r,A,L,ba,ra){if(!b)return null;b=Fh.OT.xfe(b,h);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Fh.Wf.ZV(this.oq,2,"The anchored image could not be inserted",Fh.Wf.jq()),null;r=b.node;L=this.sfe(r,L,ba,ra);Fh.Wf.FPg(this.oq,L.id);A||this.HCg(r);return r}bmg(b,h,r){D.a.Vba(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Fh.Wf.g$(this.oq,8,Fh.Wf.jq()),
v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.v3d(r,h.Thumbnail))}mpg(b,h,r,A,L,ba){h||this.o_c(b);this.Khb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.rse("IsHyperlinkWithNonURLDisplayText",r,ba);this.ariaNotify(A,L);Fh.Wf.g$(this.oq,5,Fh.Wf.jq())}rse(b,h,r){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ka.a.sendTelemetryEvent(Object.assign(new ja.a,
{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ma.a,{name:b,bool:h}),Object.assign(new ma.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.O2b&&Fh.ry&&(b=this.GMf(b,h),Fh.ry.sendNotification(b,!0))}nzf(b){const h=b.node,r=rd.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=vc.a.createTextRange(h,0,r.length),Fh.Ug.lf(b,""),vc.a.jd(h,0)):b}d1d(b,h){return h?b:this.GNf(b)}GNf(b){const h=rd.ParagraphReader.text(b.node),r=te.a.kb(b.node);
if(r.Wd()){b=vc.a.jd(b.node,b.cpEnd);hg.a.xe(r);const A=Fh.Yf.kva(r);Fh.ni.wea(r,A,b,!0,!0,!0,!0);""!=h&&Fh.ni.mA(r,!1,!0);r.ue();return vc.a.jd(r.currentNode,0)}return null}Fpg(b){if(!({group:b}=lm.a.A6(b.data.responseData)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}FMf(b,h){const r=!D.a.Vba(h);switch(b){case 1:return r?String.format(WacWordeditorStrings.ExternalContentThumbnailAltText_VideoWithTitle,h):WacWordeditorStrings.ExternalContentThumbnailAltText_Video;default:return r?
String.format(WacWordeditorStrings.ExternalContentThumbnailAltText_WebContentWithTitle,h):WacWordeditorStrings.ExternalContentThumbnailAltText_WebContent}}v3d(b,h){b.hk().Jg.lG(()=>{this.Dpg(h,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Ufd(b){b=te.a.kb(b);b.Ib(12);b.xd(12);b.Jr.LV=!0}p9a(b){b.xwc=null}HCg(b){b=te.a.kb(b);b.Ib(11)&&(b.xd(11),b.Wd()&&b.xl()&&b.ue()&&rd.ParagraphReader.lc(b.currentNode)&&(b=Tb.SelectionFactory.Ie(b.currentNode,
0),Fg.a.instance.Uc(b)))}ofd(b,h,r,A){const L=b.cpBegin,ba=b.cpEnd;b=rd.ParagraphReader.text(b.node).trim();L||b!==h&&""!==b?L?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yv[r],A):0<L&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
yv[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yv[r],A)}o_c(b){this.ljc();const h=new Gy.a(1,y.AFrameworkApplication.isRtl);h.kkd=b;Fh.$rb.Lmd(h)}ljc(){const b=
new Jz.a(!0);Fh.Pda.GPa(b)}Dpg(b,h){if(b=this.NPf(b,h))h=Array(1),h[0]=b,b=UK.a.construct(h,!1,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Tu.Kr:null),h=this.pxf(),this.zAb(h,b)}NPf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Tu=h.hk();(new te.a).set(h);if(!h.anchor||!h.anchor.rt||!h.anchor.rt.Ku)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.rt.Ku.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(Kh.a.YL,kf.a.jw);const A=h.getValue(Sb.a.FI),L=rb.a.Rf(pe.a.uH(h.properties),0),ba=rb.a.Rf(pe.a.pN(h.properties),1);return wI.a.construct(h.id.toString(),b,h.ka(Sb.a.imageAltText,""),L,ba,h.ka(Rc.a.P1,""),r,h.ka(Rc.a.lZ,0),h.ka(Rc.a.ioa,!1),h.ka(Kh.a.Wma,-1),h.ka(Rc.a.nxb,Box4Intl.Box4Strings.l_Picture),h.ka(Sb.a.dEa,!1),A,h.ka(Rc.a.runId,
1),h.ka(Rc.a.qd,0))}zAb(b,h){y.AFrameworkApplication.pe.addRequest(b,2,H.c(h),{},!1,2,this.ykd,this.Fwc,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}pxf(){let b=db.a.C4c("PicturePaste.ashx");const h=on.a.$Ya;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=db.a.xq(b,Wi.a.fileId,this.Tu.Kr));b=db.a.xq(b,Wi.a.cellId,this.Tu.Wl.toString());this.xn||(this.xn=qb.a.create(),
v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=db.a.xq(b,Wi.a.g1,this.xn.toString());b=db.a.xq(b,Wi.a.classId,h.toString());this.Tu.MI&&(b=db.a.xq(b,Wi.a.MI,this.Tu.MI));b=db.a.xq(b,Wi.a.rDb,"1");b=db.a.xq(b,ri.a.imageType,jr.other.toString());b=Sk.a.instance.Pif(b);b=db.a.xq(b,Wi.a.uBa,this.Tu.Jg.Au.toString());b=db.a.xq(b,Wi.a.vwc,"0");return b=db.a.xq(b,Wi.a.p5b,"1")}static get $rb(){return null!=Fh.uZg?Fh.uZg:Fh.uZg=Xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get oua(){Fh.mIa||
(Fh.mIa=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Fh.mIa}static get Pda(){return null!=Fh.L7g?Fh.L7g:Fh.L7g=Xa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get ry(){return null!=Fh.WWg?Fh.WWg:Fh.WWg=Xa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get n6(){return null!=Fh.g9g?Fh.g9g:Fh.g9g=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get OT(){return null!=Fh.t1g?Fh.t1g:Fh.t1g=Xa.a.instance.resolve("WordEditor.IImageEditor")}static get Yf(){return Fh.ni||
(Fh.ni=Xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Ug(){return null!=Fh.AXg?Fh.AXg:Fh.AXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Wf(){return null!=Fh.DZg?Fh.DZg:Fh.DZg=Xa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get Bhd(){return null!=Fh.l6g?Fh.l6g:Fh.l6g=Xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get w5(){return null!=Fh.$5g?Fh.$5g:Fh.$5g=Xa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}
Fh.ni=null;Fh.tCa=5E3;Fh.mIa=null;Object(u.a)(Fh,"ExternalContentEditor",null,[175]);var Uw=e(270),QB=e(992);class KD{constructor(b,h){this.Ejb=!0;this.yeb=r=>{if(null!=r.result)return r.result.Value;v.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.Ejb};this.UOa=r=>{r.mq||r.wj?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.L2h(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.Ejb};this.Hx=b;this.OM=h}mBi(){const b=new zg.a;this.T6i()&&this.OM?this.OM.yfb(Uw.a.KZc).CWRCo(this.yeb,0).CWRCo(this.UOa,8):b.setResult(this.Ejb)}E6(b){this.OM&&this.OM.E6(Uw.a.KZc,new QB.a(Uw.a.KZc,b))}JSo(b){this.T6i()&&(this.Hx.Mpa("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.L2h(b),this.E6(b))}T6i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}L2h(b){this.Ejb=b}}Object(u.a)(KD,"ExternalContentSettingInfo",null,[647]);var VK=e(1132);class LD{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(u.a)(LD,"FluidComponentProperties",
null,[]);class xI{constructor(){this.loopType=this.hx=this.F9a=this.url=null;this.mediaType=0;this.egj=null}}Object(u.a)(xI,"IFrameProps",null,[]);class zl{static get n6(){return null!=zl.e9g?zl.e9g:zl.e9g=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get OT(){return zl.ll||(zl.ll=Xa.a.instance.resolve("WordEditor.IImageEditor"))}static get ry(){return null!=zl.VWg?zl.VWg:zl.VWg=Xa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get Gs(){return null!=
zl.e1g?zl.e1g:zl.e1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Yf(){return null!=zl.I6g?zl.I6g:zl.I6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Ug(){return null!=zl.zXg?zl.zXg:zl.zXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static i_a(b){const h=b.startsWith(Mc.a.exc),r=b.startsWith(Mc.a.Ild),A=b.startsWith(Mc.a.Xue);return(h||r||A)&&Mc.a.i_a(b)}static lqf(b,h){let r=!1;if(b){switch(b.contextId){case ic.a.kd:r=!h;break;case ic.a.Nd:r=!0}r&&!xv.a(b.node)&&
(r=!1)}return r}static joc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=vc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Mc.a.VD(h,!1);if(1===h.length){h=h[0];const r=rd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static FMf(b,h){const r=!D.a.Vba(h);switch(b){case 1:return r?String.format(WacWordeditorStrings.ExternalContentThumbnailAltText_VideoWithTitle,h):WacWordeditorStrings.ExternalContentThumbnailAltText_Video;default:return r?
String.format(WacWordeditorStrings.ExternalContentThumbnailAltText_WebContentWithTitle,h):WacWordeditorStrings.ExternalContentThumbnailAltText_WebContent}}static Ufd(b){b=te.a.kb(b);b.Ib(12);b.xd(12);b.Jr.LV=!0}static Sae(b,h,r,A){const L=new Ai.DictionaryPropertySet;zl.OT.mue(L,h,b);b=zl.FMf(A,r);L.setValue(Sb.a.imageAltText,b);L.setValue(Rc.a.lZ,of.a.BG());L.setValue(Rc.a.imageType,jr.other);return L}static sfe(b,h,r){if(!b||!b.isConnected||!pe.a.nr(b))return null;const A=new kA.a;A.setValue(Tc.a.Ioc,
h.mediaType);A.setValue(Tc.a.XYa,h.url);A.setValue(Pd.a.loopComponentType,h.loopType);A.F9a=h.F9a;A.hx=h.hx;A.providerName=r;A.creationTime=Date.now();A.fdb=1===h.mediaType;A.createMode=h.egj;te.a.kb(b).pg(A,2);zl.Ufd(A);return A}static d1d(b,h){return h?b:zl.GNf(b)}static GNf(b){const h=rd.ParagraphReader.text(b.node),r=te.a.kb(b.node);if(r.Wd()){b=vc.a.jd(b.node,b.cpEnd);hg.a.xe(r);const A=zl.Yf.kva(r);zl.Yf.wea(r,A,b,!0,!0,!0,!0);""!=h&&zl.Yf.mA(r,!1,!0);r.ue();return vc.a.jd(r.currentNode,0)}return null}static HCg(b){b=
te.a.kb(b);b.Ib(11)&&(b.xd(11),b.Wd()&&b.xl()&&b.ue()&&rd.ParagraphReader.lc(b.currentNode)&&(b=Tb.SelectionFactory.Ie(b.currentNode,0),Fg.a.instance.Uc(b)))}static GMf(b,h){const r=!D.a.Vba(h);switch(b){case 1:b=r?String.format(WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WacWordeditorStrings.ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,
h){zl.ry&&(b=zl.GMf(b,h),zl.ry.sendNotification(b,!0))}static rse(b,h,r,A=""){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:r,dataFields:[Object.assign(new ma.a,{name:b,bool:h}),Object.assign(new ma.a,{name:"ProviderName",string:A})]}))}}Object(u.a)(zl,"ExternalContentHelper",null,[]);var Rx=e(762);class RB{constructor(){this.xn=this.Tu=null}v3d(b,h,r){b.hk().Jg.lG(()=>{this.Dpg(h,b,r)},()=>
{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Dpg(b,h,r){if(b=this.NPf(b,h))h=Array(1),h[0]=b,r=UK.a.construct(h,r,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Tu.Kr:null),b=this.pxf(),this.zAb(b,r)}NPf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Tu=h.hk();(new te.a).set(h);if(!h.anchor||!h.anchor.rt||!h.anchor.rt.Ku)return v.ULS.sendTraceTag(592996171,
324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.rt.Ku.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(Kh.a.YL,kf.a.jw);const A=h.getValue(Sb.a.FI),L=rb.a.Rf(pe.a.uH(h.properties),0),ba=rb.a.Rf(pe.a.pN(h.properties),1);return wI.a.construct(h.id.toString(),b,h.ka(Sb.a.imageAltText,""),L,ba,h.ka(Rc.a.P1,""),r,h.ka(Rc.a.lZ,0),h.ka(Rc.a.ioa,
!1),h.ka(Kh.a.Wma,-1),h.ka(Rc.a.nxb,Box4Intl.Box4Strings.l_Picture),h.ka(Sb.a.dEa,!1),A,h.ka(Rc.a.runId,1),h.ka(Rc.a.qd,0))}zAb(b,h){y.AFrameworkApplication.pe.addRequest(b,2,H.c(h),{},!1,2,this.ykd.bind(this),this.Fwc.bind(this),null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}ykd(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Fwc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}pxf(){let b=
db.a.C4c("PicturePaste.ashx");const h=on.a.$Ya;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=db.a.xq(b,Wi.a.fileId,this.Tu.Kr));b=db.a.xq(b,Wi.a.cellId,this.Tu.Wl.toString());this.xn||(this.xn=qb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=db.a.xq(b,Wi.a.g1,this.xn.toString());b=db.a.xq(b,Wi.a.classId,h.toString());this.Tu.MI&&(b=db.a.xq(b,Wi.a.MI,this.Tu.MI));b=db.a.xq(b,
Wi.a.rDb,"1");b=db.a.xq(b,ri.a.imageType,jr.other.toString());b=Sk.a.instance.Pif(b);b=db.a.xq(b,Wi.a.uBa,this.Tu.Jg.Au.toString());b=db.a.xq(b,Wi.a.vwc,"0");return b=db.a.xq(b,Wi.a.p5b,"1")}}Object(u.a)(RB,"ExternalContentThumbnailHelper",null,[]);class or extends RB{constructor(){super(...arguments);this.oq=null}static get Wf(){return null!=or.CZg?or.CZg:or.CZg=Xa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}igk(b,h,r){return zl.i_a(h)?zl.lqf(b,r)?!0:(or.Wf.ZV(this.oq,2,"URL inserted in Non-Embedable context",
or.Wf.jq()),!1):(v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),or.Wf.ZV(this.oq,2,"URL inserted is not valid for ExternalContent",or.Wf.jq()),!1)}}Object(u.a)(or,"AbstractExternalContentEditor",RB,[175]);var Sx=e(1164),Bt=e(1156);class Hr extends or{constructor(b){super();Hr.VTa=b;this.e9f()}e9f(){Bt.a.e9f(Hr.VTa.VBi())}static get gm(){return null!=Hr.n7g?Hr.n7g:Hr.n7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}$Ll(b,h){h=this.SGi(b,
h);this.KXi(h,b,5)}fZa(b,h,r){if(this.igk(b,h,r)){var A=this.SGi(b,null);A.url=h;this.KXi(A,b,r?0:2)}}nte(b,h){this.fZa(b,h,!1)}KXi(b,h,r){this.xn=qb.a.create();const A=new hb.GraphTransaction(15);A.Eb(h.node);A.Bh=Lc.a.Tgn;const L=zl.joc(h),ba=Xt.r(b.mediaType),ra=zl.Sae(b.height,b.width,b.title,ba);h=this.OEp(h,1==r);(h=zl.ll.xfe(h,ra))?(h=h.node,zl.sfe(h,{url:b.url,mediaType:ba,hx:b.title,loopType:b.type,egj:r},void 0)||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),
A.sOa(this.xn,1),A.dispose(),this.v3d(h,b.thumbnail,!1),this.Elo(L,ba,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}OEp(b,h){zl.Ug.lf(b,"");return zl.d1d(b,h)}Elo(b,h,r){zl.rse("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");zl.ariaNotify(h,this.Iom(r))}Iom(b){switch(b){case Rx.a.CheckList:return"Checklist Component";case Rx.a.TaskAssignment:return"Task List Component";case Rx.a.Poll:return"Poll Component";
default:return"Fluid Component"}}SGi(b,h){const r=new LD;r.width=zl.n6.fjc(b.node)||0;Xt.j()?r.height=null!=Hr.VTa&&Hr.VTa.SBi(h)||zl.n6.j$a(b.node)||0:r.height=null!=Hr.VTa&&Hr.VTa.SBi(h)+2*fz.a.pga||zl.n6.j$a(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.Tzm();r.url=null!=Hr.VTa&&Hr.VTa.dMf();return r}Tzm(){return Hr.VTa.VBi()}static obd(b){y.AFrameworkApplication.ud("2cejb611;b0jjh576");return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=Hr.VTa&&Hr.VTa.Y7i(b)&&Sx.a.Bwl(b)}}Object(u.a)(Hr,"FluidComponentEditor",or,[]);class tr{get jam(){return null!=this.tZg?this.tZg:this.tZg=Xa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get f7d(){return null!=this.P_g?this.P_g:this.P_g=Xa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}zlo(b,h){b&&(Hr.obd(h)?this.f7d.fZa(b,h,!0):this.jam.fZa(b,h,!0))}}Object(u.a)(tr,"PostHyperlinkAutoCorrectStrategy",null,[646]);class gz{Mgc(b,h){h(gz.Jlo.test(b))}uyc(b,
h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new JD,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:gz.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}gz.Jlo=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");gz.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(u.a)(gz,"PowerBIURLResolver",null,[399,389]);class Tx{constructor(b){this.WOh=b}Mgc(b,h){let r=!1;try{if(Tx.aAn(b)){const A=this.WOh.Umc(b);r=null!=A.width&&null!=A.height&&!!A.thumbnailUrl}}catch(A){}h(r)}uyc(b,h){var r=this.WOh.Umc(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new JD,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Width:r.width});h(r)}static aAn(b){for(const h of Tx.ynp)if(b.startsWith(h))return!0;return!1}static fca(){return new Tx(Xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Tx.ynp=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(u.a)(Tx,"WedgeComponentExperimentsURLResolver",null,[399,389]);var TF=
e(909);let yI=!1;class Cu{static Rep(b){Cu.h4i||Cu.addEventListener();const h=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(Cu.fop,Cu.eop,!0);Cu.h4i=!0}static Yyl(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();yI=!0}}Cu.ROn="LoopHomeTabFlightActivity";Cu.fop="switchToInsertTabAndClickLoopButtonEvent";Cu.h4i=!1;Cu.eop=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));
const r=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.sc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Md.a(0,1,r,()=>{Cu.Yyl()});null===(h=y.AFrameworkApplication.zc)||void 0===h?void 0:h.pc(b)};Object(u.a)(Cu,"FluidComponentsTUIHelper",null,[]);class lA{constructor(b,h,r){this.ga=b;this.bCk=h;this.sm=r;this.Vuh=!1;this.wzh=1E3;this.xzh=15E3;this.Waf=this.Naf=!0;this.Waf=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",
!1);this.wzh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.xzh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}mc(){this.ga.nb(Lc.a.OXi,ic.a.kd,this.shn.bind(this),1028);this.ga.nb(Lc.a.Ute,ic.a.kd,this.Ute.bind(this),1028);this.ga.nb(Lc.a.Y$c,ic.a.kd,this.kZf.bind(this),1028);this.ga.nb(Lc.a.K$c,ic.a.kd,
this.kZf.bind(this),1028);this.ga.nb(Lc.a.Bfe,ic.a.kd,this.kZf.bind(this),1028);this.ga.nb(Lc.a.Taj,ic.a.kd,this.Smk.bind(this),1028)}shn(){return 32}Ute(b,h,r){if(2!==r)return 32;this.Waf&&(this.dJj(),this.ewp());return 32}kZf(b,h,r){var A,L;if(1===r){if(!this.zhe(b)||!TF.a.D2i())return v.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;if(!h.nm||!Ee.a.Df(h)||(null===(A=this.sm)||void 0===A?0:A.t4(h))||(null===(L=this.sm)||void 0===L?0:L.koa(h)))return 2;if(h&&
h.node&&xv.a(h.node))return 32}else if(2===r)return this.bCk.$Ll(h,lA.Rzm(b)),this.dJj(),32;return 2}ewp(){if(null!=Ja.a.instance.getItem("LoopComponentSurveyShowed")||yI)this.Naf=!1;if(this.Naf){let b=this.RGi();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&(this.Vuh=!0)},this.wzh);this.NQk=window.setTimeout(()=>{const h=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");this.Vuh&&h&&h.execute(r=>{(b=this.RGi())&&"hidden"===b.visibility&&!yI&&(v.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),
r.y2a("WordLoopFeedbackSurvey",null),this.Naf=!1,Ja.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.xzh)}}RGi(){var b,h;let r=null;try{const A=document.getElementById("Ribbon-LoopComponentDropdown");A&&(r=Lj.a.JB(null===(h=null===(b=A.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(A){v.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=A?A.toString():""))}return r}dJj(){this.Waf&&window.clearTimeout(this.NQk)}zhe(b){return b===
Lc.a.K$c||b===Lc.a.Y$c?Sx.a.zhe():!0}Smk(b,h,r){2===r&&D.a.BZ("https://go.microsoft.com/fwlink/?linkid=2194838")&&Ze.a.Wzg.wDc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static Rzm(b){switch(b){case Lc.a.Y$c:return Rx.a.TaskAssignment;case Lc.a.K$c:return Rx.a.CheckList;case Lc.a.Bfe:return Rx.a.Poll;default:return null}}}Object(u.a)(lA,"FluidComponentsActor",null,[]);class lj extends or{constructor(){super();this.dXb=this.cXb=null;this.oFf=new ez.ExternalContentEmbedRetriever;this.ZJc=
null;null!=lj.oua&&lj.oua.mBi()}rEj(){this.oq=V.a.create();lj.Wf.pPb(this.oq,4);lj.Wf.g$(this.oq,0,lj.Wf.jq());this.$Ub(this.cXb,3,this.dXb,!0)}fZa(b,h,r){this.oq=V.a.create();lj.Wf.pPb(this.oq,r?0:2);lj.Wf.g$(this.oq,0,lj.Wf.jq());this.ZJc();this.$Ub(b,r?0:2,h)}nte(b,h){this.oq=V.a.create();lj.Wf.pPb(this.oq,1);lj.Wf.g$(this.oq,0,lj.Wf.jq());this.$Ub(b,1,h)}jGj(b){this.ZJc=b}fMe(b,h){const r=lj.n6.fjc(h)||0;h=lj.n6.j$a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=
h/A)}vUg(b,h,r){if(null!=b&&null!=h&&!D.a.jg(r)){var A=lj.Bhd.Umc(r);A.hideFloatie=!0;this.fMe(b,h.node);this.kpc(b,h,!1,A,r)}}Rtb(b){return b?b.Xe:0}lRg(b,h,r){let A=null;const L=b.node;if(!rd.ParagraphReader.lc(L)||!L.isConnected)return{returnValue:!1,xya:A};if(r)return{returnValue:!0,xya:b};r=b.cpBegin;const ba=b.cpEnd,ra=rd.ParagraphReader.text(L);if(0<=r&&ba<=ra.length&&ra.substring(r,ba)===h)return{returnValue:!0,xya:b};const Ia=ra.indexOf(h);return 0<=Ia?(A=vc.a.createTextRange(L,Ia,Ia+h.length),
{returnValue:!0,xya:A}):0<=r&&ba<=ra.length&&zl.joc(b)?{returnValue:!0,xya:b}:{returnValue:!1,xya:A}}x5f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Khb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");r&&r.execute(A=>{A.logActivity(b,h)})},lj.tCa)}$Ub(b,h,r,A=!1){if(this.igk(b,r,!h)){var L=lj.Bhd.Umc(r);L&&(this.x5f(L)?(v.ULS.sendTraceTag(591681428,
324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.zpg(b,h,L,r,A)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),lj.Wf.ZV(this.oq,2,"Size provided is not valid for OEmbed",lj.Wf.jq())))}}zpg(b,h,r,A,L){const ba=1===h,ra=lj.n6.fjc(b.node)||0,Ia=lj.n6.j$a(b.node)||0,Ta=vI.a.fuf(r.DQg,!0,ra,Ia);this.ofd(b,A,h,!0);this.oFf.Y5h(Ta,ob=>{lj.Wf.g$(this.oq,4,lj.Wf.jq());lj.Wf.frd(this.oq,this.Rtb(ob.data));if(ob=this.Fpg(ob)){v.ULS.sendTraceTag(592307859,
324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var nb=Xt.r(ob.MediaType);lj.Wf.Wwe(this.oq,7,nb);nb=b;({xya:nb}=this.lRg(b,A,ba)).returnValue?(this.ofd(nb,A,h,!1),null==r.width?0<ra&&ob.Width>ra&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),ob.Width=ra):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),
ob.Width=this.lxd(r.width,ob.Width,ra)),null==r.height?0<Ia&&ob.Height>Ia&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),ob.Height=Ia):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),ob.Height=this.lxd(r.height,ob.Height,Ia)),lj.oua.Ejb||L?this.kpc(ob,nb,ba,r,A):(this.cXb=b,this.dXb=A,this.o_c(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
lj.Wf.ZV(this.oq,2,"No conversion as the context is no longer valid for the external content conversion",lj.Wf.jq()));ba&&this.p9a(nb.node)}else ba&&this.p9a(b.node),lj.Wf.ZV(this.oq,1,"URL not oEmbedable",lj.Wf.jq())},ob=>{lj.Wf.g$(this.oq,4,lj.Wf.jq());lj.Wf.frd(this.oq,this.Rtb(ob.data));ba&&this.p9a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl.");lj.Wf.ZV(this.oq,2,"ExternalContentEmbedRequest failed",lj.Wf.jq())},ob=>{ba&&this.p9a(b.node);v.ULS.sendTraceTag(588834835,
324,50,"Request not allowed in InsertExternalContentImpl: "+ob)},this.oq)}lxd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}kpc(b,h,r,A,L){this.xn=qb.a.create();b.Width=b.Width/b.Height*(b.Height-(fz.a.Fde+fz.a.pga))+2*fz.a.pga;const ba=new hb.GraphTransaction(15);ba.Eb(h.node);ba.Bh=Lc.a.fZa;const ra=zl.joc(h);if(h){r&&(h=this.nzf(h));var Ia=zl.d1d(h,r);if(Ia){var Ta=
Xt.r(b.MediaType),ob=zl.Sae(b.Height,b.Width,b.Title,Ta);(Ia=this.hZf(Ia,ob,r,{url:L,F9a:b.IFrameHtml,hx:b.Title,mediaType:Ta},b.ProviderName))?(ba.sOa(this.xn,1),ba.dispose(),this.cXb=h,this.dXb=L,this.bmg(A,b,Ia),this.mpg(L,r||A.hideFloatie,ra,Ta,b.Title,b.ProviderName)):ba.dispose()}else ba.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),lj.Wf.ZV(this.oq,2,"Could not create IP context on splitting the paragraph",
lj.Wf.jq())}else lj.Wf.ZV(this.oq,2,"GraphNodeContext is null",lj.Wf.jq())}hZf(b,h,r,A,L){if(!b)return null;b=lj.OT.xfe(b,h);if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),lj.Wf.ZV(this.oq,2,"The anchored image could not be inserted",lj.Wf.jq()),null;b=b.node;A=zl.sfe(b,A,L);lj.Wf.FPg(this.oq,A.id);r||zl.HCg(b);return b}bmg(b,h,r){D.a.Vba(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&
(lj.Wf.g$(this.oq,8,lj.Wf.jq()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.v3d(r,h.Thumbnail,!1))}mpg(b,h,r,A,L,ba){h||this.o_c(b);this.Khb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");zl.rse("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",ba);zl.ariaNotify(A,L);lj.Wf.g$(this.oq,5,lj.Wf.jq())}nzf(b){const h=b.node,r=rd.ParagraphReader.text(h);return 0<r.length&&
!r.trim().length?(b=vc.a.createTextRange(h,0,r.length),zl.Ug.lf(b,""),vc.a.jd(h,0)):b}Fpg(b){if(!({group:b}=lm.a.A6(b.data.responseData)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}p9a(b){b.xwc=null}ofd(b,h,r,A){const L=b.cpBegin,ba=b.cpEnd;b=rd.ParagraphReader.text(b.node).trim();L||b!==h&&""!==b?L?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
yv[r],A):0<L&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yv[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
yv[r],A)}o_c(b){this.ljc();const h=new Gy.a(1,y.AFrameworkApplication.isRtl);h.kkd=b;lj.$rb.Lmd(h)}ljc(){const b=new Jz.a(!0);lj.Pda.GPa(b)}static get $rb(){return null!=lj.vZg?lj.vZg:lj.vZg=Xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get oua(){lj.mIa||(lj.mIa=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return lj.mIa}static get Pda(){return null!=lj.M7g?lj.M7g:lj.M7g=Xa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get n6(){return null!=
lj.f9g?lj.f9g:lj.f9g=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get OT(){return null!=lj.s1g?lj.s1g:lj.s1g=Xa.a.instance.resolve("WordEditor.IImageEditor")}static get Bhd(){return null!=lj.k6g?lj.k6g:lj.k6g=Xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}lj.tCa=5E3;lj.mIa=null;Object(u.a)(lj,"ExternalContentEditorV2",or,[]);class MD{constructor(){this.Qd=this.Z=null}get name(){return"WordEditor.ExternalContent"}get Dc(){return this.Qd?
this.Qd:this.Qd=this.Z.resolve("Box4.IFeatureHelper")}Ec(b){var h;this.Z=b;b.ja("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new cM.a(Ap.a.instance,Ur.a.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ja("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new tr).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();b.ja("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new KD(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ja("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new lj).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ja("WordEditor.ExternalContent.FluidComponentEditor",()=>new Hr(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ja("WordEditor.ExternalContent.FluidComponentsActor",
()=>new lA(y.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),Ke.a.instance)).ha(),(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Cu.Rep(Cu.ROn)):b.ja("WordEditor.ExternalContent.ExternalContentEditor",()=>new Fh).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.Dc.Fs.continueWith(()=>{this.Sp()});y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.Z.resolve("WordEditor.ExternalContent.FluidComponentsActor").mc()}dispose(){}PLl(){const b=new tI;this.Foi()&&b.zTh(Tx.fca());b.zTh(new gz);return b}Sp(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.Z.ja("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new VK.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();this.Foi()&&(this.Z.ja("WordEditor.ExternalContent.IWordExternalContentURLResolver",
()=>this.PLl()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.Z.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}Foi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){F.a.instance.Rc(new MD)}}Object(u.a)(MD,"ExternalContentPackage",null,[0,1]);var zv;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";
b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.Nyf=6]="decimal";b[b.bar=7]="bar";b[b.eyb=8]="num"})(zv||(zv={}));Object(u.b)("TabStopValues",zv);class Rn{}Rn.vii=8;Rn.uVl=1;Rn.uca="wwaengidc";Rn.kpiName="WordRuler";Rn.precision=.0625;Rn.opp=1;Rn.UKp="ShowHideRuler";Object(u.a)(Rn,"Constants",null,[]);var UF=e(1070);class pr{static mnc(b,h){if(!pr.Mcd)return null;switch(b){case "Left":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{oXb:0,p1b:A.scale-(A.margins[1].value+r[2].value+
Math.max(r[0].value,r[1].value)+8*A.precision)}};case "Right":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{oXb:0,p1b:A.scale-(r[2].value+(A.margins[0].value+Math.max(r[0].value,r[1].value))+8*A.precision)}};case "MoveTableColumn":return()=>{let r=0,A=0;if(0===h){var L={};32===pr.Tb.Zb(fb.a.vxc,2,L)&&(r=fg.a.kD(L.MinIndent),A=fg.a.kD(L.MaxIndent))}else L={lo:h-1},32===pr.Tb.Zb(fb.a.txc,2,L)&&(r=fg.a.kD(L.MinResize),A=fg.a.kD(L.MaxResize));return{oXb:r,p1b:A}};case "Top":return r=>{r=r.rulerCanvasProps;
return{oXb:0,p1b:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{oXb:0,p1b:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static hbe(b){if(!pr.Mcd)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var r=h.rulerCanvasProps,A=h.indents,L=h.ipContextIndex;h=r.margins;var ba=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){L=h[0].value;h=h[1].value+A[2].value;var ra=L;"LeftIndent"===b&&(ra+=
Math.max(A[0].value,A[1].value));A=-1*L;r=ba-(ra+h+8*r)}else{ba=0;for(ra=0;ra<=L;ra++)ba+=h[ra].value;ra=0;if("LeftIndent"===b){ra=A[0].value;const Ia=A[1].value;ba+=Math.max(ra,Ia);ra=Math.max(ra,Ia)}h=h[L+1].value;ra+=A[2].value;A=-1*ba;r=h-ra-r}return{oXb:A,p1b:r}};case "RightIndent":return h=>{var r=h.rulerCanvasProps,A=h.indents,L=h.ipContextIndex,ba=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ba[0].type){var ra=ba[0].value;ba=ba[1].value;L=A[0].value;var Ia=A[1].value;A=-1*ba;h-=
ra+ba+Math.max(L,Ia)+8*r}else{ra=0;for(Ia=0;Ia<=L;Ia++)ra+=ba[Ia].value;ba=ba[L+1].value;L=A[0].value;Ia=A[1].value;A=-1*(h-ra-ba);h=ba-Math.max(L,Ia)-r}return{oXb:A,p1b:h}}}return null}static PPm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,A=b.ipContextIndex,L=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==L[0].type?(A=L[0].value,L=L[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(A+L+b)):(h=r[2].value,L=L[A+1].value,r=Math.min(r[0].value,r[1].value)+b,b=L-(h+b));return{oXb:r,
p1b:b}}}static get Tb(){return null!=pr.JWg?pr.JWg:pr.JWg=y.AFrameworkApplication.va}static get Mcd(){null==this.ylb&&(y.AFrameworkApplication.Goa("WoRul910;WoRul910cf"),this.ylb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.ylb}}pr.ylb=null;Object(u.a)(pr,"RulerPropertyBoundaryHelper",null,[]);var WK=e(950),dM=e(1368),SB=e(972),mA=e(1222),ND=e(1223);class Yt{constructor(b,h,r,A,L,ba,ra){this.wdo=
"OutlineContainer";this.LXk="UpdateCustomTabFailed";this.cKb="ReadRulerPropertiesFailed";this.PXk="UpdateIndentFailed";this.LOh="UpdateMarginFailed";this.hre=Ia=>{(Ia.button===Sys.UI.MouseButton.rightButton||this.kyn&&Ia.button===Sys.UI.MouseButton.leftButton)&&this.n$e.show(new Sys.UI.Point(Ia.clientX,Ia.clientY),2)};this.Mdk=()=>{this.s3a()};this.vv=b;this.Xac=h;this.ga=r;this.n$e=A;this.mC=L;this.tS=ba;this.Y8b=null;this.eIb=ra;this.qB=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.z9;
this.Wrj=this.Qqe.bind(this);this.Yuj=this.Jv.bind(this);this.Ldk=this.s3a.bind(this)}EG(){this.Aif();this.FTh();this.Xac.Um.Hf(10).yq(this.Wrj);Re.a.addHandler(this.Vff,Fd.a.scroll,this.Mdk);this.vv.execute(h=>{h.UW(this.Yuj)});const b=[this.EIi(),document.getElementById(Uk.a.kDb),document.getElementById("PageContentContainer")];this.Vug(b);Db.StaticActiveAppFrame.Aa().ES.registerBoundingWindowRectsChanged("documentPanel",(h,r)=>{"undefined"!==r&&this.$hb([1,0])})}Vug(b){this.Y8b?this.Y8b.register(b,
this.Ldk):SB.a(dM.a.zbl,()=>{appChrome.getResizeObserver().then(h=>{this.Y8b=h.createResizeObserver();this.Y8b.register(b,this.Ldk);return null})})}EIi(){return 0===this.tS.vz?this.MDh:this.dEh}get Vff(){return document.getElementById(Uk.a.G3a)}get MDh(){const b=document.getElementsByClassName(this.wdo);return b&&0<b.length?b[0]:null}get BOk(){var b=this.mC.CRb;if(!b)return null;b=this.JUo(rd.ParagraphReader.fW(b));return WK.a.IIi(b)}get qUa(){return this.eIb.value}get dEh(){return this.qUa.ug(this.qUa.Fd).iU}JUo(b){return 0<
b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get iS(){return this.vv&&this.vv.instance?this.vv.instance.Ql:Rn.uVl}Bmc(){const b={};return 32!==this.ga.Zb(fb.a.CPa,2,b)?(v.ULS.sendTraceTag(529065947,mA.a.fXn,ND.a.warning,"Unable to read page properties for Ruler"),Gl.recordQosError(this.cKb,[Gl.sla],"Unable to read page properties for Ruler"),null):b}dispose(){this.JTi();this.Xac.Um.Hf(10).nU(this.Wrj);Re.a.removeHandler(this.Vff,Fd.a.scroll,this.Mdk);this.vv.execute(b=>{b.NPa(this.Yuj)});
this.Y8b&&this.Y8b.dispose();Db.StaticActiveAppFrame.Aa().ES.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.$hb([1,0])})}get G4i(){null==Yt.L_e&&(Yt.L_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&y.AFrameworkApplication.J.$("RulerThemingIsEnabled"):!1);return Yt.L_e}get kyn(){null==Yt.t0e&&(Yt.t0e=y.AFrameworkApplication.J?
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRulerContextMenuOnLeftClick",!1):!1);return Yt.t0e}}Yt.L_e=null;Yt.t0e=null;Object(u.a)(Yt,"ARuler",null,[239]);var XK=e(310);class ft extends Yt{constructor(b,h,r,A,L,ba,ra,Ia){super(b,h,r,L,ba,ra,Ia);this.YT="HorizontalRuler";this.zkk="CustomTabModificationFromRuler";this.fmk="IndentModificationFromRuler";this.rLe="MarginModificationFromRuler";this.Pqh=this.Oqh=this._tabStops=null;this.K3n=(Ta,ob,nb)=>{if(!(Ta>=this._tabStops.length)){Ta=
this._tabStops[Ta];var Eb="Modify"===nb?this.ga.Zb(Lc.a.nuc,2,{["tabStop"]:Ta,["value"]:fg.a.pF(ob)}):this.ga.Zb(Lc.a.Afb,2,Ta);if(32===Eb){ob=1;var bc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",nb,zv[Ta.Kja]);v.ULS.sendTraceTag(591213271,3014,50,bc)}else ob=0,bc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",nb,zv[Ta.Kja]),v.ULS.sendTraceTag(591213272,3014,15,bc),Gl.recordQosError(this.LXk,[Gl.sla],"Unable to modify custom tab using ruler");
$d.a(this.zkk,32===Eb,void 0,[Object.assign(new ma.a,{name:"Operation",string:nb}),Object.assign(new ma.a,{name:"TabType",int64:zv[Ta.Kja]})]);nb=new Map;nb.set("Command","OnCustomTabChange");nb.set("Source",this.YT);nb.set("Response",bc);Ca.Health.instance.recordKpiUsage(Rn.kpiName,ob,Rn.uca,nb)}};this.$5n=(Ta,ob)=>{var nb=new UF.a;nb.unit=1;nb.value=fg.a.pF(ob);ob=8;switch(Ta){case "FirstLineIndent":ob=this.ga.Zb(fb.a.Mrd,2,nb);break;case "HangingIndent":ob=this.ga.Zb(fb.a.Nrd,2,nb);break;case "LeftIndent":ob=
this.ga.Zb(fb.a.Ubb,2,nb);break;case "RightIndent":ob=this.ga.Zb(fb.a.Tbb,2,nb)}let Eb;32===ob?(nb=1,Eb=String.format("Indents set using Ruler. Indent: {0}",Ta),v.ULS.sendTraceTag(592517017,3014,50,Eb)):(nb=0,Eb=String.format("Unable to set indent using Ruler. Indent: {0}",Ta),v.ULS.sendTraceTag(592496523,3014,15,Eb,Ta),Gl.recordQosError(this.PXk,[Gl.sla],"Unable to set indent using Ruler."));$d.a(this.fmk,32===ob,void 0,[Object.assign(new ma.a,{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command",
"OnIndentChange");Ta.set("Source",this.YT);Ta.set("Response",Eb);Ca.Health.instance.recordKpiUsage(Rn.kpiName,nb,Rn.uca,Ta)};this.Lvc=(Ta,ob)=>{if(Gl.instance.fia)switch(ob.$db){case 3:case 2:case 1:this.Vug([this.dEh]);break;case 0:this.Vug([this.MDh])}};this.Djg=(Ta,ob,nb)=>{let Eb;Eb="Left"===Ta?this.ga.Zb(fb.a.Hpa,2,fg.a.pF(ob)):"Right"===Ta?this.ga.Zb(fb.a.xgb,2,fg.a.pF(ob)):nb?this.ga.Zb(fb.a.uFe,2,{["columnIndex"]:nb-1,["width"]:fg.a.pF(ob)}):this.ga.Zb(fb.a.aAc,2,fg.a.pF(ob));32===Eb?(ob=
1,nb=String.format("Margins set using Ruler. Margin: {0}",Ta),v.ULS.sendTraceTag(592517018,3014,50,nb)):(ob=0,nb=String.format("Unable to set margins using Ruler. Margin: {0}",Ta),v.ULS.sendTraceTag(592496524,3014,15,nb),Gl.recordQosError(this.LOh,[Gl.sla],"Unable to set margins using Ruler."));$d.a(this.rLe,32===Eb,void 0,[Object.assign(new ma.a,{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command","OnMarginChange");Ta.set("Source",this.YT);Ta.set("Response",nb);Ca.Health.instance.recordKpiUsage(Rn.kpiName,
ob,Rn.uca,Ta)};this.RUa=A;this.Ut={}}get kZ(){return this.Oqh}get cNa(){return this.Pqh}renderRuler(){this.kZ.classList.remove("HideWACHorizontalRulerContainer");this.kZ.classList.add("ShowWACHorizontalRulerContainer");var b=this.Bmc();if(b){var h=this.Djg,r=this.$5n,A=this.K3n,L=this.Ivd(),ba=this.Z8j(),ra=this.Y8j();L&&ba&&ra||(this.Ut.disabled=!0);this.Ut.onIndentChange=r;this.Ut.onMarginChange=h;this.Ut.onTabChange=A;this.s3a();b=rb.a.Zj(b.pageWidth,0);this.cNa.style.width=(b*this.iS).toString()+
"px";return this.RUa().then(Ia=>{Ia.renderRuler(this.cNa,this.Ut)})}}Y8j(){const b=[];var h={};if(32!==this.ga.Zb(Lc.a.N_b,2,h))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Gl.recordQosError(this.cKb,[Gl.sla],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.Ut.tabs=b,!0;this._tabStops=r;h="";for(const A of r){switch(A.Kja){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h=
"DecimalTab";break;case 7:h="BarTab"}r=rb.a.U0a(A.IQa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:pr.PPm()})}this.Ut.tabs=b;return!0}$hb(b){var h;if(this.kZ){this.kZ.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.Ut&&delete this.Ut.disabled;for(const r of b)switch(r){case 0:b=this.Z8j();const A=this.Y8j();b&&A||(this.Ut.disabled=!0);break;case 1:this.Ivd()||(this.Ut.disabled=!0)}if(null===(h=this.mC.currentSelection)||void 0===h?0:h.nbd)this.Ut.disabled=!0;this.RUa().then(r=>
{r.renderRuler(this.cNa,this.Ut);return null})}}Ivd(){const b={};var h=this.Bmc();if(!h)return!1;b.scale=fg.a.kD(h.pageWidth);b.precision=Rn.precision;b.rulerType="Horizontal";if(!this.Gbo())return this.Ut.ipContextIndex=0,this.Ut.permittedUnits=Rn.vii,h=[{["type"]:"Left",["value"]:fg.a.kD(h.marginLeft),["getRulerPropertyBoundary"]:pr.mnc("Left",0)},{["type"]:"Right",["value"]:fg.a.kD(h.marginRight),["getRulerPropertyBoundary"]:pr.mnc("Right",1)}],b.margins=h,this.Ut.rulerCanvasProps=b,!0;var r={};
h={};var A=this.ga.Zb(fb.a.smd,2,r);const L=this.ga.Zb(fb.a.Y_b,2,h);if(32!==A||32!==L)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Gl.recordQosError(this.cKb,[Gl.sla],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;A=h.TablePosition;if(!A||!r||0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Gl.recordQosError(this.cKb,[Gl.sla],"Cannot show table properties on the ruler as they are null"),
!1;h=Array(r.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:fg.a.kD(A.x/this.iS),["getRulerPropertyBoundary"]:pr.mnc("MoveTableColumn",0)};for(A=0;A<r.length;A+=1)h[A+1]={["type"]:"MoveTableColumn",["value"]:fg.a.kD(r[A]),["getRulerPropertyBoundary"]:pr.mnc("MoveTableColumn",A+1)};this.Ut.ipContextIndex=this.DTm();this.Ut.permittedUnits=Rn.opp;b.margins=h;this.Ut.rulerCanvasProps=b;return!0}Z8j(){var b={};if(32!==this.ga.Zb(fb.a.lfb,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
Gl.recordQosError(this.cKb,[Gl.sla],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=pr.hbe("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=pr.hbe("HangingIndent");const A={type:"RightIndent"};A.getRulerPropertyBoundary=pr.hbe("RightIndent");const L={type:"LeftIndent"};L.getRulerPropertyBoundary=pr.hbe("LeftIndent");this.Ut.rtl=b.isRtl;b=b.fw;h.value=1===b.specialIndentType?fg.a.kD(b.Bja+b.NC):2===b.specialIndentType?
fg.a.kD(b.NC-b.Bja):fg.a.kD(b.NC);r.value=fg.a.kD(b.NC);L.value=fg.a.kD(b.NC);A.value=fg.a.kD(b.Kha);this.Ut.indents=[h,r,A,L];return!0}FTh(){Re.a.addHandler(this.kZ,Fd.a.eE,this.hre);this.tS.wVc(this.Lvc)}JTi(){this.kZ&&(this.kZ.classList.remove("ShowWACHorizontalRulerContainer"),this.kZ.classList.add("HideWACHorizontalRulerContainer"),Re.a.removeHandler(this.kZ,Fd.a.eE,this.hre));this.RUa().then(b=>{b.dispose(this.cNa);return null});this.tS.Oxe(this.Lvc)}Jv(){this.Odk();this.s3a();this.$hb([1,0])}Qqe(b,
h){b=h.property;if(b===Rc.a.pageWidth||b===Rc.a.marginLeft||b===Rc.a.marginRight)this.Odk(),this.s3a(),this.$hb([1])}Odk(){var b=this.Bmc();b&&(b=rb.a.Zj(b.pageWidth,0),this.cNa.style.width=Math.round(b*this.iS).toString()+"px")}s3a(){window.requestAnimationFrame(()=>{var b=this.EIi();b&&(b=ed.a.getElementBounds(b),y.AFrameworkApplication.isRtl?this.cNa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.cNa.style.marginLeft=b.x.toString()+"px")})}DTm(){const b=
te.a.kb(this.mC.CRb);if(b.Ib(14))return b.xd(16),wy.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Gl.recordQosError(this.cKb,[Gl.sla],"Unable to read table column index for Ruler");return 0}Gbo(){let b=!0;const h=this.mC.currentSelection.QV();if(null===h)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Gl.recordQosError(this.cKb,[Gl.sla],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=
te.a.kb(h.current.node);r.Wd();b=b&&Qh.TableReader.Cz(r)}return b}Aif(){if(!this.cNa&&!this.kZ){this.Oqh=document.createElement("div");this.kZ.id=ft.DEk;this.kZ.className=ft.CEk;this.kZ.setAttribute(le.a.bma,WacWordeditorStrings.Ruler);this.kZ.setAttribute(le.a.fi,le.a.HZh);this.kZ.classList.add("HideWACHorizontalRulerContainer");if(this.G4i){var b=y.AFrameworkApplication.J.rb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");yc.a.ZCa(b,
!h)&&this.kZ.classList.add(ft.hLk)}this.Pqh=document.createElement("div");this.cNa.className=ft.BEk;this.cNa.id=ft.EEk;this.kZ.appendChild(this.cNa);b=null;this.qB&&((b=Object(XK.a)("EditorBars"))&&b.appendChild(this.kZ),this.kZ.classList.add("regionComposer"));b||(b=document.getElementById(Uk.a.kDb),b.insertBefore(this.kZ,b.firstChild))}}static JI(){return new ft(Xa.a.instance.Za("Common.IZoomManager"),Ze.a.wf,y.AFrameworkApplication.va,Tk.UISurfaces.qLi,Xa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Js.a.instance,Xa.a.instance.resolve("WordEditor.IMainViewModeManager"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc))}static get instance(){return null!=ft.Q2g?ft.Q2g:ft.Q2g=ft.JI()}}ft.DEk="WACHorizontalRulerContainer";ft.CEk="WACHorizontalRulerContainer";ft.EEk="WACHorizontalRuler";ft.BEk="WACHorizontalRuler";ft.hLk="ModernUxWACHorizontalRulerContainer";Object(u.a)(ft,"HorizontalRuler",Yt,[]);var nA=e(1550);class zs extends Yt{constructor(b,h,r,A,L,ba,ra,Ia){super(b,h,r,L,ba,ra,Ia);this.YT="VerticalRuler";
this.rLe="MarginModificationFromRuler";this.BPh=this.APh=null;this.Djg=(Ta,ob)=>{let nb=8;"Top"===Ta?nb=this.ga.Zb(fb.a.ygb,2,fg.a.pF(ob)):"Bottom"===Ta&&(nb=this.ga.Zb(fb.a.wgb,2,fg.a.pF(ob)));let Eb;32===nb?(ob=1,Eb=String.format("Margins set using Ruler. Margin: {0}",Ta),v.ULS.sendTraceTag(529065945,3014,50,Eb)):(ob=0,Eb=String.format("Unable to set margins using Ruler. Margin: {0}",Ta),v.ULS.sendTraceTag(529065946,3014,15,Eb),Gl.recordQosError(this.LOh,[Gl.sla],"Unable to set margins using Ruler."));
$d.a(this.rLe,32===nb,void 0,[Object.assign(new ma.a,{name:"Type",string:Ta})]);Ta=new Map;Ta.set("Command","OnMarginChange");Ta.set("Source",this.YT);Ta.set("Response",Eb);Ca.Health.instance.recordKpiUsage(Rn.kpiName,ob,Rn.uca,Ta)};this.RUa=A;this.Ut={}}get K6(){return this.APh}get CRa(){return this.BPh}renderRuler(){this.K6.classList.remove("HideWACVerticalRulerContainer");this.K6.classList.add("ShowWACVerticalRulerContainer");var b=this.Bmc();if(b){var h=this.Djg;this.Ivd()||(this.Ut.disabled=
!0);this.Ut.onMarginChange=h;this.s3a();b=rb.a.Zj(b.pageHeight,1);this.CRa.style.height=(b*this.iS).toString()+"px";this.RUa().then(r=>{r.renderRuler(this.CRa,this.Ut);return null})}}$hb(b){var h;if(this.K6){this.K6.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.Ut&&delete this.Ut.disabled;for(const r of b)switch(r){case 1:this.Ivd()?this.s3a():this.Ut.disabled=!0}if(null===(h=this.mC.currentSelection)||void 0===h?0:h.nbd)this.Ut.disabled=!0;this.RUa().then(r=>{r.renderRuler(this.CRa,
this.Ut);return null})}}Ivd(){const b={},h=this.Bmc();if(!h)return!1;b.scale=fg.a.kD(h.pageHeight);b.precision=Rn.precision;b.rulerType="Vertical";this.Ut.ipContextIndex=0;this.Ut.permittedUnits=Rn.vii;b.margins=[{["type"]:"Top",["value"]:fg.a.kD(h.marginTop),["getRulerPropertyBoundary"]:pr.mnc("Top",0)},{["type"]:"Bottom",["value"]:fg.a.kD(h.marginBottom),["getRulerPropertyBoundary"]:pr.mnc("Bottom",1)}];this.Ut.rulerCanvasProps=b;return!0}FTh(){this.Aif();Re.a.addHandler(this.K6,Fd.a.eE,this.hre)}JTi(){this.K6&&
(this.K6.classList.remove("ShowWACVerticalRulerContainer"),this.K6.classList.add("HideWACVerticalRulerContainer"),Re.a.removeHandler(this.K6,Fd.a.eE,this.hre));this.RUa().then(b=>{b.dispose(this.CRa);return null})}Jv(){this.Kdk();this.s3a();this.$hb([1])}Qqe(b,h){b=h.property;if(b===Rc.a.pageHeight||b===Rc.a.marginTop||b===Rc.a.marginBottom)this.Kdk(),this.s3a(),this.$hb([1])}Kdk(){var b=this.Bmc();b&&(b=rb.a.Zj(b.pageHeight,1),this.CRa.style.height=Math.round(b*this.iS).toString()+"px")}s3a(){window.requestAnimationFrame(()=>
{var b=this.BOk;if(b){const h=ed.a.getElementBounds(b);this.CRa.style.height=h.height.toString()+"px";b=this.wVm(b);this.CRa.style.marginTop=b+"px"}})}wVm(b){b=b.getBoundingClientRect().y;const h=this.Vff.getBoundingClientRect().y;return b-h}Aif(){if(!this.CRa&&!this.K6){this.APh=document.createElement("div");this.K6.id=zs.BYk;this.K6.className=zs.AYk;this.K6.setAttribute(le.a.bma,WacWordeditorStrings.Ruler);this.K6.setAttribute(le.a.fi,le.a.HZh);this.K6.classList.add("HideWACVerticalRulerContainer");
if(this.G4i){var b=y.AFrameworkApplication.J.rb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");yc.a.ZCa(b,!h)&&Sys.UI.DomElement.addCssClass(this.K6,zs.iLk)}this.BPh=document.createElement("div");this.CRa.className=zs.zYk;this.CRa.id=zs.CYk;this.K6.appendChild(this.CRa);b=document.getElementById(Uk.a.kDb);b.insertBefore(this.K6,b.firstChild)}}static JI(){return new zs(Xa.a.instance.Za("Common.IZoomManager"),Ze.a.wf,y.AFrameworkApplication.va,
Tk.UISurfaces.qLi,Xa.a.instance.resolve("WordEditor.IRulerContextMenu"),Js.a.instance,Xa.a.instance.resolve("WordEditor.IMainViewModeManager"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc))}static get instance(){return null!=zs.P2g?zs.P2g:zs.P2g=zs.JI()}}zs.BYk="WACVerticalRulerContainer";zs.AYk="WACVerticalRulerContainer";zs.CYk="WACVerticalRuler";zs.zYk="WACVerticalRuler";zs.iLk="ModernUxWACVerticalRulerContainer";Object(u.a)(zs,"VerticalRuler",Yt,[]);class Gl{constructor(b,h,r,A,L,ba,ra,Ia,
Ta){this.JXe=this.n_e=!1;this.YT="RulerActor";this.uIh=null;this.fia=!1;this.rwk="ClearAllTabStopsFailed";this.FKh="ShowHideRulerFailed";this.dZd=(ob,nb,Eb)=>{if(1===Eb)return 32;ob=this.ga.Vb(Lc.a.K0b,2,null);32===ob?(Eb=1,nb=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,nb)):(Eb=0,nb=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,3014,15,nb),Gl.recordQosError(this.rwk,[Gl.sla],nb));const bc=new Map;bc.set("Command","ClearAllTabStops");
bc.set("Source",this.YT);bc.set("Response",nb);Ca.Health.instance.recordKpiUsage(Rn.kpiName,Eb,Rn.uca,bc);return ob};this.N$c=(ob,nb,Eb)=>{if(1===Eb)switch(ob){case Lc.a.pnf:case Lc.a.Oyf:return 2;default:return 32}nb=this.n$e.AOm();switch(ob){case Lc.a.w7f:var bc=1;break;case Lc.a.tzg:bc=4;break;case Lc.a.Vqf:bc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}ob=new AB.a(nb,bc,0,1);ob=this.ga.Zb(Lc.a.Yqd,2,ob);32===ob?(Eb=1,nb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",
zv[bc],nb.toString()),v.ULS.sendTraceTag(591213269,3014,50,nb)):(Eb=0,nb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",zv[bc],nb.toString()),v.ULS.sendTraceTag(591213270,3014,15,nb));bc=new Map;bc.set("Command","InsertCustomTabStopRuler");bc.set("Source",this.YT);bc.set("Response",nb);Ca.Health.instance.recordKpiUsage(Rn.kpiName,Eb,Rn.uca,bc);return ob};this.h3b=(ob,nb,Eb,bc,Bc)=>this.n_e||1===Eb&&bi.a.bda(nb.Pk)?8:this.fia?this.i9c(ob,nb,Eb,bc,Bc):this.Gfp(nb,Eb);
this.vRo=()=>{this.fia?v.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.Vb(fb.a.h3b,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Gl.recordQosError(this.FKh,[Gl.sla],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.i9c=(ob,nb,Eb)=>{if(1===Eb||!this.fia)return 32;this.fia=!1;this.o$e.cPj(!1);this.Ykb.dispose();this.ake()&&
this.kBf();this.Ndk();v.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");ob=new Map;ob.set("Command","HideRuler");ob.set("Source",this.YT);ob.set("Response","");Ca.Health.instance.recordKpiUsage(Rn.kpiName,1,Rn.uca,ob);return 32};this.Pve=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return 32;Bc&&(Bc[bg.a.On]=this.fia);return 32};this.ycn=ob=>{this.fia=ob.result};this.Ade=()=>{this.n_e=!1};this.uTi=()=>{this.n_e=!0};this.ga=b;this.Ykb=h;this.Gff=r;this.s6b=A;this.n$e=L;this.o$e=ba;Gl.km=Ia;this.U9b=ra;this.tS=
Ta;this.U9b.g8k(this.uTi);this.U9b.QUh(this.Ade)}initialize(){this.mc();this.uIh=this.vRo;window.addEventListener("TurnRulerOnAction",this.uIh,!0);return this.o$e.OPm().continueWith(this.ycn,8)}mc(){this.ga.qa(fb.a.h3b,ic.a.view,this.h3b);this.ga.nb(fb.a.Pve,ic.a.view,this.Pve,96);this.ga.qa(Lc.a.pnf,ic.a.view,this.N$c);this.ga.qa(Lc.a.Vqf,ic.a.view,this.N$c);this.ga.qa(Lc.a.dZd,ic.a.view,this.dZd);this.ga.qa(Lc.a.Oyf,ic.a.view,this.N$c);this.ga.qa(Lc.a.i9c,ic.a.view,this.i9c);this.ga.qa(Lc.a.w7f,
ic.a.view,this.N$c);this.ga.qa(Lc.a.tzg,ic.a.view,this.N$c);nA.a.vd.addHandler(nA.a.Iqe,this.jjd.bind(this));this.tS.SUd(this.Lvc)}XWi(){this.fia&&(this.Ykb.EG(),this.Ykb.renderRuler(),this.ake()&&this.yKj())}yKj(){this.Gff.EG();this.Gff.renderRuler()}kBf(){this.Gff.dispose()}ake(){return this.isPaginatedView()}dwp(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1)&&this.fia&&Xa.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("LocateRulerActivity",
null)})}lDc(){this.fia||Xa.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}W0(){this.U9b.dJo(this.uTi);this.U9b.RIo(this.Ade);this.fia&&(this.Ykb.dispose(),this.ake()&&this.kBf())}Ndk(){if(this.s6b){const b={};b[Rn.UKp]="ToggleButtonModel";this.s6b.UH(b)}}Gfp(b,h){if(!Gl.km.f9(b.Pk))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Gl.recordQosError(this.FKh,[Gl.sla],"Cannot show ruler. Word Section Node not found."),
8;if(1===h)return 32;this.fia=!0;this.o$e.cPj(!0);this.XWi();this.Ndk();v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.YT);b.set("Response","");Ca.Health.instance.recordKpiUsage(Rn.kpiName,1,Rn.uca,b);return 32}isPaginatedView(){var b,h;return 1===(null===(b=this.tS)||void 0===b?void 0:b.vz)||2===(null===(h=this.tS)||void 0===h?void 0:h.vz)}jjd(b,h){switch(h.documentMode){case "View":this.fia&&(this.ga.Vb(fb.a.h3b,2),this.JXe=!0);
break;case "Edit":this.JXe&&(this.ga.Vb(fb.a.h3b,2),this.JXe=!1)}}Lvc(b,h){if(Gl.instance.fia)switch(h.$db){case 2:case 1:Gl.instance.yKj();break;case 3:case 0:Gl.instance.kBf()}}static recordQosError(b,h,r){const A=Object.assign(new Sa.a,{extendedProperties:new Map});r&&A.extendedProperties.set("exception",r);Ca.Health.instance.recordQosError(b,h,!1,!0,!1,!1,A)}static JI(){return new Gl(y.AFrameworkApplication.va,ft.instance,zs.instance,Db.StaticActiveAppFrame.Aa(),Xa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Xa.a.instance.Wa("WordEditor.Ruler.IRulerSettingInfo"),Xa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Ap.a.instance,Xa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Gl.Q1g?Gl.Q1g:Gl.Q1g=Gl.JI()}}Gl.km=null;Gl.sla="RulerInteractionFailed";Object(u.a)(Gl,"RulerActor",null,[]);class VF{constructor(b,h){this.KRc=null;this.yeb=r=>r.result?r.result.Value.toString():"";this.UOa=r=>{if(r.mq||r.wj)v.ULS.sendTraceTag(591541278,3014,
15,"Failed to get ruler is enabled settings options from Roaming Service."),this.KRc=!1;else{zi.a.rx("EnableRuler;EnableRulercf");r=r.result;const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1);"true"===r.toLowerCase()&&A&&v.ULS.sendTraceTag(508703490,3014,50,"Roaming setting is set to true by default");""===r&&y.AFrameworkApplication.J&&(!A||appChrome.api.isSmallDevice()||appChrome.api.isVerySmallDevice()?r=y.AFrameworkApplication.J.rb("RulerDefaultOn"):
(r="true",v.ULS.sendTraceTag(508703489,3014,50,"Enabling Ruler by default for undefined roaming setting for large screens")));this.KRc="true"===r.toLowerCase();v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully.")}return this.KRc};this.Hx=b;this.OM=h}OPm(){const b=new zg.a;if(null==this.KRc){if(this.Y6i())return this.OM.yfb(Uw.a.Spd).CWRCo(this.yeb,0).CWRCo(this.UOa,8);b.setResult(!1)}else b.setResult(this.KRc);return b.task}E6(b){this.OM.E6(Uw.a.Spd,
new QB.a(Uw.a.Spd,b))}cPj(b){this.Y6i()&&(this.Hx.Mpa("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.E6(b)}Y6i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(u.a)(VF,"RulerSettingInfo",null,[450]);class zI{constructor(){this.msh=this.Z=null}get name(){return"WordEditor.Ruler"}Ec(b){this.Z=
b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.Z.ja("WordEditor.Ruler.RulerSettingInfo",()=>new VF(this.Z.resolve("Box4.IRoamingServiceRequestManager"),this.Z.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.Z.resolve("Box4.IFeatureHelper").Fs.continueWith(()=>{this.Sp()});this.msh=Gl.instance.initialize();v.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Sp(){this.msh.continueWith(()=>
{Gl.instance.XWi();Gl.instance.lDc();Gl.instance.dwp()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Gl.instance.W0();v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(u.a)(zI,"PackageManager",null,[0,1]);var Vw=e(2114);class WF{}WF.Fh="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(WF,"InsertMediaM365DialogHtml",null,[]);class Du{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd){this.UO=Jd;this.Hjb=null;this.m1f=this.KId=!1;this.F_j=ie=>{if(ie.rawEvent&&(ie=ie.rawEvent.data))try{const re=Sys.Serialization.JavaScriptSerializer.deserialize(ie,!0),me=re.MessageId?re.MessageId.toString():null;re&&me&&(me===J.a.mpc||me===J.a.aZf)&&this.FPc.start(me===J.a.mpc?this.mlb:this.ysh)}catch(re){}};this.iEp=(ie,re,me,Sd,cf)=>{if(1===me)return 32;this.ovh?ie=CommonUIStrings.l_OneDriveName:
""!==this.hGd?ie=this.hGd:(ie=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));cf[vk.a.LabelText]=ie;return 32};this.lEp=(ie,re,me,Sd,cf)=>{if(1===me)return 32;if(!y.AFrameworkApplication.g2f())return cf[vk.a.Visible]=!1,32;this.ovh?ie=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.hGd?ie=String.format(CommonUIStrings.l_ChangePictureFromHost,this.hGd):
(ie=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));cf[vk.a.LabelText]=ie;return 32};this.jEp=(ie,re,me,Sd,cf)=>{if(1===me)return 32;y.AFrameworkApplication.J.$("InsertOnlinePictureEnabled")||(cf[vk.a.Visible]=!1);return 32};this.kEp=(ie,re,me,Sd,cf)=>{if(1===me)return 32;y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled")||(cf[vk.a.Visible]=
!1);return 32};this.gDe=(ie,re,me)=>{re=this.OLc.value.kma(re);if(1===me)return re&&this.llb.Rsn?32:8;if(2!==me||!re)return 8;this.Hjb=qb.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");ie=this.uDm(ie,this.Hjb);ie=this.Ihf(ie);ie=this.$Gd.t6c(ie);ie.correlationId=this.Hjb;ie.tZf=this.zsh;ie.mwa=1;return this.eDe(ie,CommonUIStrings.L_PictureInsertTitle,this.mlb)};this.Jep=(ie,re,me)=>{ie=32===this.ga.Sf(re,fb.a.PT,1,!1,null,null);if(1===
me)return ie&&this.llb.z3i?32:8;if(2!==me||!ie)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.eDe(this.xsh.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.ysh)};this.s_j=(ie,re,me)=>{ie=this.OLc.value.kma(re);if(1===me)return ie&&this.llb.f2f?32:8;if(2!==me||!ie)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.eDe(this.xsh.getInstance(),
CommonUIStrings.L_PictureInsertTitle,this.mlb)};this.cDe=(ie,re,me)=>{re=this.OLc.value.kma(re);if(1===me)return re&&this.llb.Tsn?32:8;if(2!==me||!re)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.Hjb=qb.a.create();me=y.AFrameworkApplication.J.$("StockImagesFreemiumExperienceIsEnabled")&&this.yM.isFreemiumUpsellEnabled();me=this.KId?1:me?0:-1;ie=this.cGm(ie,this.Hjb,me);ie=this.$Gd.t6c(ie);ie.Fh=WF.Fh;ie.correlationId=this.Hjb;
ie.mwa=2;ie.tZf=this.zsh;ie.QVa=this.yM;ie.userLicenseType=me;return this.eDe(ie,CommonUIStrings.L_PictureInsertTitle,this.mlb)};this.hDe=(ie,re,me)=>{re=this.OLc.value.kma(re);ie=Xa.a.instance.Wa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===me)return re&&!this.llb.f2f&&ie&&ie.s4f()&&!y.AFrameworkApplication.kdd?32:8;if(2!==me||!re||!ie)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.Hjb=qb.a.create();me=Du.wPh;re=
!1;y.AFrameworkApplication.h2f()&&(re=this.mmm());const Sd=new Vw.a;Sd.rfc=re;Sd.Yoc=!0;me=ie.$0d(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,me,"Insert Media",1,Sd);ie.P5c(me).then(cf=>{if(null!=cf&&0<cf.length){const sf=[];for(let yh=0;yh<cf.length;yh++){const si=cf[yh][G.a.Tyj],cl=cf[yh][G.a.Pyj],Pj={};Pj.Extension=si;Pj.OriginalUrl=cl;Pj.caption=si;sf.push(Pj)}this.mlb.hZa=fb.a.o8;this.mlb.dcb(sf)}});return 32};this.fDe=(ie,re,me)=>{var Sd=this.OLc.value.kma(re);re=Xa.a.instance.Wa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===me)return Sd&&re&&re.s4f()?32:8;if(2!==me||!Sd||!re)return 8;me=Xa.a.instance.Wa("Common.App.PhoneLink.IPhoneLinkManager");null!=me&&me.ccm(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.Hjb=qb.a.create();me=Du.wPh;Sd=new Vw.a;Sd.rfc=!0;Sd.Yoc=!0;me=re.$0d(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,
!0,!1,!0,me,"InsertPictureFromMobile",3,Sd);re.P5c(me).then(cf=>{if(null!=cf&&0<cf.length){var sf=[];const yh=ie===fb.a.yfe;let si=!1;const cl=y.AFrameworkApplication.J.rb("PhoneLinkServiceEndpoint");for(let Pj=0;Pj<cf.length;Pj++){const cn=cf[Pj][G.a.Tyj],Mu=cf[Pj][G.a.Pyj],dv={};dv.Extension=cn;dv.OriginalUrl=Mu;dv.caption=cn;sf.push(dv);si||(si=-1!==dv.OriginalUrl.indexOf(cl))}this.mlb.hZa=fb.a.o8;this.mlb.dcb(sf);sf={};sf.InsertImageCount=cf.length;si&&$d.c(yh?fb.a.thn:fb.a.eul,void 0,void 0,
void 0,void 0,void 0,sf)}});return 32};this.FPc=A;this.KLd=L;this.$Gd=ra;this.xsh=Ia;this.B7=Ta;this.ga=b;this.OLc=ba;this.ovh=bc;this.hGd=Yc;this.llb=r;this.mlb=ob;this.ysh=nb;this.zsh=zd;(this.yM=Eb)&&this.yM.isFeatureEnabled("MsoPremiumStockImages",!1).catch(ie=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",ie)).then(ie=>{(this.KId=ie)||this.yM.dxa("MsoPremiumStockImages",()=>{this.KId=!0;v.ULS.sendTraceTag(577249667,
352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}mc(){(this.llb.f2f||this.llb.z3i)&&this.llb.Ssn&&this.Omo();this.DCo();this.CCo();this.ga.nb(fb.a.G5h,ic.a.view,this.s_j,1284);this.ga.nb(fb.a.LCj,ic.a.view,this.lEp,1124);this.ga.nb(fb.a.nZf,ic.a.view,this.s_j,1284);this.ga.nb(fb.a.csg,ic.a.view,this.iEp,1124);this.ga.nb(fb.a.Dhn,ic.a.view,this.Jep,1284)}DCo(){this.ga.nb(fb.a.insertOnlinePicture,ic.a.view,this.gDe,1284);this.ga.nb(fb.a.vfe,ic.a.view,this.cDe,
1284);this.ga.Y5("word_insertOnlinePictures",!0,fb.a.insertOnlinePicture,ic.a.view,this.gDe,b=>{Db.StaticActiveAppFrame.Aa().W4b(b,Object(E.a)(new Zn.a,(new Zn.a).etb,"getCommandById"))});this.ga.Y5("word_insertOnlinePictures",!0,fb.a.vfe,ic.a.view,this.cDe,b=>{Db.StaticActiveAppFrame.Aa().W4b(b,Object(E.a)(new Zn.a,(new Zn.a).etb,"getCommandById"))});this.ga.nb(fb.a.drf,ic.a.view,this.gDe,1284);this.ga.nb(fb.a.frf,ic.a.view,this.hDe,1284);this.ga.Y5("word_insertOnlinePictures",!0,fb.a.frf,ic.a.view,
this.hDe);this.ga.nb(fb.a.grf,ic.a.view,this.cDe,1284);this.ga.nb(fb.a.JCj,ic.a.view,this.jEp,1284);this.ga.nb(fb.a.KCj,ic.a.view,this.kEp,1284);this.ga.Y5("word_insertOnlinePictures",!0,fb.a.drf,ic.a.view,this.gDe);this.ga.Y5("word_insertOnlinePictures",!0,fb.a.grf,ic.a.view,this.cDe);this.ga.nb(fb.a.pZf,ic.a.view,this.hDe,1284);this.ga.Y5("word_insertOnlinePictures",!0,fb.a.pZf,ic.a.view,this.hDe,b=>{Db.StaticActiveAppFrame.Aa().W4b(b,Object(E.a)(new Zn.a,(new Zn.a).etb,"getCommandById"))})}CCo(){y.AFrameworkApplication.h2f()&&
(this.ga.nb(fb.a.yfe,ic.a.view,this.fDe,1284),this.ga.nb(fb.a.erf,ic.a.view,this.fDe,1284),this.ga.Y5("mso_insertMobileDevicePictures",!0,fb.a.yfe,ic.a.view,this.fDe,b=>{Db.StaticActiveAppFrame.Aa().W4b(b,Object(E.a)(new Zn.a,(new Zn.a).etb,"getCommandById"))}),this.ga.Y5("mso_insertMobileDevicePictures",!0,fb.a.erf,ic.a.view,this.fDe,b=>{Db.StaticActiveAppFrame.Aa().W4b(b,Object(E.a)(new Zn.a,(new Zn.a).etb,"getCommandById"))}))}Omo(){y.AFrameworkApplication.ta.get_element().appendChild(this.KLd.T$a);
Re.a.addHandler(this.KLd.T$a.contentWindow,"message",this.F_j);this.m1f=!0}uDm(b,h){let r=0;y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb&&5===y.AFrameworkApplication.ta.Pb.gl&&(r=12);const A=Wg.a.Vg(y.AFrameworkApplication.lcid);return String.format(y.AFrameworkApplication.J.appSettings.WordInsertPictureServiceEndpoint,b===fb.a.insertOnlinePicture?1:0,y.AFrameworkApplication.lcid,A?A.name:"en-us",y.AFrameworkApplication.buildVersion,h,r,y.AFrameworkApplication.J.rb("UserId"))}eDe(b,h,
r){try{return b.dDe(h,r,void 0),v.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(A){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",A.toString()),this.Pq(Of.a.jhd,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}cGm(b,h,r){if(fb.a.vfe===b)return b=this.B7.L1h(y.AFrameworkApplication.J.rb("InsertOnlineM365PictureEndpoint"),h.toString(),
1,r),this.Ihf(b);b=this.B7.L1h(y.AFrameworkApplication.J.rb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.Ihf(b)}Pq(b,h,r){const A=new wg.StandardDialog(!0);A.hv=y.AFrameworkApplication.Uha;A.Md=0;A.Ue(1,CommonUIStrings.l_DialogClose);A.zA(b,h,r,()=>{})}mmm(){const b=Xa.a.instance.Wa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.Gqm():!1}dispose(){this.m1f&&this.KLd.T$a.contentWindow&&(Re.a.removeHandler(this.KLd.T$a.contentWindow,"message",this.F_j),this.m1f=!1)}Ihf(b){return this.UO&&
this.UO.UQ?(b=new Ua.QueryStringBuilder(b),b.Me("theme","4"),b.toString()):b}}Du.wPh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(Du,"InsertMediaActor",null,[11]);var Ux=e(990);class TB extends Ux.a{constructor(b,h){super(b,db.a.getOrigin(h))}Ht(b,h){this.isEnabled()&&this.Pla(this.phb)&&(this.$w(b),this.DG(b,h))}}Object(u.a)(TB,"InsertMediaCrossDocumentMessenger",Ux.a,[619,41,11]);class AI{getInstance(b,h){return new TB(b,h)}}Object(u.a)(AI,"InsertMediaCrossDocumentMessengerFactory",
null,[603]);var BI=e(796);class XF{}XF.Fh="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(u.a)(XF,"InsertMediaDialogHtml",null,[]);var UB;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(UB||(UB={}));Object(u.b)("HubbleAction",UB);var Vx;(function(b){b[b.unknown=0]="unknown";b[b.W0p=1]=
"bing";b[b.nWp=2]="M365";b[b.Sbq=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.$de=5]="hubble"})(Vx||(Vx={}));Object(u.b)("InsertMediaProviders",Vx);class VB extends Xf.a{constructor(b,h,r,A=null,L=!1){super(!1,!1,L);this.sB=null;this.aKc=!1;this.Mfd=this.y5=null;this.Npf="KeepFocusDiv";this.DXd="KeepFocusStartDiv";this.correlationId=null;this.mwa=0;this.QVa=this.tZf=null;this.userLicenseType=0;this.G2e=null;this.j6n=()=>{this.y5&&(this.y5.style.visibility="visible",window.setTimeout(()=>{if(this.nk){const ba=
this.nk.getElementById(this.DXd);ba&&ba.focus()}},0))};this.lia=ba=>{ba.keyCode===Sys.UI.Key.tab&&(ba.target.id!==this.Npf||ba.shiftKey?ba.target.id===this.DXd&&ba.shiftKey&&(ba.preventDefault(),this.nk.getElementById(this.Npf).focus()):(ba.preventDefault(),this.nk.getElementById(this.DXd).focus()))};this.cpj=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.cRb(this.S8a);this.AAb(1)};this.Tig=()=>{this.sB&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),
this.sB.sendMessage(J.a.kTj,{["CustomHeaders"]:""}))};this.Aqj=()=>{this.sB&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.sB.sendMessage(J.a.H5o,{["SessionId"]:y.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.zqj=()=>{this.sB&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.sB.sendMessage(J.a.EZo,{["CID"]:""}))};this.E6n=()=>{this.QVa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.QVa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.aHd=b;this.D8b="";this.B7=r;this.wAa=[];this.WMd=h;this.Fh=A||XF.Fh;this.$g="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async dDe(b,h){this.D8b=b;this.aKc=!1;this.showDialog(this.D8b,null);this.y5=this.gmc(this.Vj("insertmediaframe"));if(!this.y5)throw this.cRb(this.S8a),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.DXd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.y5.parentNode.insertBefore(b,this.y5.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.Npf);b.setAttribute("tabindex","0");this.y5.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.cAf,
"keydown",this.lia);this.y5.src=this.aHd;this.y5.style.width="100%";this.y5.style.height="100%";this.y5.frameBorder="0";y.AFrameworkApplication.J.$("ShowInsertMediaIframeWhenIframeIsReady")&&X.a.Hj?(this.y5.style.visibility="hidden",this.Mfd=this.j6n,Re.a.addHandler(this.y5,"load",this.Mfd)):this.y5.style.visibility="visible";this.gmc(this.Vj("WACDialogButtonPanel")).style.display="none";this.gmc(this.Vj("WACDialogTitleText")).style.display="none";2===this.mwa&&(this.gmc(this.Vj("WACDialogTitlePanel")).style.display=
"none",this.gmc(this.Vj("WACDialogBodyPanel")).style.padding="0");Jc.FocusManager.instance().Cv().scope.LN=!0;this.sB=this.WMd.getInstance(this.y5.contentWindow,this.aHd);this.sB.Pla("https://osiziwuspersimmon002.blob.core.windows.net");this.sB.Pla("https://osizewuspersimmon001.blob.core.windows.net");this.sB.Pla("https://osizpscuspersimmon000.blob.core.windows.net");this.sB.Pla("https://cdn.hubblecontent.msit.osi.office.net");this.sB.Pla("https://cdn.hubblecontent.osi.office.net");this.sB.Ht(J.a.addItem,
r=>{this.poj(r,Object(E.a)(h,h.dcb,"insertMediaCallback"))});this.sB.Ht(J.a.insert,r=>{this.sqe(r,Object(E.a)(h,h.dcb,"insertMediaCallback"))});this.sB.Ht(J.a.jTh,r=>{this.Urj(r)});this.sB.Ht(J.a.KBi,this.Tig);this.sB.Ht(J.a.getSessionId,this.Aqj);this.sB.Ht(J.a.vzi,this.zqj);this.sB.Ht(J.a.aYd,this.cpj);2!==this.mwa||this.userLicenseType||(this.sB.Ht(J.a.DFn,this.E6n),this.G2e=this.QVa.dxa("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");
this.sB.sendMessage(J.a.kJp,{["LicenseTier"]:r.toString()})}));this.AAb(3)}dispose(){this.QVa&&this.G2e&&this.QVa.O0b("MsoPremiumStockImages",this.G2e);this.sB&&(this.sB.dispose(),this.sB=null);this.Mfd&&(Re.a.removeHandler(this.y5,"load",this.Mfd),this.Mfd=null);super.dispose()}poj(b,h){v.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.B7.Vgo(b))this.wAa.push(b),this.aKc&&(h(this.wAa),this.aKc=!1)}Pq(){const b=new wg.StandardDialog(!0);b.hv=y.AFrameworkApplication.Uha;b.Md=
0;b.Ue(1,CommonUIStrings.l_DialogOk);b.Yx(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}AAb(b){if(2===this.mwa){const r=y.AFrameworkApplication.J.rb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new ma.a,{name:"InsertedFiles",int64:this.wAa.length}));h.push(Object.assign(new ma.a,{name:"MediaDetails",string:JSON.stringify(this.wAa)}));h.push(Object.assign(new ma.a,{name:"DialogResult",string:UB[b]}));h.push(Object.assign(new ma.a,
{name:"DialogMode",string:this.cHi()}));h.push(Object.assign(new ma.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ma.a,{name:"Provider",string:Vx[this.mwa]||"Unknown"}));ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:h}))}}}cHi(){return 3===this.mwa?"Icons":5===this.mwa?"ExternalContent":"Images"}gmc(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",
b));return h}sqe(b,h){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.cRb(this.S8a);h?this.wAa&&50<this.wAa.length?(this.Pq(),this.AAb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.wAa.length,Vx[this.mwa])):this.wAa&&0<this.wAa.length?(h(this.wAa),this.AAb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.wAa.length,Vx[this.mwa])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),
this.aKc=!0,h(this.wAa),this.AAb(2)):this.AAb(2)}Urj(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ka.a.sendOtelEvent(Object.assign(new BI.a,{otelEvent:b})))}}Object(u.a)(VB,"InsertMediaDialog",Xf.a,[594,11]);class YK{constructor(b,h){this.eZe=b;this.B7=h}t6c(b,h=!1){return new VB(b,this.eZe,this.B7,XF.Fh,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(YK,"InsertMediaDialogFactory",
null,[593]);class CI{constructor(b,h,r){this.X_i=!1;this.correlationId=null;this.mwa=0;this.tZf=null;this.IEk=b;this.cUc=[];this.iGd=h;this.hMh=r.split(";")}async dDe(b,h){Array.clear(this.cUc);b=this.IEk.value;b.Pla(this.iGd);b.$w(h.r9c);this.X_i||(b.DG(h.r9c,r=>{this.sqe(r,h)}),this.X_i=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.Ggi,{["FileExtensionFilterList"]:this.hMh})}P5k(b){Array.contains(this.cUc,b)||
this.cUc.push(b)}sqe(b,h){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.zxj(b);const r=[];for(let A=0;A<b.length;A++){const L=b[A];h.she(L,this.hMh)?r.push(L):this.P5k(h.TKi(L))}r&&r.length?h.dcb(r):v.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.cUc.length&&(h=this.cUc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),
this.ogp(h))}ogp(b){const h=new wg.StandardDialog;h.Md=0;h.tU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(u.a)(CI,"InsertMediaFromHostManager",null,[594,11]);class ZK{constructor(b){this.OFk=b}t6c(){throw Error.notImplemented();}getInstance(){return this.OFk}}Object(u.a)(ZK,"InsertMediaFromHostManagerFactory",null,[592,593]);class Ct{constructor(){this.T$a=document.createElement("iframe");this.T$a.src="about:blank";
this.T$a.style.visibility="hidden";this.T$a.style.position="absolute";this.T$a.style.zIndex="-100"}}Object(u.a)(Ct,"InsertMediaFromHostOneDriveHostFrame",null,[591]);class Si extends Ux.a{constructor(b,h){super(b,"*"===h?h:db.a.getOrigin(h));this.URh(J.a.mpc);this.URh(J.a.aZf)}oye(){}}Object(u.a)(Si,"InsertMediaFromOneDriveCrossDocumentMessenger",Ux.a,[590,41,11]);class hz{}Object(u.a)(hz,"OnlineMediaSearchResult",null,[]);class oA{L1h(b,h,r,A){const L=Wg.a.Vg(y.AFrameworkApplication.lcid).name,ba=
y.AFrameworkApplication.buildVersion,ra=D.a.DV(y.AFrameworkApplication.J.rb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ia=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;y.AFrameworkApplication.ud("ShIns226;ShIns226cf");return String.format(b,y.AFrameworkApplication.lcid,L,ba,h,oA.rMe,ra,A,r,Ia)}return String.format(b,y.AFrameworkApplication.lcid,L,ba,h,oA.rMe,ra,A,r)}Vgo(b){if(!b||!b.Values)return null;b=b.Values;
if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new hz,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}Wgo(b){const h=[];if(!b||
!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let A=0;A<b.length;A++){var r=b[A];r&&(r=Object.assign(new hz,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}sng(b){const h=[];for(let A=0;A<b.data.files.length;A++){var r=b.data.files[A];r&&(r=Object.assign(new hz,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:
0}),h.push(r))}return h}she(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}Jmo(b){let h="";if(b)for(let r=0;r<b.length;r++){const A=b[r];A&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',A.OriginalUrl,A.Width,A.Height))}return h}}oA.rMe=0;Object(u.a)(oA,"InsertMediaHelper",null,[589]);class DI{constructor(b,h,r,A,L){this.Rsn=b;this.f2f=h;this.z3i=r;this.Ssn=A;this.Tsn=L}}Object(u.a)(DI,"InsertMediaSettingsManager",null,[]);
class YF{constructor(b){this.ZLc=fb.a.PT;this.ga=b}get hZa(){return this.ZLc}set hZa(b){this.ZLc=b}dcb(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Zb(this.hZa,2,b[h]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",
h.toString())}}}Object(u.a)(YF,"InsertOneDriveFileHandler",null,[453]);class Yu extends YF{constructor(b){super(b)}get Ggi(){return J.a.aZf}get r9c(){return J.a.Rgn}zxj(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}TKi(){Cd.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}she(){return!0}WBj(b,h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.r9c,r))}Cxj(b){const h=[];for(let r=0;r<b.data.files.length;r++){const A=
b.data.files[r];if(A){const L={};L.DisplayText=String.format("{0}{1}",A.name,A.extension);L.Url=this.jgm([A.urls.viewInBrowser,A.urls.open,A.urls.download]);h.push(L)}}return h}jgm(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(u.a)(Yu,"InsertOneDriveFileHelper",YF,[452,453]);class ZF{constructor(b,h,r,A){this.ap=A;this.ZLc=fb.a.o8;this.Tq=null;this.p8n=()=>{Oe.a.cX&&this.ap.gM([26],this.$d)};
this.ga=b;this.B7=h;this.Bla=r;Oe.a.cX&&(this.$d=ej.a.getInstance(ne.a),Tj.a.Aug(this.p8n))}get Tb(){return this.ga}get ry(){return this.Tq||(this.Tq=Xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get hZa(){return this.ZLc}set hZa(b){this.ZLc=b}dcb(b){try{Oe.a.cX&&this.ap.RW([26]);v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.B7.Jmo(b);let r=2;if(h&&0<h.length){const A=new Ai.DictionaryPropertySet;A.setValue(Pd.a.PZ,
h);A.setValue(Pd.a.$ha,!0);if(this.Bla){const L=this.Bla.Dtd();L.Gfc("insertOnlineImage");A.setValue(Pd.a.KBa,L)}r=this.ga.Zb(this.hZa,2,A)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){v.ULS.yA(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(u.a)(ZF,"InsertOnlineImageHandler",null,[453]);class OD extends ZF{constructor(b,
h,r,A=null){super(b,h,A,r)}get Ggi(){return J.a.mpc}get r9c(){return J.a.fhn}zxj(b){return this.B7.Wgo(b)}TKi(b){return b.Type}she(b,h){return this.B7.she(b.Type,h)}Cxj(b){return this.B7.sng(b)}WBj(b,h,r){r=r(b);if(r.length){b=[];for(let A=0;A<r.length;A++){const L=r[A],ba={};ba.Extension=L.Type;ba.SourceUrl=L.OriginalUrl;ba.caption=L.Type;ba.SourceUrl=L.OriginalUrl;ba.Width=L.Width;ba.Height=L.Height;b.push(ba)}r={};r.Items=b;h.sendMessage(this.r9c,r)}}}Object(u.a)(OD,"InsertOnlineImageHelper",ZF,
[452,453]);class Av{constructor(b,h){this.kGb=b;this.WMd=h}start(b){this.kGb.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.WMd.getInstance(window.frames[0].parent,window.document.URL),r.WBj(h,b,A=>r.Cxj(A))):v.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(u.a)(Av,"OneDriveFilePickerHelperV5",null,[454]);class EI{constructor(){this.ZGd=this.Z=null}get name(){return"Box4.Media"}Ec(b){this.Z=b;b.ja("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new Ct).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new DI(Boolean.parse(y.AFrameworkApplication.J.appSettings.InsertOnlinePictureEnabled||"false"),y.AFrameworkApplication.g2f(),
!1,y.AFrameworkApplication.rGg(),y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled"));b.ja("Box4.Media.OneDriveFilePickerHelperV5",()=>new Av(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();b.ja("Box4.Media.InsertMediaActor",()=>new Du(y.AFrameworkApplication.va,y.AFrameworkApplication.J,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new xe.a(()=>Xa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),y.AFrameworkApplication.wWb,y.AFrameworkApplication.awa,
y.AFrameworkApplication.j9m,y.AFrameworkApplication.J.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ja("Box4.Media.InsertMediaDialogFactory",()=>new YK(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ja("Box4.Media.InsertMediaFromHostManagerFactory",()=>new ZK(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();
b.ja("Box4.Media.InsertMediaFromHostManager",()=>new CI(new xe.a(()=>{if(y.AFrameworkApplication.rGg()){var r=Xa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").T$a;r=new Si(r.contentWindow,"*")}else r=y.AFrameworkApplication.L1;return r}),y.AFrameworkApplication.rGg()?db.a.getOrigin(window.document.URL):db.a.getOrigin(y.AFrameworkApplication.izb),y.AFrameworkApplication.J.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(AI,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();
b.register(oA,"Box4.Media.InsertMediaHelper").ha();b.ja("Box4.Media.InsertOnlineImageHelper",()=>new OD(y.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new Dj.b,b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ja("Box4.Media.InsertOneDriveFileHelper",()=>new Yu(y.AFrameworkApplication.va)).ha()}init(){this.ZGd=this.Z.resolve("Box4.Media.InsertMediaActor");this.ZGd.mc()}dispose(){this.ZGd&&this.ZGd.dispose()}}Object(u.a)(EI,"MediaPackage",null,[0,1]);var eM=e(999);class FI{get name(){return"Box4.PlaceholderText"}Ec(b){this.Z=
b;this.Z.ja("Box4.PlaceholderText.PlaceholderTextProvider",()=>new eM.a(Db.StaticActiveAppFrame.Aa().tb.Xc,this.Z.resolve("Box4.ObjectSpaceParagraphCollection"),this.Z.resolve("Box4.ITextRenderingStrategy"),this.Z.Za("Common.Interface.IEditNotificationManager"),Ze.a.wf.Um.Hf(12),this.Z.zf("Box4.IParagraphReader"))).ha()}init(){this.Z.resolve("Box4.PlaceholderText.PlaceholderTextProvider").init()}dispose(){}static main(){F.a.instance.Rc(new FI,4)}}Object(u.a)(FI,"PlaceholderTextPackage",null,[0,1]);
var fM=e(1851);class WB{constructor(b,h,r,A){this.$ac=b;this.ila=h;this.FHk=r;this.$s=A;this.esj=()=>{(y.AFrameworkApplication.$Jj||this.Thl())&&this.OHe()}}init(){WB.Uhl&&this.FHk&&this.h$()}h$(){this.ila.wv(this.esj)}OHe(){this.ila.VW(this.esj)}Thl(){var b;if(!this.$ac)return!1;const h=this.Oym();if(h){let r=h;if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))r=new fM.a(h,!0);if(32===y.AFrameworkApplication.va.Zb(wb.a.kxa,
2,r)&&this.$s)return this.$s.execute(A=>{A.logActivity("AutoRenameDocumentCallout",null);y.AFrameworkApplication.zc.pc(new Md.a(5,1,12E4,()=>{A.logActivity("AutoRenameSentimentSurvey",null)},0,"floodgateSurveyForAutoRenameSentiment"))}),$d.a("AutoRenameDocumentSuccess"),!0}return!1}Oym(){let b,h=this.$ac.Wkc();for(;h;){const r=h.node;if(0<rd.ParagraphReader.textLength(r,9)&&(b=wm.AParagraphNode.Pym(r.characterData.trim()),0<b.length))break;h=h.next}return b}static get Uhl(){var b;null===this.pOe&&
(this.pOe=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1));return this.pOe}}WB.pOe=null;Object(u.a)(WB,"AutoRenameExecutor",null,[]);class $F{Kun(b){var h;if(!y.AFrameworkApplication.VL)return!1;var r=y.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended;r=0<=(null===r||void 0===r?void 0:r.toLowerCase().indexOf("new"));return(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocumentFileNew",
!1))?(h=y.AFrameworkApplication.sessionStartInfoSettings.SessionOrigin,h=0<=(null===h||void 0===h?void 0:h.toLowerCase().indexOf("wacfilenew")),(r||h)&&this.$ad(b)):r&&this.$ad(b)}$ad(b){return b.value.ama(Db.StaticActiveAppFrame.Aa().tb.Xc.Fd)}get name(){return"Box4.AutoRename"}Ec(b){this.Z=b;this.Z.ja("Box4.AutoRename.AutoRenameExecutor",()=>new WB(this.Z.resolve("Box4.ObjectSpaceParagraphCollection"),Ze.a.wf.Um.Hf(12),this.Kun(this.Z.zf("Box4.IParagraphReader")),b.Za("Common.ISystemInitiatedFeedback"))).ha()}init(){this.Z.resolve("Box4.AutoRename.AutoRenameExecutor").init()}dispose(){}static main(){F.a.instance.Rc(new $F,
20)}}Object(u.a)($F,"AutoRenamePackage",null,[0,1]);var XB=e(359);class Zu{constructor(){this.UQo="getAddinShortcutsPreference";this.VQo="saveAddinShortcutsPreference";this.WQo="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Tmm=6E4;this.voe=this.Ota=this.sea=null}$Ki(b){return String.format(this.WQo,y.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",b,y.AFrameworkApplication.lm)}executeRequest(b,h,r,A,L=null){return Zu.HV.LMb(b,h,L,null,r,A,!1,null,this.Tmm)}saveSetting(b,
h,r,A,L){return this.dPj(b,h,r,null,A,L)}startBatchUpdateScope(){this.voe=[]}saveShortcutInfoArrayBatch(b,h,r){this.$So(r,b,h)}$So(b,h,r){const A={action:"",addinId:"",ownerType:0};A.timestamp=(new Date).toUTCString();const L=this.getShortcutInfoArray(h.toString(),r.toString());b?(A.shortcutInfoArray=b,this.Hhf(h,r,b)):L&&(A.shortcutInfoArray=L);b={};b[h.toString()]=A;h=new XB.a(r.toString(),b);this.voe.push(h)}commitBatchUpdateScope(){return this.Gsd()?this.bTo().then(()=>{this.xgc();return Promise.resolve(!0)}):
this.dTo().then(()=>{this.xgc();return Promise.resolve(!0)})}bTo(){return this.getSetting().then(b=>{let h=null;if(b&&!({Zv:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.voe){(b=h[r.key])||(b={});const A=r.value;for(const L of sb.a.zT(A))b[L]=A[L];h[r.key]=b}this.sea=h;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(h)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}dTo(){return this.lYo().then(b=>this.yze(b))}lYo(){return this.aRf().then(b=>{let h=null;b&&(({Zv:h}=H.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.voe){(b=h[r.key])||(b={});const A=r.value;for(const L of sb.a.zT(A))b[L]=A[L];h[r.key]=b}this.sea=h;return H.c(h)})}saveShortcutInfoArray(b,h,
r){return this.dPj(0,"","",r,b,h)}dPj(b,h,r,A,L,ba){const ra=this.Gsd(),Ia={};Ia.action=r;Ia.addinId=h;Ia.ownerType=b;Ia.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(L.toString(),ba.toString());0===b&&A?(Ia.shortcutInfoArray=A,this.Hhf(L,ba,A)):h&&(Ia.shortcutInfoArray=h);b={};b[L.toString()]=Ia;L=new XB.a(ba.toString(),b);return ra?this.aTo(L):this.cTo(L)}aTo(b){return this.getSetting().then(h=>{let r=null;if(h&&!({Zv:r}=H.d(h)).returnValue)return v.ULS.sendTraceTag(522739855,0,
10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.sea=r;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(r)),Promise.resolve(!0)}catch(A){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",A),Promise.resolve(!1)}})}cTo(b){return this.kYo(b).then(h=>this.yze(h))}kYo(b){return this.aRf().then(h=>{let r=null;h&&(({Zv:r}=H.d(h)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
r||(r={});r[b.key]=b.value;this.sea=r;return H.c(r)})}saveSettings(b){this.sea=H.a(b);this.xgc();return this.Gsd()?this.gPj(b):this.yze(b)}gPj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}yze(b){const h={};h.Wac=b;const r=H.c(h);return new Promise(A=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)A(!1);else{var L=this.executeRequest(this.$Ki(this.VQo),
2,"SaveAddinShortcutsPreferenceRequest","38",r);L.continueWith(()=>{if(L.mq||L.wj)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),A(!1);else{var ba=L.result;void 0!==ba.args&&null!==ba.args&&void 0!==ba.args.data&&null!==ba.args.data&&ba.args.data.Xe===pa.a.jB?A(!0):A(!1)}})}}catch(ba){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ba.toString()),A(!1)}})}getSetting(){const b=this.Gsd();return this.sea?Promise.resolve(H.c(this.sea)):
b?this.hRm():this.aRf()}Gsd(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser"),h=y.AFrameworkApplication.J.$("IsRoamingServiceEnabled");var r=y.AFrameworkApplication.J.rb("Puid");const A=y.AFrameworkApplication.J.rb("UserPrincipalName");r=!(void 0===r||null===r)&&!(void 0===A||null===A)&&0<r.length&&0<A.length;return b||!h||!r}hRm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",
b),Promise.resolve("")}}aRf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.$Ki(this.UQo),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.mq||r.wj)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let L="";var A=r.result;A&&A.args&&A.args.data?A.args.data.Xe!==pa.a.jB?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",A.args.data.Xe):A.args.data.responseData?(A=H.a(A.args.data.responseData),A.Wac&&(L=A.Wac)):
v.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(L)}})}catch(r){v.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.Gsd(),r=this;return this.getSetting().then(A=>{let L=null;A&&(L=H.a(A));if(!L)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ba of sb.a.zT(L)){A=L[ba.toString()];for(const ra of sb.a.zT(A)){const Ia=A[ra];if(Ia.addinId===b)delete A[ra.toString()];else if(0===Ia.ownerType&&Ia.shortcutInfoArray){const Ta=Ia.shortcutInfoArray,ob=new Cb.a;for(let nb=0;nb<Ta.length;++nb)Ta[nb].addinId!==b&&ob.add(Ta[nb]);Ia.shortcutInfoArray=ob.toArray()}}sb.a.count(A)||delete A[ba]}r.sea=L;r.aGo(b);return h?r.gPj(H.c(L)):r.yze(H.c(L))})}xgc(){if(this.sea){this.Ota=null;const r=this.sea;for(const A in r){var b=
A;const L=r[A];for(const ba in L){var h=ba;const ra=L[ba];ra.shortcutInfoArray&&this.Hhf(parseInt(h),parseInt(b),ra.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Zv:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.sea=h;this.xgc();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,
h,r){return this.sea&&(r=this.sea[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.sea&&(h=this.sea[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.xgc();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Ota)return Promise.resolve(!0);
var r=this.Ota[b];if(!r)return Promise.resolve(!0);var A=r[h];r=A.modifiers;A=A.keyCode;const L=this.getShortcutInfoArray(r.toString(),A.toString());if(!L||!L.length)return Promise.resolve(!0);let ba=0;for(const ra of L){if(ra.addinId===b&&ra.action===h)break;++ba}if(ba>=L.length)return Promise.resolve(!0);L.splice(ba,1);return this.saveShortcutInfoArray(r,A,L).then(()=>{this.xgc();return Promise.resolve(!0)})}Hhf(b,h,r){this.Ota||(this.Ota={});for(const A of r){r=A.addinId;const L=A.action;let ba=
this.Ota[r];ba||(ba={});const ra={};ra.modifiers=b;ra.keyCode=h;ba[L]=ra;this.Ota[r]=ba}}aGo(b){b in this.Ota&&delete this.Ota[b]}isActionCustomized(b,h){return this.Ota&&(b=this.Ota[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Ota&&(b=this.Ota[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.sea}static instance(){Zu.ckf||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Zu.ckf=new Zu,Zu.HV=y.AFrameworkApplication.pe);return Zu.ckf}}Zu.ckf=
null;Zu.HV=null;Object(u.a)(Zu,"AddinShortcutsPreferenceSettingHelper",null,[]);class GI{constructor(b,h){this.mCd=null;new Cb.a;this.uuh=!0;this.EFd=b;this.rph=h}bjf(b){this.rph.addHandler("GoalChangedEvent",b)}c_n(){this.rph.raiseEvent("GoalChangedEvent")}A0f(b,h){return this.mCd&&this.uuh?b in this.mCd?this.mCd[b]:"Formality"===h&&this.EFd.QQf().formality?!1:!0:!0}l_o(b,h){h===this.EFd.QQf().formality&&(this.mCd=b,this.c_n())}MEp(b){this.uuh=b}}Object(u.a)(GI,"GoalChangeSource",null,[612,613,614]);
var PD=e(1593),HI=e(1705),II=e(1420);class aG{constructor(b,h,r,A,L,ba){this.lTa=h;this.uIa=r;this.ff=b;this.WE=A;this.oh=L;this.ODk=ba;this.uIa.PVb()&&this.initialize()}initialize(){return this.WE.Km().then(()=>{this.ff.Cb(this,PD.a.getTypeName());this.ff.addHandler(this,HI.a.getTypeName())}).catch(b=>{this.oh.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}XI(b,h){if(h===ko.a.getTypeName()||h===II.a.getTypeName())if(!b||!b.content)this.oh.sendTraceTag(528274564,
2252,10,"Handled annotation is invalid");else if($a.a.getTypeNameFor(b.content)===PD.a.getTypeName()||$a.a.getTypeNameFor(b.content)===HI.a.getTypeName())if($a.a.getTypeNameFor(b.content)===PD.a.getTypeName()){var r=b.content;this.oh.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.lTa.l_o(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if($a.a.getTypeNameFor(b.content)===HI.a.getTypeName())if(b=
b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.ODk.MEp(!!r.supportType);return}this.oh.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.oh.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(u.a)(aG,"GoalsAnnotationHandler",null,[365]);class QD{constructor(b){this.za=b}PVb(){return this.za.$("EditorGoalsEnabled")}}Object(u.a)(QD,"GoalsGate",null,[609]);var $K=e(1158),RD=e(1165),pA=e(1530);
class Dt{}Dt.j2d=0;Dt.p2d="1.0";Dt.settingType="Goals";Object(u.a)(Dt,"GoalsConstants",null,[]);var Bv=e(1592);class JI{constructor(b,h,r,A,L){this.vbc=null;this.T2i=!1;this.REh=b;this.GFd=h;this.oh=r;this.uIa=A;this.MWe=L;this.uIa.PVb()?this.bwo():this.uIa.PVb()&&this.DBg(Dt.j2d,Dt.p2d)}bwo(){new Promise(b=>{this.REh.pJi(Dt.settingType,h=>{this.cwo(h)?(this.DBg(this.vbc.formality,this.vbc.version),b(this.vbc)):(this.DBg(Dt.j2d,Dt.p2d),b(null))})})}cwo(b){this.T2i=!0;if(!b||!b.fBb)return this.oh.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;b=b.fBb.properties;var h=b.getValue(Rc.a.vYi);h=parseInt(h);b=b.getValue(Rc.a.wYi);if(!this.GFd.vRg(b))return this.oh.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.vbc=b=Object.assign(new Bv.a,{formality:h,version:b});this.oh.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}DBg(b,h){b=Object.assign(new pA.a,
{formality:b,version:h});this.MWe.HRj(b)}uSp(b){if(this.GFd.vRg(b.version)){var h=$K.a.vMl(b.version,b.formality.toString());this.REh.oTh(Object.assign(new RD.a,{fBb:h,settingType:Dt.settingType}))?this.vbc=b:this.oh.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.oh.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}ZFi(){this.T2i||this.oh.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");
return this.vbc}}Object(u.a)(JI,"GoalsPersistenceHandler",null,[608]);class Zl{constructor(b,h,r,A){this.oh=b;this.NWe=h;this.GFd=r;this.uIa=A;this.FFd=Object.assign(new Bv.a,{formality:Dt.j2d,version:Dt.p2d});this.Haf=this.uIa.PVb()}QQf(){this.Haf&&(this.Haf=!1,this.NWe.ZFi()&&(this.FFd=this.NWe.ZFi()));return this.FFd}p5o(b){this.Haf=!1;this.GFd.vRg(b.version)?(this.uIa.PVb()&&this.NWe.uSp(b),this.FFd=b):(this.oh.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",
b.version),this.FFd=Object.assign(new Bv.a,{formality:Dt.j2d,version:Dt.p2d}))}}Object(u.a)(Zl,"GoalsProvider",null,[422,423]);class bG{constructor(b,h,r,A){this.ff=b;this.WE=h;this.A_=r;this.oh=A}HRj(b){b=Object.assign(new ko.a,{parentPath:["Signal",pA.a.getTypeName()],items:[Object.assign(new La.a,{body:b})]});this.K4d(b)}K4d(b){this.WE.Km().then(()=>{this.ahf(b)}).catch(h=>{this.oh.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}ahf(b){this.ff.activateAnnotation(PD.a.getTypeName(),
bG.vfc).then(()=>{this.A_.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jb.a,{operation:b}))}).catch(h=>{this.oh.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}bG.vfc="GoalSelected";Object(u.a)(bG,"GoalsSignalSender",null,[421]);class qA{constructor(){qA.Fff=new RegExp(qA.xYk)}vRg(b){return!!b.match(qA.Fff)&&1===b.match(qA.Fff).length}}qA.xYk="[0-9]+[.]?[0-9]*";qA.Fff=null;Object(u.a)(qA,"GoalsValidator",null,[420]);class bs{constructor(){this.Z=
null}get name(){return"WordEditor.Goals"}init(){this.Z.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}Ec(b){this.Z=b;this.Z.ja("WordEditor.Goals.GoalsValidator",()=>new qA).as("WordEditor.Goals.IGoalsValidator").ha();this.Z.ja("WordEditor.Goals.IGoalsGate",()=>new QD(this.Z.resolve("Common.IAppSettingsManager"))).ha();this.Z.ja("WordEditor.Goals.GoalsProvider",()=>new Zl(this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),
this.Z.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();this.Z.ja("WordEditor.Goals.GoalChangeSource",()=>new GI(this.Z.resolve("WordEditor.Goals.IGoalReader"),new Nf.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.Z.ja("WordEditor.Goals.GoalsPersistenceHandler",()=>new JI(this.Z.resolve("Box4.PersistenceSettingsManager"),this.Z.resolve("WordEditor.Goals.IGoalsValidator"),
this.Z.resolve("Common.IUlsWrapper"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.Z.ja("WordEditor.Goals.GoalsAnnotationHandler",()=>new aG(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.resolve("WordEditor.Goals.IGoalsGate"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Common.IUlsWrapper"),
this.Z.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();this.Z.ja("WordEditor.Goals.GoalsSignalSender",()=>new bG(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.Z.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.Z.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){F.a.instance.Rc(new bs)}}Object(u.a)(bs,"WordEditorGoalsPackage",
null,[0,1]);var YB=e(1840),Zt=e(640),SD=e(1441);class KI{constructor(){this.annotation=null;this.languages=new bk.a(Ea.a.Oh())}}Object(u.a)(KI,"CritiqueCountWrapper",null,[]);class sw{constructor(){this.eza=new kb.a}e9d(){return this.eza}PVi(b,h,r,A){if(this.eza.Bb(r)){this.eza.K(r).annotation.count+=h;r=this.eza.K(r).languages;for(var L of A)r.add(L)}else L=V.a.create().toString(),b=Object.assign(new SD.a,{id:L,categoryName:b,count:h}),this.eza.add(r,Object.assign(new KI,{annotation:b,languages:A}))}}
sw.Gj=389;Object(u.a)(sw,"BaseCritiquesByTypeCounter",null,[404]);class LI extends sw{constructor(b){super();this.hKb=new Ka.a;this.ERe=new Ka.a;this.iTd=b}R_m(b){const h=b.annotation;try{if(h&&Zt.a($a.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===ko.a.getTypeName()){this.iTd.oIo(h.parentPath,r);const A=r.M_.state;if(60!==A&&70!==A)return this.hKb.contains(h.id)&&this.hKb.remove(h.id),this.ibn(h.id,r),YB.a.QBb(h,8),!0;this.hKb.add(h.id)}else if(b.opType===Xv.a.getTypeName())if(this.hKb.contains(h.id))this.hKb.remove(h.id);
else if(this.Phi(r.typeId,h.id))return YB.a.QBb(h,16),!0}}catch(r){YB.a.kfd(r,[h],!0)}return!1}Q_m(b){if((b=b.annotation)&&Zt.a($a.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.hKb.contains(b.id))return this.hKb.add(b.id),this.Phi(h.typeId,b.id)}return!1}ibn(b,h){this.ERe.add(b);b=new bk.a(Ea.a.Oh());h.language&&b.add(h.language);this.PVi(h.categoryName,1,h.typeId,b)}Phi(b,h){if(!this.ERe.contains(h))return!1;if(!this.eza.Bb(b))return v.ULS.sendTraceTag(589866503,
sw.Gj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.eza.K(b).annotation.count)return v.ULS.sendTraceTag(589866504,sw.Gj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.ERe.remove(h);this.eza.K(b).annotation.count--;return!0}}Object(u.a)(LI,"AlCritiquesByTypeCounter",sw,[644,404]);var gM=e(1654);class ZB extends at.a{constructor(b,
h,r,A,L,ba,ra,Ia,Ta){var ob;super();this.ff=b;this.iTd=h;this.yNe=r;this.lkh=A;this.lTa=L;this.jAa=ba;this.Tk=ra;this.Afa=this.Cih=!1;this.X4e=new kb.a;this.E4n=(nb,Eb)=>{this.iTd.R0m(Eb)&&(this.Afa=!0,this.t2())};this.E1n=(nb,Eb)=>{this.yNe.R_m(Eb)&&this.Q1b()};this.Ppj=()=>{this.Q1b()};this.nhg=(nb,Eb)=>{this.yNe.Q_m(Eb)&&this.Q1b()};this.uyb=()=>{this.Q1b()};this.Q1b=()=>{let nb=!1;this.Tk.Ae(()=>{var Eb=this.Mum();const bc=new Cb.a;for(const Bc of Eb)Eb=Object.assign(new gM.a,{id:Bc.id,parentPath:eq.a.qQb,
content:Bc,annotationType:$a.a.getTypeNameFor(Bc)}),bc.add(Eb),nb||(nb=0<Bc.count);this.ff.k_o(bc)},"CC:SATH");!this.Cih&&nb&&(ka.a.sendTelemetryEvent({...(new ja.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.Cih=!0)};this.qon=(nb,Eb,bc)=>{const Bc=!this.lTa||this.lTa.A0f(nb,bc);nb=this.jAa&&this.jAa.instance?this.jAa.instance.z0f(nb,bc,Eb.substr(1,Eb.length-2)):!0;return Bc&&nb};null===Ia||void 0===Ia?void 0:Ia.bjf(this.uyb);Ta.Cxa(this,7);null===(ob=this.jAa)||void 0===ob?void 0:
ob.execute(nb=>{nb.Ajf(this.Q1b)})}get index(){return 3}run(){this.Afa&&(this.Q1b(),this.Afa=!1)}ysj(){this.Q1b()}bJl(b){let h=0;if(({value:h}=this.X4e.Nc(b.categoryName,0)).returnValue)if(h!==b.count)this.X4e.W(b.categoryName,b.count);else return!1;else this.X4e.add(b.categoryName,b.count);return!0}Mum(){const b=new kb.a;var h=this.iTd.e9d();const r=this.yNe.e9d();this.jPg(b,h);this.jPg(b,r);this.lkh&&(h=this.lkh.e9d(),this.jPg(b,h));h=new Cb.a;for(const A of b.values)this.bJl(A)&&h.add(A);return h}jPg(b,
h){for(const L of h){h=L.value.annotation;const ba=L.key;var r=this.jYo(L.value.languages);if(!b.Bb(h.categoryName)){var A=V.a.create().toString();A=Object.assign(new SD.a,{id:A,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,A)}this.qon(ba,r,h.categoryName)&&(r=b.K(h.categoryName),r.count+=h.count,r.countsByTypeId[ba]=(r.countsByTypeId[ba]?r.countsByTypeId[ba]:0)+h.count)}}jYo(b){const h=[];let r=0;for(const A of b)h[r++]=A;return H.c(h)}}Object(u.a)(ZB,"CritiquesCounter",
at.a,[642,643]);class iz{constructor(b){this.i7=b}e9d(){const b=new kb.a,h=new bk.a(Ea.a.Oh()),r=Object.assign(new SD.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.i7.bIc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new KI,{annotation:r,languages:h}));return b}}Object(u.a)(iz,"DictationCritiquesByTypeCounter",null,[641,404]);class cG extends sw{constructor(b){super();this.ojb=new kb.a;this.ff=b}R0m(b){const h=eq.a.wae(b.nodeId);if(!eq.a.jg(h)){if(b.Urb&&
b.Urb.length){let r=null;for(const A of b.Urb)A.errorDetails.Icb()||(b=this.yBi(A),eq.a.jg(b)||(r||(r=new kb.a),r.Bb(b)||r.add(b,new Cb.a),r.K(b).add(A)));this.Qhi(h);r?this.o3o(h,r):this.ojb.remove(h)}else{if(!this.ojb.Bb(h))return!1;this.Qhi(h);this.ojb.remove(h)}return!0}return!1}oIo(b,h){var r;if(({value:r}=this.ojb.Nc(b,r)).returnValue)for(const L of r)if(b=L.value,0<b.count&&this.JLf(b.K(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var A=b.K(r).end-b.K(r).Mc;b.K(r).Mc===h.range.start&&A===
h.range.length&&(A=this.yBi(b.K(r)),this.eza.Bb(A)&&(A=this.eza.K(A).annotation,A.count=Math.max(0,A.count-1)),b.removeAt(r))}}Qhi(b){if(this.ojb.Bb(b))for(const r of this.ojb.K(b)){var h=r.key;b=r.value;this.eza.Bb(h)&&(h=this.eza.K(h).annotation,h.count=Math.max(0,h.count-b.count))}}o3o(b,h){const r=new kb.a,A=new kb.a;for(const L of h){h=L.key;A.add(h,new bk.a(Ea.a.Oh()));for(const ba of L.value){const ra=ba.end-ba.Mc,Ia=this.JLf(ba);this.hvl(b,Ia,ba.Mc,ra)?v.ULS.sendTraceTag(589866513,sw.Gj,50,
"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ba.Mc,ra):(r.Bb(h)||r.add(h,new Cb.a),r.K(h).add(ba),A.K(h).add(this.Oum(ba)))}}this.ojb.W(b,r);for(const L of this.ojb.K(b))0<L.value.count&&(b=this.JLf(L.value.K(0)),this.PVi(b,L.value.count,L.key,A.K(L.key)))}yBi(b){let h=null;b&&(b=Object(ya.a)(402,b.errorDetails))&&b.Yv&&(h=b.Yv.TypeId);return h}JLf(b){let h=null;b&&(b=Object(ya.a)(402,b.errorDetails))&&b.Yv&&(h=b.Yv.CategoryTitle);
return h}Oum(b){let h="";b&&b.errorDetails&&(h=Wg.a.Vg(b.errorDetails.lcid).name);return h}hvl(b,h,r,A){if((b=this.ff.i8d(b))&&0<b.count)for(const L of b)if(b=$a.a.getTypeNameFor(L.content),L&&Zt.a(b)&&(b=L.content,b.categoryName===h&&b.range.start===r&&b.range.length===A))return!0;return!1}}Object(u.a)(cG,"WacCritiquesByTypeCounter",sw,[403,404]);class jz{constructor(){this.Z=null}get name(){return"WordEditor.CritiqueCounts"}Ec(b){this.Z=b}init(){var b=this.Z.resolve("Common.IAppSettingsManager");
if(b.$("AugLoopOperationsAreEnabled")){this.Z.ja("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new cG(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.Z.ja("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new LI(this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.Z.ja("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",
()=>new iz(this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.Z.ja("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new ZB(this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.Z.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.Z.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.Z.Wa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.Z.Wa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.Z.Za("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
mp.a.instance,this.Z.Wa("WordEditor.Goals.IGoalChangeSource"),this.Z.resolve("Box4.Graph.IGraphTransactionManager"))).ha();b=this.Z.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.Z.resolve("Box4.Proofing.IErrorRangeEditor").VUh(b.E4n);this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").GUh(b.E1n);this.Z.resolve("Box4.AugmentationLoop.IAnnotationStorage").FUh(b.nhg);h&&(h=this.Z.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.rUh(b.Ppj),h.sUh(b.Ppj))}}dispose(){}static main(){F.a.instance.Rc(new jz)}}
Object(u.a)(jz,"WordEditorCritiqueCountsPackage",null,[0,1]);class dG{get name(){return"WordEditor.GraphicsEditor"}Ec(){}init(){}dispose(){}static main(){F.a.instance.Rc(new dG)}}Object(u.a)(dG,"PackageManager",null,[0,1]);var UM=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]},kz=e(327);class eG{constructor(b){this.sAk={};this.oc=b;this.qKb=new de.a}wXa(b,h){const r=this.oc.nzb,A=parseInt(b);return b&&A!==qf.ActionManager.bDf?this.qKb.Bb(r)?(b=this.qKb.K(r).Xnc(A,
h,2),32===b||1===b):!1:!1}$Na(b){const h=parseInt(b),r=this.oc.nzb;return b&&h!==qf.ActionManager.bDf?this.qKb.Bb(r)?32===this.qKb.K(r).Xnc(h,this.sAk,1):!1:!0}ZGj(b,h){this.qKb.W(b,h)}qYj(b){b=parseInt(b);const h=this.oc.nzb;return!!h&&!!this.qKb.K(h)&&this.qKb.K(h).unn(b)}}Object(u.a)(eG,"NonCanvasCuiUser",null,[1803,184]);var Cv=e(1186),Et;(function(b){b[b.UYp=0]="UnspecifiedGallery";b[b.PTp=1]="CharacterCodeGallery";b[b.sVp=2]="FontStyleGallery";b[b.TVp=3]="InkThicknessGallery";b[b.PVp=4]="IconGallery";
b[b.iWp=5]="ListGallery";b[b.sYp=6]="TableStyleGallery";b[b.dXp=7]="PageNumberGallery";b[b.OTp=8]="ChangeColorsGallery"})(Et||(Et={}));Object(u.b)("GalleryType",Et);class Ir{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(u.a)(Ir,"CommonGalleryButtonProps",null,[]);class Wx extends Ir{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(u.a)(Wx,"AdditionalTableStyleGalleryButtonProps",Ir,[]);class rA extends Wx{constructor(){super()}}Object(u.a)(rA,
"AdditionalChangeColorsGalleryButtonProps",Wx,[]);class Xx extends Ir{constructor(){super();this.character=null}}Object(u.a)(Xx,"AdditionalCharacterCodeGalleryButtonProps",Ir,[]);class Ep extends Ir{constructor(){super();this.menuModel=this.previewStyleFontNameAndSize=this.previewStyleLabel=this.styleDisplayName=null}}Object(u.a)(Ep,"AdditionalFontStyleGalleryButtonProps",Ir,[]);class MI{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=
null;this.galleryType="TableStyleGallery"}}Object(u.a)(MI,"AdditionalGalleryProperties",null,[]);class Ft extends Ir{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(u.a)(Ft,"AdditionalIconButtonProperties",Ir,[]);class NI extends Ir{constructor(){super();this.styleDisplayName=null}}Object(u.a)(NI,"AdditionalInkThicknessGalleryButtonProps",Ir,[]);class sA extends Ir{constructor(){super();
this.ariaLabel=this.infoAtLevel=null}}Object(u.a)(sA,"AdditionalListGallerButtonProps",Ir,[]);class OI extends Ir{constructor(){super();this.text=null}}Object(u.a)(OI,"AdditionalPageNumberGalleryButtonProps",Ir,[]);var tA=e(1113);const PI=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(ya.a)(Object,r[b])){if((b=Object(ya.a)(String,r.value))&&b===h)return!1;b=Object(ya.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let A=null;for(let L=
0;L<r.length;L++){const ba=Object(ya.a)(Object,r[L]);if(Object(ya.a)(String,ba.key)===b){A=ba;break}}if(A&&Object(ya.a)(String,A.text)===h)return!1}}return!0},aL=(b,h,r,A)=>{if(0<(A&2)){A=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":A.push(uA(b,r[bg.a.On]));break;case "CheckboxModel":A.push(appChrome.actions.toggleCheckbox(b,r[bg.a.On]));break;case "ComboBoxModel":if(!PI(b,r[$c.a.Value]))break;(h=r[$c.a.Key])?A.push(appChrome.actions.updateComboBoxKey(b,h,r[$c.a.Value])):A.push(appChrome.actions.updateComboBoxValue(b,
r[$c.a.Value]));break;case "FontPickerModel":A.push(appChrome.actions.updateFontPickerSelectedFont(b,r[tA.a.SelectedFont]));break;case "SplitButtonModel":A.push(uA(b,r[El.a.On]));break;case "SpinButtonModel":A.push(appChrome.actions.updateSpinButton(b,r[vi.a.Number],fg.a.H9a(r[vi.a.UnitType]),r[vi.a.Text],r[vi.a.MaxValue],r[vi.a.Alt]));break;case "ColorPickerModel":A.push(appChrome.actions.updateColorPickerSelectedColor(b,r[Ol.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":A.push(appChrome.actions.updatePageNumberGalleryButtonText(b,
r[Pf.a.Text]));break;case "CompoundButtonModel":r[bg.a.Description]&&A.push(appChrome.actions.updateCompoundButtonDescription(b,r[bg.a.Description]));bg.a.On in r&&A.push(uA(b,r[bg.a.On]));break;case "SliderModel":r.snapToStep?A.push(appChrome.actions.updateSliderSelectedValue(b,r[vl.Value])):A.push(appChrome.actions.updateSliderValue(b,r[vl.Value],r[vl.MinValue]||0,r[vl.MaxValue],r[vl.Text]));break;case "FlyoutAnchorModel":Ue.a.ImageIsVisible in r&&A.push(appChrome.actions.hideFlyoutAnchorIcon(b,
!r[Ue.a.ImageIsVisible]));bg.a.On in r&&A.push(uA(b,r[bg.a.On]));break;case "InputBoxModel":A.push(appChrome.actions.updateInputBoxValue(b,r[Nk.a.Text]))}h=A;var L=Object(ya.a)(String,r[xj.a.iconColor]);void 0!==L&&null!==L&&h.push(appChrome.actions.updateIconColor(b,L));TD(b,r,A);h=A;(L=Object(ya.a)(Object,r[xj.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,L));h=A;L=Object(ya.a)(String,r[xj.a.customTooltip]);void 0!==L&&null!==L&&h.push(appChrome.actions.setControlCustomTooltip(b,L));
b=A;(r=Array.isArray(r[xj.a.bug])?r[xj.a.bug]:null)&&b.push.apply(b,r);return A}return null},Gt=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),uA=(b,h)=>appChrome.actions.toggleButton(b,h),TD=(b,h,r)=>{h=Object(ya.a)(String,h[xj.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,h))};class fG{constructor(b,h,r,A){this.hm=A;this.rAa=b;this.vD=h;this.lcc=r;this.YMc={}}Eko(b,h,r,A,L=null){const ba=b.ExternalGalleryId||b.ExternalId;var ra=b.ExternalId;A.push(ba);
if(appChrome.selectors.isControlDefined(ba))b.GalleryStyle&&mh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ba,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ba,Object.assign(new MI,{columns:b.Width,sections:[appChrome.api.gallerySection([],ra)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}r=0;if(mh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ra=[];A=[];const Ta=[],ob={};for(var Ia of b.GallerySections){ra.push(appChrome.api.gallerySection([],
Ia.SectionId,Ia.Title));0===r&&Ia.GalleryButtons&&0<Ia.GalleryButtons.length&&(r=Ia.GalleryButtons[0].Type);this.JJi(Ia.GalleryButtons,L,ob);const nb=this.Shf(A,Ia.GalleryButtons,ob);A.push.apply(A,this.UPf(nb,ba,Ia.SectionId,!1,r,L,!0,ob));Ta.push.apply(Ta,nb)}h.push(appChrome.actions.setGallerySections(ba,ra));h.push.apply(h,A);h.push.apply(h,this.pNf(ba,Et[r],Ta,null,5===b.Type,!0,null,ob))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ia=this.JJi(b.GalleryItems,L,null),
h.push.apply(h,this.UPf(this.Shf(h,b.GalleryItems,Ia),ba,ra,!1,r,L,!1,Ia))}UMm(b,h){const r=[];let A=null,L=!1;if(!b)return null;const ba=this.rAa.Fkd(this.vD,b.commandId,h);r.push(Gt(b.externalUxCommand,!ba));if(b.previewControlIds){const Ta=[];for(let ob=0;ob<b.previewControlIds.length;ob++){var ra={},Ia=b.previewControlIds[ob];ra.SourceControlId=Ia;const nb=this.hm.getCommandByExternalUxId(Ia);this.Iae(nb||b,ra);ra[Pf.a.On]&&(A=ra.SourceControlId,ra[Pf.a.HighlightOn]&&(L=!0));TD(Ia,ra,r);if(ra=
Object(ya.a)(BB.a,ra[Pf.a.GalleryButtonProps]))Ta.push(ra),ba&&(Ia=this.rAa.Fkd(this.vD,ra.Command,h),ra.IsDisabled=!Ia)}0<Ta.length&&r.push.apply(r,this.UPf(this.Shf(r,Ta),b.externalUxCommand,b.externalUxCommand,!0,Ta[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,A));L&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",A),r.push(appChrome.actions.highlightSelectedFontStyle(A)))}return r}Shf(b,h,r=null){const A=[],L=[];for(let ra=
0;ra<h.length;ra++){const Ia=h[ra],Ta=ef.b(Ia.ExternalId)?Ia.Id:Ia.ExternalId;A.push(Ta);const ob=r&&r[Ta]?r[Ta].result:-1;switch(Ia.Type){case 1:var ba=Ia;L.push(appChrome.api.createCharacterCodeGalleryButtonModel(Ta,Object.assign(new Xx,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,character:ba.Character,style:ba.Style,title:ba.Alt})));break;case 2:ba=Ia;L.push(appChrome.api.createFontStylesGalleryButtonModel(Ta,Object.assign(new Ep,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,styleDisplayName:ba.LabelText,
style:ba.Style,title:ba.Alt,previewStyleLabel:ba.PreviewStyleLabel,previewStyleFontNameAndSize:ba.previewStyleFontNameAndSize,menuModel:ba.menuModel})));break;case 3:ba=Ia;L.push(appChrome.api.createInkThicknessGalleryButtonModel(Ta,Object.assign(new NI,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt})));break;case 4:ba=Ia;L.push(appChrome.api.createIconGalleryButtonModel(Ta,Object.assign(new Ft,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,icon:[ba.Icon],
role:ba.Role,fullIconStyle:ba.FullIconStyle,previewIconStyle:ba.PreviewIconStyle,largePreviewIconStyle:ba.LargePreviewIconStyle,label:ba.LabelText,title:ba.Alt})));break;case 5:ba=Ia;L.push(appChrome.api.createListGalleryButtonModel(Ta,Object.assign(new sA,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,infoAtLevel:ba.LevelInfo,ariaLabel:ba.Alt})));break;case 6:ba=Ia;L.push(appChrome.api.createTableStyleGalleryButtonModel(Ta,Object.assign(new Wx,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,
tableStyles:ba.TableStyles,title:ba.Alt,columns:ba.columns})));break;case 8:ba=Ia;L.push(appChrome.api.createChangeColorsGalleryButtonModel(Ta,Object.assign(new rA,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt})));break;case 7:ba=Ia,L.push(appChrome.api.createPageNumberGalleryButtonModel(Ta,Object.assign(new OI,{disabled:-1!==ob?1>(ob&1):ba.IsDisabled,text:ba.Text,title:ba.Alt})))}this.hm.addCommandToMaps(Object.assign(new Qt.a(Ta,
Ia.Command),{queryCommandId:Ia.QueryCommand,menuItemId:Ia.MenuItemId}))}b.push(appChrome.actions.addControls(L));return A}UPf(b,h,r,A,L,ba=null,ra=!1,Ia=null){const Ta=[];A?Ta.push(appChrome.actions.populateGalleryItems(h,b)):(this.YMc[h]=!1,ra||(A=!0,appChrome.selectors.isControlDefined(h)&&(A=appChrome.selectors.getGalleryState(h),A=A.disableIndividualButtons?A.disableIndividualButtons:!0),Ta.push.apply(Ta,this.pNf(h,Et[L],b,null,5===L,A,ba,Ia))),Ta.push(appChrome.actions.updateGallerySectionItems(h,
r,b)));return Ta}JAm(b){return this.pNf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}pNf(b,h,r,A,L,ba=!0,ra=null,Ia=null){const Ta=[];if(b in this.YMc){if(this.YMc[b])return delete this.YMc[b],Ta;this.YMc[b]=!0}let ob=null,nb=-1;if(r)({Qwi:nb,returnValue:ob}=this.JSh(h,r,Ta,ba,ra,Ia));else if(A)for(const Eb of A)(r=({Qwi:nb}=this.JSh(h,Eb.galleryButtons,Ta,ba,null,Ia)).returnValue)&&(ob=r);Ta.push(appChrome.actions.updateGallerySelectedId(b,
ob));ba&&Ta.push(Gt(b,!1));L&&0<nb&&Ta.push(appChrome.actions.updateListGalleryTextDirection(b,2===nb));return Ta}IJi(b,h=null){const r={},A={};A.SourceControlId=b;A.Location=h;b=this.hm.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=A,r;b=this.Iae(b,A);r.result=b;r.props=A;return r}JJi(b,h=null,r=null){r||(r={});for(const A of b)b=ef.b(A.ExternalId)?A.Id:A.ExternalId,r[b]=this.IJi(b,h);return r}JSh(b,h,r,A,L=null,ba=null){let ra,Ia=null;ra=-1;let Ta=!1;for(const nb of h){var ob=this.GAm(b);
h=ba&&ba[nb]&&-1!==ba[nb].result?ba[nb]:this.IJi(nb,L);const Eb=h.result;h=h.props;A&&r.push(Gt(nb,1>(Eb&1)));(ob=aL(nb,ob,h,Eb))&&r.push.apply(r,ob);h[Pf.a.On]&&(Ia=nb,h[Pf.a.HighlightOn]&&h[Pf.a.HighlightOn]&&(Ta=!0));void 0!==h[xj.a.labelText]&&null!==h[xj.a.labelText]&&(ob=this.hm.getCommandByExternalUxId(nb),r.push(appChrome.actions.setControlLabel(ob.externalUxCommand,h[xj.a.labelText])));h[Pf.a.IsRtl]&&0>ra&&(ra=h[Pf.a.IsRtl])}Ta&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",
Ia),r.push(appChrome.actions.highlightSelectedFontStyle(Ia)));return{returnValue:Ia,Qwi:ra}}GAm(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";
case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}Iae(b,h){h.MenuItemId=b.menuItemId;return this.rAa.Twa(this.vD,this.lcc,b.commandId,b.queryCommandId,h)}}Object(u.a)(fG,"ReactGalleryPoller",null,[]);var bL=e(717),cL=e(666),dL=e(1708),$B=e(800),jq=e(1709);class aC{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(u.a)(aC,"PopulateFontPickerDataProps",null,[]);var hM=e(297),Dv=e(1899);
class Uq{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1;this.secondaryText=null}}Object(u.a)(Uq,"CommonOptionalButtonProperties",null,[]);class vA extends Uq{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(u.a)(vA,"OptionalButtonProperties",Uq,[]);class bC extends Uq{constructor(){super();
this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(u.a)(bC,"OptionalCompoundButtonProperties",Uq,[]);class Ev extends Uq{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(u.a)(Ev,"OptionalErrorViewProperties",Uq,[]);class Nd extends Uq{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=
!1;this.roleInMenu=null}}Object(u.a)(Nd,"OptionalFlyoutAnchorProperties",Uq,[]);class Eu extends Uq{constructor(){super();this.isBanner=null}}Object(u.a)(Eu,"OptionalLabelProperties",Uq,[]);class sj extends Uq{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(u.a)(sj,"OptionalMultipActionButtonProperties",Uq,[]);class eL extends vA{constructor(){super();
this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(u.a)(eL,"OptionalPersonaButtonProperties",vA,[]);class cC extends Uq{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1;this.stylingParameters=null}}Object(u.a)(cC,"OptionalToggleButtonProperties",Uq,[]);var QI=e(1711),UD=e(1710),$t=e(494);class RI{constructor(){this.G9h=this.actions=null;this.Zgk=!1}}Object(u.a)(RI,"PopulateActions",null,[]);class Ww{zMi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);
case "ToggleButtonModel":return this.NNm(b);case "InkButtonModel":return this.MNm(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}NNm(b){const h={};h[bg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}MNm(b){const h={};h[bg.a.On]=mh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);
return h}}Object(u.a)(Ww,"ReactStatePropsSelector",null,[]);class fC{constructor(b,h,r,A,L){this.rAa=b;this.vD=h;this.lcc=r;this.hm=A;this.jcf={};this.uQk=new Ww;this.bKb=L}N0j(b){const h=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&h in this.jcf}nOm(b,h,r=null){const A=[],L={};if(!this.N0j(b)){const ba=b.populationProps.populateQueryCommandId,ra={};ra.MenuId=b.externalUxCommand;ra.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.rAa.Twa(this.vD,this.lcc,
ba,ba,ra,this.sDm(r))&1))if("FontPickerModel"===h)this.jcf[ba]=!0,A.push(fC.yMm(b,ra)),L[b.externalUxCommand]="FontPickerModel";else if(ra.MenuItems)switch(this.jcf[ba]=!0,h){case "ComboBoxModel":A.push(fC.wMm(b,ra));L[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":A.push.apply(A,this.OOi(b.externalUxCommand,h,ra.MenuItems,L,r&&"location"in r?r.location:null))}}return Object.assign(new RI,
{actions:A,G9h:L,Zgk:this.isShadowMenuOpen(r)})}eHi(b,h,r,A,L,ba,ra,Ia,Ta=null){let ob=null;const nb=[];ef.c(b.Title)||(ob=b.Title);for(let Eb=0;Eb<b.ControlList.length;Eb++){const bc=Object(ya.a)(bl.a,b.ControlList[Eb]);if(!bc||bc.ExternalId)ba&&this.Lsm(bc,ba),h.push.apply(h,this.xMm(bc,ra,nb,L,r,A,Ta))}return Ia?appChrome.api.menuSection(nb,ob,b.Lang):null}OOi(b,h,r,A,L=null){const ba=[],ra=[],Ia=[],Ta=[];for(var ob=0;ob<r.MenuSectionList.length;ob++){var nb=Object(ya.a)(Zd.a,r.MenuSectionList[ob]);
nb&&(nb=this.eHi(nb,ba,b,h,Ta,A,ra,r.UpdateDynamically,L),r.UpdateDynamically&&Ia.push(nb))}ob=null;r.MenuFooterSection&&(ob=this.eHi(r.MenuFooterSection,ba,b,h,Ta,A,ra,r.UpdateDynamically,L));r.UpdateDynamically&&ba.push(appChrome.actions.updateMenu(b,Ia,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,ob,r.IsFlexLayout));0<ra.length&&ba.splice(0,0,appChrome.actions.addControls(ra));0<Ta.length&&mh.d("setStatefulSplitButtonMruBypassControls")&&ba.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,
Ta));return ba}Lsm(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(ya.a)(Te.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}xMm(b,h,r,A,L,ba,ra=null){const Ia=[];switch(b.ControlType){case 14:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(A=Object(ya.a)($B.a,b),null!=A.IsBanner&&A.IsBanner&&this.mko(Object(ya.a)($B.a,b),Ia,h,r));break;case 1:case 3:b=Object(ya.a)(qg.a,b);this.oko(b,Ia,h,r);b.MenuItemsStatefulData&&mh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Ia.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(L,b.MenuItemsStatefulData));break;case 2:this.clo(Object(ya.a)($t.a,b),Ia,h,r);break;case 6:this.pko(Object(ya.a)(FB.a,b),Ia,h,r);break;case 4:this.Vko(Object(ya.a)(sh,b),Ia,h,r);break;case 7:this.rko(Object(ya.a)(Te.a,
b),Ia,h,r);break;case 12:this.yko(Object(ya.a)(dL.a,b),Ia,h,r);break;case 13:this.Rko(Object(ya.a)(jq.a,b),Ia,h,r);break;case 9:b=Object(ya.a)(Sj.a,b);this.Ako(b,Ia,h,r);"StatefulSplitButtonModel"===ba&&A.push(b.ExternalId);break;case 8:this.bKb.Eko(Object(ya.a)(Ul.a,b),Ia,h,r,ra)}return Ia}mko(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,
b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Dv.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new Eu,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}oko(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&
h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.vVd()&&((r=this.mYa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Dv.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Pb.a)(cF,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new bC,{iconSet:(new Dv.a(this.mYa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,
ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null,secondaryText:b.SecondaryText}))):(A=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new vA,{iconSet:(new Dv.a(this.mYa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,secondaryText:b.SecondaryText,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==
A&&null!==A?A:!0})))),this.hm.addCommandToMaps(Object.assign(new Qt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&mh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}pko(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.vVd()&&
((r=this.mYa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Dv.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new cC,{iconSet:(new Dv.a(this.mYa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,
customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.hm.addCommandToMaps(Object.assign(new Qt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}yko(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&
(h=new Dv.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new Ev,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}Rko(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),
b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new sj,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,
iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.hm.addCommandToMaps(new Qt.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&this.hm.addCommandToMaps(new Qt.a(b.ActionId,b.ActionIdMapped)))}clo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&
h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.vVd()&&((r=this.mYa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Dv.a(r)).iconSet)),y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new cC,{iconSet:(new Dv.a(this.mYa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new cC,{iconSet:(new Dv.a(this.mYa(b))).iconSet,iconColor:b.IconColor,
keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))),this.hm.addCommandToMaps(Object.assign(new Qt.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Vko(b,h,r,A){A.push(b.ExternalId);A=this.XLm(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,A,b.LabelText)):mh.a("createPersonaButtonModel")&&
r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,A,b.LabelText,Object.assign(new eL,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Ako(b,h,r,A){A.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.vVd()&&((r=this.mYa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Dv.a(r)).iconSet)),void 0!==
b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{A=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const L=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new Nd,{iconSet:(new Dv.a(this.mYa(b))).iconSet,keytip:b.KeyTip,
hideIcon:A,toggled:L,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.hm.addCommandToMaps(Object.assign(new Qt.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new bL.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.OOi(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}rko(b,h,r,A){b.McuLayout&&A.push(b.McuExternalId);A.push(b.ExternalId);A=0;appChrome.selectors.isControlDefined(b.ExternalId)?
b.McuLayout&&(A=this.uQk.zMi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.hm.addCommandToMaps(Object.assign(new Qt.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),A=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.hm.addCommandToMaps(Object.assign(new Qt.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
r=[];const L=[];for(let ba=0;ba<b.Colors.length;ba++){const ra=b.Colors[ba],Ia=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)?ra.Disabled:!1;ba<A?r.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt,Ia)):L.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt,Ia))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,
L));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}mYa(b){return b.Image32by32Class?this.hm.SCi(b.Image32by32Class):b.Image16by16Class?this.hm.SCi(b.Image16by16Class):b.ExternalImageId}XLm(b){return b?Object.assign(new UD.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new QI.a,
{PersonaType:"User",Smtp:b.PersonaId})}):null}sDm(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}vVd(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static yMm(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,A)=>{Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>{L.isFeatureEnabled(hM.a.qXb,
!1).then(ba=>{let ra=h.fonts;ba||L.isFreemiumUpsellEnabled()||(ra=lf.a.lhk(ra,Ia=>Ia.fontType!==hM.a.wpg));ba=Object.assign(new aC,{commandId:b.externalUxCommand,fonts:ra,isSubscriber:ba,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});r(ba)}).catch(A)})}))}static wMm(b,h){const r=[];for(let A=0;A<h.MenuItems.MenuSectionList.length;A++){const L=h.MenuItems.MenuSectionList[A];L.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+A.toString(),
L.Title));for(let ba=0;ba<L.ControlList.length;ba++){const ra=Object(ya.a)(cL.a,L.ControlList[ba]);ra&&r.push(appChrome.api.comboBoxItem(ra.MenuItemId,ra.LabelText,ra.Styles,ra.CommandValueId,ra.AriaLabel,ra.Data,ra.Disabled))}A<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+A.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(u.a)(fC,"ReactPopulateQueryCommandPoller",null,[]);class YD{constructor(b,h,r,A,L){this.hm=
r;this.rAa=b;this.vD=h;this.lcc=A;this.bKb=L}mOm(b,h,r){const A=[];if(this.Jnn(h))b=this.mSm(b,h,r),void 0!==b&&null!==b&&A.push.apply(A,b);else if(b){var L=this.Iae(b,r);xj.a.visible in r&&A.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[xj.a.visible]));A.push(Gt(b.externalUxCommand,1>(L&1)));void 0!==r[xj.a.labelText]&&null!==r[xj.a.labelText]&&A.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[xj.a.labelText]));void 0!==h&&null!==h&&(L=aL(b.externalUxCommand,
h,r,L),void 0!==L&&null!==L&&A.push.apply(A,L),"PeopleWell"===h&&this.R3k(b.externalUxCommand,r,A))}return A}Hxm(b,h,r){const A=[];switch(h){case "FlyoutAnchorModel":var L=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ba=appChrome.selectors.getSplitButtonState(b);if(ba=this.hm.getCommandByExternalUxId(ba.command))r=this.rAa.Fkd(this.vD,ba.commandId,r),A.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),A.push(Gt(b,!1));return A;default:return null}h=
!1;for(ba in L)if(L=this.hm.getCommandByExternalUxId(ba),ef.c(L))h=!0;else if(r.SourceControlId=L.externalUxCommand,this.rAa.Fkd(this.vD,L.commandId,r))return A.push(Gt(b,!1)),A;A.push(Gt(b,!h));return A}mSm(b,h,r){switch(h){case "PreviewGalleryModel":return this.bKb.UMm(b,r);case "GalleryModel":return this.bKb.JAm(r)}return null}Jnn(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}Iae(b,h){h.MenuItemId=b.menuItemId;return this.rAa.Twa(this.vD,this.lcc,b.commandId,b.queryCommandId,h)}R3k(b,
h,r){const A=h[Ue.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Ue.a.LabelText];A&&0<A.length&&(h=String.format.apply(null,[h].concat(A)));r.push(this.CWm(b,h))}CWm(b,h){return appChrome.actions.updatePeopleWell(this.osm(b),h)}osm(b){const h=[];var r={};b=this.hm.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.rAa.Twa(this.vD,this.lcc,"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const A=r.ControlList[b],L=
{};L.name=A.Alt;L.id=A.MenuItemId;L.description=A.Description;L.color=A.ImageBackColor;L.joinTime=A.JoinTimeInMS;L.imageUrl=A.ImageUrl;L.activeStatus=A.ActiveStatus;L.isAnonymous=A.IsAnonymous;L.canJump=A.CanJump;L.upn=A.Upn;h.push(L)}return h}}Object(u.a)(YD,"ReactQueryCommandPoller",null,[]);var WI=e(1673);class gG{constructor(b,h,r){this.hm=b;this.vD=h;b=new WI.a;this.SUk=new Ww;this.bKb=new fG(b,this.vD,r,this.hm);this.nGh=new fC(b,this.vD,r,this.hm,this.bKb);this.bGh=new YD(b,this.vD,this.hm,
r,this.bKb)}PMa(){const b=[];if(!mh.c())return b;b.push.apply(b,this.AWm());var h=this.Cwm();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.Dwm();for(const A of r)b.push(appChrome.actions.updateControlEnabledDisabledState(A,!0)),delete h[A];b.push.apply(b,this.cce(h))}return b}Gkd(b,h){mh.c()&&(b=this.cce(b,h),appChrome.api.dispatch(b))}Pog(b,h,r=null){if(!ef.c(b)&&b.populationProps&&!this.nGh.N0j(b)){b=this.nGh.nOm(b,h,r);if(!b.Zgk){let A;
(A=b.actions).push.apply(A,this.cce(b.G9h,mh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}cce(b,h=0){const r=[],A={};if(mh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var L of appChrome.selectors.getActiveGroupIds())for(var ba of appChrome.selectors.getVisibleControlsInGroup(L))A[ba]=!0;for(const ra in b)L=ra,ba=b[ra],0===h&&A[L]&&(h=2),
r.push.apply(r,this.zWm(L,ba,h));return r}zWm(b,h,r=0){const A=[],L=this.hm.getCommandByExternalUxId(b);let ba={};appChrome.selectors.isControlDefined(b)&&(ba=this.SUk.zMi(b,h));ba[Cv.a.Ohb]=r;ef.c(L)?(ba.ExternalUxId=b,(b=this.bGh.Hxm(b,h,ba))&&0<b.length&&A.push.apply(A,b)):(ba.MenuItemId=L.menuItemId,ba.SourceControlId=b);A.push.apply(A,this.bGh.mOm(L,h,ba));return A}AWm(){const b=[],h=appChrome.selectors.getContextualTabIds(),r=appChrome.selectors.getActiveContextualTabIds();for(let L=0;L<h.length;L++){var A=
this.hm.GRf(h[L]);A&&(A=this.vD.$Na(A),0<=Array.indexOf(r,h[L])!==A&&b.push(appChrome.actions.activateDeactivateContextualTab(h[L],A)))}return b}Cwm(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.hm.GRf(b);r&&(this.vD.$Na(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}Dwm(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.hm.cBm(r))for(const A of b)this.vD.$Na(A.commandId)||((b=A.externalUxCommandIds)||
(b=appChrome.selectors.getVisibleControlsInGroup(A.externalUxGroupId)),h.push.apply(h,b));return h}}Object(u.a)(gG,"ReactRibbonRootPoller",null,[1790]);class hG{constructor(b,h,r=null){this.vD=this.HIa=this.Kmb=null;this.Mbc=h;b.DVa(this);this.nJ=r}get Xva(){this.HIa||(this.HIa=new Date,this.HIa.setTime(0));return this.HIa}set Xva(b){this.HIa=b}get cea(){return 2}get nJ(){return this.vD}set nJ(b){this.vD=b}get Gxc(){this.Kmb||(this.Kmb=new gG(this.Mbc,this.nJ,this.cea));return this.Kmb}dqb(){const b=
document.activeElement;eb.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,A,L,ba,ra,Ia=2){ef.c(this.nJ)||(L=new cm.a,L.CommandLocation=Ia,L.InvocationMethod=A,L.CommandTabName=r,h[Cv.a.Ohb]=Ia,this.nJ.wXa(b,h,L,ba,ra),this.vKn(b,h))}PMa(){return ef.c(this.nJ)?[]:this.Gxc.PMa()}qo(){const b=this.PMa();0<b.length&&(this.Xva=new Date,appChrome.api.dispatch(b))}Awd(){mh.c()&&this.Gxc.Gkd({PeopleWell:"PeopleWell"},18)}nwd(){}vKn(b,h){try{const r=Xa.a.instance.Wa("Common.ISystemInitiatedFeedback");if(r&&
h){const A=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let L=(A?"_"+A:"")+(h.SqmControlId?"_"+h.SqmControlId:"");L=L.length?L:"_"+b;r.z9f("Ribbon"+L)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}Object(u.a)(hG,"ReactRibbonRoot",null,[506,1791]);var ZD=e(1594);class XI{constructor(b){this.Xff=this.mXe=!1;this.Cjb=null;this.Afh=!1;this.VK=null;this.Oza=!1;this.w3n=h=>{h.Yb&&h.Yb.target&&"input"===h.Yb.target.tagName.toLowerCase()&&
Jc.FocusManager.instance().scopeChanged("ribbon");return!1};this.D8e=b;qd.a.instance.Cb(Fd.a.eE,this.u5c(),this.w3n);(b=Xa.a.instance.Za("Common.IActionContextProvider"))&&b.execute(h=>{this.VK=h});y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ta.Pb.JN?Fk.a.get_instance().Zk(16,()=>{this.isReady?this.initializeContextualUI(this.u5c()):Fk.a.get_instance().Zk(7,()=>{this.initializeContextualUI(this.u5c())})}):Fk.a.get_instance().Zk(7,
()=>{this.initializeContextualUI(this.u5c())})}get k5(){return this.Oza}get isReady(){return y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ta.Pb.JN?Fk.a.get_instance().isCompleted(16)&&Fk.a.get_instance().isCompleted(7):Fk.a.get_instance().isCompleted(7)}Irl(){if(this.Afh)return!0;try{return Promise.resolve(null),this.Afh=!0}catch(b){return!1}}uOg(b){if(!this.isReady||this.Xff)return this.u$f("Unable to launch contextual ui because ribbon hasn't loaded yet"),
!0;if(!this.Irl())return this.u$f("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(y.AFrameworkApplication.y3d||""!==y.AFrameworkApplication.$v)if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===y.AFrameworkApplication.$v||"ContentAssemblyView"===y.AFrameworkApplication.$v)return this.u$f("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.Xff=!0;let h=wb.a.nh;
switch(b){case 1:h=wb.a.showContextMenu;break;case 0:h=wb.a.showFloatie;break;case 2:h=wb.a.IAc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Xff=!1;$d.c(h)},0)});return!1}jPi(b){return Tk.UISurfaces.zab().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const A of b)Array.contains(h,A)||r.push(A);return r}return b})}showFloatie(b,h,r,A=null){let L=A;A||(L={});L.sharedApiStartTime=window.performance.now();
this.uOg(0)||this.jPi(h).then(ba=>{if(0>=ba.length)return null;this.QEg(ba).then(()=>{const ra={};ra.target=b;Tk.UISurfaces.zab().then(Ia=>{appChrome.api.dispatch(Ia.showFloatie(ra,r,void 0,this.MOf(),L));this.Oza=!0;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&y.AFrameworkApplication.va&&y.AFrameworkApplication.va.Vb(wb.a.rej,2);return null})});return null})}showContextMenu(b,h,r=null,A=null){this.uOg(1)||this.NZj(b,h,r,A)}NZj(b,
h,r=null,A=null){const L={};L.sharedApiStartTime=window.performance.now();this.QEg(null).then(()=>{const ba={};ba.target=b;A&&(ba.directionalHint=A);Tk.UISurfaces.zab().then(ra=>{appChrome.api.dispatch(ra.showContextMenu(ba,h,r,void 0,this.MOf(),L));return null})})}HAc(b,h,r,A=null){const L={};L.sharedApiStartTime=window.performance.now();this.uOg(2)||this.jPi(h).then(ba=>{0>=ba.length?this.NZj(b,r,A):this.QEg(ba).then(()=>{const ra={};ra.target=b;const Ia={};Ia.target=b;Tk.UISurfaces.zab().then(Ta=>
{appChrome.api.dispatch(Ta.showContextualUI(ra,Ia,r,void 0,A,this.MOf(),L));this.Oza=!0;return null})});return null})}u$f(b){v.ULS.sendTraceTag(561394519,340,15,b)}NAf(){this.isReady&&Tk.UISurfaces.isLoaded()&&Tk.UISurfaces.zab().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.isReady&&Tk.UISurfaces.isLoaded()&&Tk.UISurfaces.zab().then(b=>{this.Oza=!1;appChrome.api.dispatch(b.hideFloatie());return null})}g1c(){this.isReady&&Tk.UISurfaces.isLoaded()&&Tk.UISurfaces.zab().then(b=>
{appChrome.api.dispatch(b.hideContextualUI());this.Oza=!1;return null})}initializeContextualUI(b){return Tk.UISurfaces.zab().then(h=>{this.mXe||(h.initializeContextualUI(b),this.mXe=!0);return null})}QEg(b){if(!this.mXe)return this.initializeContextualUI(this.u5c()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);
var r=[];Tk.UISurfaces.zab().then(A=>{r.push.apply(r,this.D8e.Gxc.cce(A.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}u5c(){if(this.Cjb)return this.Cjb;this.Cjb=ZD.a("div");this.Cjb.id="ReactContextualUIDiv";this.Cjb.style.position="absolute";this.Cjb.style.zIndex="1001";document.body.insertBefore(this.Cjb,document.body.firstChild);return this.Cjb}MOf(){return this.VK?this.VK.contentType:"Unknown"}}Object(u.a)(XI,"ReactContextualUILauncher",null,[1792]);
class kL extends wF.a{constructor(){super()}}Object(u.a)(kL,"FloatieBuildOptions",wF.a,[]);class $D extends xF.a{constructor(){super()}}Object(u.a)($D,"FloatieBuildContext",xF.a,[]);var d=e(1486);class n extends Fq.Builder{constructor(b,h,r){super(b,h,r,null);this.G9n=A=>{this.Lml(A.Rld,A.EZc);this.oT.Iui=this;this.oT.ro();this.oT.fd.style.display="none";this.placeholder.appendChild(this.oT.fd);this.BBa.continueWith(()=>{this.BBa.result.eZb(this.oT)},11);Di.a.instance.Cb(Fd.a.Lu,this.oT.fd,Object(E.a)(this.oT,
this.oT.rA,"onPointerDown"))};if(ef.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get oT(){return this.root}F7o(b){this.root=b}Kml(){const b=new $D,h=new Rq.a;h.ymd=1;h.handler=this.G9n;h.data=b;this.rCa.oze(h)}Lml(b,h){b=jj.a.tna(b,jj.a.Alk);if(ef.c(b))throw Error.create("No floatie element was present in the data");b=new jj.a(b);this.F7o(new Bw(b.attributes[jj.a.id],b.attributes));b=jj.a.tna(b.node,jj.a.fLe);this.fpf(b,h)}fpf(b,h){b=jj.a.zz(b);for(let r=0;r<b.length;r++){if(this.SZa(b[r]))continue;
const A=this.lpf(b[r],h);this.oT.pg(A)}}lpf(b,h){var r=new jj.a(b);b=new d.Group(this.oT,r.attributes[jj.a.id],r.attributes[jj.a.V3a],r.attributes[jj.a.UEc],r.attributes[jj.a.S3a],!1,r.name===jj.a.Gpk,!1,r.attributes);r=jj.a.zz(r.node);for(let A=0;A<r.length;A++)b.pg(this.uXd(r[A],h));return b}uXd(b,h){b=new jj.a(b);var r=b.attributes[jj.a.id];b=jj.a.zz(b.node);var A=2;2===b.length&&(A=3);r=new oa.a(this.oT,r,A,2,1);for(A=0;A<b.length;A++){const ba=new jj.a(b[A]);var L=jj.a.tna(ba.node,jj.a.DDb);
L=jj.a.zz(L);this.tpf(r.dbe(A+1),L,ba.attributes[jj.a.id],h)}return r}tpf(b,h,r,A){for(r=0;r<h.length;r++){if(this.SZa(h[r]))continue;const L=new jj.a(h[r]),ba=this.ima(h[r],A);ba&&b.pg(ba.KY(L.attributes[jj.a.VEc]))}}}Object(u.a)(n,"FloatieBuilder",Fq.Builder,[]);class B{constructor(b,h){this.iy=null;this.TBl=b;this.ORe=h;this.U4n=this.aqe.bind(this)}get oT(){return this.iy}gqb(b,h,r){h=new ge.a(Rl.a.Q8a,Box4Intl.Box4Strings,null,null,h);const A=new kL;A.KK=r||{};A.KK.floatieshadingColor=!1;const L=
new n(A,document.body,this.TBl.YNj);L.rCa=new yF.a(b,h);L.Kml();this.ORe.execute(ba=>{L.oT.nJ=ba});L.oT.cDo(this.U4n);L.oT.lCo(()=>[]);this.iy=L.oT;return this.oT}}Object(u.a)(B,"AFloatieInitializer",null,[]);class Q extends B{constructor(b,h,r,A){super(h,r);this.Fog=()=>{this.oT.qo()};this.mi=b;this.IM=A}gqb(b,h,r){if(b=super.gqb(b,h,r))b.Ywc=!0,b.sue=!0,b.preventDismissOnScroll=!0;this.mi.GVa(this.Fog);return b}x$c(b,h,r=null){this.IM.d0h(()=>this.gqb(b,h,r))}aqe(){this.oT.Ywc=!0}}Object(u.a)(Q,
"PasteFloatieInitializer",B,[]);var ha=e(831);class Aa{sGa(b,h){this.jsl&&this.Ddp(b,h,Aa.pbg,Aa.currentSelection)}Ddp(b,h,r,A){switch(r){case 1:case 6:case 2:case 3:case 4:Aa.yCf.show(A,b,h)}}Xij(){switch(Aa.pbg){case 5:case 1:return!0;default:return!1}}VSl(){return Aa.pbg}get jsl(){return 1!==Db.StaticActiveAppFrame.Aa().state}static get yCf(){return null!=Aa.jZg?Aa.jZg:Aa.jZg=Xa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static uGm(b){if(!b)return 0;if(2===Db.StaticActiveAppFrame.Aa().mode){const h=
b.Ya.node,r=te.a.kb(h);r.ku();return Yo.e(r.currentNode)?2:y.AFrameworkApplication.aEc||!Su.g(h)||Su.j(h)?bi.a.isn(b.Ya)||bi.a.u1f(b.Ya)?6:1:3}return 4}static get currentSelection(){return Fg.a.instance.ob.currentSelection}static get pbg(){return Aa.uGm(Aa.currentSelection)}}Object(u.a)(Aa,"SelectionContextMenuProvider",null,[1554]);class bb{constructor(b,h){this.sue=this.Ywc=!1;this.Z8c=!0;this.eQ=b;this.hm=h}get isVisible(){return this.eQ.k5}get controls(){return null}dismissFloatie(){this.eQ.dismissFloatie();
return!0}LDf(){}Ogb(b,h,r,A,L=null){this.eQ.showFloatie(Object.assign(new Ew.a,{x:b.x,y:b.y}),this.GJf(r),r,L)}DSb(){return new Sys.UI.Bounds(0,0,0,0)}B8(){return this.dismissFloatie()}GJf(){return[]}}Object(u.a)(bb,"ReactFloatie",null,[214,215]);class Ib{constructor(b){this.tCd=null;this.eQ=b}dispose(){}B8(){this.eQ.g1c();return!0}showContextMenu(b,h){this.e3b(b,h.clientPoint,h.Og)}e3b(b,h,r){this.Mgb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}Mgb(b,h,r,A=null){this.tCd?this.eQ.HAc(Object.assign(new Ew.a,{x:h.x,y:h.y}),this.tCd.GJf(r),r,b):this.eQ.showContextMenu(Object.assign(new Ew.a,{x:h.x,y:h.y}),r,b,A);this.tCd=null}IAc(b,h,r,A){this.tCd=Object(ya.a)(bb,r);A.sGa(b,h);return!0}}Object(u.a)(Ib,"ReactContextMenuController",null,[676,11]);var oc=e(962);class Ac{constructor(){this.Bpa=this.text=this.qva=null}}Object(u.a)(Ac,"BusinessBarButtonData",null,[]);class ad{constructor(){this.text=this.qva=null}}Object(u.a)(ad,"BusinessBarLinkData",
null,[]);var sd=e(751),wd=e(250);class yd{constructor(b,h,r,A){this.bnh=this.mkh=this.ckb=this.iih=null;this.pv=b;this.Sya=h;this.ga=r;this.za=A}cog(){this.YXc();this.ZXc();this.ghc()}ZXc(){}YXc(){const b=Db.StaticActiveAppFrame.Aa().tb.rd;b&&(this.iih=this.bib(this.iih,1,2===Db.StaticActiveAppFrame.Aa().mode&&b.u0f,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}y9i(){return y.AFrameworkApplication.ta&&1===y.AFrameworkApplication.ta.mode}ghc(){let b=null;if(10<=Ze.a.wf.PK){if(Ze.a.wf.Kea.NYa){var h=
Ze.a.wf.jJb;wd.a.zVb(h)?22===h?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?b=X.a.Yi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?b=X.a.Yi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):wd.a.WVf(Ze.a.wf.Kea.nga)||Ze.a.Yn||this.y9i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}}else if(h=
Db.StaticActiveAppFrame.Aa().tb.activeSection){const r=h.zjd;wd.a.zVb(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=X.a.Yi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=X.a.Yi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):wd.a.WVf(h.c8a)||
Ze.a.Yn||this.y9i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.bnh=this.bib(this.bnh,5,!!b,b)}f_j(b,h,r,A){b=this.Sya.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.wUd(h,()=>{ed.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});A&&(b.rma=A);this.pv.yB(b,!0)}tep(b,h,r){this.f_j(b,h,r,null)}Eep(b){b=this.Sya.create(null,b,null);b.closeable=!0;b.id=20;this.pv.yB(b)}Ndp(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.ckb||(this.ckb=this.Sya.create(b,h,null),this.ckb.closeable=!0,this.ckb.id=27,this.pv.yB(this.ckb))}J6m(){this.ckb&&(this.ckb=this.bib(this.ckb,27,!1,""))}IGg(b){this.mkh=this.bib(this.mkh,30,!0,b)}bib(b,h,r,A,L=!1,ba="",ra=null,Ia=null,Ta=null){r?b?b.message=A:(b=this.Sya.create(ba,A,null),b.id=h,b.closeable=L,ra&&b.addButton(ra.text,ra.qva,ra.Bpa),Ia&&b.wUd(Ia.text,Ia.qva),Ta&&(b.rma=Ta),this.pv.yB(b,!1)):b&&(this.pv.removeEntry(b),b=null);return b}Ahf(b){this.pv.yB(b,void 0)}}Object(u.a)(yd,
"BusinessBarController",null,[280]);class be extends yd{constructor(b,h,r,A){super(b,h,r,A);this.Vza=null}dOf(b,h,r=null,A=null,L=null,ba=2){if(this.Vza)return null;this.Vza=this.Sya.create(h,r||"",null);this.Vza.id=6;this.Vza.image=ba;this.Vza.$bd=!1;b&&(this.Vza.errorCode=b);this.Vza.closeable=!1;h=y.AFrameworkApplication.uE&&this.za.$("ShowFeedbackButtonOnKickoutBusinessBar");A?(this.Vza.addButton(A,L,""),h&&this.Vza.JTh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.TPi(b)})):h&&this.Vza.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.TPi(b)},"");this.pv.yB(this.Vza,void 0,null,null,null);return this.Vza}TPi(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Zb(wb.a.Hna,2,{["ErrorCode"]:b})}static get Jj(){return fn.a.instance}}Object(u.a)(be,"BusinessBarController",yd,[279,280]);class ye{static get Lnj(){const b=D.a.nj(Wg.a.Vg(y.AFrameworkApplication.lcid).name);return ye.qvn?String.format("https://support.office.com/{0}/client/results?Shownav=true&lcid=1033&ns=WDWAEndUser&version=15&omkt={0}&ver=15&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER&HelpID=WordODF",
b):String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}static get qvn(){if(null!=ye.i4g)var b=ye.i4g;else{var h;y.AFrameworkApplication.ud("d932d186;491d2669");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogLearnMoreUrlChangeEnabled",!1);b=ye.i4g=b}return b}}Object(u.a)(ye,"OdtUtils",null,[]);class Qe extends be{constructor(b,h,r,A){super(b,h,r,A);this.YIb=this.HEb=this.ZKc=this.Dzh=this.vVa=
this.Jzh=this.PKh=null;this.JJk="https://go.microsoft.com/fwlink/?linkid=2134357"}cog(){super.cog();this.cwl();this.zwl()}ZXc(){const b=Db.StaticActiveAppFrame.Aa().tb.rd;if(b){var h=Ze.a.q5;if(Ze.a.Wu||Ze.a.Yn||h&&y.AFrameworkApplication.Tx)this.PKh=this.bib(this.PKh,4,be.Jj.Zcb(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.Jzh=this.bib(this.Jzh,3,be.Jj.Pcb(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.Dzh=this.bib(this.Dzh,8,be.Jj.NFl(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),be.Jj.LWb(b)?this.vVa||(this.vVa=this.Sya.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.vVa.id=14,this.vVa.closeable=!0,this.vVa.image=3,this.vVa.addButton(Box4Intl.Box4Strings.L_LearnMore,sd.a.lGn,""),this.pv.yB(this.vVa,!1)):this.vVa&&(this.pv.removeEntry(this.vVa),this.vVa=null)}}cwl(){if(Pk.a.gcd){const b=ye.Lnj,h=this.Sya.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.U2k(b);this.pv.yB(h,!0)}}get hBn(){return this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)?X.a.iBn:!1}zwl(){this.hBn&&!this.YIb&&(this.YIb=this.Sya.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.YIb.id=15,this.YIb.closeable=!0,this.YIb.$bd=!1,this.YIb.addButton(Box4Intl.Box4Strings.L_DownloadNow,sd.a.OBp,""),this.pv.yB(this.YIb,!1))}uep(b,h){if(Db.StaticActiveAppFrame.Aa().tb.rd){const r=
new Ac;r.text=WacWordeditorStrings.BusinessBarMergePromptSendButton;r.qva=()=>{b()};const A=new ad;A.text=WacWordeditorStrings.BusinessBarMergePromptPrivacyLinkText;A.qva=()=>{ed.a.openWindow(4,y.AFrameworkApplication.privacyUrl)};this.ZKc=this.bib(this.ZKc,25,!0,WacWordeditorStrings.BusinessBarMergePromptMessage,!0,WacWordeditorStrings.BusinessBarMergePromptTitle,r,A,()=>{h()})}}R6m(){this.ZKc&&(this.ZKc=this.bib(this.ZKc,25,!1,""))}vdp(){if(Db.StaticActiveAppFrame.Aa().tb.rd){const b=new ad;b.text=
WacWordeditorStrings.CitationStyleLearnMore;b.qva=()=>{ed.a.openWindow(4,this.JJk)};this.HEb||(this.HEb=this.Sya.create(WacWordeditorStrings.CitationStylePromptTitle,WacWordeditorStrings.CitationStylePromptText,null),this.HEb.id=32,this.HEb.closeable=!0,this.HEb.image=3,this.HEb.wUd(b.text,b.qva),this.pv.yB(this.HEb,!1))}}s9(b){return this.pv.s9(b)}yB(b,h){this.pv.yB(b,h)}}Object(u.a)(Qe,"BusinessBarController",be,[278,279,280]);class af{constructor(){this.menuTargetType=null}}Object(u.a)(af,"MenuTargetDescriptor",
null,[]);class Qf{static get cca(){return null!=Qf.qYg?Qf.qYg:Qf.qYg=Xa.a.instance.resolve("Box4.IContextMenuController")}static showContextMenu(b,h){Qf.cca.showContextMenu(b,h)}static e3b(b,h,r){Qf.cca.e3b(b,h,r)}static Mgb(b,h,r,A=null){Qf.cca.Mgb(b,h,r,A)}}Object(u.a)(Qf,"BaseContextMenu",null,[]);class hf extends Qf{constructor(b,h,r,A=!1,L,ba=null,ra){super();this.vzj=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;Ia=Eb.aB;Eb=Eb.Ed;Ta=Object.assign(new dk.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,
MenuSectionList:[]});this.SNl(Ta,Ia,Eb.IsShadowMenuOpen);Eb.MenuItems=Ta;return 32};this.Eqo=h;this.jp=r;this.pnb=ba;this.U_e=A;this.mc(b);this.Xib=ra;hf.s7a[1]=fb.a.aEe;hf.s7a[2]=fb.a.vce;hf.s7a[3]=fb.a.GEe}get L4l(){return Zn.a.$1d}get K4l(){return Zn.a.x0d}get M4l(){return Zn.a.jkd}get tCf(){return Zn.a.xng}mc(b){b.nb(fb.a.Sog,ic.a.application,this.vzj,96);b.nb(fb.a.xzj,ic.a.application,this.vzj,96)}show(b,h,r){let A=null,L=new Sys.UI.Bounds(0,0,0,0);const ba=this.zNm(b);if(ba&&(b=b.Ya.node)&&
(b=b.ug(Object(Vb.a)().Pd.Lc))){L=VE.a.fx(b,ba.end);if(y.AFrameworkApplication.isRtl&&L.x>h.x||!y.AFrameworkApplication.isRtl&&L.x+L.width<h.x||L.y+L.height<h.y)L=VE.a.fx(b,ba.end-1);h.x=L.x+(y.AFrameworkApplication.isRtl?0:L.width);h.y=L.y+L.height;A=6}Qf.Mgb("ContextMenu",new Sys.UI.Bounds(h.x,h.y,L.width,L.height),r,A)}W4(b,h){return this.Xsd(b)||hf.fhc(fb.a.mergeCells)||hf.fhc(fb.a.CQa)||this.uHg(b)||this.IZj(b,h)||hf.x_j()||hf.k_j(b).returnValue}Xsd(b){return 2===Db.StaticActiveAppFrame.Aa().mode&&
this.Wbd(b)}L_c(b,h,r=null){if(qu.rF()&&2===Db.StaticActiveAppFrame.Aa().mode){h=this.Xib.Wbi(b.Ya);if(!h||!this.$xn()&&!this.zzn(h.errorDetails))return;h=h.errorDetails}else{if(!this.Xsd(b))return;h=this.gKi(b)}var A=Wg.a.Vg(h.lcid);const L=A?A.name:"UNKNOWN";A=Object(Pb.a)(to.a,h)?h.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,A,L);if(b=this.Eqo.lic(b,h))r.push.apply(r,b),this.SNn(h,A)}zzn(b){return b&&(1===
b.proofingType||2===b.proofingType)}$xn(){y.AFrameworkApplication.ud("gec07842;ae49c383");return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}SNn(b,h){const r=hf.s7a[b.proofingType];r&&(y.AFrameworkApplication.va.Vb(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,qu.rF()))}gKi(b){return this.jp.Eua(b.Ya).errorDetails}Wbd(b){return this.jp.$ze(b)}hmc(){return null}U0d(){}zNm(b){return this.Wbd(b)?
this.jp.Eua(b.Ya):(b=this.hmc(b))?new cd.a(b.ru,b.cpEnd):null}uHg(b){if(2!==Db.StaticActiveAppFrame.Aa().mode||!b)return!1;b=Mt.a.iCa(b.toArray());return!!Object(ak.a)().zV(b,14)}W_j(b,h){return 2===h||3===h&&!this.Wbd(b)}IZj(b,h){return 3!==h||this.Wbd(b)}nKl(){const b=[];b.push(Object.assign(new qg.a,{ExternalId:this.L4l}));b.push(Object.assign(new qg.a,{ExternalId:this.K4l}));b.push(Object.assign(new qg.a,{ExternalId:this.M4l}));return b}ePl(){const b=[];this.U_e&&b.push(Object.assign(new qg.a,
{ExternalId:this.tCf}));return b}static get Vd(){return null!=hf.J5g?hf.J5g:hf.J5g=Xa.a.instance.resolve("Box4.List.IListReader")}static get hsn(){null==hf.p_e&&(hf.p_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return hf.p_e}static get Tgd(){null==hf.ODb&&(hf.ODb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return hf.ODb}static get fBa(){null==hf.Sea&&(hf.Sea=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return hf.Sea}static fhc(b){return 32===y.AFrameworkApplication.va.Vb(b,1)}static x_j(){return 2===Db.StaticActiveAppFrame.Aa().mode&&!!Ze.a.HD.tL&&Ze.a.HD.tL.Lcd(fb.a.cse.toString())}static z_j(b){if(1!==b.length||!b.Ya.nm)return!1;b=te.a.kb(b.Ya.node);b.Ib(11);b.Ac();return(nf.a.Qe?nf.a.Wg(b):b.dw(4))&&!hf.Vd.Fy(b).listType?!0:!1}static k_j(b){let h=!1,r=!1;if(!b)return{returnValue:!1,qub:h,B9c:r};if(hf.Tgd)return hf.Dep(b,r);if(!(b.xy||hf.hsn&&2===b.length&&b.hd.contextId===ic.a.od))return{returnValue:!1,
qub:h,B9c:r};b=b.Ya.clone();h=32===y.AFrameworkApplication.va.Sf(b,fb.a.Beb,1,!0,null,null);r=32===y.AFrameworkApplication.va.Sf(b,fb.a.PT,1,!0,null,null);return{returnValue:h||r,qub:h,B9c:r}}static Dep(b,h){let r;h=b.Ya.clone();r=hf.fBa&&kp.l(h);let A=!r&&32===y.AFrameworkApplication.va.Sf(h,fb.a.Beb,1,!0,null,null);if(b.xy||2===b.length&&b.hd.contextId===ic.a.od)h=!r&&32===y.AFrameworkApplication.va.Sf(h,fb.a.PT,1,!0,null,null);else{h=!0;const L=b.length;for(let ba=0;ba<L;ba++){const ra=b.K(ba).clone();
if(ra.contextId===ic.a.paragraph||ra.contextId===ic.a.Nd)(r=hf.fBa&&kp.l(ra))||(h=32===y.AFrameworkApplication.va.Sf(ra,fb.a.PT,1,!0,null,null)&&h);else if(ra.contextId!==ic.a.od)return h=A=!1,{returnValue:!1,qub:A,B9c:h}}}return{returnValue:A||h,qub:A,B9c:h}}static fHi(b){const h=Object.assign(new Zd.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new qg.a,{ExternalId:r}));return h}static gF(b){const h=[];for(const r of b)h.push(Object.assign(new qg.a,{ExternalId:r}));return h}}
hf.p_e=null;hf.ODb=null;hf.Sea=null;hf.s7a=[];Object(u.a)(hf,"AEditSurfaceContextMenu",Qf,[]);var di=e(727),vj=e(1475),Wk=e(1784),Tm=e(1040);class Dk{static Pmm(b,h,r){return r.J.$("AddInCommandsIsEnabled")?(h=[],Dk.wJl(b,Pk.a.Xm.tb.Xc.ub.iX,h),h):[]}static wJl(b,h,r){2===Pk.a.Xm.mode&&oi.OSh&&(h=te.a.kb(h),oi.OSh(r,b,h))}static HMm(b,h,r){h=[];r.dno.lic(r.Enm(b),h);return h}static vwm(b,h,r){const A=[];if(r.Xsd(b))return A;al.a.VNa&&!X.a.Zt||r.iAf.U0d(b,null,h,A);return A}static VRm(b,h,r){const A=
[];r.L_c(b,h,A);return A}}Object(u.a)(Dk,"ContextMenuSectionHelper",null,[]);class gi{static jwm(b,h,r){h=[];r.QYl(b)&&h.push(Object.assign(new qg.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.ZOm(b)}));return h}static CGm(){return hf.fhc(fb.a.mergeCells)?hf.gF(["MergeCells"]):hf.fhc(fb.a.fEe)?hf.gF(["SplitCells"]):[]}static VTm(){return hf.fhc(fb.a.UDe)&&(y.AFrameworkApplication.ud("4aah1391;h7hg6461"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableSortInContextMenuEnabled",
!1))?hf.gF(["Sort"]):[]}static GVm(b,h,r){h=[];if(!r.Ni.yai(b))return h;b=r.Ni.rOi(b);h.push(Object.assign(new qg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WacWordeditorStrings.TrackChangeContextMenuTextFormat,WacWordeditorStrings.AcceptChange,b)}));h.push(Object.assign(new qg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WacWordeditorStrings.TrackChangeContextMenuTextFormat,WacWordeditorStrings.RejectChange,b)}));return h}static Uqm(b,h,r){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&
b&&b.Ya&&b.Ya.node&&r.Jc&&r.Jc.Dmj(b.Ya.node)?hf.gF(["ShowCatchUpActivitiesForParagraph"]):[]}static dxm(b){return oi.Rdp(b)?hf.gF(["Draw"]):oi.o_j(b)?hf.gF(["EditIllustration"]):[]}static AYm(b){return oi.vgp(b)?[Object.assign(new Sj.a,{ExternalId:"WrapTextMenu"})]:[]}static SOm(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isResetPictureEnabled",!1)&&oi.Bfp(b)?hf.gF(["ResetPictureEdits"]):[]}static Tae(b,h,r){return r.iZl(b)?hf.gF(["CreatePullQuote"]):[]}static getContentControls(b,
h,r){return r.PYl()?hf.gF(["RemoveContentControl"]):[]}static Rsm(){return hf.gF(["NewComment"])}static rrm(b){const h=[];!oi.sHg(b)&&oi.WGg(b)&&id.SessionStatusManager.instance.WC&&b.GN&&h.push(Object.assign(new Sj.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static zDm(b,h,r){h=[];!oi.sHg(b)&&oi.WGg(b)&&id.SessionStatusManager.instance.WC&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.GN&&!y.AFrameworkApplication.J.$("ChangePicturesIsEnabled")?
h.push(...hf.gF(["ChangePicture"])):h.push(...r.$Ml().ControlList),(b=oi.vFi())&&0<b.length&&(r=r.WQl(b),null!=r&&h.push(...r.ControlList)));return h}static vNm(){return hf.x_j()?hf.gF(["SetProofingLanguage"]):[]}static iPm(b,h,r){return r.Yxn&&r.Cfp(b)?hf.gF(["Rewrite"]):[]}static hFm(b){return hf.z_j(b)?hf.gF(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static fLm(){return oi.J_j()?hf.gF(["ParagraphOptions"]):[]}static vCm(b){return oi.o_j(b)?hf.gF(["EditIllustration"]):[]}static LRm(b){return oi.sHg(b)?
hf.gF(["ShowSmartLookupPane"]):[]}static RVm(b){return oi.C_j(b)?hf.gF(["ModernTranslatorSplitButton"]):[]}static ABm(b,h,r){h=[];if(b.xy){const A=b.Ya;if(A.contextId===ic.a.paragraph||A.contextId===ic.a.kd||A.contextId===ic.a.Nd){b=b.Ya.node;if(!r.gh.lc(b)||b.pr||""===b.characterData)return h;r.x2l.b$d(b)&&h.push(...hf.gF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(b.xy){const A=b.Ya;(Ee.a.Df(A)||Ee.a.ncb(A))&&r.ukl.A9d(b.Ya.node,b.Ya.cpBegin)&&(h.push(...hf.gF(["DeleteBookmarkContextMenu"])),
h.push(...hf.gF(["EditBookmarkNameContextMenu"])))}return h}static vna(b){let h=!1,r=!1;const A=[];({qub:h,B9c:r}=hf.k_j(b)).returnValue&&(h?r?A.push(...hf.gF(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):A.push(...hf.gF(["OpenHyperlink"])):r&&(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")?A.push(...hf.gF(["InsertLinkFlyout"])):A.push(...hf.gF(["InsertLink"]))));return A}static ism(b,h,r){const A=[];
if(!r.IZj(b,h))return A;2===Db.StaticActiveAppFrame.Aa().mode?(A.push(...r.nKl()),A.push(...r.ePl()),3===h&&r.Wbd(b)&&A.push(Object.assign(new qg.a,{ExternalId:"Delete"}))):(!y.AFrameworkApplication.AR&&!y.AFrameworkApplication.nE||y.AFrameworkApplication.XLa)&&A.push(Object.assign(new qg.a,{ExternalId:"Copy"}));return A}static XJf(b,h,r){return r.uHg(b)&&r.W_j(b,h)?hf.gF(["EditTableAltText"]):[]}static zFi(b,h,r){return r.$Yl(b)?hf.gF(["ShowIntentSuggestion"]):[]}static JTm(b,h,r){const A=[];r.uHg(b)&&
!r.W_j(b,h)&&(A.push(Object.assign(new Sj.a,{ExternalId:"InsertTableMenu"})),A.push(Object.assign(new Sj.a,{ExternalId:"DeleteTableMenu"})),A.push(Object.assign(new Sj.a,{ExternalId:"SelectTableMenu"})));return A}static PTm(b,h,r){return r.Yfp(b)?hf.gF(["UpdateTableOfContents"]):[]}static Xxm(b){return oi.Ydp(b)?hf.gF(["ShowHideEquationToolsPane"]):[]}static qum(b,h,r){b=r.Tom(b).map(A=>{switch(A.category){case "draftContent":return"OpenCopilotComposeDraftContent";case "rewrite":return"OpenCopilotComposeL1Rewrite";
case "visualize":return"OpenCopilotComposeL1VisualizeAsTable";default:throw Error("Not supported category for compose action");}});return b.includes("OpenCopilotComposeL1Rewrite")&&b.includes("OpenCopilotComposeL1VisualizeAsTable")?hf.gF(["OpenCopilotComposeSplitButton"]):hf.gF(b)}}Object(u.a)(gi,"ContextMenuSectionItemHelper",null,[]);class oi extends hf{get gh(){return this.qb}get x2l(){return this.W4a}static get OSh(){return oi.Jch}constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd,Jd,ie,re=
!1,me=null,Sd=null,cf,sf,yh,si){super(b,h,r,re,void 0,me,cf);this.R2d=si;this.G7e=this.VK=null;this.LZe=this.lqh=!1;this.jqd=new Map;this.rE={};this.Bxb={};this.ga=b;this.J=A;this.Ni=L;this.p0=Ia;this.MM=Ta;this.xo=ob;this.eYk=!!me;this.iAf=nb;this.dno=Eb;this.Vjh=zd;this.fra=Jd;this.ukl=ie;this.W4a=yh;this.qb=sf;Yc&&Yc.execute(cl=>{this.OIh=cl});bc&&bc.execute(cl=>{this.G7e=cl});this.Jc=ra;this.Rw=Bc;Sd&&Sd.execute(cl=>{this.VK=cl});this.ncn();this.$ko();this.fcm();this.Ubm().catch(()=>{v.ULS.sendTraceTag(508679947,
3048,50,"Fetching copilot state for context menu failed.")});this.Zko()}get tCf(){return this.eYk?Zn.a.hkd:super.tCf}xAo(b){oi.Jch=b}Hbp(){const b=Pk.a.Xm.tb.Xc.ub.ob.currentSelection;return this.Xsd(b)&&2!==this.gKi(b).errorType}W4(b,h){return super.W4(b,h)||oi.J_j()||hf.z_j(b)||oi.WGg(b)||oi.C_j(b)}SNl(b,h,r){const A=[];let L=null;try{L=Pk.a.Xm.tb.Xc.ub.ob.currentSelection}catch(ba){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.Mko(L,
h,A,this.cum(L));b.MenuSectionList.push(...A);this.Z2o(b);!r&&this.OIh&&this.OIh.Woo(b.MenuTargetDescriptor.menuTargetType,A)}cum(b){return hf.fhc(fb.a.mergeCells)?Ni.IVg:b.nbd?Ni.cUg:b.GN?Ni.aVg:b.Crc()?Ni.YTg:b.AZa?Ni.QTg:Ni.hUg}aNl(b){b=oi.mNl(b);return Object.assign(new qg.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}XQl(b){return(b=oi.wkk(b))?Object.assign(new qg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}$Ml(){const b=Object.assign(new Zd.a,{ControlList:[]}),h=oi.vFi();b.ControlList.push(this.aNl(h));
return b}WQl(b){const h=Object.assign(new Zd.a,{ControlList:[]});if(b&&0<b.length){b=this.XQl(b);if(null==b)return null;h.ControlList.push(b)}return h}csc(b){return b.GN||2<b.length||!b.length||2===b.length&&!Ee.a.em(b.hd)||1===b.length&&Ee.a.em(b.hd)?!1:this.w5f(b.Ya)}w5f(b){return rd.ParagraphReader.lc(b.node)?""!==rd.ParagraphReader.text(b.node).trim():!1}Yfp(b){var h=te.a.kb(b.Ya.node);h=Object(ya.a)(di.a,h.currentNode);return b.GN?!1:!!h&&h.pr}fcm(){this.J.$("RewriteIsEnabled")||this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.Rw.execute(b=>{b.isFeatureEnabled(vj.a.Slj,!1).then(h=>{h||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.lqh=h;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}async Ubm(){v.ULS.sendTraceTag(508679949,3048,50,"Fetching copilot state for context menu.");this.LZe=await (await Object(Tm.b)(this.hIl)).isEnabled();v.ULS.sendTraceTag(508679948,3048,50,`Fetching copilot state for context menu complete. Enabled: ${this.LZe}`)}get Yxn(){return this.J.$("RewriteIsEnabled")||
this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.lqh&&!this.LZe:!1}Cfp(b){if(!this.csc(b)||b.AZa||b.Crc())return!1;b=b.Ya;if(rd.ParagraphReader.Xn(b)||Ee.a.Df(b)||Ee.a.Rm(b)){b=this.MM.KMa(b);b||(b=y.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}$Yl(b){if(1!==b.length||X.a.Zt)return!1;const h=al.a.VNa;if(h&&this.Hbp()||
qu.rF()&&!this.Xib.Wbi(b.Ya))return!1;const r=oi.Dc.isFeatureEnabled(55);return b.K(0).contextId===ic.a.kd&&(h||r)&&0<this.xo.u6c(b.K(0),0).count||h&&this.hmc(b)?!0:!1}QYl(b){return 1===b.length&&this.Vjh.YD(b.Ya.node).joa}ZOm(b){var h,r;const A=null===(h=this.R2d)||void 0===h?void 0:h.fZ(null===(r=null===b||void 0===b?void 0:b.Ya)||void 0===r?void 0:r.node);return Wk.a.kOi(A)}get By(){return null!=this.RYg?this.RYg:this.RYg=Xa.a.instance.Wa("WordEditor.Designer.IDesignerTaskPane")}get kIl(){return null!=
this.tYg?this.tYg:this.tYg=Xa.a.instance.Wa("WordEditor.Copilot.Compose.CopilotComposeTriggerConditions")}get hIl(){return null!=this.sYg?this.sYg:this.sYg=Xa.a.instance.Za("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}iZl(b){if(!this.fra.l1i()||!this.By||this.By.isVisible||!(1===b.length||2===b.length&&Ee.a.em(b.hd))||b.Gwb||!Ee.a.Rm(b.Ya)&&b.Ya.contextId!==ic.a.paragraph||b.h7i()||this.Vjh.YD(b.Ya.node).joa)return!1;const h=rd.ParagraphReader.text(b.Ya.node),r=b.Ya.contextId===ic.a.paragraph?
0:b.Ya.cpBegin,A=b.Ya.contextId===ic.a.paragraph?h.length:b.Ya.cpEnd-r;return 1>A||1500<A||D.a.jg(D.a.LFa(h.substr(r,A)))||1!=ru.a.gtb(b.Ya.node)?!1:!0}PYl(){return 32==this.ga.Vb(fb.a.Und,1)}hmc(b){return this.iAf.hmc(b)}U0d(b,h,r,A=null){this.Xsd(b)||this.iAf.U0d(b,h,r,A)}Enm(b){return this.G7e?this.G7e.Fnm(b):[]}Z2o(b){const h=this.VK?this.VK.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new af,{menuTargetType:h})}static get Dc(){return null!=oi.u_g?oi.u_g:oi.u_g=Xa.a.instance.resolve("Box4.IFeatureHelper")}static WGg(b){return y.AFrameworkApplication.b5&&
!b.AZa&&Xa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").EBn()}static Uae(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=D.a.VC(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static mNl(b){let h=WacWordeditorStrings.ContextMenuSmartLookup;(b=oi.Uae(b))&&0<b.length&&(h=String.format(WacWordeditorStrings.ContextMenuTextSmartLookup,b));return h}static wkk(b){b=oi.Uae(b);return null!=b&&0<b.length?String.format(WacWordeditorStrings.ContextMenuTextSynonyms,b):
null}static vFi(){const b=(new fr.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static o_j(b){const h=oi.Dc.isFeatureEnabled(43);return!b.wZc&&h&&!X.a.Zt&&b.AZa}static Rdp(b){const h=oi.Dc.isFeatureEnabled(43);return!b.wZc&&h&&!X.a.Zt&&b.GN}static sHg(b){return y.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")&&!b.Crc()}static C_j(b){return y.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&!b.AZa&&!b.Crc()}static Ydp(b){return b.i7i()&&y.AFrameworkApplication.ta.Pb.Ecd}static J_j(){return 2===
Pk.a.Xm.mode}static vgp(b){return b.GN}static Bfp(b){return b.GN}Tom(b){var h,r;return null!==(r=null===(h=this.kIl)||void 0===h?void 0:h.Gxm(b))&&void 0!==r?r:[]}Mko(b,h,r,A){this.Bxb[A].forEach(L=>{const ba=Object.assign(new Zd.a,{ControlList:[]}),ra=ba.ControlList;L.forEach(Ia=>{Ia instanceof wh?r.push(...this.jqd.get(Ia)(b,h,this)):ra.push(...this.rE[Ia](b,h,this))});(null===ra||void 0===ra?0:ra.length)&&r.push(ba)})}Zko(){this.jqd.set(wh.IKe,Dk.Pmm);this.jqd.set(wh.Y5b,Dk.HMm);this.jqd.set(wh.ZKe,
Dk.vwm);this.jqd.set(wh.LLe,Dk.VRm)}$ko(){this.rE[lg.EDb]=gi.ism;this.rE[lg.DTg]=gi.qum;this.rE[lg.QLe]=gi.JTm;this.rE[lg.RLe]=gi.PTm;this.rE[lg.YKe]=gi.jwm;this.rE[lg.qLe]=gi.CGm;this.rE[lg.SLe]=gi.VTm;this.rE[lg.MKe]=gi.XJf;this.rE[lg.lLe]=gi.zDm;this.rE[lg.Jyd]=gi.zFi;this.rE[lg.kLe]=gi.vCm;this.rE[lg.KLe]=gi.LRm;this.rE[lg.ULe]=gi.RVm;this.rE[lg.xLe]=gi.vNm;this.rE[lg.CLe]=gi.iPm;this.rE[lg.Myd]=gi.hFm;this.rE[lg.Pyd]=gi.fLm;this.rE[lg.yLe]=gi.Tae;this.rE[lg.tyd]=gi.getContentControls;this.rE[lg.qMe]=
gi.AYm;this.rE[lg.BLe]=gi.SOm;this.rE[lg.$Ke]=gi.dxm;this.rE[lg.SKe]=gi.rrm;this.rE[lg.TLe]=gi.GVm;this.rE[lg.RKe]=gi.Uqm;this.rE[lg.ryd]=gi.getBookmark;this.rE[lg.hLe]=gi.ABm;this.rE[lg.jLe]=gi.vna;this.rE[lg.KRa]=gi.Rsm;this.rE[lg.Jyd]=gi.zFi;this.rE[lg.bLe]=gi.Xxm}ncn(){const b=[lg.qLe,lg.SLe,lg.MKe,lg.QLe];this.Bxb[Ni.IVg]=[[lg.EDb],b,[lg.KRa],[wh.Y5b],[lg.tyd]];this.Bxb[Ni.aVg]=[[lg.EDb],[lg.SKe,lg.$Ke,lg.qMe,lg.BLe],b,[lg.KRa],[wh.Y5b]];this.Bxb[Ni.YTg]=[[lg.bLe],[lg.Myd,lg.Pyd],[lg.ryd,lg.KRa],
[wh.Y5b]];this.Bxb[Ni.hUg]=[[lg.Jyd],[lg.YKe],[wh.LLe],[wh.ZKe],[lg.EDb],[lg.DTg],[lg.lLe,lg.kLe,lg.KLe,lg.ULe],[lg.xLe,lg.CLe,lg.Pyd],[lg.Myd],b,[lg.tyd],[lg.jLe,lg.ryd,lg.hLe,lg.KRa],[lg.yLe],[lg.TLe],[lg.RKe],[wh.IKe],[lg.RLe],[wh.Y5b]];this.Bxb[Ni.cUg]=[[lg.EDb],[lg.KRa]];this.Bxb[Ni.QTg]=[[lg.EDb],[lg.kLe]];this.Bxb[Ni.Qmk]=[[lg.Jyd],[lg.YKe],[wh.LLe],[wh.ZKe],[lg.EDb],[lg.SKe],[lg.$Ke],[lg.qMe],[lg.BLe],[lg.lLe],[lg.KLe],[lg.ULe],[lg.xLe],[lg.CLe],[lg.bLe],[lg.Myd],[lg.Pyd],[lg.jLe],[lg.qLe],
[lg.SLe],[lg.MKe],[lg.QLe],[lg.ryd],[lg.hLe],[lg.KRa],[lg.yLe],[lg.tyd],[lg.TLe],[lg.RKe],[wh.IKe],[lg.RLe],[wh.Y5b]]}}oi.Jch=null;Object(u.a)(oi,"EditSurfaceContextMenu",hf,[]);var Ni;(function(b){b[b.IVg=1]="TABLE_MULTI_CELL";b[b.hUg=2]="GENERIC";b[b.aVg=3]="PICTURE";b[b.YTg=4]="EQUATION";b[b.Qmk=5]="LEGACY";b[b.cUg=6]="FLUID";b[b.QTg=7]="DRAWING"})(Ni||(Ni={}));Object(u.b)("Scenarios",Ni);class wh{}wh.IKe=new wh;wh.Y5b=new wh;wh.ZKe=new wh;wh.LLe=new wh;Object(u.a)(wh,"Sections",null,[]);var lg;
(function(b){b[b.Jyd=1]="INTENT_SUGGESTION";b[b.EDb=2]="ESSENTIALS";b[b.DTg=3]="COPILOT_COMPOSE";b[b.lLe=4]="INSIGHT";b[b.kLe=5]="ILLUSTRATION";b[b.KLe=6]="SMART_LOOKUP";b[b.ULe=7]="TRANSLATE";b[b.xLe=8]="PROOFING";b[b.CLe=9]="REWRITE_SUGGESTIONS";b[b.Myd=10]="LISTS";b[b.Pyd=11]="PARAGRAPH_OPTIONS";b[b.qLe=12]="MERGE_SPLIT_CELLS";b[b.SLe=13]="TABLE_SORT";b[b.MKe=14]="ALT_TEXT";b[b.jLe=15]="HYPERLINK";b[b.ryd=16]="BOOKMARK";b[b.hLe=17]="HEADING_LINK";b[b.KRa=18]="COMMENT";b[b.yLe=19]="PULL_QUOTE";
b[b.qMe=20]="WRAP_TEXT";b[b.BLe=21]="RESET_PICTURE";b[b.$Ke=22]="DRAW";b[b.TLe=23]="TRACK_CHANGE";b[b.RKe=24]="CATCHUP_ACTIVITIES";b[b.RLe=25]="TABLE_OF_CONTENTS";b[b.YKe=26]="DESIGNER_REVIEW";b[b.QLe=27]="TABLE_ITEMS";b[b.SKe=28]="CHANGE_PICTURE";b[b.bLe=29]="EQUATION_TOOLS";b[b.tyd=30]="CONTENT_CONTROL"})(lg||(lg={}));Object(u.b)("SectionItem",lg);class Lg extends Qf{constructor(b,h,r){super();this.Xl=null;this.Yte=(A,L,ba,ra,Ia)=>{if(1===ba)return 32;A=[];L=[];this.Ibp()&&L.push("InsertTabStopMenuSplitButton");
this.tbp()&&L.push("ClearAllTabStops");L.push("HideRuler");A.push(Lg.fHi(L));L=Object.assign(new dk.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});L.MenuSectionList.push(...A);Ia.MenuItems=L;return 32};this.ga=b;this.vv=h;this.mC=r;this.mc()}get Ykb(){return document.getElementById("WACHorizontalRuler")}get iS(){return this.vv&&this.vv.instance?this.vv.instance.Ql:1}get target(){return this.Xl}show(b,h){this.Xl=b;Qf.e3b("RulerContextMenu",b,h);v.ULS.sendTraceTag(592307397,
3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",Lg.YT);b.set("Response","Ruler Context menu invoked.");Ca.Health.instance.recordKpiUsage(Lg.kpiName,1,Lg.uca,b)}AOm(){var b=0,h=(this.target.x-ed.a.yKf(this.Ykb))/this.iS;h=rb.a.YB(h,0);var r={},A=this.mC.CRb,L=te.a.kb(A);L.Wd();if(!Qh.TableReader.Cz(L))return 32===this.ga.Zb(fb.a.CPa,2,r)&&(b=r.marginLeft),h-b;b={};L={};r=this.ga.Zb(fb.a.smd,2,b);var ba=this.ga.Zb(fb.a.Y_b,2,L);if(32!==r||32!==ba)return v.ULS.sendTraceTag(559252943,
3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ba=L.TablePosition;if(!ba||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;L=te.a.kb(A);L.Ib(14)&&(L.xd(16),r=wy.a(L,!0));A=ba.x/this.iS;for(L=0;L<r;L++)A+=b[L];return h-A}mc(){this.ga.nb(Lc.a.Yte,ic.a.application,this.Yte,96)}Ibp(){var b={},h={},r=this.ga.Zb(fb.a.CPa,2,b),A=this.ga.Zb(fb.a.lfb,2,h);if(32===r&&32===A){A=h.fw;r=rb.a.Zj(A.Kha,0);
A=1===A.specialIndentType?rb.a.Zj(A.NC,0):rb.a.Zj(A.NC-A.Bja,0);const L=rb.a.Zj(b.marginLeft,0);b=rb.a.Zj(b.marginRight,0);const ba=ed.a.yKf(this.Ykb),ra=ed.a.zKf(this.Ykb);h.isRtl?(h=ba+this.iS*Math.max(b,b+r),r=ra-this.iS*Math.max(L,L+A)):(h=ba+this.iS*Math.max(L,L+A),r=ra-this.iS*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}tbp(){var b={};if(32!==this.ga.Zb(Lc.a.N_b,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static fHi(b){const h=Object.assign(new Zd.a,
{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new qg.a,{ExternalId:r}));return h}}Lg.uca="wwaengidc";Lg.kpiName="WordRuler";Lg.YT="RulerContextMenu";Object(u.a)(Lg,"RulerContextMenu",Qf,[282]);var gp=e(291),Fu=e(1352),YI=e(471),iG=e(775),jG=e(1175),ZI=e(1707),Xw=e(719);class gC{constructor(){this.h5=this.q3i=!1;this.jCb=Xw.a.none;this.Dz=0;this.rib=1}}Object(u.a)(gC,"WrapTextPropertiesData",null,[]);var lL=e(1120);class Xk extends jG.a{constructor(b=null){super(b);this.UIh=new ZI.a;
this.vQh=new gC;this.xMh=new wq;this.jXe=!1;this.$Ui=h=>{const r=new gp.a;r.cMa=!0;r.zQ=h;return r};this.e_=()=>{const h=new gp.a;h.kUb=!1;h.zQ=fb.a.CPa;h.Ed=this.UIh;h.orc=!0;h.roa=!0;return h};this.lDj=()=>{const h=new gp.a;h.kUb=this.jXe;this.jXe=!0;h.zQ=fb.a.EPa;h.Ed=this.xMh;h.orc=!0;h.roa=!0;return h};this.Uxd=()=>{const h=new gp.a;h.kUb=!1;h.zQ=Lc.a.Bxc;h.Ed=this.vQh;h.orc=!0;h.roa=!0;return h};this.oee=(h,r)=>{const A=new gp.a;A.Ed=new Ai.DictionaryPropertySet;switch(h){case Lc.a.S9c:A.Ed.setValue(Pd.a.Qub,
r[vi.a.Number]);break;case Lc.a.P9c:A.Ed.setValue(Pd.a.Nub,r[vi.a.Number]);break;case Lc.a.Q9c:A.Ed.setValue(Pd.a.Oub,r[vi.a.Number]);break;case Lc.a.R9c:A.Ed.setValue(Pd.a.Pub,r[vi.a.Number])}return A};this.$ro=()=>{const h=new gp.a;h.Ed=new Ai.DictionaryPropertySet;h.roa=!0;return h}}initialize(){super.initialize();this.Bd.W(Lc.a.R6f,Fu.a.evb);this.Bd.W(Lc.a.U6f,Fu.a.evb);this.Bd.W(Lc.a.W6f,Fu.a.evb);this.Bd.W(Lc.a.bsg,Xk.b1a);this.Bd.W(Lc.a.mmd,Xk.b1a);this.Bd.W(Lc.a.Vrg,Xk.b1a);this.Bd.W(wb.a.xxc,
Xk.b1a);this.Bd.W(fb.a.uve,this.e_);this.Bd.W(fb.a.tve,this.e_);this.Bd.W(fb.a.sve,this.e_);this.Bd.W(fb.a.wve,this.e_);this.Bd.W(fb.a.vve,this.e_);this.Bd.W(fb.a.rve,this.e_);this.Bd.W(fb.a.Dve,this.e_);this.Bd.W(fb.a.Cve,this.e_);this.Bd.W(fb.a.Bve,this.e_);this.Bd.W(fb.a.yve,this.e_);this.Bd.W(fb.a.zve,this.e_);this.Bd.W(fb.a.Ave,this.e_);this.Bd.W(fb.a.qsg,this.e_);this.Bd.W(fb.a.psg,this.e_);this.Bd.W(fb.a.Erg,this.e_);this.Bd.W(fb.a.Grg,this.e_);this.Bd.W(fb.a.Frg,this.e_);this.Bd.W(fb.a.Drg,
this.e_);this.Bd.W(fb.a.zgb,Xk.GQn);this.Bd.W(fb.a.f2a,Xk.Weo);this.Bd.W(fb.a.EAb,Xk.zBl);Object(lL.a)()&&(this.Bd.W(fb.a.Qzc,Xk.RGn),this.Bd.W(fb.a.fsg,this.e_),this.Bd.W(fb.a.esg,this.e_));this.Bd.W(fb.a.Ysa,Xk.b1a);this.Bd.W(fb.a.l_b,Xk.b1a);this.Bd.W(fb.a.e1a,Xk.b1a);this.Bd.W(fb.a.pBa,Xk.b1a);this.Bd.W(fb.a.AFa,Xk.b1a);this.Bd.W(Lc.a.Nkd,Xk.b1a);this.Bd.W(Lc.a.w7d,Fu.a.NHf);this.Bd.W(Lc.a.x7d,this.Gxi);this.Go.W(Lc.a.Lkd,Fu.a.ZWa);this.Go.W(Lc.a.Mkd,Fu.a.ZWa);this.Bd.W(fb.a.x2b,Fu.a.P$a);this.Bd.W(fb.a.w2b,
Fu.a.P$a);this.Bd.W(fb.a.ZAb,Fu.a.P$a);this.Bd.W(fb.a.Dsg,this.mJ);this.Bd.W(fb.a.Bsg,this.mJ);this.Bd.W(fb.a.Csg,this.mJ);this.Bd.W(fb.a.nM,Xk.vqo);this.Go.W(Lc.a.gwe,Xk.Nnd);this.Go.W(Lc.a.hwe,Xk.Nnd);this.Go.W(Lc.a.iwe,Xk.Nnd);this.Go.W(Lc.a.ewe,Xk.Nnd);this.Go.W(Lc.a.fwe,Xk.Nnd);this.Bd.W(Lc.a.gwe,this.Uxd);this.Bd.W(Lc.a.hwe,this.Uxd);this.Bd.W(Lc.a.iwe,this.Uxd);this.Bd.W(Lc.a.ewe,this.Uxd);this.Bd.W(Lc.a.fwe,this.Uxd);this.Bd.W(Lc.a.xKe,Xk.FEc);this.Bd.W(Lc.a.yKe,Xk.FEc);this.Bd.W(Lc.a.zKe,
Xk.FEc);this.Bd.W(Lc.a.AKe,Xk.FEc);this.Bd.W(Lc.a.BKe,Xk.FEc);this.Bd.W(Lc.a.CKe,Xk.FEc);this.Bd.W(Lc.a.uQa,Xk.olc);this.Bd.W(Lc.a.d_j,Xk.olc);this.Bd.W(Lc.a.e_j,Xk.olc);this.Bd.W(Lc.a.$Ce,Xk.olc);this.Bd.W(Lc.a.aDe,Xk.olc);this.Bd.W(Lc.a.Ksd,Xk.olc);this.Bd.W(Lc.a.xzb,this.$ro);this.Bd.W(Lc.a.Xld,Xk.X7d);this.Bd.W(Lc.a.jve,Xk.X7d);this.Bd.W(Lc.a.kve,Xk.X7d);this.Bd.W(Lc.a.lve,Xk.X7d);this.Bd.W(Lc.a.S9c,this.oee);this.Bd.W(Lc.a.P9c,this.oee);this.Bd.W(Lc.a.Q9c,this.oee);this.Bd.W(Lc.a.R9c,this.oee);
this.Bd.W(fb.a.bva,this.$Ui);this.Bd.W(fb.a.oQb,this.$Ui);this.Bd.W(Lc.a.vzb,Xk.vzb);this.Bd.W(Lc.a.iDe,Fu.a.P$a);this.Bd.W(fb.a.Hsg,this.lDj);this.Bd.W(fb.a.Isg,this.lDj)}clearCache(){super.clearCache();this.jXe=!1;this.UIh=new ZI.a;this.vQh=new gC;this.xMh=new wq}PLf(){const b=super.PLf();b.qKa=Xk.qKa;b.z8a=Xk.z8a;return b}static get oeo(){return null!=Xk.U6g?Xk.U6g:Xk.U6g=Xa.a.instance.Wa("WordEditor.IPageCommandStringBuilder")}static get Oz(){Xk.LAa||(Xk.LAa=Xa.a.instance.Wa("WordEditor.ITableBorderManager"));
return Xk.LAa}static b1a(b,h){b=new gp.a;b.Ed=h;return b}static nrd(b,h,r){h[bg.a.Description]=b?b.DQn(r):null}static qKa(b,h){const r=Object(ya.a)(ZI.a,b.Ed),A=Object(ya.a)(YI.a,b.Ed),L=Object(ya.a)(gC,b.Ed),ba=Object(ya.a)(wq,b.Ed);let ra=!0;const Ia=Xk.oeo;switch(b.Pyb){default:ra=jG.a.qKa(b,h);break;case fb.a.uve:h[xj.a.Icon]=r.bEa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[bg.a.On]=!r.$Xb;Xk.nrd(Ia,h,0);break;case fb.a.tve:h[xj.a.Icon]=r.bEa?"PageMarginsLandscapeNarrow_48":
"PageMarginsPortraitNarrow_48";h[bg.a.On]=1===r.$Xb;Xk.nrd(Ia,h,1);break;case fb.a.sve:h[xj.a.Icon]=r.bEa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[bg.a.On]=2===r.$Xb;Xk.nrd(Ia,h,2);break;case fb.a.wve:h[xj.a.Icon]=r.bEa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[bg.a.On]=3===r.$Xb;Xk.nrd(Ia,h,3);break;case fb.a.vve:h[xj.a.Icon]=r.bEa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[bg.a.On]=4===r.$Xb;Xk.nrd(Ia,h,4);break;case fb.a.rve:h[xj.a.Icon]=
r.bEa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[bg.a.On]=5===r.$Xb;break;case fb.a.Dve:h[bg.a.On]=!r.LZb;h[bg.a.Description]=Ia?Ia.Ljd(0):null;break;case fb.a.Cve:h[bg.a.On]=1===r.LZb;h[bg.a.Description]=Ia?Ia.Ljd(1):null;break;case fb.a.Bve:h[bg.a.On]=2===r.LZb;h[bg.a.Description]=Ia?Ia.Ljd(2):null;break;case fb.a.yve:h[bg.a.On]=3===r.LZb;h[bg.a.Description]=Ia?Ia.Ljd(3):null;break;case fb.a.zve:h[bg.a.On]=4===r.LZb;h[bg.a.Description]=Ia?Ia.Ljd(4):null;break;case fb.a.Ave:h[bg.a.On]=
5===r.LZb;break;case fb.a.qsg:h[bg.a.On]=!r.bEa;break;case fb.a.psg:h[bg.a.On]=r.bEa;break;case fb.a.Erg:h[bg.a.On]=1===r.QYc;break;case fb.a.Grg:h[bg.a.On]=2===r.QYc;break;case fb.a.Frg:h[bg.a.On]=3===r.QYc;break;case fb.a.Drg:h[bg.a.On]=0===r.QYc;break;case fb.a.fsg:h[bg.a.On]=-1===r.F7f;break;case fb.a.esg:h[bg.a.On]=2===r.F7f;break;case fb.a.Dsg:h[bg.a.On]=A.fw?!A.fw.specialIndentType:!1;break;case fb.a.Bsg:h[bg.a.On]=A.fw?1===A.fw.specialIndentType:!1;h[vk.a.Image16by16Class]=A.isRtl?Ye.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):
Ye.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case fb.a.Csg:h[bg.a.On]=A.fw?2===A.fw.specialIndentType:!1;h[vk.a.Image16by16Class]=A.isRtl?Ye.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Ye.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Lc.a.gwe:h[bg.a.On]=1===L.rib;break;case Lc.a.hwe:h[bg.a.On]=8===L.rib;break;case Lc.a.iwe:h[bg.a.On]=9===L.rib;break;case Lc.a.ewe:h[bg.a.On]=3===L.rib;break;case Lc.a.fwe:h[bg.a.On]=4===L.rib;break;case Lc.a.xzb:h[bg.a.On]=
b.Ed.ka(Pd.a.hoa,!1);break;case Lc.a.vzb:h[$c.a.IsFreeForm]=!0;h[$c.a.Value]=b.Ed[Sl.a.Value];break;case fb.a.Hsg:h[Pf.a.On]=Xk.Oz.hzi(h.MenuItemId)===ba.lineStyle;break;case fb.a.Isg:h[Pf.a.On]=Xk.Oz.izi(h.MenuItemId)===ba.etc}return ra}static GQn(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new gp.a;h.Ed=b;return h}static Weo(b,
h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new gp.a;h.Ed=b;return h}static zBl(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new gp.a;h.Ed=b;return h}static RGn(b,h){b=3;switch(h.MenuItemId){case "buttonLineNumberingNone":b=-1;break;case "buttonLineNumberingContinuous":b=2}h=
new gp.a;h.Ed=b;return h}static vzb(){const b=new gp.a;b.zQ=Lc.a.vzb;b.Ed={};b.roa=!0;b.orc=!0;return b}static FEc(b,h){const r=new gp.a;r.Ed=new Ai.DictionaryPropertySet;let A=1;switch(b){case Lc.a.AKe:A=1;break;case Lc.a.BKe:A=8;break;case Lc.a.CKe:A=9;break;case Lc.a.yKe:A=3;break;case Lc.a.zKe:A=4}r.Ed.setValue(Pd.a.rib,A);r.Ed.setValue(Pd.a.AQa,h[bg.a.SourceControlId]);return r}static olc(b,h,r){b=new gp.a;b.Ed=r.InvocationMethod;return b}static vqo(b,h){b=new gp.a;b.Ed=h;return b}static Nnd(){const b=
new iG.a;b.zQ=Lc.a.Bxc;return b}static X7d(){const b=new gp.a;b.Ed=new Ai.DictionaryPropertySet;b.Bcd=!0;return b}static z8a(b,h){let r=!0;switch(b.Pyb){case Lc.a.Xld:b=b.Ed.ka(Pd.a.Qub,0);h[vi.a.Number]=b;h[vi.a.UnitType]=7;break;case Lc.a.jve:b=b.Ed.ka(Pd.a.Nub,0);h[vi.a.Number]=b;h[vi.a.UnitType]=7;break;case Lc.a.kve:b=b.Ed.ka(Pd.a.Oub,0);h[vi.a.Number]=b;h[vi.a.UnitType]=7;break;case Lc.a.lve:b=b.Ed.ka(Pd.a.Pub,0);h[vi.a.Number]=b;h[vi.a.UnitType]=7;break;default:r=jG.a.z8a(b,h)}return r}}Xk.LAa=
null;Object(u.a)(Xk,"CuiActionBridge",jG.a,[]);class hC extends Xf.a{constructor(b){super();this.XBl=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.m9o=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.V2d=this.FKb=this.waa=this.k6a=this.Baf=null;this.kOj=h=>{h.target.setAttribute(le.a.Vob,le.a.Zp);Sys.UI.DomElement.removeCssClass(this.FKb,"inactiveRowSelection");this.FKb=h.target};this.jOj=h=>{h.target.removeAttribute(le.a.Vob);Sys.UI.DomElement.addCssClass(h.target,"inactiveRowSelection")};
this.t5h=h=>{(h=h.target.parentNode)&&h!==this.FKb&&this.e6(h)};this.f5j=h=>h.Yb.keyCode===pg.a.vw?(h.Yb.stopPropagation(),!0):!1;this.NQh=h=>{if(!h.Yb)return!1;const r=h.Yb.keyCode;if(h.eventName===Fd.a.Bj){h=this.bDm(this.FKb);let A=-1;const L=sb.a.count(this.jCe)-1;r===Sys.UI.Key.down?A=h<L?h+1:0:r===Sys.UI.Key.up?A=0<h?h-1:L:r===Sys.UI.Key.home?A=0:r===Sys.UI.Key.end&&(A=L);-1!==A&&this.e6(this.waa.tBodies[0].children[A])}return!0};this.oc=b;this.Fh="<div id='AccessibilityHelpDialogBody'></div>";
this.$g="AAccessibilityHelpDialog";this.Md=6;this.Ue(0,CommonUIStrings.l_DialogClose)}get hAf(){return null}get jCe(){this.Baf||(this.Baf=this.Fdn());return this.Baf}get gpp(){return 300}get gkj(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get fkj(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get X9a(){return this.oc.Cv()}a2a(b){super.a2a(b);this.vko()}v2a(){this.showDialog(this.dialogTitle,Object(E.a)(this,this.EZk,"accHelpDialogResultHandler"));this.IPa();this.setFocus()}setFocus(){this.waa?
(this.FKb=this.waa.tBodies[0].firstChild,this.e6(this.FKb)):this.YK&&"none"!==this.YK.style.display?this.e6(this.YK):this.e6(this.mD)}cta(){this.Ce.Cb(Fd.a.Bj,this.V2d,this.NQh);if(this.waa){this.Ce.Cb(Fd.a.zi,this.waa,this.f5j);const b=this.waa.tBodies[0].children;for(let h=0;h<b.length;h++)if(Re.a.addHandler(b[h],Fd.a.focus,this.kOj),Re.a.addHandler(b[h],Fd.a.blur,this.jOj),X.a.Zt){const r=b[h].children;for(let A=0;A<r.length;A++)Re.a.addHandler(r[A],Fd.a.focus,this.t5h)}}super.cta()}hrb(){this.Ce&&
(this.Ce.Gc(Fd.a.Bj,this.V2d,this.NQh),this.waa&&this.Ce.Gc(Fd.a.zi,this.waa,this.f5j));if(this.waa){const b=this.waa.tBodies[0].children;for(let h=0;h<b.length;h++)if(Re.a.removeHandler(b[h],Fd.a.focus,this.kOj),Re.a.removeHandler(b[h],Fd.a.blur,this.jOj),X.a.Zt){const r=b[h].children;for(let A=0;A<r.length;A++)Re.a.removeHandler(r[A],Fd.a.focus,this.t5h)}}super.hrb()}IPa(){this.X9a.scope.Pu(this.oc.w0);this.X9a.scope.Pu(this.oc.x0);this.X9a.scope.bindAction(this.oc.w0,wb.a.NUc);this.X9a.scope.bindAction(this.oc.x0,
wb.a.MUc)}Q2m(b){if(!this.X9a.Al||!this.X9a.Al.Kta)return 2;var h=this.X9a.Al.Kta;if(this.waa&&(h===this.mD&&b===wb.a.NUc||h===this.k6a&&b===wb.a.MUc))this.e6(this.FKb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===wb.a.NUc?h=this.k6a:b===wb.a.MUc&&(h=this.mD),h&&this.e6(h);else if(b===wb.a.NUc)this.X9a.quc();else if(b===wb.a.MUc)this.X9a.ouc();else return 2;return 32}EZk(){}vko(){this.V2d=document.getElementById("AccessibilityHelpDialogBody")||this.zr;this.TQl();this.tQl();this.ZNl()}TQl(){if(this.hAf){var b=
document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.hAf;b.appendChild(h);this.Aka.appendChild(b)}}tQl(){if(this.jCe&&!sb.a.isEmpty(this.jCe)){this.waa=document.createElement("table");this.waa.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(le.a.fi,le.a.yWc);b.appendChild(h);var r=eb.a.m_c(14,this.XBl);h.appendChild(r);r=eb.a.m_c(14,this.m9o);h.appendChild(r);this.waa.appendChild(b);
b=document.createElement("tbody");h=0;r=this.jCe;for(const ba in r){var A=ba,L=r[ba];const ra=document.createElement("tr");ra.tabIndex=0;ra.setAttribute(le.a.fi,le.a.yWc);ra.id="SelectableTableRow"+h++;A=eb.a.m_c(15,A);ra.appendChild(A);L=eb.a.m_c(15,L);ra.appendChild(L);b.appendChild(ra)}b.style.maxHeight=this.gpp+"px";this.waa.appendChild(b);this.V2d.appendChild(this.waa)}}ZNl(){if(this.fkj&&this.gkj){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.k6a=document.createElement("a");
this.k6a.innerText=this.fkj;this.k6a.href=this.gkj;this.k6a.target="_blank";this.k6a.id=this.Vj("AccessibilityHelpDialogLink");this.k6a.className=Df.AFrame.Gkf;b.appendChild(this.k6a);this.Yc.insertBefore(b,this.Yc.lastChild)}}bDm(b){return Number.parseInvariant(b.id.substr(18))}c4(b,h,r,A=null){b&&h&&r&&(r=A?String.format(r,A):r,b[h]=r)}pMi(b,h){return X.a.fm?h:b}}Object(u.a)(hC,"AAccessibilityHelpDialog",Xf.a,[30]);class yA extends hC{constructor(b){super(b)}get dialogTitle(){return WacWordeditorStrings.AccHelpDialogWETitle}get hAf(){return WacWordeditorStrings.AccHelpDialogWESubtitle}Fdn(){const b=
this.pMi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.pMi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.c4(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.c4(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.c4(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);
this.c4(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.c4(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogShowNextFootnoteCommand,WacWordeditorStrings.AccHelpDialogShowNextFootnoteShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogShowNextEndnoteCommand,WacWordeditorStrings.AccHelpDialogShowNextEndnoteShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogShowNextCommentCommand,
WacWordeditorStrings.AccHelpDialogShowNextCommentShortcut);this.c4(r,WacWordeditorStrings.AccHelpDialogAccCheckerCommand,WacWordeditorStrings.AccHelpDialogAccCheckerShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogTrackChangesToggleCommand,WacWordeditorStrings.AccHelpDialogTrackChangesToggleShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogTrackChangesAcceptCommand,WacWordeditorStrings.AccHelpDialogTrackChangesAcceptShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogTrackChangesRejectCommand,
WacWordeditorStrings.AccHelpDialogTrackChangesRejectShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogTrackChangesPreviousCommand,WacWordeditorStrings.AccHelpDialogTrackChangesPreviousShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogTrackChangesNextCommand,WacWordeditorStrings.AccHelpDialogTrackChangesNextShortcut,b);this.c4(r,WacWordeditorStrings.AccHelpDialogGraphicFirstCommand,WacWordeditorStrings.AccHelpDialogGraphicFirstShortcut,b);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&
this.c4(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&this.c4(r,WacWordeditorStrings.AccHelpDialogActivityAnnouncementsCommand,WacWordeditorStrings.AccHelpDialogActivityAnnouncementsShortcut);(yA.Dc&&yA.Dc.isFeatureEnabled(55)||al.a.VNa)&&this.c4(r,WacWordeditorStrings.ShowIntentSuggestion,WacWordeditorStrings.ShowIntentSuggestionShortcut);return r}static get Dc(){return null!=
yA.c_g?yA.c_g:yA.c_g=Xa.a.instance.Wa("Box4.IFeatureHelper")}}Object(u.a)(yA,"AccessibilityHelpDialog",hC,[]);var au=e(403);class es{static get Qoa(){if(null!=es.f6g)var b=es.f6g;else{var h;zi.a.rx("DialogBoxChangesEnabled;DialogBoxChangesEnabledCf");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DialogBoxChangesEnabled",!1);b=es.f6g=b}return b}static get Fh(){return Xf.a.iA(es.pp,this.Qoa?WordEditorIntl.WordEditorStrings.l_MoreStylePlaceholder:
WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}es.pp=es.Qoa?"<div class='normal' id='text'><input type='text' id='styleText' class='WACDialogInput' placeholder={0} autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>":"<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(u.a)(es,"ApplyStylesDialogHtml",null,[]);const tw=RegExp("[{|}|;|\\\\]"),mL=b=>{if(!b)return"";const h=WacWordeditorStrings.CreateNewStyleDialogDefaultStyle,r=b.ix;let A;for(A=1;A<=r;A++){const L=h+A;if(!(b.Nca(L)||b.wnc(L)||b.Nca(L+"Char")||b.wnc(L+"Char")))break}return h+A};class rr extends Xf.a{constructor(b,h,r,A,L){var ba,ra,Ia,Ta;super(!1,!1,!0);this.context=b;this.Tb=h;this.I4=r;this.kc=A;this.A0a=L;this.j5d=null;this.wEj=(ob,nb)=>{if(this.ke.Ly){if(0!==ob){ob="string"===typeof nb.styleText?
nb.styleText:null;nb=this.Std;var Eb=ob;const bc=D.a.LFa(Eb);let Bc=null;if(0===bc.length)Bc=WacWordeditorStrings.StyleNameEmpty;else if(253<Eb.length)Bc=WacWordeditorStrings.StyleNameOverMaxLength;else if(tw.test(Eb))Bc=WacWordeditorStrings.StyleNameRestrictedCharacters;else if(nb.Ena(Eb)||nb.wnc(bc))Bc=WacWordeditorStrings.StyleNameAlreadyExists;(nb=Bc)?(this.j5d=nb,nb=mL(this.Std),ob=this.wSb(ob,nb),this.j5d=null,this.S_=!1,this.hide(),this.ti(WacWordeditorStrings.CreateNewStyle,this.wEj,ob),this.S_=
!0):(this.hide(),nb=new Map,nb.set("Source","ReactCreateNewStyleDialog"),nb.set("Action","CreateStyle"),Ca.Health.instance.recordKpiUsage(Up.a.jHa,0,Up.a.GB,nb),this.aif(ob)||(ob=new Map,ob.set("Source","ReactCreateNewStyleDialog"),ob.set("Action","CreateStyle"),ob=Object.assign(new Sa.a,{extendedProperties:ob}),Ca.Health.instance.recordKpiFailure(Up.a.jHa,"CreateStyleFailed",!1,!0,ob)))}else this.hide();this.ke.I$()}};this.$g="CreateNewStyleDialog";this.ke=b.view;(b=null===(Ta=null===(Ia=null===
(ra=null===(ba=this.ke)||void 0===ba?void 0:ba.ub)||void 0===ra?void 0:ra.ob)||void 0===Ia?void 0:Ia.currentSelection)||void 0===Ta?void 0:Ta.Ya)?(ba=b.node)?(this.Kh=this.A0a.kw(ba))?(this.Std=(new uu.a).pna(this.Kh),(this.IYb=this.I4.d6d(b))?(ba=this.IYb.ka(Sb.a.fontSize,22),16>ba?Cd.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ba?Cd.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ba?Cd.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):
Cd.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.hwg(this.IYb),this.Kh&&this.IYb&&(this.rfa=!1,ba=mL(this.Std),ba=this.wSb(ba,ba),this.ti(rr.Qoa?WordEditorIntl.WordEditorStrings.l_CreateNewStyleTitle:WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.wEj,ba))):Cd.b(592737758,3018,10,"_newStyleProperties is null.")):Cd.b(592737757,3018,10,"_pageContenNode is null."):Cd.b(592725466,3018,10,"node is null."):Cd.b(556917206,3018,10,"nodeContext is null.")}hwg(b){b.fg(Tc.a.uA,
Tc.a.wy,...Up.a.Pca())}wSb(b,h){const r=52<=this.IYb.ka(Sb.a.fontSize,Qa.a.AL),A=Mz.a.OLf(this.IYb,"97%",26,!1,!0,r);rr.Qoa||(A["padding-left"]="5px",r||(A["line-height"]="40px"));rr.Qoa&&(A["text-wrap"]="wrap",A.position="relative");const L={};rr.Qoa&&(L.border="0px",L.height="auto",L["min-height"]="20px",L["max-height"]="80px");b={["styleNameLabel"]:rr.Qoa?WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogNameText:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:rr.Qoa?
WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogPreview:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:rr.Qoa?WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogPreviewText:h,["getPreviewStyle"]:()=>A,["getPreviewContainerStyle"]:()=>L};this.j5d&&(b.errorMessage=this.j5d);return{["id"]:this.$g,["bodyControls"]:b}}aif(b){const h=new hb.GraphTransaction(15);h.Eb(this.Kh);h.Bh=fb.a.qPb;const r=Wj.a.aif(b,Wj.a.kKi(this.IYb),
null,this.Kh);r&&(Cd.b(593078046,3018,50,"User created linked style"),this.Std=(new uu.a).pna(this.Kh),b=D.a.LFa(D.a.N1(b)),b=this.Std.wnc(b),this.Tb.Sf(this.context,fb.a.FQ,2,!1,new au.a,this.kc.Je(b)));h.dispose();return r}static get Qoa(){if(null!=rr.e6g)var b=rr.e6g;else{var h;zi.a.rx("DialogBoxChangesEnabled;DialogBoxChangesEnabledCf");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DialogBoxChangesEnabled",!1);b=rr.e6g=b}return b}}
Object(u.a)(rr,"ReactCreateNewStyleDialog",Xf.a,[]);class qr extends Xf.a{constructor(b,h){super();this.kL=null;this.kTc=!1;this.$Lb=this.Zib=this.zPc=this.DPc=this.ATc=null;this.Qel=(r,A)=>{if(this.Rh.Ly){if(r){r=A.styleList;A=A.styleText;if(-1===r||D.a.Ph(A)!==D.a.Ph(this.kL[r]))r=this.IMi(A);A=this.kL[r];r=this.kc.Il();Wj.a.Zf.zl?(r=r.Ev(),A=this.kc.Je(r.Ena(A))):A=this.kc.Je(r.Rua(A));y.AFrameworkApplication.va.Sf(this._context,fb.a.FQ,2,!1,new au.a,A)}this.Rh.I$()}};this.pao=r=>{this.kTc?(this.kTc=
!1,this.validate()):"value"===r.rawEvent.propertyName&&(this.kTc=!0,this.T3.value!==this.ATc&&(this.ATc=this.T3.value,this.B_h()))};this.M6n=()=>{-1!==this.vsa.selectedIndex&&(X.a.c2&&(this.kTc=!0),this.ATc=this.kL[this.vsa.selectedIndex],this.T3.value=this.kL[this.vsa.selectedIndex],this.validate())};this.onKeyDown=r=>{X.a.cO?r.keyCode!==pg.a.IF&&r.keyCode!==pg.a.G6||this.Zib||this.$Lb||(this.$Lb=new Md.a(0,1,1,this.NLp),y.AFrameworkApplication.zc.pc(this.$Lb)):X.a.c2&&r.keyCode===pg.a.IF&&(this.kTc=
!0)};this.qK=()=>{this.Zib||(this.Zib=new Md.a(0,1,1,this.vhl),y.AFrameworkApplication.zc.pc(this.Zib));this.$Lb&&(y.AFrameworkApplication.zc.Kf(this.$Lb),this.$Lb=null)};this.vhl=()=>{this.Zib=null;this.B_h()};this.NLp=()=>{this.$Lb=null;this.validate()};this._context=b;this.Qd=h;this.$g="ApplyStylesDialog";this.Rh=this._context.view;this.sRf();b=this.Lmp();h="";!rr.Qoa&&this.kL.length>b&&(h=this.kL[b]);h={["styleText"]:h,["styleList"]:b};this.Fh=es.Fh;this.ti(rr.Qoa?WordEditorIntl.WordEditorStrings.l_Morestyles:
WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.Qel,h);this.vsa=document.getElementById("styleList");this.dpg();this.vsa.selectedIndex=b;this.T3=document.getElementById("styleText");this.T3.focus();this.T3.select();this.zLd=this.M6n;Re.a.addHandler(this.vsa,"change",this.zLd);this.yLd=this.onKeyDown;Re.a.addHandler(this.T3,"keydown",this.yLd);X.a.c2?(this.DPc=this.pao,Re.a.addHandler(this.T3,"propertychange",this.DPc),this.ATc=this.kL[b]):(this.zPc=this.qK,Re.a.addHandler(this.T3,"keypress",this.zPc))}get kc(){return null!=
this.qbh?this.qbh:this.qbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Zf(){return null!=this.P9g?this.P9g:this.P9g=Xa.a.instance.Wa("Box4.Styles.StyleSettings")}Lmp(){var b=this.Rh.ub;if(!b||!b.ob)return Cd.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.ob.currentSelection;if(!b)return Cd.b(579216409,3018,15,"CurrentSelection is null"),0;rd.ParagraphReader.Xn(b.Ya)&&(b=Ee.a.Xk(b,!0,!1));b=b.Ya;if(!b||!Ee.a.Ny(b))return Cd.b(579216410,3018,15,"Received invalid nodeContext, null={0}",
!b),0;var h=pb.a.uu(b);(h=pb.a.Wua(h))||(h=this.kc.Lr(b.node));if(!h)return 0;b=this.kc.ML(h);b=Array.indexOf(this.kL,b);0>b&&(b=0);return b}dpg(){const b=this.kL.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.kL[h];this.vsa.add(r,null)}}sRf(){var b=Wj.a.Pp();if(b){if(this.Zf.zl){var h=(new uu.a).pna(b);b=h.ix}else{var r=(new uu.a).Oca(b);b=r.ix}var A=this.Qd.isFeatureEnabled(103)&&!!this.kc.th;this.kL=[];for(let L=0;L<b;L++){let ba;ba=r instanceof
uu.a?r.nDa(L):h.uha(L);if(this.kc.isHidden(ba))continue;const ra=this.kc.wH(ba);if(!A){if(3===ra)continue}else if(3===ra&&this.kc.Je(ba)===pF.a.OYb)continue;Array.add(this.kL,this.kc.ML(ba))}this.kL.sort(qr.ADl)}else Cd.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.DPc&&Re.a.removeHandler(this.T3,"propertychange",this.DPc);this.yLd&&Re.a.removeHandler(this.T3,"keydown",this.yLd);this.zLd&&Re.a.removeHandler(this.vsa,"change",this.zLd);this.zPc&&Re.a.removeHandler(this.T3,"keypress",
this.zPc);this.Zib&&y.AFrameworkApplication.zc.Kf(this.Zib);this.Zib=this.zPc=this.vsa=this.T3=this.yLd=this.DPc=this.zLd=null;super.dispose()}B_h(){var b=this.T3.value,h=this.ubn(b);const r=-1===h?b:this.kL[h];b=b.length;const A=r.length;this.ATc=r;this.T3.value=r;this.vsa.selectedIndex=h;A>b&&(X.a.cO?this.T3.setSelectionRange(b,A):X.a.c2&&(h=this.T3.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",A-b),h.select()));this.validate();this.T3.focus()}ubn(b){let h=0,
r=this.kL.length,A=-1;for(b=D.a.Ph(b);h<r;){const L=Math.floor((h+r)/2),ba=qr.Atf(b,this.kL[L]);if(!ba){A=L;break}0<ba?h=L+1:r=L}if(A>h)for(;!qr.Atf(b,this.kL[A-1])&&(A--,A!==h););return A}validate(){const b=-1===this.IMi(this.T3.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WacWordeditorStrings.BadStyleName):(h.style.display="none",h.innerText="");return!b}IMi(b){b=D.a.Ph(b);const h=this.kL.length;for(let r=0;r<h;r++)if(b===D.a.Ph(this.kL[r]))return r;
return-1}static Atf(b,h){const r=Math.min(b.length,h.length);b=D.a.Ph(b);h=D.a.Ph(h);for(let A=0;A<r;A++){const L=D.a.charCodeAt(b,A),ba=D.a.charCodeAt(h,A);if(L!==ba)return L-ba}return b.length<=h.length?0:1}static ADl(b,h){return qr.Atf(b,h)}}Object(u.a)(qr,"ApplyStylesDialog",Xf.a,[]);var uw=e(235);class nz extends wg.StandardDialog{constructor(b){super();this.Hx=b;this.Jdp()}Jdp(){this.Md=1;this.YW(1);this.Ue(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Yx(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,
Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.xzf.bind(this))}xzf(b){1===b&&this.Hx.Mpa("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.wj?Cd.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.Yk,h.Yk.stack):(this.mOo(),Cd.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}mOo(){uw.a.eDb="{}"}}Object(u.a)(nz,"DeleteSavedStylesConfirmationDialog",wg.StandardDialog,[]);class Zx extends wg.StandardDialog{constructor(b,h){super();
this.xzf=L=>{if(1===L){L=new Map;L.set("Source","DeleteStyleConfirmationDialog");L.set("Action","DeleteStyle");Ca.Health.instance.recordKpiUsage(Up.a.jHa,0,Up.a.GB,L);var ba=Wj.a.Pp();L=new hb.GraphTransaction(15);L.Eb(ba);L.Bh=fb.a.bQb;this.nO.iji(this.TLh)?Cd.b(578359694,3018,50,"User deleted a style via UI."):(ba=new Map,ba.set("Source","DeleteStyleConfirmationDialog"),ba.set("Action","DeleteStyle"),ba=Object.assign(new Sa.a,{extendedProperties:ba}),Ca.Health.instance.recordKpiFailure(Up.a.jHa,
"DeleteStyleFailed",!1,!0,ba),Cd.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));L.dispose()}};h||Cd.b(590128417,3018,10,"styleId is null");let r=null,A=null;if(this.Rh=b.view)A=this.Rh.ub;A&&(r=A.ob.currentSelection.Ya);r?(b=r.node)?(this.DO=Object(ao.a)().kw(b))?(this.TLh=new Cb.a,this.TLh.add(h),this.Kdp(h)):Cd.b(590128448,3018,10,"_pageContenNode is null."):Cd.b(590128419,3018,10,"node is null."):Cd.b(590128418,3018,10,"nodeContext is null.")}get nO(){return null!=
this.hbh?this.hbh:this.hbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get kc(){return null!=this.zbh?this.zbh:this.zbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Kdp(b){const h=(new uu.a).Oca(this.DO);h?(b=h.Qg(b))?(b=this.kc.ML(b),this.Md=4,this.YW(2),this.Yx(rr.Qoa?WordEditorIntl.WordEditorStrings.l_DeleteStyle:CommonUIStrings.l_DefaultDialogTitle,String.format(rr.Qoa?WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogText:WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,
b),0,this.xzf)):Cd.b(590128450,3018,10,"Style set doesn't contain style with given ID"):Cd.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(u.a)(Zx,"DeleteStyleConfirmationDialog",wg.StandardDialog,[]);class kG{static get Fh(){return Xf.a.iA(kG.pp)}}kG.pp="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(u.a)(kG,"DeleteStyleDialogHtml",null,[]);class bu extends Xf.a{constructor(b){super();this.DO=this.kL=
null;this.lXl=(h,r)=>{this.Rh.Ly&&(h?(h=r.styleList,-1!==h&&(h=this.kL[h],r=this.kc.Il(),Wj.a.Zf.zl?(r=r.Ev(),h=this.kc.Je(r.Ena(h))):h=this.kc.Je(r.Rua(h)),this.R0c.Bji(this._context,h),this.Rh.I$())):this.Rh.I$())};this._context=b;this.$g="DeleteStyleDialog";this.Md=1;this.Ue(1,WacWordeditorStrings.DeleteStyleDialogButton);this.Rh=this._context.view;this.sRf();this.Fh=kG.Fh;this.ti(WacWordeditorStrings.DeleteStyle,this.lXl,{["styleList"]:0});this.vsa=document.getElementById("styleList");this.dpg();
this.vsa.selectedIndex=0;this.vsa.focus()}get kc(){return null!=this.tbh?this.tbh:this.tbh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get R0c(){return null!=this.TYg?this.TYg:this.TYg=Xa.a.instance.resolve("WordEditor.UI.IDialogFactory")}dpg(){const b=this.kL.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.kL[h];this.vsa.add(r,null)}}sRf(){if(this.DO=Wj.a.Pp()){var b=(new uu.a).Oca(this.DO),h=b.Ev();var r=Wj.a.Zf.zl?h.ix:b.ix;this.kL=
[];for(let L=0;L<r;L++){let ba;ba=Wj.a.Zf.zl?h.uha(L):b.nDa(L);if(!this.kc.isHidden(ba)&&this.kc.ye(ba,b)){var A=this.kc.wH(ba);if(2===A||1===A)ba.hasProperty(Rc.a.linkedStyle)&&2!==A||(A=ba.ka(Rc.a.cG,null))&&0<A.length||this.kL.push(this.kc.ML(ba))}}this.kL.sort()}else Cd.b(578650370,3018,15,"PageContentNode is null")}}Object(u.a)(bu,"DeleteStyleDialog",Xf.a,[]);var nL=e(801);class oL{constructor(b){this.customData=null;this.nT=b}}Object(u.a)(oL,"PropertySetChangedState",null,[]);class lG{static Ioo(b,
h,r){if(b&&h){var A=new oL(h),L=(ba,ra,Ia)=>{r.Hoo(ba,ra,Ia,A)};b=new nL.a(h,b);b.bVd=L;b.CYd=L;b.Vxe=L;b.X0a()}}}Object(u.a)(lG,"PropertySetChangedManager",null,[]);class mG{constructor(b){this.EUa=b}Hoo(b,h,r,A){const L=this.EUa[b.id.toString()];L&&L(b,h,r,A)}}Object(u.a)(mG,"PropertyChangedProcessor",null,[]);const nG=(b,h,r)=>{const A=Js.a.instance.CRb;if(A){const L=new hb.GraphTransaction(15);L.Eb(A);lG.Ioo(b,h,new mG(r));L.dispose()}};class iC{static get Fh(){return Xf.a.iA(iC.pp,WacWordeditorStrings.MarginsDialogMarginTop,
WacWordeditorStrings.MarginsDialogMarginLeft,WacWordeditorStrings.MarginsDialogMarginBottom,WacWordeditorStrings.MarginsDialogMarginRight)}}iC.pp="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(u.a)(iC,"MarginsDialogHtml",null,[]);class hp{static get b$(){return null!=hp.V6g?hp.V6g:hp.V6g=Xa.a.instance.Wa("WordEditor.IPageCommands")}static CQn(b,h,r){hp.b$&&null!==r&&hp.b$.sBe(0,r)}static yQn(b,h,r){hp.b$&&null!==r&&hp.b$.sBe(3,r)}static AQn(b,h,r){hp.b$&&null!==r&&hp.b$.sBe(1,r)}static BQn(b,h,r){hp.b$&&null!==r&&hp.b$.sBe(2,r)}static efo(b,h,r){hp.b$&&null!==r&&hp.b$.f2a(0,r)}static Deo(b,h,r){hp.b$&&null!==r&&hp.b$.f2a(1,r)}static ABl(b,h,r){hp.b$&&null!==r&&(b==Me.a.columnCount?
hp.b$.EAe(0,r):b==Me.a.CI?hp.b$.EAe(1,r):b==Me.a.uta?hp.b$.EAe(2,r):b==Me.a.separator&&hp.b$.EAe(3,r))}}Object(u.a)(hp,"PageLevelPropertyChangedHandlers",null,[]);const Fv=[Lc.a.pjd,Lc.a.ojd,Lc.a.dse,Lc.a.ese,Lc.a.qve,Lc.a.nve,Lc.a.ove,Lc.a.pve];class sr extends Xf.a{constructor(b,h,r,A,L){super();this.H4c=(ba,ra)=>{var Ia=sr.Fld(ba);ba=Ze.a.qda;this.Dr.hasProperty(Ia)?(Ia=this.Dr.getValue(Ia),ra[vi.a.Number]=fg.a.BRa(Ia,ba)):ra[vi.a.Number]=0;ra[vi.a.UnitType]=ba};this.Sqd=(ba,ra)=>{this.Dr.setValue(sr.Fld(ba),
fg.a.iRa(ra[vi.a.Number],ra[vi.a.UnitType]));this.Yw.qo()};this.EQn=ba=>{let ra=!1;1===ba&&(Math.abs(this.Dr.getValue(Rc.a.marginTop))+Math.abs(this.Dr.getValue(Rc.a.marginBottom))+Ze.a.iHa<=this.UAa.getValue(Rc.a.pageHeight)&&this.Dr.getValue(Rc.a.marginLeft)+this.Dr.getValue(Rc.a.marginRight)+Ze.a.iHa<=this.UAa.getValue(Rc.a.pageWidth)?nG(this.BIa,this.Dr,sr.enc()):ra=!0);this.dispose();ra&&this.iQa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.zQn)};this.zQn=()=>{Xa.a.instance.resolve("WordEditor.UI.IDialogFactory").Rei(this.BIa,
this.UAa,this.Raa)};this.$g="MarginsDialog";this.UAa=h.clone();this.BIa=b.clone();this.Dr=b.clone();this.Raa=r;this.S_=!1;this.Yw=L;this.Fh=iC.Fh;r&&(this.BIc=Ot.a.v4b);this.ti(WacWordeditorStrings.PageMargins,this.EQn,null);this.C$c();this.Obf=document.getElementById("DialogMarginTopSpinner");this.e6(this.Obf)}Cda(){this.sXd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Lc.a.pjd,Lc.a.qve,WacWordeditorStrings.MarginsDialogMarginTopAlt);this.sXd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Lc.a.ojd,Lc.a.nve,WacWordeditorStrings.MarginsDialogMarginBottomAlt);this.sXd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Lc.a.dse,Lc.a.ove,WacWordeditorStrings.MarginsDialogMarginLeftAlt);this.sXd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Lc.a.ese,Lc.a.pve,WacWordeditorStrings.MarginsDialogMarginRightAlt)}C$c(){for(const b of Fv)Object(Yl.a)(b,this.Sqd,this.H4c);this.Yw.Uwa("DialogMarginTopSpinner");this.Yw.Uwa("DialogMarginBottomSpinner");
this.Yw.Uwa("DialogMarginLeftSpinner");this.Yw.Uwa("DialogMarginRightSpinner")}dispose(){for(const b of Fv)Object(Yl.b)(b);this.Yw.I2("DialogMarginTopSpinner");this.Yw.I2("DialogMarginBottomSpinner");this.Yw.I2("DialogMarginLeftSpinner");this.Yw.I2("DialogMarginRightSpinner");super.dispose()}sXd(b,h,r,A,L){r=sr.knl(h,r,A,L);this.oNb(r,b,h)}oNb(b,h,r){h=document.getElementById(h);this.Yw.h8a(r,b);b=this.Yw.xSb(r,"Medium");h.appendChild(b)}static enc(){return sr.EUa||(sr.EUa=sr.kic())}static kic(){const b=
{};b[Rc.a.marginTop.id.toString()]=hp.CQn;b[Rc.a.marginBottom.id.toString()]=hp.yQn;b[Rc.a.marginLeft.id.toString()]=hp.AQn;b[Rc.a.marginRight.id.toString()]=hp.BQn;return b}static knl(b,h,r,A){let L=!0;if(h===Lc.a.pjd||h===Lc.a.ojd)L=!1;return Zh.j(b,h,r,A,[sr.mnl(L),sr.lnl(L)])}static mnl(b){return Zh.l("inch",b?"0":"-22","22",".1")}static lnl(b){return Zh.l("centimeter",b?"0":"-55.8","55.8","1")}static Fld(b){let h=null;switch(b){case Lc.a.pjd:case Lc.a.qve:h=Rc.a.marginTop;break;case Lc.a.ojd:case Lc.a.nve:h=
Rc.a.marginBottom;break;case Lc.a.dse:case Lc.a.ove:h=Rc.a.marginLeft;break;case Lc.a.ese:case Lc.a.pve:h=Rc.a.marginRight}return h}}sr.EUa=null;Object(u.a)(sr,"MarginsDialog",Xf.a,[]);class sm{static get Fh(){return Xf.a.iA(sm.pp,WacWordeditorStrings.PaperSizeDialogWidth,WacWordeditorStrings.PaperSizeDialogHeight)}}sm.pp="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(sm,"PaperSizeDialogHtml",null,[]);const $I=[Lc.a.hse,Lc.a.gse,Lc.a.Fve,Lc.a.Eve];class Jr extends Xf.a{constructor(b,h,r,A,L){super();this.H4c=(ba,ra)=>{var Ia=this.Fld(ba);ba=Ze.a.qda;this.Dr.hasProperty(Ia)?(Ia=this.Dr.getValue(Ia),ra[vi.a.Number]=fg.a.BRa(Ia,ba)):ra[vi.a.Number]=0;ra[vi.a.UnitType]=ba};this.Sqd=(ba,ra)=>{this.Dr.setValue(this.Fld(ba),fg.a.iRa(ra[vi.a.Number],ra[vi.a.UnitType]));this.Yw.qo()};this.rfo=ba=>{let ra=!1;1===ba&&(this.Dr.getValue(Rc.a.pageHeight)>=Ze.a.iHa+
this.UAa.getValue(Rc.a.marginTop)+this.UAa.getValue(Rc.a.marginBottom)&&this.Dr.getValue(Rc.a.pageWidth)>=Ze.a.iHa+this.UAa.getValue(Rc.a.marginLeft)+this.UAa.getValue(Rc.a.marginRight)?nG(this.BIa,this.Dr,Jr.enc()):ra=!0);this.dispose();ra&&this.iQa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.qfo)};this.qfo=()=>{Xa.a.instance.resolve("WordEditor.UI.IDialogFactory").sfi(this.BIa,this.UAa,this.Raa)};this.$g="PaperSizeDialog";this.UAa=h.clone();this.BIa=b.clone();this.Dr=b.clone();this.Raa=
r;this.S_=!1;this.Yw=L;this.Fh=sm.Fh;r&&(this.BIc=Ot.a.v4b);this.ti(WacWordeditorStrings.PaperSizeDialogTitle,this.rfo,null);this.C$c();this.Obf=document.getElementById("DialogWidthSpinner");this.e6(this.Obf)}Cda(){this.S1h("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Lc.a.hse,Lc.a.Fve,WacWordeditorStrings.PaperSizeDialogWidthAlt);this.S1h("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Lc.a.gse,Lc.a.Eve,WacWordeditorStrings.PaperSizeDialogHeightAlt)}C$c(){for(const b of $I)Object(Yl.a)(b,
this.Sqd,this.H4c);this.Yw.Uwa("DialogWidthSpinner");this.Yw.Uwa("DialogHeightSpinner")}dispose(){for(const b of $I)Object(Yl.b)(b);this.Yw.I2("DialogWidthSpinner");this.Yw.I2("DialogHeightSpinner");super.dispose()}S1h(b,h,r,A,L){r=Jr.Anl(h,r,A,L);this.oNb(r,b,h)}oNb(b,h,r){h=document.getElementById(h);this.Yw.h8a(r,b);b=this.Yw.xSb(r,"Medium");h.appendChild(b)}Fld(b){let h=null;switch(b){case Lc.a.gse:case Lc.a.Eve:h=Rc.a.pageHeight;break;case Lc.a.hse:case Lc.a.Fve:h=Rc.a.pageWidth}return h}static enc(){return Jr.EUa||
(Jr.EUa=Jr.kic())}static kic(){const b={};b[Rc.a.pageWidth.id.toString()]=hp.efo;b[Rc.a.pageHeight.id.toString()]=hp.Deo;return b}static Anl(b,h,r,A){return Zh.j(b,h,r,A,[Jr.Cnl(),Jr.Bnl()])}static Cnl(){return Zh.l("inch",Jr.$0j,Jr.vEn,Jr.Vhp)}static Bnl(){return Zh.l("centimeter",Jr.$0j,Jr.uEn,Jr.Uhp)}}Jr.$0j="0";Jr.vEn="22";Jr.Vhp=".1";Jr.Uhp="1";Jr.uEn="55.8";Jr.EUa=null;Object(u.a)(Jr,"PaperSizeDialog",Xf.a,[]);class zA extends Xf.a{constructor(b,h=!1,r){super(!1,!1,h);let A=h=this.xO=null;this.$g=
zA.id;this.Rh=b.view;this.Tp=r;this.Rh&&(A=this.Rh.ub);A&&A.ob&&A.ob.currentSelection&&(h=A.ob.currentSelection.Ya);h?(b=h.node)?(this.DO=Object(ao.a)().kw(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}xLp(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.jnm();const A=""===D.a.LFa(b),L=b.length>zA.PRn;r=r.includes(b);h=h.test(b);b=b.startsWith("_");
let ba=null;if(A||L||r||b||!h)ba=A?WacWordeditorStrings.BookmarkNameEmpty:L?WacWordeditorStrings.BookmarkNameOverMaxLength:b?WacWordeditorStrings.BookmarkNameRestrictedCharacters:h?WacWordeditorStrings.BookmarkNameAlreadyExists:WacWordeditorStrings.BookmarkNameRestrictedCharacters;return ba}xmn(b,h){return b?b===h:!1}jnm(){const b=this.Tp.d8d(!1),h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Rc.a.Wv,"");h.push(A)}return h}}zA.id="BookmarkEditDialog";zA.PRn=40;Object(u.a)(zA,"AEditBookmarkDialog",
Xf.a,[]);class pL extends zA{constructor(b,h,r){super(b,!0,r);this.MUe=null;this.k5a="wwaengidc";this.aNc="ReactCreateEditBookmarkNameDialog";this.Pwh="EditBookmarkName";this.Saa="EditBookmarkNameDialog";this.POe=h;this.Tp=r;this.DO&&(this.rfa=!1,b=this.wSb(h.properties.ka(Rc.a.Wv,null)),this.ti(WacWordeditorStrings.EditBookmark,this.yEj.bind(this),b))}yEj(b,h){if(this.Rh.Ly){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.POe.hasProperty(Rc.a.Wv)?r=this.POe.getValue(Rc.a.Wv):
v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.xLp(b);this.xmn(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.MUe=h,r=this.wSb(b),this.MUe=null,this.S_=!1,this.hide(),this.ti(WacWordeditorStrings.EditBookmark,this.yEj.bind(this),r),this.S_=!0):(this.hide(),r=new Map,r.set("Source",this.aNc),r.set("Action",this.Pwh),Ca.Health.instance.recordKpiUsage(this.Saa,0,this.k5a,r),this.Vtl(b)||
(r=new Map,r.set("Source",this.aNc),r.set("Action",this.Pwh),r=Object.assign(new Sa.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(this.Saa,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.Rh.I$()}}Vtl(b){b=D.a.LFa(D.a.N1(b));try{const h=this.Tp.ACp(this.POe,b);if(h)v.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return v.ULS.sendTraceTag(539762887,
3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}wSb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.MUe;h.bookmarkTextLabel=WacWordeditorStrings.EditBookmarkDialogLabelName;return{["id"]:this.$g,["bodyControls"]:h}}}Object(u.a)(pL,"ReactEditBookmarkNameDialog",zA,[]);class gt extends Xf.a{constructor(b,h,r,A){super(!1,!1,!0);this.xBl=()=>{this.R0c.Cdi(this.xWi,this.AJe,this.qdd)};this.yBl=(L,ba)=>{ba&&1===L&&(ba.columnsCountSpinButtonProps&&this.l2.setValue(Me.a.columnCount,
ba.columnsCountSpinButtonProps.value),ba.columnsWidthSpinButtonProps&&(L=ba.columnsWidthSpinButtonProps,this.l2.setValue(Me.a.CI,[fg.a.iRa(L.value,fg.a.HWa(L.unitType.toLowerCase()))])),ba.columnsSpacingSpinButtonProps&&(L=ba.columnsSpacingSpinButtonProps,this.l2.setValue(Me.a.uta,fg.a.iRa(L.value,fg.a.HWa(L.unitType.toLowerCase())))),ba.columnsLineBetweenCheckboxProps&&this.l2.setValue(Me.a.separator,ba.columnsLineBetweenCheckboxProps.checked),this.BBl()&&(ba=gt.YWd,this.Pfl()?nG(this.xWi,this.l2,
this.enc):ba=ba!==gt.YWd?ba:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ba!==gt.YWd&&this.iQa(ba,this.xBl)))};this.BBl=()=>this.l2.hasProperty(Me.a.columnCount)&&this.l2.hasProperty(Me.a.CI)&&this.l2.hasProperty(Me.a.uta)&&this.l2.hasProperty(Me.a.separator);this.w8d=(L,ba,ra)=>Math.floor((L-(ba-1)*ra)/ba);this.HKf=(L,ba,ra)=>1==ba?0:Math.floor((L-ba*ra)/(ba-1));this.e$k=(L,ba,ra,Ia)=>{const Ta=L/ba;ra<gt.eBc?(ra=gt.eBc,Ia=this.HKf(L,ba,ra)):ra>Ta&&(ra=Ta,Ia=this.HKf(L,ba,ra));
return[ra,Ia]};this.b$k=(L,ba,ra,Ia)=>{const Ta=(L-gt.eBc*ba)/(ba-1);0>Ia?(Ia=0,ra=this.w8d(L,ba,Ia)):Ia>Ta&&(Ia=Ta,ra=this.w8d(L,ba,Ia));return[ra,Ia]};this.iRa=(L,ba)=>fg.a.iRa(L,fg.a.HWa(ba));this.O_c=(L,ba,ra,Ia,Ta)=>({["unitType"]:L,["unitPlaceholder"]:D.a.Hte(ba),["minValue"]:ra,["maxValue"]:Ia,["step"]:Ta});this.xWi=b.clone();this.l2=b.clone();this.AJe=h.clone();this.Syb=this.AJe.getValue(Rc.a.pageWidth)-this.AJe.getValue(Rc.a.marginLeft)-this.AJe.getValue(Rc.a.marginRight);this.gYb=Math.floor(this.Syb/
gt.eBc);this.qdd=r;this.R0c=A;this.$g=gt.id;b={};b.getUnitValue=3==Ze.a.qda?fg.a.kD:fg.a.m3a;b.getCalculatedWidthValue=this.w8d;b.getCalculatedSpacingValue=this.HKf;b.twipsFromValueAndUnits=this.iRa;b.adjustWidthForLimits=this.e$k;b.adjustSpacingForLimits=this.b$k;b.pageContentWidth=this.Syb;b.maxColumnCount=this.gYb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.Csm();
b.columnsWidthSpinButtonProps=this.Gsm();b.columnsSpacingSpinButtonProps=this.Esm();b.columnsLineBetweenCheckboxProps=this.Dsm();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.ti(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.yBl.bind(this),b)}Csm(){var b=[this.O_c("None",0,1,this.gYb,1)];const h=this.hRf(Me.a.columnCount);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,
["unitType"]:fg.a.H9a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.G2b(h,b)}Gsm(){var b=[this.O_c("Inch",3,.5,fg.a.kD(this.Syb),.1),this.O_c("Centimeter",1,1.27,fg.a.m3a(this.Syb),1)];const h=Ze.a.qda,r=this.hRf(Me.a.CI);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,
["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:fg.a.H9a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.G2b(r,b)}Esm(){var b=[this.O_c("Inch",3,0,fg.a.kD(this.Syb-2*gt.eBc),.1),this.O_c("Centimeter",1,0,fg.a.m3a(this.Syb-2*gt.eBc),1)];const h=Ze.a.qda,r=this.hRf(Me.a.uta);b={["type"]:"AppSpinButtonProps",
["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:fg.a.H9a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.G2b(r,b)}Dsm(){const b=this.l2.getValue(Me.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",
["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get enc(){return null!=this.K0g?this.K0g:this.K0g=(()=>this.vxf())()}vxf(){const b={};b[Me.a.columnCount.id.toString()]=b[Me.a.CI.id.toString()]=b[Me.a.uta.id.toString()]=b[Me.a.separator.id.toString()]=hp.ABl;return b}Pfl(){const b=this.l2.getValue(Me.a.CI),h=this.l2.getValue(Me.a.columnCount),r=this.l2.getValue(Me.a.uta);let A=0;for(let L=0;L<h;L++)A+=b[0];
if(h<=this.gYb&&(h-1)*r+A<=this.Syb)return!0;v.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}hRf(b){if(this.l2.hasProperty(b)){if(b==Me.a.columnCount)return this.l2.getValue(b);if(b==Me.a.CI){var h=Ze.a.qda;b=this.l2.getValue(Me.a.uta);const r=this.l2.getValue(Me.a.columnCount);return fg.a.BRa(this.w8d(this.Syb,r,b),h)}if(b==Me.a.uta){if(1==this.l2.getValue(Me.a.columnCount))return 0;
h=Ze.a.qda;b=this.l2.getValue(b);return fg.a.BRa(b,h)}}return 0}G2b(b,h){h.value=isNaN(b)?gt.YWd:b;return h}}gt.id="ColumnsDialog";gt.YWd="";gt.eBc=720;Object(u.a)(gt,"WordReactColumnsDialog",Xf.a,[]);var lM=e(493),im=e(904);class vw{constructor(){this.u1j=this.Rwj=this.Pwj=this.xfo=this.Qmg=!1}}Object(u.a)(vw,"Box4PropertySetChangedState",null,[]);class Al{static get apc(){return null!=Al.w1g?Al.w1g:Al.w1g=Xa.a.instance.Wa("Box4.IIndentationCommands")}static get h$i(){return null!=Al.c5g?Al.c5g:
Al.c5g=Xa.a.instance.Wa("Box4.IJustificationCommands")}static get D$(){return null!=Al.n9g?Al.n9g:Al.n9g=Xa.a.instance.Wa("Box4.ISpacingCommands")}static rDn(b,h,r){Al.h$i&&r&&(null===h||11!==r||10!==h&&9!==h)&&Al.h$i.qJ(r)}static XGn(b,h,r){Al.D$&&r&&Al.D$.HG(r)}static OGl(b,h,r){h!=r&&Al.D$.Lzc(r)}static EDn(b,h,r){h!=r&&Al.D$.krd(r)}static gOp(b,h,r){h!=r&&Al.D$.Yrd(r)}static CDn(b,h,r){h!=r&&Al.D$.jrd(r)}static Wwj(b,h,r,A){Al.D$&&void 0!==r&&null!==r&&(b=Al.$4c(A),!b.Qmg&&A.nT.hasProperty(Pd.a.jwc)&&
A.nT.hasProperty(Pd.a.kwc)&&(h=A.nT.getValue(Pd.a.kwc),A=A.nT.getValue(Pd.a.jwc),b.Qmg=!0,Al.D$.tja(1,h,A)))}static Vwj(b,h,r,A){Al.D$&&void 0!==r&&null!==r&&(b=Al.$4c(A),!b.xfo&&A.nT.hasProperty(Pd.a.hwc)&&A.nT.hasProperty(Pd.a.iwc)&&(h=A.nT.getValue(Pd.a.iwc),A=A.nT.getValue(Pd.a.hwc),b.Qmg=!0,Al.D$.tja(0,h,A)))}static Owj(b,h,r,A){Al.apc&&void 0!==r&&null!==r&&(b=Al.$4c(A),!b.Pwj&&A.nT.hasProperty(Pd.a.kPa)&&A.nT.hasProperty(Pd.a.lPa)&&(h=A.nT.getValue(Pd.a.lPa),A=A.nT.getValue(Pd.a.kPa),b.Pwj=
!0,Al.apc.TUj(1,h,A)))}static Qwj(b,h,r,A){Al.apc&&void 0!==r&&null!==r&&(b=Al.$4c(A),!b.Rwj&&A.nT.hasProperty(Pd.a.Vyb)&&A.nT.hasProperty(Pd.a.Wyb)&&(h=A.nT.getValue(Pd.a.Wyb),A=A.nT.getValue(Pd.a.Vyb),b.Rwj=!0,Al.apc.TUj(0,h,A)))}static fIg(b,h,r,A){Al.apc&&void 0!==r&&null!==r&&(b=Al.$4c(A),!b.u1j&&A.nT.hasProperty(Pd.a.C2a)&&A.nT.hasProperty(Pd.a.D2a)&&(h=0,A.nT.hasProperty(Pd.a.E$)&&(h=A.nT.getValue(Pd.a.E$)),r=A.nT.getValue(Pd.a.D2a),A=A.nT.getValue(Pd.a.C2a),b.u1j=!0,Al.apc.MBe(h,r,A)))}static $4c(b){b.customData||
(b.customData=new vw);return b.customData}}Object(u.a)(Al,"ParagraphLevelPropertyChangedHandlers",null,[]);class Wq{constructor(){this.EUa=null}PKm(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=im.a("Point",5,0,1584,1),A=im.a("Line",4,0,327,1),L=[r,A];A=im.d();var ba=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];var ra;({fBc:Ta,Qhb:Ia,Rpc:ra}=im.c(b,Pd.a.kwc,Pd.a.jwc));var Ia=
{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:fg.a.H9a(Ia),["validUnits"]:L,["numberFormatInfo"]:A,["validReservedValues"]:ba};ra?Ia.reservedValue=ba[0]:Ia.value=isNaN(Ta)?"":Ta;h.beforeSpacingSpinButtonProps=Ia;({fBc:Ta,Qhb:Ia,Rpc:ra}=im.c(b,Pd.a.iwc,Pd.a.hwc));L={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:fg.a.H9a(Ia),["validUnits"]:L,["numberFormatInfo"]:A,["validReservedValues"]:ba};ra?L.reservedValue=ba[0]:L.value=isNaN(Ta)?"":Ta;h.afterSpacingSpinButtonProps=L;ba=(L=b.hasProperty(Pd.a.xa))&&im.f(b,Wq.sdb.YSb(b));L=L?im.g(b,Wq.sdb.YSb(b),ba):null;var Ta={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,
["showLabel"]:!0,["options"]:im.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};L?Ta.selectedKey=L:Ta.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ta;L=0;Ta=!1;b.hasProperty(Pd.a.xa)&&b.hasProperty(Pd.a.tdb)&&2===b.getValue(Pd.a.tdb)&&ba&&(L=Wq.sdb.YSb(b),
Ta=!0,1>L&&(L=Number.NaN));b=[im.a("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:A,["validReservedValues"]:r};Ta?b.value=L:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}enc(){return this.EUa||(this.EUa=this.kic())}kic(){const b={};b[Pd.a.xa.id.toString()]=Al.XGn;b[Pd.a.iwc.id.toString()]=
Al.Vwj;b[Pd.a.hwc.id.toString()]=Al.Vwj;b[Pd.a.kwc.id.toString()]=Al.Wwj;b[Pd.a.jwc.id.toString()]=Al.Wwj;return b}static get sdb(){return null!=Wq.p5g?Wq.p5g:Wq.p5g=Xa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(u.a)(Wq,"ReactParagraphDialog",null,[]);const aJ=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,AA=(b,h,r,A)=>{let L=Ze.a.qda;b.hasProperty(h)&&b.hasProperty(r)&&!A?(h=b.getValue(h),b=b.getValue(r),h?2===b?L=2:h=fg.a.BRa(h,L):Ze.a.ONa&&(L=2)):(h=Number.NaN,
Ze.a.ONa&&(L=2));return{fBc:h,Qhb:L}},fs=b=>{let h="0";b.hasProperty(Pd.a.E$)&&(b=b.getValue(Pd.a.E$),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},zq=(b,h)=>{if(h.hasProperty(Pd.a.E$)&&2===h.getValue(Pd.a.E$)&&h.hasProperty(Pd.a.D2a)&&h.hasProperty(Pd.a.C2a)&&b.hasProperty(Pd.a.lPa)&&b.hasProperty(Pd.a.kPa)){var r=b.getValue(Pd.a.lPa),A=b.getValue(Pd.a.kPa);r=(new yl.a(A,r)).ww;A=h.getValue(Pd.a.D2a);h=h.getValue(Pd.a.C2a);h=(new yl.a(h,A)).ww;b.setValue(Pd.a.lPa,r+h);b.setValue(Pd.a.kPa,
1)}},oz=b=>{const h=b.getValue(Pd.a.lPa);b=b.getValue(Pd.a.kPa);return(new yl.a(b,h)).ww},Gu=b=>{const h=b.getValue(Pd.a.Wyb);b=b.getValue(Pd.a.Vyb);return(new yl.a(b,h)).ww},zo=(b,h)=>h.hasProperty(Pd.a.lPa)&&h.hasProperty(Pd.a.kPa)&&h.hasProperty(Pd.a.Wyb)&&h.hasProperty(Pd.a.Vyb)&&b.hasProperty(Rc.a.marginLeft)&&b.hasProperty(Rc.a.marginRight)&&b.hasProperty(Rc.a.pageWidth),mM=b=>b.hasProperty(Pd.a.Sjd)?b.getValue(Pd.a.Sjd):!1,Yw=b=>b.hasProperty(Me.a.keepWithNext)?b.getValue(Me.a.keepWithNext):
!1,QL=b=>b.hasProperty(Me.a.widowControl)?b.getValue(Me.a.widowControl):!1,RL=b=>b.hasProperty(Me.a.keepTogether)?b.getValue(Me.a.keepTogether):!1;class BJ extends Xf.a{constructor(b,h,r,A){super(!1,!1,!0);this.uQh=null;this.Jfo=()=>{Xa.a.instance.resolve("Box4.UI.IBox4DialogFactory").l1d(this.BIa,this.UAa,this.Raa)};this.Lfo=(Ta,ob)=>{if(ob&&(1===Ta||2===Ta)){if(ob.alignmentComboBoxProps){var nb=parseInt(ob.alignmentComboBoxProps.selectedKey);isNaN(nb)||aJ(nb)&&this.Dr.setValue(Pd.a.Dz,nb)}var Eb=
ob.bySpinButtonProps;nb=!!Eb&&""!==Eb.value;var bc=ob.didChangeSpecialIndentationComboBoxValue;if(ob.specialIndentationComboBoxProps){var Bc=parseInt(ob.specialIndentationComboBoxProps.selectedKey);1!==Bc&&2!==Bc&&Bc||!(Bc||bc||nb)||this.Dr.setValue(Pd.a.E$,Bc)}if(Eb){Bc=Eb.value;Eb=fg.a.HWa(Eb.unitType.toLowerCase());let Yc;0<=Bc||(Bc=0);2===Eb?Yc=2:(Yc=1,Bc=fg.a.iRa(Bc,Eb));if(nb||bc)this.Dr.setValue(Pd.a.D2a,Bc),this.Dr.setValue(Pd.a.C2a,Yc)}ob.beforeTextSpinButtonProps&&(bc=ob.beforeTextSpinButtonProps,
nb=fg.a.HWa(bc.unitType.toLowerCase()),bc=""===bc.value?Number.NaN:bc.value,isNaN(bc)||(Bc=bc,2===nb?Eb=2:(Eb=1,Bc=fg.a.iRa(bc,nb)),this.Dr.setValue(Pd.a.lPa,Bc),this.Dr.setValue(Pd.a.kPa,Eb)));ob.afterTextSpinButtonProps&&(bc=ob.afterTextSpinButtonProps,nb=fg.a.HWa(bc.unitType.toLowerCase()),bc=""===bc.value?Number.NaN:bc.value,isNaN(bc)||(Bc=bc,2===nb?Eb=2:(Eb=1,Bc=fg.a.iRa(bc,nb)),this.Dr.setValue(Pd.a.Wyb,Bc),this.Dr.setValue(Pd.a.Vyb,Eb)));ob.beforeSpacingSpinButtonProps&&(nb=ob.beforeSpacingSpinButtonProps,
bc=fg.a.HWa(nb.unitType.toLowerCase()),Bc=nb.reservedValue,""!==nb.value&&(Bc===Box4Intl.Box4Strings.L_SpinnerAuto?(bc=1,nb=0):(bc=4===bc?2:4,nb=nb.value),this.Dr.setValue(Pd.a.kwc,nb),this.Dr.setValue(Pd.a.jwc,bc)));ob.afterSpacingSpinButtonProps&&(nb=ob.afterSpacingSpinButtonProps,bc=fg.a.HWa(nb.unitType.toLowerCase()),Bc=nb.reservedValue,""!==nb.value&&(Bc===Box4Intl.Box4Strings.L_SpinnerAuto?(bc=1,nb=0):(bc=4===bc?2:4,nb=nb.value),this.Dr.setValue(Pd.a.iwc,nb),this.Dr.setValue(Pd.a.hwc,bc)));
if(ob.atSpinButtonProps||ob.lineSpacingComboBoxProps)if(nb=ob.atSpinButtonProps.value,1<nb)this.Dr.setValue(Pd.a.xa,nb),this.Dr.setValue(Pd.a.tdb,2);else if(nb=ob.lineSpacingComboBoxProps.selectedKey)nb=im.e(nb),nb=1<=nb?nb:1,this.Dr.setValue(Pd.a.xa,nb),this.Dr.setValue(Pd.a.tdb,2);ob.contextualSpacingCheckboxProps&&this.Dr.setValue(Pd.a.Sjd,ob.contextualSpacingCheckboxProps.checked);ob.keepWithNextCheckboxProps&&this.Dr.setValue(Me.a.keepWithNext,ob.keepWithNextCheckboxProps.checked);ob.widowOrphanCheckboxProps&&
this.Dr.setValue(Me.a.widowControl,ob.widowOrphanCheckboxProps.checked);ob.keepTogetherCheckboxProps&&this.Dr.setValue(Me.a.keepTogether,ob.keepTogetherCheckboxProps.checked);zq(this.BIa,this.BIa);zq(this.Dr,this.BIa);ob="";nb=this.UAa;bc=this.Dr;if(Bc=zo(nb,bc))Bc=bc.hasProperty(Pd.a.D2a)&&bc.hasProperty(Pd.a.C2a);Bc?(Bc=bc.getValue(Pd.a.D2a),Eb=bc.getValue(Pd.a.C2a),Bc=(new yl.a(Eb,Bc)).ww,nb=oz(bc)+Gu(bc)+nb.getValue(Rc.a.marginRight)+nb.getValue(Rc.a.marginLeft)+Bc+Ze.a.iHa<=nb.getValue(Rc.a.pageWidth)):
nb=zo(nb,bc)?oz(bc)+Gu(bc)+nb.getValue(Rc.a.marginRight)+nb.getValue(Rc.a.marginLeft)+Ze.a.iHa<=nb.getValue(Rc.a.pageWidth):!0;nb?nG(this.BIa,this.Dr,this.rYm(this.xaf?this.xaf.kic():{})):ob=""!==ob?ob:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==ob?this.iQa(ob,this.Jfo):2===Ta&&($d.c(Lc.a.JAc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Zb(Lc.a.JAc,2,null))}};this.BIa=b.clone();this.Dr=b.clone();this.UAa=h.clone();this.Raa=r;this.ga=A;this.xaf=new Wq;
b=this.xaf.PKm(this.Dr);h=im.a("Inch",3,-11,22,.1);r=im.a("Inch",3,0,22,.1);var L=im.a("Centimeter",1,-27.94,55.88,1);A=im.a("Centimeter",1,0,55.88,1);var ba=im.a("Character",2,-316.8,316.8,.5),ra=im.a("Character",2,0,316.8,.5);h=[h,L,ba];A=[r,A,ra];r=im.d();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};L=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,
Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ba=["1","2","3","6","7"];let Ia=5;ra=this.Dr.hasProperty(Pd.a.Dz)?this.Dr.getValue(Pd.a.Dz):0;if(10===ra||9===ra)ra=11;if(y.AFrameworkApplication.lcid===Wg.a.Vg("AR-SA").LCID||11===ra)b.isKashidaSupported=!0,L[Ia]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ba[Ia]="11",Ia=6;if(y.AFrameworkApplication.lcid===Wg.a.Vg("TH-TH").LCID||13===
ra)b.isThaiSupported=!0,L[Ia]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ba[Ia]="13";L={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:im.b(L,ba),["allowFreeForm"]:!1};aJ(ra)?L.selectedKey=ra.toString():L.defaultSelectedKey="";b.alignmentComboBoxProps=L;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:Yw(this.Dr)};b.keepWithNextCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:QL(this.Dr)};b.widowOrphanCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:RL(this.Dr)};b.keepTogetherCheckboxProps=ra;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};L=fs(this.Dr);ra="0"===L;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:im.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:L,["allowFreeForm"]:!1};ba=Ze.a.qda;L=0;({fBc:L,Qhb:ba}=AA(this.Dr,Pd.a.D2a,Pd.a.C2a,ra));A={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:fg.a.H9a(ba),["validUnits"]:A,["numberFormatInfo"]:r};A=this.G2b(L,A);b.bySpinButtonProps=A;ra=Ze.a.qda;A=0;({fBc:A,Qhb:ra}=AA(this.Dr,Pd.a.lPa,Pd.a.kPa,!1));ra={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:fg.a.H9a(ra),["validUnits"]:h,["numberFormatInfo"]:r};ra=this.G2b(A,ra);b.beforeTextSpinButtonProps=ra;ra=Ze.a.qda;A=0;({fBc:A,
Qhb:ra}=AA(this.Dr,Pd.a.Wyb,Pd.a.Vyb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:fg.a.H9a(ra),["validUnits"]:h,["numberFormatInfo"]:r};h=this.G2b(A,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,
["checked"]:mM(this.Dr)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=lM.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?void 0:"left",["margin-left"]:"0"}}};this.ti(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Lfo,
h)}rYm(b){return this.uQh||(this.uQh=this.vxf(b))}vxf(b){b[Pd.a.Dz.id.toString()]=Al.rDn;b[Pd.a.kPa.id.toString()]=Al.Owj;b[Pd.a.lPa.id.toString()]=Al.Owj;b[Pd.a.Vyb.id.toString()]=Al.Qwj;b[Pd.a.Wyb.id.toString()]=Al.Qwj;b[Pd.a.E$.id.toString()]=Al.fIg;b[Pd.a.C2a.id.toString()]=Al.fIg;b[Pd.a.D2a.id.toString()]=Al.fIg;b[Pd.a.Sjd.id.toString()]=Al.OGl;b[Me.a.keepWithNext.id.toString()]=Al.EDn;b[Me.a.widowControl.id.toString()]=Al.gOp;b[Me.a.keepTogether.id.toString()]=Al.CDn;return b}G2b(b,h){h.value=
isNaN(b)?"":b;return h}}Object(u.a)(BJ,"WordReactParagraphDialog",Xf.a,[]);class CJ{YJl(b){new qr(b,Xa.a.instance.resolve("Box4.IFeatureHelper"))}mOl(b,h){new rr(b,h,Xa.a.instance.resolve("Box4.IFormattingReader"),Xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Object(ao.a)())}E4l(b,h,r){new pL(b,h,r)}Rei(b,h,r){new sr(b,h,r,Xa.a.instance.resolve("WordEditor.IPageCommands"),Xa.a.instance.resolve("Common.IStandaloneRootController").yja)}sfi(b,h,r){new Jr(b,h,r,Xa.a.instance.resolve("WordEditor.IPageCommands"),
Xa.a.instance.resolve("Common.IStandaloneRootController").yja)}Cdi(b,h,r){new gt(b,h,r,Xa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}qJl(b){return new yA(b)}l1d(b,h,r){new BJ(b,h,r,y.AFrameworkApplication.va)}gXl(){const b=Xa.a.instance.Wa("Box4.IRoamingServiceRequestManager");null==b?Cd.b(524834398,3018,10,"Roaming service not resolved."):new nz(b)}Bji(b,h){new Zx(b,h)}yzf(b){return new bu(b)}}Object(u.a)(CJ,"DialogFactory",null,[274,275]);class xC extends Xf.a{constructor(b,h,r=null){super(!1,
!1,!0);this.hmi="DoNotCheckSpellingCheckbox";this.Zmf="AutoDetectLanguageCheckbox";this.tmi="DocumentChoiceGroup";this.wCd=0;this.C$i="LanguageList";this.documentContext="DocumentContext";this.lw="RangeContext";this.Zvl="CheckmarkWithDynamicColor_16";this.Lfa=null;this.f2o=(A,L)=>{const ba=$g.a.instance.vr(fb.a.oUj);if(1!==A)ba.properties.W("canceled","true");else{A=L[this.C$i].replace(xC.hVg,"");var ra=parseInt(A),Ia=Boolean.parse(L[this.hmi]),Ta;kz.a.npa&&(Ta=Boolean.parse(L[this.Zmf]));L=L[this.tmi];
""!==L&&(L===this.documentContext?this.WId.O_o(ra,Ia):this.WId.o5o(ra,Ia));kz.a.npa&&this.Zmf&&null!==this.Lfa&&this.Lfa.ZSo(Ta);ba.properties.W("PreviousLCID",this.wCd.toString());ba.properties.W("ChangedLCID",ra.toString());ba.properties.W("NoProof",Ia.toString());kz.a.npa&&ba.properties.W("AutoDetect",Ta.toString());this.Uwh.e2o(ra,this.wCd);$d.d(fb.a.oUj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"SelectedLcid",string:A}),Object.assign(new ma.a,{name:"NoProof",string:Ia.toString()}),
Object.assign(new ma.a,{name:"Context",string:L}),kz.a.npa?Object.assign(new ma.a,{name:"AutoDetect",string:Ta.toString()}):null].filter(Boolean));Db.StaticActiveAppFrame.Aa().Ne(!0)}ba.end()};this.Uwh=h;this.WId=b;this.Lfa=r}YGg(){const b=Array(2);b[0]={["key"]:this.lw,["text"]:WacWordeditorStrings.SelectedText};b[1]={["key"]:this.documentContext,["text"]:WacWordeditorStrings.CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.tmi,["defaultSelectedKey"]:this.Yvm(),["label"]:WacWordeditorStrings.ChangeProofingLanguage,["options"]:b};this.wCd=({Iqo:this.yyk}=this.WId.oQm()).returnValue;h.languageListPropsProvider=this.iEm();h.spellingCheckboxProps={["id"]:this.hmi,["checked"]:!this.yyk,["label"]:WacWordeditorStrings.DoNotCheckSpellingOrGrammar};kz.a.npa&&(h.autoDetectLanguageCheckboxProps={["id"]:this.Zmf,["checked"]:null!==this.Lfa?this.Lfa.YPf():!1,["label"]:WacWordeditorStrings.AutoDetectLanguage,["checkmarkIcon"]:this.Zvl});
this.ti(Box4Intl.Box4Strings.l_Language,this.f2o,{["id"]:"LanguageDialog",["bodyControls"]:h})}Yvm(){return this.WId.Df()?kz.a.npa?"":this.documentContext:this.lw}iEm(){return()=>{let b,h;const r=({selectedIndex:b,iBc:h}=this.Uwh.hEm(this.wCd)).returnValue;for(let A=0;A<r.length&&A<h;A++)r[A].value=xC.hVg+r[A].value;return{["id"]:this.C$i,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}xC.hVg="recent-";Object(u.a)(xC,"ReactLanguageDialog",Xf.a,[191]);class yz extends B{constructor(b,
h,r,A){super(h,r);this.Fog=()=>{this.oT.qo()};this.mi=b;this.IM=A}gqb(b,h,r){if(b=super.gqb(b,h,r))b.Ywc=!0,b.sue=!0,b.preventDismissOnScroll=!0;this.mi.GVa(this.Fog);return b}x$c(b,h,r=null){this.IM.d0h(()=>this.gqb(b,h,r))}aqe(){this.oT.Ywc=!0}}Object(u.a)(yz,"ExternalContentFloatieInitializer",B,[]);class ks{h_b(){Gl.instance.fia&&(ft.instance.$hb([1,0]),Gl.instance.ake()&&zs.instance.$hb([1]))}}Object(u.a)(ks,"RulerUser",null,[189]);class DJ{constructor(){this.whitelistedControlIds=null}}Object(u.a)(DJ,
"StatusBarProps",null,[]);class aE{constructor(b,h,r=!0){this.sa=new Nf.a;this.R2j=()=>4;this.FNd=!1;this.F8e=null;this.Ela=h.UH;this.Rbf=h.O2j;r?Fk.a.get_instance().Zk(7,()=>{this.V1h(b,h)}):this.V1h(b,h)}V1h(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();mp.a.instance.Ae(()=>{Tk.UISurfaces.oSm().then(A=>{r.StatusBarApiResolutionTime=Date.now();const L=Object.assign(new DJ,{whitelistedControlIds:h.whitelistedControlIds});
A.initializeNewStatusBar(b,L,this.Rbf);this.F8e=A;this.FNd=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=Date.now();mp.a.instance.Ae(()=>{const ba=[];if(h.KK){const ra=h.KK;for(const Ia in ra)ba.push(appChrome.actions.updateControlHiddenState(Ia,ra[Ia]));appChrome.api.dispatch(ba)}r.PollingStartTime=Date.now();this.h_b();r.PollingEndTime=Date.now();v.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&
this.Ouo();return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Xxa&&b){aE.$ph||(y.AFrameworkApplication.va.qa(wb.a.Q2j,dd.a.frame,this.R2j),y.AFrameworkApplication.va.qa(wb.a.P2j,dd.a.frame,this.R2j),aE.$ph=!0);const A=Ot.a.efe(h.Xxa,h.ETj,b,!1);A.LN=!0;this.i0b(A,wb.a.Q2j,wb.a.P2j)}},0)}h_b(){this.FNd&&this.Ela&&window.setTimeout(()=>{this.Ela(this.F8e.selectors.getStatusBarControlsMap(this.Rbf),7)},0)}FAb(b,h){this.FNd&&
window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}OW(b){this.FNd&&this.Ela&&window.setTimeout(()=>{const h=this.F8e.selectors.getStatusBarControlsMap(this.Rbf);if(h[b]){const r={};r[b]=h[b];this.Ela(r,7)}},0)}i0b(b,h,r){const A=lc.KeyInputManager.xc(pg.a.iB,0),L=lc.KeyInputManager.xc(pg.a.iB,4);b.Pu(A);b.Pu(L);b.bindAction(A,h);b.bindAction(L,r)}Ouo(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}aE.$ph=!1;Object(u.a)(aE,"ReactStatusBar",
null,[]);class qL{constructor(){this.whitelistedControlIds=this.KK=this.UH=null;this.bCn=!1;this.ETj=this.Xxa=this.O2j=null}}Object(u.a)(qL,"ReactStatusBarInitOptions",null,[]);var Gv=e(485);class cu{constructor(b,h,r,A,L){this.Mbc=this.FUa=this.za=null;this.wlp=()=>{const ba=Db.StaticActiveAppFrame.Aa().yr.getRegion(Uk.a.Xxa);ba&&ba.qcg()};this.q3m=(ba,ra,Ia,Ta,ob)=>{if(!ob)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ia)return 32;
ob&&2===ob.length&&this.FUa&&this.FUa.FAb(ob[0],ob[0]);return 32};this.Jwd=ba=>{Db.StaticActiveAppFrame.Aa().UH(ba)};this.ga=A;mp.a.instance.Ae(()=>{this.za=L;this.Mbc=this.FUa=null;const ba={};y.AFrameworkApplication.Q_j||(ba[Gv.a.pRo]=!0);ba.GiveFeedback=!y.AFrameworkApplication.uE;this.za.$("OfficeOnlineInGallatinTextVisible")||(ba.CenterStatusLabel=!0);ba[Gv.a.lwj]=!0;this.za.$("WPMPackageIsEnabled")&&this.za.$("WPMStatusBarLabelIsEnabled")||(ba[Gv.a.WSg]=!0);this.za.$("AddInCommandsIsEnabled")||
(ba[Gv.a.q2k]=!0);this.za.$("WordEditorShowOcsConnectionStatus")||(ba[Gv.a.Qgg]=!0);ba[Gv.a.XOp]=!0;this.za.$("ReadingTimeIsEnabled")||(ba[Gv.a.LEj]=!0);window.setTimeout(()=>{this.Len(b,ba)},0)},"SBU:I")}mc(){this.ga.nb(fb.a.wEe,ic.a.application,this.q3m,96)}Len(b,h){this.Mbc=Xa.a.instance.Wa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(const L in h){var A=h[L];r[this.eQf(L)]=A}this.FUa=new aE(b,Object.assign(new qL,{KK:r,UH:this.Jwd,bCn:!1,O2j:"WordEditorStatusBar",Xxa:Uk.a.Xxa,
ETj:this.wlp}))}eQf(b){let h="";if(this.Mbc){const r=this.Mbc.HMf(b);r&&0<r.count&&(h=r.K(0))}return h&&""!==h?h:b}h_b(){this.FUa&&this.FUa.h_b()}FAb(b,h){this.FUa&&this.FUa.FAb(this.eQf(b),h)}OW(b){this.FUa&&this.FUa.OW(this.eQf(b))}dispose(){}}Object(u.a)(cu,"StatusBarUser",null,[188,11]);var yC=e(1578);class $x{constructor(b){this.Mod=(h,r,A,L,ba)=>{this.ga.Vb(this.Nym(ba[yC.a.Ese]),2);return 32};this.ga=b;this.ga.qa(wb.a.Mod,dd.a.frame,this.Mod);this.ga.qa(wb.a.dLj,dd.a.frame,qf.ActionManager.qg)}}
Object(u.a)($x,"FileMenuSQMInformation",null,[1825]);class DE extends $x{constructor(b){super(b);this.zBo()}zBo(){this.ga.qa(wb.a.xxg,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.YKj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.yxg,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.ZKj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.$Kj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.zxg,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.aLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.bLj,dd.a.frame,
qf.ActionManager.qg);this.ga.qa(wb.a.cLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.WKj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.CLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.XKj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.DLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.gLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.hLj,dd.a.frame,qf.ActionManager.qg)}Nym(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return wb.a.xxg;case "tabHome":case "FileHomePage":return y.AFrameworkApplication.ud("1ba3i132;45gid285"),
wb.a.YKj;case "menuJewelInfo":case "FileInfoPage":return wb.a.yxg;case "menuJewelNew":case "FileNewPage":return wb.a.ZKj;case "menuJewelOpen":case "FileOpenPage":return wb.a.$Kj;case "menuJewelPrint":case "FilePrintPage":return wb.a.zxg;case "menuJewelSaveAs":case "FileSaveAsPage":return wb.a.aLj;case "menuJewelDownload":case "FileDownloadPage":return Lc.a.XKj;case "menuJewelShare":case "FileSharePage":return wb.a.bLj;case "menuJewelTransform":case "FileTransformPage":return wb.a.cLj;case "menuJewelDelete":case "FileDeletePage":return wb.a.WKj}return wb.a.dLj}}
Object(u.a)(DE,"WordEditorFileMenuSQMInformation",$x,[]);var Pv=e(1572);class bv{constructor(b){this.ga=b;this.ga.qa(wb.a.Nod,dd.a.frame,Object(E.a)(this,this.Nod,"reportTabSwitch"));this.ga.qa(wb.a.yLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.zLj,dd.a.frame,qf.ActionManager.qg)}Nod(b,h,r,A,L){this.ga.Vb(this.lPm(L[Pv.a.tKg]),2);return 32}}Object(u.a)(bv,"RibbonSQMInformation",null,[1784]);class gs extends bv{constructor(b){super(b);this.UDo()}UDo(){this.ga.qa(wb.a.pLj,dd.a.frame,qf.ActionManager.qg);
this.ga.qa(wb.a.rLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.Bxg,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.sLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(wb.a.tLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.uLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.vLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.wLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.xLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.Cxg,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.Ood,dd.a.frame,qf.ActionManager.qg);
this.ga.qa(wb.a.ALj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.BLj,dd.a.frame,qf.ActionManager.qg);this.ga.qa(Lc.a.qLj,dd.a.frame,qf.ActionManager.qg)}lPm(b){var h,r;switch(b){case "tabAddins":case "Addins":return wb.a.pLj;case "tabHome":case "Home":return wb.a.sLj;case "tabInsert":case "Insert":return wb.a.tLj;case "tabDeveloper":case "Developer":return wb.a.rLj;case "tabPageLayout":case "Layout":return Lc.a.uLj;case "tabReferences":case "References":return Lc.a.xLj;case "tabReview":case "Review":return Lc.a.Cxg;
case "tabView":case "View":return wb.a.ALj;case "Table":return(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.tableCellSizeUpdate",!1))&&Object(mh.i)("getRibbonMode")&&"SingleLine"===appChrome.selectors.getRibbonMode()?Lc.a.kud:Lc.a.Ood;case "TableLayout":return(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.tableCellSizeUpdate",!1))?Lc.a.kud:Lc.a.Ood;case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Lc.a.Ood;
case "tabMailings":case "Mailings":return Lc.a.vLj;case "tabWordDesign":case "Design":return Lc.a.BLj;case "tabHelp":case "Help":return Lc.a.Bxg;case "ctabPictureTools":case "Picture":return Lc.a.wLj;case "Copilot":return Lc.a.qLj}return wb.a.zLj}}Object(u.a)(gs,"WordEditorRibbonSQMInformation",bv,[]);class hx{constructor(b=null,h=null,r=null){this.KK=b||{};this.R8j=h||[];this.U8j=r||{}}}Object(u.a)(hx,"RibbonTrimmingProperties",null,[]);class zz{constructor(b,h,r){this.rCa=b;this.KK=h;this.S5f=r}}
Object(u.a)(zz,"ReactRibbonJewelProperties",null,[]);class Qv{constructor(){this.Fvo=(b,h,r,A,L)=>{if(1===r||!L)return 32;b=L.SourceControlId;17!==L.UILocation||"New"!==b&&"Open"!==b||(L=[],mh.d("setFileMenuSelectedPage")&&("New"===b&&y.AFrameworkApplication.ta?2===y.AFrameworkApplication.ta.Pb.gl?L.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):L.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&y.AFrameworkApplication.ta&&(2===y.AFrameworkApplication.ta.Pb.gl?
L.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):L.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),L.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(L));return 32};y.AFrameworkApplication.va.qa(wb.a.v_a,dd.a.frame,this.Fvo)}Aaj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}o1a(){return!1}lzj(){}Nli(){}}Object(u.a)(Qv,"ReactFileMenu",null,[236]);class Hv{cwf(){const b=new Qv,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));
h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(u.a)(Hv,"ReactFileMenuFactory",null,[213]);class Pi{constructor(b,h,r,A=!1){this.zCc=b;this.ruh=this.zCc.Ccb;this.dpe=Xa.a.instance.Wa("Common.IOfficeTrialExperience");this.XXb=Xa.a.instance.Wa("Common.IMacOfficeOffer");Pi.uPe=!1;this.pwn=A;this.ga=h;this.oc=r}get Tb(){return this.ga}get focusManager(){return this.oc}nmf(){return this.ruh&&!!this.dpe&&!!this.XXb}J3a(b,h){this.zCc.lq(()=>{v.ULS.sendTraceTag(5878046,
340,50,"Full app settings are ready");this.ruh=!0;this.OEf(b,h)});Xa.a.instance.Za("Common.IOfficeTrialExperience").execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.dpe=r;this.OEf(b,h)});Xa.a.instance.Za("Common.IMacOfficeOffer").execute(r=>{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.XXb=r;this.OEf(b,h)})}OEf(b,h){Pi.uPe||(this.nmf()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),Pi.uPe=!0):
v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}Pi.uPe=!1;Object(u.a)(Pi,"RibbonDependencies",null,[761]);class bJ{constructor(b,h,r){this.CGb=b;this.ga=h;this.oc=r}}Object(u.a)(bJ,"WoncaRibbonUserFactory",null,[151]);class Jk{constructor(b,h){this.MQe=b;this.rec=h}cBb(b){this.MQe.cBb(b);this.rec&&this.rec.cBb(b)}ird(b){this.MQe.ird(b);this.rec&&this.rec.ird(b)}Mwd(b){this.MQe.Mwd(b);this.rec&&this.rec.Mwd(b)}}Object(u.a)(Jk,"RibbonCommandTrimmer",null,[152]);var EJ=
e(1218),bE=e(1137);class EE{constructor(b,h){this.za=b;this.ccc=h}cBb(b){X.a.Yi&&6>X.a.Lbb&&(b.fseaInsertPicture=!0);this.za.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.za.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.za.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);TF.a.c5i()||(b.InsertLoopComponentsForConsumers=!0);const h=this.za.$("InsertOnlinePictureEnabled"),r=y.AFrameworkApplication.g2f();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=
!0);r||(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);if(r||y.AFrameworkApplication.kdd)b.fseaInsertPictureFromOneDrive=!0;r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;y.AFrameworkApplication.h2f()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);y.AFrameworkApplication.mDc&&(b.btnOpenInClient=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")&&
this.nDc(b)}ird(b){b.menuJewel=!0;y.AFrameworkApplication.uE||(b.jbtnGiveFeedback=!0)}nDc(b){var h;b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0;if(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))b.jbtnDownloadAsPdfWithComments=!0}Mwd(b){delete b.menuJewel;y.AFrameworkApplication.privacyUrl||
(b.jbtnPrivacy=!0);y.AFrameworkApplication.Kod||(b.jbtnReportAbuse=!0);y.AFrameworkApplication.WFe||(b.jbtnTermsOfUse=!0);y.AFrameworkApplication.q6d||(b.jbtnFileSharing=!0);y.AFrameworkApplication.Uzb||(b.jbtnShareRWC=!0);y.AFrameworkApplication.gGf||y.AFrameworkApplication.MQg||(b.jbtnVersion=!0);this.ccc.dpe&&this.ccc.dpe.p0n||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.ccc.XXb&&this.ccc.XXb.pap||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);y.AFrameworkApplication.mDc?
(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Ze.a.Wu?"btnjOpenInClient":"btnjEditInClient"]=!0;y.AFrameworkApplication.ywp&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")?this.nDc(b):y.AFrameworkApplication.J.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;y.AFrameworkApplication.nE&&(this.nDc(b),b.faShare=!0);if(y.AFrameworkApplication.AR||X.a.e_a||!y.AFrameworkApplication.s9c&&
!y.AFrameworkApplication.YFf&&!y.AFrameworkApplication.KQg)b.jbtnFileEmbed=!0;EJ.a.Wan()||(b.btnjClose=!0);y.AFrameworkApplication.wWb?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):y.AFrameworkApplication.$je()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);y.AFrameworkApplication.ytg||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&
(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.za.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.v6i;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(y.AFrameworkApplication.BL||".ODT"===Ze.a.l3c.toUpperCase()||
!y.AFrameworkApplication.J.$("WordEditorAppsForOfficeRibbonIsEnabled")||!bE.a.wVd||y.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(u.a)(EE,"WoncaCommandTrimmer",null,[152]);var cE=e(1003);e(749);var FJ=e(1577),rL=e(1788);class cJ{constructor(b,h){this.x3=this.yO=null;this._clientId=b;this.Pfa=h}L8l(){if(!ef.c(this.x3))return this.x3;this.UDf();if(ef.c(this.x3))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");
this.x3.style.display="block";this.Pfa&&this.Pfa.f4(Object(E.a)(this,this.zx,"onResize"));return this.x3}zx(){this.aGa()}aGa(){this.ADf()?(document.getElementById("application").style.minWidth="0px",(new rL.a(this.x3,null,y.AFrameworkApplication.isRtl)).tTo(this.x3)):y.AFrameworkApplication.ta.Pb.JN||FJ.a.uTo(this.x3,y.AFrameworkApplication.isRtl)}ADf(){return y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("EnhancedMobileViewIsEnabled"):!1}UDf(){if(ef.c(this.yO)){var b;({e9c:b}=Ot.a.Kvd(!y.AFrameworkApplication.J1)).returnValue?
(this.yO=ZD.a("div"),this.yO.className=Ot.a.lam,this.yO.id=ge.a.J5d,b.appendChild(this.yO),this.NDf(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.hda&&!y.AFrameworkApplication.J1&&this.ODf(),this.K8l()):y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ReactHeaderCrashLogs")&&v.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}K8l(){ef.c(this.x3)&&(this.x3=ZD.a("div"),this.x3.className=Ot.a.SMg,this.x3.style.display=
"none",this.yO.appendChild(this.x3))}NDf(){Sys.UI.DomElement.addCssClass(this.yO,Ot.a.mam);y.AFrameworkApplication.isRtl&&ZD.b(this.yO,"cui-rtl")}ODf(){Sys.UI.DomElement.addCssClass(this.yO,"FlexBoxLayout")}}Object(u.a)(cJ,"HeaderSkeleton",null,[]);var ix=e(632);class jC{constructor(){this.IFc=null}Dyp(){this.IFc||(this.IFc=Xa.a.instance.Wa("Common.App.AccountSwitching.IAccountSwitching"))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}nmm(){this.Dyp();return this.IFc?
this.IFc.getCustomAuthConfig():null}static zon(){return y.AFrameworkApplication.J.$("UiHostSupportsCustomAuthConfig")}}Object(u.a)(jC,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class oG{constructor(){this.Esc=this.cultureName=null}}Object(u.a)(oG,"HeaderCultureInfo",null,[]);var AC=e(1595);class BA{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(u.a)(BA,"SearchInitializationSettings",null,[]);var CA=e(311);class Iv{constructor(){this.saveStatus=
this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(u.a)(Iv,"DocumentTitleAppProps",null,[]);class Ds{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;
this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(u.a)(Ds,"DocumentTitleCalloutAppProps",null,[]);class Ij{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=
this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=
!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(u.a)(Ij,"HeaderAppProps",null,[]);class ay{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(u.a)(ay,"HeaderControls",null,[]);class dJ{constructor(){this.command=this.label=null}}Object(u.a)(dJ,"WorkflowButtonAppProps",null,[]);var dE;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.Kcq=2]="insufficientPermission";b[b.hcq=3]="incompatibleEditorsPresent";b[b.B6p=4]="editorsPresent";
b[b.Goe=5]="notSupported"})(dE||(dE={}));Object(u.b)("RenameDisableReason",dE);class Zw{constructor(b=""){this.DAg=this.documentTitleAppProps=this.USg=null;this.eTf=()=>{if(!this.USg){const h=ix.a();if(h){const r=this.eOm(h.command);r&&(this.USg=Object.assign(new dJ,{command:r,label:h.label}))}}return this.USg};this.o4n=()=>{Fk.a.get_instance().AK(17)};this.onMove=()=>{const h={};h.MoveButtonClickedTime=new Date;y.AFrameworkApplication.va.Zb(wb.a.uYb,2,h)};this.Mwm=()=>{var h;let r=null,A=null;var L=
Xa.a.instance.Wa("Common.IRenameProps");const ba=null===(h=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===h?void 0:h.getSharedUxSettings();h=(h=ba&&ba.hasOwnProperty("commonSettings")?ba.commonSettings():void 0)&&h.hasOwnProperty("openBreadcrumbsInNewTab")?h.openBreadcrumbsInNewTab():!1;L?(L=L.KKi(),0!==L&&(r=this.FOm(L),A=dE[L])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new Ds,{breadcrumbBrandName:y.AFrameworkApplication.dv.breadcrumbBrandName,
breadcrumbBrandUrl:y.AFrameworkApplication.dv.breadcrumbBrandUrl,breadcrumbFolderName:y.AFrameworkApplication.dv.breadcrumbFolderName,breadcrumbFolderUrl:y.AFrameworkApplication.dv.breadcrumbFolderUrl,hideDocumentTitleInput:y.AFrameworkApplication.ta.Pb.N6m,isVersionHistoryEnabled:this.Lbp(),documentExtension:D.a.sna(y.AFrameworkApplication.fileName),isMoveEnabled:32===y.AFrameworkApplication.va.Vb(wb.a.uYb,1),onMove:this.onMove,message:r,renameDisableReason:A,openBreadcrumbsInNewTab:h||y.AFrameworkApplication.J.$("OpenLinksInNewWindow")})};
this.sCi=()=>{if(!this.documentTitleAppProps){const h=y.AFrameworkApplication.dv.sC;this.documentTitleAppProps=Object.assign(new Iv,{documentTitle:y.AFrameworkApplication.B3d?h:D.a.oN(h),onFirstRender:this.o4n,getCalloutAppProps:this.Mwm,isShared:!1})}return this.documentTitleAppProps};this.VGl=h=>{appChrome.getHeaderApi().then(r=>{r.setNavBarData(h.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{y.AFrameworkApplication.hideHeader&&
y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8451051_NoOpOnHideHeader")||(Xa.a.instance.Za("Common.App.O365Shell.IO365ShellActor").execute(h=>{h.f9o.continueWith(this.VGl,3)}),Fk.a.get_instance().AK(15))};this.onFullyLoaded=()=>{Fk.a.get_instance().AK(16)};this.TUk=""!==b?b:Wd.a.o6}eOm(b){const h=Xa.a.instance.Wa("Common.IExternalUICommandDefinitionMapping").etb(b);if(h&&0<h.length)return h[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,
10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}mum(){return Object.assign(new ay,{workflowButton:this.eTf()})}FOm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}Lbp(){return!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.z7i}k$o(){return!!y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.y7i}sbp(){const b=!ix.b()&&!y.AFrameworkApplication.hideHeader&&!y.AFrameworkApplication.fWf&&(y.AFrameworkApplication.J.$("SkypeWebControlIsEnabled")||y.AFrameworkApplication.J.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}MAo(b=!1){appChrome.getHeaderApi().then(h=>{const r=Xa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",
()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",A=>{r.onFlexPaneOpen(A)});h.setHeaderCommandHandler("OnFlexPaneClose",A=>{r.onFlexPaneClose(A)});h.setHeaderCommandHandler("SetCookie",A=>yc.a.set(A.cookieName,A.value));h.setHeaderCommandHandler("GetCookie",A=>this.oum(A));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",this.eTf);b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.sCi),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.p4n();
return null}));AC.a.dje()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(E.a)(this,this.vLi,"getSearchInitializationSettings"))})}p4n(){Xa.a.instance.Za("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.XCb(!1,y.AFrameworkApplication.va.mode)})}oum(b){b=yc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}$Sm(){return CA.AppChromeOverrideUtilities.isEnabled?CA.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.TUk+y.AFrameworkApplication.b6+
"suiteux-shell"}Lca(b=!1){a:{try{var h=Wg.a.Vg(y.AFrameworkApplication.lcid);if(h){var r=Object.assign(new oG,{cultureName:h.name,Esc:h.Esc});break a}}catch(A){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+y.AFrameworkApplication.lcid.toString())}r=Object.assign(new oG,{cultureName:"en-us",Esc:"en"})}h=Xa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new Ij,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.Esc,
isConsumer:!y.AFrameworkApplication.QQg,showAppLauncher:ix.h(),showMeControl:ix.g(),hideUserName:y.AFrameworkApplication.Jde,defaultDocumentTitleToLeft:y.AFrameworkApplication.hii,assetsContainerOverride:this.$Sm(),controls:this.mum(),documentTitleAppProps:b?null:this.sCi(),showDocumentTitleControl:!b,showWorkflowButton:!!this.eTf(),showChatControl:this.sbp(),showGoPremiumControl:ix.i(),showDiscoverPremiumButton:ix.f(),enableSearchControl:AC.a.xyn(),onFlexPaneOpen:Object(E.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),
onFlexPaneClose:Object(E.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.k$o(),testTraffic:y.AFrameworkApplication.J.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:y.AFrameworkApplication.l$o()});!y.AFrameworkApplication.aEc||y.AFrameworkApplication.FHg?(r.userDisplayName=y.AFrameworkApplication.userName,r.emailAddress=y.AFrameworkApplication.J.rb("UserPrincipalName"),r.userID=y.AFrameworkApplication.J.rb("Puid")||
"",r.signOutLink=y.AFrameworkApplication.FHg):y.AFrameworkApplication.signInUrl&&(r.signInLink=y.AFrameworkApplication.signInUrl);AC.a.dje()&&(h=this.vLi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=y.AFrameworkApplication.J.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);jC.zon()&&(h=new jC,r.shellAuthProviderConfigPromise=Object(E.a)(h,h.nmm,"getAccountSwitchingConfig"));this.a0k();this.MAo(b);y.AFrameworkApplication.ud("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");
return r}a0k(){y.AFrameworkApplication.J.$("SideLoadingIsEnabled")&&Fk.a.get_instance().Zk(16,()=>{appChrome.getHeaderApi().then(b=>{b.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId","\u25b6");b.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");b.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});
return null})})}vLi(){if(!this.DAg){const b=new AC.a;let h=y.AFrameworkApplication.J.rb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.DAg=Object.assign(new BA,{loadTellMeResources:b.bJn(),getTokenRequestDictionary:Object(E.a)(b,b.nVm,"getTokenRequestDict"),userRing:h})}return this.DAg}}Object(u.a)(Zw,"ReactSharedHeaderPropsHelper",null,[1939]);class Lu{constructor(){this.label=this.value=null}}Object(u.a)(Lu,"TextInfoSectionField",null,[]);var ww=e(967),eE=e(1193);class FE{constructor(){this.commandId=
0;this.externalUxCommand=null}}Object(u.a)(FE,"CommandDefinition",null,[]);class PG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(u.a)(PG,"CommandDefinitionMapping",null,[]);const GJ=b=>Object.assign(new PG,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new FE,{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new FE,{externalUxCommand:h})},
getDoNothingCommand:()=>parseInt(wb.a.nh),addCommandToMaps:Object(E.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(E.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(E.a)(b,b.addTabToMap,"addTabToMap")});var QG=e(1270);class zC{}Object(u.a)(zC,"RibbonInitState",null,[]);var GE=e(432),kC=e(1233);class eJ{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,r);return h}}Object(u.a)(eJ,"ReactAsyncDispatcher",null,[]);var pG=e(1657);class RG{constructor(b,h){this.nUk=
b;this.Vwk=h}}Object(u.a)(RG,"ReactExecuteCommandContext",null,[]);class Pr{}Pr.Trigger="FontTrigger";Pr.Name="FontName";Pr.Action="FontAction";Pr.Level="FontLevel";Pr.IsPinned="FontIsPinned";Object(u.a)(Pr,"FontPickerLogProperties",null,[]);class pz{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob=null,nb=null){this.J3=null;this.cKh=!1;this.DUe=[];this.rCd=-1;this.BRd=!1;this.zVk=0;this.FHc=null;this.KFh=!1;this.WBd=null;this.rzh=!1;this.wEp=(Eb,bc)=>{const Bc=Eb.launcherId;this.uAc(Bc,bc)&&(bc=appChrome.selectors.getFlyoutAnchorMenuItems(Bc),
this.NDc(bc,Bc,mh.g(Eb)))};this.tFp=(Eb,bc)=>{const Bc=Eb.launcherId;this.uAc(Bc,bc)&&(bc=mh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(Bc):appChrome.selectors.getFlyoutAnchorMenuItems(Bc),this.NDc(bc,Bc,mh.g(Eb)))};this.cHp=(Eb,bc)=>{const Bc=Eb.launcherId;this.uAc(Bc,bc)&&(bc=appChrome.selectors.getPreviewGalleryMenuItems(Bc),this.NDc(bc,Bc,mh.g(Eb)))};this.VHp=(Eb,bc)=>{const Bc=Eb.launcherId;this.uAc(Bc,bc)&&(bc=appChrome.selectors.getSplitButtonMenuItems(Bc),
this.NDc(bc,Bc,mh.g(Eb)))};this.$Hp=(Eb,bc)=>{const Bc=Eb.launcherId;this.uAc(Bc,bc)&&(bc=appChrome.selectors.getStatefulSplitButtonMenuItems(Bc),this.NDc(bc,Bc,mh.g(Eb)))};this.qla=b;this.Kmb=h;this.c$e=Object(ya.a)(1791,b);this.hm=r;this.oc=A;L&&(this.J3=new pG.a(L,A));this.RRk=ba;this.xBk=ra;this.$s=ob;this.ga=Ia;this.VHb={};this.za=Ta;this.tWg=nb;Ta&&(Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||Ta.$("EnqueueTasksWhenTaskMgrIsYielding"))&&Yj.a.instance.dlf.CWR(()=>
this.cKh=!0);Ta&&(b=this.za.rb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Zv:this.FHc}=H.d(b));this.FHc||(this.FHc={})}get iRj(){return!!window.appChrome&&!!appChrome.selectors}GPj(){-1!==this.rCd&&window.clearTimeout(this.rCd);this.rCd=window.setTimeout(()=>{for(this.rCd=-1;0<this.DUe.length;){if(vb.TaskManager.instance.UB){this.GPj();break}const b=this.DUe.shift();b&&this.executeCommand(b.nUk,b.Vwk)}},0)}executeCommand(b,h){if(vb.TaskManager.instance.UB){if(this.cKh){this.DUe.push(new RG(b,
h));this.GPj();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,sb.a.toJSON(h.payload));if(this.za.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.hm.getCommandByExternalUxId(b),A=h.modelType;this.tWg&&this.tWg.xKn(b,h);this.R1f&&r&&window.Event&&(window.Event.ActionCommandId=r.commandId);
r?this.R9l(b,r,A,h):this.S9l(b,A,h);this.fvl(h);this.lwp(h);this.hQn(b,h)}}S9l(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.gri(r,b);break;case "ButtonModel":this.M9l(r,b)}}PGp(b,h,r,A,L){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.za&&this.za.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")?
(h=!0,ef.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.r8()):this.r8();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;L=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;L=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=A;return L}QGp(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=
this.hm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.hm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.r8();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}R9l(b,
h,r,A){var L=Date.now(),ba=this.uko(A,r);let ra=h.commandId;var Ia=this.za&&!this.za.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RemoveFontNameFromTelemetryData",!1);const Ta={},ob={};switch(r){case "SplitButtonModel":if(this.z8c(A.payload,this.VHp,ba))return;Ta.MenuItemId=h.menuItemId;this.rEg(A,Ta);break;case "StatefulSplitButtonModel":if(this.z8c(A.payload,this.$Hp,ba))return;Ia=A.payload.statefulData;r=A.payload.statefulMode;"color"===r?Ta.Color=Ia:"icon"===r&&(Ia=this.hm.getCommandByExternalUxId(Ia))&&
(Ta.MenuItemId=Ia.menuItemId);break;case "FileMenu":Ta.MenuItemId=h.menuItemId;Ta.SourceControlId=b;A.payload&&"FileMenuPageSwitchPayload"===A.payload.type&&this.Z0m(ra,A.payload,b);break;case "TellMe":ra=this.QGp(ra,A,Ta);Ta.SourceControlId=b;Ta.Location=A.payload.location;break;case "ButtonModel":A.payload&&"TabSwitchPayload"===A.payload.type?this.T2m(Ta,A):ra=this.PGp(Ta,h,A,b,ra);break;case "CompoundButtonModel":Ta.MenuItemId=h.menuItemId;Ta.CommandValueId=A.payload.commandValueId;Ta.SourceControlId=
b;this.rEg(A,Ta);this.r8();break;case "ToggleButtonModel":case "InkButtonModel":Ta.MenuItemId=h.menuItemId;Ta.SourceControlId=b;this.rEg(A,Ta);this.r8();break;case "FontPickerModel":switch(A.payload.type){case "MenuOpenPayload":ra=this.hm.getCommandByExternalUxId("FontPickerMenuOpen").commandId;Ta[tA.a.FontPickerId]=A.payload.launcherId;break;case "MenuClosePayload":ra=this.hm.getCommandByExternalUxId("FontPickerMenuClose").commandId;Ta[tA.a.FontPickerId]=A.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=
A.payload.font;ba=null;"string"===typeof r?(ba=cp.a.b0a(r),Ta.CommandValueId=ba,ba=cp.a.i1d(ba)):(r.data?(Ta.CommandValueId=r.data.fontToApply,Ta.MenuItemId=r.data.themeIndex,Ta[tA.a.Formatting]=r.data):Ta.CommandValueId=r.name,ba=r);Ta.SourceControlId=b;Ta[tA.a.RequestUpdateMru]=ba;Ia&&(ob[Pr.Name]=A.payload.nameToLog?A.payload.nameToLog:"string"===typeof r?cp.a.Pge(r)?"*"+r:cp.a.a1f(r)?"[EF]":"[MF]":"",ob[Pr.IsPinned]=A.payload.isPinned,ob[Pr.Level]=A.payload.level);this.Q9f();break;case "FontPickerFontInfoRequestedPayload":Ta.CommandValueId=
A.payload.font.name;Ta[tA.a.Trigger]=A.payload.trigger;ob[Pr.Trigger]=A.payload.trigger;Ia&&(ob[Pr.Name]=A.payload.nameToLog);this.Q9f();break;case "FontPickerFontPinningPayload":r=A.payload.isPinned;Ta.CommandValueId=A.payload.fontKey;Ta[tA.a.IsPinned]=r;Ia&&(ob[Pr.Name]=A.payload.nameToLog,ob[Pr.Action]=r?"pin":"unpin",ob[Pr.Level]=A.payload.level);this.Q9f();break;default:return}break;case "ComboBoxModel":Ia=A.payload.type;switch(Ia){case "MenuOpenPayload":case "MenuPopulatePayload":this.uAc(A.payload.launcherId,
ba)&&(L={},L[A.payload.launcherId]=r,this.Kmb.Gkd(L,mh.g(A.payload)),this.VHb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=A.payload.newValue;if(!r)return;r.value?(Ta[$c.a.Value]=r.value,Ta[$c.a.IsFreeForm]=!0):(Ta[$c.a.Value]=r.text,Ta.MenuItemId=r.key,Ta.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===Ia&&(ra=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ra=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(A.payload.type){case "ZeroTermContextMenuClosePayload":Ia=
sb.a.zT(A.payload);for(const nb of Ia)Ta[nb]=A.payload[nb];break;default:this.z8c(A.payload,this.wEp,ba),Ta.launcherId=A.payload.launcherId}break;case "InkFlyoutAnchorModel":this.z8c(A.payload,this.tFp,ba);Ta.launcherId=A.payload.launcherId;break;case "ColorPickerModel":switch(A.payload.type){case "ColorPickerPayload":Ta[Ol.Color]=A.payload.selectedColorId;Ta.colorRGB=A.payload.color;break;case "ColorPickerPreviewPayload":ra=h.commandPreviewId;Ta[Ol.Color]=A.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ra=
h.commandRevertId;break;default:return}break;case "SpinButtonModel":Ta[vi.a.Number]=A.payload.value;Ta[vi.a.UnitType]=fg.a.HWa(A.payload.unitType.toLowerCase());Ta[vi.a.Text]=A.payload.reservedValue;break;case "SliderModel":Ta[vl.Value]=A.payload.value;break;case "InsertTableModel":Ta[Ei.a.Rows]=A.payload.rows;Ta[Ei.a.Columns]=A.payload.columns;break;case "CheckboxModel":Ta[bg.a.On]=A.payload.checked;Ta.MenuItemId=h.menuItemId;Ta.TerminalParentControlId=A.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.z8c(A.payload,
this.cHp,ba)){Ta.launcherId=A.payload.launcherId;break}this.gri(A,b);return;case "DocumentTitleModel":switch(A.payload.type){case "DocumentTitleRenamePayload":Ta.getNewDocumentTitle=A.payload.getNewDocumentTitle;break;case "MenuOpenPayload":L={};L[A.payload.launcherId]=r;this.Kmb.Gkd(L,mh.g(A.payload));this.VHb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":Ta.MenuItemId=A.payload.url;this.mLn(A.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":Ta.MenuItemId=
A.payload.assetId;Ta.SourceControlId=b;y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&(Ta.IsPremium=A.payload.isPremium||!1);this.nLn(A.payload.pageId);break;case "CoauthorGallery":Ta.RenderTime=A.triggerTime;break;case "PeopleWell":Ta.RenderTime=A.triggerTime;break;case "SyncStatus":Ta.SourceControlId=b;break;case "InputBoxModel":Ta.Text=A.payload.newValue;break;case "PersonaButtonModel":Ta.CommandValueId=A.payload.commandValueId;this.b2m(A.payload);break;case "MultiActionButtonModel":Ta.CommandValueId=
A.payload.commandValueId;Ta.Href=A.payload.href;Ta.SourceControlId=b;Ta.Type=A.payload.type;Ta.TerminalParentControlId=A.payload.terminalParentControlId;this.r8();break;default:return}ra&&!this.isShadowMenuOpen(A.payload)&&(A.payload&&"terminalParentControlId"in A.payload&&(Ta.ParentMenuId=A.payload.terminalParentControlId),Ta.CommandValueId||(Ta.CommandValueId=Ta.MenuItemId),h.legacyControlId&&(Ta.LegacyId=h.legacyControlId),Ta.SourceControlId||(Ta.SqmControlId=b),this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Ta.launcherId&&(h=this.hm.getCommandByExternalUxId(Ta.launcherId))&&(Ta.launcherCommandId=parseInt(h.commandId)),A.payload&&!ef.c(A.payload.PRIReadinessCheck)&&(Ta.PRIReadinessCheck=A.payload.PRIReadinessCheck,this.KFh=!0),A.payload&&!ef.c(A.payload.shouldTakeFocus)&&(Ta[Cv.a.r2a]=A.payload.shouldTakeFocus),h=this.Zhf(A,Ta),A.payload&&!ef.c(A.payload.interactiveUid)&&(ob.interactive_uid=A.payload.interactiveUid),ef.c(A.triggerTime)||(ob.TriggerTime=A.triggerTime),A.payload&&!ef.c(A.payload.userActionKey)&&
(ob.userActionKey=A.payload.userActionKey),this.DCg(ob,A,b,ra),this.c$e.executeCommand(ra,Ta,this.getSelectedTabId(),h,!0,()=>{this.ncg(Ta,b)},ob,mh.g(A.payload)),this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTimeToExecuteCommandWithCommandMetadata",!1)&&v.ULS.sendTraceTag(508118238,207,50,"executeCommandWithCommandMetadata executed for command :{0} and time taken in execution :{1}",b,Date.now()-L))}DCg(b,h,r,A){if(this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",
!1)&&r&&A&&h.payload){const L=!ef.c(h.payload.launcherId);r=this.POj(this.IIm(L?h.payload.launcherId:r,A),A,!1);b.ControlId=r;const ba=h.payload.inputMethod,ra=h.payload.location;ef.c(ba)||ef.c(ra)||this.FKn(1===ba,2===ba||3===ba||4===ba,L&&("Overflow"===ra||"ToolBarOverflow"===ra)||"TabSwitchPayload"===h.payload.type,r,ra)}this.za&&this.za.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.POj(h.payload.terminalParentControlId,
A,!0))}FKn(b,h,r,A,L){this.WBd||(this.WBd={});const ba=[];L=Uh.a.Fca("UILocation",L,2);Array.add(ba,L);if(L=this.getSelectedTabId())L=Uh.a.Fca("Tab",L,2),Array.add(ba,L);this.WBd[A]||r||(this.WBd[A]=1,h?this.ffd("DistinctUserInitiatedTerminalCommand",ba):b&&this.ffd("DistinctUserInitiatedKeyboardCommand",ba));h?r?this.ffd("UserInitiatedNavigationalCommand",ba):this.ffd("UserInitiatedTerminalCommand",ba):b&&this.ffd("UserInitiatedKeyboardCommand",ba)}ffd(b,h){$d.b(b,null,0,!0,0,h)}POj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;
v.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}IIm(b,h){h=parseInt(h);h=qf.ActionManager.ctf(h)||qf.ActionManager.yba(h)||"";return!ef.c(h)&&h in this.FHc?this.FHc[h]:100<b.length?"":b}Q9f(){this.$s&&this.$s.execute(b=>{b.z9f("ModernFontPickerExperience")})}Zhf(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&
b.payload.inputMethod&&(r=b.payload.inputMethod,h[Cv.a.aB]=r);return r}ncg(b,h){const r=Object(ya.a)(Df.AFrame,y.AFrameworkApplication.ta);if(this.oc&&this.IYj(b)){if(!this.oc.currentScope&&r){let A="null";if(b){const L=b.Value;delete b.Value;A=sb.a.toJSON(b);ef.c(L)||(b.Value=L)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,A,r.Tfb)}this.oc.DHf()}(this.oc&&this.oc.currentScope&&
this.oc.currentScope.name!==Df.AFrame.Sia&&r&&this.oc.currentScope.name!==r.Tfb||this.IYj(b))&&this.HAl(b)}IYj(b){return!!b&&!ef.c(b[Cv.a.r2a])&&b[Cv.a.r2a]}HAl(b){Cv.a.aB in b&&1===b[Cv.a.aB]&&ww.ShyRibbon.Fpb(1,0)}T2m(b,h){mh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.r8();this.qla.qo();if(this.RRk&&this.ga){const r={};r[Pv.a.tKg]=h.payload.tabId;this.ga.Zb(wb.a.Nod,2,r,this.bR(h));ef.c(h.payload.inputMethod)||(this.ga.Vb(wb.a.yLj,
2),this.BRd||this.$fp(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.hm.GRf(h);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.$s&&h){const r=h+"TabSwitchActivity";this.$s.execute(A=>{A.z9f(r)})}}z8c(b,h,r){const A=b.type;return"MenuClosePayload"===A?!0:"MenuOpenPayload"===A?(h(b,r),!0):!1}b2m(b){b=b.type;"MenuOpenPayload"===b?y.AFrameworkApplication.fud=!0:"MenuClosePayload"===b&&(y.AFrameworkApplication.fud=!1)}uko(b,h){if(!b.payload||!b.payload.launcherId||
"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,A=this.hm.getCommandByExternalUxId(r);return A&&A.populationProps?((b=this.Kmb.Pog(A,h,b.payload))&&r in this.VHb&&delete this.VHb[r],b):!1}getSelectedTabId(){return this.iRj?appChrome.selectors.getSelectedTabId():null}NDc(b,h,r){this.Kmb.Gkd(b,r);this.VHb[h]=new Date}uAc(b,h){let r=!0;b in this.VHb&&(r=this.VHb[b].getTime()<this.qla.Xva.getTime());return r&&!h&&this.iRj}gri(b,h){const r=
{};var A=b.payload.selectedGalleryId;const L=this.hm.getCommandByExternalUxId(A);if(L){r.SourceControlId=A;r.MenuItemId=L.menuItemId;r.SqmControlId=h;L.legacyControlId&&(r.LegacyId=L.legacyControlId);b.payload&&!ef.c(b.payload.shouldTakeFocus)&&(r[Cv.a.r2a]=b.payload.shouldTakeFocus);this.tLm(b.payload,r);(A=this.bR(b))||(A={});this.DCg(A,b,h,L.commandId);const ba=this.Zhf(b,r);this.c$e.executeCommand(L.commandId,r,this.getSelectedTabId(),ba,!0,()=>{this.ncg(r,h)},A,mh.g(b.payload))}}M9l(b,h){const r=
this.hm.getCommandByExternalUxId(h);if(r){const A={};A.SourceControlId=h;A.MenuItemId=h;A.SqmControlId=h;b.payload&&!ef.c(b.payload.shouldTakeFocus)&&(A[Cv.a.r2a]=b.payload.shouldTakeFocus);let L=this.bR(b);L||(L={});this.DCg(L,b,h,r.commandId);const ba=this.Zhf(b,A);this.c$e.executeCommand(r.commandId,A,this.getSelectedTabId(),ba,!1,()=>{this.ncg(A,h)},L,mh.g(b.payload))}}tLm(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}rEg(b,h){b.payload&&"toggled"in b.payload&&(h[bg.a.On]=
b.payload.toggled)}hQn(b,h){if("MenuOpen"===b){if(this.J3&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.J3.onMenuOpen()}else if("MenuClose"===b&&this.J3)this.J3.onMenuClose()}r8(){this.J3&&this.J3.Vhg()}bR(b){let h=null;ef.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Z0m(b,h,r){if(this.xBk&&this.ga){const A={};A[yC.a.Ese]=r;this.ga.Zb(wb.a.Mod,2,A)}this.NDc(h.pageControlIdMap,b,mh.g(h))}nLn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Vb(wb.a.CLj,2);
break;case "FileNewPage":this.ga.Vb(wb.a.DLj,2)}}mLn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Vb(wb.a.gLj,2);break;case "FileOpenPage":this.ga.Vb(wb.a.hLj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}$fp(b){if(y.AFrameworkApplication.J.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.$s.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.BRd=!0;else{if(y.AFrameworkApplication.J.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.$s.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.zVk)){this.BRd=!0;return}y.AFrameworkApplication.J.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.Vb(wb.a.k3b,2)&&(this.BRd=!0)}}fvl(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.KFh&&appChrome.PRIToastManager.dismissToast()}lwp(b){!this.rzh&&this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(b=mh.g(b.payload),31===b||14===b||15===b||2===
b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.rzh=!0)}get R1f(){var b,h;return null!==(h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScopeAsyncEnabled",!1))&&void 0!==h?h:!1}}Object(u.a)(pz,"ReactExecuteCommandHandler",null,[]);class by{constructor(){this.n6d=
null}get ZCb(){return 0}get Idb(){return 0}get COa(){return!1}aGa(){}Y6j(){}z4(){return!1}GTj(){}B8(){return!1}uRa(b){return this.n6d&&this.n6d.o1a(b)?!0:!1}get Xpa(){return!1}FAb(){}ahe(){return!1}get g0d(){return null}set g0d(b){}ema(){}Vga(){}OSf(){return null}pXa(){}refresh(){}get controls(){return null}Mxc(){return!1}dqb(){}qo(){}get nJ(){return null}set nJ(b){}nwd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(u.a)(by,"ReactRibbonExternal",null,[505,429,506]);class fJ{constructor(b,
h,r,A){this.$4n=(L,ba)=>{if((L=Object(ya.a)(Df.AFrame,y.AFrameworkApplication.ta))&&ba.mmj&&y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.oEa){const ra=appChrome.selectors.getShyState();ra.isActive&&ba.mmj.name===L.Tfb&&ww.ShyRibbon.Fpb(ra.state,1)}};this.GNj=()=>4;this.FNj=()=>4;this.BNj=()=>{mh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.oEa&&appChrome.selectors.getShyState().isActive&&ww.ShyRibbon.Fpb(1,0),this.oc.Rg(Df.AFrame.Co));
return 4};this.N9n=L=>{L.Yb&&L.Yb.target&&"input"!==L.Yb.target.tagName.toLowerCase()&&L.Yb.preventDefault();return!1};this.oc=b;this.ga=h;this.PPh=r;this.dcc=A}initialize(){this.ga.qa(wb.a.ypd,dd.a.frame,this.GNj);this.ga.qa(wb.a.xpd,dd.a.frame,this.FNj);this.ga.qa(wb.a.Yye,dd.a.frame,this.BNj);var b=Ot.a.efe(this.dcc,null,this.PPh,!1);b.LN=!0;this.i0b(b,wb.a.ypd,wb.a.xpd);b.bindAction(lc.KeyInputManager.xc(pg.a.iib,0),wb.a.Yye);b=this.oc.te(Df.AFrame.Sia);b.LN=!0;this.i0b(b,wb.a.s$a,wb.a.s$a);qd.a.instance.Cb(Fd.a.eE,
this.PPh,this.N9n);b=sq.a.instance;mh.a("enterKeytipMode")&&b.D3o(this.dcc,()=>{appChrome.api.enterKeytipMode(!1)});mh.a("exitKeytipMode")&&b.z3o(this.dcc,()=>{appChrome.api.exitKeytipMode();ww.ShyRibbon.Fpb(1,0)});y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.oEa&&(b=Object(ya.a)(Jc.FocusManager,this.oc))&&b.q7k(this.$4n)}dfn(b){b=Ot.a.efe(b,null,document.getElementById("WACToolbarContainer"),!1);b.LN=!0;this.i0b(b,wb.a.ypd,wb.a.xpd)}i0b(b,h,r){const A=lc.KeyInputManager.xc(pg.a.iB,0),
L=lc.KeyInputManager.xc(pg.a.iB,4);b.Pu(A);b.Pu(L);b.bindAction(A,h);b.bindAction(L,r)}dispose(){this.ga.Jz(wb.a.ypd,dd.a.frame,this.GNj);this.ga.Jz(wb.a.xpd,dd.a.frame,this.FNj);this.ga.Jz(wb.a.Yye,dd.a.frame,this.BNj)}}Object(u.a)(fJ,"ReactRibbonFocusManager",null,[11]);class Aq{constructor(b,h,r,A,L,ba,ra,Ia=null,Ta=!0,ob=null,nb=null){this.Bkb=this.xSd=this.HQe=this.qla=null;this.FJh=[];this.fcc=null;this.Dto=()=>{y.AFrameworkApplication.J.lq(()=>{this.L0l()})};this.wNn=()=>{if(y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.$t){var Eb=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(Eb.execute(Bc=>{Bc.logActivity("SingleRibbonModeActivity",null)}),y.AFrameworkApplication.ud("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(Eb.execute(Bc=>{Bc.logActivity("MultiRibbonModeActivity",null)}),y.AFrameworkApplication.ud("69a7h198;dfd7j584"));if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){var bc=
eb.a.aub();Eb=eb.a.G1();bc=1550<bc?"Large":1050<bc?"Medium":"Small";Eb=850<Eb?"Large":675<Eb?"Medium":"Small";$d.a("ScreenBucket_W_"+bc+"_H_"+Eb);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeAction")&&$d.c(this.ZPm(bc,Eb))}}};this.$Gg=()=>{const Eb=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");Eb&&Eb.execute(bc=>{bc.logActivity("SingleLineToolBarOptOut",null)});return 32};this.$Jn=()=>{this.ga.qa(wb.a.ENg,dd.a.frame,
Object(E.a)(this,this.ENg,"triggerModeSwitcherTUI"));this.ga.nb(wb.a.$Gg,dd.a.frame,this.$Gg,96);window.setTimeout(()=>{const Eb=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");Eb&&y.AFrameworkApplication.J.$("Fluent2StyleIsEnabled")&&(Eb.execute(bc=>{bc.logActivity("VNextStylesOn",null)}),Eb.execute(bc=>{bc.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.iEo=()=>{Fk.a.get_instance().Zk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const Eb=
appChrome.api.getRibbonSubComponentMappings();for(const Bc in Eb){var bc=Bc;const Yc=Eb[Bc];if(Yc)for(const zd of Yc)y.AFrameworkApplication.va.s1(zd)?appChrome.api.reportRibbonSubComponentBehaviorMapped(bc):y.AFrameworkApplication.va.w3o(zd,this.BOl(bc));else appChrome.api.reportRibbonSubComponentBehaviorMapped(bc)}};this.MUa=b;this.S3e=h;this.dcc=r;this.oc=A;this.ga=L;this.hm=ba;this.qla=ob?ob:new hG(jw.instance,this.hm);this.WMc=ra;this.YHh=new by;this.NUa=Ia;this.Iaf=Ta;new eJ;this.gnh=nb;Fk.a.get_instance().Zk(7,
Object(E.a)(this,this.W4o,"setRibbonPostInteractiveReady"));Fk.a.get_instance().Zk(7,this.wNn);Fk.a.get_instance().Zk(19,this.$Jn);Fk.a.get_instance().Zk(7,this.iEo);Fk.a.get_instance().Zk(7,this.Dto)}initialize(b,h,r=null){this.Iaf||this.AK(5);r?r.then(()=>{this.sKj()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):GE.a.Pud(GE.a.Pud(Fj.Task.WAA(this.acj(b),this.$bj(Aq.lxk)),()=>this.$bj(Aq.Btk)),()=>this.acj(h)).continueWith(()=>{this.sKj()},11)}dispose(){this.Nzp();
this.Bkb&&this.Bkb.Nli();this.fcc&&this.fcc.dispose();for(const b of this.FJh)Fk.a.get_instance().Dxl(b);y.AFrameworkApplication.va.Jz(wb.a.xMo,dd.a.frame,qf.ActionManager.qg)}$bj(b){return Xa.a.instance.resolve("Common.ISharedDependencyLoader").rtc(y.AFrameworkApplication.Lz(b,2))}acj(b){return""===b?Fj.Task.T8(!0):Xa.a.instance.resolve("Common.ISharedDependencyLoader").rtc(y.AFrameworkApplication.Lz(b,3))}Nen(){(this.NUa||this.WMc)&&appChrome.api.dispatch(this.GOi());this.W6o();mh.a("setWebpackPublicPath")&&
appChrome.api.setWebpackPublicPath(y.AFrameworkApplication.G$);this.qla.qo()}sKj(){this.Nen();this.Iaf&&(appChrome.renderAppChrome(this.MUa,mh.e()),this.AK(10));this.ZRh();this.gpf();this.Iaf&&this.AK(5);this.PWi()}PWi(){this.oc&&this.ga&&this.dcc&&(this.fcc=new fJ(this.oc,this.ga,this.MUa,this.dcc),this.fcc.initialize())}get wpd(){return this.YHh}setCommandDefinitionMapping(){if(mh.a("setCommandDefinitionMapping")){const b=GJ(this.hm);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.oEa&&mh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.Kwc()})}ZRh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(ya.a)(hG,this.qla);this.HQe=new pz(this.qla,b.Gxc,this.hm,this.oc,this.S3e,Xa.a.instance.Wa("Common.IRibbonSQMInformation"),Xa.a.instance.Wa("Common.IFileMenuSQMInformation"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,Xa.a.instance.Za("Common.ISystemInitiatedFeedback"),
null);this.wjl();this.Y_m()}wjl(){this.xSd=appChrome.api.bindCommandHandler((b,h)=>{this.HQe.executeCommand(b,h)})}Nzp(){this.xSd&&(this.xSd(),this.xSd=null)}W6o(){appChrome.api.initializeLogger(new Ak.a)}PMa(){return this.qla?this.qla.PMa():[]}Kwc(){mp.a.instance.Ae(()=>{let b=null;mp.a.instance.Ae(()=>{b=this.PMa()},"RB:GA");b&&0<b.length&&(this.qla.Xva=new Date,mp.a.instance.Ae(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.Bkb&&mp.a.instance.Ae(()=>{this.Bkb.lzj()},"RB:J")},"RB:PFSU")}Awd(){this.qla.Awd()}eZb(){}o_k(b){b=
[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}GOi(){var b=y.AFrameworkApplication.J;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(A=>{A&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",
!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.gDi());b=new QG.a(this.hm);this.NUa.KK&&(kC.a.Bwp(this.NUa.KK),h.push.apply(h,b.Z7d(this.NUa.KK)));if(this.NUa.R8j)for(const r of this.NUa.R8j)h.push(appChrome.actions.updateGallerySectionHiddenState(r.T7d,r.Ptq,r.uyq));h.push.apply(h,b.Oxi(this.NUa.U8j));return h}gDi(){const b=[];if(this.WMc&&this.WMc.KK){const r=this.WMc.KK;for(const A in r){var h=r[A];const L=this.hm.HMf(A);if(L)for(const ba of L)b.push(appChrome.actions.updateControlHiddenState(ba,
h))}}return b}rRa(b){b&&this.qla.Gxc.Gkd(b,0)}Pog(b){this.qla.Gxc.Pog(this.hm.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}L0l(){const b=y.AFrameworkApplication.J.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=y.AFrameworkApplication.J.appSettings;h&&appChrome.api.dispatch(this.QHp(b,"Shared"===(h.SharingStatus||"")))}QHp(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}AK(b){Fk.a.get_instance().AK(b);this.FJh.push(b)}W4o(){mh.d("updateRibbonInitializationState")&&
appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new zC,{postRibbonInteractiveReady:!0})))}gpf(){this.WMc&&this.gnh&&(this.Bkb=this.gnh.cwf(),this.YHh.n6d=this.Bkb)}BFn(b,h){this.Bkb&&this.Bkb.Aaj(b,h)}ozg(b,h,r){if(1===r)return 32;this.jVj(!0);this.Kwc();y.AFrameworkApplication.ta.Ne();return 32}pzg(b,h,r){if(1===r)return 32;this.jVj(!1);this.h5o();this.Kwc();y.AFrameworkApplication.ta.Ne();return 32}ENg(b,h,r){if(1===r)return 32;(b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback"))&&
b.execute(A=>{A.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}h5o(){yc.a.p2a(y.AFrameworkApplication.J.rb("IsSimplifiedRibbonOnCookieName"),"true",yc.a.U_a)}jVj(b){yc.a.p2a(y.AFrameworkApplication.J.rb("ReactRibbonMLRPreferenceCookieName"),b.toString(),yc.a.U_a)}ZPm(b,h){return"Large"===b?"Large"===h?wb.a.XTo:"Medium"===h?wb.a.YTo:wb.a.ZTo:"Medium"===b?"Large"===h?wb.a.$To:"Medium"===h?wb.a.aUo:wb.a.bUo:"Large"===h?wb.a.cUo:"Medium"===h?wb.a.dUo:wb.a.eUo}BOl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Y_m(){if(y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&mh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&y.AFrameworkApplication.zwc.fhf){const b=y.AFrameworkApplication.zwc.fhf,h=y.AFrameworkApplication.zwc.xRh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;Aq.INj.Bb(r)?Aq.INj.K(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():
(h.payload.PRIReadinessCheck=!0,this.HQe.executeCommand(b,h))}}}Aq.lxk="common";Aq.Btk="appChrome";Aq.INj=new eE.a(Ea.a.V7c());Object(u.a)(Aq,"ReactRibbonUser",null,[171,172,11]);class cy extends Aq{constructor(b,h,r,A,L,ba,ra,Ia,Ta=null,ob=!0,nb=null,Eb=null){super(b,h,A,L,ba,ra,Ia,Ta,ob,nb,Eb);this.tFd=null;this.CGb=r;this.CGb.execute(bc=>{this.tFd=bc});this.CGb.execute(bc=>{this.qla.nJ=bc})}PMa(){return this.tFd?(this.tFd.clearCache(),super.PMa()):[]}eZb(b){if(!b)throw Error.argumentNull();this.CGb.execute(h=>
{b.nJ=h})}}Object(u.a)(cy,"ReactRibbonUser",Aq,[]);var qz=e(1006);class Hu extends cy{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob=!0,nb=null,Eb=null){super(h,b.oca,A,Uk.a.uxa,L.focusManager,L.Tb,ra,Ia,Ta,ob,nb,Eb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.XXe=b;this.Pfa=ba;L.J3a(()=>{this.wHp();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Fk.a.get_instance().Zk(7,()=>{this.EWi()}):this.EWi()},null)}get $0i(){return!!y.AFrameworkApplication.J.appSettings.BootActivityNavigationId}EWi(){this.AMl();
this.cwf();this.OAo()}wHp(){this.MUa.classList.add("FlexBoxLayout");this.XXe.Cua().classList.add("cui-exth");this.XXe.Cua().classList.add("FlexBoxLayout");this.XXe.Cua().classList.add("ScrollableRibbon")}AMl(){y.AFrameworkApplication.J1||y.AFrameworkApplication.hideHeader&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8451051_NoOpOnHideHeader")||this.VQl()}VQl(){if(!(y.AFrameworkApplication.J1||y.AFrameworkApplication.hideHeader&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8451051_NoOpOnHideHeader"))){var b=
(new cJ(Hu.PRk,this.Pfa)).L8l(),h=Ot.a.efe(Uk.a.QYa,null,b,!0);h.LN=!0;this.i0b(h,wb.a.ypd,wb.a.xpd);h.bindAction(lc.KeyInputManager.xc(pg.a.iib,0),wb.a.Yye);SB.a(1,()=>{this.EKo(b)})}}EKo(b){const h=new Zw;appChrome.renderSharedHeader(b,h.Lca()).then(this.PAf.bind(this))}jIj(){y.AFrameworkApplication.ta.Pb.x7i?appChrome.getHeaderApi().then(b=>{document.getElementById(y.AFrameworkApplication.bsb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new qz.a).PAf()}PAf(){this.$0i&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?
(Fk.a.get_instance().Zk(12,this.jIj.bind(this),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.jIj()}i0b(b,h,r){const A=lc.KeyInputManager.xc(pg.a.iB,0),L=lc.KeyInputManager.xc(pg.a.iB,4);b.Pu(A);b.Pu(L);b.bindAction(A,h);b.bindAction(L,r)}cwf(){const b=!!this.NUa&&"FileMenu"in this.NUa.U8j;y.AFrameworkApplication.ta.Pb.YZa&&!b&&SB.a(1,this.cKo.bind(this))}cKo(){const b=[];if(y.AFrameworkApplication.J.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=
[Object.assign(new Lu,{label:CommonUIStrings.L_DiagnosticsSessionId,value:y.AFrameworkApplication.userSessionId}),Object.assign(new Lu,{label:CommonUIStrings.L_DiagnosticsBuild,value:y.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.gDi());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}OAo(){this.ga.qa(wb.a.T2a,ic.a.view,this.T2a.bind(this));this.ga.qa(wb.a.ozg,ic.a.view,
this.ozg.bind(this));this.ga.qa(wb.a.pzg,ic.a.view,this.pzg.bind(this))}activateRibbonTab(b){this.o_k(b)}Kwc(){Fk.a.get_instance().isCompleted(7)&&this.tFd&&(Yb.a.mark(4893),Mz.a.bHp(),super.Kwc(),Yb.a.mark(4894))}T2a(b,h,r,A,L){if(2===L[Cv.a.aB]){if(r=Object(ya.a)(iv.a,h))A=Object(ya.a)(Vt.a,r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,sb.a.join(L," ",":")),8;if(A&&""!==
A.lN)bi.a.bda(h)&&bi.a.Ovb()||(this.oc.Rg(A.lN),appChrome.selectors.getShyState().isActive&&ww.ShyRibbon.Fpb(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,sb.a.join(L," ",":"),this.HDm(r.view)),8}return 32}HDm(b){return b?"is ContentEditableView: "+b.ql+" is Editing View: "+b.doa+" is HtmlView: "+b.Gcb+" is InteractiveView: "+b.Ee+" is NavigationPaneView: "+
b.Iun+" is PageView: "+b.Aj+" is WordNavigationPaneHeadingsView "+b.I5f:"null view"}}Hu.PRk="WACRibbon";Object(u.a)(Hu,"ReactRibbonUser",cy,[170,171,172,11]);class Zm extends Hu{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc=null,Yc,zd){super(b,h,r,A,L,ba,ra,Ia,Ta,!1,ob,Bc);this.Hal=()=>{this.$s&&this.$s.execute(Jd=>{Jd.logActivity("WordShyRibbon",null)});return 32};this.u8o=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&"true"!==
yc.a.get(y.AFrameworkApplication.J.rb("ReactRibbonMLRPreferenceCookieName"))&&Fk.a.get_instance().Zk(20,()=>{this.$s.execute(Jd=>{Jd.logActivity("FloodgateFirstStart",null)})})};this.Zdn=()=>{ei.a.instance.Gf(th.a.ofn,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(Jd=>{var ie;this.NUa&&Jd.push.apply(Jd,this.GOi());(this.sKh||this.tKh)&&this.pnb&&Jd.push.apply(Jd,this.$qm());Jd.push(appChrome.actions.setControlCustomTooltip(Zn.a.kGn,CommonUIStrings.l_LoopsLearnMoreTooltip));
Jd.push(appChrome.actions.setControlCustomTooltip(Zn.a.Nwl,"Plan and manage tasks with to-do lists you can share and work on with others."));Jd.push(appChrome.actions.setControlCustomTooltip(Zn.a.lqp,"Assign tasks, set due dates, and track in a table you can easily edit."));Jd.push(appChrome.actions.setControlCustomTooltip(Zn.a.Vjo,"Make surveys to get quick feedback, schedule, and plan."));var re=null===(ie=y.AFrameworkApplication.J)||void 0===ie?void 0:ie.rb("ReactShyRibbonPreferenceCookieName");
ie=yc.a.get(re);this.s8o(ie);this.u8o();Jd.push.apply(Jd,this.PMa());Jd.push(appChrome.actions.setControlBehaviorAttached(!0));const me=Xa.a.instance.resolve("WordEditor.IModeSwitcherControl");ie=me.jDm();y.AFrameworkApplication.ud("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(re=appChrome.selectors.getModeSwitcherMode())&&re!==ie.activeMode&&v.ULS.sendTraceTag(527778651,
306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${ie.activeMode}, Actual: ${re}`);"Suggest"===ie.activeMode||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===ie.activeMode?appChrome.getUpdateAppModeAndTabsActions(ie,!0).then(Sd=>{appChrome.api.dispatch(Jd.concat(Sd));me.Eij();this.VWi()}):(Jd.push(appChrome.actions.updateModeSwitcher(ie)),appChrome.api.dispatch(Jd),me.Eij(),this.VWi())})};this.pnb=
nb;this.sKh=Eb;this.tKh=bc;this.$s=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");this.Sb=Yc;this.mWe=zd}nfn(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Fk.a.get_instance().AK(5);const b=this.$0i&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?12:10;Fk.a.get_instance().Zk(b,this.Zdn,11);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.P3k()}P3k(){this.Sb.pc(new Md.a(5,1,0,()=>{this.mWe.execute(b=>
{b.b4o()})}))}$qm(){const b=[];this.sKh&&(b.push(appChrome.actions.setButtonSecondaryText(Zn.a.$1d,this.pnb.vWf)),b.push(appChrome.actions.setButtonSecondaryText(Zn.a.x0d,this.pnb.uWf)),b.push(appChrome.actions.setButtonSecondaryText(Zn.a.jkd,this.pnb.wWf)));this.tKh&&b.push(appChrome.actions.setButtonSecondaryText(Zn.a.hkd,this.pnb.p8m));return b}s8o(b){"true"===b?this.$s.execute(h=>{h.logActivity("OptInShyRibbonNormalScreenActivity",null)}):"false"!==b&&""!==b||!(1300>window.innerWidth||700>window.innerHeight)||
this.$s.execute(h=>{h.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var h;null===(h=document.getElementById("RibbonModeToggle"))||void 0===h?void 0:h.click()},0))},!1);y.AFrameworkApplication.va.nb(wb.a.BWh,dd.a.frame,this.Hal,96)}VWi(){y.AFrameworkApplication.zwc.Mzp();this.ZRh();this.gpf();this.PWi();Fk.a.get_instance().AK(7);ei.a.instance.Cba(th.a.YVc,th.a.nzg,(new Date).getTime());
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&this.fcc&&this.fcc.dfn(ws.a.A0j)}rRa(b){if(b){const h=this.fEi();try{super.rRa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}PMa(){const b=this.fEi();try{return super.PMa()}finally{null===b||void 0===b?void 0:b.dispose()}}fEi(){var b;let h=void 0;const r=null===(b=Ze.a.wf)||void 0===b?void 0:b.Um;r&&(h=new hb.GraphTransaction(Ze.a.O1i()&&Ze.a.V1f?0:2),h.set(r));return h}}Object(u.a)(Zm,
"ReactRibbonUser",Hu,[]);class py extends bJ{constructor(b,h,r,A,L,ba,ra,Ia){super(b,h,r);this.U_e=y.AFrameworkApplication.J.$("PasteWithOptionsFromRibbon")&&X.a.w9;this.hm=L;this.D8e=ba;this.Sb=ra;this.mWe=Ia}YPl(b,h){const r=new Pi(y.AFrameworkApplication.J,this.ga,this.oc,this.U_e),A=new cE.a(r);return this.yQl(b,h,A,r)}yQl(b,h,r,A){var L=new Jk(new EE(y.AFrameworkApplication.J,A),r);r=this.Ken(L);const ba={};L.cBb(ba);L=!X.a.w9;const ra=X.a.zt||X.a.Hj;var Ia=X.a.fm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&
(Ia=X.a.Yi||Ia);Ia=new ha.a(Ia);b=new Zm(b,h,WacWordeditorStrings,this.CGb,A,b,this.hm,r,new hx(ba),this.D8e,Ia,L,ra,new Hv,this.Sb,this.mWe);b.nfn();return b}Ken(b){const h={};b.ird(h);b.Mwd(h);return new zz(null,h,"jewelWordEditor")}}Object(u.a)(py,"WordEditorRibbonUserFactory",bJ,[]);class Cq{constructor(b,h){this.vD=b;this.WKd=h}wXa(b,h,r,A=null,L=null){return this.WKd.qYj(b)?this.WKd.wXa(b,h,r,A,L):this.vD.wXa(b,h,r,A,L)}$Na(b,h=null){return this.WKd.qYj(b)?this.WKd.$Na(b):this.vD.$Na(b,h)}}
Object(u.a)(Cq,"RootCuiUser",null,[184]);class QA extends Cq{constructor(b,h){super(b,h)}clearCache(){this.vD.clearCache()}}Object(u.a)(QA,"WordGeneralCuiUser",Cq,[183,184]);var rk=e(1358);class jx{static getSelectedText(){const b=(new fr.a).RQf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static Uae(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=D.a.VC(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(u.a)(jx,"SearchUtils",null,[]);class Zq extends bb{constructor(b,
h,r){super(b,r);this.zM=h}GJf(b){const h=[];var r=Fg.a.instance.ob.currentSelection;const A=!!this.zM&&this.zM.Lcd(fb.a.Xqf.toString()),L=!!this.zM&&this.zM.Lcd(fb.a.Z_b.toString()),ba=!A&&!r.AZa&&Zq.jgb.Xij(),ra=!(y.AFrameworkApplication.$v&&Zq.A3i)&&(!!this.zM&&this.zM.Lcd(wb.a.IOa.toString())||!!qp.a.instance&&(3===qp.a.instance.mode||2===qp.a.instance.mode)),Ia=r.i7i()&&y.AFrameworkApplication.ta.Pb.Ecd;var Ta=!1;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1)){Ta=!!r&&(r.xy||2===r.length&&Ee.a.em(r.hd));var ob=jx.getSelectedText();Ta=Ta&&0<ob.length&&60>ob.length}b=(ob=3===b||X.a.Yi||y.AFrameworkApplication.lIf)&&Zq.yCf.W4(r,b);r=Zq.A3i&&r&&1===r.length&&r.K(0).contextId===ic.a.kd;ob&&h.push(this.hm.Iua("ClipboardGroup")[0].externalUxGroupId);ba&&(h.push(this.hm.Iua("TextFormattingGroup")[0].externalUxGroupId),h.push(this.hm.Iua("StylesGroup")[0].externalUxGroupId));Ta&&h.push(this.hm.Iua("DefineGroup")[0].externalUxGroupId);A&&h.push(this.hm.Iua("PictureToolsGroup")[0].externalUxGroupId);
L&&h.push(this.hm.Iua("TableToolsGroup")[0].externalUxGroupId);Ia&&h.push(this.hm.Iua("EquationToolsGroup")[0].externalUxGroupId);ra&&h.push(this.hm.Iua("CommentGroup")[0].externalUxGroupId);r&&h.push(this.hm.Iua("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.hm.Iua("ContextMenuGroup")[0].externalUxGroupId);rk.a.w0i&&Zq.Yon&&h.push(this.hm.Iua("DesignerGroup")[0].externalUxGroupId);Zq.vun&&h.push(this.hm.Iua("MiniTemplateGroup")[0].externalUxGroupId);return h}static get yCf(){return null!=
Zq.iZg?Zq.iZg:Zq.iZg=Xa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get jgb(){return null!=Zq.C8g?Zq.C8g:Zq.C8g=Xa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static x$c(b,h,r,A){b.sjl(()=>Zq.gqb(h,r,A))}static gqb(b,h,r){return new Zq(b,h,r)}static get Yon(){null===this.PZe&&(y.AFrameworkApplication.ud("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.PZe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",
!1):!1);return this.PZe}static get A3i(){null!==this.x_e||"Templatization"!==y.AFrameworkApplication.$v&&"ContentAssemblyEdit"!==y.AFrameworkApplication.$v||(y.AFrameworkApplication.ud("insertSnippetTreatment;insertSnippetControl"),this.x_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.x_e}static get vun(){null==this.K_e&&(y.AFrameworkApplication.ud("MiniTemplateV2ConsumerExp;MiniTemplateV2ConsumerExpCf"),
this.K_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1):!1);return this.K_e}}Zq.PZe=null;Zq.x_e=null;Zq.K_e=null;Object(u.a)(Zq,"WordReactFloatie",bb,[]);class SG{constructor(){this.vka=this.aTc=this.Z=null}get name(){return"WordEditor.UI"}init(){var b;this.Z.resolve("WordEditor.UI.BusinessBarController").cog();const h=Ze.a.HD.tL,r=Db.StaticActiveAppFrame.Aa();Zq.x$c(r,this.Z.resolve("Common.IReactContextualUILauncher"),
h,this.Z.resolve("Common.IExternalUICommandDefinitionMapping"));this.vka=this.Z.Wa("Box4.IContextMenuController");const A=new Q(r,h,this.Z.Za("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.PasteFloatieManager")),L={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:L["floatie.gbFormatWithDesignerButton"]=
!1;break;case 2:L["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:L["floatie.gbUseSmartPasteButton"]=!1}A.x$c("PasteFloatieData",null,L);this.Z.resolve("WordEditor.UI.CuiActionBridge").initialize();(new yz(r,h,this.Z.Za("Box4.IGeneralCuiUser"),this.Z.resolve("Box4.UI.ExternalContentFloatieManager"))).x$c("ExternalContentFloatieData",[WacWordeditorStrings],{});this.Z.resolve("Box4.IGeneralCuiUser");Fk.a.get_instance().Zk(7,()=>{this.aTc=this.Z.resolve("WordEditor.UI.StatusBarUser");this.aTc.mc()})}dispose(){this.aTc&&
(this.aTc.dispose(),this.aTc=null);this.vka&&(this.vka.dispose(),this.vka=null)}Ec(b){this.Z=b;b.ja("WordEditor.UI.BusinessBarController",()=>new Qe(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),y.AFrameworkApplication.va,y.AFrameworkApplication.J)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();let h=X.a.fm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=X.a.Yi||h);b.ja("Box4.UI.ShortcutHintMapping",
()=>new ha.a(h));const r=X.a.zt||X.a.Hj,A=y.AFrameworkApplication.J.$("PasteWithOptionsFromContextMenu")&&(X.a.w9||r),L=y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled");b.ja("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new qu(Xa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Xa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Nf.a)).ha();b.ja("WordEditor.UI.EditSurfaceContextMenu",()=>new oi(y.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),
b.resolve("Box4.Proofing.IErrorRangeEditor"),y.AFrameworkApplication.J,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,L?b.Za("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Wa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),
b.Za("Box4.IPresenceDataManager"),b.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Za("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),A,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Xa.a.instance.Za("Common.IActionContextProvider"),Xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),
b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Wa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ja("Box4.ISelectionContextMenuProvider",()=>new Aa).ha();b.ja("WordEditor.UI.CuiActionBridge",()=>new Xk(y.AFrameworkApplication.J)).as("Box4.UI.CuiActionBridge").ha();b.ja("WordEditor.UI.DialogFactory",()=>new CJ).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ja("Common.NonCanvasCuiUser",
()=>new eG(Jc.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ja("WordEditor.UI.WordGeneralCuiUser",()=>new QA(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ja("WordEditor.UI.StatusBarUser",()=>new cu(Db.StaticActiveAppFrame.Aa().bJg,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,Db.StaticActiveAppFrame.Aa())).as("WordEditor.IStatusBarUser").ha();
const ba=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ja("CommandUI.ReactRibbonRoot",()=>new hG(jw.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ba)).ha();const ra=b.Za("WordEditor.UI.WordGeneralCuiUser");b.ja("WordEditor.UI.WordEditorRibbonUserFactory",()=>new py(ra,y.AFrameworkApplication.va,Jc.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),
y.AFrameworkApplication.zc,b.Za("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();let Ia=null;kz.a.npa&&(Ia=this.Z.resolve("Box4.Proofing.IProofingLanguageAutoDetectSettingsInfo"));b.ja("WordEditor.UI.ReactLanguageDialog",()=>new xC(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"),Ia)).as("Box4.UI.ILanguageDialog");b.ja("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new gs(y.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();
b.ja("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new DE(y.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ja("WordEditor.UI.RulerUser",()=>new ks).as("WordEditor.IRulerUser");b.ja("WordEditor.UI.RulerContextMenu",()=>new Lg(y.AFrameworkApplication.va,Xa.a.instance.Za("Common.IZoomManager"),Js.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ja("Common.IReactContextualUILauncher",()=>new XI(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();
b.ja("Box4.IContextMenuController",()=>new Ib(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){y.AFrameworkApplication.ud("5b6i5792;30d4f535");un.instance.Goi();un.instance.lDf();F.a.instance.Rc(new SG,6)}}Object(u.a)(SG,"WordEditorUIPackage",null,[0,1]);var SL=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",
ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},
children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",
Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},kx={};kx.PEc=function(){function b(){return ra()&&(Yc()||3<=(Eb()?zd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function A(Ff){Ff=(new RegExp(Ff+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Hi=-1;
null!=Ff&&2<=Ff.length&&(Hi=parseFloat(Ff[1]),isNaN(Hi)&&(Hi=-1));return Hi}function L(){iL||(iL=!0,jL=A("Windows Phone"));return 8<=jL}function ba(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Bc()&&!Ia()}function ra(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ia(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Ta(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function ob(){return Ta()?
8==window.document.documentMode:!1}function nb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Eb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function bc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Bc(){var Ff=window.navigator.userAgent.toLowerCase();return 0<=Ff.indexOf("android")&&0<=Ff.indexOf("chrome")}function Yc(){return 3<=(nb()?zd("firefox/"):0)}function zd(Ff){var Hi=window.navigator.userAgent.toLowerCase(),Nj=Hi.indexOf(Ff);
return 0<=Nj?parseInt(Hi.substring(Nj+Ff.length,Hi.length)):0}function Jd(Ff,Hi,Nj,gk,Jn){if(gk&&null!=Hi)Hi();else if(ba())navigator.msLaunchUri(Ff,Hi,Nj);else if(!(bc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ra())||Ia())re(Ff,Hi,Nj);else if(bc()&&Jn)a:{try{window.open(Ff,"_self")}catch(Vq){null!=Nj&&Nj();break a}null!=Hi&&Hi()}else ie(Ff,Hi,Nj)}function ie(Ff,Hi,Nj){var gk=document.getElementById("OICLinkTag");
null==gk&&(gk=document.createElement("a"),gk.id="OICLinkTag",gk.style.visibility="hidden",gk.href="",0==(fp.Options&$u.SupportsTopTargetNavigation)||fp.NoBrowserModalDialogs?gk.target="_blank":gk.target="_top",document.body.appendChild(gk),null!=gk.addEventListener&&gk.addEventListener("click",function(Jn){null!=Jn.stopPropagation&&Jn.stopPropagation()},!1));try{gk.href=Ff,gk.dispatchEvent(new MouseEvent("click"))}catch(Jn){null!=Nj&&Nj();return}null!=Hi&&Hi()}function re(Ff,Hi,Nj){var gk=document.getElementById("OICFrame");
null==gk&&(gk=document.createElement("iframe"),gk.className="ObjectInDialog",gk.style.visibility="hidden",gk.src="about:blank",document.body.appendChild(gk),gk.id="OICFrame");try{gk.contentWindow.location.href=Ff}catch(Jn){null!=Nj&&Nj();return}null!=Hi&&Hi()}function me(Ff){return 0!=(Ff.Options&$u.SkipProtocolHandler)||ob()}function Sd(Ff){return Ff===mz.ReadOnly||Ff===mz.ReadWrite}function cf(Ff,Hi,Nj,gk){var Jn;try{var Vq=new ActiveXObject("SharePoint.OpenDocuments.4");return(Jn=Vq.ViewDocument3(window.self,
Ff,Hi,gk))?(wA(Yx.O14ActiveX),ro.None):ro.Failed}catch(lq){}if($u.O14Only===(Nj&$u.O14Only))return fp.DescriptiveUnattemptedEnums?ro.O14AttemptFailure:ro.Unattempted;try{return Vq=new ActiveXObject("SharePoint.OpenDocuments.3"),(Jn=Vq.ViewDocument3(window.self,Ff,Hi,gk))?(wA(Yx.O12ActiveX),ro.None):ro.Failed}catch(lq){}if($u.O12UpOnly===(Nj&$u.O12UpOnly))return fp.DescriptiveUnattemptedEnums?ro.O12UpOnlyFail:ro.Unattempted;try{return Vq=new ActiveXObject("SharePoint.OpenDocuments.2"),(Jn=Sd(Hi)?Vq.ViewDocument2(window.self,
Ff,gk):Vq.EditDocument2(window.self,Ff,gk))?(wA(Yx.O11ActiveX),ro.None):ro.Failed}catch(lq){}return fp.DescriptiveUnattemptedEnums?ro.ActiveXUnattempted:ro.Unattempted}function sf(Ff,Hi,Nj,gk,Jn){Ff==kq.Visio&&Nj==mz.ReadWrite&&(Nj=mz.WriteOnly);gk=gk||r()&&!L();if(!gk){gk="";if(Ff==kq.PowerPoint){Ff=gk;gk=fp.DocumentExtension;Nj=Sd(Nj);var Vq=new Set([".pot",".potm",".potx"]),lq=new Set([".pps",".ppsm",".ppsx"]);Nj=Nj&&Vq.has(gk)?"nft|ofc|":Nj&&lq.has(gk)?"ofv|ofs|t|":!Nj&&lq.has(gk)?"ofe|ofs|t|":
Nj?"ofv|ofc|":"ofe|";Nj=Ff+Nj}else Nj=Sd(Nj)?gk+"ofv|ofc|":gk+"ofe|";Ff=fp.SessionOrigin?"or|"+fp.SessionOrigin+"|":"";Ff+=fp.ClickTime?"ct|"+fp.ClickTime+"|":"";Ff+=fp.CorrelationId?"cid|"+fp.CorrelationId+"|":"";gk=Nj+si(Ff);Jn+=si(gk+"u|")}Jn+=si(Hi);Hi=window.location.href;Nj=Hi.toLowerCase().indexOf("&wdlor=");-1!=Nj?(Nj+=7,Ff=Hi.indexOf("&",Nj),Hi=-1==Ff?Hi.substr(Nj):Hi.substring(Nj,Ff)):Hi=void 0;if(null!=Hi&&"undefined"!=typeof Hi){Nj="";try{Nj=decodeURIComponent(Hi)}catch(eC){}0<Nj.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Nj)&&(Jn=Jn+"|f|"+Nj)}return Jn}function yh(Ff,Hi,Nj,gk,Jn,Vq){var lq=VM(Ff);if(null==lq)return lz(fp.DescriptiveUnattemptedEnums?ro.ProtocolHandlerIsNull:ro.Unattempted,fp.Application),!1;Ff=sf(Ff,Hi,Nj,gk,lq);Jd(Ff,cl,Pj,Jn,Vq);return!0}function si(Ff){if(ra()&&bc()){var Hi="";try{Hi=decodeURI(Ff)}catch(Nj){}if(Hi==Ff)return encodeURI(Ff)}return Ff}function cl(){wA(Yx.ProtocolHandler)}function Pj(){fp.Options|=$u.SkipProtocolHandler;
SI(fp,dC,WD)}function cn(){null!=fL&&fL(Yx.RoamingProtocolHandler)}function Mu(){null!=UI&&UI(ro.ControlNeeded)}function dv(){var Ff=document.getElementById("npSharePointPlugin");if(null==Ff){Ff="application/x-sharepoint";ra()&&3<=(Eb()?zd("version/"):0)&&qy("application/x-sharepoint-webkit",!0)&&(Ff="application/x-sharepoint-webkit");if(!qy(Ff,!0))if(ra()&&qy("application/officelive",!0))Ff="application/officelive";else return null;var Hi=document.createElement("object");Hi.id="npSharePointPlugin";
Hi.type=Ff;Hi.style.width="0px";Hi.style.height="0px";Hi.style.setProperty("visibility","hidden","");document.body.appendChild(Hi);Ff=document.getElementById("npSharePointPlugin")}return Ff}function qy(Ff,Hi){var Nj=window.navigator.mimeTypes;if(null==Nj)return!1;Ff=Nj[Ff];return!Ff||Hi&&!Ff.enabledPlugin?!1:!0}function RA(Ff){try{if(null!=new ActiveXObject(Ff))return!0}catch(Hi){}return!1}function SA(Ff){switch(Ff){case kq.OneNote:return"OneNote.Notebook";default:return""}}function VM(Ff){if(Ff!=
kq.OneNote&&r()&&!L())return"office:";switch(Ff){case kq.Excel:return"ms-excel:";case kq.OneNote:return"onenote:";case kq.PowerPoint:return"ms-powerpoint:";case kq.Visio:return"ms-visio:";case kq.Word:return"ms-word:";case kq.Project:return"ms-project:";case kq.Publisher:return"ms-publisher:";case kq.Infopath:return"ms-infopath:";case kq.Access:return"ms-access:";default:return""}}function WM(Ff){switch(Ff){case kq.Excel:return"root\\office15\\excel.exe";case kq.PowerPoint:return"root\\office15\\powerpnt.exe";
case kq.Visio:return"root\\office15\\visio.exe";case kq.Word:return"root\\office15\\winword.exe";case kq.Project:return"root\\office15\\winproj.exe";case kq.Publisher:return"root\\office15\\mspub.exe";case kq.Infopath:return"root\\office15\\infopath.exe";case kq.Access:return"root\\office15\\msaccess.exe";default:return null}}function SI(Ff,Hi,Nj){fp=Ff;dC=Hi;WD=Nj;if(Ff.DocumentUrl){var gk=Nj=Hi=Ff.DocumentUrl;try{gk=decodeURIComponent(Ff.DocumentUrl)}catch(XD){}try{Nj=encodeURI(Ff.DocumentUrl)}catch(XD){}Hi=
Hi+""+Ff.CorrelationIdForWinClient;gk+=Ff.CorrelationIdForWinClient;Nj+=Ff.CorrelationIdForWinClient;Ff.Mode===mz.ReadWrite&&$u.CheckoutRequired===(Ff.Options&$u.CheckoutRequired)&&(Ff.Mode=mz.ForceCheckout);$u.HostIsEditOnly===(Ff.Options&$u.HostIsEditOnly)&&(Ff.Mode=mz.WriteOnly);if(me(Ff)?0:ra()&&(Ff.Application==kq.OneNote||qy("application/x-sharepoint-protocolhandler",!1)||qy("application/x-sharepoint-webkit-protocolhandler",!1))||ba()||Bc()||!(b()||Yc()||"ActiveXObject"in window&&!r()||bc())||
15<=VD())yh(Ff.Application,Ff.EncodeUrl?Nj:Hi,Ff.Mode,Ff.Application==kq.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen);else{var Jn;if(Jn=ob())a:{var Vq=Ff.EncodeUrl?Hi:gk,lq=Ff.Mode,eC=SA(Ff.Application);try{Jn=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Vq,lq,eC);break a}catch(XD){}Jn=!1}if(Jn)wA(Yx.O15ActiveX);else{if(b()||Yc()){var ds=Ff.EncodeUrl?Hi:gk;gk=Ff.Mode;Jn=SA(Ff.Application);Vq=dv();if(null==Vq)ds=fp.DescriptiveUnattemptedEnums?ro.PluginIsNull:
ro.Unattempted;else{lq=!1;try{lq=Vq.ViewDocument3(window.self,ds,gk,Jn)}catch(XD){}if(!lq)try{lq=Sd(gk)?Vq.ViewDocument2(window.self,ds,Jn):Vq.EditDocument2(window.self,ds,Jn)}catch(XD){}lq?(wA(Yx.NpapiPlugin),ds=ro.None):ds=ro.Failed}}else{try{ds=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=ds&&ds.SaveSSOCreds()}catch(XD){}ds=cf(Ff.EncodeUrl?Hi:gk,Ff.Mode,Ff.Options,SA(Ff.Application))}if(ds!=ro.None){if(gk=Ff.CouldUseRoamingApps)gL||(gL=!0,hL=A("Windows NT")),gk=6.1<=hL&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(Ta()||Yc()||bc());if(gk&&Ff.Application!=kq.OneNote){if(!kx.PEc.KTp()){lz(ro.ControlNeeded,fp.Application);return}if(Ff.RoamingAppsLauncher){"undefined"==typeof Ff.RoamingAppsLauncher||null==Ff.RoamingAppsLauncher?lz(fp.DescriptiveUnattemptedEnums?ro.RoamingLauncherIsNull:ro.Unattempted,fp.Application):"undefined"==typeof Ff.RoamingBitsUrl||null==Ff.RoamingBitsUrl?kx.PEc.eWp(Ff.DocumentUrl,Ff.RoamingAppsLauncher,Ff.Application,Ff.ApplicationParameters,dC,WD):kx.PEc.Rmk(Ff.DocumentUrl,Ff.RoamingAppsLauncher,
Ff.RoamingApplicationExe,Ff.ApplicationParameters,Ff.RoamingPlatform,Ff.RoamingBitsUrl,dC,WD);return}if(!Ff.ContinueIfLauncherIsNull){lz(ro.LauncherNeeded,fp.Application);return}}$u.NoProtocolHandlerFallback==(Ff.Options&$u.NoProtocolHandlerFallback)||me(Ff)||Ta()||ra()&&!(fp.DescriptiveUnattemptedEnums?ds>=ro.O14Unattempted&&ds<=ro.DocumentUrlIsNull:ds==ro.Unattempted)?lz(ds,fp.Application):yh(Ff.Application,Ff.EncodeUrl?Nj:Hi,Ff.Mode,Ff.Application==kq.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen)}}}}else lz(fp.DescriptiveUnattemptedEnums?
ro.DocumentUrlIsNull:ro.Unattempted,fp.Application)}function wA(Ff){null!=dC&&dC(Ff)}function lz(Ff,Hi){"undefined"==typeof Hi&&(Hi=null);null!=WD&&WD(Ff,Hi)}function VD(){var Ff=0;if(b()||Yc()||bc()){var Hi=dv();try{null!=Hi&&(Ff=Hi.GetOfficeVersion())}catch(Nj){}}else RA("SharePoint.OpenDocuments.5")?Ff=15:RA("SharePoint.OpenDocuments.4")?Ff=14:RA("SharePoint.OpenDocuments.3")?Ff=12:RA("SharePoint.OpenDocuments.2")&&(Ff=11);return Ff}function TI(){return ra()&&(qy("application/x-sharepoint",!0)||
qy("application/x-sharepoint-webkit",!0))}var iM="",jM="",kM="",dC,WD,fL,UI,fp,gL,hL,iL,jL,mz={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},$u={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ro={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Yx={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},kq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:mz,OpenDocumentOptions:$u,OpenDocumentFailureType:ro,OpenDocumentControl:Yx,OfficeApplication:kq,EditDocumentInClient:SI,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=kq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=
this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:VD,IsO14MacPluginInstalled:TI,OfferOfficeInDialog:function(){return h()&&11>=VD()},OfferOfficeNoIntrusive:function(){return h()&&15>VD()},OfferMacOffice:function(){return ra()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!TI()},InstallRoamingControl:function(){nb()?window.InstallTrigger.install({Office:{URL:jM}}):re(kM,null,null)},CanUseRoamingControl:function(){if(ba())return!0;if(bc())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(nb()){var Ff=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Ff);var Hi=document.createEvent("Events");Hi.initEvent("RoamingOfficeInstalled",!0,!1);Ff.dispatchEvent(Hi);return!!Ff.getAttribute("installed")}if(Ta())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Nj){}return!1},InitUrls:function(Ff,Hi,Nj){iM=Ff;jM=Nj;kM=Hi},LaunchRoamingApps:function(Ff,
Hi,Nj,gk,Jn,Vq){kx.PEc.Rmk(Ff,Hi,WM(Nj),gk,"x86",iM,Jn,Vq)},LaunchRoamingApps2:function(Ff,Hi,Nj,gk,Jn,Vq,lq,eC){var ds="";null!=gk&&(ds+=" "+gk);null!=Ff&&(ds+=' "'+Ff+'"');if(ba()||bc())fL=lq,UI=eC,lq='office: "'+(Vq+'" "')+(Nj+'" "ROAMING"'),lq+=' "'+Hi+'"',lq+=' "'+Jn+'"',lq+=" "+ds,Jd(lq,cn,Mu,!1,!1);else if(nb())Ff=document.createElement("RoamingExtensionElement"),Ff.setAttribute("cabUrl",Vq),Ff.setAttribute("app",Nj),Ff.setAttribute("licensingEntitlements",Hi),Ff.setAttribute("platform",Jn),
Ff.setAttribute("args",ds),document.documentElement.appendChild(Ff),Hi=document.createEvent("Events"),Hi.initEvent("RoamingOfficeLaunch",!0,!1),Ff.dispatchEvent(Hi),null!=lq&&lq(Yx.RoamingFFExtension);else if(Ta()){if(Ff=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Ff)try{Ff.HrConfigureSingle(Vq,Nj,Hi,Jn,ds),null!=lq&&lq(Yx.RoamingActiveX)}catch(XD){}}else null!=eC&&eC(ro.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:ie,OpenDocumentWithProtocolHandler:yh,
OpenDocumentWithProtocolHandlerNoCallBack:function(Ff,Hi,Nj,gk){var Jn=VM(Ff);if(null==Jn)return lz(fp.DescriptiveUnattemptedEnums?ro.ProtocolHandlerNoCallbackIsNull:ro.Unattempted,fp.Application),!1;Ff=sf(Ff,Hi,Nj,gk,Jn);Jd(Ff,null,null,!1,!1);return!0}}}();kx.ClientUtils=kx.PEc;var TL=e(1372);class jt{constructor(b,h,r){this.Tao=(A,L,ba,ra,Ia)=>{if(1===ba)return 32;Ia?(A=Ia.SourceControlId,"btnjTryMacOfficeForWordEditor"===A?ed.a.Zm(db.a.Mab(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===A&&ed.a.Zm(db.a.Mab(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Daj();return 32};this.Kuj=(A,L,ba)=>{if(1===ba)return 32;switch(A){case wb.a.M9j:ed.a.Zm(db.a.Mab(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case wb.a.L9j:ed.a.Zm(db.a.Mab(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.ga=b;this.DHk=h;this.Taa=r}mc(){this.ga.qa(wb.a.byp,dd.a.frame,this.Tao);this.ga.qa(wb.a.M9j,dd.a.frame,this.Kuj);
this.ga.qa(wb.a.L9j,dd.a.frame,this.Kuj)}Daj(){ed.a.Zm(jt.EPn,"_blank",void 0,"LaunchMacTrialWindow")}get usd(){return this.DHk&&X.a.fm&&!X.a.y3f&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get pap(){const b=this.usd;b||y.AFrameworkApplication.uo.xZo();return b}get oap(){return this.usd}static get EPn(){return db.a.Jca("522401")}}Object(u.a)(jt,"MacOfficeOffer",null,[1903]);class uh{constructor(b,h,r){this.Uao=(A,L,ba,ra,Ia)=>{if(this.OSd&&1===ba)return this.isFreemiumUpsellEnabled&&this.vsd?32:
8;2===ba&&(Ia?(A=Ia.SourceControlId,"btnjTryOfficeForWordEditor"===A?ed.a.Zm(db.a.Mab(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===A?ed.a.Zm(db.a.Mab(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.V6f()):this.V6f());return 32};this.aOg=(A,L,ba,ra,Ia)=>{if(this.OSd&&1===ba)return this.isFreemiumUpsellEnabled&&this.vsd?32:8;2===ba&&(Ia?(A=Ia.SourceControlId,ed.a.Zm(db.a.Jca("862405")+this.rLm(A),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
ed.a.Zm(db.a.Jca("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.T9j=(A,L,ba)=>{if(this.OSd&&1===ba)return this.isFreemiumUpsellEnabled&&this.vsd?32:8;if(2===ba)switch(A){case wb.a.S9j:ed.a.Zm(db.a.Mab(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case wb.a.R9j:ed.a.Zm(db.a.Mab(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.ga=b;this.KHk=h;this.yM=null;(this.OSd=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(A=>{this.yM=A});this.Taa=r}mc(){this.ga.qa(wb.a.myp,dd.a.frame,this.Uao);this.ga.qa(wb.a.aOg,dd.a.frame,this.aOg);this.ga.qa(wb.a.S9j,dd.a.frame,this.T9j);this.ga.qa(wb.a.R9j,dd.a.frame,this.T9j)}get p0n(){return this.vsd}get o0n(){return this.vsd&&MSOJS.ClientUtils.OfferOfficeInDialog()}get vsd(){return this.KHk&&!X.a.fm}get isFreemiumUpsellEnabled(){let b=!1;this.yM&&(b=this.yM.isFreemiumUpsellEnabled());
return b}V6f(b=null){let h=0;b&&(h=b);ed.a.Zm(uh.XEm(h),"_blank",void 0,"LaunchOfficeOffer")}rLm(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;
case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static XEm(b){if(X.a.Yi)switch(b){case 1:return db.a.Jca("393806");case 2:return db.a.Jca("393810");case 3:return db.a.Jca("393809");case 5:return db.a.Jca("393805")}else if(X.a.gK)switch(b){case 1:return db.a.Jca("521979");
case 3:return db.a.Jca("521980");case 5:return db.a.Jca("521978");case 2:return db.a.Jca("522490")}else{if(2===b)return db.a.Jca("517778");if(1===b)return db.a.Mab(30)}return db.a.Jca("522402")}}Object(u.a)(uh,"OfficeTrialExperience",null,[1902]);class $q{Ec(b){b.register(uh,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().fe(()=>new uh(y.AFrameworkApplication.va,y.AFrameworkApplication.d3f,y.AFrameworkApplication.lcid));b.register(jt,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().fe(()=>
new jt(y.AFrameworkApplication.va,y.AFrameworkApplication.u4i,y.AFrameworkApplication.lcid))}}Object(u.a)($q,"OpenInClientConfiguration",null,[1]);class zw{constructor(b=!1,h=!1,r=!1,A=!1,L=!0,ba=!1,ra=!0,Ia=!0,Ta=!0,ob=!1,nb=!1,Eb=!1,bc=!1,Bc=!1,Yc=!1,zd=!1,Jd=!1,ie=!1,re=null,me=null,Sd=null,cf=null,sf=null,yh=null,si=null,cl=null,Pj=null){this.hqc=!1;this.LOk=b;this.QOk=h;this.oTk=r;this.mTk=A;this.hTk=L;this.iTk=ba;this.kTk=ra;this.lTk=Ia;this.jTk=Ta;this.zTk=ob;this.STk=nb;this.yTk=Eb;this.kVk=
bc;this.sTk=Bc;this.MFk=Yc;this.LTk=zd;this.TTk=Jd;this.cwk=ie;this.qTk=re;this.xTk=me;this.nTk=sf;this.vTk=Sd;this.pTk=cf;this.uTk=yh;this.wTk=si;this.rTk=cl;this.tTk=Pj}get Jxj(){return this.LOk}get Dho(){return this.QOk}get mYj(){return this.oTk}get lYj(){return this.mTk}get x$o(){return this.hTk}get y$o(){return this.iTk}get A$o(){return this.kTk}get B$o(){return this.lTk}get z$o(){return this.jTk}get kBb(){return this.sTk}get Xfn(){return this.MFk}get VYj(){return this.LTk}get uZj(){return this.TTk}get Msl(){return this.cwk}get pYj(){return this.zTk}get Pbp(){return this.STk}get K$o(){return this.yTk}get qnp(){return this.kVk}get nYj(){return this.qTk||
Object(E.a)(this,this.Fyc,"returnFalse")}get J$o(){return this.xTk||Object(E.a)(this,this.Fyc,"returnFalse")}get I$o(){return this.vTk||Object(E.a)(this,this.Xyg,"returnTrue")}get D$o(){return this.pTk||Object(E.a)(this,this.Xyg,"returnTrue")}get C$o(){return this.nTk||Object(E.a)(this,this.Fyc,"returnFalse")}get H$o(){return this.uTk||Object(E.a)(this,this.Xyg,"returnTrue")}get oYj(){return this.wTk||Object(E.a)(this,this.Fyc,"returnFalse")}get E$o(){return this.rTk||Object(E.a)(this,this.Fyc,"returnFalse")}get G$o(){return this.tTk||
Object(E.a)(this,this.Fyc,"returnFalse")}Xyg(){return!0}Fyc(){return!1}}Object(u.a)(zw,"HtmlTranslatorSettings",null,[262]);class Kn{constructor(b,h,r,A,L,ba){this.Ig=b;this.Ug=h;this.P0=r;this.uFf=A;this.lk=L;this.Yd=ba}mhn(b,h){b=h.view;h=h.Pk;if(!h||!this.Ig.Z1i(h,!0)||this.uFf&&this.uFf.instance&&this.uFf.instance.wZ(h))return 2;var r=Kn.bhb?!Kn.O1.aEa(h):!0;this.P0&&r&&this.P0.yDc(h.node,pg.a.vw,h.cpBegin);this.Ug.Vna(h,L=>new Ez.a(L));if(this.Yd.Zg){r=new hb.GraphTransaction(15);try{r.Eb(h.node),
this.lk.Kpa(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}var A=h.node;r=h.cpEnd+1;" "===rd.ParagraphReader.text(A).charAt(r)&&(A=vc.a.createTextRange(A,r,r+1),this.Ug.lf(A,"\u00a0"));h=vc.a.jd(h.node,r);b.ub.Uc(Tb.SelectionFactory.aq(h));return 32}static get O1(){return null!=Kn.m1g?Kn.m1g:Kn.m1g=Xa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get bhb(){null==Kn.qsa&&(Kn.qsa=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Kn.qsa}}
Kn.qsa=null;Object(u.a)(Kn,"InsertLineBreakStrategy",null,[]);class ur{static get Yf(){return null!=ur.A6g?ur.A6g:ur.A6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get lk(){return null!=ur.T$g?ur.T$g:ur.T$g=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Yd(){return null!=ur.yah?ur.yah:ur.yah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static Khn(b,h,r,A,L){if(L&&L.hasProperty(Pd.a.targetObject)){var ba=h.view.Fd.ed.Mb(L.getValue(Pd.a.targetObject));
ba=vc.a.create(ba)}else ba=Object(ak.a)().zV(h.Pk,11);if(!ba)return 8;b=y.AFrameworkApplication.va.Sf(ba,b,r,!0,A,L);if(32===b&&2===r){if(!h.view.Ee)return 2;h=h.view;A=h.ub.hh;if(A=Object(ak.a)().zV(A,11)){r=new Oi.a;r.set(A.node);r.Wd();if(L&&L.hasProperty(Pd.a.targetObject))for(L=L.Uf(Pd.a.targetObject);!r.currentNode.id.equals(L)&&r.Ac()&&(hg.a.xe(r),11===r.Jf););hg.a.D5(r,!1,!1);L=Ee.a.gMa(r,!0);L=rd.ParagraphReader.Xv(L)?Tb.SelectionFactory.Ie(L,0):Tb.SelectionFactory.ot(L);h.ub.Uc(L)}}return b}static wfe(b,
h,r,A,L){b=b===fb.a.V$c;h=h.node;if(L&&L.hasProperty(Pd.a.targetObject)&&!h.id.equals(L.Uf(Pd.a.targetObject)))return 2;if(1===r)return 32;r=new te.a;r.set(h);r.Ib(10);ur.Yf.mA(r,b,!0);ur.Yd.Zg&&(r=hg.a.Ze(r),ur.lk.E2b(r,1));return 32}}Object(u.a)(ur,"InsertOutlineElementStrategy",null,[]);class kt{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.VXi=(Eb,bc,Bc)=>{var Yc,zd;if(null===(Yc=this.nTa)||void 0===Yc?0:Yc.E2a)return this.nTa.E2a(Bc,bc.cpBegin,{Ob:bc.Ob,nc:bc.nc});Yc=!bc.cpBegin;Bc=bc.cpBegin===
rd.ParagraphReader.textLength(Bc);const Jd=!(null===(zd=If.a.Gd())||void 0===zd||!zd.pn);let ie=!0;Jd&&Yc&&!Bc?(ie=!1,zd=new te.a,zd.Ad(Eb),zd.Wd(),this.ni.mA(zd,!0,!1)):zd=this.ni.kva(Eb);this.ni.wea(Eb,zd,bc,!1,!0,ie,!1,!0);!Jd||Yc||Bc||(Eb=Object(ak.a)().V8d(bc),If.a.Gd().Qk.uI(Eb));return zd};this.h3=h;this.EAk=b;this.pD=ba;this.TJk=L;this.ni=r;this.zyk=A;this.sm=ra;this.pb=Ia;this.rI=Ta;this.ZHc=ob;this.nTa=nb}hYn(b,h,r,A,L){if(!h.view.Ee)return 2;h=h.view;let ba=null;h.Aj&&(ba=h);const ra=h.ub.hh;
var Ia=!0;let Ta=!1,ob=null;if(!ra)return 2;const nb=new hb.GraphTransaction(15);nb.Eb(h.Fd);let Eb=null;2===r&&(Eb=new Oi.a,Eb.set(ra.node),Eb.Wd(),ob=new gH.a(Eb),hg.a.xe(Eb),Ia=Mb.a.isEmpty(Eb,!1),{GYj:Ia,qhk:Ta}=this.zyk.HYj(Eb,Ia,px.a.hTb,-1,ra));b=y.AFrameworkApplication.va.Sf(ra,b,r,!1,A,L);Ia&&32===b&&2===r&&(Ta||hg.a.EOa(Eb,!1,!Ee.a.Df(ra),!1),Ta&&ob&&ob.restore(Eb),this.pD.freeze(),(r=Tb.SelectionFactory.zq(Eb.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),
h.ub.Uc(r),this.pD.RQa(),this.EAk.Dh.eK());ba&&(Ia||ba.c6(),ba.Ve&&ba.xZ&&(ba.Ve.mM=!0));tx.a.instance.c5b(1);nb.dispose();return b}vG(b,h,r){b=!1;if(pe.a.v9(h)||pe.a.lcb(h))h=this.IHl(h),b=!0;const A=h;if((h=Ee.a.Df(h))&&this.sm.ii&&!this.sm.Qun(A))return 2;if(1===r)return 32;const L=A.node,ba=new te.a;ba.set(L);ba.Wd();hg.a.xe(ba);r=new hb.GraphTransaction(15);r.nw(ba);h?(this.ZHc.instance&&this.ZHc.instance.fRa(A),rd.ParagraphReader.lc(L)&&A.cpBegin===rd.ParagraphReader.textLength(L)&&kp.m(A)&&
9===rd.ParagraphReader.yna(L)&&this.pD.FIl(A),nf.a.Wg(ba)?this.TJk.execute(ba,A,L,this.VXi):this.VXi(ba,A,L),this.h3&&this.h3.yDc(L,pg.a.vw,A.cpBegin),b&&(hg.a.Fu(ba,!1,!1),b=ba.ic(2),(b=this.rI.Ie(b,0))&&this.pb.Uc(b))):this.ni.mA(ba,!0,!0);r.dispose();Db.StaticActiveAppFrame.Aa()&&Db.StaticActiveAppFrame.Aa().Ne();return 32}IHl(b){if(pe.a.v9(b))var h=vc.a.jd(b.node,b.cpBegin);else{h=rd.ParagraphReader.Z0(b.node);var r=h.properties.Uf(Rc.a.qU);b=b.node.properties.getValue(Rc.a.runId);r=kt.HLf(b,
r,h.ra);h=vc.a.jd(h,r)}return h}static JGf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static HLf(b,h,r){let A=0;b=kt.JGf(b,h);let L=0;if(b===h.length)L=r.length-1;else for(;L<r.length;){h=r.jc(L);if(h.formatting&&h.formatting.Re===b)break;L++}L<r.length&&(A=r.jc(L).cp);return A}}Object(u.a)(kt,"NewLineStrategy",null,[]);class Os{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc,zd){this.yo=null;this.Hsa=b;this.bEd=ra;this.PKd=new kt(this,h,r,A,L,ba,Ia,nb,Eb,Yc,zd);this.wsh=new Kn(Ia,
Ta,h,ob,bc,Bc)}get Dh(){return this.yo||(this.yo=this.Hsa())}mc(){const b=y.AFrameworkApplication.va,h=Object(E.a)(this.PKd,this.PKd.vG,"newLine");b.nb(fb.a.enter,ic.a.view,Object(E.a)(this.bEd.value,this.bEd.value.X8l,"enterView"),1124);b.nb(fb.a.NXj,ic.a.view,Object(E.a)(this.bEd.value,this.bEd.value.j9o,"shiftEnterView"),1124);b.qa(fb.a.vG,ic.a.view,Object(E.a)(this.PKd,this.PKd.hYn,"newLineView"));b.qa(fb.a.vG,ic.a.kd,h);b.qa(fb.a.vG,ic.a.image,h);b.qa(fb.a.vG,ic.a.Nd,h);b.qa(fb.a.vG,ic.a.Fba,
h);b.qa(fb.a.vG,ic.a.Jrb,h);b.qa(fb.a.vG,ic.a.ink,h);b.qa(fb.a.vG,ic.a.paragraph,h);b.qa(fb.a.vG,ic.a.OL,h);b.qa(fb.a.vG,ic.a.oRa,h);b.Oc(fb.a.vG,1124);b.nb(fb.a.R$c,ic.a.view,Object(E.a)(this.wsh,this.wsh.mhn,"insertLineBreakView"),1028);b.qa(fb.a.V$c,ic.a.view,ur.Khn);b.qa(fb.a.V$c,ic.a.gU,ur.wfe);b.Oc(fb.a.V$c,1092)}static get instance(){return null!=Os.r2g?Os.r2g:Os.r2g=Os.In()}static In(){return new Os(()=>Xa.a.instance.resolve("Box4.IUndoManager"),Xa.a.instance.Wa("Box4.IAutoCorrectScheduler"),
Xa.a.instance.resolve("Box4.IOutlineElementEditor"),Xa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Xa.a.instance.resolve("Box4.List.ListNewLineStrategy"),Xa.a.instance.resolve("Box4.IInsertionPointFormatting"),Xa.a.instance.zf("Box4.Actors.IEnterViewStrategy"),Ke.a.instance,Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.Za("Box4.IExternalSelectionManager"),Fg.a.instance,Xa.a.instance.resolve("Box4.ISelectionFactory"),Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xa.a.instance.Za("Box4.IContentControlConverter"),Xa.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(u.a)(Os,"EnterActor",null,[]);var Nh=e(1273),sn=e(605);class Aj{static get gm(){return null!=Aj.o7g?Aj.o7g:Aj.o7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}static get D$(){return null!=Aj.m9g?Aj.m9g:Aj.m9g=Xa.a.instance.Wa("Box4.ISpacingCommands")}static get KBb(){return null!=Aj.y9g?Aj.y9g:Aj.y9g=Xa.a.instance.Wa("Box4.Styles.IWACStyleReader")}static get sdb(){return null!=
Aj.r5g?Aj.r5g:Aj.r5g=Xa.a.instance.Wa("Box4.ILineSpacingHelper")}static get lk(){return null!=Aj.$$g?Aj.$$g:Aj.$$g=Xa.a.instance.Wa("Box4.TrackChange.ITrackChangeEditor")}static get Yd(){return null!=Aj.Dah?Aj.Dah:Aj.Dah=Xa.a.instance.Wa("Box4.TrackChange.ITrackChangeManager")}static mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.H7f,ic.a.view,hn.a.oz);b.Oc(fb.a.H7f,1028);b.qa(fb.a.HG,ic.a.view,hn.a.oz);b.qa(fb.a.HG,ic.a.paragraph,Aj.dWd);b.Oc(fb.a.HG,1036);b.qa(fb.a.Lzc,ic.a.paragraph,Aj.hdl);
b.qa(fb.a.Lzc,ic.a.view,hn.a.oz);b.Oc(fb.a.Lzc,1036);b.qa(fb.a.krd,ic.a.paragraph,Aj.Klf);b.qa(fb.a.krd,ic.a.view,hn.a.oz);b.qa(fb.a.Yrd,ic.a.paragraph,Aj.gmf);b.qa(fb.a.Yrd,ic.a.view,hn.a.oz);b.qa(fb.a.jrd,ic.a.paragraph,Aj.Jlf);b.qa(fb.a.jrd,ic.a.view,hn.a.oz);b.qa(fb.a.Fif,ic.a.view,Aj.y9k);b.Oc(fb.a.Fif,1036);b.qa(fb.a.cwg,ic.a.view,Aj.HJo);b.Oc(fb.a.cwg,1036);b.qa(fb.a.Eif,ic.a.view,Aj.x9k);b.Oc(fb.a.Eif,1036);b.qa(fb.a.bwg,ic.a.view,Aj.GJo);b.Oc(fb.a.bwg,1036);b.qa(fb.a.j2a,ic.a.view,hn.a.oz);
b.qa(fb.a.j2a,ic.a.paragraph,Aj.dWd);b.Oc(fb.a.j2a,1036);b.qa(fb.a.i2a,ic.a.view,hn.a.oz);b.qa(fb.a.i2a,ic.a.paragraph,Aj.dWd);b.Oc(fb.a.i2a,1036);b.qa(fb.a.eEe,ic.a.view,Aj.dEe);b.qa(fb.a.eEe,ic.a.paragraph,Aj.dEe);b.Oc(fb.a.eEe,1028);b.qa(fb.a.pIg,ic.a.view,Aj.dEe);b.qa(fb.a.pIg,ic.a.paragraph,Aj.dEe);b.Oc(fb.a.pIg,1028);b.qa(fb.a.YDe,ic.a.view,hn.a.oz);b.qa(fb.a.YDe,ic.a.paragraph,Aj.JYh);b.Oc(fb.a.YDe,1028);b.qa(fb.a.XDe,ic.a.view,hn.a.oz);b.qa(fb.a.XDe,ic.a.paragraph,Aj.JYh);b.Oc(fb.a.XDe,1028)}static JYh(b,
h,r,A,L){if(1===r)return 32;b===fb.a.YDe?b=fb.a.j2a:b===fb.a.XDe&&(b=fb.a.i2a);return Aj.dWd(b,h,r,A,Aj.cho(L))}static cho(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new Nh.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static dEe(b,h,r,A,L){if(2===r){h=L[vi.a.Text];r=L[vi.a.Number];L=L.Increment;A=new Nh.a;let ba=!1;""===h||L&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(A.value=0,A.unit=Ze.a.ONa?2:4,ba=!0):r||L||(A.value=0,A.unit=1,ba=!0);ba&&(y.AFrameworkApplication.va.Zb(b===
fb.a.eEe?fb.a.j2a:fb.a.i2a,2,A),Db.StaticActiveAppFrame.Aa().Ne())}return 32}static dWd(b,h,r,A,L){if(!({xB:r}=hn.a.yFg(r,h)).returnValue)return r;h=h.node;switch(b){case fb.a.HG:Aj.gm.HG(h,new sn.a(2,L));break;case fb.a.j2a:b=new sn.a(L.unit,L.value);Aj.gm.DAb(h,b);break;case fb.a.i2a:b=new sn.a(L.unit,L.value),Aj.gm.CAb(h,b)}A&&ru.a.fCb&&(A.Av|=ru.a.gtb(h));return 32}static y9k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Aj.GMi(h);
if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ka(Rc.a.vk,240)/20)?b:Aj.jVl;Aj.D$.tja(1,b,4);return 32}static HJo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Aj.D$.tja(1,0,4);return 32}static x9k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Aj.GMi(h);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),
8;b=b.ka(Rc.a.ua,240)/20;Aj.D$.tja(0,b?b:12,4);return 32}static GJo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Aj.D$.tja(0,0,4);return 32}static Klf(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=h.node;h=b.GC();Aj.gm.Klf(b,L);h&&Aj.lk.MR(b,h,Aj.Yd.Zg)}return 32}static gmf(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=h.node;h=b.GC();Aj.gm.gmf(b,L);h&&Aj.lk.MR(b,h,Aj.Yd.Zg)}return 32}static Jlf(b,h,r,A,L){if(2==
r){if("boolean"!==typeof L)return 16;b=h.node;h=b.GC();Aj.gm.Jlf(b,L);h&&Aj.lk.MR(b,h,Aj.Yd.Zg)}return 32}static hdl(b,h,r,A,L){if(2==r){if("boolean"!==typeof L)return 16;b=new Map;b.set("Value",L.toString());Ca.Health.instance.recordKpiUsage(Gi.a.hOa.ytp,0,Gi.a.GB,b);h=h.node;b=h.GC();h.hasProperty(Rc.a.eA)&&h.removeProperty(Rc.a.eA);Aj.sdb.c9d(h)!==L&&h.setValue(Rc.a.eA,L);(L=Aj.sdb.Imc(h,!0))&&L.vm(4,!0);(L=Aj.sdb.Imc(h,!1))&&L.vm(4,!0);b&&Aj.lk.MR(h,b,Aj.Yd.Zg)}return 32}static GMi(b){b=b.view;
return b.Ee&&(b=b.ub)&&b.ob.currentSelection?Aj.KBb.Lr(b.ob.currentSelection.Ya.node):null}}Aj.jVl=12;Object(u.a)(Aj,"SpacingActor",null,[]);class Rv{process(){}}Object(u.a)(Rv,"NoOpFormattingViewOperationFinishedStageProcessor",null,[1614]);class Ps{constructor(b){this.Pe=b}a1o(b,h){b&&h&&h.cache&&(this.Pe.rja(b,h.cache.aK),this.Pe.tE(b,h.cache.fontSize))}YSb(){return null}uYa(){return null}tnc(){return null}cZ(){return null}}Object(u.a)(Ps,"FormattingStewardBridge",null,[1613]);class Az{Ec(b){b.ja("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",
()=>new Rv).ha();b.ja("Box4.Actors.IFormattingStewardBridge",()=>new Ps(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(u.a)(Az,"WoncaActorsConfiguration",null,[1]);class sp{constructor(b,h,r,A,L,ba,ra,Ia){this.ga=b;this.rvk=h;this.qvk=r;this.Teh=A;this.OOk=L;this.xMd=ba;this.SOk=ra;this.TOk=Ia}get Tb(){return this.ga}Cll(b){this.Tb.Oia(b,this.rvk,null,null)}zll(b){this.Tb.Oia(b,this.qvk,null,null)}o8(b,h,r){r?this.Tb.Oia(b,this.Teh,h,null):this.Tb.Zb(this.Teh,2,h)}Fho(b,h){this.Tb.Oia(b,this.xMd,
h,null)}S5(b,h){this.Tb.Oia(b,this.SOk,h,null)}azb(b,h){this.Tb.Oia(b,this.TOk,h,null)}Ang(b,h=!1){const r=new Ai.DictionaryPropertySet;r.setValue(Pd.a.PZ,b);r.setValue(Pd.a.eyj,!0);r.setValue(Pd.a.xcb,h);this.Tb.Zb(this.OOk,2,r)}}Object(u.a)(sp,"ClipboardCommands",null,[1607]);class TG{}Object(u.a)(TG,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1606]);class $w{constructor(b){this.ga=b}get Tb(){return this.ga}TUj(b,h,r){let A=0;b?1===b&&(A=fb.a.Ubb):A=fb.a.Tbb;b=new UF.a;b.unit=r;b.value=
h;this.Tb.Zb(A,2,b)}MBe(b,h,r){let A=0;1===b?A=fb.a.w2b:2===b?A=fb.a.ZAb:b||(A=fb.a.x2b);b=new UF.a;b.unit=r;b.value=h;this.Tb.Zb(A,2,b)}}Object(u.a)($w,"IndentationCommands",null,[1598]);var dy;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.xcq=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.w5p=7]="distribute";b[b.margin=8]="margin";b[b.Taq=9]="highKashida";b[b.nfq=10]="lowKashida";b[b.Lfq=11]="mediumKashida";
b[b.gnq=12]="numTab";b[b.Jxq=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(dy||(dy={}));Object(u.b)("Justification",dy);class jk{constructor(b){this.LTa={};this.ga=b;this.kcn()}get Tb(){return this.ga}qJ(b){b=this.LTa[dy[b]];void 0!==b&&null!==b&&this.Tb.Vb(b,2)}kcn(){this.LTa.left=fb.a.G9;this.LTa.center=fb.a.Rba;this.LTa.right=fb.a.p$;this.LTa.both=fb.a.vMa;this.LTa.lowKashida=fb.a.RWb;this.LTa.mediumKashida=fb.a.RWb;this.LTa.highKashida=fb.a.RWb;this.LTa.distribute=fb.a.m1c;this.LTa.thaiDistribute=
fb.a.Trd}}Object(u.a)(jk,"JustificationCommands",null,[1597]);class cv{constructor(b){this.ga=b}HG(b){this.ga.Zb(fb.a.HG,2,b)}Lzc(b){this.ga.Zb(fb.a.Lzc,2,b)}krd(b){this.ga.Zb(fb.a.krd,2,b)}Yrd(b){this.ga.Zb(fb.a.Yrd,2,b)}jrd(b){this.ga.Zb(fb.a.jrd,2,b)}tja(b,h,r){this.ga.Zb(b?fb.a.j2a:fb.a.i2a,2,Object.assign(new Nh.a,{value:h,unit:r}))}}Object(u.a)(cv,"SpacingCommands",null,[1595]);class ar{constructor(b,h,r){this.Tb=b;this.Q1c=h;this.d5l=r;this.dco=(A,L,ba)=>{if(1===ba)return this.Q1c.h4?32:8;
this.Q1c.PIn();this.d5l().Sdp(this.Q1c.oxm());return 32}}mc(){this.Tb.nb(fb.a.Nyb,ic.a.application,this.dco,1028)}}Object(u.a)(ar,"EditorSettingsUIActor",null,[]);class sk extends Xf.a{constructor(b,h){super(!1,!1,!0);this.f5l=b;this.x_a=h;this.e5l=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.f5l.jCp(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async Sdp(b){const h=await this.x_a.rXb;b={["id"]:"SettingsDialog",["uiLanguage"]:y.AFrameworkApplication.uiCulture,
["selectedLanguage"]:Wg.a.Vg(y.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.Bdd,["editorSettings"]:b};this.ti(Box4Intl.Box4Strings.l_EditorSettings,this.e5l,b);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(u.a)(sk,"EditorSettingsDialog",Xf.a,[]);var Qr=e(244);class nq{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){var Bc;this.xJb=this.qlc=this.kHc=null;this.obf=0;this.k2d=null;this.yZe=!1;this.sa=new Nf.a;this.Fhe=!1;this.pIf=null===
(Bc=y.AFrameworkApplication.J)||void 0===Bc?void 0:Bc.getBooleanFeatureGate("Microsoft.Office.WordOnline.FormatPainterStylesBugFixIsEnabled",!1);this.Gr=b;this.pD=h;this.Pe=r;this.Ww=A;this.qb=L;this.ee=ba;this.sm=ra;this.Qd=Ia;this.me=Ta;this.lr=ob;this.z0=nb;this.Vk=Eb;this.Iq=bc}get N6l(){return this.Qd?this.Qd.isFeatureEnabled(35):!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled")}get rIf(){return null!=this.e0g?this.e0g:this.e0g=Xa.a.instance.resolve("Box4.IFormatPainterStrategy")}get kW(){return this.yZe}set kW(b){this.yZe!==
b&&(this.yZe=this.Fhe=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}C6k(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}Oyj(b){const h=b.Ya;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();y.AFrameworkApplication.ud("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.pIf&&(this.k2d=pb.a.AYa(h.node));var r=h.node;b=this.M4i(b);if(this.rIf.xap(h.contextId,b))try{y.AFrameworkApplication.ud("c8cgd193;5b834819"),
this.xJb=this.qb.ebb(r)}catch(A){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",A.message),A;}this.qlc=this.Vk.Lr(r);r=pb.a.uu(h);r.qp&&(this.kHc=Object(ya.a)(Uz.a,r.qp.clone()));y.AFrameworkApplication.ud("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.pIf&&(this.qlc.getValue(Sb.a.fontColor)||this.k2d.setValue(Sb.a.fontColor,Xl.a.auto));this.obf=b?ic.a.paragraph:h.contextId}gYh(b){if(b){const r=this.M4i(b);for(let A=0;A<b.length;A++){const L=b.K(A);if(null===
L||void 0===L?0:L.nm)this.cNb(L,r);else if(0==(null===L||void 0===L?void 0:L.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",L);else if(L)for(let ba=0;ba<L.length;ba++){var h=L.getContext(ba);if(null===h||void 0===h?0:h.My){if(h)for(let ra=0;ra<h.length;ra++)L.addContext(h.getContext(ra))}else(null===h||void 0===h?0:h.nm)?this.cNb(h,r):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}jYh(b,
h){if(h){var r=b.node,A=r.ra.last,L=this.ee.J$a(r),ba=L.og(L.Rb);this.kYh(L,h,null,null);this.lr.c2b(r,A,b.cpBegin,b.cpEnd,ba,L,this.me.Zg)}}vdl(b,h,r,A){if(h||r)0<kp.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.z0.zY(b,L=>{this.kYh(L,h,r,A)})}kYh(b,h,r,A){this.Pe.ota(b);y.AFrameworkApplication.ud("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.pIf&&this.Yu(b,A);b.qp&&b.qp.removeProperty(Sb.a.highlight);this.Pe.Srf(b);r&&(r=r.clone(),
r.fg(...Up.a.Pca()),this.Yu(b,r.rj()));this.Yu(b,h)}Yu(b,h){if(h){var r=b.paragraph.ed;if(r){var A=b.qp;A=A?Object(ya.a)(Wr.a,A.clone()):Uz.a.DWa(on.a.Yyb);for(const ra of h.Ak())if(ra!==Rc.a.cA&&ra!==Rc.a.G4&&ra!==Sb.a.tG&&ra!==Sb.a.dda&&ra!==Rc.a.Ivb&&ra!==Sb.a.bE&&ra!==Rc.a.r_a&&ra!==Rc.a.noProof){if(ra===Tc.a.wy){var L=h.ka(Tc.a.wy,V.a.nil);if(L!==V.a.nil)if(L=this.Vk.Il().Fna(L,r)){var ba=this.Vk.ML(L);if(ba===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(L=this.Vk.pG(b.paragraph),Wj.a.Zf.zl?
(ba=L.Ev().Ena(ba),L=L.Qg(this.Vk.Je(ba))):L=L.Rua(ba),L){A.aCa(L.rj(),...Up.a.Pca());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}A.setValue(ra,h.Uf(ra))}A.cOa?h=r.mU(A,!0):(r.Mv(A),h=A);b.ol=h.id}}}M4i(b){return!b.xy&&b.hd.contextId!==ic.a.od}reset(){this.xJb=this.qlc=this.k2d=this.kHc=null;this.obf=ic.a.none}cNb(b,
h){if(b.contextId===ic.a.kd||b.contextId===ic.a.Nd)var r=this.sm.cda(b);else if(b.contextId===ic.a.paragraph)r=this.sm.Gie(b);else if(b.contextId===ic.a.od)r=this.sm.nhe(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(ya.a)(wm.AParagraphNode,b.node);var A=
!1;r&&(A=b.contextId===ic.a.Nd&&!!r&&!b.cpBegin&&b.cpEnd===this.qb.textLength(r));if(h=this.rIf.u9o(this.obf,b.contextId,h,A))try{rd.ParagraphReader.lc(r)?(this.qlc&&this.Gr.IP(this.qlc,r,!0),this.Ww.zYh(r,this.xJb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(L){throw v.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",L.message),L;}A=b;b.contextId===ic.a.paragraph?A=vc.a.createTextRange(r,0,
rd.ParagraphReader.textLength(r)):b.contextId===ic.a.kd&&(A=this.pD.WQf(b),A=Fg.a.oPb(A));if(A&&A.contextId===ic.a.Nd){const L=this.Iq.Dae(A);L&&(A=L);try{this.vdl(A,this.kHc,h?null:this.qlc,h?null:this.k2d)}catch(ba){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ba.message),ba;}}if(b.contextId===ic.a.paragraph||b.contextId===ic.a.od)h=new te.a,h.set(r),h.Wd(),h.xd(11),A=nf.a.Wg(h),r=!rd.ParagraphReader.textLength(r),v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",
A,r),A?(r=nf.a.a9(h),nf.a.isListItem(r)&&this.jYh(b,this.kHc)):this.N6l&&this.jYh(b,this.kHc)}}}Object(u.a)(nq,"FormatPainter",null,[1553]);var Es=e(108);class ey{constructor(b,h,r,A,L,ba,ra,Ia=!1,Ta,ob,nb){this.rId=!1;this.bWe=new Dw.a;this.c1m=()=>{this.QX.kW=!1;return 32};this.d1m=(Eb,bc,Bc)=>{Eb=!1;if(bc=this.mC.dha){switch(bc.contextId){case ic.a.Nd:case ic.a.paragraph:case ic.a.od:case ic.a.kd:Eb=!0}Eb&&Ee.a.Rm(bc)&&kp.b(bc)&&(this.Jd.qc(pf.a.Lo,{["Reason"]:uf.a.uZc}),Eb=!1);Eb&&rd.ParagraphReader.uZ(bc)&&
(this.Jd.qc(pf.a.Lo,{["Reason"]:uf.a.NS}),Eb=!1)}if(1===Bc||!Eb)return Eb?32:8;6!==this.ga.JD?(this.QX.kW?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.QX.Oyj(this.mC.currentSelection),this.rId||(this.mi.t8a(this.Ebk),(Bc=this.mi.tb.py)&&Bc.Aj&&Bc.vUh(this.Dbk),this.rId=!0)),this.QX.kW=!this.QX.kW):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),
this.QX.Oyj(this.mC.currentSelection),this.QX.kW=!1);return 32};this.b1m=(Eb,bc,Bc,Yc,zd)=>{var Jd;if(6===this.ga.JD||this.QX.kW||(null===(Jd=y.AFrameworkApplication.J)||void 0===Jd?0:Jd.getBooleanFeatureGate("Microsoft.Office.WordOnline.RepeatFeatureEnabled",!1))){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.JD);bc=this.mi.Kt.rg("UserAction","FormatPainterApply");if(ey.Dc&&ey.Dc.sG(108)){zd=zd?zd.KeepBrushActive:!1;Yc=null;this.mC.currentSelection&&
2===this.mC.currentSelection.trigger&&(zd=zd||this.QX.Fhe,this.QX.Fhe&&Ee.a.qn(this.mC.currentSelection)&&(Yc=Ee.a.M8(this.mC.currentSelection.Ya,!1)))&&(Yc.trigger=2);this.QX.Fhe=!1;if(zd||2!==this.mC.currentSelection.trigger)Bc=new hb.GraphTransaction(15),Yc&&Yc.Ya?(Bc.set(Yc.Ya.node.ml),this.pb.Uc(Yc)):Bc.set(this.mC.CRb.ml),Yc=Tb.SelectionFactory.aq(this.pb.hh),this.QX.gYh(Yc),Bc.Bh=Eb,Bc.dispose();this.QX.kW=zd}else zd=new hb.GraphTransaction(15),zd.set(this.mC.CRb.ml),Bc=Tb.SelectionFactory.aq(this.pb.hh),
this.QX.gYh(Bc),this.QX.kW=!1,zd.Bh=Eb,zd.dispose();bc.stop()}else v.ULS.sendTraceTag(508045209,354,50,"User action where Format Painter is not active via brush or keyboard shortcut. Command location: {0}",this.ga.JD);return 32};this.Ebk=()=>{this.Sre(this.QX.kW)};this.Dbk=()=>{this.Sre(this.QX.kW)};this.mi=b;this.oc=h;this.ga=r;this.Jd=A;this.mC=L;this.QX=ba;this.pb=ra;this.WGk=Ia;this.ez=Ta;this.VF=ob;this.Fyk=nb}get hoh(){return X.a.Fv||!this.myn&&X.a.$ie?"url("+this.LDi()+"), pointer":'url("'+
this.LDi()+'"), pointer'}LDi(){return this.VF?this.ez.bW(Rl.a.kh("FormatPainterText.cur"),Rl.a.kh("FormatPainterTextDarkMode.cur"),new Es.a(Ej.a.YQ())):Rl.a.kh("FormatPainterText.cur")}get myn(){if(null!=this.B4g)var b=this.B4g;else{var h;b=this.B4g=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.SafariUrlBugFixEnabled",!1)}return b}mc(){const b=this.oc.te(Uk.a.LI);b.bindAction(lc.KeyInputManager.xc(pg.a.iib,0),fb.a.qIf);b.bindAction(lc.KeyInputManager.xc(pg.a.JDb,
6),fb.a.L7d);this.WGk||b.bindAction(lc.KeyInputManager.xc(pg.a.NDb,6),fb.a.iab);this.ga.nb(fb.a.L7d,ic.a.view,this.d1m,1028);this.ga.nb(fb.a.iab,ic.a.view,this.b1m,1028);this.ga.nb(fb.a.qIf,ic.a.view,this.c1m,1028);this.QX.C6k(()=>{this.rQg(this.QX.kW)});this.VF&&this.Fyk.TUd(()=>{this.Sre(this.QX.kW)})}rQg(b){const h=this.mi.Kt.rg("UserAction","FormatPainterUpdateCursor");this.Sre(b);this.mi.Ne();h.stop()}Cbk(b,h){for(let r=0;r<b.length;r++)this.Bbk(b[r],h);(b=this.mi.tb.py)&&b.Ee&&this.Bbk(b.hj.editingElement,
h)}Bbk(b,h){b.style.cursor=h?this.hoh:""}Sre(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.hoh;if(this.mi.tb.isEditingAllowed||this.mi.tb.RB){if(b&&!r||!b&&r)this.Cbk(h,b),this.Zbk(b);b||!this.rId||this.bWe.count||(this.mi.BJj(this.Ebk),(b=this.mi.tb.py)&&b.Aj&&b.BIo(this.Dbk),this.rId=!1)}else r&&(this.Cbk(h,!1),this.Zbk(!1))}}Zbk(b){const h=this.mi.tb.py;h&&(b?this.bWe.add(h.Fd.Jl):this.bWe.remove(h.Fd.Jl))}static get Dc(){return null!=
ey.i_g?ey.i_g:ey.i_g=Xa.a.instance.Wa("Box4.IFeatureHelper")}}Object(u.a)(ey,"FormatPainterActor",null,[]);class Im{constructor(b,h,r){this.Qo=r}X8l(b,h,r,A,L){let ba;if(!({ke:r,selected:ba,xB:ob,Nbd:Ta}=this.PYj(h,r,!1)).returnValue)return ob;Yb.a.mark(5013);var ra=Im.zy.IQ(ba);for(var Ia=0;Ia<ra.length;++Ia){if(!ra[Ia].isValid)continue;const nb=ra[Ia].iterator;nb.ku();if(il.a.nA(nb))return this.oqi(r,nb)}var Ta=Ta?fb.a.R$c:this.Rxm();if(ba.My||Ee.a.Rm(ba)||rd.ParagraphReader.Xn(ba)&&!Ee.a.Zca(ba)){if(Im.Dc&&
Im.Dc.isFeatureEnabled(22)&&Object(ak.a)().yHg(ba).returnValue)return 8;var ob=this.pqi(h,r,b,A,L,Ta)}else if(Ee.a.em(ba))ob=this.nqi(h,r,b,A,L,Ta);else if(Ee.a.Df(ba)){ob=new te.a;ob.set(ba.node);ob.Ib(10);ra=Mc.a.VD(ba,!1);if(0<ra.length){if(!ra[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",ra[0].cpBegin,ra[0].cpEnd),8;Ze.a.MRb(ra[0].hyperlink.url);return 32}ih.TableCellReader.b2(ob)&&(Lh.A(ob),ih.TableCellReader.goa(ob)&&(ra=new te.a,ra.Ad(ob),
Lh.B(ra),il.a.RC(ob,ba,!1)&&(Ia=ba,yp.a.v2i(ra)&&0>=Ia.Ob&&(Ta=fb.a.V$c,Lh.C(ob),hg.a.xe(ob),L||(L=new Ai.DictionaryPropertySet),L.Xg(Pd.a.targetObject,ob.currentNode.id)))));Fx.a.QNa&&ba.node.jqb.UNa&&(L||(L=new Ai.DictionaryPropertySet),L.Xg(Pd.a.targetObject,ob.currentNode),Ta=fb.a.W2c);ob=this.rqi(h,r,b,A,L,Ta)}else Ee.a.Zca(ba)&&(ob=y.AFrameworkApplication.va.Sf(h,fb.a.vG,2,!1,A,L));Yb.a.mark(5014);return ob}PYj(b,h,r){let A=null,L=null,ba=!1;if(1===h)return{returnValue:!1,ke:A,selected:L,xB:32,
Nbd:ba};if(!b.view.Ee)return{returnValue:!1,ke:A,selected:L,xB:2,Nbd:ba};A=b.view;L=A.ub.hh;return!L||!Im.Ig.Z1i(L,r)||Im.Ig.koa(L,ra=>ba=ra)&&!ba?{returnValue:!1,ke:A,selected:L,xB:2,Nbd:ba}:this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(L)?{returnValue:!1,ke:A,selected:L,xB:4,Nbd:ba}:{returnValue:!0,ke:A,selected:L,xB:2,Nbd:ba}}j9o(b,h,r,A,L){let ba,ra;if(!({ke:r,selected:ba,xB:ra}=this.PYj(h,r,!0)).returnValue)return ra;const Ia=Im.zy.IQ(ba);for(let Ta=0;Ta<Ia.length;++Ta){if(!Ia[Ta].isValid)continue;
const ob=Ia[Ta].iterator;ob.ku();if(il.a.nA(ob))return this.oqi(r,ob)}ba.My||Ee.a.Rm(ba)?ra=this.pqi(h,r,b,A,L,fb.a.R$c):Ee.a.em(ba)?ra=this.nqi(h,r,b,A,L,fb.a.R$c):Ee.a.Df(ba)?ra=this.rqi(h,r,b,A,L,fb.a.R$c):Ee.a.Zca(ba)&&(ra=y.AFrameworkApplication.va.Sf(h,fb.a.vG,2,!1,A,L));return ra}oqi(b,h){b.ub.Uc(Tb.SelectionFactory.zq(h.currentNode,!1));return 32}pqi(b,h,r,A,L,ba){const ra=new hb.GraphTransaction(15);ra.Bh=r;ra.Eb(h.Fd);h=new Ai.DictionaryPropertySet;h.setValue(Pd.a.s1c,!0);h=y.AFrameworkApplication.va.Sf(b,
fb.a.WJ,2,!0,A,h);32===h&&(h=y.AFrameworkApplication.va.Sf(b,ba,2,!1,A,L));ra.dispose();return h}nqi(b,h,r,A,L,ba){const ra=new hb.GraphTransaction(15);ra.Bh=r;ra.Eb(h.Fd);h.ub.Uc(Ee.a.Xk(h.ub.ob.K(0),!1,!1));b=y.AFrameworkApplication.va.Sf(b,ba,2,!1,A,L);ra.dispose();return b}rqi(b,h,r,A,L,ba){const ra=new hb.GraphTransaction(15,r);ra.Bh=r;ra.Eb(h.Fd);b=y.AFrameworkApplication.va.Sf(b,ba,2,!1,A,L);ra.dispose();return b}static get zy(){return Object(ak.a)()}static get Ig(){return Ke.a.instance}static get Dc(){return null!=
Im.SZg?Im.SZg:Im.SZg=Xa.a.instance.Wa("Box4.IFeatureHelper")}}Object(u.a)(Im,"AEnterViewStrategy",null,[1622]);class Jv extends Im{constructor(b,h,r){super(b,h,r)}Rxm(){return fb.a.vG}}Object(u.a)(Jv,"EnterViewStrategy",Im,[]);class DA{constructor(b){this.Pn=this.transaction=null;this.ke=b;this.GZc=this.qq=0}}Object(u.a)(DA,"SelectAllArguments",null,[]);class Iu{constructor(b,h,r){this.teo=b;this.eGn=h;this.Bq=r;this.K$l=(A,L,ba)=>L.view.Aj?this.Q$a(L,ba,this.s2j):this.dVo(L,ba);this.xld=(A,L)=>L.qq?
1===L.qq?(L.ke.ub.Krd(L.Pn,A),L.qq=2,!0):2===L.qq?(L.ke.ub.ob.W9a=L.Pn.W9a,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableScrollingOnSelectAll",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionAprIsEnabled",!1)&&(L.ke.yAc=!1),this.Dh.eK(),L.transaction.gQa(A),L.qq=3,L.transaction.dispose(),Yb.a.mark(5799),!0):!1:(L.transaction=this.Bq.Vc(2),L.transaction.Eb(L.ke.Fd),L.qq=1,!0);this.dVo=(A,L)=>{if(1===L)return 32;if(!A.view.Ee)return 2;
A=A.view;return A.ub&&A.ub.ob&&A.ub.ob.currentSelection?this.s2j(A).Gha?1:32:8};this.s2j=A=>{A.Aj&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");A=new rt.a(null,this.Opo,new DA(A));A.$m("SelectAllInOutline");A.run();return A};this.Opo=(A,L)=>{if(!L.qq)return L.Pn=Tb.SelectionFactory.eVo(L.ke.ub.ob.currentSelection),L.transaction=this.Bq.Vc(2),L.transaction.Eb(L.ke.Fd),L.qq=1,!0;if(1===L.qq){if(!L.GZc)return L.ke.ub.Uc(L.Pn.K(0),A),++L.GZc,!0;if(L.GZc<L.Pn.length)return L.ke.ub.K4k(L.Pn.K(L.GZc),
A),++L.GZc,!0;L.qq=2}return 2===L.qq?(L.ke.ub.ob.W9a=L.Pn.W9a,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableScrollingOnSelectAll",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionAprIsEnabled",!1)&&(L.ke.yAc=!1),this.Dh.eK(),L.transaction.gQa(A),L.qq=3,L.transaction.dispose(),!0):!1}}get Dh(){return this.eGn.value}mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.sGa,dd.a.frame,Iu.MZj);b.qa(fb.a.eFg,dd.a.frame,Iu.MZj);
b.nb(fb.a.Q$a,ic.a.view,this.K$l,2);b.nb(fb.a.w8a,ic.a.view,Df.AFrame.nh,100);b.nb(fb.a.scg,ic.a.view,Iu.scg,4)}Q$a(b,h,r){if(1===h)return 32;if(!b.view.Ee)return 2;h=b.view;if(!h.ub)return 8;const A=h.ub.ob;if(!A||!A.length)return 8;Yb.a.mark(5798);Db.StaticActiveAppFrame.Aa().tb.isEditingAllowed||Db.StaticActiveAppFrame.Aa().tb.RB||h.Aj?b=Ee.a.fPf(A):(Jc.FocusManager.instance().scopeChanged(Df.AFrame.Co),b=Tb.SelectionFactory.kQj(h.Fd));if(!b)return 8;A.W9a||v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");
r&&this.teo.eWb(Ee.a.IBi(b))?r=r(h):(r=new DA(h),r.Pn=b,r=new rt.a(null,this.xld,r),r.$m("ExpandSelection"),r.run());return r.Gha?1:32}static get jgb(){return null!=Iu.B8g?Iu.B8g:Iu.B8g=Xa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static scg(b,h,r){if(1===r)return 32;if(!h.view.Ee)return 8;b=h.view;h=Tb.SelectionFactory.zq(b.root.graphNode,!0);if(!h)return 8;b.ub.Uc(h);return 32}static MZj(){var b=Db.StaticActiveAppFrame.Aa().tb.py;if(!b.Ee)return 2;if(b.Ee&&1!==Db.StaticActiveAppFrame.Aa().state){Yb.a.mark(4668);
var h=b.ub.ob.currentSelection;if(!h&&y.AFrameworkApplication.J.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Ee.a.hta(h);let r=h.x,A=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,A=b.y;Iu.jgb.sGa(new Sys.UI.Point(r,A),1);Yb.a.mark(4669)}return 32}}Object(u.a)(Iu,"SelectAllHandlers",null,[1596]);class fE{UAe(){}}Object(u.a)(fE,"FontNameFormattingStrategyNoop",null,[1605]);var fy=e(1057);class ht{constructor(b,
h,r,A,L,ba){this.w0h=this.z0h=null;this.Ju=b;this.v0h=h;this.ikl=r;this.rkl=A;this.z0h=L;this.w0h=ba}}Object(u.a)(ht,"BookmarkHighlightContext",null,[]);class du extends aq.a{constructor(){super()}get Fha(){return!0}get Cub(){return 5}get Kbb(){if(null!=this.w7)return this.w7;this.w7=[];this.w7.push(new ho.a(Eo.a.aXd,Eo.a.aXd));this.w7.push(new ho.a(Eo.a.Vnf,Eo.a.Vnf));this.w7.push(new ho.a(Eo.a.UWc,Eo.a.UWc));return this.w7}$Oa(b,h){this.Fha&&mp.a.instance.Ae(()=>{const r=this.Yt.pLa;var A=this.Yt.ced;
if(r)if(5===r.type){A=r.ZD;if(r.XN&&r.XN.Ju.includes(b))for(const L of h.DPa("*"))this.Yt.t1a(L);A&&A.Ju.includes(b)&&this.TAb(h,r.action,A,b)}else A&&5===A.type&&3===r.action&&A.ZD.Ju.includes(b)&&this.TAb(h,0,A.ZD,b)},"BHA:OPHC")}g_a(b){return Object(Pb.a)(ht,b)}fbb(b,h){if(b)for(const r of b.Ju)h.add(r)}TAb(b,h,r,A){0===h&&b.htmlElement&&mp.a.instance.Ae(()=>{const L=b.DPa("*"),ba=L.length,ra=Eo.a.aXd;var Ia=A.id===r.z0h,Ta=A.id===r.w0h;let ob=!1;var nb=0,Eb=[];const bc=Array(ba);for(let zd=0;zd<
ba;zd++){var Bc=L[zd];const Jd=io.a(Bc);bc[zd]=Jd;const ie=Bc.classList;if(0!=bc[zd]){const re=!ie.contains(Eo.a.ZJ),me=bm.a.Mb(Bc,Eo.a.xNb);me&&Eb.push(...me);if(Ia){let Sd;if((Sd=bm.a.Mb(Bc,Eo.a.cXd))&&me&&1===Sd.length&&1===me.length&&Sd[0].equals(me[0]))continue;Sd&&(nb+=Sd.length,1===Jd?ie.add(Eo.a.Vnf):ie.add(ra));if(me)for(const cf of me)this.Cge(r,cf)&&(nb--,ob&&ie.add(Eo.a.UWc));0!==nb&&re&&ie.add(ra)}if(!Ia&&!Ta&&r.rkl.has(A.id))if((Bc=bm.a.Mb(Bc,Eo.a.xNb))&&ob){ie.add(ra);for(const Sd of Bc)if(this.Cge(r,
Sd)){ie.add(Eo.a.UWc);break}}else re&&ie.add(ra)}ob=!ie.contains(Eo.a.C$a)}if(Ta&&!Ia){Ia=new Set;for(var Yc of Eb)this.Cge(r,Yc)&&Ia.add(Yc);ob=!1;for(Eb=0;0!==Ia.size&&Eb<ba;Eb++){nb=L[Eb];Yc=nb.classList;if(0!=bc[Eb])if(Ta=!1,nb=bm.a.Mb(nb,Eo.a.xNb)){for(const zd of nb)this.Cge(r,zd)&&(Ia.delete(zd),Ta=!0);0!==Ia.size&&Yc.add(ra);ob&&Ta&&Yc.add(Eo.a.UWc)}else Yc.contains(Eo.a.ZJ)||Yc.add(ra);ob=!Yc.contains(Eo.a.C$a)}}},"BHA:SPH")}Cge(b,h){for(const r of b.ikl)if(h.equals(r))return!0;return!1}}
Object(u.a)(du,"BookmarkHighlightActor",aq.a,[307]);var gy=e(1902),As;(function(b){b[b.Idq=0]="jsonToDocumentXml";b[b.a3l=1]="documentXmlToJson";b[b.b3l=2]="documentXmlToThemeJson";b[b.fzq=3]="unsupported"})(As||(As={}));Object(u.b)("GraphicsEditorConversionRequestType",As);var av=e(1634);class Ju{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.$f=b;this.nI=h;this.qb=L;this.E_=ba;this.ll=ra;this.qe=Ia;this.Qd=ob;this.za=Ta}qBg(b,h,r,A){const L=b.lRh(h);if(L){var ba=Object(Pb.a)(av.a,b),ra=this.qe.rg("WebServiceCall",
String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ba,r)),Ia=h.Pk.node,Ta=()=>{r||this.IGo(h.Pk,L.getId())};ba=Ju.I1h();A=this.f2h(L.getId().toString(),Ia,A,r);try{b.tXh(A,h)}catch(ob){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+ob.message);this.Pq(WacWordeditorStrings.GraphicsEditorDefaultError);return}this.$f.addRequest(ba,2,A.toString(),{},!0,0,
ob=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.Avc(ob,L,()=>{this.Pq(b.$ae())},Ta,Ia,h,ra)},ob=>{const nb=415===ob.data.Xe;let Eb="";ob&&ob.data&&ob.data.Pi&&"X-CorrelationId"in ob.data.Pi&&ob.data.Pi["X-CorrelationId"]&&(Eb=ob.data.Pi["X-CorrelationId"]);b.rR(`Graphics editor request failed. HttpStatus [${ob.data.Xe}], CorrelationId [${Eb}]`,L,Ia,Ta,()=>{this.Pq(nb?WacWordeditorStrings.GraphicsEditorUnsupportedContentError:
b.$ae())},ra,nb)},null)}else this.Pq(b.$ae())}PWo(b,h,r){return new Promise((A,L)=>{var ba=b.Pk,ra=null;ra=Yi.a.Q2f(ba)?ba.getContext(0).node:ba.node;ba=Ju.I1h();ra=this.f2h(h.toString(),ra,r,!1);ra.Me(gy.a.$uf,As.b3l.toString());this.$f.addRequest(ba,2,ra.toString(),{},!0,0,Ia=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");A(Ia.data.responseData)},Ia=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ia.data.Xe}`);
this.Pq(WacWordeditorStrings.GraphicsEditorDefaultError);L(null)},null)})}f2h(b,h,r,A){const L=h.hk(),ba=new Ua.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.Qla(ba);ba.Me(gy.a.EEe,this.Gsn(h)?"true":"false");ba.Me(Wi.a.nodeId,b);ba.Me(Wi.a.cellId,L.Wl.toString());ba.Me(Wi.a.fileId,L.Kr);ba.Me(Wi.a.g1,r.toString());ba.Me(gy.a.s$l,A?"true":"false");if(b=!!this.Qd&&this.Qd.isFeatureEnabled(43)){ba.Me(ri.a.Wyj,b.toString());if(b=this.Qd.isFeatureEnabled(83))ba.Me(ri.a.ejo,
b.toString()),ba.Me(ri.a.w$m,"true");this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ba.Me(ri.a.njo,"true")}ba.Me(ri.a.L_h,"true");Sk.a.instance.NMb(ba);return ba}Gsn(b){if(!this.nI)return!1;b=this.nI.kw(b);return!!b&&b.Uf(Rc.a.F4f)}IGo(b,h){b.cpBegin===b.cpEnd-1&&this.ll.Wxc(b.node,h,this.qb,this.E_)}Pq(b){const h=new wg.StandardDialog;h.Md=0;h.zA(Of.a.bCf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WacWordeditorStrings.GraphicsEditorUnsupportedContentError);
Db.StaticActiveAppFrame.Aa().Ne()}static I1h(){const b=new Ua.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.Qla(b);return b.toString()}}Object(u.a)(Ju,"GraphicsEditorRequestManager",null,[306]);class gE extends OD{constructor(b,h,r){super(b,h,r);this.hZa=fb.a.PT}dcb(b){null!=b&&0<b.length&&this.Tb.Zb(this.hZa,2,b[0])}Kjk(b,h,r,A){const L=Wg.a.Vg(y.AFrameworkApplication.lcid).name;b=String.format(b,y.AFrameworkApplication.lcid,L,y.AFrameworkApplication.buildVersion,h,
oA.rMe,r);b+="&flipgrid=1&ted=1";y.AFrameworkApplication.ud("h1b04136;di786241");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineMediaAccessibilityChangesEnabled",!1)&&(b+="&resize_picker=1");A&&(A=new Ua.QueryStringBuilder(b),A.SM("stream2","1"),A.SM("enablegetcustomheader","1"),b=A.toString());return b}}Object(u.a)(gE,"InsertHubbleMediaHelper",OD,[]);class Bq{constructor(b,h,r,A,L,ba,ra,Ia,Ta){this.LId=!1;this.ga=b;this.za=h;this.$Gd=r;this.B7=A;this.mEd=L;this.sm=
ba;this.xuk=Ia;this.Ftk=ra;this.hm=Ta;ra.isFeatureEnabled("OmgStreamTwo",!1).then(ob=>{this.LId=ob;this.LId||(this.QLh=ra.dxa("OmgStreamTwo",nb=>{this.LId=nb.isEnabled}))})}dispose(){this.QLh&&this.Ftk.O0b("OmgStreamTwo",this.QLh)}mc(){const b=this.Bco.bind(this);this.ga.nb(Lc.a.Llg,ic.a.kd,b,1028);const h=this.Fhn.bind(this);this.ga.nb(Lc.a.mZf,ic.a.kd,h,1028);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)&&(this.Y5(Lc.a.Llg,
b),this.Y5(Lc.a.mZf,h))}Y5(b,h){this.ga.Y5("word_insertOnlineVideos",!0,b,ic.a.kd,h,r=>{Db.StaticActiveAppFrame.Aa()&&this.hm&&Db.StaticActiveAppFrame.Aa().W4b(r,this.hm.etb)})}Fhn(b,h,r,A,L){if(1!==r){if(null==L)return 16;if(!h.nm||!Ee.a.Df(h))return 2;b=this.Bxm(L);L=L.OriginalUrl;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.mEd.vUg(b,h,L)}return 32}eqk(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("OnlineVideoFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}Bxm(b){const h=new JD;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}Bco(b,h,r){var A,L;if(1!==r)h=D.a.DV(this.za.rb("UserId")).toString(),h=this.B7.Kjk(this.za.appSettings.InsertVideoHubbleEndpoint,qb.a.create().toString(),
h,this.LId),this.B7.hZa=Lc.a.mZf,h=this.$Gd.t6c(h,!0),h.correlationId=qb.a.create(),h.mwa=5,h.dDe(null,this.B7,this.xuk),ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ma.a,{name:"ActionId",int64:b})]})),this.eqk();else if(!(h&&h.node&&xv.a(h.node))||(null===(A=this.sm)||void 0===A?0:A.t4(h))||(null===(L=this.sm)||void 0===L?0:L.koa(h)))return 2;return 32}}Object(u.a)(Bq,"OnlineMediaActor",null,[]);const qG={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net",
"https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class hs extends VB{constructor(b,h,r,A=null,L=!1){super(b,h,r,A,L);this.jLc=null;this.Tig=()=>{this.sB&&(v.ULS.sendTraceTag(509092503,
352,50,`onGetCustomHeaders : Token available: ${!!hs.HJa} time: ${(new Date).getTime()-this.Ci}`),this.sB.sendMessage(J.a.kTj,{["CustomHeaders"]:hs.HJa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}W4c(){const b={};b.insertMediaServiceEndpoint=this.aHd;b.iFrameId="mediaiframe";return b}async dDe(b,h,r){r&&(this.Ci=(new Date).getTime(),Date.now()>hs.DNh&&await this.refreshToken(r));this.D8b=b;this.jLc=h;this.aKc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.W4c(),
["componentIsVisibleCallback"]:this.Wnk.bind(this)};this.ti(this.D8b,null,b)}Wnk(){this.y5=this.gmc(this.Vj("mediaiframe"));let b=this.aHd;if(y.AFrameworkApplication.J.$("NewInsertMediaServiceEndpoint")){var h=new URL(b);(h=qG[h.protocol+"//"+h.host])?b=h:v.ULS.sendTraceTag(508937025,352,10,"Target URL not found")}this.sB=this.WMd.getInstance(this.y5.contentWindow,b);this.sB.Ht(J.a.addItem,r=>{this.poj(r,this.jLc.dcb.bind(this.jLc))});this.sB.Ht(J.a.insert,r=>{this.sqe(r,this.jLc.dcb.bind(this.jLc))});
this.sB.Ht(J.a.jTh,this.Urj.bind(this));this.sB.Ht(J.a.KBi,this.Tig.bind(this));this.sB.Ht(J.a.getSessionId,this.Aqj.bind(this));this.sB.Ht(J.a.vzi,this.zqj.bind(this));this.sB.Ht(J.a.aYd,this.cpj.bind(this));this.AAb(3)}AAb(b){const h=[];h.push(Object.assign(new ma.a,{name:"DialogResult",string:UB[b]}));h.push(Object.assign(new ma.a,{name:"DialogMode",string:this.cHi()}));h.push(Object.assign(new ma.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ma.a,{name:"Provider",
string:Vx[this.mwa]||"Unknown"}));ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.kX("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(hs.DNh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,hs.HJa=h.Token);v.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!hs.HJa} time: ${(new Date).getTime()-this.Ci}`)}catch(h){v.ULS.sendTraceTag(508954306,
352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.Ci} error: ${h} `)}}}hs.DNh=0;Object(u.a)(hs,"OnlineMediaDialog",VB,[]);class eu{constructor(b,h){this.eZe=b;this.B7=h}t6c(b,h=!1){return new hs(b,this.eZe,this.B7,null,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(eu,"OnlineMediaDialogFactory",null,[305]);class EA extends us{constructor(){super(1,3);this.eQ=Xa.a.instance.resolve("Common.IReactContextualUILauncher");this.L5j=
!1}Ogb(){y.AFrameworkApplication.va.Vb(Lc.a.LAc,2)}V4d(){this.Kui&&!this.iy&&(this.iy=this.bTa())}F5d(){if(this.iy&&this.iy.isVisible){var b=Object(ya.a)(tn.a,this.iy.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.fA(b.ltb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<
window.innerHeight&&(h=b.getAttribute(le.a.mWd)||"",le.a.VM===h&&b.click())}}k5(){return this.eQ.k5}}Object(u.a)(EA,"ExternalContentFloatieManager",us,[]);class Cf{constructor(){Cf.zen()}get kc(){return null!=this.ybh?this.ybh:this.ybh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get hx(){return null}F4b(b){var h=null;if(!rd.ParagraphReader.Wh(b))return{returnValue:!1,Fga:h};if((b=this.kc.Lr(b.currentNode))&&2===this.kc.wH(b)){const r=this.kc.Je(b);Cf.sV.contains(r)&&
(h=this.kc.ML(b),h=Object.assign(new DC.a,{NH:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Fga:h}}htb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static zen(){Cf.sV=new ki.a;Cf.sV.add(Hg.a.styleIdHeading1);Cf.sV.add(Hg.a.styleIdHeading2);Cf.sV.add(Hg.a.styleIdHeading3);Cf.sV.add(Hg.a.D3b);Cf.sV.add(Hg.a.Ttd);Cf.sV.add(Hg.a.Utd);Cf.sV.add(Hg.a.IEe);Cf.sV.add(Hg.a.HEe);Cf.sV.add(Hg.a.wordStyleIdHeading1);Cf.sV.add(Hg.a.wordStyleIdHeading2);Cf.sV.add(Hg.a.wordStyleIdHeading3);
Cf.sV.add(Hg.a.xEc);Cf.sV.add(Hg.a.yEc);Cf.sV.add(Hg.a.zEc);Cf.sV.add(Hg.a.Pxd);Cf.sV.add(Hg.a.Qxd);Cf.sV.add(Hg.a.Rxd);Cf.sV.add(Hg.a.wDb);Cf.sV.add(Hg.a.Sxd)}}Cf.sV=null;Object(u.a)(Cf,"ParagraphStyleDetailsProvider",null,[729,377]);class rn{constructor(b,h,r,A){this.gTa=b;this.tJk=h;this.CJk=r;this.DJk=A}tug(){this.gTa.execute(b=>{b.E0b(this.tJk.value);b.E0b(new Cf);b.E0b(this.DJk.value);b.SW(this.CJk.value)})}}Object(u.a)(rn,"AccessibilityActor",null,[]);class hE{constructor(b,h,r){this.Xi=null;
this.Hsd=(A,L,ba)=>{if(1===ba)return 32;this.Xi=this.$Ic.value.qJl(this.oc);if(!this.Xi)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.Xi.v2a();return 32};this.OQh=A=>this.Xi?this.Xi.Q2m(A):2;this.ga=b;this.$Ic=h;this.oc=r}mc(){if(y.AFrameworkApplication.J.$("UIDiscoverabilityEnabled")){var b=lc.KeyInputManager.xc(pg.a.IDb,5);this.oc.te(Df.AFrame.Co).Pu(b);this.oc.te(Df.AFrame.rr).bindAction(b,wb.a.Hsd);this.ga.qa(wb.a.Hsd,dd.a.frame,this.Hsd);this.ga.qa(wb.a.NUc,
dd.a.frame,this.OQh);this.ga.qa(wb.a.MUc,dd.a.frame,this.OQh)}}}Object(u.a)(hE,"AccessibilityHelpDialogActor",null,[]);var hy=e(1056),ax=e(1285);class FA{constructor(b,h){this.cEk=b.sc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.rsk=hy.a.OI(26,5,new ax.a)}WZ(){this.ga.WZ(this)}H5(){}F5(b){const h=+b.endTime-+b.startTime;if(h>this.cEk){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=qf.ActionManager.yba(b.actionId))&&b.length||(b="UnknownAction");this.rsk.track(h,
b+"_"+r)}}}Object(u.a)(FA,"ActionHangDetector",null,[113]);var iy=e(2158);class iE extends Hd{constructor(b,h=null){super(b,void 0,y.AFrameworkApplication.k$a,new bd(b,!1),void 0,void 0,h)}get Tdb(){return this.lhe?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get gtc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Jed(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get S_c(){return y.AFrameworkApplication.k$a?
"UIFontDialogTextLarge":null}get lhe(){return"VersionHistory"===this.eqf?!1:!y.AFrameworkApplication.ta.Pb.isBusinessUser&&!y.AFrameworkApplication.ta.Pb.isEduUser}Ile(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}K9f(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}ifd(){v.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");y.AFrameworkApplication.va.Vb(wb.a.ani,2)}}Object(u.a)(iE,"DownloadACopyDialog",Hd,[]);var GA;(function(b){b[b.Unknown=
0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.rXp=7]="Publisher";b[b.SVp=8]="Infopath";b[b.eTp=9]="Access"})(GA||(GA={}));Object(u.b)("OfficeApplication",GA);var Sh;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.zrk=2]="WriteOnly";b[b.tVp=3]="ForceCheckout";b[b.DZp=4]="WriteLocalCopy";b[b.Ynk=5]="OpenInBrowser"})(Sh||(Sh={}));Object(u.b)("OpenDocumentMode",Sh);
class jE extends Xf.a{constructor(){super(!1,!1,!0)}$re(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};
h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.ti("Send feedback to Microsoft",this.F3o.bind(this),b);return new Promise(r=>{this.CMk=r})}F3o(b,h){1===b&&this.Jja(h.selectedReason)}dispose(){super.dispose();this.CMk()}Jja(b){const h={},r={},A={},L={},ba={};h.appId=2155;h.manifestType="Fps";
h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=qb.a.create().toString();ba.reason=b;const ra={},Ia={numberOfOptions:5};Ia.selectedRating=b;ra.rating=[Ia];L.surveySpecificData=JSON.stringify(ra);A.extendedManifestData=JSON.stringify(L);h.application=A;ba.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ba;h.telemetry=this.UNb();h.web=this.iXc();r["Content-Type"]="application/json";this.FPa(JSON.stringify(h),r)}fga(b,h,r,A){h&&b&&A&&r&&A in h&&(b[r]=
h[A])}UNb(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=y.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.fga(h,b,"audienceGroup","AudienceGroup");this.fga(h,b,"osBuild","OsVersion");this.fga(h,b,"platform","Platform");this.fga(h,b,"processSessionId","WACSessionID");return h}iXc(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};this.fga(h,b,"browser","Browser");this.fga(h,b,"browserVersion","BrowserVersion");this.fga(h,b,"dataCenter",
"WACDatacenter");return h}FPa(b,h,r=0){let A=0;3<r||(1===r?A=200:1<r&&(A=200+500*(r-1)),y.AFrameworkApplication.zc.pc(new Md.a(2,1,A,()=>{y.AFrameworkApplication.pe.addRequest("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.FPa(b,h,r+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(u.a)(jE,"WordOpenInClientFeedbackDialog",
Xf.a,[]);var xw=e(1342),Hj=e(2153);const rz=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},lC=b=>b.Yb.keyCode===pg.a.vw||b.Yb.keyCode===pg.a.B3a?(b.Ff.click(),!0):!1,jy=(b,h,r,A,L,ba,ra)=>{const Ia=document.createElement("a");Ia.className="ProtocolLaunchingDialogButtonAnchor";Ia.className+=" OICDialog";Ia.id=b;Ia.setAttribute(le.a.fi,le.a.i4);Ia.style.padding="0";Ia.style.margin="0";A&&kE(L,
h,r,A,Ia);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=L;Ia.appendChild(b);Ia.tabIndex=0;ba&&Wf.a.instance.Cb(Fd.a.click,Ia,ba);ra&&lc.KeyInputManager.instance.Cb(Fd.a.zi,Ia,ra);return Ia},kE=(b,h,r,A,L)=>{var ba=document.createElement("img");ba.alt=b;ba.className=Ye.getImageClassWithCluster(r,A);ba.src=h;ba.setAttribute(le.a.fi,le.a.NA);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ba);ba=document.createElement("span");
ba.className="ProtocolLaunchingDialogIconContainer";ba.appendChild(b);L.appendChild(ba)};class sz{static get Fh(){return Xf.a.iA(sz.pp,CommonUIStrings.l_OICLaunchDialogTitle)}}sz.pp="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(sz,"OICLaunchDialogHtml",null,[]);class gJ extends Xf.a{constructor(b){super();this.b7b=this.xEb=null;this.MX=!1;this.htj=()=>{this.hide();this.Gp.vyc();return!0};this.ntj=()=>{v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();y.AFrameworkApplication.va.Vb(wb.a.k1b,2);return!0};this.G0n=()=>{this.Gp.vyc()};this.Gp=b;this.Fh=sz.Fh;this.Md=5;this.$g="OICLaunchDialog";this.showDialog("",this.G0n);this.mUj();this.u$("ProtocolLaunchingDialogTitle");4!==y.AFrameworkApplication.ta.Pb.hXa&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.e6(this.xEb);v.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Cda(){this.xEb=jy("BtnRichClient",this.Gp.sjc,this.Gp.Toc,this.Gp.zXf,CommonUIStrings.l_OICLaunchRichClient,this.ntj,lC);document.getElementById("OICLaunchRichClient").appendChild(this.xEb);rz(this.xEb);this.b7b=jy("BtnReturn",this.Gp.sjc,
this.Gp.Toc,this.Gp.tVi,CommonUIStrings.l_OICReturnToOnlineClient,this.htj,lC);document.getElementById("OICReturnToApp").appendChild(this.b7b);rz(this.b7b)}dispose(){this.MX||(this.xEb&&(Wf.a.instance.Gc(Fd.a.click,this.xEb,this.ntj),lc.KeyInputManager.instance.Gc(Fd.a.zi,this.xEb,lC)),this.b7b&&(Wf.a.instance.Gc(Fd.a.click,this.b7b,this.htj),lc.KeyInputManager.instance.Gc(Fd.a.zi,this.b7b,lC)),super.dispose(),this.MX=!0)}}Object(u.a)(gJ,"OICLaunchDialog",Xf.a,[]);class HA{static get Fh(){return 0!==
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)?Xf.a.iA(HA.BZl,CommonUIStrings.l_OICDialogTitle):Xf.a.iA(HA.pp,CommonUIStrings.l_OICDialogTitle)}}HA.pp="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
HA.BZl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'></div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonDownloadClientApp'> <div id='ProtocolHandlerDialogDownloadClientApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(HA,"ProtocolLaunchingDialogV2Html",null,[]);class hJ extends Xf.a{constructor(b){super();this.$6b=this.a7b=this.b4a=null;this.MX=!1;this.ijb=null;this.iqj=h=>this.upe(h,0);this.Ypj=h=>this.upe(h,3);this.Cqj=h=>this.upe(h,2);this.gtj=h=>this.upe(h,1);this.eqj=()=>{this.hide();4===y.AFrameworkApplication.ta.Pb.hXa?(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Gp.vyc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Gp.t8c());
return!0};this.Xpj=()=>{v.ULS.sendTraceTag(0,211,50,"Open download client app page");return!0};this.dqe=()=>{v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0};this.fre=()=>{v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";y.AFrameworkApplication.va.Vb(wb.a.k1b,2);return!0};this.qrg=()=>{this.Gp.vyc()};this.Gp=b;this.Fh=HA.Fh;this.Md=5;this.$g="ProtocolLaunchingDialog";this.BIc="OICRetryDialog";y.AFrameworkApplication.zc.uub&&
y.AFrameworkApplication.zc.restart();y.AFrameworkApplication.zc.pc(new Md.a(2,1,5E3,()=>{this.dop()},101));this.showDialog("",this.qrg);this.mUj();this.u$("Issues");this.bvi();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Cda(){const b=document.getElementById("Issues");if(b){kE("",this.Gp.sjc,this.Gp.Toc,this.Gp.zXf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Gp.hvj?
CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);rz(b);b.style.display="none"}0!==y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)&&(this.$6b=jy("DownloadClientApp",this.Gp.sjc,this.Gp.Toc,"",CommonUIStrings.l_OICDialogSectionDownloadClientApp,this.Xpj,this.Ypj),document.getElementById("ProtocolHandlerDialogDownloadClientApp").appendChild(this.$6b),rz(this.$6b));y.AFrameworkApplication.ta.Pb.VPi?(this.a7b=
jy("GiveFeedback",this.Gp.sjc,this.Gp.Toc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.dqe,this.Cqj),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.a7b),rz(this.a7b)):document.getElementById("ButtonGiveFeedback").style.display="none";0===y.AFrameworkApplication.ta.Pb.hXa||y.AFrameworkApplication.A_l?document.getElementById("ButtonEdit").style.display="none":(this.b4a=jy("Edit",this.Gp.sjc,this.Gp.Toc,"",2===y.AFrameworkApplication.ta.Pb.gl?4===y.AFrameworkApplication.ta.Pb.hXa?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===y.AFrameworkApplication.ta.Pb.hXa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.eqj,this.iqj),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.b4a),rz(this.b4a));0===y.AFrameworkApplication.ta.Pb.hXa&&!y.AFrameworkApplication.d3f&&b&&(b.style.display="none")}cvi(){return this.ijb?(this.e6(this.ijb),!0):!1}bvi(){return this.b4a?(this.e6(this.b4a),!0):!1}upe(b,
h){let r=!1;if(b.Yb.keyCode===pg.a.vw||b.Yb.keyCode===pg.a.B3a)b.Ff.click(),r=!0;else if(b.Yb.keyCode===Sys.UI.Key.down||b.Yb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.bvi();break;case 0:r=this.cvi()}return r}wjg(){oc.Redirect.showHelp("OICFailure");return!0}dop(){var b=document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!b.children.length&&(this.ijb=jy("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.fre,this.gtj),b.appendChild(this.ijb),rz(this.ijb),this.b4a||this.cvi())}}dispose(){this.MX||(this.b4a&&(Wf.a.instance.Gc(Fd.a.click,this.b4a,this.eqj),lc.KeyInputManager.instance.Gc(Fd.a.zi,this.b4a,this.iqj)),this.$6b&&(Wf.a.instance.Gc(Fd.a.click,this.$6b,this.Xpj),lc.KeyInputManager.instance.Gc(Fd.a.zi,this.$6b,this.Ypj)),this.a7b&&(Wf.a.instance.Gc(Fd.a.click,this.a7b,this.dqe),lc.KeyInputManager.instance.Gc(Fd.a.zi,
this.a7b,this.Cqj)),this.ijb&&(Wf.a.instance.Gc(Fd.a.click,this.ijb,this.fre),lc.KeyInputManager.instance.Gc(Fd.a.zi,this.ijb,this.gtj)),super.dispose(),this.MX=!0)}}Object(u.a)(hJ,"ProtocolLaunchingDialog",Xf.a,[]);class ky extends wg.StandardDialog{constructor(b){super();this.dqe=h=>{v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.oqj(h)};this.fre=()=>{v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");y.AFrameworkApplication.va.Vb(wb.a.k1b,2)};this.qrg=h=>{ky.jSi?3===
h?this.eNj():2===h||0===h?this.Bbi():1===h&&this.phc():2===h?this.eNj():(1===h||0===h)&&this.Bbi()};this.Gp=b;this.$g="ProtocolLaunchingDialog";y.AFrameworkApplication.zc.uub&&y.AFrameworkApplication.zc.restart();y.AFrameworkApplication.ta.Pb.VPi&&this.N1k(this.dqe);ky.jSi?(this.Md=12,this.Ue(1,CommonUIStrings.l_CloseFile),this.Ue(2,CommonUIStrings.l_OICDialogContinueHere),this.Ue(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Md=4,this.Ue(1,CommonUIStrings.l_OICDialogContinueHere),this.Ue(2,CommonUIStrings.l_OICDialogLaunchAgain));
this.Gxb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Gp.hvj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.qrg,null)}phc(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");y.AFrameworkApplication.va.Zb(wb.a.close,2,we.a)}eNj(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.fre,0)}Bbi(){4===y.AFrameworkApplication.ta.Pb.hXa||y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&
1===y.AFrameworkApplication.ta.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Gp.vyc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Gp.t8c())}static get jSi(){return y.AFrameworkApplication.J.$("OICDialogThreeActions")&&32===y.AFrameworkApplication.va.Vb(wb.a.close,1)}}Object(u.a)(ky,"StandardProtocolLaunchingDialog",wg.StandardDialog,[]);class iJ{}Object(u.a)(iJ,"EditDocumentInClientParams",null,[]);class rG{static Dni(b,h,r,
A,L,ba,ra=!1,Ia=!1,Ta="",ob=!1,nb=!1,Eb=!1,bc="",Bc="",Yc="",zd=""){const Jd=new iJ;Jd.DocumentUrl=b;Jd.DocumentExtension=zd;Jd.Mode=h;Jd.Options=r;Jd.Application=A;Jd.SilentExternalHandler=ra;Jd.EncodeUrl=Ia;Jd.CorrelationIdForWinClient=Ta;Jd.NavigateUsingWindowOpen=ob;Jd.DescriptiveUnattemptedEnums=nb;Jd.NoBrowserModalDialogs=Eb;Jd.SessionOrigin=bc;Jd.CorrelationId=Bc;Jd.ClickTime=Yc;MSOJS.ClientUtils.EditDocumentInClient(Jd,L,ba)}}Object(u.a)(rG,"ClientUtils",null,[]);var nM=e(564),jJ=e(971);class bx{constructor(b){this.H6a=
this.wJc=this.wHc=null;this.DKc=!1;this.BTe=this.g3e=this.ZBh=null;this.dBd=this._correlationId=this.yPd="";this.application=this.RE=0;this.Mnp=this.eKg=!1;this.VPo=(h,r,A)=>r.contextId!==dd.a.frame?2:1===A?32:this.k1b();this.aoj=()=>{this.zsf()};this.boj=()=>{this.vyc()};this.grj=()=>{this.waj()};this.c$m=()=>this.Zki(!0);this.nKp=b&&y.AFrameworkApplication.J.$("OICLaunchDialogIsEnabled");y.AFrameworkApplication.va.s1(wb.a.k1b)||y.AFrameworkApplication.va.qa(wb.a.k1b,dd.a.frame,this.VPo);this.p0j=
!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("SilentExternalHandler")}get hvj(){return this.RE}y6o(b,h="",r=""){this._correlationId=r||qb.a.create().toString();this.yPd=h||nM.a.YHi();this.dBd=b}get options(){let b=0;y.AFrameworkApplication.iNo&&(b|=1);y.AFrameworkApplication.pvj&&(b|=4);this.Gnp()&&(b|=64);return b}Gnp(){return!(2===this.application&&y.AFrameworkApplication.J.$("IsEmbeddedScenario"))}get sjc(){return y.AFrameworkApplication.mr}get Toc(){return y.AFrameworkApplication.Q1}get tVi(){return""}get zXf(){return""}get Lnp(){return y.AFrameworkApplication.J.$("OneNoteMobileViewerIsEnabled")}get Jrp(){return this.ZBh||
(this.ZBh=Xa.a.instance.resolve("Common.IOfficeTrialExperience"))}zsf(){this.eKg||this.O9l()}vyc(){this.Mnp||this.qri()}NEj(b){return this.nKp&&X.a.Yi?(new gJ(this),32):this.z$h(b)}z$h(b){const h=({zCb:b}=this.fFn(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Mc(b,h,r,A,L,ba,ra=""){this.wHc=b;this.BTe=ra;this.wJc=h;this.H6a=ba;this.application=r;this.RE=A;return y.AFrameworkApplication.hni?(this.waj(),32):y.AFrameworkApplication.awa&&!y.AFrameworkApplication.dUi?
(y.AFrameworkApplication.mHg(),8):this.T_h(L)}get F0n(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}k1b(){this.F0n&&this.bKn();return this.z$h(this.DKc)}yRj(){const b=new jJ.a(J.a.KZ);b.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();b.Values[Ux.a.ehi]=y.AFrameworkApplication.userSessionId;return this.H6a.value.send(b)?32:8}bKn(){Ca.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Sa.a,{inStaging:!1}))}HXo(b){const h=new jJ.a(J.a.mNp);h.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();h.Values[Ux.a.ehi]=y.AFrameworkApplication.userSessionId;h.Values[G.a.lNp]=b;this.H6a.value.send(h)}fFn(b){this.DKc=b;this.HXo(5===this.RE?bx.kco:bx.qco);return 5===this.RE?this.eFn():this.iFn()}eFn(){this.Haj();return{returnValue:32,zCb:"HostEditUrl,"}}iFn(){let b;var h=b="";y.AFrameworkApplication.MTh&&(h="|f|"+y.AFrameworkApplication.userSessionId);
const r=y.AFrameworkApplication.J.$("IsAssignmentMode")&&y.AFrameworkApplication.J.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||y.AFrameworkApplication.vdd||X.a.e_a,A=y.AFrameworkApplication.J.$("UnattemptedEnumIsEnabled"),L=y.AFrameworkApplication.J.$("NoBrowserModalDialogs");var ba=y.AFrameworkApplication.va.bR(3588168074);ba&&this.y6o(ba.epochClickTime,ba.sessionOrigin,ba.correlationId);this.nfj();if(y.AFrameworkApplication.jAj){b+="NewOrder,";ba=8;this.H6a&&this.H6a.value&&this.H6a.value.isEnabled()&&
y.AFrameworkApplication.m5b&&(b+="Post,",ba=this.yRj());if(32===ba)return{returnValue:ba,zCb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return y.AFrameworkApplication.dv.Kda?(v.ULS.shipAssertTag(5566816,211,!!y.AFrameworkApplication.dv.Kda),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ta.HZ(!0,y.AFrameworkApplication.dv.Kda),zCb:b}):this.wHc?(v.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId),
b+="DocUrl,",rG.Dni(this.wHc,this.RE,this.options,this.application,Object(E.a)(this,this.hqj,"onEditInClientSuccess"),Object(E.a)(this,this.gqj,"onEditInClientFailure"),this.p0j,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,L,this.yPd,this._correlationId,this.dBd,this.BTe),{returnValue:32,zCb:b}):{returnValue:8,zCb:b}}b+="OldOrder,";if(!this.wHc&&y.AFrameworkApplication.dv.Kda)return this.H6a&&this.H6a.value&&this.H6a.value.isEnabled()&&y.AFrameworkApplication.m5b?(b+="Post,",h=this.yRj()):
(v.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(v.ULS.shipAssertTag(22595484,211,!!y.AFrameworkApplication.dv.Kda),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ta.HZ(!0,y.AFrameworkApplication.dv.Kda),zCb:b}):{returnValue:h,zCb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId);b+="DocUrl,";rG.Dni(this.wHc,this.RE,this.options,this.application,Object(E.a)(this,
this.hqj,"onEditInClientSuccess"),Object(E.a)(this,this.gqj,"onEditInClientFailure"),this.p0j,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,L,this.yPd,this._correlationId,this.dBd,this.BTe);return{returnValue:32,zCb:b}}kMo(b){y.AFrameworkApplication.uo.setDw(8981,b)}hqj(b){this.kMo(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Lnp||this.Haj(),this.nfj()):this.eKg||this.zsf()}gqj(b,h=0){v.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.wJc&&!this.DKc;let A=0;1===b&&(A=2);6<=b&&13>=b&&(A=1,1===h&&(this.eKg=!0));this.Jrp.o0n?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",A),Hj.a.instance.AOl(this.DKc?this.aoj:this.boj,r?this.grj:null,this.Zki(!1)?this.c$m:null,A,h)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",
A),Hj.a.instance.yOl(this.DKc?this.aoj:this.boj,r?this.grj:null,A))}}nfj(){try{const b=[Object.assign(new ma.a,{name:"CorrelationId",string:this._correlationId}),Object.assign(new ma.a,{name:"SessionOrigin",string:this.yPd}),Object.assign(new ma.a,{name:"ClickTime",string:this.dBd}),Object.assign(new ma.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];$d.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}Haj(){y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Pb.$I&&y.AFrameworkApplication.J.$("StandardProtocolDialogIsEnabled")?new ky(this):new hJ(this)}Zki(b){const h=(X.a.Hbd||X.a.Fv)&&!!y.AFrameworkApplication.a3d;h&&b&&(ed.a.Zm(y.AFrameworkApplication.a3d,"_blank",void 0,"OpenInClient"),this.zsf());return h}}bx.qco="OpenInDesktop";bx.kco="OpenInBrowser";Object(u.a)(bx,"AOpenInClientOperation",null,[]);class tz extends bx{constructor(b,h,r=!1){super(r);this.oFk=b;this.nFk=h}get tVi(){return this.nFk}get zXf(){return this.oFk}O9l(){y.AFrameworkApplication.va.Zb(wb.a.close,
2,we.a)}qri(){}T_h(b){return this.NEj(b)}waj(){v.ULS.shipAssertTag(5566817,211,!!this.wJc);y.AFrameworkApplication.Uha?y.AFrameworkApplication.ta.HZ(!0,this.wJc):ed.a.Zm(this.wJc,void 0,void 0,"LaunchDownload")}t8c(){y.AFrameworkApplication.ta.Pb.t8c()}}Object(u.a)(tz,"OpenInClientOperation",bx,[]);class lE extends tz{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.iFo=b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Ze.a.Ppa?Ze.a.Qk.Mnd(!1,
"OpenInWordOperation").then(()=>{this.Mlg(b)}).catch(()=>{this.eej(b,-1)}).finally(()=>{v.ULS.sendTraceTag(508077649,211,15,"Kick out session after open in desktop.");id.SessionStatusManager.instance.Bsc()}):Ze.a.hX.lG(this.Mlg,this.eej,b)};this.eej=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new wg.StandardDialog;h.Md=0;h.zA(Of.a.uAp,CommonUIStrings.l_DefaultDialogTitle,WacWordeditorStrings.UnlockFailed,b?this.AJn:this.BJn)};this.AJn=()=>{y.AFrameworkApplication.va.Zb(wb.a.close,
2,we.c)};this.BJn=()=>{Db.StaticActiveAppFrame.Aa().Yda(null)};this.Mlg=b=>{y.AFrameworkApplication.fud=!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.NEj(b)}}fjl(b){Ze.a.wf.eeb.Xoc||If.a.Gd().MG.nq?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.Mlg(b)):Pw.a.rT(xw.a.uvj,!0,this.iFo,null,b)}T_h(b){this.fjl(b);return 32}qri(){Db.StaticActiveAppFrame.Aa().Yda(null)}}Object(u.a)(lE,"OpenInWordOperation",
tz,[]);const IA=(b,h)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[bg.a.On]=fn.a.instance.Tx(h);fn.a.instance.Tx(h)?b[bg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[bg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},sL=(b,h,r,A,L)=>{if(!Db.StaticActiveAppFrame.Aa()||!Db.StaticActiveAppFrame.Aa().tb||!y.AFrameworkApplication.Un.rab)return 8;h=Db.StaticActiveAppFrame.Aa().tb.rd;if(!h)return 8;if(b===
fb.a.Wue&&2===r){b=new hb.GraphTransaction(15);try{b.Eb(h),fn.a.instance.Jtp(h)}finally{b&&b.dispose()}IA(L,h);y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8336055_ForceSaveOnToggleProtectDocument")&&Pw.a.rT(xw.a.yRa,!0,null,null,L)}return 32},tL=(b,h,r,A,L)=>{if(!Db.StaticActiveAppFrame.Aa()||!Db.StaticActiveAppFrame.Aa().tb)return 8;b=Db.StaticActiveAppFrame.Aa().tb.rd;if(!b)return 8;L[bg.a.Alt]=y.AFrameworkApplication.Un.rab?"":CommonUIStrings.l_ProtectDocumentToolTip;
IA(L,b);return 32};var uL=e(1101),sG=e(770);class fu extends iy.a{constructor(b,h){super(b,h);this.Ljh=this.Kjh=this.vwh=this.uwh=this.mvh=!1;this.LVc=new Cb.a("docx doc docm dot dotx odt dotm".split(" "));this.bgd=100;this.FWl="949ada80-0026-4db3-a953-c99083e6a84f";this.wWl=500;this.Srj=(r,A,L,ba,ra)=>{var Ia;if(A.contextId!==dd.a.frame)return 2;if(!(Ze.a.BYc||y.AFrameworkApplication.dv.Kda||y.AFrameworkApplication.m5b||this.mvh))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.mvh=
!0,8;if(1===L)return id.SessionStatusManager.instance.zk?8:32;let Ta=!1;void 0!==ra&&null!==ra&&(Ta=ra);if(null===(Ia=y.AFrameworkApplication.J)||void 0===Ia?0:Ia.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new jE).$re().then(()=>this.openDocument(r,Ta));else return this.openDocument(r,Ta);return 32};this.YIe=(r,A,L)=>{if(1==L){if(!uL.a.z_e)return this.uwh||(v.ULS.sendTraceTag(508703937,231,50,"Open files from PC is shown as disabled"),this.uwh=!0),64;if(!y.AFrameworkApplication.pe.mDb)return this.vwh||
(v.ULS.sendTraceTag(508598026,231,50,"Open files from PC is shown as disabled due to empty token"),this.vwh=!0),64}else if(2==L)return $d.a("OpenFileFromPC"),(r=this.uQl())?this.Iep(L,r):2;return 32};this.C2d=(r,A,L)=>{if(1==L){if(!y.AFrameworkApplication.J.$("IsDocumentOwner"))return this.Kjh||($d.a("DeleteDocumentDisabled"),this.Kjh=!0),8;this.Ljh||($d.a("DeleteDocumentEnabled"),this.Ljh=!0);return 32}if(2==L)return y.AFrameworkApplication.ud("0693c467;45g3b301"),r=new wg.StandardDialog,r.Md=1,
r.maxWidth=this.wWl,r.Ue(1,WacWordeditorStrings.DeleteFileConfirmationDialogPrimaryButton),r.sUd(WacWordeditorStrings.LearnMore,this.FWl),r.tU(WacWordeditorStrings.DeleteFileConfirmationDialogTitle,WacWordeditorStrings.DeleteFileConfirmationDialogDescription,ba=>{1===ba&&($d.a("DeleteDocumentConfirmed"),this.BWo())}),32};this.F1l=r=>{this.RKn();if(!y.AFrameworkApplication.vdd&&y.AFrameworkApplication.ta.Pb.qFg(wb.a.Sga.toString()))this.iGa(!0,J.a.download,!0,{});else if(y.AFrameworkApplication.J.$("WordEditorDownloadACopyUiIsEnabled")){let A=
y.AFrameworkApplication.yQb,L=null;r&&(r.FileDownloadUrl&&(A=r.FileDownloadUrl.toString()),r.CallSource&&(L=r.CallSource.toString()));new iE(A,L)}else super.Sga(0,null,2,null,null)};this.grl=r=>{super.workflow(0,null,2,null,r)};this.L7=Xa.a.instance.Za("Common.ISystemInitiatedFeedback")}get bZf(){this.vsh||(this.vsh=Xa.a.instance.resolve("Common.IInsertFileUploader"));return this.vsh}get LWd(){this.QU||(this.QU=new Bi.a);return this.QU}mc(){super.mc();this.ga.qa(fb.a.KZ,dd.a.frame,this.Srj);this.ga.Oc(fb.a.KZ,
12288);var b=this.ga;b.nb(fb.a.Wue,ic.a.application,sL,4);b.nb(fb.a.wsg,ic.a.application,tL,96);this.ga.qa(wb.a.bse,dd.a.frame,this.Srj);this.ga.qa(fb.a.Hek,ic.a.view,this.YIe);this.ga.qa(fb.a.Iek,ic.a.view,this.YIe);this.ga.qa(fb.a.C2d,ic.a.view,this.C2d)}openDocument(b,h){var r;v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new lE).Mc(Ze.a.BYc,y.AFrameworkApplication.yQb,GA.Word,(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.FixOpenInBrowser"))?
b===wb.a.bse?Sh.Ynk:Sh.zrk:b===wb.a.bse?Sh.OpenInBrowser:Sh.WriteOnly,h,new xe.a(()=>this.L1))}NWd(b){return Wh.a.instance.GKa()?!0:Db.StaticActiveAppFrame.Aa().TOj(xw.a.phc,sd.a.Xzl,b)}uQl(){return()=>{window.addEventListener("fileUploadedSuccessfully",this.pwp,{once:!0});this.bZf.V2o(this.bgd);this.bZf.VYo(this.LVc);this.bZf.showDialog()}}Iep(b,h){return 2===b?(h(),32):2}pwp(){window.addEventListener("focus",()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");null!=b&&b.execute(h=>
{$d.a("triggerUploadFileFeatureSurvey");h.logActivity("UploadFileFeatureSurvey","UploadFileFloodgateSurveyIsEnabled")})},{once:!0})}async BWo(){var b=await Object(sG.c)(Ze.a.Iea,{fileId:y.AFrameworkApplication.rootQuerySignature,pn:Ze.a.Un.rhe,Adb:void 0});0==b.response.StatusCode?(v.ULS.sendTraceTag(508118240,306,50,"Document deleted successfully"),ed.a.Zm("https://word.office.com","_top")):(v.ULS.sendTraceTag(508118239,306,50,"Error in Deleting Document with StatusCode {0}",b.response.StatusCode),
b=new wg.StandardDialog,b.Md=0,b.Ue(1,WacWordeditorStrings.DeleteFileErrorDialogPrimaryButton),b.Yx(WacWordeditorStrings.DeleteFileErrorDialogTitle,WacWordeditorStrings.DeleteFileErrorDialogDescription,0))}Sga(b,h,r,A,L){if(2===r){if(!y.AFrameworkApplication.yQb&&!y.AFrameworkApplication.ta.Pb.qFg(wb.a.Sga.toString()))return 8;Pw.a.rT(xw.a.Sga,!0,this.F1l,null,L);return 32}return super.Sga(b,h,r,A,L)}RKn(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.L7&&this.L7.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,A,L){return 2===r?(Pw.a.rT(xw.a.workflow,!0,this.grl,null,L),32):super.workflow(b,h,r,A,L)}}Object(u.a)(fu,"AppFrameCommandUIActor",iy.a,[]);class JA extends wg.StandardDialog{constructor(){super();this.Md=0;this.Gxb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",
CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(u.a)(JA,"WheresTheSaveButtonDialog",wg.StandardDialog,[]);const kJ=(b,h,r)=>{if(1===r)return 32;new JA;return 32};var tG=e(566),lJ=e(1362);class Ti extends cq.a{constructor(b,h,r,A,L=null){super();this.E9=L;this.evk=56;this.vQc="px";this.pGc="aria-label";this.cSa="BookmarkIndicator";this.Gqh="HighlightBookmarkedContent";this.zEk="HighlightBookmark";this.k5a="wwaengidc";this.tkl="Bookmark_24";this.qb=b;this.xh=h;this.$_=r;(this.qD=
A)&&this.qD.PUd(this.fJ.bind(this))}M9o(b){if(b.ik){for(const h of b.lg.Rj)if(this.ZXj(h))return!0;return!1}return this.ZXj(b.htmlElement)}s2a(b){let h=!1;mp.a.instance.Ae(()=>{h=this.M9o(b)},"BIA:SCIVE");return h}ZXj(b){return Ti.Paf?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}JWa(b){const h=[];mp.a.instance.Ae(()=>{const r=b.Y8a(0,this.evk,this.zoom);h.push(this.Jga(b.z2,r,b.nEc[0].y-b.l9[0].y))},"BIA:CIs");return h}Jga(b,h,
r){const A=b.Gh.ownerDocument,L=Tl.a.createElement(A,Om.a.div);L.className=Ti.hvk;Ti.Heh;L.style.left=h+this.vQc;L.style.top=r+this.vQc;h=Tl.a.createElement(A,Om.a.div);mh.a("renderIcon")&&appChrome.api.renderIcon(this.tkl,h);h.setAttribute("role","img");h.setAttribute("alt","Bookmark");h.title="Bookmark";h.setAttribute(this.pGc,"Bookmark");L.appendChild(h);b={context:new ht([],L,new Set,new Set,null,null),Tgg:b,container:L};this.xh.wK(Fd.a.click,L,this.xwa.bind(this),b);return L}lZd(){const b=Object.assign(new ti.a,
{action:1,type:5,ZD:null,XN:this.ska});this.ska=null;this.$_.pJ(b)}fJ(b,h){this.ska&&(h.M$a.Ff.classList.contains("BookmarkHighlightSelected")||this.lZd())}xwa(b){this.sfb(this.Gqh,this.zEk);if(null==b){var h=new Map;h.set("Source",this.cSa);h=Object.assign(new Sa.a,{additionalValues:h});Ca.Health.instance.recordKpiFailure(this.Gqh,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.er.context;if(Ti.Ycb(h,this.ska))return!0;h=this.yNf(b.er.Tgg,h,b.er.container);b=Object.assign(new ti.a,
{action:0,type:5,ZD:h,XN:this.ska});this.ska=h;this.$_.pJ(b);return!0}yNf(b,h,r){h={x0h:new Set,PZb:new Set,A0h:null,Unf:null};const A=this.qb.ox(b.Jb,!0,!1),L=[];if(A)for(const ba of A)L.push(ba);this.J3k(b,h,L);h=new ht(L,r,h.x0h,h.PZb,h.A0h,h.Unf);this.ska&&this.ska.Ju===L&&(r.className+=String.format(" {0}",Ti.dvk),this.ska=h);return h}J3k(b,h,r){var A;if(b.ik){var L=new Set;for(const ra of b.lg.Rj)ra.querySelectorAll("*").forEach(L.add,L);b=Array.from(L.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let ba=[];h.PZb.add(r[0].id);h.A0h=r[0].id;h.Unf=r[0].id;b.forEach(ra=>{const Ia=bm.a.Mb(ra,Eo.a.cXd);if(Ia)for(const Ta of Ia)ba.push(Ta),h.x0h.add(Ta);if(!ba.length)return!0;ra=bm.a.Mb(ra,Eo.a.xNb);if(!ra)return!0;ba=lJ.a.Uxc(ba,ra)});for(b=this.qb.Cg(r[r.length-1],!1,!0);ba.length&&b;)h.PZb.add(b.id),h.Unf=b.id,r.push(b),L=this.E9.value.Dm(b),L=null===(A=null===L||void 0===L?void 0:L.htmlElement)||void 0===A?void 0:A.querySelectorAll("."+Eo.a.Tnf),null===L||void 0===L?void 0:L.forEach(ra=>{(ra=
bm.a.Mb(ra,Eo.a.xNb))&&(ba=lJ.a.Uxc(ba,ra))}),b=this.qb.Cg(b,!1,!0)}sfb(b,h){const r=new Map;r.set("Source",this.cSa);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.k5a,r)}static Ycb(b,h){return!!h&&!!b&&b.v0h===h.v0h}}Ti.dvk="WordBookmarkIndicatorContainerSelected";Ti.Paf=!0;Ti.Heh="WordBookmarkIndicatorContainer";Ti.hvk="WordBookmarkSvgIndicatorContainer";Object(u.a)(Ti,"BookmarkIndicatorActor",cq.a,[281]);class jl{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob=null,nb=null,Eb=null,bc=null,
Bc=null,Yc=null,zd=null){var Jd,ie;this.Lka="_";this.v5a="OLE_LINK";this.rAd=(null===(Jd=y.AFrameworkApplication.J)||void 0===Jd?0:Jd.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?WacWordeditorStrings.Bookmark:"Bookmark";this.Fuk=(null===(ie=y.AFrameworkApplication.J)||void 0===ie?0:ie.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?new RegExp("^"+this.rAd+"\\d+$","i"):/^BOOKMARK\d+$/i;this.cSa="BookmarkRibbonOptions";this.bvk=
"BookmarkFloatieOptions";this.rih="CreateBookmarkOnRange";this.sih="CreateBookmarkOnView";this.qih="CreateBookmarkOnIP";this.JRe="CreateBookmark";this.k5a="wwaengidc";this.EKh="ShowHideBookmarksOnDocument";this.Ijh="DeleteBookmark";this.bzk="DeleteBookmarkAction";this.YTk="ShowHideBookmarks";this.DKh="ShowBookmarksFloatie";this.VTk="ShowBookmarksFloatieAction";this.rlh="EditBookmark";this.cAk="EditBookmarkAction";this.Xnf="BookmarksUsage";this.vkl="InsertTabSwitchActivity";this.pin="Insert";this.s6b=
b;this.ga=h;this.pb=r;this.Tp=A;this.rB=L;this.Oaa=ba;this.Zc=ra;this.eQ=Ia;this.$s=nb;this.Geh=Ta;this.gf=ob;this.h7=Bc;this.Hp=Eb;this.zd=bc;this.xX=Yc;this.sm=zd}get Kw(){return this.rB.value}mc(){this.ga.qa(Lc.a.eLa,ic.a.view,this.eLa.bind(this));this.ga.nb(wb.a.T2a,ic.a.application,this.nwp.bind(this),96);this.ga.qa(Lc.a.eLa,ic.a.Nd,this.hKl.bind(this));this.ga.qa(Lc.a.eLa,ic.a.kd,this.gKl.bind(this));this.ga.qa(Lc.a.deleteBookmark,ic.a.view,this.deleteBookmark.bind(this));this.ga.qa(Lc.a.qCf,
ic.a.view,this.D4l.bind(this));this.ga.nb(Lc.a.DZj,ic.a.view,this.zep.bind(this),1028);this.ga.nb(Lc.a.bve,ic.a.application,this.bve.bind(this),96);this.ga.nb(Lc.a.TCe,ic.a.kd,this.TCe.bind(this),1028);this.ga.nb(fb.a.Yke,ic.a.view,this.Yke.bind(this),1028);this.ga.nb(Lc.a.Qde,ic.a.view,this.Qde.bind(this),1028);this.ga.Oc(Lc.a.eLa,1028)}nwp(b,h,r,A,L){return L&&L.NewContextId===this.pin?(this.yle(this.vkl),32):2}eLa(b,h,r,A,L){var ba,ra;b=this.pb.hh;if(!b||b.contextId===ic.a.Fba)return 2;if(1===
r)return bi.a.bda(h)||(null===(ba=this.sm)||void 0===ba?0:ba.t4(b))||(null===(ra=this.sm)||void 0===ra?0:ra.koa(b))?8:32;h=this.pb.ob.currentSelection;if(!h||this.gf.qn(h))return 2;this.wfd(L,"User is trying to create bookmark from UILocation : {0}");this.sfb(this.sih,this.JRe);if(h&&this.Tp.xhf(this.Xsb(),h))return this.yle(this.Xnf),32;L=new Map;L.set("Source",this.cSa);L=Object.assign(new Sa.a,{additionalValues:L});Ca.Health.instance.recordKpiFailure(this.sih,"Unable to create bookmark",!1,!0,
L);return 8}hKl(b,h,r,A,L){if(1===r)return 32;if(ic.a.Nd!==h.contextId)return 8;this.wfd(L,"User is trying to create bookmark from UILocation : {0}");b=this.pb.ob.currentSelection;if(!b)return 2;this.sfb(this.rih,this.JRe);if(this.Tp.xhf(this.Xsb(),b))return this.yle(this.Xnf),32;b=new Map;b.set("Source",this.cSa);b=Object.assign(new Sa.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.rih,"Unable to create bookmark for range",!1,!0,b);return 8}gKl(b,h,r,A,L){if(1===r)return 32;if(ic.a.kd!==
h.contextId)return 8;this.wfd(L,"User is trying to create bookmark from UILocation : {0}");b=this.pb.ob.currentSelection;if(!b)return 2;this.gf.qn(b)&&(h=b.Ya,this.gf.twb(h)?(b=this.gf.M8(h,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.gf.M8(h,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.sfb(this.qih,this.JRe);if(this.Tp.xhf(this.Xsb(),b))return this.yle(this.Xnf),32;b=new Map;
b.set("Source",this.cSa);b=Object.assign(new Sa.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.qih,"Unable to create bookmark for IP",!1,!0,b);return 8}bve(b,h,r,A,L){1===r&&32;L[bg.a.On]=Ti.Paf;return 32}zep(b,h,r,A,L){if(1===r)return 32;this.sfb(this.EKh,this.YTk);(b=L[bg.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Ti.Paf=b;b=Object(ao.a)().DT(this.Kw);if(null!==b)return this.Rmd(b),this.s6b.UH({ShowBookmarks:"CheckboxModel"}),32;
b=new Map;b.set("Source",this.cSa);b=Object.assign(new Sa.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.EKh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,A,L){b=this.pb.ob.currentSelection;if(!b)return 2;b=b.Ya;b=this.Tp.A9d(b.node,b.cpBegin);if(1===r)return b?32:8;this.wfd(L,"User is trying to delete bookmark from UILocation : {0}");this.eQ.k5&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.eQ.dismissFloatie());
this.sfb(this.Ijh,this.bzk);b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.Tp.EHj(b.id))return this.Geh&&this.Geh.lZd(),32;r=new Map;r.set("Source",this.cSa);r=Object.assign(new Sa.a,{additionalValues:r});Ca.Health.instance.recordKpiFailure(this.Ijh,"Unable to delete bookmark",!1,!0,r);return 8}D4l(b,h,r,A,L){b=this.pb.ob.currentSelection;if(!b)return 2;b=b.Ya;b=this.Tp.A9d(b.node,b.cpBegin);if(1===r)return b?32:8;this.wfd(L,
"User is trying to edit bookmark from UILocation : {0}");this.eQ.k5&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.eQ.dismissFloatie());this.sfb(this.rlh,this.cAk);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.h7.value.E4l(h,b,this.Tp),32;h=new Map;h.set("Source",this.cSa);h=Object.assign(new Sa.a,{additionalValues:h});Ca.Health.instance.recordKpiFailure(this.rlh,"Unable to edit bookmark",
!1,!0,h);return 8}wfd(b,h){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}TCe(b,h,r,A,L){1===r&&32;this.sfb(this.DKh,this.VTk);if(h.contextId===ic.a.kd)return b=Array(1),b.push("Bookmarks"),this.eQ.showFloatie(L.location,b,1),32;L=new Map;L.set("Source",this.bvk);L=Object.assign(new Sa.a,{additionalValues:L});Ca.Health.instance.recordKpiFailure(this.DKh,"Unable to show bookmark floatie",!1,!0,L);return 8}Yke(b,h,r,A,L){let ba;return 1===r?(mp.a.instance.Ae(()=>{ba=this.ga.Sf(h,
fb.a.PT,r,!0,A,L);32!==ba&&(ba=this.ga.Sf(h,Lc.a.eLa,r,!0,A,L))},"BA:LFE"),ba):8}Qde(b,h,r){var A;if(1===r)return 32;if(b=this.pb.ob.currentSelection){b=b.Ya.node;if(h=this.Pri(b))return h.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.Tp.A9d(b,0)){b=this.xX.kpb.get(null===(A=b.id)||void 0===A?void 0:A.toString());A=Object(ao.a)().DT(this.Kw).ed.Mb(b);if(A=this.Pri(A))return A.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,
3029,50,"No bookmark found enclosing the content.")}return 2}Pri(b){let h;b=this.Hp.kn(b).Dm(this.zd.Pd.Lc);b.GZa&&(b=b.htmlElement.querySelectorAll("div."+Ti.Heh),0<b.length&&(h=b[0]));return h}Rmd(b){const h=tG.b(b);if(h){var r=this.Zc.Vc(2);try{for(r.Eb(b);h.moveNext();){if(!rd.ParagraphReader.Wh(h.iterator))continue;const A=h.currentNode;this.k3l(A)&&this.Oaa.qVb(A,!0)}}finally{r&&r.dispose()}}}k3l(b){var h;for(let A=0;A<b.ra.length;A++){const L=b.ra.jc(A);if(null!=L.Oi)for(let ba=0;ba<L.Oi.length;ba++){var r=
L.Oi.K(ba);if(null!=r){r=b.ed.Mb(r.Ap).ka(Rc.a.Wv,"");const ra=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");if(!(D.a.jg(r)||r.startsWith(this.Lka)||ra&&r.startsWith(this.v5a)))return!0}}}}Xsb(){var b=this.Tp.d8d(!1);const h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Rc.a.Wv,"");this.Fuk.test(A)&&h.push(A)}return 0<h.length?(h.sort((r,A)=>r.localeCompare(A,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.rAd.length)),this.rAd+(b+1)):
this.rAd+1}sfb(b,h){const r=new Map;r.set("Source",this.cSa);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.k5a,r)}yle(b){this.$s&&this.$s.execute(h=>{h.logActivity(b,null)})}}Object(u.a)(jl,"BookmarkActor",null,[]);class bN{constructor(b,h,r){this.Tb=b;this.yZl=h;this.wg=r;this.atf=this.atf.bind(this)}mc(){this.Tb.qa(Lc.a.R6f,ic.a.view,this.atf)}atf(b,h,r,A,L){return 1===r?32:(b=this.wg.f9(h.Pk))?(L=3===L.aB,this.yZl.value.Cdi(this.ANm(b),this.mXm(b),L),32):2}ANm(b){const h=new Ai.DictionaryPropertySet;
h.setValue(Me.a.columnCount,this.wg.Nh(b));h.setValue(Me.a.CI,this.wg.Dca(b));h.setValue(Me.a.uta,this.wg.dtb(b));h.setValue(Me.a.separator,this.wg.mbe(b));return h}mXm(b){const h=new Ai.DictionaryPropertySet;h.setValue(Rc.a.marginLeft,this.wg.eP(b));h.setValue(Rc.a.marginRight,this.wg.fP(b));h.setValue(Rc.a.pageWidth,this.wg.nx(b));return h}}Object(u.a)(bN,"ColumnsDialogActor",null,[]);var cN=e(894);class dN{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){this.gr=b;this.Hka=h;this.Pe=r;this.Xs=A;this.wn=
L;this.ee=ba;this.Zc=ra;this.Ge=Ia;this.ga=Ta;this.XGk=ob;this.Ixk=nb}get G0f(){return this.XGk}mc(){this.ga.nb(fb.a.Isd,ic.a.view,this.Dgn.bind(this),96);this.ga.nb(fb.a.Und,ic.a.view,this.Und.bind(this),4);this.ga.nb(fb.a.XVd,ic.a.view,this.XVd.bind(this),1028)}XVd(b,h,r,A,L){if(!hq.a.Fuf)return 8;b=L.FormattingActionId;L=L.FormattingActionData;if(!h.view||!h.view.Ee)return 2;h=h.view;if(!(b&&L&&h.ub&&h.ub.ob.currentSelection))return 8;h=this.wn.ZAi(h.ub.ob.currentSelection.toArray());for(const ba of h){h=
ba.ka(Rc.a.yy,0);r=this.gr.getById(h);if(!r)return v.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.Ixk.ADp(r,b,L))return v.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}Dgn(b,h,r,A,L){h=this.gr.getById(L);if(!h)return 8;r=h.je;if(!r)return 8;if(hq.a.Hpb&&8===h.type||r.ka(Rc.a.aca,!1))return 2;A=this.gr.Ktm(h);if(!A)return 8;L=this.Zc.Vc(7);L.Eb(A.node);if(!this.G0f)return(b=h.placeholderText)||
(b=WacWordeditorStrings.ContentControlPlaceholder),this.ee.lf(A,b),hq.a.gia?this.wn.gNb(h,!0):this.gNb(h),r.setValue(Rc.a.aca,!0),L.dispose(),32;const ba=new Ai.DictionaryPropertySet;ba.setValue(Pd.a.pce,A);var ra=r.ka(Rc.a.FWa,"");ra=this.Hka.iPi(ra);if(!ra)return this.Xs.lf(A,WacWordeditorStrings.ContentControlPlaceholder,b),hq.a.gia?this.wn.gNb(h,!0):this.gNb(h),r.setValue(Rc.a.aca,!0),L.dispose(),32;ba.setValue(Pd.a.Z7c,ra);if(1<ra.length&&!h.Pg)return L.dispose(),8;hq.a.gia?this.ga.Zb(fb.a.Rsd,
2,{Z7c:ra,pce:A,placeholderText:h.placeholderText}):this.DIl(ba);r.setValue(Rc.a.aca,!0);L.dispose();return 32}Und(b,h,r){b=h.view.Ee?h.view:null;if(!b||!b.ub)return 8;const [A,L]=this.IQm(b.ub.ob);if(0===A.length)return 8;if(1===r){for(var ba of A){var ra=L.get(ba.parentId);if(this.D0i(ba,ra))return 32}return 8}if(2===r){r=this.fip(A,L);ba=this.Zc.Vc(15);ba.Eb(b.Fd);for(ra of r)r=L.get(ra.parentId),this.D0i(ra,r)&&this.gr.J0b(ra.id);ba.dispose();Object(cN.l)()&&Object(cN.o)("RemoveContentControl");
return 32}return 2}IQm(b){var h,r,A=[];for(const ba of b)A.push(...(null!==(h=this.wn.zua(ba.Ya,ba.hd,1))&&void 0!==h?h:[]));if(0===A.length)return[A,new Map];h=[];for(const ba of b)h.push(...(null!==(r=this.wn.zua(ba.Ya,ba.hd,3))&&void 0!==r?r:[]));b=new Map(A.map(ba=>[ba.id,ba]));if(0===h.length)return[A,b];const L=new Map(h.map(ba=>[ba.id,ba]));A=A.filter(ba=>!L.has(ba.id));b=new Map([...b,...L]);return 0==A.length?[[h[0]],b]:[A,b]}gNb(b){const h=this.Xs.Smc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:
0);if(h){if(b=this.Ge.pG(b.start.node).Qg(Ql.a.qog))this.Pe.ota(h.formatting),this.Pe.Hgb(h.formatting,b)}else v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}DIl(b){this.ga.Zb(fb.a.Rsd,2,b)}D0i(b,h){return b.coa&&b.Cxn&&(!h||h.isEditable)}fip(b,h){const r=(A,L)=>null==A||null==L||A.id===L.id?!1:A.id===L.parentId||r(h.get(A.parentId),L);return b.slice().sort((A,L)=>r(A,L)?1:r(L,A)?-1:0)}}Object(u.a)(dN,"ContentControlActor",null,[]);var ly=e(1083);class oM extends Xf.a{constructor(b,
h,r){super(!1,!1,!0);this.yyh=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,ly.a.Akf,ly.a.zkf,ly.a.Bkf];this.Ttk=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,ly.a.W$k,ly.a.V$k,ly.a.Y$k];this.Zch=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.JAc=()=>{new oM(this.ga,this.Jcf,this.MIc)};this.gDm=()=>{const A=[];for(const L of this.Jcf)A.push(this.M$(L));return A};this.ZHp=A=>{const L=
new Set;this.Dka="";for(const ba of A)if(""!==ba.position){const ra=this.bIi(ba.position);if(0>ra||22<ra){this.Dka=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(L.has(ra)){this.Dka=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.gtp(ba)),L.add(ra)}else{this.Dka=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Dka&&(this._tabStops=[],this.Jcf=A)};this.mTl=(A,L)=>{try{if(1===A){if(""!==this.Dka)throw Error.create(this.Dka);
L.DefaultTabStop&&(this.MIc=ly.a.zzg(L.DefaultTabStop),this.CLp(this.MIc));if(32!==this.ga.Zb(Lc.a.Q4b,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:fg.a.pF(this.MIc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ba){this.iQa(ba.message,this.JAc)}};this.ga=b;this.Jcf=h;this._tabStops=[];this.MIc=r;this.Dka="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.W4c()};this.ti(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.mTl,b)}M$(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}bIi(b){return Math.floor(100*parseFloat(b))/100}gtp(b){return new AB.a(fg.a.pF(this.bIi(b.position)),ly.a.vTm(b.alignment),ly.a.tTm(b.leader),1)}CLp(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Zb(fb.a.CPa,2,h)){var r=h.marginLeft;const A=rb.a.Zj(h.marginRight,0);r=rb.a.Zj(r,0);h=rb.a.Zj(h.pageWidth,0);if(rb.a.Rna(b,0,!1)>=h-A-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}W4c(){return{["getInitState"]:this.gDm,["updateState"]:this.ZHp,["validPositions"]:this.qMi(0,"Position"),["validAlignments"]:this.xAi(this.Zch,this.Zch,null,"Alignment"),["validLeaders"]:this.xAi(this.yyh,this.yyh,this.Ttk,"Leader"),["defaultTabStopSpinButtonProps"]:this.qMi(.01,"DefaultTabStops"),["defaultTabStopLength"]:this.MIc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}qMi(b,
h){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:h,["unitType"]:"Inch",["validUnits"]:[im.a("Inch",3,b,22,.1)],["numberFormatInfo"]:im.d()}}xAi(b,h,r,A){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:A,["options"]:im.b(b,h,r)}}}Object(u.a)(oM,"CustomTabDialog",Xf.a,[]);class eN{constructor(b,h,r){this.nuc=(A,L,ba,ra,Ia)=>{if(2!==ba)return 8;if(!Ia)return 16;A=Ia.tabStop;Ia=Ia.value;if(!A)return 16;$d.c(Lc.a.nuc);Ia=new AB.a(Ia,
A.Kja,A.$va,A.uKg);L=L.node;this.WHa.Afb(L,A);this.WHa.pfe(L,Ia);return 32};this.Yqd=(A,L,ba,ra,Ia)=>{if(2===ba){if(!Ia)return 16;this.WHa.pfe(L.node,Ia);return 32}return 8};this.N_b=(A,L,ba,ra,Ia)=>{A=this.WHa.HEj(L.node);if(!("customTabs"in Ia))return Ia.customTabs=A,32;L=Ia.customTabs;if(!L||0>=L.length||!A||0>=A.length)return Ia.customTabs=null,32;ba=[];for(const Ta of L)for(const ob of A)if(ob.IQa===Ta.IQa&&ob.uKg===Ta.uKg&&ob.Kja===Ta.Kja){ba.push(Ta);break}Ia.customTabs=ba;return 32};this.Afb=
(A,L,ba,ra,Ia)=>{if(2===ba){if(!Ia)return 16;$d.c(Lc.a.Afb);this.WHa.Afb(L.node,Ia);return 32}return 8};this.K0b=(A,L)=>{this.WHa.K0b(L.node);return 32};this.Q4b=(A,L,ba,ra,Ia)=>{if(2===ba){if(!Ia)return 16;A=Ia.tabStops;ba=Ia.defaultTabStopLength;L=L.node;ra=!1;const Ta=this.WHa.jLo(L,A);Ia.defaultTabStopLengthSaved||(ra=this.hV.H_o(L,ba),Ia.defaultTabStopLengthSaved=!0);Ta&&$d.d(Lc.a.Q4b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"Custom Tab Stops Count",string:A.length.toString()})]);
if(null==ra)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ra&&(this.vod&&this.vod.CZi(),this.Yd.Vv(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),$d.d(Lc.a.Q4b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"Default Tab Stop Length",string:ba.toString()})]));return 32}return 8};this.OZj=(A,L,ba)=>{if(2!==ba)return 8;A={};if(32!==this.ga.Zb(Lc.a.u1,2,A))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;L={};if(32!==this.ga.Zb(fb.a.CPa,2,L))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;A=ly.a.zzg(fg.a.kD(A.defaultTabStop));ba={};ba.defaultTabStopLength=A;ba.sectionPropertiesData=L;if(32!==this.ga.Zb(Lc.a.rRg,2,ba))return v.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ba.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.WHa.iQa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;L={};if(32!==this.ga.Zb(Lc.a.N_b,2,L))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(L=L.customTabs)||(L=[]);L=ly.a.uTm(L);new oM(this.ga,L,A);$d.c(Lc.a.JAc,!0);return 32};this.iwn=(A,L,ba,ra,Ia)=>{if(2!==ba)return 8;if(!Ia)return 16;if(Ia.isParagraphValid)return 32;ba={};if(32!==this.ga.Sf(L,fb.a.lfb,2,!1,null,ba))return 16;A=Ia.sectionPropertiesData;L=Ia.defaultTabStopLength;var Ta=ba.fw;ra=Ta.Kha;
Ta=1===Ta.specialIndentType?Ta.NC:Ta.NC-Ta.Bja;const ob=A.marginLeft,nb=A.marginRight;ba.isRtl?(ba=rb.a.Zj(Math.max(nb,nb+ra),0),ra=rb.a.Zj(Math.max(ob,ob+Ta),0)):(ba=rb.a.Zj(Math.max(ob,ob+Ta),0),ra=rb.a.Zj(Math.max(nb,nb+ra),0));A=rb.a.Zj(A.pageWidth,0);L=rb.a.Rna(L,0,!1);Ia.isParagraphValid=L<A-ba-ra;return 32};this.ga=b;this.WHa=h;this.hV=r}get Yd(){return null!=this.hah?this.hah:this.hah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get vod(){return null!=this.i8g?
this.i8g:this.i8g=Xa.a.instance.Wa("WordEditor.Actors.RenderParagraphsContainingTabs")}mc(){const b=r=>Rh.OutlineElementGeneralizer.lna(r.ob,!0),h=Ze.a.Z2a.k_c(b,!0);this.ga.qa(Lc.a.N_b,ic.a.view,Ze.a.Z2a.k_c(b,!1));this.ga.nb(Lc.a.N_b,ic.a.paragraph,this.N_b,96);this.ga.qa(Lc.a.Afb,ic.a.view,h);this.ga.nb(Lc.a.Afb,ic.a.paragraph,this.Afb,96);this.ga.qa(Lc.a.K0b,ic.a.view,h);this.ga.nb(Lc.a.K0b,ic.a.paragraph,this.K0b,96);this.ga.qa(Lc.a.Yqd,ic.a.view,h);this.ga.nb(Lc.a.Yqd,ic.a.paragraph,this.Yqd,
96);this.ga.qa(Lc.a.nuc,ic.a.view,h);this.ga.nb(Lc.a.nuc,ic.a.paragraph,this.nuc,96);this.ga.qa(Lc.a.Q4b,ic.a.view,h);this.ga.nb(Lc.a.Q4b,ic.a.paragraph,this.Q4b,96);this.ga.qa(Lc.a.rRg,ic.a.view,h);this.ga.nb(Lc.a.rRg,ic.a.paragraph,this.iwn,96);this.ga.qa(Lc.a.JAc,ic.a.view,this.OZj);this.ga.qa(Lc.a.hYi,ic.a.view,this.OZj)}}Object(u.a)(eN,"CustomTabActor",null,[]);var rO=e(132),vL=e(635);class sO{constructor(b,h,r,A,L,ba,ra,Ia,Ta){this.ga=b;this.cTd=r;this.h4a=(this.uSc=L)&&A;this.sq=ba;this.nY=
ra;this.Gyk=Ia;this.VF=Ta;this.Ptk=h;this.Cfj(!0);this.sej(!0);y.AFrameworkApplication.IG(()=>{this.bZb()});this.h4a&&mh.a("dispatch")&&appChrome.api.dispatch(this.s4j([]))}mc(){this.h4a&&(this.ga.qa(Lc.a.ztp,ic.a.view,this.BTl.bind(this)),this.ga.qa(Lc.a.gsd,ic.a.view,this.gsd.bind(this)),this.ga.nb(Lc.a.omd,ic.a.view,this.omd.bind(this),96));this.uSc&&(this.ga.qa(Lc.a.hsd,ic.a.view,this.hsd.bind(this)),this.ga.nb(Lc.a.Tve,ic.a.view,this.Tve.bind(this),96))}lkn(b){if(!this.$$o(b))return!1;const h=
gm.a.instance.Vc(2);try{h.Eb(b.root);const r=te.a.kb(b.root.graphNode),A=zp.a.Zr(r);for(;A.moveNext();){const L=Object(ya.a)(rO.a,A.currentNode);L&&L.fK(b.Lc,20,!0)}}finally{h&&h.dispose()}return!0}$$o(b){return b&&b.root&&b.Ly?b.Aj||b.P1f||b.I2i||b.ql:!1}kNo(){let b=!1;this.cTd.forEach(h=>{this.lkn(h)&&(b=!0)});return b}Atp(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.sq.UQ?"dark":"light");return this.sq.UQ?vL.a.gVc(1):vL.a.QHj(1)}CMg(){const b=this.sq.S0;
v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.kNo()||(b?!vL.a.gVc(0):!vL.a.QHj(0)))return!1;this.Gyk.Buo(b);return!0}s4j(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.sq.UQ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.VMi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.sq.lhb?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:
WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){v.ULS.sendTraceTag(527282835,3023,10,h)}return b}BTl(){return this.CMg()?32:8}hsd(b,h,r){if(1===r)return 32;b=this.nY.rg("UserAction","sharedUXDarkModeToggle");if(mh.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),mh.a("isSharedUXDarkModeOn")?
this.sq.UQ=appChrome.api.isSharedUXDarkModeOn():this.sq.UQ=!this.sq.UQ,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.sq.UQ);else return 8;appChrome.getHeaderApi().then(A=>{A.hasOwnProperty("refreshThemeOverride")&&A.refreshThemeOverride()});this.Atp()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.h4a&&!this.sq.lhb&&(this.CMg()||v.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");
Db.StaticActiveAppFrame.Aa().UH(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.sq.UQ));this.h4a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.sq.UQ));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.qj);$d.b(this.sq.UQ?"DarkModeOn":"DarkModeOff");return 32}gsd(b,h,r){if(1===r)return 32;b=this.nY.rg("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,
3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.sq.lhb=!this.sq.lhb;if(!this.CMg())return 8;h={};h.DarkModeSwitchBackground=this.VF?"ButtonModel":"ToggleButtonModel";Db.StaticActiveAppFrame.Aa().UH(h);b.stop();v.ULS.sendTraceTag(555885378,3023,50,"{0}",b.qj);v.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.sq.lhb);$d.b(this.sq.lhb?"DarkCanvasOff":"DarkCanvasOn");return 32}Tve(b,h,r,A,L){if(1===r)return 32;if(!L)return 2;mh.a("isSharedUXDarkModeOn")&&
(this.sq.UQ=appChrome.api.isSharedUXDarkModeOn());L&&(L[bg.a.On]=this.sq.UQ);return 32}omd(b,h,r,A,L){if(1===r)return 32;if(!L)return 2;!this.VF&&L&&(L[bg.a.On]=this.sq.lhb);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.sq.UQ));this.h4a&&this.s4j(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.VMi(!1)));appChrome.api.dispatch(b);return 32}VMi(b){const h={};this.sq.lhb?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",
h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}bZb(){this.uSc&&this.Cfj(!1);this.h4a&&this.sej(!1)}Cfj(b){var h;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.sq.UQ?"dark":"light",this.sq.zLa);b&&this.sq.UQ!=(null===(h=this.Ptk)||void 0===h?void 0:h.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",
this.sq.UQ?"dark":"light",this.sq.zLa)}sej(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.sq.S0?"dark":"light",this.sq.ATl)}}Object(u.a)(sO,"DarkModeActor",null,[]);class cx{constructor(b){this.yo=null;this.Hsa=b}get pNb(){return null!=this.YWg?this.YWg:this.YWg=Xa.a.instance.Wa("Box4.IAutoCorrectRules")}get P0(){return null!=this.$Wg?this.$Wg:this.$Wg=Xa.a.instance.Wa("Box4.IAutoCorrectScheduler")}get NZ(){return null!=this.a7g?
this.a7g:this.a7g=Xa.a.instance.Wa("Box4.Pages.IPageContentEditor")}get xP(){return null!=this.v6g?this.v6g:this.v6g=Xa.a.instance.Wa("Box4.IOutlineEditor")}get Dh(){return this.yo||(this.yo=this.Hsa())}Yaj(b,h,r){if(this.xP&&cx.Qj){var A=Object(ak.a)().hOf(h);b=A.node;Ee.a.em(A)&&(A=vc.a.jd(b,rd.ParagraphReader.textLength(b)));var L=pb.a.language(pb.a.uu(A));A=te.a.kb(r.Fd);Object(ao.a)().Uye(A);var ba=b=null;if(A)for(let ra=A.ic(1);ra&&!ba;ra=A.Di(1))il.a.hEa(ra)&&(ba=ra);if(A&&!ba){if(!this.NZ||
!this.xP)return;b=new hb.GraphTransaction(7);b.nw(A);ba=this.NZ.k1d(A);this.xP.Yla(A,!0);L&&(hg.a.Ze(A),A=vc.a.jd(A.currentNode,0),cx.Qj.kBe(pb.a.uu(A),L))}L=Tb.SelectionFactory.zq(ba,!0);r.ub.Uc(L);Ee.a.Df(h)&&(r=te.a.kb(h.node),r.ku(),hm.OutlineNavigator.Wyg(r),this.pNb&&this.P0&&il.a.RC(r,h,!0)&&(h=this.pNb.qGf(h,-1,!1,pg.a.iB))&&this.P0.BPj(h));this.Dh&&this.Dh.eK();b&&b.dispose()}}static get Qj(){return null!=cx.s0g?cx.s0g:cx.s0g=Xa.a.instance.Wa("Box4.IFormattingEditor")}static get instance(){return null!=
cx.f3g?cx.f3g:cx.f3g=cx.In()}static In(){return new cx(()=>Xa.a.instance.Wa("Box4.IUndoManager"))}}Object(u.a)(cx,"TitleViewEditor",null,[]);class pM{rzf(b,h,r){return 1===r?32:pM.YWl(h.node)}static YWl(b){const h=new te.a;h.set(b);h.ku();b=new hb.GraphTransaction(7);b.nw(h);h.qh();b.dispose();return 32}}Object(u.a)(pM,"DeleteOutlineLevelContentStrategy",null,[]);class is{constructor(){this.dzk=new pM;this.rzf=(b,h,r,A,L)=>this.dzk.rzf(b,h,r,A,L)}mc(b){const h=this.Fji.Bzf.bind(this.Fji),r=this.rzf,
A=this.tji.$Wl.bind(this.tji);this.qug(b,h,r,A);b.qa(fb.a.backspace,ic.a.kd,A);b.qa(fb.a.backspace,ic.a.Nd,A);b.qa(fb.a.backspace,ic.a.od,qf.ActionManager.UV);b.qa(fb.a.backspace,ic.a.outline,r);b.qa(fb.a.backspace,ic.a.view,h);b.Oc(fb.a.backspace,1124);b.qa(fb.a.uCa,ic.a.kd,qf.ActionManager.UV);b.qa(fb.a.uCa,ic.a.Nd,A);b.qa(fb.a.uCa,ic.a.od,qf.ActionManager.UV);b.qa(fb.a.uCa,ic.a.outline,r);b.qa(fb.a.uCa,ic.a.view,h);b.nb(fb.a.H1d,ic.a.view,h,1124);b.qa(fb.a.WJ,ic.a.kd,A);b.qa(fb.a.WJ,ic.a.Nd,A);
b.qa(fb.a.WJ,ic.a.od,qf.ActionManager.UV);b.qa(fb.a.WJ,ic.a.outline,r);b.qa(fb.a.WJ,ic.a.view,h);b.Oc(fb.a.WJ,1124);b.nb(fb.a.Qxf,ic.a.view,h,1124);b.nb(fb.a.Rta,ic.a.view,is.Rta,1028)}qug(){}static get Yf(){return null!=is.z6g?is.z6g:is.z6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get NZ(){return null!=is.Y6g?is.Y6g:is.Y6g=Xa.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get xP(){return null!=is.u6g?is.u6g:is.u6g=Xa.a.instance.resolve("Box4.IOutlineEditor")}static get Dc(){return null!=
is.t_g?is.t_g:is.t_g=Xa.a.instance.Wa("Box4.IFeatureHelper")}static Rta(b,h,r,A,L){A=h.view;if(!A.ub||!A.ub.ob.currentSelection||Ee.a.qn(A.ub.ob.currentSelection))return 8;if(1===r)return 32;r=A.ub.ob;const ba=r.currentSelection;var ra=ba.Ya,Ia=null,Ta=!1;if(r.IN){if(ra.contextId===ic.a.outline&&1===r.length){for(b=te.a.kb(ra.node);b.ue();)b.qh();is.xP.Yla(b,!0);hg.a.Ze(b);b=Tb.SelectionFactory.Ie(b.currentNode,0);A.ub.Uc(b);return 32}Ia=ra.node;var ob=null;if(Yo.c(ra)){var nb=Ia.ug(A.Lc);nb&&(nb=
nb.zrq)&&0<=nb.width&&0<=nb.height&&(ob=new rm.a(rb.a.Zn(nb.x,0),rb.a.Zn(nb.y,1)));ob||(ob=SE.a(Ia))}else ob=SE.a(ra.node);ra=te.a.kb(ra.node);ra.ku();Object(ao.a)().Uye(ra);Ia=is.NZ.k1d(ra);SE.b(Ia,ob.x,ob.y);is.xP.Yla(ra,!0);Ia=Tb.SelectionFactory.zq(Ia,!0)}else if(1===r.length){Ta=r.last;ra=Fg.a.oPb(Ta);if(is.Dc&&is.Dc.isFeatureEnabled(22)&&Object(ak.a)().yHg(ra).returnValue)return 2;ra=Ta.hd;Ta=!r.Oy&&!(null===(ob=r.currentSelection)||void 0===ob?0:ob.cdb)&&(Ee.a.em(ra)||rd.ParagraphReader.Xn(ra)||
Ee.a.Zca(ra))}Ta&&(Ta=Ee.a.Xk(ba,!1,!1,void 0,!1),A.ub.Uc(Ta),y.AFrameworkApplication.va.Sf(h,fb.a.vG,2,!1,null,L),Ia=A.ub.ob.currentSelection,A.ub.Uc(ba));L||(L=new Ai.DictionaryPropertySet);L.setValue(Pd.a.s1c,!0);y.AFrameworkApplication.va.Sf(h,fb.a.WJ,2,!0,null,L);if(Ia&&Ia.Ya.isValid)return A.ub.Uc(Ia),32;r.IN&&cx.instance.Yaj(b,h.Pk,A);Ee.a.qn(A.ub.ob.currentSelection)||y.AFrameworkApplication.va.Sf(h,fb.a.vG,2,!1,null,L);return 32}static XWl(b,h){if(1===h)return 32;h=new hb.GraphTransaction(7);
h.Eb(b);is.Yf.hxa(b);h.dispose();return 32}}Object(u.a)(is,"ADeleteActor",null,[]);var fN=e(253),tO=e(716);class An{get Ig(){return Ke.a.instance}$Wl(b,h,r,A,L){A=null===L||void 0===L?void 0:L.Zwd;if(1===r)return 32;var ba=b===fb.a.backspace;if(this.Ig.ii){if(this.Ig.V2i(h)&&An.Cma&&(r=h.clone(),r.nc+=1,--r.Ob,this.Ig.Prc(r)))return An.Cma.pHj([r]),32;if(this.Ig.G2f(h,ba))return 2}if(An.lA()&&An.lA().instance&&An.lA().instance.wZ(h))return 4;const ra=h.node;var Ia=h.cpBegin;r=h.cpEnd;let Ta=h.Ob,
ob=h.nc;const nb=rd.ParagraphReader.text(ra),Eb=nb.length;let bc=!1;if(Ia===r){if(ba&&!Ia||!ba&&Ia===Eb)return 2;ba?({cp:Ia,returnValue:bc}=this.Ig.wkj(ra,Ia),bc||({cp:Ia,lta:Ta,returnValue:bc}=this.Ig.vkj(h,Ia,Ta)),bc||(Ia--,D.a.VC(nb,Ia)&&Ia--),b=fb.a.knf):({cp:r,returnValue:bc}=this.Ig.ZVn(ra,r),bc||({cp:r,lta:ob,returnValue:bc}=this.Ig.YVn(h,r,ob)),bc||(r++,D.a.VC(nb,r)&&r++),b=fb.a.aji)}Ia=Ia===r?vc.a.jd(ra,Ia):vc.a.createTextRange(ra,Ia,r);ap.a.jsb&&(Ia.Tga=h.Tga,Ia.dua=h.dua);bc&&this.Ig.ii&&
(ba?Ia.Ob=Ta:Ia.nc=ob);if(!this.Ig.Prc(Ia))return 2;this.vMb(ra);h=new hb.GraphTransaction(15);h.Bh=b;h.Eb(ra);ba=Object(Pb.a)(tO.a,L)&&L.gab;if(!An.Yd.Zg||ba||An.BKa.gje(Fg.a.instance.ob.currentSelection))this.uji(Ia,A);else{ba=An.Yd.I8a();try{const Bc=An.Ni.std(Ia);let Yc;if(({type:Yc}=Bc.bce()).returnValue){const zd=Object(ya.a)(66,L);zd&&zd.ka(Kh.a.I0f,!1)?An.Yd.ZZb=Yc:An.Yd.Vv(Yc)}L=0;for(let zd=Bc.length-1;0<=zd;--zd){let Jd;const ie=({Qje:Jd}=Bc.getContext(zd)).returnValue;Jd?(An.Gs.cyb(ie,
null),L+=An.lk.bBb(ie,2),An.lk.L0d=r+L):this.uji(ie,A)}}finally{ba&&ba.dispose()}}h.dispose();return 32}vMb(){}static get Yd(){return null!=An.kah?An.kah:An.kah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lk(){return null!=An.W$g?An.W$g:An.W$g=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ni(){return null!=An.Fah?An.Fah:An.Fah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Gs(){return null!=
An.i1g?An.i1g:An.i1g=Xa.a.instance.resolve("Box4.IHyperlinkEditor")}static lA(){return An.Qo||(An.Qo=Xa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Cma(){An.AGb||(An.AGb=Xa.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return An.AGb.instance}static get BKa(){return null!=An.jXg?An.jXg:An.jXg=Xa.a.instance.resolve("Box4.IContentControlViewElementManager")}}An.Qo=null;An.AGb=null;Object(u.a)(An,"ADeleteParagraphContentStrategy",null,[]);var uG=e(234);class PA extends An{constructor(){super()}get Ug(){return null!=
this.pXg?this.pXg:this.pXg=Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get ht(){return null!=this.hXg?this.hXg:this.hXg=Xa.a.instance.Za("Box4.ContentControlConfigSettings")}get muc(){return null!=this.b6g?this.b6g:this.b6g=Xa.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get v8(){return null!=this.VXg?this.VXg:this.VXg=Xa.a.instance.resolve("Box4.IContentControlChpHelper")}get XV(){return null!=this.F_g?this.F_g:this.F_g=Xa.a.instance.resolve("Box4.IFieldEditor")}uji(b,h){this.mWl(b,
h)}Y9k(b,h,r,A){this.ht.instance&&this.ht.instance.ii&&(b.cpBegin===h.cpBegin?b.Ob=h.Ob:r&&(b.Ob=r.Qb&&r.Qb.length?0:-1),b.nc=A)}vMb(b){If.a.vMb(b)}mWl(b,h){var r=b.node;const A=uG.b([new cd.a(b.cpBegin,b.cpEnd)],this.qWm(b));var L=new kb.a,ba=[];PA.RAl(r,A,L,ba);for(const ra of L.keys)1<L.K(ra)&&mB.a.uoj(V.a.Of(ra));this.eGo(r,ba);this.muc.uYc(r);r=b.nc;L=!!this.ht.instance&&this.ht.instance.ii;for(ba=A.length-1;0<=ba;ba--)r=this.deleteRange(b,A[ba],r,L,h)}qWm(b){const h=[],r=b.node;var A=kp.f(r,
ra=>ra.mma);for(var L of A)A=L.Rb.cp,h.push(new cd.a(A,A+1));L=[];ap.a.kN?this.XV&&(L=this.XV.MMf(r,b)):L=rd.ParagraphReader.jYa(r);for(var ba of L)this.cvn(ba,b)&&h.push(ba);ba=!!this.ht.instance&&this.ht.instance.wva;this.ht.instance&&this.ht.instance.ii||!ba||!r.Iy||(PA.ebi&&PA.ebi.bFo(b),this.v8&&h.push(...this.v8.aBi(r).toArray()));return uG.a(h)}cvn(b,h){return ap.a.kN?this.XV?!this.XV.g1i(b,h):!1:!b.WO||!PA.o1f(b,h)}eGo(b,h){const r=new Cb.a;for(const A of h)for(h=0;h<A.length;){h=this.dFi(A,
h,0);if(-1===h)break;let L=this.dFi(A,h+1,3);if(-1===L)break;if(A.K(h).WO)for(;L>=h;){const ba=A.K(L);r.add(ba.Re);A.aO(ba);L--}h=L+1}b.tpa(r)}dFi(b,h,r){for(;h<b.length;h++){const A=b.K(h);if(1===A.Iu&&A.ze===r)return h}return-1}deleteRange(b,h,r,A,L){const ba=h.Mc,ra=h.end;h=null;A&&(h=b.node.ra.Vh(ba));ba<ra&&(A=vc.a.createTextRange(b.node,ba,ra),ap.a.jsb&&(A.Tga=b.Tga,A.dua=b.dua),this.Y9k(A,b,h,r),this.Ug.lf(A,"",void 0,void 0,fb.a.FWc,!1,L));return r=h&&h.Qb&&h.Qb.length?h.Qb.length:-1}static get ebi(){return null!=
PA.eYg?PA.eYg:PA.eYg=Xa.a.instance.Wa("WordEditor.ContentControl.IContentControlOperator")}static o1f(b,h){return b.Mc>=h.cpBegin&&b.end<=h.cpEnd}static RAl(b,h,r,A){let L=0;b=b.ra;for(const ba of h)for(;L<b.length;){h=b.jc(L);if(h.cp>=ba.Mc&&h.cp<ba.end&&(h.Fc&&h.Fc.HFl&&A.push(h.Fc),h.Oi))for(let ra=0;ra<h.Oi.length;ra++){const Ia=h.Oi.K(ra).Ap.toString();r.Bb(Ia)?r.W(Ia,r.K(Ia)+1):r.W(Ia,1)}++L}}}Object(u.a)(PA,"DeleteParagraphContentStrategy",An,[]);class QM{static get LK(){return fN.a.instance}static tXl(b,
h,r){if(1===r)return 32;b=h.node;return QM.LK.RXd(b)?is.XWl(b,r):32}}Object(u.a)(QM,"DeleteUnsupportedObjectStrategy",null,[]);var mE=e(868),uO=e(466);class gN{constructor(b,h,r,A,L){this.KMp=b;this.bea=r;this.Ed=A;this.actionId=h;this.Zwd=L}}Object(u.a)(gN,"DeleteActionData",null,[]);class Ii{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.vji=b;this.Ig=h;this.LK=r;this.Gs=A;this.O1=L;this.gh=ba;this.fxj=ra;this.Ug=Ia;this.Yd=Ta;this.BKa=ob}$up(b){return!Ee.a.Rm(b)&&!Ee.a.Tha(b)}VQm(b,h,r){var A;let L,
ba,ra;if(!h&&b&&b.xy&&(A=b.Ya)&&Ee.a.Df(A)&&this.gh.lc(A.node)&&(L=A.node.ra.Vh(A.cpBegin))&&L.Qp&&(ba=this.Wrm(L))&&ba.hyperlink.hK&&(ra=this.JQm(b,ba.cp)))return ra;if(!b)return null;if(A=this.Syp(b,h))return A;if(!r)return b;h=Ee.a.X$a(b,!h,{FG:!1,gw:!0,NI:!0,JK:!0});return Tb.SelectionFactory.SA(b,h.Ya,!1)}Wrm(b){const h=b.paragraph.ra;let r=null;b=b.cp;for(let A=0;A<h.length;A++){const L=h.jc(A);if(L.cp>=b)break;L.Qp&&(r=null);L.hyperlink&&(r=L)}return r}MQm(b,h){var r=b.Ya.node;if(h){if(h=Ee.a.A2a(b.Ya.node,
b.Ya.cpBegin,!0),b=Tb.SelectionFactory.SA(b,vc.a.jd(b.Ya.node,h),!1),r=r.ra.Vh(h),r.Vha||r.p9)b.Ya.Ob=0}else if(h=Ee.a.A2a(b.Ya.node,b.Ya.cpBegin,!1),b=Tb.SelectionFactory.SA(b,vc.a.jd(b.Ya.node,h),!1),r=r.ra.Vh(h),r.Vha||r.p9)b.Ya.Ob=r.hD+r.l_;b.Cqc=!0;return b}Syp(b,h){var r=b.Ya;let A=null;if(!b.xy||!r||!Ee.a.Df(r))return null;if(this.gh.lc(r.node)&&(A=h?r.node.ra.Vh(r.cpBegin):r.node.ra.ptb(r.cpBegin-1))&&A.oW)return this.MQm(b,h);r=te.a.kb(b.Ya.node);if(!r.Ib(8))return null;hg.a.xe(r);let L=
!1;const ba=[];if(h?A&&A.Ui:0===b.Ya.cpBegin){do(b=h?hg.a.Fu(r,!0,!0,!1):hg.a.D5(r,!0,!0,!1))&&(null===b||void 0===b?0:b.dZa)?(ba.push(vc.a.create(hg.a.Ze(r))),hg.a.xe(r)):L=!0;while(!L);if(0<ba.length)return h=new Fl.Selection(h?ba:ba.reverse(),h),h.Cqc=!0,h}return null}JQm(b,h){var r=Ee.a.jMa(b,{FG:!1,gw:!1,NI:!0,JK:!0});if(!r||!r.xy||r.Ya.node!==b.Ya.node)return null;r=r.Ya;if(r.cpBegin!==r.cpEnd)return null;const A=this.gh.text(r.node);for(let L=r.cpBegin-1;L>=h;L--)if(!D.a.Py(A.charCodeAt(L)))return Tb.SelectionFactory.SA(b,
vc.a.jd(r.node,L+1),!1);return Tb.SelectionFactory.SA(b,vc.a.jd(r.node,h),!1)}Bzf(b,h,r,A,L){var ba,ra;if(1===r)return 32;(r=null===(ra=null===(ba=h.view)||void 0===ba?void 0:ba.ub)||void 0===ra?void 0:ra.hh)&&Object(ak.a)().Uhi(r).filter(rd.ParagraphReader.uZ).forEach(Ia=>{var Ta;return null===(Ta=rd.ParagraphReader.GMa(Ia.node))||void 0===Ta?void 0:Ta.VBe("delete_selection")});ra=!1;b===fb.a.Qxf?(b=fb.a.WJ,ra=!0):b===fb.a.H1d?(b=fb.a.backspace,ra=!0):b===fb.a.uCa&&(h=new iv.a(Db.StaticActiveAppFrame.Aa().tb.Xc));
if(!h.view.Ee)return 2;tx.a.instance.dC(!1);ba=b===fb.a.WJ;r=Js.a.U5c(h);if(ra&&this.Ig.ii&&r&&Ee.a.qn(r)&&this.Ig.G2f(r.Ya,!ba,!0))return 2;ra=this.VQm(r,ba,ra);return this.vXl(b,h,A,L,ra,ba)}vXl(b,h,r,A,L,ba){var ra;const Ia=h.view,Ta=Ia.ub;var ob=A,nb=A;b===fb.a.uCa&&(nb=ob=null,L=new Fl.Selection(A,!0));if(!L)return 32;const Eb=this.U9o(ob,ba);if(this.Ig.ii&&Ii.Cma&&1===Ta.ob.length&&Ee.a.qn(L)&&L.xy&&Ii.Cma.aVo(L.Ya,ba)||ap.a.kN&&Ii.XV&&1===Ta.ob.length&&Ee.a.qn(L)&&L.xy&&Ii.XV.bVo(L.Ya,ba))return 32;
let bc;ba?Yb.a.mark(bc=5009):Yb.a.mark(bc=5011);ob=new hb.GraphTransaction(15);ob.Bh=b;ob.Eb(Ia.Fd);let Bc=null,Yc=({nTo:Bc}=this.aum(b,A,Ta,L,Bc)).returnValue;var zd=null;({BDe:zd}=Object(ak.a)().yHg(Yc)).returnValue&&(Yc=zd);if(!Yc)return ob.dispose(),32;zd=!1;y.AFrameworkApplication.ud("b1jb9393;09icj321");if(null===(ra=y.AFrameworkApplication.J)||void 0===ra?0:ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ra=Yc.node,zd=null===ra||void 0===ra?void 0:ra.Iy;
const Jd=new gN(h,b,r,nb,zd);nb=null;this.Ig.ii&&Ii.Cma&&(nb=Object(ak.a)().IQ(Yc),Ii.Cma.pHj(nb));ap.a.kN&&ap.a.i$a&&Ii.XV&&1===Ta.ob.length&&!Ee.a.qn(L)&&(nb||(nb=Object(ak.a)().IQ(Yc)),Ii.XV.fFo(nb));this.U7j(Yc);const ie=this.Txi(Yc,L,ba);let re=null;ba?re=new mE.a(L):ie&&(re=new mE.a(ie));let me=!1;nb=Ii.Om;if(Ee.a.Df(Yc)){const Sd=jF.a.Omc(Ia.Fd,Eb);nb.Ae(()=>{this.hWl(h,r,A,Yc,ba,re,L,Sd,Ta,Eb,Jd,ie)},"DVS:DAIPC")}else this.Yd.Zg&&!this.BKa.gje(L)?(nb.Ae(()=>{this.Zup(b,Ia.Fd,Yc,ba,L,Ta,Eb,
Jd,re)},"DVS:TCDC"),me=!0):nb.Ae(()=>{me=this.yyj(b,Ia.Fd,Yc,Ta,Eb,Jd,re,Bc)},"DVS:PUD");this.qgm(Ta);this.gMj(Yc);ob.dispose();Yb.a.mark(bc+1);return b===fb.a.uCa?me?32:8:32}yyj(b,h,r,A,L,ba,ra,Ia){h=jF.a.Omc(h,L);this.$up(r)&&h.Ehb(r);b=Ii.Jc.vr(b);b.properties.W("CountOfParagraphsDeleted",this.gh.vvf(r).toString());r=this.H0l(r,A,L,h,ba,ra,Ia);b.end();return r}Zup(b,h,r,A,L,ba,ra,Ia,Ta){var ob=0,nb=null;const Eb=Object(ak.a)().IQ(r),bc=Eb[Eb.length-1];if(bc.contextId===ic.a.paragraph||bc.contextId===
ic.a.od){var Bc=te.a.kb(bc.node);Bc.Wd();hg.a.xe(Bc);hg.a.Fu(Bc,!0,!1)&&(nb=hg.a.Ze(Bc))&&(ob=this.gh.textLength(nb))}else ob=this.gh.textLength(bc.node)-bc.cpEnd;Bc=Object(ya.a)(66,Ia.Ed);if(Bc=!!Bc&&Bc.ka(Kh.a.I0f,!1))this.wyj(b,h,r,ba,ra,Ia,Ta,!1,Bc);else{Bc=this.Yd.I8a();try{this.wyj(b,h,r,ba,ra,Ia,Ta,!0)}finally{Bc&&Bc.dispose()}}if(L.Cqc)ob=this.Txi(r,L,A),this.gh.lc(ob.Ya.node)&&Fg.a.instance.Uc(ob);else{if(A){if(r.My){b=Eb.length-1;do L=Eb[b],b--;while(!L.node.isConnected&&0<=b)}else L=r;
if(!this.gh.lc(L.node))return;switch(bc.contextId){case ic.a.paragraph:case ic.a.od:ob=nb&&nb.isConnected?0:ob;break;case ic.a.kd:case ic.a.Nd:break;default:ob=0}ob=Tb.SelectionFactory.Ie(L.node,this.gh.textLength(L.node)-ob);L.Uj===ob.Ya.cpBegin&&(ob.Ya.Ob=L.Ob)}else{ob=L.Ya.node;if(!this.gh.lc(ob))return;nb=L.Ya.contextId===ic.a.paragraph?0:L.Ya.contextId===ic.a.od?this.gh.textLength(ob):L.Ya.cpBegin;ob=Tb.SelectionFactory.Ie(ob,nb)}Fg.a.instance.Uc(ob)}}wyj(b,h,r,A,L,ba,ra,Ia,Ta=!1){r=this.Lkm(A,
r);r=Ii.Ni.std(r);({type:nb}=r.bce()).returnValue&&Ia&&4!==nb&&this.Yd.Vv(nb);for(Ia=r.length-1;0<=Ia;--Ia){var ob=void 0;var nb=({Qje:ob}=r.getContext(Ia)).returnValue;ob?(ob=Ta&&nb.contextId===ic.a.od&&Ia===r.length-1,this.Gs.cyb(nb,2),ob||Ii.lk.bBb(nb,2)):this.yyj(b,h,nb,A,L,ba,ra,null)}}Lkm(b,h){if(Object(Pb.a)(Yi.a,h)){b=Rh.OutlineElementGeneralizer.lna(b.ob,!0);for(let r=0;r<b.length;r++)if(b.getContext(r).contextId===ic.a.table)return b}return h}aum(b,h,r,A,L){b===fb.a.uCa?(b=Mt.a.iCa(h),L=
uO.a.instance.tPb()):(L=null,b=1===r.ob.length?Fg.a.oPb(A):r.hh);return{returnValue:b,nTo:L}}xrl(b){return!b.nm||b.contextId!==ic.a.paragraph||!this.gh.lc(b.node)||this.Yd.Zg||this.Ig.Gie(b)?!1:!0}U7j(b){if(b.My)for(let h=0;h<b.length;h++)this.U7j(b.getContext(h));else this.xrl(b)&&(b.node.SXd=!0)}gMj(b){if(b.My)for(let h=0;h<b.length;h++)this.gMj(b.getContext(h));else b.nm&&(b=b.node)&&this.gh.lc(b)&&(b.SXd=!1)}Txi(b,h,r){if(b.nm&&Ee.a.Df(b)&&!r){const A=b.node;let L=b.cpBegin,ba=-1;if(({cp:L}=this.Ig.wkj(A,
L)).returnValue)return Tb.SelectionFactory.Ie(A,L);if(({cp:L,lta:ba}=this.Ig.vkj(b,L,ba)).returnValue)return h=Tb.SelectionFactory.Ie(A,L),h.Ya.Ob=ba,h.Ya.nc=ba,h}h=Ee.a.X$a(h,!r,{FG:!h.Cqc||h.xy,gw:!1,NI:!1,JK:!0,FBa:Ee.a.qn(h)});this.Ig.ii&&Ee.a.Rm(b)&&(h.Ya.nc=h.Ya.Ob=r?b.nc:b.Ob);return h}hWl(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb){const bc=Ii.Om;!Ee.a.RC(A.node,A,L)||this.Ig.ii&&this.Ig.V2i(A)?bc.Ae(()=>{this.PWl(A,L,ba,ra,Ia,Ta,ob,nb)},"DVS:IPM"):bc.Ae(()=>{const {response:Bc,j6:Yc}=this.OWl(b,h,r,
A,L,ra,Ia,Ta,nb,Eb);Ii.Omj(Ia,32===Bc);Yc&&Ii.qxa(Ta,ba)},"DVS:ISE")}E1m(b,h){h.Ed||(h.Ed=new Ai.DictionaryPropertySet);h.Ed.setValue(Kh.a.bwa,"delete");h.Ed.setValue(Kh.a.Aoa,"backspace");var r=nf.a.Qe?b:b.eG;const A=Ii.Vd.P4(r),L=pv.WEn;if(null===L||void 0===L?0:L.Bxn(r,A)){h.Ed.setValue(Kh.a.Aoa,"backspace-autocorrect");r=L.E8j+" ";const ba=vc.a.jd(b,0);this.Ug.lf(ba,r);r=Tb.SelectionFactory.Ie(b,r.length);Fg.a.instance.Uc(r);v.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",
L.E8j)}return qh.a.getInstance().Uxn?(b=this.aOf(b),h=Ii.Vd.GEm(b),Ii.om.k$(b),Ii.om.mPo(b,h),32):y.AFrameworkApplication.va.Sf(h.KMp,A.NB?fb.a.KP:fb.a.FF,2,!1,h.bea,h.Ed)}$0m(b,h,r,A,L){let ba=!1;0<this.fxj.M4(b).ww&&(L=y.AFrameworkApplication.va.Sf(h,fb.a.Vxc,2,!1,r,A),ba=!0);return{gZ:ba,response:L}}g1m(b,h,r,A,L){let ba=!1;0<this.fxj.cK(b).ww&&(L=y.AFrameworkApplication.va.Sf(h,fb.a.Ynd,2,!1,r,A),ba=!0);return{gZ:ba,response:L}}k2m(b,h,r,A,L){let ba=!1;Ii.Hs.fOb(b)&&(L=y.AFrameworkApplication.va.Sf(h,
fb.a.uK,2,!1,r,A),ba=!0);return{gZ:ba,response:L}}L_m(b,h,r,A,L,ba,ra,Ia,Ta,ob){const nb=new Oi.a;nb.Ad(h);let Eb=!1;if(hg.a.EOa(nb,!1,!b,!1)){ob=!0;Ta=32;Eb=!0;(new te.a).Ad(nb);hg.a.Ze(nb);const Bc=nb.currentNode;rd.ParagraphReader.WBa(Bc)&&rd.ParagraphReader.GMa(Bc).VBe("delete_ip");var bc=new te.a;bc.set(ra);(bc=this.gh.isEmpty(bc))&&L&&Ee.a.Zca(L.Ya)?(r.Ehb(ba),hg.a.Ze(h),Ii.Yf.hxa(h.currentNode)):Bc.zN?(r.Ehb(ba),hg.a.xe(nb),nb.qh()):b&&bc?this.Ig.D5i(ra)&&!({j6:ob}=this.EBj(b,ra,Bc,L,ob)).returnValue&&
(r.Ehb(ba),Ii.om.aja(h),this.vji.Amo(ra),h.qh()):Qh.TableReader.isTable(nb)?(r.Ehb(ba),b&&(Lh.l(nb),Lh.k(nb),hm.OutlineNavigator.zda(nb),hg.a.Ze(nb),Ia.Uc((new mE.a(Tb.SelectionFactory.Ie(nb.currentNode,0))).restore())),Ta=2,ob=!1):this.gh.lc(Bc)&&(1==this.gh.textLength(Bc)&&(Ia=kp.e(Bc),1==Ia.length&&8==Ia[0].xi&&(Ia=vc.a.createTextRange(Bc,0,1),this.Ug.lf(Ia,"",void 0,void 0,fb.a.FWc))),({j6:ob}=this.EBj(b,ra,Bc,L,ob)).returnValue||(A.actionId==fb.a.backspace&&r.eDc(ra),this.vji.iWl(b,r,ba,h,ra,
nb)))}return{gZ:Eb,response:Ta,j6:ob}}EBj(b,h,r,A,L){if(this.Yd.Zg){if(Ii.GWa){const ba=Object(Pb.a)(wm.AParagraphNode,r)?Ii.GWa.Hie(r):!1,ra=Object(Pb.a)(wm.AParagraphNode,h)?Ii.GWa.Hie(h):!1;if(ba!==ra)return{returnValue:!1,j6:L}}b=b?h:r;if(!Object(Pb.a)(wm.AParagraphNode,b))return{returnValue:!1,j6:L};h=b.ra.last;r=y.AFrameworkApplication.userName;if(!h.Dj||h.Dj.authorName!==r)return Ii.lk.E2b(b,2),A&&(Fg.a.instance.Uc(A),L=!1),{returnValue:!0,j6:L}}return{returnValue:!1,j6:L}}w1m(b,h,r,A,L,ba,
ra,Ia){Mb.a.Oqn(h,b)||({response:ra,j6:Ia}=Ii.D1l(r,A,b,ba,L,ra,Ia));return{gZ:!1,response:ra,j6:Ia}}OWl(b,h,r,A,L,ba,ra,Ia,Ta,ob){let nb=!1,Eb=2;const bc=A.node;let Bc=void 0,Yc=!1;const zd=Ii.Om;if(!L){if(nf.a.Qe?nf.a.isListItem(bc):bc.eG)return zd.Ae(()=>{Eb=this.E1m(bc,Ta)},"DVS:HLOE"),{response:Eb,j6:nb};zd.Ae(()=>{({response:Eb,gZ:Yc}=this.$0m(bc,b,h,r,Eb))},"DVS:HIOD");if(Yc)return{response:Eb,j6:nb};zd.Ae(()=>{({response:Eb,gZ:Yc}=this.g1m(bc,b,h,r,Eb))},"DVS:HWPF");if(Yc)return{response:Eb,
j6:nb};Bc=this.aOf(bc);zd.Ae(()=>{({response:Eb,gZ:Yc}=this.k2m(Bc,b,h,r,Eb))},"DVS:HPOB");if(Yc)return{response:Eb,j6:nb}}null!==Bc&&void 0!==Bc?Bc:Bc=this.aOf(bc);zd.Ae(()=>{({response:Eb,gZ:Yc,j6:nb}=this.L_m(L,Bc,ra,Ta,ob,A,bc,Ia,Eb,nb))},"DVS:HAOE");if(Yc)return{response:Eb,j6:nb};zd.Ae(()=>{({response:Eb,gZ:Yc,j6:nb}=this.w1m(L,Bc,h,r,ra,ba,Eb,nb))},"DVS:HFLOE");return{response:Eb,j6:nb}}c$o(b){return Ee.a.Rm(b)||this.LK.e9i(b)||Ee.a.Tha(b)}U9o(b,h){return b&&b.hasProperty(Pd.a.s1c)?!b.ka(Pd.a.s1c,
!1):!h}static get Vd(){return null!=Ii.I5g?Ii.I5g:Ii.I5g=Xa.a.instance.resolve("Box4.List.IListReader")}static get om(){return null!=Ii.y5g?Ii.y5g:Ii.y5g=Xa.a.instance.resolve("Box4.List.IListEditor")}static get Yf(){return null!=Ii.H6g?Ii.H6g:Ii.H6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Hs(){return px.a.hTb}static get lk(){return null!=Ii.Z$g?Ii.Z$g:Ii.Z$g=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ni(){return null!=Ii.Iah?Ii.Iah:
Ii.Iah=Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Jc(){return $g.a.instance}static get Cma(){Ii.AGb||(Ii.AGb=Xa.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return Ii.AGb.instance}static get XV(){Ii.TIf||(Ii.TIf=Xa.a.instance.Za("Box4.IFieldEditor"));return Ii.TIf.instance}static get GWa(){return null!=Ii.hYg?Ii.hYg:Ii.hYg=Xa.a.instance.Wa("Box4.IContentControlReader")}static get drn(){var b;y.AFrameworkApplication.ud("fontfix;fontfix-cf");
return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.fontFixIsEnabled",!1)}static get Om(){return mp.a.instance}qgm(b){if(1===b.ob.length&&(b=b.ob.K(0),Ee.a.qn(b))){var h=b.Ya;b=h.node;h=h.cpBegin;var r=this.gh.text(b);h<r.length&&0<h&&" "===r.charAt(h-1)&&" "===r.charAt(h)&&this.Ug.lf(vc.a.createTextRange(b,h-1,h),"\u00a0")}}qil(b,h){if(!h.hyperlink.Lqc){const r=new hb.GraphTransaction(15);try{r.Eb(b.node),this.O1.YZ(b,h)}finally{r&&
r.dispose()}h.hyperlink.hK&&this.Yd.Vv(2)}}static D1l(b,h,r,A,L,ba,ra){if(r=Ee.a.X$a(A,!r,{FG:!1,gw:!1,NI:!1,JK:!0})){A=Tb.SelectionFactory.SA(A,r.Ya);ba=32;for(r=0;r<A.length;++r){L.Ehb(A.K(r));const Ia=y.AFrameworkApplication.va.Sf(A.K(r),fb.a.WJ,2,!0,b,h);2!==Ia&&(ba=Ia)}32===ba&&(ra=!0)}return{response:ba,j6:ra}}H0l(b,h,r,A,L,ba,ra){let Ia=!1;this.d$o(b)?(Ia=Ii.VAf(b,!0,h,r,A,L))&&Ii.wRa(ba,h,ra):this.c$o(b)?(Ia=Ii.VAf(b,!1,h,r,A,L))&&Ii.wRa(ba,h,ra):(A.normalize(),Ii.wRa(ba,h,ra));return Ia}static wRa(b,
h,r){r&&r.qxa()||Ii.qxa(h,b)}static VAf(b,h,r,A,L,ba){var ra;A||il.a.UZa(b)||(r=Ii.zDc(r))&&L.m6o(r);y.AFrameworkApplication.ud("b1jb9393;09icj321");if(null===(ra=y.AFrameworkApplication.J)||void 0===ra?0:ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ba.Ed?ba.Ed.Zwd=ba.Zwd:ba.Ed={Zwd:ba.Zwd};ra=b instanceof Yi.a?b.getContext(0).node:b.node;this.drn&&(b instanceof Yi.a&&0<b.length?(r=b.getContext(0),A=b.getContext(b.length-1),r.contextId==ic.a.paragraph&&A.contextId==
ic.a.paragraph&&r.node.id.toString()==this.Ose.Wkc().id&&A.node.id.toString()==this.Ose.Ydd().id&&this.Q2.wYc(ra,!0)):b.contextId==ic.a.paragraph&&b.node.id.toString()==this.Ose.Wkc().id&&b.node.id.toString()==this.Ose.Ydd().id&&this.Q2.wYc(ra,!0));ra=Ii.TJm(ra);b=32===y.AFrameworkApplication.va.Sf(b,ba.actionId,2,h,ba.bea,ba.Ed);Ii.Omj(L,b,ra);return b}static get Qj(){return null!=Ii.u0g?Ii.u0g:Ii.u0g=Xa.a.instance.resolve("Box4.IFormattingEditor")}static get KBb(){return null!=Ii.A9g?Ii.A9g:Ii.A9g=
Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Q2(){return null!=Ii.w9g?Ii.w9g:Ii.w9g=Xa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Ose(){return null!=Ii.j7g?Ii.j7g:Ii.j7g=Xa.a.instance.resolve("Box4.IParagraphCollection")}static TJm(b){const h=new wp.a;if(b){let r=null;b=Tb.SelectionFactory.zq(b,!0);if(!b)v.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let A=0;A<b.length;A++)if(pb.a.nuf(b.K(A))){r=b.K(A);break}r&&((b=pb.a.uu(r))&&b.cache&&
b.cache.tG&&(b=b.og(null),Ii.Qj.j$(b)),b&&(h.formatting=b.ol,h.languageId=pb.a.language(b)),h.Cqa=Ii.KBb.Lr(r.node))}return h}static Omj(b,h,r){h?b.normalize(r):b.cancel()}static qxa(b,h){h&&Ii.Om.Ae(()=>{const r=h.restore();r&&b.Uc(r)},"DVS:RS")}PWl(b,h,r,A,L,ba,ra,Ia){let Ta;!h&&({hyperlink:Ta}=this.O1.Qqc(b)).returnValue?(r=new mE.a(A),this.qil(b,Ta),L.normalize(),Ii.qxa(ba,r)):Ii.VAf(b,!1,ba,ra,L,Ia)&&(h&&this.Yd.Zg?(h=Ii.lk.L0d)?(ba.Uc(Tb.SelectionFactory.Ie(b.node,h)),Ii.lk.L0d=null):Ii.qxa(ba,
r):Ii.qxa(ba,r))}d$o(b){return b.My||il.a.UZa(b)||this.gh.Xn(b)}static zDc(b){return(b=Rh.OutlineElementGeneralizer.lna(b.ob,!0))&&1===b.length&&(b=b.getContext(0).node,Qh.TableReader.pP(b))?b:null}aOf(b){const h=new te.a;h.set(b);h.Wd();hg.a.xe(h);return h}}Ii.AGb=null;Ii.TIf=null;Object(u.a)(Ii,"ADeleteViewStrategy",null,[]);class yw{iWl(b,h,r,A,L,ba){const ra=ba.currentNode;hg.a.xe(ba);b?(h.eDc(ba.currentNode),yw.Ig.l4i(r,L,ra,!1)||yw.Yf.merge(A,ba,!1,!1)):yw.Ig.l4i(r,ra,L,!0)||yw.Yf.merge(ba,
A,!1,!1)}Amo(b){b&&rd.ParagraphReader.lc(b)&&(NF.a.Tnd(b),yw.nCf.jkf(b))}static get Yf(){return null!=yw.D6g?yw.D6g:yw.D6g=Xa.a.instance.resolve("Box4.IOutlineElementEditor")}static get nCf(){return null!=yw.fZg?yw.fZg:yw.fZg=Xa.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Ig(){return Ke.a.instance}}Object(u.a)(yw,"DeleteParagraphNodeStrategy",null,[329]);class hN extends Ii{constructor(b,h,r,A,L,ba,ra,Ia,Ta){super(new yw,b,h,r,A,L,ba,ra,Ia,Ta)}}Object(u.a)(hN,"DeleteViewStrategy",Ii,
[]);class qM extends is{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb){super();this.deleteParagraph=(bc,Bc)=>{bc=Bc.node;NF.a.Tnd(bc);this.CDd.jkf(bc);this.Tp&&this.Tp.instance&&this.Tp.instance.fsj(bc);bc.Iy&&(this.wn.aFo(bc,!this.ii),this.ii&&this.Aoh.instance&&this.Aoh.instance.sbk(bc));return 0};this.gWl=(bc,Bc,Yc)=>{if(1===Yc)return 32;bc=Db.StaticActiveAppFrame.Aa().Kt.rg("ModelUpdate","DeleteAnchoredObject");Bc=Bc.node;Yc=new te.a;Yc.set(Bc);Yc.Ib(12);var zd=Yc.Gq(12);if(Ke.a.instance.mcd(zd))return 2;
If.a.vMb(zd);zd=new hb.GraphTransaction(7);zd.Eb(Bc);Yc.qh();zd.dispose();bc.stop();return 32};this.ezk=new PA;this.gzk=new hN(Ke.a.instance,fN.a.instance,ba,ra,Ia,Ta,ob,nb,Eb);this.wn=b;this.MKc=h;this.Aoh=r;this.CDd=A;this.Tp=L}get ii(){return this.MKc.instance?this.MKc.instance.ii:!1}get Fji(){return this.gzk}get tji(){return this.ezk}qug(b,h,r,A){const L=QM.tXl,ba=this.gWl;b.qa(fb.a.backspace,ic.a.Fba,ba);b.qa(fb.a.backspace,ic.a.oRa,L);b.qa(fb.a.WJ,ic.a.Fba,ba);b.qa(fb.a.WJ,ic.a.oRa,L);b.qa(fb.a.backspace,
ic.a.paragraph,this.deleteParagraph);b.qa(fb.a.WJ,ic.a.paragraph,this.deleteParagraph);b.qa(fb.a.uCa,ic.a.paragraph,this.deleteParagraph);b.Oc(fb.a.uCa,64);super.qug(b,h,r,A)}static vMb(b){var h;(null===(h=If.a.Gd())||void 0===h?0:h.pn)&&If.a.Gd().Qk.uI(b)}}Object(u.a)(qM,"DeleteActor",is,[]);class wL{constructor(){this.Height=this.Width=0}static construct(b,h){const r=new wL;r.Width=b;r.Height=h;return r}}Object(u.a)(wL,"ViewportInfo",null,[]);class rM extends $f.a{constructor(){super();this.ContractVersion=
0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Hn(){return mK.a.$np}static construct(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){const Eb=new rM;Eb.ContractVersion=b;Eb.DocumentContent=h;Eb.EnhancementId=r;Eb.World=A;Eb.ScalingFactor=L;Eb.DesktopViewportInfo=wL.construct(ba,ra);Eb.MobileViewportInfo=wL.construct(Ia,Ta);Eb.MinParagraphCount=ob;Eb.ContentCulture=nb;return Eb}}Object(u.a)(rM,
"SwayPreviewRequest",$f.a,[]);var sM=e(616);class mC{static get Fh(){return Xf.a.iA(mC.CZl,WacWordeditorStrings.DigitalPrintLearnMore,WacWordeditorStrings.DigitalPrintDialogStyleLabel,WacWordeditorStrings.DigitalPrintDialogPreviewLabel,mC.jSo,WacWordeditorStrings.SavingStatus)}}mC.jSo=Rl.a.kh("progress.gif");mC.CZl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(u.a)(mC,"DigitalPrintDialogHtml",null,[]);class Ku{constructor(b,h,r,A){this.fontFamily=b;this.UOo=h;this.fontWeight=r;this.fontStyle=A}}Object(u.a)(Ku,"FontInfo",null,[]);class Kr{constructor(b,h,r,A){this.styleName=b;this.title=h;this.Tsp=r;this.q6m=A}}Object(u.a)(Kr,"StyleVisualInfo",null,[]);class nC extends Xf.a{constructor(b,h,r,A,L=!0){super();this.Gaa=this.Bn=this.Pra=this.E7=this.eGd=this.oMh=this.eRd=this.Bcf=this.Ccf=this.Tbf=this.idc=this.WUa=this.P7=this.Acc=null;this.vff=this.$8e=
!1;this.WEd=null;this.N2l=()=>{this.oPj(0)};this.M2l=(ba,ra)=>{this.oPj(ra)};this.Duj=ba=>{this.QFi(ba)===Sys.UI.Key.enter&&(this.Lkg(ba),ba.preventDefault(),ba.stopPropagation())};this.xqj=ba=>{((ba=ba.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ba.id||ba.id===kg.a.xzd)||X.a.Zt)&&this.WUa&&this.e2b(this.WUa)};this.yqj=ba=>{const ra=this.QFi(ba);ra!==Sys.UI.Key.tab&&ra!==Sys.UI.Key.left&&ra!==Sys.UI.Key.right&&ra!==Sys.UI.Key.up&&ra!==Sys.UI.Key.down||this.P2m(ra)||(ba.preventDefault(),
ba.stopPropagation(),this.j5n(ra))};this.Sig=()=>{this.vff||(this.vff=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Re.a.removeHandler(this.P7,Fd.a.scroll,this.Sig))};this.wjg=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.Lkg=ba=>{ba.preventDefault();ba.stopPropagation();y.AFrameworkApplication.va.Vb(fb.a.Xki,2);ba.target?(ba="button"===ba.target.tagName.toLowerCase()?ba.target:ba.target.parentNode)&&ba.id!==this.Acc&&(v.ULS.sendTraceTag(25231813,382,
50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.Acc,ba.id),this.H5h(ba),this.zfi()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.l_l=ba=>{const ra=(new Date).getTime()-this.ekh;ei.a.instance.Gf(th.a.n_l,ra);ba?this.tXo():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),y.AFrameworkApplication.va.Vb(fb.a.Wki,2))};this.rXo=()=>
{this.Rfp();try{const ba=nC.ymi.Cam(),ra=rM.construct(2,ba,this.Acc,"VerticalWorld",.3,1366,600,330,280,20,nC.ymi.Mjb.name);y.AFrameworkApplication.pe.addRequest(String.format("{0}/we/GetSwayPreview.ashx?{1}",Ze.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,sM.b(ra),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.Jno,this.RAj,ra)}catch(ba){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ba.message)}};this.Jno=
ba=>{var ra=null;({group:ra}=lm.a.A6(ba.data.responseData)).returnValue?(ra=ra.Responses[0],ra.Succeeded?(this.Ule(ba.data,th.a.aop),this.Qpb(),this.aVj(this.Bcf,ra.PreviewHtml),this.aVj(this.eRd,ra.PreviewHtmlMobile)):this.RAj(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.RAj=()=>{this.Sfp();this.Ccf.style.background="#E6E6E6";this.oMh.style.background="#E6E6E6"};this.Fh=mC.Fh;this.$g="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.fQk=WacWordeditorStrings.DigitalPrintTransformSlab;this.D8b=WacWordeditorStrings.DigitalPrintButtonTransform;this.tVk=r;this.iKc=A;this.Ue(1,this.fQk);this.ti(this.D8b,this.l_l,null);this.Kdn();this.Gmp();this.ekh=(new Date).getTime();L&&Pw.a.rT(xw.a.zAf,!1,this.N2l,this.M2l,null);this.Xen();this.hcn();this.vIn();this.i9f();this.mIn();this.zfi()}get TCa(){return this.WEd}oPj(b){if(!this.$8e){const h=(new Date).getTime()-
this.ekh;ei.a.instance.Gf(th.a.m_l,h);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",hr.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.S8a.disabled=!1}}Kdn(){this.idc=document.getElementById("digitalPrintStatusMessageDiv");this.Tbf=document.getElementById("digitalPrintStatusMessageIconDiv");this.Ccf=document.getElementById("swayDesktopPreviewWrapperDiv");
this.Bcf=document.getElementById("swayDesktopPreviewHtmlHolder");this.eRd=document.getElementById("swayMobilePreviewHtmlHolder");this.oMh=document.getElementById("swayMobilePreviewWrapperDiv");this.P7=document.getElementById("swayGallery");this.P7.setAttribute("tabindex","0");Re.a.addHandler(this.P7,Fd.a.scroll,this.Sig);this.P7.setAttribute(le.a.fi,le.a.AZh);this.E7=document.getElementById("digitalPrintLearnMoreLink");this.E7.href="https://go.microsoft.com/fwlink/?linkid=871972";Re.a.addHandler(this.E7,
Fd.a.click,this.wjg);this.Pra=new Cb.a;this.eGd=document.getElementById("homeWrapper");this.u$("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.iKc?WacWordeditorStrings.DigitalPrintDialogDescriptionMSA:WacWordeditorStrings.DigitalPrintDialogDescriptionAAD}Xen(){this.Bn=new Cb.a;this.Bn.add(new Kr("BokehV2",WacWordeditorStrings.DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));this.Bn.add(new Kr("Regency",WacWordeditorStrings.DigitalPrintStyleNameRegency,
"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Bn.add(new Kr("PilarV2",WacWordeditorStrings.DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Bn.add(new Kr("Boutique",WacWordeditorStrings.DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));this.Bn.add(new Kr("Studio",WacWordeditorStrings.DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle",
"swaySimplicityHeading swayStudioHeading"));this.Bn.add(new Kr("Sierra",WacWordeditorStrings.DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Bn.add(new Kr("Fete",WacWordeditorStrings.DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Bn.add(new Kr("CelestialV2",WacWordeditorStrings.DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Bn.add(new Kr("TranquilV2",
WacWordeditorStrings.DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Bn.add(new Kr("Midtown",WacWordeditorStrings.DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Bn.add(new Kr("Lucent",WacWordeditorStrings.DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Bn.add(new Kr("AerialV2",WacWordeditorStrings.DigitalPrintStyleNameAerial,
"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Bn.add(new Kr("StructureV2",WacWordeditorStrings.DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Bn.add(new Kr("Muse",WacWordeditorStrings.DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Bn.add(new Kr("Cinema",WacWordeditorStrings.DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));
this.Bn.add(new Kr("MegaV2",WacWordeditorStrings.DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Bn.add(new Kr("ConvergenceV2",WacWordeditorStrings.DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Bn.add(new Kr("Alloy",WacWordeditorStrings.DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Bn.add(new Kr("Fluent",
WacWordeditorStrings.DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Bn.add(new Kr("Aurora",WacWordeditorStrings.DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Bn.add(new Kr("Civic",WacWordeditorStrings.DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Bn.add(new Kr("Reflection",WacWordeditorStrings.DigitalPrintStyleNameReflection,
"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}hcn(){this.Gaa=new Cb.a;this.Gaa.add(new Ku("universc","universc","normal","normal"));this.Gaa.add(new Ku("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.Gaa.add(new Ku("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.Gaa.add(new Ku("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.Gaa.add(new Ku("QuireSans-Thin",
"QuireSans-Thin","extrathin","normal"));this.Gaa.add(new Ku("Posterama-Regular","Posterama-Regular","normal","normal"));this.Gaa.add(new Ku("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.Gaa.add(new Ku("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.Gaa.add(new Ku("ArialNova","ArialNova","normal","normal"));this.Gaa.add(new Ku("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.Gaa.add(new Ku("QuireSans-Regular",
"QuireSans-Regular","normal","normal"));this.Gaa.add(new Ku("RockwellNova","RockwellNova","normal","normal"));this.Gaa.add(new Ku("SabonNRegLT","SabonNRegLT","normal","normal"));this.Gaa.add(new Ku("DaytonaThin","DaytonaThin","100","normal"))}vIn(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.Gaa)h+=String.format(this.tVk,r.fontFamily,r.UOo,r.fontWeight,r.fontStyle);b.innerText=h;this.eGd.appendChild(b)}mIn(){const b=document.createElement("style");
b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",Rl.a.kh("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Rl.a.kh("SwayPreviewFrameHC.svg"));b.innerText=h+r;X.a.zt&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.eGd.appendChild(b)}QFi(b){return b?b.keyCode:
window.event.keyCode}hide(){this.cvg();super.hide()}cvg(){if(this.P7&&!this.$8e){for(let b=0;b<this.Pra.count;b++)Re.a.removeHandler(this.Pra.K(b),Fd.a.click,this.Lkg),Re.a.removeHandler(this.Pra.K(b),Fd.a.Bj,this.Duj);Re.a.removeHandler(this.P7,Fd.a.Bj,this.yqj);Re.a.removeHandler(this.P7,Fd.a.focus,this.xqj);Re.a.removeHandler(this.E7,Fd.a.click,this.wjg);this.vff||Re.a.removeHandler(this.P7,Fd.a.scroll,this.Sig);this.$8e=!0}}i9f(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");
b.setAttribute("type","text/css");b.setAttribute("href",Rl.a.oll());this.eGd.appendChild(b);for(const h of this.Bn)this.zwf(this.P7,h);this.e6(this.P7);this.H5h(this.P7.firstChild);this.P7.firstChild.focus();Re.a.addHandler(this.P7,Fd.a.Bj,this.yqj);Re.a.addHandler(this.P7,Fd.a.focus,this.xqj)}zwf(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(le.a.Vob,le.a.VM);r.setAttribute("title",h.title);r.setAttribute(le.a.fi,le.a.DZh);
r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);b.src=Rl.a.kh("swayPublish.png");b.setAttribute(le.a.fi,le.a.NA);b.setAttribute("unselectable","on");b.setAttribute(le.a.pz,le.a.Zp);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.Tsp;b.setAttribute(le.a.pz,le.a.Zp);b.setAttribute("unselectable","on");b.setAttribute(le.a.fi,le.a.NA);r.appendChild(b);
const A=document.createElement("label");A.innerText=WacWordeditorStrings.DigitalPrintHeadingText;A.className=h.q6m;A.setAttribute(le.a.pz,le.a.Zp);b.setAttribute("unselectable","on");A.setAttribute(le.a.fi,le.a.NA);r.appendChild(A);Re.a.addHandler(r,Fd.a.click,this.Lkg);Re.a.addHandler(r,Fd.a.Bj,this.Duj);this.Pra.add(r)}j5n(b){const h=this.TCa;this.Ohm(b,h,!y.AFrameworkApplication.isRtl)||this.Qhm(b,h,!y.AFrameworkApplication.isRtl)||this.Lhm(b,h)||this.Mhm(b,h)}P2m(b){return b===Sys.UI.Key.tab?
(this.TCa&&this.TCa!==this.WUa&&(this.TCa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.WEd=this.WUa),!0):!1}Ohm(b,h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.P7.firstChild,this.e2b(b),!0):!1}Qhm(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.P7.lastChild,this.e2b(b),!0):!1}Lhm(b,h){return b===Sys.UI.Key.down?(b=this.Pra.indexOf(h),h=b+2,h<this.Pra.count?(b=this.Pra.K(h))&&this.e2b(b):
(h=b%2+1,h=2<=h?0:h,(b=this.Pra.K(h))&&this.e2b(b)),!0):!1}Mhm(b,h){b===Sys.UI.Key.up&&(b=this.Pra.indexOf(h),h=b-2,0<=h?(b=this.Pra.K(h))&&this.e2b(b):(h=b?20+b-1:this.Pra.count-1,(b=this.Pra.K(h))&&this.e2b(b)))}e2b(b){this.TCa&&this.TCa.id!==this.WUa.id&&(this.TCa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.WEd=b;this.TCa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.TCa.focus()}Gmp(){this.S8a.className=
"WACDialogButtonNormal swayPrintToWebButton";this.S8a.setAttribute("tabindex","0");this.mD.className="WACDialogButtonNormal swayCancelButton";this.mD.setAttribute("tabindex","0");this.S8a.disabled=!0}H5h(b){this.TCa&&(this.TCa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.WUa&&(this.WUa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.WUa.setAttribute(le.a.Vob,le.a.VM));this.Acc=b.id;this.WUa=b;this.WUa.setAttribute(le.a.Vob,le.a.Zp);this.WEd=b;this.TCa.className=
String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}zfi(){vb.TaskManager.instance.pc(new Md.a(2,1,50,this.rXo))}aVj(b,h){b.innerHTML=h}tXo(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.Acc));y.AFrameworkApplication.va.Vb(fb.a.Yki,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Ze.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature,
y.AFrameworkApplication.userSessionId,this.Acc);ed.a.openWindow(4,b)}Ule(b,h){ei.a.instance.Gf(h,+b.MQ-+b.ZI)}Sfp(){var b=WacWordeditorStrings.DigitalPrintPreviewFailureMessage;this.Qpb();this.idc.innerText=b;this.idc.style.display="block"}Rfp(){this.Qpb();this.Tbf.style.display="block";this.idc.innerText=WacWordeditorStrings.DigitalPrintGeneratingPreview;this.idc.style.display="block"}Qpb(){this.Ccf.style.background="";this.eRd.style.background="";eb.a.FV(this.Bcf);eb.a.FV(this.eRd);this.idc.style.display=
"none";this.Tbf.style.display="none"}static get ymi(){return null!=nC.aZg?nC.aZg:nC.aZg=Xa.a.instance.Wa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(u.a)(nC,"DigitalPrintDialog",Xf.a,[]);class KA{constructor(b,h){this._context=this.jm=null;this.ZPe=0;this.bBd=!1;this.dLh=null;this.zAf=(r,A,L,ba,ra)=>{if(1===L)return y.AFrameworkApplication.nE?8:32;this.dLh=ra.SourceControlId;if(y.AFrameworkApplication.J.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.QAc(WacWordeditorStrings.DigitalPrintSignInNeeded),32;this._context=A;if(KA.uun())return v.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.awf(),32;switch(this.ZPe){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.awf();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.QAc(WacWordeditorStrings.DigitalPrintNoSwayLicense);break;case 0:this.bBd=!1,this.jm=(new Em.a).create(),this.jm.message=WacWordeditorStrings.DigitalPrintCheckingSwayLicense,this.jm.nM(CommonUIStrings.l_DefaultDialogTitle,this.pwl,null),y.AFrameworkApplication.pe.addRequest(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Ze.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.rwl,this.qwl,null)}return 32};this.pwl=()=>{this.bBd=!0;v.ULS.sendTraceTag(34373831,382,
50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.rwl=r=>{if(!this.bBd){this.jm.close();var A=null;this.Ule(r.data,th.a.Znp);({group:A}=lm.a.A6(r.data.responseData)).returnValue?(r=A.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.ZPe=r.HasLicense?1:2,2===this.ZPe?this.QAc(WacWordeditorStrings.DigitalPrintNoSwayLicense):
this.awf()):this.QAc(WacWordeditorStrings.DigitalPrintSwayServiceDown)):(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.QAc(WacWordeditorStrings.DigitalPrintSwayServiceDown))}};this.qwl=r=>{this.bBd||(this.jm.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.Ule(r.data,th.a.Ynp),this.QAc(WacWordeditorStrings.DigitalPrintSwayServiceDown))};
this.ga=b;this.h7=h}mc(){y.AFrameworkApplication.AR?v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.nb(fb.a.$0c,ic.a.view,this.zAf,4),this.ga.nb(fb.a.Xki,ic.a.view,qf.ActionManager.UV,4),this.ga.nb(fb.a.Yki,ic.a.view,qf.ActionManager.UV,4),
this.ga.nb(fb.a.Wki,ic.a.view,qf.ActionManager.UV,4),this.ga.nb(wb.a.$2d,ic.a.view,qf.ActionManager.UV,4))}awf(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.dLh);new nC(this._context,this.ga,y.AFrameworkApplication.J.rb("SwayFontDownloadUrlTemplate"),y.AFrameworkApplication.J.rb("FileSource"))}QAc(b){const h=new wg.StandardDialog;h.Md=0;h.Rxa(CommonUIStrings.l_DefaultDialogTitle,b,null)}Ule(b,h){ei.a.instance.Gf(h,
+b.MQ-+b.ZI)}static uun(){return"OneDriveWOPI"===y.AFrameworkApplication.J.rb("FileSource")}}Object(u.a)(KA,"DigitalPrintActor",null,[]);class iN{constructor(){this.iOh=null}Bfj(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}d$j(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.p9i(b.errorDetails))return!1;this.iOh=Object(ya.a)(to.a,b.errorDetails).typeId;return!0}ssd(b){return this.p9i(b)?Object(ya.a)(to.a,b).typeId===this.iOh:
!1}p9i(b){if(!b)return v.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(ya.a)(to.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(u.a)(iN,"DoNotCheckThisCritiqueTypeStrategy",null,[304]);class vG extends Xf.a{constructor(b,h,r){super(!1,!1,!0);this.Tb=b;this.oua=r;this.Pzk="DocumentChoiceGroup";this.Klh="EmbededContent";this.mrh="HyperLink";this.S1e=
r.Ejb;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.W4c()};this.lvk=this.ham.bind(this);this.Ue(1,WacWordeditorStrings.ExternalContentDefaultSettingsDialogSave);this.ti(WacWordeditorStrings.ExternalContentDefaultSettingsDialogTitle,this.lvk,b)}W4c(){const b=Array(2);b[0]={["key"]:this.Klh,["text"]:WacWordeditorStrings.ExternalContentGalleryContent};b[1]={["key"]:this.mrh,["text"]:WacWordeditorStrings.ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps={["id"]:this.Pzk,
["defaultSelectedKey"]:this.S1e?this.Klh:this.mrh,["label"]:WacWordeditorStrings.ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WacWordeditorStrings.ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WacWordeditorStrings.ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WacWordeditorStrings.ExternalContentDefaultSettingsDialogInformation;return h}ham(b,h){1===b?(this.S1e!==h.isExternalContentSelected&&
(b=h.isExternalContentSelected?Lc.a.zXa:Lc.a.asb,this.Tb.Vb(b,2),this.S1e=h.isExternalContentSelected,ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ma.a,{name:"ActionId",int64:b})]}))),this.oua.JSo(h.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(u.a)(vG,"ExternalContentDefaultSettingsDialog",Xf.a,[]);class Lr{constructor(b,
h,r,A,L){this.eQ=Xa.a.instance.resolve("Common.IReactContextualUILauncher");this.yEb=bg.a.On;this.LAc=()=>{const ba=Array(1);ba.push("ExternalContent");var ra=Xa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").kYa();ra=Object.assign(new Ew.a,{x:ra.x,y:ra.y});this.eQ.showFloatie(ra,ba,1);return 32};this.rUb=()=>{this.eQ.k5&&this.eQ.dismissFloatie();return 32};this.QCj=(ba,ra,Ia,Ta,ob)=>{if(ra="object"===typeof ob?ob:null)ba===Lc.a.Rrg?(ba=Lr.U5a!==Lc.a.zXa&&Lr.U5a!==
Lc.a.asb,ra[this.yEb]=Lr.U5a===Lc.a.zXa||ba):ba===Lc.a.Srg&&(ra[this.yEb]=Lr.U5a===Lc.a.asb);return 32};this.Iri=(ba,ra,Ia)=>{1!==Ia&&(ba===Lc.a.asb&&Lr.U5a!==Lc.a.asb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.yo.undo()&&(ra=new Gy.a(1,y.AFrameworkApplication.isRtl),ra.kkd="ExternalContent",Lr.$rb.Lmd(ra))):ba===Lc.a.zXa&&Lr.U5a!==Lc.a.zXa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),this.Dmh.rEj()),Lr.U5a=ba);ka.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ma.a,{name:"behavior",string:Ia.toString()}),Object.assign(new ma.a,{name:"ActionId",int64:ba})]}));return 32};this.ga=b;this.yo=h;this.Dmh=A;this.pGk=L;this.kvk=this.iam.bind(this);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Dmh.jGj(()=>{this.reset()})}mc(){this.ga.nb(Lc.a.Rrg,
ic.a.view,this.QCj,97);this.ga.nb(Lc.a.Srg,ic.a.view,this.QCj,97);this.ga.nb(Lc.a.Hri,ic.a.view,this.kvk,1028);this.ga.nb(Lc.a.zXa,ic.a.view,this.Iri,1028);this.ga.nb(Lc.a.asb,ic.a.view,this.Iri,1028);this.pGk||(this.ga.nb(Lc.a.LAc,ic.a.view,this.LAc,96),this.ga.nb(Lc.a.rUb,ic.a.view,this.rUb,96))}cep(b){new vG(this.ga,b,Lr.oua)}iam(b,h,r){1!==r&&this.cep(Lr.U5a);return 32}static get $rb(){return null!=Lr.wZg?Lr.wZg:Lr.wZg=Xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get oua(){Lr.mIa||
(Lr.mIa=Xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Lr.mIa}reset(){Lr.U5a=null!=Lr.oua?Lr.oua.Ejb?Lc.a.zXa:Lc.a.asb:Lc.a.zXa}}Lr.U5a=Lc.a.zXa;Lr.mIa=null;Object(u.a)(Lr,"ExternalContentActor",null,[]);class nE extends TE{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){super(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb);this.sad=bc;this.u5d=!1;this.Nsh=null}tnd(){this.u5d||(super.tnd(),this.u5d=!0)}cIe(){this.u5d&&(super.cIe(),nE.Ini&&this.Nsh&&nE.Ini.removeHandler(AD.a.gKa,
this.Nsh),this.u5d=!1)}R4b(){if(this.sad){this.ZBa.k5&&this.ZBa.dismissFloatie();const b=new Gy.a(0,y.AFrameworkApplication.isRtl);b.location=this.Qeb.kYa();this.showFloatie(null,b)}else this.ZBa.k5&&y.AFrameworkApplication.va.Vb(Lc.a.rUb,2),y.AFrameworkApplication.va.Vb(Lc.a.LAc,2);this.Vrc=!1}dismissFloatie(b){!this.D_e&&(b&&(this.Qeb.XZf(),this.jak()),this.ZBa.k5||this.HTa)&&(this.HTa=!b,this.cIe(),this.sad?this.ZBa.dismissFloatie():y.AFrameworkApplication.va.Vb(Lc.a.rUb,2))}showFloatie(b,h){h||
(h=new Gy.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.Qeb.kYa());if(!h.location)return!1;this.HTa&&(this.HTa=!1,this.tnd());this.sad?(b=Array(1),b.push("ExternalContent"),this.ZBa.showFloatie(this.Qeb.kYa(),b,1)):y.AFrameworkApplication.va.Vb(Lc.a.LAc,2);return!0}k0c(){if(!this.Vrc){const b=new Md.a(3,1,this.Khi,()=>{this.R4b()},196);vb.TaskManager.instance.pc(b);this.Vrc=!0}}wpa(){this.sad?this.ZBa.k5&&this.ZBa.dismissFloatie():y.AFrameworkApplication.va.Vb(Lc.a.rUb,2);this.k0c()}G1b(){this.sad?
this.ZBa.k5&&this.ZBa.dismissFloatie():y.AFrameworkApplication.va.Vb(Lc.a.rUb,2);this.k0c()}static get Ini(){return null!=nE.hZg?nE.hZg:nE.hZg=Xa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(u.a)(nE,"ExternalContentFloatieEventManager",TE,[]);class oE extends Jw{constructor(b,h,r,A,L){super(b,h,r,A,L)}A3h(){if(!this.pb||!this.pb.ob||!this.pb.ob.currentSelection)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;
var b=this.pb.ob.currentSelection.Ya,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.zN){do r=this.VJi(r);while(r&&!r.zN&&Object(Pb.a)(wm.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";const L=Object(ya.a)(wm.AParagraphNode,r);L&&(A=L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?A.length:b.cpBegin;b=Object.assign(new $n,{pFa:Object(ya.a)(89,(L?Object(ya.a)(89,L):Object(ya.a)(89,r))||b.node),wwc:h});return this.$Mf(b)}HEi(b,
h){let r=null;const A=Object(ya.a)(112,b.pFa.Dm(h.Lc));if(!A)return null;if(Object(Pb.a)(wm.AParagraphNode,b.pFa)){const L=Object(ya.a)(wm.AParagraphNode,b.pFa);if(L.LV){if(b=Object(ya.a)(ZA.a,rd.ParagraphReader.GMa(L)))(b=Object(ya.a)(112,b.Dm(h.Lc)))&&(r=b.getBounds()),r&&(r.height+=oE.Lui,r.width-=oE.fhm);return r}h=Object(ya.a)(50,A);if(!h)return null;try{if(r=this.Mnb.m4(b.wwc,h,0<b.wwc,!1,!1,!1))r.height+=oE.Lui}catch(ba){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
ba),r=null}}r||(r=A.getBounds());return r}}oE.Lui=65;oE.fhm=100;Object(u.a)(oE,"ExternalContentFloatiePositionProvider",Jw,[]);class jN{constructor(b,h,r,A,L,ba){this.sye=(ra,Ia,Ta)=>{if(1===Ta)return y.AFrameworkApplication.AR||y.AFrameworkApplication.nE||y.AFrameworkApplication.Cva||id.SessionStatusManager.instance.zk?8:32;if(ra===fb.a.print)ra=1;else if(ra===Lc.a.C1c)ra=0;else if(ra===Lc.a.Q3d)ra=3;else if(ra===Lc.a.P3d)ra=2;else return 8;return this.tSo(ra)};this.ga=b;this.h7=h;this.s9b=r;this.yzk=
A;this.skh=L;this.Avk=ba}mc(){var b;y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&this.yzk||y.AFrameworkApplication.nE?(document.body.classList.add("WACStopPrinting"),""!==this.skh&&this.Avk.Eep(this.skh)):(this.ga.qa(fb.a.print,ic.a.application,this.sye),this.ga.qa(Lc.a.C1c,ic.a.application,this.sye),(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&this.ga.qa(Lc.a.Q3d,ic.a.application,this.sye),
this.ga.qa(Lc.a.P3d,ic.a.application,this.sye))}tSo(b){const h=y.AFrameworkApplication.rootQuerySignature;if(!h||""===h||If.a.Gd()&&If.a.Gd().MG.nq)return 8;this.s9b.Ege=!1;this.s9b.$gk.start();Pw.a.rT(xw.a.gHl,!0,Object(E.a)(this.s9b,this.s9b.OMo,"requestFileDownload"),Object(E.a)(this.s9b,this.s9b.mZb,"onForceSaveFailed"),b);return 32}}Object(u.a)(jN,"FileDownloadActor",null,[]);class mJ extends Pe{constructor(b,h=null,r=null,A=!1){super(b,!0,h,!1,void 0,r,A)}get aXf(){return null}get Tdb(){return this.Uad?
CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText:this.ebd?CommonUIStrings.l_DownloadAsPdfDialog_EmailALinkText:y.AFrameworkApplication.k$a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get gtc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get jVd(){return null}get Uad(){return"VersionHistory"===this.eqf||1===y.AFrameworkApplication.ta.mode||this.$qi?!1:1==y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",
0)}get ebd(){return"VersionHistory"===this.eqf||1===y.AFrameworkApplication.ta.mode||this.$qi?!1:2==y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",0)}Ile(){v.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");zi.a.rx("tshrepdf;cshrepdf")}}Object(u.a)(mJ,"DownloadAsPdfDialog",Pe,[]);var wG=e(463);class Ht{constructor(){this._url=this.ey=null;this.h7a=this.g7a=0;this.Znb=!1;this._headers=this.H9e=null;this.tOa=()=>{if(this.H9e){const b=
new wG.a(this._url,1,null,this._headers,!0,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,this.H9e);y.AFrameworkApplication.pe.send(b).cxa(h=>{this.aPa(h)},h=>{this.rR(h)})}else y.AFrameworkApplication.pe.addRequest(this._url,1,null,null,!0,2,this.aPa,this.rR,null)};this.aPa=b=>{Ht.Xod();const h=b.data.xpa;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(A){}r&&("InProgress"===r.text&&22>this.g7a++||"ServiceBusy"===r.text&&3>this.h7a++)?this.SPa(1E3*(this.g7a+
this.h7a)):this.ey(!0,r?r.text:null,b.data)};this.rR=b=>{this.Znb?(Ht.nJa||(Ht.Elb=new Date,Ht.nJa=!0,Ht.jY=1),18E4>(new Date).getTime()-Ht.Elb.getTime()?this.aAb(4<=Ht.jY?2E4:1E3):this.wbb(b.data)):4>Ht.jY?this.aAb(2E3):this.wbb(b.data)}}send(b,h,r,A,L){this._url=b;this.H9e=L;this._headers=A;this.ey=h;this.Znb=r;this.tOa(null)}SPa(b){b=new Md.a(2,1,b,this.tOa);y.AFrameworkApplication.zc.pc(b)}aAb(b){this.SPa(b);Ht.jY++}wbb(b){this.ey(!1,null,b)}static D8(b,h,r,A){(new Ht).send(b,h,!1,r,A)}static Xod(){Ht.nJa=
!1;Ht.jY=0}}Ht.Elb=null;Ht.nJa=!1;Ht.jY=0;Object(u.a)(Ht,"ClientRequestWithRetry",null,[]);class xG extends Hd{constructor(b){super(b,void 0,y.AFrameworkApplication.k$a)}get Tdb(){return xG.pvn?WacWordeditorStrings.DownloadAsOdtDialogOdtReady.replace("{0}",""):WacWordeditorStrings.DownloadAsOdtDialogOdtReady}static get pvn(){if(null!=xG.h4g)var b=xG.h4g;else{var h;y.AFrameworkApplication.ud("32d51153;h1018576");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogDownloadLinkRemovalEnabled",
!1);b=xG.h4g=b}return b}get gtc(){return WacWordeditorStrings.DownloadAsOdtDialogLinkSuggestion}get Jed(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get S_c(){return y.AFrameworkApplication.k$a?"UIFontDialogTextLarge":null}Ile(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}K9f(){v.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}ifd(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get ued(){return ye.Lnj}get axb(){return WacWordeditorStrings.DownloadAsOdtDialogLearnMoreLinkText}get vjj(){return!y.AFrameworkApplication.k$a}}
Object(u.a)(xG,"DownloadAsOdtDialog",Hd,[]);class kN{constructor(b,h){this.Z_e=this.Era=this.Akb=this.a8a=null;this.lni="downloadpdf";this.ZOo="blob";this.Mjl="blob:";this.$Oo="application/pdf";this.F3l="downloadpdfwithoutcomments";this.bBj="printpdf";this.Knj="odt";this.Sgb=r=>{1===Db.StaticActiveAppFrame.Aa().state||this.a8a||(this.a8a=(new Em.a).create(),r=r.customData,this.cKn(r),1===r?this.a8a.message=this.GFb.TV.isEnabled?y.AFrameworkApplication.k$a?CommonUIStrings.l_DirectPrintPreparingPDF:
WacWordeditorStrings.DirectPrintWait:WacWordeditorStrings.PrintPDFWait:0===r||3===r?this.a8a.message=WacWordeditorStrings.PrintPDFWait:2===r&&(this.a8a.message=WacWordeditorStrings.ConversionToODTWait),this.a8a.nM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.Ege=!0};this.U9=(r,A,L)=>{this.jJg("Success. Save and Conversion Complete.");var ba=new Ua.QueryStringBuilder(L.request.get_url());y.AFrameworkApplication.Qla(ba);ba=ba.toString();const ra=this.dNo(ba);
this.Xta(ra);2!==ra&&this.GFb.qoo();if(!r||A)this.A$(ra);else if(this.Ege)this.Ege=!1,this.Akb=null;else{this.Akb&&y.AFrameworkApplication.zc.Kf(this.Akb);this.Akb=null;if(0===ra||3===ra){A=new ma.a;A.name="IsLabeled";const Ia=y.AFrameworkApplication.J.rb("AppliedPolicyId");A.bool=!!(Ia&&0<Ia.length);$d.a("PdfProtectionUsage",r,void 0,[A])}this.b6i&&1==ra?(r=L.TFa,(null===r||void 0===r?void 0:r.type)==this.$Oo?(r=URL.createObjectURL(r),this.i2m(r)):v.ULS.sendTraceTag(507892753,306,15,"Response type should be pdf blob")):
this.Q0l(ba,ra)}};this.Ege=!1;this.GFb=b;this.$gk=h.O_a("UserAction","WordEditorForceSaveAndPrint")}Xta(b){this.a8a&&(this.mKn(b),this.a8a.close(),this.a8a=null)}A$(b){if(1!==Db.StaticActiveAppFrame.Aa().state){this.hLn(b);const h=new wg.StandardDialog;h.Md=0;h.Ue(1,CommonUIStrings.l_DialogClose);h.zA(0,"",1===b?WacWordeditorStrings.PrintError:WacWordeditorStrings.ConversionError,null,!0)}}tQf(b){switch(b){case 0:return this.D1i?this.F3l:this.lni;case 3:return this.lni;case 1:return this.bBj;case 2:return this.Knj;
default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),this.bBj}}OMo(b){var h=y.AFrameworkApplication.rootQuerySignature;if(h&&""!==h){var r="WordViewer/request."+this.nFf(b)+"?"+h+"&type="+this.tQf(b)+"&rndm="+qb.a.create();1===b&&this.GFb.Pcp()&&(r+="&useNamedAction=1");y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CustomFontReadModePDFIsEnabled")&&cp.a.kCe()&&(1===b||!b)&&(0<cp.a.uhi&&(r+="&cfcVer="+cp.a.uhi),cp.a.thi&&(r+="&cfcUrl="+encodeURI(cp.a.thi)),cp.a.vhi&&
(r+="&cfcEncData="+encodeURIComponent(cp.a.vhi)),cp.a.shi&&(r+="&cfcBaseUrl="+encodeURI(cp.a.shi)));if(this.b6i&&1==b){var A=new Cb.a;A.add("access_token");A.add("access_token_ttl");h=db.a.uae(r,A);r=db.a.Gxe(r,A);A={};for(const L of h)A[L.key]=L.value;Ht.D8(r,this.U9,A,this.ZOo)}else Ht.D8(r,this.U9);this.Akb||(this.Akb=new Md.a(2,1,500,this.Sgb),this.Akb.customData=b,y.AFrameworkApplication.zc.pc(this.Akb))}else this.jJg("failed. QuerySignature is empty."),this.A$(b)}nFf(b){return 2===b?"odt":"pdf"}mZb(){this.jJg("Failed. force save failed.")}dNo(b){if(0<
b.indexOf("&type=downloadpdf")&&this.D1i)return 0<b.indexOf("&type=downloadpdfwithoutcomments")?0:3;if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri.");return 1}jJg(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.$gk.stop()}i2m(b){if(b.startsWith(this.Mjl)){var h=()=>{URL.revokeObjectURL(b);
this.Era&&(this.Era.src="",document.getElementById(Uk.a.kDb).removeChild(this.Era),this.Era=null);window.removeEventListener("focus",h)};this.Era||(this.Era=document.createElement("iframe"),this.Era.id="FrameContainingPrintPdf",this.Era.style.display="none",this.Era.style.contain="strict",document.getElementById(Uk.a.kDb).appendChild(this.Era));this.Era.src=b;window.addEventListener("focus",h);this.Era.focus();this.Era.contentWindow.print()}else v.ULS.sendTraceTag(507892686,306,15,"URL should be of type blob")}Q0l(b,
h){const r=new Cb.a;r.add("access_token");r.add("access_token_ttl");1!==Db.StaticActiveAppFrame.Aa().state&&(1===h?this.GFb.sfp(b,r):0===h||3===h?new mJ(b,null,null,0===h):2===h&&new xG(b))}dispose(){}cKn(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 3:v.ULS.sendTraceTag(508078023,203,50,"Download Attempt: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");
break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}mKn(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 3:v.ULS.sendTraceTag(508078022,203,50,"Download Cancelled: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}hLn(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,
203,15,"Download Failed: Pdf");break;case 3:v.ULS.sendTraceTag(508078021,203,15,"Download Failed: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}get D1i(){if(null!=this.F3g)var b=this.F3g;else{var h;y.AFrameworkApplication.ud("b62ed219;f72gc351");b=this.F3g=null===(h=y.AFrameworkApplication.J)||void 0===
h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1)}return b}get b6i(){if(y.AFrameworkApplication.kdd)return!1;null==this.Z_e&&(zi.a.rx("PrintUxImprovementTf;PrintUxImprovementCf"),this.Z_e=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.PrintUxImprovementIsEnabled",!1):!1);return this.Z_e}}Object(u.a)(kN,"FileDownloadManager",null,[]);class pE{get key(){return"LIST"}get hx(){return Box4Intl.Box4Strings.l_ListContentTitle}F4b(b){let h=
null;const r=pE.Vd.Fy(b);if(!r)return{returnValue:!1,Fga:h};b=this.eFm(b,r);h=Object.assign(new DC.a,{NH:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Fga:h}}htb(b,h){b=b.contentObject;const r=this.NDm(b.cB),A=new ii.a;h?(h=h.contentObject,h.level!==b.level?(A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r)):h.id.equals(b.id)&&h.cB.listType===b.cB.listType||A.add(r)):(A.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),A.add(r));return A.toArray().join(" ")}NDm(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Ez);else if(1===b.listType)switch(r){case 1:h=this.l2h;break;case 2:h=this.Lol;break;case 3:h=this.Mol;break;default:h=this.l2h}return h}static get Vd(){return null!=pE.F5g?pE.F5g:pE.F5g=Xa.a.instance.resolve("Box4.List.IListReader")}}Object(u.a)(pE,"ListDetailsProvider",null,[729,377]);class lN{constructor(){this.cB=this.listId=
this.id=null;this.level=0}}Object(u.a)(lN,"ListItemInfo",null,[]);class oC extends pE{constructor(b){super();this.Daa=b}get l2h(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get Lol(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get Mol(){return WoncaIntl.WoncaStrings.L_BulletStyle3}eFm(b,h){const r=this.Daa.mG(b);return Object.assign(new lN,{id:b.currentNode.id,listId:new V.a(qb.a.nil,r.listID),cB:h,level:r.level+1})}}Object(u.a)(oC,"FlatListDetailsProvider",pE,[]);class mN{constructor(b,h){this.ga=
b;this.zg=h}get kc(){return null!=this.ubh?this.ubh:this.ubh=Xa.a.instance.Wa("Box4.Styles.IWACStyleReader")}mc(){}}Object(u.a)(mN,"FormattingActor",null,[]);var vO=e(1143),Kv=e(302),nN=e(1714);class oN{constructor(b,h,r,A,L,ba,ra,Ia){this.Lb=b;this.RSk=h;this.Zc=r;this.NGb=A;this.ir=L;this.za=ba;this.Qd=ra;this.uHk=Ia}Avc(b,h,r,A,L,ba,ra){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.qj});this.NGb.then(()=>
{this.RSk(b.data.responseData);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.qj});ra.stop()})}rR(b,h,r,A,L,ba,ra){ba.stop();L();ra?(this.Bio(h,r),v.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:pe.a.vtb(h.Lb)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:pe.a.vtb(h.Lb)})}tXh(b,h){b.Me(gy.a.$uf,As.a3l.toString());if(this.Qd&&this.Qd.isFeatureEnabled(43)){var r=
this.ir.Io(h.Pk);r=this.ir.pl(r);b.Me(ri.a.gu,Kv.a[r]);5===r&&this.ycl(b,h)}this.uHk&&b.Me(ri.a.Cee,"true")}lRh(){return new nN.a(this.Lb.id,this.Lb)}$ae(){return WacWordeditorStrings.GraphicsEditorDefaultError}Bio(b,h){const r=this.Zc.Vc(7,fb.a.c_m);r.Eb(h);b.Lb.setValue(Rc.a.Hai,!0);r.dispose()}ycl(b,h){var r=h.Pk;h=this.ir.Io(r);var A=r.node;const L=(r=this.ir.OMa(h,A.ed,!1))?this.ir.oYa(r):"";if(""===L)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");A=(A=this.ir.OMa(h,A.ed,!0))?this.ir.oYa(A):"";b.Me(ri.a.Tvc,L);b.Me(ri.a.dhk,A);r=r.ka(Tc.a.Qsi,"");""!==r&&b.Me(ri.a.extension,r);b.Me(ri.a.width,this.ir.XD(h).toString());b.Me(ri.a.height,this.ir.iF(h).toString());b.Me(ri.a.Akd,this.ir.Ntb(h).toString());r=this.za.$("WordEditorImageCropIsEnabled");b.Me(ri.a.Fgi,r.toString());r&&(r=this.ir.oha(h),b.Me(ri.a.top,r.top.toString()),b.Me(ri.a.bottom,r.bottom.toString()),b.Me(ri.a.left,r.left.toString()),
b.Me(ri.a.right,r.right.toString()));r=this.za.$("WordEditorImageRotateIsEnabled");b.Me(ri.a.fOj,r.toString());r&&(b.Me(ri.a.angle,this.ir.N4(h).toString()),h=this.ir.Jua(h),b.Me(ri.a.flipH,h.ssb?"true":"false"),b.Me(ri.a.flipV,h.lMa?"true":"false"));b.Me(ri.a.noi,"true")}}Object(u.a)(oN,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[309]);class pN{constructor(){this.iTa=null}ujl(b){this.iTa=b}teardown(){null!=this.iTa&&(this.iTa.teardown(),this.iTa=null);this.V7e=null}getGraphicData(){return this.iTa?
this.iTa.getGraphicData():null}kFo(){null!=this.V7e&&this.setGraphicData(this.V7e)}setGraphicData(b){this.V7e=b;if(this.iTa)try{this.iTa.setGraphicData(b)}catch(h){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.iTa?this.iTa.hasEdits():!1}}Object(u.a)(pN,"GraphicsEditorGC2HostUser",
null,[311]);var wO=e(1715),xO=e(1088),xk=e(1252),qE=e(816),yG=e(1341),zG=e(1087);class rE{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(u.a)(rE,"GC2ScriptLoader",null,[]);class AG{constructor(b,h,r){this.xQe=b;this._context=h;this.KUa=r}closeEditor(){this.xQe&&(this.xQe(),this.xQe=null)}logActivity(b,h,r,A){$d.a(b,h,r,A)}logTrace(b,h,r,A){v.ULS.sendTraceTag(575522531,3001,AG.COn(h),A)}isEnabled(b){const h=
y.AFrameworkApplication.J;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");
default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Xa.a.instance.resolve("Box4.IFontServiceParser").eab}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=cp.a.gJf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return Ca.Health.instance}getFonts(b){const h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",
!1),r=h?"msofp_hier":"msofp",A=`${Xa.a.instance.resolve("Box4.IFontServiceParser").eab}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,A);cp.a.SRh();cp.a.tSh({});b=cp.a.fJf(()=>!1,(L,ba)=>ba).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.fFl()));return b}fFl(){const b=cp.a.gJf(()=>!1,()=>"").fonts.map((h,r)=>{const A=h.name;h=h.displayName;const L=cp.a.Qva(A);return Object.assign(new cL.a,{MenuItemId:cp.a.gQj+r,CommandValueId:A,LabelText:h||A,Styles:{["optionText"]:{["fontFamily"]:h&&
!L?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:A})});return Object.assign(new Zd.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Pk;var r=pe.a.Io(h);if(this.lsn(r,h,b)&&(r=pe.a.R$(r,Pd.a.X9,""),r.length))return Promise.resolve(r);r=new Ua.QueryStringBuilder("/we/GetImage.ashx?");r.HMb(h.node.hk().Kr);r.Me(ri.a.b2d,b);y.AFrameworkApplication.Qla(r);r.Me(Wi.a.rDb,"1");Sk.a.instance.NMb(r);
r.Me(ri.a.Ihi,"true");const A=r.toString();return new Promise((L,ba)=>{this.KUa.addRequest(A,1,null,null,!1,2,ra=>{L(ra.data.responseData)},ra=>{ba(ra.data.Xe.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=Rl.a.kh("progress.gif");b.PictureInvalid=Rl.a.kh("CancelRequest.32x32x32.png");return b}getTheme(){const b=Object(ao.a)().kw(this._context.view.Fd).properties.ka(Rc.a.lGe,"");return 0===b.length?[]:b.split(" ").map(h=>Ze.a.tWa[h])}static COn(b){switch(b){case 0:return 10;
case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}lsn(b,h,r){const A=h.node.ed;h=pe.a.cae(b,A,!1);b=pe.a.cae(b,A,!0);return r===h||r===b}}Object(u.a)(AG,"GraphicsEditorApp",null,[327]);class sE extends Xf.a{constructor(b,h,r,A,L){super(!1,!1,!0);this.closeEditor=()=>{this.pbi();this.dispose()};this.Uta=ba=>{this.pbi(2===ba)};this.Rkb=b;this.WDk=h;this.Erh=r;this._context=A;this.KUa=L}vep(b){return new Promise((h,r)=>{this.ti(WacWordeditorStrings.GraphicsEditorDialogTitle,
this.Uta,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(A,L)=>this.zNb(A,L,b),["onload"]:A=>{this.onLoad(A,h,r)},["editorDiscardText"]:WacWordeditorStrings.GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WacWordeditorStrings.GraphicsEditorDialogSave,["onReload"]:()=>{this.Rkb.kFo()},["iFrameTitle"]:WacWordeditorStrings.GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.Rkb.ujl(b),h(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}zNb(b,h,
r){b=y.AFrameworkApplication.J;const A=zG.a();A.loadScriptWithRetryHandler=h;const L=new AG(this.closeEditor,this._context,this.KUa),ba={["bootConfig"]:Object.assign(new xk.a,{scriptBaseUrl:CA.AppChromeOverrideUtilities.isEnabled?CA.AppChromeOverrideUtilities.Q$d(y.AFrameworkApplication.lcid):y.AFrameworkApplication.G$+y.AFrameworkApplication.lcid+"/",isMLRRibbonMode:y.AFrameworkApplication.ta.Pb.wAc,isCombinedBundleEnabled:y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new rE(new xO.DynamicScriptLoader(A)),
["publicPath"]:y.AFrameworkApplication.G$,["appSettings"]:b.appSettings,["logger"]:new Ak.a,["featureGateManager"]:Object.assign(new qE.a,{getBooleanFeatureGate:Object(E.a)(b,b.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(E.a)(b,b.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(E.a)(b,b.getStringFeatureGate,"getStringFeatureGate")}),["app"]:L,["resolveScript"]:(ra,Ia)=>yG.a.resolveScript(ra,Ia),["initialTabId"]:r};b.$("DynamicBundlesIsEnabled")&&(r="",
y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")||(r=b.$("IsWebpack5RibbonEnabled")?"wp5/":"exp/"),ba.dynamicBundlesPath=CA.AppChromeOverrideUtilities.isEnabled?CA.AppChromeOverrideUtilities.dzc+r:b.rb("StaticContentUrl")+r);return new Promise((ra,Ia)=>{h("gc2",y.AFrameworkApplication.Lz("gc2.js",5),"anonymous",5,!1).then(()=>{ra(ba)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");
Ia(null)})})}pbi(b){b=this.Rkb.hasEdits()&&!b;this.WDk(b?this.Rkb.getGraphicData():null,!!this.Erh,this.Erh,b)}}Object(u.a)(sE,"ReactGraphicsEditorDialog",Xf.a,[]);class BG{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc,Bc,Yc=!1){this.Uwi=Yc;this.NGb=this._context=null;this.wep=(zd,Jd,ie,re,me)=>{var Sd,cf;const sf=!!me&&Object(Pb.a)(V.a,me);try{if(1===ie){const si=Jd.view;return this.ll.kma(Jd)&&si.features.XEe?32:8}this.RHk=4===(null===me||void 0===me?void 0:me.InputMethod)?!0:!1;Object(Li.c)()&&
(this.Uwi||vO.a.Xrb(()=>{this.Uwi=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${sf}`);performance.mark("LaunchStart");this._context=Jd;const yh=new sE(this.Rkb,this.Whg,sf?me:null,Jd,this.$f);zd=null;if(sf){const si=null===(cf=null===(Sd=Jd.view.ub)||void 0===Sd?void 0:Sd.ob)||void 0===cf?void 0:cf.currentSelection;if(null===si||void 0===si?0:si.GN)zd="Draw"}this.NGb=yh.vep(zd).then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${sf}`)}).catch(()=>
{this.Fli()});if(!sf){const si=cn=>{this.NGb.then(()=>{this.Ktj(cn,!1)})};if(y.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return si(JSON.stringify({elements:[]})),32;let cl=null;cl=Object(ao.a)().kw(Jd.view.Fd);const Pj=cl.properties.ka(Rc.a.Vwi,"");if(0<Pj.length)return si(Pj),32;this.TWe.PWo(Jd,V.a.create(),qb.a.create()).then(cn=>{const Mu=this.Zc.Vc(0,fb.a.m8c);Mu.Eb(cl);cl.setValue(Rc.a.Vwi,cn);Mu.dispose();si(cn);
return null}).catch(cn=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",cn.toString(),sf);this.Fli()})}return 32}catch(yh){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",yh.toString(),sf),8}};this.J0m=(zd,Jd,ie,re,me)=>{var Sd,cf;zd=Jd.view;ie=null===(cf=null===(Sd=null===zd||void 0===zd?void 0:zd.ub)||void 0===Sd?void 0:Sd.ob)||void 0===cf?void 0:cf.currentSelection;
if(null===ie||void 0===ie||!ie.AZa)return 8;if(!zd.features.XEe)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.Eni(me,Jd);return 32};this.I0m=(zd,Jd,ie,re,me)=>{var Sd,cf,sf=Jd.view;sf=null===(cf=null===(Sd=null===sf||void 0===sf?void 0:sf.ub)||void 0===Sd?void 0:Sd.ob)||void 0===cf?void 0:cf.currentSelection;return null!==sf&&void 0!==sf&&sf.AZa?this.hRi(zd,Jd,ie,re,me):8};this.hRi=(zd,Jd,ie)=>{if(1===ie)return Jd.view.features.XEe?32:8;if(2===ie){zd=pe.a.Io(Jd.Pk);
if(!zd)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.Eni(zd,Jd);return 32}return 2};this.Ktj=(zd,Jd=!0)=>{this.Rkb.setGraphicData(zd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");zd=performance.getEntriesByName("EditorLaunch");v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${Jd} Duration: ${zd[zd.length-1].duration}`);performance.clearMarks("LaunchStart");
performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.Whg=(zd,Jd,ie,re)=>{var me;this.Rkb.teardown();if(Jd&&this._context){var Sd=this._context.view.ub.hh,cf=Sd.node;Sd.nm&&rd.ParagraphReader.lc(cf)&&(Sd=null===(me=this.oba)||void 0===me?void 0:me.YD(cf),27==(null===Sd||void 0===Sd?void 0:Sd.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",re,re?" Everything deleted: "+(0==(null===zd||void 0===zd?void 0:zd.json.length)):
""))}if(re)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(zd)if(re=zd.json,me=zd.width,cf=zd.height,re.length||Jd)if(!re.length&&Jd)if(Jd=this._context.Pk){Jd=Jd.node;if(pe.a.Wca(Jd)){if(!this.ll.DFo(Jd,new te.a,Ke.a.instance,qM.vMb)){v.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.ll.Wxc(Jd,ie,this.qb,this.E_)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else Sd=new wO.a(this._context,y.AFrameworkApplication.ta.SYa,!0,this.ll,this.za,Object(ao.a)()),zd=qb.a.create(),ie=new av.a(Sd,re,this.qO,this.yo,zd,gm.a.instance,Jd,ie,this.ll,this.ir,me,cf,this.za,this.E_,this.Qd,Object(Li.c)(),Object(Li.b)()),this.TWe.qBg(ie,this._context,Jd,zd),this.Wja(),this.RHk&&this.jwp();else v.ULS.sendTraceTag(541714001,3001,
50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.za=h;this.TWe=r;this.ll=A;this.qO=L;this.yo=ba;this.Rkb=new pN;this.Zc=Ia;this.qb=Ta;this.E_=ob;this.ir=nb;this.Qd=bc;this.$f=Eb;this.oba=Bc}mc(){let b=!0;this.za.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Qd&&this.Qd.isFeatureEnabled(43));
b&&!X.a.Zt&&(this.ga.nb(Lc.a.Dce,ic.a.view,this.wep,4),this.ga.nb(fb.a.sCf,ic.a.view,this.J0m,4),this.ga.nb(Lc.a.Fni,ic.a.view,this.I0m,4),this.ga.nb(Lc.a.Djc,ic.a.view,this.hRi,4))}Fli(){const b=new wg.StandardDialog;b.Md=0;b.zA(Of.a.bCf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WacWordeditorStrings.GraphicsEditorDefaultError,null);Db.StaticActiveAppFrame.Aa().Ne()}Eni(b,h){var r=b.ka(Kh.a.FR,1);const A=b.ka(Tc.a.S1,pd.a.finished);r&&A!==pd.a.YGa?b.ka(Rc.a.Hai,!1)?(h=new wg.StandardDialog,
h.Md=0,h.zA(Of.a.bCf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WacWordeditorStrings.GraphicsEditorUnsupportedContentError,null,!0),Db.StaticActiveAppFrame.Aa().Ne(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties"})):(this.ga.Zb(Lc.a.Dce,2,b.id),this.NGb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.NGb=new Promise(L=>{L(null)})),r=qb.a.create(),b=new oN(b,this.Ktj,gm.a.instance,
this.NGb,this.ir,this.za,this.Qd,Object(Li.d)(b)),this.TWe.qBg(b,h,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Wja(){const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):v.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}jwp(){const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey",
"WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(u.a)(BG,"GraphicsEditorActor",null,[]);var nJ=e(545);class oJ{constructor(b,h,r){this.k5a="wwaengidc";this.jCd="CreateLinkForHeading";this.jyk="CreateLinkForHeadingAction";this.tAk="\ufffc";this.W4a=b;this.ga=h;this.qb=r}mc(){this.ga.qa(Lc.a.t_c,ic.a.paragraph,this.cxf.bind(this));this.ga.qa(Lc.a.t_c,ic.a.Nd,this.cxf.bind(this));this.ga.qa(Lc.a.t_c,ic.a.kd,this.cxf.bind(this));this.ga.Oc(Lc.a.t_c,
1028)}cxf(b,h,r){b=h.node;if(1===r)return this.c4i(b)?32:8;this.hyo(this.jCd,this.jyk);if(!this.c4i(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Rc.a.qd);if(!r)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",this.jCd),r=Object.assign(new Sa.a,{additionalValues:r}),Ca.Health.instance.recordKpiFailure(this.jCd,"Unable to create sharable link as paragraph id is missing",
!1,!0,r),8;this.yei(r);return 32}yei(b){b=String.format('{{"{0}":"{1}"}}',nJ.a.heading,b);this.ga.Zb(wb.a.wca,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}c4i(b){return!this.qb.lc(b)||this.qb.Aqc(b)||this.qb.TNa(b)||b.pr||""===b.characterData||b.characterData===this.tAk||!this.W4a.b$d(b)?!1:!0}hyo(b,h){const r=new Map;r.set("Source",this.jCd);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.k5a,r)}}Object(u.a)(oJ,"HeadingsActor",null,[]);class dx{jbp(b){return rd.ParagraphReader.WBa(this.bEi(b))}crd(b,
h,r){if(b=rd.ParagraphReader.GMa(this.bEi(b)))h=b.ug(h),Object(Pb.a)(33,h)&&(Xt.m(b)?h.l6o(r):h.crd())}bEi(b){return b&&b.nm&&b?b.node:null}}Object(u.a)(dx,"IFrameFocusStrategy",null,[303]);class tE{constructor(b){this.HJa=null;this.yGd=b}Bfj(){v.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}d$j(b){if(!b)return v.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,
375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.HJa=D.a.BGe(b.errorDetails.token,b.errorDetails.lcid);this.yGd.add(this.HJa,b.errorDetails.lcid);return!0}ssd(b){return b?b.token?D.a.BGe(b.token,b.lcid)===this.HJa:(v.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(u.a)(tE,"IgnoreAllProofingErrorStrategy",null,[304]);
var yO=e(1261),zO=e(590),RM=e(380);class Xq{constructor(b,h){this.filename=b;this.blob=h}}Object(u.a)(Xq,"UploadBlobParameters",null,[]);class qN extends Fc{constructor(b,h,r,A,L,ba,ra,Ia,Ta=null){super(b,h,r,null,L,ba,Ia,!1);this.YIk="DragAndDrop";this.enh="FileName";this.hnh=0;this.ROh=null;this.Wwd=this.krb=!1;this.klh=A;this.nFh=Ta}get Mek(){return"DragDropInsertImage"}get YT(){return this.YIk}get fileExtension(){return this.enh}get fileSize(){return this.hnh}get Nek(){return this.ROh}Ytd(b){const h=
new Xq(this.klh.name,this.klh);b.N3j(h);this.ROh=b.Wnb}PCa(b,h){this.nFh&&this.nFh();super.PCa(b,h)}oRg(b){const h=!!b&&this.yqa(b.name,null)&&this.qRg(b,null);b&&(this.enh=b.name,this.hnh=b.size);h||this.Jle();return h}}Object(u.a)(qN,"DragDropInsertImageUploader",Fc,[]);class Yq{constructor(b,h,r,A,L,ba,ra){this.W9c=ba;this.dX=ra;this.Rme=this.Sme=this.one=this.pne=0;this.ga=null;this.UBf=(Ia,Ta,ob)=>{if(Ze.a.d3d)return 8;Ia=Ta.node;return 1===ob?Ia?32:2:2===ob?(ob=pe.a.Io(Ta),Ta=pe.a.W6c(ob,Ta.node.hk().Hd,
y.AFrameworkApplication.J,y.AFrameworkApplication.ta.SYa),rH(Ta),32):2};this.Uhn=(Ia,Ta,ob)=>{const nb=this.ll.kma(Ta);if(2===ob&&nb){if(fb.a.qZ===Ia||fb.a.AYd===Ia)y.AFrameworkApplication.awa?y.AFrameworkApplication.mHg():this.nPl(Ta);return 32}return 1!==ob||fb.a.qZ!==Ia&&fb.a.AYd!==Ia?2:nb?32:2};this.cVb=(Ia,Ta,ob,nb,Eb)=>this.ll.kma(Ta)?1===ob?32:this.ll.sZf(Ta,Eb)?32:2:2;this.A5o=()=>{if(this.pb&&this.pb.ob&&this.pb.ob.currentSelection){const Ia=this.pb.ob.currentSelection.Ya;Ia&&this.pb.Uc(Tb.SelectionFactory.Ie(Ia.node,
Ia.cpBegin))}};this.a4l=(Ia,Ta,ob,nb,Eb)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Ia=Eb.DataTransfer)&&Ia.files&&0<Ia.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ia.files.length));for(ob=0;ob<Ia.files.length;ob++)nb=Ia.files[ob],0<=D.a.Ph(nb.type).indexOf("image")&&this.ghn(nb,Ta)&&(nb=this.pb.ob.currentSelection.Ya,this.pb.Uc(Tb.SelectionFactory.Ie(nb.node,nb.cpBegin+1)));this.LRa();return 32}v.ULS.sendTraceTag(42530334,307,15,
"Drag and drop local content not handled");return 2};this.ljo=(Ia,Ta,ob,nb,Eb)=>{if(2===ob)return y.AFrameworkApplication.va.Sf(Ta.Pk,Ia,ob,!0,nb,Eb);if(!Ta.view.Ee)return 8;Ia=Ta.view;if(!Ia.ub)return 8;Ia=Ia.ub.hh;Ia=Object(ak.a)().IQ(Ia);return 1===Ia.length&&this.GQ(Ia[0])?(this.aNn(),32):8};this.A_m=(Ia,Ta,ob)=>{if(!this.GQ(Ta))return 8;const nb=pe.a.Io(Ta),Eb=pe.a.XD(nb),bc=pe.a.iF(nb);Ia=Ia===fb.a.Fce;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ia});if(1===ob)return this.Jj.i5||
pe.a.Kcb(nb)?2:Ia&&Eb<this.Sme&&bc<this.Rme||!Ia&&Eb>this.pne&&bc>this.one?32:2;ob=Ia?1.1:.9;this.setSize(nb,Ta,Eb*ob,bc*ob,!0);return 32};this.jxc=(Ia,Ta,ob,nb,Eb)=>{if(!this.bta(Ta))return 8;Ia=pe.a.Io(Ta);Ta=pe.a.tYa(Ia);ob=pe.a.sYa(Ia);if(0>=Ta||0>=ob)return 2;Ia=pe.a.XD(Ia)/Ta*100;Eb.setValue(Pd.a.b$c,Ia);return 32};this.Soc=(Ia,Ta,ob,nb,Eb)=>{if(!this.bta(Ta))return 8;Ia=pe.a.Io(Ta);if(1===ob)return this.Jj.i5||pe.a.Kcb(Ia)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");var bc=
Eb.ka(Pd.a.b$c,-1)/100,Bc=Eb.ka(Pd.a.oVi,!1);const Yc=Eb.ka(Pd.a.vXf,!0);var zd=Eb.ka(Pd.a.wXf,!0);if(0>=bc)return Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.rvb}),2;const Jd=pe.a.tYa(Ia),ie=pe.a.sYa(Ia);ob=pe.a.XD(Ia);nb=pe.a.iF(Ia);if(0>=Jd||0>=ie)return Yq.Jc.qc(pf.a.C6,{["Reason"]:uf.a.rvb}),2;Bc?(Bc=Yc?bc*ob:ob,bc=zd?bc*nb:nb):(Bc=Yc?bc*Jd:ob,bc=zd?bc*ie:nb);Eb=Eb.ka(Pd.a.hVi,1);Eb=2==Eb||0==Eb||4==Eb||6==Eb;zd=this.IOf(Ta,Bc);Yq.wee&&zd<Bc&&(ob==zd&&(zd-=.001),Bc=zd,Eb&&(bc=zd/ob*nb));this.setSize(Ia,
Ta,Bc,bc);If.a.Gd().pn&&If.a.Gd().Qk.uI(Ta.node);this.LRa();return 32};this.S_b=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;Ia=pe.a.Io(Ta);Ia=pe.a.iF(Ia);if(0>=Ia)return 2;Eb.setValue(Pd.a.jNa,Ia);return 32};this.jNa=(Ia,Ta,ob,nb,Eb)=>{if(!this.bta(Ta))return 8;Ia=pe.a.Io(Ta);if(1===ob)return this.Jj.i5||pe.a.Kcb(Ia)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Eb=Eb.ka(Pd.a.jNa,0);nb=pe.a.Jcb(Ia);if(0>=Eb)return Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.rvb}),2;var bc=pe.a.tYa(Ia);
const Bc=pe.a.sYa(Ia),Yc=pe.a.XD(Ia);ob=pe.a.iF(Ia);ob=Yc/ob;if(0>=bc||0>=Bc)if(Yq.Jc.qc(pf.a.C6,{["Reason"]:uf.a.rvb}),this.OYj(Ia))return 2;nb=nb?Eb*ob:Yc;bc=this.IOf(Ta,nb);Yq.wee&&bc<nb&&(nb=bc,Eb=nb/ob);this.setSize(Ia,Ta,nb,Eb);If.a.Gd().pn&&If.a.Gd().Qk.uI(Ta.node);Db.StaticActiveAppFrame.Aa().Ne();return 32};this.T_b=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;Ia=pe.a.Io(Ta);Ia=pe.a.XD(Ia);if(0>=Ia)return 2;Eb.setValue(Pd.a.kNa,Ia);return 32};this.kNa=(Ia,Ta,ob,nb,Eb)=>{if(!this.bta(Ta))return 8;
Ia=pe.a.Io(Ta);if(1===ob)return this.Jj.i5||pe.a.Kcb(Ia)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");nb=Eb.ka(Pd.a.kNa,0);ob=pe.a.Jcb(Ia);if(0>=nb)return Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.rvb}),2;var bc=pe.a.tYa(Ia);const Bc=pe.a.sYa(Ia);var Yc=pe.a.XD(Ia);Eb=pe.a.iF(Ia);Yc=Eb/Yc;if(0>=bc||0>=Bc)if(Yq.Jc.qc(pf.a.C6,{["Reason"]:uf.a.rvb}),this.OYj(Ia))return 2;bc=nb;nb=this.IOf(Ta,nb);Yq.wee&&nb<bc&&(bc=nb);this.setSize(Ia,Ta,bc,ob?bc*Yc:Eb);If.a.Gd().pn&&If.a.Gd().Qk.uI(Ta.node);
Db.StaticActiveAppFrame.Aa().Ne();return 32};this.V_b=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;Ia=pe.a.Io(Ta);Ia=pe.a.Jcb(Ia);Eb.setValue(Pd.a.R1,Ia);return 32};this.R1=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;Ia=pe.a.Io(Ta);if(1===ob&&this.Jj.i5)return 2;If.a.Gd().pn&&If.a.Gd().Qk.uI(Ta.node);Eb&&(Ta=Eb.ka(Pd.a.R1,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.ll.bUj(Ia,Ta),Db.StaticActiveAppFrame.Aa().Ne());return 32};this.kfb=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;
Ia=pe.a.Io(Ta);Ia=pe.a.z1(Ia);Eb.setValue(Pd.a.Lub,Ia);return 32};this.Lub=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;if(1===ob)return this.Jj.i5?2:32;if(If.a.Gd().pn&&(Ia=Ta.node.ka(Kh.a.YL,kf.a.jw),Ia!==kf.a.jw&&(Ia=If.a.Gd().Qk.Atb(Ia),RM.a.getInstance().Lgb(Ia))))return Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),2;Ia=pe.a.Io(Ta);Eb=Eb.ka(Pd.a.Lub,null);this.ll.G1o(Ia,Ta,Eb);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Yd.Vv(13);return 32};this.jfb=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;
Ia=pe.a.Io(Ta);Ia=pe.a.nYa(Ia);Eb.setValue(Pd.a.P1,Ia);return 32};this.P1=(Ia,Ta,ob,nb,Eb)=>{if(!this.GQ(Ta))return 8;if(1===ob)return this.Jj.i5?2:32;if(If.a.Gd().pn&&(Ia=Ta.node.ka(Kh.a.YL,kf.a.jw),Ia!==kf.a.jw&&(Ia=If.a.Gd().Qk.Atb(Ia),RM.a.getInstance().Lgb(Ia))))return Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),2;Ia=pe.a.Io(Ta);Eb=Eb.ka(Pd.a.P1,null);this.ll.F1o(Ia,Ta,Eb);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Yd.Vv(13);return 32};this.fgb=(Ia,Ta,ob)=>{var nb,
Eb;if(1===ob)return 32;if(!Ta.view.Ee)return v.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ia),8;Ta=Ta.view;ob=null===(Eb=null===(nb=Ta.ub)||void 0===nb?void 0:nb.ob)||void 0===Eb?void 0:Eb.K(0);if(!ob)return v.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ia),8;Eb=ob.Ya;nb=this.dX.rg("UserAction",Ia.toString());let bc;Ia==fb.a.LAg?bc=this.W9c.fgb(Eb,2):Ia==fb.a.OAg?(bc=this.W9c.fgb(Eb,0),5==bc&&(bc=this.W9c.fgb(Eb,2))):Ia==fb.a.PAg&&(bc=this.W9c.fgb(Eb,
1),5==bc&&(bc=this.W9c.fgb(Eb,3)));switch(bc){case 4:Eb=32;Ta.c6();break;case 5:Eb=2;break;default:Eb=8}nb.stop();v.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",bc,nb.qj,Ia);return Eb};this.ll=b;this.Qo=h;this.Yd=r;this.Dh=A;this.pb=L;this.$d=Oe.a.ur?ej.a.getInstance(ne.a):ej.a.getInstance(Kj.a)}get Jj(){return fn.a.instance}get $ga(){return this.Qo.instance}get Tb(){return this.ga}Wen(){this.pne=rb.a.Zn(1,0);this.one=rb.a.Zn(1,1);this.Sme=rb.a.Zn(1920,0);this.Rme=
rb.a.Zn(1280,1)}mc(b){this.ga=b;const h=this.ljo,r=this.Uhn,A=this.cVb,L=this.A_m;b.nb(fb.a.qZ,ic.a.view,r,1284);b.qa(fb.a.cVb,ic.a.kd,A);b.qa(fb.a.LAg,ic.a.view,this.fgb);b.qa(fb.a.OAg,ic.a.view,this.fgb);b.qa(fb.a.PAg,ic.a.view,this.fgb);b.qa(fb.a.cVb,ic.a.image,A);b.Oc(fb.a.cVb,1284);b.nb(fb.a.AYd,ic.a.view,r,1284);b.nb(fb.a.Xqf,ic.a.view,h,1028);this.at(b,fb.a.Fce,L);this.at(b,fb.a.AHg,L);this.at(b,fb.a.jxc,this.jxc);this.at(b,fb.a.S_b,this.S_b);this.at(b,fb.a.T_b,this.T_b);this.at(b,fb.a.kfb,
this.kfb);this.at(b,fb.a.jfb,this.jfb);this.at(b,fb.a.Soc,this.Soc);this.at(b,fb.a.bBe,this.jNa);this.at(b,fb.a.cBe,this.kNa);this.at(b,fb.a.grd,this.Lub);this.at(b,fb.a.d2b,this.P1);this.at(b,fb.a.V_b,this.V_b);this.at(b,fb.a.R1,this.R1);this.at(b,fb.a.UBf,this.UBf);b.nb(fb.a.rni,ic.a.view,this.a4l,4);b.Oc(fb.a.Fce,4);b.Oc(fb.a.AHg,4);b.Oc(fb.a.jxc,69);b.Oc(fb.a.S_b,69);b.Oc(fb.a.T_b,69);b.Oc(fb.a.V_b,69);b.Oc(fb.a.kfb,69);b.Oc(fb.a.jfb,69);b.Oc(fb.a.R1,4);b.Oc(fb.a.Soc,4);b.Oc(fb.a.bBe,4);b.Oc(fb.a.cBe,
4);b.Oc(fb.a.grd,4);b.Oc(fb.a.d2b,4);this.Wen()}at(b,h,r){b.qa(h,ic.a.image,r);b.qa(h,ic.a.GRb,r);b.qa(h,ic.a.Nd,r);b.qa(h,ic.a.Fba,r)}nPl(b){new Fc(b,vb.TaskManager.instance,y.AFrameworkApplication.J,null,this.Dh,this.ga,new Dj.b)}TLp(b){return this.Jj.i5?(Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.ibm}),!1):Yq.Ig.t4(b)?(Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.EI}),!1):this.$ga&&this.$ga.wZ(b)?(Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.R$a}),
!1):!0}rsn(b){const h=pe.a.Io(b);return h&&5===pe.a.pl(h)&&this.M1i(b,h)}M1i(b,h){(h=!pe.a.JSb(h)&&!pe.a.$he(h))||Yq.Jc.qc(pf.a.Lo,{["Reason"]:uf.a.Oai});return h&&this.TLp(b)}ghn(b,h){var r,A;h=new qN(h,vb.TaskManager.instance,y.AFrameworkApplication.J,b,this.Dh,this.ga,this.pb,new Dj.b,this.A5o);if(h.oRg(b))Oe.a.ur?this.$d.logKpiUsage({kpiName:ne.d.TMa,kpiType:0}):(null===(A=y.AFrameworkApplication.J)||void 0===A?0:A.$("ShouldLogPicturesExtendedHealthKpis"))&&this.$d.logKpiUsage({kpiName:Kj.c.lNa,
kpiType:0});else return Oe.a.ur?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Sa.a,{extendedProperties:b}),this.$d.logKpiFailure({kpiName:ne.d.TMa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(Pg.c)(ne.d.Vnc)})):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Sa.a,{extendedProperties:b}),this.$d.logKpiFailure({kpiName:Kj.c.lNa,
errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Kj.c.Qoc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):Ca.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Cg.a(document.body,Object(E.a)(h,h.Myb,"onUploadFrameInitialized"),Object(E.a)(h,
h.wqa,"uploadResponseReceived"),y.AFrameworkApplication.J,!1,void 0,Se.a(y.AFrameworkApplication.J));return!0}GQ(b){return this.rsn(b)}bta(b){const h=pe.a.Io(b);if(!h)return!1;const r=Xa.a.instance.Wa("Box4.IFeatureHelper"),A=pe.a.pl(h);return 5===A||10===A||48===A||11===A||r&&r.isFeatureEnabled(43)&&4===A?this.M1i(b,h):!1}static get wee(){if(null!=Yq.u1g)var b=Yq.u1g;else{var h;y.AFrameworkApplication.ud("9h122341;23147890");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableImageResizeBug",
!1);b=Yq.u1g=b}return b}IOf(b,h){const r=new te.a;r.set(b.node);Ee.a.uw(r);return Yq.wee&&ih.TableCellReader.lda(r)?(b=te.a.kb(b.node),b.Ib(16),.92*b.xd(16).width):h}setSize(b,h,r,A,L=!1){If.a.Gd().pn&&If.a.Gd().Qk.uI(h.node);const ba=pe.a.Jcb(b);let ra=1;r>this.Sme?ra=this.Sme/r:r<this.pne&&(ra=this.pne/r);let Ia=1;A>this.Rme?Ia=this.Rme/A:A<this.one&&(Ia=this.one/A);if(ba||L)ra=Math.min(ra,Ia),Ia=Math.min(ra,Ia);1!==ra&&(r*=ra);1!==Ia&&(A*=Ia);this.wBf(b,h,r,A)}wBf(b,h,r,A){this.ll.M5o(b,h,r,A)}aNn(){v.ULS.sendTraceTag(20459969,
322,50,"PictureTools Tab enabled.")}LRa(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}OYj(b){const h=pe.a.tYa(b);b=pe.a.sYa(b);return 0>=h||0>=b}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}}Object(u.a)(Yq,"ImageActor",null,[]);
var AO=e(853);class uz{constructor(b,h,r,A,L,ba){this.oF=b;this.graphNode=h;this.C4=r;this.g_m=A;this.kna=L;this.ap=ba;this.OKc=new AO.a(this.Pp(),uz.QEc);if(Oe.a.ur||Oe.a.cX)this.$d=ej.a.getInstance(ne.a)}Kga(b){this.ZL("crop");this.ap.RW([7]);if(null===this.oF||void 0===this.C4||void 0===this.kna)return this.Ux("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;const r=this.kna.oYm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.Kfc(r,
h))return this.pxb("crop","Failed to apply and update"),this.Ux("crop","Failed to apply and update"),!1}catch(A){return this.pxb("crop",A),this.Ux("crop",A.stack?A.stack:A.message?A.message:A.toString()),!1}this.ap.gM([7]);this.V2();this.Gtc("crop");return!0}rotate(b){this.ZL("rotate");this.ap.RW([8]);if(null===this.oF||void 0===this.C4||void 0===this.kna)return this.Ux("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.oF.Pia.fLi();if(0!==b){const r=
this.kna.tYm();r.rotation=b;try{if(!this.Kfc(r,h))return this.Ux("rotate","Failed to apply and update"),!1}catch(A){return this.pxb("rotate",A),this.Ux("rotate",A.stack?A.stack:A.message?A.message:A.toString()),!1}}this.ap.gM([8]);this.V2();this.Gtc("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.ZL(r);this.ap.RW([9]);if(null===this.oF||void 0===this.C4||void 0===this.kna)return this.Ux(r,"Argument(s) invalid"),!1;const A=this.getGraphicData(r);if(void 0===A)return!1;const L=
this.kna.pYm();L.flip=this.kna.Kzm();L.flip.x=b;L.flip.y=h;try{if(!this.Kfc(L,A))return this.Ux(r,"Failed to apply and update"),!1}catch(ba){return this.pxb(r,ba),this.Ux(r,ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.ap.gM([9]);this.V2();this.Gtc(r);return!0}zYd(b,h,r){const A="changePictureBorderProps"+(void 0!==b?"_Weight":"")+(void 0!==h?"_DashType":"")+(void 0!==r?"_Color":"");this.ZL(A);this.ap.RW([10]);if(null===this.oF||void 0===this.C4||void 0===this.kna)return this.Ux(A,
"Argument(s) invalid"),!1;const L=this.getGraphicData(A);if(void 0===L)return!1;const ba=this.kna.mYm();void 0!==b&&(ba.weight=b);void 0!==h&&(ba.VO=h);void 0!==r&&(ba.color=r);try{if(!this.Kfc(ba,L))return this.pxb(A,"Failed to apply and update"),this.Ux(A,"Failed to apply and update"),!1}catch(ra){return this.pxb(A,ra),this.Ux(A,ra.stack?ra.stack:ra.message?ra.message:ra.toString()),!1}this.ap.gM([10]);this.V2();this.Gtc(A);return!0}resize(b,h){this.ZL("resize");this.ap.RW([11]);if(null===this.oF||
void 0===this.C4||void 0===this.kna)return this.Ux("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let A=0;var L=0;({width:A,height:L}=pe.a.Pab(this.oF));b/=A;h/=L;L=this.kna.uYm();L.scale=this.kna.GRm();L.scale.width=b;L.scale.height=h;try{if(!this.Kfc(L,r))return this.Ux("resize","Failed to apply and update"),!1}catch(ba){return this.pxb("resize",ba),this.Ux("resize",ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.ap.gM([11]);this.V2();
this.Gtc("resize");return!0}static get QEc(){return Xa.a.instance.Wa("Box4.ICssColorProvider")}reset(){this.ZL("resetPicture");this.ap.RW([28]);if(null===this.oF||void 0===this.C4||void 0===this.kna)return this.Ux("resetPicture","Argument(s) invalid"),!1;const b=this.oF.getValue(Me.a.WI);var h=this.ESb("resetPicture");if(void 0===h)return this.Ux("resetPicture","Failed to get graphicData"),!1;const r=this.kna.sYm();r.k5l={rotation:!0,Kga:!0,flipH:!0,flipV:!0};try{if(!this.Kfc(r,h))return this.Ux("resetPicture",
"Failed to apply and update"),!1}catch(A){return this.pxb("resetPicture",A),this.Ux("resetPicture",A.stack?A.stack:A.message?A.message:A.toString()),!1}h=this.oF.getValue(Me.a.WI);v.ULS.sendTraceTag(507885147,322,50,h===b?"Reset applied but did not change the picture.":"Reset applied but changed the picture.");this.ap.gM([28]);this.V2();this.Gtc("resetPicture");return!0}ESb(b){try{const h=this.OKc.Rbe();return this.oF.ESb(h)}catch(h){this.Ux(b,h.stack?h.stack:h.message?h.message:h.toString())}}getGraphicData(b){try{const h=
this.OKc.Rbe();return this.oF.getGraphicData(h)}catch(h){this.Ux(b,h.stack?h.stack:h.message?h.message:h.toString())}}Kfc(b,h){this.C4.apply(b,h);b=this.oF.iSb(h);if(void 0===b)return!1;this.DCp(b);return!0}DCp(b){const h=new hb.GraphTransaction(15);h.Eb(this.graphNode);this.oF.setValue(Me.a.WI,b.WI);this.g_m.PSo(b.Mri,b.vEa,this.oF);h.dispose()}Pp(){return Object(ao.a)().kw(this.graphNode)}ZL(b){const h=this.tUg;h.trb=b;v.ULS.sendTraceTag(509657553,322,50,"{0}",h)}Ux(b,h){const r=this.tUg;r.message=
h;r.trb=b;v.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get tUg(){return{["id"]:pe.a.vtb(this.oF),["type"]:pe.a.pl(this.oF)}}Gtc(b){Oe.a.ur&&this.$d.logKpiSuccess({kpiName:ne.d.Ace+ne.b.U7d+b+Kv.a[pe.a.pl(this.oF)].toString()})}pxb(b,h){if(Oe.a.ur){const {width:r,height:A}=pe.a.Pab(this.oF);h=Object.assign(new Sa.a,{extendedProperties:new Map([["Exception",h.message?h.message:h.toString()]])});h.extendedProperties.set("ErrorLevel","warning");this.$d.logKpiFailure({kpiName:ne.d.Ace+ne.b.U7d+b+Kv.a[pe.a.pl(this.oF)].toString(),
errorName:"DrawingResponseInvalid"+Object(Pg.b)(A,r),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:h},optionalVeto:Object(Pg.c)(ne.d.HQi,h,null,!1)})}}V2(){if(Oe.a.cX){var b=this.ap.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new Sa.a,{durationMs:r}),hasImpliedUsage:!0},this.$d.logKpiSuccess({kpiName:ne.d.Awc+Dj.a[h]+Kv.a[pe.a.pl(this.oF)].toString(),optionalProperties:b}),this.ap.Zxc(Number(h))}}}Object(u.a)(uz,"EditWithGC2Command",null,[]);
class LA{PSo(b,h,r){this.xIn(b,h);this.SSo(r)}xIn(b,h){this.EL=Array(4);this.EL[zm.a.left]=b.KCf;this.EL[zm.a.top]=b.MCf;this.EL[zm.a.right]=b.LCf;this.EL[zm.a.bottom]=b.JCf;this.xXa=b.xXa;this.yXa=b.yXa;(this.vEa=h)&&this.BHl()}SSo(b){b.setValue(Me.a.wDa,Math.round(this.xXa).toString());b.setValue(Me.a.xDa,Math.round(this.yXa).toString());const h=Array(4);this.EL.forEach((r,A)=>{h[A]=Math.round(r).toString()});b.setValue(Me.a.GYa,h);b.setValue(Me.a.ucb,this.vEa)}BHl(){this.Xnp();const b=this.xXa/
2,h=this.yXa/2;this.xXa%2&&0===this.yXa%2?(--this.EL[zm.a.left],++this.EL[zm.a.top]):this.yXa%2&&0===this.xXa%2&&(++this.EL[zm.a.left],--this.EL[zm.a.top]);this.EL[zm.a.left]+=b-h;this.EL[zm.a.right]-=b-h;this.EL[zm.a.top]+=h-b;this.EL[zm.a.bottom]-=h-b}Xnp(){const b=this.xXa;this.xXa=this.yXa;this.yXa=b}}Object(u.a)(LA,"GraphicsExtents",null,[]);var tM=e(1141),uM=e(1142),xL=e(544);class yL{constructor(){this.XNp={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,
["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.FTl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8};this.djo={["background1"]:0,["text1"]:1,["background2"]:2,["text2"]:3,["accent1"]:4,["accent2"]:5,["accent3"]:6,["accent4"]:7,["accent5"]:8,["accent6"]:9};this.cjo={[0]:"background1",
[1]:"text1",[2]:"background2",[3]:"text2",[4]:"accent1",[5]:"accent2",[6]:"accent3",[7]:"accent4",[8]:"accent5",[9]:"accent6"};this.wii={ZPa:{Wwc:1}};this.zii=.75;this.xii=0;this.Rrp=8;this.bZn=6}utp(b,h){if(b){var r=this.gMm(b);h=h.Pia.zae();b.On=void 0===r?!1:r===h}}ttp(b,h){if(b){var r=this.tJi(b);h=h.Pia.PPf();b.On=void 0===r||void 0===h?!1:r===h}}static M7c(b){return b.Pia.M7c()}UUm(b){var h=b.ZPa;b=this.cjo[h.Wwc];const r=h.NKa.gme;h=h.NKa.fme;let A,L;void 0!=r?A=r:void 0!=h&&(L=100-h);return{Wwc:b,
NKa:{whb:A,gAc:L}}}mea(b,h,r){var A;const L=null===(A=w())||void 0===A?void 0:A.Jma();h=new uz(b,h,L,new LA,z(),new Dj.b);r=this.xJi(r);if(void 0===r)return!1;A=!!b.Pia.M7c();b=void 0!==b.Pia.PPf();return h.zYd(r,b?void 0:this.xii,A?void 0:this.wii)}f4o(b,h,r){var A;const L=null===(A=w())||void 0===A?void 0:A.Jma();h=new uz(b,h,L,new LA,z(),new Dj.b);r=this.tJi(r);if(void 0===r)return!1;A=!!b.Pia.M7c();b=!!b.Pia.zae();return h.zYd(b?void 0:this.zii,r,A?void 0:this.wii)}g6(b,h,r){var A;const L=null===
(A=w())||void 0===A?void 0:A.Jma();A=new uz(b,h,L,new LA,z(),new Dj.b);h=this.dMm(r,h);if(void 0===h)return!1;r=!!b.Pia.zae();b=void 0!==b.Pia.PPf();return A.zYd(r?void 0:this.zii,b?void 0:this.xii,h)}Yxc(b,h){var r;const A=null===(r=w())||void 0===r?void 0:r.Jma();return(new uz(b,h,A,new LA,z(),new Dj.b)).zYd()}dMm(b,h){if(b.length===this.Rrp){b=parseInt(b,16)>>>24;h=Object(ao.a)().kw(h);h=lp.Kxp(b-1,h);if(void 0===h){v.ULS.sendTraceTag(508692042,322,15,`getPictureBorderColorFromActionData: Could not find theme color info for color index ${b}`);
return}b=this.djo[h.iGe];if(void 0===b){v.ULS.sendTraceTag(508683782,322,15,`getPictureBorderColorFromActionData: Could not find preset scheme color for ${h.iGe}`);return}const r=void 0!==h.whb?100-h.whb:100-h.gAc;return{ZPa:{Wwc:b,NKa:{fme:r,gme:void 0!==h.whb?100-r:void 0}}}}if(b.length===this.bZn)return{upd:"#"+D.a.yL(Xl.a.cpb(parseInt(b,16)),6)};v.ULS.sendTraceTag(508692041,322,15,"setPictureBorderColor: Invalid action data received.")}gMm(b){b=this.xJi(b);if(void 0!==b)return b=rb.a.F2(b,0,!1),
rb.a.oog(b)}xJi(b){b=this.XNp[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692040,322,15,"getPictureBorderWeightFromActionDataInPoints: Invalid action data received.");return b}tJi(b){b=this.FTl[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692039,322,15,"getPictureBorderDashTypeFromActionData: Invalid action data received.");return b}}Object(u.a)(yL,"Gc2PictureBorderHelper",null,[]);var rN=e(398),BO=e(448),CO=e(1349);class Ho extends Yq{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){super(b,
h,A,ba,ra,Ia,Ta);this.tzh=!1;this.pWe=this.Ifa=null;this.Nz=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;if(1===bc)return this.Jj.i5?2:32;nb=parseInt(Yc);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+nb);this.WOd.Gto(Eb,pe.a.Io(Eb),nb);this.cfd(Eb);this.LRa();return 32};this.resetPicture=(nb,Eb,bc)=>{if(!this.GQ(Eb))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");nb=pe.a.Io(Eb);if(1===bc)return this.Jj.i5?2:32;bc=pe.a.Rab(nb);bc===xp.a.Dfb?(bc=new hb.GraphTransaction(15),
bc.Eb(Eb.node),pe.a.Zpc()?nb.setValue(Rc.a.c_b,""):this.fL.nGo(nb),bc.dispose(),this.mRc.create(nb,Eb).Nz(Og.a.iMj),this.cfd(Eb)):bc===xp.a.AWh&&this.mRc.create(nb,Eb).Nz(Og.a.iMj);return 32};this.i1m=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;nb=pe.a.Io(Eb);if(1===bc)return this.Jj.i5||pe.a.Hqc(nb)?2:32;Yc&&(this.fL.SCc(nb,Eb),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Db.StaticActiveAppFrame.Aa().Ne());this.LRa();return 32};this.j1m=(nb,Eb,bc,Bc,Yc)=>{var zd;if(!this.GQ(Eb))return 8;
if(1===bc)return this.Jj.i5?2:32;nb=pe.a.Io(Eb);if(Yc){bc=pe.a.Gge(pe.a.Io(Eb));v.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+bc);Bc=Yc.ka(Pd.a.Qub,0);const ie=Yc.ka(Pd.a.Nub,0),re=Yc.ka(Pd.a.Oub,0);Yc=Yc.ka(Pd.a.Pub,0);var Jd=pe.a.oha(nb);const me=Jd.bottom,Sd=Jd.left,cf=Jd.right;if(Bc===Jd.top&&ie===me&&re===Sd&&Yc===cf)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(Object(Li.d)(nb)&&(Jd=null===(zd=
w())||void 0===zd?void 0:zd.Jma(),(new uz(nb,Eb.node,Jd,new LA,z(),new Dj.b)).Kga({top:.001*Bc,bottom:.001*ie,left:.001*re,right:.001*Yc})))return 32;bc?(new tM.a(nb,new uM.a,new Dj.b)).p_o(Bc,ie,re,Yc,this.J3n,Eb):this.WOd.wto(Eb,pe.a.Io(Eb),Bc,ie,re,Yc);this.cfd(Eb);Db.StaticActiveAppFrame.Aa().Ne()}return 32};this.Nce=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;Bc=pe.a.Io(Eb);if(1===bc)return this.Jj.i5||pe.a.Hqc(Bc)?2:32;if(Yc){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");
this.fL.hoa()||this.fL.SCc(Bc,Eb);switch(nb){case Lc.a.S9c:nb=Yc.ka(Pd.a.Qub,-1);bc=0;break;case Lc.a.P9c:nb=Yc.ka(Pd.a.Nub,-1);bc=1;break;case Lc.a.Q9c:nb=Yc.ka(Pd.a.Oub,-1);bc=2;break;case Lc.a.R9c:nb=Yc.ka(Pd.a.Pub,-1);bc=3;break;default:return 8}this.fL.lFp(nb,bc);this.cfd(Eb);Db.StaticActiveAppFrame.Aa().Ne()}return 32};this.xzb=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;Yc&&(nb=this.fL.hoa(),Yc.setValue(Pd.a.hoa,nb));return 32};this.ixc=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;nb=pe.a.Io(Eb);
if(Yc){if(this.fL.hoa())({top:zd,bottom:bc,left:nb,right:Eb}=this.fL.evm());else{Bc=rb.a.Rf(pe.a.XD(nb),0);var zd=rb.a.Rf(pe.a.iF(nb),1);Eb=pe.a.oha(nb);const Jd=Math.max(Eb.top,0);bc=Math.max(Eb.bottom,0);nb=Math.max(Eb.left,0);Eb=Math.max(Eb.right,0);Bc=1E5*Bc/(1E5-(nb+Eb));const ie=1E5*zd/(1E5-(Jd+bc));zd=Math.floor(Jd*ie/1E5);bc=Math.floor(bc*ie/1E5);nb=Math.floor(nb*Bc/1E5);Eb=Math.floor(Eb*Bc/1E5)}Yc.setValue(Pd.a.Qub,zd);Yc.setValue(Pd.a.Nub,bc);Yc.setValue(Pd.a.Oub,nb);Yc.setValue(Pd.a.Pub,
Eb)}return 32};this.Znc=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;if(1===bc){if(this.Jj.i5)return 2;this.yOn();return 32}nb=pe.a.Io(Eb);this.fL.hoa()&&this.fL.SCc(nb,Eb);nb=Yc.ka(Pd.a.AQa,"");Yc=Yc.ka(Pd.a.rib,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:Yc,["SourceControlId"]:nb});switch(Yc){case 1:this.fL.H6o(Eb);break;case 8:this.fL.UBe(Eb,Xw.a.v3b,1);break;case 9:this.fL.UBe(Eb,Xw.a.v3b,3);break;case 3:this.fL.UBe(Eb,Xw.a.none,void 0,!0);break;case 4:this.fL.UBe(Eb,
Xw.a.none,void 0,!1)}this.LRa();Db.StaticActiveAppFrame.Aa().Ne();return 32};this.Bxc=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;nb=pe.a.Io(Eb);Eb=pe.a.v9(Eb);bc=pe.a.h5(nb);Bc=pe.a.Wtb(nb);nb=pe.a.VA(nb);return this.uto(Eb,bc,Bc,nb,Yc)?32:8};this.l1m=(nb,Eb,bc,Bc,Yc)=>{var zd;if(!this.bta(Eb))return 8;Bc=pe.a.Io(Eb);if(1===bc)return id.SessionStatusManager.instance.zk?8:this.Jj.i5||pe.a.Iqc(Bc)?2:32;this.fL.hoa()&&this.fL.SCc(Bc,Eb);if(Yc){const ie=Yc.ka(Pd.a.Z9c,0),re=pe.a.Gge(Bc);v.ULS.sendTraceTag(22052889,
322,50,"SetImageRotateAction: {0}, isCanvas: {1}",ie,re);bc=pe.a.N4(Bc);var Jd=pe.a.Jua(Bc);let me=Jd.ssb;Jd=Jd.lMa;switch(ie){case 0:bc=Yc.ka(Pd.a.mZ,0);break;case 2:bc-=90;bc=Pg.e(bc);break;case 1:bc+=90;bc=Pg.e(bc);break;case 4:me=!me;break;case 3:Jd=!Jd;break;case 5:bc+=Yc.ka(Pd.a.mZ,0),bc=Pg.e(bc)}if(Object(Li.d)(Bc))if(Yc=null===(zd=w())||void 0===zd?void 0:zd.Jma(),zd=new uz(Bc,Eb.node,Yc,new LA,z(),new Dj.b),4===ie){if(zd.flip(!0,!1))return 32}else if(3===ie){if(zd.flip(!1,!0))return 32}else if(zd.rotate(bc))return 32;
re?(new tM.a(Bc,new uM.a,new Dj.b)).c5o(bc,me,Jd,this.T9n,Eb):ie?this.mRc.create(Bc,Eb).h4o(bc,me,Jd):(zd=qb.a.create(),Yc=new hb.GraphTransaction(15,fb.a.k9),Yc.Eb(Eb.node),this.fL.P1o(Bc,bc),this.WOd.Cto(Eb,pe.a.Io(Eb),bc,zd),Yc.sOa(zd,1),Yc.Bh=nb,Yc.dispose());this.LRa();this.cfd(Eb);Db.StaticActiveAppFrame.Aa().Ne()}return 32};this.U_b=(nb,Eb,bc,Bc,Yc)=>{if(!this.GQ(Eb))return 8;nb=pe.a.Io(Eb);nb=pe.a.N4(nb);if(0>nb)return 2;Yc.setValue(Pd.a.mZ,nb);return 32};this.T9n=(nb,Eb,bc,Bc)=>{if(nb){const Yc=
new hb.GraphTransaction(15,fb.a.k9);Yc.Eb(Bc.node);Eb.setValue(Pd.a.jOb,JSON.stringify(bc));Eb.setValue(Pd.a.Iw,nb);this.fL.fBe(Eb,bc.rotationAngle,bc.xoc,bc.lEc);this.ZRb(Eb);Yc.dispose()}};this.B9n=(nb,Eb,bc,Bc)=>{if(nb){const Yc=new hb.GraphTransaction(15);Yc.Eb(Bc.node);Eb.setValue(Pd.a.jOb,JSON.stringify(bc));Eb.setValue(Pd.a.Iw,nb);this.fL.MAe(Eb,bc.RHe,bc.dwd);this.ZRb(Eb);Yc.dispose()}};this.J3n=(nb,Eb,bc,Bc)=>{if(nb){const Yc=new hb.GraphTransaction(15);Yc.Eb(Bc.node);Eb.setValue(Pd.a.jOb,
JSON.stringify(bc));Eb.setValue(Pd.a.Iw,nb);this.fL.J1o(Eb,Math.round(bc.mLa*xL.a.Nqb),Math.round(bc.jLa*xL.a.Nqb),Math.round(bc.kLa*xL.a.Nqb),Math.round(bc.lLa*xL.a.Nqb));this.ZRb(Eb);Yc.dispose()}};this.q2m=(nb,Eb,bc)=>{var Bc;nb=pe.a.Io(Eb);const Yc=nb.getValue(Me.a.l8c);if(!Object(Li.d)(nb)||!this.GQ(Eb)||!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isResetPictureEnabled",!1)||5!==nb.getValue(Rc.a.gu)||1!==Yc.length)return 8;if(1===bc)return this.Jj.i5?2:32;this.fL.hoa()&&
this.fL.SCc(nb,Eb);bc=null===(Bc=w())||void 0===Bc?void 0:Bc.Jma();return(new uz(nb,Eb.node,bc,new LA,z(),new Dj.b)).reset()?32:8};this.Okd=(nb,Eb,bc,Bc,Yc)=>{if(!this.bta(Eb))return 8;if(1===bc)return 32;nb=this.Pp(Eb);if(!nb)return 8;bc=pe.a.Io(Eb);Object(Li.d)(bc)?(Eb=yL.M7c(bc),void 0===Eb?Eb=Ho.xkd.dea="":void 0!==Eb.ZPa?(Eb=(new yL).UUm(Eb),Ho.xkd.dea=Eb,Eb=""):Eb=Ho.xkd.dea=Eb.upd):(Eb=this.Lq.sJi(Ej.a.cW(Eb),bc),Ho.xkd.dea=Eb);this.vK&&this.vK.YCb(Eb);Eb=Ho.xkd.Gsb(nb,Ze.a.tWa);if(!Eb)return 8;
Yc.MenuItems=Eb;return 32};this.g6=(nb,Eb,bc,Bc,Yc)=>{if(!this.bta(Eb))return 8;Bc=pe.a.Io(Eb);if(Object(Li.d)(Bc)){if(!pe.a.nqf(Bc))return 2}else if(Bc&&pe.a.QB(Bc))return 2;if(1===bc)return 32;if(2!==bc)return 2;if(!Yc)return v.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;if(Object(Li.d)(Bc)){if(!this.ylc.g6(Bc,Eb.node,Yc))return 8}else{bc=new hb.GraphTransaction(15);bc.Eb(Eb.node);const zd=Ho.oya.sma(Eb.node,Yc);this.Lq.g6(Bc,Yc,Eb,zd);this.ZRb(Bc);bc.dispose()}nb==
fb.a.Crd&&this.vK.bKa(Yc);this.dzd();this.LRa();return 32};this.K5=(nb,Eb,bc)=>{if(!this.bta(Eb))return 8;if(1===bc)return 32;Db.StaticActiveAppFrame.Aa().dismissFloatie();Ho.MHa=new Vs("PictureBorder",fb.a.Crd);Ho.MHa.pBb(0);return 32};this.mea=(nb,Eb,bc,Bc,Yc)=>{if(!this.bta(Eb))return 8;if(1===bc)return 32;nb=pe.a.Io(Eb);if(Object(Li.d)(nb)){if(!pe.a.nqf(nb))return 2}else if(nb&&pe.a.QB(nb))return 2;if(!Yc)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;
if(Object(Li.d)(nb)){if(!this.ylc.mea(nb,Eb.node,Yc))return 8}else bc=new hb.GraphTransaction(15),bc.Eb(Eb.node),this.Lq.mea(nb,Yc,Eb),this.ZRb(nb),bc.dispose();this.dzd();this.LRa();return 32};this.Cgb=(nb,Eb,bc,Bc,Yc)=>{if(!this.bta(Eb))return 8;if(1===bc)return 32;nb=pe.a.Io(Eb);if(Object(Li.d)(nb)){if(!pe.a.nqf(nb))return 2}else if(nb&&pe.a.QB(nb))return 2;if(!Yc)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;if(Object(Li.d)(nb)){if(!this.ylc.f4o(nb,Eb.node,
Yc))return 8}else bc=new hb.GraphTransaction(15),bc.Eb(Eb.node),this.Lq.Cgb(nb,Yc,Eb),this.ZRb(nb),bc.dispose();this.dzd();this.LRa();return 32};this.Yxc=(nb,Eb,bc)=>{if(!this.bta(Eb))return 8;if(1===bc)return 32;nb=pe.a.Io(Eb);if(Object(Li.d)(nb)){if(!this.ylc.Yxc(nb,Eb.node))return 8}else bc=new hb.GraphTransaction(15),bc.Eb(Eb.node),pe.a.ioc(nb)&&(this.Lq.Yxc(nb),this.ZRb(nb)),bc.dispose();this.dzd();this.LRa();return 32};this.fL=b;this.mRc=r;this.WOd=L;Ho.mi=ob;null===ra||void 0===ra?void 0:ra.BD(Ho.crl)}get vK(){return null!=
this.c8g?this.c8g:this.c8g=Xa.a.instance.Wa("Box4.UI.RecentColorsSectionHandler")}static crl(){Ho.mjo()}get Lq(){this.Ifa||(this.Ifa=new rN.a);return this.Ifa}get ylc(){this.pWe||(this.pWe=new yL);return this.pWe}mc(b){super.mc(b);this.at(b,fb.a.Nz,this.Nz);b.Oc(fb.a.Nz,4);this.at(b,fb.a.resetPicture,this.resetPicture);this.at(b,Lc.a.xKe,this.Znc);b.Oc(Lc.a.xKe,4);this.at(b,Lc.a.yKe,this.Znc);this.at(b,Lc.a.zKe,this.Znc);this.at(b,Lc.a.AKe,this.Znc);this.at(b,Lc.a.BKe,this.Znc);this.at(b,Lc.a.CKe,
this.Znc);this.at(b,Lc.a.Bxc,this.Bxc);b.Oc(Lc.a.Bxc,101);this.at(b,Lc.a.O9c,this.i1m);b.Oc(Lc.a.O9c,4);this.at(b,Lc.a.xzb,this.xzb);b.Oc(Lc.a.xzb,101);this.at(b,Lc.a.gVi,this.j1m);this.at(b,Lc.a.S9c,this.Nce);this.at(b,Lc.a.P9c,this.Nce);this.at(b,Lc.a.Q9c,this.Nce);this.at(b,Lc.a.R9c,this.Nce);this.at(b,Lc.a.Xld,this.ixc);b.Oc(Lc.a.Xld,101);this.at(b,Lc.a.jve,this.ixc);b.Oc(Lc.a.jve,101);this.at(b,Lc.a.kve,this.ixc);b.Oc(Lc.a.kve,101);this.at(b,Lc.a.lve,this.ixc);b.Oc(Lc.a.lve,101);this.at(b,fb.a.k9,
this.l1m);b.Oc(fb.a.k9,4);this.at(b,fb.a.U_b,this.U_b);b.Oc(fb.a.U_b,101);this.at(b,fb.a.hMj,this.q2m);this.at(b,fb.a.Okd,this.Okd);b.Oc(fb.a.Okd,4);this.at(b,fb.a.g6,this.g6);b.Oc(fb.a.g6,4);this.at(b,fb.a.Crd,this.g6);b.Oc(fb.a.Crd,4);this.at(b,fb.a.Jlg,this.K5);b.Oc(fb.a.Jlg,4);this.at(b,fb.a.zFa,this.zFa.bind(this));b.Oc(fb.a.zFa,4);this.at(b,fb.a.mea,this.mea);b.Oc(fb.a.mea,4);this.at(b,fb.a.W_b,this.W_b.bind(this));b.Oc(fb.a.W_b,4);this.at(b,fb.a.Cgb,this.Cgb);b.Oc(fb.a.Cgb,4);this.at(b,fb.a.Nfg,
this.Yxc);b.Oc(fb.a.Nfg,4)}wBf(b,h,r,A){var L;v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+pe.a.Gge(b));this.fL.hoa()&&this.fL.SCc(b,h);if(Object(Li.d)(b)){const ba=null===(L=w())||void 0===L?void 0:L.Jma();if((new uz(b,h.node,ba,new LA,z(),new Dj.b)).resize(r,A))return}pe.a.QB(b)?(b=qb.a.create(),L=new hb.GraphTransaction(15),L.Eb(h.node),this.WOd.Bto(h,pe.a.Io(h),r,A,b),L.sOa(b,1),L.dispose()):pe.a.DAc(b)?(new tM.a(b,new uM.a,new Dj.b)).M4o(r,A,this.B9n,h):(super.wBf(b,
h,r,A),this.Yd.Vv(13))}GQ(b){if(!b.nm)return!1;var h=b.node;return(h=Object(Li.c)()?h instanceof pt.a||h instanceof CO.a?h:null:Object(ya.a)(pt.a,h))&&Xt.n(h)?(Yq.Jc.qc(yO.a.Lo,{["Reason"]:zO.a.NS}),!1):super.GQ(b)}static mjo(){Ho.eJb||(Ho.mi.GVa(Ho.pyb),Ho.eJb=!0)}uto(b,h,r,A,L){return L?(L.q3i=b,L.h5=h,L.jCb=r,L.Dz=A,L.rib=Ho.BYm(L),!0):!1}cfd(b){If.a.Gd().pn&&If.a.Gd().Qk.uI(b.node)}yOn(){this.tzh||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.tzh=!0)}ZRb(b){const h=BO.a.instance.BEf(b);
this.fL.dBe(b,h[zm.a.left],h[zm.a.right],h[zm.a.top],h[zm.a.bottom])}Pp(b){return b.contextId===ic.a.view?fn.a.instance.lTb(b):Object(ao.a)().kw(b.node)}zFa(b,h,r,A,L){if(!this.bta(h))return 8;2===r&&(b=pe.a.Io(h),Object(Li.d)(b)?this.ylc.utp(L,b):this.Lq.bqk(L,b));return 32}W_b(b,h,r,A,L){if(!this.bta(h))return 8;2===r&&(b=pe.a.Io(h),Object(Li.d)(b)?this.ylc.ttp(L,b):this.Lq.aqk(L,b));return 32}dzd(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const b=Xa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get oya(){return null!=Ho.K$g?Ho.K$g:Ho.K$g=Sm.a.instance}static get xkd(){Ho.aI||(Ho.aI=new lp("PictureBorder"),Ho.Nha(Ho.aI));return Ho.aI}static BYm(b){if(b.q3i)b=1;else switch(b.jCb){case Xw.a.none:b=b.h5?3:4;break;case Xw.a.v3b:b=1===b.Dz?8:3===b.Dz?9:2;break;case Xw.a.jvd:b=5;break;case Xw.a.t6j:b=6;break;
case Xw.a.n6j:b=7;break;default:b=0}return b}static Nha(b){b.bH(3,fb.a.g6);b.bH(4,fb.a.g6);b.bH(5,fb.a.Crd);b.bH(6,fb.a.g6);b.q8a(nu.a.instance,1)}}Ho.eJb=!1;Ho.aI=null;Ho.MHa=null;Ho.pyb=()=>{Ho.mi.cyc(Ho.pyb);Ho.eJb=!1;if(mh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else v.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};
Object(u.a)(Ho,"ImageActor",Yq,[]);class jm{static get gm(){return null!=jm.r7g?jm.r7g:jm.r7g=Xa.a.instance.resolve("Box4.IParagraphEditor")}static get lE(){return null!=jm.C7g?jm.C7g:jm.C7g=Xa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get Q5(){return jm.gm.Hs}static get Dh(){return null!=jm.Oah?jm.Oah:jm.Oah=Xa.a.instance.resolve("Box4.IUndoManager")}static mc(){const b=y.AFrameworkApplication.va;b.qa(fb.a.H_b,ic.a.view,hn.a.oz);b.qa(fb.a.H_b,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.H_b,
1036);b.qa(fb.a.dQb,ic.a.view,hn.a.oz);b.qa(fb.a.dQb,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.dQb,1036);b.qa(fb.a.erb,ic.a.view,hn.a.oz);b.qa(fb.a.erb,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.erb,1036);b.qa(fb.a.Vxc,ic.a.view,hn.a.oz);b.qa(fb.a.Vxc,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Vxc,1036);b.qa(fb.a.Ynd,ic.a.view,hn.a.oz);b.qa(fb.a.Ynd,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Ynd,1036);b.qa(fb.a.Ubb,ic.a.view,hn.a.oz);b.qa(fb.a.Ubb,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Ubb,1036);b.qa(fb.a.Wub,ic.a.view,hn.a.oz);b.qa(fb.a.Wub,
ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Wub,1036);b.qa(fb.a.Tbb,ic.a.view,hn.a.oz);b.qa(fb.a.Tbb,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Tbb,1036);b.qa(fb.a.hBe,ic.a.view,jm.cEe);b.qa(fb.a.hBe,ic.a.paragraph,jm.cEe);b.Oc(fb.a.hBe,1028);b.qa(fb.a.jDg,ic.a.view,jm.cEe);b.qa(fb.a.jDg,ic.a.paragraph,jm.cEe);b.Oc(fb.a.jDg,1028);b.qa(fb.a.w2b,ic.a.view,hn.a.oz);b.qa(fb.a.w2b,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.w2b,1036);b.qa(fb.a.ZAb,ic.a.view,hn.a.oz);b.qa(fb.a.ZAb,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.ZAb,1036);b.qa(fb.a.x2b,
ic.a.view,hn.a.oz);b.qa(fb.a.x2b,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.x2b,1036);b.qa(fb.a.gIg,ic.a.view,hn.a.oz);b.Oc(fb.a.gIg,1028);b.qa(fb.a.Mrd,ic.a.view,hn.a.oz);b.qa(fb.a.Mrd,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Mrd,1036);b.qa(fb.a.Nrd,ic.a.view,hn.a.oz);b.qa(fb.a.Nrd,ic.a.paragraph,jm.Wsa);b.Oc(fb.a.Nrd,1036)}static cEe(b,h,r,A,L){2===r&&""===L[vi.a.Text]&&(b=b===fb.a.hBe?fb.a.Ubb:fb.a.Tbb,h=new UF.a,h.value=0,h.unit=Ze.a.ONa?2:1,y.AFrameworkApplication.va.Zb(b,2,h),Db.StaticActiveAppFrame.Aa().Ne());
return 32}static Wsa(b,h,r,A,L){if(!({xB:r}=hn.a.yFg(r,h)).returnValue)return r;h=h.node;switch(b){case fb.a.H_b:jm.Q5.hrg(h,!0);break;case fb.a.dQb:jm.Q5.hrg(h,!1);break;case fb.a.erb:jm.Q5.erb(h);break;case fb.a.Vxc:jm.Q5.pja(h,0);break;case fb.a.Ynd:jm.Q5.JAb(h,0);break;case fb.a.Wub:case fb.a.Ubb:r=new te.a;r.set(h);r.Ib(11);let ba=L.value;L=L.unit;b===fb.a.Wub&&(ba=(new yl.a(L,ba)).ww+jm.lE.cK(h).ww,L=1);jm.Q5.Jxa(r,L,ba);break;case fb.a.Tbb:jm.Q5.LAb(h,L.unit,L.value);break;case fb.a.w2b:L?
(b=(new yl.a(L.unit,L.value)).ww,jm.Q5.pja(h,b)):jm.lE.P9d(h).ww||jm.Q5.pja(h,il.a.u1(h));break;case fb.a.ZAb:L?(b=(new yl.a(L.unit,L.value)).ww,jm.Q5.JAb(h,b)):jm.lE.cK(h).ww||jm.Q5.JAb(h,il.a.u1(h));break;case fb.a.x2b:jm.Q5.pja(h,0);break;case fb.a.Mrd:b=L;b=(new yl.a(b.unit,b.value)).ww;jm.Q5.bEg(h,1,b);break;case fb.a.Nrd:b=L,b=(new yl.a(b.unit,b.value)).ww,jm.Q5.bEg(h,2,b)}jm.Dh.eK();A&&ru.a.fCb&&(A.Av|=ru.a.gtb(h));return 32}}Object(u.a)(jm,"IndentationActor",null,[]);var sN=e(835),DO=e(66),
zL=e(435),EO=e(1045);class mq{constructor(b){this.A6a=this.SJa=this.pPc=null;this.eQh=!1;this.wue=h=>{if(this.SJa)if(h===wb.a.vue)Jc.FocusManager.instance().getRegion(Df.AFrame.wPa).quc();else if(h===wb.a.uue)Jc.FocusManager.instance().getRegion(Df.AFrame.wPa).ouc();else return 2;else return 2;return 32};this._frame=b}Jkp(){if(this.eQh)this.Gaj();else{const b=mb.a.create(y.AFrameworkApplication.J.rb("WopiBootstrapUrl"));b.L0((h,r)=>{r.succeeded?(this.eQh=!0,this.Gaj()):v.ULS.sendTraceTag(40436806,
323,10,"Failed to download word.boot.js")});Va.a.UY(b)}}Gaj(){if(this.pPc)v.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Eya;this.SJa=document.createElement("div");b.parentNode.insertBefore(this.SJa,b);this.A6a=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:y.AFrameworkApplication.J.rb("FileName"),reactRoot:this.SJa});this.A6a.setWebpackPublicPath(y.AFrameworkApplication.G$);this.A6a.renderDocumentPanel()}}QDm(b){const h=
{};h.Container=b;h.BootstrapperUrl=y.AFrameworkApplication.J.rb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.lDb;b={};b.HostName=y.AFrameworkApplication.J.rb("FileSource");b.HostSessionId=y.AFrameworkApplication.J.rb("HostSessionId");b.UserId=y.AFrameworkApplication.J.rb("UserId");b.DocumentClickTime=new Date(this._frame.Hxb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=y.AFrameworkApplication.J.rb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,
Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.Hxb;h.Diagnostics=b;b={};b.WopiSrc=y.AFrameworkApplication.J.rb("WopiSrc");b.AccessToken=y.AFrameworkApplication.J.rb("AccessToken");b.AccessTokenTtl=y.AFrameworkApplication.J.rb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=r=>{mq.H0=r;this.A6a.setMaxPage(mq.H0.GetPageCount());
this.A6a.setCurrentPage(mq.H0.GetCurrentPage());this.A6a.setPageControlVisible(!0);mq.H0.RegisterEventHandler("PageChanged",A=>{this.A6a.setCurrentPage(A.newPage)});mq.H0.RegisterEventHandler("BrowserEvent",A=>{27===A.keyCode?this.closeViewer():A.button&&1!==A.button||this.SJa.click()});r=this._frame.Hxb-(new Date).getTime();v.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.mc();Jc.FocusManager.instance().zP(Df.AFrame.wPa,!0);this.buildFocusRegion();this.IPa(Jc.FocusManager.instance().te(Df.AFrame.wPa));
this.SJa.click()};h.FnOnInitializeFailure=(r,A)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),A.toString());this.closeViewer()};return h}buildFocusRegion(){const b=Jc.FocusManager.instance();var h=b.getRegion(Df.AFrame.wPa);h=[2,3];const r=b.te(Df.AFrame.wPa),A=new Ig.DOMFocusListing(()=>this.SJa);A.$ia=!0;for(const L of h)A.jo(L);h=b.jta(()=>this.SJa,r,A);h.s1a();h.nR=!0;h.B9a=!0;A.eC(A.hna)}mc(){y.AFrameworkApplication.va.qa(wb.a.vue,dd.a.frame,this.wue);y.AFrameworkApplication.va.qa(wb.a.uue,
dd.a.frame,this.wue)}IPa(b){b.Pu(Jc.FocusManager.instance().w0);b.Pu(Jc.FocusManager.instance().x0);b.bindAction(Jc.FocusManager.instance().w0,wb.a.vue);b.bindAction(Jc.FocusManager.instance().x0,wb.a.uue)}loadViewer(b){b=this.QDm(b);this.pPc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.pPc.Complete(b.WopiInfo)}closeViewer(){Jc.FocusManager.instance().PW(Df.AFrame.wPa);mq.H0&&(mq.H0.Dispose(),mq.H0=null,y.AFrameworkApplication.va.Jz(wb.a.vue,dd.a.frame,this.wue),y.AFrameworkApplication.va.Jz(wb.a.uue,
dd.a.frame,this.wue));this.pPc&&(this.SJa.parentNode.removeChild(this.SJa),this.SJa=this.pPc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");y.AFrameworkApplication.va.Vb(fb.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");y.AFrameworkApplication.va.Vb(Lc.a.C1c,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");y.AFrameworkApplication.va.Vb(wb.a.Sga,2)}zoomInAction(){if(mq.H0){let b=
mq.H0.GetZoomLevel();b+=.2;mq.H0.SetZoomLevel(b)}}zoomOutAction(){if(mq.H0){let b=mq.H0.GetZoomLevel();b-=.2;mq.H0.SetZoomLevel(b)}}setPage(b){if(mq.H0){const h=mq.H0.GetPageCount();1>b?(mq.H0.SetCurrentPage(1),this.A6a.setCurrentPage(1)):1<=b&&b<=h?mq.H0.SetCurrentPage(b):(mq.H0.SetCurrentPage(h),this.A6a.setCurrentPage(h))}}static getInstance(b){mq.T7e||(mq.T7e=new mq(b));return mq.T7e}}mq.H0=null;mq.T7e=null;Object(u.a)(mq,"PreviewPanelActor",null,[]);class Jm{static get zgk(){return null!=Jm.ebh?
Jm.ebh:Jm.ebh=y.AFrameworkApplication.J.rb("ClassicViewModePreferenceCookieName")}static get Nj(){return null!=Jm.GXg?Jm.GXg:Jm.GXg=Xa.a.instance.Wa("WordEditor.ClientPagination.IClientPaginationSettings")}static mc(b,h){b.nb(fb.a.readingMode,dd.a.frame,Jm.Yhk,128);b.qa(fb.a.iFe,dd.a.frame,Jm.Yhk);Jm.rQ=h;b.qa(Lc.a.nAe,dd.a.frame,Jm.nAe);b.nb(Lc.a.Rve,dd.a.frame,Jm.Rve,96);b.qa(Lc.a.T6f,dd.a.frame,Jm.Dtp);b.nb(Lc.a.mve,dd.a.frame,Jm.mve,96);Jm.Nj.Jkc&&Jm.rQ.wVc(Jm.kpe)}static Yhk(b,h,r){if(h.contextId!==
dd.a.frame)return 2;h=Pk.a.Xm;switch(b){case fb.a.readingMode:if(!h.lDb)return 8;if(1===r)return id.SessionStatusManager.instance.zk?8:32;b=(new Date).getTime();Yj.a.instance.Bzo(b);h.Hxb=b;y.AFrameworkApplication.J.$("InAppDocumentPreviewIsEnabled")?Pw.a.rT(xw.a.$bg,!0,Jm.jno,null,h):Pw.a.rT(xw.a.$bg,!0,Jm.Jlj,null,h);return 32;case fb.a.iFe:return 32;default:return 2}}static Jlj(b){zL.a()?Jm.bXm(b):Jm.u4j(b)}static bXm(b){const h={};h[G.a.GWf]=Jm.zgk;y.AFrameworkApplication.NL().execute(r=>{r.$w(J.a.HWf);
r.IAp(J.a.HWf);r.DG(J.a.HWf,A=>{Jm.Oul(A,b)});r.sendMessage(J.a.ZBm,h)})}static Oul(b,h){b.Values[G.a.GWf]===Jm.zgk&&("true"===b.Values[G.a.rUi]?Jm.u4j(h):(Jm.YDp(),Jm.iop()))}static YDp(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};y.AFrameworkApplication.ud("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static iop(){y.AFrameworkApplication.Tx=!0;Db.StaticActiveAppFrame.Aa().q6(1);Db.StaticActiveAppFrame.Aa().tb.py&&Db.StaticActiveAppFrame.Aa().tb.py.Aj&&Db.StaticActiveAppFrame.Aa().tb.py.EYf();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Db.StaticActiveAppFrame.Aa().Ne();EO.a.m8j(y.AFrameworkApplication.J)}static u4j(b){try{const h=new kb.a;let r,A;y.AFrameworkApplication.Wgk?
(r=Ze.a.hostUrl,A=3):(r=b.lDb,A=1);b.Hxb&&h.add(y.AFrameworkApplication.acg,b.Hxb.toString());y.AFrameworkApplication.s0f&&h.add(y.AFrameworkApplication.Yuf,"1");y.AFrameworkApplication.sqf&&h.add(y.AFrameworkApplication.wFl,"1");h.add(sN.a.bRg,sN.a.userSessionData);h.add(y.AFrameworkApplication.yue,y.AFrameworkApplication.userSessionId);const L=y.AFrameworkApplication.J.rb(y.AFrameworkApplication.Zja);L&&h.add(y.AFrameworkApplication.E$j,L);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");
zL.b(y.AFrameworkApplication.J)?zL.d("view",h,zL.c):(r=db.a.iif(r,h),y.AFrameworkApplication.Wgk?ed.a.Zm(r,ed.a.Fya(A),void 0,"AuthenticationLostDuringSession"):ed.a.openWindow(A,r,!1,void 0,DO.a.cKj))}catch(h){}}static jno(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Xa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("previewPanel")).catch(()=>{v.ULS.sendTraceTag(38130907,
323,10,"previewPanel: Failed to download script");Jm.Jlj(b)}).then(()=>{mq.getInstance(b).Jkp()})}static nAe(b,h,r){b=Jm.rQ.vz;if(1===r)return 2===b?8:32;Jm.rQ.hTj(1===b?Jm.Nj.pdb?3:0:1);Db.StaticActiveAppFrame.Aa().Ne();return 32}static Rve(b,h,r,A,L){if(1===r)return 32;L[bg.a.On]=1===Jm.rQ.vz;return 32}static Dtp(b,h,r){if(1===r)return 32;b=Jm.rQ.vz;2===b?b=Jm.ZAj:(Jm.ZAj=b,b=2);Jm.rQ.hTj(b);Db.StaticActiveAppFrame.Aa().Ne();return 32}static kpe(b,h){b=Db.StaticActiveAppFrame.Aa();2===h.$db?(Jm.XAj=
b.mode,b.q6(1),b.Ne()):2===h.Xgg&&(b.q6(Jm.XAj),b.Ne())}static mve(b,h,r,A,L){if(!Jm.Nj.rua)return 8;if(1===r)return 32;L[bg.a.On]=2===Jm.rQ.vz;return 32}}Jm.rQ=null;Jm.ZAj=void 0;Jm.XAj=0;Object(u.a)(Jm,"MainViewModeActor",null,[]);class tN{constructor(b,h,r){this.FQn=(A,L,ba,ra,Ia)=>1===ba?32:(A=this.km.f9(L.Pk))?(Ia=3===Ia.aB,this.h7.value.Rei(this.BNm(A),this.LTb(A),Ia),32):2;this.ga=b;this.h7=h;this.km=r}mc(){this.ga.qa(Lc.a.U6f,ic.a.view,this.FQn);this.ga.nb(Lc.a.qve,ic.a.view,Yl.d,96);this.ga.nb(Lc.a.nve,
ic.a.view,Yl.d,96);this.ga.nb(Lc.a.ove,ic.a.view,Yl.d,96);this.ga.nb(Lc.a.pve,ic.a.view,Yl.d,96);this.ga.qa(Lc.a.pjd,ic.a.view,Yl.c);this.ga.qa(Lc.a.ojd,ic.a.view,Yl.c);this.ga.qa(Lc.a.dse,ic.a.view,Yl.c);this.ga.qa(Lc.a.ese,ic.a.view,Yl.c)}BNm(b){const h=new Ai.DictionaryPropertySet;h.setValue(Rc.a.marginTop,this.km.Mua(b));h.setValue(Rc.a.marginBottom,this.km.gDa(b));h.setValue(Rc.a.marginLeft,this.km.eP(b));h.setValue(Rc.a.marginRight,this.km.fP(b));return h}LTb(b){const h=new Ai.DictionaryPropertySet;
h.setValue(Rc.a.pageWidth,this.km.nx(b));h.setValue(Rc.a.pageHeight,this.km.oG(b));return h}}Object(u.a)(tN,"MarginsDialogActor",null,[]);class uN{constructor(b,h,r,A,L,ba){this.ga=b;this.nd=h;this.Qj=r;this.DF=A;this.pUg=L;this.Yf=ba;this.y0={Xpk:["To- Do List"],Ypk:["DD/MM/YYYY"],Zpk:["Add Subtitle here "],$pk:["- Add Item here \u2705  ","- Is your item complete? \u274c "],Dmk:["DD/MM/YYYY"],Emk:["Journal Entry"],Fmk:["Add Heading 1 Here"],Gmk:["- Reflect on your day  ","- What are you doing to take care of yourself?"],
Opk:["\u270f\ufe0f Task List  "],Ajk:["Brainstorming"],Cjk:["\ud83d\udc18 Question "],Djk:["Add question for the group decision here."," "],Ejk:["\u2728 Background context "],Fjk:["Add relevant context for the project or initiative you're making a decision on here."," "],Gjk:["\ud83e\uddca Constraints"],Hjk:["- Add a list of possible roadblocks and/or concerns here"," "],Ijk:["\ud83e\udd14 Assumptions "],Jjk:["- Add a list of things that you assume are true/untrue here"," "],Bjk:["\ud83c\udfd3 Compare ideas"]};
this.qFc=new Wr.a;this.qFc.setValue(Sb.a.bold,!1);this.qFc.setValue(Sb.a.fontSize,76);this.qFc.setValue(Sb.a.font,"Amasis MT Pro Regular");this.qFc.setValue(Sb.a.fontColor,0);this.rFc=new Wr.a;this.rFc.setValue(Sb.a.bold,!1);this.rFc.setValue(Sb.a.fontSize,42);this.rFc.setValue(Sb.a.font,"Amasis MT Pro Regular");this.rFc.setValue(Sb.a.fontColor,11304704);this.sFc=new Wr.a;this.sFc.setValue(Sb.a.bold,!1);this.sFc.setValue(Sb.a.fontSize,24);this.sFc.setValue(Sb.a.font,"Trade Gothic Next Italic");this.sFc.setValue(Sb.a.fontColor,
0);this.tFc=new Wr.a;this.tFc.setValue(Sb.a.bold,!1);this.tFc.setValue(Sb.a.fontSize,24);this.tFc.setValue(Sb.a.font,"Trade Gothic Next");this.tFc.setValue(Sb.a.fontColor,0);this.$Ec=new Wr.a;this.$Ec.setValue(Sb.a.bold,!1);this.$Ec.setValue(Sb.a.fontSize,76);this.$Ec.setValue(Sb.a.font,"Sitka Banner");this.$Ec.setValue(Sb.a.fontColor,1338346);this.aFc=new Wr.a;this.aFc.setValue(Sb.a.bold,!1);this.aFc.setValue(Sb.a.fontSize,42);this.aFc.setValue(Sb.a.font,"Sitka Heading");this.aFc.setValue(Sb.a.fontColor,
0);this.bFc=new Wr.a;this.bFc.setValue(Sb.a.bold,!1);this.bFc.setValue(Sb.a.fontSize,32);this.bFc.setValue(Sb.a.font,"Sitka Subheading");this.bFc.setValue(Sb.a.fontColor,0);this.cFc=new Wr.a;this.cFc.setValue(Sb.a.bold,!1);this.cFc.setValue(Sb.a.fontSize,24);this.cFc.setValue(Sb.a.font,"Sitka Text");this.cFc.setValue(Sb.a.fontColor,0);this.uFc=new Wr.a;this.uFc.setValue(Sb.a.bold,!1);this.uFc.setValue(Sb.a.fontSize,40);this.uFc.setValue(Sb.a.font,"Aptos Display");this.uFc.setValue(Sb.a.fontColor,
6375183);this.MEc=new Wr.a;this.MEc.setValue(Sb.a.bold,!1);this.MEc.setValue(Sb.a.fontSize,40);this.MEc.setValue(Sb.a.font,"Aptos Display");this.MEc.setValue(Sb.a.fontColor,6375183);this.NEc=new Wr.a;this.NEc.setValue(Sb.a.bold,!1);this.NEc.setValue(Sb.a.fontSize,24);this.NEc.setValue(Sb.a.font,"Segoe UI Emoji");this.NEc.setValue(Sb.a.fontColor,6375183);this.OEc=new Wr.a;this.OEc.setValue(Sb.a.bold,!1);this.OEc.setValue(Sb.a.fontSize,24);this.OEc.setValue(Sb.a.font,"Segoe UI Emoji");this.OEc.setValue(Sb.a.fontColor,
0)}mc(){this.ga.nb(Lc.a.Qjj,ic.a.kd,this.ael.bind(this),1028);this.ga.nb(Lc.a.Zbg,ic.a.kd,this.$Vd.bind(this),1028);this.ga.nb(Lc.a.Xbg,ic.a.kd,this.$Vd.bind(this),1028);this.ga.nb(Lc.a.Ybg,ic.a.kd,this.$Vd.bind(this),1028);this.ga.nb(Lc.a.Wbg,ic.a.kd,this.$Vd.bind(this),1028)}ael(){return null===this.nd.instance?2:32}$Vd(b,h,r){if(1===r)return 32;if(2===r){switch(b){case Lc.a.Zbg:this.Fin(this.y0.Xpk,this.y0.Ypk,this.y0.Zpk,this.y0.$pk);break;case Lc.a.Xbg:this.jhn(this.y0.Dmk,this.y0.Emk,this.y0.Fmk,
this.y0.Gmk);break;case Lc.a.Ybg:this.win(this.y0.Opk);break;case Lc.a.Wbg:this.rgn(this.y0.Ajk,this.y0.Cjk,this.y0.Djk,this.y0.Ejk,this.y0.Fjk,this.y0.Gjk,this.y0.Hjk,this.y0.Ijk,this.y0.Jjk,this.y0.Bjk)}return 32}return 2}jhn(b,h,r,A){const L=new hb.GraphTransaction(15);try{const ba=Fg.a.instance.ob.currentSelection.Ya;let ra=ba.node,Ia;for(Ia=Xd.a.Mp(ba.node);Ia.moveNext();){const bc=Ia.currentNode;if(rd.ParagraphReader.Fcb(bc)&&rd.ParagraphReader.lc(bc)){ra=bc;break}}L.Eb(ra);const Ta=this.nd.instance.cH(b,
ra,!0).toArray();this.wmk(Ta);const ob=this.nd.instance.cH(h,ra,!0).toArray();this.xmk(ob);const nb=this.nd.instance.cH(r,ra,!0).toArray();this.ymk(nb);const Eb=this.nd.instance.cH(A,ra,!0).toArray();this.zmk(Eb)}finally{L.dispose()}}wmk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.$Ec)})}xmk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.aFc)})}ymk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.bFc)})}zmk(b){for(const h of b)b=
h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.cFc)})}Fin(b,h,r,A){const L=new hb.GraphTransaction(15);try{const ba=Fg.a.instance.ob.currentSelection.Ya;let ra=ba.node,Ia;for(Ia=Xd.a.Mp(ba.node);Ia.moveNext();){const bc=Ia.currentNode;if(rd.ParagraphReader.Fcb(bc)&&rd.ParagraphReader.lc(bc)){ra=bc;break}}L.Eb(ra);const Ta=this.nd.instance.cH(b,ra,!0).toArray();this.upk(Ta);const ob=this.nd.instance.cH(h,ra,!0).toArray();this.vpk(ob);const nb=this.nd.instance.cH(r,ra,!0).toArray();this.wpk(nb);
const Eb=this.nd.instance.cH(A,ra,!0).toArray();this.xpk(Eb)}finally{L.dispose()}}upk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.qFc)})}vpk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.rFc)})}wpk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.sFc)})}xpk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.tFc)})}win(b){const h=new hb.GraphTransaction(15);try{const r=
Fg.a.instance.ob.currentSelection.Ya;let A=r.node,L;for(L=Xd.a.Mp(r.node);L.moveNext();){const ob=L.currentNode;if(rd.ParagraphReader.Fcb(ob)&&rd.ParagraphReader.lc(ob)){A=ob;break}}h.Eb(A);const ba=this.nd.instance.cH(b,A,!0).toArray();this.Dpk(ba);const ra=te.a.kb(A);ra.Ib(23);ra.xd(11);this.Yf.mA(ra,!0,!1,null,!1,!1);const Ia=this.pUg.jCa(ra,4,3),Ta=te.a.kb(Ia);Lh.f(Ta,0,0);Ta.currentNode.properties.setValue(Sb.a.YE,16247258);Ta.xd(14);Lh.f(Ta,0,1);Ta.currentNode.properties.setValue(Sb.a.YE,16247258);
Ta.xd(14);Lh.f(Ta,0,2);Ta.currentNode.properties.setValue(Sb.a.YE,16247258);Ta.xd(14);Ta.xp(0,-1);Ta.xp(0,-1);Ta.xp(0,-1);A=Ta.xp(0,-1);this.nd.instance.cH(["Task"],A,!0).toArray();Ta.xd(14);Ta.xp(0,-1);Ta.xp(1,-1);Ta.xp(0,-1);A=Ta.xp(0,-1);this.nd.instance.cH(["Assigned to"],A,!0).toArray();Ta.xd(14);Ta.xp(0,-1);Ta.xp(2,-1);Ta.xp(0,-1);A=Ta.xp(0,-1);this.nd.instance.cH(["Due Date"],A,!0).toArray()}finally{h.dispose()}}Dpk(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,
this.uFc)})}rgn(b,h,r,A,L,ba,ra,Ia,Ta,ob){const nb=new hb.GraphTransaction(15);try{const Eb=Fg.a.instance.ob.currentSelection.Ya;let bc=Eb.node,Bc;for(Bc=Xd.a.Mp(Eb.node);Bc.moveNext();){const cn=Bc.currentNode;if(rd.ParagraphReader.Fcb(cn)&&rd.ParagraphReader.lc(cn)){bc=cn;break}}nb.Eb(bc);const Yc=this.nd.instance.cH(b,bc,!0).toArray();this.vjk(Yc);const zd=this.nd.instance.cH(h,bc,!0).toArray();this.LEc(zd);const Jd=this.nd.instance.cH(r,bc,!0).toArray();this.syd(Jd);const ie=this.nd.instance.cH(A,
bc,!0).toArray();this.LEc(ie);const re=this.nd.instance.cH(L,bc,!0).toArray();this.syd(re);const me=this.nd.instance.cH(ba,bc,!0).toArray();this.LEc(me);const Sd=this.nd.instance.cH(ra,bc,!0).toArray();this.syd(Sd);const cf=this.nd.instance.cH(Ia,bc,!0).toArray();this.LEc(cf);const sf=this.nd.instance.cH(Ta,bc,!0).toArray();this.syd(sf);const yh=this.nd.instance.cH(ob,bc,!0).toArray();this.LEc(yh);const si=te.a.kb(bc);si.Ib(23);si.xd(11);this.Yf.mA(si,!0,!1,null,!1,!1);const cl=this.pUg.jCa(si,3,
4),Pj=te.a.kb(cl);Pj.xd(14);Pj.xp(0,-1);Pj.xp(0,-1);Pj.xp(0,-1);bc=Pj.xp(0,-1);this.nd.instance.cH(["Idea"],bc,!0).toArray();Pj.xd(14);Pj.xp(0,-1);Pj.xp(1,-1);Pj.xp(0,-1);bc=Pj.xp(0,-1);this.nd.instance.cH(["Pros"],bc,!0).toArray();Pj.xd(14);Pj.xp(0,-1);Pj.xp(2,-1);Pj.xp(0,-1);bc=Pj.xp(0,-1);this.nd.instance.cH(["Cons"],bc,!0).toArray();Pj.xd(14);Pj.xp(0,-1);Pj.xp(3,-1);Pj.xp(0,-1);bc=Pj.xp(0,-1);this.nd.instance.cH(["Votes"],bc,!0).toArray()}finally{nb.dispose()}}vjk(b){for(const h of b)b=h.node,
this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.MEc)})}LEc(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.NEc)})}syd(b){for(const h of b)b=h.node,this.DF.jga(b,0,b.c_.length,r=>{this.Qj.vja(r,this.OEc)})}}Object(u.a)(uN,"MiniTemplateActor",null,[]);class AL{constructor(b){this.fvd=(h,r,A)=>{if(1===A)return 32;h=y.AFrameworkApplication.ta;if(!h)return 32;h.PWd();AL.KSo(h);return 32};this.ga=b}mc(){this.ga.qa(Lc.a.fvd,ic.a.view,this.fvd)}static KSo(b){const h=y.AFrameworkApplication.J.rb("ModernUxExperimentPreferenceCookieName");
var r=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");r=yc.a.ZCa(h,!r);yc.a.p2a(h,(!r).toString(),yc.a.U_a);r?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");$d.d(Lc.a.fvd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.Yda(null)}}Object(u.a)(AL,"ModernUxActor",null,[]);var FO=e(906),
js=e(1793);class GO{constructor(b,h,r,A){this.RDe=fg.a.pF(1)/6;this.q4o=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;if(ra=this.wg.f9(ba.Pk)){if(0<=Ta&&Ta<js.a.V5.length){ba=new hb.GraphTransaction(15);ba.Eb(ra);ba.Bh=L;L=js.a.V5[Ta].ZJd;Ia=js.a.V5[Ta].XJd;const ob=js.a.V5[Ta]._marginLeft;Ta=js.a.V5[Ta].YJd;this.Gse(L,Ia,this.wg.oG(ra))&&this.Gse(ob,Ta,this.wg.nx(ra))?(this.aH.ygb(ra,L),this.aH.wgb(ra,Ia),this.aH.Hpa(ra,ob),this.aH.xgb(ra,Ta),this.me.Vv(11)):this.iQa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);
ba.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk);return 2};this.r4o=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;if(ra=this.wg.f9(ba.Pk)){if(0<=Ta&&Ta<js.a.Vwa.length)ba=new hb.GraphTransaction(15),ba.Eb(ra),ba.Bh=L,L=(Ia=this.wg.Lbd(ra))?js.a.Vwa[Ta].y6a:js.a.Vwa[Ta].z6a,Ta=Ia?js.a.Vwa[Ta].z6a:js.a.Vwa[Ta].y6a,this.Gse(this.wg.gDa(ra),this.wg.Mua(ra),Ta)&&this.Gse(this.wg.eP(ra),this.wg.fP(ra),L)?(this.aH.DDg(ra,L),this.aH.CDg(ra,
Ta),this.me.Vv(11)):this.iQa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ba.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk);return 2};this.H3o=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;if(ra=this.wg.f9(ba.Pk)){ba=this.wg.Lbd(ra);Ia=new hb.GraphTransaction(15);Ia.Eb(ra);Ia.Bh=L;this.aH.nUj(ra,Ta);if(Ta&&!ba||!Ta&&ba){L=this.wg.nx(ra);Ta=this.wg.oG(ra);this.aH.DDg(ra,Ta);this.aH.CDg(ra,L);L=this.wg.Mua(ra);Ta=this.wg.gDa(ra);
const ob=this.wg.eP(ra),nb=this.wg.fP(ra);ba?(this.aH.ygb(ra,y.AFrameworkApplication.isRtl?ob:nb),this.aH.wgb(ra,y.AFrameworkApplication.isRtl?nb:ob),this.aH.Hpa(ra,y.AFrameworkApplication.isRtl?Ta:L),this.aH.xgb(ra,y.AFrameworkApplication.isRtl?L:Ta)):(this.aH.ygb(ra,y.AFrameworkApplication.isRtl?nb:ob),this.aH.wgb(ra,y.AFrameworkApplication.isRtl?ob:nb),this.aH.Hpa(ra,y.AFrameworkApplication.isRtl?Math.abs(L):Ta),this.aH.xgb(ra,y.AFrameworkApplication.isRtl?Ta:L));this.me.Vv(11)}Ia.dispose();return 32}v.ULS.sendTraceTag(520618523,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk);return 2};this.Mge=(L,ba,ra)=>{if(1===ra)return 1===this.tS.vz?32:8};this.EAb=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;ra=this.wg.f9(ba.Pk);if(!ra)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk),2;ba=new hb.GraphTransaction(15);ba.Eb(ra);ba.Bh=L;L=Math.floor(this.wg.nx(ra)/720);if(0>Ta||Ta>L)return 2;this.aH.X1b(ra,Ta);this.qFd.execute(ob=>{ob.logActivity("WordWebColumnsActivity",
null)});ba.dispose();return 32};this.HAe=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;ra=this.wg.f9(ba.Pk);if(!ra)return v.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk),2;ba=new hb.GraphTransaction(15);ba.Eb(ra);ba.Bh=L;L=Ta[0];Ia=this.wg.nx(ra);if(720>L||L>Ia)return 2;this.aH.Jzc(ra,Ta);this.qFd.execute(ob=>{ob.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.GAe=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;ra=this.wg.f9(ba.Pk);if(!ra)return v.ULS.sendTraceTag(520618520,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk),2;ba=new hb.GraphTransaction(15);ba.Eb(ra);ba.Bh=L;L=this.wg.nx(ra);Ia=this.wg.Nh(ra);if(0>Ta||Ta>(L-720*Ia)/(Ia-1))return 2;this.aH.XZo(ra,Ta);this.qFd.execute(ob=>{ob.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.FAe=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;ra=this.wg.f9(ba.Pk);if(!ra)return v.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk),2;ba=new hb.GraphTransaction(15);
ba.Eb(ra);ba.Bh=L;if(null==Ta)return 2;this.aH.E5o(ra,Ta);this.qFd.execute(ob=>{ob.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.jie=(L,ba,ra)=>{if(1===ra)return 1===this.tS.vz?32:8};this.Qzc=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;ra=this.wg.f9(ba.Pk);if(!ra)return v.ULS.sendTraceTag(508048402,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk),2;ba=new hb.GraphTransaction(15);ba.Eb(ra);ba.Bh=L;this.aH.w2o(ra,Ta);ba.dispose();return 32};this.CPa=(L,ba,ra,
Ia,Ta)=>{let ob;try{ob=this.wg.f9(ba.Pk)}catch(nb){return v.ULS.sendTraceTag(508339925,3009,50,"context.nextContext = {0}",ba.Pk),2}if(ob)return Ta.marginTop=this.wg.Mua(ob),Ta.marginBottom=this.wg.gDa(ob),Ta.marginLeft=this.wg.eP(ob),Ta.marginRight=this.wg.fP(ob),Ta.pageWidth=this.wg.nx(ob),Ta.pageHeight=this.wg.oG(ob),Ta.bEa=this.wg.Lbd(ob),Ta.columnCount=this.wg.Nh(ob),Ta.uta=this.wg.dtb(ob),Ta.uBl=this.wg.mbe(ob),Ta.F7f=this.wg.nGi(ob),Ta.$Xb=this.hGm(Ta),Ta.LZb=this.tKm(Ta),Ta.QYc=this.Fsm(Ta),
32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk);return 2};this.tBe=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;if(ra=this.wg.f9(ba.Pk)){ba=new hb.GraphTransaction(15);ba.Eb(ra);switch(L){case fb.a.ygb:this.aH.ygb(ra,Ta);break;case fb.a.wgb:this.aH.wgb(ra,Ta);break;case fb.a.Hpa:this.aH.Hpa(ra,Ta);break;case fb.a.xgb:this.aH.xgb(ra,Ta)}this.me.Vv(11);ba.dispose();return 32}v.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.Pk);return 2};this.SUj=(L,ba,ra,Ia,Ta)=>{if(1===ra)return 32;if(ra=this.wg.f9(ba.Pk)){ba=new hb.GraphTransaction(15);ba.Eb(ra);let ob=Ia=0;switch(L){case fb.a.FDg:ob=Ta;this.aH.DDg(ra,ob);Ia=this.wg.oG(ra);break;case fb.a.EDg:Ia=Ta,this.aH.CDg(ra,Ia),ob=this.wg.nx(ra)}this.aH.nUj(ra,Ia<ob);this.me.Vv(11);ba.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Pk);return 2};this.aH=b;this.me=h;this.tS=r;this.qFd=A}get wg(){return Ap.a.instance}iGm(b){var h=
Ze.a.L2f,r=h?1:3,A=y.AFrameworkApplication.numberFormat;let L=js.a.V5[b].ZJd;var ba=js.a.V5[b].XJd;var ra=js.a.V5[b]._marginLeft;b=js.a.V5[b].YJd;L=h?fg.a.m3a(L):fg.a.kD(L);ba=h?fg.a.m3a(ba):fg.a.kD(ba);ra=h?fg.a.m3a(ra):fg.a.kD(ra);b=h?fg.a.m3a(b):fg.a.kD(b);h=D.a.tMa(L,r,A);ba=D.a.tMa(ba,r,A);ra=D.a.tMa(ra,r,A);r=D.a.tMa(b,r,A);A={};A.top=h;A.bottom=ba;A.left=ra;A.right=r;return A}DQn(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,A=WordRibbonStrings.PageMarginsLeft,
L=WordRibbonStrings.PageMarginsRight;b=this.iGm(b);return[[h,b.top,r,b.bottom],[A,b.left,L,b.right]]}Ljd(b){var h=Ze.a.L2f,r=h?1:3;const A=y.AFrameworkApplication.numberFormat;let L=js.a.Vwa[b].y6a;b=js.a.Vwa[b].z6a;L=h?fg.a.m3a(L):fg.a.kD(L);b=h?fg.a.m3a(b):fg.a.kD(b);h=D.a.tMa(b,r,A);r=D.a.tMa(L,r,A);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}mc(){const b=y.AFrameworkApplication.va;b.nb(fb.a.zgb,ic.a.view,this.q4o,4);b.nb(fb.a.f2a,ic.a.view,this.r4o,4);b.nb(fb.a.setOrientation,
ic.a.view,this.H3o,4);b.nb(fb.a.CPa,ic.a.view,this.CPa,96);b.qa(fb.a.ygb,ic.a.view,this.tBe);b.qa(fb.a.wgb,ic.a.view,this.tBe);b.qa(fb.a.Hpa,ic.a.view,this.tBe);b.qa(fb.a.xgb,ic.a.view,this.tBe);b.qa(fb.a.FDg,ic.a.view,this.SUj);b.qa(fb.a.EDg,ic.a.view,this.SUj);b.nb(fb.a.Mge,ic.a.view,this.Mge,4);b.qa(fb.a.EAb,ic.a.view,this.EAb);b.qa(fb.a.HAe,ic.a.view,this.HAe);b.qa(fb.a.GAe,ic.a.view,this.GAe);b.qa(fb.a.FAe,ic.a.view,this.FAe);b.qa(fb.a.jie,ic.a.view,this.jie);b.qa(fb.a.Qzc,ic.a.view,this.Qzc)}Gse(b,
h,r){return r>=b+h+Ze.a.iHa}hGm(b){let h=5;for(let r=0;r<js.a.V5.length;r++)if(js.a.V5[r].ZJd===b.marginTop&&js.a.V5[r].XJd===b.marginBottom&&js.a.V5[r]._marginLeft===b.marginLeft&&js.a.V5[r].YJd===b.marginRight){h=r;break}return h}tKm(b){let h=5;b=new FO.a(Math.min(b.pageWidth,b.pageHeight),Math.max(b.pageWidth,b.pageHeight));for(let r=0;r<js.a.Vwa.length;r++)if(this.Veo(b,js.a.Vwa[r])){h=r;break}return h}Fsm(b){let h=0;switch(b.columnCount){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}Veo(b,
h){return of.a.I_i(b.z6a,Math.max(h.z6a-this.RDe,0),h.z6a+this.RDe)&&of.a.I_i(b.y6a,Math.max(h.y6a-this.RDe,0),h.y6a+this.RDe)}iQa(b){if(!kg.a.SQ){const h=new wg.StandardDialog;h.Md=0;h.tU(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(u.a)(GO,"PageActor",null,[302]);class vN{constructor(b){this.ga=b}get Tb(){return this.ga}sBe(b,h){let r=0;b?1===b?r=fb.a.Hpa:2===b?r=fb.a.xgb:3===b&&(r=fb.a.wgb):r=fb.a.ygb;this.Tb.Zb(r,2,h)}f2a(b,h){let r=0;1===b?r=fb.a.EDg:b||(r=fb.a.FDg);this.Tb.Zb(r,2,h)}EAe(b,
h){let r=0;switch(b){case 0:r=fb.a.EAb;break;case 1:r=fb.a.HAe;break;case 2:r=fb.a.GAe;break;case 3:r=fb.a.FAe}this.Tb.Zb(r,2,h)}}Object(u.a)(vN,"PageCommands",null,[301]);class pC{constructor(b,h,r){this.Ueo=(A,L,ba,ra,Ia)=>1===ba?32:(A=this.km.f9(L.Pk))?(Ia=3===Ia.aB,this.h7.value.sfi(this.CNm(A),this.LTb(A),Ia),32):2;this.ga=b;this.h7=h;this.km=r}mc(){this.ga.qa(Lc.a.W6f,ic.a.view,this.Ueo);this.ga.nb(Lc.a.Fve,ic.a.view,Yl.d,96);this.ga.nb(Lc.a.Eve,ic.a.view,Yl.d,96);this.ga.qa(Lc.a.hse,ic.a.view,
Yl.c);this.ga.qa(Lc.a.gse,ic.a.view,Yl.c)}CNm(b){const h=new Ai.DictionaryPropertySet;h.setValue(Rc.a.pageWidth,this.km.nx(b));h.setValue(Rc.a.pageHeight,this.km.oG(b));return h}LTb(b){const h=new Ai.DictionaryPropertySet;h.setValue(Rc.a.marginTop,Math.abs(this.km.Mua(b)));h.setValue(Rc.a.marginBottom,Math.abs(this.km.gDa(b)));h.setValue(Rc.a.marginLeft,this.km.eP(b));h.setValue(Rc.a.marginRight,this.km.fP(b));return h}}Object(u.a)(pC,"PaperSizeDialogActor",null,[]);class uE{constructor(b,h,r){this.ga=
b;this.h7=h;this.c0=r}mc(){this.ga.nb(fb.a.Rsc,ic.a.view,this.Mfo.bind(this),1028);this.ga.qa(fb.a.Rsc,ic.a.paragraph,this.Kfo.bind(this));this.ga.nb(fb.a.ato,ic.a.view,Yl.d,96);this.ga.nb(fb.a.bto,ic.a.view,Yl.d,96);this.ga.nb(fb.a.gso,ic.a.view,Yl.d,96);this.ga.nb(fb.a.hso,ic.a.view,Yl.d,96);this.ga.nb(fb.a.fjp,ic.a.view,Yl.c,96);this.ga.nb(fb.a.ejp,ic.a.view,Yl.c,96);this.ga.nb(fb.a.Ico,ic.a.view,Yl.c,96);this.ga.nb(fb.a.Jco,ic.a.view,Yl.c,96);this.ga.nb(fb.a.vco,ic.a.view,Yl.c,96);this.ga.nb(fb.a.djp,
ic.a.view,Yl.c,96);this.ga.nb(fb.a.wco,ic.a.view,Yl.c,96)}Kfo(b,h,r,A,L){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.z9j(h);L=3===L.aB;this.h7.value.l1d(this.m7c(b),this.LTb(h),L);return 32}Mfo(b,h,r,A,L){b=h.view.ub;if(!b||uE.Ig.gqc(b.hh))return 8;if(Object(ak.a)().eHa(rd.ParagraphReader.uZ,b.hh))return uE.Jc.qc(pf.a.$e,{["Reason"]:uf.a.NS}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.ob.currentSelection;h=this.z9j(h);L=3===L.aB;if(1===r.length&&Ee.a.Df(r.K(0)))return r=
r.K(0).node,this.h7.value.l1d(this.m7c(r),this.LTb(h),L),32;b=[];for(A=0;A<r.length;A++){const ba=r.K(A);(!A&&Ee.a.em(ba)||rd.ParagraphReader.Xn(ba)||Ee.a.Rm(ba))&&b.push(ba.node)}if(!b.length)return 8;r=Array(b.length);for(A=0;A<b.length;A++)r[A]=this.m7c(b[A]);r=jv.a.EFi(r);this.h7.value.l1d(r,this.LTb(h),L);return 32}m7c(b){const h=new Ai.DictionaryPropertySet;h.setValue(Pd.a.Dz,rd.ParagraphReader.VA(b));const r=this.c0.uYa(b);var A=r.lineSpacing;h.setValue(Pd.a.tdb,A.unit);h.setValue(Pd.a.xa,
A.value);A=r.beforeSpacing;h.setValue(Pd.a.jwc,A.unit);h.setValue(Pd.a.kwc,A.value);A=r.afterSpacing;h.setValue(Pd.a.hwc,A.unit);h.setValue(Pd.a.iwc,A.value);h.setValue(Pd.a.Sjd,r.eA);h.setValue(Me.a.keepWithNext,rd.ParagraphReader.keepWithNext(b));h.setValue(Me.a.widowControl,rd.ParagraphReader.tEc(b));h.setValue(Me.a.keepTogether,rd.ParagraphReader.keepTogether(b));return h}static get Ig(){return Ke.a.instance}static get Jc(){return $g.a.instance}}Object(u.a)(uE,"AParagraphDialogActor",null,[]);
class BL extends uE{constructor(b,h,r,A,L){super(b,h,r);this.km=A;this.Vq=L}mc(){super.mc();this.ga.nb(fb.a.YCj,ic.a.view,Yl.d,96);this.ga.nb(fb.a.ZCj,ic.a.view,Yl.d,96);this.ga.nb(fb.a.nso,ic.a.view,Yl.d,96);this.ga.nb(fb.a.obn,ic.a.view,Yl.c,96);this.ga.nb(fb.a.qbn,ic.a.view,Yl.c,96);this.ga.nb(fb.a.bjp,ic.a.view,Yl.c,96);this.ga.nb(fb.a.cjp,ic.a.view,Yl.c,96);this.ga.nb(fb.a.Eco,ic.a.view,Yl.c,96);this.ga.nb(fb.a.Lco,ic.a.view,Yl.c,96);this.ga.nb(fb.a.Kco,ic.a.view,Yl.c,96);this.ga.nb(fb.a.gjp,
ic.a.view,Yl.c,96);this.ga.nb(fb.a.cto,ic.a.view,Yl.d,96);this.ga.nb(fb.a.dto,ic.a.view,Yl.d,96)}z9j(b){return this.km.f9(b.Pk)}m7c(b){const h=super.m7c(b);var r=this.Vq.cZ(b);const A=this.Vq.cK(b);h.setValue(Pd.a.kPa,1);h.setValue(Pd.a.lPa,r.ww-A.ww);r=this.Vq.lbb(b);h.setValue(Pd.a.Vyb,r.unit);h.setValue(Pd.a.Wyb,r.value);b=this.Vq.tnc(b);b.specialIndentType&&(h.setValue(Pd.a.E$,b.specialIndentType),h.setValue(Pd.a.C2a,b.unit),h.setValue(Pd.a.D2a,b.value));return h}LTb(b){const h=new Ai.DictionaryPropertySet;
h.setValue(Rc.a.pageWidth,this.km.nx(b));h.setValue(Rc.a.pageHeight,this.km.oG(b));h.setValue(Rc.a.marginTop,Math.abs(this.km.Mua(b)));h.setValue(Rc.a.marginBottom,Math.abs(this.km.gDa(b)));h.setValue(Rc.a.marginLeft,this.km.eP(b));h.setValue(Rc.a.marginRight,this.km.fP(b));return h}}Object(u.a)(BL,"ParagraphDialogActor",uE,[]);class ex extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.W3i=h}}Object(u.a)(ex,"AfterPasteEventArgs",Sys.EventArgs,[]);class wN{constructor(b){this.IZe=null;
this.mEd=b}get f7d(){return null!=this.O_g?this.O_g:this.O_g=Xa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get $ge(){this.IZe||(this.IZe=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(Kt.a.Wji));return this.IZe}Cpo(b){if(b&&Mb.a.ji(b.RCa)&&Mb.a.ji(b.Swb)){this.Ypo(b);var h=new Oi.a;for(h.Ad(b.RCa);h&&h.currentNode;){const r=this.xae(h),A=rd.ParagraphReader.lc(r);A&&rd.ParagraphReader.kqb(r)&&this.Apo(r);const L=h.currentNode.id===b.Swb.currentNode.id;A&&this.$ge&&
r.ml.rna(r.type).nwe(new ex(r,L));if(L)break;hg.a.Fu(h,!1,!1)}}}Apo(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.xwc;b=vc.a.jd(b,0);Hr.obd(h)?this.f7d.nte(b,h):this.mEd.nte(b,h)}Ypo(b){if(b.RCa.currentNode&&b.Swb.currentNode&&b.RCa.currentNode.id===b.Swb.currentNode.id){const h=this.xae(b.RCa);rd.ParagraphReader.lc(h)?this.Epo(h,b.Hho,b.Gho):v.ULS.sendTraceTag(590955995,
307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}Epo(b,h,r){v.ULS.shipAssertTag(590956771,307,0<=h);v.ULS.shipAssertTag(590958592,307,0<=r);var A=rd.ParagraphReader.text(b);if(""!==A){var L=vc.a.createTextRange(b,h,r);L=Mc.a.VD(L,!1);if(1===L.length){const ba=L[0];L=A.substring(h,r).trim();A=A.substring(ba.cpBegin,ba.cpEnd).trim();h=L===A;L=vc.a.createTextRange(b,ba.cpBegin,ba.cpEnd);if(ba.hyperlink&&h&&!Mc.a.i_a(A))b=ba.hyperlink.url;else if(h)b=A;else{v.ULS.sendTraceTag(590958596,
307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}Hr.obd(b)?this.f7d.fZa(L,b,!1):this.mEd.fZa(L,b,!1)}else v.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",L.length)}}xae(b){const h=hg.a.Ze(b);hg.a.xe(b);return h}}Object(u.a)(wN,"PastedContentsProcessorPostMergeAfterPaste",
null,[299]);class vM extends Ky{constructor(b,h,r,A,L,ba,ra,Ia){super(A);this.E$e=7;this.mz=this.QJc=null;this.qYe=0;this.nYe=b;this.sm=h;this.jp=r;this.qe=L;this.vsk=ra;this.R6a=Ia;this.O7=this.qe.O_a("UserAction","WordIgnoreAll")}PEg(b){this.nYe.Bfj();this.QJc=this.jp.Eua(b);this.R6a.aVi(this.QJc,null,!1);return this.nYe.d$j(this.QJc)?(this.O7.start(),this.mz=new hb.GraphTransaction(15),this.mz.Eb(b.node),!0):!1}Fue(b){this.D_b(b.node);return!0}tld(b){this.D_b(b);return!0}Gue(b){this.D_b(b.node)}oLg(b){this.mz.dispose();
this.QJc.errorDetails.vCb(b.actionId);this.O7.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.qYe,this.O7.qj,this.QJc.errorDetails.proofingType));return!0}gBc(b,h){if(super.gBc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}iKi(b){if(b&&b.type!==this.E$e){const h=te.a.kb(b);return h.Ib(this.E$e)?h.xd(this.E$e):b}return b}nsn(b,h){return this.nYe.ssd(h.errorDetails)&&!this.sm.cda(vc.a.createTextRange(b,
h.Mc,h.end))}D_b(b){if(b){var h=this.jp.X8(b,r=>this.nsn(b,r));this.vsk?this.jp.Nzb(b,h,!0):0<h.length&&(b.vm(4,!0),this.jp.QYb(b));this.qYe+=h.length}}}Object(u.a)(vM,"IgnoreAllCallbackSteps",Ky,[]);class xN{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){this.hmd=(Bc,Yc,zd,Jd,ie)=>{if(1===zd)return 32;Bc=this.MM.KMa(Yc.view.ub.hh);if(Bc=Wg.a.Vg(Bc))ie[vk.a.LabelText]=Bc.displayName;return 32};this.bva=(Bc,Yc,zd,Jd,ie,re)=>{const me=new vM(this.cFk,this.sm,this.jp,this.gf,this.qe,this.p0,0,this.R6a);
return new hB(Bc,Yc,zd,Jd,ie,re,me,this.ga,this.pb,this.gf,"IgnoreAllOperation")};this.oQb=(Bc,Yc,zd,Jd,ie,re)=>{const me=new vM(this.Lzk,this.sm,this.jp,this.gf,this.qe,this.p0,1,this.R6a);return new hB(Bc,Yc,zd,Jd,ie,re,me,this.ga,this.pb,this.gf,"DoNotCheckThisCritiqueType")};this.ga=b;this.sm=h;this.pb=r;this.gf=A;this.jp=L;this.MM=ba;this.qe=ra;this.cFk=Ia;this.Lzk=Ta;this.H$b=ob.zcd;this.p0=ob;this.R6a=nb;this.t_e=Eb;this.Xib=bc}mc(){this.t_e&&(qu.rF()?this.ga.nb(fb.a.bva,ic.a.kd,this.y$m.bind(this),
1028):this.ga.uY(fb.a.bva,ic.a.view,this.bva,1028));this.H$b&&this.ga.uY(fb.a.oQb,ic.a.view,this.oQb,1028);this.ga.nb(Lc.a.hmd,ic.a.view,this.hmd,96)}y$m(b,h,r,A,L){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.Xib.NUf(L?L:h,null,Tp.b.IgnoreAll);return 32}}Object(u.a)(xN,"ProofingActor",null,[]);var aP=e(1713);class qC{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.Gp=this.SUa=this.GQd=this.HQd=null;this.XH=this.ly=this.Wt=0;this.Ikb=this.Hkb=!1;this.jh=
this.X7b=this.W7b=this.V7b=this.Y7b=0;this.HPd=null;this.mka=this.r0=this.Zw=this.aV=0;this.xn=null;this.C5a=0;this.vkg=nb=>{var Eb;if(Oe.a.ur){var bc=Object.assign(new Sa.a,{extendedProperties:new Map});bc.extendedProperties.set("status",nb.data.status.toString());bc.extendedProperties.set("httpStatus",nb.data.Xe.toString());this.Dej("GraphicSwordRequestFailed",this.C5a,bc)}else 5===this.C5a&&(bc=Object.assign(new Sa.a,{extendedProperties:new Map}),bc.extendedProperties.set("status",nb.data.status.toString()),
bc.extendedProperties.set("httpStatus",nb.data.Xe.toString()),(null===(Eb=y.AFrameworkApplication.J)||void 0===Eb?0:Eb.$("ShouldLogPicturesExtendedHealthKpis"))?(Eb={name:Kj.c.vee,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:bc},bc.extendedProperties.set("ErrorLevel","warning"),this.$d.logKpiFailure({kpiName:Kj.c.Ooc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:bc},optionalVeto:Eb})):
Ca.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,bc));v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:nb.data.status,["HttpStatus"]:nb.data.Xe,["Id"]:nb.data.id},Kv.a[this.C5a]);this.Vye()};this.ll=r;this.vUa=ob;this._image=b;this._context=h;this.DId=!1;(b=Object(ao.a)().kw(h.node))&&b.Uf(Rc.a.F4f)&&(this.DId=!0);this.MLc=A.$("ImageDataURLPresentationIsEnabled");this.sPk=A.$("WordOartPostRequestIsEnabled");this.za=
A;this.St=L;this.qe=ba;this.me=ra;this.yo=Ia;this.qO=Ta;this.$d=ej.a.getInstance(Kj.a);this.ien();this.dre=this.Avc.bind(this)}ien(){this.Gp="";this.Wt=pe.a.XD(this._image);this.ly=pe.a.iF(this._image);this.jh=pe.a.Ntb(this._image);this.XH=pe.a.N4(this._image);var b=pe.a.Jua(this._image);this.Hkb=b.ssb;this.Ikb=b.lMa;b=pe.a.oha(this._image);this.Y7b=Math.max(b.top,0);this.V7b=Math.max(b.bottom,0);this.W7b=Math.max(b.left,0);this.X7b=Math.max(b.right,0);this.xn=qb.a.nil;this.SUa=null;this.C5a=pe.a.pl(this._image)}tXd(b,
h){return(new aP.a(this.St,this.C5a,this.za,this.Wt,this.ly,this.XH,this.jh,this.Y7b,this.V7b,this.W7b,this.X7b,this.Hkb,this.Ikb,this.DId)).build(this._context.node,this._image,b,h)}resize(b,h){this.Gp="Resize";this.qEe();Yb.a.mark(this.anc());this.Wt=b;this.ly=h;this.sendMessage(!1,this.dre)}Nz(b){this.Gp="Styles";this.qEe();Yb.a.mark(this.anc());this.jh=b;this.sendMessage(!1,this.dre)}h4o(b,h,r){this.Gp="Rotation";this.qEe();this.XH=b;this.Hkb=h;this.Ikb=r;this.sendMessage(!1,this.dre)}g4o(b,h){this.Gp=
"SwordRequestManager";this.qEe();this.SUa=b;this.XH=h.angle;this.Wt=h.width;this.ly=h.height;this.jh=h.styleId;this.Y7b=h.top;this.V7b=h.bottom;this.W7b=h.left;this.X7b=h.right;this.xn=h.g1;this.sendMessage(!1,this.dre)}sendMessage(b,h){this.vUa.RW([this.vUa.cOf(this.Gp)]);if(this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Gqb(r);const A=pe.a.Pua(this._image,this.za,this.St);A?Oe.a.WAb(this._image,A,4):this._image.setValue(Kh.a.JXa,!0);r.dispose()}this.F2j(b);Yb.a.mark(this.anc());
b=new Ua.QueryStringBuilder(this.tXd(b,!0));this.MLc&&b.Me(ri.a.Ihi,"true");this.sPk?(r=new Ua.QueryStringBuilder("WordOart.ashx"),y.AFrameworkApplication.pe.addRequest(r.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.vkg,null)):y.AFrameworkApplication.pe.addRequest(b.toString(),1,"",null,!0,0,h,this.vkg,null)}Gqb(b){b=this.xn&&this.xn!==qb.a.nil?new hb.GraphTransaction(7,fb.a.k9):new hb.GraphTransaction(15);b.Eb(this._context.node);return b}get Klk(){const b=
new hb.GraphTransaction(3);b.Eb(this._context.node);return b}Vye(){this.H4d();this.G4d();const b=this.Klk;var h=pe.a.xMa(this._image,this._context.node.ed,this.za,this.St);this._image.setValue(Kh.a.JXa,!1);this._image.setValue(Pd.a.T9c,h);this._image.setValue(Pd.a.mZ,-1);this._image.setValue(Kh.a.FR,1);h=pe.a.Pua(this._image,this.za,this.St);this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Pd.a.Jte),this._image.removeProperty(Pd.a.Ite),h&&Oe.a.WAb(this._image,
h,3));b.dispose();qC.Pq();this.SUa&&this.SUa()}F2j(b){this.qe&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.HQd=this.qe.rg("WebServiceCall",b))}H4d(){this.HQd&&(this.HQd.stop(),this.HQd=null)}qEe(){if(this.qe){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Gp,Kv.a[this.C5a]);this.GQd=this.qe.rg("WebServiceCall",b)}}G4d(){this.GQd&&(this.GQd.stop(),this.GQd=null)}V2(){if(Oe.a.cX){var b=this.vUa.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new Sa.a,
{durationMs:r}),hasImpliedUsage:!0},this.$d.logKpiSuccess({kpiName:ne.d.Awc+Dj.a[h]+Kv.a[this.C5a].toString(),optionalProperties:b}),this.vUa.Zxc(Number(h))}}Fej(b){this.$d.logKpiSuccess({kpiName:ne.d.k8c+this.Gp+Kv.a[b].toString()})}Eej(b,h){b=Object.assign(new Sa.a,{extendedProperties:new Map([["Exception",b.message]])});this.Dej("GraphicResponseInvalid",h,b)}Dej(b,h,r){r.extendedProperties.set("ErrorLevel","warning");this.$d.logKpiFailure({kpiName:ne.d.k8c+this.Gp+Kv.a[h].toString(),errorName:b+
Object(Pg.b)(this.ly,this.Wt),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:r},optionalVeto:Object(Pg.c)(ne.d.ATf,r,null,!1)})}static Pq(){const b=new wg.StandardDialog;b.Md=0;b.zA(Of.a.jjo,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Db.StaticActiveAppFrame.Aa()&&Db.StaticActiveAppFrame.Aa().Ne()}}Object(u.a)(qC,"RenderedImageEditOperation",null,[320]);var yN=e(217);class zN extends qC{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){super(b,
h,r,A,L,ba,ra,Ia,Ta,ob);if(Oe.a.ur||Oe.a.cX)this.$d=ej.a.getInstance(ne.a)}sendMessage(b,h){Object(yN.a)(()=>{let r;r=this.Gqb(r);this._image.setValue(Kh.a.FR,0);r.dispose()});this.F2j(b);Yb.a.mark(this.anc());this.vUa.RW([13]);b=new Ua.QueryStringBuilder("WordOart.ashx");this.Grh=this.getUrl(!0,!1);b=new wG.a(b.toString(),2,this.getUrl(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,
"text");y.AFrameworkApplication.pe.send(b).cxa(h,r=>{this.vkg(r)})}Avc(b){try{const h=JSON.parse(b.data.TFa);this.VDk=h[ri.a.j8c];this.TYk=h[ri.a.width];this.pEk=h[ri.a.height];this.hdh=h[ri.a.MVc];this.CJc=Array(4);this.CJc[zm.a.left]=h[ri.a.zrb];this.CJc[zm.a.right]=h[ri.a.Arb];this.CJc[zm.a.top]=h[ri.a.Brb];this.CJc[zm.a.bottom]=h[ri.a.yrb];this.swh=void 0!==h[ri.a.vEa]?"true"===h[ri.a.vEa].toLowerCase():null;Object(yN.a)(()=>{this.Bwd();this._context.node.hk().Jg.lG(()=>{this.Efm()},null,null)})}catch(h){Oe.a.ur&&
(b=Object.assign(new Sa.a,{extendedProperties:new Map([["Exception",h.message],["Operation",this.Gp]])}),b.extendedProperties.set("ErrorLevel","warning"),this.$d.logKpiFailure({kpiName:ne.d.Ace+ne.b.dMa+Kv.a[pe.a.pl(this._image)].toString(),errorName:"DrawingResponseInvalid"+Object(Pg.b)(this.ly,this.Wt),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(Pg.c)(ne.d.HQi,b,null,!1)})),v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
h.message,this.Gp,pe.a.pl(this._image)),this.Vye()}}pqe(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Bwd(){let b;b=this.Gqb(b);this._image.setValue(Me.a.WI,this.VDk);this.hdh&&this._image.setValue(Me.a.zVd,this.hdh);this._image.setValue(Me.a.wDa,this.TYk);this._image.setValue(Me.a.xDa,this.pEk);this._image.setValue(Me.a.GYa,this.CJc);this.iFk&&this._image.setValue(Pd.a.HUb,this.iFk);Oe.a.WAb(this._image,this.Grh,3);this._image.setValue(Rc.a.xrb,this.Grh);this.swh?
this._image.setValue(Me.a.ucb,this.swh):this._image.removeProperty(Me.a.ucb);this.txl();b.dispose()}txl(){this._image.removeProperty(Pd.a.Iw);this._image.removeProperty(Pd.a.mZ);this._image.removeProperty(Pd.a.Jte);this._image.removeProperty(Pd.a.Ite)}Efm(){this.qO.hQa(this._context);if(this.xn&&this.xn!==qb.a.nil){const b=this._context.node.hk(),h=new V.a(this.xn,1);this.yo.Chc(b,h)}this.me.Vv(13);Oe.a.ur&&this.$d.logKpiSuccess({kpiName:ne.d.Ace+ne.b.dMa+Kv.a[pe.a.pl(this._image)].toString()});this.H4d();
this.G4d();Yb.a.mark(this.f7c());this.vUa.gM([13]);this.V2();Object(yN.a)(()=>{let b;b=this.Gqb(b);this._image.setValue(Kh.a.FR,1);b.dispose()});this.SUa&&this.SUa()}getUrl(b,h){b=new Ua.QueryStringBuilder(this.tXd(b,h));b.Me(ri.a.Cee,"true");return b.toString()}anc(){return 51511}f7c(){return 51512}}Object(u.a)(zN,"RenderedGraphicEditOperation",qC,[]);var HO=e(593);class CG extends qC{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){super(b,h,r,A,L,ba,ra,Ia,Ta,nb);this.Bmh=null;this.pqe=Eb=>{const bc=this.tXd(!0,
!1);let Bc;Bc=this.Gqb(Bc);this._image.setValue(Rc.a.NVc,this.HPd);var Yc=Xa.a.instance.Wa("Box4.IFeatureHelper");Oe.a.ur&&this.Fej(this.iKb);Yc&&Yc.isFeatureEnabled(43)&&this._image.setValue(Rc.a.K5d,this.Bmh);this.za.$("WordEditorImageRotateIsEnabled")&&this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.ll.fBe(this._image,this.XH,this.Hkb,this.Ikb);const zd=pe.a.Pua(this._image,this.za,this.St),Jd=()=>{zd&&Oe.a.WAb(this._image,zd,3);Oe.a.WAb(this._image,bc,3);this.ll.dBe(this._image,
fg.a.YJ(this.aV),fg.a.YJ(this.r0),fg.a.YJ(this.Zw),fg.a.YJ(this.mka));this._image.setValue(Rc.a.xrb,bc);pe.a.QB(this._image)||this._image.setValue(Rc.a.mNa,xp.a.Dfb);this.ll.MAe(this._image,this.Wt,this.ly);this.za.$("WordEditorImageRotateIsEnabled")&&!this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.ll.fBe(this._image,this.XH,this.Hkb,this.Ikb);2===Eb.data.status&&pe.a.l5(Eb.data.responseData)&&(this._image.setValue(Pd.a.Iw,Eb.data.responseData),Eb.data.request&&this._image.setValue(Pd.a.HUb,
Object(HO.a)("POST"===Eb.data.request.get_httpVerb()?Eb.data.request.get_body():Eb.data.request.get_url())));this.SUa&&this.SUa();this.qO.hQa(this._context);if(this.xn&&this.xn!==qb.a.nil){const ie=this._context.node.hk(),re=new V.a(this.xn,1);this.yo.Chc(ie,re)}this.me.Vv(13);this.H4d();this.G4d();Yb.a.mark(this.f7c());this.vUa.gM([this.vUa.cOf(this.Gp)]);this.V2()};if(this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.xn&&this.xn!==qb.a.nil&&(Yc=this._context.node.hk())&&Yc.Jg){Bc.dispose();
Yc.Jg.lG(()=>{let ie;ie=this.Gqb(ie);Jd();ie.dispose()},null,null);return}Jd();Bc.dispose()};if(Oe.a.ur||Oe.a.cX)this.$d=ej.a.getInstance(ne.a);this.iKb=ob}anc(){return 51511}f7c(){return 51512}Avc(b){try{var h=JSON.parse(b.data.responseData);const L=Sys.Net.XMLDOM("string"===typeof h[ri.a.zWh]?h[ri.a.zWh]:null);this.HPd="string"===typeof h[ri.a.AVd]?h[ri.a.AVd]:null;const ba=Xa.a.instance.Wa("Box4.IFeatureHelper");ba&&ba.isFeatureEnabled(43)&&(this.Bmh="string"===typeof h[ri.a.Bkc]?h[ri.a.Bkc]:null);
X.a.Zt&&L.setProperty("SelectionNamespaces","xmlns:mc='"+Og.a.Dal+"'");const ra=L.selectSingleNode("/mc:AlternateContent");if(!ra)throw en.a.argument("Alternate content element could not be retrieved!");const Ia=ra.firstChild;if(!Ia)throw en.a.argument("Alternate content choice element could not be retrieved!");const Ta=Ia.firstChild;if(!Ta)throw en.a.argument("Drawing element could not be retrieved!");var r=Ta.firstChild;if(!r)throw en.a.argument("Inline element could not be retrieved!");h=b=null;
const ob=RegExp("effectExtent"),nb=RegExp("extent");for(const bc of r.childNodes)-1!==bc.nodeName.search(ob)&&(b=bc),-1!==bc.nodeName.search(nb)&&(h=bc);if(!b||!h)throw en.a.argument("Effect extent or extent could not be retrieved!");this.aV=parseInt(b.selectSingleNode("@l").text);this.r0=parseInt(b.selectSingleNode("@r").text);this.Zw=parseInt(b.selectSingleNode("@t").text);this.mka=parseInt(b.selectSingleNode("@b").text);const Eb=Pg.e(this.XH);if(45<=Eb&&135>=Eb||225<=Eb&&315>=Eb){const bc=parseInt(h.selectSingleNode("@cx").text);
var A=parseInt(h.selectSingleNode("@cy").text);r=bc/2;A/=2;this.aV-=r-A;this.r0+=r-A;this.Zw-=A-r;this.mka+=A-r}}catch(L){Oe.a.ur&&this.Eej(L,this.iKb);v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",L.message,this.Gp,Kv.a[this.iKb]);this.Vye();return}this.sendMessage(!0,this.pqe)}}Object(u.a)(CG,"RenderedDrawingEditOperation",qC,[]);class AN extends qC{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb){super(b,h,r,A,L,ba,ra,Ia,Ta,
Eb);this.Ifa=null;this.pqe=bc=>{var Bc;const Yc=this.tXd(!0,!1);let zd;zd=this.Gqb(zd);this._image.setValue(Rc.a.c_b,this.HPd);const Jd=pe.a.Pua(this._image,this.za,this.St);Oe.a.ur?this.Fej(this.iKb):(null===(Bc=y.AFrameworkApplication.J)||void 0===Bc?0:Bc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.$d.logKpiSuccess({kpiName:Kj.c.Ooc});const ie=()=>{Jd&&Oe.a.WAb(this._image,Jd,3);Oe.a.WAb(this._image,Yc,3);this.ll.dBe(this._image,fg.a.YJ(this.aV),fg.a.YJ(this.r0),fg.a.YJ(this.Zw),fg.a.YJ(this.mka));
this._image.setValue(Rc.a.xrb,Yc);pe.a.QB(this._image)||this._image.setValue(Rc.a.mNa,xp.a.Dfb);this._image.setValue(Rc.a.Akd,this.jh);this._image.setValue(Pd.a.uan,-1);this.Qd.isFeatureEnabled(83)&&pe.a.ioc(this._image)&&this.Lq.Yxc(this._image);this._image.setValue(Kh.a.JXa,!1);this.ll.MAe(this._image,this.Wt,this.ly);this.za.$("WordEditorImageRotateIsEnabled")&&this.ll.fBe(this._image,this.XH,this.Hkb,this.Ikb);this.za.$("WordEditorImageCropIsEnabled")&&this.ll.fDg(this._image,this.Y7b,this.V7b,
this.W7b,this.X7b);2===bc.data.status&&pe.a.l5(bc.data.responseData)&&(this._image.setValue(Pd.a.Iw,bc.data.responseData),bc.data.request&&this._image.setValue(Pd.a.HUb,Object(HO.a)("POST"===bc.data.request.get_httpVerb()?bc.data.request.get_body():bc.data.request.get_url())));this.SUa&&this.SUa();this.qO.hQa(this._context);if(this.xn&&this.xn!==qb.a.nil){const re=this._context.node.hk(),me=new V.a(this.xn,1);this.yo.Chc(re,me)}this.me.Vv(13);this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateCommandUIAfterSwordEdit",
!1)&&Db.StaticActiveAppFrame.Aa().Ne();this.H4d();this.G4d();Yb.a.mark(this.f7c());this.vUa.gM([this.vUa.cOf(this.Gp)]);this.V2()};if(this.za.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.xn&&this.xn!==qb.a.nil&&(Bc=this._context.node.hk())&&Bc.Jg){zd.dispose();Bc.Jg.lG(()=>{let re;re=this.Gqb(re);ie();re.dispose()},null,null);return}ie();zd.dispose()};this.iKb=ob;this.Qd=nb;if(Oe.a.ur||Oe.a.cX)this.$d=ej.a.getInstance(ne.a)}anc(){return 7988}f7c(){return 7989}get Lq(){this.Ifa||(this.Ifa=
new rN.a);return this.Ifa}Avc(b){var h;try{const r=b.data.xpa;this.HPd=b.data.responseData;X.a.Zt&&r.setProperty("SelectionNamespaces","xmlns:pic='"+Og.a.hjo+"'");const A=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.aV=parseInt(A.selectSingleNode("@l").text);this.r0=parseInt(A.selectSingleNode("@r").text);this.Zw=parseInt(A.selectSingleNode("@t").text);this.mka=parseInt(A.selectSingleNode("@b").text)}catch(r){b=Object.assign(new Sa.a,{extendedProperties:new Map});b.extendedProperties.set("exception",
r.message);b.extendedProperties.set("operation",this.Gp);Oe.a.ur?this.Eej(r,this.iKb):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Kj.c.vee,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.$d.logKpiFailure({kpiName:Kj.c.Ooc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},
optionalVeto:h})):Ca.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Gp,Kv.a[this.iKb]);this.Vye();return}this.sendMessage(!0,this.pqe)}}Object(u.a)(AN,"RenderedPictureEditOperation",qC,[]);class pJ{constructor(b,h,r,A,L,ba,ra,Ia){this.ll=b;this.za=h;this.St=r;this.qe=A;this.me=L;this.yo=ba;this.qO=ra;this.Qd=Ia}create(b,
h){const r=pe.a.pl(b);return Object(Li.d)(b)?new zN(b,h,this.ll,this.za,this.St,this.qe,this.me,this.yo,this.qO,new Dj.b):10===r||11===r||48===r||4===r?new CG(b,h,this.ll,this.za,this.St,this.qe,this.me,this.yo,this.qO,r,new Dj.b):5===r?new AN(b,h,this.ll,this.za,this.St,this.qe,this.me,this.yo,this.qO,r,this.Qd,new Dj.b):null}}Object(u.a)(pJ,"Factory",null,[300]);class BN{constructor(){this.t1c=b=>{const h=window.performance.now(),r=Wj.a.Pp();if(r){b=tG.a(b.customData,r);b=Xd.a.$u(b,r);var A=0,L=
new hb.GraphTransaction(3);try{for(L.Eb(r);b.moveNext();){if(!rd.ParagraphReader.Wh(b.iterator))continue;const ba=b.currentNode;this.Pmi(ba)&&(A++,ba.vm(4,!0));const ra=window.performance.now()-h;if(2500<A||100<ra){this.lKb=null;this.queueTask(ba);break}}}finally{L&&L.dispose()}}else Cd.b(570450380,3018,10,"PageContentNode not found")};this.lKb=null}CZi(){const b=Wj.a.Pp();this.Rmd(b);this.queueTask(null)}queueTask(b){this.lKb&&(y.AFrameworkApplication.zc.Kf(this.lKb),this.lKb=null);this.lKb=new Md.a(1,
1,1,this.t1c,198);this.lKb.customData=b;y.AFrameworkApplication.zc.pc(this.lKb)}Rmd(b){const h=tG.b(b);if(h){var r=new hb.GraphTransaction(3);try{for(r.Eb(b);h.moveNext();){if(!rd.ParagraphReader.Wh(h.iterator))continue;const A=h.currentNode;this.Pmi(A)&&A.vm(4,!0)}}finally{r&&r.dispose()}}}Pmi(b){b=b.QK;for(const h of b)if(h.GZa)return 0<h.M3b;return!1}}Object(u.a)(BN,"RenderParagraphsContainingTabs",null,[]);class CL{constructor(b,h){this.iTe=!0;this.xIc=null;this.k2l=()=>{this.xIc=null;this.iTe=
!0;this.TUa&&this.TUa.t3a(!Yg.a.fR())};this.aib=(r,A,L)=>{if(1===L)return 32;2===L&&(r=!1,Yg.a.fR()?this.iTe=!1:this.iTe?r=!0:this.GIp(),this.TUa&&this.TUa.t3a(r));return 32};this.ga=b;this.TUa=h}mc(){this.ga.nb(wb.a.aib,ic.a.application,this.aib,1124)}GIp(){this.xIc?y.AFrameworkApplication.zc.Kf(this.xIc):this.xIc=new Md.a(4,1,5E3,this.k2l);y.AFrameworkApplication.zc.pc(this.xIc)}}Object(u.a)(CL,"SaveStatusActor",null,[]);var IO=e(677);class DL{get gAg(){return null!=this.v8g?this.v8g:this.v8g=Xa.a.instance.Wa("Box4.ISaveStyleManager")}get tNo(){return this.sNo||
(this.sNo=Xa.a.instance.Wa("Box4.IResetAndDeleteStyleManager"))}get Zf(){return null!=this.R9g?this.R9g:this.R9g=Xa.a.instance.Wa("Box4.Styles.StyleSettings")}constructor(b,h){this.hNb=(r,A,L)=>{r=Wj.a.zWb(A);if(1===L||r)return r?8:32;this.h7.value.YJl(A);return 32};this.qPb=(r,A,L)=>{r=Wj.a.zWb(A);if(1===L||r)return r?8:32;this.h7.value.mOl(A,this.ga);return 32};this.yzf=(r,A,L,ba,ra)=>{var Ia;r=Wj.a.zWb(A)||this.X9o();if(1===L||r)return r?8:32;if(null===(Ia=y.AFrameworkApplication.J)||void 0===
Ia?0:Ia.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontStylesGalleryImprovementIsEnabled",!1))return L=Mz.a.x7c(ra.CommandValueId,this.kc.Il()),this.h7.value.Bji(A,L),32;this.h7.value.yzf(A);return 32};this.ga=b;this.h7=h}get kc(){return null!=this.Ibh?this.Ibh:this.Ibh=Xa.a.instance.resolve("Box4.Styles.IWACStyleReader")}mc(){this.ga.nb(fb.a.hNb,ic.a.view,this.hNb,1028);this.ga.nb(fb.a.qPb,ic.a.view,this.qPb,4);this.ga.nb(fb.a.bQb,ic.a.view,this.yzf,4);this.ga.nb(fb.a.fAg,ic.a.view,this.hTo.bind(this),
4);this.ga.nb(fb.a.qyg,ic.a.view,this.ryg.bind(this),4);this.ga.nb(fb.a.tzf,ic.a.view,this.hXl.bind(this),4)}hTo(b,h,r){b=Wj.a.zWb(h)||this.b$o();if(1===r||b)return b?8:32;this.gAg.gTo();return 32}ryg(b,h,r){b=Wj.a.zWb(h)||this.$9o();if(1===r||b)return b?8:32;this.tNo.ryg();return 32}hXl(b,h,r){b=Wj.a.zWb(h)||this.W9o();if(1===r||b)return b?8:32;this.h7.value.gXl();return 32}W9o(){return"{}"===uw.a.eDb?!0:!1}$9o(){if(0==uw.a.oR.size)return!0;var b=uw.a.oR;const h=this.kc.Il();let r=0;for(const A of b.values())b=
h.Qg(A),this.kc.ye(b,h)||r++;return 0==r?!0:!1}b$o(){var b=uw.a.eDb,h=uw.a.oR;const r=this.kc.Il();if(0==h.size)return!0;if(!({Zv:b}=H.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const L of h.values()){h=r.Qg(L);var A=b[L];if(null==A)return!1;if(A=Wj.a.ybe(A)){if(h=Wj.a.H5c(h,r),Wj.a.Zbd(h,A))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}X9o(){var b=
Wj.a.Pp();if(!b)return Cd.b(577368330,3018,15,"PageContentNode is null"),!0;b=this.Zf.zl?(new uu.a).pna(b):(new uu.a).Oca(b);const h=b.ix;for(let A=0;A<h;A++){let L;b instanceof uu.a?L=b.nDa(A):b instanceof IO.a&&(L=b.uha(A));if(!this.kc.isHidden(L)&&this.kc.ye(L,b)){var r=this.kc.wH(L);if(2===r||1===r)if(!L.hasProperty(Rc.a.linkedStyle)||2===r)if(r=L.ka(Rc.a.cG,null),!(r&&0<r.length))return!1}}return!0}}Object(u.a)(DL,"StylesActor",null,[]);class vE{constructor(b){this.hFe=(h,r,A)=>{h=y.AFrameworkApplication.ta;
if(1===A)return 1!==h.mode||id.SessionStatusManager.instance.zk?2:32;Ca.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,vE.GB,null);const L={};L[G.a.GWf]=y.AFrameworkApplication.J.rb("ClassicViewModePreferenceCookieName");L[G.a.rUi]="true";y.AFrameworkApplication.NL().execute(ba=>{ba.sendMessage(J.a.amp,L)});return y.AFrameworkApplication.va.Vb(fb.a.readingMode,2)};this.ga=b}mc(){this.ga.qa(Lc.a.hFe,ic.a.view,this.hFe)}}vE.GB="wwaengidc";Object(u.a)(vE,"SwitchToClassicViewModeActor",null,
[]);class wM{constructor(b,h,r,A,L,ba,ra,Ia,Ta){this.angle=r;this.styleId=A;this.width=b;this.height=h;this.top=L;this.bottom=ba;this.left=ra;this.right=Ia;this.g1=Ta}}Object(u.a)(wM,"SWordData",null,[]);class CN{constructor(b,h){this.hp=this.z7=this.vs=null;this.t9e=this.Uac=!1;this.aV=this.r0=this.mka=this.Zw=this.jh=this.ly=this.Wt=this.XH=0;this.xn=null;this.U9=()=>{this.t9e=!1;this.Uac&&this.p2c()};this.ir=b;this.mRc=h;this.NWi()}NWi(){this.r0=this.aV=this.mka=this.Zw=this.jh=this.ly=this.Wt=
this.XH=-1;this.xn=qb.a.nil}p2c(){this.t9e||(this.dMp(),this.IPl(),this.Uac=!1)}IPl(){this.hp=new wM(this.Wt,this.ly,this.XH,this.jh,this.Zw,this.mka,this.aV,this.r0,this.xn);this.mRc.create(this.z7,this.vs).g4o(this.U9,this.hp);this.t9e=!0;let b;Object(Pb.a)(5,this.z7)?b=Kv.a[pe.a.pl(this.z7)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");v.ULS.sendTraceTag(23171277,
322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.Wt,this.ly,this.XH,this.jh,this.Zw,this.mka,this.aV,this.r0,b);this.NWi()}dMp(){this.Wt=-1!==this.Wt?this.Wt:this.z7.ka(Pd.a.kNa,-1);this.ly=-1!==this.ly?this.ly:this.z7.ka(Pd.a.jNa,-1);this.Wt=-1!==this.Wt?this.Wt:this.ir.XD(this.z7);this.ly=-1!==this.ly?this.ly:this.ir.iF(this.z7);this.XH=-1!==this.XH?this.XH:this.ir.N4(this.z7);this.jh=
-1!==this.jh?this.jh:this.ir.Ntb(this.z7);const b=this.ir.oha(this.z7);this.Zw=-1!==this.Zw?this.Zw:b.top;this.mka=-1!==this.mka?this.mka:b.bottom;this.aV=-1!==this.aV?this.aV:b.left;this.r0=-1!==this.r0?this.r0:b.right}Cto(b,h,r,A){this.vs=b;this.XH=r;this.Uac=!0;this.z7=h;this.xn=A;this.p2c()}Bto(b,h,r,A,L){this.vs=b;this.Uac=!0;this.z7=h;this.xn=L;this.z7.setValue(Pd.a.kNa,r);this.z7.setValue(Pd.a.jNa,A);this.p2c()}Gto(b,h,r){this.vs=b;this.Uac=!0;this.z7=h;this.jh=r;this.p2c()}wto(b,h,r,A,L,ba){this.vs=
b;this.Zw=r;this.mka=A;this.aV=L;this.r0=ba;this.Uac=!0;this.z7=h;h=b=0;({width:b,height:h}=this.ir.Pab(this.z7));this.Wt=b-(L+ba)/1E5*b;this.ly=h-(r+A)/1E5*h;this.p2c()}}Object(u.a)(CN,"SWordRequestManager",null,[285]);class qJ{static W1f(b,h){if(qJ.fxn){const r=new te.a;r.Ad(b);hg.a.xe(r);if(nf.a.Wg(r)&&Mb.a.RC(r,h,!1))return!0}return!1}static get fxn(){var b;y.AFrameworkApplication.ud("egdi3422;7g6fa693");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",
!1)}}Object(u.a)(qJ,"TableTabSelectionHelper",null,[]);class MA{constructor(b,h,r,A=null,L=null,ba=null,ra=null,Ia=null,Ta=null,ob=null){this.yo=null;this.oPh=!1;this.Iop=(nb,Eb,bc,Bc,Yc)=>{var zd;if(1===bc)return 32;const Jd=nb===fb.a.hCe;if(!Eb.view.Ee)return 2;const ie=Eb.view,re=ie.ub,me=re.hh;if(!me||MA.Ig.t4(me))return 2;if(this.Qo&&this.Qo.instance&&this.Qo.instance.wZ(me))return 4;var Sd=null,cf=qf.ActionManager.QEa,sf=!1,yh=Ee.a.Df(me);if(me.My)re.ob.IN&&(cf=me.getContext(0),Sd=new te.a,
Sd.set(cf.node),Sd.ku(),cf=Jd?fb.a.QAg:fb.a.Pze),cf=this.Gcf.Yno(cf),cf===qf.ActionManager.QEa&&((zd=Object(ak.a)().zV(me,16))?(Jd&&(cf=fb.a.ioe),Sd=new te.a,Sd.set(zd.node),Sd.Wd()):cf=Jd?fb.a.uK:fb.a.dT);else if(me.nm)if(Sd=new te.a,Sd.set(me.node),Ee.a.uw(Sd),il.a.UZa(me))cf=Jd?fb.a.QAg:fb.a.Pze;else{if(this.lYe&&this.lYe.jbp(me))return this.lYe.crd(me,ie.Lc,Jd),32;pe.a.mcb(me)?cf=Jd?fb.a.PAg:fb.a.OAg:(cf=Jd?this.Gcf.QZm(Sd,me,cf,Eb):this.Gcf.PZm(Sd,me,cf),Mb.a.ji(Sd)&&me.contextId===ic.a.kd&&
(sf=Mb.a.RC(Sd,me,!1)),ih.TableCellReader.b2(Sd)&&(null===(zd=y.AFrameworkApplication.J)||void 0===zd?0:zd.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1))&&(sf=qJ.W1f(Sd,me)),zd=nf.a.Wg(Sd)&&sf,cf!==qf.ActionManager.QEa||ih.TableCellReader.lda(Sd)||zd||(this.oPh||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.oPh=!0),y.AFrameworkApplication.va.Vb(fb.a.nXi,2),this.MXi(Eb)))}else return 2;if(!Jd&&cf===qf.ActionManager.QEa&&ih.TableCellReader.lda(Sd))if(Lh.z(Sd),
ih.TableCellReader.OZa(Sd)||Qh.TableReader.o3i(Sd)&&ih.TableCellReader.die(Sd)){if(cf=this.n_k(),!cf)return 2}else cf=fb.a.Flj;if(cf===qf.ActionManager.QEa)return 2;switch(cf){case fb.a.Flj:case fb.a.ioe:sf=cf===fb.a.ioe;yh&&this.S6&&this.h3&&(yh=this.S6.qGf(me,-1,!0,pg.a.iB))&&this.h3.BPj(yh);bc=32;Lh.z(Sd);Lh.r(Sd,sf)&&(yh=!0,sf=!1,il.a.HVf(Sd)||(hm.OutlineNavigator.zcg(Sd,!1),hg.a.Ze(Sd),rd.ParagraphReader.Xv(Sd.currentNode)&&(yh=!1,rd.ParagraphReader.textLength(Sd.currentNode)||(sf=!0)),sf||Lh.z(Sd)),
sf?Sd=Tb.SelectionFactory.Ie(Sd.currentNode,0):(Sd=Tb.SelectionFactory.ot(Sd.currentNode),!yh&&Ee.a.em(Sd.hd)&&(yh=Sd.toArray(),Array.removeAt(yh,yh.length-1),Sd=new Fl.Selection(yh,Sd.ig))),re.Uc(Sd));break;case fb.a.QAg:case fb.a.Pze:cf===fb.a.Pze?hm.OutlineNavigator.Jkj(Sd,!1):hm.OutlineNavigator.Jkj(Sd,!0);re.Uc(Tb.SelectionFactory.ot(Sd.currentNode));bc=32;break;case fb.a.vtd:bc=y.AFrameworkApplication.va.Sf(Eb,cf,bc,!0,Bc,Yc);break;default:if(Sd=()=>{const si=new Ai.DictionaryPropertySet;si.setValue(Kh.a.Vee,
nb===fb.a.hCe?"ShiftTab":"tab");return si},bc=y.AFrameworkApplication.va.Sf(Eb,cf,bc,!0,Bc,Ih.W8f?Sd():Yc),!sf&&yh&&(cf===fb.a.uK||cf===fb.a.dT)){const si=Ee.a.hta(re.ob.currentSelection).y;Ze.a.Oxc(()=>{this.bWn(re,ie,si)})}}32===bc&&Eb.view.Ee&&this.Dh.eK();return bc};this.Hsa=b;this.Gcf=h;this.Qo=r;this.S6=A;this.h3=L;this.Icf=ba;this.aSa=ra;this.Qd=Ia;this.Zc=Ta;this.lYe=ob}get Dh(){return this.yo||(this.yo=this.Hsa())}mc(){const b=y.AFrameworkApplication.va,h=this.Iop;b.nb(fb.a.tab,ic.a.view,
h,1124);b.nb(fb.a.hCe,ic.a.view,h,1124);b.qa(fb.a.nXi,ic.a.view,qf.ActionManager.qg)}bWn(b,h,r){if(b&&h){var A=b.ob.currentSelection;Ee.a.hta(A).y<r?(h=Ee.a.u3c(h,A,!1),h=Ee.a.QCa(h,{FG:!1,gw:!1,NI:!1,JK:!0})):h=Ee.a.E6d(h,A,!1);b.Uc(h)}}n_k(){return fb.a.gcb}MXi(){}Ogd(b,h,r){if(b&&h){var A=b.ob.currentSelection;Ee.a.hta(A).y<r?(h=Ee.a.u3c(h,A,!1),h=Ee.a.QCa(h,{FG:!1,gw:!1,NI:!1,JK:!0})):h=Ee.a.QCa(A,{FG:!1,gw:!1,NI:!1,JK:!0});b.Uc(h)}}static get Ig(){return Ke.a.instance}}Object(u.a)(MA,"TabActor",
null,[]);class EL{constructor(b){this.SLc=b}get Hs(){return this.SLc}Yno(b){return b}QZm(b,h,r,A){A=A.view;const L=A.ub.ob.currentSelection;if(ih.TableCellReader.lda(b))return qJ.W1f(b,h)?fb.a.uK:fb.a.ioe;hg.a.xe(b);if(Ee.a.Df(h))Mb.a.RC(b,h,!1)&&this.RYj(b)?r=fb.a.H_b:Ee.a.ije(A,L)&&this.Hs.fOb(b)?r=fb.a.uK:Ee.a.ije(A,L)&&(r=fb.a.uK);else if(Ee.a.Rm(h)){if(!this.Hs.fOb(b))return r;Ee.a.Mvb(h)?r=fb.a.uK:Ee.a.D8i(h)&&(r=this.RYj(b)?fb.a.H_b:fb.a.uK)}else this.Hs.fOb(b)&&(r=fb.a.uK);return r}PZm(b,
h,r){if(ih.TableCellReader.b2(b))return qJ.W1f(b,h)?fb.a.dT:r;hg.a.xe(b);if(Ee.a.Df(h))Mb.a.RC(b,h,!1)&&(!nf.a.Wg(b)&&Mb.a.isEmpty(b,!1)?r=qf.ActionManager.QEa:this.V9o(b)?r=fb.a.erb:this.bYj(b)?r=fb.a.dQb:this.Hs.Kgc(b)&&(r=fb.a.dT));else if(Ee.a.Rm(h)){if(!this.Hs.Kgc(b))return r;Ee.a.Mvb(h)?r=fb.a.dT:Ee.a.D8i(h)&&(r=this.bYj(b)?fb.a.dQb:fb.a.dT)}else this.Hs.Kgc(b)&&(r=fb.a.dT);return r}RYj(b){return nf.a.Wg(b)?!1:0<Mb.a.M4(b)?!0:!1}bYj(b){if(nf.a.Wg(b))return!1;const h=Mb.a.M4(b);b=il.a.u1(b.currentNode);
return h<b?!0:!1}V9o(b){return nf.a.Wg(b)?!1:0<Mb.a.cK(b)?!0:!1}static tu(){return new EL(px.a.hTb)}}Object(u.a)(EL,"TabActorPromoteDemoteStrategy",null,[293]);class wE extends MA{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){super(b,h,r,A,L,ba,ra,Ia,Ta,ob);this.Qqe=(Bc,Yc)=>{Bc=Yc.property;!this.vod||Bc!==Rc.a.pageWidth&&Bc!==Rc.a.marginLeft&&Bc!==Rc.a.marginRight||this.vod.CZi()};this.u1=(Bc,Yc,zd,Jd,ie)=>{Bc=il.a.u1(this.$Km(Yc));ie.defaultTabStop=Bc;return 32};this.Xac=nb;this.ga=bc;this.EG();
this.ga.qa(Lc.a.u1,ic.a.view,this.u1)}get vod(){return null!=this.h8g?this.h8g:this.h8g=Xa.a.instance.Wa("WordEditor.Actors.RenderParagraphsContainingTabs")}EG(){this.Xac.Um.Hf(10).yq(this.Qqe)}MXi(b){const h=b.view,r=h.ub;b=r.hh;if(this.aSa&&this.Zc){var A=this.Zc.Vc(15);A.Eb(b.node);b.contextId===ic.a.Nd&&y.AFrameworkApplication.va.Vb(fb.a.WJ,2);this.aSa.Cfe(r.hh);A.dispose();var L=Ee.a.hta(r.ob.currentSelection).y;Ze.a.Oxc(()=>{this.Ogd(r,h,L)})}}$Km(b){return b.view.ub.ob.currentSelection.Ya.node}static get instance(){return null!=
wE.a3g?wE.a3g:wE.a3g=wE.In()}static In(){return new wE(()=>Xa.a.instance.resolve("Box4.IUndoManager"),EL.tu(),Xa.a.instance.Za("Box4.IExternalSelectionManager"),Xa.a.instance.resolve("Box4.IAutoCorrectRules"),Xa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Xa.a.instance.Wa("Box4.ITabPresenterFactory"),Xa.a.instance.Wa("Box4.IBlobEditor"),Xa.a.instance.Wa("Box4.IFeatureHelper"),Xa.a.instance.Wa("Box4.Graph.GraphTransactionFactory"),Xa.a.instance.Wa("Box4.Actors.IIFrameFocusStrategy"),Ze.a.wf,Xa.a.instance.Wa("Box4.ITabRenderer"),
y.AFrameworkApplication.va)}}Object(u.a)(wE,"TabActor",MA,[]);class Mr{static get xv(){return null!=Mr.PWg?Mr.PWg:Mr.PWg=Xa.a.instance.resolve("Box4.IAppFrame")}static get vE(){return null!=Mr.X8g?Mr.X8g:Mr.X8g=Xa.a.instance.Za("Common.ISystemInitiatedFeedback")}static initialize(){var b,h;oo.a.wrc=Mr.hyn;Fg.a.instance.BD(Mr.frl);if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.tableCellSizeUpdate",!1))null===(h=y.AFrameworkApplication.va)||
void 0===h?void 0:h.qa(Lc.a.kud,ic.a.view,Mr.kud)}static kud(b,h,r){if(2===r)return null!=Mr.vE&&Mr.vE.execute(A=>{A.logActivity("triggerTableResizeTUI",null);$d.a("TableResizeTUITriggered")}),y.AFrameworkApplication.va.Vb(Lc.a.Ood,2),32}static frl(){Mr.pPp()}static hyn(b){return!Qh.TableReader.Fsn(b)}static pyb(){Mr.xv.cyc(Mr.pyb);Mr.eJb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static pPp(){var b,
h,r;((null===(b=Js.a.instance.currentSelection)||void 0===b?0:b.eOa)||(null===(h=Js.a.instance.currentSelection)||void 0===h?0:h.Oy)||(null===(r=Js.a.instance.currentSelection)||void 0===r?0:r.cdb))&&!Mr.eJb&&(Mr.xv.GVa(Mr.pyb),Mr.eJb=!0)}}Mr.eJb=!1;Object(u.a)(Mr,"TableActor",null,[]);class FL{xfm(b,h,r,A){return b?this.Xdm(h,r,A):this.yfm(h,r,A)}Sti(b,h,r,A,L){return b?this.Zem(h,r,A,L):this.Mem(h,r,A,L)}Iem(b){let h=!1;var r=b.ig?b.pf.hd:b.pf.Ya;b=new te.a;b.set(r.node);b.Ib(14);r=null;ih.TableCellReader.cia(b)?
ih.TableCellReader.WVb(b)||(h=!0,r=Lh.t(b)):r=Lh.q(b);return{returnValue:r,xWn:h}}Uem(b){var h=b.ig?b.pf.hd:b.pf.Ya;const r=new te.a;r.set(h.node);r.Ib(14);h=null;ih.TableCellReader.goa(r)?ih.TableCellReader.foa(r)||(h=new te.a,h.set(b.CBa.node),h.Ib(14),b=yp.a.fv(h),yp.a.fv(r)>b?(Lh.x(r),Lh.m(r),h=r.currentNode):h=Lh.x(r)):h=Lh.w(r);return h}cui(b,h){var r=b.ig?b.pf.hd:b.pf.Ya;b=new te.a;b.set(r.node);b.Ib(14);r=null;h?ih.TableCellReader.foa(b)||(r=Lh.x(b)):ih.TableCellReader.WVb(b)||(r=Lh.t(b));
return r}QWb(b,h,r){for(;ih.TableCellReader.eh(b);)if(h){if(r&&b.ZDa(1)||!r&&b.cEa(1))return null;r?Lh.w(b):Lh.q(b)}else{if(ih.TableCellReader.A9(b.currentNode)){const A=new te.a;A.Ad(b);if(this.QWb(A,!0,!0)||this.QWb(A,!0,!1)){b.Ad(A);break}}else{if(!r&&Lh.j(b,2))break;if(r&&Lh.j(b))break}if(r&&ih.TableCellReader.foa(b)||!r&&ih.TableCellReader.WVb(b))return null;r?Lh.x(b):Lh.t(b)}return b.currentNode}Tkc(b,h){if(!yp.a.isTableRow(b))return null;b=te.a.kb(b.currentNode);b.Ib(14);let r;const A=Qh.TableReader.sF(b.origin);
do r=h?Lh.x(b):Lh.t(b);while(A&&r&&yp.a.DZa(b));return r}Mxb(b,h,r,A,L){let ba=null;hg.a.xe(b);const ra=Mb.a.isRtl(b.currentNode);if(r)if(Lh.z(b),h=ih.TableCellReader.cia(b),r=ih.TableCellReader.goa(b),L||!ra&&r||ra&&A&&h)Lh.B(b),(A=this.Tkc(b,!0))?ba=Tb.SelectionFactory.zq(A,!h):L&&(hg.a.xe(b),L=new Oi.a,L.Ad(b),(b=hg.a.D5(L,!1,!1))&&(ba=Tb.SelectionFactory.zq(b,!1)));else{do ra?Lh.q(b):Lh.w(b);while(ih.TableCellReader.eh(b)&&!ih.TableCellReader.foa(b));ih.TableCellReader.eh(b)||(ba=Tb.SelectionFactory.zq(b.currentNode,
!ra))}else Mb.a.RC(b,h,ra)||Ee.a.Df(h)||Lh.z(b),ba=Tb.SelectionFactory.zq(b.currentNode,!ra);return ba}Lxb(b,h,r,A,L){let ba=null;hg.a.xe(b);const ra=Mb.a.isRtl(b.currentNode);if(r)if(Lh.z(b),r=ih.TableCellReader.cia(b),h=ih.TableCellReader.goa(b),L||!ra&&A&&r||ra&&!A&&h)Lh.B(b),(A=this.Tkc(b,!1))?ba=Tb.SelectionFactory.zq(A,h):(hg.a.xe(b),A=new Oi.a,A.Ad(b),(b=hg.a.Fu(A,!1,!1))&&(ba=Tb.SelectionFactory.zq(b,!0)));else{do ra?Lh.w(b):Lh.q(b);while(ih.TableCellReader.eh(b)&&!ih.TableCellReader.cia(b));
ih.TableCellReader.eh(b)||(ba=Tb.SelectionFactory.zq(b.currentNode,ra))}else Mb.a.RC(b,h,!ra)||Ee.a.Df(h)||Lh.z(b),ba=Tb.SelectionFactory.zq(b.currentNode,ra);return ba}}Object(u.a)(FL,"ATableCellSelectionStrategy",null,[1608]);class GL extends FL{constructor(){super()}Mem(b,h,r,A){let L=b.currentSelection,ba=null;if(b.Oy)if(h)if(2===L.pf.Roa&&!L.ig&&L.pf.hd.equals(L.CBa))L=Tb.SelectionFactory.Pfi(L.CBa.node,!1);else{var ra=({xWn:b}=this.Iem(L)).returnValue;ra&&(ih.TableCellReader.Js(ra)&&(ra=te.a.kb(ra),
ra.Ib(14),ra=!b&&this.QWb(ra,!0,!1)?ra.currentNode:b||Lh.t(ra)?this.QWb(ra,!1,!1):null),ra&&(ba=Tb.SelectionFactory.aq(yt.TableNodeContext.create(ra),L.ig)))}else L=b.Mja,b=te.a.kb(L.pf.hd.node),b.Ib(14),ih.TableCellReader.MNa(b.currentNode)&&Lh.n(b,2),(ra=Lh.q(b))?(b=ih.TableCellReader.A9(ra),ih.TableCellReader.Js(ra)&&!b&&(ra=te.a.kb(ra),ra.Ib(14),ra=Lh.j(ra)),b?L=Tb.SelectionFactory.zq(L.pf.hd.node,!1):ba=Tb.SelectionFactory.zq(ra,!0)):(ra=L.pf.hd.node,ba=Tb.SelectionFactory.zq(ra,!1));else b=
h&&L.ig||!h&&!L.Sva?L.pf.hd:L.pf.Ya,yp.a.B9(b.node)&&(b=te.a.kb(b.node),(ra=this.Tkc(b,!1))?ba=h?Tb.SelectionFactory.aq(yt.TableNodeContext.create(ra),L.ig):Tb.SelectionFactory.zq(ra,!0):L=Ee.a.Xk(Tb.SelectionFactory.ot(b.currentNode),!1,!0));return ba?ba:A?Ee.a.Skc(L,!1,h,!0):Ee.a.QCa(L,{FG:!h,gw:h,NI:r,JK:!0})}Zem(b,h,r,A){let L=b.currentSelection;var ba=null;if(b.Oy)h?1===L.pf.Roa&&L.ig&&L.pf.Ya.equals(L.CBa)||(ba=this.Uem(L),(ba=this.Qti(L,ba))||L.ig&&(L=L.S3c())):(L=b.Mja,ba=Tb.SelectionFactory.zq(L.pf.Ya.node,
!0));else if(h){var ra=(L.ig?L.pf.hd:L.pf.Ya).node;b=te.a.kb(ra);Ee.a.uw(b);yp.a.B9(ra)&&(L.ig&&1===L.pf.Roa&&L.Sva?(ba=yp.a.UD(ra).toArray(),(ba=this.Qti(L,0<=ba.length-2?ba[ba.length-2]:null))||L.ig&&(L=L.S3c())):(ra=this.Tkc(b,!0))?ba=Tb.SelectionFactory.aq(yt.TableNodeContext.create(ra),L.ig):L=Tb.SelectionFactory.zq(b.currentNode,!0))}else ba=Ee.a.Xk(L,!0,!1);return ba?ba:A?Ee.a.Skc(L,!0,h,!0):Ee.a.jMa(L,{FG:!h,gw:h,NI:r,JK:!0})}Qti(b,h){if(!h)return null;var r=h;ih.TableCellReader.Js(h)&&(r=
te.a.kb(h),r.Ib(14),r=this.QWb(r,!0,!0)?r.currentNode:ih.TableCellReader.O8(h));return r?Tb.SelectionFactory.aq(yt.TableNodeContext.create(r),b.ig):null}yfm(b,h,r){let A=h.currentSelection,L=null;if(h.Oy){var ba=h.e1>h.KQa;if(r)if(2===h.length&&1===h.Mja.pf.Roa&&ba)A=Ee.a.Xk(A,!0,!1);else{if(h=this.cui(A,!0))ih.TableCellReader.Js(h)&&(h=te.a.kb(h),h.Ib(14),h=this.QWb(h,!1,!0)),h&&(L=Tb.SelectionFactory.aq(yt.TableNodeContext.create(h),A.ig));L||A.ig&&(A=A.S3c())}else ba&&(A=h.Mja)}else h=r&&A.ig?
A.pf.hd:A.pf.Ya,yp.a.B9(h.node)&&(h=te.a.kb(h.node),(ba=this.Tkc(h,!0))?L=r?Tb.SelectionFactory.aq(yt.TableNodeContext.create(ba),A.ig):Tb.SelectionFactory.zq(ba,!0):r&&(A=Tb.SelectionFactory.zq(h.currentNode,!0)));return L?L:Ee.a.Hqb(b,A,!1,r,r)}Xdm(b,h,r){let A=h.currentSelection,L=null;if(h.Oy){const ba=h.e1<h.KQa;if(r)if(2===h.length&&1===h.Mja.pf.Roa&&ba)A=Ee.a.Xk(A,!1,!1);else{if(h=this.cui(A,!1))ih.TableCellReader.Js(h)&&(h=te.a.kb(h),h.Ib(14),h=this.QWb(h,!1,!1)),h&&(L=Tb.SelectionFactory.aq(yt.TableNodeContext.create(h),
A.ig))}else ba&&(A=h.Mja)}else h=!r||A.ig?A.pf.hd:A.pf.Ya,yp.a.B9(h.node)&&(h=te.a.kb(h.node),(h=this.Tkc(h,!1))&&(L=r?Tb.SelectionFactory.aq(yt.TableNodeContext.create(h),A.ig):Tb.SelectionFactory.zq(h,A.Sva)));return L?L:Ee.a.Hqb(b,A,!0,r,r)}}Object(u.a)(GL,"TableCellSelectionStrategy",FL,[]);class DN{constructor(b){this.nM=(h,r,A,L,ba)=>{if(1===A)return 32;h=(new Em.a).create();r="";switch(ba.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ba=CommonUIStrings.l_DefaultDialogTitle;
break;default:ba=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.nM(ba,null,null);return 32};this.ga=b}mc(){this.ga.nb(fb.a.nM,ic.a.view,this.nM,1028)}}Object(u.a)(DN,"UIAutomationActor",null,[]);class EN{constructor(b,h,r,A){this.qb=b;this.aSa=h;this.KGc=r;this.Haa=A}TNg(b,h,r){return this.KGc.Svn(h)?r?!0:b&&this.qb.Wh(b)?(b=this.uz(b.currentNode),this.aSa.WXi(b),!0):!1:!1}ZUf(b,h){return this.KGc.q9l(b,h)}eVf(b){b&&this.qb.Wh(b)&&(b=this.uz(b.currentNode),this.aSa.Cfe(b))}uz(b){return vc.a.uz(b)}kea(b,
h,r){this.Haa.Sxj&&this.KGc.G1i(r)&&(this.Haa.kea(b,h),b.setValue(Pd.a.$1i,!0))}PAb(){}Dhe(b){return this.KGc.Dhe(b)}get Kie(){return this.KGc.Kie}HG(){}tja(){}MBe(){}get lZj(){return!1}}Object(u.a)(EN,"WordEditorPasteStewardBridge",null,[284]);class JO{constructor(b){this.sa=new Nf.a;this.ROj="WordFileSaveAsButtonClicked";this.rPp=()=>{this.sa.raiseEvent(this.ROj,null);return 32};this.ga=b}mc(){y.AFrameworkApplication.J.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Lc.a.Thk,dd.a.frame,this.rPp)}x8k(b){this.sa.addHandler(this.ROj,
b)}}Object(u.a)(JO,"WordFileSaveAsActor",null,[]);class FN extends Zi{constructor(){super()}lWc(b,h,r,A,L,ba,ra){return Bp.a.Cwc(h,r,A,L,ba,ra)}}Object(u.a)(FN,"WordIndentationActorExtension",Zi,[]);class GN extends Xf.a{constructor(b){super(!1,!1,!0);this.n6f=b;this.WBl=this.n6f.n9o}Pep(){const b=Box4Intl.Box4Strings.l_KeyboardShortcutsDialogTitle;this.Md=null;const h={["id"]:"KeyboardShortcutsDialog",["bodyControls"]:{defaultCheckbox:!0,renderOverrideShortcutsSection:!0,prioritySection:"section2"},
["shortcuts"]:this.WBl};this.ti(b,this.Lmk.bind(this),h)}Lmk(){}}Object(u.a)(GN,"KeyboardShortcutsDialog",Xf.a,[]);class HN{constructor(){this.YJh=[];this.sQl()}get n9o(){return this.YJh}sQl(){this.b0k();this.W1k();this.j3k();this.x4k();this.J4k();this.s4k();this.L_k();this.b1k()}get $p(){return X.a.fm?"\u2318":"Ctrl"}get Qea(){return X.a.fm?"Option":"Alt"}get vWf(){return this.$p+"+X"}get uWf(){return this.$p+"+C"}get wWf(){return this.$p+"+V"}get O8m(){return this.$p+"+Z"}get r8m(){return this.$p+
"+Y"}get B7m(){return this.$p+"+B"}get N7m(){return this.$p+"+I"}get N8m(){return this.$p+"+U"}get C7m(){return this.$p+"+K"}get m8m(){return this.$p+"+/"}get Q7m(){return this.$p+"+L"}get t8m(){return this.$p+"+R"}get D7m(){return this.$p+"+E"}get O7m(){return this.$p+"+J"}get L7m(){return this.$p+"+>"}get F7m(){return this.$p+"+<"}get J8m(){return this.$p+"+X"}get I8m(){return this.$p+"+["}get K7m(){return this.$p+"+]"}get X7m(){return"\u2192"}get W7m(){return"\u2190"}get Z7m(){return this.$p+"+\u2192"}get Y7m(){return this.$p+
"+\u2190"}get g8m(){return"\u2191"}get U7m(){return"\u2193"}get h8m(){return this.$p+"+\u2191"}get V7m(){return this.$p+"+\u2193"}get f8m(){return"Home"}get b8m(){return"End"}get d8m(){return"Page up"}get c8m(){return"Page down"}get e8m(){return this.$p+"+Home"}get a8m(){return this.$p+"+End"}get $7m(){return this.Qea+"+Windows"}get A7m(){return"Tab"}get T7m(){return"Tab"}get I7m(){return"Enter"}get E7m(){return this.$p+"+F3"}get x8m(){return"Shift+\u2192"}get w8m(){return"Shift+\u2190"}get z8m(){return"Shift+"+
this.$p+"+\u2192"}get y8m(){return"Shift+"+this.$p+"+\u2190"}get E8m(){return"Shift+\u2191"}get u8m(){return"Shift+\u2193"}get F8m(){return"Shift+"+this.$p+"+\u2191"}get v8m(){return"Shift+"+this.$p+"+\u2193"}get D8m(){return"Shift+Home"}get B8m(){return"Shift+End"}get C8m(){return"Shift+"+this.$p+"+Home"}get A8m(){return"Shift+"+this.$p+"+End"}get G8m(){return this.$p+"+A"}get M7m(){return this.$p+"+M"}get L8m(){return this.$p+"+Shift+E"}get y7m(){return this.$p+"+"+this.Qea+"+="}get s8m(){return this.$p+
"+"+this.Qea+"+-"}get q8m(){return this.$p+"+"+this.Qea+"+9"}get j8m(){return this.$p+"+"+this.Qea+"+0"}get H7m(){return this.Qea+"+I"}get z7m(){return this.$p+"+Shift+A"}get R7m(){return this.$p+"+F6"}get S7m(){return this.$p+"+Shift+F6"}get J7m(){return this.Qea+"+Q"}get G7m(){return this.Qea+"+Windows"}get M8m(){return this.$p+"+Shift+F10"}get l8m(){return this.$p+"+F8"}get k8m(){return this.$p+"+F9"}get H8m(){return this.Qea+"+F12"}get P7m(){return this.$p+"+"+this.Qea+"+F7"}get K8m(){return this.$p+
"+Shift+Y"}get i8m(){return this.$p+"+"+this.Qea+"+G"}get n8m(){return this.$p+"+"+this.Qea+"+Space"}get o8m(){return this.Qea+"+\u2193"}b0k(){this.Ml(Box4Intl.Box4Strings.L_Cut,this.vWf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.L_Copy,this.uWf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.L_Paste,this.wWf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_UndoShortcutDialogDescription,
this.O8m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_RedoShortcutDialogDescription,this.r8m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog)}W1k(){this.Ml(Box4Intl.Box4Strings.l_BoldShortcutDialogDescription,this.B7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ItalicsShortcutDialogDescription,this.N7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_UnderlineShortcutDialogDescription,
this.N8m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_BulletedListShortcutDialogDescription,this.C7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_NumberedListShortcutDialogDescription,this.m8m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_AlignLeftShortcutDialogDescription,this.Q7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_AlignRightShortcutDialogDescription,
this.t8m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_AlignCenteredShortcutDialogDescription,this.D7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_JustifyShortcutDialogDescription,this.O7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_IncreaseFontSizeShortcutDialogDescription,this.L7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_DecreaseFontSizeShortcutDialogDescription,
this.F7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_StrikethroughShortcutDialogDescription,this.J8m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ShrinkFontSizeShortcutDialogDescription,this.I8m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_GrowFontSizeShortcutDialogDescription,this.K7m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog)}j3k(){this.Ml(Box4Intl.Box4Strings.l_MoveRightOneCharacterShortcutDialogDescription,
this.X7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveLeftOneCharacterShortcutDialogDescription,this.W7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveRightOneWordShortcutDialogDescription,this.Z7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveLeftOneWordShortcutDialogDescription,this.Y7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveUpOneLineShortcutDialogDescription,
this.g8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveDownOneLineShortcutDialogDescription,this.U7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveUpOneParagraphShortcutDialogDescription,this.h8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveDownOneParagraphShortcutDialogDescription,this.V7m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToStartOfLineShortcutDialogDescription,
this.f8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToEndOfLineShortcutDialogDescription,this.b8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToPreviousPageShortcutDialogDescription,this.d8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToNextPageShortcutDialogDescription,this.c8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToStartOfDocumentShortcutDialogDescription,
this.e8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveToEndOfDocumentShortcutDialogDescription,this.a8m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog)}x4k(){this.Ml(Box4Intl.Box4Strings.l_MoveRibbonDocumentContentShortcutDialogDescription,this.$7m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ActivateDifferentRibbonTabShortcutDialogDescription,this.A7m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);
this.Ml(Box4Intl.Box4Strings.l_MoveAmongRibbonCommandsShortcutDialogDescription,this.T7m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ExecuteCurrentRibbonCommandShortcutDialogDescription,this.I7m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_CollapseExpandRibbonShortcutDialogDescription,this.E7m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog)}J4k(){this.Ml(Box4Intl.Box4Strings.l_SelectRightOneCharacterShortcutDialogDescription,
this.x8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectLeftOneCharacterShortcutDialogDescription,this.w8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectRightOneWordShortcutDialogDescription,this.z8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectLeftOneWordShortcutDialogDescription,this.y8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectUpOneLineShortcutDialogDescription,
this.E8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectDownOneLineShortcutDialogDescription,this.u8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectUpOneParagraphShortcutDialogDescription,this.F8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectDownOneParagraphShortcutDialogDescription,this.v8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectToStartOfLineShortcutDialogDescription,
this.D8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectToEndOfLineShortcutDialogDescription,this.B8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectToStartOfDocumentShortcutDialogDescription,this.C8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_SelectToEndOfDocumentShortcutDialogDescription,this.A8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_WholeDocumentShortcutDialogDescription,
this.G8m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog)}s4k(){this.Ml(Box4Intl.Box4Strings.l_InsertCommentShortcutDialogDescription,this.M7m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ToggleChangeTrackingShortcutShortcutDialogDescription,this.L8m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_AcceptChangeShortcutDialogDescription,this.y7m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_RejectChangeShortcutDialogDescription,
this.s8m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_PreviousChangeShortcutDialogDescription,this.q8m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_NextChangeShortcutDialogDescription,this.j8m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog)}b1k(){this.Ml(Box4Intl.Box4Strings.l_DraftWithCopilotShortcutDialogDescription,this.H7m,Box4Intl.Box4Strings.l_CopilotSectionInShortcutsDialog)}L_k(){this.Ml(Box4Intl.Box4Strings.l_AccessibilityHelpShortcutDialogDescription,
this.z7m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_MoveAmongLandmarkRegionsShortcutDialogDescription,this.R7m+" "+Box4Intl.Box4Strings.l_OrStringShortcutsDialog+" "+this.S7m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_GoToTellMeBoxShortcutDialogDescription,this.J7m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_DisplayHideKeytipShortcutDialogDescription,
this.G7m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ToggleTooltipShortcutDialogDescription,this.M8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_NextFootNoteShortcutDialogDescription,this.l8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_NextEndNoteShortcutDialogDescription,this.k8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ShowNextCommentShortcutDialogDescription,
this.H8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_LaunchAccessibilityCheckerShortcutDialogDescription,this.P7m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_ToggleAnnouncementShortcutDialogDescription,this.K8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_NavigateFirstGraphicObjectShortcutDialogDescription,this.i8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);
this.Ml(Box4Intl.Box4Strings.l_OpenDialogueMenuShortcutDialogDescription+" "+Box4Intl.Box4Strings.l_WhenDialogIsOpenShortcutsDialog,this.n8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.Ml(Box4Intl.Box4Strings.l_OpenSuggestionShortcutDialogDescription,this.o8m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog)}Ml(b,h,r){this.YJh.push({description:b,shortcut:h,section:r,overrideBrowserShortcut:""})}}Object(u.a)(HN,"KeyboardShortcutsCollection",null,[]);class IN{constructor(b){this.Tb=
this.Tb=b}mc(){this.Tb.qa(Lc.a.o6f,ic.a.view,this.Znk.bind(this))}Znk(b,h,r){if(1===r)return 32;this.SDn=new HN;(new GN(this.SDn)).Pep();return 32}}Object(u.a)(IN,"KeyboardShortcutsDialogActor",null,[]);class Nr{constructor(b,h,r,A,L,ba,ra){this.Tb=b;this.oya=h;this.vK=r;this.dpa=A;this.Ty=L;this.Bq=ba;this.MHa=this.aI=null;this.trd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.aya,ob);Ta=this.gSb(nb);
ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[1],Ta);ob.dispose();return 32};this.zrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.gya,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[0],Ta);ob.dispose();return 32};this.vrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===
nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.Zpa,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[2],Ta);ob.dispose();return 32};this.yrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.aqa,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[3],Ta);ob.dispose();return 32};this.rrd=(Ia,Ta,ob)=>{const {paragraphs:nb,
isInsideTable:Eb}=this.d9(Ta,!1);return 0===nb.length?8:1===ob&&Eb?32:1!==ob||Eb?Eb?(Nr.Eoa(),this.Tb.Vb(fb.a.cya,ob)):8:8};this.srd=(Ia,Ta,ob)=>{const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!1);return 0===nb.length?8:1===ob&&Eb?32:1!==ob||Eb?Eb?(Nr.Eoa(),this.Tb.Vb(fb.a.eya,ob)):8:8};this.xrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.fya,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);
ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[0,1,2,3],Ta);ob.dispose();return 32};this.urd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.bya,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[4],Ta);ob.dispose();return 32};this.qrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();
if(Eb)return this.Tb.Vb(fb.a.Wla,ob);Ta=this.gSb(nb);ob=this.Bq.Vc(15);ob.Eb(nb[0]);ob.Bh=Ia;for(const bc of nb)this.dpa.Z1a(bc,[0,1,2,3,4],Ta);ob.dispose();return 32};this.wrd=(Ia,Ta,ob)=>{if(1===ob)return 32;const {paragraphs:nb,isInsideTable:Eb}=this.d9(Ta,!0);if(0===nb.length)return 8;Nr.Eoa();if(Eb)return this.Tb.Vb(fb.a.Zxb,ob);Ta=this.Bq.Vc(15);Ta.Eb(nb[0]);Ta.Bh=Ia;for(const bc of nb)this.dpa.Prf(bc,[0,1,2,3,4]);Ta.dispose();return 32};this.Wte=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;Ia=fn.a.instance.lTb(Ta);
if(!Ia)return 8;const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta,!1);Bc?(ob=new wq,this.Tb.Sf(Ta,fb.a.EPa,2,!1,void 0,ob),this.Smg.dea=ob.borderColor,this.vK.YCb(ob.borderColor)):(Ta=(Ta=this.CPf(bc,!0))&&void 0!==Ta.color?Xl.a.zB(Ta.color):"",this.Smg.dea=Ta,this.vK.YCb(Ta));Ta=this.Smg.Gsb(Ia,Ze.a.tWa);if(!Ta)return 8;Eb.MenuItems=Ta;return 32};this.ssg=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;if(!Eb)return 0;const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta,!1);ob=this.CPf(bc,!0);nb=new wq;Bc&&
this.Tb.Sf(Ta,fb.a.EPa,2,!1,void 0,nb);if(!ob&&!Bc)return Eb[bg.a.On]=!1,32;switch(Ia){case Lc.a.Ive:Eb[bg.a.On]=Eb.MenuItemId===this.Ty.bqm(Bc?nb.lineStyle:ob.style);break;case Lc.a.Jve:Eb[bg.a.On]=Eb.MenuItemId===this.Ty.eqm(Bc?nb.etc:ob.size);break;case Lc.a.Hve:if(!ob){Eb[bg.a.On]=!1;break}Eb[bg.a.On]=Eb.MenuItemId===this.Ty.Zpm(ob.space);break;default:return 8}return 32};this.yBe=(Ia,Ta,ob,nb,Eb)=>{const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta,!0);if(0===bc.length)return 8;if(1===ob)return Bc&&
Ia===Lc.a.k2b?8:32;Ta=this.E4c(Ia,Eb);Nr.Eoa();if(Bc)switch(Ia){case Lc.a.pGa:return this.Tb.Zb(fb.a.pea,ob,Ta);case Lc.a.l2b:return this.Tb.Zb(fb.a.m2a,ob,Eb);case Lc.a.m2b:return this.Tb.Zb(fb.a.n2a,ob,Eb);default:return 8}ob=this.Bq.Vc(15);ob.Eb(bc[0]);ob.Bh=Ia;for(const Yc of bc)if(Eb=this.Ty.SXa(Yc),(nb=this.Ty.Ysb(Yc))&&Eb&&0!==Eb.length){switch(Ia){case Lc.a.pGa:nb.color=this.oya.sma(Yc,Ta);this.ged.color=nb.color;break;case Lc.a.l2b:nb.style=this.Ty.aqm(Ta);this.ged.style=nb.style;break;case Lc.a.m2b:nb.size=
this.Ty.dqm(Ta);this.ged.size=nb.size;break;case Lc.a.k2b:nb.space=this.Ty.Ypm(Ta),this.ged.space=nb.space}this.dpa.Z1a(Yc,Eb,nb)}ob.dispose();return 32};this.Nwc=(Ia,Ta,ob,nb,Eb)=>{if(!this.Ty)return 8;if(1===ob)return 32;Ia=this.Ty.jJf();Eb.MenuItems=Ia;return 32};this.Owc=(Ia,Ta,ob,nb,Eb)=>{if(!this.Ty)return 8;if(1===ob)return 32;Ia=this.Ty.kJf();Eb.MenuItems=Ia;return 32};this.Iko=(Ia,Ta,ob,nb,Eb)=>{if(!this.Ty)return 8;if(1===ob)return 32;Ia=this.Ty.ilm();Eb.MenuItems=Ia;return 32};this.K5=
(Ia,Ta,ob)=>{if(1===ob)return 32;Db.StaticActiveAppFrame.Aa().dismissFloatie();this.MHa=new Vs(Nr.Ypb,Lc.a.RAb);this.MHa.pBb(0);return 32};this.RAb=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;this.Tb.Zb(Lc.a.pGa,2,Eb);this.vK.bKa(this.M8d(Eb));return 32};this.ged=this.Ty.aMf();Nr.vE=ra}get Smg(){this.aI||(this.aI=new lp(Nr.Ypb),this.Nha());return this.aI}Nha(){this.aI.bH(3,Lc.a.pGa);this.aI.bH(4,Lc.a.pGa);this.aI.bH(5,Lc.a.RAb);this.aI.bH(6,Lc.a.RAb);this.aI.q8a(nu.a.instance,1)}mc(){this.sAo();this.vAo();
this.uAo()}sAo(){y.AFrameworkApplication.va;this.Tb.qa(Lc.a.trd,ic.a.view,this.trd);this.Tb.Oc(Lc.a.trd,4);this.Tb.qa(Lc.a.zrd,ic.a.view,this.zrd);this.Tb.Oc(Lc.a.zrd,4);this.Tb.qa(Lc.a.vrd,ic.a.view,this.vrd);this.Tb.Oc(Lc.a.vrd,4);this.Tb.qa(Lc.a.yrd,ic.a.view,this.yrd);this.Tb.Oc(Lc.a.yrd,4);this.Tb.qa(Lc.a.rrd,ic.a.view,this.rrd);this.Tb.Oc(Lc.a.rrd,4);this.Tb.qa(Lc.a.srd,ic.a.view,this.srd);this.Tb.Oc(Lc.a.srd,4);this.Tb.qa(Lc.a.xrd,ic.a.view,this.xrd);this.Tb.Oc(Lc.a.xrd,4);this.Tb.qa(Lc.a.urd,
ic.a.view,this.urd);this.Tb.Oc(Lc.a.urd,4);this.Tb.qa(Lc.a.qrd,ic.a.view,this.qrd);this.Tb.Oc(Lc.a.qrd,4);this.Tb.qa(Lc.a.wrd,ic.a.view,this.wrd);this.Tb.Oc(Lc.a.wrd,4)}vAo(){this.Tb.qa(Lc.a.Wte,ic.a.view,this.Wte);this.Tb.qa(Lc.a.pGa,ic.a.view,this.yBe);this.Tb.Oc(Lc.a.pGa,4);this.Tb.qa(Lc.a.Ive,ic.a.view,this.ssg);this.Tb.qa(Lc.a.l2b,ic.a.view,this.yBe);this.Tb.Oc(Lc.a.l2b,4);this.Tb.nb(Lc.a.Bzj,ic.a.view,this.Nwc,1124);this.Tb.qa(Lc.a.Jve,ic.a.view,this.ssg);this.Tb.qa(Lc.a.m2b,ic.a.view,this.yBe);
this.Tb.Oc(Lc.a.m2b,4);this.Tb.nb(Lc.a.Czj,ic.a.view,this.Owc,1124);this.Tb.qa(Lc.a.Hve,ic.a.view,this.ssg);this.Tb.qa(Lc.a.k2b,ic.a.view,this.yBe);this.Tb.Oc(Lc.a.k2b,4);this.Tb.nb(Lc.a.Azj,ic.a.view,this.Iko,1124)}uAo(){this.Tb.qa(Lc.a.Ilg,ic.a.view,this.K5);this.Tb.Oc(Lc.a.Ilg,4);this.Tb.qa(Lc.a.RAb,ic.a.view,this.RAb);this.Tb.Oc(Lc.a.RAb,1028)}d9(b,h){b=Js.a.U5c(b);if(!b)return{paragraphs:[],isInsideTable:!1};const r=[];let A=!0;for(const L of b)rd.ParagraphReader.lc(L.node)&&(r.push(L.node),
rd.ParagraphReader.AZ(L.node)||(A=!1));return!h||1!==r.length||A||b.Ya.contextId!==ic.a.kd?{paragraphs:r,isInsideTable:A}:{paragraphs:this.EHm(r[0]),isInsideTable:!1}}EHm(b){const h=this.Ty.Ysb(b),r=this.Ty.SXa(b);if(0===r.length||!h)return[b];const A=[];for(var L=rd.ParagraphReader.Cg(b,!0,!1,!1);L;){var ba=this.Ty.Ysb(L),ra=this.Ty.SXa(L);if(ba&&this.Ty.dZh(r,ra)&&this.Ty.qWc(h,ba))A.push(L);else break;L=rd.ParagraphReader.Cg(L,!0,!1,!1)}L=[];for(ba=rd.ParagraphReader.Cg(b,!1,!1,!1);ba;){ra=this.Ty.Ysb(ba);
const Ia=this.Ty.SXa(ba);if(ra&&this.Ty.dZh(r,Ia)&&this.Ty.qWc(h,ra))L.push(ba);else break;ba=rd.ParagraphReader.Cg(ba,!1,!1,!1)}return[...A.reverse(),b,...L]}CPf(b,h=!1){if(0!==b.length){var r=this.Ty.Ysb(b[0]);for(const A of b)if(b=this.Ty.Ysb(A),h)r=this.htm(r,b);else if(!this.Ty.qWc(r,b)){r=void 0;break}return r}}htm(b,h){if(b&&h)return{color:b.color===h.color?b.color:void 0,style:b.style===h.style?b.style:void 0,size:b.size===h.size?b.size:void 0,space:b.space===h.space?b.space:void 0}}E4c(b,
h){var r="";if(!h)return r;switch(b){case Lc.a.pGa:r=(r="object"===typeof h?h:null)&&"Color"in r?r.Color:h;break;case Lc.a.l2b:case Lc.a.m2b:case Lc.a.k2b:(h="object"===typeof h?h:null)&&"MenuItemId"in h&&(r=h.MenuItemId)}return r}M8d(b){if(!b)return"";const h="object"===typeof b?b:null;return h&&"Color"in h?h.Color:b}gSb(b){b=this.CPf(b);b||(b=this.ged);b||(b=this.Ty.aMf());return b}static Eoa(){window.setTimeout(()=>{Nr.vE&&Nr.vE.execute(b=>{b.logActivity(Nr.Dfo,null)})},Nr.Cfo)}}Nr.Ypb="ParagraphBorder";
Nr.Dfo="ParagraphBordersFloodgateSurvey";Nr.Cfo=5E3;Object(u.a)(Nr,"ParagraphBorderActor",null,[]);var KO=e(789),LO=e(1163);class rC extends cq.a{constructor(b,h,r,A){super();this.hH=A;this.YAk="CommonControlChevronDown_12";this.Rwk=y.AFrameworkApplication.isRtl?"CommonControlChevronLeft_12":"CommonControlChevronRight_12";this.pGc="aria-label";this.icc="role";this.jtk="alt";this.Xoa=L=>{if(null===L)return!1;this.hHb.get(L.Ff).style.visibility="visible";return!0};this.Yoa=L=>{if(null===L)return!1;
this.hHb.get(L.Ff).style.visibility="collapse";return!0};this.hHb=new Map;this.Rn=b;this.xh=h;this.zd=r}s2a(b){b=this.hP(b);return LO.a.Ppn(b)}JWa(b){const h=[];h.push(this.Jga(b.z2));return h}Jga(b){var h,r,A;const L=this.hP(b),ba=L.jqb;if(ba){var ra=b.Gh.ownerDocument,Ia=b.htmlElement.querySelector(".ParaWrappingDiv");Ia=null===Ia||void 0===Ia?void 0:Ia.querySelector("p");Ia=null===Ia||void 0===Ia?void 0:Ia.querySelector(".TextRun");var Ta=parseFloat(null===Ia||void 0===Ia?void 0:Ia.style.lineHeight.slice(0,
-2));Ia=Tl.a.createElement(ra,Om.a.div);Ia.className=rC.XAk;Ia.style.top=`${Ta/2}px`;ra=this.UMl(ra,ba.UNa);Ia.appendChild(ra);Ta=null===(h=this.zd.Ve)||void 0===h?void 0:h.HQb;(null===(A=null===(r=this.zd.Ve)||void 0===r?void 0:r.Pf)||void 0===A?void 0:A.node)===L?(this.f_f(Ta,ra,ba.UNa),this.f_f(Ia,ra,ba.UNa)):this.f_f(b.htmlElement,ra,ba.UNa);this.xh.wK(Fd.a.click,ra,this.xwa.bind(this),{paragraphNode:L,UNa:ba.UNa});return Ia}}UMl(b,h){const r=Tl.a.createElement(b,Om.a.div);r.className=rC.WAk;
r.title=h?WordRibbonStrings.CollapsedHeadingExpandButtonTooltip:WordRibbonStrings.ExpandedHeadingCollapseButtonTooltip;r.style.visibility=h?"visible":"collapse";r.setAttribute(this.icc,"img");r.setAttribute(this.jtk,r.title);r.setAttribute(this.pGc,r.title);b=Tl.a.createElement(b,Om.a.div);b.className=rC.VAk;KO.a.renderIcon(h?this.Rwk:this.YAk,b);r.appendChild(b);return r}f_f(b,h,r){r?(this.YAp(b),this.hHb.delete(b)):(this.hHb.set(b,h),this.oCo(b))}oCo(b){this.Rn.Cb(Fd.a.sP,b,this.Xoa);this.Rn.Cb(Fd.a.pK,
b,this.Yoa)}YAp(b){this.Rn.Gc(Fd.a.sP,b,this.Xoa);this.Rn.Gc(Fd.a.pK,b,this.Yoa)}xwa(b){if(null===b)return!1;const h=b.er.UNa;b=b.er.paragraphNode;const r=y.AFrameworkApplication.va,A=new Ai.DictionaryPropertySet;A.Xg(Pd.a.targetObject,b);h?r.Zb(fb.a.W2c,2,A):r.Zb(fb.a.NZd,2,A);this.hH.G2("onAfterExpandCollapseChange");return!1}hP(b){return rd.ParagraphReader.ox(b.Jb,!0,!1).K(0)}}rC.XAk="WordExpandCollapseIndicatorContainer";rC.WAk="WordExpandCollapseIconContainer";rC.VAk="WordExpandCollapseIcon";
Object(u.a)(rC,"ExpandCollapseIndicatorActor",cq.a,[281]);class xE{constructor(b=xE.$qb){this.color=b}}xE.$qb=0;xE.oHo=Xl.a.auto;Object(u.a)(xE,"ParagraphShadingProperties",null,[]);class Bs{constructor(b,h,r,A,L,ba,ra){this.Tb=b;this.oya=h;this.vK=r;this.lxj=A;this.dgo=L;this.Bq=ba;this.p9h=this.UZd=null;this.Uko=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;if(2===ob&&!Eb)return 8;Ia=fn.a.instance.lTb(Ta);if(!Ia)return 8;Ta="";ob={};32===this.Tb.Zb(Lc.a.kmd,2,ob)&&(Ta=ob[Bs.oFa]);this.kxj.dea=Ta;this.vK.YCb(Ta);
Ia=this.kxj.Gsb(Ia,Ze.a.tWa);if(!Ia)return 8;Eb.MenuItems=Ia;return 32};this.I5o=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;this.Tb.Zb(Lc.a.lea,2,Eb);this.vK.bKa(this.M8d(Eb))||v.ULS.sendTraceTag(508151187,340,50,"Color selected from Recent Colors section. Menu: {0}",Bs.oFa);return 32};this.kmd=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta);if(0===bc.length)return 32;if(Bc){Ia={};if(32===this.Tb.Sf(Ta,fb.a.uzb,2,void 0,nb,Ia,void 0)){Ta=Ia[Bs.ytl];if(!Ta)return 8;
Eb[Bs.oFa]=Xl.a.zB(Ta);return 32}return 8}Ta=this.kRm(bc);if(!Ta)return 8;Eb[Bs.oFa]=Ta;return 32};this.ZDg=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;ob=this.M8d(Eb);if(!ob)return 8;const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta);if(0===bc.length)return 32;this.GOn&&1===bc.length&&Js.a.U5c(Ta).Ya.contextId===ic.a.Nd&&Object($d.a)("SetShadingOnTextRange");Bs.Eoa();if(Bc)return this.Tb.Sf(Ta,fb.a.t$,2,void 0,nb,ob,void 0);Ta=this.Bq.Vc(15);Ta.Eb(bc[0]);Ta.Bh=Ia;for(const Yc of bc)Ia=new xE(this.oya.sma(Yc,
ob)),this.lxj.ZDg(Yc,Ia);Ta.dispose();return 32};this.K5=(Ia,Ta,ob)=>{if(1===ob)return 32;Db.StaticActiveAppFrame.Aa().dismissFloatie();this.p9h=new Vs(Bs.oFa,Lc.a.Ard);this.p9h.pBb(0);return 32};this.$rf=(Ia,Ta,ob,nb,Eb)=>{if(1===ob)return 32;const {paragraphs:bc,isInsideTable:Bc}=this.d9(Ta);if(0===bc.length)return 32;Bs.Eoa();if(Bc)return this.Tb.Sf(Ta,fb.a.Opb,2,void 0,nb,Eb,void 0);Ta=this.Bq.Vc(15);Ta.Eb(bc[0]);Ta.Bh=Ia;for(const Yc of bc)this.lxj.$rf(Yc);Ta.dispose();return 32};Bs.vE=ra}mc(){this.Tb.qa(Lc.a.lea,
ic.a.view,this.ZDg);this.Tb.Oc(Lc.a.lea,1028);this.Tb.qa(Lc.a.Ard,ic.a.view,this.I5o);this.Tb.Oc(Lc.a.Ard,1028);this.Tb.qa(Lc.a.kmd,ic.a.view,this.kmd);this.Tb.Oc(Lc.a.kmd,1124);this.Tb.qa(Lc.a.zBe,ic.a.view,this.K5);this.Tb.Oc(Lc.a.zBe,1028);this.Tb.qa(Lc.a.ABe,ic.a.view,this.$rf);this.Tb.Oc(Lc.a.ABe,1028);this.Tb.qa(Lc.a.$og,ic.a.view,this.Uko);this.Tb.Oc(Lc.a.$og,1124)}get kxj(){this.UZd||(this.UZd=new lp(Bs.oFa),this.Nha(this.UZd));return this.UZd}Nha(b){b.bH(3,Lc.a.lea);b.bH(4,Lc.a.lea);b.bH(5,
Lc.a.Ard);b.bH(2,Lc.a.ABe);b.bH(6,Lc.a.zBe);b.q8a(nu.a.instance,1)}d9(b){b=Js.a.U5c(b);if(!b)return{paragraphs:[],isInsideTable:!1};const h=[];let r=!0;for(const A of b)rd.ParagraphReader.lc(A.node)&&(h.push(A.node),rd.ParagraphReader.AZ(A.node)||(r=!1));return{paragraphs:h,isInsideTable:r}}M8d(b){if(!b)return"";const h="object"===typeof b?b:null;return h&&"Color"in h?h.Color:b}kRm(b){if(0===b.length)return"";const h=this.$Li(b[0]);for(const r of b)if(h!==this.$Li(r))return"";return h}$Li(b){return(b=
this.dgo.jRm(b))?Xl.a.zB(b.color):""}get GOn(){if(null!=this.X5g)var b=this.X5g;else{var h;y.AFrameworkApplication.ud("c6dg7724;h7d41461");b=this.X5g=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingForParagraphShadingOnRange",!1)}return b}static Eoa(){window.setTimeout(()=>{Bs.vE&&Bs.vE.execute(b=>{b.logActivity(Bs.bgo,null)})},Bs.ago)}}Bs.oFa="ParagraphShading";Bs.ytl="CellShading";Bs.bgo="ParagraphShadingFloodgateSurvey";Bs.ago=
5E3;Object(u.a)(Bs,"ParagraphShadingActor",null,[]);class NA{constructor(b,h,r,A,L){this.Tb=b;this.dpa=h;this.Ty=r;this.Bq=A;this.Yf=L;this.wSj=(ba,ra,Ia,Ta,ob)=>{if(1===Ia)return ob&&ob.Fd&&void 0!==ob.type?32:8;Ia=ob.Fd.node;const nb=this.XBm(ob.type);if(!nb)return 8;const Eb=rd.ParagraphReader.Cg(Ia,!0,!1,!1),{zic:bc,Hfc:Bc,pAc:Yc,zAc:zd}=this.Ppm(Ia,Eb,nb),Jd=this.Bq.Vc(15);Jd.Bh=ba;if(Bc)return ob.Fd.bK().qG.k4(11),this.Yf.hxa(Ia),this.wSj(ba,ra,2,Ta,{...ob,Fd:Eb});Jd.Eb(Ia);Yc&&this.dpa.Prf(Eb,
this.Ty.SXa(Eb));zd&&(ba=rd.ParagraphReader.Cg(Ia,!1,!1,!1),ra=this.Ty.Ysb(Ia),Ta=this.Ty.SXa(Ia),ba&&0<Ta.length&&ra&&(this.dpa.Prf(ba,this.Ty.SXa(ba)),this.dpa.Z1a(ba,Ta.filter(ie=>0!==ie),ra)));this.dpa.Z1a(Ia,bc,nb);Jd.dispose();return 32}}mc(){this.Tb.qa(fb.a.P$c,ic.a.view,this.wSj);this.Tb.Oc(fb.a.P$c,4)}XBm(b){switch(b){case 0:return NA.a$m;case 1:return NA.Jgl;case 2:return NA.Szp;case 3:return NA.v3l}}Ppm(b,h,r){b=0<this.Ty.SXa(b).length;if(!rd.ParagraphReader.lc(h))return{zic:[1],Hfc:!1,
pAc:!1,zAc:b};const A=this.Ty.SXa(h);if(0===A.length)return{zic:[1],Hfc:!0,pAc:!1,zAc:b};h=this.Ty.Ysb(h);return this.Ty.qWc(h,r)?1===A.length&&1===A[0]?{zic:[0,1],Hfc:!1,pAc:!0,zAc:b}:2===A.length&&0===A[0]&&1===A[1]?{zic:[4,1],Hfc:!1,pAc:!1,zAc:b}:{zic:[1],Hfc:!1,pAc:!1,zAc:b}:{zic:[1],Hfc:!1,pAc:!1,zAc:b}}}NA.a$m={style:"single",size:6,space:1,color:0};NA.Jgl={style:"dotted",size:24,space:1,color:0};NA.Szp={style:"single",size:12,space:1,color:0};NA.v3l={style:"double",size:24,space:1,color:0};
Object(u.a)(NA,"HorizontalLineActor",null,[]);class yE{constructor(){this.MLd=this.mId=null}get name(){return"WordEditor.Actors"}init(){var b,h,r;Object(Vb.a)().Ve.Xic=!0;y.AFrameworkApplication.va.qa(Lc.a.bOp,dd.a.frame,kJ);this.Z.resolve("WordEditor.Actors.DeleteActor").mc(y.AFrameworkApplication.va);Os.instance.mc();jm.mc();Jm.mc(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.IMainViewModeManager"));Aj.mc();wE.instance.mc();ag.mc();this.Z.resolve("WordEditor.Actors.ModeSwitcherControlActor").mc(y.AFrameworkApplication.va);
this.Z.resolve("WordEditor.Actors.ExternalContentActor").mc();this.MLd=this.Z.resolve("WordEditor.OnlineMedia.OnlineMediaActor");this.MLd.mc();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&this.Z.resolve("Box4.Actors.FormatPainterActor").mc();y.AFrameworkApplication.J.$("WordEditorAutoSaveImprovementIsEnabled")&&this.Z.resolve("WordEditor.Actors.SaveStatusActor").mc();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&
(this.p0.Rie=!0);y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.Z.resolve("WordEditor.Actors.ModernUxActor").mc();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.Z.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").mc();this.Z.resolve("WordEditor.Actors.AppFrameCommandUIActor").mc();this.Z.resolve("Common.IOfficeTrialExperience").mc();this.Z.resolve("Common.IMacOfficeOffer").mc();
this.Z.resolve("WordEditor.Actors.MarginsDialogActor").mc();this.Z.resolve("WordEditor.Actors.PaperSizeDialogActor").mc();this.Z.resolve("WordEditor.Actors.ColumnsDialogActor").mc();this.Z.resolve("WordEditor.Actors.FileDownloadActor").mc();this.Z.resolve("WordEditor.Actors.StylesActor").mc();this.Z.resolve("WordEditor.Actors.ParagraphDialogActor").mc();this.Z.resolve("WordEditor.Actors.ProofingActor").mc();this.Z.resolve("WordEditor.Actors.PageActor").mc();this.Z.resolve("WordEditor.Actors.DarkModeActor").mc();
this.Z.resolve("WordEditor.Actors.ImageActor").mc(y.AFrameworkApplication.va);this.Z.resolve("WordEditor.Actors.FormattingActor").mc();this.Z.resolve("WordEditor.Actors.UIAutomationActor").mc();this.Z.resolve("WordEditor.Actors.ContentControlActor").mc();this.Z.resolve("WordEditor.Actors.CustomTabActor").mc();this.Z.resolve("WordEditor.Actors.BookmarkActor").mc();this.Z.resolve("WordEditor.Actors.HeadingsActor").mc();const A=this.Z.resolve("Box4.Indicator.IIndicatorManager");A.LPa(this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"));
Fx.a.QNa&&A.LPa(this.Z.resolve("WordEditor.Actors.ExpandCollapseIndicatorActor"));this.Z.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").mc();this.Z.resolve("WordEditor.Actors.AccessibilityActor").tug();this.Z.resolve("WordEditor.Actors.ISWordRequestManager");this.Z.resolve("Box4.Actors.AutoCorrectActor").mc();this.Z.resolve("WordEditor.Actors.DigitalPrintActor").mc();this.Z.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.Z.resolve("Box4.Actors.VisiMarkersActor").mc();
this.Z.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.Z.resolve("WordEditor.Actors.ActionHangDetector").WZ();this.Z.resolve("WordEditor.Actors.WordFileSaveAsActor").mc();y.AFrameworkApplication.J.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.tAo():this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").mc();this.$_.xfb(this.cvk);this.Z.resolve("WordEditor.Bookmark.FullBookmarkManager").N3m()&&Db.StaticActiveAppFrame.Aa().tb.DDf();Fx.a.QNa&&Db.StaticActiveAppFrame.Aa().tb.DDf();
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1)&&this.Z.resolve("WordEditor.Actors.MiniTemplateActor").mc();Db.StaticActiveAppFrame.Aa().Ne();Mr.initialize();zi.a.rx("f9ii3515;944df931");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.Z.resolve("WordEditor.Actors.ParagraphBorderActor").mc();zi.a.rx("a3425890;9b289201");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",
!1)&&this.Z.resolve("WordEditor.Actors.ParagraphShadingActor").mc();y.AFrameworkApplication.ud("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&this.Z.resolve("WordEditor.Actors.KeyboardShortcutsDialogActor").mc();zi.a.rx("d289f684;jb567207");(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",
!1))&&(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.HyphenationToLineEnabled",!1))&&this.Z.resolve("WordEditor.Actors.HorizontalLineActor").mc()}dispose(){this.MLd&&this.MLd.dispose()}tAo(){this.Qd.Fs.isCompleted?this.Qd&&this.Qd.isFeatureEnabled(43)&&this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").mc():this.Qd.Fs.continueWith(()=>{this.Qd&&this.Qd.isFeatureEnabled(43)&&(this.Z.resolve("WordEditor.Actors.GraphicsEditorActor").mc(),
Db.StaticActiveAppFrame.Aa().Ne())})}get own(){if(null==this.mId)if(this.Qd)if(this.Qd.Fs.isCompleted)this.mId=this.Qd.isFeatureEnabled(2);else return!1;else this.mId=!1;return this.mId}Ec(b){var h,r,A,L,ba,ra;this.Z=b;this.Qd=b.Wa("Box4.IFeatureHelper");this.p0=this.Z.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.p0.zcd=y.AFrameworkApplication.J.$("WordProofingSecondaryContextualMenuIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",
!1);(new Az).Ec(b);b.ja("Box4.IClipboardCommands",()=>new sp(y.AFrameworkApplication.va,fb.a.Xof,fb.a.dXc,fb.a.o8,fb.a.zng,fb.a.paste,fb.a.S5,fb.a.azb)).ha();b.ja("HtmlImport.IHtmlNormalizerSettings",()=>{const Ia=b.resolve("Common.IAppSettingsManager");return new QC(!0,Ia.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ja("HtmlImport.IHtmlTranslatorSettings",()=>{const Ia=b.resolve("Common.IAppSettingsManager"),Ta=ob=>!ob.hqc;return new zw(Ia.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,
void 0,void 0,void 0,void 0,!0,void 0,Ia.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ob=>ob.hqc,()=>!1,Ta,Ta,Ta,Ta,void 0,()=>this.own,ob=>!ob.hqc)}).ha();b.ja("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new EN(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ja("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",
()=>new wN(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ja("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new TG).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ja("Box4.IIndentationCommands",()=>new $w(y.AFrameworkApplication.va)).ha();b.ja("Box4.IJustificationCommands",()=>new jk(y.AFrameworkApplication.va)).ha();b.ja("Box4.ISpacingCommands",
()=>new cv(y.AFrameworkApplication.va)).ha();b.ja("WordEditor.IPageCommands",()=>new vN(y.AFrameworkApplication.va)).ha();b.ja("WordEditor.Actors.StylesActor",()=>new DL(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"))).ha();b.ja("WordEditor.Actors.DigitalPrintActor",()=>new KA(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"))).ha();b.ja("WordEditor.Actors.FileDownloadManager",()=>new kN(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new TL.a)).ha();b.ja("WordEditor.Actors.FileDownloadActor",
()=>new jN(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),y.AFrameworkApplication.J.$("DisablePrint"),y.AFrameworkApplication.J.rb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ja("WordEditor.Actors.ParagraphDialogActor",()=>new BL(y.AFrameworkApplication.va,b.zf("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Ap.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();
b.ja("WordEditor.Actors.MarginsDialogActor",()=>new tN(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"),Ap.a.instance)).ha();b.ja("WordEditor.Actors.ColumnsDialogActor",()=>new bN(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"),Ap.a.instance)).ha();b.ja("WordEditor.Actors.ModeSwitcherControlActor",()=>new nA.a(b.Za("Common.ISystemInitiatedFeedback"),fy.a.F5c(),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.IModeSwitcherControl").ha();b.ja("WordEditor.Actors.PaperSizeDialogActor",
()=>new pC(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"),Ap.a.instance)).ha();b.ja("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new tE(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(iN,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ja("WordEditor.Actors.ProofingActor",()=>new xN(y.AFrameworkApplication.va,Ke.a.instance,Xa.a.instance.resolve("Box4.ISelectionManager"),CC.a.instance,Xa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),
Xa.a.instance.resolve("Box4.ILanguageReader"),Xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Xa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Xa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.p0,Xa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),Xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("EditorSettingsManager")).then(()=>{const Ia=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");Ia.bcn();Ia.init();b.ja("Box4.Proofing.EditorSettingsUIActor",()=>new ar(y.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new sk(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&this.Z.resolve("Box4.Proofing.EditorSettingsUIActor").mc()});b.ja("WordEditor.Actors.PageActor",()=>new GO(Xa.a.instance.resolve("Box4.IWordSectionEditor"),Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xa.a.instance.resolve("WordEditor.IMainViewModeManager"),Xa.a.instance.Za("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
b.ja("WordEditor.Actors.DarkModeActor",()=>new sO(y.AFrameworkApplication.va,y.AFrameworkApplication.J,Qr.a.Uua(),!!Ze.a.instance&&Ze.a.instance.LNa,!!Ze.a.instance&&Ze.a.instance.Scd,Xa.a.instance.resolve("Box4.IDarkModeState"),Xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Xa.a.instance.resolve("Box4.DarkModeEventsManager"),!!Ze.a.instance&&Ze.a.instance.jEa)).ha();b.ja("WordEditor.FlatListDetailsProvider",()=>new oC(b.resolve("WordEditor.IFlatListEditor")));b.ja("WordEditor.Actors.AccessibilityActor",
()=>new rn(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.zf("WordEditor.FlatListDetailsProvider"),b.zf("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.zf("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ja("WordEditor.Actors.AppFrameCommandUIActor",()=>new fu(y.AFrameworkApplication.va,b.Za("Postmessage.IHostPostmessenger"))).ha();b.ja("WordEditor.Actors.ImageActor",()=>new Ho(b.resolve("WordEditor.IImageEditor"),b.Za("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),y.AFrameworkApplication.J)).as("Box4.Actors.ImageActor").ha();b.ja("WordEditor.Actors.WordFileSaveAsActor",()=>new JO(y.AFrameworkApplication.va)).ha();b.ja("WordEditor.Actors.RenderedImageEditOperation.Factory",
()=>new pJ(b.resolve("WordEditor.IImageEditor"),y.AFrameworkApplication.J,y.AFrameworkApplication.ta.SYa,Xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).ha();b.ja("WordEditor.Actors.DeleteActor",()=>new qM(Xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Xa.a.instance.Za("Box4.ContentControlConfigSettings"),
Xa.a.instance.Za("Box4.IContentControlEditor"),Xa.a.instance.resolve("Box4.IDynamicRangeEditor"),Xa.a.instance.Za("WordEditor.Bookmark.IBookmarkManager"),Xa.a.instance.resolve("Box4.IHyperlinkEditor"),Xa.a.instance.resolve("Box4.IHyperlinkStrategy"),Xa.a.instance.resolve("Box4.IParagraphReader"),Xa.a.instance.resolve("Box4.IParagraphIndentationReader"),Xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xa.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();
this.Z.ja("WordEditor.Actors.SWordRequestManager",()=>new CN(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),y.AFrameworkApplication.J)).as("WordEditor.Actors.ISWordRequestManager").ha();b.ja("WordEditor.Actors.TableCellSelectionStrategy",()=>new GL).as("Box4.ITableCellSelectionStrategy").ha();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&b.ja("Box4.Actors.FormatPainter",()=>new nq(b.resolve("Box4.Styles.IWACStyleEditor"),
b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Ke.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();
b.ja("Box4.Actors.FormatPainterActor",()=>new ey(Db.StaticActiveAppFrame.Aa(),Jc.FocusManager.instance(),y.AFrameworkApplication.va,$g.a.instance,Js.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Ze.a.instance&&Ze.a.instance.jEa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ja("WordEditor.Actors.FormattingActor",()=>new mN(y.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ja("WordEditor.Actors.UIAutomationActor",
()=>new DN(y.AFrameworkApplication.va)).ha();b.ja("WordEditor.Actors.SaveStatusActor",()=>new CL(y.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ja("Box4.Actors.IEnterViewStrategy",()=>new Jv(b.Wa("Box4.IAutoCorrectScheduler"),b.zf("Box4.IUndoManager"),b.Za("Box4.IExternalSelectionManager"))).ha();b.ja("Box4.ISelectAllHandlers",()=>new Iu(fn.a.instance,b.zf("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ja("WordEditor.Actors.ContentControlActor",
()=>new dN(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),y.AFrameworkApplication.va,y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),
b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ja("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new hE(y.AFrameworkApplication.va,b.zf("WordEditor.UI.IDialogFactory"),Jc.FocusManager.instance())).ha();b.ja("Box4.Actors.FontNameFormattingStrategyNoop",()=>new fE).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ja("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new Ju(y.AFrameworkApplication.pe,Object(ao.a)(),b.resolve("Box4.ICharacterPropertiesEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),y.AFrameworkApplication.J,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();b.ja("WordEditor.Actors.GraphicsEditorActor",()=>new BG(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),
b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),y.AFrameworkApplication.pe,this.Qd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ja("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new BN).ha();
b.ja("WordEditor.Actors.CustomTabActor",()=>new eN(y.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ja("WordEditor.Actors.HeadingsActor",()=>new oJ(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),y.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();b.ja("WordEditor.Actors.BookmarkActor",()=>new jl(Db.StaticActiveAppFrame.Aa(),y.AFrameworkApplication.va,Fg.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.rd),this.Z.resolve("Box4.Indicator.IIndicatorManager"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.resolve("Common.IReactContextualUILauncher"),this.Z.resolve("WordEditor.Actors.BookmarkIndicatorActor"),CC.a.instance,this.Z.Za("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),Object(Vb.a)(),this.Z.zf("WordEditor.UI.IDialogFactory"),this.Z.resolve("Box4.BookmarkParagraphMapping"),Ke.a.instance)).ha();b.ja("WordEditor.Actors.BookmarkIndicatorActor",
()=>new Ti(b.resolve("Box4.IParagraphReader"),Wf.a.instance,this.Z.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb.Xc))).ha();Fx.a.QNa&&b.ja("WordEditor.Actors.ExpandCollapseIndicatorActor",()=>new rC(qd.a.instance,Wf.a.instance,Object(Vb.a)(),b.resolve("WordEditor.Comments.WordCommentEventsActor"))).ha();b.ja("Box4.Actors.IIFrameFocusStrategy",()=>new dx).ha();b.ja("WordEditor.Actors.ExternalContentFloatiePositionProvider",
()=>new oE(Fg.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Object(Vb.a)(),ed.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ja("WordEditor.Actors.ExternalContentActor",()=>new Lr(y.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),y.AFrameworkApplication.J,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").ha();
b.ja("Box4.UI.ExternalContentFloatieManager",()=>new EA).as("Box4.UI.IFloatieManager").ha();b.ja("WordEditor.Actors.ActionHangDetector",()=>new FA(y.AFrameworkApplication.J,y.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ja("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new nE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Object(Vb.a)(),gx.a.instance(),y.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ze.a.wf.Um.Hf(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ja("Box4.Actors.WordIndentationActorExtension",()=>new FN).as("Box4.Actors.IIndentationActorExtension").ha();y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ja("WordEditor.Actors.ModernUxActor",()=>new AL(y.AFrameworkApplication.va)).ha();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ja("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new vE(y.AFrameworkApplication.va)).ha();(new $q).Ec(b);b.ja("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new eu(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ja("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new gE(y.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new Dj.b)).ha();b.ja("WordEditor.OnlineMedia.OnlineMediaActor",()=>new Bq(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),
Ke.a.instance,b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Xa.a.instance.resolve("Common.App.OAuth.IOAuthManager"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)?b.resolve("Common.IExternalUICommandDefinitionMapping"):void 0)).ha();(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1))&&b.ja("WordEditor.Actors.MiniTemplateActor",
()=>new uN(y.AFrameworkApplication.va,b.Za("WordEditor.Extension.IInsertApiOperations"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.ITableEditor"),b.resolve("Box4.IOutlineElementEditor"))).ha();null!==(A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageLoadStatsDialogEnabled",!1))&&void 0!==A&&A&&e.e(14).then(e.bind(null,2159)).then(Ia=>{(new Ia.PageLoadStatsActor(()=>b.resolve("WordEditor.IStatusBarUser"))).mc()});
this.cvk=new du;this.$_=this.Z.resolve("Box4.Highlight.IHighlightManager");zi.a.rx("f9ii3515;944df931");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.Z.ja("WordEditor.Actors.ParagraphBorderActor",()=>new Nr(y.AFrameworkApplication.va,Sm.a.instance,this.Z.resolve("Box4.UI.RecentColorsSectionHandler"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderEditor"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager"),
this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.Za("Common.ISystemInitiatedFeedback"))).ha();zi.a.rx("a3425890;9b289201");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&this.Z.ja("WordEditor.Actors.ParagraphShadingActor",()=>new Bs(y.AFrameworkApplication.va,Sm.a.instance,this.Z.resolve("Box4.UI.RecentColorsSectionHandler"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphShadingEditor"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphShadingReader"),
this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),this.Z.Za("Common.ISystemInitiatedFeedback"))).ha();y.AFrameworkApplication.ud("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(L=y.AFrameworkApplication.J)||void 0===L?0:L.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&b.ja("WordEditor.Actors.KeyboardShortcutsDialogActor",()=>new IN(y.AFrameworkApplication.va)).ha();zi.a.rx("d289f684;jb567207");(null===(ba=y.AFrameworkApplication.J)||void 0===ba?
0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))&&(null===(ra=y.AFrameworkApplication.J)||void 0===ra?0:ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.HyphenationToLineEnabled",!1))&&this.Z.ja("WordEditor.Actors.HorizontalLineActor",()=>new NA(y.AFrameworkApplication.va,this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderEditor"),this.Z.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager"),this.Z.resolve("Box4.Graph.IGraphTransactionFactory"),
this.Z.resolve("Box4.IOutlineElementEditor"))).ha()}static main(){F.a.instance.Rc(new yE)}}Object(u.a)(yE,"WordEditorActorsPackage",null,[0,1]);class xM{constructor(b){this.VHd=!1;this.Fqj=()=>{this.VHd=!0;this.Uv.Txe(this.Fqj)};this.Uv=b;this.Uv.Dob(this.Fqj)}}Object(u.a)(xM,"GraphFullyConnectedGetter",null,[312]);class jg{constructor(){this.wyh=Object.assign(new tj.a,{})}c1k(b,h){let r;const A=b&1023;({value:r}=this.wyh.Nc(A,0)).returnValue||jg.eZm().contains(A)||v.ULS.sendTraceTag(50942149,338,
15,"Culture is not supported. LCID {0}; Key: {1}",b,A);r+=h;this.wyh.W(A,r);return r}static eZm(){jg.VQd||(jg.VQd=new Ka.a,jg.Bc(0),jg.Bc(1),jg.Bc(2),jg.Bc(3),jg.Bc(4),jg.Bc(5),jg.Bc(6),jg.Bc(7),jg.Bc(8),jg.Bc(9),jg.Bc(10),jg.Bc(11),jg.Bc(12),jg.Bc(13),jg.Bc(14),jg.Bc(15),jg.Bc(16),jg.Bc(17),jg.Bc(18),jg.Bc(19),jg.Bc(20),jg.Bc(21),jg.Bc(22),jg.Bc(23),jg.Bc(24),jg.Bc(25),jg.Bc(26),jg.Bc(27),jg.Bc(28),jg.Bc(29),jg.Bc(30),jg.Bc(31),jg.Bc(32),jg.Bc(33),jg.Bc(34),jg.Bc(35),jg.Bc(36),jg.Bc(37),jg.Bc(38),
jg.Bc(39),jg.Bc(40),jg.Bc(41),jg.Bc(42),jg.Bc(43),jg.Bc(44),jg.Bc(45),jg.Bc(46),jg.Bc(47),jg.Bc(48),jg.Bc(49),jg.Bc(50),jg.Bc(51),jg.Bc(52),jg.Bc(53),jg.Bc(54),jg.Bc(55),jg.Bc(56),jg.Bc(57),jg.Bc(58),jg.Bc(59),jg.Bc(60),jg.Bc(61),jg.Bc(62),jg.Bc(63),jg.Bc(64),jg.Bc(65),jg.Bc(66),jg.Bc(67),jg.Bc(68),jg.Bc(69),jg.Bc(70),jg.Bc(71),jg.Bc(72),jg.Bc(73),jg.Bc(74),jg.Bc(75),jg.Bc(76),jg.Bc(77),jg.Bc(78),jg.Bc(79),jg.Bc(80),jg.Bc(81),jg.Bc(82),jg.Bc(83),jg.Bc(84),jg.Bc(85),jg.Bc(86),jg.Bc(87),jg.Bc(88),jg.Bc(89),
jg.Bc(90),jg.Bc(91),jg.Bc(92),jg.Bc(93),jg.Bc(94),jg.Bc(95),jg.Bc(96),jg.Bc(97),jg.Bc(98),jg.Bc(99),jg.Bc(100),jg.Bc(101),jg.Bc(102),jg.Bc(103),jg.Bc(104),jg.Bc(105),jg.Bc(106),jg.Bc(107),jg.Bc(108),jg.Bc(109),jg.Bc(110),jg.Bc(111),jg.Bc(112),jg.Bc(113),jg.Bc(114),jg.Bc(115),jg.Bc(116),jg.Bc(117),jg.Bc(118),jg.Bc(119),jg.Bc(120),jg.Bc(121),jg.Bc(122),jg.Bc(124),jg.Bc(126),jg.Bc(127),jg.Bc(128),jg.Bc(129),jg.Bc(130),jg.Bc(131),jg.Bc(132),jg.Bc(133),jg.Bc(134),jg.Bc(135),jg.Bc(136),jg.Bc(140),jg.Bc(145),
jg.Bc(146),jg.Bc(147));return jg.VQd}static Bc(b){jg.VQd.add(b&1023)}}jg.VQd=null;Object(u.a)(jg,"LanguagePerParagraphModel",null,[]);class MO{constructor(){this.wGg=!1;this.GYd=this.FYd=this.N5b=0;this.f9i=!0;this.bSp=0}}Object(u.a)(MO,"UpdateWordCountStateResult",null,[]);class JN extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(u.a)(JN,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class DG{constructor(){this.K5h=this.J5h=this.wordCount=-1;this.FQb=this.m1h=0;this.EQb=
1;this.gxj=1033}}Object(u.a)(DG,"WordCountCache",null,[]);class KN extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(u.a)(KN,"WordCountChangedEventArg",Sys.EventArgs,[]);class rJ{constructor(){this.sEc=this.FKa=0}}Object(u.a)(rJ,"CharsCountResult",null,[]);class NO{constructor(){this.cp=0;this.wEc=null;this.Tba=this.Uba=0}}Object(u.a)(NO,"TextChunkResult",null,[]);class OO{constructor(){this.Ihk=this.Uba=this.Tba=this.wordCount=0}}Object(u.a)(OO,"WordCountStateForParagraph",null,[]);
class LN{constructor(){this.Cea=this.xN=this.Uba=this.Tba=this.KW=this.wordCount=0;this.currentNode=null;this.e1=-1;this.cp=0;this.Tng=[];this.EQb=this.FQb=this.R8a=this.Ong=this.Png=0;this.TK=this.K2i=!1;this.ADb=new Cb.a;this.ldb=new Cb.a}}Object(u.a)(LN,"WordCountState",null,[]);class Fp{constructor(b,h,r,A,L,ba){this.kkp=1E3;this.sa=new Nf.a;this.mMb=null;this.VMe=0;this.mCk="\ue000";this.rJc=!1;this.eSe=this.WRe=this.ICd=0;this.Oih=this.Wih=null;this.SRe=this.RRe=this.ZRe=0;this.n2l=ra=>{this.mMb=
null;this.yBf(ra.customData)};this.hL=h;this.qAk=new RegExp(wm.AParagraphNode.jG,"g");this.Vd=b;this.jj=A;this.Wn=r;this.b8a=ba;this.A5a=L.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.vSk=L.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.YLj()}get yCn(){return!!this.mMb}get eXa(){return this.rJc}set eXa(b){this.rJc=b}get WTd(){return this.VMe}set WTd(b){this.VMe=b}get k_a(){return!this.VMe}get vC(){return this.ICd}get FPb(){return this.WRe}get JPb(){return this.eSe}get eTl(){return this.Wih}get $xf(){return this.Oih}get Z_c(){return this.ZRe}get X_c(){return this.RRe}get Y_c(){return this.SRe}Dob(b){this.sa.addHandler(Fp.hKe,
b)}Txe(b){this.sa.removeHandler(Fp.hKe,b)}Qjf(b){this.sa.addHandler(Fp.vSg,b)}BJo(b){this.sa.removeHandler(Fp.vSg,b)}H2d(){this.G2d();this.YLj()}YLj(){this.ZRe=this.SRe=this.RRe=this.eSe=this.WRe=this.ICd=-1}czf(){this.uEe(this.kkp)}Itd(){const b=new LN;b.K2i=!0;this.G2d();this.yBf(b)}uEe(b,h=null){this.k_a&&(this.yCn&&(h=null,this.G2d()),h||(h=new LN),b=new Md.a(3,1,b,this.n2l,this.q5j),b.customData=h,this.h6k(b))}G2d(){this.mMb&&(this.jj.Kf(this.mMb),this.mMb=null)}Aek(b,h,r,A,L,ba=!0,ra=-1,Ia=
-1,Ta=-1,ob=1033){const nb=new MO;nb.N5b=r;nb.FYd=L;nb.GYd=A;if(!b.cp&&h.Ixd&&ba&&!this.FKi(h))return Fp.aJp(b,h.Ixd),nb.f9i=!0,nb;A=0<=Ia&&0<=Ta?{Kd:Ia,endCp:Ta}:void 0;r=this.$mm(h,A);A&&(Ia=A.Kd,Ta=A.endCp);r=0<=Ta?r.substring(0,Ta):r;Ta=0<=Ia&&0<=Ta?r.substring(Ia,Ta):r;A=b.cp>=Ia?b.cp:Ia;L=b.Tng||[];ba=0<b.Png?b.Png:0;let Eb=0<b.Ong?b.Ong:0,bc=[];b.TK=!1;do{this.b8a.update();if(!b.K2i&&(nb.N5b+bc.length/2>Fp.WOp||this.b8a.Txb())){let zd;L=(zd=L).concat.apply(zd,bc);b.cp=A;b.Tng=L;b.Ong=Eb;b.Png=
ba;b.e1=ra;b.currentNode=h;this.uEe(Fp.ESp,b);nb.wGg=!0;b.TK=!0;return nb}if((!A||A===Ia)&&0<r.length&&A<r.length){L.push(gB.a.instance.fSf(r,A));var Bc=this.FKi(h);if(0<=ra&&!A&&Bc){b.wordCount+=1;nb.N5b+=1;const zd=this.Vd.P4(Bc);Bc=this.hL.xhd(zd,Bc);Bc=Fp.I0d(Bc);b.Uba+=Bc.FKa+1;b.Tba+=Bc.FKa-Bc.sEc}}Bc=this.pPi(r,A,Fp.Zwl);A=Bc.cp;let Yc;bc=(Yc=bc).concat.apply(Yc,Bc.wEc);ba+=Bc.Uba;Eb+=Bc.Tba}while(-1!==A);b=this.ZZk(b,L,bc,r,Ta,nb.N5b,nb.FYd,nb.GYd,h,-1===ra,ob);nb.N5b=b.wordCount;nb.FYd=b.Tba;
nb.GYd=b.Uba;nb.bSp=b.Ihk;return nb}kmi(b,h){const r=rd.ParagraphReader.textLength(h,9);if(r){h=kp.e(h);var A=0;for(let L=0;L<h.length;L++)if(this.Mub&&5===h[L].xi&&b.xN++,Fp.y9o(h[L])){A++;break}h.length!==r?b.KW++:b.KW+=A}}aYj(b){this.WTd=this.Z9o(b.R8a,b.wordCount)?1:0;return!!this.WTd}Wuj(b){this.ICd=b.wordCount;this.WRe=b.xN;this.eSe=b.Cea;this.SRe=b.Uba;this.RRe=b.Tba;this.ZRe=b.KW;this.Wih=b.ADb;this.Oih=b.ldb;this.iEj(b)}iEj(b){this.sa.raiseEvent(Fp.hKe,new KN(b))}hEj(){this.sa.raiseEvent(Fp.vSg,
new JN(!1))}Z9o(b,h){if(X.a.Zt||X.a.Fv||X.a.BH)return!1;(h/=2)||(h=1);return(h?b/h:0)>Fp.RRn?!0:!1}get Mub(){const b=!this.Aag||1===this.Aag&&this.vSk;return this.A5a&&b}tHi(b,h){let r=1033,A=0;b=h.gOf(b);h=new jg;for(let L=0;L<b.length;L++){const ba=h.c1k(b[L].lcid,b[L].end-b[L].Mc);A<ba&&(A=ba,r=b[L].lcid)}return r}ZZk(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){var Eb;h=(Eb=h).concat.apply(Eb,r);r=gB.a.instance.rPi(h,A);b.wordCount+=r.wordCount;L=Fp.I0d(L);Eb=L.FKa-L.sEc;const bc=L.FKa;b.Tba+=Eb;b.Uba+=bc;ba+=
r.wordCount;ra+=L.FKa-L.sEc;Ia+=L.FKa;b.R8a+=r.R8a;const {A4l:Bc,pup:Yc}=Fp.YZk(h,A);b.FQb+=Bc;b.EQb+=Yc;b.ldb.add(nb);b.ADb.add(r.wordCount);ob&&Fp.Bpl(bc,Eb,Ta,r,Bc,Yc,nb);b.cp=0;b.Tng=[];b=new OO;b.Tba=ra;b.Uba=Ia;b.wordCount=ba;b.Ihk=r.wordCount;return b}$mm(b,h){let r=this.pLo(b);r=rd.ParagraphReader.lsb(b,9,r,h);return this.pGo(r)}pLo(b){var h=rd.ParagraphReader.text(b);b=kp.e(b);if(0<b.length){h=h.split("");for(let A=0;A<b.length;++A){let L=!0;var r=!0;const ba=b[A];if(1===ba.xi)r=ba,r=22!==
r.kind&&2!==r.kind;else if(5===ba.xi)L=!1;else if(7===ba.xi||10===ba.xi)h[ba.Rb.cp]=this.mCk,L=!1;if(L){if(ba.Rb.cp>=h.length)return"";h[ba.Rb.cp]=r?" ":"C"}}h=h.join("")}return h}pGo(b){return b.replace(this.qAk,"")}pPi(b,h,r){const A=b.length-h<=r;var L=A?b.length:h+r;const ba=new NO;if(L<h)return ba.cp=-1,ba;ba.wEc=gB.a.instance.BKf(b,h,L);L=Fp.I0d(b.substr(h,L));ba.Uba=L.FKa;ba.Tba=L.FKa-L.sEc;if(!ba.wEc.length&&!A)return r===b.length-h?ba:this.pPi(b,h,b.length-h);ba.cp=A||!ba.wEc.length?-1:ba.wEc[ba.wEc.length-
1].cp;return ba}h6k(b){this.mMb=b;this.jj.pc(this.mMb)}FKi(b){b=nf.a.Qe?b:b.eG;if(nf.a.isListItem(b)){const h=this.Vd.P4(b);if(null===h||void 0===h?0:h.NB)return b}return null}static y9o(b){return 11===b.xi}static aJp(b,h){b.wordCount+=h.wordCount;b.Tba+=h.J5h;b.Uba+=h.K5h;b.R8a+=h.m1h;b.FQb+=h.FQb;b.EQb+=h.EQb;b.ldb.add(h.gxj);b.ADb.add(h.wordCount)}static Bpl(b,h,r,A,L,ba,ra){const Ia=new DG;Ia.wordCount=A.wordCount;Ia.K5h=b;Ia.J5h=h;Ia.m1h=A.R8a;Ia.FQb=L;Ia.EQb=ba;Ia.gxj=ra;r.Ixd=Ia}static I0d(b){const h=
b.length,r=new rJ;for(let L=0;L<h;L++){var A=b.charCodeAt(L);r.FKa++;if(55296<=A&&56319>=A&&(A=L+1<h?b.charCodeAt(L+1):0,56320<=A&&57343>=A)){L++;continue}D.a.iia(b.charAt(L))&&r.sEc++}return r}static YZk(b,h){let r=0,A=0;for(let L=0;L<b.length;++L){const ba=b[L],ra=ba.QP;(3===ra||2===ra)&&ba.cp<h.length&&(++r,D.a.pqc(h.charCodeAt(ba.cp))&&++A)}return{A4l:A,pup:r}}}Fp.hKe="wctek";Fp.vSg="wcac";Fp.ESp=1;Fp.Zwl=400;Fp.WOp=90;Fp.RRn=.1;Object(u.a)(Fp,"WordCountManagerBase",null,[325]);class yM extends Fp{constructor(b,
h,r,A,L,ba,ra,Ia,Ta,ob,nb){super(b,h,r,L,Ta,ob);this.Hvi=this.kRd=this.msa=null;this.p0a=()=>{this.czf()};this.pb=A;this.Jd=ra;this.CMh=Ia;this.MM=nb;this.pb.BD(this.p0a);this.g0e=Ta.$("ReadingTimeIsEnabled")}get q5j(){return 66}Qen(){if(this.msa)return!0;if(!this.pb||!this.pb.ob)return this.Jd&&(Ze.a.isClosing||y.AFrameworkApplication.isShuttingDown?this.Jd.qc("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.Jd.qc("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.pb.ob.clone();this.msa=b.QV(!0);if(!this.msa||!this.msa.MW())return this.G2d(),!1;this.CMh&&(this.kRd=this.CMh.create(h=>b.QV(h),this.Wn));this.msa.moveNext();return!0}get Aag(){return 1}KGl(b){return b===ic.a.Nd||b===ic.a.paragraph?!0:this.Mub&&(b===ic.a.GRb||b===ic.a.image||b===ic.a.Fba)}yBf(b){this.b8a.reset();if(this.Qen()){for(this.Mub&&this.kRd&&(this.kRd.i2l(b,this.b8a)||this.uEe(1,b));this.msa.current;){const A=-1===b.e1?0:b.e1;let L=0;var h=this.msa.current;if(!this.KGl(h.contextId)){this.msa.moveNext();
continue}if(this.Mub&&pe.a.mcb(h)){b.xN++;this.msa.moveNext();continue}if(!rd.ParagraphReader.lc(h.node)){this.msa.moveNext();continue}const ba=h.node;if(this.eXa&&this.Hvi&&this.Hvi.Kab(ba))this.msa.moveNext();else{if(this.Mub&&h.isValid){var r=te.a.kb(ba);for(r.ic(6);!r.yt;)pe.a.nr(r.currentNode)&&b.xN++,r.Di(6)}r=this.g0e?this.tHi(ba,this.MM):1033;h=this.Aek(b,ba,0,0,0,this.Ihe(h),A,h.cpBegin,h.cpEnd,r);if(h.f9i&&(L+=1,100<L)){b.e1=A+1;this.uEe(1,b);return}if(h.wGg)return;this.kmi(b,ba);this.msa.moveNext()}}this.kRd=
this.msa=null;this.aYj(b)?(this.ICd=-1,this.hEj()):this.Wuj(b)}}Ihe(b){let h=!1;b.contextId===ic.a.paragraph?h=!0:b.contextId===ic.a.Nd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(u.a)(yM,"SelectionWordCountManager",Fp,[]);class vz{constructor(b,h){this.y$b=!1;this.vLb=null;b&&h&&(this.wdc=b(!1),this.td=h,this.wdc.moveNext())}i2l(b,h){if(!b||!this.wdc||!this.wdc.current)return!0;do{const r=this.wdc.current;if(r.contextId===ic.a.rw||r.contextId===ic.a.Vy){for(this.vLb||this.$en(r.node);this.vLb.moveNext();)if(14===
this.vLb.currentNode.type&&b.Cea++,h.update(),h.Txb())return!1;this.iJl(r,b);this.vLb=null}this.wdc.moveNext()}while(this.wdc.current);return!0}iJl(b,h){const r=this.td.Ag(b.node);r.Ib(14);b.contextId===ic.a.rw&&(yp.a.v2i(r)&&(this.y$b=!0),yp.a.gie(r)&&this.y$b&&(this.y$b=!1,h.Cea++));b.contextId===ic.a.Vy&&(ih.TableCellReader.jbd(r)&&(this.y$b=!0),ih.TableCellReader.OZa(r)&&this.y$b&&(this.y$b=!1,h.Cea++))}$en(b){this.vLb=Xd.a.Mp(b);14===b.type?this.vLb.Oq(vz.o3c,b):this.vLb.Oq(vz.o3c,null)}static o3c(b){return b.parentNode?
!0:!1}}Object(u.a)(vz,"TableCountSelectionTraverser",null,[326]);class sC{constructor(b){this.A5a=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.A5a?new vz(b,h):null}}Object(u.a)(sC,"TableCountSelectionTraverserFactory",null,[308]);class zM extends Fp{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb){super(b,h,r,L,Ta,ob);this.YOp=Eb=>{if(Eb.yt)return!0;Eb=Eb.role;return 1===Eb||2===Eb||this.Mub&&6===Eb||3===Eb||4===Eb||5===Eb||!this.eXa&&(7===Eb||8===Eb)};this.ga=A;this.nOk=
ba;this.jXk=ra;this.vih=Ia;this.MM=nb;this.ga.nb(Lc.a.Ghk,ic.a.application,qf.ActionManager.qg,64);this.ga.nb(Lc.a.Hhk,ic.a.application,qf.ActionManager.qg,64);this.g0e=Ta.$("ReadingTimeIsEnabled")}get q5j(){return 63}get Aag(){return 0}yBf(b){this.b8a.reset();b.TK=!1;var h=this.nOk();fn.a.instance.eWb(h)||(this.H2d(),this.hEj());h=this.Wn.Gua(h,7,7).currentNode;var r=this.createIterator(b.currentNode,h);h=this.jXk(r,h);h.Oq(this.YOp,null);let A=r=0;for(var L=0;h.moveNext();){if(h.currentNode&&(!nf.a.Qe||
!bt.a.vie(h.currentNode))&&nf.a.isListItem(h.currentNode)){var ba=this.Vd.P4(h.currentNode);if(ba.NB){var ra=nf.a.Qe?h.currentNode:this.Vd.pYa(h.currentNode);if(ra&&(ra=ra.ra.last,(null===ra||void 0===ra?0:ra.Ui)&&(Pk.a.B$&&ra.Gi||ra.oW)))continue;b.wordCount+=1;if(ba=this.hL.xhd(ba,h.currentNode))ba=Fp.I0d(ba),b.Uba+=ba.FKa+1,b.Tba+=ba.FKa-ba.sEc;r+=1;A+=b.Uba;L+=b.Tba}if(!nf.a.Qe)continue}if(this.Mub&&h.currentNode&&pe.a.nr(h.currentNode))b.xN++;else if(this.Mub&&h.currentNode&&Qh.TableReader.pP(h.currentNode))b.Cea++;
else if(h.currentNode&&rd.ParagraphReader.lc(h.currentNode)){ba=h.currentNode;ra=this.g0e?this.tHi(ba,this.MM):1033;L=this.Aek(b,ba,r,A,L,!0,-1,-1,-1,ra);if(L.wGg){b.TK=!0;return}this.kmi(b,ba);r=L.N5b;A=L.GYd;L=L.FYd}}this.aYj(b)?(this.H2d(),this.lMo(),this.iEj(b)):this.Wuj(b)}createIterator(b,h){b?(b=this.vih(b),b.Ib(7)):b=this.vih(h);return b}lMo(){switch(this.WTd){case 1:this.ga.Vb(Lc.a.Ghk,2);break;case 2:this.ga.Vb(Lc.a.Hhk,2)}}}Object(u.a)(zM,"TotalWordCountManager",Fp,[]);class MN{constructor(){this.$Qj=
this.ZQj=this.dBg=this.aRj=this.v7j=this.w7j=this.t7j=this.u7j=0}get Bnj(){return this.Gmc(this.aRj,this.w7j,"WC")}get z_n(){return this.Gmc(this.ZQj,this.t7j,"NumCharsNoSp")}get A_n(){return this.Gmc(this.dBg,this.u7j,"NumCharsWithSp")}get E_n(){return this.Gmc(this.$Qj,this.v7j,"NumParagraphs")}Gmc(b,h,r){const A=this.oxd(h,r).toLocaleString();return 0<this.dBg?(b=this.sRg(b,h,r),String.format(WacWordeditorStrings.DocStatsDialogCountString,b.toLocaleString(),A)):A}sRg(b,h,r){b=this.oxd(b,r);return b>
h?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}oxd(b,h){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(u.a)(MN,"DocumentStats",null,[]);class HL{static Zvf(b){return Xf.a.iA(HL.pp,WacWordeditorStrings.DocStatsDialogWordsCount,b.Bnj,WacWordeditorStrings.DocStatsDialogCharsNoSpacesCount,b.z_n,WacWordeditorStrings.DocStatsDialogCharsWithSpacesCount,b.A_n,WacWordeditorStrings.DocStatsDialogParagraphsCount,b.E_n)}}HL.pp="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(u.a)(HL,"DocumentStatsDialogHtml",null,[]);class IL extends Xf.a{constructor(b){super();this.MX=!1;this.U2l=()=>{};this.EJ=b}Qdp(){this.$g="DocumentStatsDialog";this.Fh=HL.Zvf(this.EJ);this.Md=0;this.showDialog(WacWordeditorStrings.DocStatsDialogTitle,this.U2l);this.u$("DocumentStatsTable")}Cda(){}dispose(){this.MX||(super.dispose(),this.MX=!0)}}Object(u.a)(IL,"DocumentStatsDialog",Xf.a,[]);class NN{constructor(b,h,r,A,L,ba,ra,Ia,Ta){this.ELh=this.eLc=this.rJc=this.x$b=this.h1e=!1;this.Mvc=
()=>{this.WIe()};this.Fia=()=>{this.WIe()};this.Z5o=()=>{this.ELh=!0;return 32};this.Nsg=()=>this.Uv.k_a?32:8;this.zmd=(ob,nb,Eb,bc,Bc)=>{if(1===Eb)return this.Uv.k_a?32:8;Bc[bg.a.On]=this.G5f;return 32};this.CGe=(ob,nb,Eb)=>{if(1===Eb)return this.Uv.k_a?32:8;this.G5f?this.R_l():this.w6l();Db.StaticActiveAppFrame.Aa().UH({ShowWordCount:"CheckboxModel"});return 32};this.XAc=(ob,nb,Eb)=>{if(1===Eb)return bi.a.bda(nb)?8:this.Uv.k_a?32:8;if(this.ELh)return y.AFrameworkApplication.va.Vb(Lc.a.Zre,2),32;
ob=this.qe.rg("UserAction","Show Word Count Dialog");ob.start();this.Uv.Itd();this.qV.Itd();this.Uv.vC!==this.qV.vC?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");nb=this.uLl();(new IL(nb)).Qdp();ob.stop();return 32};this.Mld=(ob,nb,Eb,bc,Bc)=>{Bc||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Eb)return 32;if(!this.Uv.k_a)return Bc[vk.a.Visible]=
!1,32;Bc[vk.a.Visible]=!0;this.G5f?(ob=this.Uv.vC,0>ob?ob=WacWordeditorStrings.WordCountCalculating:ob?(nb=this.qV?this.qV.vC:-1,ob=0<nb?this.TQm(ob,nb):String.format(1===ob?WacWordeditorStrings.WordCountResultSingularAccurate:WacWordeditorStrings.WordCountResultAccurate,this.uze(ob))):ob=String.format(WacWordeditorStrings.WordCountResultExact,this.uze(ob))):ob=WacWordeditorStrings.WordCountHidden;Bc[vk.a.LabelText]=ob;return 32};this.ARe=ra;this.BRe=ba;this.Uv=b;this.qV=h;this.hLb=r;this.XUk=L;this.qV.Qjf(this.Mvc);
this.Uv.Qjf(this.Mvc);this.qV.Dob(this.Fia);this.Uv.Dob(this.Fia);this.qe=Ia;this.eXa=A;this.A5a=Ta.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Syf(){return!X.a.x9}mc(){const b=y.AFrameworkApplication.va;b.qa(Lc.a.CGe,ic.a.application,this.CGe);b.qa(Lc.a.XAc,ic.a.view,this.XAc);b.nb(Lc.a.zmd,ic.a.application,this.zmd,96);b.nb(Lc.a.Mld,ic.a.application,this.Mld,96);b.nb(Lc.a.Nsg,ic.a.application,this.Nsg,96);b.qa(Lc.a.Eoi,ic.a.application,this.Z5o)}get eXa(){return this.rJc}set eXa(b){this.rJc=
b;this.Uv.eXa=b;this.qV.eXa=b}w6l(){this.Uv.k_a&&(this.MWj(!0),this.WIe(),this.Uv.Itd())}uLl(){const b=new MN;b.w7j=this.Uv.vC;b.u7j=this.Uv.Y_c;b.t7j=this.Uv.X_c;b.v7j=this.Uv.Z_c;b.aRj=this.qV.vC;b.ZQj=this.qV.X_c;b.dBg=this.qV.Y_c;b.$Qj=this.qV.Z_c;return b}Ixm(){return this.ARe("WACWordCountEnabled",this.Syf)}RAe(b){this.BRe("WACWordCountEnabled",b?"true":"false",yc.a.U_a)}get G5f(){this.x$b||(this.h1e=this.Ixm(),this.x$b=!0);return this.h1e}MWj(b){this.RAe(b);this.h1e=b;this.x$b=!0}R_l(){this.Uv.H2d();
this.qV.H2d();this.MWj(!1);this.WIe()}get rJ(){return null!=this.q9g?this.q9g:this.q9g=(()=>this.hLb())()}WIe(){this.eLc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.RRl()),this.eLc=!0);this.rJ&&this.rJ.OW(this.XUk)}RRl(){const b={["words"]:this.Uv.vC,["charsWithSpaces"]:this.Uv.Y_c,["charsWithNoSpaces"]:this.Uv.X_c,["paragraphs"]:this.Uv.Z_c};this.A5a&&(b.images=this.Uv.FPb,b.tables=this.Uv.JPb);return b}uze(b){try{return b.toLocaleString()}catch(h){v.ULS.sendTraceTag(23652430,
338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}TQm(b,h){h>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WacWordeditorStrings.WordCountResultOnSelectionAccurate,this.uze(h),this.uze(b))}}Object(u.a)(NN,"WordCountActor",null,[]);class ON extends at.a{constructor(b,h,r,A){super();this.FW=(L,ba)=>{if(ba.property===Sb.a.so||
ba.property===Sb.a.Qq)L=ba.node,ba=Pk.a.Xm.tb.Xc,ba.Ly&&ba.Fd&&ba.Fd.ed&&L.ed&&L.ed.id===ba.Fd.ed.id&&this.Xpi(L)};this.dsj=(L,ba)=>{this.Xpi(ba.node)};this.z7n=(L,ba)=>{ba.property!==Pd.a.dE&&ba.property!==Rc.a.Qy||this.t2()};this.Tpe=()=>{this.t2()};this.Iaa=b;this.Uv=h;this.yn=r;this.A5a=A.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}bD(){var b=this.yn.Hf(12);b.yq(this.FW);b.wv(this.dsj);b.bA(this.dsj);b=this.yn.Hf(22);b.yq(this.z7n);b.wv(this.Tpe);b.bA(this.Tpe);this.A5a&&this.VCo();
this.Iaa.Cxa(this,7)}VCo(){var b=[19,14];for(const h of b)b=this.yn.Hf(h),b.wv(this.Tpe),b.bA(this.Tpe)}get index(){return 1}run(){this.Uv.czf()}Xpi(b){b.Ixd=null;this.t2()}}Object(u.a)(ON,"WordCountAppEventCoordinator",at.a,[]);class AM{}AM.$Zk="AccurateWordCountButton";Object(u.a)(AM,"WordCountConstants",null,[]);class PO{constructor(b,h){this.Uv=b;this.qV=h}getInstance(b){switch(b){case 1:return this.qV;case 0:return this.Uv;default:return this.Uv}}}Object(u.a)(PO,"WordCountManagerFactory",null,
[182]);class PN{constructor(){this.Z=null}get name(){return"WordEditor.WordCount"}Ec(b){this.Z=b;const h=this.Z.resolve("Common.IAppSettingsManager");this.Z.ja("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new sC(h)).ha();this.Z.ja("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new Qs.a(10,ed.a.We);const A=new zM(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),new dj.a,y.AFrameworkApplication.va,y.AFrameworkApplication.zc,()=>Pk.a.Xm.tb.Xc.Fd,
Xd.a.$u,te.a.kb,h,r,Xa.a.instance.resolve("Box4.ILanguageReader"));r=new yM(Xa.a.instance.resolve("Box4.List.IListReader"),Xa.a.instance.resolve("Box4.IListMarkerUtility"),new dj.a,Fg.a.instance,y.AFrameworkApplication.zc,qB.a.instance,$g.a.instance,Xa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Xa.a.instance.resolve("Box4.ILanguageReader"));return new PO(A,r)}).ha();this.Z.ja("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new xM(this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=
Db.StaticActiveAppFrame.Aa().tb;b.uva?this.xea():b.gga(()=>{this.xea()})}xea(){if(Ze.a.wf){var b=Ze.a.wf.Um;if(b){this.Z.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.Z.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),A=Xa.a.instance.resolve("Common.IAppSettingsManager");(new NN(h,r,()=>Xa.a.instance.Wa("WordEditor.IStatusBarUser"),this.Fwm(),AM.$Zk,yc.a.p2a,yc.a.ZCa,Xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
A)).mc();(new ON(Ar.a.instance,h,b,A)).bD();h.czf()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}Fwm(){var b=Pk.a.Xm.tb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Xc;if(!b)return v.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.Fd;return b?b.ka(Rc.a.eXa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){F.a.instance.Rc(new PN)}}
Object(u.a)(PN,"PackageManager",null,[0,1]);var BM=e(2107);class QN{constructor(b){this.L$e=null;b.Za("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.L$e=h})}sTj(b){this.L$e&&this.L$e.DNf().handleDocumentContentAugloopAnnotation(b)}}Object(u.a)(QN,"DocumentContentExtractionManager",null,[259]);class Th{}Th.$hp="mso_smartLookup";Th.channelId="SmartLookup";Th.Zhp="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Th.b1j="https://uci.edog.cdn.office.net/mirrored/smartlookup/";
Th.c1j="https://uci.cdn.office.net/mirrored/smartlookup/";Th.Yhp="https://hedwigtestserver.blob.core.windows.net/builds/";Th.Xhp="http://localhost:8080/";Th.jtd="current";Th.a1j="next";Th.ofo=2;Th.fwc=1;Th.gwc=CommonUIStrings.L_SmartLookupPaneTitle;Th.CF="InsightsTaskPane";Th.iLg="InsightsTaskPaneData";Th.$Wf="InsightsContentFrame";Th.width=400;Th.lUn="ApplicationPropertiesRequest";Th.wUn="SelectionRequest";Th.rUn="PageRendered";Th.kUn="ApplicationProperties";Th.vUn="Selection";Th.yUn="Telemetry";
Th.xUn="TakeFocus";Th.qUn="LostFocus";Th.nUn="Keyboard";Th.oUn="LegalAgreed";Th.XRp="WordWac";Th.Dbo="OneNoteWAC";Th.lng="yes";Th.A5j="appCorrelationId";Th.Lqp="clientCorrelationId";Th.B5j="message";Th.dbj="Microsoft::Office::Insights::LegalAgreed";Object(u.a)(Th,"InsightsConstants",null,[]);var sJ=e(1584);class EG{}Object(u.a)(EG,"ActivityContractInfo",null,[]);class Cs{}Object(u.a)(Cs,"BrowserPaneDataField",null,[]);class zE{}Object(u.a)(zE,"BrowserPaneTelemetryEvent",null,[]);class rl{static gD(b,
h){const r=new zE;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new EG,{success:!0});const A=[],L=new Cs;L.name="Message";L.dataType=0;L.value=b;b=new Cs;b.name="Level";b.dataType=0;b.value=rl.getLevelString(h);Array.add(A,L);Array.add(A,b);r.dataFields=A;rl.sendTelemetryEvent(r)}static sRj(b,h){const r=new zE;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new EG,{success:!0});b=[];const A=new Cs;A.name="AppCorrelationId";A.dataType=0;A.value=h;Array.add(b,
A);r.dataFields=b;rl.sendTelemetryEvent(r)}static VWo(b,h,r,A,L,ba){const ra=new zE;ra.eventName="LaunchPaneWithError";ra.isActivity=!1;ra.activityContract=Object.assign(new EG,{success:!0});const Ia=[],Ta=new Cs;Ta.name="IsNetworkConnected";Ta.dataType=0;Ta.value=b?"true":"false";b=new Cs;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Cs;h.name="EntryPoint";h.dataType=0;h.value=r;r=new Cs;r.name="RuntimeVersion";r.dataType=0;r.value=A;A=new Cs;A.name="IsFirstRelease";
A.dataType=1;A.value=L?"true":"false";L=new Cs;L.name="IsZeroTerm";L.dataType=1;L.value=ba?"true":"false";ba=new Cs;ba.name="IsClientSideRendering";ba.dataType=1;ba.value="false";Array.add(Ia,Ta);Array.add(Ia,h);Array.add(Ia,b);Array.add(Ia,r);Array.add(Ia,A);Array.add(Ia,L);Array.add(Ia,ba);ra.dataFields=Ia;rl.sendTelemetryEvent(ra)}static iBg(b,h,r){const A=new zE;A.eventName="CDNDownloadLatency";A.isActivity=!0;A.activityContract=Object.assign(new EG,{duration:r,success:!0});r=[];const L=new Cs;
L.name="CDNHostname";L.dataType=0;L.value=b;b=new Cs;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,L);Array.add(r,b);A.dataFields=r;rl.sendTelemetryEvent(A,1)}static qzc(b,h,r,A,L,ba,ra,Ia){const Ta=new zE;Ta.eventName="LaunchPane";Ta.isActivity=!0;Ta.activityContract=Object.assign(new EG,{duration:h,success:!0});h=[];const ob=new Cs;ob.name="AppCorrelationId";ob.dataType=0;ob.value=b;b=new Cs;b.name="EntryPoint";b.dataType=0;b.value=r;r=new Cs;r.name="IsServerSideRendering";r.dataType=1;r.value=
"true";const nb=new Cs;nb.name="UxVersion";nb.dataType=0;nb.value=A;A=new Cs;A.name="FeatureGates";A.dataType=0;A.value=L;L=new Cs;L.name="IsFirstRelease";L.dataType=1;L.value=ba?"true":"false";ba=new Cs;ba.name="IsZeroTerm";ba.dataType=1;ba.value=ra?"true":"false";ra=new Cs;ra.name="IsClientSideRendering";ra.dataType=1;ra.value=Ia?"true":"false";Array.add(h,ob);Array.add(h,b);Array.add(h,r);Array.add(h,nb);Array.add(h,A);Array.add(h,L);Array.add(h,ba);Array.add(h,ra);Ta.dataFields=h;rl.sendTelemetryEvent(Ta)}static sendTelemetryEvent(b,
h=2){if(b.isFeedbackActivity)rl.jLn(b.eventName);else{var r=-1<b.eventName.indexOf(rl.z5j)?b.eventName:rl.z5j+b.eventName,A=rl.Ivm(b.dataFields);b.isActivity?(b=Object.assign(new nk.a,{name:r,samplingPolicy:h,dataFields:A,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ka.a.sendActivityEvent(b)):(b=Object.assign(new ja.a,{name:r,samplingPolicy:h,dataFields:A}),ka.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";
default:return"Info"}}static Ivm(b){const h=[];if(b&&0<b.length)for(const r of b)(b=Uh.a.Fca(r.name,r.value,rl.cIl(r.dataType)))&&Array.add(h,b);return h}static cIl(b){switch(b){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static jLn(b){const h=Xa.a.instance.Wa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}rl.z5j="Office.Insights.SmartLookup.";Object(u.a)(rl,"TelemetryUtils",
null,[]);var tJ;(function(b){b[b.other=0]="other";b[b.Gtq=1]="searchBoxSearch";b[b.Atq=2]="searchBoxDictionary";b[b.Ftq=3]="searchBoxQuickAnswer";b[b.Zvq=4]="smartLookupRibbon";b[b.Yvq=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.k5p=7]="dictionary";b[b.web=8]="web";b[b.Hpq=9]="pictures";b[b.files=10]="files";b[b.p1p=11]="bookmarks";b[b.ooc=12]="help";b[b.a2p=13]="chartRecommendation";b[b.Qeq=14]="linkSkill";b[b.Ctq=15]="searchBoxFindInDocument";b[b.Btq=16]="searchBoxEntity";b[b.Itq=17]=
"searchSkill";b[b.N3p=18]="controlF";b[b.wsq=19]="ribbonFindButton";b[b.rsq=20]="reuseSlides";b[b.data=21]="data";b[b.B3p=22]="contextMenuDictionary";b[b.E3p=23]="contextMenuSearchSuggestion";b[b.H3p=24]="contextMenuSynonyms";b[b.D3p=25]="contextMenuSearchBoxSearch";b[b.Htq=26]="searchBoxSearchZeroTerm";b[b.F3p=27]="contextMenuSearchZeroTerm";b[b.Smq=28]="note";b[b.Xvq=29]="smartLookupAutoLaunch";b[b.G3p=30]="contextMenuSmartLookupInSubMenu";b[b.B4p=31]="dataDisambiguate";b[b.Peq=32]="linkFiles";
b[b.Etq=33]="searchBoxNoteL2";b[b.C3p=34]="contextMenuLaunchL2Document";b[b.e_p=35]="actionAI";b[b.ppq=36]="pasteAsNewSlide";b[b.Rvq=37]="slidesCompression";b[b.Dtq=38]="searchBoxGenerateDeck";b[b.Spq=39]="powerPointCopilot";b[b.hxq=40]="tellMeService";b[b.bqq=99]="prefetch"})(tJ||(tJ={}));Object(u.b)("EntryPoint",tJ);var Ns=e(1473),Lv=e(1491);class gu{static W1(b,h,r,A,L,ba){if(1===r)return id.SessionStatusManager.instance.WC?32:8;if(L.value.icp())return rl.gD("Skipping Serplet launch",10),32;h=
ba;if(!h)return 8;b=gu.cSb();if(r=h.CommandValueId)try{h=H.a(r)}catch(ra){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Ns.a,{selection:h}):(h=L.value.MSb(),r.selection=Object.assign(new Lv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=L.value.uFi();return gu.wkc(ba,null,r,b,0,L)}static wkc(b,h,r,
A,L,ba){const ra={};ra.controlId=b?b.SourceControlId:"shortcut";r&&(ra.entryPoint=tJ[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,gu.YY("Show insights",A,ra));h?ba.value.Mep(h,A,L):r&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?ba.value.Zcp(r,A):ba.value.Nep(r,A,L));return 32}static YY(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(const A in r)b[A]=r[A];return H.c(b)}static cSb(){return qb.a.create().toString()}}Object(u.a)(gu,
"InvokingPaneUtils",null,[]);class RN{}Object(u.a)(RN,"LaunchDataInDoc",null,[]);class Yk{}Object(u.a)(Yk,"LaunchDataPasteAsSlide",null,[]);class SN{}Object(u.a)(SN,"LaunchDataSlidesCompression",null,[]);var it=e(1456);class FG{constructor(b,h,r,A,L,ba,ra,Ia,Ta){this.tJc=this.kGd=this.$y=null;this.aTb=ob=>{this.$y||3!==ob.state||(this.$y=ob,this.kGd=this.$y.Mia)};this.RF=b;this.ga=h||y.AFrameworkApplication.va;this.hr=r;this.oc=A;this.Nvh=Ia;this.kPc=L;this.za=ba;this.Sb=ra;this.Tdn();this.s5a=new xe.a(()=>
new Xg.a(Ta.value,this.aTb))}mc(){this.ga.qa(wb.a.Nin,dd.a.frame,Object(E.a)(this,this.Kep,"showInsights"));this.ga.qa(wb.a.Oin,dd.a.frame,Object(E.a)(this,this.Lep,"showInsightsForTellMe"));this.ga.qa(wb.a.definitions,dd.a.frame,Object(E.a)(this,this.Gdp,"showDefinitions"));this.ga.qa(wb.a.$yf,dd.a.frame,Object(E.a)(this,this.Hdp,"showDefinitionsForTellMe"));this.ga.qa(wb.a.VGg,dd.a.frame,Object(E.a)(this,this.VGg,"showInsightsForSuggestion"));this.Nvh&&(this.ga.qa(wb.a.Uca,dd.a.frame,Object(E.a)(this,
this.W1,"invokeSmartLookupPane")),this.ga.qa(wb.a.pad,dd.a.frame,Object(E.a)(this,this.pad,"invokeInDocSerplet")),this.ga.qa(wb.a.ige,dd.a.frame,Object(E.a)(this,this.ige,"invokeSerpletRibbon")),this.ga.qa(wb.a.qad,dd.a.frame,Object(E.a)(this,this.qad,"invokeSerpletContextMenu")),this.ga.qa(wb.a.w_f,dd.a.frame,Object(E.a)(this,this.w_f,"invokeSerpletTellMeZeroTerm")),this.ga.qa(wb.a.v_f,dd.a.frame,Object(E.a)(this,this.v_f,"invokeSerpletTellMeNotes")),this.ga.qa(wb.a.ege,dd.a.frame,Object(E.a)(this,
this.ege,"invokeImageSerpletContextMenu")),this.ga.qa(wb.a.jge,dd.a.frame,Object(E.a)(this,this.jge,"invokeSynonymsSerpletContextMenu")),this.ga.qa(wb.a.dge,dd.a.frame,Object(E.a)(this,this.dge,"invokeDictionarySerpletContextMenu")),this.ga.qa(wb.a.lge,dd.a.frame,Object(E.a)(this,this.lge,"invokeZeroTermSerpletContextMenu")),this.ga.qa(wb.a.cge,dd.a.frame,Object(E.a)(this,this.cge,"invokeDefinitionSearchFromFloatie")),this.ga.qa(wb.a.hge,dd.a.frame,Object(E.a)(this,this.hge,"invokeSerpletBrowseFiles")),
this.ga.qa(wb.a.fge,dd.a.frame,Object(E.a)(this,this.fge,"invokeInDocSerpletWithLaunchData")),this.ga.qa(wb.a.cwe,dd.a.frame,Object(E.a)(this,this.cwe,"queryToggleSerplet")),this.ga.qa(wb.a.gBe,dd.a.frame,Object(E.a)(this,this.gBe,"setInDocSearchParameter")),this.ga.qa(wb.a.u_f,dd.a.frame,Object(E.a)(this,this.u_f,"invokeSerpletSlidesCompression")),this.ga.qa(wb.a.t_f,dd.a.frame,Object(E.a)(this,this.t_f,"invokeSerpletPasteAsNewSlide")),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.ga.qa(wb.a.SZi,dd.a.frame,Object(E.a)(this,this.Mkn,"invokeSmartLookupPaneConversations")),this.ga.qa(wb.a.bge,dd.a.frame,Object(E.a)(this,this.bge,"invokeAutoLaunchSearchRequest"))),this.ABo().continueWith(()=>{y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Ne(!0)}))}CSh(){this.ga.nb(wb.a.FNa,dd.a.frame,Object(E.a)(this,this.FNa,"invokeFilesSerplet"),4);this.ga.nb(wb.a.o_f,dd.a.frame,Object(E.a)(this,this.FNa,"invokeFilesSerplet"),4);this.ga.nb(wb.a.MZi,dd.a.frame,Object(E.a)(this,
this.Bkn,"invokeLinkFilesSerplet"),4);if(this.za.$("IsTellMeUpSellEnterpriseEnabled")&&this.za.$("SmartLookupTokenPrefetchIsEnabled")){const b=Md.a.jca(0,Object(E.a)(this,this.kAj,"prefetchToken"),0,177);this.Sb.pc(b)}}Qif(){mh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.qa(wb.a.FNa,dd.a.frame,Object(E.a)(this,this.p_f,"invokeFilesSerpletUnavailable")),this.ga.qa(wb.a.o_f,dd.a.frame,Object(E.a)(this,this.p_f,
"invokeFilesSerpletUnavailable")),this.ga.qa(wb.a.MZi,dd.a.frame,Object(E.a)(this,this.p_f,"invokeFilesSerpletUnavailable")))}kAj(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.uDc().then(h=>{let r=1;if(h)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.MBg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.za.sc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.MBg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.za.sc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.MBg("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.za.sc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new Md.a(3,1,h,Object(E.a)(this,
this.kAj,"prefetchToken"),177);h.data=r.toString();this.Sb.pc(h)})}MBg(b="",h=!1){this.kPc.execute(r=>{r&&r.ozc("PrefetchToken",h,0,"SmartLookup",b)})}uDc(){return this.kPc?new Promise(b=>{this.kPc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.za.rb("SmartLookupShredderServiceEndpoint")).then(A=>{b(!!A&&0<A.length);h.ozc("TryGetTokenInternal",!!A&&0<A.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}ABo(){const b=new zg.a;if(this.za.$("BrowserSupportsInsightsPaneSSO"))this.CSh(),
b.setResult(!0);else{if(!this.kPc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.setResult(!1),this.Qif(),b.task;this.kPc.execute(h=>{h?h.getToken("SmartLookup",this.za.rb("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.CSh(),b.setResult(!0)):this.Qif()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.setResult(!1),this.Qif())})}return b.task}Kep(b,
h,r,A,L){if(1===r)return y.AFrameworkApplication.ta&&y.AFrameworkApplication.J.$("OneNoteDelayLoadContextActivationManager")&&!y.AFrameworkApplication.HZc?8:this.RF.value.E3i()?32:8;b=gu.cSb();h=this.RF.value.MSb();return this.Nvh?(h=Object.assign(new Lv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Ns.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new it.a,{landingTab:"All"})}),gu.wkc(L,null,h,b,0,this.RF)):gu.wkc(L,
h,null,b,0,this.RF)}Gdp(b,h,r,A,L){if(1===r)return this.RF.value.E3i()?32:8;b=gu.cSb();h=this.RF.value.MSb();return gu.wkc(L,h,null,b,1,this.RF)}Lep(b,h,r,A,L){return 1===r?32:this.rri(L,0)}Hdp(b,h,r,A,L){return 1===r?32:this.rri(L,1)}rri(b,h){const r=gu.cSb(),A=b.CommandValueId;let L;try{L=H.a(A)}catch(ba){return v.ULS.sendTraceTag(6295941,1303,15,gu.YY(String.format("Insights parameters [{0}] is not in proper format.",A),r)),8}return gu.wkc(b,L,null,r,h,this.RF)}VGg(b,h,r,A,L){if(1===r)return 32;
if(!L)return 8;b=L.query?L.query:"";h=gu.cSb();r=new sJ.a;r.neighborhood=b;r.mentionStart=0;r.mentionLength=b.length;return gu.wkc(L,r,null,h,0,this.RF)}Bkn(b,h,r,A){if(1===r)return id.SessionStatusManager.instance.WC?32:8;const L=y.AFrameworkApplication.J.$("InsertFileLinkSerpletIsEnabled"),ba=this.RF.value.Sab();return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new it.a,{landingTab:"File"}),
entryPoint:L?32:10}))}FNa(b,h,r,A){if(1===r)return id.SessionStatusManager.instance.WC?32:8;const L=y.AFrameworkApplication.J.$("InvokeReuseSlidesSerpletIsEnabled"),ba=this.RF.value.Sab();return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new it.a,{landingTab:L?"Slide":"File"}),entryPoint:L?20:10}))}p_f(){return 2}pad(b,h,r,A,L){if(1===r)return id.SessionStatusManager.instance.zk?8:
32;const ba=this.RF.value.Sab();L=void 0===L||null===L?18:19;return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new it.a,{landingTab:"Indoc"}),entryPoint:L}))}fge(b,h,r,A,L){L=L.CommandValueId;if(!L||L&&this.tJc&&L.query===this.tJc.query&&L.matchCase===this.tJc.matchCase&&L.matchWholeWordOnly===this.tJc.matchWholeWordOnly)return 32;const ba=this.RF.value.Sab();
return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new it.a,{landingTab:"Indoc",data:Object.assign(new RN,{type:4,query:L.query,matchCase:L.matchCase,matchWholeWord:L.matchWholeWordOnly})}),entryPoint:18}))}cwe(b,h,r,A,L){L&&(L[bg.a.On]=this.RF.value.fWb);return 32}gBe(b,h,r,A,L){if(b=L.CommandValueId)this.tJc=b;return 32}Mkn(b,h,r){if(1===r)return id.SessionStatusManager.instance.WC?
32:8;b=this.RF.value.Sab();b=Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new it.a,{landingTab:"All"})});this.RF.value.Hke(b);return 32}bge(b,h,r){if(1===r)return id.SessionStatusManager.instance.WC?32:8;b=this.RF.value.Sab();b=Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new it.a,
{landingTab:"All",data:y.AFrameworkApplication.yQb})});h=gu.cSb();this.RF.value.R1b(b,h);return 32}ige(b,h,r,A){if(1===r)return id.SessionStatusManager.instance.WC?32:8;const L=this.RF.value.wFi();return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:L.mentionLength}),entryPoint:4,launchData:Object.assign(new it.a,{landingTab:"All"})}))}qad(b,h,r,A){return this.W1(b,h,r,A,Object.assign(new Ns.a,{entryPoint:5,
launchData:Object.assign(new it.a,{landingTab:"All"})}))}w_f(b,h,r,A){if(1===r)return id.SessionStatusManager.instance.WC?32:8;const L=this.RF.value.Sab();return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:0}),launchData:Object.assign(new it.a,{landingTab:"All"}),entryPoint:26}))}dge(b,h,r,A){return 1===r?(b=this.RF.value.MSb())&&0<b.mentionLength?32:8:this.W1(b,h,r,A,Object.assign(new Ns.a,{entryPoint:22,
launchData:Object.assign(new it.a,{landingTab:"All"})}))}cge(b,h,r,A){return 1===r?(b=this.RF.value.MSb())&&0<b.mentionLength?32:8:this.W1(b,h,r,A,Object.assign(new Ns.a,{entryPoint:7,launchData:Object.assign(new it.a,{landingTab:"All"})}))}ege(b,h,r,A){return this.W1(b,h,r,A,Object.assign(new Ns.a,{launchData:Object.assign(new it.a,{landingTab:"Image"}),entryPoint:9}))}jge(b,h,r,A){return this.W1(b,h,r,A,Object.assign(new Ns.a,{launchData:Object.assign(new it.a,{landingTab:"All"}),entryPoint:24}))}v_f(b,
h,r,A){return this.W1(b,h,r,A,Object.assign(new Ns.a,{launchData:Object.assign(new it.a,{landingTab:"Notes"}),entryPoint:33}))}lge(b,h,r,A){if(1===r)return id.SessionStatusManager.instance.WC?32:8;const L=this.RF.value.Sab();return this.W1(b,h,r,A,Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:0}),launchData:Object.assign(new it.a,{landingTab:"All"}),entryPoint:27}))}u_f(b,h,r,A,L){if(!L)return 8;const ba=L.url;L=L.selectedSlideIDs;
return this.W1(b,h,r,A,Object.assign(new Ns.a,{launchData:Object.assign(new it.a,{landingTab:"All",data:Object.assign(new SN,{type:6,url:ba,selectedSlideIDs:L})}),entryPoint:37}))}t_f(b,h,r,A,L){if(!L)return 8;const ba=L.Selection;L=L.CurrentDocTitle;return this.W1(b,h,r,A,Object.assign(new Ns.a,{launchData:Object.assign(new it.a,{landingTab:"All",data:Object.assign(new Yk,{type:5,selection:ba,currentDocTitle:L})}),entryPoint:36}))}W1(b,h,r,A,L){return gu.W1(b,h,r,A,this.RF,L)}hge(b,h,r){if(1===r)return 32;
this.$y||this.s5a.value.F1("Browse File from Search pane",!0);if(!this.kGd||""===this.kGd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;ed.a.Zm(this.kGd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}Tdn(){const b=this.oc.te(Th.CF);b.parent=Df.AFrame.rr;b.Rla(Object(E.a)(this,this.pzc,"sendIFrameTakeFocusMessage"));this.hr.vY(Th.CF)}pzc(){document.activeElement.blur();y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.mwb||(this.RF.value.G0o(),
this.RF.value.TWo())}dispose(){this.RF.value&&this.RF.value.dispose()}}Object(u.a)(FG,"InsightsActor",null,[11]);const JL=b=>{b=b.split("-");return b[b.length-1]},bP=()=>{var b=KL();if(b)return Promise.resolve(b);b=OA().replace("SearchWeb","searchweb");b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Th.a1j+"/":b+Th.jtd+"/";b+="version.json";if(X.a.bia)return TN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);
b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(rl.gD("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{rl.gD("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=H.b(JSON.stringify(r));return r.version?r.version:""},r=>{rl.gD("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return rl.gD("InsightsUtils - Failed to download version.json: "+h.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},TN=b=>{const h=y.AFrameworkApplication.pe;return new Promise(r=>{const A=new wG.a(b,1,null,null,!0,2,null);h.send(A).cxa(L=>{L&&L.data?L.data.responseData||(rl.gD("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
L.data.Xe,10),r("")):(rl.gD("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const ba=H.b(L.data.responseData);ba.version&&r(ba.version)}catch(ba){rl.gD("InsightsUtils - Failed to deserialize version: "+ba.toString(),10),r("")}},L=>{L&&L.data?rl.gD("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+L.data.Xe,10):rl.gD("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);r("")})})},CM=()=>y.AFrameworkApplication.J.$("SmartLookupEnableLocalOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),tC=()=>{const b=OA();return CM()||y.AFrameworkApplication.J.rb("SmartLookupPRClientVersion")?b+KL()+"/":y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Th.a1j:b+Th.jtd},KL=()=>CM()?"dev":y.AFrameworkApplication.J.rb("SmartLookupPRClientVersion")?
y.AFrameworkApplication.J.rb("SmartLookupPRClientVersion").split("/")[1]:y.AFrameworkApplication.J.rb("SmartLookupClientVersion"),DM=b=>{var h=3===y.AFrameworkApplication.ta.Pb.gl?"wordwac":2===y.AFrameworkApplication.ta.Pb.gl?"pptwac":"excelwac";var r=Wg.a.Vg(y.AFrameworkApplication.lcid);const A=r?r.name:"en-us";r=OA();const L=fx();h="main_ssr_wac.html?appName="+h+"&culture="+A;return"LOCAL"===L?r+h:r+((""!==b?b:Th.jtd)+"/")+h},cP=b=>OA()+(""!==b?b:Th.jtd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
OA=()=>{switch(fx()){case "LOCAL":return Th.Xhp;case "PR":const b=y.AFrameworkApplication.J.rb("SmartLookupPRClientVersion").split("/");return Th.Yhp+b[0]+"/";case "INT":return Th.Zhp;case "EDOG":return Th.b1j;default:return Th.c1j}},UN=()=>{if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(fx()){case "EDOG":return Th.b1j;case "PROD":return Th.c1j;default:return""}},fx=()=>{if(y.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(y.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(y.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(y.AFrameworkApplication.J.rb("SmartLookupPRClientVersion")&&y.AFrameworkApplication.J.rb("SmartLookupPRIntentSvc"))return"PR";if(CM())return"LOCAL";switch(Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=y.AFrameworkApplication.J.rb("UserPrincipalName");b=D.a.Ph(b);const h=
y.AFrameworkApplication.J.RA("SmartLookupINTEnabledForSKITeam")?y.AFrameworkApplication.J.kF("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},VN=()=>{let b;b=y.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":y.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":y.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":fx();const h=y.AFrameworkApplication.J.rb("IntentServiceEndpoint"),r=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return y.AFrameworkApplication.J.rb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},my=()=>{const b=fx(),h=y.AFrameworkApplication.J.rb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class WN{sendTelemetryEvent(b){rl.sendTelemetryEvent(b)}}
Object(u.a)(WN,"OtelTelemetrySink",null,[270]);class XN{}Object(u.a)(XN,"ApplicationProperties",null,[]);class uJ{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(u.a)(uJ,"CurrentDocumentProperties",null,[]);class wz{}Object(u.a)(wz,"EnterpriseUserInfo",null,[]);class GG{}Object(u.a)(GG,"FeatureGates",null,[]);class EM{constructor(b,h){this.Xx=this.Ij=null;this.YH="Search";this.chj=!0;this.aMb=h;this.Rw=b;this.Rw.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(A=>
{this.chj=A}).catch(A=>{rl.gD("SearchHelper - Failed to check if Feedback feature is enabled: "+A.toString(),15)})});b=VN();h=y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")){this.Xx={};const r=this.bRm();if(r&&0<r.length)for(let A=0;A<r.length;A++){const L=r[A],ba=this.sRm(L);switch(ba.toLowerCase()){case "true":this.Xx[L]=
!0;break;case "false":this.Xx[L]=!1;break;default:this.Xx[L]=ba}}this.Xx.EnableInDocumentSearch=h;this.Xx.EnableInDocumentSearchReplace=!0;this.Xx.EnableInDocumentParamLocalSearch=!0;this.Xx.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Xx.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.Xx.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Xx.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.Xx.EnableInDocumentExperiment3=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Xx.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Xx.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.Xx.EnableLocalSearch=!0;this.Xx.EnableInDocumentStickyFilters=!0;this.Xx.IntentServiceEndpoint=b;this.Xx.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Xx.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.Xx.UXBundleVersion=KL();this.Xx.SmartLookupServicePath=tC();this.Xx.EnableAcronymSearch=
!0;this.Xx.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Xx.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Xx.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Xx.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Xx.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Xx.ShowDebugInfo="INT"===fx();this.Xx.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.Xx.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Xx.QnaInMixSection=!0;this.Xx.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Xx.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Xx.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Xx.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Xx.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Xx.EnableClientSideRendering=!0}else this.Ij=new GG,this.Ij.EnableInDocumentSearch=h,this.Ij.EnableInDocumentSearchReplace=
!0,this.Ij.EnableInDocumentParamLocalSearch=!0,this.Ij.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ij.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Ij.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ij.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Ij.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ij.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ij.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ij.EnableLocalSearch=!0,this.Ij.EnableInDocumentStickyFilters=!0,this.Ij.IntentServiceEndpoint=b,this.Ij.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ij.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ij.UXBundleVersion=KL(),this.Ij.SmartLookupServicePath=tC(),this.Ij.EnableAcronymSearch=
!0,this.Ij.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ij.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ij.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ij.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ij.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ij.ShowDebugInfo="INT"===fx(),this.Ij.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ij.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ij.QnaInMixSection=!0,this.Ij.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ij.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ij.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ij.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ij.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ij.EnableClientSideRendering=!0,this.Ij.SharedSerpletFeatureGate1=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ij.SharedSerpletFeatureGate2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ij.SharedSerpletFeatureGate3=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ij.SharedSerpletFeatureGate4=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ij.SharedSerpletFeatureGate5=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ij.SharedSerpletFeatureGate6=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ij.SharedSerpletFeatureGate7=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ij.SharedSerpletFeatureGate8=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ij.SharedSerpletFeatureGate9=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ij.SharedSerpletFeatureGate10=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ij.SharedSerpletFeatureGate11=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ij.SharedSerpletFeatureGate12=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ij.SharedSerpletFeatureGate13=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ij.SharedSerpletFeatureGate14=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ij.SharedSerpletFeatureGate15=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ij.SharedSerpletFeatureGate16=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ij.SharedSerpletFeatureGate17=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ij.SharedSerpletFeatureGate18=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ij.SharedSerpletFeatureGate19=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ij.SharedSerpletFeatureGate20=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ij.SharedSerpletFeatureGate21=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ij.SharedSerpletFeatureGate22=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ij.SharedSerpletFeatureGate23=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ij.SharedSerpletFeatureGate24=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ij.SharedSerpletFeatureGate25=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ij.SharedSerpletFeatureGate26=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ij.SharedSerpletFeatureGate27=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ij.SharedSerpletFeatureGate28=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ij.SharedSerpletFeatureGate29=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ij.SharedSerpletFeatureGate30=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ij.SharedSerpletFeatureGate31=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ij.SharedSerpletFeatureGate32=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ij.SharedSerpletFeatureGate33=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ij.SharedSerpletFeatureGate34=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ij.SharedSerpletFeatureGate35=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ij.SharedSerpletFeatureGate36=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ij.SharedSerpletFeatureGate37=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ij.SharedSerpletFeatureGate38=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ij.SharedSerpletFeatureGate39=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ij.SharedSerpletFeatureGate40=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.aOc=Xa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.txb=EM.isEnterpriseUser();this.K_a=y.AFrameworkApplication.J.rb("SmartLookupShredderServiceEndpoint");this.pag=db.a.dW(y.AFrameworkApplication.J.rb("AppCatalogUrl")||"");this.APn=y.AFrameworkApplication.J.rb("UserPrincipalName");this.txb&&this.eMi()}sRm(b){return y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}bRm(){const b=y.AFrameworkApplication.J.aab,h=y.AFrameworkApplication.J.kF("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(const L in b){var A=
{key:L,value:b[L]};A=A&&A.key?A.key:"";for(let ba=0;ba<h.length;ba++)if(-1<A.toLowerCase().indexOf(h[ba].toLowerCase())){const ra=A.split(".");ra&&4===ra.length&&Array.add(r,ra[ra.length-1])}}return r}eRf(b,h,r,A){return new Promise(L=>{this.uzn().then(ba=>{const ra=new XN;ra.anid="";ra.applicationName=3===y.AFrameworkApplication.ta.Pb.gl?"WORD":"POWERPNT";ra.applicationVersion=y.AFrameworkApplication.buildVersion;ra.appCorrelationId=b?b:gu.cSb();ra.themePlatform="web";ra.lcid=y.AFrameworkApplication.lcid;
ra.launchUtcTime=(new Date).toUTCString();y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?ra.featureGates=H.c(this.Xx):ra.featureGates=H.c(this.Ij);var Ia=Wg.a.Vg(y.AFrameworkApplication.lcid);Ia=Ia?Ia.name:null;ra.market=JL(Ia);ra.uiLanguage=Ia;ra.sessionId=y.AFrameworkApplication.userSessionId;ra.themeId=r;ra.parentalControl="yes";ra.processorOnlyMode=ba;ra.isEditingAllowed=h.isEditingAllowed();ra.isFeedbackEnabled=this.chj;ra.isClientSideRendering=18===A||19===A||15===A;ra.disableClipboard=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&y.AFrameworkApplication.nE&&!y.AFrameworkApplication.XLa;ra.accessToken=this.txb?this.eMi():"";ba=new wz;ba.CountryCode=JL(Ia);ba.ServiceEndpoint=this.K_a;ba.IsGoLocal=y.AFrameworkApplication.J.$("IsGoLocalEnvironment");ba.IsEnabled=this.txb;ba.IsEnterpriseEnabled=this.txb;ba.TenantRoot=this.pag;ba.Upn=this.APn;Ia=fx();ba.IsEUDB="PROD"===Ia&&""!==y.AFrameworkApplication.J.rb("IntentServiceEndpoint");
ra.enterpriseUserInfo=ba;ba=new uJ;ba.filePath=y.AFrameworkApplication.J.rb("EditDocInClientUrl");ba.docName=y.AFrameworkApplication.J.rb("FileName");ba.author=99!==A?h.author():null;ba.createdDate=99!==A?h.createdDate():null;ra.currentDocument=ba;L(ra)})})}uzn(){return new Promise(b=>{this.Rw?this.Rw.execute(h=>{h.isFeatureEnabled(Th.$hp,!0).then(r=>{b(!r)}).catch(r=>{rl.gD("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}jio(b){this.aOc&&
this.txb&&this.Vbe(this.K_a).then(h=>{b(h)})}eMi(){return"Dev Box"===y.AFrameworkApplication.J.rb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.aOc?this.aOc.lVm(this.YH,this.K_a):""}Vbe(b){return"Dev Box"===y.AFrameworkApplication.J.rb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.aOc?this.aOc.getToken(this.YH,b):Promise.resolve("")}v7c(){return this.aMb?this.aMb.getVersion():""}Dym(){return y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?H.c(this.Xx):H.c(this.Ij)}static isEnterpriseUser(){const b=y.AFrameworkApplication.J.rb("SovereignEnvironmentName"),h=y.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(u.a)(EM,"SearchHelper",null,[260]);class HG{constructor(){HG._instance=
""}getVersion(){return HG._instance}l7o(b){HG._instance=b}}HG._instance=null;Object(u.a)(HG,"SmartLookupVersion",null,[]);class YN{}Object(u.a)(YN,"ConfigurationProvider",null,[]);class AE{constructor(b){AE._instance=b}DNf(){return AE._instance}}AE._instance=null;Object(u.a)(AE,"SearchHostRuntime",null,[]);class vJ{constructor(){this.Pka=this.y6b=this.Z=null}get name(){return"Common.App.Insights"}Ec(b){this.Z=b;const h=Kb.a.xr(Xa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")||y.AFrameworkApplication.J.$("SmartLookupIsEnabled");b.register(FG,"Common.App.Insights.InsightsActor").ha().fe(()=>new FG(b.zf("Common.App.Insights.IInsightsManager"),y.AFrameworkApplication.va,sq.a.instance,Jc.FocusManager.instance(),b.Za("Common.App.SearchCommon.ISearchOAuthManager"),y.AFrameworkApplication.J,vb.TaskManager.instance,r,new xe.a(()=>h.result)));b.register(259,"Common.App.Insights.IDocumentContentExtractionManager").ha().fe(()=>
new QN(b));r&&(b.register(HG,"Common.App.Insights.SmartLookupVersion").ha().fe(()=>new HG),b.register(260,"Common.App.SearchCommon.ISearchHelper").ha().fe(()=>new EM(Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Wa("Common.App.Insights.SmartLookupVersion"))))}init(){y.AFrameworkApplication.b5&&(this.y6b=this.Z.Wa("Common.App.Insights.InsightsActor"),this.y6b.mc())}eAo(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=y.AFrameworkApplication.J.rb("SmartLookupShredderServiceEndpoint");this.Z.resolve("Common.App.SearchCommon.ISearchHelper").Vbe(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=my();const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new wG.a(h+("?isTelemetryOnly="+A),1,null,r,!0,2,null);y.AFrameworkApplication.pe.send(r).cxa(()=>{rl.gD("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
A,50)},L=>{rl.gD("InsightsPackage - Failed to send refreshmemory API request. Error: "+L.toString(),10)})})}}H3l(){this.vjn();this.eAo()}vjn(){bP().then(b=>{if(""!==b){const h=this.Z.Wa("Common.App.Insights.SmartLookupVersion");h&&h.l7o(b)}this.T3d();this.y6b=this.Z.resolve("Common.App.Insights.InsightsActor");b=cP(b);b=mb.a.create(b);b.L0((h,r)=>{r.succeeded?this.k8o()&&this.prefetchZeroTerm():rl.gD("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.OH,10);this.y6b.mc()});
Va.a.UY(b)})}k8o(){const b=Object.assign(new YN,{channelId:Th.channelId,approvedOriginPattern:CM()?"^(http)?://(localhost:8080)$":y.AFrameworkApplication.J.rb("SmartLookupApprovedOriginPattern")});var h=this.Z.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.Z.resolve("Common.App.SearchCommon.ISerpletExecutor"),A=this.Z.resolve("Common.App.SearchCommon.IInsertContentExecutor"),L=new Cb.a;h&&L.add(h);r&&L.add(r);A&&L.add(A);h=VN();try{const ba=new WN,ra=SmartLookupHostRuntime.setup(b,
L.toArray(),!0,h,ba);this.Z.register(AE,"Common.App.SearchCommon.SearchHostRuntime").ha().fe(()=>new AE(ra));return!0}catch(ba){return rl.gD("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ba,10),!1}}prefetchZeroTerm(){if(y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Xa.a.instance.Wa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.Z.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.Z.resolve("Common.App.SearchCommon.IDocumentHelper");h.eRf(null,r,0,99).then(A=>{b.DNf().prefetchZeroTerm(A,y.AFrameworkApplication.userSessionId,tC(),!0,"Indoc",null)})}else rl.gD("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}T3d(){var b=this.Z.resolve("Common.App.SearchCommon.ISearchHelper");const h=DM(b.v7c());b=b.v7c();b=OA()+(""!==b?b:Th.jtd)+"/scripts/microsoft.office.smartlookup.ssr.js";
const r=UN();X.a.bia?this.G3l(h,b):(this.D3l(h,r),this.E3l(b,r))}D3l(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);const L=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&rl.iBg(h,b,(new Date).getTime()-L);this.Z.Wa("Common.App.Insights.SmartLookupVersion")})}catch(ba){rl.gD("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ba.toString(),10)}}E3l(b,h){var r=new Sys.Net.WebRequest;
r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);let L=-1;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),vb.TaskManager.instance.pc(new Md.a(5,1,r,()=>{const ba=mb.a.create(b);ba.ijf(()=>{L=Date.now()});ba.L0((ra,Ia)=>{Ia.succeeded?""!==h&&rl.iBg(h,b,Date.now()-L):rl.gD("InsightsPackage - Failed to prefetch JS file.",
10)});Va.a.UY(ba)}));else{L=Date.now();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&rl.iBg(h,b,Date.now()-L)})}catch(ba){rl.gD("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ba.toString(),10)}}}G3l(b,h){if(X.a.bia){var r=y.AFrameworkApplication.pe;b=new wG.a(b,1,null,null,!0,2,null);r.send(b).cxa(A=>{A&&A.data?A.data.responseData?this.Z.Wa("Common.App.Insights.SmartLookupVersion"):rl.gD("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.Xe,10):rl.gD("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?rl.gD("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+A.data.Xe,10):rl.gD("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});y.AFrameworkApplication.J.$("SmartLookupPrefetchJSIsEnabled")&&(h=new wG.a(h,1,null,null,!0,2,null),r.send(h).cxa(A=>{A&&A.data?A.data.responseData||rl.gD("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.Xe,10):rl.gD("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?rl.gD("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+A.data.Xe,10):rl.gD("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.y6b&&this.y6b.dispose()}}Object(u.a)(vJ,"InsightsPackage",null,[0,1]);var ZN=e(1548);class $N{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(u.a)($N,"DocumentContentParams",null,[]);var IG=e(1903),QO=e(963),Mv;(function(b){b.U3a="SearchProvider";b.QVg="TextSummarization"})(Mv||(Mv={}));Object(u.b)("WorkflowType",Mv);var xz;(function(b){b.Success="Success";b.lmk="Invoked";b.Error="Error"})(xz||(xz={}));Object(u.b)("LogType",xz);var uC;(function(b){b.qjk="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.jmk="InvalidAnnotation";b.ipk="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(uC||(uC={}));Object(u.b)("ErrorReason",uC);class aO{constructor(b){this.xmi=b;this.yig=this.yig.bind(this)}async submitDocumentContentExtractionSignal(){try{this.KUo=Date.now();this.tAb=qb.a.create().toString();this.log({MU:Mv.U3a,logType:xz.lmk,success:!0,correlationId:this.tAb});var b=fx().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new ss.m({parentPath:["Signal",IG.SearchProviderSignal.getTypeName()],
items:[{id:"SearchProvider",body:new IG.SearchProviderSignal({correlationId:this.tAb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.aQj=window.setTimeout(()=>{this.onError(Mv.U3a,xz.Error,uC.Timeout)},1500)}catch(h){window.clearTimeout(this.aQj),this.onError(Mv.U3a,xz.Error,uC.Other,this.dym(h))}}async generateDocumentSummaryDetails(){return null}async generateDocumentSummary(){return null}static get I4f(){return!1}async activateAnnotation(){if(!this.Mpc){await eq.a.Km();
var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation;b=[b(Object.assign(new QO.a,{annotationType:IG.SearchProviderAnnotation.getTypeName(),handler:this.yig}))];await Promise.all(b);this.Mpc=!0}}yig(b){if(this.Ivn(b)&&(b=b.items[0],IG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.aQj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.tAb)this.log({MU:Mv.U3a,logType:xz.Error,errorReason:uC.qjk,success:!1,
correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.tAb!==b.correlationId)this.log({MU:Mv.U3a,logType:xz.Error,errorReason:uC.ipk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.Vdi(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({MU:Mv.U3a,
logType:xz.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.tAb=void 0;this.xmi.sTj(h)}else this.onError(Mv.U3a,xz.Error,uC.jmk)}Ivn(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){var h=0;switch(b.MU){case Mv.U3a:h=this.KUo;break;case Mv.QVg:break;default:h=-1}const r=Date.now(),A=h?r-h:-1;h=[Object.assign(new ma.a,{name:"WorkflowType",string:b.MU}),Object.assign(new ma.a,{name:"LogType",string:b.logType}),Object.assign(new ma.a,
{name:"ErrorReason",string:b.errorReason}),Object.assign(new ma.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ma.a,{name:"Message",string:b.message}),Object.assign(new ma.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ma.a,{name:"StartTime",int64:h}),Object.assign(new ma.a,{name:"EndTime",int64:r}),Object.assign(new ma.a,{name:"Duration",int64:A})];Object($d.a)("AugloopSearchProviderData",b.success,A,h)}dym(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}Vdi(b=
"",h="",r=""){return Object.assign(new $N,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,A){h={MU:b,logType:h,success:!1,message:A,errorReason:r};switch(b){case Mv.U3a:if(!this.tAb)break;h.correlationId=this.tAb;this.log(h);this.tAb=void 0;this.kbm();break;case Mv.QVg:break;default:return null}}kbm(){this.xmi.sTj(this.Vdi())}}Object(u.a)(aO,"AugloopSearchProviderManager",null,[]);class ny{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=
!1}}Object(u.a)(ny,"DocumentContentSearchResults",null,[]);class FM{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,A,L){this.selectRange(h,r,A,L)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new ny,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new ny,{results:r,totalResultCount:r.length,hasTooManyResults:r.length>
b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(u.a)(FM,"BaseDocumentContentExecutor",null,[1842,217]);var GM=e(2156),bO=e(1360);class LL{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(u.a)(LL,"DocumentContentSearchParams",null,[]);class HM{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(u.a)(HM,"DocumentSelection",null,[]);class cO{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(u.a)(cO,"IAuthorProperties",null,[]);var BE=e(701);class IM{constructor(){this.A3c=this.ntf=0}}Object(u.a)(IM,"CommentFindResultIndexInfo",null,[]);const JM=b=>{b.Uc(Ee.a.Xk(b.ob.currentSelection,!0,!1))},ML=b=>{b=GM.a.Eae(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class dO{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(u.a)(dO,"DocumentContentSearchResult",null,[]);var eO=e(1858);class KM{constructor(){this.authorEmail=this.authorName=this.zRb=this.rtf=null}}Object(u.a)(KM,"CommentFindResults",null,[]);class fO{constructor(){this.end=this.Mc=0}}Object(u.a)(fO,"FindResultOffset",null,[]);class Or{constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob){this.wPe=this.ey=this.CVe=this.LE=null;this.KNh=0;this.uQ=null;this.JHc=new Cb.a;this.lhh=null;this.Bw=b;this.qb=h;this.fnb=r;this.nla=
L;this.w9b=ba;this.lGb=ra;this.Ri=Ia;this.ga=Ta;this.pb=ob}TBm(b,h){var r;const A=[];if(12!=b.type)return A;const L=pb.a.$xi(b);let ba=null,ra=-1;var Ia=Xl.a.auto;for(let ob=0;ob<=L.length;ob++){let nb=-1;var Ta=Xl.a.auto;ob<L.length&&(Ta=L[ob],nb=Ta.cp,Ta=null===(r=Ta.formatting)||void 0===r?void 0:r.cache,Ta=(null===Ta||void 0===Ta?0:Ta.hUb)?Ta.highlight:(null===Ta||void 0===Ta?0:Ta.OYa)?Ta.shading:Xl.a.auto);if(Ia!=Ta){if(Ia!=Xl.a.auto){ba||(ba=this.lGb.iYa(b.id));-1==nb&&(nb=ba.length);Ia=this.fnb.r1d(ba,
ra,nb,"");const Eb={};Eb.context=Ia.f0d;Eb.startOffsetInContext=Ia.Mye;Eb.endOffsetInContext=Ia.Kye-1;A.push({data:Eb,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ra,endOffsetInParagraph:nb-1})}ra=nb;Ia=Ta}}return A}get Aga(){return this.lhh}initialize(){this.LE=DD.a.createInstance(this,this.nla,RF.a.instance,!1,!0)}search(b,h){this.LE.b9a();this.I3f(b)?(this.ey=h,this.uQ=new Cb.a,b=this.Vwf(b),this.LE.find(b)):h(null)}searchV2(b,h){this.LE.b9a();if(this.I3f(b)){this.p3i()&&this.ga.Zb(wb.a.gBe,
2,{CommandValueId:b});this.wPe=h;this.KNh=b.totalResultLimit;this.uQ=new Cb.a;b=this.Vwf(b);this.lhh=new tj.a;this.LE.find(b);h=this.nla.ald(b.text);h=this.nla.VZb(h);b=this.w9b.gnc(h.join("|"),b);h=this.Ri.vT();for(let A=0;A<h.length;A++){const L=h[A],ba=ML(L);var r=this.lGb.WTb(ba,b);const ra=this.lGb.WTb(L.author,b);if(!r&&!ra){v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ba,!b);continue}r=ra&&0<ra.length?ra:r;let Ia="",Ta="";ra&&0<ra.length&&(Ia=L.author,
Ta=L.authorId);for(const ob of r)r=eO.a.createInstance(ob.Mc,ob.end,V.a.Of(L.objectId),A,32,!1),this.JHc.add(r),this.Aga.Bb(A)||this.Aga.add(A,Object.assign(new KM,{rtf:ba,zRb:[],authorName:Ia,authorEmail:Ta}))}}else h(null)}get Kti(){null==this.CVe&&(this.CVe=DD.a.createInstance(this,this.nla,RF.a.instance));return this.CVe}p3i(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}Jqc(){var b;
return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.I3f(b);b=h?this.Vwf(b):null;var r={};this.p3i()&&this.ga.Zb(Lc.a.Ksg,2,r);if(r[bg.a.On]){if(h){h={};r={};var A={};this.ga.Zb(Lc.a.gve,2,h);this.ga.Zb(wb.a.fve,2,r);this.ga.Zb(wb.a.hve,2,A);if(b.text!=h.CommandValueId||b.matchCase!=r[bg.a.On]||b.matchWholeWord!=A[bg.a.On])JM(this.pb),this.ga.Zb(wb.a.Pkc,2,{CommandValueId:b.text,
MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.Kti,r.b9a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.Kti;return 0<h.il.lqa?(b?h.dQi():h.iQi(),h.il.jhf-1):-1}Vwf(b){let h=Tw.a.none;b.matchCase&&(h|=Tw.a.matchCase);b.matchWholeWordOnly&&(h|=Tw.a.rSg);return ED.a.createQuery(b.query,h)}I3f(b){return b&&!!b.query&&0<b.query.length}WBe(){}uAe(){}reset(){}MGf(){}Nkc(){if(this.ey){var b=this.Wdi(this.uQ);this.ey(b)}if(this.wPe){b=new ny;const h=this.uQ.count+this.JHc.count>
this.KNh;b.totalResultCount=this.uQ.count+this.JHc.count;b.hasTooManyResults=h;h||(this.uQ.PC(this.uQ.count,this.JHc),b.results=this.Wdi(this.uQ));this.wPe(b);this.JHc.clear()}}Wdi(b){var h;const r=[];var A=Object.assign(new BE.a,{T1:!1,gva:!0,oNa:this.Jqc(),U1:!0});A=this.qb.DMa(this.Bw.value,A);for(const ra of b){var L=ra.Mc;let Ia=ra.end;var ba=void 0;b=-1;let Ta=null,ob=0;if(32===ra.type){Ta=Or.qtf;ob=3;b=A.count+ra.TYa;const nb=({Mc:L,end:Ia}=ZN.a.YHj(this.Aga.K(ra.TYa).rtf,L,Ia)).returnValue;
ba=this.fnb.r1d(nb,L,Ia,FD.a(ra.type));this.Aga.K(ra.TYa).rtf=nb;this.Aga.K(ra.TYa).zRb.push(Object.assign(new fO,{Mc:L,end:Ia}))}else{if(2===ra.type||4===ra.type)ob=2===ra.type?1:2,Ta=Or.$Vf;if(8===ra.type||16===ra.type)ob=8===ra.type?6:5,Ta=Or.dgg;for(ba=0;ba<A.count;ba++)if(A.K(ba).id===ra.nodeId){b=ba;break}ba=this.fnb.s1d(ra)}L=(null===(h=this.Aga)||void 0===h?0:h.Bb(ra.TYa))?this.Aga.K(ra.TYa):null;if(0<=b||(null===L||void 0===L?0:L.authorName))b=Object.assign(new dO,{snippet:ba.f0d,subdocumentId:Ta,
subdocumentType:ob,startOffsetInSnippet:ba.Mye,endOffsetInSnippet:ba.Kye-1,paragraphIndex:b,startOffsetInParagraph:ra.Mc-ba.Mye,endOffsetInParagraph:ra.end-ba.Kye-1,authorName:L?L.authorName:"",authorEmail:L?L.authorEmail:""}),r.push(b)}r.sort((ra,Ia)=>ra.paragraphIndex===Ia.paragraphIndex?ra.startOffsetInParagraph-Ia.startOffsetInParagraph:ra.paragraphIndex-Ia.paragraphIndex);return r}update(){}DXa(b,h){switch(b){case 0:h&&0<h.length&&!this.uQ&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.uQ=new Cb.a);for(const r of h)this.uQ.add(r)}}XAb(){}dispose(){}}Or.qtf="Comment";Or.$Vf="HeaderFooter";Or.dgg="Note";Or.pVi="Image";Object(u.a)(Or,"WordDocumentSearchProcessor",null,[218,11,219]);class gO extends FM{Jqc(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,A,L,ba,ra,Ia,Ta,ob,nb,Eb,bc){super();this.tJa=null;this.FW=(Bc,Yc)=>{Bc=Yc.node;Yc=Yc.property;
this.DFg(Bc)&&Yc===Sb.a.so&&this.aUb(Bc,3)};this.ZOa=(Bc,Yc)=>{Bc=Yc.node;!Yc.hhe&&this.DFg(Bc)&&this.aUb(Bc,1)};this.Hid=(Bc,Yc)=>{Bc=Yc.node;this.DFg(Bc)&&this.aUb(Bc,2)};this.Bw=b;this.qb=h;this.zd=r;this.pb=A;this.rI=L;this.Wm=Ia;this.oc=Ta;this.wba=ba;this.jV=ra;this.Ri=ob;this.TFk=nb;this.UHh=V.a.create();this.mxe(this.FW,this.ZOa,this.Hid);bc&&bc.execute(Bc=>this.asa=Bc);Eb.execute(Bc=>{this.r7a=Bc})}submitDocumentContentExtractionSignal(){this.r7a&&this.r7a.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.r7a?
this.r7a.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.r7a?this.r7a.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.uN(this.aLm());for(const r of this.Ri.vT()){var h=GM.a.Eae(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new BE.a,{T1:!1,gva:!1,U1:!0}),r=this.qb.DMa(this.Bw.value,h);h=[];const A=[];for(var L=0;L<r.count;++L){var ba=
r.K(L);h.push(...this.RCm(ba,L));A.push(...this.wba.TBm(ba,L))}r=[];L=this.Ri.vT();for(ba=0;ba<L.length;ba++)r.push(this.Ssm(L[ba]));L={};L.images=h;L.comments=r;L.highlights=A;b(L)}selectRange(b,h,r,A,L){const ba=Date.now(),ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.h2a();if(0>b||0>h||0>r||0>A||b>r||b===r&&h>A)throw Error("Provided select range offsets incorrect");const Bc=Object.assign(new BE.a,{T1:!1,gva:!0,oNa:this.Jqc(),U1:!0}),Yc=
this.qb.DMa(this.Bw.value,Bc);if(r>=Yc.count){const zd=Xa.a.instance.resolve("Common.Comments.ICommentModel").vT(),Jd=r-Yc.count;if(Jd<zd.length){L=-1;if(this.wba.Aga.Bb(Jd)){const re=this.wba.Aga.K(Jd).zRb;for(var Ia=0;Ia<re.length;Ia++)if(re[Ia].Mc===h){L=Ia;break}}this.tJa=-1!==L?Object.assign(new IM,{ntf:Jd,A3c:L}):null;const ie=zd[Jd];y.AFrameworkApplication.va.Vb(Lc.a.PY,2);y.AFrameworkApplication.va.Zb(Lc.a.C8,2,null);y.AFrameworkApplication.va.Zb(Lc.a.selectComment,2,Object.assign(new bO.a,
{commentId:ie.id,gea:2,i6:!1}))}}else{this.tJa=null;var Ta=Yc.K(b),ob=Yc.K(r);if(!this.Xje(Ta,h)||!this.Xje(ob,A))throw Error("Provided select range offsets incorrect");y.AFrameworkApplication.va.Vb(Lc.a.PY,2);this.Gtp(Ta);var nb=this.rI.Ie(Ta,h);Ia=this.rI.SA(nb,vc.a.jd(ob,A+1));if(L){const zd=Ia.toArray();h=[];for(const Jd of zd)h.push(this.rae(Jd.node));h.join(" ").includes(L)||(ra.success=!1,ra.message="The text in clicked passage does not match the selected hit")}var Eb=this.Wm.value.py,bc=this.pb.ob.currentSelection;
bc&&bc.equals(Ia)&&this.zd.xja(Eb,null);this.zd.xja(Eb,Ia);ra.duration=Date.now()-ba;this.logMessage(ra)}}catch(Bc){ra.success=!1,ra.message=Bc.stack,ra.duration=Date.now()-ba,this.logMessage(ra)}}search(b,h){this.h2a();this.wba.search(Object.assign(new LL,{query:b}),h)}searchV2(b,h){this.h2a();this.wba.searchV2(Object.assign(new LL,{query:b}),h)}selectNextPrevHighlight(b){this.h2a();return this.wba.selectNextPrevHighlight(b)}searchWithParam(b,h){this.h2a();this.wba.search(b,h)}searchWithParamV2(b,
h){this.h2a();this.wba.searchV2(b,h)}highlight(b){this.h2a();this.wba.highlight(Object.assign(new LL,{query:b}))}highlightWithParam(b){this.h2a();this.wba.highlight(b)}getRevision(){return this.UHh.toString()}getSelectedText(){const b=this.TFk.getSelectedText();return Object.assign(new Lv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new BE.a,{T1:!1,gva:!0,oNa:this.Jqc(),U1:!0}),h=({Ju:ba}=this.OQm(b)).returnValue;
if(h)return h;var r=this.pb.ob.currentSelection;if(!r||!r.length)return null;h=r.Ya;r=r.hd;let A=-1,L=-1;var ba=ba||this.qb.DMa(this.Bw.value,b);b=null;for(let ra=0;ra<ba.count;ra++){const Ia=ba.K(ra);-1===A&&h.node.id===Ia.id&&(A=ra,b=Ia);-1===L&&r.node.id===Ia.id&&(L=ra)}ba=null;5===(null===b||void 0===b?void 0:b.$ta)&&(ba=Or.$Vf);if(1===(null===b||void 0===b?void 0:b.$ta)||2===(null===b||void 0===b?void 0:b.$ta))ba=Or.dgg;return Object.assign(new HM,{subdocumentId:ba,startParagraphIndex:A,startParagraphOffset:h.Uj,
endParagraphIndex:L,endParagraphOffset:r.Yp})}clearDocumentSelection(){JM(this.pb)}selectRangeV2(b,h,r,A,L,ba){const ra=Date.now(),Ia={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.h2a();if(0>h||0>r||0>A||0>L||h>A||h===A&&r>L)throw Error("Provided select range offsets incorrect");var Ta=Object.assign(new BE.a,{T1:!1,gva:!0,oNa:this.Jqc(),U1:!0});const bc=this.qb.DMa(this.Bw.value,Ta);if(b==Or.qtf)this.pQj(r,A,bc.count);else{Ta=this.tJa=null;var ob=
{};ob.subdocumentId=b;ob.startParagraphIndex=h;ob.startParagraphOffset=r;ob.endParagraphIndex=A;ob.endParagraphOffset=L;Ta=b==Or.pVi?this.VEi(bc.K(h),{isFloatingImage:!1,imageId:"",...ob}):this.PNi(bc.K(h),bc.K(A),{clickedPassage:ba,...ob},Ia);var nb=this.Wm.value.py,Eb=this.pb.ob.currentSelection;(null===Eb||void 0===Eb?0:Eb.equals(Ta))&&this.zd.xja(nb,null);this.zd.xja(nb,Ta)}Ia.duration=Date.now()-ra;this.logMessage(Ia)}catch(bc){Ia.success=!1,Ia.message=bc.stack,Ia.duration=Date.now()-ra,this.logMessage(Ia)}}selectRangeV3(b){const h=
Date.now(),r={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.h2a();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var A=Object.assign(new BE.a,{T1:!1,gva:!0,oNa:this.Jqc(),U1:!0});const ra=this.qb.DMa(this.Bw.value,
A);if(b.subdocumentId==Or.qtf)this.pQj(b.startParagraphOffset,b.endParagraphIndex,ra.count);else{A=this.tJa=null;A=b.subdocumentId==Or.pVi?this.VEi(ra.K(b.startParagraphIndex),b):this.PNi(ra.K(b.startParagraphIndex),ra.K(b.endParagraphIndex),b,r);var L=this.Wm.value.py,ba=this.pb.ob.currentSelection;(null===ba||void 0===ba?0:ba.equals(A))&&this.zd.xja(L,null);this.zd.xja(L,A)}r.duration=Date.now()-h;this.logMessage(r)}catch(ra){r.success=!1,r.message=ra.stack,r.duration=Date.now()-h,this.logMessage(r)}}aLm(){const b=
Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},r=Object.assign(new BE.a,{T1:!1,gva:!1,U1:!0});h.duration=Date.now()-b;this.logMessage(h);return this.qb.DMa(this.Bw.value,r)}uN(b){const h=Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},A=new Cb.a;for(const L of b)A.add(this.rae(L));r.duration=Date.now()-h;this.logMessage(r);return A}VEi(b,h){if(h.isFloatingImage)return h=V.a.Of(h.imageId),b=b.ed.Mb(h),b=Tb.SelectionFactory.ot(b);
const r=this.rI.Ie(b,h.startParagraphOffset);return b=this.rI.SA(r,vc.a.jd(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new ph.a(b,"O365",h,b);if(!this.asa||!this.asa.getPersonaIconPropertiesArray)return null;b=await this.asa.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new cO,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}PNi(b,h,r,A){if(!this.Xje(b,r.startParagraphOffset)||!this.Xje(h,
r.endParagraphOffset))throw Error("Provided select range offsets incorrect");r.subdocumentId==Or.$Vf?y.AFrameworkApplication.va.Zb(Lc.a.Xwb,2,new rB.a(b)):y.AFrameworkApplication.va.Vb(Lc.a.PY,2);r.subdocumentId==Or.dgg?32===y.AFrameworkApplication.va.Zb(Lc.a.Aeb,2,new rB.a(b))&&y.AFrameworkApplication.va.Vb(Lc.a.y7d,2):y.AFrameworkApplication.va.Zb(Lc.a.C8,2,null);b=this.rI.Ie(b,r.startParagraphOffset);h=this.rI.SA(b,vc.a.jd(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const L=[];
for(const ba of b)L.push(this.rae(ba.node));L.join(" ").includes(r.clickedPassage)||(A.success=!1,A.message="The text in clicked passage does not match the selected hit")}return h}pQj(b,h,r){const A=Xa.a.instance.resolve("Common.Comments.ICommentModel").vT();h-=r;if(h<A.length){r=-1;if(this.wba.Aga.Bb(h)){const L=this.wba.Aga.K(h).zRb;for(let ba=0;ba<L.length;ba++)if(L[ba].Mc===b){r=ba;break}}this.tJa=-1!==r?Object.assign(new IM,{ntf:h,A3c:r}):null;b=A[h];y.AFrameworkApplication.va.Vb(Lc.a.PY,2);
y.AFrameworkApplication.va.Zb(Lc.a.C8,2,null);y.AFrameworkApplication.va.Zb(Lc.a.selectComment,2,Object.assign(new bO.a,{commentId:b.id,gea:2,i6:!1}))}}h2a(){this.oc&&(this.oc.currentScope&&this.oc.currentScope.name===Th.CF||this.oc.Rg(Th.CF))}uHp(){this.UHh=V.a.create()}rae(b){if(b.EVb)return"";b=this.qb.text(b);return wm.AParagraphNode.DR(b," ")}Xje(b,h){b=this.rae(b);return h<b.length}aUb(b,h){switch(h){case 1:case 2:case 3:this.uHp()}}logMessage(b){const h=[Object.assign(new ma.a,{name:"Message",
string:b.message})];Object($d.a)(b.activityName,b.success,b.duration,h)}DFg(b){return!b.EVb&&this.fcd(b)}fcd(b){const h=this.Bw.value;return!!h&&!!h.Hd&&!!b.ed&&b.ed.id.equals(h.Hd.id)}Gtp(b){this.qb.Aqc(b)?32===y.AFrameworkApplication.va.Zb(Lc.a.Aeb,2,new rB.a(b))&&y.AFrameworkApplication.va.Vb(Lc.a.y7d,2):y.AFrameworkApplication.va.Zb(Lc.a.C8,2,null)}mxe(b,h,r){this.jV&&(this.jV.yq(b),this.jV.wv(h),this.jV.bA(r))}OQm(b){let h=null;if(!this.Ri.Nv||!this.tJa)return{returnValue:null,Ju:h};const r=
Array.indexOf(this.Ri.vT(),this.Ri.Nv);if(0>r)return{returnValue:null,Ju:h};h=this.qb.DMa(this.Bw.value,b);var A=GM.a.Eae(this.Ri.Nv.text[0]).split("\n");b=0;A=(1===A.length?A[0]:A.join(" ")).length-1;this.tJa&&r===this.tJa.ntf&&this.wba.Aga.Bb(r)&&this.wba.Aga.K(r).zRb.length>this.tJa.A3c&&(b=this.wba.Aga.K(r).zRb[this.tJa.A3c].Mc,A=this.wba.Aga.K(r).zRb[this.tJa.A3c].end);return{returnValue:Object.assign(new HM,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:A,
subdocumentId:"Comment"}),Ju:h}}RCm(b,h){const r=[];if(12!=b.type)return r;r.push(...this.oDm(b,h));r.push(...this.Qzm(b,h));return r}Qzm(b,h){const r=[],A=te.a.kb(b);if(!A.hasChildren())return r;let L=A.ue();for(;L;){if(!this.CZa(L)){L=A.px();continue}const ba=L.properties;ba&&pe.a.Bbd(ba)&&r.push(this.b8j(ba,h,0,b.ed,!0,L.id.toString()));L=A.px()}return r}CZa(b){if(19!==b.type||5!==pe.a.pl(b))return!1;b=te.a.kb(b);if(!b.hasChildren())return!0;let h=b.ue();for(;h;){if(59===h.type)return!1;h=b.px()}return!0}oDm(b,
h){const r=[],A=b.ed;if(A){if(!b.hasProperty(Sb.a.Qq))return r;var L=b.ka(Sb.a.Qq,null);if(!L)return r;b=b.ka(Sb.a.sw,null);for(let ra=0;ra<L.length;++ra){var ba=L[ra];if(!ba)continue;ba=A.Mb(ba);if(!ba||!pe.a.Bbd(ba)||5!==pe.a.pl(ba))continue;let Ia=0;0!=ra&&b&&ra-1<b.length&&(Ia=b[ra-1]);r.push(this.b8j(ba,h,Ia,A,!1,""))}return r}}b8j(b,h,r,A,L,ba){A=(new Sys.Net.WebRequest).getResolvedUrl()+pe.a.GJm(b,A);const ra=b.ka(Pd.a.Iw,""),Ia={};Ia.base64Encoding=ra;Ia.url=A;Ia.width=pe.a.uH(b);Ia.height=
pe.a.pN(b);Ia.altText=pe.a.z1(b);Ia.description=pe.a.nYa(b);Ia.imageId=ba;Ia.isFloatingImage=L;return{data:Ia,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}Ssm(b){return{data:{comment:ML(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(u.a)(gO,"WordDocumentContentExecutor",FM,[]);class wJ{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}
Object(u.a)(wJ,"BaseDocumentHelper",null,[256]);class LM extends wJ{constructor(b){super();this.Dkm=b}get xjc(){const b=this.Dkm.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Db.StaticActiveAppFrame.Aa().tb.isEditingAllowed}author(){var b;return null===(b=this.xjc)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.xjc)||void 0===b?void 0:b.creationDate}}Object(u.a)(LM,"WordDocumentHelper",wJ,[]);class MM{constructor(b){this.vgj=b}insertOnlinePicture(){}insertHtmlText(b){b&&
this.dZf(b.htmlText)}getId(){return"InsertContentExecutor"}dZf(b){return this.executeCommand(fb.a.$sa,b)}executeCommand(b,h){const r=new Ai.DictionaryPropertySet;r.setValue(Pd.a.PZ,h);r.setValue(Pd.a.aQa,!1);h=this.vgj.Vb(b,1);32===h&&(h=this.vgj.Zb(b,2,r));return h}}Object(u.a)(MM,"WordInsertContentExecutor",null,[216,217]);var hO=e(1716),dP=e(1717);class vC{constructor(b,h,r,A,L){this.yIc="undefined";this.WEg="Something went wrong with retrieving a summary. Please try again.";this.Nkn=(ba,ra,Ia,
Ta,ob)=>gu.W1(ba,ra,Ia,Ta,this.RF,ob);this.WCe=(ba,ra,Ia,Ta,ob)=>{if(1===Ia)return this.YGk?32:8;ba=jx.getSelectedText();ba=String.format(WacWordeditorStrings.ContextMenuDictionarySmartLookupWithQuery,jx.Uae(ba));ob[vk.a.LabelText]=ba;return 32};this.uJf=(ba,ra,Ia)=>{if(1===Ia)return 32;const Ta={};this.r7a?this.r7a.generateDocumentSummary().then(ob=>{ob||(ob=this.WEg,v.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));Ta.additionalData=this.Dvf(ob);this.ga.Zb(wb.a.wca,
2,Ta)}).catch(()=>{v.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");Ta.additionalData=this.Dvf(this.WEg);this.ga.Zb(wb.a.wca,2,Ta)}):(v.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),Ta.additionalData=this.Dvf(this.WEg),this.ga.Zb(wb.a.wca,2,Ta));return 32};this.Avp=(ba,ra,Ia)=>{if(!this.nhj)return v.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ia)return this.ZAn()?
32:2;if(2===Ia)this.nhj.Vbe(this.za.rb("SmartLookupShredderServiceEndpoint")).then(Ta=>{Ta={token:Ta,files:H.c(this.Mym()),type:"MultiFilesDeckGeneration"};Ta=Object.assign(new hO.a,{selection:Object.assign(new Lv.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new it.a,{landingTab:"All",data:Ta}),entryPoint:38});this.ga.Zb(wb.a.Uca,2,Ta);return 32}).catch(()=>{v.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});
else return 32};this.RF=b;this.ga=h||y.AFrameworkApplication.va;this.za=r;this.DGk=(this.qB=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.z9)&&!!this.za&&this.za.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.YGk=!!this.za&&this.za.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);A&&A.execute(ba=>{this.r7a=ba});this.nhj=L}mc(){this.ga.nb(Lc.a.G_h,dd.a.frame,this.Nkn,1028);this.ga.nb(Lc.a.WCe,dd.a.frame,this.WCe,1028);this.ga.nb(Lc.a.fxi,
dd.a.frame,this.uJf,1028);this.ga.nb(Lc.a.c8j,dd.a.frame,this.Avp,1028);this.DGk&&(this.yIc=Db.StaticActiveAppFrame.Aa().ES.getWindowMode(),this.spi(this.yIc),Db.StaticActiveAppFrame.Aa().ES.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.yIc&&(this.yIc=h,this.spi(this.yIc))}))}ZAn(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",
!1)}spi(b){"DP"===b&&Tk.UISurfaces.aw().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Zb(Lc.a.G_h,2,{SourceControlId:"smartlookupAuto"});return null})}Dvf(b){return{["documentSummary"]:b}}Mym(){const b=new dP.a("docx",y.AFrameworkApplication.J.rb("EditDocInClientUrl"),y.AFrameworkApplication.J.rb("BreadcrumbBrandUrl"),"",y.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(u.a)(vC,"WordInsightsActor",null,[]);class JG{constructor(){this.gCd=
this.$U=null}Sab(){return this.MSb()}wFi(){return this.MSb()}uFi(){return null}Mep(b,h,r){this.$U||(this.$U=this.c1d());this.$U.sU(b,h,r)}Nep(b,h,r){this.$U||(this.$U=this.c1d());this.$U.fHg(b,h,r)}Zcp(b,h){this.gCd||(this.gCd=null);this.gCd&&this.gCd.fHg(b,h)}R1b(b,h){this.$U||(this.$U=this.c1d());this.$U.R1b(b,h)}Hke(b){this.$U||(this.$U=this.c1d());this.$U.Hke(b)}TWo(){this.$U&&this.$U.pzc()}G0o(){this.$U&&this.$U.TAe()}icp(){var b=y.AFrameworkApplication.J.sc("SmartLookupLaunchThrottleThresholdInMilliseconds",
1500);b=window.performance.now()-JG.gaj<=b;b||(JG.gaj=window.performance.now());return b}dispose(){this.$U&&(this.$U.dispose(),this.$U=null)}get fWb(){return this.$U?this.$U.isVisible:!1}}JG.gaj=0;Object(u.a)(JG,"InsightsManager",null,[1940,11]);class KG{constructor(b,h,r,A,L,ba=!0,ra=null,Ia=null){this.iaa=this.qI=this.DTa=null;this.UMc=!1;this.Pka=null;this.oc=h;this.P$b=ba;this.Ikh=Ia?Ia:new wJ;this.Rw=ra;this.hr=b;this.P$b&&(Xa.a.instance.Wa("Common.App.SearchCommon.SearchHostRuntime")&&(this.Pka=
Xa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").DNf()),this.gnb=Xa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.aMb=this.gnb.v7c())}yyb(b){if(this.P$b){b=b.rawEvent;try{var h=H.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,15,this.YY("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.qI&&(b=this.qI.entryPoint);this.gnb.eRf(this.iaa,this.Ikh,this.Fnc(),b).then(r=>{h.data=r;this.jzb(h)});break;
case 118:h.data=this.qI?this.qI:Object.assign(new Ns.a,{selection:Object.assign(new Lv.a,{neighborhood:this.DTa.neighborhood,mentionStart:this.DTa.mentionStart,mentionLength:this.DTa.mentionLength})});this.jzb(h);break;case 103:b=H.a(Object(ya.a)(String,h.data));rl.sendTelemetryEvent(b);break;case 206:this.gnb.Vbe(h.data).then(r=>{h.data=r;this.jzb(h)});break;case 112:h.data.shiftPressed?(X.a.Hj&&document.activeElement.blur(),this.hr.Lce(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.YY("Serplet UX lost focus through Ctrl + Shift + F6"))):
(this.hr.u8c(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,50,this.YY("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.$ua()}}}hqd(b){if(this.Pka){var h=0;this.qI&&(h=this.qI.entryPoint);this.gnb.eRf(this.iaa,this.Ikh,this.Fnc(),h).then(r=>{rl.sRj("SearchFromHost",this.iaa);this.qI.launchData||(this.qI.launchData=new it.a);const A=tC();try{this.Pka.search(this.qI,r,y.AFrameworkApplication.userSessionId,A,b),this.gnb.jio(L=>{rl.sRj("SearchFromHostWithToken",this.iaa);this.Pka.searchAuthenticatedProviders(this.qI,
r,y.AFrameworkApplication.userSessionId,A,null,L)})}catch(L){rl.gD("BaseSmartLookupPane - Fail to search from host. Error: "+L,10)}}).catch(r=>{rl.gD("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}qzc(b){if(this.P$b){var h=rl,r=h.qzc,A=this.iaa;b=Math.round(window.performance.now()-b);var L=this.qI?tJ[this.qI.entryPoint]:"",ba=this.gnb.v7c(),ra=this.gnb.Dym(),Ia=this.qI?this.qI.entryPoint:0;r.call(h,A,b,L,ba,ra,y.AFrameworkApplication.Kkf,
this.UMc,18===Ia||19===Ia||15===Ia)}}}Object(u.a)(KG,"BaseSmartLookupPane",null,[254,11]);class LG{constructor(b){this.messageType=null;this.messageType=b}}Object(u.a)(LG,"InsightsMessage",null,[]);class MG extends LG{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(u.a)(MG,"InsightsMessageWithContent",LG,[]);class iO extends MG{constructor(b){super(Th.kUn,b)}}Object(u.a)(iO,"InsightsMessageAppProperties",MG,[]);class jO extends MG{constructor(b){super(Th.vUn,b)}}Object(u.a)(jO,
"InsightsMessageSelection",MG,[]);class NM extends LG{constructor(){super(Th.xUn)}}Object(u.a)(NM,"InsightsMessageTakeFocus",LG,[]);class xJ extends KG{constructor(b,h,r,A,L=null,ba=null,ra=null,Ia=!0,Ta=null,ob=null){super(h,r,L,ba,ra,Ia,Ta,ob);this.fBd=this.NE=this.pk=null;this.iMd=!1;this.k6n=nb=>{nb===this.pk&&this.$ua()};this.mvc=()=>{v.ULS.sendTraceTag(6295951,1303,50,this.YY("The iframe is successfully loaded in Insights task pane"))};this.xyb=()=>{v.ULS.sendTraceTag(6295952,1303,15,this.YY("The iframe failed to load in Insights task pane"))};
this.bHd=b;this.ALc=this.P$b?DM(this.aMb):y.AFrameworkApplication.Pin;this.CY();this.Eug();this.Tq=A;this.tjh=0}get isVisible(){return!1}CY(){this.pk=this.bHd.N_c();y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb.mwb&&this.pk.hDo(b=>{b===this.pk&&(this.TAe(),this.pzc())});this.BYf(this.pk.L2a.r0h);this.pk.qo()}BYf(b){b.style.overflow="hidden";const h=Sg.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.NE=h;b.appendChild(this.NE);
this.NE.id=Th.$Wf}Eug(){Re.a.addHandler(this.NE,"load",this.mvc);Re.a.addHandler(this.NE,"error",this.xyb);$addHandler(window,"message",Object(E.a)(this,this.yyb,"onIFrameMessage"))}IOg(){Re.a.removeHandler(this.NE,"load",this.mvc);Re.a.removeHandler(this.NE,"error",this.xyb);$removeHandler(window,"message",Object(E.a)(this,this.yyb,"onIFrameMessage"))}dispose(){this.NE&&(this.IOg(),this.NE.parentNode.removeChild(this.NE),this.NE=null);this.pk&&(this.bHd.pjc(this.pk),this.pk=null)}sU(b,h,r){this.iaa=
h;this.fBd=null;this.tjh=r;this.UMc=!b.mentionLength;this.iMd=!1;v.ULS.sendTraceTag(6295947,1303,50,this.YY("Start to show Insights"));this.DTa=b;this.ALc&&this.ALc.length?this.NE.src=this.ALc:(this.NE.src=xJ.unj,v.ULS.sendTraceTag(6295948,1303,15,this.YY("The Insights URL config setting is null or empty")));this.Tq.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.pk.g2||this.pk.Jug(this.k6n);this.P$b&&this.hqd(!1);b=window.performance.now();this.bHd.showTaskPane(this.pk);this.pk.qo();
this.qzc(b)}fHg(b,h,r){this.qI=b;this.sU(Object.assign(new sJ.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}R1b(){}Hke(){}pzc(){this.NE.src===this.ALc&&this.iMd&&(this.oc.Rg(Th.CF),this.jzb(new NM))}TAe(){this.NE&&Jc.FocusManager.LP(this.NE.contentWindow)}Myf(){this.NE.src=xJ.unj;this.pk.ro()}$ua(){this.bHd.hideTaskPane(this.pk);this.Myf()}yyb(b){const h=b.rawEvent;if(h.source===this.NE.contentWindow)if(this.P$b)super.yyb(b);
else{let r;try{r=H.a(h.data)}catch(A){v.ULS.sendTraceTag(6295953,1303,15,this.YY("Message data [{0}] failed to deserialize.",h.data));return}if(ef.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.YY("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Th.lUn:this.jzb(new iO(this.yDm()));break;case Th.wUn:this.jzb(new jO(this.DTa));break;case Th.rUn:this.iMd=!0;this.TAe();this.pzc();v.ULS.sendTraceTag(6295955,1303,50,this.YY("Insights pane rendering is completed"));
break;case Th.yUn:b=r.messageContent;this.fBd=b.clientCorrelationId;this.iaa!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.YY("App correlation ID on client {0} does not match one on server {1}",this.iaa,b.appCorrelationId));break;case Th.qUn:r.messageContent?(X.a.Hj&&document.activeElement.blur(),this.hr.Lce(0,null,2,null,null),v.ULS.sendTraceTag(6604741,1303,50,this.YY("Insights UX lost focus through Ctrl + Shift + F6"))):(this.hr.u8c(0,null,2,null,null),v.ULS.sendTraceTag(6604742,
1303,50,this.YY("Insights UX lost focus through Ctrl + F6")));break;case Th.nUn:r.messageContent.keyCode===pg.a.iib&&this.$ua();break;case Th.oUn:try{this.iMd=!1,localStorage.setItem(Th.dbj,"true")}catch(A){v.ULS.sendTraceTag(17961859,1303,10,this.YY("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}yDm(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.iaa;3===y.AFrameworkApplication.ta.Pb.gl?b.applicationName=Th.XRp:4===y.AFrameworkApplication.ta.Pb.gl&&(b.applicationName=
Th.Dbo);b.applicationVersion=y.AFrameworkApplication.buildVersion;var h=Wg.a.Vg(y.AFrameworkApplication.lcid);h=h?h.name:null;b.market=JL(h);b.uiLanguage=h;b.sessionId=y.AFrameworkApplication.userSessionId;b.parentalControl=Th.lng;b.clientType="user";b.legalAgreed=this.IEm();b.defaultDefineTab=1===this.tjh?"true":null;return b}YY(b,...h){const r={};this.iaa&&(r[Th.A5j]=this.iaa);this.fBd&&(r[Th.Lqp]=this.fBd);r[Th.B5j]=String.format.apply(null,[b].concat(h));return H.c(r)}Fnc(){return 5}IEm(){try{const b=
localStorage.getItem(Th.dbj);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,1303,10,this.YY("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}jzb(b){b=H.c(b);this.NE.contentWindow.postMessage(b,db.a.getOrigin(this.ALc))}}xJ.unj="about:blank";Object(u.a)(xJ,"InsightsPane",KG,[]);class kO{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(u.a)(kO,"SmartLookupTaskPaneProps",null,[]);class lO{}Object(u.a)(lO,"ActionDescriptor",null,[]);class RO extends KG{constructor(b,
h,r,A=null,L=null,ba=null,ra=!0,Ia=null,Ta=null){super(h,r,A,L,ba,ra,Ia,Ta);this.Xcf=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Pb&&y.AFrameworkApplication.ta.Pb.Z4f;this.Vw=this.W8e=!1;this.OKk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.MKk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.RKk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.QKk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.Cuj=()=>{if(this.Pka)this.Pka.onPaneThemeChanged(this.Fnc());return mh.a("getTheme")?appChrome.api.getTheme():null};this.xyb=()=>{rl.gD("ReactSmartLookupPane - Iframe component failed to load.",10)};this.mvc=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||rl.gD("ReactSmartLookupPane - Onload detected no network.",
50)};ra||rl.gD("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.bJa=b;this.rrh=DM(this.aMb)}get isVisible(){return this.Vw}R1b(b,h){this.qI=b;this.DTa=b=Object.assign(new sJ.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.UMc=!b.mentionLength;this.iaa=h;this.hqd(!1)}Hke(b){this.qI=b;this.SAc(Object.assign(new sJ.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength}),!1)}sU(b,h){this.iaa=h;this.SAc(b,!0)}fHg(b,h,r){this.qI=b;this.sU(Object.assign(new sJ.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}$ua(){this.qja();this.bJa.hideTaskPane()}SAc(b,h){id.SessionStatusManager.instance.WC&&this.Pka?(this.DTa=b,this.UMc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?y.AFrameworkApplication.J.$("SmartLookupDisableRefreshPaneIsEnabled")?
(this.bJa.updateTaskPane(null),h&&this.BXo()):(h&&this.hqd(!1),this.W8e=!this.W8e,this.bJa.updateTaskPane(this.AB())):(h&&this.hqd(this.isVisible),this.bJa.showTaskPane(this.AB())),this.qzc(b)):(this.bJa.showTaskPane(this.AB()),rl.VWo(id.SessionStatusManager.instance.WC,!!this.Pka,this.qI?tJ[this.qI.entryPoint]:"",this.gnb.v7c(),y.AFrameworkApplication.Kkf,this.UMc))}BXo(){if(!this.qI){const b=Object.assign(new Lv.a,{neighborhood:this.DTa.neighborhood,mentionStart:this.DTa.mentionStart,mentionLength:this.DTa.mentionLength});
this.qI=Object.assign(new Ns.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.hqd(this.isVisible)}hXo(){const b=new lO;b.transactionId=this.iaa;b.actionType=15;b.channelId=Th.channelId;this.jzb(b)}yyb(b){const h=b.rawEvent;document.getElementById(Th.CF)&&h.source!==document.getElementById(Th.CF).contentWindow||this.Nvo(b)}Nvo(b){const h=b.rawEvent;let r;try{r=H.b(h.data)}catch(A){v.ULS.sendTraceTag(545604257,1303,15,this.YY("Message data from Serplet [{0}] failed to deserialize.",
h.data));return}switch(r.actionType){case 32:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(eb.a.aub()>=this.OKk?this.bJa.updateTaskPane(this.mxf(this.MKk)):eb.a.aub()>=this.RKk&&this.bJa.updateTaskPane(this.mxf(this.QKk)));break;case 33:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.bJa.updateTaskPane(this.mxf(r.data));break;case 42:this.bJa.updateTaskPane(this.gRl(r.data));
break;case 43:this.bJa.updateTaskPane(this.AB());break;default:super.yyb(b)}}dispose(){}initialize(){this.CY();this.qea()}CY(){this.bJa.N_c()}qea(){const b=this.oc.te(Th.CF);b.parent=Df.AFrame.rr;b.LN=!0}N0o(){this.oc.Rg(Th.CF)}qja(){this.ddb()&&this.oc.Rg(this.oc.NY)}Eug(){$addHandler(window,"message",Object(E.a)(this,this.yyb,"onIFrameMessage"))}IOg(){$removeHandler(window,"message",Object(E.a)(this,this.yyb,"onIFrameMessage"))}ddb(){return!!this.oc.currentScope&&this.oc.currentScope.name===Th.CF}jzb(b){b=
H.c(b);document.getElementById(Th.CF)&&document.getElementById(Th.CF).contentWindow.postMessage(b,db.a.getOrigin(this.rrh))}YY(b,...h){const r={};this.iaa&&(r[Th.A5j]=this.iaa);r[Th.B5j]=String.format.apply(null,[b].concat(h));return H.c(r)}Fnc(){return mh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}pzc(){}TAe(){document.getElementById(Th.CF)&&Jc.FocusManager.LP(document.getElementById(Th.CF).contentWindow)}hxm(){return this.qI?10===this.qI.entryPoint?2===y.AFrameworkApplication.ta.Pb.gl?
CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.qI.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.qI.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.qI.entryPoint||38===this.qI.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}AB(){var b=CommonUIStrings.L_SmartLookupPaneTitle;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&
(b=this.hxm());const h=new kO;h.src=this.rrh;h.id=Th.CF;h.refreshPane=this.W8e;h.onError=this.xyb;h.onLoad=this.mvc;h.title=b;id.SessionStatusManager.instance.WC?this.Pka||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new fm.a,{title:b,hideHeader:!1,width:Th.width,location:Th.ofo,contentProps:h,isModernPane:!0,onOpen:()=>{this.N0o();this.Vw=!0;this.Eug();mh.a("registerOnThemeChangeCallback")&&
appChrome.api.registerOnThemeChangeCallback(this.Cuj);y.AFrameworkApplication.ta.Ne();if(this.Pka)this.Pka.onPaneStateChanged(!0)},onClose:()=>{this.hXo();this.qja();this.Vw=!1;this.IOg();mh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.Cuj);y.AFrameworkApplication.ta.Ne();if(this.Pka)this.Pka.onPaneStateChanged(!1)}});this.Xcf&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}gRl(b){const h=this.AB();h.title=b;h.contentProps.title=b;return h}mxf(b){const h=
this.AB();h.resizeWidth=b;return h}}Object(u.a)(RO,"ReactSmartLookupPane",KG,[]);class CE{N_c(){const b=new ge.a(Rl.a.Q8a,WacWordeditorStrings);return Iq.a.instance.hgi(Th.CF,Th.fwc,Th.width,Th.iLg,b)}showTaskPane(b){Iq.a.instance.showTaskPane(b)}hideTaskPane(b){Iq.a.instance.hideTaskPane(b)}pjc(b){Iq.a.instance.pjc(Th.CF,b)}}Object(u.a)(CE,"WordInsightsPaneHandler",null,[248]);class OM{N_c(){Iq.a.instance.iLa()}showTaskPane(b){Tk.UISurfaces.aw().then(h=>{h.showTaskPane(Th.CF,b);return null})}updateTaskPane(b=
null){Tk.UISurfaces.aw().then(h=>{h.setSelectedTaskPane(Th.CF);b&&h.updateTaskPane(Th.CF,b);return null})}hideTaskPane(){Tk.UISurfaces.aw().then(b=>{b.hideTaskPane(Th.CF,2);return null})}}Object(u.a)(OM,"WordReactSmartLookupPaneHandler",null,[237]);class yJ extends JG{constructor(b,h){super();this.JA=b;this.pb=h}c1d(){const b=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Pb&&y.AFrameworkApplication.J.$("SmartLookupEnableNativePane");return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pb&&
y.AFrameworkApplication.ta.Pb.O3f?new RO(new OM,sq.a.instance,Jc.FocusManager.instance(),Xa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Xa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Xa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Xa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new xJ(new CE,sq.a.instance,Jc.FocusManager.instance(),
Xa.a.instance.resolve("Common.Utils.IAriaNotifier"),Xa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Xa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Xa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Xa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Xa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}MSb(){return this.JA.getSelectedText()}uFi(){if(!this.pb||!this.pb.ob||1>this.pb.ob.length)return null;
var b=this.pb.ob.currentSelection.Ya;b=null==b?null:pb.a.uu(b);return(b=null==b?null:Wg.a.Vg(pb.a.language(b)))?b.name:""}Sab(){return this.JA.RQf()}wFi(){return this.JA.RQf()}E3i(){return this.JA.xon()}}Object(u.a)(yJ,"WordInsightsManager",JG,[]);var eP=e(225);class PM{}Object(u.a)(PM,"CommandMetadataResponse",null,[]);class wC{constructor(){this.bXf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){eP.PrivacyDialogManager.UCe()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new PM;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),A=Array(2);A[0]=r["default"];A[1]=r.icon32;h.svgData=this.getCommandIconSvg(A)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.bXf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.bXf)return this.bXf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=wC.Ebm;h.telemetryGroup=r;h.appData=b;return h}}wC.DTi="FA000000012";wC.queryPrefix="AssetID=";wC.Ebm="SearchPane";Object(u.a)(wC,"BaseSerpletExecutor",null,[235,217]);
class NL extends wC{constructor(b,h){super();this.ga=b;this.pb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Zb(fb.a.jXb,2,null);break;case 1:this.ga.Zb(Lc.a.i3b,2,null);break;case 2:this.ga.Zb(fb.a.$0c,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Zb(wb.a.hge,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Zb(wb.a.J1b,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Zb(wb.a.GGf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};JM(this.pb);this.ga.Zb(wb.a.GGf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Zb(wb.a.Pkc,2,h)}openNavigationPane(){this.ga.Zb(Lc.a.NAc,2,null)}openSerpletTaskPane(){this.ga.Zb(wb.a.SZi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Zb(wb.a.bge,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(A=>b[A.id]=JSON.stringify(A)))}return b}}Object(u.a)(NL,"WordSerpletExecutor",wC,[]);class SO extends vJ{constructor(){super();this.k6e=null;this.Gz=()=>{y.AFrameworkApplication.b5&&(this.H3l(),eq.a.Km().then(()=>this.k6e.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){y.AFrameworkApplication.b5&&(this.k6e.Wa("WordEditor.Insights.WordInsightsActor").mc(),
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?y.AFrameworkApplication.J.lq(this.Gz):super.init())}Ec(b){super.Ec(b);this.k6e=b;b.ja("Box4.Insights.Box4InsightsSelection",()=>new fr.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ja("WordEditor.Insights.WordInsertContentExecutor",()=>new MM(y.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ja("WordEditor.Insights.WordSerpletExecutor",()=>new NL(y.AFrameworkApplication.va,Fg.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ja("WordEditor.Insights.AugloopSearchProviderManager",()=>new aO(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ja("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new Or(new xe.a(()=>Db.StaticActiveAppFrame.Aa()?Db.StaticActiveAppFrame.Aa().tb.rd:
null),b.resolve("Box4.IParagraphReader"),ZN.a.instance,y.AFrameworkApplication.J,OK.a.instance,BM.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),y.AFrameworkApplication.va,Fg.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new gO(new xe.a(()=>Db.StaticActiveAppFrame.Aa()?Db.StaticActiveAppFrame.Aa().tb.rd:null),b.resolve("Box4.IParagraphReader"),Object(Vb.a)(),Fg.a.instance,b.resolve("Box4.ISelectionFactory"),h,Ze.a.wf.Um.Hf(12),
new xe.a(()=>Db.StaticActiveAppFrame.Aa().tb),Jc.FocusManager.instance(),b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Za("WordEditor.Insights.IAugloopSearchProviderManager"),b.Za("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ja("WordEditor.Insights.WordInsightsManager",()=>new yJ(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();
b.ja("WordEditor.Insights.WordInsightsActor",()=>new vC(b.zf("Common.App.Insights.IInsightsManager"),y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.Za("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ja("Common.App.SearchCommon.IDocumentHelper",()=>new LM(b.Za("WordEditor.Extension.DocumentProperties"))).ha()}}Object(u.a)(SO,"WordInsightsPackage",vJ,[]);class TO{}Object(u.a)(TO,"ScalingStep",null,[]);class UO{constructor(b,h,
r){this.eMc=!1;this.VK=null;this.pTc=this.z$b=!1;this.z7a=[];this.zye=A=>{this.kfa&&this.kfa!==A&&appChrome.api.dispatch(this.rLi(!1))};h.execute(A=>{this.VK=A});b.BD(Object(E.a)(this,this.r$n,"onProcessSetSelectionFinished"));this.$s=r}nnc(b,h,r){const A=[];for(const L of b)A.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:L},r));return A}QJi(b){const h=[];for(let r=0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>
r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}rLi(b){const h=[];if(b)switch(this.kfa){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.QJi("PictureStyles"));h.push(...this.nnc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.z7a.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.nnc(b,
"MoveToOverflow"));break;case "Table":this.pTc||h.push(...this.QJi("TableStyles"));h.push(...this.nnc(this.z7a,"DropLabel",this.pTc?0:void 0));b=this.z7a.slice().reverse();h.push(...this.nnc(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.nnc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.z7a.slice().reverse(),h.push(...this.nnc(b,"MoveToOverflow"))}else for(const r of this.z7a)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return h}P4b(b){const h={};for(const r of b)try{h[r]=
appChrome.selectors.getModelType(r)}catch(A){this.lK("Error","GetModelType failed for "+r)}Db.StaticActiveAppFrame.Aa().J7d(h)}cCp(b){if(0!==b.length){var h=[],r={},A=!1;for(const L of b)try{if(appChrome.selectors.isControlDefined(L))r[L]=appChrome.selectors.getModelType(L);else{A=!0;break}}catch(ba){this.lK("Error","GetModelType failed for "+L);A=!0;break}if(A)this.kfa=void 0,this.kIe(!1);else{if("Image"===this.kfa&&!this.z$b)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.z$b=!0;
else if(this.z$b){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));A=appChrome.selectors.getVisibleControlsInGroup("Font");for(const L of A)r[L]=appChrome.selectors.getModelType(L);this.z$b=!1}Db.StaticActiveAppFrame.Aa().J7d(r);this.z7a=b;r=[];for(const L of b)appChrome.selectors.isControlDisabled(L)&&r.push(L);0<r.length&&this.lK("Disabled",r.join(","));0<this.z7a.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.z7a)),h.push(...this.rLi(!0)),this.eMc=!0);appChrome.api.dispatch(h)}}}kIe(b){if(b||this.eMc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.eMc=b;if("Image"===this.kfa||this.z$b){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.P4b(r)}this.z$b=!b}appChrome.api.dispatch(h)}}lDc(){this.eMc&&this.$s&&this.$s.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}r$n(b,
h){!y.AFrameworkApplication.ta.Pb.wAc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.VK&&h.Pn&&h.Pn.currentSelection&&0!==h.Pn.length?(b=()=>{let r=[],A=!1;var L=this.VK.contentType,ba=appChrome.selectors.getActiveContextualTabIds();L.includes("Image")?(this.zye("Image"),this.kfa&&"Image"===this.kfa?A=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.kfa="Image")):L.includes("Table")&&0<=ba.indexOf("Table")?(L=!(Js.a.instance.currentSelection.eOa||Js.a.instance.currentSelection.Oy||Js.a.instance.currentSelection.cdb),(ba="Table"===this.kfa&&L!==this.pTc)?this.zye("TableCellEdit"):this.zye("Table"),!this.kfa||"Table"!==this.kfa||ba?(L?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.pTc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.pTc=!1),this.kfa="Table"):A=!0):L.includes("Hyperlink")&&(this.zye("Hyperlink"),this.kfa&&"Hyperlink"===this.kfa?A=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.kfa="Hyperlink"));A?this.eMc||(this.P4b(this.z7a),this.kIe(!0),this.lDc()):0<r.length?(this.cCp(r),this.lDc()):this.kIe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.kIe(!1)}lK(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new nk.a;h.name="Events";h.dataFields=Uh.a.iG(b);h.durationMs=window.performance.now();ka.a.eQa(h,"TellMeWAC.")}}Object(u.a)(UO,"AdaptiveTabGroupUpdater",null,[]);class OL{constructor(){this.Z=null;this.G1n=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.Z.ja("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new UO(this.Z.resolve("Box4.ISelectionManager"),this.Z.Za("Common.IActionContextProvider"),this.Z.Za("Common.ISystemInitiatedFeedback"))).ha(),
this.Z.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}Ec(b){this.Z=b}init(){SB.a(1,this.G1n)}dispose(){}}Object(u.a)(OL,"PackageManager",null,[0,1]);var mO=e(1856),VO=e(1119),PL=e(1853);const c=(b,h,r)=>1===r?32:2===r?(e.e(5).then(e.bind(null,2140)).then(A=>{(0,A.createAndShowDevToolsMenu)()}),32):2;class k{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))y.AFrameworkApplication.va.qa(Lc.a.FGg,dd.a.frame,c),null!==sessionStorage.getItem("devToolsRefresh")&&e.e(5).then(e.bind(null,2140))}dispose(){}Ec(b){x(b)}static main(){F.a.instance.Rc(new k)}}Object(u.a)(k,"WordDevToolsPackage",null,[0,1]);e(603);class t{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(u.a)(t,"FormattingData",null,[]);class C extends t{constructor(){super();this.hyperlinkData=null}}Object(u.a)(C,"RichContentCommandData",
t,[]);class M{constructor(){var b;M.Sj.add(Lc.a.mhb);M.Sj.add(Lc.a.L3b);M.Sj.add(Lc.a.NBc);M.Sj.add(Lc.a.S2);M.Sj.add(Lc.a.Ffg);M.Sj.add(Lc.a.Qpg);M.Sj.add(Lc.a.deleteComment);M.Sj.add(Lc.a.A0c);M.Sj.add(Lc.a.kzf);M.Sj.add(Lc.a.kDe);M.Sj.add(Lc.a.c3a);M.Sj.add(Lc.a.FGg);M.Sj.add(Lc.a.i3b);M.Sj.add(Lc.a.MGg);M.Sj.add(Lc.a.C1c);(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&M.Sj.add(Lc.a.Q3d);M.Sj.add(Lc.a.P3d);
M.Sj.add(fb.a.$0c);M.Sj.add(fb.a.KZ);M.Sj.add(fb.a.print);M.Sj.add(fb.a.Wue);M.Sj.add(fb.a.wsg);M.Sj.add(fb.a.readingMode);M.Sj.add(fb.a.jXb);M.Sj.add(wb.a.T6j);M.Sj.add(wb.a.Pv);M.Sj.add(wb.a.Dud);M.Sj.add(wb.a.J1b);M.Sj.add(wb.a.Hna);M.Sj.add(wb.a.Hsd);M.Sj.add(wb.a.zGg);M.Sj.add(wb.a.pSg);M.Sj.add(wb.a.wca);M.Sj.add(wb.a.IOa);M.Sj.add(wb.a.Msf);M.Sj.add(wb.a.v_a);M.Sj.add(wb.a.yxg);M.Sj.add(wb.a.xxg);M.Sj.add(wb.a.zxg);M.Sj.add(wb.a.$2d);M.Sj.add(wb.a.Ssa);M.Sj.add(wb.a.xDe);M.Sj.add(wb.a.XZj);
M.Sj.add(wb.a.close);M.Sj.add(wb.a.Sve);M.Sj.add(wb.a.cve);M.Sj.add(wb.a.ise);M.Sj.add(wb.a.tDe);M.Sj.add(wb.a.wDe);M.Sj.add(wb.a.z_b);M.Sj.add(wb.a.kxa);M.Sj.add(wb.a.ipc);M.Sj.add(wb.a.lHg);M.Sj.add(wb.a.VAc);M.Sj.add(wb.a.Sga);M.Sj.add(wb.a.bzc);M.Sj.add(wb.a.Vte);M.Sj.add(wb.a.xxc);M.Sj.add(wb.a.nDj);M.Sj.add(wb.a.d9h);M.Sj.add(wb.a.HZd);M.Sj.add(wb.a.Lsf);M.Sj.add(wb.a.f9h);M.Sj.add(wb.a.e9h);M.Sj.add(wb.a.Msf);M.Sj.add(wb.a.IZd);M.Sj.add(Lc.a.GKe);M.Sj.add(Lc.a.hTg);M.Sj.add(Lc.a.P5b);M.Sj.add(Lc.a.SAg);
M.Sj.add(Lc.a.vzb);M.Sj.add(Lc.a.jwe);M.Sj.add(Lc.a.vqa);M.Sj.add(wb.a.Vub);M.Sj.add(wb.a.Zqb);M.Sj.add(wb.a.YAc);M.Sj.add(wb.a.Hik);M.Sj.add(wb.a.tDj);M.Sj.add(Lc.a.vmd);M.Sj.add(fb.a.k_b);M.Sj.add(fb.a.K5)}}M.Sj=new Set;Object(u.a)(M,"CommentRibbonCommands",null,[]);class da{constructor(b,h,r,A,L){this.Kmj=b;this.lh=h;this.hq=r;this.ki=A;this.dsp=L;this.hcc=null;this.BHa=new de.a(0);this.uEb=new de.a(0);this.VOe=new de.a(0);this.Zef=!1;this.gdn();this.TDo()}unn(b){return this.hcc&&this.hq.$A?!M.Sj.has(b):
!1}Xnc(b,h,r){if(b===wb.a.nh)return 32;if(!this.BHa.Bb(b)&&!this.uEb.Bb(b)||!this.hcc)return 2;const A=this.uEb.Bb(b);var L=A?this.uEb.K(b):this.BHa.K(b);const ba=A?2:this.VOe.K(r);A||1!==ba||(this.brn(Db.StaticActiveAppFrame.Aa().yr.currentScope.name)||Db.StaticActiveAppFrame.Aa().yr.Rg(this.lh.Ln?Df.AFrame.Xu:Df.AFrame.pT),Db.StaticActiveAppFrame.Aa().Ne(!0));r=new C;switch(L){case 1:r.highlight={color:this.rKi(h.Color)};break;case 6:r.fontColor={color:this.rKi(h.Color)}}L=this.hcc.executeCommand(L,
ba,r);2===L&&A&&(b===fb.a.fxc?h[bg.a.On]=!!r.bold:b===fb.a.mxc?h[bg.a.On]=!!r.italic:b===fb.a.Axc?h[bg.a.On]=!!r.underline:b===fb.a.rxc?h[bg.a.On]=!!r.strikethrough:b===fb.a.O2?h[bg.a.On]=!!r.highlight:b===fb.a.Uy&&(h[bg.a.On]=!!r.fontColor));return 2===L?32:1===L?2:8}TAo(b){this.hcc=b;this.hcc.registerSelectionChangeHandler(()=>{this.Zef||(this.Zef=!0,Db.StaticActiveAppFrame.Aa().Ne(!0),this.Zef=!1)});this.hcc.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case pg.a.g6b:case pg.a.hzd:case pg.a.nMe:case pg.a.X3a:Db.StaticActiveAppFrame.Aa().Ne(!0)}h.key!==
pg.a.IF&&h.key!==pg.a.G6||Db.StaticActiveAppFrame.Aa().Ne(!0)})}TDo(){this.Kmj.ZGj(Df.AFrame.Xu,this);this.Kmj.ZGj(Df.AFrame.pT,this)}gdn(){this.BHa.W(fb.a.bold,0);this.BHa.W(fb.a.cC,3);this.BHa.W(fb.a.strikethrough,4);this.BHa.W(fb.a.underline,5);this.BHa.W(fb.a.O2,1);this.BHa.W(fb.a.GBa,1);this.BHa.W(fb.a.Uy,6);this.BHa.W(fb.a.pma,6);this.BHa.W(fb.a.Ixa,6);this.uEb.W(fb.a.fxc,0);this.uEb.W(fb.a.mxc,3);this.uEb.W(fb.a.rxc,4);this.uEb.W(fb.a.Axc,5);this.VOe.W(1,0);this.VOe.W(2,1)}brn(b){return b===
Df.AFrame.Xu||b===Df.AFrame.pT}rKi(b){return b?Xl.a.zB(this.dsp.sma(this.ki.Fd,b)):""}}Object(u.a)(da,"CommentRibbonCommandHandler",null,[180,181]);class va{constructor(){this.Z=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.Z.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.Z.resolve("WordEditor.Comments.CommentsState").rtg?this.Z.resolve("WordEditor.Comments.CommentRibbonCommands"):this.Z.resolve("WordEditor.Comments.WordCommentEventsActor").H2("OnCommentRenderedOnce",
()=>{this.Z.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}Ec(b){this.Z=b;this.Z.ja("WordEditor.Comments.CommentRibbonCommandHandler",()=>new da(this.Z.Wa("Common.INonCanvasCuiUser"),this.Z.resolve("WordEditor.Comments.CommentsState"),this.Z.resolve("Common.Comments.ICommentModel"),Pk.a.Xm.tb.Xc,Sm.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.Z.ja("WordEditor.Comments.CommentRibbonCommands",()=>new M).ha()}static main(){F.a.instance.Rc(new va)}}
Object(u.a)(va,"PackageManager",null,[0,1]);var Oa=e(1995);class jb{constructor(b,h){this.QUl=2E3;this.ITd=null;this.Zmg=b.hxj;this.maxLength=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.QUl);h&&h.execute(r=>{this.ITd=r})}KKf(b){b=this.Oqm(b,this.maxLength);return{semantic:Dp.ObjectSemantic.CanvasContext,type:Dp.ObjectSchemaType.WordCanvasContext,value:b}}Oqm(b,h){try{return this.Nqm(b,h)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,
"Error processing selection for Canvas Context: {0}",r),null}}UQm(b,h){const r={F$a:[],REa:0,selection:{start:null,end:null},cursor:null,tiles:[]},A=b.length;for(let ba=0;ba<A;ba++){const ra=b.K(ba);var L=ra.node;if(!rd.ParagraphReader.lc(L)||Array.contains(r.F$a,L.Jl))continue;r.F$a.push(L.Jl);const Ia=rd.ParagraphReader.textLength(L);if(r.REa+Ia>h)break;L=this.Zmg.tqb(L);r.tiles.push(L);r.REa+=Ia;1!==A||r.cursor||(r.cursor=jb.svm(ra,r.tiles.length-1));null===r.selection.start&&0===ba&&(r.selection.start=
this.TNi(ra,!0,r.tiles.length-1));null===r.selection.end&&ba===A-1&&(r.selection.end=this.TNi(ra,!1,r.tiles.length-1))}return r}DHm(b,h,r){const A={Uud:[],u6j:[],REa:0};var L=b.K(0).node;let ba=b.K(b.length-1).node;for(b=h;0<b&&(L||ba);){var ra=jb.TBj(L,!0,b,r);if(L=ra.node)L=this.Zmg.tqb(L),A.Uud.push(L),b-=ra.REa,L=ra.node,r=ra.F$a;ra=jb.TBj(ba,!1,b,r);if(ba=ra.node)r=this.Zmg.tqb(ba),A.u6j.push(r),b-=ra.REa,ba=ra.node,r=ra.F$a}A.REa=h-b;return A}Pqm(b,h){let r=0;var A=this.UQm(b,h);const L={tiles:A.tiles,
selection:A.selection,cursor:A.cursor};r+=A.REa;A=A.F$a;r<h&&(b=this.DHm(b,h-r,A),L.tiles.unshift.apply(L.tiles,b.Uud),L.tiles.push.apply(L.tiles,b.u6j),L.selection.start&&(L.selection.start.index+=b.Uud.length),L.selection.end&&(L.selection.end.index+=b.Uud.length),L.cursor&&(L.cursor.index+=b.Uud.length));return L}Nqm(b,h){var r;if(!b)return null;b=this.Pqm(b,h);return{contentType:null===(r=this.ITd)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}TNi(b,
h,r){if(b.contextId===ic.a.Nd||b.contextId===ic.a.paragraph||b.contextId===ic.a.kd){if(h&&-1!==b.Uj)return{index:r,offset:b.Uj};if(!h&&-1!==b.Yp)return{index:r,offset:b.Yp}}return null}static svm(b,h){return b.contextId===ic.a.kd?{index:h,offset:b.Uj}:null}static TBj(b,h,r,A){A={node:null,REa:0,F$a:A};if(!b||0>=r||!A.F$a)return A;do A.node=rd.ParagraphReader.Cg(b,h,!1,!1),A.REa=A.node?rd.ParagraphReader.textLength(A.node):0,b=A.node;while(A.node&&(Array.contains(A.F$a,A.node.Jl)||!rd.ParagraphReader.lc(A.node)||
!A.REa));A.node&&(A.REa>r?A.node=null:A.F$a.push(A.node.Jl));return A}}Object(u.a)(jb,"Box4CanvasContextProvider",null,[177]);class Gb{get name(){return"Box4.CanvasContext"}init(){}dispose(){}Ec(b){b.ja("Box4.CanvasContext.Box4CanvasContextProvider",()=>new jb(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Za("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){F.a.instance.Rc(new Gb)}}Object(u.a)(Gb,"Box4CanvasContextPackage",null,
[0,1]);class ec{constructor(b,h,r,A){this.EM={};this.mec=this.XOd=0;this.m2d=3E4;this.start=()=>{0!=this.iMb.size&&0===this.mec&&(this.mec=window.setInterval(this.$Ro,this.m2d),v.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.$Ro=()=>{0!=this.iMb.size&&(this.qf.nq?(v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop()):(this.EM.ScanTime=Date.now(),this.EM.NumWatchDogs=this.iMb.size,this.EM.WatchDogManagerScanNumber=++this.XOd,this.iMb.forEach(async(L,ba)=>
{this.EM[ba]=await L.wVn();"KickoutComponent"==this.EM[ba].ComponentStatus&&this.q6f(this.Zxm(ba));L.kCn()||v.ULS.sendTraceTag(520974674,306,20,JSON.stringify(this.EM))})))};this.qf=b;this.ksa=r;this.I3=A;this.egf=new Map;this.iMb=new Map;h.execute(L=>{this.Wk=L;this.Wk.Psa((ba,ra)=>{this.KT(ra)})})}KT(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.mec||(v.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):
(this.stop(),this.start(),this.oOo(),v.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.mec&&(window.clearInterval(this.mec),this.mec=0);v.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}c5k(b,h){this.egf.set(b,h)}ROo(){this.smo(this.egf)}get eal(){return this.egf.size===this.iMb.size}smo(b){b.forEach((h,r)=>{h.execute(A=>{A?(this.iMb.set(r,A),this.start()):v.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",
r)})})}oOo(){this.iMb.forEach(b=>{b&&b.SFa()});v.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}q6f(b){0<this.ksa.p3a&&this.I3.TWb(b)}Zxm(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?Of.a.ZRp:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?Of.a.YRp:null}}Object(u.a)(ec,"WatchDogManager",null,[179]);class Ec{constructor(){this.Z=this.hMb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.hMb=this.Z.resolve(this.name);this.lfn()}dispose(){this.hMb&&this.hMb.stop()}Ec(b){this.Z=
b;b.ja(this.name,this.ORl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){F.a.instance.Rc(new Ec)}pMp(){if(!this.hMb.eal){const b=[];let h=0;this.SOd.forEach((r,A)=>{r&&(this.Z.Wa(A)||(b[h++]=A))});if(0<b.length){const r=!this.Z.resolve("Box4.Revision.IRevisionSequenceNumberManager").XT;v.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}ORl(){return new ec(this.Z.resolve("Common.ISessionStatus")||id.SessionStatusManager.instance,this.Z.Za("Common.App.VisibilityManagement.IVisibilityManager"),
this.Z.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.Z.resolve("Wonca.KickoutExecutor"))}Y5k(){window.setTimeout(this.pMp.bind(this),this.QNp)}e6k(){this.SOd=new Map;this.SOd.set("WordEditor.RunawayDataLossMonitorWatchDog",Ze.a.Yn||Ze.a.Wu);this.SOd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}lfn(){this.e6k();this.d6k(this.SOd,this.hMb.c5k.bind(this.hMb));this.hMb.ROo();this.Y5k()}d6k(b,h){b.forEach((r,A)=>{r&&h(A,this.Z.Za(A))})}get QNp(){return null!=this.cch?this.cch:
this.cch=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(u.a)(Ec,"WatchDogManagerPackage",null,[0,1]);class hd{constructor(b){this.pPa=b;this.Nui=!1;this.tsb=void 0}h8o(){this.Nui||(this.ZLl(),this.BEl(),this.L7l(),this.mlo(),this.Nui=!0)}nep(){Tk.UISurfaces.Pzm().then(b=>{b.renderFloatingHelp(this.tsb.Una,{["actionCallback"]:(h,r=2,A=null)=>{y.AFrameworkApplication.va.Zb(h,r,A)}});return null})}BEl(){this.tsb.Ajd.appendChild(this.tsb.Una)}L7l(){this.pPa.appendChild(this.tsb.Ajd)}ZLl(){this.tsb=
{Ajd:this.Tdi(hd.rdo),Una:this.Tdi(hd.Yfn)}}Tdi(b){const h=document.createElement("div");h.id=b;return h}mlo(){this.tsb.Ajd.style.position="fixed";this.tsb.Ajd.style.bottom="47px";this.tsb.Ajd.style.right="24px"}}hd.rdo="FloatingHelpOuterContainer";hd.Yfn="FloatingHelpInnerHost";Object(u.a)(hd,"FloatingHelpManager",null,[178]);class Bd{constructor(){this.container=void 0}get name(){return"WordEditor.FloatingHelp"}Ec(b){this.container=b;const h=Pk.a.Xm.VH;this.container.ja("WordEditor.FloatingHelp.FloatingHelpManager",
()=>new hd(h)).as("WordEditor.FloatingHelp.IFloatingHelpManager").ha()}init(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FloatingHelpExperiment",!1)&&void 0!==this.container){const b=this.container.resolve("WordEditor.FloatingHelp.IFloatingHelpManager");b.h8o();b.nep()}}dispose(){}static main(){F.a.instance.Rc(new Bd)}}Object(u.a)(Bd,"FloatingHelpPackage",null,[0,1]);class Kd{constructor(b,h){this.id=b;this.altText=h}}Object(u.a)(Kd,"ParagraphBorderPropertiesItem",
null,[]);class Yd{constructor(b,h,r,A,L,ba){this.T7d=b;this.gallerySectionId=h;this.tFf=r;this.Ckf=A;this.commandId=L;this.queryCommandId=ba}}Object(u.a)(Yd,"ParagraphBorderPropertiesMenuPropsArgs",null,[]);class Xe{constructor(b,h,r,A){this.size=b;this.space=h;this.style=r;this.color=A}}Object(u.a)(Xe,"ParagraphBorderStyleProperties",null,[]);class Ne{constructor(b,h,r,A,L,ba){this.N8a=b;this.Ptd=h;this.width=r;this.yhd=A;this.height=L;this.Fed=ba}}Object(u.a)(Ne,"ParagraphBorderPropertiesDefinition",
null,[]);class Oc{constructor(){this.Qkl=[new Kd(Oc.p3b,WacWordeditorStrings.ParagraphBorderSolidLine),new Kd(Oc.UPb,WacWordeditorStrings.ParagraphBorderDashedLine),new Kd(Oc.vQb,WacWordeditorStrings.ParagraphBorderDottedLine),new Kd(Oc.xQb,WacWordeditorStrings.ParagraphBorderDoubleLine)];this.$kl=[new Kd(Oc.ENb,"0.25 pt"),new Kd(Oc.CNb,"0.5 pt"),new Kd(Oc.HNb,"0.75 pt"),new Kd(Oc.DNb,"1 pt"),new Kd(Oc.BNb,"1.5 pt"),new Kd(Oc.INb,"2.25 pt"),new Kd(Oc.GNb,"3 pt"),new Kd(Oc.ANb,"4.5 pt"),new Kd(Oc.FNb,
"6 pt")];this.Mkl=[new Kd(Oc.rof,"0 pt"),new Kd(Oc.lof,"1 pt"),new Kd(Oc.qof,"2 pt"),new Kd(Oc.pof,"3 pt"),new Kd(Oc.jof,"4 pt"),new Kd(Oc.hof,"5 pt"),new Kd(Oc.nof,"6 pt"),new Kd(Oc.mof,"7 pt"),new Kd(Oc.gof,"8 pt"),new Kd(Oc.kof,"9 pt"),new Kd(Oc.oof,"10 pt")]}initialize(){this.fdn();this.wnd()}fdn(){this.eXd=[new Ne(Oc.p3b,"","2",1,8,0),new Ne(Oc.UPb,"5,3","1",1,8,0),new Ne(Oc.vQb,"1,1","1",1,8,0),new Ne(Oc.xQb,"","1",2,8,3)];this.fXd=[new Ne(Oc.ENb,"","0.25",1,8,0),new Ne(Oc.CNb,"","0.5",1,8,
0),new Ne(Oc.HNb,"","0.75",1,8,0),new Ne(Oc.DNb,"","1",1,8,0),new Ne(Oc.BNb,"","1.5",1,8,0),new Ne(Oc.INb,"","2.25",1,8,0),new Ne(Oc.GNb,"","3",1,8,0),new Ne(Oc.ANb,"","4.5",1,8,0),new Ne(Oc.FNb,"","6",1,8,0)]}wnd(){if(Object(mh.c)()){var b={};for(const h of this.eXd)b[h.N8a]=appChrome.buildBorderStyleIcon(h.Ptd,h.width,h.yhd,h.height,h.Fed);for(const h of this.fXd)b[h.N8a]=appChrome.buildBorderStyleIcon(h.Ptd,h.width,h.yhd,h.height,h.Fed);appChrome.api.registerIconProvider(()=>b)}else v.ULS.sendTraceTag(508339926,
306,15,"AppChrome not loaded yet. Skipping registering icons for paragraph border manager.")}aMf(){return new Xe(Oc.Qic,Oc.$hi,Oc.Pic,Oc.r0c)}Ysb(b){var h=this.SXa(b);if(0!==h.length){for(const A of h)if(r){if(h=this.jzi(b,A),!this.qWc(r,h))return}else var r=this.jzi(b,A);return r}}jzi(b,h){const r=this.aMf();switch(h){case 0:return{size:rd.ParagraphReader.rh(b,Me.a.yR,r.size),space:rd.ParagraphReader.rh(b,Me.a.Jwa,r.space),style:rd.ParagraphReader.rh(b,Me.a.N0a,r.style),color:rd.ParagraphReader.rh(b,
Me.a.M0a,r.color)};case 1:return{size:rd.ParagraphReader.rh(b,Me.a.JW,r.size),space:rd.ParagraphReader.rh(b,Me.a.Hwa,r.space),style:rd.ParagraphReader.rh(b,Me.a.F0a,r.style),color:rd.ParagraphReader.rh(b,Me.a.E0a,r.color)};case 2:return{size:rd.ParagraphReader.rh(b,Me.a.B2,r.size),space:rd.ParagraphReader.rh(b,Me.a.mFa,r.space),style:rd.ParagraphReader.rh(b,Me.a.I0a,r.style),color:rd.ParagraphReader.rh(b,Me.a.H0a,r.color)};case 3:return{size:rd.ParagraphReader.rh(b,Me.a.C2,r.size),space:rd.ParagraphReader.rh(b,
Me.a.nFa,r.space),style:rd.ParagraphReader.rh(b,Me.a.Leb,r.style),color:rd.ParagraphReader.rh(b,Me.a.nPa,r.color)};case 4:return{size:rd.ParagraphReader.rh(b,Me.a.jU,r.size),space:rd.ParagraphReader.rh(b,Me.a.Gwa,r.space),style:rd.ParagraphReader.rh(b,Me.a.Keb,r.style),color:rd.ParagraphReader.rh(b,Me.a.Jeb,r.color)}}return r}dqm(b){switch(b){case Oc.ENb:return Oc.XWc;case Oc.CNb:return Oc.eof;case Oc.HNb:return Oc.L8a;case Oc.DNb:return Oc.xBa;case Oc.BNb:return Oc.l8;case Oc.INb:return Oc.gma;case Oc.GNb:return Oc.m8;
case Oc.ANb:return Oc.wBa;case Oc.FNb:return Oc.fma;default:return Oc.Qic}}aqm(b){switch(b){case Oc.p3b:return"single";case Oc.UPb:return"dashed";case Oc.vQb:return"dotted";case Oc.xQb:return"double";default:return Oc.Pic}}Ypm(b){switch(b){case Oc.rof:return Oc.Q0h;case Oc.lof:return Oc.K0h;case Oc.qof:return Oc.P0h;case Oc.pof:return Oc.O0h;case Oc.jof:return Oc.iof;case Oc.hof:return Oc.I0h;case Oc.nof:return Oc.M0h;case Oc.mof:return Oc.L0h;case Oc.gof:return Oc.H0h;case Oc.kof:return Oc.J0h;case Oc.oof:return Oc.N0h;
default:return Oc.$hi}}eqm(b){switch(b){case Oc.XWc:return Oc.ENb;case Oc.eof:return Oc.CNb;case Oc.L8a:return Oc.HNb;case Oc.xBa:return Oc.DNb;case Oc.l8:return Oc.BNb;case Oc.gma:return Oc.INb;case Oc.m8:return Oc.GNb;case Oc.wBa:return Oc.ANb;case Oc.fma:return Oc.FNb}}bqm(b){switch(b){case "single":return Oc.p3b;case "dashed":return Oc.UPb;case "dotted":return Oc.vQb;case "double":return Oc.xQb}}Zpm(b){switch(b){case Oc.Q0h:return Oc.rof;case Oc.K0h:return Oc.lof;case Oc.P0h:return Oc.qof;case Oc.O0h:return Oc.pof;
case Oc.iof:return Oc.jof;case Oc.I0h:return Oc.hof;case Oc.M0h:return Oc.nof;case Oc.L0h:return Oc.mof;case Oc.H0h:return Oc.gof;case Oc.J0h:return Oc.kof;case Oc.N0h:return Oc.oof}}SXa(b){const h=[];void 0!==rd.ParagraphReader.rh(b,Me.a.yR,void 0)&&h.push(0);void 0!==rd.ParagraphReader.rh(b,Me.a.JW,void 0)&&h.push(1);void 0!==rd.ParagraphReader.rh(b,Me.a.B2,void 0)&&h.push(2);void 0!==rd.ParagraphReader.rh(b,Me.a.C2,void 0)&&h.push(3);void 0!==rd.ParagraphReader.rh(b,Me.a.jU,void 0)&&h.push(4);
return h}jJf(){const b=new Yd("ParagraphBorderLineStyleOptionsGallery","DefaultBorderStyleOptions","ParagraphBorderLineStyleOptionsGallery",this.Qkl,Lc.a.l2b,Lc.a.Ive);return this.Blc(b,Oc.Rkl,Oc.Skl)}kJf(){const b=new Yd("ParagraphBorderLineWeightOptionsGallery","DefaultBorderWeightOptions","ParagraphBorderLineWeightOptionsGallery",this.$kl,Lc.a.m2b,Lc.a.Jve);return this.Blc(b,Oc.bll,Oc.cll)}ilm(){const b=new Yd("ParagraphBorderLinePaddingOptionsGallery","DefaultBorderPaddingOptions","ParagraphBorderLinePaddingOptionsGallery",
this.Mkl,Lc.a.k2b,Lc.a.Hve);return this.Blc(b,"0px","0px")}Blc(b,h="20px",r="50px"){const A=new dk.a,L=new Zd.a,ba=Object.assign(new Ul.a,{Id:b.T7d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.tFf,Type:4,Width:10,GalleryItems:[]});for(const Ia of b.Ckf){var ra={};const Ta={};Ta.width=r;Ta.height=h;Ta.marginRight="8px";ra.root=Ta;ra=Object.assign(new wk.a,{Id:String.format("{0}_Button",Ia.id),ExternalId:String.format("{0}_ExternalID",Ia.id),Icon:Ia.id,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),
MenuItemId:Ia.id,P9p:Ta,FullIconStyle:ra,LabelText:Ia.altText});ba.GalleryItems.push(ra)}L.ControlList=[];A.MenuSectionList=[];L.ControlList.push(ba);A.MenuSectionList.push(L);A.UpdateDynamically=!0;return A}qWc(b,h){return!b&&!h||b&&h&&b.color===h.color&&b.size===h.size&&b.style===h.style&&b.space===h.space}dZh(b,h){if(b.length!==h.length)return!1;for(const r of b)if(-1===h.indexOf(r))return!1;return!0}}var ke=Oc;Oc.p3b="SolidLineStyle";Oc.UPb="DashedLineStyle";Oc.vQb="DottedLineStyle";Oc.xQb="DoubleLineStyle";
Oc.XWc=2;Oc.ENb="BorderPointSizeOneQuarter";Oc.eof=4;Oc.CNb="BorderPointSizeOneHalf";Oc.L8a=6;Oc.HNb="BorderPointSizeThreeQuarters";Oc.xBa=8;Oc.DNb="BorderPointSizeOne";Oc.l8=12;Oc.BNb="BorderPointSizeOneAndHalf";Oc.gma=18;Oc.INb="BorderPointSizeTwoAndQuarter";Oc.m8=24;Oc.GNb="BorderPointSizeThree";Oc.wBa=36;Oc.ANb="BorderPointSizeFourAndHalf";Oc.fma=48;Oc.FNb="BorderPointSizeSix";Oc.Q0h=0;Oc.rof="BorderSpaceZero";Oc.K0h=1;Oc.lof="BorderSpaceOne";Oc.P0h=2;Oc.qof="BorderSpaceTwo";Oc.O0h=3;Oc.pof="BorderSpaceThree";
Oc.iof=4;Oc.jof="BorderSpaceFour";Oc.I0h=5;Oc.hof="BorderSpaceFive";Oc.M0h=6;Oc.nof="BorderSpaceSix";Oc.L0h=7;Oc.mof="BorderSpaceSeven";Oc.H0h=8;Oc.gof="BorderSpaceEight";Oc.J0h=9;Oc.kof="BorderSpaceNine";Oc.N0h=10;Oc.oof="BorderSpaceTen";Oc.Pic="single";Oc.Qic=Oc.eof;Oc.r0c=0;Oc.$hi=ke.iof;Oc.Skl="50px";Oc.Rkl="20px";Oc.cll="60px";Oc.bll="20px";Object(u.a)(Oc,"ParagraphBorderManager",null,[318]);class xg{constructor(){this.Uxe={size:0,space:0,color:0,style:"none"}}Z1a(b,h,r){for(const A of h)this.AZo(b,
A,r)}AZo(b,h,r){switch(h){case 0:b.properties.setValue(Me.a.Jwa,r.space);b.properties.setValue(Me.a.yR,r.size);b.properties.setValue(Me.a.M0a,r.color);b.properties.setValue(Me.a.N0a,r.style);break;case 1:b.properties.setValue(Me.a.Hwa,r.space);b.properties.setValue(Me.a.JW,r.size);b.properties.setValue(Me.a.E0a,r.color);b.properties.setValue(Me.a.F0a,r.style);break;case 2:b.properties.setValue(Me.a.mFa,r.space);b.properties.setValue(Me.a.B2,r.size);b.properties.setValue(Me.a.H0a,r.color);b.properties.setValue(Me.a.I0a,
r.style);break;case 3:b.properties.setValue(Me.a.nFa,r.space);b.properties.setValue(Me.a.C2,r.size);b.properties.setValue(Me.a.nPa,r.color);b.properties.setValue(Me.a.Leb,r.style);break;case 4:b.properties.setValue(Me.a.Gwa,r.space),b.properties.setValue(Me.a.jU,r.size),b.properties.setValue(Me.a.Jeb,r.color),b.properties.setValue(Me.a.Keb,r.style)}}Prf(b,h){for(const r of h)this.Gxl(b,r)}Gxl(b,h){switch(h){case 0:this.Qnd(b,xg.fup);break;case 1:this.Qnd(b,xg.dll);break;case 2:this.Qnd(b,xg.oGn);
break;case 3:this.Qnd(b,xg.OQo);break;case 4:this.Qnd(b,xg.ljl)}}Qnd(b,h){const [r,A,L,ba]=h;h=rd.ParagraphReader.kc.Lr(b);h.hasProperty(r)?b.properties.setValue(r,this.Uxe.space):b.properties.hasProperty(r)&&b.properties.removeProperty(r);h.hasProperty(A)?b.properties.setValue(A,this.Uxe.size):b.properties.hasProperty(A)&&b.properties.removeProperty(A);h.hasProperty(L)?b.properties.setValue(L,this.Uxe.color):b.properties.hasProperty(L)&&b.properties.removeProperty(L);h.hasProperty(ba)?b.properties.setValue(ba,
this.Uxe.style):b.properties.hasProperty(ba)&&b.properties.removeProperty(ba)}}xg.fup=[Me.a.Jwa,Me.a.yR,Me.a.M0a,Me.a.N0a];xg.dll=[Me.a.Hwa,Me.a.JW,Me.a.E0a,Me.a.F0a];xg.oGn=[Me.a.mFa,Me.a.B2,Me.a.H0a,Me.a.I0a];xg.OQo=[Me.a.nFa,Me.a.C2,Me.a.nPa,Me.a.Leb];xg.ljl=[Me.a.Gwa,Me.a.jU,Me.a.Jeb,Me.a.Keb];Object(u.a)(xg,"ParagraphBorderEditor",null,[317]);class Ng{constructor(b){this.kc=b}ZDg(b,h){b.properties.setValue(Ng.K2b,h.color)}$rf(b){this.kc.Lr(b).hasProperty(Ng.K2b)?b.properties.setValue(Ng.K2b,
xE.oHo):b.properties.hasProperty(Ng.K2b)&&b.properties.removeProperty(Ng.K2b)}}Ng.K2b=Tc.a.shading;Object(u.a)(Ng,"ParagraphShadingEditor",null,[316]);class ni{jRm(b){b=rd.ParagraphReader.rh(b,ni.K2b,null);return null===b?null:new xE(b)}}ni.K2b=Tc.a.shading;Object(u.a)(ni,"ParagraphShadingReader",null,[176]);class Lf{get name(){return"WordEditor.ParagraphEditor"}Ec(b){var h,r;this.container=b;if(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",
!1))this.container.ja("WordEditor.ParagraphEditors.IParagraphBorderEditor",()=>new xg).ha(),this.container.ja("WordEditor.ParagraphEditors.IParagraphBorderManager",()=>new Oc).ha();if(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1))this.container.ja("WordEditor.ParagraphEditors.IParagraphShadingEditor",()=>new Ng(this.container.resolve("Box4.Styles.IWACStyleReader"))).ha(),this.container.ja("WordEditor.ParagraphEditors.IParagraphShadingReader",
()=>new ni).ha()}init(){var b;(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))&&this.container.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager").initialize()}dispose(){}static main(){F.a.instance.Rc(new Lf)}}Object(u.a)(Lf,"WordEditorParagraphEditorsPackage",null,[0,1]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");
Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");
Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");
Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");
Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");
Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");T.main();Type.registerNamespace("Common.App.WopiIdentity");Ba.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");zb.main();Object(Oa.a)(!1);$F.main();FI.main();
mc.main();$b.main();Fa.main();k.main();Bd.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");ce.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Gf.main();Type.registerNamespace("Common.App.WildFire");hc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");fe.main();
Type.registerNamespace("Common.App.HostNotification");Ic.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");$i.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Ui.main();Type.registerNamespace("CNT");cg.main();Type.registerNamespace("Common.App.NewAndOpen.Core");F.a.instance.Rc(new Bg);Type.registerNamespace("Common.App.NewAndOpen.UX");F.a.instance.Rc(new hj);
Type.registerNamespace("Common.App.OneDriveFilePickerApi");Ml.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Cj.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");lk.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");nj.main();Type.registerNamespace("CADWLTR");
mk.main();Type.registerNamespace("Common.App.DirectPrint");F.a.instance.Rc(new mg);Type.registerNamespace("Common.App.SearchOAuthManager");kc.main();Ch.main();Qd.main();Gg.main();Xh.main();je.main();F.a.instance.Rc(new Bf);uk.main();Dd.main();F.a.instance.Rc(new Il);Type.registerNamespace("Common.App.SaveStatus");F.a.instance.Rc(new Yp);Type.registerNamespace("Common.App.EventsCacheManager");oq.main();Type.registerNamespace("CUIB");rj.main();Type.registerNamespace("CommandUI.TaskPane");try{F.a.instance.Rc(new Rm(Db.StaticActiveAppFrame.Aa().tb))}catch(b){v.ULS.shipAssertTag(575930383,
3016,!1,b.message)}Lp.main();Type.registerNamespace("Common.App.Insights");Mp;F.a.instance.Rc(new Xm);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");bn("Begin");F.a.instance.Rc(new Do);try{F.a.instance.Rc(new vy(Fk.a.get_instance(),Db.StaticActiveAppFrame.Aa().tb,Db.StaticActiveAppFrame.Aa().Pb))}catch(b){v.ULS.shipAssertTag(575930384,
3016,!1,b.message)}tc.main();F.a.instance.Rc(new rg);Zo.main();fk.main();wo.main();Nt.main();ox.main();gn.main();iq.main();Pq.main();F.a.instance.Rc(new $E);bD.main();tu.main();rv.main();Ry.main();Gb.main();va.main();F.a.instance.Rc(new EH);F.a.instance.Rc(new hK);GH.main();vB.main();sv.main();Lf.main();F.a.instance.Rc(new nD);F.a.instance.Rc(new rF);sK;EF.main();dI.main();hI.main();Xu.main();lI;F.a.instance.Rc(new hA);F.a.instance.Rc(new Bu);pI.main();PB.main();MD.main();F.a.instance.Rc(new zI);
F.a.instance.Rc(new EI);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Zu;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");bs.main();jz.main();dG.main();UM;SG.main();SL;window.MSOJS=kx;yE.main();PN.main();F.a.instance.Rc(new SO);F.a.instance.Rc(new OL);(async()=>{y.AFrameworkApplication.J.$("WPMPackageIsEnabled")&&await e.e(28).then(e.bind(null,2148)).then(b=>
{b.initializeOnDemandPackage()})})();Ec.main();xh.main()},2153:function(I,K,e){I=e(0);var m=e(118),f=e(8),a=e(2),l=e(44),w=e(962),z=e(21);class x{constructor(F,T,Y,P){this.g3e=null;this.dDd=P;this.bAa=F;this.cAa=T;this.j3=Y;this.mKh=this.XXb.oap;F=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.sKk=F[0];this.rKk=F[1]}get XXb(){return this.g3e||(this.g3e=z.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get vub(){return CommonUIStrings.l_OICErrorHelpLink}get usd(){return this.mKh}get uhj(){return this.sKk}get thj(){return this.rKk}get shj(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.mKh?
3:2}get G2c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get R_d(){return!!this.cAa}get H2c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}wtg(F){this.Hhd(F)}y7f(F){this.Hhd(F)}Hhd(F){let T=10;this.cAa&&1===F&&(this.cAa(this.j3),T=1);this.bAa&&this.bAa(this.j3);this.pU(T)}WYb(){w.Redirect.showHelp("OICFailure");this.pU(2)}Vgg(){this.XXb.Daj();this.pU(4)}pU(F){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.dDd,F);a.AFrameworkApplication.Lod(l.a.qvj,this.dDd,F)}dispose(){this.j3=this.bAa=this.cAa=null}}Object(I.a)(x,"AOICErrorDialog",null,[11]);var u=e(37),v=e(182);class E extends x{constructor(F,T,Y,P){super(F,T,Y,P);this.Qlb=this.wJ=null;F=document.createElement("span");F.id="errorMessageText";F.innerText=this.errorMessage;F.appendChild(document.createElement("br"));F.appendChild(document.createElement("br"));this.wJ=document.createElement("a");this.wJ.href="#";this.wJ.innerText=this.vub;F.appendChild(this.wJ);
u.a.addHandler(this.wJ,"click",Object(m.a)(this,this.WYb,"oicErrorHelpLinkHandler"));T=new v.StandardDialog;T.$g=this.id;this.usd?(Y=document.createElement("span"),P=document.createElement("span"),Y.innerText=this.uhj,P.innerText=this.thj,this.Qlb=document.createElement("a"),this.Qlb.href="#",this.Qlb.innerText=this.shj,F.appendChild(document.createElement("br")),F.appendChild(Y),F.appendChild(this.Qlb),F.appendChild(P),u.a.addHandler(this.Qlb,"click",Object(m.a)(this,this.Vgg,"oicErrorMacOfferLinkHandler"))):
this.R_d&&(F.appendChild(document.createElement("br")),F.appendChild(document.createElement("br")),Y=document.createElement("span"),Y.innerText=this.G2c,F.appendChild(Y));this.R_d?(T.Md=1,T.Ue(1,this.H2c)):T.Md=0;T.Yx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.y7f,"legacyOICErrorDialogHandler"),F);T.u$("errorMessageText")}dispose(){this.wJ&&(u.a.removeHandler(this.wJ,"click",Object(m.a)(this,this.WYb,"oicErrorHelpLinkHandler")),this.wJ=null);this.Qlb&&(u.a.removeHandler(this.Qlb,"click",
Object(m.a)(this,this.Vgg,"oicErrorMacOfferLinkHandler")),this.Qlb=null);super.dispose()}}Object(I.a)(E,"OICErrorDialog",x,[]);class y{constructor(F,T,Y){this.bAa=T;this.cAa=F;this.j3=Y}get id(){return"OICErrorDialogWithDownload"}get Aqi(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get vub(){return CommonUIStrings.l_OICErrorHelpLink}get G2c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get H2c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}wtg(F){this.Hhd(F)}y7f(F){this.Hhd(F)}Hhd(F){let T=
10;1===F&&(this.cAa(this.j3),T=1);this.bAa&&this.bAa(this.j3);this.pU(T)}WYb(){w.Redirect.showHelp("OICFailure");this.pU(2)}pU(F){a.AFrameworkApplication.Lod(l.a.rvj,3,F)}dispose(){this.j3=this.cAa=this.bAa=null}}Object(I.a)(y,"AOICErrorDialogWithDownload",null,[11]);class H extends y{constructor(F,T,Y){super(F,T,Y);this.wJ=null;F=document.createElement("span");F.id="errorMessageText";F.innerText=this.Aqi;F.appendChild(document.createElement("br"));F.appendChild(document.createElement("br"));this.wJ=
document.createElement("a");this.wJ.href="#";this.wJ.innerText=this.vub;F.appendChild(this.wJ);u.a.addHandler(this.wJ,"click",Object(m.a)(this,this.WYb,"oicErrorHelpLinkHandler"));F.appendChild(document.createElement("br"));F.appendChild(document.createElement("br"));T=document.createElement("span");T.innerText=this.G2c;F.appendChild(T);T=new v.StandardDialog;T.$g=this.id;T.Md=1;T.Ue(1,this.H2c);T.Yx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.y7f,"legacyOICErrorDialogHandler"),F);T.u$("errorMessageText")}dispose(){this.wJ&&
(u.a.removeHandler(this.wJ,"click",Object(m.a)(this,this.WYb,"oicErrorHelpLinkHandler")),this.wJ=null);super.dispose()}}Object(I.a)(H,"OICErrorDialogWithDownload",y,[]);var D=e(191);class G extends x{constructor(F,T,Y,P){super(F,T,Y,P);T={["errorMessage"]:this.errorMessage};T.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.vub,["onExecute"]:S=>{this.WYb(S)}};this.usd?(T.macOfficePreLinkText=this.uhj,T.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.shj,
["onExecute"]:S=>{this.Vgg(S)}},T.macOfficePostText=this.thj):this.R_d&&(T.errorFileDownloadOffer=this.G2c);F=new D.a(!1,!1,!0);this.R_d?(F.Md=1,F.Ue(1,this.H2c)):F.Md=0;F.$g=this.id;T={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:T};F.ti(this.dialogTitle,Object(m.a)(this,this.wtg,"reactOICErrorDialogHandler"),T)}}Object(I.a)(G,"ReactOICErrorDialog",x,[]);class J extends y{constructor(F,T,Y){super(F,T,Y);T={["errorMessage"]:this.Aqi,["errorFileDownloadOffer"]:this.G2c};T.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.vub,["onExecute"]:P=>{this.WYb(P)}};F=new D.a(!1,!1,!0);F.Md=1;F.Ue(1,this.H2c);F.$g=this.id;T={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:T};F.ti(this.dialogTitle,Object(m.a)(this,this.wtg,"reactOICErrorDialogHandler"),T)}}Object(I.a)(J,"ReactOICErrorDialogWithDownload",y,[]);e.d(K,"a",function(){return U});class U{constructor(){this.ITa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Pb.$I}yOl(F,T,Y){this.ITa?new G(F,T,null,Y):new E(F,T,null,
Y)}zOl(F,T,Y){this.ITa?new J(F,T,Y):new H(F,T,Y)}AOl(F,T,Y,P,S){const {ReactOICErrorDialogWithTrial:N}=e(1900),{OICErrorDialogWithTrial:V}=e(1901);this.ITa?new N(F,T,Y,null,P,S):new V(F,T,Y,null,P,S)}static get instance(){return U._instance||(U._instance=new U)}}U._instance=null;Object(I.a)(U,"OICErrorDialogFactoryImpl",null,[1797])},2156:function(I,K,e){I=e(0);var m=e(8),f=e(1569);class a{static get nSn(){return 50}static Eae(w){if(""===w)return"";let z=0,x="";try{const u=f.a.ktb(w);for(const v of u.ops)if(a.hK(v))z||
(x+=a.qzm(v.attributes.atmention.fullName)),z+=1;else{const E=v.insert?v.insert:"";" "!==E&&0<E.length&&(z=0,x+=E)}}catch(u){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return x}static atm(w){w=a.Eae(w);return 0<w.length&&w.split(" ").length<=a.nSn?w:null}static qzm(w){let z="";w&&(w=w.split(" "),0<w.length&&(z=w[0]));return z}static hK(w){return!!w.attributes&&!!w.attributes.atmention}}Object(I.a)(a,"BaseCommentSmartReplyHelpers",
null,[]);e.d(K,"a",function(){return l});class l extends a{constructor(){super()}static pSb(w,z,x=!1){if(!w)return null;w=w.text&&0<w.text.length?w.text[0]:"";z=!z||!z.kg||""===z.kg;return 0<w.length&&z&&!x?a.atm(w):null}}Object(I.a)(l,"CommentSmartReplyHelpers",a,[])},973:function(I,K,e){e.d(K,"a",function(){return m});I=e(0);class m{constructor(){this.method=this.api=0}}Object(I.a)(m,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/23790900/wdjs/WordEditorDS.box4.dll1.js.map